var e=Object.defineProperty,t=(t,n,r)=>(((t,n,r)=>{n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r})(t,"symbol"!=typeof n?n+"":n,r),r);import{_ as n,u as r,A as a,k as i,m as o,V as s,l,p as c,a as u,o as p,X as m,Y as d,b as v}from"./index.1705233370182.js";import{g as h,a as f}from"./index.1705233370182107.js";import{l as y,M as g}from"./mapconfig.1705233370182.js";import{W as w,S as b,P as _,A as x,a as S,D as C,C as M,V as E,b as R,c as P,M as I,d as L,e as j,O as $,B as N,F as A,T as D,f as T,g as k,h as z,R as F,i as V}from"./three.module.1705233370182.js";var O,W,q,G,U={exports:{}},Z={exports:{}};function B(){return O?Z.exports:(O=1,Z.exports=e={determinant:function(e){switch(e.length){case 4:return e[0]*e[3]-e[1]*e[2];case 9:return e[0]*(e[4]*e[8]-e[5]*e[7])+e[1]*(e[5]*e[6]-e[3]*e[8])+e[2]*(e[3]*e[7]-e[4]*e[6]);default:throw new Error("FIXME")}},invert:function(t){var n=e.determinant(t);if(0===n)throw new Error("Cannot invert a matrix with a determinant of zero.");switch(t.length){case 4:return[t[3]/n,-t[1]/n,-t[2]/n,t[0]/n];case 9:return[(t[4]*t[8]-t[5]*t[7])/n,(t[2]*t[7]-t[1]*t[8])/n,(t[1]*t[5]-t[2]*t[4])/n,(t[5]*t[6]-t[3]*t[8])/n,(t[0]*t[8]-t[2]*t[6])/n,(t[2]*t[3]-t[0]*t[5])/n,(t[3]*t[7]-t[4]*t[6])/n,(t[6]*t[1]-t[0]*t[7])/n,(t[0]*t[4]-t[1]*t[3])/n];default:throw new Error("FIXME")}},multiply:function(e,t){var n,r,a,i;if(e.length===t.length)throw new Error("FIXME");if(e.length===t.length*t.length){for(n=t.length,r=new Array(n),a=n;a--;)for(r[a]=0,i=n;i--;)r[a]+=e[a*n+i]*t[i];return r}throw new Error("Matrix mismatch.")}});var e}W=U,G="undefined"!=typeof Matrix?Matrix:B(),q={coordinates:function(e,t){var n,r,a=t.length,i=new Array(a),o=new Array(a*a);if(e.length!==a+1)throw new Error("Invalid simplex.");for(n=a+1;n--;)if(e[n].length!==a)throw new Error("Invalid simplex.");for(n=a;n--;)for(i[n]=t[n]-e[0][n],r=a;r--;)o[n*a+r]=e[r+1][n]-e[0][n];return G.multiply(G.invert(o),i)},contains:function(e,t){var n,r=q.coordinates(e,t),a=0;for(n=r.length;n--;){if(r[n]<0)return null;a+=r[n]}return a<=1?r:null}},W.exports=q;var J=U.exports,X={exports:{}};!function(e){var t;!function(){var n="undefined"!=typeof Matrix?Matrix:B(),r=function(e,n,r){var a,i=new Array(e.length);for(a=i.length;a--;)i[a]=n[e[a]];this.vertices=e,this.center=t.circumcenter(i,r),this.radius=t.distanceSquared(this.center,i[0],r)};r.prototype={passed:function(e,t){var n=e[0]-this.center[0];return n>0&&n*n>this.radius},contains:function(e,n){return t.distanceSquared(this.center,e,n)<=this.radius},addEdges:function(e,t){var n,r,a;for(r=e+1;r--;){for(n=new Array(e),a=e;a--;)n[a]=this.vertices[(r+a)%this.vertices.length];n.sort(),t.push(n)}}},t={resolve:function(e,t){var n;if(void 0!==t)if(Array.isArray(t))for(n=0;void 0!==e&&n!==t.length;++n)e=e[t[n]];else void 0!==e&&(e=e[t]);return e},dimensions:function(e){var t=0,n=e.length;if(n)for(t=e[--n].length;n--;)e[n].length<t&&(t=e[n].length);return t},boundingBox:function(e,t){var n,r,a,i=new Array(t),o=new Array(t);if(e.length){for(r=t;r--;)i[r]=Number.POSITIVE_INFINITY,o[r]=Number.NEGATIVE_INFINITY;for(n=e.length;n--;)for(a=e[n],r=t;r--;)a[r]<i[r]&&(i[r]=a[r]),a[r]>o[r]&&(o[r]=a[r])}else for(r=t;r--;)i[r]=0,o[r]=0;return[i,o]},boundingSimplex:function(e,n){var r,a,i,o,s=t.boundingBox(e,n),l=s[0],c=s[1],u=new Array(n+1);for(a=n;a--;)i=2048+c[a]-l[a],l[a]-=1*i,c[a]+=3*i;for(u[0]=l,r=n;r--;)for(o=u[1+r]=new Array(n),a=n;a--;)o[a]=(r!==a?l:c)[a];return u},bisectors:function(e,t){var n,r,a,i,o,s=t+1,l=new Array(s*t);for(n=t;n--;){for(a=e[n+0],i=e[n+1],o=0,r=t;r--;)o+=(a[r]+i[r])*(l[n*s+r]=a[r]-i[r]);l[n*s+t]=-.5*o}return l},cross:function(e,t){if(e.length!==t*t+t)throw new Error("Invalid matrix shape.");var r,a,i,o=t+1,s=1,l=new Array(o),c=new Array(t*t);for(r=0;r!==o;++r){if(0===r)for(a=t;a--;)for(i=t;i--;)c[a*t+i]=e[a*o+i+1];else for(i=r-1,a=t;a--;)c[a*t+i]=e[a*o+i];l[r]=s*n.determinant(c),s=-s}return l},circumcenter:function(e,n){if(e.length!==n+1)throw new Error("A "+n+"-simplex requires "+(n+1)+" vertices.");var r,a=t.bisectors(e,n),i=t.cross(a,n);for(r=n;r--;)i[r]/=i[n];return i.length=n,i},distanceSquared:function(e,t,n){var r,a,i=0;for(r=n;r--;)i+=(a=t[r]-e[r])*a;return i},distance:function(e,n,r){return Math.sqrt(t.distanceSquared(e,n,r))},isSameEdge:function(e,t){var n;if(e.length!==t.length)return!1;for(n=e.length;n--;)if(e[n]!==t[n])return!1;return!0},removeDuplicateEdges:function(e){var n,r;for(n=e.length;n--;)for(r=n;r--;)if(t.isSameEdge(e[n],e[r])){e.splice(n,1),e.splice(r,1),--n;break}},triangulate:function(e,n){var a,i,o=e.length;for(a=(e=e.slice(0)).length;a--;)e[a]=t.resolve(e[a],n);var s=t.dimensions(e);if(s<2||s>3)throw new Error("The Delaunay module currently only supports 2D or 3D data.");for(a=e.length;a--;)e[a]={index:a,position:e[a]};e.sort((function(e,t){return t.position[0]-e.position[0]}));var l=new Array(e.length);for(a=e.length;a--;)l[a]=e[a].index,e[a]=e[a].position;Array.prototype.push.apply(e,t.boundingSimplex(e,s));var c=new Array(s+1);for(a=c.length;a--;)c[a]=o+a;var u=[new r(c,e,s)],p=[],m=[];for(a=o;a--;m.length=0){for(i=u.length;i--;)u[i].passed(e[a],s)?(p.push(u[i]),u.splice(i,1)):u[i].contains(e[a],s)&&(u[i].addEdges(s,m),u.splice(i,1));for(t.removeDuplicateEdges(m),i=m.length;i--;)m[i].unshift(a),u.push(new r(m[i],e,s))}Array.prototype.push.apply(p,u),u.length=0,c.length=0;e:for(a=p.length;a--;){for(i=p[a].vertices.length;i--;)if(p[a].vertices[i]>=o)continue e;for(i=0;i<p[a].vertices.length;i++)c.push(l[p[a].vertices[i]])}return c}},e.exports=t}()}(X);var Y=J,H=X.exports.triangulate;Y.coordinates,Y.contains;const K=""+new URL("GJZ_ZC.1705233370182.svg",import.meta.url).href,Q=""+new URL("GJZ_ZD.1705233370182.svg",import.meta.url).href,ee=""+new URL("SJZ_ZC.1705233370182.svg",import.meta.url).href,te=""+new URL("SJZ_ZD.1705233370182.svg",import.meta.url).href;async function ne(e,t){const[n,r,a,i]=await y(["esri/Graphic","esri/geometry/Point","esri/geometry/SpatialReference","esri/layers/FeatureLayer"]),o=[],s="shanghaiPointStation",l=function(){const e={type:"unique-value",field:"status",uniqueValueInfos:[]};return["countrynormal","countryabnormal","provincialnormal","provincialabnormal"].map((t=>{let n="";"countrynormal"===t?n=K:"countryabnormal"===t?n=Q:"provincialnormal"===t?n=ee:"provincialabnormal"===t&&(n=te);const r={value:t,label:t,symbol:{type:"point-3d",symbolLayers:[{type:"icon",size:60,resource:{href:n}}],verticalOffset:{screenLength:150,maxWorldLength:300,minWorldLength:50},callout:{type:"line",color:[125,125,0,1],size:1,border:{color:[255,255,255,.5]}}}};e.uniqueValueInfos.push(r)})),e}();e.map((e=>{const t={station_name:e.station_name,station_oname:e.station_oname,rely_units:"country"===e.rely_units?"country":"provincial",is_ok:1===e.is_ok?"normal":"abnormal",type:3===e.type?"provincial":"country",mapx:e.mapx,mapy:e.mapy};"country"===t.rely_units&&"normal"===t.is_ok?t.status="countrynormal":"country"===t.rely_units&&"normal"!==t.is_ok?t.status="countryabnormal":"provincial"===t.rely_units&&"normal"===t.is_ok?t.status="provincialnormal":"provincial"===t.rely_units&&"normal"!==t.is_ok&&(t.status="provincialabnormal");const i=new r({x:e.mapx,y:e.mapy,spatialReference:a.WebMercator}),s=new n({geometry:i,attributes:t});o.push(s)}));const c=t.map.findLayerById(s);c&&t.map.remove(c);const u=new i({id:s,visible:!0,title:"PointStation",objectIdField:"OBJECTID",geometryType:"point",renderer:l,labelsVisible:!0,elevationInfo:{mode:"relative-to-ground",offset:0},fields:[{name:"station_cname",type:"string",alias:"station_cname"},{name:"station_name",type:"string",alias:"station_name"},{name:"rely_units",type:"string",alias:"station_units"},{name:"is_ok",type:"string",alias:"is_ok"},{name:"type",type:"string",alias:"station_type"},{name:"mapx",type:"string",alias:"station_coordx"},{name:"mapy",type:"string",alias:"station_coordy"},{name:"status",type:"string",alias:"status"}],popupTemplate:{title:"Station{address}",content:[{type:"fields",fieldInfos:[{fieldName:"station_came",label:"station_cname"},{fieldName:"station_name",label:"station_name"},{fieldName:"rely_units",label:"station_units"},{fieldName:"is_ok",label:"is_ok"},{fieldName:"type",label:"station_type"},{fieldName:"mapx",label:"station_coordx"},{fieldName:"mapy",label:"station_coordy"}]}]},spatialReference:a.WebMercator});u.source=o,u.refresh(),u.labelingInfo=[{labelExpressionInfo:{value:"{station_name}"},symbol:{type:"label-3d",symbolLayers:[{type:"text",material:{color:"white"},halo:{size:1,color:"red"},font:{family:"Ubuntu Mono",size:24,weight:"bold"},size:18}]},labelPlacement:"above-center",maxScale:0,minScale:0}],t.map.add(u)}class re{constructor(e,n,r){t(this,"view",null),t(this,"externalRenderers",null),t(this,"jsonPoints",null),t(this,"startPoint",null),t(this,"offset",null),t(this,"fsbObjs",null),t(this,"parObjs",null),t(this,"cylider_uniforms",null),t(this,"camera",null),t(this,"scene",null),t(this,"sun",null),t(this,"ambient",null),t(this,"renderer",null),t(this,"particleSystems",null),t(this,"par_uniforms",null),t(this,"tx",null),this.view=e,this.externalRenderers=n,r=r||{},this.view=e,this.jsonPoints=r.jsonPoints||[],this.startPoint=r.startPoint||[],this.offset=0,this.fsbObjs=[],this.parObjs=[],this.cylider_uniforms=[]}setup(e){this.renderer=new w({context:e.gl,premultipliedAlpha:!1}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setViewport(0,0,this.view.width,this.view.height),this.renderer.autoClear=!1,this.renderer.autoClearDepth=!1,this.renderer.autoClearColor=!1;var t=this.renderer.setRenderTarget.bind(this.renderer);this.renderer.setRenderTarget=function(n){t(n),null==n&&e.bindRenderTarget()},this.scene=new b;var n=e.camera;this.camera=new _(n.fovY,n.aspect,n.near,n.far);const r=new x(1);r.position.copy(1e6,1e5,1e5),this.scene.add(r),this.ambient=new S(16777215,.5),this.scene.add(this.ambient),this.sun=new C(16777215,.5),this.sun.position.set(-600,300,6e4),this.scene.add(this.sun),this.clock=new M,this.getGeometry(e),e.resetWebGLState()}render(e){var t=e.camera;this.camera.position.set(t.eye[0],t.eye[1],t.eye[2]),this.camera.up.set(t.up[0],t.up[1],t.up[2]),this.camera.lookAt(new E(t.center[0],t.center[1],t.center[2])),this.camera.projectionMatrix.fromArray(t.projectionMatrix);var n=e.sunLight;this.sun.position.set(n.direction[0],n.direction[1],n.direction[2]),this.sun.intensity=n.diffuse.intensity,this.sun.color=new R(n.diffuse.color[0],n.diffuse.color[1],n.diffuse.color[2]),this.ambient.intensity=n.ambient.intensity,this.ambient.color=new R(n.ambient.color[0],n.ambient.color[1],n.ambient.color[2]),this.fsbObjs.forEach((e=>{e&&(e.rotation.z+=.03,e.scale.x>=0&&e.scale.x<=1.2?(e.scale.x+=.02,e.scale.y+=.02,e.scale.z+=.02):(e.scale.x=.01,e.scale.y=.01,e.scale.z=.01))})),this.renderer.state.reset(),this.renderer.render(this.scene,this.camera),this.externalRenderers.requestRender(this.view),e.resetWebGLState()}produceCanvasDm(e){const t=document.createElement("canvas");t.width=512,t.height=512;const n=t.getContext("2d"),r=n.createRadialGradient(256,256,0,256,256,256);return r.addColorStop(.1,`rgba(${e[0]}, ${e[1]}, ${e[2]}, 1.0)`),r.addColorStop(.2,`rgba(${e[0]}, ${e[1]}, ${e[2]}, 0.0)`),r.addColorStop(.3,`rgba(${e[0]}, ${e[1]}, ${e[2]}, 0.9)`),r.addColorStop(.5,`rgba(${e[0]}, ${e[1]}, ${e[2]}, 0.0)`),r.addColorStop(.9,`rgba(${e[0]}, ${e[1]}, ${e[2]}, 0.2)`),r.addColorStop(1,`rgba(${e[0]}, ${e[1]}, ${e[2]}, 1.0)`),n.clearRect(0,0,512,512),n.beginPath(),n.arc(256,256,256,0,2*Math.PI,!0),n.fillStyle=r,n.fill(),n.restore(),t}produceCanvasFsb(e){const t=document.createElement("canvas");t.width=512,t.height=512;const n=t.getContext("2d");return n.clearRect(0,0,512,512),n.strokeStyle=`rgb(${e[0]}, ${e[1]}, ${e[2]})`,n.setLineDash([80,80]),n.lineWidth=30,n.arc(256,256,241,0,2*Math.PI,!0),n.stroke(),t}produceCanvasLabel(){const e=document.createElement("canvas");e.width=256,e.height=256;const t=e.getContext("2d");t.clearRect(0,0,256,256);var n=new Image;return n.src="./billboard2.png",t.drawImage(n,0,0),e}getGeometry(e){this.jsonPoints.forEach((e=>{var t=[],n=e[0],r=e[1],a=e[2];this.externalRenderers.toRenderCoordinates(this.view,n,0,this.view.spatialReference,t,0,1);var i=new P(a[0],300,Math.PI,2*Math.PI),o=new I(i,new L({map:new j(this.produceCanvasDm(r)),opacity:1,transparent:!0}));o.position.set(t[0],t[1],t[2]),this.scene.add(o);var s=new I(i.clone(),new L({map:new j(this.produceCanvasFsb(r)),opacity:1,transparent:!0}));s.position.set(t[0],t[1],t[2]+100),this.scene.add(s),this.fsbObjs.push(s)}))}transparentObject(e,t){var n,r=new $;return(n=new I(e,t)).material.side=N,n.renderOrder=0,r.add(n),(n=new I(e,t.clone())).material.side=A,n.renderOrder=1,r.add(n),r}createOdLines(e){var t=[];this.externalRenderers.toRenderCoordinates(this.view,this.startPoint,0,this.view.spatialReference,t,0,1),this.jsonPoints;for(var n=0;n<this.jsonPoints.length;n++){var r=[];this.externalRenderers.toRenderCoordinates(this.view,this.jsonPoints[n][0],0,this.view.spatialReference,r,0,1),this.particleSystems.startParticles(new E(t[0],t[1],t[2]),new E(r[0],r[1],r[2]),2e4,15)}}createLabel(){var e=[];this.externalRenderers.toRenderCoordinates(this.view,this.startPoint,0,this.view.spatialReference,e,0,1);let t=(new D).load("images/billboard.png");var n=new T({map:t});let r=new k(n);r.position.set(e[0],e[1],e[2]+5e3),r.scale.set(1e4,5e3,1e4),this.scene.add(r)}getMaterial(e){var t={time:{value:1},u_image:{value:(new D).load("images/test-4.png")},u_color:{value:new R(`rgba(${e[0]}, ${e[1]}, ${e[2]}, ${e[3]})`)}};this.cylider_uniforms.push(t);let n=this.getShaderStr();return new z({uniforms:t,vertexShader:n.vs,fragmentShader:n.fs,side:void 0,transparent:!0})}getShaderStr(){let e={vs:"",fs:""};return e.vs="\n       varying vec2 v_st;\n       varying vec3 v_normalEC;\n       varying vec3 v_positionEC;\n       varying vec4 v_color;\n       void main()\n       {\n           v_st = uv;\n           v_normalEC=normal;\n           v_positionEC=position;\n           vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n           gl_Position = projectionMatrix * mvPosition;\n       }\n       ",e.fs="\n                varying vec3 v_positionEC;\n                varying vec3 v_normalEC;\n                varying vec2 v_st;\n                varying vec4 v_color;\n                uniform sampler2D u_image;\n                uniform vec3 u_color;\n                uniform float time;\n                void main()\n                {\n                    vec4 colora = texture2D(u_image,vec2(v_st.x,fract(v_st.y-time)));\n                    float alpha = colora.a;\n                    gl_FragColor = vec4(u_color, alpha);\n                }\n                ",e}getMaterial_par(e){this.par_uniforms={time:{value:1},u_image:{value:void 0},u_color:{value:new R(`rgba(${e[0]}, ${e[1]}, ${e[2]}, ${e[3]})`)}},this.tx=(new D).load("images/particles.png"),this.tx.wrapS=F,this.tx.wrapT=F,this.tx.repeat.x=4,this.tx.repeat.y=2,this.par_uniforms.u_image.value=this.tx;let t=this.getShaderStr_par();return new z({uniforms:this.par_uniforms,vertexShader:t.vs,fragmentShader:t.fs,side:void 0,opacity:1,transparent:!0,depthWrite:!1})}getShaderStr_par(){let e={vs:"",fs:""};return e.vs="\n           varying vec2 v_st;\n           varying vec3 v_normalEC;\n           varying vec3 v_positionEC;\n           void main()\n           {\n               v_st = uv;\n               v_normalEC=normal;\n               v_positionEC=position;\n               vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n               gl_Position = projectionMatrix * mvPosition;\n           }\n           ",e.fs="\n                    varying vec3 v_positionEC;\n                    varying vec3 v_normalEC;\n                    varying vec2 v_st;\n                    uniform sampler2D u_image;\n                    uniform vec3 u_color;\n                    void main()\n                    {\n                      vec4 mapColor=texture2D(u_image, v_st);\n                      gl_FragColor = vec4(u_color, mapColor.a);\n                    }\n                    ",e}getMaterial2(e){const t={scale:{type:"f",value:-1},bias:{type:"f",value:1},power:{type:"f",value:3.3},glowColor:{type:"c",value:new R(65535)},textureMap:{value:void 0},repeat:{type:"v2",value:new V(30,15)},time:{value:0}};let n=(new D).load("images/particles.png");n.wrapS=F,n.wrapT=F,n.repeat.x=2,t.textureMap.value=n;let r=this.getShaderStr2();return new z({uniforms:t,vertexShader:r.vs,fragmentShader:r.fs,side:void 0,transparent:!0})}getShaderStr2(){let e={vs:"",fs:""};return e.vs="\n      varying vec3 vNormal;\n      varying vec3 vPositionNormal;\n      varying vec2 vUv;\n      void main() \n      {\n          vUv = uv;\n          vNormal = normalize( normalMatrix * normal );\n          vPositionNormal = normalize(( modelViewMatrix * vec4(position, 1.0) ).xyz);\n          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n      }\n       ",e.fs="\n      uniform vec3 glowColor;\n      uniform float bias;\n      uniform float power;\n      uniform float scale;\n      varying vec3 vNormal;\n      varying vec3 vPositionNormal;\n      uniform sampler2D textureMap;\n      uniform vec2 repeat;\n      varying vec2 vUv;\n      uniform float time;\n      void main() \n      {\n          float a = pow( bias + scale * abs(dot(vNormal, vPositionNormal)), power );\n          vec4 mapColor=texture2D( textureMap, vUv*repeat);\n          gl_FragColor = vec4( glowColor*mapColor.rgb, a );\n      }\n      ",e}}async function ae(e){const[t,n,r,a,i,o,s,l,c,u,p,m,d]=await y(["esri/Map","esri/views/SceneView","esri/layers/FeatureLayer","esri/core/reactiveUtils","esri/widgets/Expand","esri/Camera","esri/widgets/Home","esri/widgets/Fullscreen","esri/widgets/LayerList","esri/widgets/Legend","esri/views/3d/externalRenderers","esri/widgets/BasemapGallery","esri/geometry/SpatialReference"],{url:g.jsapiurl,css:g.jscssurl}),v=new t({basemap:"streets-night-vector",ground:{surfaceColor:"#021425"}}),f=new n({spatialReference:d.WebMercator,container:"viewDiv_demo_cors",map:v,viewingMode:"local"}),w=new m({view:f}),b=new i({view:f,content:w,expandIconClass:"esri-icon-basemap",expandTooltip:"LayerList",group:"top-left"});f.ui.add(b,"top-left");const _=new c({container:document.createElement("div"),id:"demo_cors_maplayerlist",view:f,listItemCreatedFunction:async function(e){e.item.actionsSections=[[{title:"Go to full extent",className:"esri-icon-zoom-out-fixed",id:"full-extent"}],[{title:"Increase opacity",className:"esri-icon-up",id:"increase-opacity"},{title:"Decrease opacity",className:"esri-icon-down",id:"decrease-opacity"}]]}});_.on("trigger-action",(e=>{const t=e.item.layer,n=e.action.id;"full-extent"===n?f.goTo(t.fullExtent):"increase-opacity"===n?t.opacity<1&&(t.opacity+=.25):"decrease-opacity"===n&&t.opacity>0&&(t.opacity-=.25)}));const x=new i({id:"demo_cors_maplayerlistExpand",view:f,content:_.domNode,expandIconClass:"esri-icon-layers",expandTooltip:"LayerList",group:"top-left"});f.ui.add(x,"top-left");const S=new o({fov:e.camera.fov,heading:e.camera.heading,position:{x:e.camera.position.x,y:e.camera.position.y,z:e.camera.position.z,spatialReference:{wkid:3857}},tilt:e.camera.tilt});a.once((()=>!0===(null==f?void 0:f.stationary))).then((()=>{f.goTo(S,e.cameraoptions).then((()=>{h().then((e=>{ne(e.Rows,f),async function(e,t){const[n,r,a,i]=await y(["esri/Graphic","esri/geometry/Polyline","esri/geometry/SpatialReference","esri/layers/FeatureLayer"]),o=[];e.map(((e,t)=>{o[t]=[Number(e.mapx),Number(e.mapy),e.is_ok]}));const s=H(o),l=[];for(let v=s.length;v;){const e=[];--v,e.push([o[s[v]][0],o[s[v]][1],o[s[v]][2]]),--v,e.push([o[s[v]][0],o[s[v]][1],o[s[v]][2]]),--v,e.push([o[s[v]][0],o[s[v]][1],o[s[v]][2]]),l.push(e)}const c=[],u="PointStationLine",p=function(){const e={type:"unique-value",field:"status",uniqueValueInfos:[]};return["normal","abnormal"].map((t=>{const n={label:t,value:t,symbol:{type:"line-3d",symbolLayers:[{type:"line",size:2,material:{color:"normal"===t?"green":"red"},pattern:{type:"style",style:"solid"}}]}};e.uniqueValueInfos.push(n)})),e}();l.map((e=>{const t=[];t.push([e[0][0],e[0][1],10]),t.push([e[1][0],e[1][1],10]);const i=new r({hasZ:!0,hasM:!0,paths:[t],spatialReference:a.WebMercator});let o="normal";0!==e[0][2]&&0!==e[1][2]||(o="abnormal");const s=new n({geometry:i,attributes:{status:o}});c.push(s);const l=[];l.push([e[1][0],e[1][1],10]),l.push([e[2][0],e[2][1],10]);const u=new r({hasZ:!0,hasM:!0,paths:[l],spatialReference:a.WebMercator});let p="normal";0!==e[1][2]&&0!==e[2][2]||(p="abnormal");const m=new n({geometry:u,attributes:{status:p}});c.push(m);const d=[];d.push([e[2][0],e[2][1],10]),d.push([e[0][0],e[0][1],10]);const v=new r({hasZ:!0,hasM:!0,paths:[d],spatialReference:a.WebMercator});let h="normal";0!==e[2][2]&&0!==e[0][2]||(h="normal");const f=new n({geometry:v,attributes:{status:h}});c.push(f)}));const m=t.map.findLayerById(u);m&&t.map.remove(m);const d=new i({id:u,visible:!0,title:"PointStationtriangulateLine",objectIdField:"OBJECTID",geometryType:"polyline",renderer:p,labelsVisible:!1,elevationInfo:{mode:"relative-to-ground",offset:0},fields:[{name:"status",type:"string",alias:"station_status"}],spatialReference:a.WebMercator});d.source=c,d.refresh(),d.labelingInfo=[{labelExpressionInfo:{value:"{status}"},symbol:{type:"label-3d",symbolLayers:[{type:"text",material:{color:"white"},halo:{size:1,color:"red"},font:{family:"Ubuntu Mono",size:24,weight:"bold"},size:18}]},labelPlacement:"above-center",maxScale:0,minScale:0}],t.map.add(d),t.goTo(c)}(e.Rows,f);const t=[];e.Rows.map((e=>{t.push([[e.mapx,e.mapy,10],[Math.floor(255*Math.random()),Math.floor(255*Math.random()),Math.floor(255*Math.random()),1],[8e3,5e3,1]])}));const n=new re(f,p,{startPoint:[0,0,1e4],jsonPoints:t});p.add(f,n)}))}))})),a.on((()=>f),"click",(e=>{}))}const ie={name:"map",components:{},setup(){const e=r();a();const t=i({});return o((async()=>{ae(await f())})),s((()=>{})),l((()=>e.state.tagsViewRoutes.isTagsViewCurrenFull)),{...c(t)}}},oe={class:"home-container"},se=[(e=>(m("data-v-72a110f0"),e=e(),d(),e))((()=>v("div",{id:"viewDiv_demo_cors"},null,-1)))];const le=n(ie,[["render",function(e,t,n,r,a,i){return p(),u("div",oe,se)}],["__scopeId","data-v-72a110f0"]]);export{le as default};
