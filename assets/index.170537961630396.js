import{d as e,D as a,k as t,m as l,M as s,r as d,Q as i,a as n,h as r,w as o,ay as u,g as m,o as p,au as c,F as f,e as y,f as b,v as h,b as w,t as _,i as g,y as v,I as k,H as C}from"./index.1705379616303.js";import{l as x,d as D}from"./dept.1705379616303.js";import P from"./editModule.17053796163034.js";const q={class:"app-container"},z=g(" 搜索"),N=g(" 重置 "),V=g(" 新增 "),I=g("修改"),B=g("新增"),M=g("删除"),O=e({setup(e){const{proxy:O}=m(),T=a(),j=t({loading:!0,title:"",tableData:[],statusOptions:[],queryParams:{deptName:void 0,status:void 0}}),E=()=>{j.loading=!0,x(j.queryParams).then((e=>{j.tableData=e.data,j.loading=!1}))},F=()=>{j.queryParams.deptName=void 0,j.queryParams.status=void 0,E()},S=e=>{let a=e.deptId;(e=[]).parentId=a,j.title="添加部门",T.value.openDialog(e)};return l((()=>{E(),O.getDicts("sys_normal_disable").then((e=>{j.statusOptions=e.data})),O.mittBus.on("onEditDeptModule",(e=>{E()}))})),s((()=>{O.mittBus.off("onEditDeptModule")})),(e,a)=>{const t=d("el-input"),l=d("el-form-item"),s=d("el-option"),m=d("el-select"),x=d("SvgIcon"),K=d("el-button"),L=d("el-form"),R=d("el-table-column"),U=d("el-tag"),H=d("el-table"),Q=d("el-card"),A=i("auth"),G=i("loading");return p(),n("div",q,[r(Q,{shadow:"always"},{default:o((()=>[r(L,{model:u(j).queryParams,ref:"queryForm",inline:!0,"label-width":"68px"},{default:o((()=>[r(l,{label:"部门名称",prop:"deptName"},{default:o((()=>[r(t,{placeholder:"请输入部门名称模糊查询",clearable:"",size:"small",onKeyup:c(E,["enter","native"]),modelValue:u(j).queryParams.deptName,"onUpdate:modelValue":a[0]||(a[0]=e=>u(j).queryParams.deptName=e)},null,8,["onKeyup","modelValue"])])),_:1}),r(l,{label:"状态",prop:"status"},{default:o((()=>[r(m,{modelValue:u(j).queryParams.status,"onUpdate:modelValue":a[1]||(a[1]=e=>u(j).queryParams.status=e),placeholder:"部门状态",clearable:"",size:"small"},{default:o((()=>[(p(!0),n(f,null,y(u(j).statusOptions,(e=>(p(),b(s,{key:e.dictValue,label:e.dictLabel,value:e.dictValue},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),r(l,null,{default:o((()=>[r(K,{type:"primary",size:"mini",onClick:E},{default:o((()=>[r(x,{name:"elementSearch"}),z])),_:1}),r(K,{size:"mini",onClick:F},{default:o((()=>[r(x,{name:"elementRefresh"}),N])),_:1}),h((p(),b(K,{type:"primary",plain:"",size:"mini",onClick:S},{default:o((()=>[r(x,{name:"elementPlus"}),V])),_:1})),[[A,"system:dept:add"]])])),_:1})])),_:1},8,["model"]),h((p(),b(H,{data:u(j).tableData,"row-key":"deptId",border:"","default-expand-all":"","tree-props":{children:"children",hasChildren:"hasChildren"}},{default:o((()=>[r(R,{prop:"deptName",label:"部门名称",width:"260"}),r(R,{prop:"createTime",label:"创建时间",width:"300"},{default:o((a=>[w("span",null,_(e.dateStrFormat(a.row.createTime)),1)])),_:1}),r(R,{prop:"orderNum",label:"排序",width:"200"}),r(R,{prop:"status",label:"状态",width:"100"},{default:o((e=>[r(U,{type:"1"===e.row.status?"danger":"success","disable-transitions":""},{default:o((()=>{return[g(_((a=e.row,O.selectDictLabel(j.statusOptions,a.status))),1)];var a})),_:2},1032,["type"])])),_:1}),r(R,{label:"负责人",align:"center",prop:"leader",width:"200"}),r(R,{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:o((e=>[h((p(),b(K,{size:"mini",type:"text",onClick:a=>{return t=e.row,j.title="修改部门",void T.value.openDialog(t);var t}},{default:o((()=>[r(x,{name:"elementEdit"}),I])),_:2},1032,["onClick"])),[[A,"system:dept:edit"]]),h((p(),b(K,{size:"mini",type:"text",onClick:a=>S(e.row)},{default:o((()=>[r(x,{name:"elementPlus"}),B])),_:2},1032,["onClick"])),[[A,"system:dept:add"]]),0!=e.row.parentId?h((p(),b(K,{key:0,size:"mini",type:"text",onClick:a=>{return t=e.row,void k({message:'是否确认删除名称为"'+t.deptName+'"的数据项?',title:"警告",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return D(t.deptId).then((()=>{E(),C.success("删除成功")}))}));var t}},{default:o((()=>[r(x,{name:"elementDelete"}),M])),_:2},1032,["onClick"])),[[A,"system:dept:delete"]]):v("",!0)])),_:1})])),_:1},8,["data"])),[[G,u(j).loading]])])),_:1}),r(P,{ref_key:"editModuleRef",ref:T,title:u(j).title},null,8,["title"])])}}});export{O as default};
