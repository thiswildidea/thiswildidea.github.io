var e=Object.defineProperty,t=(t,r,n)=>(((t,r,n)=>{r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n})(t,"symbol"!=typeof r?r+"":r,n),n);import{_ as r,u as n,A as a,k as i,m as s,V as o,l,p as c,a as u,o as p,X as d,Y as m,b as h}from"./index.1705207398734.js";import{g as v,a as f}from"./index.1705207398734107.js";import{l as g,M as y}from"./mapconfig.1705207398734.js";import{W as w,S as b,P as x,A as _,a as C,D as M,C as S,V as E,b as I,c as R,M as P,d as j,e as $,O as L,B as N,F as A,T,f as D,g as z,h as F,R as V,i as k}from"./three.module.1705207398734.js";var O,W,q,G,B={exports:{}},U={exports:{}};function Z(){return O?U.exports:(O=1,U.exports=e={determinant:function(e){switch(e.length){case 4:return e[0]*e[3]-e[1]*e[2];case 9:return e[0]*(e[4]*e[8]-e[5]*e[7])+e[1]*(e[5]*e[6]-e[3]*e[8])+e[2]*(e[3]*e[7]-e[4]*e[6]);default:throw new Error("FIXME")}},invert:function(t){var r=e.determinant(t);if(0===r)throw new Error("Cannot invert a matrix with a determinant of zero.");switch(t.length){case 4:return[t[3]/r,-t[1]/r,-t[2]/r,t[0]/r];case 9:return[(t[4]*t[8]-t[5]*t[7])/r,(t[2]*t[7]-t[1]*t[8])/r,(t[1]*t[5]-t[2]*t[4])/r,(t[5]*t[6]-t[3]*t[8])/r,(t[0]*t[8]-t[2]*t[6])/r,(t[2]*t[3]-t[0]*t[5])/r,(t[3]*t[7]-t[4]*t[6])/r,(t[6]*t[1]-t[0]*t[7])/r,(t[0]*t[4]-t[1]*t[3])/r];default:throw new Error("FIXME")}},multiply:function(e,t){var r,n,a,i;if(e.length===t.length)throw new Error("FIXME");if(e.length===t.length*t.length){for(r=t.length,n=new Array(r),a=r;a--;)for(n[a]=0,i=r;i--;)n[a]+=e[a*r+i]*t[i];return n}throw new Error("Matrix mismatch.")}});var e}W=B,G="undefined"!=typeof Matrix?Matrix:Z(),q={coordinates:function(e,t){var r,n,a=t.length,i=new Array(a),s=new Array(a*a);if(e.length!==a+1)throw new Error("Invalid simplex.");for(r=a+1;r--;)if(e[r].length!==a)throw new Error("Invalid simplex.");for(r=a;r--;)for(i[r]=t[r]-e[0][r],n=a;n--;)s[r*a+n]=e[n+1][r]-e[0][r];return G.multiply(G.invert(s),i)},contains:function(e,t){var r,n=q.coordinates(e,t),a=0;for(r=n.length;r--;){if(n[r]<0)return null;a+=n[r]}return a<=1?n:null}},W.exports=q;var X=B.exports,Y={exports:{}};!function(e){var t;!function(){var r="undefined"!=typeof Matrix?Matrix:Z(),n=function(e,r,n){var a,i=new Array(e.length);for(a=i.length;a--;)i[a]=r[e[a]];this.vertices=e,this.center=t.circumcenter(i,n),this.radius=t.distanceSquared(this.center,i[0],n)};n.prototype={passed:function(e,t){var r=e[0]-this.center[0];return r>0&&r*r>this.radius},contains:function(e,r){return t.distanceSquared(this.center,e,r)<=this.radius},addEdges:function(e,t){var r,n,a;for(n=e+1;n--;){for(r=new Array(e),a=e;a--;)r[a]=this.vertices[(n+a)%this.vertices.length];r.sort(),t.push(r)}}},t={resolve:function(e,t){var r;if(void 0!==t)if(Array.isArray(t))for(r=0;void 0!==e&&r!==t.length;++r)e=e[t[r]];else void 0!==e&&(e=e[t]);return e},dimensions:function(e){var t=0,r=e.length;if(r)for(t=e[--r].length;r--;)e[r].length<t&&(t=e[r].length);return t},boundingBox:function(e,t){var r,n,a,i=new Array(t),s=new Array(t);if(e.length){for(n=t;n--;)i[n]=Number.POSITIVE_INFINITY,s[n]=Number.NEGATIVE_INFINITY;for(r=e.length;r--;)for(a=e[r],n=t;n--;)a[n]<i[n]&&(i[n]=a[n]),a[n]>s[n]&&(s[n]=a[n])}else for(n=t;n--;)i[n]=0,s[n]=0;return[i,s]},boundingSimplex:function(e,r){var n,a,i,s,o=t.boundingBox(e,r),l=o[0],c=o[1],u=new Array(r+1);for(a=r;a--;)i=2048+c[a]-l[a],l[a]-=1*i,c[a]+=3*i;for(u[0]=l,n=r;n--;)for(s=u[1+n]=new Array(r),a=r;a--;)s[a]=(n!==a?l:c)[a];return u},bisectors:function(e,t){var r,n,a,i,s,o=t+1,l=new Array(o*t);for(r=t;r--;){for(a=e[r+0],i=e[r+1],s=0,n=t;n--;)s+=(a[n]+i[n])*(l[r*o+n]=a[n]-i[n]);l[r*o+t]=-.5*s}return l},cross:function(e,t){if(e.length!==t*t+t)throw new Error("Invalid matrix shape.");var n,a,i,s=t+1,o=1,l=new Array(s),c=new Array(t*t);for(n=0;n!==s;++n){if(0===n)for(a=t;a--;)for(i=t;i--;)c[a*t+i]=e[a*s+i+1];else for(i=n-1,a=t;a--;)c[a*t+i]=e[a*s+i];l[n]=o*r.determinant(c),o=-o}return l},circumcenter:function(e,r){if(e.length!==r+1)throw new Error("A "+r+"-simplex requires "+(r+1)+" vertices.");var n,a=t.bisectors(e,r),i=t.cross(a,r);for(n=r;n--;)i[n]/=i[r];return i.length=r,i},distanceSquared:function(e,t,r){var n,a,i=0;for(n=r;n--;)i+=(a=t[n]-e[n])*a;return i},distance:function(e,r,n){return Math.sqrt(t.distanceSquared(e,r,n))},isSameEdge:function(e,t){var r;if(e.length!==t.length)return!1;for(r=e.length;r--;)if(e[r]!==t[r])return!1;return!0},removeDuplicateEdges:function(e){var r,n;for(r=e.length;r--;)for(n=r;n--;)if(t.isSameEdge(e[r],e[n])){e.splice(r,1),e.splice(n,1),--r;break}},triangulate:function(e,r){var a,i,s=e.length;for(a=(e=e.slice(0)).length;a--;)e[a]=t.resolve(e[a],r);var o=t.dimensions(e);if(o<2||o>3)throw new Error("The Delaunay module currently only supports 2D or 3D data.");for(a=e.length;a--;)e[a]={index:a,position:e[a]};e.sort((function(e,t){return t.position[0]-e.position[0]}));var l=new Array(e.length);for(a=e.length;a--;)l[a]=e[a].index,e[a]=e[a].position;Array.prototype.push.apply(e,t.boundingSimplex(e,o));var c=new Array(o+1);for(a=c.length;a--;)c[a]=s+a;var u=[new n(c,e,o)],p=[],d=[];for(a=s;a--;d.length=0){for(i=u.length;i--;)u[i].passed(e[a],o)?(p.push(u[i]),u.splice(i,1)):u[i].contains(e[a],o)&&(u[i].addEdges(o,d),u.splice(i,1));for(t.removeDuplicateEdges(d),i=d.length;i--;)d[i].unshift(a),u.push(new n(d[i],e,o))}Array.prototype.push.apply(p,u),u.length=0,c.length=0;e:for(a=p.length;a--;){for(i=p[a].vertices.length;i--;)if(p[a].vertices[i]>=s)continue e;for(i=0;i<p[a].vertices.length;i++)c.push(l[p[a].vertices[i]])}return c}},e.exports=t}()}(Y);var J=X,H=Y.exports.triangulate;J.coordinates,J.contains;const K=""+new URL("GJZ_ZC.1705207398735.svg",import.meta.url).href;async function Q(e,t){const[r,n,a,i]=await g(["esri/Graphic","esri/geometry/Point","esri/geometry/SpatialReference","esri/layers/FeatureLayer"]),s=[],o="shanghaicorsstation",l=function(){const e={type:"unique-value",field:"status",uniqueValueInfos:[]};return["国家正常站","国家中断站","省级正常站","省级中断站"].map((t=>{let r="";("国家正常站"===t||"国家中断站"===t||"省级正常站"===t||"省级中断站"===t)&&(r=K);const n={value:t,label:t,symbol:{type:"point-3d",symbolLayers:[{type:"icon",size:60,resource:{href:r}}],verticalOffset:{screenLength:150,maxWorldLength:300,minWorldLength:50},callout:{type:"line",color:[125,125,0,1],size:1,border:{color:[255,255,255,.5]}}}};e.uniqueValueInfos.push(n)})),e}();e.map((e=>{const t={station_name:e.station_name,station_oname:e.station_oname,rely_units:"国家"===e.rely_units?"国家":"省级",is_ok:1===e.is_ok?"正常":"异常",type:3===e.type?"省级":"国家",mapx:e.mapx,mapy:e.mapy};"国家"===t.rely_units&&"正常"===t.is_ok?t.status="国家正常站":"国家"===t.rely_units&&"正常"!==t.is_ok?t.status="国家中断站":"省级"===t.rely_units&&"正常"===t.is_ok?t.status="省级正常站":"省级"===t.rely_units&&"正常"!==t.is_ok&&(t.status="省级中断站");const i=new n({x:e.mapx,y:e.mapy,spatialReference:a.WebMercator}),o=new r({geometry:i,attributes:t});s.push(o)}));const c=t.map.findLayerById(o);c&&t.map.remove(c);const u=new i({id:o,visible:!0,title:"上海基站",objectIdField:"OBJECTID",geometryType:"point",renderer:l,labelsVisible:!0,elevationInfo:{mode:"relative-to-ground",offset:0},fields:[{name:"station_name",type:"string",alias:"基站中文名"},{name:"station_oname",type:"string",alias:"基站英文名"},{name:"rely_units",type:"string",alias:"基站单元"},{name:"is_ok",type:"string",alias:"基站状态"},{name:"type",type:"string",alias:"基站类型"},{name:"mapx",type:"string",alias:"横坐标"},{name:"mapy",type:"string",alias:"纵坐标"},{name:"status",type:"string",alias:"基站等级"}],popupTemplate:{title:"Cors基站{address}",content:[{type:"fields",fieldInfos:[{fieldName:"station_name",label:"基站中文名"},{fieldName:"station_oname",label:"基站英文名"},{fieldName:"rely_units",label:"基站单元"},{fieldName:"is_ok",label:"基站状态"},{fieldName:"type",label:"基站类型"},{fieldName:"mapx",label:"横坐标"},{fieldName:"mapy",label:"纵坐标"}]}]},spatialReference:a.WebMercator});u.source=s,u.refresh(),u.labelingInfo=[{labelExpressionInfo:{value:"{station_name}"},symbol:{type:"label-3d",symbolLayers:[{type:"text",material:{color:"white"},halo:{size:1,color:"red"},font:{family:"Ubuntu Mono",size:24,weight:"bold"},size:18}]},labelPlacement:"above-center",maxScale:0,minScale:0}],t.map.add(u)}class ee{constructor(e,r,n){t(this,"view",null),t(this,"externalRenderers",null),t(this,"jsonPoints",null),t(this,"startPoint",null),t(this,"offset",null),t(this,"fsbObjs",null),t(this,"parObjs",null),t(this,"cylider_uniforms",null),t(this,"camera",null),t(this,"scene",null),t(this,"sun",null),t(this,"ambient",null),t(this,"renderer",null),t(this,"particleSystems",null),t(this,"par_uniforms",null),t(this,"tx",null),this.view=e,this.externalRenderers=r,n=n||{},this.view=e,this.jsonPoints=n.jsonPoints||[],this.startPoint=n.startPoint||[],this.offset=0,this.fsbObjs=[],this.parObjs=[],this.cylider_uniforms=[]}setup(e){this.renderer=new w({context:e.gl,premultipliedAlpha:!1}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setViewport(0,0,this.view.width,this.view.height),this.renderer.autoClear=!1,this.renderer.autoClearDepth=!1,this.renderer.autoClearColor=!1;var t=this.renderer.setRenderTarget.bind(this.renderer);this.renderer.setRenderTarget=function(r){t(r),null==r&&e.bindRenderTarget()},this.scene=new b;var r=e.camera;this.camera=new x(r.fovY,r.aspect,r.near,r.far);const n=new _(1);n.position.copy(1e6,1e5,1e5),this.scene.add(n),this.ambient=new C(16777215,.5),this.scene.add(this.ambient),this.sun=new M(16777215,.5),this.sun.position.set(-600,300,6e4),this.scene.add(this.sun),this.clock=new S,this.getGeometry(e),e.resetWebGLState()}render(e){var t=e.camera;this.camera.position.set(t.eye[0],t.eye[1],t.eye[2]),this.camera.up.set(t.up[0],t.up[1],t.up[2]),this.camera.lookAt(new E(t.center[0],t.center[1],t.center[2])),this.camera.projectionMatrix.fromArray(t.projectionMatrix);var r=e.sunLight;this.sun.position.set(r.direction[0],r.direction[1],r.direction[2]),this.sun.intensity=r.diffuse.intensity,this.sun.color=new I(r.diffuse.color[0],r.diffuse.color[1],r.diffuse.color[2]),this.ambient.intensity=r.ambient.intensity,this.ambient.color=new I(r.ambient.color[0],r.ambient.color[1],r.ambient.color[2]),this.fsbObjs.forEach((e=>{e&&(e.rotation.z+=.03,e.scale.x>=0&&e.scale.x<=1.2?(e.scale.x+=.02,e.scale.y+=.02,e.scale.z+=.02):(e.scale.x=.01,e.scale.y=.01,e.scale.z=.01))})),this.renderer.state.reset(),this.renderer.render(this.scene,this.camera),this.externalRenderers.requestRender(this.view),e.resetWebGLState()}produceCanvasDm(e){const t=document.createElement("canvas");t.width=512,t.height=512;const r=t.getContext("2d"),n=r.createRadialGradient(256,256,0,256,256,256);return n.addColorStop(.1,`rgba(${e[0]}, ${e[1]}, ${e[2]}, 1.0)`),n.addColorStop(.2,`rgba(${e[0]}, ${e[1]}, ${e[2]}, 0.0)`),n.addColorStop(.3,`rgba(${e[0]}, ${e[1]}, ${e[2]}, 0.9)`),n.addColorStop(.5,`rgba(${e[0]}, ${e[1]}, ${e[2]}, 0.0)`),n.addColorStop(.9,`rgba(${e[0]}, ${e[1]}, ${e[2]}, 0.2)`),n.addColorStop(1,`rgba(${e[0]}, ${e[1]}, ${e[2]}, 1.0)`),r.clearRect(0,0,512,512),r.beginPath(),r.arc(256,256,256,0,2*Math.PI,!0),r.fillStyle=n,r.fill(),r.restore(),t}produceCanvasFsb(e){const t=document.createElement("canvas");t.width=512,t.height=512;const r=t.getContext("2d");return r.clearRect(0,0,512,512),r.strokeStyle=`rgb(${e[0]}, ${e[1]}, ${e[2]})`,r.setLineDash([80,80]),r.lineWidth=30,r.arc(256,256,241,0,2*Math.PI,!0),r.stroke(),t}produceCanvasLabel(){const e=document.createElement("canvas");e.width=256,e.height=256;const t=e.getContext("2d");t.clearRect(0,0,256,256);var r=new Image;return r.src="./billboard2.png",t.drawImage(r,0,0),e}getGeometry(e){this.jsonPoints.forEach((e=>{var t=[],r=e[0],n=e[1],a=e[2];this.externalRenderers.toRenderCoordinates(this.view,r,0,this.view.spatialReference,t,0,1);var i=new R(a[0],300,Math.PI,2*Math.PI),s=new P(i,new j({map:new $(this.produceCanvasDm(n)),opacity:1,transparent:!0}));s.position.set(t[0],t[1],t[2]),this.scene.add(s);var o=new P(i.clone(),new j({map:new $(this.produceCanvasFsb(n)),opacity:1,transparent:!0}));o.position.set(t[0],t[1],t[2]+100),this.scene.add(o),this.fsbObjs.push(o)}))}transparentObject(e,t){var r,n=new L;return(r=new P(e,t)).material.side=N,r.renderOrder=0,n.add(r),(r=new P(e,t.clone())).material.side=A,r.renderOrder=1,n.add(r),n}createOdLines(e){var t=[];this.externalRenderers.toRenderCoordinates(this.view,this.startPoint,0,this.view.spatialReference,t,0,1),this.jsonPoints;for(var r=0;r<this.jsonPoints.length;r++){var n=[];this.externalRenderers.toRenderCoordinates(this.view,this.jsonPoints[r][0],0,this.view.spatialReference,n,0,1),this.particleSystems.startParticles(new E(t[0],t[1],t[2]),new E(n[0],n[1],n[2]),2e4,15)}}createLabel(){var e=[];this.externalRenderers.toRenderCoordinates(this.view,this.startPoint,0,this.view.spatialReference,e,0,1);let t=(new T).load("images/billboard.png");var r=new D({map:t});let n=new z(r);n.position.set(e[0],e[1],e[2]+5e3),n.scale.set(1e4,5e3,1e4),this.scene.add(n)}getMaterial(e){var t={time:{value:1},u_image:{value:(new T).load("images/test-4.png")},u_color:{value:new I(`rgba(${e[0]}, ${e[1]}, ${e[2]}, ${e[3]})`)}};this.cylider_uniforms.push(t);let r=this.getShaderStr();return new F({uniforms:t,vertexShader:r.vs,fragmentShader:r.fs,side:void 0,transparent:!0})}getShaderStr(){let e={vs:"",fs:""};return e.vs="\n       varying vec2 v_st;\n       varying vec3 v_normalEC;\n       varying vec3 v_positionEC;\n       varying vec4 v_color;\n       void main()\n       {\n           v_st = uv;\n           v_normalEC=normal;\n           v_positionEC=position;\n           vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n           gl_Position = projectionMatrix * mvPosition;\n       }\n       ",e.fs="\n                varying vec3 v_positionEC;\n                varying vec3 v_normalEC;\n                varying vec2 v_st;\n                varying vec4 v_color;\n                uniform sampler2D u_image;\n                uniform vec3 u_color;\n                uniform float time;\n                void main()\n                {\n                    vec4 colora = texture2D(u_image,vec2(v_st.x,fract(v_st.y-time)));\n                    float alpha = colora.a;\n                    gl_FragColor = vec4(u_color, alpha);\n                }\n                ",e}getMaterial_par(e){this.par_uniforms={time:{value:1},u_image:{value:void 0},u_color:{value:new I(`rgba(${e[0]}, ${e[1]}, ${e[2]}, ${e[3]})`)}},this.tx=(new T).load("images/particles.png"),this.tx.wrapS=V,this.tx.wrapT=V,this.tx.repeat.x=4,this.tx.repeat.y=2,this.par_uniforms.u_image.value=this.tx;let t=this.getShaderStr_par();return new F({uniforms:this.par_uniforms,vertexShader:t.vs,fragmentShader:t.fs,side:void 0,opacity:1,transparent:!0,depthWrite:!1})}getShaderStr_par(){let e={vs:"",fs:""};return e.vs="\n           varying vec2 v_st;\n           varying vec3 v_normalEC;\n           varying vec3 v_positionEC;\n           void main()\n           {\n               v_st = uv;\n               v_normalEC=normal;\n               v_positionEC=position;\n               vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n               gl_Position = projectionMatrix * mvPosition;\n           }\n           ",e.fs="\n                    varying vec3 v_positionEC;\n                    varying vec3 v_normalEC;\n                    varying vec2 v_st;\n                    uniform sampler2D u_image;\n                    uniform vec3 u_color;\n                    void main()\n                    {\n                      vec4 mapColor=texture2D(u_image, v_st);\n                      gl_FragColor = vec4(u_color, mapColor.a);\n                    }\n                    ",e}getMaterial2(e){const t={scale:{type:"f",value:-1},bias:{type:"f",value:1},power:{type:"f",value:3.3},glowColor:{type:"c",value:new I(65535)},textureMap:{value:void 0},repeat:{type:"v2",value:new k(30,15)},time:{value:0}};let r=(new T).load("images/particles.png");r.wrapS=V,r.wrapT=V,r.repeat.x=2,t.textureMap.value=r;let n=this.getShaderStr2();return new F({uniforms:t,vertexShader:n.vs,fragmentShader:n.fs,side:void 0,transparent:!0})}getShaderStr2(){let e={vs:"",fs:""};return e.vs="\n      varying vec3 vNormal;\n      varying vec3 vPositionNormal;\n      varying vec2 vUv;\n      void main() \n      {\n          vUv = uv;\n          vNormal = normalize( normalMatrix * normal );\n          vPositionNormal = normalize(( modelViewMatrix * vec4(position, 1.0) ).xyz);\n          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n      }\n       ",e.fs="\n      uniform vec3 glowColor;\n      uniform float bias;\n      uniform float power;\n      uniform float scale;\n      varying vec3 vNormal;\n      varying vec3 vPositionNormal;\n      uniform sampler2D textureMap;\n      uniform vec2 repeat;\n      varying vec2 vUv;\n      uniform float time;\n      void main() \n      {\n          float a = pow( bias + scale * abs(dot(vNormal, vPositionNormal)), power );\n          vec4 mapColor=texture2D( textureMap, vUv*repeat);\n          gl_FragColor = vec4( glowColor*mapColor.rgb, a );\n      }\n      ",e}}async function te(e){const[t,r,n,a,i,s,o,l,c,u,p,d,m]=await g(["esri/Map","esri/views/SceneView","esri/layers/FeatureLayer","esri/core/reactiveUtils","esri/widgets/Expand","esri/Camera","esri/widgets/Home","esri/widgets/Fullscreen","esri/widgets/LayerList","esri/widgets/Legend","esri/views/3d/externalRenderers","esri/widgets/BasemapGallery","esri/geometry/SpatialReference"],{url:y.jsapiurl,css:y.jscssurl}),h=new t({basemap:"streets-night-vector",ground:{surfaceColor:"#021425"}}),f=new r({spatialReference:m.WebMercator,container:"viewDiv_demo_cors",map:h,viewingMode:"local"}),w=new d({view:f}),b=new i({view:f,content:w,expandIconClass:"esri-icon-basemap",expandTooltip:"LayerList",group:"top-left"});f.ui.add(b,"top-left");const x=new c({container:document.createElement("div"),id:"demo_cors_maplayerlist",view:f,listItemCreatedFunction:async function(e){e.item.actionsSections=[[{title:"Go to full extent",className:"esri-icon-zoom-out-fixed",id:"full-extent"}],[{title:"Increase opacity",className:"esri-icon-up",id:"increase-opacity"},{title:"Decrease opacity",className:"esri-icon-down",id:"decrease-opacity"}]]}});x.on("trigger-action",(e=>{const t=e.item.layer,r=e.action.id;"full-extent"===r?f.goTo(t.fullExtent):"increase-opacity"===r?t.opacity<1&&(t.opacity+=.25):"decrease-opacity"===r&&t.opacity>0&&(t.opacity-=.25)}));const _=new i({id:"demo_cors_maplayerlistExpand",view:f,content:x.domNode,expandIconClass:"esri-icon-layers",expandTooltip:"LayerList",group:"top-left"});f.ui.add(_,"top-left");const C=new s({fov:e.camera.fov,heading:e.camera.heading,position:{x:e.camera.position.x,y:e.camera.position.y,z:e.camera.position.z,spatialReference:{wkid:3857}},tilt:e.camera.tilt});a.once((()=>!0===(null==f?void 0:f.stationary))).then((()=>{f.goTo(C,e.cameraoptions).then((()=>{v().then((e=>{Q(e.Rows,f),async function(e,t){const[r,n,a,i]=await g(["esri/Graphic","esri/geometry/Polyline","esri/geometry/SpatialReference","esri/layers/FeatureLayer"]),s=[];e.map(((e,t)=>{s[t]=[Number(e.mapx),Number(e.mapy),e.is_ok]}));const o=H(s),l=[];for(let h=o.length;h;){const e=[];--h,e.push([s[o[h]][0],s[o[h]][1],s[o[h]][2]]),--h,e.push([s[o[h]][0],s[o[h]][1],s[o[h]][2]]),--h,e.push([s[o[h]][0],s[o[h]][1],s[o[h]][2]]),l.push(e)}const c=[],u="shanghaicorsLine",p=function(){const e={type:"unique-value",field:"status",uniqueValueInfos:[]};return["连接","中断"].map((t=>{const r={label:t,value:t,symbol:{type:"line-3d",symbolLayers:[{type:"line",size:2,material:{color:"连接"===t?"green":"red"},pattern:{type:"style",style:"solid"}}]}};e.uniqueValueInfos.push(r)})),e}();l.map((e=>{const t=[];t.push([e[0][0],e[0][1],10]),t.push([e[1][0],e[1][1],10]);const i=new n({hasZ:!0,hasM:!0,paths:[t],spatialReference:a.WebMercator});let s="连接";0!==e[0][2]&&0!==e[1][2]||(s="中断");const o=new r({geometry:i,attributes:{status:s}});c.push(o);const l=[];l.push([e[1][0],e[1][1],10]),l.push([e[2][0],e[2][1],10]);const u=new n({hasZ:!0,hasM:!0,paths:[l],spatialReference:a.WebMercator});let p="连接";0!==e[1][2]&&0!==e[2][2]||(p="中断");const d=new r({geometry:u,attributes:{status:p}});c.push(d);const m=[];m.push([e[2][0],e[2][1],10]),m.push([e[0][0],e[0][1],10]);const h=new n({hasZ:!0,hasM:!0,paths:[m],spatialReference:a.WebMercator});let v="连接";0!==e[2][2]&&0!==e[0][2]||(v="中断");const f=new r({geometry:h,attributes:{status:v}});c.push(f)}));const d=t.map.findLayerById(u);d&&t.map.remove(d);const m=new i({id:u,visible:!0,title:"上海基站三角网",objectIdField:"OBJECTID",geometryType:"polyline",renderer:p,labelsVisible:!1,elevationInfo:{mode:"relative-to-ground",offset:0},fields:[{name:"status",type:"string",alias:"基站状态"}],spatialReference:a.WebMercator});m.source=c,m.refresh(),m.labelingInfo=[{labelExpressionInfo:{value:"{status}"},symbol:{type:"label-3d",symbolLayers:[{type:"text",material:{color:"white"},halo:{size:1,color:"red"},font:{family:"Ubuntu Mono",size:24,weight:"bold"},size:18}]},labelPlacement:"above-center",maxScale:0,minScale:0}],t.map.add(m),t.goTo(c)}(e.Rows,f);const t=[];e.Rows.map((e=>{t.push([[e.mapx,e.mapy,10],[Math.floor(255*Math.random()),Math.floor(255*Math.random()),Math.floor(255*Math.random()),1],[8e3,5e3,1]])}));const r=new ee(f,p,{startPoint:[0,0,1e4],jsonPoints:t});p.add(f,r)}))}))})),a.on((()=>f),"click",(e=>{}))}const re={name:"map",components:{},setup(){const e=n();a();const t=i({});return s((async()=>{te(await f())})),o((()=>{})),l((()=>e.state.tagsViewRoutes.isTagsViewCurrenFull)),{...c(t)}}},ne={class:"home-container"},ae=[(e=>(d("data-v-72a110f0"),e=e(),m(),e))((()=>h("div",{id:"viewDiv_demo_cors"},null,-1)))];const ie=r(re,[["render",function(e,t,r,n,a,i){return p(),u("div",ne,ae)}],["__scopeId","data-v-72a110f0"]]);export{ie as default};
