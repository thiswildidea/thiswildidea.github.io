import{g as B,a as F,u as S}from"./table.1704797758166.js";import{l as z}from"./type.1704797758166.js";import G from"./basicInfoForm.1704797758166.js";import O from"./genInfoForm.1704797758166.js";import{_ as P,D as x,k as q,p as Q,r as m,f as w,w as o,H as E,o as b,h as e,a as y,e as T,b as c,t as p,F as U,g as $,i as L}from"./index.1704797758166.js";const K={name:"genEdit",components:{BasicInfoForm:G,GenInfoForm:O},setup(){const{proxy:r}=$(),_=x(),g=x(),d=q({isShowDialog:!1,activeName:"cloum",columns:[],tableTree:[],dictOptions:[],info:{}}),k=n=>{n.tableId&&(B(n.tableId).then(i=>{let s=i.data.list.filter(v=>!["create_time","update_time","delete_time"].includes(v.columnName));d.columns=s,d.info=i.data.info,d.info.columns=d.columns,console.log(d),d.isShowDialog=!0}),z({pageNum:1,pageSize:100}).then(i=>{d.dictOptions=i.data.data,console.log(d.dictOptions)}),F().then(i=>{d.tableTree=i.data,d.tableTree.unshift({tableId:0,className:"\u8BF7\u9009\u62E9"})}))},I=()=>{console.log(g.value);const n=g.value.basicInfoForm,i=_.value.genInfoFormRef;Promise.all([n,i].map(u)).then(s=>{if(s.every(f=>!!f)){const f=Object.assign({},n.model,i.model);console.log(d.columns),f.columns=d.columns,f.params={treeCode:f.treeCode,treeName:f.treeName,treeParentCode:f.treeParentCode},S(f).then(C=>{E.success("\u4FEE\u6539\u6210\u529F"),V()})}else E.error("\u8868\u5355\u6821\u9A8C\u672A\u901A\u8FC7\uFF0C\u8BF7\u91CD\u65B0\u68C0\u67E5\u63D0\u4EA4\u5185\u5BB9")})},N=()=>{F().then(n=>{d.tableTree=n.data,d.tableTree.unshift({tableId:0,className:"\u8BF7\u9009\u62E9"})})},h=n=>d.tableTree.filter(function(i){if(i.tableName===n)return i.columns}),u=n=>new Promise(i=>{n.validate(s=>{i(s)})}),V=n=>{r.mittBus.emit("onEditTableModule",n),d.isShowDialog=!1};return{genInfoRef:_,basicInfoRef:g,openDialog:k,closeDialog:V,getTablesCol:h,getTables:N,submitForm:I,getFormPromise:u,handleChangeConfig:(n,i)=>{d.tableTree.filter(function(s){s.tableName===n.fkTableName&&(n.fkCol=s.columns)})},...Q(d)}}},M={style:{float:"left"}},H={style:{float:"right",color:"#8492a6","font-size":"13px"}},A={style:{float:"left"}},J={style:{float:"right",color:"#8492a6","font-size":"13px"}},W={style:{float:"left"}},X={style:{float:"right",color:"#8492a6","font-size":"13px"}},Y={style:{float:"left"}},Z={style:{float:"right",color:"#8492a6","font-size":"13px"}},ee=L("\u63D0\u4EA4"),le=L("\u8FD4\u56DE");function ae(r,_,g,d,k,I){const N=m("BasicInfoForm"),h=m("el-tab-pane"),u=m("el-table-column"),V=m("el-input"),t=m("el-option"),n=m("el-select"),i=m("el-checkbox"),s=m("el-table"),v=m("GenInfoForm"),f=m("el-tabs"),C=m("el-button"),D=m("el-form-item"),R=m("el-form"),j=m("el-dialog");return b(),w(j,{modelValue:r.isShowDialog,"onUpdate:modelValue":_[1]||(_[1]=a=>r.isShowDialog=a),title:"\u7F16\u8F91\u8868\u7ED3\u6784",width:"90%",center:""},{default:o(()=>[e(f,{modelValue:r.activeName,"onUpdate:modelValue":_[0]||(_[0]=a=>r.activeName=a)},{default:o(()=>[e(h,{label:"\u57FA\u672C\u4FE1\u606F",name:"basic"},{default:o(()=>[e(N,{ref:"basicInfoRef",info:r.info},null,8,["info"])]),_:1}),e(h,{label:"\u5B57\u6BB5\u4FE1\u606F",name:"cloum"},{default:o(()=>[e(s,{ref:"dragTable",data:r.columns,"row-key":"columnId",height:"450px"},{default:o(()=>[e(u,{label:"\u5E8F\u53F7",type:"index",width:"50"}),e(u,{label:"\u5B57\u6BB5\u5217\u540D",prop:"columnName",width:"150","show-overflow-tooltip":!0}),e(u,{fixed:"",label:"\u5B57\u6BB5\u63CF\u8FF0",width:"150"},{default:o(a=>[e(V,{modelValue:a.row.columnComment,"onUpdate:modelValue":l=>a.row.columnComment=l},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(u,{label:"\u7269\u7406\u7C7B\u578B",prop:"columnType",width:"120","show-overflow-tooltip":!0}),e(u,{label:"go\u7C7B\u578B",width:"120"},{default:o(a=>[e(n,{modelValue:a.row.goType,"onUpdate:modelValue":l=>a.row.goType=l},{default:o(()=>[e(t,{label:"int",value:"int"}),e(t,{label:"uint",value:"uint"}),e(t,{label:"int64",value:"int64"}),e(t,{label:"uint64",value:"uint64"}),e(t,{label:"float64",value:"float64"}),e(t,{label:"string",value:"string"}),e(t,{label:"Time",value:"Time"}),e(t,{label:"byte",value:"byte"})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1}),e(u,{label:"go\u5C5E\u6027",width:"150"},{default:o(a=>[e(V,{modelValue:a.row.goField,"onUpdate:modelValue":l=>a.row.goField=l},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(u,{label:"json\u5C5E\u6027",width:"150"},{default:o(a=>[e(V,{modelValue:a.row.jsonField,"onUpdate:modelValue":l=>a.row.jsonField=l},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(u,{label:"\u63D2\u5165",width:"50"},{default:o(a=>[e(i,{modelValue:a.row.isInsert,"onUpdate:modelValue":l=>a.row.isInsert=l,"true-label":"1","false-label":"0"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(u,{label:"\u7F16\u8F91",width:"70","cell-style":{"text-align":"center"}},{default:o(a=>[e(i,{modelValue:a.row.isEdit,"onUpdate:modelValue":l=>a.row.isEdit=l,"true-label":"1","false-label":"0"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(u,{label:"\u5217\u8868",width:"70","cell-style":{"text-align":"center"}},{default:o(a=>[e(i,{modelValue:a.row.isList,"onUpdate:modelValue":l=>a.row.isList=l,"true-label":"1","false-label":"0"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(u,{label:"\u67E5\u8BE2",width:"70","cell-style":{"text-align":"center"}},{default:o(a=>[e(i,{modelValue:a.row.isQuery,"onUpdate:modelValue":l=>a.row.isQuery=l,"true-label":"1","false-label":"0"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(u,{label:"\u5FC5\u586B",width:"50"},{default:o(a=>[e(i,{modelValue:a.row.isRequired,"onUpdate:modelValue":l=>a.row.isRequired=l,"true-label":"1","false-label":"0"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(u,{label:"\u67E5\u8BE2\u65B9\u5F0F",width:"120"},{default:o(a=>[e(n,{modelValue:a.row.queryType,"onUpdate:modelValue":l=>a.row.queryType=l},{default:o(()=>[e(t,{label:"=",value:"EQ"}),e(t,{label:"!=",value:"NE"}),e(t,{label:">",value:"GT"}),e(t,{label:">=",value:"GTE"}),e(t,{label:"<",value:"LT"}),e(t,{label:"<=",value:"LTE"}),e(t,{label:"LIKE",value:"LIKE"})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1}),e(u,{label:"\u663E\u793A\u7C7B\u578B",width:"140"},{default:o(a=>[e(n,{modelValue:a.row.htmlType,"onUpdate:modelValue":l=>a.row.htmlType=l},{default:o(()=>[e(t,{label:"\u6587\u672C\u6846",value:"input"}),e(t,{label:"\u4E0B\u62C9\u6846",value:"select"}),e(t,{label:"\u5355\u9009\u6846",value:"radio"}),e(t,{label:"\u6587\u4EF6\u9009\u62E9",value:"file"}),e(t,{label:"\u6587\u672C\u57DF",value:"textarea"}),e(t,{label:"\u65E5\u671F\u63A7\u4EF6",value:"datetime"})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1}),e(u,{label:"\u5B57\u5178\u7C7B\u578B",width:"160"},{default:o(a=>[e(n,{modelValue:a.row.dictType,"onUpdate:modelValue":l=>a.row.dictType=l,clearable:"",filterable:"",placeholder:"\u8BF7\u9009\u62E9"},{default:o(()=>[(b(!0),y(U,null,T(r.dictOptions,l=>(b(),w(t,{key:l.dictType,label:l.dictName,value:l.dictType},{default:o(()=>[c("span",M,p(l.dictName),1),c("span",H,p(l.dictType),1)]),_:2},1032,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1}),e(u,{label:"\u5173\u7CFB\u8868",width:"160"},{default:o(a=>[e(n,{modelValue:a.row.linkTableName,"onUpdate:modelValue":l=>a.row.linkTableName=l,clearable:"",filterable:"",placeholder:"\u8BF7\u9009\u62E9",onChange:l=>d.handleChangeConfig(a.row,a.$index)},{default:o(()=>[(b(!0),y(U,null,T(r.tableTree,l=>(b(),w(t,{key:l.tableName,label:l.tableName,value:l.tableName},{default:o(()=>[c("span",A,p(l.tableName),1),c("span",J,p(l.tableComment),1)]),_:2},1032,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(u,{label:"\u5173\u7CFB\u8868key",width:"150"},{default:o(a=>[e(n,{modelValue:a.row.linkLabelId,"onUpdate:modelValue":l=>a.row.linkLabelId=l,clearable:"",filterable:"",placeholder:"\u8BF7\u9009\u62E9"},{default:o(()=>[(b(!0),y(U,null,T(a.row.fkCol,l=>(b(),w(t,{key:l.columnName,label:l.columnName,value:l.jsonField},{default:o(()=>[c("span",W,p(l.jsonField),1),c("span",X,p(l.columnComment),1)]),_:2},1032,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1}),e(u,{label:"\u5173\u7CFB\u8868value",width:"150"},{default:o(a=>[e(n,{modelValue:a.row.linkLabelName,"onUpdate:modelValue":l=>a.row.linkLabelName=l,clearable:"",filterable:"",placeholder:"\u8BF7\u9009\u62E9"},{default:o(()=>[(b(!0),y(U,null,T(a.row.fkCol,l=>(b(),w(t,{key:l.columnName,label:l.columnName,value:l.jsonField},{default:o(()=>[c("span",Y,p(l.jsonField),1),c("span",Z,p(l.columnComment),1)]),_:2},1032,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["data"])]),_:1}),e(h,{label:"\u751F\u6210\u4FE1\u606F",name:"genInfo"},{default:o(()=>[e(v,{ref:"genInfoRef",info:r.info},null,8,["info"])]),_:1})]),_:1},8,["modelValue"]),e(R,{"label-width":"100px"},{default:o(()=>[e(D,{style:{"text-align":"center","margin-left":"-100px","margin-top":"10px"}},{default:o(()=>[e(C,{type:"primary",onClick:d.submitForm},{default:o(()=>[ee]),_:1},8,["onClick"]),e(C,{onClick:d.closeDialog},{default:o(()=>[le]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}const ie=P(K,[["render",ae]]);export{ie as default};
