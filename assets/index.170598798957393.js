import{at as e,_ as a,k as l,m as o,p as r,r as n,Q as t,a as i,h as s,w as u,v as d,f as p,x as m,b as g,I as c,H as h,o as y,au as f,t as w,i as b}from"./index.1705987989573.js";const C={name:"onlineuser",setup(){const a=l({total:0,loading:!0,onlineList:[],queryParams:{pageNum:1,pageSize:10,ipaddr:void 0,userName:void 0}}),n=()=>{var l;a.loading=!0,(l=a.queryParams,e({url:"/monitor/online/list",method:"get",params:l})).then((e=>{a.onlineList=e.rows,a.total=e.total,a.loading=!1}))},t=()=>{n()};return o((()=>{n()})),{handleCurrentChange:e=>{a.queryParams.pageNum=e,t()},handleSizeChange:e=>{a.queryParams.pageSize=e,t()},handleForceLogout:a=>{c({message:'是否确认强退名称为"'+a.userName+'"的用户?',title:"警告",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(){return l=a.tokenId,e({url:"/monitor/online/"+l,method:"delete"});var l})).then((()=>{n(),h.success("强退成功")}))},handleQuery:t,resetQuery:()=>{a.queryParams.pageNum=1,a.queryParams.pageSize=10,a.queryParams.ipaddr="",a.queryParams.userName="",t()},getList:n,...r(a)}}},q={class:"app-container"},P=b("搜索"),v=b("重置"),z=b("强退");const N=a(C,[["render",function(e,a,l,o,r,c){const h=n("el-input"),b=n("el-form-item"),C=n("el-button"),N=n("el-form"),_=n("el-table-column"),x=n("el-table"),k=n("el-divider"),S=n("el-pagination"),L=t("auth"),Q=t("loading");return y(),i("div",q,[s(N,{model:e.queryParams,ref:"queryRef",inline:!0,"label-width":"68px"},{default:u((()=>[s(b,{label:"登录地址",prop:"ipaddr"},{default:u((()=>[s(h,{modelValue:e.queryParams.ipaddr,"onUpdate:modelValue":a[0]||(a[0]=a=>e.queryParams.ipaddr=a),placeholder:"请输入登录地址",clearable:"",size:"small",onKeyup:f(o.handleQuery,["enter"])},null,8,["modelValue","onKeyup"])])),_:1}),s(b,{label:"用户名称",prop:"userName"},{default:u((()=>[s(h,{modelValue:e.queryParams.userName,"onUpdate:modelValue":a[1]||(a[1]=a=>e.queryParams.userName=a),placeholder:"请输入用户名称",clearable:"",onKeyup:f(o.handleQuery,["enter"])},null,8,["modelValue","onKeyup"])])),_:1}),s(b,null,{default:u((()=>[s(C,{type:"primary",icon:"Search",size:"mini",onClick:o.handleQuery},{default:u((()=>[P])),_:1},8,["onClick"]),s(C,{icon:"Refresh",size:"mini",onClick:o.resetQuery},{default:u((()=>[v])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model"]),d((y(),p(x,{data:e.onlineList,style:{width:"100%"}},{default:u((()=>[s(_,{label:"序号",type:"index",align:"center"},{default:u((a=>[g("span",null,w((e.queryParams.pageNum-1)*e.queryParams.pageSize+a.$index+1),1)])),_:1}),s(_,{label:"会话编号",align:"center",prop:"tokenId","show-overflow-tooltip":!0}),s(_,{label:"登录名称",align:"center",prop:"userName","show-overflow-tooltip":!0}),s(_,{label:"所属部门",align:"center",prop:"deptName","show-overflow-tooltip":!0}),s(_,{label:"主机",align:"center",prop:"ipaddr","show-overflow-tooltip":!0}),s(_,{label:"登录地点",align:"center",prop:"loginLocation","show-overflow-tooltip":!0}),s(_,{label:"操作系统",align:"center",prop:"os","show-overflow-tooltip":!0}),s(_,{label:"浏览器",align:"center",prop:"browser","show-overflow-tooltip":!0}),s(_,{label:"登录时间",align:"center",prop:"loginTime",width:"180"},{default:u((a=>[g("span",null,w(e.parseTime(a.row.loginTime)),1)])),_:1}),s(_,{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:u((e=>[d((y(),p(C,{size:"mini",type:"text",icon:"Delete",onClick:a=>o.handleForceLogout(e.row)},{default:u((()=>[z])),_:2},1032,["onClick"])),[[L,"monitor:online:forceLogout"]])])),_:1})])),_:1},8,["data"])),[[Q,e.loading]]),d(g("div",null,[s(k),s(S,{background:"",total:e.total,"current-page":e.queryParams.pageNum,"page-size":e.queryParams.pageSize,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:o.handleSizeChange,onCurrentChange:o.handleCurrentChange},null,8,["total","current-page","page-size","onSizeChange","onCurrentChange"])],512),[[m,e.total>0]])])}]]);export{N as default};
