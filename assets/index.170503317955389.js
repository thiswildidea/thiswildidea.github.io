import{_ as e,D as a,k as l,m as t,M as n,p as o,r as i,Q as d,a as r,h as s,w as u,g as p,I as m,H as c,o as h,au as y,F as g,e as f,f as b,v as C,i as w,t as _,y as q,x as v,b as z}from"./index.1705033179553.js";import{E as P,l as k,d as x}from"./editModule.17050331795532.js";const V={name:"index",components:{EditModule:P},setup(){const{proxy:e}=p(),i=a(),d=l({loading:!0,ids:[],single:!0,multiple:!0,title:"",tableData:[],total:0,methodOptions:[],queryParams:{pageNum:1,pageSize:10,path:void 0,description:void 0,method:void 0,apiGroup:void 0}}),r=()=>{d.loading=!0,k(d.queryParams).then((e=>{d.tableData=e.data.data,d.total=e.data.total,d.loading=!1}))};return t((()=>{r(),e.getDicts("sys_method_api").then((e=>{d.methodOptions=e.data})),e.mittBus.on("onEditApiModule",(e=>{r()}))})),n((()=>{e.mittBus.off("onEditApiModule")})),{editModuleRef:i,handleSelectionChange:e=>{d.ids=e.map((e=>e.id)),d.single=1!=e.length,d.multiple=!e.length},handleSizeChange:e=>{d.queryParams.pageSize=e,r()},handleCurrentChange:e=>{d.queryParams.pageNum=e,r()},handleQuery:r,resetQuery:()=>{d.queryParams.path=void 0,d.queryParams.description=void 0,d.queryParams.method=void 0,d.queryParams.apiGroup=void 0,r()},onOpenAddModule:e=>{e=[],d.title="添加Api参数",i.value.openDialog(e)},onOpenEditModule:e=>{d.title="修改Api参数",i.value.openDialog(e)},onTabelRowDel:e=>{const a=e.id||d.ids;m({message:'是否确认删除配置参数编号为"'+a+'"的数据项?',title:"警告",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return x(a).then((()=>{r(),c.success("删除成功")}))}))},...o(d)}}},S={class:"app-container"},D=w(" 搜索"),M=w(" 重置 "),E=w("新增"),Q=w("删除"),A=w("修改"),O=w("删除");const G=e(V,[["render",function(e,a,l,t,n,o){const p=i("el-input"),m=i("el-form-item"),c=i("el-option"),P=i("el-select"),k=i("SvgIcon"),x=i("el-button"),V=i("el-form"),G=i("el-col"),K=i("el-row"),R=i("el-table-column"),B=i("el-tag"),T=i("el-table"),U=i("el-divider"),j=i("el-pagination"),I=i("el-card"),N=i("EditModule"),F=d("auth"),H=d("loading");return h(),r("div",S,[s(I,{shadow:"always"},{default:u((()=>[s(V,{model:e.queryParams,ref:"queryForm",inline:!0},{default:u((()=>[s(m,{label:"路径",prop:"path"},{default:u((()=>[s(p,{placeholder:"Api路径模糊查询",clearable:"",size:"small",onKeyup:y(t.handleQuery,["enter"]),style:{width:"240px"},modelValue:e.queryParams.path,"onUpdate:modelValue":a[0]||(a[0]=a=>e.queryParams.path=a)},null,8,["onKeyup","modelValue"])])),_:1}),s(m,{label:"描述",prop:"description"},{default:u((()=>[s(p,{placeholder:"描述模糊查询",clearable:"",size:"small",onKeyup:y(t.handleQuery,["enter"]),style:{width:"240px"},modelValue:e.queryParams.description,"onUpdate:modelValue":a[1]||(a[1]=a=>e.queryParams.description=a)},null,8,["onKeyup","modelValue"])])),_:1}),s(m,{label:"分组",prop:"apiGroup"},{default:u((()=>[s(p,{placeholder:"分组查询",clearable:"",size:"small",onKeyup:y(t.handleQuery,["enter"]),style:{width:"240px"},modelValue:e.queryParams.apiGroup,"onUpdate:modelValue":a[2]||(a[2]=a=>e.queryParams.apiGroup=a)},null,8,["onKeyup","modelValue"])])),_:1}),s(m,{label:"方法",prop:"method"},{default:u((()=>[s(P,{modelValue:e.queryParams.method,"onUpdate:modelValue":a[3]||(a[3]=a=>e.queryParams.method=a),placeholder:"方法",clearable:"",size:"small",style:{width:"240px"}},{default:u((()=>[(h(!0),r(g,null,f(e.methodOptions,(e=>(h(),b(c,{key:e.dictValue,label:e.dictLabel,value:e.dictValue},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),s(m,null,{default:u((()=>[s(x,{type:"primary",size:"mini",onClick:t.handleQuery},{default:u((()=>[s(k,{name:"elementSearch"}),D])),_:1},8,["onClick"]),s(x,{size:"mini",onClick:t.resetQuery},{default:u((()=>[s(k,{name:"elementRefresh"}),M])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model"]),s(K,{gutter:10,class:"mb8"},{default:u((()=>[s(G,{span:1.5},{default:u((()=>[C((h(),b(x,{type:"primary",plain:"",size:"mini",onClick:t.onOpenAddModule},{default:u((()=>[s(k,{name:"elementPlus"}),E])),_:1},8,["onClick"])),[[F,"system:api:add"]])])),_:1},8,["span"]),s(G,{span:1.5},{default:u((()=>[C((h(),b(x,{type:"danger",plain:"",size:"mini",disabled:e.multiple,onClick:t.onTabelRowDel},{default:u((()=>[s(k,{name:"elementDelete"}),Q])),_:1},8,["disabled","onClick"])),[[F,"system:api:delete"]])])),_:1},8,["span"])])),_:1}),C((h(),b(T,{data:e.tableData,onSelectionChange:t.handleSelectionChange},{default:u((()=>[s(R,{type:"selection",width:"55",align:"center"}),s(R,{label:"id",align:"center",prop:"id"}),s(R,{label:"路径",align:"center",prop:"path","show-overflow-tooltip":!0}),s(R,{label:"分组",align:"center",prop:"apiGroup"}),s(R,{label:"简介",align:"center",prop:"description"}),s(R,{label:"请求",align:"center",prop:"method","show-overflow-tooltip":!0},{default:u((e=>[s(B,{type:"success"},{default:u((()=>[w(_(e.row.method),1)])),_:2},1024)])),_:1}),s(R,{label:"操作",align:"center",width:"200","class-name":"medium-padding fixed-width"},{default:u((e=>[C((h(),b(x,{size:"mini",type:"text",onClick:a=>t.onOpenEditModule(e.row)},{default:u((()=>[s(k,{name:"elementEdit"}),A])),_:2},1032,["onClick"])),[[F,"system:api:edit"]]),0!=e.row.parentId?C((h(),b(x,{key:0,size:"mini",type:"text",onClick:a=>t.onTabelRowDel(e.row)},{default:u((()=>[s(k,{name:"elementDelete"}),O])),_:2},1032,["onClick"])),[[F,"system:api:delete"]]):q("",!0)])),_:1})])),_:1},8,["data","onSelectionChange"])),[[H,e.loading]]),C(z("div",null,[s(U),s(j,{background:"",total:e.total,"current-page":e.queryParams.pageNum,"page-size":e.queryParams.pageSize,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:t.handleSizeChange,onCurrentChange:t.handleCurrentChange},null,8,["total","current-page","page-size","onSizeChange","onCurrentChange"])],512),[[v,e.total>0]])])),_:1}),s(N,{ref:"editModuleRef",title:e.title},null,8,["title"])])}]]);export{G as default};
