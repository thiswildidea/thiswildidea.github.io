import{t as N}from"./dept.1704798071520.js";import{b as w,a as S,c as x,d as M}from"./user.1704798071520.js";import{_ as R,D as z,k as L,p as q,r as m,U as P,a as f,h as o,w as s,ax as T,H as I,o as p,v as G,i as E,t as k,b as H,f as g,y as h,F as V,e as B,g as J}from"./index.1704798071520.js";const $={name:"editUser",props:{title:{type:String,default:()=>""}},setup(){const{proxy:u}=J(),r=z(null),l=L({isShowDialog:!1,sexOptions:[],roleOptions:[],statusOptions:[],deptOptions:[],postOptions:[],ruleForm:{userId:void 0,userName:"",nickName:"",deptId:"",roleId:"",postId:"",phonenumber:"",email:"",status:"",password:"",avatar:"",sex:"",remark:"",postIds:[],roleIds:[]},postIds:[],roleIds:[],isHideOptions:[],menuTypeOptions:[],yesOrNoOptions:[],menuOptions:[],ruleRules:{username:[{required:!0,message:"\u7528\u6237\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],nickName:[{required:!0,message:"\u7528\u6237\u6635\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],password:[{required:!0,message:"\u7528\u6237\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],email:[{type:"email",message:"'\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u90AE\u7BB1\u5730\u5740",trigger:["blur","change"]}],phone:[{pattern:/^1[3|4|5|6|7|8|9][0-9]\d{8}$/,message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u624B\u673A\u53F7\u7801",trigger:"blur"}]}}),b=a=>{a&&a.userId&&a.userId!=null&&a.userId!=0?w(a.userId).then(t=>{l.ruleForm=t.data,l.postOptions=t.posts,l.roleOptions=t.roles,l.postIds=t.postIds.map(i=>Number(i)),l.roleIds=t.roleIds.map(i=>Number(i)),l.ruleForm.password=""}):d(),F(),l.isShowDialog=!0,u.getDicts("sys_user_sex").then(t=>{l.sexOptions=t.data}),u.getDicts("sys_normal_disable").then(t=>{l.statusOptions=t.data})},_=a=>{u.mittBus.emit("onEditUserModule",a),l.isShowDialog=!1},v=()=>{_(),d()},F=async()=>{N().then(a=>{l.deptOptions=a.data})},n=()=>{const a=T(r);!a||a.validate(t=>{t&&(l.ruleForm.postId=l.postIds[0],l.ruleForm.roleId=l.roleIds[0],l.ruleForm.postIds=l.postIds,l.ruleForm.roleIds=l.roleIds,l.ruleForm.userId!=null?S(l.ruleForm).then(i=>{I.success("\u4FEE\u6539\u6210\u529F"),_()}):x(l.ruleForm).then(i=>{I.success("\u65B0\u589E\u6210\u529F"),_()}))})},d=()=>{M().then(a=>{l.postOptions=a.data.posts,l.roleOptions=a.data.roles}),l.ruleForm.userId=void 0,l.ruleForm.username="",l.ruleForm.nickName="",l.ruleForm.deptId="",l.ruleForm.phone="",l.ruleForm.email="",l.ruleForm.status="",l.ruleForm.password="",l.ruleForm.avatar="",l.ruleForm.sex="",l.ruleForm.remark="",l.ruleForm.postIds="",l.ruleForm.roleIds=""};return{ruleFormRef:r,openDialog:b,closeDialog:_,onCancel:v,onSubmit:n,beforeAvatarUpload:a=>{const t=a.type==="image/jpeg",i=a.size/1024/1024<2;return t||I.error("\u4E0A\u4F20\u5934\u50CF\u56FE\u7247\u53EA\u80FD\u662F JPG \u683C\u5F0F!"),i||I.error("\u4E0A\u4F20\u5934\u50CF\u56FE\u7247\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC7 2MB!"),t&&i},handleAvatarSuccess:a=>{},...q(l)}}},j={class:"system-menu-container"},W={style:{"font-size":"large"}},K={class:"dialog-footer"},Q=E("\u53D6 \u6D88"),X=E("\u7F16 \u8F91");function Y(u,r,l,b,_,v){const F=m("el-input"),n=m("el-form-item"),d=m("el-col"),D=m("el-cascader"),c=m("el-option"),a=m("el-select"),t=m("el-radio"),i=m("el-radio-group"),A=m("el-row"),C=m("el-form"),y=m("el-button"),O=m("el-dialog"),U=P("drag");return p(),f("div",j,[o(O,{modelValue:u.isShowDialog,"onUpdate:modelValue":r[11]||(r[11]=e=>u.isShowDialog=e),width:"769px"},{title:s(()=>[G((p(),f("div",W,[E(k(l.title),1)])),[[U,[".system-menu-container .el-dialog",".system-menu-container .el-dialog__header"]]])]),footer:s(()=>[H("span",K,[o(y,{onClick:b.onCancel,size:"small"},{default:s(()=>[Q]),_:1},8,["onClick"]),o(y,{type:"primary",onClick:b.onSubmit,size:"small"},{default:s(()=>[X]),_:1},8,["onClick"])])]),default:s(()=>[o(C,{ref:"ruleFormRef",model:u.ruleForm,rules:u.ruleRules,"label-width":"80px"},{default:s(()=>[o(A,{gutter:35},{default:s(()=>[o(d,{xs:24,sm:12,md:12,lg:12,xl:12},{default:s(()=>[o(n,{label:"\u7528\u6237\u6635\u79F0",prop:"nickName"},{default:s(()=>[o(F,{modelValue:u.ruleForm.nickName,"onUpdate:modelValue":r[0]||(r[0]=e=>u.ruleForm.nickName=e),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u6635\u79F0"},null,8,["modelValue"])]),_:1})]),_:1}),o(d,{xs:24,sm:12,md:12,lg:12,xl:12},{default:s(()=>[o(n,{label:"\u5F52\u5C5E\u90E8\u95E8",prop:"deptId"},{default:s(()=>[o(D,{modelValue:u.ruleForm.deptId,"onUpdate:modelValue":r[1]||(r[1]=e=>u.ruleForm.deptId=e),options:u.deptOptions,props:{label:"label",value:"id",checkStrictly:!0,emitPath:!1},class:"w100",clearable:"",filterable:"",placeholder:"\u8BF7\u9009\u62E9\u5F52\u5C5E\u90E8\u95E8","show-all-levels":!1},null,8,["modelValue","options"])]),_:1})]),_:1}),o(d,{xs:24,sm:12,md:12,lg:12,xl:12},{default:s(()=>[u.ruleForm.userId==null?(p(),g(n,{key:0,label:"\u7528\u6237\u540D\u79F0",prop:"userName"},{default:s(()=>[o(F,{modelValue:u.ruleForm.userName,"onUpdate:modelValue":r[2]||(r[2]=e=>u.ruleForm.userName=e),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D\u79F0"},null,8,["modelValue"])]),_:1})):h("",!0)]),_:1}),o(d,{xs:24,sm:12,md:12,lg:12,xl:12},{default:s(()=>[u.ruleForm.userId==null?(p(),g(n,{key:0,label:"\u7528\u6237\u5BC6\u7801",prop:"password"},{default:s(()=>[o(F,{modelValue:u.ruleForm.password,"onUpdate:modelValue":r[3]||(r[3]=e=>u.ruleForm.password=e),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u5BC6\u7801",type:"password"},null,8,["modelValue"])]),_:1})):h("",!0)]),_:1}),o(d,{xs:24,sm:12,md:12,lg:12,xl:12},{default:s(()=>[o(n,{label:"\u624B\u673A\u53F7\u7801",prop:"phonenumber"},{default:s(()=>[o(F,{modelValue:u.ruleForm.phonenumber,"onUpdate:modelValue":r[4]||(r[4]=e=>u.ruleForm.phonenumber=e),placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\u7801",maxlength:"11"},null,8,["modelValue"])]),_:1})]),_:1}),o(d,{xs:24,sm:12,md:12,lg:12,xl:12},{default:s(()=>[o(n,{label:"\u90AE\u7BB1",prop:"email"},{default:s(()=>[o(F,{modelValue:u.ruleForm.email,"onUpdate:modelValue":r[5]||(r[5]=e=>u.ruleForm.email=e),placeholder:"\u8BF7\u8F93\u5165\u90AE\u7BB1",maxlength:"50"},null,8,["modelValue"])]),_:1})]),_:1}),o(d,{xs:24,sm:12,md:12,lg:12,xl:12},{default:s(()=>[o(n,{label:"\u7528\u6237\u6027\u522B",prop:"sex"},{default:s(()=>[o(a,{modelValue:u.ruleForm.sex,"onUpdate:modelValue":r[6]||(r[6]=e=>u.ruleForm.sex=e),placeholder:"\u8BF7\u9009\u62E9"},{default:s(()=>[(p(!0),f(V,null,B(u.sexOptions,e=>(p(),g(c,{key:e.dictValue,label:e.dictLabel,value:e.dictValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),o(d,{xs:24,sm:12,md:12,lg:12,xl:12},{default:s(()=>[o(n,{label:"\u72B6\u6001"},{default:s(()=>[o(i,{modelValue:u.ruleForm.status,"onUpdate:modelValue":r[7]||(r[7]=e=>u.ruleForm.status=e)},{default:s(()=>[(p(!0),f(V,null,B(u.statusOptions,e=>(p(),g(t,{key:e.dictValue,label:e.dictValue},{default:s(()=>[E(k(e.dictLabel),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),o(d,{xs:24,sm:12,md:12,lg:12,xl:12},{default:s(()=>[o(n,{label:"\u5C97\u4F4D"},{default:s(()=>[o(a,{modelValue:u.postIds,"onUpdate:modelValue":r[8]||(r[8]=e=>u.postIds=e),multiple:"","collapse-tags":"true",placeholder:"\u8BF7\u9009\u62E9"},{default:s(()=>[(p(!0),f(V,null,B(u.postOptions,e=>(p(),g(c,{key:e.postId,label:e.postName,value:e.postId,disabled:e.status==1},null,8,["label","value","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),o(d,{xs:24,sm:12,md:12,lg:12,xl:12},{default:s(()=>[o(n,{label:"\u89D2\u8272"},{default:s(()=>[o(a,{modelValue:u.roleIds,"onUpdate:modelValue":r[9]||(r[9]=e=>u.roleIds=e),multiple:"","collapse-tags":"true",placeholder:"\u8BF7\u9009\u62E9"},{default:s(()=>[(p(!0),f(V,null,B(u.roleOptions,e=>(p(),g(c,{key:e.roleId,label:e.roleName,value:e.roleId,disabled:e.status==1},null,8,["label","value","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),o(d,{xs:24,sm:24,md:24,lg:24,xl:24},{default:s(()=>[o(n,{label:"\u5907\u6CE8"},{default:s(()=>[o(F,{modelValue:u.ruleForm.remark,"onUpdate:modelValue":r[10]||(r[10]=e=>u.ruleForm.remark=e),type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}const ue=R($,[["render",Y],["__scopeId","data-v-27aa3d0c"]]);export{ue as default};
