import{t as e}from"./dept.1705207398734.js";import{b as l,a,c as o,d as s}from"./user.1705207398734.js";import{_ as r,D as t,k as d,p as u,r as m,Q as p,a as n,h as i,w as c,ay as g,H as f,o as b,v as F,i as I,t as _,b as V,f as h,y as x,F as y,e as k,g as O}from"./index.1705207398734.js";const v={name:"editUser",props:{title:{type:String,default:()=>""}},setup(){const{proxy:r}=O(),m=t(null),p=d({isShowDialog:!1,sexOptions:[],roleOptions:[],statusOptions:[],deptOptions:[],postOptions:[],ruleForm:{userId:void 0,userName:"",nickName:"",deptId:"",roleId:"",postId:"",phonenumber:"",email:"",status:"",password:"",avatar:"",sex:"",remark:"",postIds:[],roleIds:[]},postIds:[],roleIds:[],isHideOptions:[],menuTypeOptions:[],yesOrNoOptions:[],menuOptions:[],ruleRules:{username:[{required:!0,message:"用户名称不能为空",trigger:"blur"}],nickName:[{required:!0,message:"用户昵称不能为空",trigger:"blur"}],password:[{required:!0,message:"用户密码不能为空",trigger:"blur"}],email:[{type:"email",message:"'请输入正确的邮箱地址",trigger:["blur","change"]}],phone:[{pattern:/^1[3|4|5|6|7|8|9][0-9]\d{8}$/,message:"请输入正确的手机号码",trigger:"blur"}]}}),n=e=>{r.mittBus.emit("onEditUserModule",e),p.isShowDialog=!1},i=async()=>{e().then((e=>{p.deptOptions=e.data}))},c=()=>{s().then((e=>{p.postOptions=e.data.posts,p.roleOptions=e.data.roles})),p.ruleForm.userId=void 0,p.ruleForm.username="",p.ruleForm.nickName="",p.ruleForm.deptId="",p.ruleForm.phone="",p.ruleForm.email="",p.ruleForm.status="",p.ruleForm.password="",p.ruleForm.avatar="",p.ruleForm.sex="",p.ruleForm.remark="",p.ruleForm.postIds="",p.ruleForm.roleIds=""};return{ruleFormRef:m,openDialog:e=>{e&&e.userId&&null!=e.userId&&0!=e.userId?l(e.userId).then((e=>{p.ruleForm=e.data,p.postOptions=e.posts,p.roleOptions=e.roles,p.postIds=e.postIds.map((e=>Number(e))),p.roleIds=e.roleIds.map((e=>Number(e))),p.ruleForm.password=""})):c(),i(),p.isShowDialog=!0,r.getDicts("sys_user_sex").then((e=>{p.sexOptions=e.data})),r.getDicts("sys_normal_disable").then((e=>{p.statusOptions=e.data}))},closeDialog:n,onCancel:()=>{n(),c()},onSubmit:()=>{const e=g(m);e&&e.validate((e=>{e&&(p.ruleForm.postId=p.postIds[0],p.ruleForm.roleId=p.roleIds[0],p.ruleForm.postIds=p.postIds,p.ruleForm.roleIds=p.roleIds,null!=p.ruleForm.userId?a(p.ruleForm).then((e=>{f.success("修改成功"),n()})):o(p.ruleForm).then((e=>{f.success("新增成功"),n()})))}))},beforeAvatarUpload:e=>{const l="image/jpeg"===e.type,a=e.size/1024/1024<2;return l||f.error("上传头像图片只能是 JPG 格式!"),a||f.error("上传头像图片大小不能超过 2MB!"),l&&a},handleAvatarSuccess:e=>{},...u(p)}}},w={class:"system-menu-container"},N={style:{"font-size":"large"}},U={class:"dialog-footer"},D=I("取 消"),S=I("编 辑");const C=r(v,[["render",function(e,l,a,o,s,r){const t=m("el-input"),d=m("el-form-item"),u=m("el-col"),g=m("el-cascader"),f=m("el-option"),O=m("el-select"),v=m("el-radio"),C=m("el-radio-group"),j=m("el-row"),z=m("el-form"),R=m("el-button"),q=m("el-dialog"),A=p("drag");return b(),n("div",w,[i(q,{modelValue:e.isShowDialog,"onUpdate:modelValue":l[11]||(l[11]=l=>e.isShowDialog=l),width:"769px"},{title:c((()=>[F((b(),n("div",N,[I(_(a.title),1)])),[[A,[".system-menu-container .el-dialog",".system-menu-container .el-dialog__header"]]])])),footer:c((()=>[V("span",U,[i(R,{onClick:o.onCancel,size:"small"},{default:c((()=>[D])),_:1},8,["onClick"]),i(R,{type:"primary",onClick:o.onSubmit,size:"small"},{default:c((()=>[S])),_:1},8,["onClick"])])])),default:c((()=>[i(z,{ref:"ruleFormRef",model:e.ruleForm,rules:e.ruleRules,"label-width":"80px"},{default:c((()=>[i(j,{gutter:35},{default:c((()=>[i(u,{xs:24,sm:12,md:12,lg:12,xl:12},{default:c((()=>[i(d,{label:"用户昵称",prop:"nickName"},{default:c((()=>[i(t,{modelValue:e.ruleForm.nickName,"onUpdate:modelValue":l[0]||(l[0]=l=>e.ruleForm.nickName=l),placeholder:"请输入用户昵称"},null,8,["modelValue"])])),_:1})])),_:1}),i(u,{xs:24,sm:12,md:12,lg:12,xl:12},{default:c((()=>[i(d,{label:"归属部门",prop:"deptId"},{default:c((()=>[i(g,{modelValue:e.ruleForm.deptId,"onUpdate:modelValue":l[1]||(l[1]=l=>e.ruleForm.deptId=l),options:e.deptOptions,props:{label:"label",value:"id",checkStrictly:!0,emitPath:!1},class:"w100",clearable:"",filterable:"",placeholder:"请选择归属部门","show-all-levels":!1},null,8,["modelValue","options"])])),_:1})])),_:1}),i(u,{xs:24,sm:12,md:12,lg:12,xl:12},{default:c((()=>[null==e.ruleForm.userId?(b(),h(d,{key:0,label:"用户名称",prop:"userName"},{default:c((()=>[i(t,{modelValue:e.ruleForm.userName,"onUpdate:modelValue":l[2]||(l[2]=l=>e.ruleForm.userName=l),placeholder:"请输入用户名称"},null,8,["modelValue"])])),_:1})):x("",!0)])),_:1}),i(u,{xs:24,sm:12,md:12,lg:12,xl:12},{default:c((()=>[null==e.ruleForm.userId?(b(),h(d,{key:0,label:"用户密码",prop:"password"},{default:c((()=>[i(t,{modelValue:e.ruleForm.password,"onUpdate:modelValue":l[3]||(l[3]=l=>e.ruleForm.password=l),placeholder:"请输入用户密码",type:"password"},null,8,["modelValue"])])),_:1})):x("",!0)])),_:1}),i(u,{xs:24,sm:12,md:12,lg:12,xl:12},{default:c((()=>[i(d,{label:"手机号码",prop:"phonenumber"},{default:c((()=>[i(t,{modelValue:e.ruleForm.phonenumber,"onUpdate:modelValue":l[4]||(l[4]=l=>e.ruleForm.phonenumber=l),placeholder:"请输入手机号码",maxlength:"11"},null,8,["modelValue"])])),_:1})])),_:1}),i(u,{xs:24,sm:12,md:12,lg:12,xl:12},{default:c((()=>[i(d,{label:"邮箱",prop:"email"},{default:c((()=>[i(t,{modelValue:e.ruleForm.email,"onUpdate:modelValue":l[5]||(l[5]=l=>e.ruleForm.email=l),placeholder:"请输入邮箱",maxlength:"50"},null,8,["modelValue"])])),_:1})])),_:1}),i(u,{xs:24,sm:12,md:12,lg:12,xl:12},{default:c((()=>[i(d,{label:"用户性别",prop:"sex"},{default:c((()=>[i(O,{modelValue:e.ruleForm.sex,"onUpdate:modelValue":l[6]||(l[6]=l=>e.ruleForm.sex=l),placeholder:"请选择"},{default:c((()=>[(b(!0),n(y,null,k(e.sexOptions,(e=>(b(),h(f,{key:e.dictValue,label:e.dictLabel,value:e.dictValue},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),i(u,{xs:24,sm:12,md:12,lg:12,xl:12},{default:c((()=>[i(d,{label:"状态"},{default:c((()=>[i(C,{modelValue:e.ruleForm.status,"onUpdate:modelValue":l[7]||(l[7]=l=>e.ruleForm.status=l)},{default:c((()=>[(b(!0),n(y,null,k(e.statusOptions,(e=>(b(),h(v,{key:e.dictValue,label:e.dictValue},{default:c((()=>[I(_(e.dictLabel),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),i(u,{xs:24,sm:12,md:12,lg:12,xl:12},{default:c((()=>[i(d,{label:"岗位"},{default:c((()=>[i(O,{modelValue:e.postIds,"onUpdate:modelValue":l[8]||(l[8]=l=>e.postIds=l),multiple:"","collapse-tags":"true",placeholder:"请选择"},{default:c((()=>[(b(!0),n(y,null,k(e.postOptions,(e=>(b(),h(f,{key:e.postId,label:e.postName,value:e.postId,disabled:1==e.status},null,8,["label","value","disabled"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),i(u,{xs:24,sm:12,md:12,lg:12,xl:12},{default:c((()=>[i(d,{label:"角色"},{default:c((()=>[i(O,{modelValue:e.roleIds,"onUpdate:modelValue":l[9]||(l[9]=l=>e.roleIds=l),multiple:"","collapse-tags":"true",placeholder:"请选择"},{default:c((()=>[(b(!0),n(y,null,k(e.roleOptions,(e=>(b(),h(f,{key:e.roleId,label:e.roleName,value:e.roleId,disabled:1==e.status},null,8,["label","value","disabled"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),i(u,{xs:24,sm:24,md:24,lg:24,xl:24},{default:c((()=>[i(d,{label:"备注"},{default:c((()=>[i(t,{modelValue:e.ruleForm.remark,"onUpdate:modelValue":l[10]||(l[10]=l=>e.ruleForm.remark=l),type:"textarea",placeholder:"请输入内容"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])])}],["__scopeId","data-v-27aa3d0c"]]);export{C as default};
