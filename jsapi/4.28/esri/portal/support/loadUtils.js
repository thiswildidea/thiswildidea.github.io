// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.28/esri/copyright.txt for details.
//>>built
define(["exports","../../layers/support/associatedFeatureServiceUtils"],function(d,k){function e(a){const b={id:a.id,name:a.name};"Oriented Imagery Layer"===a.type&&(b.layerType="OrientedImageryLayer");return b}d.createSublayerData=e;d.getFirstLayerOrTableId=function(a){const b=a.layers;if(b?.length)return b[0].id;a=a.tables;return a?.length?a[0].id:null};d.getNumLayersAndTables=function(a){return(a?.layers?.length??0)+(a?.tables?.length??0)};d.getOrientedImageryLayerIds=function(a){return a?.layers?.filter(({layerType:b})=>
"OrientedImageryLayer"===b).map(({id:b})=>b)};d.getSubtypeGroupLayerIds=function(a){const b=[];a?.layers?.forEach(c=>{"SubtypeGroupLayer"===c.layerType&&b.push(c.id)});return b};d.populateSceneServiceItemData=async function(a,b,c){if(!a?.url)return b??{};b??(b={});if(!b.layers){const f=await c.fetchServiceMetadata(a.url);b.layers=f.layers?.map(e)}const {serverUrl:g,portalItem:h}=await k.findAssociatedFeatureService(a.url,{sceneLayerItem:a}).catch(()=>({serverUrl:null,portalItem:null}));if(null==g)return b.tables=
[],b;!b.tables&&h&&(a=await h.fetchData(),a?.tables?b.tables=a.tables.map(e):(c=await c.fetchServiceMetadata(g),b.tables=c?.tables?.map(e)));if(b.tables)for(const f of b.tables)f.url=`${g}/${f.id}`;return b};d.preprocessFSItemData=async function(a,b,c){if(null==a?.layers||null==a?.tables)b=await c.fetchServiceMetadata(b),a=a||{},a.layers=a.layers||b?.layers?.map(e),a.tables=a.tables||b?.tables?.map(e);return a};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})});