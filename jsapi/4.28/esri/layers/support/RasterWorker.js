// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.28/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/support/PixelBlock":function(){define("../../chunks/tslib.es6 ../../core/Error ../../core/JSONSupport ../../core/lang ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/subclass ./SimpleBandStatistics ./rasterFormats/pixelRangeUtils".split(" "),function(q,D,z,O,A,U,Q,K,J,B){var r;z=r=class extends z.JSONSupport{static createEmptyBand(f,d){return new (r.getPixelArrayConstructor(f))(d)}static getPixelArrayConstructor(f){let d;
switch(f){case "u1":case "u2":case "u4":case "u8":d=Uint8Array;break;case "u16":d=Uint16Array;break;case "u32":d=Uint32Array;break;case "s8":d=Int8Array;break;case "s16":d=Int16Array;break;case "s32":d=Int32Array;break;case "f32":d=Float32Array;break;case "f64":d=Float64Array;break;case "c64":case "c128":case "unknown":d=Float32Array}return d}constructor(f){super(f);this.height=this.width=null;this.pixelType="f32";this.mask=this.validPixelCount=null;this.premultiplyAlpha=this.maskIsAlpha=!1;this.statistics=
null;this.depthCount=1}castPixelType(f){if(!f)return"f32";f=f.toLowerCase();["u1","u2","u4"].includes(f)?f="u8":"unknown u8 s8 u16 s16 u32 s32 f32 f64".split(" ").includes(f)||(f="f32");return f}getPlaneCount(){return this.pixels?.length}addData(f){if(!f.pixels||f.pixels.length!==this.width*this.height)throw new D("pixelblock:invalid-or-missing-pixels","add data requires valid pixels array that has same length defined by pixel block width * height");this.pixels||(this.pixels=[]);this.statistics||
(this.statistics=[]);this.pixels.push(f.pixels);this.statistics.push(f.statistics??new J.SimpleBandStatistics)}getAsRGBA(){const f=new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case "s8":case "s16":case "u16":case "s32":case "u32":case "f32":case "f64":this._fillFromNon8Bit(f);break;default:this._fillFrom8Bit(f)}return new Uint8ClampedArray(f)}getAsRGBAFloat(){const f=new Float32Array(this.width*this.height*4);this._fillFrom32Bit(f);return f}updateStatistics(){if(this.pixels){this.statistics=
this.pixels.map(u=>this._calculateBandStatistics(u,this.mask));var f=this.mask,d=0;if(null!=f)for(let u=0;u<f.length;u++)f[u]&&d++;else d=this.width*this.height;this.validPixelCount=d}}clamp(f){if(f&&"f64"!==f&&"f32"!==f&&this.pixels){var [d,u]=B.getPixelValueRange(f),F=this.pixels,p=this.width*this.height,l=F.length,w=[];for(let c=0;c<l;c++){var E=r.createEmptyBand(f,p);var a=F[c];for(let b=0;b<p;b++){var e=a[b];E[b]=e>u?u:e<d?d:e}w.push(E)}this.pixels=w;this.pixelType=f}}extractBands(f){const {pixels:d,
statistics:u}=this;if(null==f||0===f.length||!d||0===d.length)return this;var F=d.length,p=f.some(c=>c>=d.length),l=F===f.length&&!f.some((c,b)=>c!==b);if(p||l)return this;F=this.bandMasks?.length===F?f.map(c=>this.bandMasks[c]):void 0;let {mask:w,validPixelCount:E}=this;const {width:a,height:e}=this;if(F){if(1===F.length)w=F[0];else for(p=a*e,w=(new Uint8Array(p)).fill(255),l=0;l<F.length;l++){const c=F[l];for(let b=0;b<p;b++)c[b]||(w[b]=0)}E=w.filter(c=>!!c).length}return new r({pixelType:this.pixelType,
width:a,height:e,mask:w,bandMasks:F,validPixelCount:E,maskIsAlpha:this.maskIsAlpha,pixels:f.map(c=>d[c]),statistics:u&&f.map(c=>u[c])})}clone(){const f=new r({width:this.width,height:this.height,pixelType:this.pixelType,maskIsAlpha:this.maskIsAlpha,validPixelCount:this.validPixelCount});null!=this.mask&&(f.mask=this.mask instanceof Uint8Array?new Uint8Array(this.mask):this.mask.slice(0));this.bandMasks&&(f.bandMasks=this.bandMasks.map(F=>new Uint8Array(F)));let d;const u=r.getPixelArrayConstructor(this.pixelType);
if(this.pixels&&0<this.pixels.length){f.pixels=[];const F=!!this.pixels[0].slice;for(d=0;d<this.pixels.length;d++)f.pixels[d]=F?this.pixels[d].slice(0,this.pixels[d].length):new u(this.pixels[d])}if(this.statistics)for(f.statistics=[],d=0;d<this.statistics.length;d++)f.statistics[d]=O.clone(this.statistics[d]);f.premultiplyAlpha=this.premultiplyAlpha;return f}_fillFrom8Bit(f){const {mask:d,maskIsAlpha:u,premultiplyAlpha:F,pixels:p}=this;if(f&&p?.length){var l,w;var E=l=w=p[0];3<=p.length?(l=p[1],
w=p[2]):2===p.length&&(l=p[1]);var a=new Uint32Array(f),e=this.width*this.height;if(E.length!==e)A.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");else if(null!=d&&d.length===e)if(u)for(f=0;f<e;f++){const c=d[f];if(c){const b=c/255;a[f]=F?c<<24|w[f]*b<<16|l[f]*b<<8|E[f]*b:c<<24|w[f]<<16|l[f]<<8|E[f]}}else for(f=0;f<e;f++)d[f]&&(a[f]=-16777216|w[f]<<16|l[f]<<8|E[f]);else for(f=0;f<e;f++)a[f]=-16777216|w[f]<<16|l[f]<<8|E[f]}else A.getLogger(this).error("getAsRGBA()",
"Unable to convert to RGBA. The input pixel block is empty.")}_fillFromNon8Bit(f){const {pixels:d,mask:u,statistics:F}=this;if(f&&d?.length){var p=this.pixelType,l=1,w=0;l=1;if(F&&0<F.length){for(var E of F)null!=E.minValue&&(w=Math.min(w,E.minValue)),null!=E.maxValue&&null!=E.minValue&&(l=Math.max(l,E.maxValue-E.minValue));l=255/l}else l=255,"s8"===p?(w=-128,l=127):"u16"===p?l=65535:"s16"===p?(w=-32768,l=32767):"u32"===p?l=4294967295:"s32"===p?(w=-2147483648,l=2147483647):"f32"===p?(w=-3.4*1E39,
l=3.4*1E39):"f64"===p&&(w=-Number.MAX_VALUE,l=Number.MAX_VALUE),l=255/(l-w);f=new Uint32Array(f);p=this.width*this.height;var a,e,c;E=a=e=d[0];if(E.length!==p)return A.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");if(2<=d.length)if(a=d[1],3<=d.length&&(e=d[2]),null!=u&&u.length===p)for(c=0;c<p;c++)u[c]&&(f[c]=-16777216|(e[c]-w)*l<<16|(a[c]-w)*l<<8|(E[c]-w)*l);else for(c=0;c<p;c++)f[c]=-16777216|(e[c]-w)*l<<16|(a[c]-w)*l<<8|(E[c]-w)*l;else if(null!=u&&
u.length===p)for(c=0;c<p;c++)a=(E[c]-w)*l,u[c]&&(f[c]=-16777216|a<<16|a<<8|a);else for(c=0;c<p;c++)a=(E[c]-w)*l,f[c]=-16777216|a<<16|a<<8|a}else A.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")}_fillFrom32Bit(f){const {pixels:d,mask:u}=this;if(!f||!d?.length)return A.getLogger(this).error("getAsRGBAFloat()","Unable to convert to RGBA. The input pixel block is empty.");let F,p,l,w;F=p=l=d[0];3<=d.length?(p=d[1],l=d[2]):2===d.length&&(p=d[1]);const E=
this.width*this.height;if(F.length!==E)return A.getLogger(this).error("getAsRGBAFloat()","Unable to convert to RGBA. The pixelblock is invalid.");let a=0;if(null!=u&&u.length===E)for(w=0;w<E;w++)f[a++]=F[w],f[a++]=p[w],f[a++]=l[w],f[a++]=u[w]&1;else for(w=0;w<E;w++)f[a++]=F[w],f[a++]=p[w],f[a++]=l[w],f[a++]=1}_calculateBandStatistics(f,d){let u=Infinity,F=-Infinity;const p=f.length;let l,w=0;if(null!=d)for(l=0;l<p;l++)d[l]&&(w=f[l],u=w<u?w:u,F=w>F?w:F);else for(l=0;l<p;l++)w=f[l],u=w<u?w:u,F=w>F?
w:F;return new J.SimpleBandStatistics(u,F)}};q.__decorate([U.property({json:{write:!0}})],z.prototype,"width",void 0);q.__decorate([U.property({json:{write:!0}})],z.prototype,"height",void 0);q.__decorate([U.property({json:{write:!0}})],z.prototype,"pixelType",void 0);q.__decorate([Q.cast("pixelType")],z.prototype,"castPixelType",null);q.__decorate([U.property({json:{write:!0}})],z.prototype,"validPixelCount",void 0);q.__decorate([U.property({json:{write:!0}})],z.prototype,"mask",void 0);q.__decorate([U.property({json:{write:!0}})],
z.prototype,"maskIsAlpha",void 0);q.__decorate([U.property({json:{write:!0}})],z.prototype,"pixels",void 0);q.__decorate([U.property()],z.prototype,"premultiplyAlpha",void 0);q.__decorate([U.property({json:{write:!0}})],z.prototype,"statistics",void 0);q.__decorate([U.property({json:{write:!0}})],z.prototype,"depthCount",void 0);q.__decorate([U.property({json:{write:!0}})],z.prototype,"noDataValues",void 0);q.__decorate([U.property({json:{write:!0}})],z.prototype,"bandMasks",void 0);return z=r=q.__decorate([K.subclass("esri.layers.support.PixelBlock")],
z)})},"esri/layers/support/SimpleBandStatistics":function(){define(["exports"],function(q){class D{constructor(z=null,O=null,A=null){this.minValue=z;this.maxValue=O;this.noDataValue=A}}q.SimpleBandStatistics=D;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/pixelRangeUtils":function(){define(["exports"],function(q){function D(O){return z[O]??[-3.4028234663852886E38,3.4028234663852886E38]}const z={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],
u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-3.4028234663852886E38,3.4028234663852886E38],f64:[-Number.MAX_VALUE,Number.MAX_VALUE],unknown:void 0,c64:void 0,c128:void 0};q.convertNoDataToMask=function(O,A,U){if(!(O.depthCount&&1<O.depthCount)){var {pixels:Q,statistics:K,pixelType:J}=O,B=Q[0].length,r=O.bandMasks??[];B=O.mask??(new Uint8Array(B)).fill(255);var f="f32"===J||"f64"===J,d=D(J),u=!1;for(let l=0;l<Q.length;l++){const w="number"===typeof A?A:A[l];
if(null==w)continue;var F=K?.[l]?.maxValue??d[1];if((K?.[l]?.minValue??d[0])>w+Number.EPSILON||F<w-Number.EPSILON)continue;F=r[l]||B.slice();const E=Q[l];var p=U?.customFloatTolerance;if(f&&0!==p){p||(p=9.999999E37<=Math.abs(w)?2E-7*Math.abs(w):"f32"===J?2**-23:Number.EPSILON);for(let a=0;a<E.length;a++)F[a]&&Math.abs(E[a]-w)<p&&(E[a]=0,F[a]=0,B[a]=0,u=!0)}else for(p=0;p<E.length;p++)F[p]&&E[p]===w&&(E[p]=0,F[p]=0,B[p]=0,u=!0);r[l]=F}u&&(O.bandMasks=O.bandMasks||1<O.pixels.length?r:null,O.mask=B);
u&&"updateStatistics"in O&&O.updateStatistics()}};q.getPixelValueRange=D;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/RasterCodec":function(){define("exports ../../../core/Error ../../../core/maybe ../PixelBlock ./ImageCanvasDecoder ./JpgPlus ./Lerc ./Lzw ./pixelRangeUtils ../../../chunks/Zlib ./Raw ./TiffDecoder ./utils".split(" "),function(q,D,z,O,A,U,Q,K,J,B,r,f,d){async function u(k,y){if(!d.isPlatformLittleEndian)throw new D("rasterCoded:decode",
"lerc decoder is not supported on big endian platform");await Q.load();const {offset:I}=y,{width:C,height:L,pixelType:H,statistics:S,depthCount:x,noDataValues:h,bandMasks:G,pixels:M,mask:R}=Q.decode(k,{inputOffset:I,returnInterleaved:y.returnInterleaved});k=new O({width:C,height:L,pixelType:H.toLowerCase(),pixels:M,mask:R,statistics:S,bandMasks:G,depthCount:x,noDataValues:h});S?.length||k.updateStatistics();return k}async function F(k,y){k=await f.decode(k,{...y,noDataValue:null});z.assertIsSome(k);
k=new O({width:k.width,height:k.height,pixels:k.pixels,pixelType:k.pixelType.toLowerCase(),mask:k.mask,bandMasks:k.bandMasks,statistics:null});k.updateStatistics();return k}async function p(k,y){k=await f.decodeTileOrStrip(k,y.customOptions);k=new O({width:k.width,height:k.height,pixels:k.pixels,pixelType:k.pixelType.toLowerCase(),mask:k.mask,statistics:null});k.updateStatistics();return k}function l(k,y){const I=y.pixelType||"u8",C=O.getPixelArrayConstructor(I),L="u8"===I?k:new C(k.buffer),H=[],
S=y.planes||1;if(1===S)H.push(L);else for(let x=0;x<S;x++){const h=(y.width||1)*(y.height||k.length),G=new C(h);for(let M=0;M<h;M++)G[M]=L[M*S+x];H.push(G)}k=new O({width:y.width||1,height:y.height||k.length,pixels:H,pixelType:I,statistics:null});k.updateStatistics();return k}function w(k,y){k=(new B.Zlib(new Uint8Array(k))).getBytes();return l(k,y)}function E(k,y){k=K.decode(k,y.offset,y.eof,!y.isInputBigEndian);return l(k,y)}function a(k,y){k=U.decode(k,y.hasNoZlibMask??void 0);k=new O({width:k.width,
height:k.height,pixels:k.pixels,pixelType:"U8",mask:k.mask,statistics:null});k.updateStatistics();return k}function e(k,y){k=new Uint8Array(k);k=new n(k);const {width:I,height:C}=y;y=I*C;k=k.decode();let L=0;var H=0;let S;H=new Uint8Array(y);for(L=0;L<y;L++)H[L]=k[4*L+3];const x=new O({width:I,height:C,pixels:[],pixelType:"U8",mask:H,statistics:[]});for(L=0;3>L;L++){S=new Uint8Array(y);for(H=0;H<y;H++)S[H]=k[4*H+L];x.addData({pixels:S})}x.updateStatistics();return x}async function c(k,y,I,C){k=await (new A).decode(k,
{applyJpegMask:!1,format:y,...I},C);k=new O(k);k.updateStatistics();return k}function b(k){if(null==k)throw new D("rasterCodec:decode","parameter encodeddata is required.");k=new Uint8Array(k,0,10);let y="";255===k[0]&&216===k[1]?y="jpg":137===k[0]&&80===k[1]&&78===k[2]&&71===k[3]?y="png":67===k[0]&&110===k[1]&&116===k[2]&&90===k[3]&&73===k[4]&&109===k[5]&&97===k[6]&&103===k[7]&&101===k[8]&&32===k[9]?y="lerc":76===k[0]&&101===k[1]&&114===k[2]&&99===k[3]&&50===k[4]&&32===k[5]?y="lerc2":73===k[0]&&
73===k[1]&&42===k[2]&&0===k[3]||77===k[0]&&77===k[1]&&0===k[2]&&42===k[3]||73===k[0]&&73===k[1]&&43===k[2]&&0===k[3]||77===k[0]&&77===k[1]&&0===k[2]&&43===k[3]?y="tiff":71===k[0]&&73===k[1]&&70===k[2]?y="gif":66===k[0]&&77===k[1]?y="bmp":String.fromCharCode.apply(null,k).toLowerCase().includes("error")&&(y="error");return y}function g(k){let y=null;switch(k){case "lerc":case "lerc2":y=u;break;case "jpg":y=a;break;case "png":y=e;break;case "bsq":case "bip":y=(I,C)=>{var L=C.pixelType,H=null;let S=
null;switch(L?L.toLowerCase():"f32"){case "u1":case "u2":case "u4":case "u8":S=255;H=Uint8Array;break;case "u16":S=S||65535;H=Uint16Array;break;case "u32":S=S||2**32-1;H=Uint32Array;break;case "s8":S=S||-128;H=Int8Array;break;case "s16":S=S||-32768;H=Int16Array;break;case "s32":S=S||-(2**31);H=Int32Array;break;default:H=Float32Array}({pixelTypeCtor:L}={pixelTypeCtor:H,noDataValue:S});H=r.decode;I=H(I,{width:C.width,height:C.height,pixelType:L,format:k});C=new O({width:C.width,height:C.height,pixels:I.pixels,
pixelType:C.pixelType,mask:I.mask,statistics:null});C.updateStatistics();return C};break;case "tiff":y=F;break;case "deflate":y=w;break;case "lzw":y=E;break;case "error":y=()=>{throw new D("rasterCodec:decode","input data contains error");};break;default:y=()=>{throw new D("rasterCodec:decode","unsupported raster format");}}return y}function m(k,y=1){if(k){var {pixels:I,width:C,height:L,mask:H}=k;if(I&&0!==I.length){var S=I.length,x=C-1,h=L-1,G=[],M,R,X=null,T=O.getPixelArrayConstructor(k.pixelType);
if(0===y){for(y=0;y<S;y++){var Z=I[y];var ha=new T(x*h);for(M=0;M<h;M++){var v=M*C;for(R=0;R<x;R++)ha[M*x+R]=Z[v+R]}G.push(ha)}if(null!=H)for(X=new Uint8Array(x*h),M=0;M<h;M++)for(v=M*C,R=0;R<x;R++)X[M*x+R]=H[v+R]}else{for(y=0;y<S;y++){Z=I[y];ha=new T(x*h);for(M=0;M<h;M++)for(v=M*C,R=0;R<x;R++)ha[M*x+R]=(Z[v+R]+Z[v+R+1]+Z[v+C+R]+Z[v+C+R+1])/4;G.push(ha)}if(H)for(X=new Uint8Array(x*h),M=0;M<h;M++)for(v=M*C,R=0;R<x;R++)X[M*x+R]=Math.min.apply(null,[H[v+R],H[v+R+1],H[v+C+R],H[v+C+R+1]])}k.width=x;k.height=
h;k.mask=X;k.pixels=G}}}var n=function(k){function y(H){var S,x;this.data=H;this.pos=8;this.palette=[];this.imgData=[];this.transparency={};this.animation=null;this.text={};for(x=null;;){var h=this.readUInt32();var G=H=void 0;H=[];for(G=0;4>G;++G)H.push(String.fromCharCode(this.data[this.pos++]));H=H.join("");switch(H){case "IHDR":this.width=this.readUInt32();this.height=this.readUInt32();this.bits=this.data[this.pos++];this.colorType=this.data[this.pos++];this.compressionMethod=this.data[this.pos++];
this.filterMethod=this.data[this.pos++];this.interlaceMethod=this.data[this.pos++];break;case "acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||Infinity,frames:[]};break;case "PLTE":this.palette=this.read(h);break;case "fcTL":x&&this.animation.frames.push(x);this.pos+=4;x={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()};H=this.readUInt16();h=this.readUInt16()||100;x.delay=1E3*H/h;x.disposeOp=this.data[this.pos++];x.blendOp=
this.data[this.pos++];x.data=[];break;case "IDAT":case "fdAT":"fdAT"===H&&(this.pos+=4,h-=4);H=(null!=x?x.data:void 0)||this.imgData;for(G=0;0<=h?G<h:G>h;0<=h?++G:--G)H.push(this.data[this.pos++]);break;case "tRNS":this.transparency={};switch(this.colorType){case 3:this.transparency.indexed=this.read(h);h=255-this.transparency.indexed.length;if(0<h)for(H=0;0<=h?H<h:H>h;0<=h?++H:--H)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(h)[0];break;case 2:this.transparency.rgb=
this.read(h)}break;case "tEXt":G=this.read(h);h=G.indexOf(0);H=String.fromCharCode.apply(String,G.slice(0,h));this.text[H]=String.fromCharCode.apply(String,G.slice(h+1));break;case "IEND":x&&this.animation.frames.push(x);a:{switch(this.colorType){case 0:case 3:case 4:x=1;break a;case 2:case 6:x=3;break a}x=void 0}this.colors=x;this.hasAlphaChannel=4===(S=this.colorType)||6===S;S=this.colors+(this.hasAlphaChannel?1:0);this.pixelBitlength=this.bits*S;a:{switch(this.colors){case 1:S="DeviceGray";break a;
case 3:S="DeviceRGB";break a}S=void 0}this.colorSpace=S;this.imgData=new Uint8Array(this.imgData);return;default:this.pos+=h}this.pos+=4;if(this.pos>this.data.length)throw Error("Incomplete or corrupt PNG file");}}var I;y.load=function(H,S,x){"function"===typeof S&&(x=S);var h=new XMLHttpRequest;h.open("GET",H,!0);h.responseType="arraybuffer";h.onload=function(){var G=new Uint8Array(h.response||h.mozResponseArrayBuffer);G=new y(G);"function"===typeof(null!=S?S.getContext:void 0)&&G.render(S);return"function"===
typeof x?x(G):void 0};return h.send(null)};y.prototype.read=function(H){var S;var x=[];for(S=0;0<=H?S<H:S>H;0<=H?++S:--S)x.push(this.data[this.pos++]);return x};y.prototype.readUInt32=function(){var H=this.data[this.pos++]<<24;var S=this.data[this.pos++]<<16;var x=this.data[this.pos++]<<8;var h=this.data[this.pos++];return H|S|x|h};y.prototype.readUInt16=function(){var H=this.data[this.pos++]<<8;var S=this.data[this.pos++];return H|S};y.prototype.decodePixels=function(H){var S,x,h,G,M,R,X,T;null==
H&&(H=this.imgData);if(0===H.length)return new Uint8Array(0);H=new B.Zlib(H);H=H.getBytes();var Z=this.pixelBitlength/8;var ha=Z*this.width;var v=new Uint8Array(ha*this.height);var N=H.length;for(x=G=M=0;G<N;){switch(H[G++]){case 0:for(h=S=0;S<ha;h=S+=1)v[x++]=H[G++];break;case 1:for(h=R=0;R<ha;h=R+=1){S=H[G++];var P=h<Z?0:v[x-Z];v[x++]=(S+P)%256}break;case 2:for(h=P=0;P<ha;h=P+=1){S=H[G++];var V=(h-h%Z)/Z;R=M&&v[(M-1)*ha+V*Z+h%Z];v[x++]=(R+S)%256}break;case 3:for(h=T=0;T<ha;h=T+=1)S=H[G++],V=(h-
h%Z)/Z,P=h<Z?0:v[x-Z],R=M&&v[(M-1)*ha+V*Z+h%Z],v[x++]=(S+Math.floor((P+R)/2))%256;break;case 4:for(h=T=0;T<ha;h=T+=1){S=H[G++];V=(h-h%Z)/Z;P=h<Z?0:v[x-Z];0===M?R=X=0:(R=v[(M-1)*ha+V*Z+h%Z],X=V&&v[(M-1)*ha+(V-1)*Z+h%Z]);var Y=P+R-X;h=Math.abs(Y-P);V=Math.abs(Y-R);Y=Math.abs(Y-X);P=h<=V&&h<=Y?P:V<=Y?R:X;v[x++]=(S+P)%256}break;default:throw Error("Invalid filter algorithm: "+H[G-1]);}M++}return v};y.prototype.decodePalette=function(){var H,S,x,h;var G=this.palette;var M=this.transparency.indexed||[];
var R=new Uint8Array((M.length||0)+G.length);var X=0;G.length;var T=S=H=0;for(x=G.length;S<x;T=S+=3)R[X++]=G[T],R[X++]=G[T+1],R[X++]=G[T+2],R[X++]=null!=(h=M[H++])?h:255;return R};y.prototype.copyToImageData=function(H,S){var x,h;var G=this.colors;var M=null;var R=this.hasAlphaChannel;this.palette.length&&(M=null!=(x=this._decodedPalette)?x:this._decodedPalette=this.decodePalette(),G=4,R=!0);H=H.data||H;var X=H.length;var T=M||S;x=h=0;if(1===G)for(;x<X;)G=M?4*S[x/4]:h,h=T[G++],H[x++]=h,H[x++]=h,H[x++]=
h,H[x++]=R?T[G++]:this.transparency.grayscale&&this.transparency.grayscale===h?0:255,h=G;else for(;x<X;)G=M?4*S[x/4]:h,H[x++]=T[G++],H[x++]=T[G++],H[x++]=T[G++],H[x++]=R?T[G++]:this.transparency.rgb&&this.transparency.rgb[1]===T[G-3]&&this.transparency.rgb[3]===T[G-2]&&this.transparency.rgb[5]===T[G-1]?0:255,h=G};y.prototype.decode=function(){var H=new Uint8Array(this.width*this.height*4);this.copyToImageData(H,this.decodePixels());return H};var C=(I=k.document&&k.document.createElement("canvas"))&&
I.getContext("2d");var L=function(H){C.width=H.width;C.height=H.height;C.clearRect(0,0,H.width,H.height);C.putImageData(H,0,0);H=new Image;H.src=I.toDataURL();return H};y.prototype.decodeFrames=function(H){var S,x;if(this.animation){var h=this.animation.frames;var G=[];var M=S=0;for(x=h.length;S<x;M=++S){M=h[M];var R=H.createImageData(M.width,M.height);var X=this.decodePixels(new Uint8Array(M.data));this.copyToImageData(R,X);M.imageData=R;G.push(M.image=L(R))}return G}};y.prototype.renderFrame=function(H,
S){var x=this.animation.frames;var h=x[S];x=x[S-1];0===S&&H.clearRect(0,0,this.width,this.height);1===(null!=x?x.disposeOp:void 0)?H.clearRect(x.xOffset,x.yOffset,x.width,x.height):2===(null!=x?x.disposeOp:void 0)&&H.putImageData(x.imageData,x.xOffset,x.yOffset);0===h.blendOp&&H.clearRect(h.xOffset,h.yOffset,h.width,h.height);return H.drawImage(h.image,h.xOffset,h.yOffset)};y.prototype.animate=function(H){var S,x=this;var h=0;var G=this.animation;var M=G.numFrames;var R=G.frames;var X=G.numPlays;
return(S=function(){var T=h++%M;var Z=R[T];x.renderFrame(H,T);if(1<M&&h/M<X)return x.animation._timeout=setTimeout(S,Z.delay)})()};y.prototype.stopAnimation=function(){var H;return clearTimeout(null!=(H=this.animation)?H._timeout:void 0)};y.prototype.render=function(H){H._png&&H._png.stopAnimation();H._png=this;H.width=this.width;H.height=this.height;H=H.getContext("2d");if(this.animation)return this.decodeFrames(H),this.animate(H);var S=H.createImageData(this.width,this.height);this.copyToImageData(S,
this.decodePixels());return H.putImageData(S,0,0)};return y}(self);const t=new Set(["jpg","png","bmp","gif"]);q.decode=async function(k,y={},I){if(null==k)throw new D("rasterCodec:decode","missing encodeddata parameter.");let C=y.format?.toLowerCase();if(!("bsq"!==C&&"bip"!==C||null!=y.width&&null!=y.height))throw new D("rasterCodec:decode","requires width and height in options parameter.");if("tiff"===C&&y.customOptions)return p(k,y);if(!C||"bsq"!==C&&"bip"!==C&&"deflate"!==C&&"lzw"!==C)C=b(k);if(y.useCanvas&&
t.has(C))return c(k,C,y,I);I=g(C);y.isPoint&&(y={...y},null!=y.width&&y.width++,null!=y.height&&y.height++);k=await I(k,y);if(!k)return k;"jpg"!==C&&null!=y.noDataValue&&1===k.depthCount&&J.convertNoDataToMask(k,y.noDataValue,{customFloatTolerance:y.tolerance});y.isPoint&&m(k);return k};q.getFormat=function(k){k=b(k);"lerc2"===k?k="lerc":"error"===k&&(k="");return k};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/ImageCanvasDecoder":function(){define(["../../../core/Error",
"../../../core/promiseUtils","../../../chunks/Zlib"],function(q,D,z){class O{constructor(A){this._ctx=this._canvas=null;A&&(this._canvas=A.canvas,this._ctx=A.ctx||A.canvas&&A.canvas.getContext("2d"))}decode(A,U,Q){if(!A||10>A.byteLength)throw new q("imagecanvasdecoder: decode","required a valid encoded data as input.");let {width:K=0,height:J=0,format:B}=U;const {applyJpegMask:r}=U;if(r&&(!K||!J))throw new q("imagecanvasdecoder: decode","image width and height are needed to apply jpeg mask directly to canvas");
return new Promise((f,d)=>{let u=null;"jpg"===B&&r&&(u=O._getMask(A,{width:K,height:J}));const F=new Blob([new Uint8Array(A)],{type:"jpg"==="image/"+B?"jpeg":B}),p=URL.createObjectURL(F),l=new Image;let w;l.src=p;l.onload=()=>{URL.revokeObjectURL(p);if(D.isAborted(Q))d(D.createAbortError());else{K=l.width;J=l.height;if(this._canvas&&this._ctx){if(this._canvas.width!==K||this._canvas.height!==J)this._canvas.width=K,this._canvas.height=J;this._ctx.clearRect(0,0,K,J)}else this._canvas=document.createElement("canvas"),
this._canvas.width=K,this._canvas.height=J,this._ctx=this._canvas.getContext("2d");this._ctx.drawImage(l,0,0);var E=this._ctx.getImageData(0,0,K,J);w=E.data;var a;if(U.renderOnCanvas){if(u)for(a=0;a<u.length;a++)w[4*a+3]=u[a]?255:0;this._ctx.putImageData(E,0,0);f(null)}else{E=K*J;var e=new Uint8Array(E),c=new Uint8Array(E),b=new Uint8Array(E);if(u)for(a=0;a<E;a++)e[a]=w[4*a],c[a]=w[4*a+1],b[a]=w[4*a+2];else for(u=new Uint8Array(E),a=0;a<E;a++)e[a]=w[4*a],c[a]=w[4*a+1],b[a]=w[4*a+2],u[a]=w[4*a+3];
f({width:K,height:J,pixels:[e,c,b],mask:u,pixelType:"u8"})}}};l.onerror=()=>{URL.revokeObjectURL(p);d("cannot load image")}})}static _getMask(A,U){let Q=null;try{var K=new Uint8Array(A);A=0;var J=K.length-2;for(A=Math.ceil(K.length/2);A<J&&(255!==K[A]||217!==K[A+1]);A++);A+=2;if(A<K.length-1){const B=(new z.Zlib(K.subarray(A))).getBytes();Q=new Uint8Array(U.width*U.height);U=0;for(K=0;K<B.length;K++)for(J=7;0<=J;J--)Q[U++]=B[K]>>J&1}}catch(B){}return Q}}return O})},"esri/chunks/Zlib":function(){define(["exports",
"./_commonjsHelpers"],function(q,D){var z={exports:{}};z.exports;(function(O){(function(A){A=A();void 0!==A&&(O.exports=A)})(function(){var A=function(){function U(){this.bufferLength=this.pos=0;this.eof=!1;this.buffer=null}U.prototype={ensureBuffer:function(Q){var K=this.buffer,J=K?K.byteLength:0;if(Q<J)return K;for(var B=512;B<Q;)B<<=1;Q=new Uint8Array(B);for(B=0;B<J;++B)Q[B]=K[B];return this.buffer=Q},getByte:function(){for(var Q=this.pos;this.bufferLength<=Q;){if(this.eof)return null;this.readBlock()}return this.buffer[this.pos++]},
getBytes:function(Q){var K=this.pos;if(Q){this.ensureBuffer(K+Q);for(Q=K+Q;!this.eof&&this.bufferLength<Q;)this.readBlock();var J=this.bufferLength;Q>J&&(Q=J)}else{for(;!this.eof;)this.readBlock();Q=this.bufferLength}this.pos=Q;return this.buffer.subarray(K,Q)},lookChar:function(){for(var Q=this.pos;this.bufferLength<=Q;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos])},getChar:function(){for(var Q=this.pos;this.bufferLength<=Q;){if(this.eof)return null;
this.readBlock()}return String.fromCharCode(this.buffer[this.pos++])},makeSubStream:function(Q,K,J){for(var B=Q+K;this.bufferLength<=B&&!this.eof;)this.readBlock();return new Stream(this.buffer,Q,K,J)},skip:function(Q){Q||(Q=1);this.pos+=Q},reset:function(){this.pos=0}};return U}();return function(){function U(d){throw Error(d);}function Q(d){var u=0,F=d[u++],p=d[u++];-1!=F&&-1!=p||U("Invalid header in flate stream");8!=(F&15)&&U("Unknown compression method in flate stream");0!=((F<<8)+p)%31&&U("Bad FCHECK in flate stream");
p&32&&U("FDICT bit set in flate stream");this.bytes=d;this.bytesPos=u;this.codeBuf=this.codeSize=0;A.call(this)}if(!self||!self.Uint32Array)return null;var K=new Uint32Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),J=new Uint32Array([3,4,5,6,7,8,9,10,65547,65549,65551,65553,131091,131095,131099,131103,196643,196651,196659,196667,262211,262227,262243,262259,327811,327843,327875,327907,258,258,258]),B=new Uint32Array([1,2,3,4,65541,65543,131081,131085,196625,196633,262177,262193,327745,327777,
393345,393409,459009,459137,524801,525057,590849,591361,657409,658433,724993,727041,794625,798721,868353,876545]),r=[new Uint32Array([459008,524368,524304,524568,459024,524400,524336,590016,459016,524384,524320,589984,524288,524416,524352,590048,459012,524376,524312,589968,459028,524408,524344,590032,459020,524392,524328,59E4,524296,524424,524360,590064,459010,524372,524308,524572,459026,524404,524340,590024,459018,524388,524324,589992,524292,524420,524356,590056,459014,524380,524316,589976,459030,
524412,524348,590040,459022,524396,524332,590008,524300,524428,524364,590072,459009,524370,524306,524570,459025,524402,524338,590020,459017,524386,524322,589988,524290,524418,524354,590052,459013,524378,524314,589972,459029,524410,524346,590036,459021,524394,524330,590004,524298,524426,524362,590068,459011,524374,524310,524574,459027,524406,524342,590028,459019,524390,524326,589996,524294,524422,524358,590060,459015,524382,524318,589980,459031,524414,524350,590044,459023,524398,524334,590012,524302,
524430,524366,590076,459008,524369,524305,524569,459024,524401,524337,590018,459016,524385,524321,589986,524289,524417,524353,590050,459012,524377,524313,589970,459028,524409,524345,590034,459020,524393,524329,590002,524297,524425,524361,590066,459010,524373,524309,524573,459026,524405,524341,590026,459018,524389,524325,589994,524293,524421,524357,590058,459014,524381,524317,589978,459030,524413,524349,590042,459022,524397,524333,590010,524301,524429,524365,590074,459009,524371,524307,524571,459025,
524403,524339,590022,459017,524387,524323,589990,524291,524419,524355,590054,459013,524379,524315,589974,459029,524411,524347,590038,459021,524395,524331,590006,524299,524427,524363,590070,459011,524375,524311,524575,459027,524407,524343,590030,459019,524391,524327,589998,524295,524423,524359,590062,459015,524383,524319,589982,459031,524415,524351,590046,459023,524399,524335,590014,524303,524431,524367,590078,459008,524368,524304,524568,459024,524400,524336,590017,459016,524384,524320,589985,524288,
524416,524352,590049,459012,524376,524312,589969,459028,524408,524344,590033,459020,524392,524328,590001,524296,524424,524360,590065,459010,524372,524308,524572,459026,524404,524340,590025,459018,524388,524324,589993,524292,524420,524356,590057,459014,524380,524316,589977,459030,524412,524348,590041,459022,524396,524332,590009,524300,524428,524364,590073,459009,524370,524306,524570,459025,524402,524338,590021,459017,524386,524322,589989,524290,524418,524354,590053,459013,524378,524314,589973,459029,
524410,524346,590037,459021,524394,524330,590005,524298,524426,524362,590069,459011,524374,524310,524574,459027,524406,524342,590029,459019,524390,524326,589997,524294,524422,524358,590061,459015,524382,524318,589981,459031,524414,524350,590045,459023,524398,524334,590013,524302,524430,524366,590077,459008,524369,524305,524569,459024,524401,524337,590019,459016,524385,524321,589987,524289,524417,524353,590051,459012,524377,524313,589971,459028,524409,524345,590035,459020,524393,524329,590003,524297,
524425,524361,590067,459010,524373,524309,524573,459026,524405,524341,590027,459018,524389,524325,589995,524293,524421,524357,590059,459014,524381,524317,589979,459030,524413,524349,590043,459022,524397,524333,590011,524301,524429,524365,590075,459009,524371,524307,524571,459025,524403,524339,590023,459017,524387,524323,589991,524291,524419,524355,590055,459013,524379,524315,589975,459029,524411,524347,590039,459021,524395,524331,590007,524299,524427,524363,590071,459011,524375,524311,524575,459027,
524407,524343,590031,459019,524391,524327,589999,524295,524423,524359,590063,459015,524383,524319,589983,459031,524415,524351,590047,459023,524399,524335,590015,524303,524431,524367,590079]),9],f=[new Uint32Array([327680,327696,327688,327704,327684,327700,327692,327708,327682,327698,327690,327706,327686,327702,327694,0,327681,327697,327689,327705,327685,327701,327693,327709,327683,327699,327691,327707,327687,327703,327695,0]),5];Q.prototype=Object.create(A.prototype);Q.prototype.getBits=function(d){for(var u=
this.codeSize,F=this.codeBuf,p=this.bytes,l=this.bytesPos,w;u<d;)"undefined"==typeof(w=p[l++])&&U("Bad encoding in flate stream"),F|=w<<u,u+=8;this.codeBuf=F>>d;this.codeSize=u-=d;this.bytesPos=l;return F&(1<<d)-1};Q.prototype.getCode=function(d){var u=d[0],F=d[1];d=this.codeSize;for(var p=this.codeBuf,l=this.bytes,w=this.bytesPos;d<F;){var E;"undefined"==typeof(E=l[w++])&&U("Bad encoding in flate stream");p|=E<<d;d+=8}F=u[p&(1<<F)-1];u=F>>16;F&=65535;(0==d||d<u||0==u)&&U("Bad encoding in flate stream");
this.codeBuf=p>>u;this.codeSize=d-u;this.bytesPos=w;return F};Q.prototype.generateHuffmanTable=function(d){for(var u=d.length,F=0,p=0;p<u;++p)d[p]>F&&(F=d[p]);for(var l=1<<F,w=new Uint32Array(l),E=1,a=0,e=2;E<=F;++E,a<<=1,e<<=1)for(var c=0;c<u;++c)if(d[c]==E){var b=0,g=a;for(p=0;p<E;++p)b=b<<1|g&1,g>>=1;for(p=b;p<l;p+=e)w[p]=E<<16|c;++a}return[w,F]};Q.prototype.readBlock=function(){function d(b,g,m,n,t){for(b=b.getBits(m)+n;0<b--;)g[a++]=t}var u=this.getBits(3);u&1&&(this.eof=!0);u>>=1;if(0==u){var F=
this.bytes,p=this.bytesPos,l;"undefined"==typeof(l=F[p++])&&U("Bad block header in flate stream");var w=l;"undefined"==typeof(l=F[p++])&&U("Bad block header in flate stream");w|=l<<8;"undefined"==typeof(l=F[p++])&&U("Bad block header in flate stream");u=l;"undefined"==typeof(l=F[p++])&&U("Bad block header in flate stream");(u|l<<8)!=(~w&65535)&&U("Bad uncompressed block length in flate stream");this.codeSize=this.codeBuf=0;l=this.bufferLength;u=this.ensureBuffer(l+w);this.bufferLength=w=l+w;for(var E=
l;E<w;++E){if("undefined"==typeof(l=F[p++])){this.eof=!0;break}u[E]=l}this.bytesPos=p}else{if(1==u)p=r,l=f;else if(2==u){u=this.getBits(5)+257;l=this.getBits(5)+1;F=this.getBits(4)+4;p=Array(K.length);for(var a=0;a<F;)p[K[a++]]=this.getBits(3);p=this.generateHuffmanTable(p);a=F=0;l=u+l;for(w=Array(l);a<l;)E=this.getCode(p),16==E?d(this,w,2,3,F):17==E?d(this,w,3,3,F=0):18==E?d(this,w,7,11,F=0):w[a++]=F=E;p=this.generateHuffmanTable(w.slice(0,u));l=this.generateHuffmanTable(w.slice(u,l))}else U("Unknown block type in flate stream");
w=(u=this.buffer)?u.length:0;for(E=this.bufferLength;;){var e=this.getCode(p);if(256>e)E+1>=w&&(u=this.ensureBuffer(E+1),w=u.length),u[E++]=e;else{if(256==e){this.bufferLength=E;break}e-=257;e=J[e];var c=e>>16;0<c&&(c=this.getBits(c));F=(e&65535)+c;e=this.getCode(l);e=B[e];c=e>>16;0<c&&(c=this.getBits(c));e=(e&65535)+c;E+F>=w&&(u=this.ensureBuffer(E+F),w=u.length);for(c=0;c<F;++c,++E)u[E]=u[E-e]}}}};return Q}()})})(z);D=D.getDefaultExportFromCjs(z.exports);q.Zlib=D})},"esri/layers/support/rasterFormats/JpgPlus":function(){define(["../../../chunks/Jpg",
"../../../chunks/Zlib"],function(q,D){class z{static decode(O,A=!1){const U=new Uint8Array(O);O=new q.JpegImage;O.parse(U);const {width:Q,height:K,numComponents:J,eof:B}=O,r=O.getData(Q,K,!0),f=Q*K;O=null;let d=0,u=0,F=0;if(!A&&B<U.length-1)try{var p=(new D.Zlib(U.subarray(B))).getBytes();O=new Uint8Array(f);for(d=A=0;d<p.length;d++)for(F=7;0<=F;F--)O[A++]=p[d]>>F&1}catch{}if(1===J&&r.length===Q*K)p=new Uint8Array(r.buffer),p=[p,p,p];else{p=[];for(d=0;3>d;d++)p.push(new Uint8Array(f));for(u=F=0;u<
f;u++)for(d=0;3>d;d++)p[d][u]=r[F++]}return{width:Q,height:K,pixels:p,mask:O}}}return z})},"esri/chunks/Jpg":function(){define(["exports","./_commonjsHelpers"],function(q,D){var z={exports:{}};z.exports;(function(O){(function(A){A=A();void 0!==A&&(O.exports=A)})(function(){var A=function(){function U(Q){this.message="JPEG error: "+Q}U.prototype=Error();U.prototype.name="JpegError";return U.constructor=U}();return function(){function U(){this.decodeTransform=null;this.colorTransform=-1}function Q(f,
d){for(var u=0,F=[],p,l,w=16;0<w&&!f[w-1];)w--;F.push({children:[],index:0});var E=F[0],a;for(p=0;p<w;p++){for(l=0;l<f[p];l++){E=F.pop();for(E.children[E.index]=d[u];0<E.index;)E=F.pop();E.index++;for(F.push(E);F.length<=p;)F.push(a={children:[],index:0}),E.children[E.index]=a.children,E=a;u++}p+1<w&&(F.push(a={children:[],index:0}),E.children[E.index]=a.children,E=a)}return F[0].children}function K(f,d,u,F,p,l,w,E,a){function e(){if(0<H)return H--,L>>H&1;L=f[d++];if(255===L){var V=f[d++];if(V)throw new A("unexpected marker "+
(L<<8|V).toString(16));}H=7;return L>>>7}function c(V){for(;;){V=V[e()];if("number"===typeof V)return V;if("object"!==typeof V)throw new A("invalid huffman sequence");}}function b(V){for(var Y=0;0<V;)Y=Y<<1|e(),V--;return Y}function g(V){if(1===V)return 1===e()?1:-1;var Y=b(V);return Y>=1<<V-1?Y:Y+(-1<<V)+1}function m(V,Y){var aa=c(V.huffmanTableDC);aa=0===aa?0:g(aa);V.blockData[Y]=V.pred+=aa;for(aa=1;64>aa;){var fa=c(V.huffmanTableAC),ea=fa&15;fa>>=4;if(0===ea){if(15>fa)break;aa+=16}else aa+=fa,
V.blockData[Y+r[aa]]=g(ea),aa++}}function n(V,Y){var aa=c(V.huffmanTableDC);aa=0===aa?0:g(aa)<<a;V.blockData[Y]=V.pred+=aa}function t(V,Y){V.blockData[Y]|=e()<<a}function k(V,Y){if(0<S)S--;else for(var aa=l;aa<=w;){var fa=c(V.huffmanTableAC),ea=fa&15;fa>>=4;if(0===ea){if(15>fa){S=b(fa)+(1<<fa)-1;break}aa+=16}else aa+=fa,V.blockData[Y+r[aa]]=g(ea)*(1<<a),aa++}}function y(V,Y){for(var aa=l,fa=0,ea;aa<=w;){ea=r[aa];switch(x){case 0:fa=c(V.huffmanTableAC);ea=fa&15;fa>>=4;if(0===ea)15>fa?(S=b(fa)+(1<<
fa),x=4):(fa=16,x=1);else{if(1!==ea)throw new A("invalid ACn encoding");h=g(ea);x=fa?2:3}continue;case 1:case 2:V.blockData[Y+ea]?V.blockData[Y+ea]+=e()<<a:(fa--,0===fa&&(x=2===x?3:0));break;case 3:V.blockData[Y+ea]?V.blockData[Y+ea]+=e()<<a:(V.blockData[Y+ea]=h<<a,x=0);break;case 4:V.blockData[Y+ea]&&(V.blockData[Y+ea]+=e()<<a)}aa++}4===x&&(S--,0===S&&(x=0))}var I=u.mcusPerLine,C=d,L=0,H=0,S=0,x=0,h,G=F.length,M,R,X,T;E=u.progressive?0===l?0===E?n:t:0===E?k:y:m;var Z=0;u=1===G?F[0].blocksPerLine*
F[0].blocksPerColumn:I*u.mcusPerColumn;for(var ha,v;Z<u;){var N=p?Math.min(u-Z,p):u;for(M=0;M<G;M++)F[M].pred=0;S=0;if(1===G){var P=F[0];for(T=0;T<N;T++)E(P,64*((P.blocksPerLine+1)*(Z/P.blocksPerLine|0)+Z%P.blocksPerLine)),Z++}else for(T=0;T<N;T++){for(M=0;M<G;M++)for(P=F[M],ha=P.h,v=P.v,R=0;R<v;R++)for(X=0;X<ha;X++)E(P,64*((P.blocksPerLine+1)*((Z/I|0)*P.v+R)+(Z%I*P.h+X)));Z++}H=0;(P=B(f,d))&&P.invalid&&(console.log("decodeScan - unexpected MCU data, next marker is: "+P.invalid),d=P.offset);P=P&&
P.marker;if(!P||65280>=P)throw new A("marker was not found");if(65488<=P&&65495>=P)d+=2;else break}(P=B(f,d))&&P.invalid&&(console.log("decodeScan - unexpected Scan data, next marker is: "+P.invalid),d=P.offset);return d-C}function J(f,d){f=d.blocksPerLine;for(var u=d.blocksPerColumn,F=new Int16Array(64),p=0;p<u;p++)for(var l=0;l<f;l++){var w=void 0,E=void 0,a=void 0,e=void 0,c=void 0,b=void 0,g=void 0,m=void 0,n=c=b=e=E=w=void 0,t=void 0,k=void 0,y=void 0,I=64*((d.blocksPerLine+1)*p+l),C=F,L=d.quantizationTable,
H=d.blockData;if(!L)throw new A("missing required Quantization Table.");for(var S=0;64>S;S+=8)w=H[I+S],m=H[I+S+1],g=H[I+S+2],b=H[I+S+3],c=H[I+S+4],e=H[I+S+5],a=H[I+S+6],E=H[I+S+7],w*=L[S],0===(m|g|b|c|e|a|E)?(w=5793*w+512>>10,C[S]=w,C[S+1]=w,C[S+2]=w,C[S+3]=w,C[S+4]=w,C[S+5]=w,C[S+6]=w,C[S+7]=w):(m*=L[S+1],g*=L[S+2],b*=L[S+3],c*=L[S+4],e*=L[S+5],a*=L[S+6],E*=L[S+7],y=5793*w+128>>8,k=5793*c+128>>8,t=g,n=a,c=2896*(m-E)+128>>8,E=2896*(m+E)+128>>8,b<<=4,e<<=4,y=y+k+1>>1,k=y-k,w=3784*t+1567*n+128>>8,t=
1567*t-3784*n+128>>8,n=w,c=c+e+1>>1,e=c-e,E=E+b+1>>1,b=E-b,y=y+n+1>>1,n=y-n,k=k+t+1>>1,t=k-t,w=2276*c+3406*E+2048>>12,c=3406*c-2276*E+2048>>12,E=w,w=799*b+4017*e+2048>>12,b=4017*b-799*e+2048>>12,e=w,C[S]=y+E,C[S+7]=y-E,C[S+1]=k+e,C[S+6]=k-e,C[S+2]=t+b,C[S+5]=t-b,C[S+3]=n+c,C[S+4]=n-c);for(L=0;8>L;++L)w=C[L],m=C[L+8],g=C[L+16],b=C[L+24],c=C[L+32],e=C[L+40],a=C[L+48],E=C[L+56],0===(m|g|b|c|e|a|E)?(w=5793*w+8192>>14,w=-2040>w?0:2024<=w?255:w+2056>>4,H[I+L]=w,H[I+L+8]=w,H[I+L+16]=w,H[I+L+24]=w,H[I+L+
32]=w,H[I+L+40]=w,H[I+L+48]=w,H[I+L+56]=w):(y=5793*w+2048>>12,k=5793*c+2048>>12,t=g,n=a,c=2896*(m-E)+2048>>12,E=2896*(m+E)+2048>>12,y=(y+k+1>>1)+4112,k=y-k,w=3784*t+1567*n+2048>>12,t=1567*t-3784*n+2048>>12,n=w,c=c+e+1>>1,e=c-e,E=E+b+1>>1,b=E-b,y=y+n+1>>1,n=y-n,k=k+t+1>>1,t=k-t,w=2276*c+3406*E+2048>>12,c=3406*c-2276*E+2048>>12,E=w,w=799*b+4017*e+2048>>12,b=4017*b-799*e+2048>>12,e=w,w=y+E,E=y-E,m=k+e,a=k-e,g=t+b,e=t-b,b=n+c,c=n-c,w=16>w?0:4080<=w?255:w>>4,m=16>m?0:4080<=m?255:m>>4,g=16>g?0:4080<=g?
255:g>>4,b=16>b?0:4080<=b?255:b>>4,c=16>c?0:4080<=c?255:c>>4,e=16>e?0:4080<=e?255:e>>4,a=16>a?0:4080<=a?255:a>>4,E=16>E?0:4080<=E?255:E>>4,H[I+L]=w,H[I+L+8]=m,H[I+L+16]=g,H[I+L+24]=b,H[I+L+32]=c,H[I+L+40]=e,H[I+L+48]=a,H[I+L+56]=E)}return d.blockData}function B(f,d,u){var F=f.length-1;u=u<d?u:d;if(d>=F)return null;var p=f[d]<<8|f[d+1];if(65472<=p&&65534>=p)return{invalid:null,marker:p,offset:d};for(d=f[u]<<8|f[u+1];!(65472<=d&&65534>=d);){if(++u>=F)return null;d=f[u]<<8|f[u+1]}return{invalid:p.toString(16),
marker:d,offset:u}}if(!self||!self.Uint8ClampedArray)return null;var r=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]);U.prototype={parse:function(f){function d(){var L=f[p]<<8|f[p+1];p+=2;return L}function u(){var L=d();L=p+L-2;var H=B(f,L,p);H&&H.invalid&&(console.log("readDataBlock - incorrect length, next marker is: "+H.invalid),L=H.offset);L=
f.subarray(p,L);p+=L.length;return L}function F(L){for(var H=Math.ceil(L.samplesPerLine/8/L.maxH),S=Math.ceil(L.scanLines/8/L.maxV),x=0;x<L.components.length;x++){C=L.components[x];var h=Math.ceil(Math.ceil(L.samplesPerLine/8)*C.h/L.maxH),G=Math.ceil(Math.ceil(L.scanLines/8)*C.v/L.maxV);C.blockData=new Int16Array(64*S*C.v*(H*C.h+1));C.blocksPerLine=h;C.blocksPerColumn=G}L.mcusPerLine=H;L.mcusPerColumn=S}var p=0,l=null,w=null,E=[],a=[],e=[],c=d();if(65496!==c)throw new A("SOI not found");for(c=d();65497!==
c;){switch(c){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var b=u();65504===c&&74===b[0]&&70===b[1]&&73===b[2]&&70===b[3]&&0===b[4]&&(l={version:{major:b[5],minor:b[6]},densityUnits:b[7],xDensity:b[8]<<8|b[9],yDensity:b[10]<<8|b[11],thumbWidth:b[12],thumbHeight:b[13],thumbData:b.subarray(14,14+3*b[12]*b[13])});65518===c&&65===b[0]&&100===b[1]&&111===b[2]&&
98===b[3]&&101===b[4]&&(w={version:b[5]<<8|b[6],flags0:b[7]<<8|b[8],flags1:b[9]<<8|b[10],transformCode:b[11]});break;case 65499:c=d()+p-2;for(var g;p<c;){var m=f[p++],n=new Uint16Array(64);if(0===m>>4)for(b=0;64>b;b++)g=r[b],n[g]=f[p++];else if(1===m>>4)for(b=0;64>b;b++)g=r[b],n[g]=d();else throw new A("DQT - invalid table spec");E[m&15]=n}break;case 65472:case 65473:case 65474:if(t)throw new A("Only single frame JPEGs supported");d();var t={};t.extended=65473===c;t.progressive=65474===c;t.precision=
f[p++];t.scanLines=d();t.samplesPerLine=d();t.components=[];t.componentIds={};b=f[p++];for(c=n=m=0;c<b;c++){g=f[p];var k=f[p+1]>>4;var y=f[p+1]&15;m<k&&(m=k);n<y&&(n=y);k=t.components.push({h:k,v:y,quantizationId:f[p+2],quantizationTable:null});t.componentIds[g]=k-1;p+=3}t.maxH=m;t.maxV=n;F(t);break;case 65476:g=d();for(c=2;c<g;){m=f[p++];n=new Uint8Array(16);for(b=k=0;16>b;b++,p++)k+=n[b]=f[p];y=new Uint8Array(k);for(b=0;b<k;b++,p++)y[b]=f[p];c+=17+k;(0===m>>4?e:a)[m&15]=Q(n,y)}break;case 65501:d();
var I=d();break;case 65498:d();g=f[p++];b=[];for(c=0;c<g;c++){m=t.componentIds[f[p++]];var C=t.components[m];m=f[p++];C.huffmanTableDC=e[m>>4];C.huffmanTableAC=a[m&15];b.push(C)}c=f[p++];g=f[p++];m=f[p++];c=K(f,p,t,b,I,c,g,m>>4,m&15);p+=c;break;case 65535:255!==f[p]&&p--;break;default:if(255===f[p-3]&&192<=f[p-2]&&254>=f[p-2])p-=3;else throw new A("unknown marker "+c.toString(16));}c=d()}this.width=t.samplesPerLine;this.height=t.scanLines;this.jfif=l;this.eof=p;this.adobe=w;this.components=[];for(c=
0;c<t.components.length;c++){C=t.components[c];if(l=E[C.quantizationId])C.quantizationTable=l;this.components.push({output:J(t,C),scaleX:C.h/t.maxH,scaleY:C.v/t.maxV,blocksPerLine:C.blocksPerLine,blocksPerColumn:C.blocksPerColumn})}this.numComponents=this.components.length},_getLinearizedBlockData:function(f,d){var u=this.width/f,F=this.height/d,p,l,w=0,E=this.components.length,a=f*d*E,e=new Uint8ClampedArray(a),c=new Uint32Array(f);for(l=0;l<E;l++){var b=this.components[l];var g=b.scaleX*u;var m=
b.scaleY*F;w=l;var n=b.output;var t=b.blocksPerLine+1<<3;for(p=0;p<f;p++)b=0|p*g,c[p]=(b&4294967288)<<3|b&7;for(g=0;g<d;g++)for(b=0|g*m,b=t*(b&4294967288)|(b&7)<<3,p=0;p<f;p++)e[w]=n[b+c[p]],w+=E}if(d=this.decodeTransform)for(l=0;l<a;)for(f=b=0;b<E;b++,l++,f+=2)e[l]=(e[l]*d[f]>>8)+d[f+1];return e},_isColorConversionNeeded:function(){return this.adobe?!!this.adobe.transformCode:3===this.numComponents?0===this.colorTransform?!1:!0:1===this.colorTransform?!0:!1},_convertYccToRgb:function(f){for(var d,
u,F,p=0,l=f.length;p<l;p+=3)d=f[p],u=f[p+1],F=f[p+2],f[p]=d-179.456+1.402*F,f[p+1]=d+135.459-.344*u-.714*F,f[p+2]=d-226.816+1.772*u;return f},_convertYcckToRgb:function(f){for(var d,u,F,p,l=0,w=0,E=f.length;w<E;w+=4)d=f[w],u=f[w+1],F=f[w+2],p=f[w+3],f[l++]=-122.67195406894+u*(-6.60635669420364E-5*u+4.37130475926232E-4*F-5.4080610064599E-5*d+4.8449797120281E-4*p-.154362151871126)+F*(-9.57964378445773E-4*F+8.17076911346625E-4*d-.00477271405408747*p+1.53380253221734)+d*(9.61250184130688E-4*d-.00266257332283933*
p+.48357088451265)+p*(-3.36197177618394E-4*p+.484791561490776),f[l++]=107.268039397724+u*(2.19927104525741E-5*u-6.40992018297945E-4*F+6.59397001245577E-4*d+4.26105652938837E-4*p-.176491792462875)+F*(-7.78269941513683E-4*F+.00130872261408275*d+7.70482631801132E-4*p-.151051492775562)+d*(.00126935368114843*d-.00265090189010898*p+.25802910206845)+p*(-3.18913117588328E-4*p-.213742400323665),f[l++]=-20.810012546947+u*(-5.70115196973677E-4*u-2.63409051004589E-5*F+.0020741088115012*d-.00288260236853442*p+
.814272968359295)+F*(-1.53496057440975E-5*F-1.32689043961446E-4*d+5.60833691242812E-4*p-.195152027534049)+d*(.00174418132927582*d-.00255243321439347*p+.116935020465145)+p*(-3.43531996510555E-4*p+.24165260232407);return f},_convertYcckToCmyk:function(f){for(var d,u,F,p=0,l=f.length;p<l;p+=4)d=f[p],u=f[p+1],F=f[p+2],f[p]=434.456-d-1.402*F,f[p+1]=119.541-d+.344*u+.714*F,f[p+2]=481.816-d-1.772*u;return f},_convertCmykToRgb:function(f){for(var d,u,F,p,l=0,w=1/255,E=0,a=f.length;E<a;E+=4)d=f[E]*w,u=f[E+
1]*w,F=f[E+2]*w,p=f[E+3]*w,f[l++]=255+d*(-4.387332384609988*d+54.48615194189176*u+18.82290502165302*F+212.25662451639585*p-285.2331026137004)+u*(1.7149763477362134*u-5.6096736904047315*F-17.873870861415444*p-5.497006427196366)+F*(-2.5217340131683033*F-21.248923337353073*p+17.5119270841813)-p*(21.86122147463605*p+189.48180835922747),f[l++]=255+d*(8.841041422036149*d+60.118027045597366*u+6.871425592049007*F+31.159100130055922*p-79.2970844816548)+u*(-15.310361306967817*u+17.575251261109482*F+131.35250912493976*
p-190.9453302588951)+F*(4.444339102852739*F+9.8632861493405*p-24.86741582555878)-p*(20.737325471181034*p+187.80453709719578),f[l++]=255+d*(.8842522430003296*d+8.078677503112928*u+30.89978309703729*F-.23883238689178934*p-14.183576799673286)+u*(10.49593273432072*u+63.02378494754052*F+50.606957656360734*p-112.23884253719248)+F*(.03296041114873217*F+115.60384449646641*p-193.58209356861505)-p*(22.33816807309886*p+180.12613974708367);return f},getData:function(f,d,u){if(4<this.numComponents)throw new A("Unsupported color mode");
f=this._getLinearizedBlockData(f,d);if(1===this.numComponents&&u){u=f.length;d=new Uint8ClampedArray(3*u);for(var F=0,p=0;p<u;p++){var l=f[p];d[F++]=l;d[F++]=l;d[F++]=l}return d}if(3===this.numComponents&&this._isColorConversionNeeded())return this._convertYccToRgb(f);if(4===this.numComponents){if(this._isColorConversionNeeded())return u?this._convertYcckToRgb(f):this._convertYcckToCmyk(f);if(u)return this._convertCmykToRgb(f)}return f}};return U}()})})(z);D=D.getDefaultExportFromCjs(z.exports);q.JpegImage=
D})},"esri/layers/support/rasterFormats/Lerc":function(){define(["require","exports","../../../assets"],function(q,D,z){function O(B,r,f){f.set(B.slice(r,r+f.length))}function A(B){const {_malloc:r,_free:f,_lerc_getBlobInfo:d,_lerc_getDataRanges:u,_lerc_decode_4D:F,asm:p}=B;let l;const w=Object.values(p).find(a=>a&&"buffer"in a&&a.buffer===B.HEAPU8.buffer),E=a=>{a=a.map(b=>(b>>3<<3)+16);var e=a.reduce((b,g)=>b+g),c=r(e);l=new Uint8Array(w.buffer);e=a[0];a[0]=c;for(c=1;c<a.length;c++){const b=a[c];
a[c]=a[c-1]+e;e=b}return a};J.getBlobInfo=a=>{var e=new Uint8Array(48),c=new Uint8Array(24);const [b,g,m]=E([a.length,e.length,c.length]);l.set(a,b);l.set(e,g);l.set(c,m);var n=d(b,a.length,g,m,12,3);if(n)throw f(b),Error(`lerc-getBlobInfo: error code is ${n}`);l=new Uint8Array(w.buffer);O(l,g,e);O(l,m,c);e=new Uint32Array(e.buffer);var t=new Float64Array(c.buffer);const [k,y,,I,C,L,H,S,x,h,G]=e;c={version:k,depthCount:h,width:I,height:C,validPixelCount:H,bandCount:L,blobSize:S,maskCount:x,dataType:y,
minValue:t[0],maxValue:t[1],maxZerror:t[2],statistics:[],bandCountWithNoData:G};if(G&&1<h)return f(b),c;if(1===h&&1===L)return f(b),c.statistics.push({minValue:t[0],maxValue:t[1]}),c;n=h*L*8;var M=new Uint8Array(n),R=new Uint8Array(n);e=b;var X=t=0;let T=!1;l.byteLength<b+2*n?(f(b),T=!0,[e,t,X]=E([a.length,n,n]),l.set(a,e)):[t,X]=E([n,n]);l.set(M,t);l.set(R,X);if(n=u(e,a.length,h,L,t,X))throw f(e),T||f(t),Error(`lerc-getDataRanges: error code is ${n}`);l=new Uint8Array(w.buffer);O(l,t,M);O(l,X,R);
a=new Float64Array(M.buffer);n=new Float64Array(R.buffer);R=c.statistics;for(M=0;M<L;M++)if(1<h){X=a.slice(M*h,(M+1)*h);const Z=n.slice(M*h,(M+1)*h),ha=Math.min.apply(null,X),v=Math.max.apply(null,Z);R.push({minValue:ha,maxValue:v,depthStats:{minValues:X,maxValues:Z}})}else R.push({minValue:a[M],maxValue:n[M]});f(e);T||f(t);return c};J.decode=(a,e)=>{const {maskCount:c,depthCount:b,bandCount:g,width:m,height:n,dataType:t,bandCountWithNoData:k}=e;var y=U[t],I=m*n;e=new Uint8Array(I*g);y=new Uint8Array(I*
b*g*y.size);I=new Uint8Array(g);var C=new Uint8Array(8*g);const [L,H,S,x,h]=E([a.length,e.length,y.length,I.length,C.length]);l.set(a,L);l.set(e,H);l.set(y,S);l.set(I,x);l.set(C,h);if(a=F(L,a.length,c,H,b,m,n,g,t,S,x,h))throw f(L),Error(`lerc-decode: error code is ${a}`);l=new Uint8Array(w.buffer);O(l,S,y);O(l,H,e);a=null;if(k){O(l,x,I);O(l,h,C);a=[];C=new Float64Array(C.buffer);for(let G=0;G<I.length;G++)a.push(I[G]?C[G]:null)}f(L);return{data:y,maskData:e,noDataValues:a}}}const U=[{pixelType:"S8",
size:1,ctor:Int8Array,range:[-128,127]},{pixelType:"U8",size:1,ctor:Uint8Array,range:[0,255]},{pixelType:"S16",size:2,ctor:Int16Array,range:[-32768,32767]},{pixelType:"U16",size:2,ctor:Uint16Array,range:[0,65536]},{pixelType:"S32",size:4,ctor:Int32Array,range:[-2147483648,2147483647]},{pixelType:"U32",size:4,ctor:Uint32Array,range:[0,4294967296]},{pixelType:"F32",size:4,ctor:Float32Array,range:[-3.4027999387901484E38,3.4027999387901484E38]},{pixelType:"F64",size:8,ctor:Float64Array,range:[-1.7976931348623157E308,
1.7976931348623157E308]}];let Q=null,K=!1;const J={getBlobInfo:null,decode:null};D.decode=function(B,r={}){var f=r.inputOffset??0;B=B instanceof Uint8Array?B.subarray(f):new Uint8Array(B,f);f=J.getBlobInfo(B);const {data:d,maskData:u,noDataValues:F}=J.decode(B,f),{width:p,height:l,bandCount:w,depthCount:E,dataType:a,maskCount:e,statistics:c}=f;var b=U[a],g=new b.ctor(d.buffer);B=[];f=[];const m=p*l;var n=m*E;for(var t=0;t<w;t++){var k=g.subarray(t*n,(t+1)*n);if(r.returnInterleaved)B.push(k);else{a:{var y=
m,I=E;if(2>I)break a;const C=new b.ctor(y*I);for(let L=0,H=0;L<y;L++)for(let S=0,x=L;S<I;S++,x+=y)C[x]=k[H++];k=C}B.push(k)}f.push(u.subarray(t*n,(t+1)*n))}g=0===e?null:1===e?f[0]:new Uint8Array(m);if(1<e)for(g.set(f[0]),n=1;n<f.length;n++)for(t=f[n],k=0;k<m;k++)g[k]&=t[k];({noDataValue:r}=r);n=null!=r&&b.range[0]<=r&&b.range[1]>=r;if(0<e&&n)for(n=0;n<w;n++)for(t=B[n],k=f[n]||g,y=0;y<m;y++)0===k[y]&&(t[y]=r);({pixelType:b}=b);return{width:p,height:l,bandCount:w,pixelType:b,depthCount:E,statistics:c,
pixels:B,mask:g,bandMasks:e===w&&1<w?f:null,noDataValues:F}};D.getBlobInfo=function(B,r={}){B=B instanceof Uint8Array?B.subarray(r.inputOffset??0):new Uint8Array(B,r.inputOffset??0);return J.getBlobInfo(B)};D.isLoaded=function(){return K};D.load=function(){return Q?Q:Q=(new Promise((B,r)=>q(["../../../chunks/lerc-wasm"],B,r))).then(B=>B.lercWasm).then(({default:B})=>B({locateFile:r=>z.getAssetUrl(`esri/layers/support/rasterFormats/${r}`)})).then(B=>{A(B);K=!0})};D.pixelTypeInfoMap=U;Object.defineProperty(D,
Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/Lzw":function(){define(["exports"],function(q){function D(U,Q,K,J=!0){if(0!==Q%4||0!==K%4){var B=new ArrayBuffer(4*Math.ceil(K/4));B=new Uint8Array(B);U=new Uint8Array(U,Q,K);if(J)for(J=0;J<B.length;J+=4)B[J]=U[J+3],B[J+1]=U[J+2],B[J+2]=U[J+1],B[J+3]=U[J];else B.set(U);return new Uint32Array(B.buffer)}if(J){J=new Uint8Array(U,Q,K);B=new Uint8Array(J.length);for(U=0;U<B.length;U+=4)B[U]=J[U+3],B[U+1]=J[U+2],B[U+2]=J[U+1],B[U+
3]=J[U];return new Uint32Array(B.buffer)}return new Uint32Array(U,Q,K/4)}function z(){const U=[];for(let Q=0;257>=Q;Q++)U[Q]=[Q];return U}function O(U,Q){for(let K=0;K<Q.length;K++)U.push(Q[K])}const A=new Set;A.add(511);A.add(1023);A.add(2047);A.add(4095);A.add(8191);q.decode=function(U,Q,K,J=!0){U=D(U,Q,K,J);Q=9;J=z();let B=32,r=J.length,f=[],d=1,u=U[0],F=0;const p=U.length;K=8*(4*p-K);const l=[];for(;null!=u;){if(B>=Q)B-=Q,F=u>>>32-Q,u<<=Q;else{F=u>>>32-B;u=U[d++];var w=Q-B;B=32-w;F=(F<<w)+(u>>>
B);u<<=w}if(257===F)break;if(256===F)Q=9,J=z(),r=J.length,f=[];else{w=J[F];if(null==w){if(F>J.length)throw Error("data integrity issue: code does not exist on code page");f.push(f[0]);J[r++]=f.slice();O(l,f)}else O(l,w),f.push(w[0]),1<f.length&&(J[r++]=f.slice()),f=w.slice();A.has(r)&&Q++;0===B&&(u=U[d++],B=32);if(d>p||d===p&&B<=K)break}}return new Uint8Array(l)};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/Raw":function(){define(function(){const q=
z=>{let O=1;switch(z){case Uint8Array:case Int8Array:O=1;break;case Uint16Array:case Int16Array:O=2;break;case Uint32Array:case Int32Array:case Float32Array:O=4;break;case Float64Array:O=8}return O};class D{static decode(z,O){var A=O.pixelType;const U=[],Q=O.width*O.height;var K=Math.floor(z.byteLength/(O.width*O.height*q(O.pixelType)));const {bandIds:J,format:B}=O;O=J?.length||Math.floor(z.byteLength/(O.width*O.height*q(O.pixelType)));var r=z.byteLength-z.byteLength%(Q*q(A)),f=new A(z,0,Q*K);let d,
u,F,p,l=null;if("bip"===B)for(d=0;d<O;d++){F=new A(Q);p=J?J[d]:d;for(u=0;u<Q;u++)F[u]=f[u*K+p];U.push(F)}else if("bsq"===B)for(d=0;d<O;d++)p=J?J[d]:d,U.push(f.subarray(p*Q,(p+1)*Q));if(r<z.byteLength-1)if(z=z.slice(r),8*z.byteLength<Q)l=null;else{z=new Uint8Array(z,0,Math.ceil(Q/8));A=new Uint8Array(Q);for(r=f=r=O=K=0;r<z.length-1;r++)for(O=z[r],f=7;0<=f;f--)A[K++]=O>>f&1;for(f=7;K<Q-1;)O=z[z.length-1],A[K++]=O>>f&1,f--;l=A}return{pixels:U,mask:l}}}return D})},"esri/layers/support/rasterFormats/TiffDecoder":function(){define("exports ../rasterDatasets/byteStreamUtils ../../../chunks/Jpg ./Lerc ./Lzw ./pixelRangeUtils ./TiffTags ./utils ../../../chunks/Zlib".split(" "),
function(q,D,z,O,A,U,Q,K,J){function B(x,h){let G="unknown";3===x?G=64===h?"f64":"f32":1===x?1===h?G="u1":2===h?G="u2":4===h?G="u4":8>=h?G="u8":16>=h?G="u16":32>=h&&(G="u32"):2===x&&(8>=h?G="s8":16>=h?G="s16":32>=h&&(G="s32"));return G}function r(x){let h=null;switch(x?x.toLowerCase():"f32"){case "u1":case "u2":case "u4":case "u8":h=Uint8Array;break;case "u16":h=Uint16Array;break;case "u32":h=Uint32Array;break;case "s8":h=Int8Array;break;case "s16":h=Int16Array;break;case "s32":h=Int32Array;break;
case "f64":h=Float64Array;break;default:h=Float32Array}return h}function f(x,h){return{x:h[0]*x.x+h[1]*x.y+h[2],y:h[3]*x.x+h[4]*x.y+h[5]}}function d(x,h){return x.get(h)?.values?.[0]}function u(x,h,G,M=0,R=Q.tiffTags,X=4){var T=8===X;const Z=T?n(new DataView(x,G,8),0,h):(new DataView(x,G,2)).getUint16(0,h),ha=4+2*X;var v=T?8:2;T=v+Z*ha;if(G+T>x.byteLength)return{success:!1,ifd:null,nextIFD:null,requiredBufferSize:T};const N=G+T+4<=x.byteLength?t(new DataView(x,G+T,8===X?8:4),0,h,8===X):null;G+=v;
v=new Map;let P,V,Y,aa=0,fa=0;for(let da=0;da<Z;da++){var ea=new DataView(x,G+ha*da,ha);P=ea.getUint16(0,h);Y=ea.getUint16(2,h);V=Q.getTagName(P,R);const ka=[];2===X?(aa=ea.getUint16(4,h),fa=ea.getUint16(6,h)):4===X?(aa=ea.getUint32(4,h),fa=ea.getUint32(8,h)):8===X&&(aa=t(ea,4,h,!0),fa=t(ea,12,h,!0),ka.push(ea.getUint32(12,h)),ka.push(ea.getUint32(16,h)));ea={id:P,type:Y,valueCount:aa,valueOffset:fa,valueOffsets:ka,values:null};a(x,h,ea,M,!1,X);v.set(V,ea)}return{success:!0,ifd:v,nextIFD:N,requiredBufferSize:T}}
function F(x,h){if(1!==h&&2!==h&&4!==h)return x;const G=new Uint8Array(x),M=8/h;x=new Uint8Array(x.byteLength*M);let R=0;const X=2**h-1;for(let T=0;T<G.length;T++){const Z=G[T];for(let ha=0;ha<M;ha++)x[R++]=Z<<h*ha>>>8-h&X}return x.buffer}function p(x,h,G){const M=new z.JpegImage;M.parse(x);M.colorTransform=6===G?-1:0;x=M.getData(M.width,M.height,1!==h&&4!==h);return new Uint8Array(x.buffer)}function l(x){x=(new J.Zlib(x)).getBytes();var h=new ArrayBuffer(x.length);h=new Uint8Array(h);h.set(x);return h}
async function w(x,h,G,M,R){var X=K.isPlatformLittleEndian===h,T=d(G,"BITSPERSAMPLE"),Z=d(G,"SAMPLESPERPIXEL")??1,ha=d(G,"PHOTOMETRICINTERPRETATION"),v=d(G,"SAMPLEFORMAT")??1,N=B(v,T),P=d(G,"COMPRESSION")??1,V=r(N);if(34887===P)return await O.load(),O.decode(x,{inputOffset:M}).pixels[0];if(1===P)ha=x.slice(M,M+R),h=new Uint8Array(ha);else if(8===P||32946===P)h=new Uint8Array(x,M,R),h=l(h),ha=h.buffer;else if(6===P)h=new Uint8Array(x,M,R),h=p(h,Z,ha),ha=h.buffer;else if(7===P){const Y=G.get("JPEGTABLES").values,
aa=Y.length-2;h=new Uint8Array(aa+R-2);for(let fa=0;fa<aa;fa++)h[fa]=Y[fa];x=new Uint8Array(x,M+2,R-2);for(M=0;M<x.length;M++)h[aa+M]=x[M];h=p(h,Z,ha);ha=h.buffer}else if(5===P)h=A.decode(x,M,R,h),ha=h.buffer;else throw Error("tiff-decode: unsupport compression "+P);ha=F(ha,T);if("u8"!==N&&"s8"!==N&&!X)switch(ha=new ArrayBuffer(h.length),X=new Uint8Array(ha),N){case "u16":case "s16":for(N=0;N<h.length;N+=2)X[N]=h[N+1],X[N+1]=h[N];break;case "u32":case "s32":case "f32":for(N=0;N<h.length;N+=4)X[N]=
h[N+3],X[N+1]=h[N+2],X[N+2]=h[N+1],X[N+3]=h[N]}T=new V(ha);X=d(G,"PREDICTOR")??1;N=d(G,"TILEWIDTH");h=d(G,"TILELENGTH");if(1<X&&(5===P||8===P||32946===P)&&N&&h){P=c(G);V=new V(T.length);V.set(T);G=3===v&&3===X;P=P?1:Z;Z=G?4:1;v=N*Z*P;G&&(V=new Uint8Array(V.buffer));for(X=0;X<h;X++)for(T=X*v,ha=P;ha<v;ha++)V[T+ha]+=V[T+ha-P];if(G){G=new Uint8Array(V.length);P*=N;for(N=0;N<h;N++)for(X=N*v,T=0;T<P;T++)for(ha=0;ha<Z;ha++)G[X+T*Z+ha]=V[X+T+(Z-ha-1)*P];T=new Float32Array(G.buffer)}else T=V}return T}async function E(x,
h,G){const M=G.get("TILEOFFSETS")?.values;if(void 0===M)return null;const R=G.get("TILEBYTECOUNTS")?.values,{width:X,height:T,pixelType:Z,tileWidth:ha,tileHeight:v}=e([G]);var N=c(G,h);const P=d(G,"SAMPLESPERPIXEL")||h.planes;var V=X*T,Y=d(G,"BITSPERSAMPLE"),aa=34887===(d(G,"COMPRESSION")??1),fa=r(Z);const ea=[];for(var da=0;da<P;da++)ea.push(new fa(V));let ka,na,oa,pa,qa,sa,ra,ua,ma;fa=Math.ceil(X/ha);V=(new Uint8Array(V)).fill(255);da=!1;if(0===Y%8)if(aa&&N&&1<P)for(N=Math.round(M.length/P),Y=0;Y<
N;Y++){var wa=Math.floor(Y/fa)*v;oa=Y%fa*ha;pa=wa*X+oa;for(aa=0;aa<P;aa++){var W=Y*P+aa;0===R[W]?(W=null,da=!0):W=await w(x,h.littleEndian,G,M[W],R[W]);sa=0;qa=pa;ua=Math.min(ha,X-oa);ra=Math.min(v,T-wa);ma=ea[aa];for(ka=0;ka<ra;ka++)for(qa=pa+ka*X,sa=ka*ha,na=0;na<ua;na++,qa++,sa++)W?ma[qa]=W[sa]:V[qa]=0}}else for(Y=0;Y<M.length;Y++)for(wa=Math.floor(Y/fa)*v,oa=Y%fa*ha,pa=wa*X+oa,0===R[Y]?(W=null,da=!0):W=await w(x,h.littleEndian,G,M[Y],R[Y]),sa=0,qa=pa,ua=Math.min(ha,X-oa),ra=Math.min(v,T-wa),wa=
0;wa<P;wa++)if(ma=ea[wa],N||aa)for(ka=0;ka<ra;ka++)for(qa=pa+ka*X,sa=ha*v*wa+ka*ha,na=0;na<ua;na++,qa++,sa++)W?ma[qa]=W[sa]:V[qa]=0;else for(ka=0;ka<ra;ka++)for(qa=pa+ka*X,sa=ka*ha*P+wa,na=0;na<ua;na++,qa++,sa+=P)W?ma[qa]=W[sa]:V[qa]=0;return{width:X,height:T,pixelType:Z,pixels:ea,mask:da?V:void 0}}function a(x,h,G,M=0,R=!1,X=4){if(G.values)return!0;var T=G.type,Z=G.valueCount,ha=G.valueOffset;let v=[];var N=C[T],P=8*N,V=Z*N,Y=Z*C[T]*8,aa=8===X?64:32;X=G.valueOffsets;if(Y>aa&&V>(R?x.byteLength:x?
x.byteLength-ha+M:0))return G.offlineOffsetSize=[ha,V],G.values=null,!1;if(Y<=aa)if(h||(32>=aa?ha>>>=32-Y:(x=X?.length?X[0]:ha>>>0,h=X?.length?X[1]:Math.round((ha-x)/4294967296),32>=Y?(ha=x>>>32-Y,X[0]=ha):(ha=x*2**(32-Y)+(h>>>32-Y),X[0]=x,X[1]=h>>>32-Y))),1===Z&&P===aa)v=[ha];else if(64===aa)for(x=X?.length?X[0]:ha>>>0,ha=X?.length?X[1]:Math.round((ha-x)/4294967296),h=x,N=32,x=1;x<=Z;x++)V=32-P*x%32,N<P?(V=h<<V>>>32-N,Y=ha<<32-N>>>32-N,h=ha,v.push(V+Y*2**(P-N)),N-=32-(P-N)):(v.push(h<<V>>>32-P),
N-=P),0===N&&(N=32,h=ha);else for(x=1;x<=Z;x++)v.push(ha<<32-P*x>>>32-P);else for(ha-=M,R&&(ha=0),Z=ha;Z<ha+V;Z+=N){switch(T){case 1:P=(new DataView(x,Z,1)).getUint8(0);break;case 2:P=(new DataView(x,Z,1)).getUint8(0);break;case 3:P=(new DataView(x,Z,2)).getUint16(0,h);break;case 4:case 13:P=(new DataView(x,Z,4)).getUint32(0,h);break;case 5:P=(new DataView(x,Z,4)).getUint32(0,h)/(new DataView(x,Z+4,4)).getUint32(0,h);break;case 6:P=(new DataView(x,Z,1)).getInt8(0);break;case 7:P=(new DataView(x,Z,
1)).getUint8(0);break;case 8:P=(new DataView(x,Z,2)).getInt16(0,h);break;case 9:P=(new DataView(x,Z,4)).getInt32(0,h);break;case 10:P=(new DataView(x,Z,4)).getInt32(0,h)/(new DataView(x,Z+4,4)).getInt32(0,h);break;case 11:P=(new DataView(x,Z,4)).getFloat32(0,h);break;case 12:P=(new DataView(x,Z,8)).getFloat64(0,h);break;case 16:case 18:P=n(new DataView(x,Z,8),0,h);break;case 17:X=new DataView(x,Z,8);Y=(P=h)?X.getInt32(0,P):X.getUint32(0,P);X=P?X.getUint32(4,P):X.getInt32(4,P);aa=0<=(P?Y:X)?1:-1;P?
Y*=aa:X*=aa;P=aa*(P?4294967296*X+Y:4294967296*Y+X);break;default:P=null}v.push(P)}if(2===T){T="";ha=v;v=[];for(x=0;x<ha.length;x++)0===ha[x]&&""!==T?(v.push(T),T=""):T+=String.fromCharCode(ha[x]);""===T&&0!==v.length||v.push(T)}G.values=v;return!0}function e(x){var h=x[0];const G=d(h,"TILEWIDTH"),M=d(h,"TILELENGTH"),R=d(h,"IMAGEWIDTH"),X=d(h,"IMAGELENGTH");var T=d(h,"BITSPERSAMPLE");const Z=d(h,"SAMPLESPERPIXEL");var ha=d(h,"SAMPLEFORMAT")??1;const v=B(ha,T),N=c(h);var P=h.get("GDAL_NODATA")?.values;
let V=null;P?.length&&(V=P.map(ma=>parseFloat(ma)),V.some(ma=>isNaN(ma))&&(V=null));var Y=d(h,"COMPRESSION")??1;switch(Y){case 1:P="NONE";break;case 2:case 3:case 4:case 32771:P="CCITT";break;case 5:P="LZW";break;case 6:case 7:P="JPEG";break;case 32773:P="PACKBITS";break;case 8:case 32946:P="DEFLATE";break;case 34712:P="JPEG2000";break;case 34887:P="LERC";break;default:P=String(Y)}let aa=!0,fa="";L.has(Y)||(aa=!1,fa+="unsupported tag compression "+Y);3<ha&&(aa=!1,fa+="unsupported tag sampleFormat "+
ha);1!==T&&2!==T&&4!==T&&0!==T%8&&(aa=!1,fa+="unsupported tag bitsPerSample "+T);T=h.get("GEOASCIIPARAMS")?.values?.[0];if(T){var ea=(ea=T.split("|").find(ma=>ma.includes("ESRI PE String \x3d ")))?ea.replace("ESRI PE String \x3d ",""):"";ea=ea.startsWith("COMPD_CS")||ea.startsWith("PROJCS")||ea.startsWith("GEOGCS")?{wkid:null,wkt:ea}:null}ha=h.get("GEOTIEPOINTS")?.values;T=h.get("GEOPIXELSCALE")?.values;Y=h.get("GEOTRANSMATRIX")?.values;var da=h.has("GEOKEYDIRECTORY")?h.get("GEOKEYDIRECTORY").data:
null,ka=!1;h=!1;if(da){ka=2===d(da,"GTRasterTypeGeoKey");var na=d(da,"GTModelTypeGeoKey");2===na?(da=d(da,"GeographicTypeGeoKey"),1024<=da&&32766>=da&&(ea={wkid:da}),ea||32767!==da||(h=!0,ea={wkid:4326})):1===na&&(da=d(da,"ProjectedCSTypeGeoKey"),1024<=da&&32766>=da&&(ea={wkid:da}))}let oa;T&&ha&&6<=ha.length?(oa=[T[0],0,ha[3]-ha[0]*T[0],0,-Math.abs(T[1]),ha[4]-ha[1]*T[1]],ka&&(oa[2]-=.5*oa[0]+.5*oa[1],oa[5]-=.5*oa[3]+.5*oa[4])):Y&&16===Y.length&&(oa=ka?[Y[0],Y[1],Y[3]-.5*Y[0],Y[4],Y[5],Y[7]-.5*Y[5]]:
[Y[0],Y[1],Y[3],Y[4],Y[5],Y[7]]);if(oa){ha=[{x:0,y:X},{x:0,y:0},{x:R,y:X},{x:R,y:0}];da=ka=Number.POSITIVE_INFINITY;let ma=na=Number.NEGATIVE_INFINITY;for(let wa=0;wa<ha.length;wa++)Y=f(ha[wa],oa),ka=Y.x>ka?ka:Y.x,na=Y.x<na?na:Y.x,da=Y.y>da?da:Y.y,ma=Y.y<ma?ma:Y.y;ha={xmin:ka,xmax:na,ymin:da,ymax:ma,spatialReference:ea}}else ha={xmin:-.5,ymin:.5-X,xmax:R-.5,ymax:.5,spatialReference:ea};h&&(400<ha.xmax-ha.xmin||361<Math.max(Math.abs(ha.xmin),Math.abs(ha.xmax)))&&(ea=null,ha.spatialReference=null);
ea=b(x);let pa;let qa,sa;if(0<ea.length){qa=Math.round(Math.log(R/d(ea[0],"IMAGEWIDTH"))/Math.LN2);var ra=ea[ea.length-1];sa=Math.round(Math.log(R/d(ra,"IMAGEWIDTH"))/Math.LN2);pa=d(ra,"TILEWIDTH");ra=d(ra,"TILELENGTH")}pa=null!=sa&&0<sa?pa||G:null;ra=null!=sa&&0<sa?ra||M:null;let ua;G&&(ua=[{maxCol:Math.ceil(R/G)-1,maxRow:Math.ceil(X/M)-1,minRow:0,minCol:0}],ea.forEach(ma=>{ua.push({maxCol:Math.ceil(d(ma,"IMAGEWIDTH")/d(ma,"TILEWIDTH"))-1,maxRow:Math.ceil(d(ma,"IMAGELENGTH")/d(ma,"TILELENGTH"))-
1,minRow:0,minCol:0})}));Y=x[0].get("GDAL_METADATA")?.values?.[0];Y=S(Y);fa+=" "+I({width:R,height:X,tileWidth:G,tileHeight:M,planes:Z,ifds:x});x=g(x).length===ea.length+1;return{width:R,height:X,tileWidth:G,tileHeight:M,planes:Z,isBSQ:N,pixelType:v,compression:P,noData:V,hasMaskBand:x,isSupported:aa,message:fa,extent:ha,isPseudoGeographic:h,affine:T?null:oa,firstPyramidLevel:qa,maximumPyramidLevel:sa,pyramidBlockWidth:pa,pyramidBlockHeight:ra,tileBoundary:ua,metadata:Y}}function c(x,h){return(x=
x.get("PLANARCONFIGURATION")?.values)?2===x[0]:h?h.isBSQ:!1}function b(x){return x.filter(h=>1===d(h,"NEWSUBFILETYPE"))}function g(x){return x.filter(h=>{const G=4===((d(h,"NEWSUBFILETYPE")??0)&4);h=4===d(h,"PHOTOMETRICINTERPRETATION");return G&&h})}function m(x){const {littleEndian:h,isBigTiff:G,firstIFDPos:M}=k(x);var R=M;const X=[];do if(R=y(x,h,R,0,Q.tiffTags,G?8:4),R.success)X.push(R.ifd),R=R.nextIFD;else break;while(0<R);x=e(X);R=b(X);const T=g(X);return{...x,littleEndian:h,isBigTiff:G,ifds:X,
pyramidIFDs:R,maskIFDs:T}}function n(x,h,G){const M=x.getUint32(h,G);x=x.getUint32(h+4,G);return G?4294967296*x+M:4294967296*M+x}function t(x,h,G,M){return M?n(x,h,G):x.getUint32(h,G)}function k(x){var h=new DataView(x,0,16),G=h.getUint16(0,!1);x=null;if(18761===G)x=!0;else if(19789===G)x=!1;else throw Error("unexpected endianess byte");var M=h.getUint16(2,x);if(42!==M&&43!==M)throw Error("unexpected tiff identifier");G=4;if(M=43===M){const R=h.getUint16(G,x);G+=2;if(8!==R)throw Error("unsupported bigtiff version");
if(0!==h.getUint16(G,x))throw Error("unsupported bigtiff version");G+=2}h=t(h,G,x,M);return{littleEndian:x,isBigTiff:M,firstIFDPos:h}}function y(x,h,G,M=0,R=Q.tiffTags,X=4){G=u(x,h,G,M,R,X);let T;const Z=G.ifd;Z&&(Q.ifdTags.forEach((ha,v)=>{Z.has(v)&&(T=Z.get(v),T.data=u(x,h,T.valueOffset-M,M,ha).ifd)}),Z.has("GEOKEYDIRECTORY")&&(T=Z.get("GEOKEYDIRECTORY"),(R=T.values)&&4<R.length&&(R=R[0]+"."+R[1]+"."+R[2],T.data=u(x,h,T.valueOffset+6-M,M,Q.geoKeys,2).ifd,T.data&&T.data.set("GEOTIFFVersion",{id:0,
type:2,valueCount:1,valueOffset:null,values:[R]}))),Z.has("XMP")&&(T=Z.get("XMP"),R=T.values,"number"===typeof R[0]&&7===T.type&&(T.values=[D.bytesToUTF8(new Uint8Array(R))])));return G}function I(x){const {width:h,height:G,tileHeight:M,tileWidth:R}=x,X=x.planes,T=R?R*M:h*G;x=d(x.ifds[0],"BITSPERSAMPLE");let Z="";T*X>2**30/(8<x?x/8:1)&&(Z=R?"tiled tiff exceeding 1 gigabits per tile is not supported":"scanline tiff exceeding 1 gigabits is not supported");return Z}const C=[0,1,1,2,4,8,1,1,2,4,8,4,8,
-1,-1,-1,8,8,8],L=new Set([1,5,6,7,8,34712,34887]),H=(x,h,G)=>{if(!(x&&0<x.length&&h&&G))return null;let M,R,X;const T=x[0].length,Z=x.length,ha=new Uint8Array(T);for(let N=0;N<Z;N++)if(M=x[N],R=h[N],X=G[N],0===N)for(var v=0;v<T;v++)ha[v]=M[v]<R||M[v]>X?0:1;else for(v=0;v<T;v++)ha[v]&&(ha[v]=M[v]<R||M[v]>X?0:1);return ha},S=x=>{if(!x)return null;var h=x.match(/<Item(.*?)Item>/gi);if(!h||0===h.length)return null;x=new Map;var G;for(var M=0;M<h.length;M++){var R=h[M];var X=R.slice(6,R.indexOf("\x3e"));
var T=R.indexOf("sample\x3d");-1<T&&(G=R.slice(T+8,R.indexOf('"',T+8)));T=R.indexOf("name\x3d");-1<T&&(X=R.slice(T+6,R.indexOf('"',T+6)));X&&(R=R.slice(R.indexOf("\x3e")+1,R.indexOf("\x3c/Item\x3e")).trim(),null!=G?x.has(X)?x.get(X)[G]=R:x.set(X,[R]):x.set(X,R));G=null}h=x.get("STATISTICS_MINIMUM");X=x.get("STATISTICS_MAXIMUM");M=x.get("STATISTICS_MEAN");R=x.get("STATISTICS_STDDEV");G=null;if(h&&X)for(G=[],T=0;T<h.length;T++)G.push({min:parseFloat(h[T]),max:parseFloat(X[T]),avg:M&&parseFloat(M[T]),
stddev:R&&parseFloat(R[T])});X=x.get("BandName");M=x.get("WavelengthMin");R=x.get("WavelengthMax");h=null;if(X)for(h=[],T=0;T<X.length;T++)h.push({BandName:X[T],WavelengthMin:M&&parseFloat(M[T]),WavelengthMax:R&&parseFloat(R[T])});X=x.get("DataType");return{statistics:G,bandProperties:h,dataType:X,rawMetadata:x}};q.decode=async function(x,h={}){var G=h.pyramidLevel||0,M=h.headerInfo||m(x);const {ifds:R,noData:X}=M;if(0===R.length)throw Error("no valid image file directory");var T=I(M);if(T)throw T;
T=null;var Z=-1===G?R[R.length-1]:R[G];h=X??h.noDataValue;if(M.tileWidth)T=await E(x,M,Z);else{{const sa=K.isPlatformLittleEndian===M.littleEndian,ra=Z.get("STRIPOFFSETS")?.values;if(void 0===ra)T=null;else{var {width:ha,height:v,pixelType:N}=e([Z]);G=d(Z,"SAMPLESPERPIXEL")||M.planes;var P=d(Z,"PHOTOMETRICINTERPRETATION");T=ha*v;var V=d(Z,"BITSPERSAMPLE"),Y=r(N),aa=new Y(T*G),fa=Z.get("STRIPBYTECOUNTS")?.values,ea=d(Z,"ROWSPERSTRIP"),da=d(Z,"COMPRESSION")??1;var ka=ea;if(0===V%8)for(Z=0;Z<ra.length;Z++){var na=
Z*ea*ha*G;ka=(Z+1)*ea>v?v-Z*ea:ea;if("u8"===N||"s8"===N||sa)if(8===da||32946===da){var oa=new Uint8Array(x,ra[Z],fa[Z]);oa=l(oa);var pa=oa.buffer}else 6===da?(oa=new Uint8Array(x,ra[Z],fa[Z]),oa=p(oa,G,P),pa=oa.buffer):5===da?(oa=A.decode(x,ra[Z],fa[Z],M.littleEndian),pa=oa.buffer):(fa[Z]!==ka*ha*G*V/8&&console.log("strip byte counts is different than expected"),pa=x.slice(ra[Z],ra[Z]+fa[Z]));else{if(6===da||8===da||32946===da){oa=new Uint8Array(x,ra[Z],fa[Z]);var qa=l(oa);pa=qa.buffer}else fa[Z]!==
ka*ha*G*V/8&&console.log("strip byte counts is different than expected"),pa=new ArrayBuffer(fa[Z]),oa=new Uint8Array(x,ra[Z],fa[Z]),qa=new Uint8Array(pa);switch(N){case "u16":case "s16":for(ka=0;ka<oa.length;ka+=2)qa[ka]=oa[ka+1],qa[ka+1]=oa[ka];break;case "u32":case "s32":case "f32":for(ka=0;ka<oa.length;ka+=4)qa[ka]=oa[ka+3],qa[ka+1]=oa[ka+2],qa[ka+2]=oa[ka+1],qa[ka+3]=oa[ka]}}pa=F(pa,V);ka=new Y(pa);aa.set(ka,na)}P=[];if(1===G)P.push(aa);else for(Z=0;Z<G;Z++){M=new Y(T);for(x=0;x<T;x++)M[x]=aa[x*
G+Z];P.push(M)}T={width:ha,height:v,pixelType:N,pixels:P}}}}if(!T)return T;null!=h&&U.convertNoDataToMask(T,h);return T};q.decodeTileOrStrip=async function(x,h){const {headerInfo:G,ifd:M,offsets:R,sizes:X}=h;var T=[];for(var Z=0;Z<R.length;Z++){0===X[Z]?1:0;var ha=await w(x,G.littleEndian,M,R[Z],X[Z]||x.byteLength);T.push(ha)}var v=c(M,G);x=d(M,"BITSPERSAMPLE");Z=d(M,"SAMPLEFORMAT")??1;Z=B(Z,x);var N=d(M,"SAMPLESPERPIXEL")||G.planes;const P=r(Z);ha=d(M,"TILEWIDTH");const V=d(M,"TILELENGTH");var Y=
d(M,"COMPRESSION")??1;const aa=ha*V;x=[];let fa=T[0];const ea=34887===Y;for(let da=0;da<N;da++){Y=new P(aa);if(T.length===N)fa=T[da],fa.length===aa&&(Y=fa);else if(fa.length)if(v||ea)Y=fa.length===aa?fa:fa.slice(aa*da,aa*(da+1));else for(let ka=0;ka<aa;ka++)Y[ka]=fa[ka*N+da];x.push(Y)}T=G.noData?G.noData[0]:h.noDataValue;v=(N=G.metadata?G.metadata.statistics:null)?N.map(da=>da.min):null;N=N?N.map(da=>da.max):null;Z={pixelType:Z,width:ha,height:V,pixels:x,noDataValue:T};null!=T?U.convertNoDataToMask(Z,
T):v&&N&&h.applyMinMaxConstraint&&(Z.mask=H(x,v,N));return Z};q.getImageInfo=e;q.getMaskIFDs=g;q.getPyramidIFDs=b;q.isBSQConfig=c;q.parseFieldValues=a;q.parseHeader=m;q.parseIFD=y;q.parseSignature=k;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/byteStreamUtils":function(){define(["exports"],function(q){q.bytesToUTF8=function(D,z){let O=0,A="",U=0,Q=0;const K=D.length;for(;O<K;)if(Q=D[O++],U=Q>>4,8>U?U=1:15===U?(U=4,Q=(Q&7)<<18|(D[O++]&63)<<12|
(D[O++]&63)<<6|D[O++]&63):14===U?(U=3,Q=(Q&15)<<12|(D[O++]&63)<<6|D[O++]&63):(U=2,Q=(Q&31)<<6|D[O++]&63),0!==Q||z)A+=String.fromCharCode(Q);return A};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/TiffTags":function(){define(function(){const q=(()=>{const A=[];A[254]="NEWSUBFILETYPE";A[255]="SUBFILETYPE";A[256]="IMAGEWIDTH";A[257]="IMAGELENGTH";A[258]="BITSPERSAMPLE";A[259]="COMPRESSION";A[262]="PHOTOMETRICINTERPRETATION";A[263]="THRESHHOLDING";
A[264]="CELLWIDTH";A[265]="CELLLENGTH";A[266]="FILLORDER";A[269]="DOCUMENTNAME";A[270]="IMAGEDESCRIPTION";A[271]="MAKE";A[272]="MODEL";A[273]="STRIPOFFSETS";A[274]="ORIENTATION";A[277]="SAMPLESPERPIXEL";A[278]="ROWSPERSTRIP";A[279]="STRIPBYTECOUNTS";A[280]="MINSAMPLEVALUE";A[281]="MAXSAMPLEVALUE";A[282]="XRESOLUTION";A[283]="YRESOLUTION";A[284]="PLANARCONFIGURATION";A[285]="PAGENAME";A[286]="XPOSITION";A[287]="YPOSITION";A[288]="FREEOFFSETS";A[289]="FREEBYTECOUNTS";A[290]="GRAYRESPONSEUNIT";A[291]=
"GRAYRESPONSECURVE";A[292]="T4OPTIONS";A[293]="T6OPTIONS";A[296]="RESOLUTIONUNIT";A[297]="PAGENUMBER";A[300]="COLORRESPONSEUNIT";A[301]="TRANSFERFUNCTION";A[305]="SOFTWARE";A[306]="DATETIME";A[315]="ARTIST";A[316]="HOSTCOMPUTER";A[317]="PREDICTOR";A[318]="WHITEPOINT";A[319]="PRIMARYCHROMATICITIES";A[320]="COLORMAP";A[321]="HALFTONEHINTS";A[322]="TILEWIDTH";A[323]="TILELENGTH";A[324]="TILEOFFSETS";A[325]="TILEBYTECOUNTS";A[326]="BADFAXLINES";A[327]="CLEANFAXDATA";A[328]="CONSECUTIVEBADFAXLINES";A[330]=
"SUBIFD";A[332]="INKSET";A[333]="INKNAMES";A[334]="NUMBEROFINKS";A[336]="DOTRANGE";A[337]="TARGETPRINTER";A[338]="EXTRASAMPLES";A[339]="SAMPLEFORMAT";A[340]="SMINSAMPLEVALUE";A[341]="SMAXSAMPLEVALUE";A[342]="TRANSFERRANGE";A[347]="JPEGTABLES";A[512]="JPEGPROC";A[513]="JPEGIFOFFSET";A[514]="JPEGIFBYTECOUNT";A[515]="JPEGRESTARTINTERVAL";A[517]="JPEGLOSSLESSPREDICTORS";A[518]="JPEGPOINTTRANSFORM";A[519]="JPEGQTABLES";A[520]="JPEGDCTABLES";A[521]="JPEGACTABLES";A[529]="YCBCRCOEFFICIENTS";A[530]="YCBCRSUBSAMPLING";
A[531]="YCBCRPOSITIONING";A[532]="REFERENCEBLACKWHITE";A[700]="XMP";A[33550]="GEOPIXELSCALE";A[33922]="GEOTIEPOINTS";A[33432]="COPYRIGHT";A[42112]="GDAL_METADATA";A[42113]="GDAL_NODATA";A[50844]="RPCCOEFFICIENT";A[34264]="GEOTRANSMATRIX";A[34735]="GEOKEYDIRECTORY";A[34736]="GEODOUBLEPARAMS";A[34737]="GEOASCIIPARAMS";A[34665]="EXIFIFD";A[34853]="GPSIFD";A[40965]="INTEROPERABILITYIFD";return A})(),D=(()=>{const A=q.slice();A[36864]="ExifVersion";A[40960]="FlashpixVersion";A[40961]="ColorSpace";A[42240]=
"Gamma";A[37121]="ComponentsConfiguration";A[37122]="CompressedBitsPerPixel";A[40962]="PixelXDimension";A[40963]="PixelYDimension";A[37500]="MakerNote";A[37510]="UserComment";A[40964]="RelatedSoundFile";A[36867]="DateTimeOriginal";A[36868]="DateTimeDigitized";A[36880]="OffsetTime";A[36881]="OffsetTimeOriginal";A[36882]="OffsetTimeDigitized";A[37520]="SubSecTime";A[37521]="SubSecTimeOriginal";A[37522]="SubSecTimeDigitized";A[37888]="Temperature";A[37889]="Humidity";A[37890]="Pressure";A[37891]="WaterDepth";
A[37892]="Acceleration";A[37893]="CameraElevationAngle";A[42016]="ImageUniqueID";A[42032]="CameraOwnerName";A[42033]="BodySerialNumber";A[42034]="LensSpecification";A[42035]="LensMake";A[42036]="LensModel";A[42037]="LensSerialNumber";A[33434]="ExposureTime";A[33437]="FNumber";A[34850]="ExposureProgram";A[34852]="SpectralSensitivity";A[34855]="PhotographicSensitivity";A[34856]="OECF";A[34864]="SensitivityType";A[34865]="StandardOutputSensitivity";A[34866]="RecommendedExposureIndex";A[34867]="ISOSpeed";
A[34868]="ISOSpeedLatitudeyyy";A[34869]="ISOSpeedLatitudezzz";A[37377]="ShutterSpeedValue";A[37378]="ApertureValue";A[37379]="BrightnessValue";A[37380]="ExposureBiasValue";A[37381]="MaxApertureValue";A[37382]="SubjectDistance";A[37383]="MeteringMode";A[37384]="LightSource";A[37385]="Flash";A[37386]="FocalLength";A[37396]="SubjectArea";A[41483]="FlashEnergy";A[41484]="SpatialFrequencyResponse";A[41486]="FocalPlaneXResolution";A[41487]="FocalPlaneYResolution";A[41488]="FocalPlaneResolutionUnit";A[41492]=
"SubjectLocation";A[41493]="ExposureIndex";A[41495]="SensingMethod";A[41728]="FileSource";A[41729]="SceneType";A[41730]="CFAPattern";A[41985]="CustomRendered";A[41986]="ExposureMode";A[41987]="WhiteBalance";A[41988]="DigitalZoomRatio";A[41989]="FocalLengthIn35mmFilm";A[41990]="SceneCaptureType";A[41991]="GainControl";A[41992]="Contrast";A[41993]="Saturation";A[41994]="Sharpness";A[41995]="DeviceSettingDescription";A[41996]="SubjectDistanceRange";return A})(),z=(()=>{const A=[];A[1024]="GTModelTypeGeoKey";
A[1025]="GTRasterTypeGeoKey";A[1026]="GTCitationGeoKey";A[2048]="GeographicTypeGeoKey";A[2049]="GeogCitationGeoKey";A[2050]="GeogGeodeticDatumGeoKey";A[2051]="GeogPrimeMeridianGeoKey";A[2052]="GeogLinearUnitsGeoKey";A[2053]="GeogLinearUnitSizeGeoKey";A[2054]="GeogAngularUnitsGeoKey";A[2055]="GeogAngularUnitSizeGeoKey";A[2056]="GeogEllipsoidGeoKey";A[2057]="GeogSemiMajorAxisGeoKey";A[2058]="GeogSemiMinorAxisGeoKey";A[2059]="GeogInvFlatteningGeoKey";A[2061]="GeogPrimeMeridianLongGeoKey";A[2060]="GeogAzimuthUnitsGeoKey";
A[3072]="ProjectedCSTypeGeoKey";A[3073]="PCSCitationGeoKey";A[3074]="ProjectionGeoKey";A[3075]="ProjCoordTransGeoKey";A[3076]="ProjLinearUnitsGeoKey";A[3077]="ProjLinearUnitSizeGeoKey";A[3078]="ProjStdParallel1GeoKey";A[3079]="ProjStdParallel2GeoKey";A[3080]="ProjNatOriginLongGeoKey";A[3081]="ProjNatOriginLatGeoKey";A[3082]="ProjFalseEastingGeoKey";A[3083]="ProjFalseNorthingGeoKey";A[3084]="ProjFalseOriginLongGeoKey";A[3085]="ProjFalseOriginLatGeoKey";A[3086]="ProjFalseOriginEastingGeoKey";A[3087]=
"ProjFalseOriginNorthingGeoKey";A[3088]="ProjCenterLongGeoKey";A[3090]="ProjCenterEastingGeoKey";A[3091]="ProjCenterNorthingGeoKey";A[3092]="ProjScaleAtNatOriginGeoKey";A[3093]="ProjScaleAtCenterGeoKey";A[3094]="ProjAzimuthAngleGeoKey";A[3095]="ProjStraightVertPoleLongGeoKey";A[4096]="VerticalCSTypeGeoKey";A[4097]="VerticalCitationGeoKey";A[4098]="VerticalDatumGeoKey";A[4099]="VerticalUnitsGeoKey";return A})(),O=new Map;O.set("EXIFIFD",D);O.set("GPSIFD","GPSVersionID GPSLatitudeRef GPSLatitude GPSLongitudeRef GPSLongitude GPSAltitudeRef GPSAltitude GPSTimeStamp GPSSatellites GPSStatus GPSMeasureMode GPSDOP GPSSpeedRef GPSSpeed GPSTrackRef GPSTrack GPSImgDirectionRef GPSImgDirection GPSMapDatum GPSDestLatitudeRef GPSDestLatitude GPSDestLongitudeRef GPSDestLongitude GPSDestBearingRef GPSDestBearing GPSDestDistanceRef GPSDestDistance GPSProcessingMethod GPSAreaInformation GPSDateStamp GPSDifferential GPSHPositioningError".split(" "));
return{tiffTags:q,ifdTags:O,geoKeys:z,getTagName:(A,U)=>{U=(U||q)[A];void 0===U&&(U="unknown"+String(A));return U}}})},"esri/layers/support/rasterFormats/utils":function(){define(["exports"],function(q){const D=new ArrayBuffer(4),z=new Uint8Array(D);(new Uint32Array(D))[0]=1;q.isPlatformLittleEndian=1===z[0];Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/pixelUtils":function(){define(["exports","../PixelBlock","../rasterFormats/pixelRangeUtils"],
function(q,D,z){function O(a){return null!=a&&"esri.layers.support.PixelBlock"===a.declaredClass&&a.pixels&&0<a.pixels.length}function A(a,e,c,b,g){const m=a.length;g=D.createEmptyBand(g,m);if(e)for(let n=0;n<m;n++)e[n]&&(g[n]=c[a[n]-b]);else for(e=0;e<m;e++)g[e]=c[a[e]-b];return g}function U(a,e,c,b){const g=null!=c&&2<=c.length?new Set(c):null;c=1===c?.length?c[0]:null;const m=!!e?.length;for(let n=0;n<a.length;n++)if(b[n]){const t=a[n];if(m){let k=!1;for(let y=0;y<e.length;y+=2)if(t>=e[y]&&t<=
e[y+1]){k=!0;break}k||(b[n]=0)}b[n]&&(t===c||g?.has(t))&&(b[n]=0)}}function Q(a,e){const c=a[0].length;for(let b=0;b<c;b++)if(e[b]){let g=!1;for(let m=0;m<a.length;m++)if(a[m][b]){g=!0;break}g||(e[b]=0)}}function K(a,e){const c=a[0].length;for(let b=0;b<c;b++)if(e[b]){let g=!1;for(let m=0;m<a.length;m++)if(0===a[m][b]){g=!0;break}g&&(e[b]=0)}}function J(a,e,c,b,g,m,n,t){return{xmin:g<=c*a?0:g<c*a+a?g-c*a:a,ymin:m<=b*e?0:m<b*e+e?m-b*e:e,xmax:g+n<=c*a?0:g+n<c*a+a?g+n-c*a:a,ymax:m+t<=b*e?0:m+t<b*e+e?
m+t-b*e:e}}function B(a,e,c,b,g,m){const {width:n,height:t}=c.block,{x:k,y}=c.offset,{width:I,height:C}=c.mosaic;c=J(n,t,b,g,k,y,I,C);let L=0;var H=0;if(m){var S=m.hasGCSSShiftTransform?360:m.halfWorldWidth??0,x=n*m.resolutionX;const h=m.startX+b*x;h<S&&h+x>S?H=m.rightPadding:h>=S&&(L=m.leftMargin-m.rightPadding,H=0)}c.xmax-=H;if("number"===typeof e)for(m=c.ymin;m<c.ymax;m++)for(H=(g*t+m-y)*I+(b*n-k)+L,S=c.xmin;S<c.xmax;S++)a[H+S]=e;else for(m=c.ymin;m<c.ymax;m++)for(H=(g*t+m-y)*I+(b*n-k)+L,S=m*n,
x=c.xmin;x<c.xmax;x++)a[H+x]=e[S+x]}function r(a,e,c={}){const {clipOffset:b,clipSize:g,alignmentInfo:m,blockWidths:n}=c;if(n)return f(a,e,{blockWidths:n});var t=a.find(R=>O(R));if(null==t)return null;c=g?g.width:e.width;const k=g?g.height:e.height;var y=t.width,I=t.height;const C=e.width/y,L=e.height/I;e={offset:b||{x:0,y:0},mosaic:g||e,block:{width:y,height:I}};y=t.pixelType;var H=D.getPixelArrayConstructor(y);t=t.pixels.length;I=[];for(var S=0;S<t;S++){var x=new H(c*k);for(var h=0;h<L;h++)for(var G=
0;G<C;G++){var M=a[h*C+G];O(M)&&(M=M.pixels[S],B(x,M,e,G,h,m))}I.push(x)}H=a.some(R=>null==R||null!=R.mask&&0<R.mask.length);x=a.some(R=>R?.bandMasks&&1<R.bandMasks.length);H=H?new Uint8Array(c*k):void 0;x=x?[]:void 0;if(H){for(S=0;S<L;S++)for(h=0;h<C;h++)G=a[S*C+h],M=null!=G?G.mask:null,null!=M?B(H,M,e,h,S,m):G?B(H,255,e,h,S,m):B(H,0,e,h,S,m);if(x)for(S=0;S<t;S++){h=new Uint8Array(c*k);for(G=0;G<L;G++)for(M=0;M<C;M++){const R=a[G*C+M],X=R?.bandMasks?.[S]??R?.mask;null!=X?B(h,X,e,M,G,m):R?B(h,255,
e,M,G,m):B(h,0,e,M,G,m)}x.push(h)}}a=new D({width:c,height:k,pixels:I,pixelType:y,bandMasks:x,mask:H});a.updateStatistics();return a}function f(a,e,c){const b=a.find(h=>null!=h);if(null==b)return null;var g=a.some(h=>null!=h?!!h.mask:!0);const {width:m,height:n}=e;e=g?new Uint8Array(m*n):null;({blockWidths:c}=c);const t=[],k=b.getPlaneCount(),y=D.getPixelArrayConstructor(b.pixelType);if(g)for(let h=0,G=0;h<a.length;G+=c[h],h++)if(g=a[h],O(g)){var I=g.mask;for(var C=0;C<n;C++)for(var L=0;L<c[h];L++)e[C*
m+L+G]=null==I?255:I[C*g.width+L]}I=(g=a.some(h=>h?.bandMasks&&1<h.bandMasks.length))?[]:void 0;C=m*n;for(L=0;L<k;L++){const h=new y(C),G=g?new Uint8Array(C):void 0;for(let M=0,R=0;M<a.length;R+=c[M],M++){const X=a[M];if(O(X)){var H=X.pixels[L];if(null!=H){for(var S=0;S<n;S++)for(var x=0;x<c[M];x++)h[S*m+x+R]=H[S*X.width+x];if(G)for(H=X.bandMasks?.[L]??X.mask,S=0;S<n;S++)for(x=0;x<c[M];x++)G[S*m+x+R]=H?H[S*X.width+x]:255}}}t.push(h);I&&G&&I.push(G)}a=new D({width:m,height:n,mask:e,bandMasks:I,pixels:t,
pixelType:b.pixelType});a.updateStatistics();return a}function d(a){if(!O(a))return null;const e=a.clone(),{width:c,height:b,pixels:g}=a;var m=g[0];const n=e.pixels[0];a=a.mask;for(let y=2;y<b-1;y++){const I=new Map;for(var t=y-2;t<y+2;t++)for(var k=0;4>k;k++){const C=t*c+k;p(I,m[C],a?a[C]:1)}n[y*c]=u(I);n[y*c+1]=n[y*c+2]=n[y*c];for(t=3;t<c-1;t++)k=(y-2)*c+t+1,p(I,m[k],a?a[k]:1),k=(y-1)*c+t+1,p(I,m[k],a?a[k]:1),k=y*c+t+1,p(I,m[k],a?a[k]:1),k=(y+1)*c+t+1,p(I,m[k],a?a[k]:1),k=(y-2)*c+t-3,F(I,m[k],a?
a[k]:1),k=(y-1)*c+t-3,F(I,m[k],a?a[k]:1),k=y*c+t-3,F(I,m[k],a?a[k]:1),k=(y+1)*c+t-3,F(I,m[k],a?a[k]:1),n[y*c+t]=u(I);n[y*c+t+1]=n[y*c+t]}for(m=0;m<c;m++)n[m]=n[c+m]=n[2*c+m],n[(b-1)*c+m]=n[(b-2)*c+m];e.updateStatistics();return e}function u(a){if(0===a.size)return 0;let e=0,c=-1,b=0;const g=a.keys();let m=g.next();for(;!m.done;)b=a.get(m.value),b>e&&(c=m.value,e=b),m=g.next();return c}function F(a,e,c){0!==c&&(c=a.get(e),1===c?a.delete(e):a.set(e,c-1))}function p(a,e,c){0!==c&&a.set(e,a.has(e)?a.get(e)+
1:1)}function l(a,e,c){let {x:b,y:g}=e;const {width:m,height:n}=c;if(0===b&&0===g&&n===a.height&&m===a.width)return a;const {width:t,height:k}=a;e=Math.max(0,g);const y=Math.max(0,b),I=Math.min(b+m,t),C=Math.min(g+n,k);if(0>I||0>C||!O(a))return null;b=Math.max(0,-b);g=Math.max(0,-g);var {pixels:L}=a,H=m*n,S=L.length;const x=[];for(var h=0;h<S;h++){var G=L[h],M=D.createEmptyBand(a.pixelType,H);for(let R=e;R<C;R++){const X=R*t;let T=(R+g-e)*m+b;for(let Z=y;Z<I;Z++)M[T++]=G[X+Z]}x.push(M)}L=new Uint8Array(H);
H=a.mask;for(S=e;S<C;S++)for(h=S*t,G=(S+g-e)*m+b,M=y;M<I;M++)L[G++]=H?H[h+M]:1;a=new D({width:c.width,height:c.height,pixelType:a.pixelType,pixels:x,mask:L});a.updateStatistics();return a}function w(a,e=!0){if(!O(a))return null;const {pixels:c,width:b,height:g,mask:m,pixelType:n}=a;a=[];const t=Math.round(b/2),k=Math.round(g/2),y=g-1,I=b-1;for(var C=0;C<c.length;C++){var L=c[C],H=D.createEmptyBand(n,t*k),S=0;for(var x=0;x<g;x+=2)for(var h=0;h<b;h+=2){var G=L[x*b+h];if(e){var M=h===I?G:L[x*b+h+1];
const R=x===y?G:L[x*b+h+b],X=h===I?R:x===y?M:L[x*b+h+b+1];H[S++]=(G+M+R+X)/4}else H[S++]=G}a.push(H)}C=null;if(null!=m)for(C=new Uint8Array(t*k),L=0,H=0;H<g;H+=2)for(S=0;S<b;S+=2)x=m[H*b+S],e?(h=S===I?x:m[H*b+S+1],G=H===y?x:m[H*b+S+b],M=S===I?G:H===y?h:m[H*b+S+b+1],C[L++]=x*h*G*M?1:0):C[L++]=x;return new D({width:t,height:k,pixelType:n,pixels:a,mask:C})}function E(a,e,c,b,g=0){const {width:m,height:n}=a,{width:t,height:k}=e;a=b.cols;b=b.rows;e=Math.ceil(t/a-.1/a);const y=Math.ceil(k/b-.1/b);let I,
C,L,H,S;const x=e*a;var h=x*y*b;const G=new Float32Array(h),M=new Float32Array(h),R=new Uint32Array(h),X=new Uint32Array(h);let T=0,Z,ha;for(let P=0;P<y;P++)for(let V=0;V<e;V++){var v=12*(P*e+V);h=c[v];I=c[v+1];C=c[v+2];L=c[v+3];H=c[v+4];S=c[v+5];for(var N=0;N<b;N++){T=(P*b+N)*x+V*a;ha=(N+.5)/b;for(let Y=0;Y<N;Y++)Z=(Y+.5)/a,G[T+Y]=(h*Z+I*ha+C)*m+g,M[T+Y]=(L*Z+H*ha+S)*n+g,R[T+Y]=Math.floor(G[T+Y]),X[T+Y]=Math.floor(M[T+Y])}v+=6;h=c[v];I=c[v+1];C=c[v+2];L=c[v+3];H=c[v+4];S=c[v+5];for(v=0;v<b;v++)for(T=
(P*b+v)*x+V*a,ha=(v+.5)/b,N=v;N<a;N++)Z=(N+.5)/a,G[T+N]=(h*Z+I*ha+C)*m+g,M[T+N]=(L*Z+H*ha+S)*n+g,R[T+N]=Math.floor(G[T+N]),X[T+N]=Math.floor(M[T+N])}return{offsets_x:G,offsets_y:M,offsets_xi:R,offsets_yi:X,gridWidth:x}}q.NoDataInterpretation=void 0;(function(a){a[a.matchAny=0]="matchAny";a[a.matchAll=1]="matchAll"})(q.NoDataInterpretation||(q.NoDataInterpretation={}));q.MissingBandAction=void 0;(function(a){a[a.bestMatch=0]="bestMatch";a[a.fail=1]="fail"})(q.MissingBandAction||(q.MissingBandAction=
{}));q.approximateTransform=function(a,e,c,b,g="nearest"){if(!O(a))return null;"majority"===g&&(a=d(a));const {pixels:m,mask:n,bandMasks:t,pixelType:k}=a,y=a.width;var I=a.height;const C=D.getPixelArrayConstructor(k),L=m.length,{width:H,height:S}=e;a=!1;for(var x=0;x<c.length;x+=3)-1===c[x]&&-1===c[x+1]&&-1===c[x+2]&&(a=!0);const {offsets_x:h,offsets_y:G,offsets_xi:M,offsets_yi:R,gridWidth:X}=E({width:y,height:I},e,c,b,"majority"===g?.5:0);let T;e=(ha,v,N,P)=>{const V=ha instanceof Float32Array||
ha instanceof Float64Array?0:.5;for(let Y=0;Y<S;Y++){T=Y*X;for(let aa=0;aa<H;aa++){if(0>h[T]||0>G[T])ha[Y*H+aa]=0;else if(P)ha[Y*H+aa]=v[M[T]+R[T]*y];else{const fa=Math.floor(h[T]),ea=Math.floor(G[T]),da=Math.ceil(h[T]),ka=Math.ceil(G[T]),na=h[T]-fa,oa=G[T]-ea;ha[Y*H+aa]=!N||N[fa+ea*y]&&N[da+ea*y]&&N[fa+ka*y]&&N[da+ka*y]?(1-oa)*((1-na)*v[fa+ea*y]+na*v[da+ea*y])+oa*((1-na)*v[fa+ka*y]+na*v[da+ka*y])+V:v[M[T]+R[T]*y]}T++}}};c=[];b=t?.length===L;I=[];for(x=0;x<L;x++){if(b){var Z=new Uint8Array(H*S);e(Z,
t[x],t[x],!0);I.push(Z)}Z=new C(H*S);e(Z,m[x],b?t[x]:n,"nearest"===g||"majority"===g);c.push(Z)}g=new D({width:H,height:S,pixelType:k,pixels:c,bandMasks:b?I:void 0});if(null!=n)g.mask=new Uint8Array(H*S),e(g.mask,n,n,!0);else if(a)for(g.mask=new Uint8Array(H*S),a=0;a<H*S;a++)g.mask[a]=0>h[a]||0>G[a]?0:1;g.updateStatistics();return g};q.clip=l;q.colorize=function(a,e){if(!O(a)||!e||!e.indexedColormap&&!e.indexed2DColormap)return a;const c=a.clone();var b=c.pixels;let g=c.mask;const m=c.width*c.height;
if(1!==b.length)return a;const {indexedColormap:n,indexed2DColormap:t,offset:k,alphaSpecified:y}=e;a=0;b=b[0];e=new Uint8Array(b.length);const I=new Uint8Array(b.length),C=new Uint8Array(b.length);var L=0;if(n){const H=n.length-1;if(null!=g)for(a=0;a<m;a++)g[a]&&(L=4*(b[a]-k),L<k||L>H?g[a]=0:(e[a]=n[L],I[a]=n[L+1],C[a]=n[L+2],g[a]=n[L+3]));else{g=new Uint8Array(m);for(a=0;a<m;a++)L=4*(b[a]-k),L<k||L>H?g[a]=0:(e[a]=n[L],I[a]=n[L+1],C[a]=n[L+2],g[a]=n[L+3]);c.mask=g}}else if(t)if(null!=g)for(a=0;a<
m;a++)g[a]&&(L=t[b[a]],e[a]=L[0],I[a]=L[1],C[a]=L[2],g[a]=L[3]);else{g=new Uint8Array(m);for(a=0;a<m;a++)L=t[b[a]],e[a]=L[0],I[a]=L[1],C[a]=L[2],g[a]=L[3];c.mask=g}c.pixels=[e,I,C];c.statistics=null;c.pixelType="u8";c.maskIsAlpha=y;return c};q.compositeBands=function(a){if(!a?.length||a.some(k=>!O(k)))return null;if(1===a.length)return a[0]?.clone()??null;const {width:e,height:c,pixelType:b}=a[0];if(a.some(k=>k.width!==e||k.height!==c))return null;const g=a.map(({mask:k})=>k).filter(k=>null!=k);let m=
null;g.length&&(m=new Uint8Array(e*c),m.set(g[0]),1<g.length&&K(g.slice(1),m));const n=[];a.forEach(({pixels:k})=>n.push(...k));const t=[];a.map(({statistics:k})=>k).filter(k=>k?.length).forEach(k=>t.push(...k));return new D({pixelType:b,width:e,height:c,mask:m,pixels:n,statistics:t.length?t:null})};q.createColormapLUT=function(a){if(a){var e=a.colormap;if(e&&0!==e.length){e=e.sort((y,I)=>y[0]-I[0]);var c=0;0>e[0][0]&&(c=e[0][0]);var b=Math.max(256,e[e.length-1][0]-c+1),g=new Uint8Array(4*b),m=[],
n=0,t=0,k=5===e[0].length;if(65536<b)return e.forEach(y=>{m[y[0]-c]=k?y.slice(1):y.slice(1).concat([255])}),{indexed2DColormap:m,offset:c,alphaSpecified:k};if(a.fillUnspecified)for(a=e[t],n=a[0]-c;n<b;n++)g[4*n]=a[1],g[4*n+1]=a[2],g[4*n+2]=a[3],g[4*n+3]=k?a[4]:255,n===a[0]-c&&(a=t===e.length-1?a:e[++t]);else for(n=0;n<e.length;n++)a=e[n],t=4*(a[0]-c),g[t]=a[1],g[t+1]=a[2],g[t+2]=a[3],g[t+3]=k?a[4]:255;return{indexedColormap:g,offset:c,alphaSpecified:k}}}};q.createMaskLUT=function(a,e,c){if("u8"!==
a&&"s8"!==a&&"u16"!==a&&"s16"!==a)return null;var b=a.includes("16")?65536:256;a=a.includes("s")?-b/2:0;b=new Uint8Array(b);if(e)for(let m=0;m<e.length;m++){var g=Math.ceil(e[2*m]-a);const n=Math.floor(e[2*m+1]-a);for(;g<=n;g++)b[g]=255}else b.fill(255);if(c)for(e=0;e<c.length;e++)b[c[e]-a]=0;return{lut:b,offset:a}};q.createRemapLUT=function(a){const {srcPixelType:e,inputRanges:c,outputValues:b,allowUnmatched:g,noDataRanges:m,isLastInputRangeInclusive:n,outputPixelType:t}=a;if("u8"!==e&&"s8"!==e&&
"u16"!==e&&"s16"!==e)return null;var k=e.includes("16")?65536:256;a=e.includes("s")?-k/2:0;const y=D.createEmptyBand(t,k);k=new Uint8Array(k);g&&k.fill(255);const [I,C]=z.getPixelValueRange(t);if(c?.length&&b?.length){var L=c.map(h=>h-1E-6);L[0]=c[0];n&&(L[L.length-1]=c[c.length-1]);for(var H=0;H<L.length;H++){var S=b[H]>C?C:b[H]<I?I:b[H],x=Math.ceil(L[2*H]-a);const h=Math.floor(L[2*H+1]-a);for(;x<=h;x++)y[x]=S,k[x]=255}}if(m?.length)for(L=0;L<m.length;L++)for(S=Math.ceil(m[2*L]-a),H=Math.floor(m[2*
L+1]-a);S<=H;S++)k[S]=0;return{lut:y,offset:a,mask:k}};q.extractBands=function(a,e){return e?.length&&O(a)?a.extractBands(e):a};q.getClipBounds=J;q.getLocalArithmeticNorthRotations=function(a,e){const {coefficients:c,spacing:b}=e,{offsets_x:g,offsets_y:m,gridWidth:n}=E(a,a,c,{rows:b[0],cols:b[1]}),{width:t,height:k}=a;a=new Float32Array(t*k);e=180/Math.PI;for(let C=0;C<k;C++)for(let L=0;L<t;L++){var y=C*n+L,I=0===C?y:y-n;const H=C===k-1?y:y+n;y=g[I]-g[H];I=m[H]-m[I];isNaN(y)||isNaN(I)?a[C*t+L]=90:
(I=Math.atan2(I,y)*e,I=(360+I)%360,a[C*t+L]=I)}return a};q.interpolateOffsets=E;q.isValidPixelBlock=O;q.lookupBandValues=A;q.lookupPixels=function(a,e){if(!O(a))return null;const {pixels:c,mask:b}=a,g=c.length;let m=e.lut;const {offset:n}=e;m&&1===m[0].length&&(m=c.map(()=>m));const t=[];e=e.outputPixelType||"u8";for(let k=0;k<g;k++){const y=A(c[k],b,m[k],n||0,e);t.push(y)}a=new D({width:a.width,height:a.height,pixels:t,mask:b,pixelType:e});a.updateStatistics();return a};q.mask=function(a,e){if(!O(a))return null;
const {width:c,height:b,pixels:g}=a;var m=c*b;const n=new Uint8Array(m);a.mask?n.set(a.mask):n.fill(255);a=g.length;const {includedRanges:t,noDataValues:k,outputPixelType:y,matchAll:I,lookups:C}=e;if(C){m=[];for(e=0;e<a;e++){var L=C[e];L=A(g[e],n,L.lut,L.offset||0,"u8");m.push(L)}1===m.length?n.set(m[0]):I?Q(m,n):K(m,n)}else if(I){e=[];for(L=0;L<a;L++){const H=new Uint8Array(m);H.set(n);U(g[L],t?.slice(2*L,2*L+2),k?.[L],H);e.push(H)}1===e.length?n.set(e[0]):Q(e,n)}else for(m=0;m<a;m++)U(g[m],t?.slice(2*
m,2*m+2),k?.[m],n);return new D({width:c,height:b,pixelType:y,pixels:g,mask:n})};q.maxMapSizeGpu=6;q.mosaic=r;q.mosaicPixelData=function(a,e){if(!a||0===a.length)return null;var c=a.find(C=>C.pixelBlock);if(null==c?.pixelBlock)return null;var b=(c.extent.xmax-c.extent.xmin)/c.pixelBlock.width;const g=(c.extent.ymax-c.extent.ymin)/c.pixelBlock.height,m=.01*Math.min(b,g),n=a.sort((C,L)=>Math.abs(C.extent.ymax-L.extent.ymax)>m?L.extent.ymax-C.extent.ymax:Math.abs(C.extent.xmin-L.extent.xmin)>m?C.extent.xmin-
L.extent.xmin:0);var t=Math.min.apply(null,n.map(C=>C.extent.xmin));const k=Math.min.apply(null,n.map(C=>C.extent.ymin)),y=Math.max.apply(null,n.map(C=>C.extent.xmax)),I=Math.max.apply(null,n.map(C=>C.extent.ymax));a={x:Math.round((e.xmin-t)/b),y:Math.round((I-e.ymax)/g)};t={width:Math.round((y-t)/b),height:Math.round((I-k)/g)};b={width:Math.round((e.xmax-e.xmin)/b),height:Math.round((e.ymax-e.ymin)/g)};if(Math.round(t.width/c.pixelBlock.width)*Math.round(t.height/c.pixelBlock.height)!==n.length||
0>a.x||0>a.y||t.width<b.width||t.height<b.height)return null;c=n.map(C=>C.pixelBlock);c=r(c,t,{clipOffset:a,clipSize:b});return{extent:e,pixelBlock:c}};q.remap=function(a,e){if(!O(a))return null;const {width:c,height:b}=a,{inputRanges:g,outputValues:m,outputPixelType:n,noDataRanges:t,allowUnmatched:k,isLastInputRangeInclusive:y}=e;e=a.pixels[0];const I=D.createEmptyBand(n,e.length),C=a.mask,L=new Uint8Array(c*b);C?L.set(C):L.fill(255);const H=a.pixelType.startsWith("f")?1E-6:0;a=g.map(T=>T-H);a[0]=
g[0];a[a.length-1]=g[g.length-1]+(y?1E-6:0);var S=g.length/2;const [x,h]=z.getPixelValueRange(n);for(var G=0;G<b;G++)for(var M=0;M<c;M++){var R=G*c+M;if(L[R]){var X=e[R];let T=!1;for(let Z=S-1;0<=Z;Z--)if(X===a[2*Z]||X>a[2*Z]&&X<a[2*Z+1]){I[R]=m[Z];T=!0;break}T||(k?I[R]=X>h?h:X<x?x:X:L[R]=0)}}if(a=t?.length)for(S=0;S<b;S++)for(G=0;G<c;G++)if(M=S*c+G,!C||C[M])for(R=e[M],X=0;X<a;X+=2)if(R>=t[X]&&R<=t[X+1]){I[M]=0;L[M]=0;break}return new D({width:c,height:b,pixelType:n,pixels:[I],mask:L})};q.remapColor=
function(a,e){if(!O(a))return null;a=a.clone();var {pixels:c}=a;const b=a.width*a.height,g=e.length,m=Math.floor(g/2),n=e[Math.floor(m)];c=c[0];let t,k,y,I,C,L,H=!1;const S=new Uint8Array(b),x=new Uint8Array(b),h=new Uint8Array(b);let G=a.mask;const M=4===e[0].mappedColor.length;G||(G=new Uint8Array(b),G.fill(M?255:1),a.mask=G);for(C=0;C<b;C++)if(G[C]){t=c[C];H=!1;L=m;k=n;y=0;for(I=g-1;1<I-y;){if(t===k.value){H=!0;break}t>k.value?y=L:I=L;L=Math.floor((y+I)/2);k=e[Math.floor(L)]}H||(t===e[y].value?
(k=e[y],H=!0):t===e[I].value?(k=e[I],H=!0):t<e[y].value?(H=!1,k=null):t>e[y].value&&(t<e[I].value?(k=e[y],H=!0):I===g-1?(H=!1,k=null):(k=e[I],H=!0)));H?(S[C]=k.mappedColor[0],x[C]=k.mappedColor[1],h[C]=k.mappedColor[2],G[C]=k.mappedColor[3]):S[C]=x[C]=h[C]=G[C]=0}a.pixels=[S,x,h];a.mask=G;a.pixelType="u8";a.maskIsAlpha=M;return a};q.resampleByMajority=d;q.setValidBoundary=function(a,e,c){if(!O(a))return null;const {width:b,height:g}=a,m=e.x;e=e.y;const n=c.width+m;c=c.height+e;if(0>m||0>e||n>b||c>
g||0===m&&0===e&&n===b&&c===g)return a;a.mask||(a.mask=new Uint8Array(b*g));const t=a.mask;for(let k=0;k<g;k++){const y=k*b;for(let I=0;I<b;I++)t[y+I]=k<e||k>=c||I<m||I>=n?0:1}a.updateStatistics();return a};q.split=function(a,e,c){if(!O(a))return null;const {width:b,height:g}=e;let {width:m,height:n}=a;const t=new Map,k={x:0,y:0};c=null==c?1:1+c;for(let y=0;y<c;y++){const I=Math.ceil(m/b),C=Math.ceil(n/g);for(let L=0;L<C;L++){k.y=L*g;for(let H=0;H<I;H++){k.x=H*b;const S=l(a,k,e);t.set(`${y}/${L}/${H}`,
S)}}y<c-1&&(a=w(a));m=Math.round(m/2);n=Math.round(n/2)}return t};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/rasterFunctionHelper":function(){define("exports ../../../core/colorUtils ../../../core/Error ../../../core/lang ./AspectFunction ./BandArithmeticFunction ./ColormapFunction ./CompositeBandFunction ./ContrastBrightnessFunction ./ConvolutionFunction ./CurvatureFunction ./ExtractBandFunction ./LocalFunction ./MaskFunction ./NDVIFunction ./RemapFunction ./SlopeFunction ./StatisticsFunction ./StatisticsHistogramFunction ./StretchFunction ./TableFunction".split(" "),
function(q,D,z,O,A,U,Q,K,J,B,r,f,d,u,F,p,l,w,E,a,e){function c(h,G){({rasterFunctionArguments:h}=h);h&&(h.rasters||[h.raster]).forEach(M=>{M&&"number"!==typeof M&&("string"===typeof M?M.startsWith("http")&&(G.includes(M)||G.push(M)):"rasterFunctionArguments"in M&&c(M,G))})}function b(h,G){return"rasters"===G[0]&&Array.isArray(h.rasters)?h.rasters:G.map(M=>h[M])}function g(h){return!!(h&&"object"===typeof h&&h.rasterFunction&&h.rasterFunctionArguments)}function m(h){const {rasterFunction:G,rasterFunctionArguments:M}=
h,R={};for(const T in M){let Z=M[T];var X=T.toLowerCase();if("rasters"===X&&Array.isArray(Z))R.rasters=Z.map(ha=>g(ha)?m(ha):ha);else switch(g(Z)&&(Z=m(Z)),X){case "dra":R.dra=Z;break;case "pspower":R.psPower=Z;break;case "pszfactor":R.psZFactor=Z;break;case "bandids":R.bandIds=Z;break;default:X=T[0].toLowerCase()+T.slice(1),R[X]=Z}}"Local"!==G||R.rasters?.length||(R.rasters=["$$"]);return{...h,rasterFunctionArguments:R}}function n(h,G){const {rasterFunction:M,rasterFunctionArguments:R}=h;var X=h.outputPixelType?.toLowerCase();
if(null==M||!x.has(M))throw new z("raster-function-helper",`unsupported raster function: ${M}`);var T=x.get(M);h=("function"===typeof T.ctor?T.ctor:T.ctor["default"]).fromJSON({...h,outputPixelType:X});({rasterArgumentNames:X}=h);T=[];const Z=b(R,X),ha="rasters"===X[0],v=[];for(let N=0;N<Z.length;N++){const P=Z[N];let V;null==P||"string"===typeof P&&P.startsWith("$")?T.push(G?.raster):"string"===typeof P?G[P]&&T.push(G[P]):"number"!==typeof P&&"rasterFunction"in P&&(V=n(P,G),ha||(h.functionArguments[X[N]]=
V),T.push(V));ha&&v.push(V??P)}ha&&(h.functionArguments.rasters=v);G&&(h.sourceRasters=T,G=G.raster?.url)&&(h.mainPrimaryRasterId=G);return h}function t(h,G){if(h&&G)for(const M in h){const R=h[M];R&&"object"===typeof R&&"type"in R&&("RasterFunctionTemplate"===R.type?t(R.arguments,G):"RasterFunctionVariable"===R.type&&null!=G[R.name]&&(R.value=G[R.name]))}}function k(h,G){if(!h||"object"!==typeof h)return h;const {value:M}=h;if(!M||"object"!==typeof M)return h.isDataset?"$$":M;if(Array.isArray(M))return 0===
M.length?[]:M.map(X=>"object"===typeof X&&"RasterFunctionVariable"===X.type?k(X,G):X);if("value"in M&&["number","string","boolean"].includes(typeof M.value))return M.value;if(h.isDataset&&"Scalar"!==M.type)return"$$";if(!("type"in M))return M;h=M;switch(M.type){case "Scalar":h=M.value;break;case "AlgorithmicColorRamp":h=y(M);break;case "MultiPartColorRamp":h={type:"multipart",colorRamps:M.ArrayOfColorRamp.map(y)};break;case "ArgumentArray":if(M.elements?.length&&"RasterStatistics"!==M.elements[0].type){h=
[];for(let X=0;X<M.elements.length;X++){const T=M.elements[X];var {type:R}=T;if(R)if("RasterFunctionTemplate"===R)({renderingRule:R}=I(T,G)),h.push(R),null!=T._object_id&&G.set(T._object_id,R);else if("RasterFunctionVariable"===R)R=k(T,G),h.push(R),null!=T._object_id&&G.set(T._object_id,R);else throw new z("raster-function-helper","unsupported raster function json.");else h.push(T)}}else h=M.elements}null!=M._object_id&&G.set(M._object_id,h);return h}function y(h){const G=h.algorithm??"esriHSVAlgorithm";
let {FromColor:M,ToColor:R}=h;if(!Array.isArray(M)){const {r:X,g:T,b:Z}=D.toRGB({h:M.Hue,s:M.Saturation,v:M.Value});M=[X,T,Z,M.AlphaValue]}if(!Array.isArray(R)){const {r:X,g:T,b:Z}=D.toRGB({h:R.Hue,s:R.Saturation,v:R.Value});R=[X,T,Z,R.AlphaValue]}return{type:"algorithmic",algorithm:G,fromColor:M,toColor:R}}function I(h,G,M){M&&t(h,M);G={renderingRule:{},templates:G};C(h,G);return G}function C(h,G){if(h&&G.renderingRule){var {renderingRule:M,templates:R}=G,{function:X,arguments:T,_object_id:Z}=h;
if(X&&T){null!=Z&&R.set(Z,M);M.rasterFunction=X.type.replace("Function","");M.outputPixelType=X.pixelType;h={};M.rasterFunctionArguments=h;for(const ha in T)"type"!==ha&&"object_id"!==ha&&"_object_ref_id"!==ha&&((G=T[ha])&&"object"===typeof G&&"type"in G&&("RasterFunctionTemplate"===G.type||"RasterFunctionVariable"===G.type)?("RasterFunctionVariable"===G.type?h[ha]=k(G,R):(M.rasterFunctionArguments[ha]={},C(G,{renderingRule:M.rasterFunctionArguments[ha],templates:R})),null!=G._object_id&&R.set(G._object_id,
h[ha])):h[ha]=G);h.DEM&&!h.Raster&&(h.Raster=h.DEM,delete h.DEM);switch(M.rasterFunction){case "Stretch":H(h);break;case "Colormap":"randomcolorramp"===h.ColorRamp?.type?.toLowerCase()&&(delete h.ColorRamp,h.ColormapName="Random");0===h.ColorSchemeType&&delete h.ColorRamp;break;case "Convolution":null!=h.ConvolutionType&&(h.Type=h.ConvolutionType,delete h.ConvolutionType);break;case "Mask":S(h)}}}}function L(h){const {renderingRule:G,templates:M}=h;if("object"===typeof G&&G?.rasterFunctionArguments&&
M.size){({rasterFunctionArguments:h}=G);for(const R in h){const X=h[R],T="_object_ref_id"===R?X:X&&"object"===typeof X&&"_object_ref_id"in X?X._object_ref_id:null;if(null!=T){if(!M.has(T))throw new z("raster-function-helper",`unsupported raster function json. _object_ref_id: ${T} does not exist`);const Z=M.get(T);"_object_ref_id"!==R?h[R]=Z:Z&&"object"===typeof Z&&Object.assign(h,Z)}else X&&"object"===typeof X&&(X.rasterFunctionArguments&&L({renderingRule:X,templates:M}),Array.isArray(X)&&X.forEach((Z,
ha)=>{if("object"===typeof Z)if(null!=Z._object_ref_id){if(!M.has(Z._object_ref_id))throw new z("raster-function-helper",`unsupported raster function json. _object_ref_id: ${X} does not exist`);const v=M.get(T);v&&"object"===typeof v?Object.assign(Z,v):X[ha]=v}else L({renderingRule:Z,templates:M})}))}}}function H(h){h.Statistics?.length&&"object"===typeof h.Statistics&&(h.Statistics=h.Statistics.map(G=>[G.min,G.max,G.mean,G.standardDeviation]));null!=h.NumberOfStandardDeviation&&(h.NumberOfStandardDeviations=
h.NumberOfStandardDeviation,delete h.NumberOfStandardDeviation)}function S(h){h.NoDataValues?.length&&"string"===typeof h.NoDataValues[0]&&(h.NoDataValues=h.NoDataValues.filter(G=>""!==G).map(G=>Number(G)))}const x=new Map;x.set("Aspect",{desc:"Aspect Function",ctor:A,rasterArgumentNames:["raster"]});x.set("BandArithmetic",{desc:"Band Arithmetic Function",ctor:U,rasterArgumentNames:["raster"]});x.set("Colormap",{desc:"Colormap Function",ctor:Q,rasterArgumentNames:["raster"]});x.set("CompositeBand",
{desc:"CompositeBand Function",ctor:K,rasterArgumentNames:["rasters"]});x.set("Convolution",{desc:"Convolution Function",ctor:B,rasterArgumentNames:["raster"]});x.set("ContrastBrightness",{desc:"Contrast Brightness Function",ctor:J,rasterArgumentNames:["raster"]});x.set("ExtractBand",{desc:"ExtractBand Function",ctor:f,rasterArgumentNames:["raster"]});x.set("Curvature",{desc:"Curvature Function",ctor:r,rasterArgumentNames:["raster"]});x.set("Local",{desc:"Local Function",ctor:d,rasterArgumentNames:["rasters"]});
x.set("Mask",{desc:"Mask Function",ctor:u,rasterArgumentNames:["raster"]});x.set("NDVI",{desc:"NDVI Function",ctor:F,rasterArgumentNames:["raster"]});x.set("Remap",{desc:"Remap Function",ctor:p,rasterArgumentNames:["raster"]});x.set("Slope",{desc:"Slope Function",ctor:l,rasterArgumentNames:["raster"]});x.set("Statistics",{desc:"Focal Statistics Function",ctor:w,rasterArgumentNames:["raster"]});x.set("StatisticsHistogram",{desc:"Statistics Histogram Function",ctor:E,rasterArgumentNames:["raster"]});
x.set("Stretch",{desc:"Stretch Function",ctor:a,rasterArgumentNames:["raster"]});x.set("Table",{desc:"Attribute Table Function",ctor:e,rasterArgumentNames:["raster"]});q.create=function(h,G){G=G??{};h=O.clone(h);if("function"in h&&"arguments"in h&&h.arguments){const M=new Map;h=I(h,M,G);L(h);if(!h.renderingRule)throw new z("raster-function-helper","Unsupported raster function json.");h=h.renderingRule}if("rasterFunction"in h)return h=m(h),n(h,G);throw new z("raster-function-helper","unsupported raster function json.");
};q.getPrimaryRasterUrls=c;q.getRasterValues=b;q.getSupportedFunctions=function(){const h=new Set;x.forEach((G,M)=>h.add(M));return h};q.register=function(h,G,M=["raster"],R=""){x.set(h,{desc:R,ctor:G,rasterArgumentNames:M})};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/AspectFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./AspectFunctionArguments ./BaseRasterFunction ./surfaceUtils".split(" "),
function(q,D,z,O,A,U,Q,K,J){z=class extends K{constructor(){super(...arguments);this.functionName="Aspect";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.isGCS=!1}_bindSourceRasters(){var B=this.sourceRasterInfos[0];this.isGCS=B.spatialReference?.isGeographic??!1;this.outputPixelType=this._getOutputPixelType("f32");B=B.clone();B.pixelType=this.outputPixelType;B.statistics=[{min:-1,max:360,avg:180,stddev:30}];B.histograms=null;B.colormap=null;B.attributeTable=null;B.bandCount=
1;this.rasterInfo=B;return{success:!0,supportsGPU:!0}}_processPixels(B){const r=B.pixelBlocks?.[0];if(null==r)return null;const {extent:f,primaryPixelSizes:d}=B;B=d?.[0];return J.aspect(r,{resolution:null==B?f?{x:f.width/r.width,y:f.height/r.height}:{x:1,y:1}:B})}};q.__decorate([D.property({json:{write:!0,name:"rasterFunction"}})],z.prototype,"functionName",void 0);q.__decorate([D.property({type:Q,json:{write:!0,name:"rasterFunctionArguments"}})],z.prototype,"functionArguments",void 0);q.__decorate([D.property()],
z.prototype,"rasterArgumentNames",void 0);q.__decorate([D.property({json:{write:!0}})],z.prototype,"isGCS",void 0);return z=q.__decorate([U.subclass("esri.layers.support.rasterFunctions.AspectFunction")],z)})},"esri/layers/support/rasterFunctions/AspectFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/Error ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(q,D,z,O,A,U,Q,K){var J;D=J=class extends K{clone(){return new J({raster:this.raster})}};return D=J=q.__decorate([Q.subclass("esri.layers.support.rasterFunctions.AspectFunctionArguments")],D)})},"esri/layers/support/rasterFunctions/BaseFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass".split(" "),
function(q,D,z,O,A,U,Q){D=class extends D.JSONSupport{constructor(){super(...arguments);this.raster=void 0}};q.__decorate([z.property({json:{write:!0}})],D.prototype,"raster",void 0);return D=q.__decorate([Q.subclass("esri.layers.support.rasterFunctions.AspectFunctionArguments")],D)})},"esri/layers/support/rasterFunctions/BaseRasterFunction":function(){define("../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/cast ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../PixelBlock ../RasterInfo".split(" "),
function(q,D,z,O,A,U,Q,K,J){const B=new Set("slope aspect curvature hillshade shadedrelief statistics".split(" "));D=class extends D.JSONSupport{constructor(){super(...arguments);this.functionArguments=null;this.readingBufferSize=0;this.id=-1;this.isNoopProcess=!1;this.rawInputBandIds=[];this.isInputBandIdsSwizzled=!1;this.swizzledBandSelection=[];this.isBranch=!1;this._bindingResult=null}get supportsGPU(){return this._bindingResult.supportsGPU}get flatWebGLFunctionChain(){var r=this.getWebGLProcessorDefinition();
if(!r)return null;const f=[r];({parameters:r}=r);for(r=r.rasters||r.raster&&[r.raster];r?.length;){f.unshift(...r);var d=[];for(var u=0;u<r.length;u++){var {parameters:F}=r[u];F=F.rasters||F.raster&&[F.raster];F?.length&&d.push(...F)}r=d}for(r=f.length-1;0<=r;r--)f[r].isNoopProcess&&f.splice(r,1);r=!1;for(d=0;d<f.length;d++)u=f[d],u.id=f.length-d-1,{rasters:u}=u.parameters,r=r||null!=u&&1<u.length;d=f.some(({name:p})=>B.has(p.toLowerCase()));return{functions:f,hasBranches:r,hasFocalFunction:d}}bind(r,
f=!1,d=-1){this.id=d+1;d=this._getRasterValues();let u=!0;for(let p=0;p<d.length;p++){var F=d[p];if(null!=F&&this._isRasterFunctionValue(F)){F=F.bind(r,f,this.id+p);if(!F.success)return this._bindingResult=F;u=u&&F.supportsGPU}}if(!this.rasterInfo||f)return this.sourceRasterInfos=this._getSourceRasterInfos(r),this._bindingResult=this._bindSourceRasters(),this._bindingResult.success&&this._patchRasterInfo(),this._bindingResult.supportsGPU=u&&this._bindingResult.supportsGPU,this.processInputBandIds(),
this._bindingResult;this._bindingResult={success:!0,supportsGPU:!0};this.processInputBandIds();return this._bindingResult}process(r){var f=this._getRasterValues();f=0===f.length?r.pixelBlocks??r.primaryPixelBlocks:f.map(d=>this._readRasterValue(d,r));return this._processPixels({...r,pixelBlocks:f})}processInputBandIds(){var r=this._getRasterValues().filter(this._isRasterFunctionValue);if(1<r.length)return this.rawInputBandIds=r.map(d=>d.processInputBandIds()[0]),this.isInputBandIdsSwizzled=this.rawInputBandIds.some((d,
u)=>d!==u),r=r.filter(d=>"ExtractBand"===d.functionName),r.length&&r.forEach((d,u)=>{d.isInputBandIdsSwizzled=!0;d.swizzledBandSelection=[u,u,u]}),this.rawInputBandIds;var f=r[0];if(f){if(r=f.processInputBandIds(),f.isInputBandIdsSwizzled)return this.rawInputBandIds=r}else{r=[];({bandCount:f}=this.sourceRasterInfos[0]);for(let d=0;d<f;d++)r.push(d)}r=this._getInputBandIds(r);this.isInputBandIdsSwizzled=r.some((d,u)=>d!==u);return this.rawInputBandIds=r}getPrimaryRasters(){const r=[],f=[];this._getPrimaryRasters(this,
r,f);return{rasters:r,rasterIds:f}}getWebGLProcessorDefinition(){const r=this._getWebGLParameters(),{raster:f,rasters:d}=this.functionArguments;d&&Array.isArray(d)&&d.length?(r.rasters=d.map(u=>this._isRasterFunctionValue(u)?u.getWebGLProcessorDefinition():"number"===typeof u?{name:"Constant",parameters:{value:u},pixelType:"f32",id:-1,isNoopProcess:!1}:{name:"Identity",parameters:{value:u},pixelType:"f32",id:-1,isNoopProcess:!1}),r.rasters.some(u=>null!=u)||(r.rasters=null)):this._isRasterFunctionValue(f)&&
(r.raster=f.getWebGLProcessorDefinition());return{name:this.functionName,parameters:r,pixelType:this.outputPixelType,id:this.id,isNoopProcess:this.isNoopProcess}}_getOutputPixelType(r){return"unknown"===this.outputPixelType?r:this.outputPixelType??r}_getWebGLParameters(){return{}}_getInputBandIds(r){return r}_isOutputRoundingNeeded(){const {outputPixelType:r}=this;return(r?.startsWith("u")||r?.startsWith("s"))??!1}_getRasterValues(){const {rasterArgumentNames:r}=this;return"rasters"===r[0]?this.functionArguments.rasters??
[]:r.flatMap(f=>this.functionArguments[f])}_getSourceRasterInfos(r){const f=this._getRasterValues(),{rasterInfos:d,rasterIds:u}=r;if(0===f.length)return d;const F=f.map(l=>{if(l&&"object"===typeof l&&"bind"in l&&l.rasterInfo)return l.rasterInfo;if("string"===typeof l&&u.includes(l))return d[u.indexOf(l)];if("number"!==typeof l)return d[0]}),p=F.find(l=>l)??d[0];F.forEach((l,w)=>{void 0===l&&(F[w]=p)});return F}_getPrimaryRasterId(r){return r?.url}_getPrimaryRasters(r,f=[],d=[]){for(let F=0;F<r.sourceRasters.length;F++){var u=
r.sourceRasters[F];if("number"!==typeof u)if("bind"in u)this._getPrimaryRasters(u,f,d);else{const p=this._getPrimaryRasterId(u);null==p||d.includes(p)||(this.mainPrimaryRasterId===p?(f.unshift(u),d.unshift(p)):(f.push(u),d.push(p)))}}}_isRasterFunctionValue(r){return null!=r&&"object"===typeof r&&"getWebGLProcessorDefinition"in r}_readRasterValue(r,f){var {primaryPixelBlocks:d}=f;if(null==r||"$$"===r)return r=d[0],null==r?null:r.clone();if("string"===typeof r)return r=f.primaryRasterIds.indexOf(r),
-1===r?null:d[r];if("number"===typeof r){d=d[0];if(null==d)return null;const {width:u,height:F,pixelType:p,mask:l}=d;d=l?new Uint8Array(l):null;f=new Float32Array(u*F);f.fill(r);r=Array(this.sourceRasterInfos[0].bandCount).fill(f);return new K({width:u,height:F,pixelType:p,pixels:r,mask:d})}return r.process(f)}_patchRasterInfo(){const {rasterInfo:r}=this;if(r?.keyProperties){var {bandCount:f,keyProperties:d,statistics:u,histograms:F}=r,p=d.BandProperties;p&&p.length!==f&&(r.keyProperties={...d,BandProperties:void 0});
u&&u.length!==f&&(r.statistics=u.length>f?u.slice(0,f):null);F&&F.length!==f&&(r.histograms=F.length>f?F.slice(0,f):null);d.BAND_COUNT&&Number(d.BAND_COUNT)!==f&&(r.keyProperties={...d,BAND_COUNT:"string"===typeof d.BAND_COUNT?String(f):f})}}};q.__decorate([z.property({json:{write:!0}})],D.prototype,"functionName",void 0);q.__decorate([z.property({json:{write:!0}})],D.prototype,"functionArguments",void 0);q.__decorate([z.property()],D.prototype,"rasterArgumentNames",void 0);q.__decorate([z.property({json:{write:!0}}),
O.cast(r=>r?.toLowerCase())],D.prototype,"outputPixelType",void 0);q.__decorate([z.property({json:{write:!0}})],D.prototype,"mainPrimaryRasterId",void 0);q.__decorate([z.property()],D.prototype,"sourceRasters",void 0);q.__decorate([z.property({type:[J],json:{write:!0}})],D.prototype,"sourceRasterInfos",void 0);q.__decorate([z.property({json:{write:!0}})],D.prototype,"rasterInfo",void 0);q.__decorate([z.property({json:{write:!0}})],D.prototype,"readingBufferSize",void 0);q.__decorate([z.property({json:{write:!0}})],
D.prototype,"id",void 0);q.__decorate([z.property()],D.prototype,"isNoopProcess",void 0);q.__decorate([z.property()],D.prototype,"supportsGPU",null);q.__decorate([z.property()],D.prototype,"rawInputBandIds",void 0);q.__decorate([z.property()],D.prototype,"isInputBandIdsSwizzled",void 0);q.__decorate([z.property()],D.prototype,"swizzledBandSelection",void 0);q.__decorate([z.property()],D.prototype,"isBranch",void 0);q.__decorate([z.property()],D.prototype,"flatWebGLFunctionChain",null);q.__decorate([z.property()],
D.prototype,"_bindingResult",void 0);return D=q.__decorate([Q.subclass("esri.layers.support.rasterFunctions.BaseRasterFunction")],D)})},"esri/layers/support/RasterInfo":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../geometry/Extent ../../geometry/SpatialReference ./RasterBandInfo ./RasterSensorInfo ./RasterStorageInfo".split(" "),
function(q,D,z,O,A,U,Q,K,J,B,r){var f;D=f=class extends D.JSONSupport{constructor(d){super(d);this.extent=this.colormap=this.bandCount=this.attributeTable=null;this.format=void 0;this.histograms=this.width=this.height=null;this.keyProperties={};this.pixelType=this.pixelSize=this.noDataValue=this.multidimensionalInfo=null;this.isPseudoSpatialReference=!1;this.transform=this.storageInfo=this.statistics=this.spatialReference=null}get bandInfos(){var d=this.keyProperties.BandProperties,{bandCount:u}=
this;if(!d?.length||d.length<u){d=[];for(let F=1;F<=u;F++)d.push(new J({name:"band_"+F}));return d}u=d.map(F=>J.fromJSON(F));for(d=0;d<u.length;d++)u[d].name=u[d].name||"band_"+(d+1);return u}get dataType(){const d=this.keyProperties?.DataType?.toLowerCase()??"generic";return"stdtime"===d?"standard-time":d}get nativeExtent(){return this._get("nativeExtent")||this.extent}set nativeExtent(d){d&&this._set("nativeExtent",d)}get nativePixelSize(){if(null==this.transform||!this.transform.affectsPixelSize)return this.pixelSize;
const d=this.nativeExtent;return{x:d.width/this.width,y:d.height/this.height}}get hasMultidimensionalTranspose(){return!!this.storageInfo?.transposeInfo}get sensorInfo(){if(this.keyProperties?.SensorName)return B.fromJSON(this.keyProperties)}clone(){return new f({attributeTable:z.clone(this.attributeTable),bandCount:this.bandCount,colormap:z.clone(this.colormap),extent:z.clone(this.extent),nativePixelSize:z.clone(this.nativePixelSize),format:this.format,height:this.height,width:this.width,histograms:z.clone(this.histograms),
keyProperties:z.clone(this.keyProperties),multidimensionalInfo:z.clone(this.multidimensionalInfo),noDataValue:this.noDataValue,pixelSize:z.clone(this.pixelSize),pixelType:this.pixelType,isPseudoSpatialReference:this.isPseudoSpatialReference,spatialReference:z.clone(this.spatialReference),statistics:z.clone(this.statistics),storageInfo:z.clone(this.storageInfo),transform:z.clone(this.transform)})}};q.__decorate([O.property({json:{write:!0}})],D.prototype,"attributeTable",void 0);q.__decorate([O.property({json:{write:!0}})],
D.prototype,"bandCount",void 0);q.__decorate([O.property({readOnly:!0})],D.prototype,"bandInfos",null);q.__decorate([O.property({json:{write:!0}})],D.prototype,"colormap",void 0);q.__decorate([O.property({type:String,readOnly:!0})],D.prototype,"dataType",null);q.__decorate([O.property({type:Q,json:{write:!0}})],D.prototype,"extent",void 0);q.__decorate([O.property({type:Q,json:{write:!0}})],D.prototype,"nativeExtent",null);q.__decorate([O.property({json:{write:!0}})],D.prototype,"nativePixelSize",
null);q.__decorate([O.property({json:{write:!0}})],D.prototype,"format",void 0);q.__decorate([O.property({json:{write:!0}})],D.prototype,"height",void 0);q.__decorate([O.property({json:{write:!0}})],D.prototype,"width",void 0);q.__decorate([O.property({json:{write:!0}})],D.prototype,"hasMultidimensionalTranspose",null);q.__decorate([O.property({json:{write:!0}})],D.prototype,"histograms",void 0);q.__decorate([O.property({json:{write:!0}})],D.prototype,"keyProperties",void 0);q.__decorate([O.property({json:{write:!0}})],
D.prototype,"multidimensionalInfo",void 0);q.__decorate([O.property({json:{write:!0}})],D.prototype,"noDataValue",void 0);q.__decorate([O.property({json:{write:!0}})],D.prototype,"pixelSize",void 0);q.__decorate([O.property({json:{write:!0}})],D.prototype,"pixelType",void 0);q.__decorate([O.property()],D.prototype,"isPseudoSpatialReference",void 0);q.__decorate([O.property({readOnly:!0})],D.prototype,"sensorInfo",null);q.__decorate([O.property({type:K,json:{write:!0}})],D.prototype,"spatialReference",
void 0);q.__decorate([O.property({json:{write:!0}})],D.prototype,"statistics",void 0);q.__decorate([O.property({type:r,json:{write:!0}})],D.prototype,"storageInfo",void 0);q.__decorate([O.property({json:{write:!0}})],D.prototype,"transform",void 0);return D=f=q.__decorate([U.subclass("esri.layers.support.RasterInfo")],D)})},"esri/layers/support/RasterBandInfo":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(q,D,z,O,A,U,Q){function K(B){B=Number(B);return isNaN(B)?void 0:B}var J;D=J=class extends D.JSONSupport{constructor(){super(...arguments);this.name=null;this.solarIrradiance=this.reflectanceGain=this.reflectanceBias=this.radianceGain=this.radianceBias=this.maxWavelength=this.minWavelength=void 0}clone(){return new J({name:this.name,minWavelength:this.minWavelength,maxWavelength:this.maxWavelength,radianceBias:this.radianceBias,radianceGain:this.radianceGain,reflectanceBias:this.reflectanceBias,
reflectanceGain:this.reflectanceGain,solarIrradiance:this.solarIrradiance})}};q.__decorate([z.property({json:{name:"BandName",write:!0}})],D.prototype,"name",void 0);q.__decorate([z.property({json:{name:"WavelengthMin",read:{reader:K},write:!0}})],D.prototype,"minWavelength",void 0);q.__decorate([z.property({json:{name:"WavelengthMax",read:{reader:K},write:!0}})],D.prototype,"maxWavelength",void 0);q.__decorate([z.property({json:{name:"RadianceBias",read:{reader:K},write:!0}})],D.prototype,"radianceBias",
void 0);q.__decorate([z.property({json:{name:"RadianceGain",read:{reader:K},write:!0}})],D.prototype,"radianceGain",void 0);q.__decorate([z.property({json:{name:"ReflectanceBias",read:{reader:K},write:!0}})],D.prototype,"reflectanceBias",void 0);q.__decorate([z.property({json:{name:"ReflectanceGain",read:{reader:K},write:!0}})],D.prototype,"reflectanceGain",void 0);q.__decorate([z.property({json:{name:"SolarIrradiance",read:{reader:K},write:!0}})],D.prototype,"solarIrradiance",void 0);return D=J=
q.__decorate([Q.subclass("esri.layers.support.RasterBandInfo")],D)})},"esri/layers/support/RasterSensorInfo":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer".split(" "),function(q,D,z,O,A,U,Q,K,J){function B(f){f=Number(f);return isNaN(f)?
void 0:f}var r;D=r=class extends D.JSONSupport{constructor(){super(...arguments);this.productName=this.cloudCover=this.acquisitionDate=void 0;this.sensorName=null;this.sunElevation=this.sunAzimuth=this.sensorElevation=this.sensorAzimuth=void 0}readAcquisitionDate(f){return new Date(f)}writeAcquisitionDate(f,d){d.AcquisitionDate=f.getTime()}clone(){return new r({acquisitionDate:this.acquisitionDate,cloudCover:this.cloudCover,productName:this.productName,sensorName:this.sensorName,sensorAzimuth:this.sensorAzimuth,
sensorElevation:this.sensorElevation,sunAzimuth:this.sunAzimuth,sunElevation:this.sunElevation})}};q.__decorate([z.property({json:{name:"AcquisitionDate",write:!0}})],D.prototype,"acquisitionDate",void 0);q.__decorate([Q.reader("acquisitionDate")],D.prototype,"readAcquisitionDate",null);q.__decorate([J.writer("acquisitionDate")],D.prototype,"writeAcquisitionDate",null);q.__decorate([z.property({json:{name:"CloudCover",read:{reader:B},write:!0}})],D.prototype,"cloudCover",void 0);q.__decorate([z.property({json:{name:"ProductName",
write:!0}})],D.prototype,"productName",void 0);q.__decorate([z.property({json:{name:"SensorName",write:!0}})],D.prototype,"sensorName",void 0);q.__decorate([z.property({json:{name:"SensorAzimuth",read:{reader:B},write:!0}})],D.prototype,"sensorAzimuth",void 0);q.__decorate([z.property({json:{name:"SensorElevation",read:{reader:B},write:!0}})],D.prototype,"sensorElevation",void 0);q.__decorate([z.property({json:{name:"SunAzimuth",read:{reader:B},write:!0}})],D.prototype,"sunAzimuth",void 0);q.__decorate([z.property({json:{name:"SunElevation",
read:{reader:B},write:!0}})],D.prototype,"sunElevation",void 0);return D=r=q.__decorate([K.subclass("esri.layers.support.RasterSensorInfo")],D)})},"esri/layers/support/RasterStorageInfo":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../geometry/Point".split(" "),function(q,D,z,O,A,U,Q){var K;D=K=class extends D.JSONSupport{constructor(){super(...arguments);
this.blockHeight=this.blockWidth=void 0;this.maximumPyramidLevel=this.firstPyramidLevel=this.origin=this.compression=null;this.pyramidScalingFactor=2;this.pyramidBlockHeight=this.pyramidBlockWidth=null;this.isVirtualTileInfo=!1;this.blockBoundary=this.transposeInfo=this.tileInfo=null}clone(){return new K({blockWidth:this.blockWidth,blockHeight:this.blockHeight,compression:this.compression,origin:z.clone(this.origin),firstPyramidLevel:this.firstPyramidLevel,maximumPyramidLevel:this.maximumPyramidLevel,
pyramidResolutions:z.clone(this.pyramidResolutions),pyramidScalingFactor:this.pyramidScalingFactor,pyramidBlockWidth:this.pyramidBlockWidth,pyramidBlockHeight:this.pyramidBlockHeight,isVirtualTileInfo:this.isVirtualTileInfo,tileInfo:z.clone(this.tileInfo),transposeInfo:z.clone(this.transposeInfo),blockBoundary:z.clone(this.blockBoundary)})}};q.__decorate([O.property({type:Number,json:{write:!0}})],D.prototype,"blockWidth",void 0);q.__decorate([O.property({type:Number,json:{write:!0}})],D.prototype,
"blockHeight",void 0);q.__decorate([O.property({type:String,json:{write:!0}})],D.prototype,"compression",void 0);q.__decorate([O.property({type:Q,json:{write:!0}})],D.prototype,"origin",void 0);q.__decorate([O.property({type:Number,json:{write:!0}})],D.prototype,"firstPyramidLevel",void 0);q.__decorate([O.property({type:Number,json:{write:!0}})],D.prototype,"maximumPyramidLevel",void 0);q.__decorate([O.property({json:{write:!0}})],D.prototype,"pyramidResolutions",void 0);q.__decorate([O.property({type:Number,
json:{write:!0}})],D.prototype,"pyramidScalingFactor",void 0);q.__decorate([O.property({type:Number,json:{write:!0}})],D.prototype,"pyramidBlockWidth",void 0);q.__decorate([O.property({type:Number,json:{write:!0}})],D.prototype,"pyramidBlockHeight",void 0);q.__decorate([O.property({type:Boolean,json:{write:!0}})],D.prototype,"isVirtualTileInfo",void 0);q.__decorate([O.property({json:{write:!0}})],D.prototype,"tileInfo",void 0);q.__decorate([O.property()],D.prototype,"transposeInfo",void 0);q.__decorate([O.property()],
D.prototype,"blockBoundary",void 0);return D=K=q.__decorate([U.subclass("esri.layers.support.RasterStorageInfo")],D)})},"esri/layers/support/rasterFunctions/surfaceUtils":function(){define(["exports","../PixelBlock","./pixelUtils"],function(q,D,z){function O(K){let {altitude:J,azimuth:B}=K;const {hillshadeType:r,pixelSizePower:f=1,pixelSizeFactor:d=1,scalingType:u,isGCS:F,resolution:p}=K;var l="multi-directional"===r?2*K.zFactor:K.zFactor;const {x:w,y:E}=p;K=l/(8*w);var a=l/(8*E);F&&.001<l&&(K/=Q,
a/=Q);"adjusted"===u&&(F?(K=w*Q,a=E*Q,K=(l+K**f*d)/(8*K),a=(l+a**f*d)/(8*a)):(K=(l+w**f*d)/(8*w),a=(l+E**f*d)/(8*E)));var e=(90-J)*Math.PI/180;l=Math.cos(e);let c=(360-B+90)*Math.PI/180,b=Math.sin(e)*Math.cos(c);e=Math.sin(e)*Math.sin(c);const g=[315,270,225,360,180,0],m=[60,60,60,60,60,90];var n=new Float32Array([3,5,3,2,1,4]);const t=n.reduce((L,H)=>L+H);n=n.map(L=>L/t);const k="multi-directional"===r?g.length:1,y=new Float32Array(6),I=new Float32Array(6),C=new Float32Array(6);if("multi-directional"===
r)for(let L=0;L<k;L++)J=m[L],B=g[L],e=(90-J)*Math.PI/180,l=Math.cos(e),c=(360-B+90)*Math.PI/180,b=Math.sin(e)*Math.cos(c),e=Math.sin(e)*Math.sin(c),y[L]=l,I[L]=b,C[L]=e;else y.fill(l),I.fill(b),C.fill(e);return{resolution:p,factor:[K,a],sinZcosA:b,sinZsinA:e,cosZ:l,sinZcosAs:I,sinZsinAs:C,cosZs:y,weights:n,hillshadeType:["traditional","multi-directional"].indexOf(r)}}function A(K,J){const {width:B,height:r}=K;var f=B*r;const d=new Uint8Array(f),u=null!=K.mask;let F;if(u){F=new Uint8Array(K.mask);
for(var p=0;p<F.length;p++)F[p]&&(d[p]=1,F[p]=1)}K=K.pixels[0];p=new Float32Array(f);const l=new Float32Array(f);let w=0;if(J){({resolution:E}=J);var E=E?(E.x+E.y)/2:1;w=200*J.zFactor/(E*E);E=new Float32Array(f)}J=J?.curvatureType;let a;let e;for(f=1;f<r-1;f++){const y=f*B;for(let I=1;I<B-1;I++){const C=y+I;if(!F||0!==F[C]){if(F){if(7>F[C-B-1]+F[C-B]+F[C-B+1]+F[C-1]+F[C+1]+F[C+B-1]+F[C+B]+F[C+B+1]){d[C]=0;continue}var c=F[C-B-1]?K[C-B-1]:K[C];var b=F[C-B]?K[C-B]:K[C];var g=F[C-B+1]?K[C-B+1]:K[C];
var m=F[C-1]?K[C-1]:K[C];var n=F[C+1]?K[C+1]:K[C];a=F[C+B-1]?K[C+B-1]:K[C];var t=F[C+B]?K[C+B]:K[C];e=F[C+B+1]?K[C+B+1]:K[C]}else c=K[C-B-1],b=K[C-B],g=K[C-B+1],m=K[C-1],n=K[C+1],a=K[C+B-1],t=K[C+B],e=K[C+B+1];p[C]=g+n+n+e-(c+m+m+a);l[C]=a+t+t+e-(c+b+b+g);if(null!=E){var k=K[C];const L=.5*(m+n)-k;k=.5*(b+t)-k;"standard"===J?E[C]=-w*(L+k):(c=(-c+g+a-e)/4,m=(-m+n)/2,b=(b-t)/2,t=m*m,n=b*b,(g=t+n)&&(E[C]="profile"===J?w*(L*t+k*n+c*m*b)/g:-w*(L*n+k*t-c*m*b)/g))}}}}return{outMask:u?d:null,dzxs:p,dzys:l,
curvatures:E}}function U(K,J,B){for(var r=0;r<B;r++)K[r*J]=K[r*J+1],K[(r+1)*J-1]=K[(r+1)*J-2];for(r=1;r<J-1;r++)K[r]=K[r+J],K[r+(B-1)*J]=K[r+(B-2)*J]}const Q=1/111E3;q.aspect=function(K,J={}){if(!z.isValidPixelBlock(K))return K;var {resolution:B}=J;J=B?1/B.x:1;B=B?1/B.y:1;const {dzxs:r,dzys:f,outMask:d}=A(K),{width:u,height:F}=K,p=new Float32Array(u*F);for(let w=1;w<F-1;w++){const E=w*u;for(let a=1;a<u-1;a++){var l=E+a;if(!d||d[l]){const e=r[l]*J;l=f[l]*B;let c=-1;if(0!==e||0!==l)c=90-57.29578*Math.atan2(l,
-e),0>c&&(c+=360),360===c?c=0:360<c&&(c%=360);p[E+a]=c}}}U(p,u,F);return new D({width:u,height:F,pixels:[p],mask:d,pixelType:"f32",validPixelCount:K.validPixelCount,statistics:[{minValue:-1,maxValue:360}]})};q.calculateHillshadeParams=O;q.curvature=function(K,J){if(!z.isValidPixelBlock(K))return K;const {curvatures:B,outMask:r}=A(K,J),{width:f,height:d}=K;U(B,f,d);K=new D({width:f,height:d,pixels:[B],mask:r,pixelType:"f32",validPixelCount:K.validPixelCount});K.updateStatistics();return K};q.gcsFactor=
Q;q.hillshade=function(K,J){if(!z.isValidPixelBlock(K))return K;const {factor:B,sinZcosA:r,sinZsinA:f,cosZ:d,sinZcosAs:u,sinZsinAs:F,cosZs:p,weights:l}=O(J),[w,E]=B;J="traditional"===J.hillshadeType;const {width:a,height:e}=K,c=new Uint8Array(a*e),{dzxs:b,dzys:g,outMask:m}=A(K);for(let t=1;t<e-1;t++){const k=t*a;for(let y=1;y<a-1;y++){const I=k+y;if(!m||m[I]){var n=b[I]*w;const C=g[I]*E,L=Math.sqrt(1+n*n+C*C);let H=0;if(J)n=255*(d+f*C-r*n)/L,0>n&&(n=0),H=n;else{const S=F.length;for(let x=0;x<S;x++){let h=
255*(p[x]+F[x]*C-u[x]*n)/L;0>h&&(h=0);H+=h*l[x]}}c[I]=H&255}}}U(c,a,e);return new D({width:a,height:e,pixels:[c],mask:m,pixelType:"u8",validPixelCount:K.validPixelCount,statistics:[{minValue:0,maxValue:255}]})};q.slope=function(K,J){if(!z.isValidPixelBlock(K))return K;var B=J.zFactor,r=J.pixelSizePower??1,f=J.pixelSizeFactor??1;const d=J.slopeType;var u=J.isGCS;const {x:F,y:p}=J.resolution;J=B/(8*F);let l=B/(8*p);u&&1E-4>Math.abs(B-1)&&(J/=Q,l/=Q);"adjusted"===d&&(J=(B+F**r*f)/(8*F),l=(B+p**r*f)/
(8*p));const {dzxs:w,dzys:E,outMask:a}=A(K),{width:e,height:c}=K;B=new Float32Array(e*c);for(r=1;r<c-1;r++)for(f=r*e,u=1;u<e-1;u++){var b=f+u;if(!a||a[b]){var g=w[b]*J;b=E[b]*l;g=Math.sqrt(g*g+b*b);B[f+u]="percent-rise"===d?100*g:57.2957795*Math.atan(g)}}U(B,e,c);K=new D({width:e,height:c,pixels:[B],mask:a,pixelType:"f32",validPixelCount:K.validPixelCount});K.updateStatistics();return K};q.tintHillshade=function(K,J,B,r){if(z.isValidPixelBlock(K)&&z.isValidPixelBlock(J)){var {min:f,max:d}=r;r=K.pixels[0];
var {pixels:u,mask:F}=J;J=u[0];var p=255.00001/(d-f),l=new Uint8ClampedArray(J.length),w=new Uint8ClampedArray(J.length),E=new Uint8ClampedArray(J.length),a=B.length-1;for(let b=0;b<J.length;b++){if(F&&0===F[b])continue;var e=Math.floor((J[b]-f)*p);const [g,m]=B[0>e?0:e>a?a:e];var c=r[b];e=c*m;const n=e*(1-Math.abs(g%2-1));c-=e;switch(Math.floor(g)){case 0:l[b]=e+c;w[b]=n+c;E[b]=c;break;case 1:l[b]=n+c;w[b]=e+c;E[b]=c;break;case 2:l[b]=c;w[b]=e+c;E[b]=n+c;break;case 3:l[b]=c;w[b]=n+c;E[b]=e+c;break;
case 4:l[b]=n+c;w[b]=c;E[b]=e+c;break;case 5:case 6:l[b]=e+c,w[b]=c,E[b]=n+c}}K.pixels=[l,w,E];K.updateStatistics()}};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/BandArithmeticFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BandArithmeticFunctionArguments ./bandIndexUtils ./BaseRasterFunction".split(" "),
function(q,D,z,O,A,U,Q,K,J){const B=new Set(["vari","mtvi2","rtvi-core","evi"]);z=class extends J{constructor(){super(...arguments);this.functionName="BandArithmetic";this.functionArguments=null;this.rasterArgumentNames=["raster"]}_bindSourceRasters(){this.outputPixelType=this._getOutputPixelType("f32");var r=this.sourceRasterInfos[0];if(2>r.bandCount)return{success:!1,supportsGPU:!1,error:"band-arithmetic-function: source raster has insufficient amount of raster bands"};r=r.clone();r.pixelType=this.outputPixelType;
r.statistics=null;r.histograms=null;r.bandCount="sultan"===this.functionArguments.method?3:1;r.keyProperties={...r.keyProperties,BandProperties:void 0};this.rasterInfo=r;return{success:!0,supportsGPU:!["custom","gvitm","sultan"].includes(this.functionArguments.method)}}_processPixels(r){r=r.pixelBlocks?.[0];if(null==r)return r;const {method:f,bandIndexes:d}=this.functionArguments,u=d.split(" ").map(F=>parseFloat(F));return K.calculateBandIndex(r,{method:f,bandIndexes:u,equation:d})}_getWebGLParameters(){const r=
this.functionArguments.bandIndexes.split(" ").map(F=>parseFloat(F)-1);2===r.length&&r.push(0);var f=this.isInputBandIdsSwizzled?[0,1,2]:r;const d=new Float32Array(3);({method:u}=this.functionArguments);switch(u){case "gndvi":case "nbr":case "ndbi":case "ndvi":case "ndvi-re":case "ndsi":case "ndmi":case "mndwi":f=K.getBandMatrix3([f[0],f[1],0]);var u="ndxi";break;case "ndwi":f=K.getBandMatrix3([f[1],f[0],0]);u="ndxi";break;case "sr":case "sr-re":case "iron-oxide":case "ferrous-minerals":case "clay-minerals":f=
K.getBandMatrix3([f[0],f[1],0]);u="sr";break;case "ci-g":case "ci-re":f=K.getBandMatrix3([f[0],f[1],0]);u="ci";break;case "savi":f=K.getBandMatrix3([f[0],f[1],0]);u="savi";d[0]=r[2]+1;break;case "tsavi":f=K.getBandMatrix3([f[0],f[1],0]);u="tsavi";d[0]=r[2]+1;d[1]=r[3]+1;d[2]=r[4]+1;break;case "msavi":f=K.getBandMatrix3([f[0],f[1],0]);u="msavi";break;case "gemi":f=K.getBandMatrix3([f[0],f[1],0]);u="gemi";break;case "pvi":f=K.getBandMatrix3([f[0],f[1],0]);u="tsavi";d[0]=r[2]+1;d[1]=r[3]+1;break;case "vari":f=
K.getBandMatrix3([f[0],f[1],f[2]]);u="vari";break;case "mtvi2":f=K.getBandMatrix3([f[0],f[1],f[2]]);u="mtvi2";break;case "rtvi-core":f=K.getBandMatrix3([f[0],f[1],f[2]]);u="rtvicore";break;case "evi":f=K.getBandMatrix3([f[0],f[1],f[2]]);u="evi";break;case "wndwi":f=K.getBandMatrix3([f[0],f[1],0]);u="wndwi";d[0]=r[3]?r[3]+1:.5;break;case "bai":f=K.getBandMatrix3([f[1],f[0],0]);u="bai";break;default:f=K.getBandMatrix3([0,1,2]),u="custom"}return{bandIndexMat3:f,indexType:u,adjustments:d}}_getInputBandIds(r){if("custom"===
this.functionArguments.method)return r;var f=this.functionArguments.bandIndexes.split(" ").map(F=>parseFloat(F)-1);const d=r.length;f=f.map(F=>F>=d?d-1:F);const u=B.has(this.functionArguments.method)?3:2;f=f.slice(0,u).map(F=>r[F]);2===f.length&&f.push(0);return f}};q.__decorate([D.property({json:{write:!0,name:"rasterFunction"}})],z.prototype,"functionName",void 0);q.__decorate([D.property({type:Q,json:{write:!0,name:"rasterFunctionArguments"}})],z.prototype,"functionArguments",void 0);q.__decorate([D.property()],
z.prototype,"rasterArgumentNames",void 0);return z=q.__decorate([U.subclass("esri.layers.support.rasterFunctions.BandArithmeticFunction")],z)})},"esri/layers/support/rasterFunctions/BandArithmeticFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./bandIndexUtils ./BaseFunctionArguments".split(" "),
function(q,D,z,O,A,U,Q,K){var J;O=J=class extends K{constructor(){super(...arguments);this.method="custom"}clone(){return new J({method:this.method,bandIndexes:this.bandIndexes,raster:D.clone(this.raster)})}};q.__decorate([z.property({json:{type:String,write:!0}})],O.prototype,"bandIndexes",void 0);q.__decorate([A.enumeration(Q.bandIndexMethodMap)],O.prototype,"method",void 0);return O=J=q.__decorate([U.subclass("esri.layers.support.rasterFunctions.BandArithmeticFunctionArguments")],O)})},"esri/core/accessorSupport/decorators/enumeration":function(){define(["exports",
"../../jsonMap","./property"],function(q,D,z){q.enumeration=function(O,A={}){O=O instanceof D.JSONMap?O:new D.JSONMap(O,A);O={type:A?.ignoreUnknown??!0?O.apiValues:String,json:{type:O.jsonValues,read:A?.readOnly?!1:{reader:O.read},write:{writer:O.write}}};void 0!==A?.readOnly&&(O.readOnly=!!A.readOnly);void 0!==A?.default&&(O.json.default=A.default);void 0!==A?.name&&(O.json.name=A.name);void 0!==A?.nonNullable&&(O.nonNullable=A.nonNullable);return z.property(O)};Object.defineProperty(q,Symbol.toStringTag,
{value:"Module"})})},"esri/layers/support/rasterFunctions/bandIndexUtils":function(){define(["exports","../../../core/jsonMap","../PixelBlock","./customBandIndexUtils","./pixelUtils"],function(q,D,z,O,A){function U(c,b,g){const m=g.length,n=new Float32Array(m);for(let t=0;t<m;t++)if(null==c||c[t]){const k=b[t],y=g[t],I=k+y;I&&(n[t]=(k-y)/I)}return[n]}function Q(c,b,g){const m=g.length,n=new Float32Array(m);for(let t=0;t<m;t++)if(null==c||c[t]){const k=b[t],y=g[t];y&&(n[t]=k/y)}return[n]}function K(c,
b,g){const m=b.length,n=new Float32Array(m);for(let t=0;t<m;t++)if(null==c||c[t]){const k=b[t],y=g[t];y&&(n[t]=k/y-1)}return[n]}function J(c,b,g,m){const n=g.length,t=new Float32Array(n);for(let k=0;k<n;k++)if(null==c||c[k]){const y=g[k],I=b[k],C=I+y+m;C&&(t[k]=(I-y)/C*(1+m))}return[t]}function B(c,b,g,m,n,t){const k=g.length,y=new Float32Array(k);t=-n*m+t*(1+m*m);for(let I=0;I<k;I++)if(null==c||c[I]){const C=g[I],L=b[I],H=n*L+C+t;H&&(y[I]=m*(L-m*C-n)/H)}return[y]}function r(c,b,g){const m=g.length,
n=new Float32Array(m);for(let t=0;t<m;t++)if(null==c||c[t]){const k=b[t];n[t]=.5*(2*(k+1)-Math.sqrt((2*k+1)**2-8*(k-g[t])))}return[n]}function f(c,b,g){const m=g.length,n=new Float32Array(m);for(let k=0;k<m;k++)if(null==c||c[k]){const y=g[k];var t=b[k];1!==y&&(t=(2*(t*t-y*y)+1.5*t+.5*y)/(t+y+.5),n[k]=t*(1-.25*t)-(y-.125)/(1-y))}return[n]}function d(c,b,g,m,n){const t=g.length,k=new Float32Array(t),y=Math.sqrt(1+m*m);for(let I=0;I<t;I++)if(null==c||c[I])k[I]=(b[I]-m*g[I]-n)/y;return[k]}function u(c,
b){const [g,m,n,t,k,y]=b;b=g.length;const I=new Float32Array(b);for(let C=0;C<b;C++)if(null==c||c[C])I[C]=-.2848*g[C]-.2435*m[C]-.5436*n[C]+.7243*t[C]+.084*k[C]-1.18*y[C];return[I]}function F(c,b){const [g,,m,n,t,k]=b;b=g.length;const y=new Float32Array(b),I=new Float32Array(b),C=new Float32Array(b);for(let L=0;L<b;L++)if(null==c||c[L])y[L]=k[L]?t[L]/k[L]*100:0,I[L]=g[L]?t[L]/g[L]*100:0,C[L]=n[L]?m[L]/n[L]*(t[L]/n[L])*100:0;return[y,I,C]}function p(c,b){const [g,m,n]=b;b=g.length;const t=new Float32Array(b);
for(let k=0;k<b;k++)if(null==c||c[k])for(k=0;k<b;k++){const y=g[k],I=m[k],C=I+y-n[k];C&&(t[k]=(I-y)/C)}return[t]}function l(c,b){const [g,m,n]=b;b=g.length;const t=new Float32Array(b);for(let k=0;k<b;k++)if(null==c||c[k])for(k=0;k<b;k++){const y=g[k],I=m[k],C=n[k];t[k]=1.5*(1.2*(y-C)-2.5*(I-C))*Math.sqrt((2*y+1)**2-6*y-5*Math.sqrt(I)-.5)}return[t]}function w(c,b){const [g,m,n]=b;b=g.length;const t=new Float32Array(b);for(let k=0;k<b;k++)if(null==c||c[k])for(k=0;k<b;k++){const y=g[k];t[k]=100*(y-m[k])-
10*(y-n[k])}return[t]}function E(c,b){const [g,m,n]=b;b=g.length;const t=new Float32Array(b);for(let k=0;k<b;k++)if(null==c||c[k])for(k=0;k<b;k++){const y=g[k],I=m[k],C=y+6*I-7.5*n[k]+1;C&&(t[k]=2.5*(y-I)/C)}return[t]}function a(c,b,g=.5){const [m,n,t]=b;b=n.length;const k=new Float32Array(b);for(let y=0;y<b;y++)if(null==c||c[y])for(y=0;y<b;y++){const I=m[y],C=n[y],L=t[y],H=I+g*C+(1-g)*L;H&&(k[y]=(I-g*C-(1-g)*L)/H)}return[k]}function e(c,b,g){const m=g.length,n=new Float32Array(m);for(let t=0;t<m;t++)if(null==
c||c[t])for(t=0;t<m;t++){const k=(.1-b[t])**2+(.06-g[t])**2;k&&(n[t]=1/k)}return[n]}D=new D.JSONMap({0:"custom",1:"ndvi",2:"savi",3:"tsavi",4:"msavi",5:"gemi",6:"pvi",7:"gvitm",8:"sultan",9:"vari",10:"gndvi",11:"sr",12:"ndvi-re",13:"sr-re",14:"mtvi2",15:"rtvi-core",16:"ci-re",17:"ci-g",18:"ndwi",19:"evi",20:"iron-oxide",21:"ferrous-minerals",22:"clay-minerals",23:"wndwi",24:"bai",25:"nbr",26:"ndbi",27:"ndmi",28:"ndsi",29:"mndwi"},{useNumericKeys:!0});q.bandIndexMethodMap=D;q.calculateBandIndex=function(c,
b){if(!A.isValidPixelBlock(c))return c;const {equation:g,method:m}=b;b=b.bandIndexes.map(y=>y-1);const {pixels:n,mask:t}=c;switch(m){case "gndvi":case "nbr":case "ndbi":case "ndvi":case "ndvi-re":case "ndsi":case "ndmi":case "mndwi":b=U(t,n[b[0]],n[b[1]]);break;case "ndwi":b=U(t,n[b[1]],n[b[0]]);break;case "sr":case "sr-re":case "iron-oxide":case "ferrous-minerals":case "clay-minerals":b=Q(t,n[b[0]],n[b[1]]);break;case "ci-g":case "ci-re":b=K(t,n[b[0]],n[b[1]]);break;case "savi":b=J(t,n[b[0]],n[b[1]],
b[2]+1);break;case "tsavi":b=B(t,n[b[0]],n[b[1]],b[2]+1,b[3]+1,b[4]+1);break;case "msavi":b=r(t,n[b[0]],n[b[1]]);break;case "gemi":b=f(t,n[b[0]],n[b[1]]);break;case "pvi":b=d(t,n[b[0]],n[b[1]],b[2]+1,b[3]+1);break;case "gvitm":b=u(t,[n[b[0]],n[b[1]],n[b[2]],n[b[3]],n[b[4]],n[b[5]]]);break;case "sultan":b=F(t,[n[b[0]],n[b[1]],n[b[2]],n[b[3]],n[b[4]],n[b[5]]]);break;case "vari":b=p(t,[n[b[0]],n[b[1]],n[b[2]]]);break;case "mtvi2":b=l(t,[n[b[0]],n[b[1]],n[b[2]]]);break;case "rtvi-core":b=w(t,[n[b[0]],
n[b[1]],n[b[2]]]);break;case "evi":b=E(t,[n[b[0]],n[b[1]],n[b[2]]]);break;case "wndwi":b=a(t,[n[b[0]],n[b[1]],n[b[2]]],b[3]?b[3]+1:.5);break;case "bai":b=e(t,n[b[0]],n[b[1]]);break;case "custom":b=O.calculateCustomBandIndex(t,n,g);break;default:return c}const k=null!=t?new Uint8Array(t.length):null;null!=t&&null!=k&&k.set(t);c=new z({width:c.width,height:c.height,pixelType:"f32",pixels:b,mask:k});c.updateStatistics();return c};q.calculateNDVI=function(c,b,g,m){const {mask:n,pixels:t,width:k,height:y}=
c;c=t[g];b=t[b];g=b.length;const I=m?new Uint8Array(g):new Float32Array(g),C=m?100:1,L=m?100.5:0;for(let H=0;H<g;H++)if(null==n||n[H]){const S=c[H],x=b[H],h=S+x;h&&(I[H]=(S-x)/h*C+L)}m=new z({width:k,height:y,mask:n,pixelType:m?"u8":"f32",pixels:[I]});m.updateStatistics();return m};q.getBandMatrix3=function(c){const b=new Float32Array(9);b[3*c[0]]=1;b[3*c[1]+1]=1;b[3*c[2]+2]=1;return b};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/customBandIndexUtils":function(){define(["exports",
"../../../core/has"],function(q,D){const z=new Set("+-*/()".split(""));q.calculateCustomBandIndex=function(O,A,U){U=U.replaceAll(" ","");U.startsWith("-")&&(U="0"+U);U.startsWith("+")&&(U=U.slice(1,U.length));U=U.split("");var Q=[],K=[],J="";for(var B=0;B<U.length;B++){const u=U[B];z.has(u)?(""!==J&&K.push(parseFloat(J)),Q.push(u),J=""):"b"===u.toLowerCase()?(B++,J=u.concat(U[B]),K.push(A[parseInt(J[1],10)-1]),J=""):(J=J.concat(u),B===U.length-1&&K.push(parseFloat(J)))}let {ops:r,nums:f}={ops:Q,nums:K};
if(0===r.length){O=1===f.length?f[0]:A[0];if(O instanceof Float32Array)return[O];var d=new Float32Array(A[0].length);"number"===typeof O?d.fill(O):d.set(O);return[d]}for(;0<r.length;){d=r;if(1===d.length)d={opIndex:0,numIndex:0};else{Q=U=0;for(A=0;A<d.length;A++)if("("===d[A])U=A;else if(")"===d[A]){Q=A;break}K=0===Q?d:d.slice(U+1,Q);A=-1;for(J=0;J<K.length;J++)if("*"===K[J]||"/"===K[J]){A=J;break}if(!(-1<A))for(J=0;J<K.length;J++)if("+"===K[J]||"-"===K[J]){A=J;break}0<Q&&(A+=U+1);U=0;for(Q=0;Q<A;Q++)"("===
d[Q]&&U++;d={opIndex:A,numIndex:A-U}}const {numIndex:u,opIndex:F}=d;Q=U=A=void 0;d=O;J=r[F];K=f[u];B=f[u+1];if("number"===typeof K&&"number"===typeof B)d=K+B;else{"number"===typeof K?(A=B,Q=A.length,U=new Float32Array(Q),U.fill(K)):(Q=K.length,U=K,B.constructor===Number?(A=new Float32Array(Q),A.fill(B)):A=B);K=new Float32Array(Q);switch(J){case "+":for(J=0;J<Q;J++)if(null==d||d[J])K[J]=U[J]+A[J];break;case "-":for(J=0;J<Q;J++)if(null==d||d[J])K[J]=U[J]-A[J];break;case "*":for(J=0;J<Q;J++)if(null==
d||d[J])K[J]=U[J]*A[J];break;case "/":for(J=0;J<Q;J++)(null==d||d[J])&&A[J]&&(K[J]=U[J]/A[J]);break;case "(":case ")":throw Error("encountered error with custom band index equation");}d=K}if(1===r.length)break;else{A=r;A.splice(F,1);Q=U=0;do{Q=U=0;for(K=0;K<A.length;K++)if("("===A[K])U=K;else if(")"===A[K]){Q=K;break}Q===U+1&&A.splice(U,2)}while(Q===U+1);r=A;f.splice(u,2,d)}}return[d]};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/ColormapFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./ColormapFunctionArguments ./colormaps ../../../renderers/support/colorRampUtils".split(" "),
function(q,D,z,O,A,U,Q,K,J,B){z=class extends Q{constructor(){super(...arguments);this.functionName="Colormap";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.isNoopProcess=!0}_bindSourceRasters(){var r=this.sourceRasterInfos[0];if(1<r.bandCount)return{success:!1,supportsGPU:!1,error:"colormap-function: source data must be single band"};let {colormap:f,colormapName:d,colorRamp:u,colorRampName:F}=this.functionArguments;if(!f?.length)if(u)f=B.convertColorRampToColormap(u,{interpolateAlpha:!0});
else if(F){const p=B.getColorRampJSON(F);p&&(f=B.convertColorRampToColormap(p))}else d&&(f=J.getColormapByName(d));if(!f?.length)return{success:!1,supportsGPU:!1,error:"colormap-function: missing colormap argument"};this.outputPixelType=this._getOutputPixelType("u8");r=r.clone();r.pixelType=this.outputPixelType;r.colormap=f;r.bandCount=1;this.rasterInfo=r;return{success:!0,supportsGPU:!0}}_processPixels(r){return r.pixelBlocks?.[0]}};q.__decorate([D.property({json:{write:!0,name:"rasterFunction"}})],
z.prototype,"functionName",void 0);q.__decorate([D.property({type:K,json:{write:!0,name:"rasterFunctionArguments"}})],z.prototype,"functionArguments",void 0);q.__decorate([D.property()],z.prototype,"rasterArgumentNames",void 0);q.__decorate([D.property()],z.prototype,"isNoopProcess",void 0);q.__decorate([D.property({json:{write:!0}})],z.prototype,"indexedColormap",void 0);return z=q.__decorate([U.subclass("esri.layers.support.rasterFunctions.ColormapFunction")],z)})},"esri/layers/support/rasterFunctions/ColormapFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/cast ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments ../../../renderers/support/colorRampUtils ../../../rest/support/colorRamps".split(" "),
function(q,D,z,O,A,U,Q,K,J){var B;Q=B=class extends Q{castColormapName(r){if(!r)return null;r=r.toLowerCase();return K.rasterColormapNames.includes(r)?r:null}readColorRamp(r){return J.fromJSON(r)}readColorRampName(r,f){return r?(f=K.colorRampDict.jsonValues.find(d=>d.toLowerCase()===r.toLowerCase()))?K.colorRampDict.fromJSON(f):null:null}clone(){return new B({colormap:D.clone(this.colormap),colormapName:this.colormapName,colorRamp:this.colorRamp?.clone(),colorRampName:this.colorRampName})}};q.__decorate([z.property({type:[[Number]],
json:{write:!0}})],Q.prototype,"colormap",void 0);q.__decorate([z.property({type:String,json:{write:!0}})],Q.prototype,"colormapName",void 0);q.__decorate([O.cast("colormapName")],Q.prototype,"castColormapName",null);q.__decorate([z.property({types:J.types,json:{write:!0}})],Q.prototype,"colorRamp",void 0);q.__decorate([A.reader("colorRamp")],Q.prototype,"readColorRamp",null);q.__decorate([z.property({type:K.colorRampDict.apiValues,json:{type:K.colorRampDict.jsonValues,write:K.colorRampDict.write}})],
Q.prototype,"colorRampName",void 0);q.__decorate([A.reader("colorRampName")],Q.prototype,"readColorRampName",null);return Q=B=q.__decorate([U.subclass("esri.layers.support.rasterFunctions.ColormapFunctionArguments")],Q)})},"esri/renderers/support/colorRampUtils":function(){define(["exports","../../Color","../../core/colorUtils","../../core/jsonMap","../../core/JSONSupport"],function(q,D,z,O,A){function U(a,e){if(!a||!e||a.length!==e.length)return!1;for(let c=0;c<a.length;c++)if(a[c]>e[c]+2||a[c]<
e[c]-2)return!1;return!0}function Q(a){const e=a.clone();e.fromColor=a.toColor;e.toColor=a.fromColor;e.algorithm=a.algorithm;return e}function K(a){if("multipart"===a.type){a=a.clone();if(!a.colorRamps?.length)return a;a.colorRamps=a.colorRamps.reverse().map(e=>Q(e));return a}return Q(a)}function J(a,e){if(a){e=e??w;var c=null;"algorithmic"===a.type?e.some(b=>{if(U(a.fromColor.toRgb(),b.fromColor)&&U(a.toColor.toRgb(),b.toColor))return c=b.id,!0}):"multipart"===a.type&&e.some(b=>{const g=a.colorRamps,
m=b.colorRamps;if(g&&m&&g.length===m.length&&!m.some((n,t)=>{if(!U(g[t].fromColor.toRgb(),(new D(n.fromColor)).toRgb())||!U(g[t].toColor.toRgb(),(new D(n.toColor)).toRgb()))return!0})){if(c)return!0;c=b.id}});return c}}function B(a,e,c=!1){if(a){var b=J(a,e);null!=b||c||(a=K(a),b=J(a,e));return b}}function r(a,e=!1){return(a="string"===typeof a?a:B(a,void 0,e))?E.toJSON(a):null}function f(a){a=a||{};const e=a.numColors||256;return{...a,numColors:e,distanceOffset:a.distanceOffset||0,interpolateAlpha:!!a.interpolateAlpha,
distanceInterval:a.distanceInterval||1/(e-1),isCustomInterval:null!=a.isCustomInterval?a.isCustomInterval:null!==a.distanceInterval&&a.distanceInterval!==1/(e-1),weights:a.weights}}function d(a,e){let {fromColor:c,toColor:b}=a;c=[...c];b=[...b];3===c.length&&(c=c.concat([255]));3===b.length&&(b=b.concat([255]));a=a.algorithm||"esriCIELabAlgorithm";var g=f(e);const {numColors:m,distanceOffset:n,isCustomInterval:t,interpolateAlpha:k}=g;if(1===m&&0===n)return[c];if(2===m&&0===n&&!t)return[c,b];var y=
{r:c[0],g:c[1],b:c[2]};e={r:b[0],g:b[1],b:b[2]};if("esriCIELabAlgorithm"===a){a=z.toLAB(y);e=z.toLAB(e);const {numColors:H,distanceOffset:S,distanceInterval:x,isCustomInterval:h}=g;let {l:G,a:M,b:R}=a;a=(e.l-G)*x;y=(e.a-M)*x;g=(e.b-R)*x;var I=[];if(S){var C=S/x;G+=C*a;M+=C*y;R+=C*g}for(C=0;C<H-1;C++)I.push({l:G,a:M,b:R}),G+=a,M+=y,R+=g;I.push(h?{l:G,a:M,b:R}:e);e=I}else if("esriHSVAlgorithm"===a){a=z.toHSV(y);e=z.toHSV(e);const {numColors:H,distanceOffset:S,distanceInterval:x,isCustomInterval:h}=
g;I=0===a.s;C=0===e.s;y=a.h;g=e.h;I&&!C?y=g:C&&!I&&(e={...e,h:y},g=y);I=Math.abs(g-y);180>I?g=(g-y)*x:(I=360-I,g=y>g?I*x:-I*x);I=(e.s-a.s)*x;C=(e.v-a.v)*x;let {s:G,v:M}=a;a=y;S&&(y=S/x,a=(a+y*g+360)%360,G+=y*I,M+=y*C);y=[];for(var L=0;L<H-1;L++)y.push({h:a,s:G,v:M}),a=(a+g+360)%360,G+=I,M+=C;y.push(h?{h:a,s:G,v:M}:e);e=y}else{y=z.toLCH(y);e=z.toLCH(e);const {numColors:H,distanceOffset:S,distanceInterval:x,isCustomInterval:h}=g;g=y.h;I=e.h;a=2*Math.PI;g<=I?(C=I-g,g=I-g-a,g=Math.abs(g)<Math.abs(C)?
g:C):(C=I+a-g,g=I-g,g=Math.abs(g)<Math.abs(C)?g:C);g*=x;I=(e.l-y.l)*x;C=(e.c-y.c)*x;let {l:G,c:M,h:R}=y;S&&(y=S/x,G+=y*I,M+=y*C,R=(R+y*g+a)%a);y=[];for(L=0;L<H-1;L++)y.push({l:G,c:M,h:R}),G+=I,M+=C,R=(R+g+a)%a;y.push(h?{l:G,c:M,h:R}:e);e=y}a=[];y=c[3]??255;g=((b[3]??255)-y)/(m-1);for(I=0;I<m;I++){const {r:H,g:S,b:x}=z.toRGB(e[I]);a.push([H,S,x,k?Math.round(y+g*I):255])}return a}function u(a,e){const {numColors:c,interpolateAlpha:b}=f(e);e=e?.weights;({colorRamps:a}=a);if(e){const I=e.reduce((C,L)=>
C+L);e=e.map(C=>C/I)}else{e=[];for(var g=0;g<a.length;g++)e[g]=1/a.length}g=[];let m=0,n=0;const t=1/(c-1);let k=!1;for(let I=0;I<a.length;I++){var y=k?0:m*t-n;let C=I===a.length-1?c-1-m:(e[I]-y)/t;k=Math.ceil(C)===C;C=Math.ceil(C);0!==C&&(y/=e[I],y=d(a[I],{numColors:C,interpolateAlpha:b,distanceOffset:y,distanceInterval:t/e[I]}),m+=y.length,g.push(...y),n+=e[I])}e=[...a[a.length-1].toColor];3===e.length&&e.push(255);g.push(e);return g}function F(a,e){a=A.isSerializable(a)?a.toJSON():a;return"multipart"===
a.type?u(a,e):d(a,e)}function p(a){a=z.toHSV(a);return{type:"HsvColor",Hue:a.h,Saturation:a.s,Value:a.v,AlphaValue:255}}function l(a){return{Algorithm:a.toJSON()?.Algorithm||"esriHSVAlgorithm",type:"AlgorithmicColorRamp",FromColor:p(a.fromColor),ToColor:p(a.toColor)}}const w=[{id:"aspect",type:"multipart",colorRamps:[{fromColor:[190,190,190],toColor:[255,45,8]},{fromColor:[255,45,8],toColor:[255,181,61]},{fromColor:[255,181,61],toColor:[255,254,52]},{fromColor:[255,254,52],toColor:[0,251,50]},{fromColor:[0,
251,50],toColor:[255,254,52]},{fromColor:[0,253,255],toColor:[0,181,255]},{fromColor:[0,181,255],toColor:[26,35,253]},{fromColor:[26,35,253],toColor:[255,57,251]},{fromColor:[255,57,251],toColor:[255,45,8]}]},{id:"black-to-white",fromColor:[0,0,0],toColor:[255,255,255]},{id:"blue-bright",fromColor:[204,204,255],toColor:[0,0,224]},{id:"blue-light-to-dark",fromColor:[211,229,232],toColor:[46,100,140]},{id:"blue-green-bright",fromColor:[203,245,234],toColor:[48,207,146]},{id:"blue-green-light-to-dark",
fromColor:[216,242,237],toColor:[21,79,74]},{id:"brown-light-to-dark",fromColor:[240,236,170],toColor:[102,72,48]},{id:"brown-to-blue-green-diverging-right",type:"multipart",colorRamps:[{fromColor:[156,85,31],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[33,130,145]}]},{id:"brown-to-blue-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[110,70,45],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[48,100,102]}]},{id:"coefficient-bias",fromColor:[214,214,255],toColor:[0,
57,148]},{id:"cold-to-hot-diverging",type:"multipart",colorRamps:[{fromColor:[69,117,181],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[214,47,39]}]},{id:"condition-number",type:"multipart",colorRamps:[{fromColor:[0,97,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,34,0]}]},{id:"cyan-to-purple",type:"multipart",colorRamps:[{fromColor:[0,245,245],toColor:[0,0,245]},{fromColor:[0,0,245],toColor:[245,0,245]}]},{id:"cyan-light-to-blue-dark",type:"multipart",colorRamps:[{fromColor:[182,
237,240],toColor:[31,131,224]},{fromColor:[31,131,224],toColor:[9,9,145]}]},{id:"distance",fromColor:[255,200,0],toColor:[0,0,255]},{id:"elevation1",type:"multipart",colorRamps:[{fromColor:[175,240,233],toColor:[255,255,179]},{fromColor:[255,255,179],toColor:[0,128,64]},{fromColor:[0,128,64],toColor:[252,186,3]},{fromColor:[252,186,3],toColor:[128,0,0]},{fromColor:[120,0,0],toColor:[105,48,13]},{fromColor:[105,48,13],toColor:[171,171,171]},{fromColor:[171,171,171],toColor:[255,252,255]}]},{id:"elevation2",
type:"multipart",colorRamps:[{fromColor:[118,219,211],toColor:[255,255,199]},{fromColor:[255,255,199],toColor:[255,255,128]},{fromColor:[255,255,128],toColor:[217,194,121]},{fromColor:[217,194,121],toColor:[135,96,38]},{fromColor:[135,96,38],toColor:[150,150,181]},{fromColor:[150,150,181],toColor:[181,150,181]},{fromColor:[181,150,181],toColor:[255,252,255]}]},{id:"errors",fromColor:[255,235,214],toColor:[196,10,10]},{id:"gray-light-to-dark",fromColor:[219,219,219],toColor:[69,69,69]},{id:"green-bright",
fromColor:[204,255,204],toColor:[14,204,14]},{id:"green-light-to-dark",fromColor:[220,245,233],toColor:[34,102,51]},{id:"green-to-blue",type:"multipart",colorRamps:[{fromColor:[32,204,16],toColor:[0,242,242]},{fromColor:[0,242,242],toColor:[2,33,227]}]},{id:"orange-bright",fromColor:[255,235,204],toColor:[240,118,5]},{id:"orange-light-to-dark",fromColor:[250,233,212],toColor:[171,65,36]},{id:"partial-spectrum",type:"multipart",colorRamps:[{fromColor:[242,241,162],toColor:[255,255,0]},{fromColor:[255,
255,0],toColor:[255,0,0]},{fromColor:[252,3,69],toColor:[176,7,237]},{fromColor:[176,7,237],toColor:[2,29,173]}]},{id:"partial-spectrum-1-diverging",type:"multipart",colorRamps:[{fromColor:[135,38,38],toColor:[240,149,12]},{fromColor:[240,149,12],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[74,80,181]},{fromColor:[74,80,181],toColor:[39,32,122]}]},{id:"partial-spectrum-2-diverging",type:"multipart",colorRamps:[{fromColor:[115,77,42],toColor:[201,137,52]},{fromColor:[201,137,52],toColor:[255,
255,191]},{fromColor:[255,255,191],toColor:[91,63,176]},{fromColor:[91,63,176],toColor:[81,13,97]}]},{id:"pink-to-yellow-green-diverging-bright",type:"multipart",colorRamps:[{fromColor:[158,30,113],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[99,110,45]}]},{id:"pink-to-yellow-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[97,47,73],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[22,59,15]}]},{id:"precipitation",type:"multipart",colorRamps:[{fromColor:[194,82,60],
toColor:[237,161,19]},{fromColor:[237,161,19],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,219,0]},{fromColor:[0,219,0],toColor:[32,153,143]},{fromColor:[32,153,143],toColor:[11,44,122]}]},{id:"prediction",type:"multipart",colorRamps:[{fromColor:[40,146,199],toColor:[250,250,100]},{fromColor:[250,250,100],toColor:[232,16,20]}]},{id:"purple-bright",fromColor:[255,204,255],toColor:[199,0,199]},{id:"purple-to-green-diverging-bright",type:"multipart",colorRamps:[{fromColor:[77,32,150],toColor:[255,
255,191]},{fromColor:[255,255,191],toColor:[20,122,11]}]},{id:"purple-to-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[67,14,89],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[24,79,15]}]},{id:"purple-blue-bright",fromColor:[223,184,230],toColor:[112,12,242]},{id:"purple-blue-light-to-dark",fromColor:[229,213,242],toColor:[93,44,112]},{id:"purple-red-bright",fromColor:[255,204,225],toColor:[199,0,99]},{id:"purple-red-light-to-dark",fromColor:[250,215,246],toColor:[143,17,
57]},{id:"red-bright",fromColor:[255,204,204],toColor:[219,0,0]},{id:"red-light-to-dark",fromColor:[255,224,224],toColor:[143,10,10]},{id:"red-to-blue-diverging-bright",type:"multipart",colorRamps:[{fromColor:[196,69,57],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[48,95,207]}]},{id:"red-to-blue-diverging-dark",type:"multipart",colorRamps:[{fromColor:[107,13,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[13,53,97]}]},{id:"red-to-green",type:"multipart",colorRamps:[{fromColor:[245,
0,0],toColor:[245,245,0]},{fromColor:[245,245,0],toColor:[0,245,0]}]},{id:"red-to-green-diverging-bright",type:"multipart",colorRamps:[{fromColor:[186,20,20],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[54,145,33]}]},{id:"red-to-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[97,21,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[16,69,16]}]},{id:"slope",type:"multipart",colorRamps:[{fromColor:[56,168,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,
0,0]}]},{id:"spectrum-full-bright",type:"multipart",colorRamps:[{fromColor:[255,0,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,0,255]}]},{id:"spectrum-full-dark",type:"multipart",colorRamps:[{fromColor:[153,0,0],toColor:[153,153,0]},{fromColor:[153,153,0],toColor:[0,153,153]},{fromColor:[0,153,153],toColor:[0,0,153]}]},{id:"spectrum-full-light",type:"multipart",colorRamps:[{fromColor:[255,153,153],toColor:[255,255,153]},{fromColor:[255,255,
153],toColor:[153,255,255]},{fromColor:[153,255,255],toColor:[153,153,255]}]},{id:"surface",type:"multipart",colorRamps:[{fromColor:[112,153,89],toColor:[242,238,162]},{fromColor:[242,238,162],toColor:[242,206,133]},{fromColor:[242,206,133],toColor:[194,140,124]},{fromColor:[194,140,124],toColor:[255,242,255]}]},{id:"temperature",type:"multipart",colorRamps:[{fromColor:[255,252,255],toColor:[255,0,255]},{fromColor:[255,0,255],toColor:[0,0,255]},{fromColor:[0,0,255],toColor:[0,255,255]},{fromColor:[0,
255,255],toColor:[0,255,0]},{fromColor:[0,255,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,128,0]},{fromColor:[255,128,0],toColor:[128,0,0]}]},{id:"white-to-black",fromColor:[255,255,255],toColor:[0,0,0]},{id:"yellow-to-dark-red",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[242,167,46]},{fromColor:[242,167,46],toColor:[107,0,0]}]},{id:"yellow-to-green-to-dark-blue",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[56,224,9]},{fromColor:[56,224,9],toColor:[26,
147,171]},{fromColor:[26,147,171],toColor:[12,16,120]}]},{id:"yellow-to-red",fromColor:[245,245,0],toColor:[255,0,0]},{id:"yellow-green-bright",fromColor:[236,252,204],toColor:[157,204,16]},{id:"yellow-green-light-to-dark",fromColor:[215,240,175],toColor:[96,107,45]}],E=new O.JSONMap({Aspect:"aspect","Black to White":"black-to-white","Blue Bright":"blue-bright","Blue Light to Dark":"blue-light-to-dark","Blue-Green Bright":"blue-green-bright","Blue-Green Light to Dark":"blue-green-light-to-dark","Brown Light to Dark":"brown-light-to-dark",
"Brown to Blue Green Diverging, Bright":"brown-to-blue-green-diverging-right","Brown to Blue Green Diverging, Dark":"brown-to-blue-green-diverging-dark","Coefficient Bias":"coefficient-bias","Cold to Hot Diverging":"cold-to-hot-diverging","Condition Number":"condition-number","Cyan to Purple":"cyan-to-purple","Cyan-Light to Blue-Dark":"cyan-light-to-blue-dark",Distance:"distance","Elevation #1":"elevation1","Elevation #2":"elevation2",Errors:"errors","Gray Light to Dark":"gray-light-to-dark","Green Bright":"green-bright",
"Green Light to Dark":"green-light-to-dark","Green to Blue":"green-to-blue","Orange Bright":"orange-bright","Orange Light to Dark":"orange-light-to-dark","Partial Spectrum":"partial-spectrum","Partial Spectrum 1 Diverging":"partial-spectrum-1-diverging","Partial Spectrum 2 Diverging":"partial-spectrum-2-diverging","Pink to YellowGreen Diverging, Bright":"pink-to-yellow-green-diverging-bright","Pink to YellowGreen Diverging, Dark":"pink-to-yellow-green-diverging-dark",Precipitation:"precipitation",
Prediction:"prediction","Purple Bright":"purple-bright","Purple to Green Diverging, Bright":"purple-to-green-diverging-bright","Purple to Green Diverging, Dark":"purple-to-green-diverging-dark","Purple-Blue Bright":"purple-blue-bright","Purple-Blue Light to Dark":"purple-blue-light-to-dark","Purple-Red Bright":"purple-red-bright","Purple-Red Light to Dark":"purple-red-light-to-dark","Red Bright":"red-bright","Red Light to Dark":"red-light-to-dark","Red to Blue Diverging, Bright":"red-to-blue-diverging-bright",
"Red to Blue Diverging, Dark":"red-to-blue-diverging-dark","Red to Green":"red-to-green","Red to Green Diverging, Bright":"red-to-green-diverging-bright","Red to Green Diverging, Dark":"red-to-green-diverging-dark",Slope:"slope","Spectrum-Full Bright":"spectrum-full-bright","Spectrum-Full Dark":"spectrum-full-dark","Spectrum-Full Light":"spectrum-full-light",Surface:"surface",Temperature:"temperature","White to Black":"white-to-black","Yellow to Dark Red":"yellow-to-dark-red","Yellow to Green to Dark Blue":"yellow-to-green-to-dark-blue",
"Yellow to Red":"yellow-to-red","Yellow-Green Bright":"yellow-green-bright","Yellow-Green Light to Dark":"yellow-green-light-to-dark"});q.colorRampDict=E;q.convertColorRampToColormap=function(a,e){a=F(a,e);const c=e?.interpolateAlpha;a.forEach((b,g)=>{b.unshift(g);c||b.pop()});return a};q.convertColorRampToColors=F;q.convertRGBATo32Bit=function(a){a=a.reverse().map(e=>{e=e.toString(16);return 2>e.length?"0"+e:e});return 4294967295&Number.parseInt(a.join(""),16)};q.getColorRampId=B;q.getColorRampJSON=
function(a,e="esriCIELabAlgorithm"){const c=w.find(({id:b})=>b===a);return c?c.colorRamps?{type:"multipart",colorRamps:c.colorRamps.map(b=>({type:"algorithmic",algorithm:e,fromColor:[...b.fromColor],toColor:[...b.toColor]}))}:{type:"algorithmic",algorithm:e,fromColor:[...c.fromColor],toColor:[...c.toColor]}:null};q.getColorRampName=r;q.getRFxArgColorRampValue=function(a){const e=r(a);return e?"algorithmic"===a.type?{...l(a),Name:e}:a.colorRamps?(a=a.colorRamps.map(l),{type:"MultiPartColorRamp",NumColorRamps:a.length,
ArrayOfColorRamp:a,Name:e}):null:null};q.predefinedJsonColorRamps=w;q.rasterColormapNames="random ndvi ndvi2 ndvi3 elevation gray hillshade".split(" ");Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/colorRamps":function(){define(["exports","./AlgorithmicColorRamp","./ColorRamp","./MultipartColorRamp"],function(q,D,z,O){z={key:"type",base:z,typeMap:{algorithmic:D,multipart:O}};q.fromJSON=function(A){return A?.type?"algorithmic"===A.type?D.fromJSON(A):"multipart"===
A.type?O.fromJSON(A):null:null};q.types=z;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/AlgorithmicColorRamp":function(){define("../../chunks/tslib.es6 ../../Color ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./ColorRamp".split(" "),function(q,D,z,O,A,U,Q,K){var J;K=J=class extends K{constructor(B){super(B);this.toColor=
this.fromColor=this.algorithm=null;this.type="algorithmic"}clone(){return new J({fromColor:z.clone(this.fromColor),toColor:z.clone(this.toColor),algorithm:this.algorithm})}};q.__decorate([U.enumeration({esriCIELabAlgorithm:"cie-lab",esriHSVAlgorithm:"hsv",esriLabLChAlgorithm:"lab-lch"})],K.prototype,"algorithm",void 0);q.__decorate([O.property({type:D,json:{type:[A.Integer],write:!0}})],K.prototype,"fromColor",void 0);q.__decorate([O.property({type:D,json:{type:[A.Integer],write:!0}})],K.prototype,
"toColor",void 0);q.__decorate([O.property({type:["algorithmic"]})],K.prototype,"type",void 0);return K=J=q.__decorate([Q.subclass("esri.rest.support.AlgorithmicColorRamp")],K)})},"esri/rest/support/ColorRamp":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),function(q,D,z,O,A,U,Q){D=class extends D.JSONSupport{constructor(K){super(K);
this.type=null}};q.__decorate([z.property({readOnly:!0,json:{read:!1,write:!0}})],D.prototype,"type",void 0);return D=q.__decorate([Q.subclass("esri.rest.support.ColorRamp")],D)})},"esri/rest/support/MultipartColorRamp":function(){define("../../chunks/tslib.es6 ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./AlgorithmicColorRamp ./ColorRamp".split(" "),function(q,D,z,O,A,U,Q){var K;O=K=class extends Q{constructor(J){super(J);
this.colorRamps=null;this.type="multipart"}clone(){return new K({colorRamps:D.clone(this.colorRamps)})}};q.__decorate([z.property({type:[U],json:{write:!0}})],O.prototype,"colorRamps",void 0);q.__decorate([z.property({type:["multipart"]})],O.prototype,"type",void 0);return O=K=q.__decorate([A.subclass("esri.rest.support.MultipartColorRamp")],O)})},"esri/layers/support/rasterFunctions/colormaps":function(){define(["exports","../../../renderers/support/colorRampUtils"],function(q,D){function z(K,J){const B=
[],r=[];for(let f=0;f<K.length-1;f++)B.push({type:"algorithmic",algorithm:"esriHSVAlgorithm",fromColor:K[f].slice(1),toColor:K[f+1].slice(1)}),r.push(K[f+1][0]-K[f][0]);K=K[K.length-1][0];J=J??r;return D.convertColorRampToColors({type:"multipart",colorRamps:B},{numColors:K,weights:J})}function O(){const K=z([[0,255,255,255],[70,0,255,0],[80,205,173,193],[100,150,150,150],[110,120,51,100],[130,120,100,200],[140,28,3,144],[160,6,0,55],[180,10,25,30],[201,6,7,27]]);for(let J=K.length;256>J;J++)K.push([6,
27,7]);return K}function A(){const K=[];for(let J=0;256>J;J++){const B=[];for(let r=0;3>r;r++)B.push(Math.round(255*Math.random()));K.push(B)}return K}const U=[[36,0,255],[36,0,255],[36,0,255],[36,0,255],[112,75,3],[113,76,3],[114,77,3],[115,77,3],[116,78,3],[117,79,3],[118,79,3],[119,80,3],[121,81,4],[122,82,4],[123,82,4],[124,83,4],[125,84,4],[126,84,4],[127,85,4],[128,86,4],[129,86,4],[130,87,4],[131,88,4],[132,89,4],[133,89,4],[134,90,4],[135,91,4],[136,91,4],[137,92,4],[138,93,4],[139,94,4],
[140,94,4],[142,95,5],[143,96,5],[144,96,5],[145,97,5],[146,98,5],[147,99,5],[148,99,5],[149,100,5],[150,101,5],[151,101,5],[152,102,5],[153,103,5],[154,104,5],[155,104,5],[156,105,5],[157,106,5],[158,106,5],[159,107,5],[160,108,5],[161,108,5],[162,109,5],[164,110,6],[165,111,6],[166,111,6],[167,112,6],[168,113,6],[169,113,6],[170,114,6],[171,115,6],[172,116,6],[173,116,6],[174,117,6],[245,0,0],[245,5,0],[245,10,0],[246,15,0],[246,20,0],[246,25,0],[246,30,0],[247,35,0],[247,40,0],[247,45,0],[247,
50,0],[247,55,0],[248,60,0],[248,65,0],[248,70,0],[248,75,0],[249,81,0],[249,86,0],[249,91,0],[249,96,0],[250,101,0],[250,106,0],[250,111,0],[250,116,0],[250,121,0],[251,126,0],[251,131,0],[251,136,0],[251,141,0],[252,146,0],[252,151,0],[252,156,0],[252,156,0],[251,159,0],[250,162,0],[249,165,0],[248,168,0],[247,171,0],[246,174,0],[245,177,0],[245,179,0],[244,182,0],[243,185,0],[242,188,0],[241,191,0],[240,194,0],[239,197,0],[238,200,0],[237,203,0],[236,206,0],[235,209,0],[234,212,0],[233,215,0],
[232,218,0],[231,221,0],[230,224,0],[230,226,0],[229,229,0],[228,232,0],[227,235,0],[226,238,0],[225,241,0],[224,244,0],[223,247,0],[165,247,0],[163,244,0],[161,240,0],[158,237,0],[156,233,1],[154,230,1],[152,227,1],[149,223,1],[147,220,1],[145,216,1],[143,213,1],[140,210,2],[138,206,2],[136,203,2],[134,200,2],[132,196,2],[129,193,2],[127,189,2],[125,186,3],[123,183,3],[120,179,3],[118,176,3],[116,172,3],[114,169,3],[111,166,3],[109,162,4],[107,159,4],[105,155,4],[103,152,4],[100,149,4],[98,145,4],
[96,142,4],[94,138,5],[91,135,5],[89,132,5],[87,128,5],[85,125,5],[82,121,5],[80,118,5],[78,115,6],[76,111,6],[73,108,6],[71,105,6],[69,101,6],[67,98,6],[65,94,6],[62,91,7],[60,88,7],[58,84,7],[56,81,7],[53,77,7],[51,74,7],[49,71,7],[47,67,8],[44,64,8],[42,60,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],
[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8]],Q=[[36,0,255],[36,0,
255],[36,0,255],[36,0,255],[245,20,0],[245,24,0],[245,29,0],[245,31,0],[247,33,0],[247,33,0],[247,37,0],[247,41,0],[247,41,0],[247,41,0],[247,45,0],[247,45,0],[247,47,0],[247,49,0],[247,49,0],[247,54,0],[247,54,0],[247,56,0],[247,58,0],[247,58,0],[250,62,0],[250,62,0],[250,62,0],[250,67,0],[250,67,0],[250,67,0],[250,69,0],[250,71,0],[250,71,0],[250,75,0],[250,75,0],[250,78,0],[250,79,0],[250,79,0],[250,79,0],[250,81,0],[250,83,0],[250,83,0],[250,87,0],[250,87,0],[250,90,0],[250,92,0],[252,93,0],[252,
93,0],[252,97,0],[252,97,0],[252,97,0],[252,97,0],[252,101,0],[252,101,0],[252,101,0],[252,101,0],[252,105,0],[252,105,0],[252,107,0],[252,109,0],[252,109,0],[252,113,13],[255,118,20],[255,119,23],[255,121,25],[255,126,33],[255,132,38],[255,133,40],[255,135,43],[255,141,48],[255,144,54],[255,150,59],[255,152,61],[255,153,64],[255,159,69],[255,163,77],[255,165,79],[255,168,82],[255,174,87],[255,176,92],[255,181,97],[255,183,99],[255,186,102],[255,191,107],[255,197,115],[255,201,120],[255,203,123],
[255,205,125],[255,209,130],[255,214,138],[255,216,141],[255,218,143],[255,224,150],[255,228,156],[255,234,163],[255,236,165],[255,238,168],[255,243,173],[255,248,181],[255,252,186],[253,252,186],[250,252,187],[244,250,180],[238,247,176],[234,246,173],[231,245,169],[223,240,163],[217,237,157],[211,235,150],[205,233,146],[200,230,142],[195,227,136],[189,224,132],[184,222,126],[180,220,123],[174,217,119],[169,214,114],[163,212,108],[160,210,105],[154,207,101],[148,204,96],[143,201,93],[138,199,88],
[134,197,84],[130,194,81],[126,191,77],[117,189,70],[115,186,68],[112,184,64],[106,181,60],[100,179,55],[94,176,49],[92,174,47],[90,173,45],[81,168,37],[75,166,33],[71,163,28],[66,160,24],[62,158,21],[56,156,14],[51,153,0],[51,153,0],[51,153,0],[50,150,0],[50,150,0],[50,150,0],[50,150,0],[49,148,0],[49,148,0],[49,148,0],[48,145,0],[48,145,0],[48,145,0],[48,145,0],[48,143,0],[48,143,0],[48,143,0],[48,143,0],[47,140,0],[47,140,0],[47,140,0],[47,140,0],[46,138,0],[46,138,0],[46,138,0],[46,138,0],[45,
135,0],[45,135,0],[45,135,0],[45,135,0],[44,133,0],[44,133,0],[44,133,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[42,128,0],[42,128,0],[42,128,0],[42,125,0],[42,125,0],[42,125,0],[42,125,0],[41,122,0],[41,122,0],[41,122,0],[41,122,0],[40,120,0],[40,120,0],[40,120,0],[40,120,0],[40,120,0],[39,117,0],[39,117,0],[39,117,0],[39,117,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],
[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0]];q.getColormapByName=
function(K){let J;switch(K){case "elevation":J=z([[0,0,191,191],[51,0,0,255],[102,255,0,255],[153,255,0,127],[204,191,63,127],[256,20,20,20]]);break;case "gray":J=D.convertColorRampToColors({type:"algorithmic",algorithm:"esriHSVAlgorithm",fromColor:[0,0,0],toColor:[255,255,255]});break;case "hillshade":J=z([[0,38,41,54],[69,79,82,90],[131,156,156,156],[256,253,253,241]],[.268,.238,.495]);break;case "ndvi":J=U;break;case "ndvi2":J=O();break;case "ndvi3":J=Q;break;case "random":J=A()}return J?J=J.map((B,
r)=>[r,...B]):null};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/CompositeBandFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./CompositeBandFunctionArguments ./pixelUtils".split(" "),function(q,D,z,O,A,U,Q,K,J){z=class extends Q{constructor(){super(...arguments);
this.functionName="CompositeBand";this.functionArguments=null;this.rasterArgumentNames=["rasters"]}_bindSourceRasters(){var {sourceRasterInfos:B}=this,r=B[0];this.outputPixelType=this._getOutputPixelType(r.pixelType);r=r.clone();r.attributeTable=null;r.colormap=null;r.pixelType=this.outputPixelType;r.bandCount=B.map(({bandCount:f})=>f).reduce((f,d)=>f+d);if(B.every(({statistics:f})=>null!=f&&f.length)){const f=[];B.forEach(({statistics:d})=>null!=d&&f.push(...d));r.statistics=f}if(B.every(({histograms:f})=>
null!=f&&f.length)){const f=[];B.forEach(({histograms:d})=>null!=d&&f.push(...d));r.histograms=f}1<r.bandCount&&(r.colormap=null,r.attributeTable=null);B=B.every(f=>f.keyProperties.BandProperties?.length)?B.flatMap(f=>f.keyProperties.BandProperties):void 0;r.keyProperties={...r.keyProperties,BandProperties:B};this.rasterInfo=r;return{success:!0,supportsGPU:3>=r.bandCount}}_processPixels(B){({pixelBlocks:B}=B);return B&&null!=B?.[0]?J.compositeBands(B):null}_getWebGLParameters(){return{bandCount:this.rasterInfo.bandCount}}};
q.__decorate([D.property({json:{write:!0,name:"rasterFunction"}})],z.prototype,"functionName",void 0);q.__decorate([D.property({type:K,json:{write:!0,name:"rasterFunctionArguments"}})],z.prototype,"functionArguments",void 0);q.__decorate([D.property()],z.prototype,"rasterArgumentNames",void 0);return z=q.__decorate([U.subclass("esri.layers.support.rasterFunctions.CompositeBandFunction")],z)})},"esri/layers/support/rasterFunctions/CompositeBandFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseFunctionArguments".split(" "),
function(q,D,z,O,A,U,Q){var K;O=K=class extends Q{constructor(){super(...arguments);this.rasters=[]}writeRasters(J,B){B.rasters=J.map(r=>"number"===typeof r||"string"===typeof r?r:r.toJSON())}clone(){return new K({rasters:D.clone(this.rasters)})}};q.__decorate([z.property({json:{write:!0}})],O.prototype,"rasters",void 0);q.__decorate([U.writer("rasters")],O.prototype,"writeRasters",null);return O=K=q.__decorate([A.subclass("esri.layers.support.rasterFunctions.CompositeBandFunctionArguments")],O)})},
"esri/layers/support/rasterFunctions/ContrastBrightnessFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./ContrastBrightnessFunctionArguments ./pixelUtils ./stretchUtils".split(" "),function(q,D,z,O,A,U,Q,K,J,B){z=class extends Q{constructor(){super(...arguments);this.functionName="ContrastBrightness";
this.functionArguments=null;this.rasterArgumentNames=["raster"];this.lookup=null}_bindSourceRasters(){var {sourceRasterInfos:r}=this;r=r[0];if("u8"!==r.pixelType)return{success:!1,supportsGPU:!1,error:"Only unsigned 8 bit raster is supported by ContrastBrightness function."};this.outputPixelType=this._getOutputPixelType("u8");r=r.clone();r.colormap=null;r.statistics=null;r.histograms=null;this.rasterInfo=r;const {contrastOffset:f,brightnessOffset:d}=this.functionArguments;this.lookup=B.createContrastBrightnessLUT(f,
d);return{success:!0,supportsGPU:!0}}_processPixels(r){r=r.pixelBlocks?.[0];return null==r?null:J.lookupPixels(r,{lut:r.pixels.map(()=>this.lookup),offset:0,outputPixelType:"u8"})}_getWebGLParameters(){const {contrastOffset:r,brightnessOffset:f}=this.functionArguments;return{contrastOffset:r,brightnessOffset:f}}};q.__decorate([D.property({json:{write:!0,name:"rasterFunction"}})],z.prototype,"functionName",void 0);q.__decorate([D.property({type:K,json:{write:!0,name:"rasterFunctionArguments"}})],z.prototype,
"functionArguments",void 0);q.__decorate([D.property()],z.prototype,"rasterArgumentNames",void 0);q.__decorate([D.property({json:{write:!0}})],z.prototype,"lookup",void 0);return z=q.__decorate([U.subclass("esri.layers.support.rasterFunctions.ContrastBrightnessFunction")],z)})},"esri/layers/support/rasterFunctions/ContrastBrightnessFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(q,D,z,O,A,U,Q){var K;z=K=class extends Q{constructor(){super(...arguments);this.brightnessOffset=this.contrastOffset=0}clone(){return new K({contrastOffset:this.contrastOffset,brightnessOffset:this.brightnessOffset,raster:this.raster})}};q.__decorate([D.property({json:{write:!0}})],z.prototype,"contrastOffset",void 0);q.__decorate([D.property({json:{write:!0}})],z.prototype,"brightnessOffset",void 0);return z=K=q.__decorate([U.subclass("esri.layers.support.rasterFunctions.ContrastBrightnessFunctionArguments")],
z)})},"esri/layers/support/rasterFunctions/stretchUtils":function(){define(["exports","../../../core/maybe","../PixelBlock","../rasterFormats/pixelRangeUtils","../../../renderers/support/stretchRendererUtils"],function(q,D,z,O,A){function U(d,u=256){u=Math.min(u,256);const {size:F,counts:p}=d;d=new Uint8Array(F);var l=p.reduce((c,b)=>c+b/u,0);let w=0;var E=0;let a=0,e=l;for(let c=0;c<F;c++)if(a+=p[c],!(c<F-1&&a+p[c+1]<e)){for(;w<u-1&&e<a;)w++,e+=l;for(;E<=c;E++)d[E]=w;E=c+1}for(l=E;l<F;l++)d[l]=u-
1;return d}function Q(d,u){d=Math.min(Math.max(d,-100),100);u=Math.min(Math.max(u??0,-100),100);let F=0,p=0;const l=new Uint8Array(256);for(F=0;256>F;F++)0<d&&100>d?p=(200*F-25500+510*u)/(2*(100-d))+128:0>=d&&-100<d?p=(200*F-25500+510*u)*(100+d)/2E4+128:100===d?(p=200*F-25500+256*(100-d)+510*u,p=0<p?255:0):-100===d&&(p=128),l[F]=255<p?255:0>p?0:p;return l}function K(d,u,F,p){let l=Infinity,w=-Infinity;var E=0,a=0,e=0,c=0;const b=d.length;var g=new Map,m=[];for(let n=0;n<b;n++){const t=d[n];if(!u||
u[n]){m.push(t);const k=(g.get(t)??0)+1;g.set(t,k);k>c&&(c=k,e=t);l=t<l?t:l;w=t>w?t:w;E+=t;a++}}if(0===a)return{statistics:{min:0,max:0,avg:0,stddev:0,mode:0,median:0},histogram:null};E/=a;c=0;for(g=0;g<b;g++)if(!u||u[g])c+=(d[g]-E)**2;g=u?u.filter(n=>n).length:b;c=1>=g?0:Math.sqrt(c/(g-1));m.sort((n,t)=>n-t);g=a>>>1;e={min:l,max:w,avg:E,stddev:c,mode:e,median:a%2?m[Math.floor(g)]:(m[g-1]+m[g])/2};if(!p)return{statistics:e,histogram:null};if(["u8","s8","u4","u2","u1"].includes(F)){a=w-l+1;F=new Uint32Array(a);
for(p=0;p<b;p++)u&&!u[p]||F[d[p]-l]++;return{statistics:e,histogram:{min:l-.5,max:w+.5,size:a,counts:F}}}F=new Uint32Array(256);p=(w-l)/256;if(0===p)return{statistics:e,histogram:{min:l,max:w,size:1,counts:(new Uint32Array(1)).fill(a)}};a=new Uint32Array(257);for(m=0;m<b;m++)u&&!u[m]||a[Math.floor((d[m]-l)/p)]++;for(d=0;255>d;d++)F[d]=a[d];F[255]=a[255]+a[256];return{statistics:e,histogram:{min:l,max:w,size:256,counts:F}}}function J(d){if(!d?.pixels?.length)return null;const {pixels:u,mask:F,bandMasks:p,
pixelType:l}=d,w=d.width*d.height,E=u.length;let a,e;let c;var b;const g=[],m=[];for(c=0;c<E;c++){var n=new Uint32Array(256);var t=u[c];var k=p?.[c]??F;if("u8"===l)if(a=-.5,e=255.5,k)for(b=0;b<w;b++)k[b]&&n[t[b]]++;else for(b=0;b<w;b++)n[t[b]]++;else{b=!1;d.statistics||(d.updateStatistics(),b=!0);var y=d.statistics;a=y[c].minValue;e=y[c].maxValue;var I=(e-a)/256;if(0===I)for(!y||d.validPixelCount||b||d.updateStatistics(),I=(d.validPixelCount||d.width*d.height)/256,b=0;256>b;b++)n[b]=Math.round(I*
(b+1))-Math.round(I*b);else{y=new Uint32Array(257);for(b=0;b<w;b++)k&&!k[b]||y[Math.floor((t[b]-a)/I)]++;for(b=0;255>b;b++)n[b]=y[b];n[255]=y[255]+y[256]}}g.push({min:a,max:e,size:256,counts:n});for(b=k=t=I=0;256>b;b++)I+=n[b],t+=b*n[b];t/=I;for(b=0;256>b;b++)k+=n[b]*(b-t)**2;b=Math.sqrt(k/(I-1));I=(e-a)/256;n=(t+.5)*I+a;I*=b;m.push({min:a,max:e,avg:n,stddev:I})}return{statistics:m,histograms:g}}function B(d,u){if(null==u||0===u.length)return d;const F=Math.max.apply(null,u),{minCutOff:p,maxCutOff:l,
outMin:w,outMax:E,histogramLut:a}=d;return p.length===u.length||p.length<=F?d:{minCutOff:u.map(e=>p[e]),maxCutOff:u.map(e=>l[e]),histogramLut:a?u.map(e=>a[e]):null,outMin:w,outMax:E}}function r(d,u){const F=new Float32Array(d);for(let p=0;p<d;p++)F[p]=1<u[p]?2<u[p]?6.5+(u[p]-2)**2.5:6.5+100*(2-u[p])**4:1;return F}const f=[.299,.587,.114];q.computeGammaCorrection=r;q.computeGammaValues=function(d,u,F){const p=[];for(let e=0;e<u.length;e++){var l=0,w=0,E=0;"min"in u[e]?{min:l,max:w,avg:E}=u[e]:[l,w,
E]=u[e];E=E??0;"u8"!==d&&(E=255*(E-l)/(w-l));F&&(E*=f[e]);l=p;w=l.push;if(0>=E||255<=E)E=1;else{var a=0;150!==E&&(a=150>=E?45*Math.cos(.01047*E):17*Math.sin(.021*E));a=Math.log((E+a)/255);0===a?E=1:(E=Math.log(E/255)/a,E=isNaN(E)?1:Math.min(9.9,Math.max(.01,E)))}w.call(l,E)}return p};q.computeStatisticsHistograms=function(d){const {pixels:u,mask:F,pixelType:p,bandMasks:l}=d;var w=u.map((E,a)=>K(E,l?.[a]??F,p,!0));d=w.map(({statistics:E})=>E);w=w.map(({histogram:E})=>E);return{statistics:d,histograms:w}};
q.createContrastBrightnessLUT=Q;q.createHistogramEqualizationLUT=U;q.createStretchLUT=function(d){const {minCutOff:u,maxCutOff:F,gamma:p,pixelType:l,rounding:w}=d,E=d.outMin||0,a=d.outMax||255;if(!["u8","u16","s8","s16"].includes(l))return null;const e=u.length;let c,b,g=0;"s8"===l?g=-127:"s16"===l&&(g=-32767);let m=256;["u16","s16"].includes(l)&&(m=65536);var n=[],t=[];const k=a-E;for(c=0;c<e;c++)t[c]=F[c]-u[c],n[c]=0===t[c]?0:k/t[c];let y;const I=[];let C,L;if(p&&p.length>=e)for(n=r(e,p),c=0;c<
e;c++){L=[];for(b=0;b<m;b++)if(0===t[c])L[b]=E;else{var H=b+g;y=(H-u[c])/t[c];C=1;1<p[c]&&(C-=(1/k)**(y*n[c]));H<F[c]&&H>u[c]?(H=C*k*y**(1/p[c])+E,L[b]="floor"===w?Math.floor(H):"round"===w?Math.round(H):H):L[b]=H>=F[c]?a:E}I[c]=L}else for(c=0;c<e;c++){L=[];for(b=0;b<m;b++)H=b+g,H<=u[c]?L[b]=E:H>=F[c]?L[b]=a:(t=(H-u[c])*n[c]+E,L[b]="floor"===w?Math.floor(t):"round"===w?Math.round(t):t);I[c]=L}if(null!=d.contrastOffset)for(d=Q(d.contrastOffset,d.brightnessOffset),c=0;c<e;c++)for(L=I[c],b=0;b<m;b++)L[b]=
d[L[b]];return{lut:I,offset:g}};q.estimateStatisticsFromHistograms=function(d){const u=[];for(let w=0;w<d.length;w++){const {min:E,max:a,size:e,counts:c}=d[w];let b=0;var F=0;for(var p=0;p<e;p++)b+=c[p],F+=p*c[p];F/=b;p=0;for(var l=0;l<e;l++)p+=c[l]*(l-F)**2;l=(a-E)/e;u.push({min:E,max:a,avg:(F+.5)*l+E,stddev:Math.sqrt(p/(b-1))*l})}return u};q.estimateStatisticsHistograms=J;q.getStretchCutoff=function(d,u){const {pixelBlock:F,bandIds:p,returnHistogramLut:l,rasterInfo:w}=u;var E=null;u=null;var a=
d.stretchType;"number"===typeof a&&(a=A.stretchTypeFunctionEnum[a]);d.dra?"minMax"===a&&F?.statistics?E=F.statistics.map(H=>[H.minValue,H.maxValue,0,0]):(u=J(F),E=null!=u?u.statistics:null,u=null!=u?u.histograms:null):(E=d.statistics?.length?d.statistics:w.statistics,u="histograms"in d?d.histograms:void 0,u||(u=w.histograms));"percentClip"!==a&&"histogramEqualization"!==a||u?.length||(a="minMax");var e=E?.length||u?.length||w.bandCount;const c=[],b=[];let g,m,n;E&&!Array.isArray(E[0])&&(E=E.map(H=>
[H.min,H.max,H.avg,H.stddev]));const [t,k]=O.getPixelValueRange(w.pixelType);if(!E?.length){E=[];for(m=0;m<e;m++)E.push([t,k,1,1]);"standardDeviation"===a&&(a="minMax")}switch(a){case "none":for(m=0;m<e;m++)c[m]=t,b[m]=k;break;case "minMax":for(m=0;m<e;m++){var y=E[m];c[m]=y[0];b[m]=y[1]}break;case "standardDeviation":({numberOfStandardDeviations:y=2}=d);for(m=0;m<e;m++){var I=E[m];c[m]=I[2]-y*I[3];b[m]=I[2]+y*I[3];c[m]<I[0]&&(c[m]=I[0]);b[m]>I[1]&&(b[m]=I[1])}break;case "histogramEqualization":D.assertIsSome(u);
for(m=0;m<e;m++)c[m]=u[m].min,b[m]=u[m].max;break;case "percentClip":D.assertIsSome(u);for(m=0;m<u.length;m++){E=u[m];I=new Uint32Array(E.size);var C=[...E.counts];20<=C.length&&(C[0]=C[1]=C[2]=C[C.length-1]=C[C.length-2]=0);y=0;e=(E.max-E.min)/E.size;g=-.5===E.min&&1===e?.5:0;for(n=0;n<E.size;n++)y+=C[n],I[n]=y;C=(d.minPercent||0)*y/100;c[m]=E.min+g;for(n=0;n<E.size;n++)if(I[n]>C){c[m]=E.min+e*(n+g);break}C=(1-(d.maxPercent||0)/100)*y;b[m]=E.max+g;for(n=E.size-2;0<=n;n--)if(I[n]<C){b[m]=E.min+e*
(n+2-g);break}b[m]<c[m]&&(E=c[m],c[m]=b[m],b[m]=E)}break;default:for(m=0;m<e;m++)y=E[m],c[m]=y[0],b[m]=y[1]}let L;"histogramEqualization"===a?(D.assertIsSome(u),a=u[0].size||256,d=0,l&&(L=u.map(H=>U(H)))):(a=d.max||255,d=d.min||0);return B({minCutOff:c,maxCutOff:b,outMax:a,outMin:d,histogramLut:L},p)};q.stretch=function(d,u){if(!d?.pixels?.length)return d;const {mask:F,bandMasks:p,width:l,height:w,pixels:E}=d,{minCutOff:a,maxCutOff:e,gamma:c}=u;var b=u.outMin||0;const g=u.outMax||255,m=l*w,n=u.outputPixelType||
"u8";d=d.pixels.map(()=>z.createEmptyBand(n,m));const t=d.length;var k=g-b,y=[],I=[];for(var C=0;C<t;C++)I[C]=e[C]-a[C],y[C]=0===I[C]?0:k/I[C];C=n.startsWith("u")||n.startsWith("s");u=!!u.isRenderer;if(c&&c.length>=t){y=r(t,c);for(var L=0;L<t;L++){var H=p?.[L]??F;for(let x=0;x<m;x++)if(null==H||H[x]){if(0===I[L]){d[L][x]=b;continue}var S=E[L][x];const h=(S-a[L])/I[L];let G=1;1<c[L]&&(G-=(1/k)**(h*y[L]));S<e[L]&&S>a[L]?(S=G*k*h**(1/c[L])+b,d[L][x]=u?Math.floor(S):C?Math.round(S):S):d[L][x]=S>=e[L]?
g:b}}}else for(k=0;k<t;k++)for(I=p?.[k]??F,L=0;L<m;L++)if(null==I||I[L])H=E[k][L],H<e[k]&&H>a[k]?(H=(H-a[k])*y[k]+b,d[k][L]=u?Math.floor(H):C?Math.round(H):H):d[k][L]=H>=e[k]?g:b;b=new z({width:l,height:w,mask:F,bandMasks:p,pixels:d,pixelType:n});b.updateStatistics();return b};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/stretchRendererUtils":function(){define(["exports","../../core/jsonMap"],function(q,D){D=new D.JSONMap({none:"none",standardDeviation:"standard-deviation",
histogramEqualization:"histogram-equalization",minMax:"min-max",percentClip:"percent-clip",sigmoid:"sigmoid"});q.stretchTypeFunctionEnum={0:"none",3:"standardDeviation",4:"histogramEqualization",5:"minMax",6:"percentClip",9:"sigmoid"};q.stretchTypeJSONDict=D;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/ConvolutionFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../rasterFunctionConstants ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./ConvolutionFunctionArguments ./convolutionUtils".split(" "),
function(q,D,z,O,A,U,Q,K,J,B,r){z=class extends J{constructor(){super(...arguments);this.functionName="Convolution";this.rasterArgumentNames=["raster"]}_bindSourceRasters(){const {convolutionType:f,rows:d,cols:u,kernel:F}=this.functionArguments;if(!Object.values(Q.convolutionKernel).includes(f))return{success:!1,supportsGPU:!1,error:`convolution-function: the specified kernel type is not supported ${f}`};if(f!==Q.convolutionKernel.none&&d*u!==F.length)return{success:!1,supportsGPU:!1,error:"convolution-function: the specified rows and cols do not match the length of the kernel"};
var p=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType(p.pixelType);p=p.clone();p.pixelType=this.outputPixelType;const l=[Q.convolutionKernel.none,Q.convolutionKernel.sharpen,Q.convolutionKernel.sharpen2,Q.convolutionKernel.sharpening3x3,Q.convolutionKernel.sharpening5x5];"u8"===this.outputPixelType||l.includes(f)||(p.statistics=null,p.histograms=null);p.colormap=null;p.attributeTable=null;this.rasterInfo=p;return{success:!0,supportsGPU:25>=F.length}}_processPixels(f){f=f.pixelBlocks?.[0];
if(null==f||this.functionArguments.convolutionType===Q.convolutionKernel.none)return f;let {kernel:d,rows:u,cols:F}=this.functionArguments;const p=d.reduce((l,w)=>l+w);0!==p&&1!==p&&(d=d.map(l=>l/p));return r.convolute(f,{kernel:d,rows:u,cols:F,outputPixelType:this.outputPixelType})}_getWebGLParameters(){let {kernel:f}=this.functionArguments;const d=f.reduce((F,p)=>F+p);0!==d&&1!==d&&(f=f.map(F=>F/d));const u=new Float32Array(25);u.set(f);return{kernelRows:this.functionArguments.rows,kernelCols:this.functionArguments.cols,
kernel:u,clampRange:K.getPixelValueRange(this.outputPixelType)}}};q.__decorate([D.property({json:{write:!0,name:"rasterFunction"}})],z.prototype,"functionName",void 0);q.__decorate([D.property({type:B,json:{write:!0,name:"rasterFunctionArguments"}})],z.prototype,"functionArguments",void 0);q.__decorate([D.property()],z.prototype,"rasterArgumentNames",void 0);return z=q.__decorate([U.subclass("esri.layers.support.rasterFunctions.ConvolutionFunction")],z)})},"esri/layers/support/rasterFunctionConstants":function(){define(["exports"],
function(q){const D={plus:1,minus:2,times:3,sqrt:4,power:5,abs:10,divide:23,exp:25,exp10:26,exp2:27,int:30,float:32,ln:35,log10:36,log2:37,mod:44,negate:45,roundDown:48,roundUp:49,square:53,floatDivide:64,floorDivide:65},z={bitwiseAnd:11,bitwiseLeftShift:12,bitwiseNot:13,bitwiseOr:14,bitwiseRightShift:15,bitwiseXOr:16,booleanAnd:17,booleanNot:18,booleanOr:19,booleanXOr:20,equalTo:24,greaterThan:28,greaterThanEqual:29,lessThan:33,lessThanEqual:34,isNull:31,notEqual:46},O={acos:6,asin:7,atan:8,atanh:9,
cos:21,cosh:22,sin:51,sinh:52,tan:56,tanh:57,acosh:59,asinh:60,atan2:61},A={majority:38,max:39,mean:40,med:41,min:42,minority:43,range:47,stddev:54,sum:55,variety:58,majorityIgnoreNoData:66,maxIgnoreNoData:67,meanIgnoreNoData:68,medIgnoreNoData:69,minIgnoreNoData:70,minorityIgnoreNoData:71,rangeIgnoreNoData:72,stddevIgnoreNoData:73,sumIgnoreNoData:74,varietyIgnoreNoData:75},U={setNull:50,conditional:78},Q={...D,...z,...O,...A,...U};q.bandIndexType={userDefined:0,NDVI:1,SAVI:2,TSAVI:3,MSAVI:4,GEMI:5,
PVI:6,GVITM:7,Sultan:8,VARI:9,GNDVI:10,SR:11,NDVIRe:12,SRRe:13,MTVI2:14,RTVICore:15,CIRe:16,CIG:17,NDWI:18,EVI:19,ironOxide:20,ferrousMinerals:21,clayMinerals:22,WNDWI:23,BAI:24,NBR:25,NDBI:26,NDMI:27,NDSI:28,MNDWI:29};q.cellStatisticalOperation=A;q.colorRampName={aspect:"Aspect",blackToWhite:"Black to White",blueBright:"Blue Bright",blueLightToDark:"Blue Light to Dark",blueGreenBright:"Blue-Green Bright",blueGreenLightToDark:"Blue-Green Light to Dark",brownLightToDark:"Brown Light to Dark",brownToBlueGreenDivergingBright:"Brown to Blue Green Diverging, Bright",
brownToBlueGreenDivergingDark:"Brown to Blue Green Diverging, Dark",coefficientBias:"Coefficient Bias",coldToHotDiverging:"Cold to Hot Diverging",conditionNumber:"Condition Number",cyanToPurple:"Cyan to Purple",cyanLightToBlueDark:"Cyan-Light to Blue-Dark",distance:"Distance",elevation1:"Elevation #1",elevation2:"Elevation #2",errors:"Errors",grayLightToDark:"Gray Light to Dark",greenBright:"Green Bright",greenLightToDark:"Green Light to Dark",greenToBlue:"Green to Blue",orangeBright:"Orange Bright",
orangeLightToDark:"Orange Light to Dark",partialSpectrum:"Partial Spectrum",partialSpectrum1Diverging:"Partial Spectrum 1 Diverging",partialSpectrum2Diverging:"Partial Spectrum 2 Diverging",pinkToYellowGreenDivergingBright:"Pink to YellowGreen Diverging, Bright",pinkToYellowGreenDivergingDark:"Pink to YellowGreen Diverging, Dark",precipitation:"Precipitation",prediction:"Prediction",purpleBright:"Purple Bright",purpleToGreenDivergingBright:"Purple to Green Diverging, Bright",purpleToGreenDivergingDark:"Purple to Green Diverging, Dark",
purpleBlueBright:"Purple-Blue Bright",purpleBlueLightToDark:"Purple-Blue Light to Dark",purpleRedBright:"Purple-Red Bright",purpleRedLightToDark:"Purple-Red Light to Dark",redBright:"Red Bright",redLightToDark:"Red Light to Dark",redToBlueDivergingBright:"Red to Blue Diverging, Bright",redToBlueDivergingDark:"Red to Blue Diverging, Dark",redToGreen:"Red to Green",redToGreenDivergingBright:"Red to Green Diverging, Bright",redToGreenDivergingDark:"Red to Green Diverging, Dark",slope:"Slope",spectrumFullBright:"Spectrum-Full Bright",
spectrumFullDark:"Spectrum-Full Dark",spectrumFullLight:"Spectrum-Full Light",surface:"Surface",temperature:"Temperature",whiteToBlack:"White to Black",yellowToDarkRed:"Yellow to Dark Red",yellowToGreenToDarkBlue:"Yellow to Green to Dark Blue",yellowToRed:"Yellow to Red",yellowGreenBright:"Yellow-Green Bright",yellowGreenLightToDark:"Yellow-Green Light to Dark"};q.colormapName={random:"Random",NDVI:"NDVI",NDVI2:"NDVI2",NDVI3:"NDVI3",elevation:"Elevation",gray:"Gray",hillshade:"Hillshade"};q.convolutionKernel=
{userDefined:-1,lineDetectionHorizontal:0,lineDetectionVertical:1,lineDetectionLeftDiagonal:2,lineDetectionRightDiagonal:3,gradientNorth:4,gradientWest:5,gradientEast:6,gradientSouth:7,gradientNorthEast:8,gradientNorthWest:9,smoothArithmeticMean:10,smoothing3x3:11,smoothing5x5:12,sharpening3x3:13,sharpening5x5:14,laplacian3x3:15,laplacian5x5:16,sobelHorizontal:17,sobelVertical:18,sharpen:19,sharpen2:20,pointSpread:21,none:255};q.curvatureType={standard:0,platform:1,profile:2};q.localArithmeticOperation=
D;q.localConditionalOperation=U;q.localLogicalOperation=z;q.localOperators=Q;q.localTrigonometricOperation=O;q.missingBandAction={bestMatch:0,fail:1};q.noDataInterpretation={matchAny:0,matchAll:1};q.slopeType={degree:1,percentRise:2,adjusted:3};q.statisticsType={min:1,max:2,mean:3,standardDeviation:4,median:5,majority:6,minority:7};q.stretchType={none:0,standardDeviation:3,histogramEqualization:4,minMax:5,percentClip:6,sigmoid:9};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/ConvolutionFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../rasterFunctionConstants ./BaseFunctionArguments ./convolutionUtils".split(" "),
function(q,D,z,O,A,U,Q,K){var J;O=J=class extends Q{constructor(){super(...arguments);this.cols=this.rows=3;this.kernel=[0,0,0,0,1,0,0,0,0]}set convolutionType(B){this._set("convolutionType",B);const r=K.convolutionKernels.get(B);r&&B!==U.convolutionKernel.userDefined&&B!==U.convolutionKernel.none&&(B=Math.sqrt(r.length),this._set("kernel",r),this._set("cols",B),this._set("rows",B))}clone(){return new J({cols:this.cols,rows:this.rows,kernel:[...this.kernel],convolutionType:this.convolutionType,raster:D.clone(this.raster)})}};
q.__decorate([z.property({json:{type:Number,write:!0}})],O.prototype,"rows",void 0);q.__decorate([z.property({json:{type:Number,write:!0}})],O.prototype,"cols",void 0);q.__decorate([z.property({json:{name:"type",type:Number,write:!0}})],O.prototype,"convolutionType",null);q.__decorate([z.property({json:{type:[Number],write:!0}})],O.prototype,"kernel",void 0);return O=J=q.__decorate([A.subclass("esri.layers.support.rasterFunctions.ConvolutionFunctionArguments")],O)})},"esri/layers/support/rasterFunctions/convolutionUtils":function(){define(["exports",
"../PixelBlock","../rasterFunctionConstants","./mirror"],function(q,D,z,O){function A(B){const r=Math.sqrt(B.length),f=B.slice(0,r),d=[1];for(let u=1;u<r;u++){let F=null;for(let p=0;p<r;p++){const l=B[p+u*r],w=B[p];if(null==F)if(0===w){if(l)return{separable:!1,row:null,col:null}}else F=l/w;else if(l/w!==F)return{separable:!1,row:null,col:null}}if(null==F)return{separable:!1,row:null,col:null};d.push(F)}return{separable:!0,row:f,col:d}}function U(B,r,f,d,u,F,p){const l=new Float32Array(r*f),w=F.length,
E=p?0:d,a=p?d:0;p=p?1:r;for(let e=E;e<f-E;e++){const c=e*r;for(let b=a;b<r-a;b++){if(u&&!u[c+b])continue;let g=0;for(let m=0;m<w;m++)g+=B[c+b+(m-d)*p]*F[m];l[c+b]=g}}return l}function Q(B,r,f=!0){const {pixels:d,width:u,height:F,pixelType:p,mask:l}=B;B=d.length;const w=[],{kernel:E,rows:a,cols:e}=r;for(r=0;r<B;r++){var c=d[r],b=u,g=F,m=a,n=e,t=l,k=E;const y=new Float32Array(b*g),I=Math.floor(m/2),C=Math.floor(n/2);for(let L=I;L<g-I;L++){const H=L*b;for(let S=C;S<b-C;S++){if(t&&!t[H+S])continue;let x=
0;for(let h=0;h<m;h++)for(let G=0;G<n;G++)x+=c[H+S+(h-I)*b+G-C]*k[h*n+G];y[H+S]=x}}c=y;f&&O.mirror(c,u,F,a,e);w.push(c)}return new D({width:u,height:F,pixelType:p,pixels:w,mask:l})}function K(B,r,f,d=!0){const {pixels:u,width:F,height:p,pixelType:l,mask:w}=B;B=u.length;const E=[],a=r.length,e=f.length,c=Math.floor(a/2),b=Math.floor(e/2);for(let g=0;g<B;g++){let m=U(u[g],F,p,c,w,r,!0);m=U(m,F,p,b,w,f,!1);d&&O.mirror(m,F,p,a,e);E.push(m)}return new D({width:F,height:p,pixelType:l,pixels:E,mask:w})}
const J=new Map;J.set(z.convolutionKernel.none,[0,0,0,0,1,0,0,0,0]);J.set(z.convolutionKernel.lineDetectionHorizontal,[-1,-1,-1,2,2,2,-1,-1,-1]);J.set(z.convolutionKernel.lineDetectionVertical,[-1,2,-1,-1,2,-1,-1,2,-1]);J.set(z.convolutionKernel.lineDetectionLeftDiagonal,[2,-1,-1,-1,2,-1,-1,-1,2]);J.set(z.convolutionKernel.lineDetectionRightDiagonal,[-1,-1,2,-1,2,-1,2,-1,-1]);J.set(z.convolutionKernel.gradientNorth,[-1,-2,-1,0,0,0,1,2,1]);J.set(z.convolutionKernel.gradientWest,[-1,0,1,-2,0,2,-1,0,
1]);J.set(z.convolutionKernel.gradientEast,[1,0,-1,2,0,-2,1,0,-1]);J.set(z.convolutionKernel.gradientSouth,[1,2,1,0,0,0,-1,-2,-1]);J.set(z.convolutionKernel.gradientNorthEast,[0,-1,-2,1,0,-1,2,1,0]);J.set(z.convolutionKernel.gradientNorthWest,[-2,-1,0,-1,0,1,0,1,2]);J.set(z.convolutionKernel.smoothArithmeticMean,[.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111]);J.set(z.convolutionKernel.smoothing3x3,[.0625,.125,.0625,.125,
.25,.125,.0625,.125,.0625]);J.set(z.convolutionKernel.smoothing5x5,[1,1,1,1,1,1,4,4,4,1,1,4,12,4,1,1,4,4,4,1,1,1,1,1,1]);J.set(z.convolutionKernel.sharpening3x3,[-1,-1,-1,-1,9,-1,-1,-1,-1]);J.set(z.convolutionKernel.sharpening5x5,[-1,-3,-4,-3,-1,-3,0,6,0,-3,-4,6,21,6,-4,-3,0,6,0,-3,-1,-3,-4,-3,-1]);J.set(z.convolutionKernel.laplacian3x3,[0,-1,0,-1,4,-1,0,-1,0]);J.set(z.convolutionKernel.laplacian5x5,[0,0,-1,0,0,0,-1,-2,-1,0,-1,-2,17,-2,-1,0,-1,-2,-1,0,0,0,-1,0,0]);J.set(z.convolutionKernel.sobelHorizontal,
[-1,-2,-1,0,0,0,1,2,1]);J.set(z.convolutionKernel.sobelVertical,[-1,0,1,-2,0,2,-1,0,1]);J.set(z.convolutionKernel.sharpen,[0,-.25,0,-.25,2,-.25,0,-.25,0]);J.set(z.convolutionKernel.sharpen2,[-.25,-.25,-.25,-.25,3,-.25,-.25,-.25,-.25]);J.set(z.convolutionKernel.pointSpread,[-.627,.352,-.627,.352,2.923,.352,-.627,.352,-.627]);q.convolute=function(B,r){const f=A(r.kernel),d=!1!==r.mirrorEdges;B=f.separable?K(B,f.row,f.col,d):Q(B,r,d);({outputPixelType:r}=r);r&&B.clamp(r);return B};q.convoluteSeparable=
K;q.convolutionKernels=J;q.separateKernels=A;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/mirror":function(){define(["exports"],function(q){q.mirror=function(D,z,O,A,U){A=Math.floor(A/2);for(var Q=0;Q<A;Q++)for(var K=0;K<z;K++)D[Q*z+K]=D[(U-1-Q)*z+K],D[(O-1-Q)*z+K]=D[(O-U+Q)*z+K];A=Math.floor(U/2);for(Q=0;Q<O;Q++){K=Q*z;for(let J=0;J<A;J++)D[K+J]=D[K+U-1-J],D[K+z-J-1]=D[K+z+J-U]}};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},
"esri/layers/support/rasterFunctions/CurvatureFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./CurvatureFunctionArguments ./surfaceUtils".split(" "),function(q,D,z,O,A,U,Q,K,J){z=class extends Q{constructor(){super(...arguments);this.functionName="Curvature";this.functionArguments=null;this.rasterArgumentNames=
["raster"];this.isGCS=!1}_bindSourceRasters(){this.outputPixelType=this._getOutputPixelType("f32");const B=this.sourceRasterInfos[0].clone();B.pixelType=this.outputPixelType;B.statistics=null;B.histograms=null;B.colormap=null;B.attributeTable=null;B.bandCount=1;this.rasterInfo=B;this.isGCS=B.spatialReference?.isGeographic??!1;return{success:!0,supportsGPU:!0}}_processPixels(B){const r=B.pixelBlocks?.[0];if(null==r)return null;const {zFactor:f,curvatureType:d}=this.functionArguments,{extent:u,primaryPixelSizes:F}=
B;B=F?.[0];return J.curvature(r,{zFactor:this.isGCS&&1<=f?f*J.gcsFactor:f,curvatureType:d,resolution:null==B?u?{x:u.width/r.width,y:u.height/r.height}:{x:1,y:1}:B})}_getWebGLParameters(){const {zFactor:B,curvatureType:r}=this.functionArguments;return{curvatureType:r,zFactor:this.isGCS&&1<=B?B*J.gcsFactor:B}}};q.__decorate([D.property({json:{write:!0,name:"rasterFunction"}})],z.prototype,"functionName",void 0);q.__decorate([D.property({type:K,json:{write:!0,name:"rasterFunctionArguments"}})],z.prototype,
"functionArguments",void 0);q.__decorate([D.property()],z.prototype,"rasterArgumentNames",void 0);q.__decorate([D.property({json:{write:!0}})],z.prototype,"isGCS",void 0);return z=q.__decorate([U.subclass("esri.layers.support.rasterFunctions.CurvatureFunction")],z)})},"esri/layers/support/rasterFunctions/CurvatureFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/jsonMap ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(q,D,z,O,A,U,Q,K,J,B){var r;const f=new D.JSONMap({0:"standard",1:"platform",2:"profile"},{useNumericKeys:!0});D=r=class extends B{constructor(){super(...arguments);this.curvatureType="standard";this.zFactor=1}readCurvatureType(d,u){return f.fromJSON(u.type??u.curvatureType??0)}clone(){return new r({curvatureType:this.curvatureType,zFactor:this.zFactor,raster:this.raster})}};q.__decorate([z.property({json:{write:{target:"type"}}}),Q.enumeration(f)],D.prototype,"curvatureType",void 0);q.__decorate([K.reader("curvatureType",
["type","curvatureType"])],D.prototype,"readCurvatureType",null);q.__decorate([z.property({type:Number,json:{write:!0}})],D.prototype,"zFactor",void 0);return D=r=q.__decorate([J.subclass("esri.layers.support.rasterFunctions.CurvatureFunctionArguments")],D)})},"esri/layers/support/rasterFunctions/ExtractBandFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./bandIndexUtils ./BaseRasterFunction ./ExtractBandFunctionArguments ./pixelUtils".split(" "),
function(q,D,z,O,A,U,Q,K,J,B){z=class extends K{constructor(){super(...arguments);this.functionName="ExtractBand";this.functionArguments=null;this.rasterArgumentNames=["raster"]}_bindSourceRasters(){const {functionArguments:r,sourceRasterInfos:f}=this;var d=f[0];const {method:u,bandNames:F,bandWavelengths:p,bandIds:l,missingBandAction:w}=r,E=F?.length&&("name"===u||"id"!==u&&!l?.length),a=p?.length&&("wavelength"===u||"id"!==u&&!l?.length);var e=w===B.MissingBandAction.fail;e=E?this._matchBandNames(d,
F):a?this._matchBandWavelengths(d,p,e):this._matchBandIds(d,l,e);if(null==e)return{success:!1,supportsGPU:!1,error:`extract-band-function: Invalid ${E?"band names":a?"band wavelengths":"band ids"} for the imagery data source`};this.functionArguments.bandIds=e;this.functionArguments.method="id";this.outputPixelType=this._getOutputPixelType("f32");d=d.clone();d.pixelType=this.outputPixelType;d.bandCount=e.length;const {statistics:c,histograms:b}=d;null!=c&&c.length&&(d.statistics=e.map(m=>c[m]||c[c.length-
1]));null!=b&&b.length&&(d.histograms=e.map(m=>b[m]||b[b.length-1]));let g=d.keyProperties?.BandProperties;g?.length&&(g=e.map(m=>m>=g.length?g[g.length-1]:g[m]),d.keyProperties={...d.keyProperties,BandProperties:g});this.rasterInfo=d;return{success:!0,supportsGPU:3>=d.bandCount}}_processPixels(r){r=r.pixelBlocks?.[0];if(null==r)return null;const f=r.pixels.length,d=this.functionArguments.bandIds.map(u=>u>=f?f-1:u);return r.extractBands(d)}_getWebGLParameters(){let r;if(this.isInputBandIdsSwizzled)r=
this.swizzledBandSelection.length?this.swizzledBandSelection:[0,1,2];else{r=[...this.functionArguments.bandIds];0===r.length?r=[0,1,2]:3>r.length&&(r[1]=r[1]??r[0],r[2]=r[2]??r[1]);for(let f=0;3>f;f++)r[f]=Math.min(r[f],2)}return{bandIndexMat3:Q.getBandMatrix3(r)}}_getInputBandIds(r){const f=r.length;return this.functionArguments.bandIds.map(d=>d>=f?f-1:d).map(d=>r[d])}_matchBandNames(r,f){r=r.bandInfos.map(({name:u})=>u.toLowerCase());const d=[];for(let u=0;u<f.length;u++){const F=f[u].toLowerCase();
let p=r.indexOf(F);-1===p&&"nearinfrared"===F&&(p=r.findIndex(l=>l.startsWith("nearinfrared_1")),-1===p&&(p=r.findIndex(l=>l.startsWith("nearinfrared"))));if(-1===p)return null;d.push(p)}return d}_matchBandIds(r,f,d){const {bandCount:u}=r;return!f?.length||d&&f.some(F=>0>F||F>=u)?null:f}_matchBandWavelengths(r,f,d){var {bandInfos:u}=r;r=[];for(var F=0;F<u.length;F++){const {minWavelength:p,maxWavelength:l}=u[F];if(!p||!l)return null;r.push({minWavelength:p,maxWavelength:l})}({wavelengthMatchTolerance:u}=
this.functionArguments);F=[];for(let p=0;p<f.length;p++){const l=f[p];let w=!1,E=-1,a=Number.MAX_VALUE;for(let e=0;e<r.length;e++){const c=r[e],b=Math.abs(l-(c.minWavelength+c.maxWavelength)/2);l>=c.minWavelength&&l<=c.maxWavelength?b<a&&(w=!0,E=e,a=b):!w&&b<a&&(E=e,a=b)}!w&&u&&a<u&&(w=!0);if(!w&&d)return null;F.push(E)}return F}};q.__decorate([D.property({json:{write:!0,name:"rasterFunction"}})],z.prototype,"functionName",void 0);q.__decorate([D.property({type:J,json:{write:!0,name:"rasterFunctionArguments"}})],
z.prototype,"functionArguments",void 0);q.__decorate([D.property()],z.prototype,"rasterArgumentNames",void 0);return z=q.__decorate([U.subclass("esri.layers.support.rasterFunctions.ExtractBandFunction")],z)})},"esri/layers/support/rasterFunctions/ExtractBandFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments ./pixelUtils".split(" "),
function(q,D,z,O,A,U,Q,K,J){var B;z=B=class extends K{constructor(){super(...arguments);this.bandIds=[];this.bandNames=[];this.bandWavelengths=[];this.missingBandAction=J.MissingBandAction.bestMatch}clone(){return new B({bandIds:this.bandIds?.slice(),bandNames:this.bandNames?.slice(),bandWavelengths:this.bandWavelengths?.slice(),missingBandAction:this.missingBandAction,method:this.method,wavelengthMatchTolerance:this.wavelengthMatchTolerance})}};q.__decorate([D.property({json:{write:!0}})],z.prototype,
"bandIds",void 0);q.__decorate([D.property({json:{write:!0}})],z.prototype,"bandNames",void 0);q.__decorate([D.property({json:{write:!0}})],z.prototype,"bandWavelengths",void 0);q.__decorate([U.enumeration({0:"name",1:"wavelength",2:"id"})],z.prototype,"method",void 0);q.__decorate([D.property({json:{write:!0}})],z.prototype,"missingBandAction",void 0);q.__decorate([D.property({json:{write:!0}})],z.prototype,"wavelengthMatchTolerance",void 0);return z=B=q.__decorate([Q.subclass("esri.layers.support.rasterFunctions.ExtractBandFunctionArguments")],
z)})},"esri/layers/support/rasterFunctions/LocalFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../rasterFunctionConstants ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./LocalFunctionArguments ./localUtils".split(" "),function(q,D,z,O,A,U,Q,K,J,B,r){z=class extends J{constructor(){super(...arguments);
this.functionName="Local";this.functionArguments=null;this.rasterArgumentNames=["rasters"]}_bindSourceRasters(){var {sourceRasterInfos:f}=this,d=f[0];const {bandCount:u}=d;var {processAsMultiband:F}=this.functionArguments;if(f.some(w=>w.bandCount!==u))return{success:!1,supportsGPU:!1,error:"local-function: input rasters do not have same band count"};const {operation:p,rasters:l}=this.functionArguments;f=r.operandsCount[p];if(!(999===f||l.length===f||1>=l.length&&1===f))return{success:!1,supportsGPU:!1,
error:`local-function: the length of functionArguments.rasters does not match operation's requirement: ${f}`};this.outputPixelType=this._getOutputPixelType("f32");d=d.clone();d.pixelType=this.outputPixelType;d.statistics=null;d.histograms=null;d.colormap=null;d.attributeTable=null;d.bandCount=999!==f||F?u:1;if(F=r.getOutputDomain(p)){d.statistics=[];for(let w=0;w<d.bandCount;w++)d.statistics[w]={min:F[0],max:F[1],avg:(F[0]+F[1])/2,stddev:(F[0]+F[1])/10}}this.rasterInfo=d;return{success:!0,supportsGPU:1===
d.bandCount&&3>=f&&(11>p||16<p)}}_processPixels(f){({pixelBlocks:f}=f);return null==f||f.some(d=>null==d)?null:r.local(f,this.functionArguments.operation,{processAsMultiband:this.functionArguments.processAsMultiband,outputPixelType:this.outputPixelType??void 0})}_getWebGLParameters(){const {operation:f}=this.functionArguments,d=r.operandsCount[f],u=Object.keys(Q.localOperators).find(w=>Q.localOperators[w]===f)?.toLowerCase()??"undefined";var F=this.outputPixelType??"f32";let [p,l]=K.getPixelValueRange(F);
if(F=F.startsWith("u")||F.startsWith("s"))p-=1E-4,l+=1E-4;return{imageCount:d,operationName:u,domainRange:[p,l],isOutputRounded:F}}};q.__decorate([D.property({json:{write:!0,name:"rasterFunction"}})],z.prototype,"functionName",void 0);q.__decorate([D.property({type:B,json:{write:!0,name:"rasterFunctionArguments"}})],z.prototype,"functionArguments",void 0);q.__decorate([D.property()],z.prototype,"rasterArgumentNames",void 0);return z=q.__decorate([U.subclass("esri.layers.support.rasterFunctions.LocalFunction")],
z)})},"esri/layers/support/rasterFunctions/LocalFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseFunctionArguments".split(" "),function(q,D,z,O,A,U,Q){var K;O=K=class extends Q{constructor(){super(...arguments);this.rasters=[];this.processAsMultiband=!0}writeRasters(J,B){B.rasters=
J.map(r=>"number"===typeof r||"string"===typeof r?r:r.toJSON())}clone(){return new K({operation:this.operation,processAsMultiband:this.processAsMultiband,rasters:D.clone(this.rasters)})}};q.__decorate([z.property({json:{write:!0}})],O.prototype,"operation",void 0);q.__decorate([z.property({json:{write:!0}})],O.prototype,"rasters",void 0);q.__decorate([U.writer("rasters")],O.prototype,"writeRasters",null);q.__decorate([z.property({json:{write:!0}})],O.prototype,"processAsMultiband",void 0);return O=
K=q.__decorate([A.subclass("esri.layers.support.rasterFunctions.LocalFunctionArguments")],O)})},"esri/layers/support/rasterFunctions/localUtils":function(){define(["exports","../PixelBlock","../rasterFunctionConstants","../rasterFormats/pixelRangeUtils"],function(q,D,z,O){function A(W,ia=!1){var ba=W.map(ca=>ca.mask);const ja=ba.filter(ca=>null!=ca);var la=W[0].pixels[0].length;if(0===ja.length)return(new Uint8Array(la)).fill(255);W=new Uint8Array(ja[0]);if(1===ja.length)return W;if(!ia){for(ia=1;ia<
ja.length;ia++)for(ba=ja[ia],la=0;la<W.length;la++)W[la]&&(W[la]=ba[la]?255:0);return W}if(ja.length!==ba.length)return(new Uint8Array(la)).fill(255);for(ia=1;ia<ja.length;ia++)for(ba=ja[ia],la=0;la<W.length;la++)0===W[la]&&(W[la]=ba[la]?255:0);return W}function U(W,ia,ba){const [ja,la]=W;W=ja.length;ba=D.createEmptyBand(ba,W);for(let ca=0;ca<W;ca++)if(!ia||ia[ca])ba[ca]=ja[ca]+la[ca];return ba}function Q(W,ia,ba){[W]=W;ia=D.createEmptyBand("f32",W.length);ia.set(W);return ia}function K(W,ia,ba){const [ja,
la]=W;W=ja.length;ba=D.createEmptyBand(ba,W);for(let ca=0;ca<W;ca++)if(!ia||ia[ca])ba[ca]=ja[ca]-la[ca];return ba}function J(W,ia,ba){const [ja,la]=W;W=ja.length;ba=D.createEmptyBand(ba,W);for(let ca=0;ca<W;ca++)if(!ia||ia[ca])ba[ca]=ja[ca]*la[ca];return ba}function B(W,ia,ba){[W]=W;const ja=W.length;ba=D.createEmptyBand(ba,ja);for(let la=0;la<ja;la++)if(!ia||ia[la])ba[la]=Math.sign(W[la])*Math.floor(Math.abs(W[la]));return ba}function r(W,ia,ba){const [ja,la]=W;W=ja.length;ba=D.createEmptyBand(ba,
W);for(let ca=0;ca<W;ca++)if(!ia||ia[ca])ba[ca]=ja[ca]/la[ca];return ba}function f(W,ia,ba){return r(W,ia,"f32")}function d(W,ia,ba){const [ja,la]=W;W=ja.length;ba=D.createEmptyBand(ba,W);for(let ca=0;ca<W;ca++)if(!ia||ia[ca])ba[ca]=Math.floor(ja[ca]/la[ca]);return ba}function u(W,ia,ba,ja){W=W[0];const la=W.length;ba=D.createEmptyBand(ba,la);if(ja===z.localTrigonometricOperation.atanh){for(ja=0;ja<la;ja++)if(ia[ja]){var ca=W[ja];1<=Math.abs(ca)?ia[ja]=0:ba[ja]=Math.atanh(ca)}return ba}ja=ja===z.localTrigonometricOperation.asin?
Math.asin:Math.acos;for(ca=0;ca<la;ca++)if(ia[ca]){const ta=W[ca];1<Math.abs(ta)?ia[ca]=0:ba[ca]=ja(ta)}return ba}function F(W,ia,ba,ja){[W]=W;const la=W.length;ba=D.createEmptyBand(ba,la);for(let ca=0;ca<la;ca++)if(!ia||ia[ca])ba[ca]=ja(W[ca]);return ba}function p(W,ia,ba,ja){const [la,ca]=W;W=la.length;ba=D.createEmptyBand(ba,W);for(let ta=0;ta<W;ta++)if(!ia||ia[ta])ba[ta]=ja(la[ta],ca[ta]);return ba}function l(W,ia,ba){const [ja,la]=W;W=ja.length;ba=D.createEmptyBand(ba,W);for(let ca=0;ca<W;ca++)if(!ia||
ia[ca])ba[ca]=ja[ca]&la[ca];return ba}function w(W,ia,ba){const [ja,la]=W;W=ja.length;ba=D.createEmptyBand(ba,W);for(let ca=0;ca<W;ca++)if(!ia||ia[ca])ba[ca]=ja[ca]<<la[ca];return ba}function E(W,ia,ba){[W]=W;const ja=W.length;ba=D.createEmptyBand(ba,ja);for(let la=0;la<ja;la++)if(!ia||ia[la])ba[la]=~W[la];return ba}function a(W,ia,ba){const [ja,la]=W;W=ja.length;ba=D.createEmptyBand(ba,W);for(let ca=0;ca<W;ca++)if(!ia||ia[ca])ba[ca]=ja[ca]|la[ca];return ba}function e(W,ia,ba){const [ja,la]=W;W=ja.length;
ba=D.createEmptyBand(ba,W);for(let ca=0;ca<W;ca++)if(!ia||ia[ca])ba[ca]=ja[ca]>>la[ca];return ba}function c(W,ia,ba){const [ja,la]=W;W=ja.length;ba=D.createEmptyBand(ba,W);for(let ca=0;ca<W;ca++)if(!ia||ia[ca])ba[ca]=ja[ca]^la[ca];return ba}function b(W,ia,ba){const [ja,la]=W;W=ja.length;ba=D.createEmptyBand(ba,W);for(let ca=0;ca<W;ca++)if(!ia||ia[ca])ba[ca]=ja[ca]&&la[ca]?1:0;return ba}function g(W,ia,ba){[W]=W;const ja=W.length;ba=D.createEmptyBand(ba,ja);for(let la=0;la<ja;la++)if(!ia||ia[la])ba[la]=
W[la]?0:1;return ba}function m(W,ia,ba){const [ja,la]=W;W=ja.length;ba=D.createEmptyBand(ba,W);for(let ca=0;ca<W;ca++)if(!ia||ia[ca])ba[ca]=ja[ca]||la[ca]?1:0;return ba}function n(W,ia,ba){const [ja,la]=W;W=ja.length;ba=D.createEmptyBand(ba,W);for(let ca=0;ca<W;ca++)if(!ia||ia[ca])ba[ca]=(ja[ca]?1:0)^(la[ca]?1:0);return ba}function t(W,ia,ba){const [ja,la]=W;W=ja.length;ba=D.createEmptyBand(ba,W);for(let ca=0;ca<W;ca++)if(!ia||ia[ca])ba[ca]=ja[ca]===la[ca]?1:0;return ba}function k(W,ia,ba,ja){[W]=
W;const la=W.length;ba=D.createEmptyBand(ba,la);const ca=ja===Math.E;for(let ta=0;ta<la;ta++)if(!ia||ia[ta])ba[ta]=ca?Math.exp(W[ta]):ja**W[ta];return ba}function y(W,ia,ba){return k(W,ia,ba,10)}function I(W,ia,ba){return k(W,ia,ba,2)}function C(W,ia,ba){return k(W,ia,ba,Math.E)}function L(W,ia,ba,ja){[W]=W;const la=W.length;ba=D.createEmptyBand(ba,la);for(let ca=0;ca<la;ca++)if(!ia||ia[ca])0>=W[ca]?ia[ca]=0:ba[ca]=ja(W[ca]);return ba}function H(W,ia,ba){return L(W,ia,ba,Math.log10)}function S(W,
ia,ba){return L(W,ia,ba,Math.log2)}function x(W,ia,ba){return L(W,ia,ba,Math.log)}function h(W,ia,ba){const [ja,la]=W;W=ja.length;ba=D.createEmptyBand(ba,W);for(let ca=0;ca<W;ca++)if(!ia||ia[ca])ba[ca]=ja[ca]>la[ca]?1:0;return ba}function G(W,ia,ba){const [ja,la]=W;W=ja.length;ba=D.createEmptyBand(ba,W);for(let ca=0;ca<W;ca++)if(!ia||ia[ca])ba[ca]=ja[ca]>=la[ca]?1:0;return ba}function M(W,ia,ba){const [ja,la]=W;W=ja.length;ba=D.createEmptyBand(ba,W);for(let ca=0;ca<W;ca++)if(!ia||ia[ca])ba[ca]=ja[ca]<
la[ca]?1:0;return ba}function R(W,ia,ba){const [ja,la]=W;W=ja.length;ba=D.createEmptyBand(ba,W);for(let ca=0;ca<W;ca++)if(!ia||ia[ca])ba[ca]=ja[ca]<=la[ca]?1:0;return ba}function X(W,ia,ba){[W]=W;W=W.length;ba=D.createEmptyBand(ba,W);if(!ia)return ba;for(let ja=0;ja<W;ja++)ba[ja]=ia[ja]?0:1;return ba}function T(W,ia,ba){const [ja,la]=W;W=ja.length;ba=D.createEmptyBand(ba,W);for(let ca=0;ca<W;ca++)if(!ia||ia[ca])ba[ca]=ja[ca]%la[ca];return ba}function Z(W,ia,ba){[W]=W;const ja=W.length;ba=D.createEmptyBand(ba,
ja);for(let la=0;la<ja;la++)if(!ia||ia[la])ba[la]=-W[la];return ba}function ha(W,ia,ba){const [ja,la]=W;W=ja.length;ba=D.createEmptyBand(ba,W);for(let ca=0;ca<W;ca++)if(!ia||ia[ca])ba[ca]=ja[ca]===la[ca]?0:1;return ba}function v(W,ia,ba){const [ja,la]=W;W=ja.length;ba=D.createEmptyBand(ba,W);const ca=new Uint8Array(W);for(let ta=0;ta<W;ta++)null!=ia&&!ia[ta]||0!==ja[ta]||(ba[ta]=la[ta],ca[ta]=255);return{band:ba,mask:ca}}function N(W,ia,ba){const [ja,la,ca]=W;W=ja.length;ba=D.createEmptyBand(ba,W);
for(let ta=0;ta<W;ta++)if(!ia||ia[ta])ba[ta]=ja[ta]?la[ta]:ca[ta];return ba}function P(W,ia,ba){const ja=W.length;if(2>ja)return W[0];const [la]=W,ca=la.length;ba=D.createEmptyBand(ba,ca);for(let ta=0;ta<ca;ta++)if(!ia||ia[ta]){let va=la[ta];for(let xa=1;xa<ja;xa++){const ya=W[xa][ta];va<ya&&(va=ya)}ba[ta]=va}return ba}function V(W,ia,ba){const ja=W.length;if(2>ja)return W[0];const [la]=W,ca=la.length;ba=D.createEmptyBand(ba,ca);for(let ta=0;ta<ca;ta++)if(!ia||ia[ta]){let va=la[ta];for(let xa=1;xa<
ja;xa++){const ya=W[xa][ta];va>ya&&(va=ya)}ba[ta]=va}return ba}function Y(W,ia,ba){const ja=W.length;if(2>ja)return W[0];const [la]=W,ca=la.length;ba=D.createEmptyBand(ba,ca);for(let ta=0;ta<ca;ta++)if(!ia||ia[ta]){let va=la[ta],xa=va;for(let ya=1;ya<ja;ya++){const Aa=W[ya][ta];xa<Aa?xa=Aa:va>Aa&&(va=Aa)}ba[ta]=xa-va}return ba}function aa(W,ia,ba){const ja=W.length;if(2>ja)return W[0];var [la]=W;la=la.length;ba=D.createEmptyBand(ba,la);for(let ca=0;ca<la;ca++)if(!ia||ia[ca]){let ta=0;for(let va=0;va<
ja;va++)ta+=W[va][ca];ba[ca]=ta/ja}return ba}function fa(W,ia,ba){const ja=W.length;if(2>ja)return W[0];var [la]=W;la=la.length;ba=D.createEmptyBand(ba,la);for(let ca=0;ca<la;ca++)if(!ia||ia[ca])for(let ta=0;ta<ja;ta++)ba[ca]+=W[ta][ca];return ba}function ea(W,ia,ba){const ja=W.length;if(2>ja)return W[0];var [la]=W;la=la.length;ba=D.createEmptyBand(ba,la);for(let va=0;va<la;va++)if(!ia||ia[va]){const xa=new Float32Array(ja);let ya=0;for(var ca=0;ca<ja;ca++){var ta=W[ca];ya+=ta[va];xa[ca]=ta[va]}ya/=
ja;ca=0;for(ta=0;ta<ja;ta++)ca+=(xa[ta]-ya)**2;ba[va]=Math.sqrt(ca/ja)}return ba}function da(W,ia,ba){const ja=W.length;if(2>ja)return W[0];const la=Math.floor(ja/2);var [ca]=W;ca=ca.length;ba=D.createEmptyBand(ba,ca);const ta=new Float32Array(ja),va=1===ja%2;for(let xa=0;xa<ca;xa++)if(!ia||ia[xa]){for(let ya=0;ya<ja;ya++)ta[ya]=W[ya][xa];ta.sort();ba[xa]=va?ta[la]:(ta[la]+ta[la-1])/2}return ba}function ka(W,ia,ba){const [ja,la]=W;if(null==la)return ja;W=ja.length;ba=D.createEmptyBand(ba,W);for(let ca=
0;ca<W;ca++)ia[ca]&&(ja[ca]===la[ca]?ba[ca]=ja[ca]:ia[ca]=0);return ba}function na(W,ia,ba){const ja=W.length;if(2>=ja)return ka(W,ia,ba);const la=W[0].length;ba=D.createEmptyBand(ba,la);const ca=new Map;for(let va=0;va<la;va++)if(!ia||ia[va]){ca.clear();let xa;for(var ta=0;ta<ja;ta++)xa=W[ta][va],ca.set(xa,ca.has(xa)?ca.get(xa)+1:1);let ya=ta=0;for(const Aa of ca.keys())ta=ca.get(Aa),ta>ya&&(ya=ta,xa=Aa);ba[va]=xa}return ba}function oa(W,ia,ba){const ja=W.length;if(2>=ja)return ka(W,ia,ba);const la=
W[0].length;ba=D.createEmptyBand(ba,la);const ca=new Map;for(let va=0;va<la;va++)if(!ia||ia[va]){ca.clear();let xa;for(var ta=0;ta<ja;ta++)xa=W[ta][va],ca.set(xa,ca.has(xa)?ca.get(xa)+1:1);ta=0;let ya=W.length;for(const Aa of ca.keys())ta=ca.get(Aa),ta<ya&&(ya=ta,xa=Aa);ba[va]=xa}return ba}function pa(W,ia,ba){const ja=W.length;if(2>ja)return W[0];var [la]=W;la=la.length;ba=D.createEmptyBand(ba,la);const ca=new Set;for(let ta=0;ta<la;ta++)if(!ia||ia[ta]){ca.clear();let va;for(let xa=0;xa<ja;xa++)va=
W[xa][ta],ca.add(va);ba[ta]=ca.size}return ba}function qa(W,ia,ba,ja){let [la,ca]=O.getPixelValueRange(ba);if(ba=ba.startsWith("u")||ba.startsWith("s"))la-=1E-5,ca+=1E-5;for(let ta=0;ta<ia.length;ta++)if(ia[ta]){const va=W[ta];isNaN(va)||va<la||va>ca?ia[ta]=0:ja[ta]=ba?Math.round(va):va}}const sa=new Map;sa.set(z.localTrigonometricOperation.acos,[0,Math.PI]);sa.set(z.localTrigonometricOperation.asin,[-Math.PI/2,Math.PI/2]);sa.set(z.localTrigonometricOperation.atan,[-Math.PI/2,Math.PI/2]);sa.set(z.localTrigonometricOperation.cos,
[-1,1]);sa.set(z.localTrigonometricOperation.sin,[-1,1]);sa.set(z.localLogicalOperation.booleanAnd,[0,1]);sa.set(z.localLogicalOperation.booleanNot,[0,1]);sa.set(z.localLogicalOperation.booleanOr,[0,1]);sa.set(z.localLogicalOperation.booleanXOr,[0,1]);sa.set(z.localLogicalOperation.equalTo,[0,1]);sa.set(z.localLogicalOperation.notEqual,[0,1]);sa.set(z.localLogicalOperation.greaterThan,[0,1]);sa.set(z.localLogicalOperation.greaterThanEqual,[0,1]);sa.set(z.localLogicalOperation.lessThan,[0,1]);sa.set(z.localLogicalOperation.lessThanEqual,
[0,1]);sa.set(z.localLogicalOperation.isNull,[0,1]);const ra=new Map,ua=new Map,ma=new Map,wa=new Map;q.getOutputDomain=function(W){return sa.get(W)};q.local=function(W,ia,ba={}){ra.size||(ra.set(4,Math.sqrt),ra.set(6,Math.acos),ra.set(7,Math.asin),ra.set(8,Math.atan),ra.set(9,Math.atanh),ra.set(10,Math.abs),ra.set(21,Math.cos),ra.set(22,Math.cosh),ra.set(48,Math.floor),ra.set(49,Math.ceil),ra.set(51,Math.sin),ra.set(52,Math.sinh),ra.set(56,Math.tan),ra.set(57,Math.tanh),ra.set(59,Math.acosh),ra.set(60,
Math.asinh),ra.set(65,Math.floor),ua.set(5,Math.pow),ua.set(61,Math.atan2),ma.set(1,U),ma.set(2,K),ma.set(3,J),ma.set(11,l),ma.set(12,w),ma.set(13,E),ma.set(14,a),ma.set(15,e),ma.set(16,c),ma.set(17,b),ma.set(18,g),ma.set(19,m),ma.set(20,n),ma.set(23,r),ma.set(24,t),ma.set(25,C),ma.set(26,y),ma.set(27,I),ma.set(28,h),ma.set(29,G),ma.set(30,B),ma.set(31,X),ma.set(32,Q),ma.set(33,M),ma.set(34,R),ma.set(35,x),ma.set(36,H),ma.set(37,S),ma.set(44,T),ma.set(45,Z),ma.set(46,ha),ma.set(64,f),ma.set(65,d),
ma.set(76,N),ma.set(78,N),wa.set(38,na),wa.set(39,P),wa.set(40,aa),wa.set(41,da),wa.set(42,V),wa.set(43,oa),wa.set(47,Y),wa.set(54,ea),wa.set(55,fa),wa.set(58,pa),wa.set(66,na),wa.set(67,P),wa.set(68,aa),wa.set(69,da),wa.set(70,V),wa.set(71,oa),wa.set(72,Y),wa.set(73,ea),wa.set(74,fa),wa.set(75,pa));var ja=A(W,66<=ia&&75>=ia);const {outputPixelType:la="f32"}=ba,ca=!wa.has(ia)||ba.processAsMultiband,ta=ca?W[0].pixels.length:1;ba=[];for(let ya=0;ya<ta;ya++){var va=wa.has(ia)&&!ca?W.flatMap(Aa=>Aa.pixels):
W.map(Aa=>Aa.pixels[ya]),xa=!0;ia===z.localConditionalOperation.setNull?(ja=v(va,ja,la),va=ja.band,ja=ja.mask,xa=!1):ma.has(ia)?va=ma.get(ia)(va,ja,"f64"):ra.has(ia)?va=ia===z.localTrigonometricOperation.asin||ia===z.localTrigonometricOperation.acos||ia===z.localTrigonometricOperation.atanh?u(va,ja,"f64",ia):F(va,ja,"f64",ra.get(ia)):ua.has(ia)?va=p(va,ja,"f64",ua.get(ia)):wa.has(ia)?va=wa.get(ia)(va,ja,"f64"):(va=va[0],xa=!1);xa&&ia!==z.localLogicalOperation.isNull&&!sa.has(ia)&&(xa=D.createEmptyBand(la,
va.length),ja||(ja=(new Uint8Array(va.length)).fill(255)),qa(va,ja,la,xa),va=xa);ba.push(va)}W=W[0];return new D({width:W.width,height:W.height,pixelType:la,mask:ia===z.localLogicalOperation.isNull?null:ja,pixels:ba})};q.operandsCount=[0,2,2,2,1,2,1,1,1,1,1,2,2,1,2,2,2,2,1,2,2,1,1,2,2,1,1,1,2,2,1,1,1,2,2,1,1,1,999,999,999,999,999,999,2,1,2,999,1,1,2,1,1,1,999,999,1,1,999,1,1,2,999,999,2,2,999,999,999,999,999,999,999,999,999,999,3,999,3];Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},
"esri/layers/support/rasterFunctions/MaskFunction":function(){define("../../../chunks/tslib.es6 ../../../core/mathUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./MaskFunctionArguments ./pixelUtils".split(" "),function(q,D,z,O,A,U,Q,K,J,B){O=class extends K{constructor(){super(...arguments);this.functionName="Mask";this.functionArguments=
null;this.rasterArgumentNames=["raster"]}_bindSourceRasters(){var r=this.sourceRasterInfos[0].clone();const {pixelType:f}=r;this.outputPixelType=this._getOutputPixelType(f);r.pixelType=this.outputPixelType;this.rasterInfo=r;const {includedRanges:d,normalizedNoDataValues:u}=this.functionArguments;if(!d?.length&&!u?.length)return{success:!1,supportsGPU:!1,error:"missing includedRanges or noDataValues argument"};let F=[];for(let p=0;p<r.bandCount;p++){const l=B.createMaskLUT(f,d?.slice(2*p,2*p+2),u?.[p]);
if(null==l){F=null;break}F.push(l)}this.lookups=F;r=null!=u&&u.every(p=>p?.length===u[0]?.length);return{success:!0,supportsGPU:(!d||d.length<=2*B.maxMapSizeGpu)&&(!u||r&&u[0].length<=B.maxMapSizeGpu)}}_processPixels(r){r=r.pixelBlocks?.[0];if(null==r)return null;const {outputPixelType:f,lookups:d}=this,{includedRanges:u,noDataInterpretation:F,normalizedNoDataValues:p}=this.functionArguments;return B.mask(r,{includedRanges:u,noDataValues:p,outputPixelType:f,matchAll:F===B.NoDataInterpretation.matchAll,
lookups:d})}_getWebGLParameters(){const {includedRanges:r,normalizedNoDataValues:f}=this.functionArguments,d=new Float32Array(B.maxMapSizeGpu);d.fill(D.numberMaxFloat32);f?.[0]?.length&&d.set(f[0]);const u=new Float32Array(B.maxMapSizeGpu);for(let F=0;F<u.length;F+=2)u[F]=r?.[F]??-D.numberMaxFloat32,u[F+1]=r?.[F+1]??D.numberMaxFloat32;r&&r.length&&u.set(r);return{bandCount:this.sourceRasterInfos[0].bandCount,noDataValues:d,includedRanges:u}}};q.__decorate([z.property({json:{write:!0,name:"rasterFunction"}})],
O.prototype,"functionName",void 0);q.__decorate([z.property({type:J,json:{write:!0,name:"rasterFunctionArguments"}})],O.prototype,"functionArguments",void 0);q.__decorate([z.property()],O.prototype,"rasterArgumentNames",void 0);q.__decorate([z.property({json:{write:!0}})],O.prototype,"lookups",void 0);return O=q.__decorate([Q.subclass("esri.layers.support.rasterFunctions.MaskFunction")],O)})},"esri/layers/support/rasterFunctions/MaskFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments ./pixelUtils".split(" "),
function(q,D,z,O,A,U,Q,K){var J;z=J=class extends Q{constructor(){super(...arguments);this.noDataValues=this.includedRanges=null;this.noDataInterpretation=K.NoDataInterpretation.matchAny}get normalizedNoDataValues(){var {noDataValues:B}=this;if(!B?.length)return null;let r=!1;B=B.map(f=>"number"===typeof f?(r=!0,[f]):"string"===typeof f?(f=f.trim().split(" ").filter(d=>""!==d.trim()).map(d=>Number(d)),r=r||0<f.length,0===f.length?null:f):null);return r?B:null}clone(){return new J({includedRanges:this.includedRanges?.slice()??
[],noDataValues:this.noDataValues?.slice()??[],noDataInterpretation:this.noDataInterpretation})}};q.__decorate([D.property({json:{write:!0}})],z.prototype,"includedRanges",void 0);q.__decorate([D.property({json:{write:!0}})],z.prototype,"noDataValues",void 0);q.__decorate([D.property()],z.prototype,"normalizedNoDataValues",null);q.__decorate([D.property({json:{write:!0}})],z.prototype,"noDataInterpretation",void 0);return z=J=q.__decorate([U.subclass("esri.layers.support.rasterFunctions.MaskFunctionArguments")],
z)})},"esri/layers/support/rasterFunctions/NDVIFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./bandIndexUtils ./BaseRasterFunction ./NDVIFunctionArguments".split(" "),function(q,D,z,O,A,U,Q,K,J){z=class extends K{constructor(){super(...arguments);this.functionName="NDVI";this.functionArguments=null;this.rasterArgumentNames=
["raster"]}_bindSourceRasters(){const {scientificOutput:B,visibleBandID:r,infraredBandID:f}=this.functionArguments;this.outputPixelType=this._getOutputPixelType(B?"f32":"u8");var d=this.sourceRasterInfos[0];const u=Math.max(r,f);if(2>d.bandCount||u>=d.bandCount)return{success:!1,supportsGPU:!1,error:"ndvi-function: source raster has insufficient amount of raster bands"};d=d.clone();d.pixelType=this.outputPixelType;d.colormap=null;d.histograms=null;d.bandCount=1;d.keyProperties={...d.keyProperties,
BandProperties:void 0};const [F,p,l,w]=B?[-1,1,0,.1]:[0,200,100,10];d.statistics=[{min:F,max:p,avg:l,stddev:w}];this.rasterInfo=d;return{success:!0,supportsGPU:!0}}_processPixels(B){B=B.pixelBlocks?.[0];if(null==B)return null;const {visibleBandID:r,infraredBandID:f,scientificOutput:d}=this.functionArguments;return Q.calculateNDVI(B,r,f,!d)}_getWebGLParameters(){const {visibleBandID:B,infraredBandID:r,scientificOutput:f}=this.functionArguments;return{bandIndexMat3:Q.getBandMatrix3(this.isInputBandIdsSwizzled?
[0,1,2]:[r,B,0]),scaled:!f}}_getInputBandIds(B){const {visibleBandID:r,infraredBandID:f}=this.functionArguments;return[f,r,0].map(d=>B[d])}};q.__decorate([D.property({json:{write:!0,name:"rasterFunction"}})],z.prototype,"functionName",void 0);q.__decorate([D.property({type:J,json:{write:!0,name:"rasterFunctionArguments"}})],z.prototype,"functionArguments",void 0);q.__decorate([D.property()],z.prototype,"rasterArgumentNames",void 0);return z=q.__decorate([U.subclass("esri.layers.support.rasterFunctions.NDVIFunction")],
z)})},"esri/layers/support/rasterFunctions/NDVIFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),function(q,D,z,O,A,U,Q){var K;z=K=class extends Q{constructor(){super(...arguments);this.visibleBandID=0;this.infraredBandID=1;this.scientificOutput=!1}clone(){const {visibleBandID:J,
infraredBandID:B,scientificOutput:r}=this;return new K({visibleBandID:J,infraredBandID:B,scientificOutput:r})}};q.__decorate([D.property({json:{write:!0}})],z.prototype,"visibleBandID",void 0);q.__decorate([D.property({json:{write:!0}})],z.prototype,"infraredBandID",void 0);q.__decorate([D.property({json:{write:!0}})],z.prototype,"scientificOutput",void 0);return z=K=q.__decorate([U.subclass("esri.layers.support.rasterFunctions.NDVIFunctionArguments")],z)})},"esri/layers/support/rasterFunctions/RemapFunction":function(){define("../../../chunks/tslib.es6 ../../../core/mathUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./pixelUtils ./RemapFunctionArguments".split(" "),
function(q,D,z,O,A,U,Q,K,J,B,r){O=class extends J{constructor(){super(...arguments);this.functionName="Remap";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.lookup=null}_bindSourceRasters(){const f=this.sourceRasterInfos[0].clone(),{pixelType:d}=f;this.outputPixelType=this._getOutputPixelType(d);f.pixelType=this.outputPixelType;f.colormap=null;f.histograms=null;f.bandCount=1;f.attributeTable=null;const {statistics:u}=f,{allowUnmatched:F,outputValues:p,inputRanges:l,noDataRanges:w,
isLastInputRangeInclusive:E}=this.functionArguments;if(null!=u&&u.length&&p?.length)if(F){var a=Math.min.apply(null,[...p,u[0].min]),e=Math.max.apply(null,[...p,u[0].max]);f.statistics=[{...u[0],min:a,max:e}]}else{e=a=p[0];for(let c=0;c<p.length;c++)a=a>p[c]?p[c]:a,e=e>p[c]?e:p[c];f.statistics=[{...u[0],min:a,max:e}]}this.rasterInfo=f;this.lookup=F?null:B.createRemapLUT({srcPixelType:d,inputRanges:l,outputValues:p,noDataRanges:w,allowUnmatched:F,isLastInputRangeInclusive:E,outputPixelType:this.outputPixelType});
return{success:!0,supportsGPU:(!p||p.length<=B.maxMapSizeGpu)&&(!w||w.length<=B.maxMapSizeGpu)}}_processPixels(f){f=f.pixelBlocks?.[0];if(null==f)return null;const {lookup:d,outputPixelType:u}=this;if(d){const a=B.lookupPixels(f,{lut:[d.lut],offset:d.offset,outputPixelType:u});null!=a&&d.mask&&(a.mask=B.lookupBandValues(f.pixels[0],f.mask,d.mask,d.offset,"u8"));return a}const {inputRanges:F,outputValues:p,noDataRanges:l,allowUnmatched:w,isLastInputRangeInclusive:E}=this.functionArguments;return B.remap(f,
{inputRanges:F,outputValues:p,noDataRanges:l,outputPixelType:u,allowUnmatched:w,isLastInputRangeInclusive:E})}_getWebGLParameters(){const {allowUnmatched:f,noDataRanges:d,isLastInputRangeInclusive:u}=this.functionArguments,F=new Float32Array(3*B.maxMapSizeGpu);var p=this.functionArguments.inputRanges??[],l=this.functionArguments.outputValues??[];const w=l.length;for(let E=0;E<B.maxMapSizeGpu;E++)if(F[3*E]=p[2*E]??D.numberMaxFloat32-1,F[3*E+1]=p[2*E+1]??D.numberMaxFloat32,F[3*E+2]=l[E]??0,E<w&&(0<
E&&(F[3*E]-=1E-5),E<w-1||!u))F[3*E+1]-=1E-5;p=new Float32Array(2*B.maxMapSizeGpu);p.fill(D.numberMaxFloat32);d?.length&&p.set(d);l=K.getPixelValueRange(this.outputPixelType);return{allowUnmatched:f,rangeMaps:F,noDataRanges:p,clampRange:l}}};q.__decorate([z.property({json:{write:!0,name:"rasterFunction"}})],O.prototype,"functionName",void 0);q.__decorate([z.property({type:r,json:{write:!0,name:"rasterFunctionArguments"}})],O.prototype,"functionArguments",void 0);q.__decorate([z.property()],O.prototype,
"rasterArgumentNames",void 0);q.__decorate([z.property({json:{write:!0}})],O.prototype,"lookup",void 0);return O=q.__decorate([Q.subclass("esri.layers.support.rasterFunctions.RemapFunction")],O)})},"esri/layers/support/rasterFunctions/RemapFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(q,D,z,O,A,U,Q){var K;z=K=class extends Q{constructor(){super(...arguments);this.noDataRanges=this.outputValues=this.inputRanges=null;this.isLastInputRangeInclusive=this.allowUnmatched=!1}clone(){return new K({inputRanges:[...this.inputRanges],outputValues:[...this.outputValues],noDataRanges:[...this.noDataRanges],allowUnmatched:this.allowUnmatched,isLastInputRangeInclusive:this.isLastInputRangeInclusive})}};q.__decorate([D.property({json:{write:!0}})],z.prototype,"inputRanges",void 0);q.__decorate([D.property({json:{write:!0}})],
z.prototype,"outputValues",void 0);q.__decorate([D.property({json:{write:!0}})],z.prototype,"noDataRanges",void 0);q.__decorate([D.property({json:{write:!0}})],z.prototype,"allowUnmatched",void 0);q.__decorate([D.property({json:{write:!0}})],z.prototype,"isLastInputRangeInclusive",void 0);return z=K=q.__decorate([U.subclass("esri.layers.support.rasterFunctions.RemapFunctionArguments")],z)})},"esri/layers/support/rasterFunctions/SlopeFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./SlopeFunctionArguments ./surfaceUtils".split(" "),
function(q,D,z,O,A,U,Q,K,J){z=class extends Q{constructor(){super(...arguments);this.functionName="Slope";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.isGCS=!1}_bindSourceRasters(){this.outputPixelType=this._getOutputPixelType("f32");const B=this.sourceRasterInfos[0].clone();B.pixelType=this.outputPixelType;B.statistics="percent-rise"!==this.functionArguments.slopeType?[{min:0,max:90,avg:1,stddev:1}]:null;B.histograms=null;B.colormap=null;B.attributeTable=null;B.bandCount=
1;this.rasterInfo=B;this.isGCS=B.spatialReference?.isGeographic??!1;return{success:!0,supportsGPU:!0}}_processPixels(B){const r=B.pixelBlocks?.[0];if(null==r)return null;const {zFactor:f,slopeType:d,pixelSizePower:u,pixelSizeFactor:F}=this.functionArguments,{isGCS:p}=this,{extent:l,primaryPixelSizes:w}=B;B=w?.[0];return J.slope(r,{zFactor:f,slopeType:d,pixelSizePower:u,pixelSizeFactor:F,isGCS:p,resolution:null==B?l?{x:l.width/r.width,y:l.height/r.height}:{x:1,y:1}:B})}_getWebGLParameters(){const {zFactor:B,
slopeType:r,pixelSizeFactor:f,pixelSizePower:d}=this.functionArguments;return{zFactor:this.isGCS&&1<=B?B*J.gcsFactor:B,slopeType:r,pixelSizeFactor:f??0,pixelSizePower:d??0}}};q.__decorate([D.property({json:{write:!0,name:"rasterFunction"}})],z.prototype,"functionName",void 0);q.__decorate([D.property({type:K,json:{write:!0,name:"rasterFunctionArguments"}})],z.prototype,"functionArguments",void 0);q.__decorate([D.property()],z.prototype,"rasterArgumentNames",void 0);q.__decorate([D.property({json:{write:!0}})],
z.prototype,"isGCS",void 0);return z=q.__decorate([U.subclass("esri.layers.support.rasterFunctions.SlopeFunction")],z)})},"esri/layers/support/rasterFunctions/SlopeFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/jsonMap ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(q,D,z,O,A,U,Q,K,J){var B;D=new D.JSONMap({1:"degree",2:"percent-rise",3:"adjusted"},{useNumericKeys:!0});J=B=class extends J{constructor(){super(...arguments);this.slopeType="degree";this.zFactor=1;this.pixelSizePower=.664;this.pixelSizeFactor=.024;this.removeEdgeEffect=!1}clone(){return new B({slopeType:this.slopeType,zFactor:this.zFactor,pixelSizePower:this.pixelSizePower,pixelSizeFactor:this.pixelSizeFactor,removeEdgeEffect:this.removeEdgeEffect,raster:this.raster})}};q.__decorate([Q.enumeration(D)],
J.prototype,"slopeType",void 0);q.__decorate([z.property({type:Number,json:{write:!0}})],J.prototype,"zFactor",void 0);q.__decorate([z.property({type:Number,json:{name:"psPower",write:!0}})],J.prototype,"pixelSizePower",void 0);q.__decorate([z.property({type:Number,json:{name:"psZFactor",write:!0}})],J.prototype,"pixelSizeFactor",void 0);q.__decorate([z.property({type:Boolean,json:{write:!0}})],J.prototype,"removeEdgeEffect",void 0);return J=B=q.__decorate([K.subclass("esri.layers.support.rasterFunctions.SlopeFunctionArguments")],
J)})},"esri/layers/support/rasterFunctions/StatisticsFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./focalStatUtils ./StatisticsFunctionArguments".split(" "),function(q,D,z,O,A,U,Q,K,J,B){const r=new Set("min max mean median majority minority".split(" "));
z=class extends K{constructor(){super(...arguments);this.functionName="Statistics";this.rasterArgumentNames=["raster"]}_bindSourceRasters(){const {type:f}=this.functionArguments.toJSON();if(1>f||7<f)return{success:!1,supportsGPU:!1,error:`statistics-function: the given statistics type is not supported ${f}`};var d=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType(d.pixelType);d=d.clone();d.pixelType=this.outputPixelType;const {statisticsType:u}=this.functionArguments;r.has(u)||
(d.statistics=null,d.histograms=null,d.colormap=null,d.attributeTable=null);this.rasterInfo=d;return{success:!0,supportsGPU:3>=d.bandCount&&5>f}}_processPixels(f){f=f.pixelBlocks?.[0];if(null==f)return f;const {statisticsType:d,rows:u,cols:F,fillNoDataOnly:p}=this.functionArguments;return J.computeFocalStatistics(f,{kernelRows:u,kernelCols:F,fillNoDataOnly:p,outputPixelType:this.outputPixelType,statisticsType:d,mirrorEdges:!0})}_getWebGLParameters(){const {rows:f,cols:d,statisticsType:u,fillNoDataOnly:F}=
this.functionArguments;return{fillNoDataOnly:F,kernelRows:f,kernelCols:d,statisticsType:u,clampRange:Q.getPixelValueRange(this.outputPixelType)}}};q.__decorate([D.property({json:{write:!0,name:"rasterFunction"}})],z.prototype,"functionName",void 0);q.__decorate([D.property({type:B,json:{write:!0,name:"rasterFunctionArguments"}})],z.prototype,"functionArguments",void 0);q.__decorate([D.property()],z.prototype,"rasterArgumentNames",void 0);return z=q.__decorate([U.subclass("esri.layers.support.rasterFunctions.StatisticsFunction")],
z)})},"esri/layers/support/rasterFunctions/focalStatUtils":function(){define(["exports","../../../core/has","../../../core/jsonMap","../PixelBlock","./mirror"],function(q,D,z,O,A){function U(Q,K){const {fillNoDataOnly:J}=K,{band:B,width:r,height:f,mask:d,outBand:u}=Q;if(J&&!d)u.set(B);else{var {kernelRows:F,kernelCols:p}=K;Q=Math.floor(F/2);K=Math.floor(p/2);var l=u.slice(),w=new Uint32Array(r*f);for(var E=Q;E<f-Q;E++){var a=E*r;for(var e=K;e<r-K;e++){if(J&&d&&d[a+e])continue;const c=[];for(let b=
0;b<F;b++)for(let g=0;g<p;g++){const m=a+e+(b-Q)*r+g-K;d&&!d[m]||c.push(B[m])}c.length&&(c.sort((b,g)=>b-g),d?(l[a+e]=c[Math.floor((c.length-1)/2)],w[a+e]=c.length):u[a+e]=c[Math.floor((c.length-1)/2)])}}if(d)for(E=Q;E<f-Q;E++)for(a=E*r,e=K;e<r-K;e++)!w[a+e]||J&&d[a+e]||(u[a+e]=l[a+e],d[a+e]=255)}}D=new z.JSONMap({1:"min",2:"max",3:"mean",4:"stddev",5:"median",6:"majority",7:"minority"},{useNumericKeys:!0});q.computeFocalStatistics=function(Q,K){const {mask:J}=Q,{fillNoDataOnly:B}=K;if(B&&!J)return Q;
const {pixels:r,width:f,height:d,bandMasks:u,pixelType:F}=Q,p=r.length,l=f*d,w=[],{kernelRows:E,kernelCols:a,statisticsType:e,mirrorEdges:c}=K;if(B&&!J)return Q;const b=K.outputPixelType??F,g=[];for(let I=0;I<p;I++){const C=r[I],L=O.createEmptyBand(b,l);B&&L.set(C);const H=(u?.[I]??J)?.slice()??null,S={band:C,width:f,height:d,mask:H,outBand:L};switch(e){case "min":case "max":a:{var m=K;const {fillNoDataOnly:x}=m,{band:h,width:G,height:M,mask:R,outBand:X}=S;if(x&&!R){X.set(h);break a}const {kernelRows:T,
kernelCols:Z,statisticsType:ha}=m,v=Math.floor(T/2),N=Math.floor(Z/2),P="min"===ha,V=X.slice(),Y=new Uint32Array(G*M);for(let aa=v;aa<M-v;aa++){const fa=aa*G;for(let ea=N;ea<G-N;ea++){let da=P?Number.MAX_VALUE:-Number.MAX_VALUE,ka=0;for(let na=0;na<T;na++)for(let oa=0;oa<Z;oa++){const pa=fa+ea+(na-v)*G+oa-N;if(!R||R[pa])da=P?Math.min(da,h[pa]):Math.max(da,h[pa]),ka++}R?(V[fa+ea]=0===ka?0:da,Y[fa+ea]=ka):X[fa+ea]=0===ka?0:da}}if(R)for(let aa=v;aa<M-v;aa++){const fa=aa*G;for(let ea=N;ea<G-N;ea++)!Y[fa+
ea]||x&&R[fa+ea]||(X[fa+ea]=V[fa+ea],R[fa+ea]=255)}}break;case "mean":case "stddev":a:{var n=K;const {fillNoDataOnly:x}=n,{band:h,width:G,height:M,mask:R,outBand:X}=S;if(x&&!R){X.set(h);break a}const {statisticsType:T,kernelRows:Z,kernelCols:ha}=n,v="stddev"===T,N=G*M,P=new Float64Array(N),V=new Float64Array(N),Y=new Uint32Array(N);for(let oa=0;oa<M;oa++){const pa=oa*G;let qa=0,sa=0,ra=0;for(let ua=0;ua<ha;ua++)if(!R||R[pa+ua])qa+=h[pa+ua],v&&(sa+=h[pa+ua]**2),ra++;P[pa]=qa;V[pa]=sa;Y[pa]=ra;for(let ua=
1;ua<=G-ha;ua++){const ma=pa+ua-1,wa=ma+ha;R?(R[ma]&&(ra--,qa-=h[ma],v&&(sa-=h[ma]**2)),R[wa]&&(ra++,qa+=h[wa],v&&(sa+=h[wa]**2))):(qa-=h[ma],qa+=h[wa],v&&(sa-=h[ma]**2,sa+=h[wa]**2));P[pa+ua]=qa;Y[pa+ua]=ra;v&&(V[pa+ua]=sa)}}const aa=new Float64Array(N),fa=new Float64Array(N),ea=new Uint32Array(N),da=Z*G;for(let oa=0;oa<=G-ha;oa++){let pa=0,qa=0,sa=0;for(let ra=0;ra<Z;ra++){const ua=ra*G+oa;pa+=P[ua];sa+=Y[ua];v&&(qa+=V[ua])}aa[oa]=pa;fa[oa]=qa;ea[oa]=sa;for(let ra=1;ra<=M-Z;ra++){const ua=(ra-1)*
G+oa,ma=ua+da;pa-=P[ua];pa+=P[ma];sa-=Y[ua];sa+=Y[ma];v&&(qa-=V[ua],qa+=V[ma]);aa[ra*G+oa]=pa;fa[ra*G+oa]=qa;ea[ra*G+oa]=sa}}const ka=Math.floor(Z/2),na=Math.floor(ha/2);for(let oa=ka;oa<M-ka;oa++){const pa=oa*G;for(let qa=na;qa<G-na;qa++){const sa=(oa-ka)*G+qa-na,ra=ea[sa];if(0===ra||x&&(!R||R[pa+qa]))continue;const ua=aa[sa]/ra;X[pa+qa]=v?Math.sqrt((fa[sa]-aa[sa]*ua)/ra):ua;R&&(R[pa+qa]=255)}}}break;case "median":U(S,K);break;case "majority":case "minority":a:{var t=K;const {fillNoDataOnly:x}=t,
{band:h,width:G,height:M,mask:R,outBand:X}=S;if(x&&!R){X.set(h);break a}const {kernelRows:T,kernelCols:Z}=t,ha=Math.floor(T/2),v=Math.floor(Z/2),N="majority"===t.statisticsType,P=T*Z,V=X.slice(),Y=new Uint32Array(G*M);for(let aa=ha;aa<M-ha;aa++){const fa=aa*G;for(let ea=v;ea<G-v;ea++){if(x&&R&&R[fa+ea])continue;const da=new Map;for(let pa=0;pa<T;pa++)for(let qa=0;qa<Z;qa++){const sa=fa+ea+(pa-ha)*G+qa-v;if(R&&!R[sa])continue;const ra=h[sa];da.set(ra,da.has(ra)?da.get(ra)+1:1)}if(0===da.size)continue;
let ka=0,na=0,oa=N?0:P+1;for(const pa of da.keys())na=da.get(pa),N===na>oa&&(oa=na,ka=pa);R?(V[fa+ea]=ka,Y[fa+ea]=da.size):X[fa+ea]=ka}}if(R)for(let aa=ha;aa<M-ha;aa++){const fa=aa*G;for(let ea=v;ea<G-v;ea++)!Y[fa+ea]||x&&R[fa+ea]||(X[fa+ea]=V[fa+ea],R[fa+ea]=255)}}}c&&!B&&A.mirror(L,f,d,E,a);w.push(L);H&&g.push(H)}let k=g[0]??J;g.length!==p&&(g.length=0);if(1<p&&u?.length){k=new Uint8Array(l);k.set(g[0]);for(let I=1;I<u.length;I++){const C=u[I];for(let L=0;L<C.length;L++)0===C[L]&&(k[L]=0)}}const y=
new O({pixelType:b,width:f,height:d,pixels:w,bandMasks:u&&g.length?g:null,mask:k});y.updateStatistics();return y};q.statisticsTypeMap=D;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/StatisticsFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments ./focalStatUtils".split(" "),
function(q,D,z,O,A,U,Q,K){var J;O=J=class extends Q{constructor(){super(...arguments);this.cols=this.rows=3;this.fillNoDataOnly=!1;this.statisticsType="min"}clone(){return new J({rows:this.rows,cols:this.cols,fillNoDataOnly:this.fillNoDataOnly,statisticsType:this.statisticsType,raster:D.clone(this.raster)})}};q.__decorate([z.property({json:{write:!0,read:{source:["kernelRows","rows"],reader:(B,r)=>Number(B??r?.kernelRows??3)}}})],O.prototype,"rows",void 0);q.__decorate([z.property({json:{write:!0,
read:{source:["kernelCols","cols"],reader:(B,r)=>Number(B??r?.kernelCols??3)}}})],O.prototype,"cols",void 0);q.__decorate([z.property({json:{write:!0}})],O.prototype,"fillNoDataOnly",void 0);q.__decorate([z.property({json:{read:{source:["statisticsType","type"],reader:(B,r)=>K.statisticsTypeMap.fromJSON(r?.statisticsType??r?.type)??"min"},write:{target:"type"}}}),A.enumeration(K.statisticsTypeMap)],O.prototype,"statisticsType",void 0);return O=J=q.__decorate([U.subclass("esri.layers.support.rasterFunctions.StatisticsFunctionArguments")],
O)})},"esri/layers/support/rasterFunctions/StatisticsHistogramFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./StatisticsHistogramFunctionArguments".split(" "),function(q,D,z,O,A,U,Q,K){z=class extends Q{constructor(){super(...arguments);this.functionName="StatisticsHistogram";this.functionArguments=
null;this.rasterArgumentNames=["raster"];this.isNoopProcess=!0}_bindSourceRasters(){var J=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType("u8");J=J.clone();const {statistics:B,histograms:r}=this.functionArguments;r&&(J.histograms=r);B&&(J.statistics=B);this.rasterInfo=J;return{success:!0,supportsGPU:!0}}_processPixels(J){return J.pixelBlocks?.[0]}};q.__decorate([D.property({json:{write:!0,name:"rasterFunction"}})],z.prototype,"functionName",void 0);q.__decorate([D.property({type:K,
json:{write:!0,name:"rasterFunctionArguments"}})],z.prototype,"functionArguments",void 0);q.__decorate([D.property()],z.prototype,"rasterArgumentNames",void 0);q.__decorate([D.property({json:{write:!0}})],z.prototype,"indexedColormap",void 0);q.__decorate([D.property()],z.prototype,"isNoopProcess",void 0);return z=q.__decorate([U.subclass("esri.layers.support.rasterFunctions.StatisticsHistogramFunction")],z)})},"esri/layers/support/rasterFunctions/StatisticsHistogramFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseFunctionArguments".split(" "),
function(q,D,z,O,A,U,Q,K){var J;O=J=class extends K{constructor(){super(...arguments);this.histograms=this.statistics=null}readStatistics(B,r){if(!B?.length)return null;const f=[];B.forEach(d=>{f.push({min:d.min,max:d.max,avg:d.avg??d.mean,stddev:d.stddev??d.standardDeviation})});return f}writeStatistics(B,r,f){if(B?.length){var d=[];B.forEach(u=>{u={...u,mean:u.avg,standardDeviation:u.stddev};delete u.avg;delete u.stddev;d.push(u)});r[f]=d}}clone(){return new J({statistics:D.clone(this.statistics),
histograms:D.clone(this.histograms)})}};q.__decorate([z.property({json:{write:!0}})],O.prototype,"statistics",void 0);q.__decorate([A.reader("statistics")],O.prototype,"readStatistics",null);q.__decorate([Q.writer("statistics")],O.prototype,"writeStatistics",null);q.__decorate([z.property({json:{write:!0}})],O.prototype,"histograms",void 0);return O=J=q.__decorate([U.subclass("esri.layers.support.rasterFunctions.StatisticsHistogramFunctionArguments")],O)})},"esri/layers/support/rasterFunctions/StretchFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./pixelUtils ./StretchFunctionArguments ./stretchUtils".split(" "),
function(q,D,z,O,A,U,Q,K,J,B){z=class extends Q{constructor(){super(...arguments);this.functionName="Stretch";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.cutOffs=this.lookup=null}_bindSourceRasters(){this.cutOffs=this.lookup=null;var r=this.sourceRasterInfos[0];const {pixelType:f}=r;var {functionArguments:d}=this;const {dynamicRangeAdjustment:u,gamma:F,useGamma:p}=d;if(!u&&["u8","u16","s8","s16"].includes(f)){d=B.getStretchCutoff(d.toJSON(),{rasterInfo:r});const l=this._isOutputRoundingNeeded()?
"round":"float";this.lookup=B.createStretchLUT({pixelType:f,...d,gamma:p?F:null,rounding:l});this.cutOffs=d}else u||(this.cutOffs=B.getStretchCutoff(d.toJSON(),{rasterInfo:r}));this.outputPixelType=this._getOutputPixelType(f);r=r.clone();r.pixelType=this.outputPixelType;r.statistics=null;r.histograms=null;r.colormap=null;r.attributeTable=null;"u8"===this.outputPixelType&&(r.keyProperties.DataType="processed");this.rasterInfo=r;return{success:!0,supportsGPU:!u}}_processPixels(r){r=r.pixelBlocks?.[0];
if(null==r)return r;var {lookup:f}=this;if(f)return K.lookupPixels(r,{...f,outputPixelType:this.rasterInfo.pixelType});({functionArguments:f}=this);const d=this.cutOffs||B.getStretchCutoff(f.toJSON(),{rasterInfo:this.sourceRasterInfos[0],pixelBlock:r});return B.stretch(r,{...d,gamma:f.useGamma?f.gamma:null,outputPixelType:this.outputPixelType})}_getWebGLParameters(){const {outputMin:r=0,outputMax:f=255,gamma:d,useGamma:u}=this.functionArguments,F=2<=this.rasterInfo.bandCount?3:1,p=u&&d?.length?B.computeGammaCorrection(F,
d):[1,1,1],{minCutOff:l,maxCutOff:w}=this.cutOffs??{minCutOff:[0,0,0],maxCutOff:[255,255,255]};1===l.length&&(l[1]=l[2]=l[0],w[1]=w[2]=w[0]);const E=new Float32Array(F);var a;for(a=0;a<F;a++)E[a]=(f-r)/(w[a]-l[a]);a=this._isOutputRoundingNeeded();return{bandCount:F,outMin:r,outMax:f,minCutOff:l,maxCutOff:w,factor:E,useGamma:u,gamma:u&&d?d:[1,1,1],gammaCorrection:u&&p?p:[1,1,1],stretchType:this.functionArguments.stretchType,isOutputRounded:a,type:"stretch"}}};q.__decorate([D.property({json:{write:!0,
name:"rasterFunction"}})],z.prototype,"functionName",void 0);q.__decorate([D.property({type:J,json:{write:!0,name:"rasterFunctionArguments"}})],z.prototype,"functionArguments",void 0);q.__decorate([D.property()],z.prototype,"rasterArgumentNames",void 0);q.__decorate([D.property({json:{write:!0}})],z.prototype,"lookup",void 0);q.__decorate([D.property({json:{write:!0}})],z.prototype,"cutOffs",void 0);return z=q.__decorate([U.subclass("esri.layers.support.rasterFunctions.StretchFunction")],z)})},"esri/layers/support/rasterFunctions/StretchFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/jsonMap ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseFunctionArguments".split(" "),
function(q,D,z,O,A,U,Q,K,J){var B;D=new D.JSONMap({0:"none",3:"standard-deviation",4:"histogram-equalization",5:"min-max",6:"percent-clip",9:"sigmoid"},{useNumericKeys:!0});J=B=class extends J{constructor(){super(...arguments);this.dynamicRangeAdjustment=this.computeGamma=!1;this.gamma=[];this.statistics=this.histograms=null;this.stretchType="none";this.useGamma=!1}writeStatistics(r,f,d){r?.length&&(Array.isArray(r[0])||(r=r.map(u=>[u.min,u.max,u.avg,u.stddev])),f[d]=r)}clone(){return new B({stretchType:this.stretchType,
outputMin:this.outputMin,outputMax:this.outputMax,useGamma:this.useGamma,computeGamma:this.computeGamma,statistics:z.clone(this.statistics),gamma:z.clone(this.gamma),sigmoidStrengthLevel:this.sigmoidStrengthLevel,numberOfStandardDeviations:this.numberOfStandardDeviations,minPercent:this.minPercent,maxPercent:this.maxPercent,histograms:z.clone(this.histograms),dynamicRangeAdjustment:this.dynamicRangeAdjustment,raster:this.raster})}};q.__decorate([O.property({type:Boolean,json:{write:!0}})],J.prototype,
"computeGamma",void 0);q.__decorate([O.property({type:Boolean,json:{name:"dra",write:!0}})],J.prototype,"dynamicRangeAdjustment",void 0);q.__decorate([O.property({type:[Number],json:{write:!0}})],J.prototype,"gamma",void 0);q.__decorate([O.property()],J.prototype,"histograms",void 0);q.__decorate([O.property({type:Number,json:{write:!0}})],J.prototype,"maxPercent",void 0);q.__decorate([O.property({type:Number,json:{write:!0}})],J.prototype,"minPercent",void 0);q.__decorate([O.property({type:Number,
json:{write:!0}})],J.prototype,"numberOfStandardDeviations",void 0);q.__decorate([O.property({type:Number,json:{name:"max",write:!0}})],J.prototype,"outputMax",void 0);q.__decorate([O.property({type:Number,json:{name:"min",write:!0}})],J.prototype,"outputMin",void 0);q.__decorate([O.property({type:Number,json:{write:!0}})],J.prototype,"sigmoidStrengthLevel",void 0);q.__decorate([O.property({json:{type:[[Number]],write:!0}})],J.prototype,"statistics",void 0);q.__decorate([K.writer("statistics")],J.prototype,
"writeStatistics",null);q.__decorate([U.enumeration(D)],J.prototype,"stretchType",void 0);q.__decorate([O.property({type:Boolean,json:{write:!0}})],J.prototype,"useGamma",void 0);return J=B=q.__decorate([Q.subclass("esri.layers.support.rasterFunctions.StretchFunctionArguments")],J)})},"esri/layers/support/rasterFunctions/TableFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./TableFunctionArguments".split(" "),
function(q,D,z,O,A,U,Q,K){z=class extends Q{constructor(){super(...arguments);this.functionName="Table";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.isNoopProcess=!0}_bindSourceRasters(){var J=this.sourceRasterInfos[0];if(1<J.bandCount||J.pixelType.startsWith("f"))return{success:!1,supportsGPU:!1,error:"table-function: Source data must be single band and integer pixel type."};const {attributeTableAsRecordSet:B}=this.functionArguments;if(!B)return{success:!1,supportsGPU:!1,
error:"table-function: Missing attributeTableAsRecordSet argument."};this.outputPixelType=this._getOutputPixelType(J.pixelType);J=J.clone();J.pixelType=this.outputPixelType;J.bandCount=1;"thematic"!==J.dataType&&(J.keyProperties=J.keyProperties?{...J.keyProperties,DataType:"thematic"}:{DataType:"thematic"});this.rasterInfo=J;return{success:!0,supportsGPU:!0}}_processPixels(J){return J.pixelBlocks?.[0]}};q.__decorate([D.property({json:{write:!0,name:"rasterFunction"}})],z.prototype,"functionName",
void 0);q.__decorate([D.property({type:K,json:{write:!0,name:"rasterFunctionArguments"}})],z.prototype,"functionArguments",void 0);q.__decorate([D.property()],z.prototype,"rasterArgumentNames",void 0);q.__decorate([D.property()],z.prototype,"isNoopProcess",void 0);return z=q.__decorate([U.subclass("esri.layers.support.rasterFunctions.TableFunction")],z)})},"esri/layers/support/rasterFunctions/TableFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(q,D,z,O,A,U){var Q;O=Q=class extends U{constructor(){super(...arguments);this.attributeTableAsRecordSet=null}clone(){return new Q({attributeTableAsRecordSet:D.clone(this.attributeTableAsRecordSet)})}};q.__decorate([z.property({json:{write:!0}})],O.prototype,"attributeTableAsRecordSet",void 0);return O=Q=q.__decorate([A.subclass("esri.layers.support.rasterFunctions.TableFunctionArguments")],O)})},"esri/layers/support/rasterFunctions/rasterProjectionHelper":function(){define("exports ../../../geometry ../../../core/arrayUtils ../../../core/Error ../../../core/unitUtils ../../../chunks/pe ../../../geometry/projection ../../../geometry/support/spatialReferenceUtils ../../../geometry/Extent ../../../geometry/Point ../../../geometry/Polygon ../../../geometry/SpatialReference".split(" "),
function(q,D,z,O,A,U,Q,K,J,B,r,f){function d(v,N,P){return!Q.canProjectWithoutEngine(v,N,P)}function u(v,N,P){if((v=d(v,N,P))&&!Q.isLoaded())throw new O("rasterprojectionhelper-project","projection engine is not loaded");return v}function F(v,N,P){u(v.spatialReference,N);return P?Q.getTransformation(N,v.spatialReference,v):Q.getTransformation(v.spatialReference,N,v)}function p(v,N,P,V=null){const Y=v.spatialReference;if(Y.equals(N))return v;u(Y,N,V);P=P.center;P=new J({xmin:P.x-v.x/2,xmax:P.x+v.x/
2,ymin:P.y-v.y/2,ymax:P.y+v.y/2,spatialReference:Y});V=Q.project(P,N,V);P=C(N);null==V||null!=P&&V.width>=P?(N=A.getMetersPerUnitForSR(Y)/A.getMetersPerUnitForSR(N),v={x:v.x*N,y:v.y*N}):v={x:V.width,y:V.height};return v}function l(v,N=.01){return A.getMetersPerUnitForSR(v)?N/A.getMetersPerUnitForSR(v):0}function w(v,N,P=null,V=!0){const Y=v.spatialReference;if(Y.equals(N))return v;u(Y,N,P);P=Q.project(v,N,P);if(!V||!P)return P;E([v],[P],Y,N);return P}function E(v,N,P,V){const Y=L(P,!0),aa=L(V,!0);
P=l(P,500);V=l(V,500);if(P&&null!=Y&&null!=aa)for(let fa=0;fa<v.length;fa++){const ea=N[fa];if(!ea)continue;const {x:da}=v[fa],{x:ka}=ea;ka>=aa[1]-V&&Math.abs(da-Y[0])<P?ea.x-=aa[1]-aa[0]:ka<=aa[0]+V&&Math.abs(da-Y[1])<P&&(ea.x+=aa[1]-aa[0])}}function a(v){const {inSR:N,outSR:P,datumTransformation:V,preferPE:Y}=v;if(N.equals(P))return{points:v}=m(v,null),v;if(N.isWebMercator&&P.isWGS84||N.isWGS84&&P.isWebMercator){const {cols:da,rows:ka,xres:na,yres:oa,usePixelCenter:pa,inSR:qa,outSR:sa}=v;let {xmin:ra,
ymax:ua}=v;pa&&(ra+=na/2,ua-=oa/2);v=[];const ma=[];var aa=Math.max(da,ka);for(var fa=0;fa<aa;fa++){var ea=Q.project(new B({x:ra+na*Math.min(da,fa),y:ua-oa*Math.min(ka,fa),spatialReference:qa}),sa);fa<=da&&v.push(ea.x);fa<=ka&&ma.push(ea.y)}aa=[];for(fa=0;fa<da;fa++)for(ea=0;ea<ka;ea++)aa.push([v[fa],ma[ea]]);return aa}return u(N,P,V)&&Y&&(N.isGeographic||null!=b(N))?c(v):e(v)}function e(v){var {points:N}=m(v,null);const {inSR:P,outSR:V,datumTransformation:Y}=v;v=N.map(aa=>new B(aa[0],aa[1],P));N=
Q.project(v,V,Y);Y&&E(v,N,P,V);return N.map(aa=>aa?[aa.x,aa.y]:[NaN,NaN])}function c(v){const {inSR:N,outSR:P,datumTransformation:V}=v;var Y=b(N);const {points:aa,mask:fa}=m(v,Y);N.isGeographic||(v=N.wkid?U.PeFactory.coordsys(N.wkid):U.PeFactory.fromString(N.isGeographic?U.PeDefs.PE_TYPE_GEOGCS:U.PeDefs.PE_TYPE_PROJCS,N.wkt2||N.wkt),U.PeCSTransformations.projToGeog(v,aa.length,aa));if(null!=V&&V.steps.length){var ea;P.isGeographic&&(ea=aa.map(([da])=>179.9955<da?1:-179.9955>da?-1:0));V.steps.forEach(da=>
{const ka=da.wkid?U.PeFactory.geogtran(da.wkid):U.PeFactory.fromString(U.PeDefs.PE_TYPE_GEOGTRAN,da.wkt);U.PeGTTransformations.geogToGeog(ka,aa.length,aa,null,da.isInverse?U.PeDefs.PE_TRANSFORM_2_TO_1:U.PeDefs.PE_TRANSFORM_1_TO_2)});if(ea)for(v=0;v<aa.length;v++){Y=ea[v];const da=aa[v][0],ka=179.9955<da?1:-179.9955>da?-1:0;Y&&ka&&Y!==ka&&(aa[v][0]=0<Y?da+360:da-360)}}P.isGeographic||(ea=b(P,!0),n(aa,null!=ea&&ea.isEnvelope?[ea.bbox[1],ea.bbox[3]]:[-90,90]),ea=P.wkid?U.PeFactory.coordsys(P.wkid):U.PeFactory.fromString(P.isGeographic?
U.PeDefs.PE_TYPE_GEOGCS:U.PeDefs.PE_TYPE_PROJCS,P.wkt2||P.wkt),U.PeCSTransformations.geogToProj(ea,aa.length,aa));ea=aa;if(fa&&aa.length!==fa.length){ea=[];for(let da=0,ka=0;da<fa.length;da++)fa[da]?ea.push(aa[ka++]):ea.push([NaN,NaN])}return ea}function b(v,N=!1){var P=v.wkid||v.wkt2||v.wkt;if(!P||v.isGeographic)return null;P=String(P);if(Z.has(P))return P=Z.get(P),N?P?.gcs:P?.pcs;var V=v.wkid?U.PeFactory.coordsys(v.wkid):U.PeFactory.fromString(v.isGeographic?U.PeDefs.PE_TYPE_GEOGCS:U.PeDefs.PE_TYPE_PROJCS,
v.wkt2||v.wkt);v=l(v,1E-4);v=g(V,v);V=g(V,0,!0);Z.set(P,{pcs:v,gcs:V});return N?V:v}function g(v,N=0,P=!1){var V=U.PePCSInfo.generate(v),Y=P?v.horizonGcsGenerate():v.horizonPcsGenerate();if(!V||!Y?.length)return null;v=!1;var aa=Y.find(na=>1===na.getInclusive()&&1===na.getKind());if(!aa){aa=Y.find(na=>1===na.getInclusive()&&0===na.getKind());if(!aa)return null;v=!0}P=P?0:(2===V.getNorthPoleLocation()?1:0)|(2===V.getSouthPoleLocation()?2:0);V=V.isPannableRectangle();aa=aa.getCoord();if(v)return{isEnvelope:v,
isPannable:V,vertices:aa,coef:null,bbox:[aa[0][0]-N,aa[0][1]-N,aa[1][0]+N,aa[1][1]+N],poleLocation:P};N=0;v=[];let [fa,ea]=aa[0],[da,ka]=aa[0];for(let na=0,oa=aa.length;na<oa;na++){N++;N===oa&&(N=0);const [pa,qa]=aa[na],[sa,ra]=aa[N];if(ra===qa)v.push([pa,sa,qa,ra,2]);else{Y=(sa-pa)/(ra-qa||1E-4);const ua=pa-Y*qa;qa<ra?v.push([Y,ua,qa,ra,0]):v.push([Y,ua,ra,qa,1])}fa=fa<pa?fa:pa;ea=ea<qa?ea:qa;da=da>pa?da:pa;ka=ka>qa?ka:qa}return{isEnvelope:!1,isPannable:V,vertices:aa,coef:v,bbox:[fa,ea,da,ka],poleLocation:P}}
function m(v,N){const P=[],{cols:V,rows:Y,xres:aa,yres:fa,usePixelCenter:ea}=v;let {xmin:da,ymax:ka}=v;ea&&(da+=aa/2,ka-=fa/2);if(null==N){for(v=0;v<V;v++)for(N=0;N<Y;N++)P.push([da+aa*v,ka-fa*N]);return{points:P}}v=new Uint8Array(V*Y);if(N.isEnvelope){const {bbox:[ua,ma,wa,W]}=N;for(let ia=0,ba=0;ia<V;ia++){var na=da+aa*ia,oa=N.isPannable||na>=ua&&na<=wa;for(var pa=0;pa<Y;pa++,ba++){var qa=ka-fa*pa;oa&&qa>=ma&&qa<=W&&(P.push([na,qa]),v[ba]=1)}}return{points:P,mask:v}}na=N.coef;N=[];for(oa=0;oa<Y;oa++){var sa=
ka-fa*oa;pa=[];qa=[];for(var ra=0;ra<na.length;ra++){const [ua,ma,wa,W,ia]=na[ra];sa===wa&&wa===W?(pa.push(ua),pa.push(ma),qa.push(2),qa.push(2)):sa>=wa&&sa<=W&&(pa.push(ua*sa+ma),qa.push(ia))}sa=pa;if(2<pa.length){ra=2===qa[0]?0:qa[0];let ua=pa[0];sa=[];for(let ma=1;ma<qa.length;ma++)if(2!==qa[ma]||ma===qa.length-1)qa[ma]!==ra&&(sa.push(0===ra?Math.min(ua,pa[ma-1]):Math.max(ua,pa[ma-1])),ra=qa[ma],ua=pa[ma]),ma===qa.length-1&&sa.push(0===qa[ma]?Math.min(ua,pa[ma]):Math.max(ua,pa[ma]));sa.sort((ma,
wa)=>ma-wa)}else pa[0]>pa[1]&&(sa=[pa[1],pa[0]]);N.push(sa)}for(let ua=0,ma=0;ua<V;ua++)for(na=da+aa*ua,oa=0;oa<Y;oa++,ma++)if(pa=ka-fa*oa,qa=N[oa],2===qa.length)na>=qa[0]&&na<=qa[1]&&(P.push([na,pa]),v[ma]=1);else if(2<qa.length){sa=!1;for(ra=0;ra<qa.length;ra+=2)if(na>=qa[ra]&&na<=qa[ra+1]){sa=!0;break}sa&&(P.push([na,pa]),v[ma]=1)}return{points:P,mask:v}}function n(v,N){const [P,V]=N;for(N=0;N<v.length;N++){const Y=v[N][1];if(Y<P||Y>V)v[N]=[NaN,NaN]}}function t(v,N){const P=C(v[0].spatialReference);
if(2>v.length||null==P)return v[0];N=N??l(v[0].spatialReference);v=v.filter(ea=>ea.width>N);if(1===v.length)return v[0];let {xmin:V,xmax:Y,ymin:aa,ymax:fa}=v[0];for(let ea=1;ea<v.length;ea++){const da=v[ea];Y=da.xmax+P*ea;aa=Math.min(aa,da.ymin);fa=Math.max(fa,da.ymax)}return new J({xmin:V,xmax:Y,ymin:aa,ymax:fa,spatialReference:v[0].spatialReference})}function k(v,N,P=null,V=!0){var Y=v.spatialReference;if(Y.equals(N))return v;var aa=S(v);const fa=C(Y,!0);var ea=C(N);if(0===aa||null==fa||null==ea)return aa=
I(v,N,P,V),null==fa&&null!=ea&&Math.abs(aa.width-ea)<l(N)&&Q.isLoaded()&&(Y=b(Y),null!=Y&&Y.poleLocation===R.None&&v.width<(Y.bbox[2]-Y.bbox[0])/2)?y(v,N)||aa:aa;ea=v.clone().normalize();if(1===ea.length&&v.xmax<fa&&v.xmax-fa/2>l(Y)){const {xmin:da,xmax:ka}=v;for(let na=0;na<=aa;na++)ea[na]=new J({xmin:0===na?da:-fa/2,xmax:na===aa?ka-fa*na:fa/2,ymin:v.ymin,ymax:v.ymax,spatialReference:Y})}v=ea.map(da=>I(da,N,P,V));return t(v.filter(z.isSome))}function y(v,N){const P=C(N);if(null==P)return null;let {xmin:V,
ymin:Y,xmax:aa,ymax:fa}=v;var ea=v.spatialReference;v=new r({spatialReference:ea,rings:[[[V,Y],[aa,Y],[aa,fa],[V,fa],[V,Y]]]});v=Q.project(v,N);if(2!==v.rings.length||!v.rings[0].length||!v.rings[1].length)return null;({rings:v}=v);ea=l(ea);N=new J({spatialReference:N});for(let da=0;2>da;da++){V=aa=v[da][0][0];Y=fa=v[da][0][1];for(let ka=0;ka<v[da].length;ka++)V=V>v[da][ka][0]?v[da][ka][0]:V,aa=aa<v[da][ka][0]?v[da][ka][0]:aa,Y=Y>v[da][ka][1]?v[da][ka][1]:Y,fa=fa<v[da][ka][1]?v[da][ka][1]:fa;if(0===
da)N.ymin=Y,N.ymax=fa,N.xmin=V,N.xmax=aa;else if(N.ymin=Math.min(N.ymin,Y),N.ymax=Math.max(N.ymax,fa),Math.abs(aa-P/2)<ea)N.xmin=V,N.xmax+=P;else if(Math.abs(V+P/2)<ea)N.xmax=aa+P;else return null}return N}function I(v,N,P=null,V=!0,Y=!0){const aa=v.spatialReference;if(aa.equals(N)||!N)return v;u(aa,N,P);const fa=Q.project(v,N,P);if(Y&&N.isWebMercator&&fa&&(fa.ymax=Math.min(2.0037508342787E7,fa.ymax),fa.ymin=Math.max(-2.0037508342787E7,fa.ymin),fa.ymin>=fa.ymax))return null;if(!V||!fa)return fa;var ea=
L(aa,!0);V=L(N,!0);if(null==ea||null==V)return fa;Y=l(aa,.001);const da=l(aa,500);var ka=l(N,.001);if(Math.abs(fa.xmin-V[0])<ka&&Math.abs(fa.xmax-V[1])<ka){ka=Math.abs(v.xmin-ea[0]);ea=Math.abs(ea[1]-v.xmax);if(ka<Y&&ea>da){fa.xmin=V[0];var na=[];na.push(new B(v.xmax,v.ymin,aa));na.push(new B(v.xmax,(v.ymin+v.ymax)/2,aa));na.push(new B(v.xmax,v.ymax,aa));na=na.map(oa=>w(oa,N,P)).filter(oa=>!isNaN(oa?.x)).map(oa=>oa.x);fa.xmax=Math.max.apply(null,na)}ea<Y&&ka>da&&(fa.xmax=V[1],V=[],V.push(new B(v.xmin,
v.ymin,aa)),V.push(new B(v.xmin,(v.ymin+v.ymax)/2,aa)),V.push(new B(v.xmin,v.ymax,aa)),v=V.map(oa=>w(oa,N,P)).filter(oa=>!isNaN(oa?.x)).map(oa=>oa.x),fa.xmin=Math.min.apply(null,v))}else v=l(N,.001),Math.abs(fa.xmin-V[0])<v&&(fa.xmin=V[0]),Math.abs(fa.xmax-V[1])<v&&(fa.xmax=V[1]);return fa}function C(v,N=!1){return v?v.isWebMercator?2*(N?2.0037508342787E7:2.0037508342788905E7):v.wkid&&v.isGeographic?360:2*T[v.wkid]||null:null}function L(v,N=!1){if(v.isGeographic)return[-180,180];v=C(v,N);return null!=
v?[-v/2,v/2]:null}function H(v,N,P,V){v=(v-N)/P;0!==v-Math.floor(v)?v=Math.floor(v):V&&--v;return v}function S(v,N=!1){var P=C(v.spatialReference);if(null==P)return 0;const V=N?0:-(P/2),Y=l(v.spatialReference),aa=!N&&Math.abs(v.xmin+P/2)<Y?-P/2:v.xmin;v=H(!N&&Math.abs(v.xmax-P/2)<Y?P/2:v.xmax,V,P,!0);P=H(aa,V,P,!1);return v-P}function x(v){const {projectedExtent:N,srcBufferExtent:P,pixelSize:V,datumTransformation:Y,rasterTransform:aa}=v;var fa=N.spatialReference;const ea=P.spatialReference;var da=
u(fa,ea);const {xmin:ka,ymin:na,xmax:oa,ymax:pa}=N,qa=C(ea),sa=null!=qa&&(v.hasWrapAround||"gcs-shift"===aa?.type);v=v.spacing||[32,32];var ra=v[0]*V.x,ua=v[1]*V.y;const ma=1===v[0],wa=Math.ceil((oa-ka)/ra-.1/v[0])+(ma?0:1),W=Math.ceil((pa-na)/ua-.1/v[1])+(ma?0:1);ra=a({cols:wa,rows:W,xmin:ka,ymax:pa,xres:ra,yres:ua,inSR:fa,outSR:ea,datumTransformation:Y,preferPE:4>=v[0],usePixelCenter:ma});ua=[];let ia,ba=0;const ja=ma?-1:NaN,{xmin:la,xmax:ca,ymax:ta,width:va,height:xa}=P,ya=l(ea,500),Aa=null!=qa&&
0<la&&ca>qa/2;var Ba=!1;da&&(Ba=b(fa),Ba=null!=Ba&&0<Ba.poleLocation);for(fa=0;fa<wa;fa++){da=[];for(let Ca=0;Ca<W;Ca++){var za=ra[fa*W+Ca];sa&&za[0]>ca&&za[0]>qa/2-ya?za[0]-=qa:sa&&0===fa&&0>za[0]&&Aa&&!aa&&(za[0]+=qa);!za||isNaN(za[0])||isNaN(za[1])?(ua.push(ja),ua.push(ja),da.push(null),ba++):(aa&&(za=aa.inverseTransform(new B({x:za[0],y:za[1],spatialReference:ea})),za=[za.x,za.y]),da.push(za),0<fa&&sa&&ia[Ca]&&za[0]<ia[Ca][0]&&(za[0]+=qa,Ba&&za[0]>ca&&za[0]>qa&&(za[0]-=qa)),ua.push((za[0]-la)/
va),ua.push((ta-za[1])/xa))}ia=da}return{offsets:ua,error:null,coefficients:null,outofBoundPointCount:ba,spacing:v,size:ma?[wa,W]:[wa-1,W-1]}}function h(v,N,P){const {cols:V,rows:Y}=N;N=new Float32Array((V-1)*(Y-1)*12);const aa=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),fa=new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(let pa=0;pa<V-1;pa++){for(var ea=0;ea<Y-1;ea++){var da=pa*Y*2+2*ea,ka=v[da];const qa=v[da+1];var na=v[da+2],oa=v[da+3];da+=2*Y;const sa=v[da],ra=v[da+1],ua=v[da+2];da=v[da+3];let ma=
0,wa=12*(ea*(V-1)+pa);for(let W=0;3>W;W++)N[wa++]=aa[ma++]*ka+aa[ma++]*na+aa[ma++]*ua;ma=0;for(na=0;3>na;na++)N[wa++]=aa[ma++]*qa+aa[ma++]*oa+aa[ma++]*da;ma=0;for(oa=0;3>oa;oa++)N[wa++]=fa[ma++]*ka+fa[ma++]*sa+fa[ma++]*ua;ma=0;for(ka=0;3>ka;ka++)N[wa++]=fa[ma++]*qa+fa[ma++]*ra+fa[ma++]*da}if(P)for(ea=0;ea<N.length;ea++)isNaN(N[ea])&&(N[ea]=-1)}return N}function G(v,N){v=v.clone().normalize();return 1===v.length?v[0]:t(v,N)}function M(v,N){const {pixelSize:P,extent:V}=v;v=F(V,N,!1);const Y=G(V,(P.x+
P.y)/16);return k(Y,N,v)}var R;(function(v){v[v.None=0]="None";v[v.North=1]="North";v[v.South=2]="South";v[v.Both=3]="Both"})(R||(R={}));const X=(v,N,P,V=0)=>{if(1===P[0])return[0,0];var Y=1,aa=-1,fa=1,ea=-1;for(var da=0;da<v.length;da+=2)isNaN(v[da])||(Y=Y>v[da]?v[da]:Y,aa=aa>v[da]?aa:v[da],fa=fa>v[da+1]?v[da+1]:fa,ea=ea>v[da+1]?ea:v[da+1]);const {cols:ka,rows:na}=N;N=(aa-Y)/ka/P[0];P=(ea-fa)/na/P[1];V*=2;fa=0;ea=!1;Y=[0,0];for(aa=0;aa<ka-3;aa++){for(da=0;da<na-3;da++){var oa=aa*na*2+2*da;const pa=
Math.abs(((v[oa]+v[oa+4]+v[oa+4*na]+v[oa+4*na+4])/4-v[oa+2*na+2])/N);oa=Math.abs(((v[oa+1]+v[oa+5]+v[oa+4*na+1]+v[oa+4*na+5])/4-v[oa+2*na+3])/P);pa+oa>fa&&(fa=pa+oa,Y=[pa,oa]);if(V&&fa>V){ea=!0;break}}if(ea)break}return Y},T={3395:2.0037508342789244E7,3410:1.7334193943686873E7,3857:2.0037508342788905E7,3975:1.7367530445161372E7,4087:2.0037508342789244E7,4088:2.0015108787169147E7,6933:1.7367530445161372E7,32662:2.0037508342789244E7,53001:2.001508679602057E7,53002:1.000754339801029E7,53003:2.001508679602057E7,
53004:2.001508679602057E7,53016:1.4152803599503474E7,53017:1.7333573624304302E7,53034:2.001508679602057E7,53079:2.0015114352186374E7,53080:2.0015114352186374E7,54001:2.0037508342789244E7,54002:1.0018754171394624E7,54003:2.0037508342789244E7,54004:2.0037508342789244E7,54016:1.4168658027268292E7,54017:1.736753044516137E7,54034:2.0037508342789244E7,54079:2.0037508342789244E7,54080:2.0037508342789244E7,54100:2.0037508342789244E7,54101:2.0037508342789244E7},Z=new Map,ha=new Map;q.computeProjectedScales=
function(v,N,P){var V=P?.tileSize??512,Y=P?.alignGlobalDatasetWithAGOL??!0,aa=!!P?.limitToSrcResolution;const {extent:fa,spatialReference:ea,pixelSize:da}=v;P=p(new B({x:da.x,y:da.y,spatialReference:ea}),N,fa);if(null==P)return{projectedPixelSize:null,scales:null,srcResolutions:null,isCustomTilingScheme:!1};const ka=(P.x+P.y)/2,na=A.getMetersPerUnitForSR(N);var oa=ka*na*96*39.37,pa=N.isGeographic?256/V*2.958287637958547E8:256/V*5.91657527591555E8,qa="vector-magdir"===v.dataType||"vector-uv"===v.dataType,
sa=M(v,N),ra=Math.min(Math.ceil(Math.log(Math.min(v.width,v.height)/32)/Math.LN2),Math.ceil(Math.log(pa/2/oa)/Math.LN2));if(!qa&&Y&&(N.isGeographic||N.isWebMercator)&&(Y=C(N),qa=0<S(sa)||null!=Y&&sa.width>Y/4,!qa&&null!=Y)){qa=-1;if(3>ra)qa=2**ra*ka*V;else if(v.storageInfo){const {maximumPyramidLevel:ua=0,pyramidScalingFactor:ma=2}=v.storageInfo;qa=ma**ua*ka*V}V=Math.ceil(Y/qa);qa=1===V||2===V&&Y/2-sa.xmax<qa}V=oa;v=Math.min(2,Math.max(1.414,v.storageInfo?.pyramidScalingFactor||2));if(qa)V=pa,pa=
N.isGeographic?1.341104507446289E-6:.29858214164761665,ra=96*pa*na*39.37,N=p(new B({x:pa,y:pa,spatialReference:{wkid:N.isGeographic?4326:3857}}),ea,sa),N.x*=V/ra,N.y*=V/ra;else{N={x:da.x,y:da.y};for(sa=0;V<.5005*pa&&sa<ra;)sa++,V*=v,N.x*=v,N.y*=v;1.001>=Math.max(V,pa)/Math.min(V,pa)&&(V=pa)}pa=[V];sa=[{x:N.x,y:N.y}];for(oa=Math.min(70.5310735,oa)/1.001;V>=oa;)V/=v,N.x/=v,N.y/=v,pa.push(V),sa.push({x:N.x,y:N.y});if(aa){const ua=.001*da.x;aa=sa.findIndex(ma=>ma.x>=da.x-ua&&ma.x<=da.x+ua);-1<aa?(sa.length=
aa+1,pa.length=aa+1):(aa=sa.findIndex(ma=>ma.x<=da.x+ua),0<aa&&(sa.length=aa,pa.length=aa))}return{projectedPixelSize:P,scales:pa,srcResolutions:sa,isCustomTilingScheme:!qa}};q.defaultGridSpacing=32;q.defaultProjectionToleranceInPixels=4;q.getDefaultDatumTransformationForDataset=F;q.getProjectedGridPoints=a;q.getProjectionOffsetGrid=function(v){var N=v.isAdaptive&&null==v.spacing;let P=v.spacing||[32,32],V=x(v);var Y={cols:V.size[0]+1,rows:V.size[1]+1};const aa=0<V.outofBoundPointCount&&V.outofBoundPointCount<
V.offsets.length/2;let fa=V.outofBoundPointCount===V.offsets.length/2||N&&aa?[0,0]:X(V.offsets,Y,P,4);const ea=(fa[0]+fa[1])/2;var da=v.projectedExtent.spatialReference;const ka=v.srcBufferExtent.spatialReference;N&&(aa||4<ea)&&(d(da,ka,v.datumTransformation)&&(da.isGeographic||null!=b(da)),P=[4,4],V=x({...v,spacing:P}),Y={cols:V.size[0]+1,rows:V.size[1]+1},fa=X(V.offsets,Y,P,4));V.error=fa;1<P[0]&&(V.coefficients=h(V.offsets,Y,aa));!v.includeGCSGrid||da.isGeographic||da.isWebMercator||(ka.isGeographic?
V.gcsGrid={offsets:V.offsets,coefficients:V.coefficients,spacing:P}:(N=b(da),null==N||N.isEnvelope||(da&&!da.isGeographic&&(N=String(da.wkid||da.wkt2||da.wkt),ha.has(N)?da=ha.get(N):(da=(da.wkid?U.PeFactory.coordsys(da.wkid):U.PeFactory.fromString(U.PeDefs.PE_TYPE_PROJCS,da.wkt2||da.wkt)).getGeogcs().getCode(),ha.set(N,da)),da=new f({wkid:da})),da=k(v.projectedExtent,da),{offsets:v}=x({...v,srcBufferExtent:da,spacing:P}),Y=h(v,Y,aa),V.gcsGrid={offsets:v,coefficients:Y,spacing:P})));return V};q.getRasterDatasetAlignmentInfo=
function(v){const N=v.storageInfo.origin.x;var P=C(v.spatialReference,!0);if(null==P)return{originX:N,halfWorldWidth:null,pyramidsInfo:null};const V=P/2,{nativePixelSize:Y,storageInfo:aa,extent:fa}=v,{maximumPyramidLevel:ea,blockWidth:da,pyramidScalingFactor:ka}=aa;let na=Y.x;const oa=[];v=null!=v.transform&&"gcs-shift"===v.transform.type;const pa=N+(v?0:V);P=v?P-N:V-N;for(let qa=0;qa<=ea;qa++){const sa=(fa.xmax-N)/na/da,ra=P/na/da;oa.push({resolutionX:na,blockWidth:da,datsetColumnCount:0===sa-Math.floor(sa)?
sa:Math.ceil(sa),worldColumnCountFromOrigin:0===ra-Math.floor(ra)?ra:Math.ceil(ra),leftMargin:Math.round(pa/na)%da,rightPadding:(da-Math.round(P/na)%da)%da,originColumnOffset:Math.floor(pa/na/da)});na*=ka}return{originX:N,halfWorldWidth:V,pyramidsInfo:oa,hasGCSSShiftTransform:v}};q.getWorldWidth=C;q.getWorldWrapCount=S;q.load=async function(){Q.isLoaded()||await Q.load()};q.minimumGridSpacing=4;q.projectDatasetExtent=M;q.projectExtent=k;q.projectPoint=w;q.projectPolygon=function(v,N,P){if("extent"===
v.type){const {xmin:V,ymin:Y,xmax:aa,ymax:fa,spatialReference:ea}=v;v=new r({rings:[[[V,fa],[aa,fa],[aa,Y],[V,Y],[V,fa]]],spatialReference:ea})}if(v.spatialReference.equals(N))return v;u(v.spatialReference,N,P);return Q.project(v,N,P)};q.projectResolution=p;q.requirePE=d;q.shiftExtent=function(v){var {spatialReference:N}=v;N=K.getInfo(N);if(!N)return v;const [P,V]=N.valid;N=V-P;let Y=0;v.xmin<P?Y=Math.ceil((P-v.xmin)/N):v.xmin>V&&(Y=-Math.ceil((v.xmin-V)/N));return new J({spatialReference:v.spatialReference,
xmin:v.xmin+Y*N,ymin:v.ymin,xmax:v.xmax+Y*N,ymax:v.ymax})};q.snapExtent=G;q.snapPyramid=function(v,N,P){const {storageInfo:V,pixelSize:Y}=N;var aa=0;let fa=!1;var {pyramidResolutions:ea}=V,da="mixed"===V.tileInfo.format?.toLowerCase()?Math.max(1,Math.min(3,V.tileInfo.dpi/96)):1;da=(v.x+v.y)/2/da;if(null!=ea&&ea.length){v=ea[ea.length-1];v=(v.x+v.y)/2;var ka=(Y.x+Y.y)/2;if(da<=ka)aa=0;else if(da>=v)aa=ea.length,fa=8<da/v;else{v=ka;for(let na=1;na<=ea.length;na++){ka=(ea[na-1].x+ea[na-1].y)/2;if(da<=
ka){da===ka?aa=na:"down"===P?(aa=na-1,fa=8<da/v):aa="up"===P?na:da-v>ka-da||2<da/v?na:na-1;break}v=ka}}P=0===aa?Y:ea[aa-1];fa&&(ea=Math.min(P.x,P.y),da=A.getMetersPerUnitForSR(N.spatialReference),19567<ea*da&&(fa=!1));return{pyramidLevel:aa,pyramidResolution:new B({x:P.x,y:P.y,spatialReference:N.spatialReference}),excessiveReading:fa}}aa=Math.log(v.x/Y.x)/Math.LN2;da=Math.log(v.y/Y.y)/Math.LN2;ea=N.storageInfo.maximumPyramidLevel||0;aa="down"===P?Math.floor(Math.min(aa,da)):"up"===P?Math.ceil(Math.max(aa,
da)):Math.round((aa+da)/2);0>aa?aa=0:aa>ea&&(fa=aa>ea+3,aa=ea);P=2**aa;N=new B({x:P*N.nativePixelSize.x,y:P*N.nativePixelSize.y,spatialReference:N.spatialReference});return{pyramidLevel:aa,pyramidResolution:N,excessiveReading:fa}};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/vectorFieldUtils":function(){define(["exports","../../../core/jsonMap","../PixelBlock","./pixelUtils"],function(q,D,z,O){function A(g,m){return p.get(g)/p.get(m)||1}function U(g,
m="geographic"){const [n,t]=g;g=Math.sqrt(n*n+t*t);let k=Math.atan2(t,n)*l;k=(360+k)%360;"geographic"===m&&(k=(450-k)%360);return[g,k]}function Q(g,m="geographic"){let n=g[1];"geographic"===m&&(n=(450-n)%360);n%=360;g=g[0];return[g*Math.cos(n/l),g*Math.sin(n/l)]}function K(g,m,n="geographic",t=1){if(!O.isValidPixelBlock(g))return g;const {pixels:k,width:y,height:I}=g;var C=y*I;const L=k[0],H=k[1],S=g.pixelType.startsWith("f")?g.pixelType:"f32",x=z.createEmptyBand(S,C);C=z.createEmptyBand(S,C);let h=
0;for(let G=0;G<I;G++)for(let M=0;M<y;M++)"vector-uv"===m?([x[h],C[h]]=U([L[h],H[h]],n),x[h]*=t):([x[h],C[h]]=Q([L[h],H[h]],n),x[h]*=t,C[h]*=t),h++;g=new z({pixelType:S,width:g.width,height:g.height,mask:g.mask,validPixelCount:g.validPixelCount,maskIsAlpha:g.maskIsAlpha,pixels:[x,C]});g.updateStatistics();return g}function J(g=0,m=0,n=Math.PI,t=!0){t&&(n=(2*Math.PI-n)%(2*Math.PI));t=t?-1:1;const k=-7*t,y=-2*t,I=-16*t,[C,L]=r(0,m+13*t,n,21.75),[H,S]=r(g-5.5,m+k,n,21.75),[x,h]=r(g+5.5,m+k,n,21.75),
[G,M]=r(g-1.5,m+y,n,21.75),[R,X]=r(g+1.5,m+y,n,21.75),[T,Z]=r(g-1.5,m+I,n,21.75),[ha,v]=r(g+1.5,m+I,n,21.75);return[C,L,H,S,G,M,R,X,x,h,T,Z,ha,v]}function B(g=0,m=Math.PI,n=!0){n&&(m=(2*Math.PI-m)%(2*Math.PI));var t=n?-1:1,k=5*t;const y=20*t,I=25*t;t*=2;const C=n?1:-1;n=5*C;let [L,H]=[0+n,0-y],[S,x]=[L+2*C,H],[h,G]=[S-0*C,x+t],[M,R]=[0-n,0-I],[X,T]=[M+0*C,R-t],Z=Math.ceil(g/5),ha=Math.floor(Z/10);Z-=8*ha;g=[];const v=[];for(let ka=0;ka<Z/2;ka++,ha--){0>=ha&&1===Z%2&&ka===(Z-1)/2&&(M=0,X=M+0*C,R=(R+
H)/2,T=R-t);const [na,oa]=r(M,R,m,45);if(0<ha){const [pa,qa]=r(S,R,m,45),[sa,ra]=r(L,H,m,45);g.push(pa);g.push(qa);g.push(na);g.push(oa);g.push(sa);g.push(ra)}else{const [pa,qa]=r(S,x,m,45),[sa,ra]=r(h,G,m,45),[ua,ma]=r(X,T,m,45);v.push(na);v.push(oa);v.push(ua);v.push(ma);v.push(sa);v.push(ra);v.push(pa);v.push(qa)}R+=k;H+=k;x+=k;G+=k;T+=k}const [N,P]=r(0+n,0+y,m,45);k=7*C;const [V,Y]=r(0+k,0+y,m,45),[aa,fa]=r(0+n,0-I,m,45),[ea,da]=r(0+k,0-I,m,45);return{pennants:g,barbs:v,shaft:[N,P,V,Y,aa,fa,ea,
da]}}function r(g,m,n,t=1){return[Math.sqrt(g*g+m*m)/t,(2*Math.PI+(2*Math.PI+Math.atan2(m,g))%(2*Math.PI)-n)%(2*Math.PI)]}function f(g,m,n,t){n=A(t||"knots",n);for(t=1;t<m.length;t++)if(t===m.length-1){if(g<m[t]*n)break}else if(g<=m[t]*n)break;return Math.min(t-1,m.length-2)}function d(g,m,n,t,k){let y=0;switch(m){case "beaufort_kn":y=f(g,a,"knots",n);break;case "beaufort_km":y=f(g,a,"kilometer-per-hour",n);break;case "beaufort_ft":y=f(g,a,"feet-per-second",n);break;case "beaufort_m":y=f(g,a,"meter-per-second",
n);break;case "classified_arrow":y=f(g,k??[],t,n);break;case "ocean_current_m":y=f(g,e,"meter-per-second",n);break;case "ocean_current_kn":y=f(g,c,"knots",n)}return y}function u(g,m){const {style:n,inputUnit:t,outputUnit:k,breakValues:y}=m,I=w.fromJSON(t),C=w.fromJSON(k);let L=0,H=0;const {width:S,height:x,mask:h}=g,G=g.pixels[0];g=g.pixels[1];var M=null!=h?h.filter(T=>0<T).length:S*x;const R=new Float32Array(42*M);M=new Uint32Array(15*M);m=m.invertDirection?J(0,0,0,!1):E;for(let T=0;T<x;T++)for(let Z=
0;Z<S;Z++){var X=T*S+Z;if(!h||h[T*S+Z]){const ha=(g[X]+360)%360/180*Math.PI,v=d(G[X],n,I,C,y);for(let N=0;N<m.length;N+=2)R[L++]=(Z+.5)/S,R[L++]=(T+.5)/x,R[L++]=m[N],R[L++]=m[N+1]+ha,R[L++]=v,R[L++]=G[X];X=7*(L/42-1);M[H++]=X;M[H++]=X+1;M[H++]=X+2;M[H++]=X+0;M[H++]=X+4;M[H++]=X+3;M[H++]=X+0;M[H++]=X+2;M[H++]=X+3;M[H++]=X+2;M[H++]=X+5;M[H++]=X+3;M[H++]=X+5;M[H++]=X+6;M[H++]=X+3}}return{vertexData:R,indexData:M}}function F(g,m){let n=0,t=0;const {width:k,height:y,mask:I}=g;g=g.pixels[0];const C=[],
L=[];var H=w.fromJSON(m.inputUnit);H=A(H,"knots");m="wind_speed"===m.style?5:Number.MAX_VALUE;for(let x=0;x<y;x++)for(let h=0;h<k;h++){var S=g[x*k+h]*H;if((!I||I[x*k+h])&&S<m){for(let G=0;4>G;G++)C[n++]=(h+.5)/k,C[n++]=(x+.5)/y,C[n++]=2>G?-.5:.5,C[n++]=0===G%2?-.5:.5,C[n++]=0,C[n++]=S;S=4*(n/24-1);L[t++]=S;L[t++]=S+1;L[t++]=S+2;L[t++]=S+1;L[t++]=S+2;L[t++]=S+3}}return{vertexData:new Float32Array(C),indexData:new Uint32Array(L)}}const p=new Map;p.set("meter-per-second",1);p.set("kilometer-per-hour",
.277778);p.set("knots",.514444);p.set("feet-per-second",.3048);p.set("mile-per-hour",.44704);const l=180/Math.PI,w=new D.JSONMap({esriMetersPerSecond:"meter-per-second",esriKilometersPerHour:"kilometer-per-hour",esriKnots:"knots",esriFeetPerSecond:"feet-per-second",esriMilesPerHour:"mile-per-hour"}),E=J(0,0,0),a=[0,1,3,6,10,16,21,27,33,40,47,55,63],e=[0,.5,1,1.5,2],c=[0,.25,.5,1,1.5,2,2.5,3,3.5,4],b=[];q.convertToLocalDirections=function(g,m,n,t="geographic"){if(!O.isValidPixelBlock(g)||null==n)return g;
g="vector-magdir"===m?g.clone():K(g,m);const k=g.pixels[1];for(let y=0;y<k.length;y++)k[y]="geographic"===t?(k[y]+n[y]+270)%360:(k[y]+360-n[y])%360;return"vector-magdir"===m?g:K(g,"vector-magdir")};q.convertVectorFieldData=K;q.convertVectorFieldUnit=function(g,m,n=1){if(1===n||!O.isValidPixelBlock(g))return g;g=g.clone();const {pixels:t,width:k,height:y}=g,I=t[0],C=t[1];let L=0;for(let H=0;H<y;H++)for(let S=0;S<k;S++)"vector-uv"===m?(I[L]*=n,C[L]*=n):I[L]*=n,L++;g.updateStatistics();return g};q.createVFMesh=
function(g,m){if("simple_scalar"===m.style)m=F(g,m);else if("wind_speed"===m.style){if(0===b.length)for(var n=0;30>n;n++)b.push(B(5*n,0,!m.invertDirection));m=w.fromJSON(m.inputUnit);m=A(m,"knots");const {width:I,height:C,mask:L}=g;n=g.pixels[0];g=g.pixels[1];const H=[],S=[];let x=0,h=0;for(let G=0;G<C;G++)for(let M=0;M<I;M++){var t=G*I+M,k=n[t]*m;if((!L||L[G*I+M])&&5<=k){const R=(g[t]+360)%360/180*Math.PI,{pennants:X,barbs:T,shaft:Z}=b[Math.min(Math.floor(k/5),29)];if(0===X.length+T.length)continue;
t=H.length/6;const ha=(M+.5)/I,v=(G+.5)/C;for(var y=0;y<X.length;y+=2)H[x++]=ha,H[x++]=v,H[x++]=X[y],H[x++]=X[y+1]+R,H[x++]=0,H[x++]=k;for(y=0;y<T.length;y+=2)H[x++]=ha,H[x++]=v,H[x++]=T[y],H[x++]=T[y+1]+R,H[x++]=0,H[x++]=k;for(y=0;y<Z.length;y+=2)H[x++]=ha,H[x++]=v,H[x++]=Z[y],H[x++]=Z[y+1]+R,H[x++]=0,H[x++]=k;for(k=0;k<X.length/6;k++)S[h++]=t,S[h++]=t+1,S[h++]=t+2,t+=3;for(k=0;k<T.length/8;k++)S[h++]=t,S[h++]=t+1,S[h++]=t+2,S[h++]=t+1,S[h++]=t+2,S[h++]=t+3,t+=4;S[h++]=t+0;S[h++]=t+1;S[h++]=t+2;
S[h++]=t+1;S[h++]=t+3;S[h++]=t+2;t+=4}}m={vertexData:new Float32Array(H),indexData:new Uint32Array(S)}}else m=u(g,m);return m};q.createVFMeshScalar=F;q.getUnitConversionFactor=A;q.sampleVectorField=function(g,m,n,t=[0,0],k=.5){const {width:y,height:I,mask:C}=g,[L,H]=g.pixels,[S,x]=t;g=Math.round((y-S)/n);t=Math.round((I-x)/n);var h=g*t;const G=new Float32Array(h),M=new Float32Array(h);h=new Uint8Array(h);m="vector-uv"===m;for(let X=0;X<t;X++)for(let T=0;T<g;T++){let Z=0;const ha=X*g+T,v=Math.max(0,
X*n+x),N=Math.max(0,T*n+S),P=Math.min(I,v+n),V=Math.min(y,N+n);for(let Y=v;Y<P;Y++)for(let aa=N;aa<V;aa++){var R=Y*y+aa;if(!C||C[R]){Z++;R=m?[L[R],H[R]]:[L[R],(360+H[R])%360];const [fa,ea]=m?R:Q(R);G[ha]+=fa;M[ha]+=ea}}if(Z>=(P-v)*(V-N)*(1-k)){h[ha]=1;const [Y,aa]=U([G[ha]/Z,M[ha]/Z]);G[ha]=Y;M[ha]=aa}else h[ha]=0,G[ha]=0,M[ha]=0}n=new z({width:g,height:t,pixels:[G,M],mask:h});n.updateStatistics();return n};q.snapImageToSymbolTile=function(g,m,n,t,k){if(null==k||!k.spatialReference.equals(g.spatialReference))return{extent:g,
width:Math.round(m/t),height:Math.round(n/t),resolution:g.width/m};const y=k.xmin;k=k.ymax;m=(g.xmax-g.xmin)/m*t;n=(g.ymax-g.ymin)/n*t;g.xmin=y+Math.floor((g.xmin-y)/m)*m;g.xmax=y+Math.ceil((g.xmax-y)/m)*m;g.ymin=k+Math.floor((g.ymin-k)/n)*n;g.ymax=k+Math.ceil((g.ymax-k)/n)*n;return{extent:g,width:Math.round(g.width/m),height:Math.round(g.height/n),resolution:(m+n)/2}};q.unitKebabDict=w;q.uvComponentToVector=U;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterTransforms/utils":function(){define(["exports",
"./GCSShiftTransform","./IdentityTransform","./PolynomialTransform"],function(q,D,z,O){const A={GCSShiftXform:D,IdentityXform:z,PolynomialXform:O},U=Object.keys(A);q.isTransformSupported=function(Q){return!Q||U.includes(Q?.type)};q.readTransform=function(Q){if(!Q?.type)return null;var K=A[Q?.type];return K?(K=new K,K.read(Q),K):null};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterTransforms/GCSShiftTransform":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseRasterTransform".split(" "),
function(q,D,z,O,A,U,Q,K){var J;z=J=class extends K{constructor(){super(...arguments);this.type="gcs-shift";this.tolerance=1E-8}forwardTransform(B){B=B.clone();if("point"===B.type)return B.x>180+this.tolerance&&(B.x-=360),B;B.xmin>=180-this.tolerance?(B.xmax-=360,B.xmin-=360):B.xmax>180+this.tolerance&&(B.xmin=-180,B.xmax=180);return B}inverseTransform(B){B=B.clone();if("point"===B.type)return B.x<-this.tolerance&&(B.x+=360),B;B.xmin<-this.tolerance&&(B.xmin+=360,B.xmax+=360);return B}clone(){return new J({tolerance:this.tolerance})}};
q.__decorate([U.enumeration({GCSShiftXform:"gcs-shift"})],z.prototype,"type",void 0);q.__decorate([D.property()],z.prototype,"tolerance",void 0);return z=J=q.__decorate([Q.subclass("esri.layers.support.rasterTransforms.GCSShiftTransform")],z)})},"esri/layers/support/rasterTransforms/BaseRasterTransform":function(){define("../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass".split(" "),
function(q,D,z,O,A,U,Q){D=class extends D.JSONSupport{get affectsPixelSize(){return!1}forwardTransform(K){return K}inverseTransform(K){return K}};q.__decorate([z.property()],D.prototype,"affectsPixelSize",null);q.__decorate([z.property({json:{write:!0}})],D.prototype,"spatialReference",void 0);return D=q.__decorate([Q.subclass("esri.layers.support.rasterTransforms.BaseRasterTransform")],D)})},"esri/layers/support/rasterTransforms/IdentityTransform":function(){define("../../../chunks/tslib.es6 ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/Error ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseRasterTransform".split(" "),
function(q,D,z,O,A,U,Q,K,J){var B;D=B=class extends J{constructor(){super(...arguments);this.type="identity"}clone(){return new B}};q.__decorate([Q.enumeration({IdentityXform:"identity"})],D.prototype,"type",void 0);return D=B=q.__decorate([K.subclass("esri.layers.support.rasterTransforms.IdentityTransform")],D)})},"esri/layers/support/rasterTransforms/PolynomialTransform":function(){define("../../../chunks/tslib.es6 ../../../geometry ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseRasterTransform ../../../geometry/Point ../../../geometry/Extent".split(" "),
function(q,D,z,O,A,U,Q,K,J,B,r,f,d){function u(l,w,E){const {x:a,y:e}=w;if(2>E)return{x:l[0]+a*l[2]+e*l[4],y:l[1]+a*l[3]+e*l[5]};if(2===E){w=a*a;E=e*e;var c=a*e;return{x:l[0]+a*l[2]+e*l[4]+w*l[6]+c*l[8]+E*l[10],y:l[1]+a*l[3]+e*l[5]+w*l[7]+c*l[9]+E*l[11]}}w=a*a;E=e*e;c=a*e;const b=w*a,g=w*e,m=a*E,n=e*E;return{x:l[0]+a*l[2]+e*l[4]+w*l[6]+c*l[8]+E*l[10]+b*l[12]+g*l[14]+m*l[16]+n*l[18],y:l[1]+a*l[3]+e*l[5]+w*l[7]+c*l[9]+E*l[11]+b*l[13]+g*l[15]+m*l[17]+n*l[19]}}function F(l,w,E){const {xmin:a,ymin:e,xmax:c,
ymax:b,spatialReference:g}=w;w=[];if(2>E)w.push({x:a,y:b}),w.push({x:c,y:b}),w.push({x:a,y:e}),w.push({x:c,y:e});else{var m=10;for(var n=0;n<m;n++)w.push({x:a,y:e+(b-e)*n/(m-1)}),w.push({x:c,y:e+(b-e)*n/(m-1)});m=8;for(n=1;n<=m;n++)w.push({x:a+(c-a)*n/m,y:e}),w.push({x:a+(c-a)*n/m,y:b})}w=w.map(t=>u(l,t,E));m=w.map(t=>t.x);w=w.map(t=>t.y);return new d({xmin:Math.min.apply(null,m),xmax:Math.max.apply(null,m),ymin:Math.min.apply(null,w),ymax:Math.max.apply(null,w),spatialReference:g})}var p;D=p=class extends r{constructor(){super(...arguments);
this.polynomialOrder=1;this.type="polynomial"}readForwardCoefficients(l,w){const {coeffX:E,coeffY:a}=w;if(!E?.length||!a?.length||E.length!==a.length)return null;l=[];for(w=0;w<E.length;w++)l.push(E[w]),l.push(a[w]);return l}writeForwardCoefficients(l,w,E){E=[];const a=[];for(let e=0;e<l?.length;e++)0===e%2?E.push(l[e]):a.push(l[e]);w.coeffX=E;w.coeffY=a}get inverseCoefficients(){var l=this._get("inverseCoefficients"),w=this._get("forwardCoefficients");if(!l&&w&&2>this.polynomialOrder){const [E,a,
e,c,b,g]=w;l=e*g-b*c;w=b*c-e*g;l=[(b*a-E*g)/l,(e*a-E*c)/w,g/l,c/w,-b/l,-e/w]}return l}set inverseCoefficients(l){this._set("inverseCoefficients",l)}readInverseCoefficients(l,w){const {inverseCoeffX:E,inverseCoeffY:a}=w;if(!E?.length||!a?.length||E.length!==a.length)return null;l=[];for(w=0;w<E.length;w++)l.push(E[w]),l.push(a[w]);return l}writeInverseCoefficients(l,w,E){E=[];const a=[];for(let e=0;e<l?.length;e++)0===e%2?E.push(l[e]):a.push(l[e]);w.inverseCoeffX=E;w.inverseCoeffY=a}get affectsPixelSize(){return 0<
this.polynomialOrder}forwardTransform(l){if("point"===l.type){const w=u(this.forwardCoefficients,l,this.polynomialOrder);return new f({x:w.x,y:w.y,spatialReference:l.spatialReference})}return F(this.forwardCoefficients,l,this.polynomialOrder)}inverseTransform(l){if("point"===l.type){const w=u(this.inverseCoefficients,l,this.polynomialOrder);return new f({x:w.x,y:w.y,spatialReference:l.spatialReference})}return F(this.inverseCoefficients,l,this.polynomialOrder)}clone(){return new p({polynomialOrder:this.polynomialOrder,
forwardCoefficients:this.forwardCoefficients?[...this.forwardCoefficients]:null,inverseCoefficients:this.inverseCoefficients?[...this.inverseCoefficients]:null})}};q.__decorate([z.property({json:{write:!0}})],D.prototype,"polynomialOrder",void 0);q.__decorate([z.property()],D.prototype,"forwardCoefficients",void 0);q.__decorate([K.reader("forwardCoefficients",["coeffX","coeffY"])],D.prototype,"readForwardCoefficients",null);q.__decorate([B.writer("forwardCoefficients")],D.prototype,"writeForwardCoefficients",
null);q.__decorate([z.property({json:{write:!0}})],D.prototype,"inverseCoefficients",null);q.__decorate([K.reader("inverseCoefficients",["inverseCoeffX","inverseCoeffY"])],D.prototype,"readInverseCoefficients",null);q.__decorate([B.writer("inverseCoefficients")],D.prototype,"writeInverseCoefficients",null);q.__decorate([z.property()],D.prototype,"affectsPixelSize",null);q.__decorate([Q.enumeration({PolynomialXform:"polynomial"})],D.prototype,"type",void 0);return D=p=q.__decorate([J.subclass("esri.layers.support.rasterTransforms.PolynomialTransform")],
D)})},"esri/renderers/support/RasterSymbolizer":function(){define("../../chunks/tslib.es6 ../../core/colorUtils ../../core/JSONSupport ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../layers/support/RasterInfo ../../layers/support/rasterFunctions/pixelUtils ../../layers/support/rasterFunctions/stretchUtils ../../layers/support/rasterFunctions/surfaceUtils ./colorRampUtils ./rasterRendererChecks".split(" "),
function(q,D,z,O,A,U,Q,K,J,B,r,f,d,u,F){function p(l){return r.isValidPixelBlock(l)&&0!==l.validPixelCount}z=class extends z.JSONSupport{constructor(l){super(l)}bind(){const {rendererJSON:l}=this;if(!l)return{success:!1};this.lookup={rendererJSON:{}};let w;switch(l.type){case "uniqueValue":w=this._updateUVRenderer(l);break;case "rasterColormap":w=this._updateColormapRenderer(l);break;case "rasterStretch":w=this._updateStretchRenderer(l);break;case "classBreaks":w=this._updateClassBreaksRenderer(l);
break;case "rasterShadedRelief":w=this._updateShadedReliefRenderer(l);break;case "vectorField":w=this._updateVectorFieldRenderer();break;case "flowRenderer":w=this._updateFlowRenderer()}return w}symbolize(l){let w=l?.pixelBlock;if(!p(w))return w;if(l.simpleStretchParams&&"rasterStretch"===this.rendererJSON.type)return this.simpleStretch(w,l.simpleStretchParams);try{3<w.pixels.length&&(w=w.extractBands([0,1,2]));let E;switch(this.rendererJSON.type){case "uniqueValue":case "rasterColormap":E=this._symbolizeColormap(w);
break;case "classBreaks":E=this._symbolizeClassBreaks(w);break;case "rasterStretch":E=this._symbolizeStretch(w,l.bandIds);break;case "rasterShadedRelief":const a=l.extent;E=this._symbolizeShadedRelief(w,{isGCS:a.spatialReference.isGeographic,resolution:{x:(a.xmax-a.xmin)/w.width,y:(a.ymax-a.ymin)/w.height}})}return E}catch(E){return O.getLogger(this).error("symbolize",E.message),w}}simpleStretch(l,w){if(!p(l))return l;try{return 3<l.pixels.length&&(l=l.extractBands([0,1,2])),f.stretch(l,{...w,isRenderer:!0})}catch(E){return O.getLogger(this).error("symbolize",
E.message),l}}generateWebGLParameters(l){if(["uniqueValue","rasterColormap","classBreaks"].includes(this.rendererJSON.type)){const {indexedColormap:c,offset:b}=this.lookup.colormapLut||{};return{colormap:c,colormapOffset:b,type:"lut"}}const {pixelBlock:w,isGCS:E,resolution:a,bandIds:e}=l;({rendererJSON:l}=this);return"rasterStretch"===l.type?this._generateStretchWebGLParams(w,l,e):"rasterShadedRelief"===l.type?this._generateShadedReliefWebGLParams(l,E,a??void 0):"vectorField"===l.type?this._generateVectorFieldWebGLParams(l):
null}_isLUTChanged(l){if(!this.lookup||!this.lookup.rendererJSON)return!0;if("colorRamp"in this.rendererJSON){const w=this.rendererJSON.colorRamp;if(l)return JSON.stringify(w)!==JSON.stringify(this.lookup.rendererJSON.colorRamp);({...this.rendererJSON});({...this.lookup.rendererJSON})}return JSON.stringify(this.rendererJSON)!==JSON.stringify(this.lookup.rendererJSON)}_symbolizeColormap(l){return this._isLUTChanged()&&!this.bind().success?l:r.colorize(l,this.lookup.colormapLut)}_symbolizeClassBreaks(l){const {canUseIndexedLUT:w}=
this._analyzeClassBreaks(this.rendererJSON);return this._isLUTChanged()&&!this.bind().success?l:w?r.colorize(l,this.lookup.colormapLut):r.remapColor(l,this.lookup.remapLut??[])}_symbolizeStretch(l,w){const {rasterInfo:E}=this,{pixelType:a,bandCount:e}=E,c=this.rendererJSON;var b=["u8","u16","s8","s16"].includes(a);let g;var {dra:m}=c;({gamma:n}=this.lookup);if("histogramEqualization"===c.stretchType){b=m?null:this.lookup?.histogramLut;w=f.getStretchCutoff(c,{rasterInfo:E,pixelBlock:l,bandIds:w,returnHistogramLut:!b});
var n=f.stretch(l,{...w,gamma:n,isRenderer:!0});n=r.lookupPixels(n,{lut:m?w.histogramLut:b,offset:0})}else if(b){if(m)m=f.getStretchCutoff(c,{rasterInfo:E,pixelBlock:l,bandIds:w}),g=f.createStretchLUT({pixelType:a,...m,gamma:n,rounding:"floor"});else{if(this._isLUTChanged()&&!this.bind().success)return l;g=this.lookup?this.lookup.stretchLut:null}if(!g)return l;1<e&&null!=w&&w.length===l?.pixels.length&&g?.lut.length===e&&(g={lut:w.map(t=>g.lut[t]),offset:g.offset});n=r.lookupPixels(l,g)}else m=f.getStretchCutoff(c,
{rasterInfo:E,pixelBlock:l,bandIds:w}),n=f.stretch(l,{...m,gamma:n,isRenderer:!0});if(c.colorRamp){if(this._isLUTChanged(!0)&&!this.bind().success)return l;n=r.colorize(n,this.lookup?.colormapLut)}return n}_symbolizeShadedRelief(l,w){var E=this.rendererJSON;w=d.hillshade(l,{...E,...w});if(!E.colorRamp||this._isLUTChanged(!0)&&!this.bind().success)return w;E=this.lookup?this.lookup.hsvMap:null;if(!E)return w;d.tintHillshade(w,l,E,this.rasterInfo.statistics?.[0]??{min:0,max:8E3});return w}_isVectorFieldData(){const {bandCount:l,
dataType:w}=this.rasterInfo;return 2===l&&("vector-magdir"===w||"vector-uv"===w)}_updateVectorFieldRenderer(){return this._isVectorFieldData()?{success:!0}:{success:!1,error:`Unsupported data type "${this.rasterInfo.dataType}"; VectorFieldRenderer only supports "vector-magdir" and "vector-uv".`}}_updateFlowRenderer(){return this._isVectorFieldData()?{success:!0}:{success:!1,error:`Unsupported data type "${this.rasterInfo.dataType}"; FlowRenderer only supports "vector-magdir" and "vector-uv".`}}_updateUVRenderer(l){const {bandCount:w,
attributeTable:E,pixelType:a}=this.rasterInfo,e=l.field1;if(!e)return{success:!1,error:"Unsupported renderer; missing UniqueValueRenderer.field."};const c=l.defaultSymbol;var b=1===w&&["u8","s8"].includes(a);if(!F.isUVRendererSupported(this.rasterInfo,e)&&!b)return{success:!1,error:"Unsupported data; UniqueValueRenderer is only supported on single band data with a valid raster attribute table."};const g=[];if(null!=E){const m=E.fields.find(n=>"value"===n.name.toLowerCase());if(!m)return{success:!1,
error:"Unsupported data; the data's raster attribute table does not have a value field."};E.features.forEach(n=>{const t=l.uniqueValueInfos?.find(k=>String(k.value)===String(n.attributes[e]))?.symbol?.color;t?g.push([n.attributes[m.name]].concat(t)):c&&g.push([n.attributes[m.name]].concat(c.color))})}else{if("value"!==e.toLowerCase())return{success:!1,error:'Unsupported renderer; UniqueValueRenderer.field must be "Value" when raster attribute table is not availalbe.'};l.uniqueValueInfos?.forEach(m=>
{const n=m?.symbol?.color;n?g.push([parseInt(""+m.value,10)].concat(n)):c&&g.push([parseInt(""+m.value,10)].concat(c?.color))})}if(0===g.length)return{success:!1,error:"Invalid UniqueValueRenderer. Cannot find matching records in the raster attribute table."};b=r.createColormapLUT({colormap:g});this.lookup={rendererJSON:l,colormapLut:b};this.canRenderInWebGL=this._isColormapSupportedByWebGL(b?.indexedColormap);return{success:!0}}_updateColormapRenderer(l){if(!F.isColormapRendererSupported(this.rasterInfo))return{success:!1,
error:"Unsupported data; the data source does not have a colormap."};var w=l.colormapInfos.map(E=>[E.value].concat(E.color)).sort((E,a)=>E[0]-a[0]);if(!w||0===w.length)return{success:!1,error:"Unsupported renderer; ColormapRenderer must have meaningful colormapInfos."};w=r.createColormapLUT({colormap:w});this.lookup={rendererJSON:l,colormapLut:w};this.canRenderInWebGL=this._isColormapSupportedByWebGL(w?.indexedColormap);return{success:!0}}_updateShadedReliefRenderer(l){if(!F.isShadedReliefRendererSupported(this.rasterInfo))return{success:!1,
error:`Unsupported data type "${this.rasterInfo.dataType}"; ShadedReliefRenderer only supports "elevation", or single band float/s16 data.`};if(l.colorRamp){var w=u.convertColorRampToColormap(l.colorRamp,{interpolateAlpha:!0});w=r.createColormapLUT({colormap:w});const E=[],a=w.indexedColormap;for(let e=0;e<a.length;e+=4){const c=D.toHSV({r:a[e],g:a[e+1],b:a[e+2]});E.push([c.h/60,c.s/100,255*c.v/100])}this.lookup={rendererJSON:l,colormapLut:w,hsvMap:E}}else this.lookup=null;this.canRenderInWebGL=!0;
return{success:!0}}_analyzeClassBreaks(l){const {attributeTable:w,pixelType:E}=this.rasterInfo,a=null!=w?w.fields.find(b=>"value"===b.name.toLowerCase()):null,e=null!=w?w.fields.find(b=>b.name.toLowerCase()===l.field.toLowerCase()):null,c=null!=a&&null!==e;return{canUseIndexedLUT:["u8","u16","s8","s16"].includes(E)||c,tableValueField:a,tableBreakField:e}}_updateClassBreaksRenderer(l){var {attributeTable:w}=this.rasterInfo;const {canUseIndexedLUT:E,tableValueField:a,tableBreakField:e}=this._analyzeClassBreaks(l);
var c=l.classBreakInfos;if(!c?.length)return{success:!1,error:"Unsupported renderer; missing or invalid ClassBreaksRenderer.classBreakInfos."};c=c.sort((t,k)=>t.classMaxValue-k.classMaxValue);var b=c[c.length-1],g=l.minValue;if(!E){var m=[];for(var n=0;n<c.length;n++)m.push({value:c[n].classMinValue??g,mappedColor:c[n].symbol.color}),g=c[n].classMaxValue;m.push({value:b.classMaxValue,mappedColor:b.symbol.color});this.lookup={rendererJSON:l,remapLut:m};this.canRenderInWebGL=!1;return{success:!0}}m=
[];if(null!=w&&null!=a&&null!==e&&a!==e){b=a.name;const t=e.name,k=c[c.length-1],{classMaxValue:y}=k;g=l.minValue;for(n of w.features){w=n.attributes[b];const I=n.attributes[t],C=I===y?k:I<g?null:c.find(({classMaxValue:L})=>L>I);C&&m.push([w].concat(C.symbol.color))}}else{g=Math.floor(l.minValue);for(n=0;n<c.length;n++){for(w=c[n];g<w.classMaxValue;g++)m.push([g].concat(w.symbol.color));g=Math.ceil(w.classMaxValue)}b.classMaxValue===g&&m.push([b.classMaxValue].concat(b.symbol.color))}c=r.createColormapLUT({colormap:m,
fillUnspecified:!1});this.lookup={rendererJSON:l,colormapLut:c};this.canRenderInWebGL=this._isColormapSupportedByWebGL(c?.indexedColormap);return{success:!0}}_isColormapSupportedByWebGL(l){return!!l?.length&&16384>=l.length}_isHistogramRequired(l){return"percentClip"===l||"histogramEqualization"===l}_isValidRasterStatistics(l){return null!=l&&0<l.length&&null!=l[0].min&&null!=l[0].max}_updateStretchRenderer(l){let {stretchType:w,dra:E}=l;if(!("none"===w||l.statistics?.length||this._isValidRasterStatistics(this.rasterInfo.statistics)||
E))return{success:!1,error:"Unsupported renderer; StretchRenderer.statistics is required when dynamic range adjustment is not used."};var a=l.histograms||this.rasterInfo.histograms;!this._isHistogramRequired(l.stretchType)||a?.length||E||(w="minMax");const {computeGamma:e,useGamma:c,colorRamp:b}=l;let {gamma:g}=l;c&&e&&!g?.length&&(g=f.computeGammaValues(this.rasterInfo.pixelType,l.statistics?.length?l.statistics:this.rasterInfo.statistics));var m=this.rasterInfo.pixelType;const n=!E&&["u8","u16",
"s8","s16"].includes(m);"histogramEqualization"===w?(m=a.map(t=>f.createHistogramEqualizationLUT(t)),this.lookup={rendererJSON:l,histogramLut:m}):n&&(a=f.getStretchCutoff(l,{rasterInfo:this.rasterInfo}),m=f.createStretchLUT({pixelType:m,...a,gamma:c?g:null,rounding:"floor"}),this.lookup={rendererJSON:l,stretchLut:m});b&&!this._isStretchColorRampNoop(b)&&(m=u.convertColorRampToColormap(b,{interpolateAlpha:!0}),this.lookup||(this.lookup={rendererJSON:l}),this.lookup.colormapLut=r.createColormapLUT({colormap:m}),
this.lookup.rendererJSON=l);this.lookup.gamma=c&&g?.length?g:null;this.canRenderInWebGL=!0;return{success:!0}}_isStretchColorRampNoop(l){return"algorithmic"===l.type&&["0,0,0,255","0,0,0"].includes(l.fromColor.join(","))&&["255,255,255,255","255,255,255"].includes(l.toColor.join(","))}_generateStretchWebGLParams(l,w,E){let a=null,e=null;var c=this.lookup?.colormapLut;w.colorRamp&&c&&(a=c.indexedColormap,e=c.offset);"histogramEqualization"===w.stretchType&&(w={...w,stretchType:"minMax"});({gamma:c}=
this.lookup);const b=!!(w.useGamma&&c&&c.some(C=>1!==C)),{minCutOff:g,maxCutOff:m,outMin:n,outMax:t}=f.getStretchCutoff(w,{rasterInfo:this.rasterInfo,pixelBlock:l,bandIds:E});var k=0;null!=l&&(k=l.getPlaneCount(),2===k&&(l=l.clone(),l.statistics=[l.statistics[0]],l.pixels=[l.pixels[0]]));({bandCount:l}=this.rasterInfo);E=Math.min(3,E?.length||k||l,l);l=new Float32Array(E);k=a||b?1:255;let y;for(y=0;y<g.length;y++)l[y]=m[y]===g[y]?0:(t-n)/(m[y]-g[y])/k;const I=new Float32Array(E);if(b&&c)for(y=0;y<
E;y++)I[y]=1<c[y]?2<c[y]?6.5+(c[y]-2)**2.5:6.5+100*(2-c[y])**4:1;return{bandCount:E,outMin:n/k,outMax:t/k,minCutOff:g,maxCutOff:m,factor:l,useGamma:b,gamma:b?c:[1,1,1],gammaCorrection:b?I:[1,1,1],colormap:a,colormapOffset:e,stretchType:w.stretchType,type:"stretch"}}_generateShadedReliefWebGLParams(l,w=!1,E={x:0,y:0}){let a=null,e=null;const c=this.lookup?.colormapLut;l.colorRamp&&c&&(a=c.indexedColormap,e=c.offset);w=d.calculateHillshadeParams({...l,isGCS:w,resolution:E});E=this.rasterInfo.statistics?.[0];
return{...w,minValue:E?.min??0,maxValue:E?.max??8E3,hillshadeType:"traditional"===l.hillshadeType?0:1,type:"hillshade",colormap:a,colormapOffset:e}}_generateVectorFieldWebGLParams(l){const {style:w,inputUnit:E,outputUnit:a,visualVariables:e,symbolTileSize:c,flowRepresentation:b}=l;let g;var m=this.rasterInfo.statistics?.[0].min??0,n=this.rasterInfo.statistics?.[0].max??50,t=e?.find(I=>"sizeInfo"===I.type)??{type:"sizeInfo",field:"Magnitude",maxDataValue:n,maxSize:.8*c,minDataValue:m,minSize:.2*c},
k=t.minDataValue??m,y=t.maxDataValue??n;n=null!=t.maxSize&&null!=t.minSize?[t.minSize/c,t.maxSize/c]:[.2,.8];"wind_speed"===w&&(n[0]=n[1]=(n[0]+n[1])/2);m=null!=k&&null!=y?[k,y]:null;if("classified_arrow"===w)if(null!=k&&null!=y&&null!=t)for(g=[],k=(t.maxDataValue-t.minDataValue)/5,y=0;6>y;y++)g.push(t.minDataValue+k*y);else g=[0,1E-6,3.5,7,10.5,14];t="flow_to"===b===("ocean_current_kn"===w||"ocean_current_m"===w)?0:Math.PI;k=e?.find(I=>"rotationInfo"===I.type);return{breakValues:g,dataRange:m,inputUnit:E,
outputUnit:a,symbolTileSize:c,symbolPercentRange:n,style:w||"single_arrow",rotation:t,rotationType:this.rasterInfo.storageInfo?.tileInfo&&"vector-uv"===this.rasterInfo.dataType?"geographic":k?.rotationType||l.rotationType,type:"vectorField"}}};q.__decorate([A.property({json:{write:!0}})],z.prototype,"rendererJSON",void 0);q.__decorate([A.property({type:B,json:{write:!0}})],z.prototype,"rasterInfo",void 0);q.__decorate([A.property({json:{write:!0}})],z.prototype,"lookup",void 0);q.__decorate([A.property()],
z.prototype,"canRenderInWebGL",void 0);return z=q.__decorate([J.subclass("esri.renderers.support.RasterSymbolizer")],z)})},"esri/renderers/support/rasterRendererChecks":function(){define(["exports"],function(q){function D(z){return["u8","s8"].includes(z.pixelType)&&null!=z.statistics?.[0]?.min&&null!=z.statistics[0]?.max&&1===z.bandCount}q.isClassBreaksSupported=function(z,O=!1){const {attributeTable:A,bandCount:U}=z;return 1===U&&(!O||null!=A||null!=z.histograms)};q.isColormapRendererSupported=function(z,
O=!1){const {bandCount:A,colormap:U,pixelType:Q}=z;return 1===A&&(!!U?.length||!O&&"u8"===Q)};q.isFlowRendererSupported=function(z){({dataType:z}=z);return"vector-uv"===z||"vector-magdir"===z};q.isShadedReliefRendererSupported=function(z){const {bandCount:O,dataType:A,pixelType:U}=z;return"elevation"===A||"generic"===A&&1===O&&("s16"===U||"s32"===U||"f32"===U||"f64"===U)};q.isSingleBand8BitRasterWithStats=D;q.isUVRendererSupported=function(z,O){const {attributeTable:A,bandCount:U}=z;return null==
A&&D(z)?!0:null==A||1<U||O&&null==A.fields.find(Q=>Q.name.toLowerCase()===O.toLowerCase())?!1:!0};q.isVectorFieldRendererSupported=function(z){({dataType:z}=z);return"vector-uv"===z||"vector-magdir"===z};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/flow/dataUtils":function(){define("exports ../../../../geometry ../../../../core/has ../../../../core/Logger ../../../../core/mathUtils ../../../../core/promiseUtils ../../../../core/RandomLCG ../../../../geometry/support/spatialReferenceUtils ../../../../geometry/Extent".split(" "),
function(q,D,z,O,A,U,Q,K,J){function B(a,e){const c=d(e.data,e.width,e.height,a.smoothing);return a.interpolate?(b,g)=>{const m=Math.floor(b),n=Math.floor(g);if(0>m||m>=e.width||0>n||n>=e.height)return[0,0];b-=m;g-=n;const t=m<e.width-1?m+1:m,k=n<e.height-1?n+1:n;return[(c[2*(n*e.width+m)]*(1-g)+c[2*(k*e.width+m)]*g)*(1-b)+(c[2*(n*e.width+t)]*(1-g)+c[2*(k*e.width+t)]*g)*b,(c[2*(n*e.width+m)+1]*(1-g)+c[2*(k*e.width+m)+1]*g)*(1-b)+(c[2*(n*e.width+t)+1]*(1-g)+c[2*(k*e.width+t)+1]*g)*b]}:(b,g)=>{b=Math.round(b);
g=Math.round(g);return 0>b||b>=e.width||0>g||g>=e.height?[0,0]:[c[2*(g*e.width+b)],c[2*(g*e.width+b)+1]]}}function r(a,e,c,b,g,m,n,t,k){const y=[];let I=0,[C,L]=e(c,b);C*=a.velocityScale;L*=a.velocityScale;y.push({x:c,y:b,t:I,speed:Math.sqrt(C*C+L*L)});for(let x=0;x<a.verticesPerLine;x++){let [h,G]=e(c,b);h*=a.velocityScale;G*=a.velocityScale;const M=Math.sqrt(h*h+G*G);if(M<a.minSpeedThreshold)break;const R=h/M,X=G/M;c+=R*a.segmentLength;b+=X*a.segmentLength;I+=a.segmentLength/M;if(Math.acos(R*H+
X*S)>a.maxTurnAngle)break;if(a.collisions){var H=Math.round(c*k);var S=Math.round(b*k);if(0>H||H>n-1||0>S||S>t-1)break;const T=m[S*n+H];if(-1!==T&&T!==g)break;m[S*n+H]=g}y.push({x:c,y:b,t:I,speed:M});H=R;S=X}return y}function f(a,e,c,b){const g=[],m=new Q,n=1/Math.max(a.lineCollisionWidth,1),t=Math.round(c*n),k=Math.round(b*n),y=new Int32Array(t*k);for(var I=0;I<y.length;I++)y[I]=-1;I=[];for(let C=0;C<b;C+=a.lineSpacing)for(let L=0;L<c;L+=a.lineSpacing)I.push({x:L,y:C,sort:m.getFloat()});I.sort((C,
L)=>C.sort-L.sort);for(const {x:C,y:L}of I)m.getFloat()<a.density&&(c=r(a,e,C,L,g.length,y,t,k,n),2>c.length||g.push(c));return g}function d(a,e,c,b){if(0===b)return a;const g=Math.round(3*b),m=Array(2*g+1);var n=0;for(var t=-g;t<=g;t++){var k=Math.exp(-t*t/(b*b));m[t+g]=k;n+=k}for(b=-g;b<=g;b++)m[b+g]/=n;n=new Float32Array(a.length);for(b=0;b<c;b++)for(t=0;t<e;t++){var y=k=0;for(var I=-g;I<=g;I++)if(!(0>t+I||t+I>=e)){var C=m[I+g];k+=C*a[2*(b*e+(t+I))];y+=C*a[2*(b*e+(t+I))+1]}n[2*(b*e+t)]=k;n[2*(b*
e+t)+1]=y}a=new Float32Array(a.length);for(b=0;b<e;b++)for(t=0;t<c;t++){y=k=0;for(I=-g;I<=g;I++)0>t+I||t+I>=c||(C=m[I+g],k+=C*n[2*((t+I)*e+b)],y+=C*n[2*((t+I)*e+b)+1]);a[2*(t*e+b)]=k;a[2*(t*e+b)+1]=y}return a}function u(a,e){const c=new Q;var b=a.reduce((t,k)=>t+k.length,0);b=new Float32Array(4*b);const g=Array(a.length);let m=0,n=0;for(const t of a){a=m;for(const k of t)b[4*m]=k.x,b[4*m+1]=k.y,b[4*m+2]=k.t,b[4*m+3]=k.speed,m++;g[n++]={startVertex:a,numberOfVertices:t.length,totalTime:t[t.length-
1].t,timeSeed:e?c.getFloat():0}}return{lineVertices:b,lineDescriptors:g}}function F(a,e){function c(H,S,x,h,G,M,R,X){const T=9*k;let Z=0;t[T+Z++]=H;t[T+Z++]=S;t[T+Z++]=1;t[T+Z++]=x;t[T+Z++]=M;t[T+Z++]=R;t[T+Z++]=h/2;t[T+Z++]=G/2;t[T+Z++]=X;k++;t[T+Z++]=H;t[T+Z++]=S;t[T+Z++]=-1;t[T+Z++]=x;t[T+Z++]=M;t[T+Z++]=R;t[T+Z++]=-h/2;t[T+Z++]=-G/2;t[T+Z++]=X;k++}const {lineVertices:b,lineDescriptors:g}=a;var m=a=0;for(var n of g)a+=2*n.numberOfVertices,m+=6*(n.numberOfVertices-1);const t=new Float32Array(9*
a);n=new Uint32Array(m);let k=0;a=0;for(const H of g){const {totalTime:S,timeSeed:x}=H;let h=m=null,G=null;var y=null,I=null,C=null;for(let M=0;M<H.numberOfVertices;M++){y=b[4*(H.startVertex+M)];const R=b[4*(H.startVertex+M)+1],X=b[4*(H.startVertex+M)+2],T=b[4*(H.startVertex+M)+3];let Z=null,ha=null;var L=null;let v=null;0<M&&(Z=y-m,ha=R-h,L=Math.sqrt(Z*Z+ha*ha),Z/=L,ha/=L,1<M?(I=Z+I,C=ha+C,L=Math.sqrt(I*I+C*C),I/=L,C/=L,L=Math.min(1/(I*Z+C*ha),e),I*=L,C*=L,L=-C,v=I):(L=-ha,v=Z),null!==L&&null!==
v&&(c(m,h,G,L,v,S,x,T),n[a++]=k-2,n[a++]=k,n[a++]=k-1,n[a++]=k,n[a++]=k+1,n[a++]=k-1));m=y;h=R;G=X;I=Z;C=ha;y=T}c(m,h,G,-C,I,S,x,y)}return{vertexData:t,indexData:n}}function p(a){function e(P,V){var Y=X+Z,aa=T+ha,fa=Math.sqrt(Y*Y+aa*aa);Y/=fa;aa/=fa;var ea=X*Y+T*aa,da=Z+v,ka=ha+N;fa=Math.sqrt(da*da+ka*ka);da/=fa;ka/=fa;var na=Z*da+ha*ka;fa=L;var oa=H,pa=S,qa=x;aa=-(aa/ea);Y/=ea;ea=h;var sa=G,ra=M,ua=R;ka=-(ka/na);da/=na;na=16*I;let ma=0;for(const wa of[1,2])for(const W of[1,2,3,4])k[na+ma++]=fa,k[na+
ma++]=oa,k[na+ma++]=pa,k[na+ma++]=qa,k[na+ma++]=ea,k[na+ma++]=sa,k[na+ma++]=ra,k[na+ma++]=ua,k[na+ma++]=wa,k[na+ma++]=W,k[na+ma++]=P,k[na+ma++]=V,k[na+ma++]=aa/2,k[na+ma++]=Y/2,k[na+ma++]=ka/2,k[na+ma++]=da/2,I++;y[C++]=I-8;y[C++]=I-7;y[C++]=I-6;y[C++]=I-7;y[C++]=I-5;y[C++]=I-6;y[C++]=I-4;y[C++]=I-3;y[C++]=I-2;y[C++]=I-3;y[C++]=I-1;y[C++]=I-2}function c(P,V,Y,aa,fa,ea){X=Z;T=ha;Z=v;ha=N;null==X&&null==T&&(X=Z,T=ha);if(null!=h&&null!=G){v=P-h;N=V-G;const da=Math.sqrt(v*v+N*N);v/=da;N/=da}null!=X&&
null!=T&&e(fa,ea);L=h;H=G;S=M;x=R;h=P;G=V;M=Y;R=aa}function b(P,V){X=Z;T=ha;Z=v;ha=N;null==X&&null==T&&(X=Z,T=ha);null!=X&&null!=T&&e(P,V)}const {lineVertices:g,lineDescriptors:m}=a;let n=a=0;for(var t of m){const P=t.numberOfVertices-1;a+=8*P;n+=12*P}const k=new Float32Array(16*a),y=new Uint32Array(n);let I=0,C=0,L,H,S,x,h,G,M,R,X,T,Z,ha,v,N;for(const P of m){N=v=ha=Z=T=X=R=M=G=h=x=S=H=L=null;const {totalTime:V,timeSeed:Y}=P;for(t=0;t<P.numberOfVertices;t++)c(g[4*(P.startVertex+t)],g[4*(P.startVertex+
t)+1],g[4*(P.startVertex+t)+2],g[4*(P.startVertex+t)+3],V,Y);b(V,Y)}return{vertexData:k,indexData:y}}function l(a,e){const c=e.pixels,{width:b,height:g}=e,m=new Float32Array(b*g*2),n=e.mask||new Uint8Array(b*g*2);e.mask||n.fill(255);if("vector-uv"===a)for(a=0;a<b*g;a++)m[2*a]=c[0][a],m[2*a+1]=-c[1][a];else if("vector-magdir"===a)for(a=0;a<b*g;a++){e=c[0][a];const t=A.deg2rad(c[1][a]),k=Math.sin(t-Math.PI/2);m[2*a]=Math.cos(t-Math.PI/2)*e;m[2*a+1]=k*e}return{data:m,mask:n,width:b,height:g}}async function w(a,
e,c,b,g,m){const n={requestProjectedLocalDirections:!0,signal:m};null!=g&&(n.timeExtent=g);if("imagery"===a.type)return await a.load({signal:m}),g=a.rasterInfo.dataType,a=await a.fetchImage(e,c,b,n),null==a?.pixelData?.pixelBlock?{data:new Float32Array(c*b*2),mask:new Uint8Array(c*b),width:c,height:b}:l(g,a.pixelData.pixelBlock);await a.load({signal:m});g=a.rasterInfo.dataType;a=await a.fetchPixels(e,c,b,n);return null==a?.pixelBlock?{data:new Float32Array(c*b*2),mask:new Uint8Array(c*b),width:c,
height:b}:l(g,a.pixelBlock)}const E=O.getLogger("esri.views.2d.engine.flow.dataUtils");q.createAnimatedLinesData=u;q.createFlowMesh=async function(a,e,c,b){const g=performance.now();var m=B(e,c);const n=performance.now();c=f(e,m,c.width,c.height);e=performance.now();m=u(c,!0);c=performance.now();a="Streamlines"===a?F(m,10):p(m);m=performance.now();z("esri-2d-profiler")&&(E.info("I.1","_createFlowFieldFromData (ms)",Math.round(n-g)),E.info("I.2","_getStreamlines (ms)",Math.round(e-n)),E.info("I.3",
"createAnimatedLinesData (ms)",Math.round(c-e)),E.info("I.4","create{Streamlines|Particles}Mesh (ms)",Math.round(m-c)),E.info("I.5","createFlowMesh (ms)",Math.round(m-g)),E.info("I.6","Mesh size (bytes)",a.vertexData.buffer.byteLength+a.indexData.buffer.byteLength));await Promise.resolve();U.throwIfAborted(b);return a};q.createParticlesMesh=p;q.createStreamlinesMesh=F;q.loadImagery=async function(a,e,c,b,g,m){const n=performance.now();var t=K.getInfo(e.spatialReference);if(!t)return c=await w(a,e,
c,b,g,m),z("esri-2d-profiler")&&E.info("I.7","loadImagery, early exit (ms)",Math.round(performance.now()-n)),z("esri-2d-profiler")&&E.info("I.9","Number of parts",1),c;const [k,y]=t.valid,I=Math.ceil(e.width/(y-k)),C=e.width/I,L=Math.round(c/I);let H=e.xmin;const S=[];t=performance.now();for(let x=0;x<I;x++){const h=new J({xmin:H,xmax:H+C,ymin:e.ymin,ymax:e.ymax,spatialReference:e.spatialReference});S.push(w(a,h,L,b,g,m));H+=C}a=await Promise.all(S);z("esri-2d-profiler")&&E.info("I.8","All calls to _fetchPart (ms)",
Math.round(performance.now()-t));z("esri-2d-profiler")&&E.info("I.9","Number of parts",a.length);b={data:new Float32Array(c*b*2),mask:new Uint8Array(c*b),width:c,height:b};e=0;for(const x of a){for(a=0;a<x.height;a++)for(g=0;g<x.width;g++)e+g>=c||(b.data[2*(a*c+e+g)]=x.data[2*(a*x.width+g)],b.data[2*(a*c+e+g)+1]=x.data[2*(a*x.width+g)+1],b.mask[a*c+e+g]=x.mask[a*x.width+g]);e+=x.width}z("esri-2d-profiler")&&E.info("I.10","loadImagery, general exit (ms)",Math.round(performance.now()-n));return b};
Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define("../../geometry ../../geometry/support/GeographicTransformation ./PixelBlock ./rasterFormats/RasterCodec ./rasterFunctions/pixelUtils ./rasterFunctions/rasterFunctionHelper ./rasterFunctions/rasterProjectionHelper ./rasterFunctions/stretchUtils ./rasterFunctions/vectorFieldUtils ./rasterTransforms/utils ../../renderers/support/RasterSymbolizer ../../views/2d/engine/flow/dataUtils ../../geometry/Extent ../../geometry/Point".split(" "),function(q,D,z,O,A,U,Q,K,J,B,r,f,d,u){class F{convertVectorFieldData(p){const l=
z.fromJSON(p.pixelBlock);p=J.convertVectorFieldData(l,p.type);return Promise.resolve(null!=p?p.toJSON():null)}computeStatisticsHistograms(p){p=z.fromJSON(p.pixelBlock);p=K.computeStatisticsHistograms(p);return Promise.resolve(p)}async decode(p){return(p=await O.decode(p.data,p.options))&&p.toJSON()}symbolize(p){p.pixelBlock=z.fromJSON(p.pixelBlock);p.extent=p.extent?d.fromJSON(p.extent):null;p=this.symbolizer.symbolize(p);return Promise.resolve(null!=p?p.toJSON():null)}async updateSymbolizer(p){this.symbolizer=
r.fromJSON(p.symbolizerJSON);p.histograms&&"rasterStretch"===this.symbolizer?.rendererJSON.type&&(this.symbolizer.rendererJSON.histograms=p.histograms)}async updateRasterFunction(p){this.rasterFunction=U.create(p.rasterFunctionJSON)}async process(p){p=this.rasterFunction.process({extent:d.fromJSON(p.extent),primaryPixelBlocks:p.primaryPixelBlocks.map(l=>null!=l?z.fromJSON(l):null),primaryPixelSizes:p.primaryPixelSizes?.map(l=>null!=l?u.fromJSON(l):null),primaryRasterIds:p.primaryRasterIds});return null!=
p?p.toJSON():null}stretch(p){p=this.symbolizer.simpleStretch(z.fromJSON(p.srcPixelBlock),p.stretchParams);return Promise.resolve(p?.toJSON())}estimateStatisticsHistograms(p){p=K.estimateStatisticsHistograms(z.fromJSON(p.srcPixelBlock));return Promise.resolve(p)}split(p){const l=A.split(z.fromJSON(p.srcPixelBlock),p.tileSize,p.maximumPyramidLevel);l&&l.forEach((w,E)=>{l.set(E,w?.toJSON())});return Promise.resolve(l)}async mosaicAndTransform(p){var l=p.srcPixelBlocks.map(a=>a?new z(a):null);let w=l=
A.mosaic(l,p.srcMosaicSize,{blockWidths:p.blockWidths,alignmentInfo:p.alignmentInfo,clipOffset:p.clipOffset,clipSize:p.clipSize});p.coefs&&(w=A.approximateTransform(l,p.destDimension,p.coefs,p.sampleSpacing,p.interpolation));let E;p.projectDirections&&p.gcsGrid&&(E=A.getLocalArithmeticNorthRotations(p.destDimension,p.gcsGrid),w=J.convertToLocalDirections(w,p.isUV?"vector-uv":"vector-magdir",E));return{pixelBlock:w?.toJSON(),localNorthDirections:E}}async createFlowMesh(p,l){const w={data:new Float32Array(p.flowData.buffer),
mask:new Uint8Array(p.flowData.maskBuffer),width:p.flowData.width,height:p.flowData.height},{vertexData:E,indexData:a}=await f.createFlowMesh(p.meshType,p.simulationSettings,w,l.signal);return{result:{vertexBuffer:E.buffer,indexBuffer:a.buffer},transferList:[E.buffer,a.buffer]}}async getProjectionOffsetGrid(p){const l=d.fromJSON(p.projectedExtent),w=d.fromJSON(p.srcBufferExtent);let E=null;p.datumTransformationSteps&&(E=new D({steps:p.datumTransformationSteps}));(p.includeGCSGrid||Q.requirePE(l.spatialReference,
w.spatialReference,E))&&await Q.load();const a=p.rasterTransform?B.readTransform(p.rasterTransform):null;return Q.getProjectionOffsetGrid({...p,projectedExtent:l,srcBufferExtent:w,datumTransformation:E,rasterTransform:a})}}return F});