// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.28/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/graphics/sources/WFSSource":function(){define("exports ../../../chunks/tslib.es6 ../../../geometry ../../../core/Error ../../../core/has ../../../core/Loadable ../../../core/promiseUtils ../../../core/workers/workers ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ../../../geometry/support/typeUtils ./support/clientSideDefaults ../../ogc/wfsUtils ../../../rest/support/FeatureSet ../../../time/timeZoneUtils ../../../geometry/Extent".split(" "),
function(f,A,E,t,F,x,p,K,B,S,L,T,G,h,P,aa,m,Y){f.WFSSource=class extends x{constructor(){super(...arguments);this._connection=null;this.capabilities=h.createCapabilities(!1,!1);this.type="wfs";this.refresh=p.debounce(async l=>{await this.load();({extent:l}=await this._connection.invoke("refresh",l));l&&(this.sourceJSON.extent=l);return{dataChanged:!0,updates:{extent:this.sourceJSON.extent}}})}load(l){this.addResolvingPromise(this._startWorker({signal:null!=l?l.signal:null}));return Promise.resolve(this)}destroy(){this._connection?.close();
this._connection=null}async openPorts(){await this.load();return this._connection.openPorts()}async queryFeatures(l,v={}){await this.load(v);l=await this._connection.invoke("queryFeatures",l?l.toJSON():null,v);return aa.fromJSON(l)}async queryFeaturesJSON(l,v={}){await this.load(v);return this._connection.invoke("queryFeatures",l?l.toJSON():null,v)}async queryFeatureCount(l,v={}){await this.load(v);return this._connection.invoke("queryFeatureCount",l?l.toJSON():null,v)}async queryObjectIds(l,v={}){await this.load(v);
return this._connection.invoke("queryObjectIds",l?l.toJSON():null,v)}async queryExtent(l,v={}){await this.load(v);l=await this._connection.invoke("queryExtent",l?l.toJSON():null,v);return{count:l.count,extent:Y.fromJSON(l.extent)}}async querySnapping(l,v={}){await this.load(v);return this._connection.invoke("querySnapping",l,v)}async _createLoadOptions(l){const {url:v,customParameters:b,name:c,namespaceUri:n,fields:u,geometryType:C,swapXY:H}=this.layer;var y="defaults"===this.layer.originOf("spatialReference")?
void 0:this.layer.spatialReference;if(!v)throw new t("wfs-layer:missing-url","WFSLayer must be created with a url");this.wfsCapabilities||(this.wfsCapabilities=await P.getCapabilities(v,{customParameters:b,...l}));l=["fields","geometryType","name","namespaceUri","swapXY"].some(N=>null==this.layer[N])?await P.getWFSLayerInfo(this.wfsCapabilities,c,n,{spatialReference:y,customParameters:b,signal:l?.signal}):{...P.prepareWFSLayerFields(u??[]),geometryType:C,name:c,namespaceUri:n,spatialReference:y,swapXY:H};
y=P.findFeatureType(this.wfsCapabilities.readFeatureTypes(),l.name,l.namespaceUri);const Q=G.featureGeometryTypeKebabDictionary.toJSON(l.geometryType);return{customParameters:b,featureType:y,fields:l.fields?.map(N=>N.toJSON())??[],geometryField:l.geometryField,geometryType:Q,getFeatureUrl:this.wfsCapabilities.operations.GetFeature.url,getFeatureOutputFormat:this.wfsCapabilities.operations.GetFeature.outputFormat,objectIdField:l.objectIdField,spatialReference:l.spatialReference?.toJSON(),swapXY:!!l.swapXY}}async _startWorker(l){const [v,
b]=await p.eachAlways([this._createLoadOptions(l),K.open("WFSSourceWorker",{...l,strategy:F("feature-layers-workers")?"dedicated":"local",registryTarget:this})]);var c=v.error||b.error||null;const n=b.value||null;if(c)throw n&&n.close(),c;c=v.value;this._connection=b.value;l=(await this._connection.invoke("load",c,l)).extent;this.sourceJSON={dateFieldsTimeReference:{timeZoneIANA:m.utc},extent:l,fields:c.fields,geometryType:c.geometryType,objectIdField:c.objectIdField,geometryField:c.geometryField,
drawingInfo:h.createDrawingInfo(c.geometryType),name:c.featureType.title,wfsInfo:{name:c.featureType.name,featureUrl:c.getFeatureUrl,maxFeatures:3E3,swapXY:c.swapXY,supportedSpatialReferences:c.featureType.supportedSpatialReferences,version:"2.0.0",wfsNamespace:c.featureType.namespaceUri}}}};A.__decorate([B.property()],f.WFSSource.prototype,"capabilities",void 0);A.__decorate([B.property({constructOnly:!0})],f.WFSSource.prototype,"layer",void 0);A.__decorate([B.property()],f.WFSSource.prototype,"sourceJSON",
void 0);A.__decorate([B.property()],f.WFSSource.prototype,"type",void 0);A.__decorate([B.property()],f.WFSSource.prototype,"wfsCapabilities",void 0);f.WFSSource=A.__decorate([T.subclass("esri.layers.graphics.sources.WFSSource")],f.WFSSource);Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})})},"esri/layers/ogc/wfsUtils":function(){define("exports ../../geometry ../../request ../../core/Error ../../core/iteratorUtils ../../core/urlUtils ../../geometry/projection ../../geometry/support/spatialReferenceUtils ../../geometry/support/typeUtils ../graphics/sources/geojson/geojson ./xmlUtils ../support/arcgisLayerUrl ../support/Field ../support/fieldUtils ../../geometry/SpatialReference ../../geometry/Extent".split(" "),
function(f,A,E,t,F,x,p,K,B,S,L,T,G,h,P,aa){function m(a){a=V(a);W(a);I(a);a=a.firstElementChild;const d=F.cache(v(a));return{operations:Y(a),get featureTypes(){return Array.from(d())},readFeatureTypes:d}}function Y(a){let d=!1;const e={GetCapabilities:{url:""},DescribeFeatureType:{url:""},GetFeature:{url:"",outputFormat:null,supportsPagination:!1}};L.visitXML(a,{OperationsMetadata:{Operation:k=>{switch(k.getAttribute("name")){case "GetCapabilities":return{DCP:{HTTP:{Get:g=>{e.GetCapabilities.url=
g.getAttribute("xlink:href")}}}};case "DescribeFeatureType":return{DCP:{HTTP:{Get:g=>{e.DescribeFeatureType.url=g.getAttribute("xlink:href")}}}};case "GetFeature":return{DCP:{HTTP:{Get:g=>{e.GetFeature.url=g.getAttribute("xlink:href")}}},Parameter:g=>{if("outputFormat"===g.getAttribute("name"))return{AllowedValues:{Value:r=>{(r=r.textContent)&&Z.has(r.toLowerCase())&&(e.GetFeature.outputFormat=r)}}}}}}},Constraint:k=>{switch(k.getAttribute("name")){case "KVPEncoding":return{DefaultValue:g=>{d="true"===
g.textContent.toLowerCase()}};case "ImplementsResultPaging":return{DefaultValue:g=>{e.GetFeature.supportsPagination="true"===g.textContent.toLowerCase()}}}}}});if(!d)throw new t("wfs-layer:kvp-encoding-not-supported","WFS service doesn't support key/value pair (KVP) encoding");if(null==e.GetFeature.outputFormat)throw new t("wfs-layer:geojson-not-supported","WFS service doesn't support GeoJSON output format");return e}function l(a){a=parseInt(a.textContent?.match(/(?<wkid>\d+$)/i)?.groups?.wkid??"",
10);if(!Number.isNaN(a))return a}function v(a){return L.iterateXML(a,{FeatureTypeList:{FeatureType:d=>{const e={typeName:"undefined:undefined",name:"",title:"",description:"",extent:null,namespacePrefix:"",namespaceUri:"",defaultSpatialReference:4326,supportedSpatialReferences:[]},k=new Set;L.visitXML(d,{Name:g=>{const {name:r,prefix:w}=J(g.textContent);e.typeName=`${w}:${r}`;e.name=r;e.namespacePrefix=w;e.namespaceUri=g.lookupNamespaceURI(w)},Abstract:g=>{e.description=g.textContent},Title:g=>{e.title=
g.textContent},WGS84BoundingBox:g=>{e.extent=b(g)},DefaultCRS:g=>{if(g=l(g))e.defaultSpatialReference=g,k.add(g)},OtherCRS:g=>{(g=l(g))&&k.add(g)}});e.title||(e.title=e.name);k.add(4326);e.supportedSpatialReferences.push(...k);return e}}})}function b(a){let d,e,k,g;for(const r of a.children)switch(r.localName){case "LowerCorner":[d,e]=r.textContent.split(" ").map(w=>Number.parseFloat(w));break;case "UpperCorner":[k,g]=r.textContent.split(" ").map(w=>Number.parseFloat(w))}return{xmin:d,ymin:e,xmax:k,
ymax:g,spatialReference:K.WGS84}}function c(a,d,e){return F.find(a,k=>e?k.name===d&&k.namespaceUri===e:k.typeName===d||k.name===d)}async function n(a,d,e,k={}){a=a.readFeatureTypes();e=d?c(a,d,e):a.next().value;({spatialReference:a=new P({wkid:e?.defaultSpatialReference})}=k);if(null==e){if(d)throw new t("wfs-layer:feature-type-not-found",`The type '${d}' could not be found in the service`);throw new t("wfs-layer:empty-service","The service is empty");}d=new aa({...e.extent,spatialReference:P.WGS84});
if(!K.equals(d.spatialReference,a))try{await p.initializeProjection(d.spatialReference,a,void 0,k),d=p.project(d,a)}catch{throw new t("wfs-layer:unsupported-spatial-reference","Projection not supported");}return{extent:d,spatialReference:a,featureType:e}}async function u(a,d,e,k={}){const {typeName:g}=d,[r,w]=await Promise.allSettled([y(a.operations.DescribeFeatureType.url,g,k),H(a,g,e,k)]);a=O=>new t("wfs-layer:getWFSLayerTypeInfo-error",`An error occurred while getting info about the feature type '${g}'`,
{error:O});if("rejected"===r.status)throw a(r.reason);if("rejected"===w.status)throw a(w.reason);const {fields:R,errors:D}=r.value??{};a=r.value?.geometryType||w.value?.geometryType;d=w.value?.swapXY??!1;if(null==a)throw new t("wfs-layer:unknown-geometry-type",`The geometry type could not be determined for type '${g}`,{typeName:g,geometryType:a,fields:R,errors:D});return{...C(R??[]),geometryType:a,swapXY:d}}function C(a){const d=a.find(k=>"geometry"===k.type);let e=a.find(k=>"oid"===k.type);a=a.filter(k=>
"geometry"!==k.type);e||(e=new G({name:"__esri_wfs_id__",type:"oid",alias:"__esri_wfs_id__"}),a.unshift(e));return{geometryField:d?.name??null,objectIdField:e.name,fields:a}}async function H(a,d,e,k={}){let g,r=!1;const [w,R]=await Promise.all([M(a.operations.GetFeature.url,d,e,a.operations.GetFeature.outputFormat,{...k,count:1}),E(a.operations.GetFeature.url,{responseType:"text",query:X(d,e,void 0,{...k,count:1}),signal:k?.signal})]);if(a="FeatureCollection"===w.type&&w.features[0]?.geometry){g=
B.featureGeometryTypeKebabDictionary.fromJSON(S.getGeometryType(a.type));switch(a.type){case "Point":var D=a.coordinates;break;case "LineString":case "MultiPoint":D=a.coordinates[0];break;case "MultiLineString":case "Polygon":D=a.coordinates[0][0];break;case "MultiPolygon":D=a.coordinates[0][0][0]}if(d=/<[^>]*pos[^>]*> *(-?\d+(?:\.\d+)?) (-?\d+(?:\.\d+)?)/.exec(R.data))a=D[0].toFixed(3),D=D[1].toFixed(3),e=parseFloat(d[1]).toFixed(3),d=parseFloat(d[2]).toFixed(3),a===d&&D===e&&(r=!0)}return{geometryType:g,
swapXY:r}}async function y(a,d,e){a=await E(a,{responseType:"text",query:{SERVICE:"WFS",REQUEST:"DescribeFeatureType",VERSION:"2.0.0",TYPENAME:d,...e?.customParameters},signal:e?.signal});return Q(d,a.data)}function Q(a,d){const {name:e}=J(a);d=V(d);I(d);const k=F.find(L.iterateXML(d.firstElementChild,{element:g=>({name:g.getAttribute("name"),typeName:J(g.getAttribute("type")).name})}),({name:g})=>g===e);if(null!=k){const g=F.find(L.iterateXML(d.firstElementChild,{complexType:r=>r}),r=>r.getAttribute("name")===
k.typeName);if(null!=g)return N(g)}throw new t("wfs-layer:feature-type-not-found",`Type '${a}' not found in document`,{document:(new XMLSerializer).serializeToString(d)});}function N(a){const d=[],e=[];let k=void 0;var g=L.iterateXML(a,{complexContent:{extension:{sequence:{element:r=>r}}}});for(const r of g){g=r.getAttribute("name");if(!g)continue;let w,R;r.hasAttribute("type")?w=J(r.getAttribute("type")).name:L.visitXML(r,{simpleType:{restriction:q=>{w=J(q.getAttribute("base")).name;return{maxLength:z=>
{R=+z.getAttribute("value")}}}}});if(!w)continue;const D="true"===r.getAttribute("nillable");let O=!1;switch(w.toLowerCase()){case "integer":case "nonpositiveinteger":case "negativeinteger":case "long":case "int":case "short":case "byte":case "nonnegativeinteger":case "unsignedlong":case "unsignedint":case "unsignedshort":case "unsignedbyte":case "positiveinteger":e.push(new G({name:g,alias:g,type:"integer",nullable:D,length:h.getFieldDefaultLength("integer")}));break;case "float":case "double":case "decimal":e.push(new G({name:g,
alias:g,type:"double",nullable:D,length:h.getFieldDefaultLength("double")}));break;case "boolean":case "string":case "gyearmonth":case "gyear":case "gmonthday":case "gday":case "gmonth":case "anyuri":case "qname":case "notation":case "normalizedstring":case "token":case "language":case "idrefs":case "entities":case "nmtoken":case "nmtokens":case "name":case "ncname":case "id":case "idref":case "entity":case "duration":case "time":e.push(new G({name:g,alias:g,type:"string",nullable:D,length:R??h.getFieldDefaultLength("string")}));
break;case "datetime":case "date":e.push(new G({name:g,alias:g,type:"date",nullable:D,length:R??h.getFieldDefaultLength("date")}));break;case "pointpropertytype":k="point";O=!0;break;case "multipointpropertytype":k="multipoint";O=!0;break;case "curvepropertytype":case "multicurvepropertytype":case "multilinestringpropertytype":k="polyline";O=!0;break;case "surfacepropertytype":case "multisurfacepropertytype":case "multipolygonpropertytype":k="polygon";O=!0;break;case "geometrypropertytype":case "multigeometrypropertytype":O=
!0;d.push(new t("wfs-layer:unknown-geometry-type",`geometry type '${w}' is not supported`,{type:(new XMLSerializer).serializeToString(a)}));break;default:d.push(new t("wfs-layer:unknown-field-type",`Unknown field type '${w}'`,{type:(new XMLSerializer).serializeToString(a)}))}O&&e.push(new G({name:g,alias:g,type:"geometry",nullable:D}))}for(const r of e)if("integer"===r.type&&!r.nullable&&da.has(r.name.toLowerCase())){r.type="oid";break}return{geometryType:k,fields:e,errors:d}}async function M(a,d,
e,k,g){({data:a}=await E(a,{responseType:"text",query:X(d,e,k,g),signal:g?.signal}));a=a.replaceAll(/": +(-?\d+),(\d+)(,)?/g,'": $1.$2$3');try{return JSON.parse(a)}catch(r){throw new t("wfs-layer:malformed-json","Error while parsing the\u00a0response",{response:a,error:r});}}function X(a,d,e,k){return{SERVICE:"WFS",REQUEST:"GetFeature",VERSION:"2.0.0",TYPENAMES:a,OUTPUTFORMAT:e,SRSNAME:"EPSG:"+("number"===typeof d?d:d.wkid),STARTINDEX:k?.startIndex,COUNT:k?.count,...k?.customParameters}}function V(a){return(new DOMParser).parseFromString(a.trim(),
"text/xml")}function J(a){const [d,e]=a.split(":");return{prefix:e?d:"",name:e??d}}function W(a){if((a=a.firstElementChild?.getAttribute("version"))&&"2.0.0"!==a)throw new t("wfs-layer:unsupported-wfs-version",`Unsupported WFS version ${a}. Supported version: ${"2.0.0"}`);}function I(a){let d="",e="";L.visitXML(a.firstElementChild,{Exception:k=>{d=k.getAttribute("exceptionCode");return{ExceptionText:g=>{e=g.textContent}}}});if(d)throw new t(`wfs-layer:${d}`,e);}function ca(a,d,e){const k={wkid:d.defaultSpatialReference};
e=null!=e?.wkid?{wkid:e.wkid}:k;a=T.isArcGISUrl(a)||e.wkid&&d.supportedSpatialReferences.includes(e.wkid)?{wkid:e.wkid}:{wkid:d.defaultSpatialReference};return{spatialReference:e,getFeatureSpatialReference:a}}const Z=new Set(["json","application/json","geojson","application/json; subtype\x3dgeojson"]),da=new Set(["objectid","fid"]);f.describeFeatureType=y;f.findFeatureType=c;f.getCapabilities=async function(a,d){d=await E(a,{responseType:"text",query:{SERVICE:"WFS",REQUEST:"GetCapabilities",VERSION:"2.0.0",
...d?.customParameters},signal:d?.signal});d=m(d.data);x.isHTTPSProtocol(a)&&(x.hasSameOrigin(a,d.operations.DescribeFeatureType.url,!0)&&(d.operations.DescribeFeatureType.url=x.toHTTPS(d.operations.DescribeFeatureType.url)),x.hasSameOrigin(a,d.operations.GetFeature.url,!0)&&(d.operations.GetFeature.url=x.toHTTPS(d.operations.GetFeature.url)));return d};f.getFeature=M;f.getFeatureCount=async function(a,d,e){a=await E(a,{responseType:"text",query:{SERVICE:"WFS",REQUEST:"GetFeature",VERSION:"2.0.0",
TYPENAMES:d,RESULTTYPE:"hits",...e?.customParameters},signal:e?.signal});a=V(a.data);I(a);a=Number.parseFloat(a.firstElementChild.getAttribute("numberMatched"));return Number.isNaN(a)?0:a};f.getFeatureTypeInfo=n;f.getGetFeatureSpatialReference=ca;f.getWFSLayerInfo=async function(a,d,e,k={}){const {featureType:g,extent:r}=await n(a,d,e,k);({spatialReference:d}=ca(a.operations.GetFeature.url,g,k.spatialReference));const {fields:w,geometryType:R,swapXY:D,objectIdField:O,geometryField:q}=await u(a,g,
d,k);return{url:a.operations.GetCapabilities.url,name:g.name,namespaceUri:g.namespaceUri,fields:w,geometryField:q,geometryType:R,objectIdField:O,spatialReference:k.spatialReference??new P({wkid:g.defaultSpatialReference}),extent:r,swapXY:D,wfsCapabilities:a,customParameters:k.customParameters}};f.parseDescribeFeatureTypeResponse=Q;f.parseGetCapabilitiesResponse=m;f.prepareWFSLayerFields=C;f.wfsOidFieldName="__esri_wfs_id__";Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/sources/geojson/geojson":function(){define("exports ../../../../core/date ../../../../core/Error ../../../../geometry/support/spatialReferenceUtils ../../OptimizedFeature ../../OptimizedGeometry ../../../support/fieldUtils".split(" "),
function(f,A,E,t,F,x,p){function*K(b){switch(b.type){case "Feature":yield b;break;case "FeatureCollection":for(const c of b.features)c&&(yield c)}}function*B(b){if(b)switch(b.type){case "Point":yield b.coordinates;break;case "LineString":case "MultiPoint":yield*b.coordinates;break;case "MultiLineString":case "Polygon":for(const c of b.coordinates)yield*c;break;case "MultiPolygon":for(const c of b.coordinates)for(const n of c)yield*n}}function*S(b,c={}){const {geometryType:n,objectIdField:u}=c;for(const C of b){const {geometry:H,
properties:y,id:Q}=C;if(H&&v[H.type]!==n)continue;b=y||{};let N=void 0;u&&(N=b[u],null==Q||N||(b[u]=N=Q));yield new F.OptimizedFeature(H?h(new x,H,c):null,b,null,N??void 0)}}function L(b){for(const c of b)if(2<c.length)return!0;return!1}function T(b){let c=0;for(let n=0;n<b.length;n++){const u=b[n],C=b[(n+1)%b.length];c+=u[0]*C[1]-C[0]*u[1]}return 0>=c}function G(b){const c=b[0],n=b[b.length-1];c[0]===n[0]&&c[1]===n[1]&&c[2]===n[2]||b.push(c);return b}function h(b,c,n){switch(c.type){case "LineString":return m(b,
c.coordinates,n),b;case "MultiLineString":for(const C of c.coordinates)m(b,C,n);return b;case "MultiPoint":return m(b,c.coordinates,n),b;case "MultiPolygon":for(var u of c.coordinates)for(P(b,u[0],n),c=1;c<u.length;c++)aa(b,u[c],n);return b;case "Point":return l(b,c.coordinates,n),b;case "Polygon":u=c.coordinates;P(b,u[0],n);for(c=1;c<u.length;c++)aa(b,u[c],n);return b}}function P(b,c,n){c=G(c);T(c)?m(b,c,n):Y(b,c,n)}function aa(b,c,n){c=G(c);T(c)?Y(b,c,n):m(b,c,n)}function m(b,c,n){for(const u of c)l(b,
u,n);b.lengths.push(c.length)}function Y(b,c,n){for(let u=c.length-1;0<=u;u--)l(b,c[u],n);b.lengths.push(c.length)}function l(b,c,n){const [u,C,H]=c;b.coords.push(u,C);n.hasZ&&b.coords.push(H||0)}const v={LineString:"esriGeometryPolyline",MultiLineString:"esriGeometryPolyline",MultiPoint:"esriGeometryMultipoint",Point:"esriGeometryPoint",Polygon:"esriGeometryPolygon",MultiPolygon:"esriGeometryPolygon"};f.createOptimizedFeatures=function(b,c){return Array.from(S(K(b),c))};f.getGeometryType=function(b){return v[b]};
f.inferLayerProperties=function(b,c={}){const n=[];var u=new Set;const C=new Set;var H=!1;let y=null,Q=!1,N=void 0;({geometryType:c=null}=c);var M=!1;for(const X of K(b)){const {geometry:V,properties:J,id:W}=X;if(V&&(c||(c=v[V.type]),v[V.type]!==c))continue;H||(H=B(V),H=L(H));!Q&&(Q=null!=W)&&(N=typeof W,J&&(y=Object.keys(J).filter(I=>J[I]===W)));J&&y&&Q&&null!=W&&(1<y.length?y=y.filter(I=>J[I]===W):1===y.length&&(y=J[y[0]]===W?y:[]));if(!M&&J){b=!0;for(const I in J){if(u.has(I))continue;M=J[I];if(null==
M){b=!1;C.add(I);continue}a:switch(typeof M){case "string":M=A.isISO8601Date(M)?"esriFieldTypeDate":"esriFieldTypeString";break a;case "number":M="esriFieldTypeDouble";break a;default:M="unknown"}if("unknown"===M){C.add(I);continue}C.delete(I);u.add(I);const ca=p.normalizeFieldName(I);ca&&n.push({name:ca,alias:I,type:M})}M=b}}if(u=p.normalizeFieldName(1===y?.length&&y[0]||null)??void 0)for(const X of n)if(X.name===u&&p.isNumericField(X)){X.type="esriFieldTypeOID";break}return{fields:n,geometryType:c,
hasZ:H,objectIdFieldName:u,objectIdFieldType:N,unknownFields:Array.from(C)}};f.validateGeoJSON=function(b,c=4326){if(!b)throw new E("geojson-layer:empty","GeoJSON data is empty");if("Feature"!==b.type&&"FeatureCollection"!==b.type)throw new E("geojson-layer:unsupported-geojson-object","missing or not supported GeoJSON object type",{data:b});({crs:b}=b);if(b){var n="string"===typeof b?b:"name"===b.type?b.properties.name:"EPSG"===b.type?b.properties.code:null;c=t.isWGS84({wkid:c})?RegExp(".*(CRS84H?|4326)$",
"i"):new RegExp(`.*(${c})$`,"i");if(!n||!c.test(n))throw new E("geojson:unsupported-crs","unsupported GeoJSON 'crs' member",{crs:b});}};Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})})},"esri/core/date":function(){define(["exports"],function(f){function A(p){const K=new Date(p);if(Number.isNaN(K.getTime()))p=!1;else{var B=!0;if(x&&/\d+\W*$/.test(p)&&(p=p.match(/[a-zA-Z]{2,}/))){B=!1;let S=0;for(;!B&&S<=p.length;)B=!F.test(p[S]),S++;B=!B}p=B}return p?Number.isNaN(K.getTime())?null:K.getTime()-
6E4*K.getTimezoneOffset():null}function E(p){p=t.exec(p);if(!p?.groups)return null;p=p.groups;const K=+p.year,B=+p.month-1,S=+p.day,L=+(p.hours??0),T=+(p.minutes??0),G=+(p.seconds??0);if(23<L||59<T||59<G)return null;var h=p.ms??"0";h=h?+h.padEnd(3,"0").substring(0,3):0;p=p.isUTC||!p.offsetSign?Date.UTC(K,B,S,L,T,G,h):6E4*("+"===p.offsetSign?-1:1)*(60*+p.offsetHours+ +p.offsetMinutes)+Date.UTC(K,B,S,L,T,G,h);return Number.isNaN(p)?null:p}const t=/^(?:(?<year>-?\d{4,})-(?<month>\d{2})-(?<day>\d{2}))(?:T(?<hours>\d{2}):(?<minutes>\d{2}):(?<seconds>\d{2})(?:\.(?<ms>\d+))?)?(?:(?<isUTC>Z)|(?:(?<offsetSign>\+|-)(?<offsetHours>\d{2}):(?<offsetMinutes>\d{2})))?$/,
F=/^((jan(uary)?)|(feb(ruary)?)|(mar(ch)?)|(apr(il)?)|(may)|(jun(e)?)|(jul(y)?)|(aug(ust)?)|(sep(tember)?)|(oct(ober)?)|(nov(ember)?)|(dec(ember)?)|(am)|(pm)|(gmt)|(utc))$/i,x=!Number.isNaN((new Date("technology 10")).getTime());f.isDateString=function(p){return null!=E(p)||null!=A(p)};f.isISO8601Date=function(p){return t.test(p)};f.parseDate=function(p){return E(p)??A(p)};Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})})},"esri/layers/ogc/xmlUtils":function(){define(["exports"],function(f){function A(t,
F){if(t&&F)for(const x of t.children)x.localName in F&&(t=F[x.localName],"function"===typeof t?(t=t(x))&&A(x,t):A(x,t))}function*E(t,F){for(const x of t.children)x.localName in F&&(t=F[x.localName],"function"===typeof t?yield t(x):yield*E(x,t))}f.iterateXML=E;f.visitXML=A;Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define("../chunks/tslib.es6 ../geometry ../PopupTemplate ../renderers/ClassBreaksRenderer ../renderers/DictionaryRenderer ../renderers/DotDensityRenderer ../renderers/HeatmapRenderer ../renderers/PieChartRenderer ../renderers/Renderer ../renderers/SimpleRenderer ../renderers/UniqueValueRenderer ../renderers/support/jsonUtils ../renderers/support/types ../core/MultiOriginJSONSupport ../core/object ../core/urlUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ../core/accessorSupport/decorators/writer ../geometry/support/typeUtils ./Layer ./graphics/sources/WFSSource ./mixins/BlendLayer ./mixins/CustomParametersMixin ./mixins/FeatureEffectLayer ./mixins/FeatureReductionLayer ./mixins/OperationalLayer ./mixins/OrderedLayer ./mixins/PortalLayer ./mixins/RefreshableLayer ./mixins/ScaleRangeLayer ./mixins/TemporalLayer ./ogc/wfsUtils ./support/commonProperties ./support/Field ./support/fieldProperties ./support/fieldUtils ./support/LabelClass ./support/labelingInfo ../rest/support/Query ../support/popupUtils ../time/timeZoneUtils ../geometry/SpatialReference ../geometry/Extent".split(" "),function(f,
A,E,t,F,x,p,K,B,S,L,T,G,h,P,aa,m,Y,l,v,b,c,n,u,C,H,y,Q,N,M,X,V,J,W,I,ca,Z,da,a,d,e,k,g,r,w,R,D){var O;A=a.defineFieldProperties();h=O=class extends X.OrderedLayer(y.CustomParametersMixin(N.FeatureReductionLayer(Q.FeatureEffectLayer(H.BlendLayer(I.TemporalLayer(J.RefreshableLayer(W.ScaleRangeLayer(M.OperationalLayer(V.PortalLayer(h.MultiOriginJSONMixin(u))))))))))){static fromWFSLayerInfo(q){const {customParameters:z,fields:U,geometryField:ba,geometryType:ea,name:fa,namespaceUri:ha,objectIdField:ia,
spatialReference:ja,swapXY:ka,url:la,wfsCapabilities:ma}=q;return new O({customParameters:z,fields:U,geometryField:ba,geometryType:ea,name:fa,namespaceUri:ha,objectIdField:ia,spatialReference:ja,swapXY:ka,url:la,wfsCapabilities:ma})}constructor(q){super(q);this.elevationInfo=this.displayField=this.definitionExpression=this.dateFieldsTimeZone=this.customParameters=this.copyright=null;this.featureUrl=void 0;this.geometryType=this.fullExtent=this.fieldsIndex=this.fields=null;this.labelsVisible=!0;this.labelingInfo=
null;this.legendEnabled=!0;this.objectIdField=null;this.operationalLayerType="WFS";this.maxFeatures=3E3;this.mode=0;this.outFields=this.namespaceUri=this.name=null;this.popupEnabled=!0;this.popupTemplate=null;this.screenSizePerspectiveEnabled=!0;this.source=new C.WFSSource({layer:this});this.spatialReference=R.WGS84;this.spatialReferences=[4326];this.swapXY=void 0;this.title="WFS";this.type="wfs";this.url=null;this.version=void 0}destroy(){this.source?.destroy()}load(q){this.addResolvingPromise(this.loadFromPortal({supportedTypes:["WFS"]},
q).then(()=>this.source.load(q)).then(()=>{this.read(this.source.sourceJSON,{origin:"service",url:this.parsedUrl});this.revert("objectIdField fields timeInfo spatialReference name namespaceUri".split(" "),"service");d.fixRendererFields(this.renderer,this.fieldsIndex);d.fixTimeInfoFields(this.timeInfo,this.fieldsIndex)}));return Promise.resolve(this)}get capabilities(){return this.source?.capabilities}get createQueryVersion(){this.commitProperty("definitionExpression");this.commitProperty("timeExtent");
this.commitProperty("timeOffset");this.commitProperty("geometryType");this.commitProperty("capabilities");return(this._get("createQueryVersion")||0)+1}get defaultPopupTemplate(){return this.createPopupTemplate()}writeFields(q,z,U){q=q.filter(ba=>ba.name!==ca.wfsOidFieldName);this.geometryField&&q.unshift(new da({name:this.geometryField,alias:this.geometryField,type:"geometry"}));P.setDeepValue(U,q.map(ba=>ba.toJSON()),z)}get parsedUrl(){return aa.urlToObject(this.url)}set renderer(q){d.fixRendererFields(q,
this.fieldsIndex);this._set("renderer",q)}get wfsCapabilities(){return this.source?.wfsCapabilities}set wfsCapabilities(q){this.source&&(this.source.wfsCapabilities=q)}createPopupTemplate(q){return r.createPopupTemplate(this,q)}createQuery(){const q=new g;q.returnGeometry=!0;q.outFields=["*"];q.where=this.definitionExpression||"1\x3d1";const {timeOffset:z,timeExtent:U}=this;q.timeExtent=null!=z&&null!=U?U.offset(-z.value,z.unit):U||null;return q}getFieldDomain(q,z){return this.getField(q)?.domain}getField(q){return this.fieldsIndex?.get(q)}queryFeatures(q,
z){return this.load().then(()=>this.source.queryFeatures(g.from(q)||this.createQuery(),z)).then(U=>{if(U?.features)for(const ba of U.features)ba.layer=ba.sourceLayer=this;return U})}queryObjectIds(q,z){return this.load().then(()=>this.source.queryObjectIds(g.from(q)||this.createQuery(),z))}queryFeatureCount(q,z){return this.load().then(()=>this.source.queryFeatureCount(g.from(q)||this.createQuery(),z))}queryExtent(q,z){return this.load().then(()=>this.source.queryExtent(g.from(q)||this.createQuery(),
z))}async hasDataChanged(){try{const {dataChanged:q,updates:z}=await this.source.refresh(this.customParameters);null!=z&&this.read(z,{origin:"service",url:this.parsedUrl,ignoreDefaults:!0});return q}catch{}return!1}};f.__decorate([m.property({readOnly:!0})],h.prototype,"capabilities",null);f.__decorate([m.property({type:String})],h.prototype,"copyright",void 0);f.__decorate([m.property({readOnly:!0})],h.prototype,"createQueryVersion",null);f.__decorate([m.property({json:{name:"wfsInfo.customParameters",
write:{overridePolicy(q){return{enabled:!!(q&&0<Object.keys(q).length),ignoreOrigin:!0}}}}})],h.prototype,"customParameters",void 0);f.__decorate([m.property(w.timeZoneProperty("dateFieldsTimeReference"))],h.prototype,"dateFieldsTimeZone",void 0);f.__decorate([m.property({readOnly:!0})],h.prototype,"defaultPopupTemplate",null);f.__decorate([m.property({type:String,json:{name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],h.prototype,"definitionExpression",void 0);f.__decorate([m.property({type:String})],
h.prototype,"displayField",void 0);f.__decorate([m.property(Z.elevationInfo)],h.prototype,"elevationInfo",void 0);f.__decorate([m.property({type:String,readOnly:!0,json:{name:"wfsInfo.featureUrl",write:{ignoreOrigin:!0,isRequired:!0}}})],h.prototype,"featureUrl",void 0);f.__decorate([m.property({type:[da],json:{name:"layerDefinition.fields",write:{ignoreOrigin:!0,isRequired:!0},origins:{service:{name:"fields"}}}})],h.prototype,"fields",void 0);f.__decorate([c.writer("fields")],h.prototype,"writeFields",
null);f.__decorate([m.property(A.fieldsIndex)],h.prototype,"fieldsIndex",void 0);f.__decorate([m.property({type:D,json:{name:"extent"}})],h.prototype,"fullExtent",void 0);f.__decorate([m.property()],h.prototype,"geometryField",void 0);f.__decorate([m.property({type:String,json:{read:{source:"layerDefinition.geometryType",reader:n.featureGeometryTypeKebabDictionary.read},write:{target:"layerDefinition.geometryType",writer:n.featureGeometryTypeKebabDictionary.write,ignoreOrigin:!0},origins:{service:{read:n.featureGeometryTypeKebabDictionary.read}}}})],
h.prototype,"geometryType",void 0);f.__decorate([m.property({type:String})],h.prototype,"id",void 0);f.__decorate([m.property(Z.labelsVisible)],h.prototype,"labelsVisible",void 0);f.__decorate([m.property({type:[e],json:{name:"layerDefinition.drawingInfo.labelingInfo",read:{reader:k.reader},write:!0}})],h.prototype,"labelingInfo",void 0);f.__decorate([m.property(Z.legendEnabled)],h.prototype,"legendEnabled",void 0);f.__decorate([m.property({type:["show","hide"]})],h.prototype,"listMode",void 0);f.__decorate([m.property({type:String})],
h.prototype,"objectIdField",void 0);f.__decorate([m.property({type:["WFS"]})],h.prototype,"operationalLayerType",void 0);f.__decorate([m.property({type:Y.Integer,json:{name:"wfsInfo.maxFeatures",write:{ignoreOrigin:!0,isRequired:!0}}})],h.prototype,"maxFeatures",void 0);f.__decorate([m.property({type:[0],readOnly:!0,json:{origins:{"web-map":{write:{ignoreOrigin:!0,isRequired:!0}}}}})],h.prototype,"mode",void 0);f.__decorate([m.property({type:String,json:{name:"wfsInfo.name",write:{ignoreOrigin:!0,
isRequired:!0}}})],h.prototype,"name",void 0);f.__decorate([m.property({type:String,json:{name:"wfsInfo.wfsNamespace",write:{ignoreOrigin:!0,isRequired:!0}}})],h.prototype,"namespaceUri",void 0);f.__decorate([m.property(Z.opacityDrawingInfo)],h.prototype,"opacity",void 0);f.__decorate([m.property(A.outFields)],h.prototype,"outFields",void 0);f.__decorate([m.property({readOnly:!0})],h.prototype,"parsedUrl",null);f.__decorate([m.property(Z.popupEnabled)],h.prototype,"popupEnabled",void 0);f.__decorate([m.property({type:E,
json:{name:"popupInfo",write:!0}})],h.prototype,"popupTemplate",void 0);f.__decorate([m.property({types:G.rendererTypes,json:{origins:{service:{name:"drawingInfo.renderer"},"web-scene":{types:G.webSceneRendererTypes,name:"layerDefinition.drawingInfo.renderer",write:!0}},name:"layerDefinition.drawingInfo.renderer",write:{ignoreOrigin:!0}}})],h.prototype,"renderer",null);f.__decorate([m.property(Z.screenSizePerspectiveEnabled)],h.prototype,"screenSizePerspectiveEnabled",void 0);f.__decorate([m.property({readOnly:!0})],
h.prototype,"source",void 0);f.__decorate([m.property({type:R,json:{name:"layerDefinition.spatialReference",write:{ignoreOrigin:!0,isRequired:!0},origins:{service:{name:"extent.spatialReference"}}}})],h.prototype,"spatialReference",void 0);f.__decorate([m.property({readOnly:!0,type:[Y.Integer],json:{name:"wfsInfo.supportedSpatialReferences",write:{ignoreOrigin:!0,isRequired:!0}}})],h.prototype,"spatialReferences",void 0);f.__decorate([m.property({type:Boolean,value:!1,json:{name:"wfsInfo.swapXY",
write:{ignoreOrigin:!0,isRequired:!0}}})],h.prototype,"swapXY",void 0);f.__decorate([m.property({json:{write:{ignoreOrigin:!0,isRequired:!0},origins:{service:{name:"name"}}}})],h.prototype,"title",void 0);f.__decorate([m.property({json:{read:!1},readOnly:!0})],h.prototype,"type",void 0);f.__decorate([m.property(Z.url)],h.prototype,"url",void 0);f.__decorate([m.property({type:String,readOnly:!0,json:{name:"wfsInfo.version",write:{ignoreOrigin:!0,isRequired:!0}}})],h.prototype,"version",void 0);f.__decorate([m.property()],
h.prototype,"wfsCapabilities",null);return h=O=f.__decorate([b.subclass("esri.layers.WFSLayer")],h)});