// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.28/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/mixins/ImageryTileMixin":function(){define("exports ../../chunks/tslib.es6 ../../geometry ../../rasterRenderers ../../request ../../core/Error ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../geometry/support/spatialReferenceUtils ../support/arcgisLayerUrl ../support/commonProperties ../support/DimensionalDefinition ../support/MultidimensionalSubset ../support/RasterFunction ../support/RasterJobHandler ../support/TileInfo ../support/rasterDatasets/FunctionRaster ../support/rasterDatasets/multidimensionalUtils ../support/rasterFunctions/clipUtils ../support/rasterFunctions/rasterFunctionHelper ../support/rasterFunctions/rasterProjectionHelper ../support/rasterFunctions/stretchUtils ../support/rasterFunctions/vectorFieldUtils ../../renderers/support/rasterRendererHelper ../../renderers/support/RasterSymbolizer ../../rest/support/ImageHistogramParameters ../../views/2d/engine/flow/dataUtils ../../geometry/SpatialReference ../../geometry/Point".split(" "),
function(m,w,z,N,D,S,Q,P,H,y,u,c,e,l,q,t,h,p,v,a,g,d,b,f,k,r,B,A,n,C,E,I,M,U){const F=Q.getLogger("esri.layers.mixins.ImageryTileMixin");m.ImageryTileMixin=x=>{function K(J){if(!J.raster||!J.rasterInfo)throw new S("imagery-tile","no raster");}x=class extends x{constructor(...J){super(...J);this._isConstructedFromFunctionRaster=!1;this._rasterJobHandler={instance:null,refCount:0,connectionPromise:null};this.copyright=this.bandIds=null;this.interpolation="nearest";this.symbolizer=this.spatialReference=
this.sourceJSON=this.rasterInfo=this.raster=this.multidimensionalSubset=null;this._isConstructedFromFunctionRaster="Function"===J[0]?.raster?.datasetFormat}get fullExtent(){return this.rasterInfo?.extent}set multidimensionalDefinition(J){this._set("multidimensionalDefinition",J);this.updateRenderer()}set rasterFunction(J){"none"===J?.functionName?.toLowerCase()&&(J=void 0);this._set("rasterFunction",J);this.updateRasterFunction()}set url(J){this._set("url",q.sanitizeUrl(J,F))}set renderer(J){null==
J&&null==this.rasterFunction?this._configDefaultRenderer("override"):(this._set("renderer",J),this.updateRenderer())}readRenderer(J,G,O){return N.read(G?.layerDefinition?.drawingInfo?.renderer,O)||void 0}async convertVectorFieldData(J,G){if(null==J||!this.rasterInfo)return null;const O=this._rasterJobHandler.instance,R=this.rasterInfo.dataType;return O?O.convertVectorFieldData({pixelBlock:J,dataType:R},G):A.convertVectorFieldData(J,R)}async computeStatisticsHistograms(J,G){J=H.ensureClass(E,J).clone();
var {rasterInfo:O}=this;const {geometry:R}=J;if(null==R)throw new S("imagery-tile-mixin:compute-statistics-histograms","geometry must be specified");var T=R;const {spatialReference:X}=O;R.spatialReference.equals(X)||(await r.load(),T="extent"===R.type?r.projectExtent(R,X):r.projectPolygon(R,X));J=J.pixelSize??new U({x:O.pixelSize.x,y:O.pixelSize.y,spatialReference:X});const {extent:L,width:V,height:W}=f.snapToRaster(O,T,J);O=await this.fetchPixels(L,V,W,{...G,interpolation:"nearest"});if(null==O.pixelBlock)throw new S("imagery-tile-mixin:compute-statistics-histograms",
"failed to fetch pixels");T=await f.clip(O.pixelBlock,L,T);return(O=this._rasterJobHandler.instance)?O.computeStatisticsHistograms({pixelBlock:T},G):B.computeStatisticsHistograms(T)}async createFlowMesh(J,G){const O=this._rasterJobHandler.instance;return O?O.createFlowMesh(J,G):I.createFlowMesh(J.meshType,J.simulationSettings,J.flowData,null!=G.signal?G.signal:(new AbortController).signal)}normalizeRasterFetchOptions(J){var {multidimensionalInfo:G}=this.rasterInfo??{};if(null==G)return J;let O=J.multidimensionalDefinition||
this.multidimensionalDefinition;O?.length||(O=b.getDefaultMultidimensionalDefinition(this.raster.rasterInfo,{multidimensionalSubset:this.multidimensionalSubset}));var R=J.timeExtent||this.timeExtent;if(null!=O&&null!=R&&(null!=R.start||null!=R.end)){O=O.map(Z=>Z.clone());var T=G.variables.find(({name:Z})=>Z===O[0].variableName)?.dimensions?.find(({name:Z})=>"StdTime"===Z);G=O.find(({dimensionName:Z})=>"StdTime"===Z);if(!T||!G)return{...J,multidimensionalDefinition:null};const {start:X,end:L}=R;R=
null==X?null:X.getTime();const V=null==L?null:L.getTime(),W=R??V,Y=V??R;if(null!=T.values)T=T.values.filter(Z=>{if(Array.isArray(Z)){if(W===Y)return Z[0]<=W&&Z[1]>=W;const aa=Z[0]>=W&&Z[1]<=Y||Z[0]<W&&Z[1]>Y;return Z[0]<=W&&Z[1]>W||Z[0]<Y&&Z[1]>=Y||aa}return W===Y?Z===W:Z>=W&&Z<=Y}),T.length?(T=T.sort((Z,aa)=>{const fa=Array.isArray(Z)?Z[0]:Z;Z=Array.isArray(Z)?Z[1]:Z;const ea=Array.isArray(aa)?aa[0]:aa;aa=Array.isArray(aa)?aa[1]:aa;return W===Y?fa-ea:Math.abs(Z-Y)-Math.abs(aa-Y)})[0],G.values=[T]):
O=null;else if(T.hasRegularIntervals&&T.extent){const [Z,aa]=T.extent;W>aa||Y<Z?O=null:G.values=W===Y?[W]:[Math.max(Z,W),Math.min(aa,Y)]}}return null!=O&&b.hasExcludedVariableOrDimension(O,this.multidimensionalSubset)?{...J,multidimensionalDefinition:null}:{...J,multidimensionalDefinition:O}}async updateRasterFunction(){if(this.loaded&&"imagery-tile"===this.type&&(this.rasterFunction||this._cachedRasterFunctionJson)&&JSON.stringify(this.rasterFunction)!==JSON.stringify(this._cachedRasterFunctionJson))if(this._isConstructedFromFunctionRaster&&
"Function"===this.raster.datasetFormat){var J=this.raster.rasterFunction.toJSON();!this.rasterFunction&&J&&this._set("rasterFunction",v.fromJSON(J));this._cachedRasterFunctionJson=this.rasterFunction?.toJSON()}else{var G=this.raster;J=!1;if("Function"===G.datasetFormat){var O=G.primaryRasters.rasters;G=O[0];J=!0}else O=[G];var {rasterFunction:R}=this;if(R){const X={raster:G};1<O.length&&O.forEach(L=>X[L.url]=L);G=k.create(R.functionDefinition?.toJSON()??R.toJSON(),X);G=new d({rasterFunction:G});G.rasterJobHandler=
this._rasterJobHandler.instance;await G.open();this._cachedRasterFunctionJson=this.rasterFunction?.toJSON();this.raster=G}else this.raster=G,this._cachedRasterFunctionJson=null,await G.when();this._cachedRendererJson=null;if(J||R){({bandIds:J}=this);var {bandCount:T}=this.raster.rasterInfo;R=J?.length?J.some(X=>X>=T):3<=T;J&&(R||this.renderer&&"raster-stretch"!==this.renderer.type)&&this._set("bandIds",null);this._configDefaultRenderer("auto")}}}async updateRenderer(){const {loaded:J,symbolizer:G}=
this;if(J&&G&&this.renderer){var {rasterInfo:O}=this.raster,R=b.getDefaultVariablInfo(O,{multidimensionalDefinition:this.multidimensionalDefinition,multidimensionalSubset:this.multidimensionalSubset})?.name,T=n.normalizeRendererJSON({...this.renderer.toJSON(),variableName:R});if(JSON.stringify(this._cachedRendererJson)!==JSON.stringify(T)){var X=this._rasterJobHandler.instance;X&&(G.rasterInfo=n.getVariableRasterInfo(O,R),G.rendererJSON=T,G.bind(),await X.updateSymbolizer(G),this._cachedRendererJson=
T)}}}async applyRenderer(J,G){var O=J?.pixelBlock;if(!(null!=O&&O.pixels&&0<O.pixels.length))return null;await this.updateRenderer();O=this._rasterJobHandler.instance;const R=this.bandIds??[];return O?await O.symbolize({...J,simpleStretchParams:G,bandIds:R}):this.symbolizer.symbolize({...J,simpleStretchParams:G,bandIds:R})}getTileUrl(J,G,O){return"RasterTileServer"===this.raster.datasetFormat?`${this.url}/tile/${J}/${G}/${O}`:""}getCompatibleTileInfo(J,G,O=!1){if(!this.loaded||null==G)return null;
if(O&&J.equals(this.spatialReference))return this.tileInfo;O=l.getInfo(J);return g.create({size:256,spatialReference:J,origin:O?{x:O.origin[0],y:O.origin[1]}:{x:G.xmin,y:G.ymax}})}getCompatibleFullExtent(J){return this.loaded?this._compatibleFullExtent&&this._compatibleFullExtent.spatialReference.equals(J)?this._compatibleFullExtent:this._compatibleFullExtent=this.raster.computeExtent(J):null}async fetchTile(J,G,O,R={}){K(this);if(R.requestAsImageElement)return J=this.getTileUrl(J,G,O),D(J,{responseType:"image",
query:{...this.refreshParameters,...this.raster.ioConfig.customFetchParameters},signal:R.signal}).then(X=>X.data);const {rasterInfo:T}=this;if(null!=T.multidimensionalInfo&&(R=this.normalizeRasterFetchOptions(R),null==R.multidimensionalDefinition))return{extent:this.raster.getTileExtentFromTileInfo(J,G,O,R.tileInfo||T.storageInfo.tileInfo),pixelBlock:null};await this._initJobHandler();await this.updateRasterFunction();"raster-shaded-relief"===this.renderer?.type&&(R={...R,buffer:{cols:1,rows:1}});
return this.raster.fetchTile(J,G,O,R)}async fetchPixels(J,G,O,R={}){if(null!=this.rasterInfo.multidimensionalInfo&&(R=this.normalizeRasterFetchOptions(R),null==R.multidimensionalDefinition))return{extent:J,pixelBlock:null};await this._initJobHandler();await this.updateRasterFunction();G=Math.round(G);O=Math.round(O);return this.raster.fetchPixels(J,G,O,R)}async identify(J,G={}){const {raster:O,rasterInfo:R}=this;if(!(null==R.multidimensionalInfo||R.hasMultidimensionalTranspose&&(b.isMultiSliceOrRangeDefinition(G.multidimensionalDefinition)||
G.transposedVariableName||G.timeExtent))&&(G=this.normalizeRasterFetchOptions(G),null==G.multidimensionalDefinition))return{location:J,value:null};const T=this.multidimensionalSubset?.areaOfInterest;if(T&&!T.contains(J))throw new S("imagery-tile-mixin:identify","the request cannot be fulfilled when falling outside of the multidimensional subset");return O.identify(J,G)}increaseRasterJobHandlerUsage(){this._rasterJobHandler.refCount++}decreaseRasterJobHandlerUsage(){this._rasterJobHandler.refCount--;
0>=this._rasterJobHandler.refCount&&this._shutdownJobHandler()}hasStandardTime(){const J=this.rasterInfo?.multidimensionalInfo;if(null==J||"standard-time"!==this.rasterInfo?.dataType)return!1;const G=this.multidimensionalDefinition,O=G?.[0]?.variableName;return J.variables.some(R=>R.name===O&&(!G?.[0].dimensionName||R.dimensions.some(T=>"StdTime"===T.name)))}getStandardTimeValue(J){return(new Date(864E5*(J-25569))).toString()}getMultidimensionalSubsetVariables(J){return b.getSubsetVariablesFromMdInfo(this.multidimensionalSubset,
J??this.rasterInfo?.multidimensionalInfo)}_configDefaultSettings(){this._configDefaultInterpolation();this.multidimensionalDefinition||(this.multidimensionalDefinition=b.getDefaultMultidimensionalDefinition(this.raster.rasterInfo,{multidimensionalSubset:this.multidimensionalSubset}));this.rasterFunction&&"Function"===this.raster.datasetFormat&&(this._cachedRasterFunctionJson=this.rasterFunction.toJSON());this._configDefaultRenderer()}_initJobHandler(){if(null!=this._rasterJobHandler.connectionPromise)return this._rasterJobHandler.connectionPromise;
const J=new a;this._rasterJobHandler.connectionPromise=J.initialize().then(async()=>{K(this);this._rasterJobHandler.instance=J;this.raster.rasterJobHandler=J;"Function"===this.raster.datasetFormat&&this.raster.syncJobHandler();this.rasterFunction&&await this.updateRasterFunction().catch(()=>{});this.renderer&&this.updateRenderer()}).catch(()=>{});return this._rasterJobHandler.connectionPromise}_shutdownJobHandler(){this._rasterJobHandler.instance&&this._rasterJobHandler.instance.destroy();this._rasterJobHandler.instance=
null;this._rasterJobHandler.connectionPromise=null;this._rasterJobHandler.refCount=0;this._cachedRendererJson=null;this.raster&&(this.raster.rasterJobHandler=null)}_configDefaultInterpolation(){if(null==this.interpolation){K(this);var {raster:J}=this;J=n.getDefaultInterpolation(J.rasterInfo,J.tileType,this.sourceJSON?.defaultResamplingMethod);this._set("interpolation",J)}}_configDefaultRenderer(J="no"){K(this);var {rasterInfo:G}=this.raster;!this.bandIds&&1<G.bandCount&&(this.bandIds=n.getDefaultBandCombination(G));
var O=b.getDefaultVariablInfo(G,{multidimensionalDefinition:this.multidimensionalDefinition,multidimensionalSubset:this.multidimensionalSubset})?.name;if(!this.renderer||"override"===J){var R=n.createDefaultRenderer(G,{bandIds:this.bandIds,variableName:O}),T=G.statistics;T=T&&0<T.length?T[0]:null;"WCSServer"===this.raster.datasetFormat&&"raster-stretch"===R.type&&(1E24<(T?.max??0)||-1E24>(T?.min??0))&&(R.dynamicRangeAdjustment=!0,R.statistics=null,"none"===R.stretchType&&(R.stretchType="min-max"));
this.renderer=R}R=n.normalizeRendererJSON({...this.renderer.toJSON(),variableName:O});G=n.getVariableRasterInfo(G,O);this.symbolizer?(this.symbolizer.rendererJSON=R,this.symbolizer.rasterInfo=G):this.symbolizer=new C({rendererJSON:R,rasterInfo:G});G=this.symbolizer.bind();G.success?"auto"===J&&({colormap:G}=this.raster.rasterInfo,J=this.renderer,null!=G&&"raster-colormap"===J.type?(G=n.createDefaultRenderer(this.raster.rasterInfo),JSON.stringify(G)!==JSON.stringify(J)&&this._configDefaultRenderer("override")):
"raster-stretch"===J.type&&(G=this.bandIds?.length,O=J.statistics?.length,!J.dynamicRangeAdjustment&&O&&G&&O!==G&&this._configDefaultRenderer("override"))):(F.warn("imagery-tile-mixin",G.error||"The given renderer is not supported by the layer."),"auto"===J&&this._configDefaultRenderer("override"))}};w.__decorate([P.property({clonable:!1})],x.prototype,"_cachedRendererJson",void 0);w.__decorate([P.property({clonable:!1})],x.prototype,"_cachedRasterFunctionJson",void 0);w.__decorate([P.property({clonable:!1})],
x.prototype,"_compatibleFullExtent",void 0);w.__decorate([P.property({clonable:!1})],x.prototype,"_isConstructedFromFunctionRaster",void 0);w.__decorate([P.property({clonable:!1})],x.prototype,"_rasterJobHandler",void 0);w.__decorate([P.property()],x.prototype,"bandIds",void 0);w.__decorate([P.property({json:{origins:{service:{read:{source:"copyrightText"}}}}})],x.prototype,"copyright",void 0);w.__decorate([P.property({json:{read:!1}})],x.prototype,"fullExtent",null);w.__decorate([P.property()],x.prototype,
"interpolation",void 0);w.__decorate([P.property()],x.prototype,"ioConfig",void 0);w.__decorate([P.property({type:[h],json:{write:!0}})],x.prototype,"multidimensionalDefinition",null);w.__decorate([P.property({type:p,json:{write:!0}})],x.prototype,"multidimensionalSubset",void 0);w.__decorate([P.property()],x.prototype,"raster",void 0);w.__decorate([P.property({type:v,json:{name:"renderingRule",write:!0}})],x.prototype,"rasterFunction",null);w.__decorate([P.property()],x.prototype,"rasterInfo",void 0);
w.__decorate([P.property()],x.prototype,"sourceJSON",void 0);w.__decorate([P.property({readOnly:!0,type:M,json:{read:!1}})],x.prototype,"spatialReference",void 0);w.__decorate([P.property({type:g})],x.prototype,"tileInfo",void 0);w.__decorate([P.property(t.url)],x.prototype,"url",null);w.__decorate([P.property({types:N.rasterRendererTypes,json:{name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy(){const J="raster-stretch"===this.renderer?.type&&"none"===this.renderer.stretchType&&!this.renderer.useGamma;
return{enabled:!this.loaded||"Raster"===this.raster.tileType||!J}}},origins:{"web-scene":{types:N.websceneRasterRendererTypes,name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy(J){return{enabled:J&&"vector-field"!==J.type&&"flow"!==J.type}}}}}}})],x.prototype,"renderer",null);w.__decorate([c.reader("renderer")],x.prototype,"readRenderer",null);w.__decorate([P.property({clonable:!1})],x.prototype,"symbolizer",void 0);return x=w.__decorate([e.subclass("esri.layers.ImageryTileMixin")],
x)};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/rasterRenderers":function(){define("exports ./core/Warning ./renderers/ClassBreaksRenderer ./renderers/FlowRenderer ./renderers/RasterColormapRenderer ./renderers/RasterShadedReliefRenderer ./renderers/RasterStretchRenderer ./renderers/UniqueValueRenderer ./renderers/VectorFieldRenderer".split(" "),function(m,w,z,N,D,S,Q,P,H){function y(l,q){if(!l)return null;if("classBreaks"===l.type&&l.classificationMethod){var t=l.authoringInfo||
{classificationMethod:""};t.classificationMethod=l.classificationMethod;l.authoringInfo=t}"vectorField"===l.type&&l.visualVariables&&!Array.isArray(l.visualVariables)&&(l.visualVariables=[l.visualVariables]);t=l?e[l.type]||null:null;if(t)return t=new t,t.read(l,q),t;q?.messages&&l&&q.messages.push(new w("renderer:unsupported","Renderers of type '"+(l.type||"unknown")+"' are not supported",{definition:l,context:q}));return null}const u={key:"type",base:null,typeMap:{"unique-value":P,"class-breaks":z,
"raster-colormap":D,"raster-stretch":Q,"vector-field":H,"raster-shaded-relief":S,flow:N}},c={...u,typeMap:{...u.typeMap}};delete c.typeMap["vector-field"];delete c.typeMap.flow;const e={uniqueValue:P,classBreaks:z,rasterStretch:Q,rasterColormap:D,vectorField:H,rasterShadedRelief:S,flowRenderer:N};m.ClassBreaksRenderer=z;m.FlowRenderer=N;m.RasterColormapRenderer=D;m.RasterShadedReliefRenderer=S;m.RasterStretchRenderer=Q;m.UniqueValueRenderer=P;m.VectorFieldRenderer=H;m.fromJSON=function(l,q){return y(l,
q)};m.rasterRendererTypes=u;m.read=y;m.websceneRasterRendererTypes=c;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/FlowRenderer":function(){define("../chunks/tslib.es6 ../Color ../core/jsonMap ../core/JSONSupport ../core/screenUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/subclass ./mixins/VisualVariablesMixin ./support/AuthoringInfo ./support/LegendOptions".split(" "),
function(m,w,z,N,D,S,Q,P,H,y,u,c,e,l){var q;z=new z.JSONMap({flow_from:"flow-from",flow_to:"flow-to"});N=q=class extends c.VisualVariablesMixin(N.JSONSupport){constructor(t){super(t);this.density=.8;this.color=new w([255,255,255,1]);this.maxPathLength=200;this.trailWidth=1.5;this.flowSpeed=10;this.trailLength=100;this.smoothing=0;this.flowRepresentation="flow-from";this.type="flow";this.legendOptions=this.authoringInfo=null;this.trailCap="butt";this.background="none"}clone(){const {density:t,maxPathLength:h,
trailWidth:p,flowSpeed:v,trailLength:a,smoothing:g,flowRepresentation:d,trailCap:b,background:f}=this,k=this.color.clone(),r=(this.visualVariables||[]).map(n=>n.clone()),B=this.authoringInfo?.clone(),A=this.legendOptions?.clone();return new q({density:t,color:k,maxPathLength:h,trailWidth:p,flowSpeed:v,trailLength:a,trailCap:b,background:f,smoothing:g,flowRepresentation:d,visualVariables:r,authoringInfo:B,legendOptions:A})}getSymbol(t,h){}async getSymbolAsync(t,h){}getSymbols(){return[]}};m.__decorate([S.property({type:Number,
json:{write:!0}})],N.prototype,"density",void 0);m.__decorate([S.property({type:w,json:{write:{allowNull:!0}}})],N.prototype,"color",void 0);m.__decorate([S.property({type:Number,cast:D.toPt,json:{write:!0}})],N.prototype,"maxPathLength",void 0);m.__decorate([S.property({type:Number,cast:D.toPt,json:{write:!0}})],N.prototype,"trailWidth",void 0);m.__decorate([S.property({type:Number,json:{write:!0}})],N.prototype,"flowSpeed",void 0);m.__decorate([S.property({type:Number,json:{write:!0}})],N.prototype,
"trailLength",void 0);m.__decorate([S.property({type:Number,cast:D.toPt,json:{write:!1}})],N.prototype,"smoothing",void 0);m.__decorate([S.property({type:z.apiValues,json:{type:z.jsonValues,read:{reader:z.read},write:{writer:z.write}}})],N.prototype,"flowRepresentation",void 0);m.__decorate([y.enumeration({flowRenderer:"flow"})],N.prototype,"type",void 0);m.__decorate([S.property({type:e,json:{write:!0}})],N.prototype,"authoringInfo",void 0);m.__decorate([S.property({type:l.LegendOptions,json:{write:!0}})],
N.prototype,"legendOptions",void 0);m.__decorate([S.property({type:String,json:{write:!0}})],N.prototype,"trailCap",void 0);m.__decorate([S.property({type:String,json:{write:!0}})],N.prototype,"background",void 0);return N=q=m.__decorate([u.subclass("esri.renderers.FlowRenderer")],N)})},"esri/renderers/RasterColormapRenderer":function(){define("../chunks/tslib.es6 ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/subclass ./support/ColormapInfo ./support/colorRampUtils".split(" "),
function(m,w,z,N,D,S,Q,P,H,y){var u;w=u=class extends w.JSONSupport{constructor(c){super(c);this.colormapInfos=null;this.type="raster-colormap"}static createFromColormap(c,e){if(!c)return null;const l=5===c[0].length;c=[...c].sort((q,t)=>q[0]-t[0]).map(q=>H.fromJSON({value:q[0],color:l?q.slice(1,5):q.slice(1,4).concat([255]),label:e?e[q[0]]??"":q[0]}));return new u({colormapInfos:c})}static createFromColorramp(c){c=y.convertColorRampToColormap(c);return u.createFromColormap(c)}clone(){return new u({colormapInfos:this.colormapInfos.map(c=>
c.toJSON())})}extractColormap(){return this.colormapInfos.map(({value:c,color:e})=>[c,e.r,e.g,e.b,1<e.a?e.a:255*e.a&255]).sort((c,e)=>c[0]-e[0])}};m.__decorate([z.property({type:[H],json:{write:!0}})],w.prototype,"colormapInfos",void 0);m.__decorate([Q.enumeration({rasterColormap:"raster-colormap"})],w.prototype,"type",void 0);return w=u=m.__decorate([P.subclass("esri.renderers.RasterColormapRenderer")],w)})},"esri/renderers/support/ColormapInfo":function(){define("../../chunks/tslib.es6 ../../Color ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(m,w,z,N,D,S,Q,P){z=class extends z.JSONSupport{constructor(){super(...arguments);this.color=this.label=this.value=null}};m.__decorate([N.property({type:Number,json:{write:!0}})],z.prototype,"value",void 0);m.__decorate([N.property({type:String,json:{write:!0}})],z.prototype,"label",void 0);m.__decorate([N.property({type:w,json:{type:[D.Integer],write:!0}})],z.prototype,"color",void 0);return z=m.__decorate([P.subclass("esri.renderers.support.ColormapInfo")],z)})},"esri/renderers/support/colorRampUtils":function(){define(["exports",
"../../Color","../../core/colorUtils","../../core/jsonMap","../../core/JSONSupport"],function(m,w,z,N,D){function S(a,g){if(!a||!g||a.length!==g.length)return!1;for(let d=0;d<a.length;d++)if(a[d]>g[d]+2||a[d]<g[d]-2)return!1;return!0}function Q(a){const g=a.clone();g.fromColor=a.toColor;g.toColor=a.fromColor;g.algorithm=a.algorithm;return g}function P(a){if("multipart"===a.type){a=a.clone();if(!a.colorRamps?.length)return a;a.colorRamps=a.colorRamps.reverse().map(g=>Q(g));return a}return Q(a)}function H(a,
g){if(a){g=g??p;var d=null;"algorithmic"===a.type?g.some(b=>{if(S(a.fromColor.toRgb(),b.fromColor)&&S(a.toColor.toRgb(),b.toColor))return d=b.id,!0}):"multipart"===a.type&&g.some(b=>{const f=a.colorRamps,k=b.colorRamps;if(f&&k&&f.length===k.length&&!k.some((r,B)=>{if(!S(f[B].fromColor.toRgb(),(new w(r.fromColor)).toRgb())||!S(f[B].toColor.toRgb(),(new w(r.toColor)).toRgb()))return!0})){if(d)return!0;d=b.id}});return d}}function y(a,g,d=!1){if(a){var b=H(a,g);null!=b||d||(a=P(a),b=H(a,g));return b}}
function u(a,g=!1){return(a="string"===typeof a?a:y(a,void 0,g))?v.toJSON(a):null}function c(a){a=a||{};const g=a.numColors||256;return{...a,numColors:g,distanceOffset:a.distanceOffset||0,interpolateAlpha:!!a.interpolateAlpha,distanceInterval:a.distanceInterval||1/(g-1),isCustomInterval:null!=a.isCustomInterval?a.isCustomInterval:null!==a.distanceInterval&&a.distanceInterval!==1/(g-1),weights:a.weights}}function e(a,g){let {fromColor:d,toColor:b}=a;d=[...d];b=[...b];3===d.length&&(d=d.concat([255]));
3===b.length&&(b=b.concat([255]));a=a.algorithm||"esriCIELabAlgorithm";var f=c(g);const {numColors:k,distanceOffset:r,isCustomInterval:B,interpolateAlpha:A}=f;if(1===k&&0===r)return[d];if(2===k&&0===r&&!B)return[d,b];var n={r:d[0],g:d[1],b:d[2]};g={r:b[0],g:b[1],b:b[2]};if("esriCIELabAlgorithm"===a){a=z.toLAB(n);g=z.toLAB(g);const {numColors:M,distanceOffset:U,distanceInterval:F,isCustomInterval:x}=f;let {l:K,a:J,b:G}=a;a=(g.l-K)*F;n=(g.a-J)*F;f=(g.b-G)*F;var C=[];if(U){var E=U/F;K+=E*a;J+=E*n;G+=
E*f}for(E=0;E<M-1;E++)C.push({l:K,a:J,b:G}),K+=a,J+=n,G+=f;C.push(x?{l:K,a:J,b:G}:g);g=C}else if("esriHSVAlgorithm"===a){a=z.toHSV(n);g=z.toHSV(g);const {numColors:M,distanceOffset:U,distanceInterval:F,isCustomInterval:x}=f;C=0===a.s;E=0===g.s;n=a.h;f=g.h;C&&!E?n=f:E&&!C&&(g={...g,h:n},f=n);C=Math.abs(f-n);180>C?f=(f-n)*F:(C=360-C,f=n>f?C*F:-C*F);C=(g.s-a.s)*F;E=(g.v-a.v)*F;let {s:K,v:J}=a;a=n;U&&(n=U/F,a=(a+n*f+360)%360,K+=n*C,J+=n*E);n=[];for(var I=0;I<M-1;I++)n.push({h:a,s:K,v:J}),a=(a+f+360)%
360,K+=C,J+=E;n.push(x?{h:a,s:K,v:J}:g);g=n}else{n=z.toLCH(n);g=z.toLCH(g);const {numColors:M,distanceOffset:U,distanceInterval:F,isCustomInterval:x}=f;f=n.h;C=g.h;a=2*Math.PI;f<=C?(E=C-f,f=C-f-a,f=Math.abs(f)<Math.abs(E)?f:E):(E=C+a-f,f=C-f,f=Math.abs(f)<Math.abs(E)?f:E);f*=F;C=(g.l-n.l)*F;E=(g.c-n.c)*F;let {l:K,c:J,h:G}=n;U&&(n=U/F,K+=n*C,J+=n*E,G=(G+n*f+a)%a);n=[];for(I=0;I<M-1;I++)n.push({l:K,c:J,h:G}),K+=C,J+=E,G=(G+f+a)%a;n.push(x?{l:K,c:J,h:G}:g);g=n}a=[];n=d[3]??255;f=((b[3]??255)-n)/(k-1);
for(C=0;C<k;C++){const {r:M,g:U,b:F}=z.toRGB(g[C]);a.push([M,U,F,A?Math.round(n+f*C):255])}return a}function l(a,g){const {numColors:d,interpolateAlpha:b}=c(g);g=g?.weights;({colorRamps:a}=a);if(g){const C=g.reduce((E,I)=>E+I);g=g.map(E=>E/C)}else{g=[];for(var f=0;f<a.length;f++)g[f]=1/a.length}f=[];let k=0,r=0;const B=1/(d-1);let A=!1;for(let C=0;C<a.length;C++){var n=A?0:k*B-r;let E=C===a.length-1?d-1-k:(g[C]-n)/B;A=Math.ceil(E)===E;E=Math.ceil(E);0!==E&&(n/=g[C],n=e(a[C],{numColors:E,interpolateAlpha:b,
distanceOffset:n,distanceInterval:B/g[C]}),k+=n.length,f.push(...n),r+=g[C])}g=[...a[a.length-1].toColor];3===g.length&&g.push(255);f.push(g);return f}function q(a,g){a=D.isSerializable(a)?a.toJSON():a;return"multipart"===a.type?l(a,g):e(a,g)}function t(a){a=z.toHSV(a);return{type:"HsvColor",Hue:a.h,Saturation:a.s,Value:a.v,AlphaValue:255}}function h(a){return{Algorithm:a.toJSON()?.Algorithm||"esriHSVAlgorithm",type:"AlgorithmicColorRamp",FromColor:t(a.fromColor),ToColor:t(a.toColor)}}const p=[{id:"aspect",
type:"multipart",colorRamps:[{fromColor:[190,190,190],toColor:[255,45,8]},{fromColor:[255,45,8],toColor:[255,181,61]},{fromColor:[255,181,61],toColor:[255,254,52]},{fromColor:[255,254,52],toColor:[0,251,50]},{fromColor:[0,251,50],toColor:[255,254,52]},{fromColor:[0,253,255],toColor:[0,181,255]},{fromColor:[0,181,255],toColor:[26,35,253]},{fromColor:[26,35,253],toColor:[255,57,251]},{fromColor:[255,57,251],toColor:[255,45,8]}]},{id:"black-to-white",fromColor:[0,0,0],toColor:[255,255,255]},{id:"blue-bright",
fromColor:[204,204,255],toColor:[0,0,224]},{id:"blue-light-to-dark",fromColor:[211,229,232],toColor:[46,100,140]},{id:"blue-green-bright",fromColor:[203,245,234],toColor:[48,207,146]},{id:"blue-green-light-to-dark",fromColor:[216,242,237],toColor:[21,79,74]},{id:"brown-light-to-dark",fromColor:[240,236,170],toColor:[102,72,48]},{id:"brown-to-blue-green-diverging-right",type:"multipart",colorRamps:[{fromColor:[156,85,31],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[33,130,145]}]},{id:"brown-to-blue-green-diverging-dark",
type:"multipart",colorRamps:[{fromColor:[110,70,45],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[48,100,102]}]},{id:"coefficient-bias",fromColor:[214,214,255],toColor:[0,57,148]},{id:"cold-to-hot-diverging",type:"multipart",colorRamps:[{fromColor:[69,117,181],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[214,47,39]}]},{id:"condition-number",type:"multipart",colorRamps:[{fromColor:[0,97,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,34,0]}]},{id:"cyan-to-purple",
type:"multipart",colorRamps:[{fromColor:[0,245,245],toColor:[0,0,245]},{fromColor:[0,0,245],toColor:[245,0,245]}]},{id:"cyan-light-to-blue-dark",type:"multipart",colorRamps:[{fromColor:[182,237,240],toColor:[31,131,224]},{fromColor:[31,131,224],toColor:[9,9,145]}]},{id:"distance",fromColor:[255,200,0],toColor:[0,0,255]},{id:"elevation1",type:"multipart",colorRamps:[{fromColor:[175,240,233],toColor:[255,255,179]},{fromColor:[255,255,179],toColor:[0,128,64]},{fromColor:[0,128,64],toColor:[252,186,3]},
{fromColor:[252,186,3],toColor:[128,0,0]},{fromColor:[120,0,0],toColor:[105,48,13]},{fromColor:[105,48,13],toColor:[171,171,171]},{fromColor:[171,171,171],toColor:[255,252,255]}]},{id:"elevation2",type:"multipart",colorRamps:[{fromColor:[118,219,211],toColor:[255,255,199]},{fromColor:[255,255,199],toColor:[255,255,128]},{fromColor:[255,255,128],toColor:[217,194,121]},{fromColor:[217,194,121],toColor:[135,96,38]},{fromColor:[135,96,38],toColor:[150,150,181]},{fromColor:[150,150,181],toColor:[181,150,
181]},{fromColor:[181,150,181],toColor:[255,252,255]}]},{id:"errors",fromColor:[255,235,214],toColor:[196,10,10]},{id:"gray-light-to-dark",fromColor:[219,219,219],toColor:[69,69,69]},{id:"green-bright",fromColor:[204,255,204],toColor:[14,204,14]},{id:"green-light-to-dark",fromColor:[220,245,233],toColor:[34,102,51]},{id:"green-to-blue",type:"multipart",colorRamps:[{fromColor:[32,204,16],toColor:[0,242,242]},{fromColor:[0,242,242],toColor:[2,33,227]}]},{id:"orange-bright",fromColor:[255,235,204],toColor:[240,
118,5]},{id:"orange-light-to-dark",fromColor:[250,233,212],toColor:[171,65,36]},{id:"partial-spectrum",type:"multipart",colorRamps:[{fromColor:[242,241,162],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]},{fromColor:[252,3,69],toColor:[176,7,237]},{fromColor:[176,7,237],toColor:[2,29,173]}]},{id:"partial-spectrum-1-diverging",type:"multipart",colorRamps:[{fromColor:[135,38,38],toColor:[240,149,12]},{fromColor:[240,149,12],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[74,
80,181]},{fromColor:[74,80,181],toColor:[39,32,122]}]},{id:"partial-spectrum-2-diverging",type:"multipart",colorRamps:[{fromColor:[115,77,42],toColor:[201,137,52]},{fromColor:[201,137,52],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[91,63,176]},{fromColor:[91,63,176],toColor:[81,13,97]}]},{id:"pink-to-yellow-green-diverging-bright",type:"multipart",colorRamps:[{fromColor:[158,30,113],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[99,110,45]}]},{id:"pink-to-yellow-green-diverging-dark",
type:"multipart",colorRamps:[{fromColor:[97,47,73],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[22,59,15]}]},{id:"precipitation",type:"multipart",colorRamps:[{fromColor:[194,82,60],toColor:[237,161,19]},{fromColor:[237,161,19],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,219,0]},{fromColor:[0,219,0],toColor:[32,153,143]},{fromColor:[32,153,143],toColor:[11,44,122]}]},{id:"prediction",type:"multipart",colorRamps:[{fromColor:[40,146,199],toColor:[250,250,100]},{fromColor:[250,
250,100],toColor:[232,16,20]}]},{id:"purple-bright",fromColor:[255,204,255],toColor:[199,0,199]},{id:"purple-to-green-diverging-bright",type:"multipart",colorRamps:[{fromColor:[77,32,150],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[20,122,11]}]},{id:"purple-to-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[67,14,89],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[24,79,15]}]},{id:"purple-blue-bright",fromColor:[223,184,230],toColor:[112,12,242]},{id:"purple-blue-light-to-dark",
fromColor:[229,213,242],toColor:[93,44,112]},{id:"purple-red-bright",fromColor:[255,204,225],toColor:[199,0,99]},{id:"purple-red-light-to-dark",fromColor:[250,215,246],toColor:[143,17,57]},{id:"red-bright",fromColor:[255,204,204],toColor:[219,0,0]},{id:"red-light-to-dark",fromColor:[255,224,224],toColor:[143,10,10]},{id:"red-to-blue-diverging-bright",type:"multipart",colorRamps:[{fromColor:[196,69,57],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[48,95,207]}]},{id:"red-to-blue-diverging-dark",
type:"multipart",colorRamps:[{fromColor:[107,13,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[13,53,97]}]},{id:"red-to-green",type:"multipart",colorRamps:[{fromColor:[245,0,0],toColor:[245,245,0]},{fromColor:[245,245,0],toColor:[0,245,0]}]},{id:"red-to-green-diverging-bright",type:"multipart",colorRamps:[{fromColor:[186,20,20],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[54,145,33]}]},{id:"red-to-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[97,21,13],toColor:[204,
204,102]},{fromColor:[204,204,102],toColor:[16,69,16]}]},{id:"slope",type:"multipart",colorRamps:[{fromColor:[56,168,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]}]},{id:"spectrum-full-bright",type:"multipart",colorRamps:[{fromColor:[255,0,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,0,255]}]},{id:"spectrum-full-dark",type:"multipart",colorRamps:[{fromColor:[153,0,0],toColor:[153,153,0]},{fromColor:[153,153,0],toColor:[0,
153,153]},{fromColor:[0,153,153],toColor:[0,0,153]}]},{id:"spectrum-full-light",type:"multipart",colorRamps:[{fromColor:[255,153,153],toColor:[255,255,153]},{fromColor:[255,255,153],toColor:[153,255,255]},{fromColor:[153,255,255],toColor:[153,153,255]}]},{id:"surface",type:"multipart",colorRamps:[{fromColor:[112,153,89],toColor:[242,238,162]},{fromColor:[242,238,162],toColor:[242,206,133]},{fromColor:[242,206,133],toColor:[194,140,124]},{fromColor:[194,140,124],toColor:[255,242,255]}]},{id:"temperature",
type:"multipart",colorRamps:[{fromColor:[255,252,255],toColor:[255,0,255]},{fromColor:[255,0,255],toColor:[0,0,255]},{fromColor:[0,0,255],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,255,0]},{fromColor:[0,255,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,128,0]},{fromColor:[255,128,0],toColor:[128,0,0]}]},{id:"white-to-black",fromColor:[255,255,255],toColor:[0,0,0]},{id:"yellow-to-dark-red",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[242,167,46]},{fromColor:[242,
167,46],toColor:[107,0,0]}]},{id:"yellow-to-green-to-dark-blue",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[56,224,9]},{fromColor:[56,224,9],toColor:[26,147,171]},{fromColor:[26,147,171],toColor:[12,16,120]}]},{id:"yellow-to-red",fromColor:[245,245,0],toColor:[255,0,0]},{id:"yellow-green-bright",fromColor:[236,252,204],toColor:[157,204,16]},{id:"yellow-green-light-to-dark",fromColor:[215,240,175],toColor:[96,107,45]}],v=new N.JSONMap({Aspect:"aspect","Black to White":"black-to-white",
"Blue Bright":"blue-bright","Blue Light to Dark":"blue-light-to-dark","Blue-Green Bright":"blue-green-bright","Blue-Green Light to Dark":"blue-green-light-to-dark","Brown Light to Dark":"brown-light-to-dark","Brown to Blue Green Diverging, Bright":"brown-to-blue-green-diverging-right","Brown to Blue Green Diverging, Dark":"brown-to-blue-green-diverging-dark","Coefficient Bias":"coefficient-bias","Cold to Hot Diverging":"cold-to-hot-diverging","Condition Number":"condition-number","Cyan to Purple":"cyan-to-purple",
"Cyan-Light to Blue-Dark":"cyan-light-to-blue-dark",Distance:"distance","Elevation #1":"elevation1","Elevation #2":"elevation2",Errors:"errors","Gray Light to Dark":"gray-light-to-dark","Green Bright":"green-bright","Green Light to Dark":"green-light-to-dark","Green to Blue":"green-to-blue","Orange Bright":"orange-bright","Orange Light to Dark":"orange-light-to-dark","Partial Spectrum":"partial-spectrum","Partial Spectrum 1 Diverging":"partial-spectrum-1-diverging","Partial Spectrum 2 Diverging":"partial-spectrum-2-diverging",
"Pink to YellowGreen Diverging, Bright":"pink-to-yellow-green-diverging-bright","Pink to YellowGreen Diverging, Dark":"pink-to-yellow-green-diverging-dark",Precipitation:"precipitation",Prediction:"prediction","Purple Bright":"purple-bright","Purple to Green Diverging, Bright":"purple-to-green-diverging-bright","Purple to Green Diverging, Dark":"purple-to-green-diverging-dark","Purple-Blue Bright":"purple-blue-bright","Purple-Blue Light to Dark":"purple-blue-light-to-dark","Purple-Red Bright":"purple-red-bright",
"Purple-Red Light to Dark":"purple-red-light-to-dark","Red Bright":"red-bright","Red Light to Dark":"red-light-to-dark","Red to Blue Diverging, Bright":"red-to-blue-diverging-bright","Red to Blue Diverging, Dark":"red-to-blue-diverging-dark","Red to Green":"red-to-green","Red to Green Diverging, Bright":"red-to-green-diverging-bright","Red to Green Diverging, Dark":"red-to-green-diverging-dark",Slope:"slope","Spectrum-Full Bright":"spectrum-full-bright","Spectrum-Full Dark":"spectrum-full-dark","Spectrum-Full Light":"spectrum-full-light",
Surface:"surface",Temperature:"temperature","White to Black":"white-to-black","Yellow to Dark Red":"yellow-to-dark-red","Yellow to Green to Dark Blue":"yellow-to-green-to-dark-blue","Yellow to Red":"yellow-to-red","Yellow-Green Bright":"yellow-green-bright","Yellow-Green Light to Dark":"yellow-green-light-to-dark"});m.colorRampDict=v;m.convertColorRampToColormap=function(a,g){a=q(a,g);const d=g?.interpolateAlpha;a.forEach((b,f)=>{b.unshift(f);d||b.pop()});return a};m.convertColorRampToColors=q;m.convertRGBATo32Bit=
function(a){a=a.reverse().map(g=>{g=g.toString(16);return 2>g.length?"0"+g:g});return 4294967295&Number.parseInt(a.join(""),16)};m.getColorRampId=y;m.getColorRampJSON=function(a,g="esriCIELabAlgorithm"){const d=p.find(({id:b})=>b===a);return d?d.colorRamps?{type:"multipart",colorRamps:d.colorRamps.map(b=>({type:"algorithmic",algorithm:g,fromColor:[...b.fromColor],toColor:[...b.toColor]}))}:{type:"algorithmic",algorithm:g,fromColor:[...d.fromColor],toColor:[...d.toColor]}:null};m.getColorRampName=
u;m.getRFxArgColorRampValue=function(a){const g=u(a);return g?"algorithmic"===a.type?{...h(a),Name:g}:a.colorRamps?(a=a.colorRamps.map(h),{type:"MultiPartColorRamp",NumColorRamps:a.length,ArrayOfColorRamp:a,Name:g}):null:null};m.predefinedJsonColorRamps=p;m.rasterColormapNames="random ndvi ndvi2 ndvi3 elevation gray hillshade".split(" ");Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/core/colorUtils":function(){define(["exports","../Color","../chunks/vec4","../chunks/vec4f64"],
function(m,w,z,N){function D(h,p){const v=[];let a,g;if(h[0].length!==p.length)throw Error("dimensions do not match");const d=h.length,b=h[0].length;let f=0;for(a=0;a<d;a++){for(g=f=0;g<b;g++)f+=h[a][g]*p[g];v.push(f)}return v}function S(h){h=[h.r/255,h.g/255,h.b/255].map(p=>.04045>=p?p/12.92:((p+.055)/1.055)**2.4);h=D(q,h);return{x:100*h[0],y:100*h[1],z:100*h[2]}}function Q(h){h=D(t,[h.x/100,h.y/100,h.z/100]).map(p=>Math.min(1,Math.max(.0031308>=p?12.92*p:1.055*p**(1/2.4)-.055,0)));return{r:Math.round(255*
h[0]),g:Math.round(255*h[1]),b:Math.round(255*h[2])}}function P(h){h=[h.x/95.047,h.y/100,h.z/108.883].map(p=>p>(6/29)**3?p**(1/3):1/3*(29/6)**2*p+4/29);return{l:116*h[1]-16,a:500*(h[0]-h[1]),b:200*(h[1]-h[2])}}function H(h){const p=h.l;h=[(p+16)/116+h.a/500,(p+16)/116,(p+16)/116-h.b/200].map(v=>v>6/29?v**3:3*(6/29)**2*(v-4/29));return{x:95.047*h[0],y:100*h[1],z:108.883*h[2]}}function y(h){if("r"in h&&"g"in h&&"b"in h)return h;if("l"in h&&"c"in h&&"h"in h){var p=h.c,v=h.h;return Q(H({l:h.l,a:p*Math.cos(v),
b:p*Math.sin(v)}))}if("l"in h&&"a"in h&&"b"in h)return Q(H(h));if("x"in h&&"y"in h&&"z"in h)return Q(h);if("h"in h&&"s"in h&&"v"in h){v=(h.h+360)%360/60;p=h.v/100*255;h=h.s/100*p;const a=h*(1-Math.abs(v%2-1));switch(Math.floor(v)){case 0:v={r:h,g:a,b:0};break;case 1:v={r:a,g:h,b:0};break;case 2:v={r:0,g:h,b:a};break;case 3:v={r:0,g:a,b:h};break;case 4:v={r:a,g:0,b:h};break;case 5:case 6:v={r:h,g:0,b:a};break;default:v={r:0,g:0,b:0}}v.r=Math.round(v.r+p-h);v.g=Math.round(v.g+p-h);v.b=Math.round(v.b+
p-h);return v}return h}function u(h){if("h"in h&&"s"in h&&"v"in h)return h;var p=y(h);h=p.r;const v=p.g,a=p.b;p=Math.max(h,v,a);const g=p-Math.min(h,v,a);h=0===g?0:p===h?(v-a)/g%6:p===v?(a-h)/g+2:(h-v)/g+4;0>h&&(h+=6);return{h:60*h,s:100*(0===g?0:g/p),v:100/255*p}}function c(h){return"l"in h&&"a"in h&&"b"in h?h:P(S(y(h)))}function e(h){let {r:p,g:v,b:a,a:g}=h;1>g&&(p=Math.round(g*p+255*(1-g)),v=Math.round(g*v+255*(1-g)),a=Math.round(g*a+255*(1-g)));return new w({r:p,g:v,b:a})}function l(h,p){const {r:v,
g:a,b:g}=p?.ignoreAlpha?h:e(h);return.2126*v+.7152*a+.0722*g}const q=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],t=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];m.BrightnessThreshold=void 0;(function(h){h[h.Low=160]="Low";h[h.High=225]="High"})(m.BrightnessThreshold||(m.BrightnessThreshold={}));m.colorEquals=function(h,p){return h===p||null!=h&&h.equals(p)};m.colorVectorEquals=function(h,p){return h===p||null!=h&&null!=p&&z.equals(h,p)};m.colorVectorToColorAndOpacity=
function(h){return N.fromValues(h[0],h[1],h[2],3<h.length?h[3]:1)};m.darken=function(h,p){var v=c(h);v.l*=1-p;p=y(v);v=h.clone();v.setColor(p);v.a=h.a;return v};m.desaturate=function(h,p){var v=u(h);v.s*=p;p=y(v);v=h.clone();v.setColor(p);v.a=h.a;return v};m.getColorLuminance=l;m.getColorTheme=function(h){return e(h).isBright?"light":"dark"};m.getContrast=function(h,p=m.BrightnessThreshold.High){return l(h,{ignoreAlpha:!0})>p?new w([0,0,0,h.a]):new w([255,255,255,h.a])};m.multiplyOpacity=function(h,
p){h=h.clone();h.a*=p;return h};m.multiplyOpacityToUnitRGBA=function(h,p){h=w.toUnitRGBA(h);h[3]*=p;return h};m.toHSV=u;m.toLAB=c;m.toLCH=function(h){if(!("l"in h&&"c"in h&&"h"in h)){var p=P(S(y(h)));h=p.l;var v=p.a;const a=p.b;p=Math.sqrt(v*v+a*a);v=Math.atan2(a,v);v=0<v?v:v+2*Math.PI;h={l:h,c:p,h:v}}return h};m.toRGB=y;m.unitRGBAFromColor=function(h){return w.toUnitRGBA(h)};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/RasterShadedReliefRenderer":function(){define("../chunks/tslib.es6 ../core/JSONSupport ../core/lang ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../rest/support/colorRamps".split(" "),
function(m,w,z,N,D,S,Q,P,H){var y;w=y=class extends w.JSONSupport{constructor(u){super(u);this.altitude=45;this.azimuth=315;this.colorRamp=null;this.hillshadeType="traditional";this.pixelSizePower=.664;this.pixelSizeFactor=.024;this.scalingType="none";this.type="raster-shaded-relief";this.zFactor=1}readColorRamp(u){return H.fromJSON(u)}clone(){return new y({hillshadeType:this.hillshadeType,altitude:this.altitude,azimuth:this.azimuth,zFactor:this.zFactor,scalingType:this.scalingType,pixelSizeFactor:this.pixelSizeFactor,
pixelSizePower:this.pixelSizePower,colorRamp:z.clone(this.colorRamp)})}};m.__decorate([N.property({type:Number,json:{write:!0}})],w.prototype,"altitude",void 0);m.__decorate([N.property({type:Number,json:{write:!0}})],w.prototype,"azimuth",void 0);m.__decorate([N.property({types:H.types,json:{write:!0}})],w.prototype,"colorRamp",void 0);m.__decorate([Q.reader("colorRamp")],w.prototype,"readColorRamp",null);m.__decorate([N.property({type:["traditional","multi-directional"],json:{write:!0}})],w.prototype,
"hillshadeType",void 0);m.__decorate([N.property({type:Number,json:{write:!0}})],w.prototype,"pixelSizePower",void 0);m.__decorate([N.property({type:Number,json:{write:!0}})],w.prototype,"pixelSizeFactor",void 0);m.__decorate([N.property({type:["none","adjusted"],json:{write:!0}})],w.prototype,"scalingType",void 0);m.__decorate([S.enumeration({rasterShadedRelief:"raster-shaded-relief"})],w.prototype,"type",void 0);m.__decorate([N.property({type:Number,json:{write:!0}})],w.prototype,"zFactor",void 0);
return w=y=m.__decorate([P.subclass("esri.renderers.RasterShadedReliefRenderer")],w)})},"esri/renderers/RasterStretchRenderer":function(){define("../chunks/tslib.es6 ../core/JSONSupport ../core/lang ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../core/accessorSupport/decorators/writer ./support/stretchRendererUtils ../rest/support/colorRamps".split(" "),
function(m,w,z,N,D,S,Q,P,H,y,u){var c;w=c=class extends w.JSONSupport{constructor(e){super(e);this.colorRamp=null;this.dynamicRangeAdjustment=this.computeGamma=!1;this.gamma=[];this.sigmoidStrengthLevel=this.outputMin=this.outputMax=this.numberOfStandardDeviations=this.minPercent=this.maxPercent=null;this.statistics=[];this.histograms=null;this.useGamma=!1;this.stretchType="none";this.type="raster-stretch"}readColorRamp(e){if(e)return u.fromJSON(e)}writeStatistics(e,l,q){e?.length&&(Array.isArray(e[0])||
(e=e.map(t=>[t.min,t.max,t.avg,t.stddev])),l[q]=e)}readStretchType(e,l){e=l.stretchType;"number"===typeof e&&(e=y.stretchTypeFunctionEnum[e]);return y.stretchTypeJSONDict.read(e)}clone(){return new c({stretchType:this.stretchType,outputMin:this.outputMin,outputMax:this.outputMax,useGamma:this.useGamma,computeGamma:this.computeGamma,statistics:z.clone(this.statistics),gamma:z.clone(this.gamma),sigmoidStrengthLevel:this.sigmoidStrengthLevel,numberOfStandardDeviations:this.numberOfStandardDeviations,
minPercent:this.minPercent,maxPercent:this.maxPercent,colorRamp:z.clone(this.colorRamp),histograms:z.clone(this.histograms),dynamicRangeAdjustment:this.dynamicRangeAdjustment})}};m.__decorate([N.property({types:u.types,json:{write:!0}})],w.prototype,"colorRamp",void 0);m.__decorate([Q.reader("colorRamp")],w.prototype,"readColorRamp",null);m.__decorate([N.property({type:Boolean,json:{write:!0}})],w.prototype,"computeGamma",void 0);m.__decorate([N.property({type:Boolean,json:{write:{target:"dra"},read:{source:"dra"}}})],
w.prototype,"dynamicRangeAdjustment",void 0);m.__decorate([N.property({type:[Number],json:{write:!0}})],w.prototype,"gamma",void 0);m.__decorate([N.property({type:Number,json:{write:!0}})],w.prototype,"maxPercent",void 0);m.__decorate([N.property({type:Number,json:{write:!0}})],w.prototype,"minPercent",void 0);m.__decorate([N.property({type:Number,json:{write:!0}})],w.prototype,"numberOfStandardDeviations",void 0);m.__decorate([N.property({type:Number,json:{read:{source:"max"},write:{target:"max"}}})],
w.prototype,"outputMax",void 0);m.__decorate([N.property({type:Number,json:{read:{source:"min"},write:{target:"min"}}})],w.prototype,"outputMin",void 0);m.__decorate([N.property({type:Number,json:{write:!0}})],w.prototype,"sigmoidStrengthLevel",void 0);m.__decorate([N.property({json:{type:[[Number]],write:!0}})],w.prototype,"statistics",void 0);m.__decorate([N.property()],w.prototype,"histograms",void 0);m.__decorate([H.writer("statistics")],w.prototype,"writeStatistics",null);m.__decorate([N.property({type:Boolean,
json:{write:!0}})],w.prototype,"useGamma",void 0);m.__decorate([N.property({type:y.stretchTypeJSONDict.apiValues,json:{type:y.stretchTypeJSONDict.jsonValues,write:y.stretchTypeJSONDict.write}})],w.prototype,"stretchType",void 0);m.__decorate([Q.reader("stretchType",["stretchType"])],w.prototype,"readStretchType",null);m.__decorate([S.enumeration({rasterStretch:"raster-stretch"})],w.prototype,"type",void 0);return w=c=m.__decorate([P.subclass("esri.renderers.RasterStretchRenderer")],w)})},"esri/renderers/support/stretchRendererUtils":function(){define(["exports",
"../../core/jsonMap"],function(m,w){w=new w.JSONMap({none:"none",standardDeviation:"standard-deviation",histogramEqualization:"histogram-equalization",minMax:"min-max",percentClip:"percent-clip",sigmoid:"sigmoid"});m.stretchTypeFunctionEnum={0:"none",3:"standardDeviation",4:"histogramEqualization",5:"minMax",6:"percentClip",9:"sigmoid"};m.stretchTypeJSONDict=w;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/VectorFieldRenderer":function(){define("../chunks/tslib.es6 ../Color ../geometry ../Graphic ../symbols ../core/jsonMap ../core/JSONSupport ../core/lang ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../geometry/support/normalizeUtils ../layers/support/rasterFunctions/vectorFieldUtils ./ClassBreaksRenderer ./mixins/VisualVariablesMixin ./support/ClassBreakInfo ./visualVariables/RotationVariable ./visualVariables/SizeVariable ./visualVariables/support/visualVariableUtils ../symbols/SimpleLineSymbol ../symbols/SimpleMarkerSymbol ../symbols/support/utils ../geometry/Point ../symbols/PictureMarkerSymbol".split(" "),
function(m,w,z,N,D,S,Q,P,H,y,u,c,e,l,q,t,h,p,v,a,g,d,b,f,k,r){var B;const A=new Set(["esriMetersPerSecond","esriKilometersPerHour","esriKnots","esriFeetPerSecond","esriMilesPerHour"]);z=new S.JSONMap({beaufort_ft:"beaufort-ft",beaufort_km:"beaufort-km",beaufort_kn:"beaufort-kn",beaufort_m:"beaufort-m",beaufort_mi:"beaufort-mi",classified_arrow:"classified-arrow",ocean_current_kn:"ocean-current-kn",ocean_current_m:"ocean-current-m",simple_scalar:"simple-scalar",single_arrow:"single-arrow",wind_speed:"wind-barb"});
S=new S.JSONMap({flow_from:"flow-from",flow_to:"flow-to"});Q=B=class extends h.VisualVariablesMixin(Q.JSONSupport){constructor(n){super(n);this.attributeField="Magnitude";this.flowRepresentation="flow-from";this.rotationType="arithmetic";this.style="single-arrow";this.symbolTileSize=50;this.type="vector-field"}readInputUnit(n,C){return A.has(n)?q.unitKebabDict.fromJSON(n):null}readOutputUnit(n,C){return A.has(n)?q.unitKebabDict.fromJSON(n):null}get styleRenderer(){const n=this.attributeField,C=this._createStyleRenderer(this.style);
C.field=n;return C}get sizeVariables(){const n=[];if(this.visualVariables)for(var C of this.visualVariables)"size"===C.type&&n.push(C);0===n.length&&(C=new a({field:"Magnitude",minSize:.2*this.symbolTileSize,maxSize:.8*this.symbolTileSize}),this.visualVariables?this.visualVariables.push(C):this._set("visualVariables",[C]),n.push(C));return n}get rotationVariables(){const n=[];if(this.visualVariables)for(var C of this.visualVariables)"rotation"===C.type&&n.push(C);0===n.length&&(C=new v({field:"Direction",
rotationType:this.rotationType}),this.visualVariables?this.visualVariables.push(C):this._set("visualVariables",[C]),n.push(C));return n}clone(){return new B({attributeField:this.attributeField,flowRepresentation:this.flowRepresentation,rotationType:this.rotationType,symbolTileSize:this.symbolTileSize,style:this.style,visualVariables:P.clone(this.visualVariables),inputUnit:this.inputUnit,outputUnit:this.outputUnit})}async getGraphicsFromPixelData(n,C=!1,E=[]){const I=[];var M=q.getUnitConversionFactor(this.inputUnit,
this.outputUnit),U=this.rotationVariables[0]?.rotationType||this.rotationType;C=C?q.convertVectorFieldData(n.pixelBlock,"vector-uv",U,M):q.convertVectorFieldUnit(n.pixelBlock,"vector-magdir",M);if(null==C)return I;n=n.extent;M=null!=C.mask&&0<C.mask.length;U=0;const F=(n.xmax-n.xmin)/C.width,x=(n.ymax-n.ymin)/C.height;for(let J=0;J<C.height;J++)for(let G=0;G<C.width;G++,U++){let O=new k({x:n.xmin+G*F+F/2,y:n.ymax-J*x-x/2,spatialReference:n.spatialReference});O=(await l.normalizeCentralMeridian(O))[0];
var K=E.some(R=>R.intersects(O));M&&!C.mask[U]||K||(K=new N({geometry:{type:"point",x:O.x,y:O.y,spatialReference:n.spatialReference},attributes:{Magnitude:C.pixels[0][U],Direction:C.pixels[1][U]}}),K.symbol=this._getVisualVariablesAppliedSymbol(K),I.push(K))}return I}getSymbol(n,C){}async getSymbolAsync(n,C){}getSymbols(){return[]}getClassBreakInfos(){return this.styleRenderer?.classBreakInfos}getDefaultSymbol(){return this.styleRenderer?.defaultSymbol}_getDefaultSymbol(n){return new b({path:"M14,32 14,18 9,23 16,3 22,23 17,18 17,32 z",
outline:new d({width:0}),size:20,color:n||new w([0,92,230])})}_getVisualVariablesAppliedSymbol(n){if(n){var C=this.styleRenderer?.getSymbol(n)?.clone(),E=this.sizeVariables,I=this.rotationVariables;E&&E.length&&this.sizeVariables.forEach(M=>f.applySizesToSymbol(C,g.getAllSizes([M],n)));I&&I.length&&(n.attributes.Direction+="flow-to"===this.flowRepresentation===("ocean-current-kn"===this.style||"ocean-current-m"===this.style)?0:180,this.rotationVariables.forEach(M=>f.applyRotationToSymbol(C,g.getRotationAngle(M,
n),M.axis)));return C}}_createStyleRenderer(n){let C={defaultSymbol:this._getDefaultSymbol(),classBreakInfos:[]};switch(n){case "single-arrow":C=this._createSingleArrowRenderer();break;case "beaufort-kn":C=this._createBeaufortKnotsRenderer();break;case "beaufort-m":C=this._createBeaufortMeterRenderer();break;case "beaufort-ft":C=this._createBeaufortFeetRenderer();break;case "beaufort-mi":C=this._createBeaufortMilesRenderer();break;case "beaufort-km":C=this._createBeaufortKilometersRenderer();break;
case "ocean-current-m":C=this._createCurrentMeterRenderer();break;case "ocean-current-kn":C=this._createCurrentKnotsRenderer();break;case "simple-scalar":C=this._createSimpleScalarRenderer();break;case "wind-barb":C=this._createWindBarbsRenderer();break;case "classified-arrow":C=this._createClassifiedArrowRenderer()}return new t(C)}_createSingleArrowRenderer(){return{defaultSymbol:this._getDefaultSymbol()}}_createBeaufortKnotsRenderer(){const n=this._getDefaultSymbol(new w([214,47,39])),C=this._getClassBreaks([0,
1,3,6,10,16,21,27,33,40,47,55,63],[[40,146,199],[89,162,186],[129,179,171],[160,194,155],[191,212,138],[218,230,119],[250,250,100],[252,213,83],[252,179,102],[250,141,52],[247,110,42],[240,71,29]]);return{defaultSymbol:n,classBreakInfos:C}}_createBeaufortMeterRenderer(){const n=this._getDefaultSymbol(new w([214,47,39])),C=this._getClassBreaks([0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7],[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,
220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]]);return{defaultSymbol:n,classBreakInfos:C}}_createBeaufortFeetRenderer(){const n=this._getDefaultSymbol(new w([214,47,39]));var C=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];C=C.map(E=>3.28084*E);C=this._getClassBreaks(C,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]]);return{defaultSymbol:n,classBreakInfos:C}}_createBeaufortMilesRenderer(){const n=
this._getDefaultSymbol(new w([214,47,39]));var C=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];C=C.map(E=>2.23694*E);C=this._getClassBreaks(C,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]]);return{defaultSymbol:n,classBreakInfos:C}}_createBeaufortKilometersRenderer(){const n=this._getDefaultSymbol(new w([214,47,39]));var C=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,
32.7];C=C.map(E=>3.6*E);C=this._getClassBreaks(C,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]]);return{defaultSymbol:n,classBreakInfos:C}}_createCurrentMeterRenderer(){const n=this._getDefaultSymbol(new w([177,177,177])),C=this._getClassBreaks([0,.5,1,1.5,2],[[78,26,153],[179,27,26],[202,128,26],[177,177,177]]);return{defaultSymbol:n,classBreakInfos:C}}_createCurrentKnotsRenderer(){const n=
this._getDefaultSymbol(new w([177,177,177])),C=this._getClassBreaks([0,.25,.5,1,1.5,2,2.5,3,3.5,4],[[0,0,0],[0,37,100],[78,26,153],[151,0,100],[179,27,26],[177,78,26],[202,128,26],[177,179,52],[177,177,177]]);return{defaultSymbol:n,classBreakInfos:C}}_createClassifiedArrowRenderer(){const n=this._getDefaultSymbol(new w([56,168,0]));var C=[0,1E-6,3.5,7,10.5,14];if(this.sizeVariables?.length){const E=this.sizeVariables[0].minDataValue,I=this.sizeVariables[0].maxDataValue;if(E&&I){const M=(I-E)/5;C=
Array.from(Array(6).keys()).map(U=>E+M*U)}}C=this._getClassBreaks(C,[[56,168,0],[139,309,0],[255,255,0],[255,128,0],[255,0,0]]);return{defaultSymbol:n,classBreakInfos:C}}_createSimpleScalarRenderer(){return{defaultSymbol:r.fromJSON({imageData:"iVBORw0KGgoAAAANSUhEUgAAACsAAAArCAQAAABLVLlLAAAABGdBTUEAAYagMeiWXwAAAAJiS0dEAACqjSMyAAAACXBIWXMAAABIAAAASABGyWs+AAAC3ElEQVRIx9XXvW4cVRQH8N982btpsIREJECyiCXsxX4DKh6AliqGKCBBE2SlwlHgAbBD/AKmyEYUeQ1KahPZSZQvBCkQLTHZ7KGY8Xodz4w3a1NwbzVzz/znfJ//zbStVC5q3icKak9GAs2QIdDx3PtW/S011NW3p+M5Eomh11ipTIKe6+4LQzHaQ+G+63pIZNJJQXMpljwTwj1brpgx5w1zZlyx5Z4QnllEIm2xeeSUHBf0hV0bejo1Uh09G3aFvgXk7cCJFBc9EdaRVuHJJaOdKyTV2TVhYLMduNR0Q9gxL5GaaTDw8GzejrDRBpxWoGsySRW0dttKuattwNkIlFw2YXgzOdYq4Ox49PlM+JrKd5OusjTWhBuVxUfMX/KXXZ3WEmkuqa67wspR4BTbwtKr/5u4fFgStse/T7EifFPnnYl9zPq4vmUOPrRndgoHjDti1gOPqlyXoifcRNGQzUd31lDyfHmob1Gp35vSr+P6vilcQ5Egtyd8YF/ySg9NhPM+9M/IOaHwp5+PSZayXTvCogEUwlatC3J8LLwYtcWB8EuDXQVuCkV5/B4eNHb7wGBs87LBDS+xjdVSn09wq1G8dFM+9tSUhIGneLvUdniKxKpTYljCpu3j7rVWlHj/P23v4NPGUEyeCQnexe9lJjzEQqMjJs+EzNAX6B98dBZVRmroJx95x/A/6gln18EyfCUsl+qdXb/tjvfbw+mwforpUOBz4XLVoBwAn3aWnfeH246NyBXhrq7TTN5lNSP9RkU+puUJm3W2Tsdq0nZWM07srk7MwQrZSRysjjGWBLRJNsNbfj2JMR4AbxpU1XLAb9Mxfpsq5EjMuuiR8L0JiHOOBX3hiUvOmavN0nMueSzcceFk0BK4pMqLo7vDD1Z0qrtDx7Itt4Xwm9UqbMmk8S0Dtuzb2pvOU99Z1nLTOfleNmvfZfP2pYZmPfajwosKdDBNpacNpVGGsWX9CyDI8Xq/Sj6QAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE0LTExLTEwVDAzOjE3OjU4LTA1OjAwF+tHyQAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMFQwMzoxNzo1OC0wNTowMGa2/3UAAAAASUVORK5CYII\x3d",
height:20,width:20,type:"esriPMS",angle:0})}}_createWindBarbsRenderer(){const n=Array.from(Array(31).keys()).map(M=>5*M),C=[{range:"0-5",path:"M20 20 M5 20 A15 15 0 1 0 35 20 A15 15 0 1 0 5 20 M20 20 M10 20 A10 10 0 1 0 30 20 A10 10 0 1 0 10 20",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTIwIDIwIE01IDIwIEExNSAxNSAwIDEgMCAzNSAyMCBBMTUgMTUgMCAxIDAgNSAyMCBNMjAgMjAgTTEwIDIwIEExMCAxMCAwIDEgMCAzMCAyMCBBMTAgMTAgMCAxIDAgMTAgMjAiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},
{range:"5-10",path:"M25 0 L25 40 M25 35 L17.5 37.5",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNyA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTTI1IDM1IEwxNy41IDM3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"10-15",path:"M25 0 L25 40 L10 45 L25 40",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNyA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTDEwIDQ1IEwyNSA0MCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},
{range:"15-20",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L17.5 37.5",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjEyIDAgMTUgNDUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxNy41IDM3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"20-25",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNiA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTDEwIDQ1IEwyNSA0MCBNMjUgMzUgTDEwIDQwIiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},
{range:"25-30",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L17.5 32.5",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNiA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTDEwIDQ1IEwyNSA0MCBNMjUgMzUgTDEwIDQwIEwyNSAzNSBNMjUgMzAgTDE3LjUgMzIuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"30-35",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},
{range:"35-40",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxNy41IDI3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"40-45",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"45-50",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxNy41IDIyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},
{range:"50-55",path:"M25 0 L25 40 L10 40 L25 35",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"55-60",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L17.5 32.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxNy41IDMyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},
{range:"60-65",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"65-70",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxNy41IDI3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},
{range:"70-75",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"75-80",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxNy41IDIyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"80-85",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},
{range:"85-90",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L17.5 17.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSBMMjUgMjAgTTI1IDE1IEwxNy41IDE3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"90-95",
path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSBMMjUgMjAgTTI1IDE1IEwxMCAyMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"95-100",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20 L25 15 M25 10 L17.5 12.5",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSBMMjUgMjAgTTI1IDE1IEwxMCAyMCBMMjUgMTUgTTI1IDEwIEwxNy41IDEyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"100-105",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},
{range:"105-110",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L17.5 27.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDE3LjUgMjcuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"110-115",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},
{range:"115-120",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L17.5 22.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDE3LjUgMjIuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"120-125",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"125-130",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L17.5 17.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDE3LjUgMTcuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},
{range:"130-135",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"135-140",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIE0yNSAxNSBNMjUgMTAgTDE3LjUgMTIuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"140-145",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIE0yNSAxNSBNMjUgMTAgTDEwIDE1IiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"145-150",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIE0yNSAxNSBNMjUgMTAgTDEwIDE1IE0yNSAxMCBNMjUgNSBMMTcuNSA3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"}],E=r.fromJSON({imageData:"iVBORw0KGgoAAAANSUhEUgAAACgAAAApCAQAAADtq6NDAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJiS0dEAP+Hj8y/AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAEY0lEQVRIx5XXWWxWRRQH8N+d+31tUdGAVjGglYJABFEBY91jfDAg7piYaFTccA++uMQEFRcSXlATtxiXqMQt4G4iisYl0ai4sIQYtVFZ1KIFKdTS0l4f7vRCS5fPebozc+bM/2z/Mzcx0AgSiUxXnKfIdMn875FIhX53U2n/B/s+kKM4UINTjTBZImixxnrv+9a2iL6zEoUBXcoudrWj/OtHm3wt02lfU9Qao9OnHvIhgmww84MEl1qnxfNmGrqHxAizLdPpC6chGcAxKGGcL+30gOERf1BSpUqVslQSV8d5ReZFe8VQ9avufJn31cWwlJV7iafKStGOE/1qvfH9qUxxu8ydUdmuSKbGO8YUdT2inKLG69pM70tliktl5qIkCAJGmusDG7Vqsc0WjZa4UBlBiA5YZIcjYzB7qDtH5kaUJFLs7RGZTZ42W4PRRmtwvbdt1+wGiaS4drEtDttdZYIDNVuAclR3vA3+dI3qHqmVSy7U6Tv1MScCPvPR7nIpFlsdCy3FdTLPGhK92e2CUITjMJ9ocwKxnsZqc3O3JwMma3d6UVLnyVxB4aXemZqvPqLdpJhW3KVVbY4yYImPo6M5Urv50fj+0z/FG9YaEiENs8UtMfXUaTeTePNHlhXfA1UU+2lyD1Il3Gtt9+adfpNG7dNlpg2U/T3KYLZ2dUWFdTgp3/rQ4sK973qnInV5TIf40x3dhvrJPBiqyWUo4wAtLqhQYS71qK+QKOFRywmGK/kpikzV6WMKhh58vGWs4TIJNjiEYLIuP8Tt4/zmLyqk+AyrJSbF+Qq1DgqRUPMxyl+9q3IQhX/rMCJ6tEunriDs1oSyQZKlr9AkhT2ZIARbJfaJS1vtVbHB+Rgi0RK/y1q1BWsEEyLoz40xtGKcARPVWB1BTPO7f4LNtpkUl1aoMbViLyZo0GRjPD3BxnxjqXeLYlvhqYrzMMG3HoyJXa3JjfnGlbYYFlP7Jh3qKsKY4hQ7TY0nG+xwRL61n63mxHtqNHosigyMLmClNwvuecFnOZB88nNBDzNkzhxEZaKMBVoKapggMzvHHXBEpNSSFAvtcFRsVn0bW8LlMmcXs+c0Kne3gRR32+zg4uXwjC6zit6Wt4a8LXVfcp/MtQXHn2ynGbuCmb8GvvFeJLEE82ReU9/n6+dkq2x3buG9Wn94smcgAw631RPR7BTH+kbmHReZoEpOdEe7zWqZl40s0JWs9Hmv7hjBHqPDwsjGKVJnWWqjbdZp1KhJi0aPmxYZsIRhlttgeF+Jlke41QcOQKoqilSb6HJzSvNG3G/UoWnxwsmt+sVaYwd63dRbqdnMyCPVeyRPvpYgdavM22oGKoMUVRbJfOWMwidJ8Zzb1UvmWK/VVUXzHaTjjrVYh1897HT7xxYEVUaa5SWb/WO+YUWa9SrwvigzM8YlzlYv2GSdVCYxxlBtVnnFq5olwp5/BEk/OLsf5LUmG2+inRJdVvjZ97ZH9/zP34ug1O91pf4p+D+JYBpvrKxfbwAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNC0xMS0xMFQwMzoxMjowOS0wNTowMB9ViV0AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTBUMDM6MTI6MDktMDU6MDBuCDHhAAAAAElFTkSuQmCC",
height:20,width:20,type:"esriPMS",angle:0}),I=n.map((M,U)=>{if(U!==n.length-1)if(0===U)var F={minValue:M,maxValue:n[U+1],symbol:E};else F=r.fromJSON({type:"esriPMS",imageData:C[U].imageData,contentType:"image/svg+xml",height:32,width:32,angle:0}),F={minValue:M,maxValue:n[U+1],symbol:F};return new p(F)});return{defaultSymbol:E,classBreakInfos:I}}_getClassBreaks(n,C){return C.map((E,I)=>new p({minValue:n[I],maxValue:n[I+1],symbol:this._getDefaultSymbol(new w(E))}))}};m.__decorate([H.property({type:String,
json:{write:!0}})],Q.prototype,"attributeField",void 0);m.__decorate([H.property({type:S.apiValues,json:{type:S.jsonValues,read:{reader:S.read},write:{writer:S.write}}})],Q.prototype,"flowRepresentation",void 0);m.__decorate([H.property({type:["geographic","arithmetic"],json:{write:!0}})],Q.prototype,"rotationType",void 0);m.__decorate([H.property({type:z.apiValues,json:{type:z.jsonValues,read:{reader:z.read},write:{writer:z.write}}})],Q.prototype,"style",void 0);m.__decorate([H.property({json:{write:!0}})],
Q.prototype,"symbolTileSize",void 0);m.__decorate([H.property({type:q.unitKebabDict.apiValues,json:{type:q.unitKebabDict.jsonValues,write:{writer:q.unitKebabDict.write}}})],Q.prototype,"inputUnit",void 0);m.__decorate([c.reader("inputUnit")],Q.prototype,"readInputUnit",null);m.__decorate([H.property({type:q.unitKebabDict.apiValues,json:{type:q.unitKebabDict.jsonValues,read:{reader:q.unitKebabDict.read},write:{writer:q.unitKebabDict.write}}})],Q.prototype,"outputUnit",void 0);m.__decorate([c.reader("outputUnit")],
Q.prototype,"readOutputUnit",null);m.__decorate([u.enumeration({vectorField:"vector-field"})],Q.prototype,"type",void 0);m.__decorate([H.property({type:t})],Q.prototype,"styleRenderer",null);m.__decorate([H.property({type:a})],Q.prototype,"sizeVariables",null);m.__decorate([H.property({type:v})],Q.prototype,"rotationVariables",null);return Q=B=m.__decorate([e.subclass("esri.renderers.VectorFieldRenderer")],Q)})},"esri/layers/support/rasterFunctions/vectorFieldUtils":function(){define(["exports","../../../core/jsonMap",
"../PixelBlock","./pixelUtils"],function(m,w,z,N){function D(f,k){return t.get(f)/t.get(k)||1}function S(f,k="geographic"){const [r,B]=f;f=Math.sqrt(r*r+B*B);let A=Math.atan2(B,r)*h;A=(360+A)%360;"geographic"===k&&(A=(450-A)%360);return[f,A]}function Q(f,k="geographic"){let r=f[1];"geographic"===k&&(r=(450-r)%360);r%=360;f=f[0];return[f*Math.cos(r/h),f*Math.sin(r/h)]}function P(f,k,r="geographic",B=1){if(!N.isValidPixelBlock(f))return f;const {pixels:A,width:n,height:C}=f;var E=n*C;const I=A[0],M=
A[1],U=f.pixelType.startsWith("f")?f.pixelType:"f32",F=z.createEmptyBand(U,E);E=z.createEmptyBand(U,E);let x=0;for(let K=0;K<C;K++)for(let J=0;J<n;J++)"vector-uv"===k?([F[x],E[x]]=S([I[x],M[x]],r),F[x]*=B):([F[x],E[x]]=Q([I[x],M[x]],r),F[x]*=B,E[x]*=B),x++;f=new z({pixelType:U,width:f.width,height:f.height,mask:f.mask,validPixelCount:f.validPixelCount,maskIsAlpha:f.maskIsAlpha,pixels:[F,E]});f.updateStatistics();return f}function H(f=0,k=0,r=Math.PI,B=!0){B&&(r=(2*Math.PI-r)%(2*Math.PI));B=B?-1:1;
const A=-7*B,n=-2*B,C=-16*B,[E,I]=u(0,k+13*B,r,21.75),[M,U]=u(f-5.5,k+A,r,21.75),[F,x]=u(f+5.5,k+A,r,21.75),[K,J]=u(f-1.5,k+n,r,21.75),[G,O]=u(f+1.5,k+n,r,21.75),[R,T]=u(f-1.5,k+C,r,21.75),[X,L]=u(f+1.5,k+C,r,21.75);return[E,I,M,U,K,J,G,O,F,x,R,T,X,L]}function y(f=0,k=Math.PI,r=!0){r&&(k=(2*Math.PI-k)%(2*Math.PI));var B=r?-1:1,A=5*B;const n=20*B,C=25*B;B*=2;const E=r?1:-1;r=5*E;let [I,M]=[0+r,0-n],[U,F]=[I+2*E,M],[x,K]=[U-0*E,F+B],[J,G]=[0-r,0-C],[O,R]=[J+0*E,G-B],T=Math.ceil(f/5),X=Math.floor(T/
10);T-=8*X;f=[];const L=[];for(let ja=0;ja<T/2;ja++,X--){0>=X&&1===T%2&&ja===(T-1)/2&&(J=0,O=J+0*E,G=(G+M)/2,R=G-B);const [la,oa]=u(J,G,k,45);if(0<X){const [pa,qa]=u(U,G,k,45),[ra,sa]=u(I,M,k,45);f.push(pa);f.push(qa);f.push(la);f.push(oa);f.push(ra);f.push(sa)}else{const [pa,qa]=u(U,F,k,45),[ra,sa]=u(x,K,k,45),[ua,ma]=u(O,R,k,45);L.push(la);L.push(oa);L.push(ua);L.push(ma);L.push(ra);L.push(sa);L.push(pa);L.push(qa)}G+=A;M+=A;F+=A;K+=A;R+=A}const [V,W]=u(0+r,0+n,k,45);A=7*E;const [Y,Z]=u(0+A,0+n,
k,45),[aa,fa]=u(0+r,0-C,k,45),[ea,ca]=u(0+A,0-C,k,45);return{pennants:f,barbs:L,shaft:[V,W,Y,Z,aa,fa,ea,ca]}}function u(f,k,r,B=1){return[Math.sqrt(f*f+k*k)/B,(2*Math.PI+(2*Math.PI+Math.atan2(k,f))%(2*Math.PI)-r)%(2*Math.PI)]}function c(f,k,r,B){r=D(B||"knots",r);for(B=1;B<k.length;B++)if(B===k.length-1){if(f<k[B]*r)break}else if(f<=k[B]*r)break;return Math.min(B-1,k.length-2)}function e(f,k,r,B,A){let n=0;switch(k){case "beaufort_kn":n=c(f,a,"knots",r);break;case "beaufort_km":n=c(f,a,"kilometer-per-hour",
r);break;case "beaufort_ft":n=c(f,a,"feet-per-second",r);break;case "beaufort_m":n=c(f,a,"meter-per-second",r);break;case "classified_arrow":n=c(f,A??[],B,r);break;case "ocean_current_m":n=c(f,g,"meter-per-second",r);break;case "ocean_current_kn":n=c(f,d,"knots",r)}return n}function l(f,k){const {style:r,inputUnit:B,outputUnit:A,breakValues:n}=k,C=p.fromJSON(B),E=p.fromJSON(A);let I=0,M=0;const {width:U,height:F,mask:x}=f,K=f.pixels[0];f=f.pixels[1];var J=null!=x?x.filter(R=>0<R).length:U*F;const G=
new Float32Array(42*J);J=new Uint32Array(15*J);k=k.invertDirection?H(0,0,0,!1):v;for(let R=0;R<F;R++)for(let T=0;T<U;T++){var O=R*U+T;if(!x||x[R*U+T]){const X=(f[O]+360)%360/180*Math.PI,L=e(K[O],r,C,E,n);for(let V=0;V<k.length;V+=2)G[I++]=(T+.5)/U,G[I++]=(R+.5)/F,G[I++]=k[V],G[I++]=k[V+1]+X,G[I++]=L,G[I++]=K[O];O=7*(I/42-1);J[M++]=O;J[M++]=O+1;J[M++]=O+2;J[M++]=O+0;J[M++]=O+4;J[M++]=O+3;J[M++]=O+0;J[M++]=O+2;J[M++]=O+3;J[M++]=O+2;J[M++]=O+5;J[M++]=O+3;J[M++]=O+5;J[M++]=O+6;J[M++]=O+3}}return{vertexData:G,
indexData:J}}function q(f,k){let r=0,B=0;const {width:A,height:n,mask:C}=f;f=f.pixels[0];const E=[],I=[];var M=p.fromJSON(k.inputUnit);M=D(M,"knots");k="wind_speed"===k.style?5:Number.MAX_VALUE;for(let F=0;F<n;F++)for(let x=0;x<A;x++){var U=f[F*A+x]*M;if((!C||C[F*A+x])&&U<k){for(let K=0;4>K;K++)E[r++]=(x+.5)/A,E[r++]=(F+.5)/n,E[r++]=2>K?-.5:.5,E[r++]=0===K%2?-.5:.5,E[r++]=0,E[r++]=U;U=4*(r/24-1);I[B++]=U;I[B++]=U+1;I[B++]=U+2;I[B++]=U+1;I[B++]=U+2;I[B++]=U+3}}return{vertexData:new Float32Array(E),
indexData:new Uint32Array(I)}}const t=new Map;t.set("meter-per-second",1);t.set("kilometer-per-hour",.277778);t.set("knots",.514444);t.set("feet-per-second",.3048);t.set("mile-per-hour",.44704);const h=180/Math.PI,p=new w.JSONMap({esriMetersPerSecond:"meter-per-second",esriKilometersPerHour:"kilometer-per-hour",esriKnots:"knots",esriFeetPerSecond:"feet-per-second",esriMilesPerHour:"mile-per-hour"}),v=H(0,0,0),a=[0,1,3,6,10,16,21,27,33,40,47,55,63],g=[0,.5,1,1.5,2],d=[0,.25,.5,1,1.5,2,2.5,3,3.5,4],
b=[];m.convertToLocalDirections=function(f,k,r,B="geographic"){if(!N.isValidPixelBlock(f)||null==r)return f;f="vector-magdir"===k?f.clone():P(f,k);const A=f.pixels[1];for(let n=0;n<A.length;n++)A[n]="geographic"===B?(A[n]+r[n]+270)%360:(A[n]+360-r[n])%360;return"vector-magdir"===k?f:P(f,"vector-magdir")};m.convertVectorFieldData=P;m.convertVectorFieldUnit=function(f,k,r=1){if(1===r||!N.isValidPixelBlock(f))return f;f=f.clone();const {pixels:B,width:A,height:n}=f,C=B[0],E=B[1];let I=0;for(let M=0;M<
n;M++)for(let U=0;U<A;U++)"vector-uv"===k?(C[I]*=r,E[I]*=r):C[I]*=r,I++;f.updateStatistics();return f};m.createVFMesh=function(f,k){if("simple_scalar"===k.style)k=q(f,k);else if("wind_speed"===k.style){if(0===b.length)for(var r=0;30>r;r++)b.push(y(5*r,0,!k.invertDirection));k=p.fromJSON(k.inputUnit);k=D(k,"knots");const {width:C,height:E,mask:I}=f;r=f.pixels[0];f=f.pixels[1];const M=[],U=[];let F=0,x=0;for(let K=0;K<E;K++)for(let J=0;J<C;J++){var B=K*C+J,A=r[B]*k;if((!I||I[K*C+J])&&5<=A){const G=
(f[B]+360)%360/180*Math.PI,{pennants:O,barbs:R,shaft:T}=b[Math.min(Math.floor(A/5),29)];if(0===O.length+R.length)continue;B=M.length/6;const X=(J+.5)/C,L=(K+.5)/E;for(var n=0;n<O.length;n+=2)M[F++]=X,M[F++]=L,M[F++]=O[n],M[F++]=O[n+1]+G,M[F++]=0,M[F++]=A;for(n=0;n<R.length;n+=2)M[F++]=X,M[F++]=L,M[F++]=R[n],M[F++]=R[n+1]+G,M[F++]=0,M[F++]=A;for(n=0;n<T.length;n+=2)M[F++]=X,M[F++]=L,M[F++]=T[n],M[F++]=T[n+1]+G,M[F++]=0,M[F++]=A;for(A=0;A<O.length/6;A++)U[x++]=B,U[x++]=B+1,U[x++]=B+2,B+=3;for(A=0;A<
R.length/8;A++)U[x++]=B,U[x++]=B+1,U[x++]=B+2,U[x++]=B+1,U[x++]=B+2,U[x++]=B+3,B+=4;U[x++]=B+0;U[x++]=B+1;U[x++]=B+2;U[x++]=B+1;U[x++]=B+3;U[x++]=B+2;B+=4}}k={vertexData:new Float32Array(M),indexData:new Uint32Array(U)}}else k=l(f,k);return k};m.createVFMeshScalar=q;m.getUnitConversionFactor=D;m.sampleVectorField=function(f,k,r,B=[0,0],A=.5){const {width:n,height:C,mask:E}=f,[I,M]=f.pixels,[U,F]=B;f=Math.round((n-U)/r);B=Math.round((C-F)/r);var x=f*B;const K=new Float32Array(x),J=new Float32Array(x);
x=new Uint8Array(x);k="vector-uv"===k;for(let O=0;O<B;O++)for(let R=0;R<f;R++){let T=0;const X=O*f+R,L=Math.max(0,O*r+F),V=Math.max(0,R*r+U),W=Math.min(C,L+r),Y=Math.min(n,V+r);for(let Z=L;Z<W;Z++)for(let aa=V;aa<Y;aa++){var G=Z*n+aa;if(!E||E[G]){T++;G=k?[I[G],M[G]]:[I[G],(360+M[G])%360];const [fa,ea]=k?G:Q(G);K[X]+=fa;J[X]+=ea}}if(T>=(W-L)*(Y-V)*(1-A)){x[X]=1;const [Z,aa]=S([K[X]/T,J[X]/T]);K[X]=Z;J[X]=aa}else x[X]=0,K[X]=0,J[X]=0}r=new z({width:f,height:B,pixels:[K,J],mask:x});r.updateStatistics();
return r};m.snapImageToSymbolTile=function(f,k,r,B,A){if(null==A||!A.spatialReference.equals(f.spatialReference))return{extent:f,width:Math.round(k/B),height:Math.round(r/B),resolution:f.width/k};const n=A.xmin;A=A.ymax;k=(f.xmax-f.xmin)/k*B;r=(f.ymax-f.ymin)/r*B;f.xmin=n+Math.floor((f.xmin-n)/k)*k;f.xmax=n+Math.ceil((f.xmax-n)/k)*k;f.ymin=A+Math.floor((f.ymin-A)/r)*r;f.ymax=A+Math.ceil((f.ymax-A)/r)*r;return{extent:f,width:Math.round(f.width/k),height:Math.round(f.height/r),resolution:(k+r)/2}};
m.unitKebabDict=p;m.uvComponentToVector=S;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/PixelBlock":function(){define("../../chunks/tslib.es6 ../../core/Error ../../core/JSONSupport ../../core/lang ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/subclass ./SimpleBandStatistics ./rasterFormats/pixelRangeUtils".split(" "),function(m,w,z,N,D,S,Q,P,H,y){var u;z=u=class extends z.JSONSupport{static createEmptyBand(c,
e){return new (u.getPixelArrayConstructor(c))(e)}static getPixelArrayConstructor(c){let e;switch(c){case "u1":case "u2":case "u4":case "u8":e=Uint8Array;break;case "u16":e=Uint16Array;break;case "u32":e=Uint32Array;break;case "s8":e=Int8Array;break;case "s16":e=Int16Array;break;case "s32":e=Int32Array;break;case "f32":e=Float32Array;break;case "f64":e=Float64Array;break;case "c64":case "c128":case "unknown":e=Float32Array}return e}constructor(c){super(c);this.height=this.width=null;this.pixelType=
"f32";this.mask=this.validPixelCount=null;this.premultiplyAlpha=this.maskIsAlpha=!1;this.statistics=null;this.depthCount=1}castPixelType(c){if(!c)return"f32";c=c.toLowerCase();["u1","u2","u4"].includes(c)?c="u8":"unknown u8 s8 u16 s16 u32 s32 f32 f64".split(" ").includes(c)||(c="f32");return c}getPlaneCount(){return this.pixels?.length}addData(c){if(!c.pixels||c.pixels.length!==this.width*this.height)throw new w("pixelblock:invalid-or-missing-pixels","add data requires valid pixels array that has same length defined by pixel block width * height");
this.pixels||(this.pixels=[]);this.statistics||(this.statistics=[]);this.pixels.push(c.pixels);this.statistics.push(c.statistics??new H.SimpleBandStatistics)}getAsRGBA(){const c=new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case "s8":case "s16":case "u16":case "s32":case "u32":case "f32":case "f64":this._fillFromNon8Bit(c);break;default:this._fillFrom8Bit(c)}return new Uint8ClampedArray(c)}getAsRGBAFloat(){const c=new Float32Array(this.width*this.height*4);this._fillFrom32Bit(c);
return c}updateStatistics(){if(this.pixels){this.statistics=this.pixels.map(l=>this._calculateBandStatistics(l,this.mask));var c=this.mask,e=0;if(null!=c)for(let l=0;l<c.length;l++)c[l]&&e++;else e=this.width*this.height;this.validPixelCount=e}}clamp(c){if(c&&"f64"!==c&&"f32"!==c&&this.pixels){var [e,l]=y.getPixelValueRange(c),q=this.pixels,t=this.width*this.height,h=q.length,p=[];for(let d=0;d<h;d++){var v=u.createEmptyBand(c,t);var a=q[d];for(let b=0;b<t;b++){var g=a[b];v[b]=g>l?l:g<e?e:g}p.push(v)}this.pixels=
p;this.pixelType=c}}extractBands(c){const {pixels:e,statistics:l}=this;if(null==c||0===c.length||!e||0===e.length)return this;var q=e.length,t=c.some(d=>d>=e.length),h=q===c.length&&!c.some((d,b)=>d!==b);if(t||h)return this;q=this.bandMasks?.length===q?c.map(d=>this.bandMasks[d]):void 0;let {mask:p,validPixelCount:v}=this;const {width:a,height:g}=this;if(q){if(1===q.length)p=q[0];else for(t=a*g,p=(new Uint8Array(t)).fill(255),h=0;h<q.length;h++){const d=q[h];for(let b=0;b<t;b++)d[b]||(p[b]=0)}v=p.filter(d=>
!!d).length}return new u({pixelType:this.pixelType,width:a,height:g,mask:p,bandMasks:q,validPixelCount:v,maskIsAlpha:this.maskIsAlpha,pixels:c.map(d=>e[d]),statistics:l&&c.map(d=>l[d])})}clone(){const c=new u({width:this.width,height:this.height,pixelType:this.pixelType,maskIsAlpha:this.maskIsAlpha,validPixelCount:this.validPixelCount});null!=this.mask&&(c.mask=this.mask instanceof Uint8Array?new Uint8Array(this.mask):this.mask.slice(0));this.bandMasks&&(c.bandMasks=this.bandMasks.map(q=>new Uint8Array(q)));
let e;const l=u.getPixelArrayConstructor(this.pixelType);if(this.pixels&&0<this.pixels.length){c.pixels=[];const q=!!this.pixels[0].slice;for(e=0;e<this.pixels.length;e++)c.pixels[e]=q?this.pixels[e].slice(0,this.pixels[e].length):new l(this.pixels[e])}if(this.statistics)for(c.statistics=[],e=0;e<this.statistics.length;e++)c.statistics[e]=N.clone(this.statistics[e]);c.premultiplyAlpha=this.premultiplyAlpha;return c}_fillFrom8Bit(c){const {mask:e,maskIsAlpha:l,premultiplyAlpha:q,pixels:t}=this;if(c&&
t?.length){var h,p;var v=h=p=t[0];3<=t.length?(h=t[1],p=t[2]):2===t.length&&(h=t[1]);var a=new Uint32Array(c),g=this.width*this.height;if(v.length!==g)D.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");else if(null!=e&&e.length===g)if(l)for(c=0;c<g;c++){const d=e[c];if(d){const b=d/255;a[c]=q?d<<24|p[c]*b<<16|h[c]*b<<8|v[c]*b:d<<24|p[c]<<16|h[c]<<8|v[c]}}else for(c=0;c<g;c++)e[c]&&(a[c]=-16777216|p[c]<<16|h[c]<<8|v[c]);else for(c=0;c<g;c++)a[c]=-16777216|
p[c]<<16|h[c]<<8|v[c]}else D.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")}_fillFromNon8Bit(c){const {pixels:e,mask:l,statistics:q}=this;if(c&&e?.length){var t=this.pixelType,h=1,p=0;h=1;if(q&&0<q.length){for(var v of q)null!=v.minValue&&(p=Math.min(p,v.minValue)),null!=v.maxValue&&null!=v.minValue&&(h=Math.max(h,v.maxValue-v.minValue));h=255/h}else h=255,"s8"===t?(p=-128,h=127):"u16"===t?h=65535:"s16"===t?(p=-32768,h=32767):"u32"===t?h=4294967295:
"s32"===t?(p=-2147483648,h=2147483647):"f32"===t?(p=-3.4*1E39,h=3.4*1E39):"f64"===t&&(p=-Number.MAX_VALUE,h=Number.MAX_VALUE),h=255/(h-p);c=new Uint32Array(c);t=this.width*this.height;var a,g,d;v=a=g=e[0];if(v.length!==t)return D.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");if(2<=e.length)if(a=e[1],3<=e.length&&(g=e[2]),null!=l&&l.length===t)for(d=0;d<t;d++)l[d]&&(c[d]=-16777216|(g[d]-p)*h<<16|(a[d]-p)*h<<8|(v[d]-p)*h);else for(d=0;d<t;d++)c[d]=-16777216|
(g[d]-p)*h<<16|(a[d]-p)*h<<8|(v[d]-p)*h;else if(null!=l&&l.length===t)for(d=0;d<t;d++)a=(v[d]-p)*h,l[d]&&(c[d]=-16777216|a<<16|a<<8|a);else for(d=0;d<t;d++)a=(v[d]-p)*h,c[d]=-16777216|a<<16|a<<8|a}else D.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")}_fillFrom32Bit(c){const {pixels:e,mask:l}=this;if(!c||!e?.length)return D.getLogger(this).error("getAsRGBAFloat()","Unable to convert to RGBA. The input pixel block is empty.");let q,t,h,p;q=t=h=e[0];
3<=e.length?(t=e[1],h=e[2]):2===e.length&&(t=e[1]);const v=this.width*this.height;if(q.length!==v)return D.getLogger(this).error("getAsRGBAFloat()","Unable to convert to RGBA. The pixelblock is invalid.");let a=0;if(null!=l&&l.length===v)for(p=0;p<v;p++)c[a++]=q[p],c[a++]=t[p],c[a++]=h[p],c[a++]=l[p]&1;else for(p=0;p<v;p++)c[a++]=q[p],c[a++]=t[p],c[a++]=h[p],c[a++]=1}_calculateBandStatistics(c,e){let l=Infinity,q=-Infinity;const t=c.length;let h,p=0;if(null!=e)for(h=0;h<t;h++)e[h]&&(p=c[h],l=p<l?
p:l,q=p>q?p:q);else for(h=0;h<t;h++)p=c[h],l=p<l?p:l,q=p>q?p:q;return new H.SimpleBandStatistics(l,q)}};m.__decorate([S.property({json:{write:!0}})],z.prototype,"width",void 0);m.__decorate([S.property({json:{write:!0}})],z.prototype,"height",void 0);m.__decorate([S.property({json:{write:!0}})],z.prototype,"pixelType",void 0);m.__decorate([Q.cast("pixelType")],z.prototype,"castPixelType",null);m.__decorate([S.property({json:{write:!0}})],z.prototype,"validPixelCount",void 0);m.__decorate([S.property({json:{write:!0}})],
z.prototype,"mask",void 0);m.__decorate([S.property({json:{write:!0}})],z.prototype,"maskIsAlpha",void 0);m.__decorate([S.property({json:{write:!0}})],z.prototype,"pixels",void 0);m.__decorate([S.property()],z.prototype,"premultiplyAlpha",void 0);m.__decorate([S.property({json:{write:!0}})],z.prototype,"statistics",void 0);m.__decorate([S.property({json:{write:!0}})],z.prototype,"depthCount",void 0);m.__decorate([S.property({json:{write:!0}})],z.prototype,"noDataValues",void 0);m.__decorate([S.property({json:{write:!0}})],
z.prototype,"bandMasks",void 0);return z=u=m.__decorate([P.subclass("esri.layers.support.PixelBlock")],z)})},"esri/layers/support/SimpleBandStatistics":function(){define(["exports"],function(m){class w{constructor(z=null,N=null,D=null){this.minValue=z;this.maxValue=N;this.noDataValue=D}}m.SimpleBandStatistics=w;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/pixelRangeUtils":function(){define(["exports"],function(m){function w(N){return z[N]??[-3.4028234663852886E38,
3.4028234663852886E38]}const z={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-3.4028234663852886E38,3.4028234663852886E38],f64:[-Number.MAX_VALUE,Number.MAX_VALUE],unknown:void 0,c64:void 0,c128:void 0};m.convertNoDataToMask=function(N,D,S){if(!(N.depthCount&&1<N.depthCount)){var {pixels:Q,statistics:P,pixelType:H}=N,y=Q[0].length,u=N.bandMasks??[];y=N.mask??(new Uint8Array(y)).fill(255);var c="f32"===H||
"f64"===H,e=w(H),l=!1;for(let h=0;h<Q.length;h++){const p="number"===typeof D?D:D[h];if(null==p)continue;var q=P?.[h]?.maxValue??e[1];if((P?.[h]?.minValue??e[0])>p+Number.EPSILON||q<p-Number.EPSILON)continue;q=u[h]||y.slice();const v=Q[h];var t=S?.customFloatTolerance;if(c&&0!==t){t||(t=9.999999E37<=Math.abs(p)?2E-7*Math.abs(p):"f32"===H?2**-23:Number.EPSILON);for(let a=0;a<v.length;a++)q[a]&&Math.abs(v[a]-p)<t&&(v[a]=0,q[a]=0,y[a]=0,l=!0)}else for(t=0;t<v.length;t++)q[t]&&v[t]===p&&(v[t]=0,q[t]=
0,y[t]=0,l=!0);u[h]=q}l&&(N.bandMasks=N.bandMasks||1<N.pixels.length?u:null,N.mask=y);l&&"updateStatistics"in N&&N.updateStatistics()}};m.getPixelValueRange=w;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/pixelUtils":function(){define(["exports","../PixelBlock","../rasterFormats/pixelRangeUtils"],function(m,w,z){function N(a){return null!=a&&"esri.layers.support.PixelBlock"===a.declaredClass&&a.pixels&&0<a.pixels.length}function D(a,g,d,b,f){const k=
a.length;f=w.createEmptyBand(f,k);if(g)for(let r=0;r<k;r++)g[r]&&(f[r]=d[a[r]-b]);else for(g=0;g<k;g++)f[g]=d[a[g]-b];return f}function S(a,g,d,b){const f=null!=d&&2<=d.length?new Set(d):null;d=1===d?.length?d[0]:null;const k=!!g?.length;for(let r=0;r<a.length;r++)if(b[r]){const B=a[r];if(k){let A=!1;for(let n=0;n<g.length;n+=2)if(B>=g[n]&&B<=g[n+1]){A=!0;break}A||(b[r]=0)}b[r]&&(B===d||f?.has(B))&&(b[r]=0)}}function Q(a,g){const d=a[0].length;for(let b=0;b<d;b++)if(g[b]){let f=!1;for(let k=0;k<a.length;k++)if(a[k][b]){f=
!0;break}f||(g[b]=0)}}function P(a,g){const d=a[0].length;for(let b=0;b<d;b++)if(g[b]){let f=!1;for(let k=0;k<a.length;k++)if(0===a[k][b]){f=!0;break}f&&(g[b]=0)}}function H(a,g,d,b,f,k,r,B){return{xmin:f<=d*a?0:f<d*a+a?f-d*a:a,ymin:k<=b*g?0:k<b*g+g?k-b*g:g,xmax:f+r<=d*a?0:f+r<d*a+a?f+r-d*a:a,ymax:k+B<=b*g?0:k+B<b*g+g?k+B-b*g:g}}function y(a,g,d,b,f,k){const {width:r,height:B}=d.block,{x:A,y:n}=d.offset,{width:C,height:E}=d.mosaic;d=H(r,B,b,f,A,n,C,E);let I=0;var M=0;if(k){var U=k.hasGCSSShiftTransform?
360:k.halfWorldWidth??0,F=r*k.resolutionX;const x=k.startX+b*F;x<U&&x+F>U?M=k.rightPadding:x>=U&&(I=k.leftMargin-k.rightPadding,M=0)}d.xmax-=M;if("number"===typeof g)for(k=d.ymin;k<d.ymax;k++)for(M=(f*B+k-n)*C+(b*r-A)+I,U=d.xmin;U<d.xmax;U++)a[M+U]=g;else for(k=d.ymin;k<d.ymax;k++)for(M=(f*B+k-n)*C+(b*r-A)+I,U=k*r,F=d.xmin;F<d.xmax;F++)a[M+F]=g[U+F]}function u(a,g,d={}){const {clipOffset:b,clipSize:f,alignmentInfo:k,blockWidths:r}=d;if(r)return c(a,g,{blockWidths:r});var B=a.find(G=>N(G));if(null==
B)return null;d=f?f.width:g.width;const A=f?f.height:g.height;var n=B.width,C=B.height;const E=g.width/n,I=g.height/C;g={offset:b||{x:0,y:0},mosaic:f||g,block:{width:n,height:C}};n=B.pixelType;var M=w.getPixelArrayConstructor(n);B=B.pixels.length;C=[];for(var U=0;U<B;U++){var F=new M(d*A);for(var x=0;x<I;x++)for(var K=0;K<E;K++){var J=a[x*E+K];N(J)&&(J=J.pixels[U],y(F,J,g,K,x,k))}C.push(F)}M=a.some(G=>null==G||null!=G.mask&&0<G.mask.length);F=a.some(G=>G?.bandMasks&&1<G.bandMasks.length);M=M?new Uint8Array(d*
A):void 0;F=F?[]:void 0;if(M){for(U=0;U<I;U++)for(x=0;x<E;x++)K=a[U*E+x],J=null!=K?K.mask:null,null!=J?y(M,J,g,x,U,k):K?y(M,255,g,x,U,k):y(M,0,g,x,U,k);if(F)for(U=0;U<B;U++){x=new Uint8Array(d*A);for(K=0;K<I;K++)for(J=0;J<E;J++){const G=a[K*E+J],O=G?.bandMasks?.[U]??G?.mask;null!=O?y(x,O,g,J,K,k):G?y(x,255,g,J,K,k):y(x,0,g,J,K,k)}F.push(x)}}a=new w({width:d,height:A,pixels:C,pixelType:n,bandMasks:F,mask:M});a.updateStatistics();return a}function c(a,g,d){const b=a.find(x=>null!=x);if(null==b)return null;
var f=a.some(x=>null!=x?!!x.mask:!0);const {width:k,height:r}=g;g=f?new Uint8Array(k*r):null;({blockWidths:d}=d);const B=[],A=b.getPlaneCount(),n=w.getPixelArrayConstructor(b.pixelType);if(f)for(let x=0,K=0;x<a.length;K+=d[x],x++)if(f=a[x],N(f)){var C=f.mask;for(var E=0;E<r;E++)for(var I=0;I<d[x];I++)g[E*k+I+K]=null==C?255:C[E*f.width+I]}C=(f=a.some(x=>x?.bandMasks&&1<x.bandMasks.length))?[]:void 0;E=k*r;for(I=0;I<A;I++){const x=new n(E),K=f?new Uint8Array(E):void 0;for(let J=0,G=0;J<a.length;G+=
d[J],J++){const O=a[J];if(N(O)){var M=O.pixels[I];if(null!=M){for(var U=0;U<r;U++)for(var F=0;F<d[J];F++)x[U*k+F+G]=M[U*O.width+F];if(K)for(M=O.bandMasks?.[I]??O.mask,U=0;U<r;U++)for(F=0;F<d[J];F++)K[U*k+F+G]=M?M[U*O.width+F]:255}}}B.push(x);C&&K&&C.push(K)}a=new w({width:k,height:r,mask:g,bandMasks:C,pixels:B,pixelType:b.pixelType});a.updateStatistics();return a}function e(a){if(!N(a))return null;const g=a.clone(),{width:d,height:b,pixels:f}=a;var k=f[0];const r=g.pixels[0];a=a.mask;for(let n=2;n<
b-1;n++){const C=new Map;for(var B=n-2;B<n+2;B++)for(var A=0;4>A;A++){const E=B*d+A;t(C,k[E],a?a[E]:1)}r[n*d]=l(C);r[n*d+1]=r[n*d+2]=r[n*d];for(B=3;B<d-1;B++)A=(n-2)*d+B+1,t(C,k[A],a?a[A]:1),A=(n-1)*d+B+1,t(C,k[A],a?a[A]:1),A=n*d+B+1,t(C,k[A],a?a[A]:1),A=(n+1)*d+B+1,t(C,k[A],a?a[A]:1),A=(n-2)*d+B-3,q(C,k[A],a?a[A]:1),A=(n-1)*d+B-3,q(C,k[A],a?a[A]:1),A=n*d+B-3,q(C,k[A],a?a[A]:1),A=(n+1)*d+B-3,q(C,k[A],a?a[A]:1),r[n*d+B]=l(C);r[n*d+B+1]=r[n*d+B]}for(k=0;k<d;k++)r[k]=r[d+k]=r[2*d+k],r[(b-1)*d+k]=r[(b-
2)*d+k];g.updateStatistics();return g}function l(a){if(0===a.size)return 0;let g=0,d=-1,b=0;const f=a.keys();let k=f.next();for(;!k.done;)b=a.get(k.value),b>g&&(d=k.value,g=b),k=f.next();return d}function q(a,g,d){0!==d&&(d=a.get(g),1===d?a.delete(g):a.set(g,d-1))}function t(a,g,d){0!==d&&a.set(g,a.has(g)?a.get(g)+1:1)}function h(a,g,d){let {x:b,y:f}=g;const {width:k,height:r}=d;if(0===b&&0===f&&r===a.height&&k===a.width)return a;const {width:B,height:A}=a;g=Math.max(0,f);const n=Math.max(0,b),C=
Math.min(b+k,B),E=Math.min(f+r,A);if(0>C||0>E||!N(a))return null;b=Math.max(0,-b);f=Math.max(0,-f);var {pixels:I}=a,M=k*r,U=I.length;const F=[];for(var x=0;x<U;x++){var K=I[x],J=w.createEmptyBand(a.pixelType,M);for(let G=g;G<E;G++){const O=G*B;let R=(G+f-g)*k+b;for(let T=n;T<C;T++)J[R++]=K[O+T]}F.push(J)}I=new Uint8Array(M);M=a.mask;for(U=g;U<E;U++)for(x=U*B,K=(U+f-g)*k+b,J=n;J<C;J++)I[K++]=M?M[x+J]:1;a=new w({width:d.width,height:d.height,pixelType:a.pixelType,pixels:F,mask:I});a.updateStatistics();
return a}function p(a,g=!0){if(!N(a))return null;const {pixels:d,width:b,height:f,mask:k,pixelType:r}=a;a=[];const B=Math.round(b/2),A=Math.round(f/2),n=f-1,C=b-1;for(var E=0;E<d.length;E++){var I=d[E],M=w.createEmptyBand(r,B*A),U=0;for(var F=0;F<f;F+=2)for(var x=0;x<b;x+=2){var K=I[F*b+x];if(g){var J=x===C?K:I[F*b+x+1];const G=F===n?K:I[F*b+x+b],O=x===C?G:F===n?J:I[F*b+x+b+1];M[U++]=(K+J+G+O)/4}else M[U++]=K}a.push(M)}E=null;if(null!=k)for(E=new Uint8Array(B*A),I=0,M=0;M<f;M+=2)for(U=0;U<b;U+=2)F=
k[M*b+U],g?(x=U===C?F:k[M*b+U+1],K=M===n?F:k[M*b+U+b],J=U===C?K:M===n?x:k[M*b+U+b+1],E[I++]=F*x*K*J?1:0):E[I++]=F;return new w({width:B,height:A,pixelType:r,pixels:a,mask:E})}function v(a,g,d,b,f=0){const {width:k,height:r}=a,{width:B,height:A}=g;a=b.cols;b=b.rows;g=Math.ceil(B/a-.1/a);const n=Math.ceil(A/b-.1/b);let C,E,I,M,U;const F=g*a;var x=F*n*b;const K=new Float32Array(x),J=new Float32Array(x),G=new Uint32Array(x),O=new Uint32Array(x);let R=0,T,X;for(let W=0;W<n;W++)for(let Y=0;Y<g;Y++){var L=
12*(W*g+Y);x=d[L];C=d[L+1];E=d[L+2];I=d[L+3];M=d[L+4];U=d[L+5];for(var V=0;V<b;V++){R=(W*b+V)*F+Y*a;X=(V+.5)/b;for(let Z=0;Z<V;Z++)T=(Z+.5)/a,K[R+Z]=(x*T+C*X+E)*k+f,J[R+Z]=(I*T+M*X+U)*r+f,G[R+Z]=Math.floor(K[R+Z]),O[R+Z]=Math.floor(J[R+Z])}L+=6;x=d[L];C=d[L+1];E=d[L+2];I=d[L+3];M=d[L+4];U=d[L+5];for(L=0;L<b;L++)for(R=(W*b+L)*F+Y*a,X=(L+.5)/b,V=L;V<a;V++)T=(V+.5)/a,K[R+V]=(x*T+C*X+E)*k+f,J[R+V]=(I*T+M*X+U)*r+f,G[R+V]=Math.floor(K[R+V]),O[R+V]=Math.floor(J[R+V])}return{offsets_x:K,offsets_y:J,offsets_xi:G,
offsets_yi:O,gridWidth:F}}m.NoDataInterpretation=void 0;(function(a){a[a.matchAny=0]="matchAny";a[a.matchAll=1]="matchAll"})(m.NoDataInterpretation||(m.NoDataInterpretation={}));m.MissingBandAction=void 0;(function(a){a[a.bestMatch=0]="bestMatch";a[a.fail=1]="fail"})(m.MissingBandAction||(m.MissingBandAction={}));m.approximateTransform=function(a,g,d,b,f="nearest"){if(!N(a))return null;"majority"===f&&(a=e(a));const {pixels:k,mask:r,bandMasks:B,pixelType:A}=a,n=a.width;var C=a.height;const E=w.getPixelArrayConstructor(A),
I=k.length,{width:M,height:U}=g;a=!1;for(var F=0;F<d.length;F+=3)-1===d[F]&&-1===d[F+1]&&-1===d[F+2]&&(a=!0);const {offsets_x:x,offsets_y:K,offsets_xi:J,offsets_yi:G,gridWidth:O}=v({width:n,height:C},g,d,b,"majority"===f?.5:0);let R;g=(X,L,V,W)=>{const Y=X instanceof Float32Array||X instanceof Float64Array?0:.5;for(let Z=0;Z<U;Z++){R=Z*O;for(let aa=0;aa<M;aa++){if(0>x[R]||0>K[R])X[Z*M+aa]=0;else if(W)X[Z*M+aa]=L[J[R]+G[R]*n];else{const fa=Math.floor(x[R]),ea=Math.floor(K[R]),ca=Math.ceil(x[R]),ja=
Math.ceil(K[R]),la=x[R]-fa,oa=K[R]-ea;X[Z*M+aa]=!V||V[fa+ea*n]&&V[ca+ea*n]&&V[fa+ja*n]&&V[ca+ja*n]?(1-oa)*((1-la)*L[fa+ea*n]+la*L[ca+ea*n])+oa*((1-la)*L[fa+ja*n]+la*L[ca+ja*n])+Y:L[J[R]+G[R]*n]}R++}}};d=[];b=B?.length===I;C=[];for(F=0;F<I;F++){if(b){var T=new Uint8Array(M*U);g(T,B[F],B[F],!0);C.push(T)}T=new E(M*U);g(T,k[F],b?B[F]:r,"nearest"===f||"majority"===f);d.push(T)}f=new w({width:M,height:U,pixelType:A,pixels:d,bandMasks:b?C:void 0});if(null!=r)f.mask=new Uint8Array(M*U),g(f.mask,r,r,!0);
else if(a)for(f.mask=new Uint8Array(M*U),a=0;a<M*U;a++)f.mask[a]=0>x[a]||0>K[a]?0:1;f.updateStatistics();return f};m.clip=h;m.colorize=function(a,g){if(!N(a)||!g||!g.indexedColormap&&!g.indexed2DColormap)return a;const d=a.clone();var b=d.pixels;let f=d.mask;const k=d.width*d.height;if(1!==b.length)return a;const {indexedColormap:r,indexed2DColormap:B,offset:A,alphaSpecified:n}=g;a=0;b=b[0];g=new Uint8Array(b.length);const C=new Uint8Array(b.length),E=new Uint8Array(b.length);var I=0;if(r){const M=
r.length-1;if(null!=f)for(a=0;a<k;a++)f[a]&&(I=4*(b[a]-A),I<A||I>M?f[a]=0:(g[a]=r[I],C[a]=r[I+1],E[a]=r[I+2],f[a]=r[I+3]));else{f=new Uint8Array(k);for(a=0;a<k;a++)I=4*(b[a]-A),I<A||I>M?f[a]=0:(g[a]=r[I],C[a]=r[I+1],E[a]=r[I+2],f[a]=r[I+3]);d.mask=f}}else if(B)if(null!=f)for(a=0;a<k;a++)f[a]&&(I=B[b[a]],g[a]=I[0],C[a]=I[1],E[a]=I[2],f[a]=I[3]);else{f=new Uint8Array(k);for(a=0;a<k;a++)I=B[b[a]],g[a]=I[0],C[a]=I[1],E[a]=I[2],f[a]=I[3];d.mask=f}d.pixels=[g,C,E];d.statistics=null;d.pixelType="u8";d.maskIsAlpha=
n;return d};m.compositeBands=function(a){if(!a?.length||a.some(A=>!N(A)))return null;if(1===a.length)return a[0]?.clone()??null;const {width:g,height:d,pixelType:b}=a[0];if(a.some(A=>A.width!==g||A.height!==d))return null;const f=a.map(({mask:A})=>A).filter(A=>null!=A);let k=null;f.length&&(k=new Uint8Array(g*d),k.set(f[0]),1<f.length&&P(f.slice(1),k));const r=[];a.forEach(({pixels:A})=>r.push(...A));const B=[];a.map(({statistics:A})=>A).filter(A=>A?.length).forEach(A=>B.push(...A));return new w({pixelType:b,
width:g,height:d,mask:k,pixels:r,statistics:B.length?B:null})};m.createColormapLUT=function(a){if(a){var g=a.colormap;if(g&&0!==g.length){g=g.sort((n,C)=>n[0]-C[0]);var d=0;0>g[0][0]&&(d=g[0][0]);var b=Math.max(256,g[g.length-1][0]-d+1),f=new Uint8Array(4*b),k=[],r=0,B=0,A=5===g[0].length;if(65536<b)return g.forEach(n=>{k[n[0]-d]=A?n.slice(1):n.slice(1).concat([255])}),{indexed2DColormap:k,offset:d,alphaSpecified:A};if(a.fillUnspecified)for(a=g[B],r=a[0]-d;r<b;r++)f[4*r]=a[1],f[4*r+1]=a[2],f[4*r+
2]=a[3],f[4*r+3]=A?a[4]:255,r===a[0]-d&&(a=B===g.length-1?a:g[++B]);else for(r=0;r<g.length;r++)a=g[r],B=4*(a[0]-d),f[B]=a[1],f[B+1]=a[2],f[B+2]=a[3],f[B+3]=A?a[4]:255;return{indexedColormap:f,offset:d,alphaSpecified:A}}}};m.createMaskLUT=function(a,g,d){if("u8"!==a&&"s8"!==a&&"u16"!==a&&"s16"!==a)return null;var b=a.includes("16")?65536:256;a=a.includes("s")?-b/2:0;b=new Uint8Array(b);if(g)for(let k=0;k<g.length;k++){var f=Math.ceil(g[2*k]-a);const r=Math.floor(g[2*k+1]-a);for(;f<=r;f++)b[f]=255}else b.fill(255);
if(d)for(g=0;g<d.length;g++)b[d[g]-a]=0;return{lut:b,offset:a}};m.createRemapLUT=function(a){const {srcPixelType:g,inputRanges:d,outputValues:b,allowUnmatched:f,noDataRanges:k,isLastInputRangeInclusive:r,outputPixelType:B}=a;if("u8"!==g&&"s8"!==g&&"u16"!==g&&"s16"!==g)return null;var A=g.includes("16")?65536:256;a=g.includes("s")?-A/2:0;const n=w.createEmptyBand(B,A);A=new Uint8Array(A);f&&A.fill(255);const [C,E]=z.getPixelValueRange(B);if(d?.length&&b?.length){var I=d.map(x=>x-1E-6);I[0]=d[0];r&&
(I[I.length-1]=d[d.length-1]);for(var M=0;M<I.length;M++){var U=b[M]>E?E:b[M]<C?C:b[M],F=Math.ceil(I[2*M]-a);const x=Math.floor(I[2*M+1]-a);for(;F<=x;F++)n[F]=U,A[F]=255}}if(k?.length)for(I=0;I<k.length;I++)for(U=Math.ceil(k[2*I]-a),M=Math.floor(k[2*I+1]-a);U<=M;U++)A[U]=0;return{lut:n,offset:a,mask:A}};m.extractBands=function(a,g){return g?.length&&N(a)?a.extractBands(g):a};m.getClipBounds=H;m.getLocalArithmeticNorthRotations=function(a,g){const {coefficients:d,spacing:b}=g,{offsets_x:f,offsets_y:k,
gridWidth:r}=v(a,a,d,{rows:b[0],cols:b[1]}),{width:B,height:A}=a;a=new Float32Array(B*A);g=180/Math.PI;for(let E=0;E<A;E++)for(let I=0;I<B;I++){var n=E*r+I,C=0===E?n:n-r;const M=E===A-1?n:n+r;n=f[C]-f[M];C=k[M]-k[C];isNaN(n)||isNaN(C)?a[E*B+I]=90:(C=Math.atan2(C,n)*g,C=(360+C)%360,a[E*B+I]=C)}return a};m.interpolateOffsets=v;m.isValidPixelBlock=N;m.lookupBandValues=D;m.lookupPixels=function(a,g){if(!N(a))return null;const {pixels:d,mask:b}=a,f=d.length;let k=g.lut;const {offset:r}=g;k&&1===k[0].length&&
(k=d.map(()=>k));const B=[];g=g.outputPixelType||"u8";for(let A=0;A<f;A++){const n=D(d[A],b,k[A],r||0,g);B.push(n)}a=new w({width:a.width,height:a.height,pixels:B,mask:b,pixelType:g});a.updateStatistics();return a};m.mask=function(a,g){if(!N(a))return null;const {width:d,height:b,pixels:f}=a;var k=d*b;const r=new Uint8Array(k);a.mask?r.set(a.mask):r.fill(255);a=f.length;const {includedRanges:B,noDataValues:A,outputPixelType:n,matchAll:C,lookups:E}=g;if(E){k=[];for(g=0;g<a;g++){var I=E[g];I=D(f[g],
r,I.lut,I.offset||0,"u8");k.push(I)}1===k.length?r.set(k[0]):C?Q(k,r):P(k,r)}else if(C){g=[];for(I=0;I<a;I++){const M=new Uint8Array(k);M.set(r);S(f[I],B?.slice(2*I,2*I+2),A?.[I],M);g.push(M)}1===g.length?r.set(g[0]):Q(g,r)}else for(k=0;k<a;k++)S(f[k],B?.slice(2*k,2*k+2),A?.[k],r);return new w({width:d,height:b,pixelType:n,pixels:f,mask:r})};m.maxMapSizeGpu=6;m.mosaic=u;m.mosaicPixelData=function(a,g){if(!a||0===a.length)return null;var d=a.find(E=>E.pixelBlock);if(null==d?.pixelBlock)return null;
var b=(d.extent.xmax-d.extent.xmin)/d.pixelBlock.width;const f=(d.extent.ymax-d.extent.ymin)/d.pixelBlock.height,k=.01*Math.min(b,f),r=a.sort((E,I)=>Math.abs(E.extent.ymax-I.extent.ymax)>k?I.extent.ymax-E.extent.ymax:Math.abs(E.extent.xmin-I.extent.xmin)>k?E.extent.xmin-I.extent.xmin:0);var B=Math.min.apply(null,r.map(E=>E.extent.xmin));const A=Math.min.apply(null,r.map(E=>E.extent.ymin)),n=Math.max.apply(null,r.map(E=>E.extent.xmax)),C=Math.max.apply(null,r.map(E=>E.extent.ymax));a={x:Math.round((g.xmin-
B)/b),y:Math.round((C-g.ymax)/f)};B={width:Math.round((n-B)/b),height:Math.round((C-A)/f)};b={width:Math.round((g.xmax-g.xmin)/b),height:Math.round((g.ymax-g.ymin)/f)};if(Math.round(B.width/d.pixelBlock.width)*Math.round(B.height/d.pixelBlock.height)!==r.length||0>a.x||0>a.y||B.width<b.width||B.height<b.height)return null;d=r.map(E=>E.pixelBlock);d=u(d,B,{clipOffset:a,clipSize:b});return{extent:g,pixelBlock:d}};m.remap=function(a,g){if(!N(a))return null;const {width:d,height:b}=a,{inputRanges:f,outputValues:k,
outputPixelType:r,noDataRanges:B,allowUnmatched:A,isLastInputRangeInclusive:n}=g;g=a.pixels[0];const C=w.createEmptyBand(r,g.length),E=a.mask,I=new Uint8Array(d*b);E?I.set(E):I.fill(255);const M=a.pixelType.startsWith("f")?1E-6:0;a=f.map(R=>R-M);a[0]=f[0];a[a.length-1]=f[f.length-1]+(n?1E-6:0);var U=f.length/2;const [F,x]=z.getPixelValueRange(r);for(var K=0;K<b;K++)for(var J=0;J<d;J++){var G=K*d+J;if(I[G]){var O=g[G];let R=!1;for(let T=U-1;0<=T;T--)if(O===a[2*T]||O>a[2*T]&&O<a[2*T+1]){C[G]=k[T];R=
!0;break}R||(A?C[G]=O>x?x:O<F?F:O:I[G]=0)}}if(a=B?.length)for(U=0;U<b;U++)for(K=0;K<d;K++)if(J=U*d+K,!E||E[J])for(G=g[J],O=0;O<a;O+=2)if(G>=B[O]&&G<=B[O+1]){C[J]=0;I[J]=0;break}return new w({width:d,height:b,pixelType:r,pixels:[C],mask:I})};m.remapColor=function(a,g){if(!N(a))return null;a=a.clone();var {pixels:d}=a;const b=a.width*a.height,f=g.length,k=Math.floor(f/2),r=g[Math.floor(k)];d=d[0];let B,A,n,C,E,I,M=!1;const U=new Uint8Array(b),F=new Uint8Array(b),x=new Uint8Array(b);let K=a.mask;const J=
4===g[0].mappedColor.length;K||(K=new Uint8Array(b),K.fill(J?255:1),a.mask=K);for(E=0;E<b;E++)if(K[E]){B=d[E];M=!1;I=k;A=r;n=0;for(C=f-1;1<C-n;){if(B===A.value){M=!0;break}B>A.value?n=I:C=I;I=Math.floor((n+C)/2);A=g[Math.floor(I)]}M||(B===g[n].value?(A=g[n],M=!0):B===g[C].value?(A=g[C],M=!0):B<g[n].value?(M=!1,A=null):B>g[n].value&&(B<g[C].value?(A=g[n],M=!0):C===f-1?(M=!1,A=null):(A=g[C],M=!0)));M?(U[E]=A.mappedColor[0],F[E]=A.mappedColor[1],x[E]=A.mappedColor[2],K[E]=A.mappedColor[3]):U[E]=F[E]=
x[E]=K[E]=0}a.pixels=[U,F,x];a.mask=K;a.pixelType="u8";a.maskIsAlpha=J;return a};m.resampleByMajority=e;m.setValidBoundary=function(a,g,d){if(!N(a))return null;const {width:b,height:f}=a,k=g.x;g=g.y;const r=d.width+k;d=d.height+g;if(0>k||0>g||r>b||d>f||0===k&&0===g&&r===b&&d===f)return a;a.mask||(a.mask=new Uint8Array(b*f));const B=a.mask;for(let A=0;A<f;A++){const n=A*b;for(let C=0;C<b;C++)B[n+C]=A<g||A>=d||C<k||C>=r?0:1}a.updateStatistics();return a};m.split=function(a,g,d){if(!N(a))return null;
const {width:b,height:f}=g;let {width:k,height:r}=a;const B=new Map,A={x:0,y:0};d=null==d?1:1+d;for(let n=0;n<d;n++){const C=Math.ceil(k/b),E=Math.ceil(r/f);for(let I=0;I<E;I++){A.y=I*f;for(let M=0;M<C;M++){A.x=M*b;const U=h(a,A,g);B.set(`${n}/${I}/${M}`,U)}}n<d-1&&(a=p(a));k=Math.round(k/2);r=Math.round(r/2)}return B};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/utils":function(){define("require exports ../../Color ../../symbols ../../core/asyncUtils ../../core/has ../../core/screenUtils ../../chunks/vec3f64 ../../layers/effects/jsonUtils ./cimSymbolUtils ./gfxUtils ./Symbol3DMaterial".split(" "),
function(m,w,z,N,D,S,Q,P,H,y,u,c){function e(f){f=f.symbolLayers;if(!f)return null;let k=null;f.forEach(r=>{"object"===r.type&&r.resource?.href||(k="water"===r.type?r.color:r.material?r.material.color:null)});return k?new z(k):null}function l(f,k){if(null==k||null==f)return f;f=f.toRgba();f[3]*=k;return new z(f)}function q(f,k,r){if(f=f.symbolLayers){var B=A=>{k=k??A??(null!=r?b:null);return l(k,r)};f.forEach(A=>{if("object"!==A.type||!A.resource?.href||k)if("water"===A.type)A.color=B(A.color);else{const n=
B(null!=A.material?A.material.color:null);null==A.material?A.material=new c.Symbol3DMaterial({color:n}):A.material.color=n;null!=r&&"outline"in A&&null!=A.outline?.color&&(A.outline.color=l(A.outline.color,r))}})}}async function t(f,k){(f=f.symbolLayers)&&await D.forEach(f,async r=>h(r,k))}async function h(f,k){switch(f.type){case "extrude":f.size="number"===typeof k[2]?k[2]:0;break;case "icon":case "line":case "text":k=p(k);null!=k&&(f.size=k);break;case "path":const r=a(k,P.ONES,[f.width,void 0,
f.height]);f.width=d(k[0],f.width,1,r);f.height=d(k[2],f.height,1,r);break;case "object":await v(f,k)}}function p(f){for(const k of f)if("number"===typeof k)return k;return null}async function v(f,k){const {resourceSize:r,symbolSize:B}=await g(f),A=a(k,r,B);f.width=d(k[0],B[0],r[0],A);f.depth=d(k[1],B[1],r[1],A);f.height=d(k[2],B[2],r[2],A)}function a(f,k,r){for(let B=0;3>B;B++){const A=f[B];switch(A){case "symbol-value":return f=r[B],null!=f?f/k[B]:1;case "proportional":break;default:if(A&&k[B])return A/
k[B]}}return 1}async function g(f){var {computeObjectLayerResourceSize:k}=await new Promise((E,I)=>m(["./symbolLayerUtils"],E,I));k=await k(f,10);const {width:r,height:B,depth:A}=f;f=[r,A,B];let n=1;for(var C=0;3>C;C++){const E=f[C];if(null!=E){n=E/k[C];break}}for(C=0;3>C;C++)null==f[C]&&(f[C]=k[C]*n);return{resourceSize:k,symbolSize:f}}function d(f,k,r,B){switch(f){case "proportional":return r*B;case "symbol-value":return null!=k?k:r;default:return f}}const b=new z("white");w.applyColorToSymbol=
function(f,k,r){if(f&&(k||null!=r))if(k&&(k=new z(k)),N.isSymbol3D(f))q(f,k,r);else if(N.isSymbol2D(f)){if(k=k??f.color)f.color=l(k,r);null!=r&&"outline"in f&&f.outline?.color&&(f.outline.color=l(f.outline.color,r))}};w.applyOpacityToColor=l;w.applyRotationToSymbol=function(f,k,r){f&&null!=k&&(N.isSymbol3D(f)?(f=f.symbolLayers)&&f.forEach(B=>{if(B&&"object"===B.type)switch(r){case "tilt":B.tilt=k;break;case "roll":B.roll=k;break;default:B.heading=k}}):!N.isSymbol2D(f)||"simple-marker"!==f.type&&"picture-marker"!==
f.type&&"text"!==f.type||(f.angle=k))};w.applySizesToSymbol=async function(f,k){if(f&&k){if(N.isSymbol3D(f))return t(f,k);if(N.isSymbol2D(f)&&(k=p(k),null!=k))switch(f.type){case "simple-marker":f.size=k;break;case "picture-marker":const r=f.width/f.height;1<r?(f.width=k,f.height=k*r):(f.width=k*r,f.height=k);break;case "simple-line":f.width=k;break;case "text":f.font.size=k}}};w.fetchWebStyleSymbol=async function(f,k){const r=await f.fetchSymbol(k);return r?r:f.fetchCIMSymbol(k)};w.getCSSFilterFromEffectList=
function(f){if(!f)return null;f=f.effects.filter(k=>"bloom"!==k.type).map(k=>k.toJSON());return H.effectFunctionsFromJSON(f)};w.getColorFromSymbol=function(f,k){if(!f)return null;let r=null;N.isSymbol3D(f)?r=e(f):N.isSymbol2D(f)&&(r="cim"===f.type?y.getCIMSymbolColor(f):f.color?new z(f.color):null);return r?l(r,k):null};w.getIconHref=function(f){return f.resource?.href??""};w.getSymbolOutlineSize=function(f){return f?N.isSymbol3D(f)?(f=(f=f.symbolLayers?.at(-1))&&"outline"in f?f?.outline?.size:void 0,
null!=f?f:0):Q.px2pt(u.getStroke(f)?.width):0};w.isVolumetricSymbol=function(f){if(null==f||!("symbolLayers"in f)||null==f.symbolLayers)return!1;switch(f.type){case "point-3d":return f.symbolLayers.some(k=>"object"===k.type);case "line-3d":return f.symbolLayers.some(k=>"path"===k.type);case "polygon-3d":return f.symbolLayers.some(k=>"object"===k.type||"extrude"===k.type);default:return!1}};w.symbolHasExtrudeSymbolLayer=function(f){return null!=f&&"polygon-3d"===f.type&&f.symbolLayers.some(k=>"extrude"===
k.type)};Object.defineProperty(w,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/cimSymbolUtils":function(){define(["exports","../../Color","../cim/utils"],function(m,w,z){function N(c){c=z.toCIMSymbolJSON(c);if("CIMTextSymbol"===c?.type)return c.height??0;let e=0;if(c?.symbolLayers)for(const l of c.symbolLayers)z.isCIMMarker(l)&&null!=l.size&&l.size>e?e=l.size:z.isCIMStroke(l)&&null!=l.width&&l.width>e?e=l.width:z.isCIMFill(l);return e}function D(c,e,l,q){if(c)if("CIMTextSymbol"===
c.type)null!=c.height&&(c.height*=e);else{if(l&&c.effects)for(const t of c.effects)P(t,e);if(c.symbolLayers)for(const t of c.symbolLayers)switch(t.type){case "CIMPictureMarker":case "CIMVectorMarker":S(t,e,q);break;case "CIMPictureStroke":case "CIMSolidStroke":!q?.preserveOutlineWidth&&t.width&&(t.width*=e);break;case "CIMPictureFill":t.height&&(t.height*=e);t.offsetX&&(t.offsetX*=e);t.offsetY&&(t.offsetY*=e);break;case "CIMHatchFill":D(t.lineSymbol,e,!0,{...q,preserveOutlineWidth:!1}),t.offsetX&&
(t.offsetX*=e),t.offsetY&&(t.offsetY*=e),t.separation&&(t.separation*=e)}}}function S(c,e,l){if(c&&(c.markerPlacement&&Q(c.markerPlacement,e),c.offsetX&&(c.offsetX*=e),c.offsetY&&(c.offsetY*=e),c.anchorPoint&&"Absolute"===c.anchorPointUnits&&(c.anchorPoint={x:c.anchorPoint.x*e,y:c.anchorPoint.y*e}),c.size=null!=c.size?c.size*e:0,"CIMVectorMarker"===c.type&&c.markerGraphics))for(const q of c.markerGraphics)c.scaleSymbolsProportionally||D(q.symbol,e,!0,l)}function Q(c,e){z.isCIMMarkerStrokePlacement(c)&&
c.offset&&(c.offset*=e);switch(c.type){case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineSameSize":c.customEndingOffset&&(c.customEndingOffset*=e);c.offsetAlongLine&&(c.offsetAlongLine*=e);if(c.placementTemplate&&c.placementTemplate.length){var l=c.placementTemplate.map(q=>q*e);c.placementTemplate=l}break;case "CIMMarkerPlacementAlongLineVariableSize":c.maxRandomOffset&&(c.maxRandomOffset*=e);c.placementTemplate&&c.placementTemplate.length&&(l=c.placementTemplate.map(q=>
q*e),c.placementTemplate=l);break;case "CIMMarkerPlacementOnLine":c.startPointOffset&&(c.startPointOffset*=e);break;case "CIMMarkerPlacementAtExtremities":c.offsetAlongLine&&(c.offsetAlongLine*=e);break;case "CIMMarkerPlacementAtRatioPositions":c.beginPosition&&(c.beginPosition*=e);c.endPosition&&(c.endPosition*=e);break;case "CIMMarkerPlacementPolygonCenter":c.offsetX&&(c.offsetX*=e);c.offsetY&&(c.offsetY*=e);break;case "CIMMarkerPlacementInsidePolygon":c.offsetX&&(c.offsetX*=e),c.offsetY&&(c.offsetY*=
e),c.stepX&&(c.stepX*=e),c.stepY&&(c.stepY*=e)}}function P(c,e){switch(c.type){case "CIMGeometricEffectArrow":case "CIMGeometricEffectDonut":c.width&&(c.width*=e);break;case "CIMGeometricEffectBuffer":c.size&&(c.size*=e);break;case "CIMGeometricEffectCut":c.beginCut&&(c.beginCut*=e);c.endCut&&(c.endCut*=e);c.middleCut&&(c.middleCut*=e);break;case "CIMGeometricEffectDashes":c.customEndingOffset&&(c.customEndingOffset*=e);c.offsetAlongLine&&(c.offsetAlongLine*=e);if(c.dashTemplate&&c.dashTemplate.length){const l=
c.dashTemplate.map(q=>q*e);c.dashTemplate=l}break;case "CIMGeometricEffectExtension":case "CIMGeometricEffectJog":case "CIMGeometricEffectRadial":c.length&&(c.length*=e);break;case "CIMGeometricEffectMove":c.offsetX&&(c.offsetX*=e);c.offsetY&&(c.offsetY*=e);break;case "CIMGeometricEffectOffset":case "CIMGeometricEffectOffsetTangent":c.offset&&(c.offset*=e);break;case "CIMGeometricEffectRegularPolygon":c.radius&&(c.radius*=e);break;case "CIMGeometricEffectTaperedPolygon":c.fromWidth&&(c.fromWidth*=
e);c.length&&(c.length*=e);c.toWidth&&(c.toWidth*=e);break;case "CIMGeometricEffectWave":c.amplitude&&(c.amplitude*=e),c.period&&(c.period*=e)}}function H(c,e){if(c){var l="CIMTextSymbol"===c.type?c.symbol:c;c="CIMPolygonSymbol"===c.type;if(l?.symbolLayers)for(const q of l.symbolLayers)if(!(q.colorLocked||c&&(z.isCIMStroke(q)||z.isCIMMarker(q)&&q.markerPlacement&&z.isCIMMarkerStrokePlacement(q.markerPlacement))))switch(q.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":q.tintColor&&
y(e,q.tintColor);break;case "CIMVectorMarker":q.markerGraphics?.forEach(t=>{H(t.symbol,e)});break;case "CIMSolidStroke":case "CIMSolidFill":y(e,q.color);break;case "CIMHatchFill":H(q.lineSymbol,e)}}}function y(c,e){for(const l of c)if(l.join(".")===e.join("."))return;c.push(e)}function u(c,e,l){if(c){var q="CIMTextSymbol"===c.type?c.symbol:c;c="CIMPolygonSymbol"===q?.type;if(q?.symbolLayers)for(const t of q.symbolLayers)if(!t.colorLocked){if(c)if(l){if({layersToColor:q}=l,(z.isCIMStroke(t)||z.isCIMMarker(t)&&
t.markerPlacement&&z.isCIMMarkerStrokePlacement(t.markerPlacement))&&"fill"===q||z.isCIMFill(t)&&"outline"===q)continue}else if(z.isCIMStroke(t)||z.isCIMMarker(t)&&t.markerPlacement&&z.isCIMMarkerStrokePlacement(t.markerPlacement))continue;q=e.toArray();switch(t.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":t.tintColor=q;break;case "CIMVectorMarker":t.markerGraphics?.forEach(h=>{u(h.symbol,e,l)});break;case "CIMSolidStroke":case "CIMSolidFill":t.color=q;break;case "CIMHatchFill":u(t.lineSymbol,
e,l)}}}}m.applyCIMSymbolColor=function(c,e,l){e instanceof w||(e=new w(e));(c=z.toCIMSymbolJSON(c))&&u(c,e,l)};m.applyCIMSymbolRotation=function(c,e,l=!1){c=z.toCIMSymbolJSON(c);l&&0!==e&&(e=360-e);if("CIMTextSymbol"===c?.type)c.angle=e;else if("CIMPointSymbol"===c?.type&&c.symbolLayers){l=e-(c.angle||0);for(const q of c.symbolLayers)if(z.isCIMMarker(q)){let t=q.rotation||0;t=q.rotateClockwise?t-l:t+l;q.rotation=t}c.angle=e}};m.getCIMSymbolColor=function(c){c=z.toCIMSymbolJSON(c);const e=[];H(c,e);
return e.length?new w(z.fromCIMColor(e[0])):null};m.getCIMSymbolRotation=function(c,e=!1){c=z.toCIMSymbolJSON(c);return"CIMTextSymbol"===c?.type||"CIMPointSymbol"===c?.type?(c=c.angle,null!=c&&0!==c&&e?360-c:c??0):0};m.getCIMSymbolSize=N;m.getCIMSymbolType=function(c){c=z.toCIMSymbolJSON(c);if(!c)return null;switch(c.type){case "CIMPointSymbol":return"CIMPointSymbol";case "CIMLineSymbol":return"CIMLineSymbol";case "CIMPolygonSymbol":return"CIMPolygonSymbol";case "CIMTextSymbol":return"CIMTextSymbol";
case "CIMMeshSymbol":return"CIMMeshSymbol";default:return null}};m.scaleCIMMarker=S;m.scaleCIMSymbol=D;m.scaleCIMSymbolTo=function(c,e,l){if(c){var q=z.toCIMSymbolJSON(c);c=N(c);if(0===c){if(q)if("CIMTextSymbol"===q.type)q.height=e;else if(q.symbolLayers)for(const t of q.symbolLayers)switch(t.type){case "CIMPictureMarker":case "CIMVectorMarker":t.size=e;break;case "CIMPictureStroke":case "CIMSolidStroke":t.width=e}}else D(q,e/c,!1,l)}};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},
"esri/symbols/cim/utils":function(){define(["require","exports"],function(m,w){function z(c){return"function"===typeof c}function N(c){let e=c.length;for(;e--;)if(!" /-,\n".includes(c.charAt(e)))return!1;return!0}function D(c,e){const l=[];var q=0;let t=-1;do t=c.indexOf("[",q),t>=q&&(t>q&&(q=c.substr(q,t-q),l.push([q,null,N(q)])),q=t+1,t=c.indexOf("]",q),t>=q&&(t>q&&(q=c.substr(q,t-q),(q=e[q])&&l.push([null,q,!1])),q=t+1));while(-1!==t);q<c.length-1&&(c=c.substr(q),l.push([c,null,N(c)]));return l}
function S(c,e,l){let q="",t=null;for(const h of e){const [p,v,a]=h;if(p)a?t=p:(t&&(q+=t,t=null),q+=p);else if(e=c.attributes[v])t&&(q+=t,t=null),q+=e}return Q(q,l)}function Q(c,e){"string"!==typeof c&&(c=String(c));switch(e){case "LowerCase":return c.toLowerCase();case "Allcaps":return c.toUpperCase();default:return c}}function P(c){return c?{r:c[0],g:c[1],b:c[2],a:c[3]/255}:{r:0,g:0,b:0,a:0}}function H(c){if(!c)return null;switch(c.type){case "CIMPolygonSymbol":if(c.symbolLayers)for(const e of c.symbolLayers)if(c=
H(e),null!=c)return c;break;case "CIMTextSymbol":return H(c.symbol);case "CIMSolidFill":return c.color}}function y(c){if(c)switch(c.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(c=c.symbolLayers)for(const e of c)if(c=y(e),null!=c)return c;break;case "CIMTextSymbol":return y(c.symbol);case "CIMSolidStroke":return c.color}}function u(c){if(c)switch(c.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(c.symbolLayers)for(const e of c.symbolLayers)if(c=u(e),void 0!==c)return c;break;case "CIMTextSymbol":return u(c.symbol);
case "CIMSolidStroke":case "CIMGradientStroke":case "CIMPictureStroke":return c.width}}w.adjustTextCase=Q;w.analyzeTextParts=D;w.assignTextValuesFromFeature=S;w.attributesToFields=function(c){return(c?Object.keys(c):[]).map(e=>({name:e,alias:e,type:"string"===typeof c[e]?"esriFieldTypeString":"esriFieldTypeDouble"}))};w.colorToArray=function(c){return[c.r,c.g,c.b,c.a]};w.createLabelOverrideFunction=function(c,e,l){const q=D(e,c);return t=>S(t,q,l)};w.evaluateValueOrFunction=function(c,e,l,q){return z(c)?
c(e,l,q):c};w.fromCIMColor=P;w.fromCIMFontDecoration=function(c){return c.underline?"underline":c.strikethrough?"line-through":"none"};w.fromCIMFontStyle=function(c){let e="normal",l="normal";c&&(c=c.toLowerCase(),c.includes("italic")?e="italic":c.includes("oblique")&&(e="oblique"),c.includes("bold")?l="bold":c.includes("light")&&(l="lighter"));return{style:e,weight:l}};w.fromCIMHorizontalAlignment=function(c){switch(c){default:return"left";case "Right":return"right";case "Center":return"center";
case "Justify":return"center"}};w.fromCIMVerticalAlignment=function(c){switch(c){default:return"top";case "Center":return"middle";case "Baseline":return"baseline";case "Bottom":return"bottom"}};w.getFillColor=H;w.getFontStyle=function(c){if(!c)return"normal";switch(c.toLowerCase()){case "italic":return"italic";case "oblique":return"oblique";default:return"normal"}};w.getFontWeight=function(c){if(!c)return"normal";switch(c.toLowerCase()){case "bold":return"bold";case "bolder":return"bolder";case "lighter":return"lighter";
default:return"normal"}};w.getStrokeColor=y;w.getStrokeWidth=u;w.getTintColor=c=>c.tintColor?P(c.tintColor):{r:255,g:255,b:255,a:1};w.getValue=(c,e=0)=>null==c||isNaN(c)?e:c;w.importGeometryEngine=function(){return new Promise((c,e)=>m(["../../geometry/geometryEngineJSON"],c,e))};w.isCIMFill=function(c){return null!=c&&("CIMGradientFill"===c.type||"CIMHatchFill"===c.type||"CIMPictureFill"===c.type||"CIMSolidFill"===c.type||"CIMWaterFill"===c.type)};w.isCIMMarker=function(c){return"CIMVectorMarker"===
c.type||"CIMPictureMarker"===c.type||"CIMBarChartMarker"===c.type||"CIMCharacterMarker"===c.type||"CIMPieChartMarker"===c.type||"CIMStackedBarChartMarker"===c.type};w.isCIMMarkerStrokePlacement=function(c){return null!=c&&("CIMMarkerPlacementAlongLineRandomSize"===c.type||"CIMMarkerPlacementAlongLineSameSize"===c.type||"CIMMarkerPlacementAlongLineVariableSize"===c.type||"CIMMarkerPlacementAtExtremities"===c.type||"CIMMarkerPlacementAtMeasuredUnits"===c.type||"CIMMarkerPlacementAtRatioPositions"===
c.type||"CIMMarkerPlacementOnLine"===c.type||"CIMMarkerPlacementOnVertices"===c.type)};w.isCIMStroke=function(c){return"CIMGradientStroke"===c.type||"CIMPictureStroke"===c.type||"CIMSolidStroke"===c.type};w.isFeatureValueFn=z;w.isGeometryEngineRequired=c=>{if(!c)return!1;for(const e of c)switch(e.type){case "CIMGeometricEffectBuffer":case "CIMGeometricEffectOffset":case "CIMGeometricEffectDonut":return!0}return!1};w.isSVGImage=c=>c.includes("data:image/svg+xml");w.mapCIMSymbolToGeometryType=function(c){if(!c)return null;
switch(c.type){case "CIMPointSymbol":case "CIMTextSymbol":return"esriGeometryPoint";case "CIMLineSymbol":return"esriGeometryPolyline";case "CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}};w.resampleHermite=function(c,e,l,q,t,h,p=!0){const v=e/t;l/=h;const a=Math.ceil(v/2),g=Math.ceil(l/2);for(let f=0;f<h;f++)for(let k=0;k<t;k++){const r=4*(k+(p?h-f-1:f)*t);var d=0;let B=0,A=0,n=0,C=0,E=0,I=0;const M=(f+.5)*l;for(let U=Math.floor(f*l);U<(f+1)*l;U++){var b=Math.abs(M-(U+.5))/g;const F=
(k+.5)*v;b*=b;for(let x=Math.floor(k*v);x<(k+1)*v;x++){let K=Math.abs(F-(x+.5))/a;d=Math.sqrt(b+K*K);-1<=d&&1>=d&&(d=2*d*d*d-3*d*d+1,0<d&&(K=4*(x+U*e),I+=d*c[K+3],A+=d,255>c[K+3]&&(d=d*c[K+3]/250),n+=d*c[K],C+=d*c[K+1],E+=d*c[K+2],B+=d))}}q[r]=n/B;q[r+1]=C/B;q[r+2]=E/B;q[r+3]=I/A}};w.toCIMSymbolJSON=function(c){return c.data?.symbol??null};Object.defineProperty(w,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/gfxUtils":function(){define("exports ../../assets ../../Color ../../request ../../core/LRUCache ../../core/screenUtils ./cimSymbolUtils".split(" "),
function(m,w,z,N,D,S,Q){function P(u){if(!u)return null;let c=null;switch(u.type){case "simple-fill":case "picture-fill":case "simple-marker":c=P(u.outline);break;case "simple-line":const e=S.pt2px(u.width);null!=u.style&&"none"!==u.style&&0!==e&&(c={color:u.color,style:y(u.style),width:e,cap:u.cap,join:"miter"===u.join?S.pt2px(u.miterLimit):u.join});break;default:c=null}return c}const H=new D.LRUCache(1E3),y=(()=>{const u={};return c=>{if(u[c])return u[c];const e=c.replaceAll("-","");return u[c]=
e}})();z=new z([128,128,128]);m.defaultThematicColor=z;m.dekebabifyLineStyle=y;m.getFill=function(u){const c=u.style;let e=null;if(u)switch(u.type){case "simple-marker":"cross"!==c&&"x"!==c&&(e=u.color);break;case "simple-fill":"solid"===c?e=u.color:"none"!==c&&(e={type:"pattern",x:0,y:0,src:w.getAssetUrl(`esri/symbols/patterns/${c}.png`),width:5,height:5});break;case "picture-fill":e={type:"pattern",src:u.url,width:S.pt2px(u.width)*u.xscale,height:S.pt2px(u.height)*u.yscale,x:S.pt2px(u.xoffset),
y:S.pt2px(u.yoffset)};break;case "text":e=u.color;break;case "cim":e=Q.getCIMSymbolColor(u)}return e};m.getPatternUrlWithColor=function(u,c){const e=u+"-"+c;return void 0!==H.get(e)?Promise.resolve(H.get(e)):N(u,{responseType:"image"}).then(l=>{l=l.data;const q=l.naturalWidth,t=l.naturalHeight,h=document.createElement("canvas");h.width=q;h.height=t;const p=h.getContext("2d");p.fillStyle=c;p.fillRect(0,0,q,t);p.globalCompositeOperation="destination-in";p.drawImage(l,0,0);l=h.toDataURL();H.put(e,l);
return l})};m.getStroke=P;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/DimensionalDefinition":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),function(m,w,z,N,D,S){var Q;w=Q=class extends w.JSONSupport{constructor(P){super(P);this.dimensionName=this.variableName=null;this.values=[];this.isSlice=
!1}clone(){return new Q({variableName:this.variableName,dimensionName:this.dimensionName,values:z.clone(this.values),isSlice:this.isSlice})}};m.__decorate([N.property({type:String,json:{write:!0}})],w.prototype,"variableName",void 0);m.__decorate([N.property({type:String,json:{write:!0}})],w.prototype,"dimensionName",void 0);m.__decorate([N.property({type:D.types.array(D.types.oneOf([D.types.native(Number),D.types.array(D.types.native(Number))])),json:{write:!0}})],w.prototype,"values",void 0);m.__decorate([N.property({type:Boolean,
json:{write:!0}})],w.prototype,"isSlice",void 0);return w=Q=m.__decorate([S.subclass("esri.layers.support.DimensionalDefinition")],w)})},"esri/layers/support/MultidimensionalSubset":function(){define("../../chunks/tslib.es6 ../../geometry ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../geometry/Extent ../../geometry/Polygon ../../geometry/support/jsonUtils ./DimensionalDefinition ../../geometry/Geometry".split(" "),
function(m,w,z,N,D,S,Q,P,H,y,u,c,e){var l;w={base:e,key:"type",typeMap:{extent:H,polygon:y}};z=l=class extends z.JSONSupport{constructor(q){super(q);this.subsetDefinitions=this.areaOfInterest=null}get dimensions(){var {subsetDefinitions:q}=this;if(null==q||0===q.length)return[];const t=new Map;q.forEach(h=>{if(h.dimensionName){if(Array.isArray(h.values[0])){var p=h.values;var v=p[0][0];p=p[h.values.length-1][1]}else p=h.values,v=p[0],p=p[h.values.length-1];t.has(h.dimensionName)?(h=t.get(h.dimensionName),
h[0]=Math.min(v,h[0]),h[1]=Math.max(p,h[1])):t.set(h.dimensionName,[v,p])}});q=[];for(const h of t)q.push({name:h[0],extent:h[1]});return q}get variables(){const {subsetDefinitions:q}=this;if(null==q||0===q.length)return[];const t=new Set;q.forEach(h=>{h.variableName&&t.add(h.variableName)});return[...t]}clone(){const q=this.subsetDefinitions?.map(h=>h.clone()),t=this.areaOfInterest?this.areaOfInterest.clone():this.areaOfInterest;return new l({areaOfInterest:t,subsetDefinitions:q})}};m.__decorate([N.property({types:w,
json:{read:u.fromJSON,write:!0}})],z.prototype,"areaOfInterest",void 0);m.__decorate([N.property({readOnly:!0})],z.prototype,"dimensions",null);m.__decorate([N.property({readOnly:!0})],z.prototype,"variables",null);m.__decorate([N.property({type:[c],json:{write:!0}})],z.prototype,"subsetDefinitions",void 0);return z=l=m.__decorate([P.subclass("esri.layers.support.MultidimensionalSubset")],z)})},"esri/layers/support/RasterFunction":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ./RasterFunctionTemplate".split(" "),
function(m,w,z,N,D,S,Q,P,H,y){var u;const c=new Set(["raster","raster2","dem","fillraster"]),e=new Set(["rasters"]),l=p=>p?.rasterFunction?h.fromJSON(p):p,q=p=>p&&p instanceof h?p.toJSON():p,t=p=>p?.functionName&&!p.declaredClass?new h(p):p;D={types:{key:"type",base:null,typeMap:{RasterFunctionTemplate:y}},json:{write:!0,name:"rasterFunctionDefinition"}};let h=u=class extends w.JSONSupport{constructor(p){super(p);this.functionName=null;this.outputPixelType="unknown";this.functionDefinition=this.variableName=
null}set functionArguments(p){if(p){const v=Object.keys(p);if(v.some(a=>{var g;if(g=c.has(a.toLowerCase()))a=p[a],g=a?.functionName&&!a.declaredClass;return g})||v.some(a=>e.has(a.toLowerCase())&&Array.isArray(p[a])&&p[a].some(g=>g?.functionName&&!g.declaredClass))){p=z.clone(p);for(const a of v)c.has(a.toLowerCase())?p[a]=t(p[a]):e.has(a.toLowerCase())&&Array.isArray(p[a])&&(p[a]=p[a].map(g=>t(g)))}}this._set("functionArguments",p)}readFunctionArguments(p){if(null==p)var v=null;else{p=z.clone(p);
var a={};for(v of Object.keys(p))c.has(v.toLowerCase())?a[v]=l(p[v]):e.has(v.toLowerCase())&&Array.isArray(p[v])?a[v]=p[v].map(l):a[v]=p[v];v=a}return v}writeFunctionArguments(p,v,a){const g={};for(const d of Object.keys(p))c.has(d.toLowerCase())?g[d]=q(p[d]):e.has(d.toLowerCase())&&Array.isArray(p[d])?g[d]=p[d].map(q):g[d]=q(p[d]);v[a]=g}readFunctionName(p,v){p=v.rasterFunctionInfos;const a=v.name;return a?a:p?.length&&"None"!==p[0].name?p[0].name:v.rasterFunctionDefinition?v.rasterFunctionDefinition.name:
v.rasterFunction}get rasterFunctionDefinition(){return this.functionDefinition?.toJSON()}set rasterFunctionDefinition(p){this.functionDefinition=p?y.fromJSON(p):null}clone(){return new u({functionName:this.functionName,functionArguments:z.clone(this.functionArguments),outputPixelType:this.outputPixelType,variableName:this.variableName,rasterFunctionDefinition:z.clone(this.rasterFunctionDefinition)})}};m.__decorate([N.property({json:{type:Object,name:"rasterFunctionArguments"}})],h.prototype,"functionArguments",
null);m.__decorate([Q.reader("functionArguments")],h.prototype,"readFunctionArguments",null);m.__decorate([H.writer("functionArguments")],h.prototype,"writeFunctionArguments",null);m.__decorate([N.property({json:{type:String,write:{target:"rasterFunction"}}})],h.prototype,"functionName",void 0);m.__decorate([Q.reader("functionName",["rasterFunction","rasterFunctionInfos","rasterFunctionDefinition"])],h.prototype,"readFunctionName",null);m.__decorate([S.enumeration({C128:"c128",C64:"c64",F32:"f32",
F64:"f64",S16:"s16",S32:"s32",S8:"s8",U1:"u1",U16:"u16",U2:"u2",U32:"u32",U4:"u4",U8:"u8",UNKNOWN:"unknown"},{ignoreUnknown:!1}),N.property({json:{default:"unknown"}})],h.prototype,"outputPixelType",void 0);m.__decorate([N.property({type:String,json:{read:!0,write:!0}})],h.prototype,"variableName",void 0);m.__decorate([N.property()],h.prototype,"rasterFunctionDefinition",null);m.__decorate([N.property(D)],h.prototype,"functionDefinition",void 0);return h=u=m.__decorate([P.subclass("esri.layers.support.RasterFunction")],
h)})},"esri/layers/support/RasterFunctionTemplate":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ./RasterFunctionInfo ./RasterFunctionProperties".split(" "),function(m,w,z,N,D,S,Q,P,H,y){w=new w.JSONMap({0:"mosaic",1:"item",2:"item-group"},{useNumericKeys:!0});z=class extends z.JSONSupport{constructor(){super(...arguments);
this.functionType="mosaic";this.type="RasterFunctionTemplate"}};m.__decorate([N.property({type:[String],json:{write:!0}})],z.prototype,"aliases",void 0);m.__decorate([N.property({type:Object,json:{write:!0}})],z.prototype,"arguments",void 0);m.__decorate([N.property({type:String,json:{write:!0}})],z.prototype,"description",void 0);m.__decorate([N.property({type:H,json:{write:!0,name:"function"}})],z.prototype,"functionInfo",void 0);m.__decorate([N.property({type:w.apiValues,json:{type:[0,1,2],read:w.read,
write:w.write}})],z.prototype,"functionType",void 0);m.__decorate([N.property({type:String,json:{write:!0}})],z.prototype,"group",void 0);m.__decorate([N.property({type:String,json:{write:!0}})],z.prototype,"help",void 0);m.__decorate([N.property({type:Number,json:{type:D.Integer,write:!0,name:"_object_id"}})],z.prototype,"id",void 0);m.__decorate([N.property({type:String,json:{write:!0}})],z.prototype,"name",void 0);m.__decorate([N.property({type:String,json:{write:!0,name:"definition"}})],z.prototype,
"queryDefinition",void 0);m.__decorate([N.property({type:String,json:{write:!0}})],z.prototype,"tag",void 0);m.__decorate([N.property({type:y,json:{write:!0}})],z.prototype,"properties",void 0);m.__decorate([N.property({type:String,json:{write:!0}})],z.prototype,"thumbnail",void 0);m.__decorate([N.property({type:String,json:{write:!0}})],z.prototype,"thumbnailEx",void 0);m.__decorate([N.property({json:{type:["RasterFunctionTemplate"],write:!0}})],z.prototype,"type",void 0);return z=m.__decorate([P.subclass("esri.layers.support.RasterFunctionTemplate")],
z)})},"esri/layers/support/RasterFunctionInfo":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ./rasterEnums".split(" "),function(m,w,z,N,D,S,Q,P){w=class extends w.JSONSupport{constructor(){super(...arguments);this.pixelType="unknown"}};m.__decorate([z.property({type:String,json:{write:!0}})],w.prototype,"name",void 0);
m.__decorate([z.property({type:String,json:{write:!0}})],w.prototype,"description",void 0);m.__decorate([z.property({type:N.Integer,json:{type:N.Integer,write:!0,name:"_object_id"}})],w.prototype,"id",void 0);m.__decorate([z.property({type:String,json:{type:P.pixelTypeKebabDict.jsonValues,read:P.pixelTypeKebabDict.read,write:P.pixelTypeKebabDict.write}})],w.prototype,"pixelType",void 0);m.__decorate([z.property({type:String,json:{write:!0}})],w.prototype,"type",void 0);return w=m.__decorate([Q.subclass("esri.layers.support.RasterFunctionInfo")],
w)})},"esri/layers/support/rasterEnums":function(){define(["exports","../../core/jsonMap"],function(m,w){const z=w.strict()({RSP_NearestNeighbor:"nearest",RSP_BilinearInterpolation:"bilinear",RSP_CubicConvolution:"cubic",RSP_Majority:"majority"}),N=w.strict()({esriNoDataMatchAny:"any",esriNoDataMatchAll:"all"});w=w.strict()({U1:"u1",U2:"u2",U4:"u4",U8:"u8",S8:"s8",U16:"u16",S16:"s16",U32:"u32",S32:"s32",F32:"f32",F64:"f64",C64:"c64",C128:"c128",UNKNOWN:"unknown"});m.interpolationKebab=z;m.noDataInterpretationKebab=
N;m.pixelTypeKebabDict=w;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/RasterFunctionProperties":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ./RasterFunctionVariable".split(" "),function(m,w,z,N,D,S,Q,P){D={key:"type",base:null,typeMap:{RasterFunctionVariable:P}};w=class extends w.JSONSupport{};
m.__decorate([z.property({types:D,json:{types:D,name:"MatchVariable"}})],w.prototype,"matchVariable",void 0);m.__decorate([z.property({types:D,json:{types:D,name:"UnionDimension"}})],w.prototype,"unionDimension",void 0);m.__decorate([z.property({type:Number,json:{type:N.Integer,write:!0,name:"_object_id"}})],w.prototype,"id",void 0);m.__decorate([z.property({type:String,json:{write:!0}})],w.prototype,"type",void 0);return w=m.__decorate([Q.subclass("esri.layers.support.RasterFunctionProperties")],
w)})},"esri/layers/support/RasterFunctionVariable":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),function(m,w,z,N,D,S,Q){w=class extends w.JSONSupport{constructor(){super(...arguments);this.isPublic=this.isDataset=!1;this.type="RasterFunctionVariable"}};m.__decorate([z.property({type:String,json:{write:!0}})],
w.prototype,"name",void 0);m.__decorate([z.property({type:Number,json:{type:N.Integer,write:!0,name:"_object_id"}})],w.prototype,"id",void 0);m.__decorate([z.property({type:Boolean,json:{write:!0}})],w.prototype,"isDataset",void 0);m.__decorate([z.property({type:Boolean,json:{write:!0}})],w.prototype,"isPublic",void 0);m.__decorate([z.property({json:{write:!0}})],w.prototype,"value",void 0);m.__decorate([z.property({type:String,json:{write:!0}})],w.prototype,"type",void 0);return w=m.__decorate([Q.subclass("esri.layers.support.RasterFunctionVariable")],
w)})},"esri/layers/support/RasterJobHandler":function(){define(["../../core/Error","../../core/workers/workers","./PixelBlock"],function(m,w,z){class N{constructor(){this._workerThread=null;this._destroyed=!1}async initialize(){const D=await w.open("RasterWorker");this._destroyed?D.close():this._workerThread=D}destroy(){this._destroyed=!0;this._workerThread&&(this._workerThread.close(),this._workerThread=null)}async convertVectorFieldData(D,S){if(!this._workerThread)throw new m("raster-jobhandler:no-connection",
"no available worker connection");return(D=await this._workerThread.invoke("convertVectorFieldData",{pixelBlock:D.pixelBlock.toJSON(),type:D.dataType},S))?new z(D):null}computeStatisticsHistograms(D,S){if(!this._workerThread)throw new m("raster-jobhandler:no-connection","no available worker connection");return this._workerThread.invoke("computeStatisticsHistograms",{pixelBlock:D.pixelBlock.toJSON()},S)}async decode(D,S){if(!this._workerThread)throw new m("raster-jobhandler:no-connection","no available worker connection");
return(D=await this._workerThread.invoke("decode",D,S))?new z(D):null}async symbolize(D,S){if(!this._workerThread)throw new m("raster-jobhandler:no-connection","no available worker connection");D={extent:D.extent?.toJSON(),pixelBlock:D.pixelBlock?.toJSON(),simpleStretchParams:D.simpleStretchParams,bandIds:D.bandIds};return(S=await this._workerThread.invoke("symbolize",D,S))?new z(S):null}async updateSymbolizer(D,S){if(!this._workerThread)throw new m("raster-jobhandler:no-connection","no available worker connection");
const Q=D?.rendererJSON?.histograms;await Promise.all(this._workerThread.broadcast("updateSymbolizer",{symbolizerJSON:D.toJSON(),histograms:Q},S))}async updateRasterFunction(D,S){if(!this._workerThread)throw new m("raster-jobhandler:no-connection","no available worker connection");await Promise.all(this._workerThread.broadcast("updateRasterFunction",{rasterFunctionJSON:D.toJSON()},S))}async process(D,S){if(!this._workerThread)throw new m("raster-jobhandler:no-connection","no available worker connection");
return(D=await this._workerThread.invoke("process",{extent:D.extent?.toJSON(),primaryPixelSizes:D.primaryPixelSizes?.map(Q=>null!=Q?Q.toJSON():null),primaryPixelBlocks:D.primaryPixelBlocks.map(Q=>null!=Q?Q.toJSON():null),primaryRasterIds:D.primaryRasterIds},S))?new z(D):null}async stretch(D,S){if(!this._workerThread)throw new m("raster-jobhandler:no-connection","no available worker connection");if(!D?.pixelBlock)return null;D={srcPixelBlock:D.pixelBlock.toJSON(),stretchParams:D.stretchParams};return(S=
await this._workerThread.invoke("stretch",D,S))?new z(S):null}async split(D,S){if(!this._workerThread)throw new m("raster-jobhandler:no-connection","no available worker connection");if(!D?.pixelBlock)return null;D={srcPixelBlock:D.pixelBlock.toJSON(),tileSize:D.tileSize,maximumPyramidLevel:D.maximumPyramidLevel};const Q=await this._workerThread.invoke("split",D,S);Q&&Q.forEach((P,H)=>{Q.set(H,P?z.fromJSON(P):null)});return Q}async estimateStatisticsHistograms(D,S){if(!this._workerThread)throw new m("raster-jobhandler:no-connection",
"no available worker connection");if(!D?.pixelBlock)return null;D={srcPixelBlock:D.pixelBlock.toJSON()};return await this._workerThread.invoke("estimateStatisticsHistograms",D,S)}async mosaicAndTransform(D,S){if(!this._workerThread)throw new m("raster-jobhandler:no-connection","no available worker connection");if(!D?.srcPixelBlocks?.length)return{pixelBlock:null};D={...D,srcPixelBlocks:D.srcPixelBlocks.map(Q=>null!=Q?Q.toJSON():null)};S=await this._workerThread.invoke("mosaicAndTransform",D,S);return{pixelBlock:S.pixelBlock?
new z(S.pixelBlock):null,localNorthDirections:S.localNorthDirections}}async createFlowMesh(D,S){if(!this._workerThread)throw new m("raster-jobhandler:no-connection","no available worker connection");const Q={buffer:D.flowData.data.buffer,maskBuffer:D.flowData.mask.buffer,width:D.flowData.width,height:D.flowData.height},{meshType:P,simulationSettings:H}=D;D=await this._workerThread.invoke("createFlowMesh",{meshType:P,flowData:Q,simulationSettings:H},{...S,transferList:[Q.buffer,Q.maskBuffer]});return{vertexData:new Float32Array(D.vertexBuffer),
indexData:new Uint32Array(D.indexBuffer)}}getProjectionOffsetGrid(D,S){if(!this._workerThread)throw new m("raster-jobhandler:no-connection","no available worker connection");const Q=null!=D.datumTransformation?D.datumTransformation.steps.map(H=>({wkid:H.wkid,wkt:H.wkt,isInverse:H.isInverse})):null,P=null!=D.rasterTransform?D.rasterTransform.toJSON():null;D={projectedExtent:D.projectedExtent.toJSON(),srcBufferExtent:D.srcBufferExtent.toJSON(),pixelSize:D.pixelSize,hasWrapAround:D.hasWrapAround,spacing:D.spacing,
datumTransformationSteps:Q,rasterTransform:P,isAdaptive:D.isAdaptive,includeGCSGrid:D.includeGCSGrid};return this._workerThread.invoke("getProjectionOffsetGrid",D,S)}}return N})},"esri/layers/support/TileInfo":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/unitUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../geometry/Point ../../geometry/SpatialReference ../../geometry/support/aaBoundingRect ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ./LOD ./TileKey".split(" "),
function(m,w,z,N,D,S,Q,P,H,y,u,c,e,l,q,t,h,p){var v;w=new w.JSONMap({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});z=v=class extends z.JSONSupport{static create(a={}){const {resolutionFactor:g=1,scales:d,size:b=256,spatialReference:f=e.WebMercator,numLODs:k=24}=a;if(!q.isValid(f)){a=[];if(d)for(var r=0;r<d.length;r++){var B=
d[r];a.push(new h({level:r,scale:B,resolution:B}))}else for(r=5E-4,B=k-1;0<=B;B--)a.unshift(new h({level:B,scale:r,resolution:r})),r*=2;return new v({dpi:96,lods:a,origin:new c(0,0,f),size:[b,b],spatialReference:f})}r=q.getInfo(f);a=a.origin?new c({x:a.origin.x,y:a.origin.y,spatialReference:f}):r?new c({x:r.origin[0],y:r.origin[1],spatialReference:f}):new c({x:0,y:0,spatialReference:f});r=1/(39.37*N.getMetersPerUnitForSR(f)*96);B=[];if(d)for(var A=0;A<d.length;A++){var n=d[A];B.push(new h({level:A,
scale:n,resolution:n*r}))}else{var C=q.isGeographic(f)?512/b*5.916575275917094E8:256/b*5.91657527591555E8;A=Math.ceil(k/g);B.push(new h({level:0,scale:C,resolution:C*r}));for(n=1;n<A;n++)C/=2**g,B.push(new h({level:n,scale:C,resolution:C*r}))}return new v({dpi:96,lods:B,origin:a,size:[b,b],spatialReference:f})}constructor(a){super(a);this.dpi=96;this.spatialReference=this.size=this.origin=this.format=null}get isWrappable(){const {spatialReference:a,origin:g}=this;if(a&&g){const d=q.getInfo(a);return a.isWrappable&&
!!d&&Math.abs(d.origin[0]-g.x)<=d.dx}return!1}readOrigin(a,g){return c.fromJSON({spatialReference:g.spatialReference,...a})}set lods(a){const g=[],d=this._levelToLOD={};a&&a.forEach(b=>{g.push(b.scale);d[b.level]=b});this._set("scales",g);this._set("lods",a);this._initializeUpsampleLevels()}readSize(a,g){return[g.cols,g.rows]}writeSize(a,g){g.cols=a[0];g.rows=a[1]}zoomToScale(a){const g=this.scales;if(0>=a)return g[0];if(a>=g.length-1)return g[g.length-1];const d=Math.floor(a);return g[d]/(g[d]/g[d+
1])**(a-d)}scaleToZoom(a){const g=this.scales,d=g.length-1;let b=0;for(;b<d;b++){const f=g[b],k=g[b+1];if(f<=a)break;if(k===a)return b+1;if(f>a&&k<a)return b+Math.log(f/a)/Math.log(f/k)}return b}snapScale(a,g=.95){a=this.scaleToZoom(a);return a%Math.floor(a)>=g?this.zoomToScale(Math.ceil(a)):this.zoomToScale(Math.floor(a))}tileAt(a,g,d,b){var f=this.lodAt(a);if(!f)return null;let k;if("number"===typeof g)k=g,g=d;else{if(q.equals(g.spatialReference,this.spatialReference))k=g.x,g=g.y;else{b=t.project(g,
this.spatialReference);if(null==b)return null;k=b.x;g=b.y}b=d}d=f.resolution*this.size[0];f=f.resolution*this.size[1];b||(b=new p.TileKey(null,0,0,0,l.create()));b.level=a;b.row=Math.floor((this.origin.y-g)/f+.001);b.col=Math.floor((k-this.origin.x)/d+.001);this.updateTileInfo(b);return b}updateTileInfo(a,g=v.ExtrapolateOptions.NONE){var d=this.lodAt(a.level);d||g!==v.ExtrapolateOptions.POWER_OF_TWO||(g=this.lods[this.lods.length-1],g.level<a.level&&(d=g));if(d){var b=a.level-d.level;g=d.resolution*
this.size[0]/2**b;d=d.resolution*this.size[1]/2**b;a.id=`${a.level}/${a.row}/${a.col}`;a.extent||(a.extent=l.create());a.extent[0]=this.origin.x+a.col*g;a.extent[1]=this.origin.y-(a.row+1)*d;a.extent[2]=a.extent[0]+g;a.extent[3]=a.extent[1]+d}}upsampleTile(a){const g=this._upsampleLevels[a.level];if(!g||-1===g.parentLevel)return!1;a.level=g.parentLevel;a.row=Math.floor(a.row/g.factor+.001);a.col=Math.floor(a.col/g.factor+.001);this.updateTileInfo(a);return!0}getTileBounds(a,g){var d=this.lodAt(g.level);
if(null==d)return null;var {resolution:b}=d;d=b*this.size[0];b*=this.size[1];a[0]=this.origin.x+g.col*d;a[1]=this.origin.y-(g.row+1)*b;a[2]=a[0]+d;a[3]=a[1]+b;return a}lodAt(a){return this._levelToLOD?.[a]??null}clone(){return v.fromJSON(this.write({}))}getOrCreateCompatible(a,g){if(256===this.size[0]&&256===this.size[1])return 256===a?this:null;const d=[],b=this.lods.length;for(let f=0;f<b;f++){const k=this.lods[f];d.push(new h({level:k.level,scale:k.scale,resolution:k.resolution*g}))}return new v({size:[a,
a],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin,spatialReference:this.spatialReference,lods:d})}_initializeUpsampleLevels(){const a=this.lods;this._upsampleLevels=[];let g=null;for(let d=0;d<a.length;d++){const b=a[d];this._upsampleLevels[b.level]={parentLevel:g?g.level:-1,factor:g?g.resolution/b.resolution:0};g=b}}};m.__decorate([D.property({type:Number,json:{write:!0}})],z.prototype,"compressionQuality",void 0);m.__decorate([D.property({type:Number,
json:{write:!0}})],z.prototype,"dpi",void 0);m.__decorate([D.property({type:String,json:{read:w.read,write:w.write,origins:{"web-scene":{read:!1,write:!1}}}})],z.prototype,"format",void 0);m.__decorate([D.property({readOnly:!0})],z.prototype,"isWrappable",null);m.__decorate([D.property({type:c,json:{write:!0}})],z.prototype,"origin",void 0);m.__decorate([H.reader("origin")],z.prototype,"readOrigin",null);m.__decorate([D.property({type:[h],value:null,json:{write:!0}})],z.prototype,"lods",null);m.__decorate([D.property({readOnly:!0})],
z.prototype,"scales",void 0);m.__decorate([D.property({cast:a=>Array.isArray(a)?a:"number"===typeof a?[a,a]:[256,256]})],z.prototype,"size",void 0);m.__decorate([H.reader("size",["rows","cols"])],z.prototype,"readSize",null);m.__decorate([u.writer("size",{cols:{type:S.Integer},rows:{type:S.Integer}})],z.prototype,"writeSize",null);m.__decorate([D.property({type:e,json:{write:!0}})],z.prototype,"spatialReference",void 0);z=v=m.__decorate([y.subclass("esri.layers.support.TileInfo")],z);(function(a){a=
a.ExtrapolateOptions||(a.ExtrapolateOptions={});a[a.NONE=0]="NONE";a[a.POWER_OF_TWO=1]="POWER_OF_TWO"})(z||(z={}));return z})},"esri/layers/support/LOD":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),function(m,w,z,N,D,S,Q){var P;w=P=class extends w.JSONSupport{constructor(H){super(H);this.cols=null;this.level=
0;this.origin=this.levelValue=null;this.resolution=0;this.rows=null;this.scale=0}clone(){return new P({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})}};m.__decorate([z.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],w.prototype,"cols",void 0);m.__decorate([z.property({type:N.Integer,json:{write:!0}})],w.prototype,"level",void 0);m.__decorate([z.property({type:String,json:{write:!0}})],
w.prototype,"levelValue",void 0);m.__decorate([z.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],w.prototype,"origin",void 0);m.__decorate([z.property({type:Number,json:{write:!0}})],w.prototype,"resolution",void 0);m.__decorate([z.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],w.prototype,"rows",void 0);m.__decorate([z.property({type:Number,json:{write:!0}})],w.prototype,"scale",void 0);
return w=P=m.__decorate([Q.subclass("esri.layers.support.LOD")],w)})},"esri/layers/support/TileKey":function(){define(["exports"],function(m){class w{constructor(z,N,D,S,Q){this.id=z;this.level=N;this.row=D;this.col=S;this.extent=Q}}m.TileKey=w;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/FunctionRaster":function(){define("../../../chunks/tslib.es6 ../../../core/Error ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseRaster ../rasterFunctions/pixelUtils ../../../rest/support/FeatureSet".split(" "),
function(m,w,z,N,D,S,Q,P,H,y){N=class extends P{constructor(){super(...arguments);this.datasetFormat="Function";this.tileType="Raster";this.rasterFunction=null}async open(u){await this.init();const {rasterFunction:c}=this;this.primaryRasters?.rasters?.length?c.sourceRasters=this.primaryRasters.rasters:(this.primaryRasters=c.getPrimaryRasters(),this.rasterJobHandler&&this.primaryRasters.rasters?.forEach(p=>p.rasterJobHandler=this.rasterJobHandler));const {rasters:e,rasterIds:l}=this.primaryRasters;
var q=e.map(p=>p.rasterInfo?void 0:p.open(u));await Promise.all(q);q=e.map(({rasterInfo:p})=>p);var t=c.bind({rasterInfos:q,rasterIds:l});if(!t.success||0===q.length)throw new w("raster-function:open",`cannot bind the function: ${t.error??""}`);t="Table"===c.functionName?c:c.functionArguments?.raster;"Table"===t?.functionName&&(c.rasterInfo.attributeTable=y.fromJSON(t.functionArguments.attributeTableAsRecordSet));await this.syncJobHandler();const h=q[0];this.hasUniqueSourceStorageInfo=1===q.length||
q.slice(1).every(p=>this._hasSameStorageInfo(p,h));this.set("sourceJSON",e[0].sourceJSON);this.set("rasterInfo",c.rasterInfo)}async syncJobHandler(){return this.rasterJobHandler?.updateRasterFunction(this.rasterFunction)}async fetchPixels(u,c,e,l={}){const {rasters:q,rasterIds:t}=this.primaryRasters;var h=!1,{interpolation:p}=l,v=this.rasterFunction.flatWebGLFunctionChain?.hasFocalFunction;!l.requestRawData&&"bilinear"!==p&&v&&(h=1===q.length&&!l.skipRasterFunction,l={...l,interpolation:"bilinear",
requestRawData:h});v=q.map(b=>b.fetchPixels(u,c,e,l));v=await Promise.all(v);var a=v.map(b=>b.pixelBlock),g=h||l.requestRawData?v.map(b=>b.srcTilePixelSize):null;if(l.skipRasterFunction||a.every(b=>null==b))return v[0];const d=v.find(b=>null!=b.pixelBlock)?.extent??u;a=this.rasterJobHandler?await this.rasterJobHandler.process({extent:d,primaryPixelBlocks:a,primaryPixelSizes:g,primaryRasterIds:t}):this.rasterFunction.process({extent:d,primaryPixelBlocks:a,primaryPixelSizes:g,primaryRasterIds:t});({transformGrid:g}=
v[0]);if(!h||null==a||null==g)return{...v[0],pixelBlock:a};h={rows:g.spacing[0],cols:g.spacing[1]};p=this.rasterJobHandler?(await this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:[a],srcMosaicSize:{width:a.width,height:a.height},destDimension:{width:c,height:e},coefs:g.coefficients,sampleSpacing:h,projectDirections:!1,gcsGrid:null,isUV:!1,interpolation:p,alignmentInfo:void 0,blockWidths:null},l)).pixelBlock:H.approximateTransform(a,{width:c,height:e},g.coefficients,h,p);return{extent:u,srcExtent:v[0].srcExtent,
pixelBlock:p}}_hasSameStorageInfo(u,c){const {storageInfo:e,pixelSize:l,spatialReference:q,extent:t}=u,{storageInfo:h,pixelSize:p,spatialReference:v,extent:a}=c;return l.x===p.x&&l.y===p.y&&q.equals(v)&&t.equals(a)&&e.blockHeight===h.blockHeight&&e.blockWidth===h.blockWidth&&e.maximumPyramidLevel===h.maximumPyramidLevel}};m.__decorate([z.property({type:String,json:{write:!0}})],N.prototype,"datasetFormat",void 0);m.__decorate([z.property()],N.prototype,"tileType",void 0);m.__decorate([z.property()],
N.prototype,"rasterFunction",void 0);m.__decorate([z.property()],N.prototype,"primaryRasters",void 0);return N=m.__decorate([Q.subclass("esri.layers.support.rasterDatasets.FunctionRaster")],N)})},"esri/layers/support/rasterDatasets/BaseRaster":function(){define("../../../chunks/tslib.es6 ../../../geometry ../../../request ../../../core/Error ../../../core/JSONSupport ../../../core/Logger ../../../core/Promise ../../../core/promiseUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../arcgisLayerUrl ../commonProperties ../DimensionalDefinition ../LOD ../RasterStorageInfo ../TileInfo ./multidimensionalUtils ./RawBlockCache ../rasterFormats/pixelRangeUtils ../rasterFormats/RasterCodec ../rasterFunctions/pixelUtils ../rasterFunctions/rasterProjectionHelper ../rasterFunctions/vectorFieldUtils ../../../geometry/Extent ../../../geometry/Point".split(" "),
function(m,w,z,N,D,S,Q,P,H,y,u,c,e,l,q,t,h,p,v,a,g,d,b,f,k,r,B,A){w=class extends Q.EsriPromiseMixin(D.JSONSupport){constructor(){super(...arguments);this.datasetFormat=this.datasetName=null;this.hasUniqueSourceStorageInfo=!0;this.rasterInfo=null;this.ioConfig={sampling:"closest"}}async init(){const n=k.load();this.addResolvingPromise(n);await this.when()}normalizeCtorArgs(n){n?.ioConfig&&(n={...n,ioConfig:{resolution:null,bandIds:null,sampling:"closest",tileInfo:v.create(),...n.ioConfig}});return n}get _isGlobalWrappableSource(){const {rasterInfo:n}=
this,C=k.getWorldWidth(n.spatialReference);return null!=C&&n.extent.width>=C/2}get _hasNoneOrGCSShiftTransform(){const {transform:n}=this.rasterInfo;return null==n||"gcs-shift"===n.type}set rasterJobHandler(n){this._set("rasterJobHandler",n);"Function"===this.datasetFormat&&this.primaryRasters?.rasters?.forEach(C=>C.rasterJobHandler=n)}set url(n){this._set("url",l.sanitizeUrl(n,S.getLogger(this)))}async open(n){throw new N("BaseRaster:open-not-implemented","open() is not implemented");}async fetchTile(n,
C,E,I={}){const M=I.tileInfo||this.rasterInfo.storageInfo.tileInfo;n=this.getTileExtentFromTileInfo(n,C,E,M);return this.fetchPixels(n,M.size[0],M.size[1],I)}async identify(n,C={}){n=y.ensureClass(A,n).clone().normalize();const {multidimensionalDefinition:E,timeExtent:I}=C;var {rasterInfo:M}=this;const {hasMultidimensionalTranspose:U,multidimensionalInfo:F}=M;var {transposedVariableName:x}=C,K=null!=F&&U&&(null!=I||a.isMultiSliceOrRangeDefinition(E));K&&!x&&(x=null!=E&&0<E.length?E[0].variableName??
void 0:F.variables[0].name,C={...C,transposedVariableName:x});C=this._getRequestOptionsWithSliceId(C);const {spatialReference:J,extent:G}=M;var {datumTransformation:O}=C;O=k.projectPoint(n,J,O);if(!G.intersects(O)||null!=M.transform&&(O=M.transform.inverseTransform(O),!M.nativeExtent.intersects(O)))return{location:O,value:null};let R=0;var T=null!=x&&null!=F&&M.hasMultidimensionalTranspose;if("Function"===this.datasetFormat){K=this.primaryRasters.rasters[0];if(T)return K.identify(O,C);({pixelSize:T}=
M);C=3*T.x/2;T=3*T.y/2;C=new B({xmin:O.x-C,xmax:O.x+C,ymin:O.y-T,ymax:O.y+T,spatialReference:J});T={interpolation:"nearest"};({pixelBlock:K}=await K.fetchPixels(C,3,3,T));({pixelBlock:C}=await this.fetchPixels(C,3,3,T));if(null==K)return{location:O,value:null};K=!K.mask||K.mask[4]?K.pixels.map(aa=>aa[4]):null;var X;null!=C&&(X=!C.mask||C.mask[4]?C.pixels.map(aa=>aa[4]):void 0);return{location:O,value:K,processedValue:X,pyramidLevel:0}}if(!T)if(C.srcResolution)R=k.snapPyramid(C.srcResolution,M,this.ioConfig.sampling).pyramidLevel;
else if(R=await this.computeBestPyramidLevelForLocation(n,C),null==R)return{location:O,value:null};X=this.identifyPixelLocation(O,R,null,T);if(null===X)return{location:O,value:null};const {row:L,col:V,rowOffset:W,colOffset:Y,blockWidth:Z}=X;X=g.getRasterId(this.url,x??C.sliceId);M=`${R}/${L}/${V}`;x=g.getBlock(X,null,M);null==x&&(x=this.fetchRawTile(R,L,V,C),g.putBlock(X,null,M,x));X=await x;return X?.pixels?.length?this._processIdentifyResult(X,{srcLocation:O,position:W*Z+Y,pyramidLevel:R,useTransposedTile:!!T,
requestSomeSlices:K,identifyOptions:C}):{location:O,value:null}}async fetchPixels(n,C,E,I={}){n=k.shiftExtent(n);I=this._getRequestOptionsWithSliceId(I);var {_hasNoneOrGCSShiftTransform:M}=this;if(I.requestRawData&&M)return this._fetchPixels(n,C,E,I);var U=k.getWorldWidth(n.spatialReference),F=k.getWorldWrapCount(n);if(null==U||0===F||1===F&&this._isGlobalWrappableSource&&M)return this._fetchPixels(n,C,E,I);if(3<=F)return{extent:n,pixelBlock:null};const x=[],{xmin:K,xmax:J}=n,G=Math.round(U/(J-K)*
C),O=G-Math.round((U/2-K)/(J-K)*C);let R=0;M=[];for(let X=0;X<=F;X++){var T=new B({xmin:0===X?K:-U/2,xmax:X===F?J-U*X:U/2,ymin:n.ymin,ymax:n.ymax,spatialReference:n.spatialReference});const L=0===X?G-O:X===F?C-R:G;R+=L;M.push(L);T=I.disableWrapAround&&0<X?null:this._fetchPixels(T,L,E,I);x.push(T)}U=(await Promise.all(x)).map(X=>X?.pixelBlock);F=null;C={width:C,height:E};F=this.rasterJobHandler?(await this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:U,srcMosaicSize:C,destDimension:null,coefs:null,
sampleSpacing:null,interpolation:"nearest",alignmentInfo:null,blockWidths:M},I)).pixelBlock:f.mosaic(U,C,{blockWidths:M});I=k.projectExtent(n,this.rasterInfo.spatialReference,I.datumTransformation);return{extent:n,srcExtent:I,pixelBlock:F}}async fetchRawPixels(n,C,E,I={}){C={x:Math.floor(C.x),y:Math.floor(C.y)};const M=await this._fetchRawTiles(n,C,E,I),{nativeExtent:U,nativePixelSize:F,storageInfo:x}=this.rasterInfo;var K=2**n,J=F.x*K;K*=F.y;J=new B({xmin:U.xmin+J*C.x,xmax:U.xmin+J*(C.x+E.width-
1),ymin:U.ymax-K*(C.y+E.height-1),ymax:U.ymax-K*C.y,spatialReference:U.spatialReference});if(!M)return{extent:J,srcExtent:J,pixelBlock:null};const {pixelBlocks:G,mosaicSize:O}=M;if(1===G.length&&null!=G[0]&&G[0].width===E.width&&G[0].height===E.height)return{extent:J,srcExtent:J,pixelBlock:M.pixelBlocks[0]};n={x:C.x%(0<n?x.pyramidBlockWidth:x.blockWidth),y:C.y%(0<n?x.pyramidBlockHeight:x.blockHeight)};E=this.rasterJobHandler?(await this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:G,srcMosaicSize:O,
destDimension:E,clipOffset:n,clipSize:E,coefs:null,sampleSpacing:null,interpolation:I.interpolation,alignmentInfo:null,blockWidths:null},I)).pixelBlock:f.mosaic(G,O,{clipOffset:n,clipSize:E});return{extent:J,srcExtent:J,pixelBlock:E}}fetchRawTile(n,C,E,I){throw new N("BaseRaster:read-not-implemented","fetchRawTile() is not implemented");}computeExtent(n){return k.projectExtent(this.rasterInfo.extent,n)}decodePixelBlock(n,C){return!this.rasterJobHandler||C.useCanvas?b.decode(n,C):this.rasterJobHandler.decode({data:n,
options:C})}async request(n,C,E=0){const {customFetchParameters:I}=this.ioConfig,{range:M,query:U,headers:F}=C;E=E??C.retryCount??this.ioConfig.retryCount;const x=M?{Range:`bytes=${M.from}-${M.to}`}:null;try{return await z(n,{...C,query:{...U,...I},headers:{...F,...x}})}catch(K){if(0<E)return E--,this.request(n,C,E);throw K;}}getSliceIndex(n){const {multidimensionalInfo:C}=this.rasterInfo;return null==C||null==n||0===n.length?null:a.getSliceIndex(n,C)}getTileExtentFromTileInfo(n,C,E,I){n=I.lodAt(n);
return this.getTileExtent({x:n.resolution,y:n.resolution},C,E,I.origin,I.spatialReference,I.size)}updateTileInfo(){const {storageInfo:n,spatialReference:C,extent:E,pixelSize:I}=this.rasterInfo;if(!n.tileInfo){const U=[];var M=n.maximumPyramidLevel||0;let F=Math.max(I.x,I.y),x=1/.0254*96*F;for(let K=0;K<=M;K++)U.unshift(new h({level:M-K,resolution:F,scale:x})),F*=2,x*=2;M=new A({x:E.xmin,y:E.ymax,spatialReference:C});n.tileInfo=new v({origin:M,size:[n.blockWidth,n.blockHeight],spatialReference:C,lods:U});
n.isVirtualTileInfo=!0}}createRemoteDatasetStorageInfo(n,C=512,E=512,I){const {width:M,height:U,nativeExtent:F,pixelSize:x,spatialReference:K}=n,J=new A({x:F.xmin,y:F.ymax,spatialReference:K});null==I&&(I=Math.max(0,Math.round(Math.log(Math.max(M,U))/Math.LN2-8)));const G=this.computeBlockBoundary(F,512,512,{x:F.xmin,y:F.ymax},[x],I);n.storageInfo=new p({blockWidth:C,blockHeight:E,pyramidBlockWidth:C,pyramidBlockHeight:E,origin:J,firstPyramidLevel:1,maximumPyramidLevel:I,blockBoundary:G})}async computeBestPyramidLevelForLocation(n,
C){return 0}computeBlockBoundary(n,C,E,I,M,U=0,F=2){if(1===M.length&&0<U){M=[...M];let {x:J,y:G}=M[0];for(let O=0;O<U;O++)J*=F,G*=F,M.push({x:J,y:G})}U=[];const {x,y:K}=I;for(I=0;I<M.length;I++){const {x:J,y:G}=M[I];U.push({minCol:Math.floor((n.xmin-x+.1*J)/C/J),maxCol:Math.floor((n.xmax-x-.1*J)/C/J),minRow:Math.floor((K-n.ymax+.1*G)/E/G),maxRow:Math.floor((K-n.ymin-.1*G)/E/G)})}return U}getPyramidPixelSize(n){const {nativePixelSize:C}=this.rasterInfo,{pyramidResolutions:E,pyramidScalingFactor:I}=
this.rasterInfo.storageInfo;if(0===n)return C;if(null!=E&&E.length)return E[n-1];n=I**n;return{x:C.x*n,y:C.y*n}}identifyPixelLocation(n,C,E,I){const {spatialReference:M,nativeExtent:U,storageInfo:F}=this.rasterInfo,{maximumPyramidLevel:x,origin:K,transposeInfo:J}=F,G=I&&null!=J?J.tileSize[0]:F.blockWidth;I=I&&null!=J?J.tileSize[1]:F.blockHeight;n=k.projectPoint(n,M,E);if(!U.intersects(n)||0>C||C>x)return null;E=this.getPyramidPixelSize(C);const {x:O,y:R}=E;E=(K.y-n.y)/R/I;const T=(n.x-K.x)/O/G;return{pyramidLevel:C,
row:Math.floor(E),col:Math.floor(T),rowOffset:Math.min(I-1,Math.floor((E-Math.floor(E))*I)),colOffset:Math.min(G-1,Math.floor((T-Math.floor(T))*G)),blockWidth:G,srcLocation:n}}getTileExtent(n,C,E,I,M,U){const [F,x]=U;E=I.x+E*F*n.x;C=I.y-C*x*n.y;return new B({xmin:E,xmax:E+F*n.x,ymin:C-x*n.y,ymax:C,spatialReference:M})}getBlockWidthHeight(n){return{blockWidth:0<n?this.rasterInfo.storageInfo.pyramidBlockWidth:this.rasterInfo.storageInfo.blockWidth,blockHeight:0<n?this.rasterInfo.storageInfo.pyramidBlockHeight:
this.rasterInfo.storageInfo.blockHeight}}isBlockOutside(n,C,E){n=this.rasterInfo.storageInfo.blockBoundary[n];return!n||n.maxRow<C||n.maxCol<E||n.minRow>C||n.minCol>E}async _fetchPixels(n,C,E,I={}){var M=k.getWorldWrapCount(n);if(2<=M)return{extent:n,pixelBlock:null};var U=this._getSourceDataInfo(n,C,E,I);const {pyramidLevel:F,srcResolution:x,srcExtent:K,srcWidth:J,srcHeight:G,ul:O}=U;if(0===J||0===G)return{extent:n,srcExtent:K,pixelBlock:null};var {rasterInfo:R}=this,T=R.transform,X="gcs-shift"===
T?.type,L=null!=k.getWorldWidth(n.spatialReference);if(X||!L)M=k.getWorldWrapCount(U.srcExtent,X);U=await this._fetchRawTiles(F,O,{width:J,height:G,wrapCount:M},I);if(!U)return{extent:n,srcExtent:K,pixelBlock:null};var V=R.storageInfo;X=0<F?V.pyramidBlockWidth:V.blockWidth;var W=0<F?V.pyramidBlockHeight:V.blockHeight;let {x:Y,y:Z}=R.pixelSize;if(0<F){const {pyramidResolutions:pa,pyramidScalingFactor:qa}=V;null!=pa&&pa[F-1]?{x:Y,y:Z}=pa[F-1]:(V=qa**F,Y*=V,Z*=V)}var aa=R.spatialReference;R=new A({x:Y,
y:Z,spatialReference:aa});const fa=X===J&&W===G&&0===O.x%X&&0===O.y%W;V=new A({x:(n.xmax-n.xmin)/C,y:(n.ymax-n.ymin)/E,spatialReference:n.spatialReference});const ea=!n.spatialReference.equals(aa),ca=aa.isGeographic?1E-9:1E-4;({datumTransformation:aa}=I);if(!ea&&fa&&1===U.pixelBlocks.length&&X===C&&W===E&&this._isSameResolution(x,V,ca))return{extent:n,srcExtent:K,srcTilePixelSize:R,pixelBlock:U.pixelBlocks[0]};X=L&&null!=k.getWorldWidth(K.spatialReference)&&this._hasNoneOrGCSShiftTransform;(L=I.requestProjectedLocalDirections&&
this.rasterInfo.dataType.startsWith("vector"))&&!this.rasterJobHandler&&await k.load();M=this.rasterJobHandler?await this.rasterJobHandler.getProjectionOffsetGrid({projectedExtent:n,srcBufferExtent:U.extent,pixelSize:V.toJSON(),datumTransformation:aa,rasterTransform:T,hasWrapAround:0<M||X,isAdaptive:!1!==this.ioConfig.optimizeProjectionAccuracy,includeGCSGrid:L},I):k.getProjectionOffsetGrid({projectedExtent:n,srcBufferExtent:U.extent,pixelSize:V,datumTransformation:aa,rasterTransform:T,hasWrapAround:0<
M||X,isAdaptive:!1,includeGCSGrid:L});T=!I.requestRawData;X={rows:M.spacing[0],cols:M.spacing[1]};W=this._hasNoneOrGCSShiftTransform?this._getRasterTileAlignmentInfo(F,U.extent.xmin):void 0;const {pixelBlocks:ja,mosaicSize:la,isPartiallyFilled:oa}=U;U=null;this.rasterJobHandler?(C=await this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:ja,srcMosaicSize:la,destDimension:T?{width:C,height:E}:null,coefs:T?M.coefficients:null,sampleSpacing:T?X:null,projectDirections:L,gcsGrid:L?M.gcsGrid:null,
isUV:"vector-uv"===this.rasterInfo.dataType,interpolation:I.interpolation,alignmentInfo:W,blockWidths:null},I),{pixelBlock:T,localNorthDirections:U}=C):(W=f.mosaic(ja,la,{alignmentInfo:W}),T=T?f.approximateTransform(W,{width:C,height:E},M.coefficients,X,I.interpolation):W,L&&M.gcsGrid&&(U=f.getLocalArithmeticNorthRotations({width:C,height:E},M.gcsGrid),T=r.convertToLocalDirections(T,this.rasterInfo.dataType,U)));return I.requestRawData||L?{extent:n,srcExtent:K,srcTilePixelSize:R,pixelBlock:T,transformGrid:M,
localNorthDirections:U,isPartiallyFilled:oa}:{extent:n,srcExtent:K,srcTilePixelSize:R,pixelBlock:T}}async _fetchRawTiles(n,C,E,I){const {origin:M,blockBoundary:U}=this.rasterInfo.storageInfo,{blockWidth:F,blockHeight:x}=this.getBlockWidthHeight(n);let {x:K,y:J}=C,{width:G,height:O,wrapCount:R}=E;var T=this._getRasterTileAlignmentInfo(n,0);I.buffer&&(K-=I.buffer.cols,J-=I.buffer.rows,G+=2*I.buffer.cols,O+=2*I.buffer.rows);var X=0,L=0;let V=0;R&&null!=T&&({worldColumnCountFromOrigin:L,originColumnOffset:V,
rightPadding:X}=T,L*T.blockWidth-X>=K+G&&(X=0));C=Math.floor(K/F);E=Math.floor(J/x);const W=Math.floor((K+G+X-1)/F);X=Math.floor((J+O+X-1)/x);var Y=U[n];if(!Y)return null;const {minRow:Z,minCol:aa,maxCol:fa,maxRow:ea}=Y;if(0===R&&(X<Z||W<aa||E>ea||C>fa))return null;Y=[];let ca=!1;const ja=null==this.ioConfig.allowPartialFill?I.allowPartialFill:this.ioConfig.allowPartialFill;for(let pa=E;pa<=X;pa++)for(let qa=C;qa<=W;qa++){let ra=qa;!I.disableWrapAround&&R&&null!=T&&L<=qa&&(ra=qa-L-V);if(pa>=Z&&ra>=
aa&&ea>=pa&&fa>=ra){const sa=this._fetchRawTile(n,pa,ra,I);ja?Y.push(new Promise(ua=>{sa.then(ma=>ua(ma)).catch(()=>{ca=!0;ua(null)})})):Y.push(sa)}else Y.push(Promise.resolve(null))}if(0===Y.length)return null;I=await Promise.all(Y);T={height:(X-E+1)*x,width:(W-C+1)*F};({spatialReference:L}=this.rasterInfo);n=this.getPyramidPixelSize(n);const {x:la,y:oa}=n;return{extent:new B({xmin:M.x+C*F*la,xmax:M.x+(W+1)*F*la,ymin:M.y-(X+1)*x*oa,ymax:M.y-E*x*oa,spatialReference:L}),pixelBlocks:I,mosaicSize:T,
isPartiallyFilled:ca}}_isSameResolution(n,C,E){return Math.abs(n.x-C.x)<E&&Math.abs(n.y-C.y)<E}_fetchRawTile(n,C,E,I){var M=this.rasterInfo.storageInfo.blockBoundary[n];if(!M)return Promise.resolve(null);const {minRow:U,minCol:F,maxCol:x,maxRow:K}=M;if(C<U||E<F||C>K||E>x)return Promise.resolve(null);const J=g.getRasterId(this.url,I.sliceId),G=`${n}/${C}/${E}`;M=g.getBlock(J,I.registryId,G);if(null==M){const O=new AbortController;M=this.fetchRawTile(n,C,E,{...I,signal:O.signal});g.putBlock(J,I.registryId,
G,M,O);M.catch(()=>g.deleteBlock(J,I.registryId,G))}if(I.signal)P.onAbort(I,()=>{g.decreaseRefCount(J,I.registryId,G)});return M}_computeMagDirValues(n){const {bandCount:C,dataType:E}=this.rasterInfo;if((2!==C||"vector-magdir"!==E)&&"vector-uv"!==E||2!==n?.length||!n[0]?.length)return null;var I=n[0].length;if("vector-magdir"===E)return I=n[1].map(x=>(x+360)%360),[n[0],I];const [M,U]=n;n=[];const F=[];for(let x=0;x<I;x++){const [K,J]=r.uvComponentToVector([M[x],U[x]]);n.push(K);F.push(J)}return[n,
F]}_getRasterTileAlignmentInfo(n,C){null==this._rasterTileAlighmentInfo&&(this._rasterTileAlighmentInfo=k.getRasterDatasetAlignmentInfo(this.rasterInfo));return null==this._rasterTileAlighmentInfo.pyramidsInfo?null:{startX:C,halfWorldWidth:this._rasterTileAlighmentInfo.halfWorldWidth,hasGCSSShiftTransform:this._rasterTileAlighmentInfo.hasGCSSShiftTransform,...this._rasterTileAlighmentInfo.pyramidsInfo[n]}}_getSourceDataInfo(n,C,E,I={}){const M={datumTransformation:I.datumTransformation,pyramidLevel:0,
pyramidResolution:null,srcExtent:null,srcHeight:0,srcResolution:null,srcWidth:0,ul:{x:0,y:0}};I.srcResolution&&(M.srcResolution=I.srcResolution,this._updateSourceDataInfo(n,M));var U=this.rasterInfo.storageInfo.maximumPyramidLevel||0;const {srcWidth:F,srcHeight:x,pyramidLevel:K}=M;var J=F/C;const G=x/E,O=K<U&&16<=J*G;var R=K===U&&this._requireTooManySrcTiles(F,x,C,E);if(O||R||0===F||0===x){R=new A({x:(n.xmax-n.xmin)/C,y:(n.ymax-n.ymin)/E,spatialReference:n.spatialReference});R=k.projectResolution(R,
this.rasterInfo.spatialReference,n,M.datumTransformation);const T=!R||I.srcResolution&&R.x+R.y<I.srcResolution.x+I.srcResolution.y;O&&I.srcResolution&&T&&(J=Math.round(Math.log(Math.max(J,G))/Math.LN2)-1,U-K+3>=J&&(U=2**J,R={x:I.srcResolution.x*U,y:I.srcResolution.y*U}));R&&(M.srcResolution=R,this._updateSourceDataInfo(n,M))}this._requireTooManySrcTiles(M.srcWidth,M.srcHeight,C,E)&&(M.srcWidth=0,M.srcHeight=0);return M}_requireTooManySrcTiles(n,C,E,I){const {tileInfo:M}=this.rasterInfo.storageInfo;
return 256<=Math.ceil(n/M.size[0])*Math.ceil(C/M.size[1])||8<n/E||8<C/I}_updateSourceDataInfo(n,C){C.srcWidth=0;C.srcHeight=0;var {rasterInfo:E}=this,I=E.spatialReference;const {srcResolution:M,datumTransformation:U}=C,{pyramidLevel:F,pyramidResolution:x,excessiveReading:K}=k.snapPyramid(M,E,this.ioConfig.sampling);if(!K&&(n=C.srcExtent||k.projectExtent(n,I,U),null!=n)){(I=E.transform)&&(n=I.inverseTransform(n));C.srcExtent=n;var {x:J,y:G}=E.storageInfo.origin;E=Math.floor((n.xmin-J)/x.x+.1);I=Math.floor((G-
n.ymax)/x.y+.1);var O=Math.floor((n.xmax-J)/x.x-.1),R=Math.floor((G-n.ymin)/x.y-.1);O=n.width<.1*x.x?0:O-E+1;n=n.height<.1*x.y?0:R-I+1;C.pyramidLevel=F;C.pyramidResolution=x;C.srcWidth=O;C.srcHeight=n;C.ul={x:E,y:I}}}_getRequestOptionsWithSliceId(n){null!=this.rasterInfo.multidimensionalInfo&&null==n.sliceId&&(n={...n,sliceId:this.getSliceIndex(n.multidimensionalDefinition)});return n}_processIdentifyResult(n,C){const {srcLocation:E,position:I,pyramidLevel:M,useTransposedTile:U}=C,F=n.pixels[0].length/
n.width/n.height;if(n.mask&&!n.mask[I])return{location:E,value:null};const {multidimensionalInfo:x}=this.rasterInfo;if(null==x||!U)return C=n.pixels.map(X=>X[I]),n={location:E,value:C,pyramidLevel:M},C=this._computeMagDirValues(C.map(X=>[X])),C?.length&&(n.magdirValue=C.map(X=>X[0])),n;let K=n.pixels.map(X=>X.slice(I*F,I*F+F)),J=this._computeMagDirValues(K);const {requestSomeSlices:G,identifyOptions:O}=C;let R=a.createSlices(x,O.transposedVariableName);if(G){const X=a.getSliceIds(R,O.multidimensionalDefinition,
O.timeExtent);K=K.map(L=>X.map(V=>L[V]));J=J?.map(L=>X.map(V=>L[V]));R=X.map(L=>R[L])}C=n.noDataValues||this.rasterInfo.noDataValue;n={pixels:K,pixelType:n.pixelType};let T;null!=C&&(d.convertNoDataToMask(n,C),T=n.mask);n=R.map((X,L)=>{X={value:0===T?.[L]?null:K.map(V=>V[L]),multidimensionalDefinition:X.multidimensionalDefinition.map(V=>new t({...V,isSlice:!0}))};J?.length&&(X.magdirValue=[J[0][L],J[1][L]]);return X});return{location:E,value:null,dataSeries:n,pyramidLevel:M}}};m.__decorate([H.property()],
w.prototype,"_rasterTileAlighmentInfo",void 0);m.__decorate([H.property({readOnly:!0})],w.prototype,"_isGlobalWrappableSource",null);m.__decorate([H.property({readOnly:!0})],w.prototype,"_hasNoneOrGCSShiftTransform",null);m.__decorate([H.property()],w.prototype,"rasterJobHandler",null);m.__decorate([H.property(q.url)],w.prototype,"url",null);m.__decorate([H.property({type:String,json:{write:!0}})],w.prototype,"datasetName",void 0);m.__decorate([H.property({type:String,json:{write:!0}})],w.prototype,
"datasetFormat",void 0);m.__decorate([H.property()],w.prototype,"hasUniqueSourceStorageInfo",void 0);m.__decorate([H.property()],w.prototype,"rasterInfo",void 0);m.__decorate([H.property()],w.prototype,"ioConfig",void 0);m.__decorate([H.property()],w.prototype,"sourceJSON",void 0);return w=m.__decorate([e.subclass("esri.layers.support.rasterDatasets.BaseRaster")],w)})},"esri/layers/support/RasterStorageInfo":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../geometry/Point".split(" "),
function(m,w,z,N,D,S,Q){var P;w=P=class extends w.JSONSupport{constructor(){super(...arguments);this.blockHeight=this.blockWidth=void 0;this.maximumPyramidLevel=this.firstPyramidLevel=this.origin=this.compression=null;this.pyramidScalingFactor=2;this.pyramidBlockHeight=this.pyramidBlockWidth=null;this.isVirtualTileInfo=!1;this.blockBoundary=this.transposeInfo=this.tileInfo=null}clone(){return new P({blockWidth:this.blockWidth,blockHeight:this.blockHeight,compression:this.compression,origin:z.clone(this.origin),
firstPyramidLevel:this.firstPyramidLevel,maximumPyramidLevel:this.maximumPyramidLevel,pyramidResolutions:z.clone(this.pyramidResolutions),pyramidScalingFactor:this.pyramidScalingFactor,pyramidBlockWidth:this.pyramidBlockWidth,pyramidBlockHeight:this.pyramidBlockHeight,isVirtualTileInfo:this.isVirtualTileInfo,tileInfo:z.clone(this.tileInfo),transposeInfo:z.clone(this.transposeInfo),blockBoundary:z.clone(this.blockBoundary)})}};m.__decorate([N.property({type:Number,json:{write:!0}})],w.prototype,"blockWidth",
void 0);m.__decorate([N.property({type:Number,json:{write:!0}})],w.prototype,"blockHeight",void 0);m.__decorate([N.property({type:String,json:{write:!0}})],w.prototype,"compression",void 0);m.__decorate([N.property({type:Q,json:{write:!0}})],w.prototype,"origin",void 0);m.__decorate([N.property({type:Number,json:{write:!0}})],w.prototype,"firstPyramidLevel",void 0);m.__decorate([N.property({type:Number,json:{write:!0}})],w.prototype,"maximumPyramidLevel",void 0);m.__decorate([N.property({json:{write:!0}})],
w.prototype,"pyramidResolutions",void 0);m.__decorate([N.property({type:Number,json:{write:!0}})],w.prototype,"pyramidScalingFactor",void 0);m.__decorate([N.property({type:Number,json:{write:!0}})],w.prototype,"pyramidBlockWidth",void 0);m.__decorate([N.property({type:Number,json:{write:!0}})],w.prototype,"pyramidBlockHeight",void 0);m.__decorate([N.property({type:Boolean,json:{write:!0}})],w.prototype,"isVirtualTileInfo",void 0);m.__decorate([N.property({json:{write:!0}})],w.prototype,"tileInfo",
void 0);m.__decorate([N.property()],w.prototype,"transposeInfo",void 0);m.__decorate([N.property()],w.prototype,"blockBoundary",void 0);return w=P=m.__decorate([S.subclass("esri.layers.support.RasterStorageInfo")],w)})},"esri/layers/support/rasterDatasets/multidimensionalUtils":function(){define(["exports","../../../core/arrayUtils","../DimensionalDefinition"],function(m,w,z){function N(l,q,t){const h=q.shift();0===t.length&&t.push({sliceId:-1,multidimensionalDefinition:[]});const p=t.length;for(let v=
0;v<p;v++){const a=t.shift().multidimensionalDefinition;h.values?.forEach(g=>{t.push({sliceId:-1,multidimensionalDefinition:[...a,{variableName:l,dimensionName:h.name,values:[g]}]})})}q.length&&N(l,q,t)}function D(l,q){return Array.isArray(l)?q[0]===q[1]?l[0]===q[0]||l[1]===q[0]:l[0]>=q[0]&&l[0]<=q[1]&&l[1]>=q[0]&&l[1]<=q[1]:l>=q[0]&&l<=q[1]}function S(l,q){return l[0]<=q[0]&&l[1]>=q[0]||l[0]<=q[1]&&l[1]>=q[1]||l[0]>=q[0]&&l[1]<=q[1]}function Q(l){return 1===l.length?[l[0],l[0]]:[l[0],l[l.length-
1]]}function P(l,q,t){if(!q?.subsetDefinitions?.length)return l;if(t){const {variables:p}=q;if(p.length&&!p.includes(t))return null;q=q.subsetDefinitions.find(v=>v.dimensionName===l.name&&v.variableName===t);if(!q?.values?.length)return l;q=Q(q.values)}else q=q.dimensions.find(({name:p})=>p===l.name)?.extent;const h=q;if(!h?.length)return l;q=l.values.filter(p=>D(p,h));return{...l,extent:[...h],values:q}}function H(l,q,t){if(!q?.subsetDefinitions?.length)return!1;const {variables:h}=q;if(h.length&&
l.some(({variableName:p})=>p&&!h.includes(p)))return!0;for(let p=0;p<l.length;p++){const v=l[p],a=q.subsetDefinitions.find(g=>(""===v.variableName||g.variableName===v.variableName)&&g.dimensionName===v.dimensionName);if(a?.values.length){const g=Q(a.values);if(!v.isSlice&&2===v.values.length&&!Array.isArray(v.values[0])&&v.values[0]!==v.values[1]&&t){if(!S(v.values,g))return!0}else if(v.values.some(d=>!D(d,g)))return!0}}return!1}function y(l,q){var t=l.dimensions.find(({name:a})=>"StdTime"===a);if(null==
t||null==q.start&&null==q.end)return q;q=q.clone();const {start:h,end:p}=q.toJSON(),v=h===p?[h]:null!=h&&null!=p?[h,p]:[h??p];if(2===v.length&&t?.extent.length&&(v[0]=Math.max(v[0],t.extent[0]),v[1]=Math.min(v[1],t.extent[1]??t.extent[0]),v[1]<v[0]))return null;t=new z({variableName:"",dimensionName:"StdTime",isSlice:1===v.length,values:v});if(H([t],l,!0))return null;q.start=new Date(v[0]);q.end=new Date(v[1]??v[0]);return q}function u(l,q={}){const {multidimensionalInfo:t,keyProperties:h}=l;if(null==
t)return null;const {variableName:p,multidimensionalSubset:v,multidimensionalDefinition:a}=q;l=null!=a?a[0]?.variableName:null;const g=p||l||h?.DefaultVariable;({variables:l}=t);v?.variables?.length&&(l=l.filter(({name:d})=>v.variables.includes(d)));return g?l.find(({name:d})=>d===g)??l[0]:l[0]}function c(l,q){var {values:t}=q;if(t?.length){q=Array.isArray(t[0]);var h=Array.isArray(l);return q!==h?-1:q&&h?t.findIndex(v=>v[0]===l[0]&&v[1]===l[1]):t.indexOf(l)}({extent:h}=q);if(Array.isArray(l)||l<
h[0]||l>h[1])return-1;t=q.interval||1;if("ISO8601"!==q.unit)return Math.round((l-h[0])/t);h=h[0];let p=-1;switch(q.intervalUnit?.toLowerCase()||"seconds"){case "seconds":p=Math.round((l-h)/1E3/t);break;case "minutes":p=Math.round((l-h)/6E4/t);break;case "hours":p=Math.round((l-h)/36E5/t);break;case "days":p=Math.round((l-h)/864E5/t);break;case "months":q=(new Date(l)).getUTCFullYear()-(new Date(h)).getUTCFullYear();t=(new Date(h)).getUTCMonth();h=(new Date(l)).getUTCMonth();p=0===q?h-t:h+11-t+12*
(q-1);break;case "years":p=Math.round(((new Date(l)).getUTCFullYear()-(new Date(h)).getUTCFullYear())/t);break;case "decades":p=Math.round(((new Date(l)).getUTCFullYear()-(new Date(h)).getUTCFullYear())/10/t)}return p}function e(l){var q=l.values?.length;if(q)return q;const {extent:t,unit:h}=l;q=l.interval||1;var p=t?t[1]-t[0]:0;if("ISO8601"!==h)return Math.round(p/q);switch(l.intervalUnit?.toLowerCase()??"seconds"){case "seconds":q=Math.round(p/1E3/q);break;case "minutes":q=Math.round(p/6E4/q);break;
case "hours":q=Math.round(p/36E5/q);break;case "days":q=Math.round(p/864E5/q);break;case "months":l=(new Date(t[1])).getUTCFullYear()-(new Date(t[0])).getUTCFullYear();q=(new Date(t[0])).getUTCMonth();p=(new Date(t[1])).getUTCMonth();q=0===l?p-q+1:p+11-q+12*(l-1)+1;break;case "years":q=Math.round(((new Date(t[1])).getUTCFullYear()-(new Date(t[0])).getUTCFullYear())/q);break;case "decades":q=Math.round(((new Date(t[1])).getUTCFullYear()-(new Date(t[0])).getUTCFullYear())/10/q);break;default:q=0}return q}
m.createSlices=function(l,q){const t=[];let h=0;(q?l.variables.filter(p=>p.name.toLowerCase()===q.toLowerCase()):[...l.variables].sort((p,v)=>p.name>v.name?1:-1)).forEach(p=>{const v=[],a=[...p.dimensions].sort((g,d)=>g.name>d.name?-1:1);N(p.name,a,v);v.forEach(g=>{t.push({...g,sliceId:h++})})});return t};m.getDefaultMultidimensionalDefinition=function(l,q={}){var t=u(l,q);if(!t)return null;l=[];const {dimensions:h,name:p}=t;if(0===h.length)return[new z({variableName:p,dimensionName:"",values:[],
isSlice:!0})];for(t=0;t<h.length;t++){const v=P(h[t],q.multidimensionalSubset,p);if(!v)return null;const {values:a,extent:g}=v;let d=a?.[0]??g[0];"stdz"===v.name.toLowerCase()&&!v.hasRanges&&Math.abs(g[1])<=Math.abs(g[0])&&(d=a?.length?a[a.length-1]:g[1]);l.push(new z({variableName:p,dimensionName:v.name,values:[d],isSlice:q.useRangeForRangedDimensionInfo?!!v.hasRanges:!0}))}return l};m.getDefaultVariablInfo=u;m.getSliceIds=function(l,q,t){let h=l;q&&(q=[...q].sort((p,v)=>p.dimensionName<v.dimensionName?
-1:1),q.forEach(({dimensionName:p,values:v,isSlice:a})=>{v.length&&(h=h.filter(g=>{g=g.multidimensionalDefinition.find(b=>b.dimensionName===p);if(null==g)return!1;const d=g.values[0];return"number"===typeof d?"number"===typeof v[0]?v.includes(d):v.some(b=>b[0]<=d&&b[1]>=d):"number"===typeof v[0]?v.some(b=>d[0]<=b&&d[1]>=b):a?v.some(b=>b[0]===d[0]&&b[0]===d[1]):v.some(b=>b[0]>=d[0]&&b[0]<=d[1]||b[1]>=d[0]&&b[1]<=d[1]||b[0]<d[0]&&b[1]>d[1])}))}));if(h.length&&null!=t?.start&&null!=t.end){const p=t.start.getTime(),
v=t.end.getTime(),a=h[0].multidimensionalDefinition.findIndex(g=>"StdTime"===g.dimensionName);-1<a&&(h=h.filter(g=>{g=g.multidimensionalDefinition[a].values[0];return p<=g&&v>=g}))}return h.map(p=>p.sliceId)};m.getSliceIndex=function(l,q){let t=0;var h=l[0].variableName;q=[...q.variables].sort((v,a)=>v.name>a.name?1:-1);for(var p=0;p<q.length;p++){const v=q[p],a=[...v.dimensions].sort((g,d)=>g.name>d.name?-1:1);if(v.name!==h)t+=a.map(g=>e(g)).reduce((g,d)=>g*d);else{h=a.map(g=>e(g));q=a.length;for(let g=
0;g<q;g++){p=l.find(d=>d.dimensionName===a[g].name);if(null==p)return null;p=c(p.values[0],a[g]);if(-1===p)return null;h.shift();t=g===q-1?t+p:t+p*h.reduce((d,b)=>d*b)}break}}return t};m.getSubsetVariablesFromMdInfo=function(l,q){if(null==q||null==l)return null;q=q.variables.map(t=>({...t}));l?.variables?.length&&(q=q.filter(({name:t})=>l.variables.includes(t)),q.forEach(t=>{t.dimensions=t.dimensions.map(h=>P(h,l,t.name)).filter(w.isSome)}));return q};m.hasExcludedVariableOrDimension=H;m.intersectMultimensionalSubset=
function(l,q){if(null==l)return{isOutside:!1};const {geometry:t,timeExtent:h,multidimensionalDefinition:p}=q;q=null;if(null!=h&&(q=y(l,h),null==q))return{isOutside:!0};const {areaOfInterest:v}=l;if(v&&t){const a="point"===t.type?t:"extent"===t.type?t.center:"polygon"===t.type?t.centroid:null;if(a&&!v.contains(a))return{isOutside:!0}}return null!=p&&p.length&&H(p,l,!0)?{isOutside:!0}:{isOutside:!1,intersection:{geometry:t,timeExtent:q,multidimensionalDefinition:p}}};m.isMultiSliceOrRangeDefinition=
function(l){return l?.length?l.some(q=>{if(null==q.values)return!0;const t=q.values.length;return 0===t||1<t||!q.isSlice&&Array.isArray(q.values[0])}):!1};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/RawBlockCache":function(){define(["exports","../../../geometry","./EphemeralBlockCache","../rasterFunctions/rasterProjectionHelper","../../../geometry/Point"],function(m,w,z,N,D){function S(H,y){return(H=Q.get(H))?H[y]??null:null}const Q=new Map,
P=new z;m.decreaseRefCount=function(H,y,u){const c=Q.get(H);if(!c)return null==y?P.decreaseRefCount(H,u):0;if(null==y||null==c[y])return P.decreaseRefCount(H,u);y=c[y]?.cache;H=y?.get(u);if(y&&H){H.refCount--;if(0===H.refCount){y.delete(u);for(y=0;y<c.length;y++)c[y]?.cache.delete(u);H.controller&&H.controller.abort()}return H.refCount}return 0};m.deleteBlock=function(H,y,u){const c=Q.get(H);c?null==y||null==c[y]?P.deleteBlock(H,u):c[y]?.cache.delete(u):null==y&&P.deleteBlock(H,u)};m.deleteRaster=
function(H){Q.delete(H)};m.getBlock=function(H,y,u){const c=Q.get(H);if(!c)return null==y?P.getBlock(H,u):null;if(null==y||null==c[y]){for(y=0;y<c.length;y++){var e=c[y]?.cache.get(u);if(e)return e.refCount++,e.block}return P.getBlock(H,u)}if(H=c[y]?.cache.get(u))return H.refCount++,H.block;for(H=0;H<c.length;H++){if(H===y||!c[H])continue;e=c[H]?.cache;const l=e?.get(u);if(e&&l)return l.refCount++,e.set(u,l),l.block}return null};m.getRasterId=function(H,y){return null==y?H:`${H}?sliceId=${y}`};m.putBlock=
function(H,y,u,c,e=null){const l=Q.get(H);if(l)if(null==y||null==l[y])P.putBlock(H,u,c,e);else{var q={refCount:1,block:c,isResolved:!1,isRejected:!1,controller:e};c.then(()=>q.isResolved=!0).catch(()=>q.isRejected=!0);l[y]?.cache.set(u,q)}else null==y&&P.putBlock(H,u,c,e)};m.register=function(H,y){y={extent:null,rasterInfo:y,cache:new Map};const u=Q.get(H);if(u)return u.push(y),u.length-1;Q.set(H,[y]);return 0};m.unregister=function(H,y){const u=Q.get(H);u&&(u[y]=null,u.some(c=>null!=c)||Q.delete(H))};
m.update=function(H,y,u,c,e,l,q=null){if(H=S(H,y)){y=H.extent;var {cache:t,rasterInfo:h}=H;if(!y||y.xmin!==u.xmin||y.xmax!==u.xmax||y.ymin!==u.ymin||y.ymax!==u.ymax){c=c??0;y=u.clone().normalize();var {spatialReference:p,transform:v}=h,a=new Set;for(let r=0;r<y.length;r++){var g=y[r];if(g.xmax-g.xmin<=c||g.ymax-g.ymin<=c)continue;var d=N.projectExtent(g,p,q);null!=v&&(d=v.inverseTransform(d));var b=new D({x:c,y:c,spatialReference:g.spatialReference});if(null==e&&(e=N.projectResolution(b,p,g,q),!e))return;
const {pyramidLevel:B,pyramidResolution:A,excessiveReading:n}=N.snapPyramid(e,h,l||"closest");if(n)return;({storageInfo:g}=h);var {origin:f}=g;b=Math.max(0,Math.floor((d.xmin-f.x)/A.x));f=Math.max(0,Math.floor((f.y-d.ymax)/A.y));const C=0<B?g.pyramidBlockWidth:g.blockWidth,E=0<B?g.pyramidBlockHeight:g.blockHeight;g=Math.max(0,Math.floor(b/C)-1);var k=Math.max(0,Math.floor(f/E)-1);b=Math.floor((b+Math.ceil((d.xmax-d.xmin)/A.x-.1)-1)/C)+1;d=Math.floor((f+Math.ceil((d.ymax-d.ymin)/A.y-.1)-1)/E)+1;for(f=
k;f<=d;f++)for(k=g;k<=b;k++)a.add(`${B}/${f}/${k}`)}t.forEach((r,B)=>{a.has(B)||(r=t.get(B),(null==r||r.isResolved||r.isRejected)&&t.delete(B))});H.extent={xmin:u.xmin,ymin:u.ymin,xmax:u.xmax,ymax:u.ymax}}}};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/EphemeralBlockCache":function(){define(function(){class m{constructor(w=15E3,z=5E3){this._timer=null;this._cachedBlocks=new Map;this._size=-1;this._duration=w;this._interval=Math.min(w,z)}decreaseRefCount(w,
z){w=w+"/"+z;z=this._cachedBlocks;if(z.has(w)){const N=z.get(w);N.refCount--;0>=N.refCount&&(z.delete(w),N.controller&&N.controller.abort());return N.refCount}return 0}getBlock(w,z){w=w+"/"+z;z=this._cachedBlocks;if(z.has(w)){const N=z.get(w);N.ts=Date.now();N.refCount++;z.delete(w);z.set(w,N);return N.block}return null}putBlock(w,z,N,D){const S=this._cachedBlocks;w=w+"/"+z;S.has(w)?(N=S.get(w),N.ts=Date.now(),N.refCount++):S.set(w,{block:N,ts:Date.now(),refCount:1,controller:D});this._trim();this._updateTimer()}deleteBlock(w,
z){const N=this._cachedBlocks;w=w+"/"+z;N.has(w)&&N.delete(w)}updateMaxSize(w){this._size=w;this._trim()}empty(){this._cachedBlocks.clear();this._clearTimer()}getCurrentSize(){return this._cachedBlocks.size}_updateTimer(){if(null==this._timer){var w=this._cachedBlocks;this._timer=setInterval(()=>{const z=Array.from(w),N=Date.now();for(let D=0;D<z.length;D++)if(z[D][1].ts<=N-this._duration)w.delete(z[D][0]);else break;0===w.size&&this._clearTimer()},this._interval)}}_trim(){const w=this._cachedBlocks;
if(!(-1===this._size||this._size>=w.size)){var z=Array.from(w);for(let N=0;N<z.length-this._size;N++)w.delete(z[N][0])}}_clearTimer(){null!=this._timer&&(clearInterval(this._timer),this._timer=null)}}return m})},"esri/layers/support/rasterFunctions/rasterProjectionHelper":function(){define("exports ../../../geometry ../../../core/arrayUtils ../../../core/Error ../../../core/unitUtils ../../../chunks/pe ../../../geometry/projection ../../../geometry/support/spatialReferenceUtils ../../../geometry/Extent ../../../geometry/Point ../../../geometry/Polygon ../../../geometry/SpatialReference".split(" "),
function(m,w,z,N,D,S,Q,P,H,y,u,c){function e(L,V,W){return!Q.canProjectWithoutEngine(L,V,W)}function l(L,V,W){if((L=e(L,V,W))&&!Q.isLoaded())throw new N("rasterprojectionhelper-project","projection engine is not loaded");return L}function q(L,V,W){l(L.spatialReference,V);return W?Q.getTransformation(V,L.spatialReference,L):Q.getTransformation(L.spatialReference,V,L)}function t(L,V,W,Y=null){const Z=L.spatialReference;if(Z.equals(V))return L;l(Z,V,Y);W=W.center;W=new H({xmin:W.x-L.x/2,xmax:W.x+L.x/
2,ymin:W.y-L.y/2,ymax:W.y+L.y/2,spatialReference:Z});Y=Q.project(W,V,Y);W=E(V);null==Y||null!=W&&Y.width>=W?(V=D.getMetersPerUnitForSR(Z)/D.getMetersPerUnitForSR(V),L={x:L.x*V,y:L.y*V}):L={x:Y.width,y:Y.height};return L}function h(L,V=.01){return D.getMetersPerUnitForSR(L)?V/D.getMetersPerUnitForSR(L):0}function p(L,V,W=null,Y=!0){const Z=L.spatialReference;if(Z.equals(V))return L;l(Z,V,W);W=Q.project(L,V,W);if(!Y||!W)return W;v([L],[W],Z,V);return W}function v(L,V,W,Y){const Z=I(W,!0),aa=I(Y,!0);
W=h(W,500);Y=h(Y,500);if(W&&null!=Z&&null!=aa)for(let fa=0;fa<L.length;fa++){const ea=V[fa];if(!ea)continue;const {x:ca}=L[fa],{x:ja}=ea;ja>=aa[1]-Y&&Math.abs(ca-Z[0])<W?ea.x-=aa[1]-aa[0]:ja<=aa[0]+Y&&Math.abs(ca-Z[1])<W&&(ea.x+=aa[1]-aa[0])}}function a(L){const {inSR:V,outSR:W,datumTransformation:Y,preferPE:Z}=L;if(V.equals(W))return{points:L}=k(L,null),L;if(V.isWebMercator&&W.isWGS84||V.isWGS84&&W.isWebMercator){const {cols:ca,rows:ja,xres:la,yres:oa,usePixelCenter:pa,inSR:qa,outSR:ra}=L;let {xmin:sa,
ymax:ua}=L;pa&&(sa+=la/2,ua-=oa/2);L=[];const ma=[];var aa=Math.max(ca,ja);for(var fa=0;fa<aa;fa++){var ea=Q.project(new y({x:sa+la*Math.min(ca,fa),y:ua-oa*Math.min(ja,fa),spatialReference:qa}),ra);fa<=ca&&L.push(ea.x);fa<=ja&&ma.push(ea.y)}aa=[];for(fa=0;fa<ca;fa++)for(ea=0;ea<ja;ea++)aa.push([L[fa],ma[ea]]);return aa}return l(V,W,Y)&&Z&&(V.isGeographic||null!=b(V))?d(L):g(L)}function g(L){var {points:V}=k(L,null);const {inSR:W,outSR:Y,datumTransformation:Z}=L;L=V.map(aa=>new y(aa[0],aa[1],W));V=
Q.project(L,Y,Z);Z&&v(L,V,W,Y);return V.map(aa=>aa?[aa.x,aa.y]:[NaN,NaN])}function d(L){const {inSR:V,outSR:W,datumTransformation:Y}=L;var Z=b(V);const {points:aa,mask:fa}=k(L,Z);V.isGeographic||(L=V.wkid?S.PeFactory.coordsys(V.wkid):S.PeFactory.fromString(V.isGeographic?S.PeDefs.PE_TYPE_GEOGCS:S.PeDefs.PE_TYPE_PROJCS,V.wkt2||V.wkt),S.PeCSTransformations.projToGeog(L,aa.length,aa));if(null!=Y&&Y.steps.length){var ea;W.isGeographic&&(ea=aa.map(([ca])=>179.9955<ca?1:-179.9955>ca?-1:0));Y.steps.forEach(ca=>
{const ja=ca.wkid?S.PeFactory.geogtran(ca.wkid):S.PeFactory.fromString(S.PeDefs.PE_TYPE_GEOGTRAN,ca.wkt);S.PeGTTransformations.geogToGeog(ja,aa.length,aa,null,ca.isInverse?S.PeDefs.PE_TRANSFORM_2_TO_1:S.PeDefs.PE_TRANSFORM_1_TO_2)});if(ea)for(L=0;L<aa.length;L++){Z=ea[L];const ca=aa[L][0],ja=179.9955<ca?1:-179.9955>ca?-1:0;Z&&ja&&Z!==ja&&(aa[L][0]=0<Z?ca+360:ca-360)}}W.isGeographic||(ea=b(W,!0),r(aa,null!=ea&&ea.isEnvelope?[ea.bbox[1],ea.bbox[3]]:[-90,90]),ea=W.wkid?S.PeFactory.coordsys(W.wkid):S.PeFactory.fromString(W.isGeographic?
S.PeDefs.PE_TYPE_GEOGCS:S.PeDefs.PE_TYPE_PROJCS,W.wkt2||W.wkt),S.PeCSTransformations.geogToProj(ea,aa.length,aa));ea=aa;if(fa&&aa.length!==fa.length){ea=[];for(let ca=0,ja=0;ca<fa.length;ca++)fa[ca]?ea.push(aa[ja++]):ea.push([NaN,NaN])}return ea}function b(L,V=!1){var W=L.wkid||L.wkt2||L.wkt;if(!W||L.isGeographic)return null;W=String(W);if(T.has(W))return W=T.get(W),V?W?.gcs:W?.pcs;var Y=L.wkid?S.PeFactory.coordsys(L.wkid):S.PeFactory.fromString(L.isGeographic?S.PeDefs.PE_TYPE_GEOGCS:S.PeDefs.PE_TYPE_PROJCS,
L.wkt2||L.wkt);L=h(L,1E-4);L=f(Y,L);Y=f(Y,0,!0);T.set(W,{pcs:L,gcs:Y});return V?Y:L}function f(L,V=0,W=!1){var Y=S.PePCSInfo.generate(L),Z=W?L.horizonGcsGenerate():L.horizonPcsGenerate();if(!Y||!Z?.length)return null;L=!1;var aa=Z.find(la=>1===la.getInclusive()&&1===la.getKind());if(!aa){aa=Z.find(la=>1===la.getInclusive()&&0===la.getKind());if(!aa)return null;L=!0}W=W?0:(2===Y.getNorthPoleLocation()?1:0)|(2===Y.getSouthPoleLocation()?2:0);Y=Y.isPannableRectangle();aa=aa.getCoord();if(L)return{isEnvelope:L,
isPannable:Y,vertices:aa,coef:null,bbox:[aa[0][0]-V,aa[0][1]-V,aa[1][0]+V,aa[1][1]+V],poleLocation:W};V=0;L=[];let [fa,ea]=aa[0],[ca,ja]=aa[0];for(let la=0,oa=aa.length;la<oa;la++){V++;V===oa&&(V=0);const [pa,qa]=aa[la],[ra,sa]=aa[V];if(sa===qa)L.push([pa,ra,qa,sa,2]);else{Z=(ra-pa)/(sa-qa||1E-4);const ua=pa-Z*qa;qa<sa?L.push([Z,ua,qa,sa,0]):L.push([Z,ua,sa,qa,1])}fa=fa<pa?fa:pa;ea=ea<qa?ea:qa;ca=ca>pa?ca:pa;ja=ja>qa?ja:qa}return{isEnvelope:!1,isPannable:Y,vertices:aa,coef:L,bbox:[fa,ea,ca,ja],poleLocation:W}}
function k(L,V){const W=[],{cols:Y,rows:Z,xres:aa,yres:fa,usePixelCenter:ea}=L;let {xmin:ca,ymax:ja}=L;ea&&(ca+=aa/2,ja-=fa/2);if(null==V){for(L=0;L<Y;L++)for(V=0;V<Z;V++)W.push([ca+aa*L,ja-fa*V]);return{points:W}}L=new Uint8Array(Y*Z);if(V.isEnvelope){const {bbox:[ua,ma,wa,ba]}=V;for(let ia=0,da=0;ia<Y;ia++){var la=ca+aa*ia,oa=V.isPannable||la>=ua&&la<=wa;for(var pa=0;pa<Z;pa++,da++){var qa=ja-fa*pa;oa&&qa>=ma&&qa<=ba&&(W.push([la,qa]),L[da]=1)}}return{points:W,mask:L}}la=V.coef;V=[];for(oa=0;oa<
Z;oa++){var ra=ja-fa*oa;pa=[];qa=[];for(var sa=0;sa<la.length;sa++){const [ua,ma,wa,ba,ia]=la[sa];ra===wa&&wa===ba?(pa.push(ua),pa.push(ma),qa.push(2),qa.push(2)):ra>=wa&&ra<=ba&&(pa.push(ua*ra+ma),qa.push(ia))}ra=pa;if(2<pa.length){sa=2===qa[0]?0:qa[0];let ua=pa[0];ra=[];for(let ma=1;ma<qa.length;ma++)if(2!==qa[ma]||ma===qa.length-1)qa[ma]!==sa&&(ra.push(0===sa?Math.min(ua,pa[ma-1]):Math.max(ua,pa[ma-1])),sa=qa[ma],ua=pa[ma]),ma===qa.length-1&&ra.push(0===qa[ma]?Math.min(ua,pa[ma]):Math.max(ua,pa[ma]));
ra.sort((ma,wa)=>ma-wa)}else pa[0]>pa[1]&&(ra=[pa[1],pa[0]]);V.push(ra)}for(let ua=0,ma=0;ua<Y;ua++)for(la=ca+aa*ua,oa=0;oa<Z;oa++,ma++)if(pa=ja-fa*oa,qa=V[oa],2===qa.length)la>=qa[0]&&la<=qa[1]&&(W.push([la,pa]),L[ma]=1);else if(2<qa.length){ra=!1;for(sa=0;sa<qa.length;sa+=2)if(la>=qa[sa]&&la<=qa[sa+1]){ra=!0;break}ra&&(W.push([la,pa]),L[ma]=1)}return{points:W,mask:L}}function r(L,V){const [W,Y]=V;for(V=0;V<L.length;V++){const Z=L[V][1];if(Z<W||Z>Y)L[V]=[NaN,NaN]}}function B(L,V){const W=E(L[0].spatialReference);
if(2>L.length||null==W)return L[0];V=V??h(L[0].spatialReference);L=L.filter(ea=>ea.width>V);if(1===L.length)return L[0];let {xmin:Y,xmax:Z,ymin:aa,ymax:fa}=L[0];for(let ea=1;ea<L.length;ea++){const ca=L[ea];Z=ca.xmax+W*ea;aa=Math.min(aa,ca.ymin);fa=Math.max(fa,ca.ymax)}return new H({xmin:Y,xmax:Z,ymin:aa,ymax:fa,spatialReference:L[0].spatialReference})}function A(L,V,W=null,Y=!0){var Z=L.spatialReference;if(Z.equals(V))return L;var aa=U(L);const fa=E(Z,!0);var ea=E(V);if(0===aa||null==fa||null==ea)return aa=
C(L,V,W,Y),null==fa&&null!=ea&&Math.abs(aa.width-ea)<h(V)&&Q.isLoaded()&&(Z=b(Z),null!=Z&&Z.poleLocation===G.None&&L.width<(Z.bbox[2]-Z.bbox[0])/2)?n(L,V)||aa:aa;ea=L.clone().normalize();if(1===ea.length&&L.xmax<fa&&L.xmax-fa/2>h(Z)){const {xmin:ca,xmax:ja}=L;for(let la=0;la<=aa;la++)ea[la]=new H({xmin:0===la?ca:-fa/2,xmax:la===aa?ja-fa*la:fa/2,ymin:L.ymin,ymax:L.ymax,spatialReference:Z})}L=ea.map(ca=>C(ca,V,W,Y));return B(L.filter(z.isSome))}function n(L,V){const W=E(V);if(null==W)return null;let {xmin:Y,
ymin:Z,xmax:aa,ymax:fa}=L;var ea=L.spatialReference;L=new u({spatialReference:ea,rings:[[[Y,Z],[aa,Z],[aa,fa],[Y,fa],[Y,Z]]]});L=Q.project(L,V);if(2!==L.rings.length||!L.rings[0].length||!L.rings[1].length)return null;({rings:L}=L);ea=h(ea);V=new H({spatialReference:V});for(let ca=0;2>ca;ca++){Y=aa=L[ca][0][0];Z=fa=L[ca][0][1];for(let ja=0;ja<L[ca].length;ja++)Y=Y>L[ca][ja][0]?L[ca][ja][0]:Y,aa=aa<L[ca][ja][0]?L[ca][ja][0]:aa,Z=Z>L[ca][ja][1]?L[ca][ja][1]:Z,fa=fa<L[ca][ja][1]?L[ca][ja][1]:fa;if(0===
ca)V.ymin=Z,V.ymax=fa,V.xmin=Y,V.xmax=aa;else if(V.ymin=Math.min(V.ymin,Z),V.ymax=Math.max(V.ymax,fa),Math.abs(aa-W/2)<ea)V.xmin=Y,V.xmax+=W;else if(Math.abs(Y+W/2)<ea)V.xmax=aa+W;else return null}return V}function C(L,V,W=null,Y=!0,Z=!0){const aa=L.spatialReference;if(aa.equals(V)||!V)return L;l(aa,V,W);const fa=Q.project(L,V,W);if(Z&&V.isWebMercator&&fa&&(fa.ymax=Math.min(2.0037508342787E7,fa.ymax),fa.ymin=Math.max(-2.0037508342787E7,fa.ymin),fa.ymin>=fa.ymax))return null;if(!Y||!fa)return fa;var ea=
I(aa,!0);Y=I(V,!0);if(null==ea||null==Y)return fa;Z=h(aa,.001);const ca=h(aa,500);var ja=h(V,.001);if(Math.abs(fa.xmin-Y[0])<ja&&Math.abs(fa.xmax-Y[1])<ja){ja=Math.abs(L.xmin-ea[0]);ea=Math.abs(ea[1]-L.xmax);if(ja<Z&&ea>ca){fa.xmin=Y[0];var la=[];la.push(new y(L.xmax,L.ymin,aa));la.push(new y(L.xmax,(L.ymin+L.ymax)/2,aa));la.push(new y(L.xmax,L.ymax,aa));la=la.map(oa=>p(oa,V,W)).filter(oa=>!isNaN(oa?.x)).map(oa=>oa.x);fa.xmax=Math.max.apply(null,la)}ea<Z&&ja>ca&&(fa.xmax=Y[1],Y=[],Y.push(new y(L.xmin,
L.ymin,aa)),Y.push(new y(L.xmin,(L.ymin+L.ymax)/2,aa)),Y.push(new y(L.xmin,L.ymax,aa)),L=Y.map(oa=>p(oa,V,W)).filter(oa=>!isNaN(oa?.x)).map(oa=>oa.x),fa.xmin=Math.min.apply(null,L))}else L=h(V,.001),Math.abs(fa.xmin-Y[0])<L&&(fa.xmin=Y[0]),Math.abs(fa.xmax-Y[1])<L&&(fa.xmax=Y[1]);return fa}function E(L,V=!1){return L?L.isWebMercator?2*(V?2.0037508342787E7:2.0037508342788905E7):L.wkid&&L.isGeographic?360:2*R[L.wkid]||null:null}function I(L,V=!1){if(L.isGeographic)return[-180,180];L=E(L,V);return null!=
L?[-L/2,L/2]:null}function M(L,V,W,Y){L=(L-V)/W;0!==L-Math.floor(L)?L=Math.floor(L):Y&&--L;return L}function U(L,V=!1){var W=E(L.spatialReference);if(null==W)return 0;const Y=V?0:-(W/2),Z=h(L.spatialReference),aa=!V&&Math.abs(L.xmin+W/2)<Z?-W/2:L.xmin;L=M(!V&&Math.abs(L.xmax-W/2)<Z?W/2:L.xmax,Y,W,!0);W=M(aa,Y,W,!1);return L-W}function F(L){const {projectedExtent:V,srcBufferExtent:W,pixelSize:Y,datumTransformation:Z,rasterTransform:aa}=L;var fa=V.spatialReference;const ea=W.spatialReference;var ca=
l(fa,ea);const {xmin:ja,ymin:la,xmax:oa,ymax:pa}=V,qa=E(ea),ra=null!=qa&&(L.hasWrapAround||"gcs-shift"===aa?.type);L=L.spacing||[32,32];var sa=L[0]*Y.x,ua=L[1]*Y.y;const ma=1===L[0],wa=Math.ceil((oa-ja)/sa-.1/L[0])+(ma?0:1),ba=Math.ceil((pa-la)/ua-.1/L[1])+(ma?0:1);sa=a({cols:wa,rows:ba,xmin:ja,ymax:pa,xres:sa,yres:ua,inSR:fa,outSR:ea,datumTransformation:Z,preferPE:4>=L[0],usePixelCenter:ma});ua=[];let ia,da=0;const ka=ma?-1:NaN,{xmin:na,xmax:ha,ymax:ta,width:va,height:xa}=W,ya=h(ea,500),Aa=null!=
qa&&0<na&&ha>qa/2;var Ba=!1;ca&&(Ba=b(fa),Ba=null!=Ba&&0<Ba.poleLocation);for(fa=0;fa<wa;fa++){ca=[];for(let Ca=0;Ca<ba;Ca++){var za=sa[fa*ba+Ca];ra&&za[0]>ha&&za[0]>qa/2-ya?za[0]-=qa:ra&&0===fa&&0>za[0]&&Aa&&!aa&&(za[0]+=qa);!za||isNaN(za[0])||isNaN(za[1])?(ua.push(ka),ua.push(ka),ca.push(null),da++):(aa&&(za=aa.inverseTransform(new y({x:za[0],y:za[1],spatialReference:ea})),za=[za.x,za.y]),ca.push(za),0<fa&&ra&&ia[Ca]&&za[0]<ia[Ca][0]&&(za[0]+=qa,Ba&&za[0]>ha&&za[0]>qa&&(za[0]-=qa)),ua.push((za[0]-
na)/va),ua.push((ta-za[1])/xa))}ia=ca}return{offsets:ua,error:null,coefficients:null,outofBoundPointCount:da,spacing:L,size:ma?[wa,ba]:[wa-1,ba-1]}}function x(L,V,W){const {cols:Y,rows:Z}=V;V=new Float32Array((Y-1)*(Z-1)*12);const aa=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),fa=new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(let pa=0;pa<Y-1;pa++){for(var ea=0;ea<Z-1;ea++){var ca=pa*Z*2+2*ea,ja=L[ca];const qa=L[ca+1];var la=L[ca+2],oa=L[ca+3];ca+=2*Z;const ra=L[ca],sa=L[ca+1],ua=L[ca+2];ca=L[ca+3];let ma=
0,wa=12*(ea*(Y-1)+pa);for(let ba=0;3>ba;ba++)V[wa++]=aa[ma++]*ja+aa[ma++]*la+aa[ma++]*ua;ma=0;for(la=0;3>la;la++)V[wa++]=aa[ma++]*qa+aa[ma++]*oa+aa[ma++]*ca;ma=0;for(oa=0;3>oa;oa++)V[wa++]=fa[ma++]*ja+fa[ma++]*ra+fa[ma++]*ua;ma=0;for(ja=0;3>ja;ja++)V[wa++]=fa[ma++]*qa+fa[ma++]*sa+fa[ma++]*ca}if(W)for(ea=0;ea<V.length;ea++)isNaN(V[ea])&&(V[ea]=-1)}return V}function K(L,V){L=L.clone().normalize();return 1===L.length?L[0]:B(L,V)}function J(L,V){const {pixelSize:W,extent:Y}=L;L=q(Y,V,!1);const Z=K(Y,
(W.x+W.y)/16);return A(Z,V,L)}var G;(function(L){L[L.None=0]="None";L[L.North=1]="North";L[L.South=2]="South";L[L.Both=3]="Both"})(G||(G={}));const O=(L,V,W,Y=0)=>{if(1===W[0])return[0,0];var Z=1,aa=-1,fa=1,ea=-1;for(var ca=0;ca<L.length;ca+=2)isNaN(L[ca])||(Z=Z>L[ca]?L[ca]:Z,aa=aa>L[ca]?aa:L[ca],fa=fa>L[ca+1]?L[ca+1]:fa,ea=ea>L[ca+1]?ea:L[ca+1]);const {cols:ja,rows:la}=V;V=(aa-Z)/ja/W[0];W=(ea-fa)/la/W[1];Y*=2;fa=0;ea=!1;Z=[0,0];for(aa=0;aa<ja-3;aa++){for(ca=0;ca<la-3;ca++){var oa=aa*la*2+2*ca;const pa=
Math.abs(((L[oa]+L[oa+4]+L[oa+4*la]+L[oa+4*la+4])/4-L[oa+2*la+2])/V);oa=Math.abs(((L[oa+1]+L[oa+5]+L[oa+4*la+1]+L[oa+4*la+5])/4-L[oa+2*la+3])/W);pa+oa>fa&&(fa=pa+oa,Z=[pa,oa]);if(Y&&fa>Y){ea=!0;break}}if(ea)break}return Z},R={3395:2.0037508342789244E7,3410:1.7334193943686873E7,3857:2.0037508342788905E7,3975:1.7367530445161372E7,4087:2.0037508342789244E7,4088:2.0015108787169147E7,6933:1.7367530445161372E7,32662:2.0037508342789244E7,53001:2.001508679602057E7,53002:1.000754339801029E7,53003:2.001508679602057E7,
53004:2.001508679602057E7,53016:1.4152803599503474E7,53017:1.7333573624304302E7,53034:2.001508679602057E7,53079:2.0015114352186374E7,53080:2.0015114352186374E7,54001:2.0037508342789244E7,54002:1.0018754171394624E7,54003:2.0037508342789244E7,54004:2.0037508342789244E7,54016:1.4168658027268292E7,54017:1.736753044516137E7,54034:2.0037508342789244E7,54079:2.0037508342789244E7,54080:2.0037508342789244E7,54100:2.0037508342789244E7,54101:2.0037508342789244E7},T=new Map,X=new Map;m.computeProjectedScales=
function(L,V,W){var Y=W?.tileSize??512,Z=W?.alignGlobalDatasetWithAGOL??!0,aa=!!W?.limitToSrcResolution;const {extent:fa,spatialReference:ea,pixelSize:ca}=L;W=t(new y({x:ca.x,y:ca.y,spatialReference:ea}),V,fa);if(null==W)return{projectedPixelSize:null,scales:null,srcResolutions:null,isCustomTilingScheme:!1};const ja=(W.x+W.y)/2,la=D.getMetersPerUnitForSR(V);var oa=ja*la*96*39.37,pa=V.isGeographic?256/Y*2.958287637958547E8:256/Y*5.91657527591555E8,qa="vector-magdir"===L.dataType||"vector-uv"===L.dataType,
ra=J(L,V),sa=Math.min(Math.ceil(Math.log(Math.min(L.width,L.height)/32)/Math.LN2),Math.ceil(Math.log(pa/2/oa)/Math.LN2));if(!qa&&Z&&(V.isGeographic||V.isWebMercator)&&(Z=E(V),qa=0<U(ra)||null!=Z&&ra.width>Z/4,!qa&&null!=Z)){qa=-1;if(3>sa)qa=2**sa*ja*Y;else if(L.storageInfo){const {maximumPyramidLevel:ua=0,pyramidScalingFactor:ma=2}=L.storageInfo;qa=ma**ua*ja*Y}Y=Math.ceil(Z/qa);qa=1===Y||2===Y&&Z/2-ra.xmax<qa}Y=oa;L=Math.min(2,Math.max(1.414,L.storageInfo?.pyramidScalingFactor||2));if(qa)Y=pa,pa=
V.isGeographic?1.341104507446289E-6:.29858214164761665,sa=96*pa*la*39.37,V=t(new y({x:pa,y:pa,spatialReference:{wkid:V.isGeographic?4326:3857}}),ea,ra),V.x*=Y/sa,V.y*=Y/sa;else{V={x:ca.x,y:ca.y};for(ra=0;Y<.5005*pa&&ra<sa;)ra++,Y*=L,V.x*=L,V.y*=L;1.001>=Math.max(Y,pa)/Math.min(Y,pa)&&(Y=pa)}pa=[Y];ra=[{x:V.x,y:V.y}];for(oa=Math.min(70.5310735,oa)/1.001;Y>=oa;)Y/=L,V.x/=L,V.y/=L,pa.push(Y),ra.push({x:V.x,y:V.y});if(aa){const ua=.001*ca.x;aa=ra.findIndex(ma=>ma.x>=ca.x-ua&&ma.x<=ca.x+ua);-1<aa?(ra.length=
aa+1,pa.length=aa+1):(aa=ra.findIndex(ma=>ma.x<=ca.x+ua),0<aa&&(ra.length=aa,pa.length=aa))}return{projectedPixelSize:W,scales:pa,srcResolutions:ra,isCustomTilingScheme:!qa}};m.defaultGridSpacing=32;m.defaultProjectionToleranceInPixels=4;m.getDefaultDatumTransformationForDataset=q;m.getProjectedGridPoints=a;m.getProjectionOffsetGrid=function(L){var V=L.isAdaptive&&null==L.spacing;let W=L.spacing||[32,32],Y=F(L);var Z={cols:Y.size[0]+1,rows:Y.size[1]+1};const aa=0<Y.outofBoundPointCount&&Y.outofBoundPointCount<
Y.offsets.length/2;let fa=Y.outofBoundPointCount===Y.offsets.length/2||V&&aa?[0,0]:O(Y.offsets,Z,W,4);const ea=(fa[0]+fa[1])/2;var ca=L.projectedExtent.spatialReference;const ja=L.srcBufferExtent.spatialReference;V&&(aa||4<ea)&&(e(ca,ja,L.datumTransformation)&&(ca.isGeographic||null!=b(ca)),W=[4,4],Y=F({...L,spacing:W}),Z={cols:Y.size[0]+1,rows:Y.size[1]+1},fa=O(Y.offsets,Z,W,4));Y.error=fa;1<W[0]&&(Y.coefficients=x(Y.offsets,Z,aa));!L.includeGCSGrid||ca.isGeographic||ca.isWebMercator||(ja.isGeographic?
Y.gcsGrid={offsets:Y.offsets,coefficients:Y.coefficients,spacing:W}:(V=b(ca),null==V||V.isEnvelope||(ca&&!ca.isGeographic&&(V=String(ca.wkid||ca.wkt2||ca.wkt),X.has(V)?ca=X.get(V):(ca=(ca.wkid?S.PeFactory.coordsys(ca.wkid):S.PeFactory.fromString(S.PeDefs.PE_TYPE_PROJCS,ca.wkt2||ca.wkt)).getGeogcs().getCode(),X.set(V,ca)),ca=new c({wkid:ca})),ca=A(L.projectedExtent,ca),{offsets:L}=F({...L,srcBufferExtent:ca,spacing:W}),Z=x(L,Z,aa),Y.gcsGrid={offsets:L,coefficients:Z,spacing:W})));return Y};m.getRasterDatasetAlignmentInfo=
function(L){const V=L.storageInfo.origin.x;var W=E(L.spatialReference,!0);if(null==W)return{originX:V,halfWorldWidth:null,pyramidsInfo:null};const Y=W/2,{nativePixelSize:Z,storageInfo:aa,extent:fa}=L,{maximumPyramidLevel:ea,blockWidth:ca,pyramidScalingFactor:ja}=aa;let la=Z.x;const oa=[];L=null!=L.transform&&"gcs-shift"===L.transform.type;const pa=V+(L?0:Y);W=L?W-V:Y-V;for(let qa=0;qa<=ea;qa++){const ra=(fa.xmax-V)/la/ca,sa=W/la/ca;oa.push({resolutionX:la,blockWidth:ca,datsetColumnCount:0===ra-Math.floor(ra)?
ra:Math.ceil(ra),worldColumnCountFromOrigin:0===sa-Math.floor(sa)?sa:Math.ceil(sa),leftMargin:Math.round(pa/la)%ca,rightPadding:(ca-Math.round(W/la)%ca)%ca,originColumnOffset:Math.floor(pa/la/ca)});la*=ja}return{originX:V,halfWorldWidth:Y,pyramidsInfo:oa,hasGCSSShiftTransform:L}};m.getWorldWidth=E;m.getWorldWrapCount=U;m.load=async function(){Q.isLoaded()||await Q.load()};m.minimumGridSpacing=4;m.projectDatasetExtent=J;m.projectExtent=A;m.projectPoint=p;m.projectPolygon=function(L,V,W){if("extent"===
L.type){const {xmin:Y,ymin:Z,xmax:aa,ymax:fa,spatialReference:ea}=L;L=new u({rings:[[[Y,fa],[aa,fa],[aa,Z],[Y,Z],[Y,fa]]],spatialReference:ea})}if(L.spatialReference.equals(V))return L;l(L.spatialReference,V,W);return Q.project(L,V,W)};m.projectResolution=t;m.requirePE=e;m.shiftExtent=function(L){var {spatialReference:V}=L;V=P.getInfo(V);if(!V)return L;const [W,Y]=V.valid;V=Y-W;let Z=0;L.xmin<W?Z=Math.ceil((W-L.xmin)/V):L.xmin>Y&&(Z=-Math.ceil((L.xmin-Y)/V));return new H({spatialReference:L.spatialReference,
xmin:L.xmin+Z*V,ymin:L.ymin,xmax:L.xmax+Z*V,ymax:L.ymax})};m.snapExtent=K;m.snapPyramid=function(L,V,W){const {storageInfo:Y,pixelSize:Z}=V;var aa=0;let fa=!1;var {pyramidResolutions:ea}=Y,ca="mixed"===Y.tileInfo.format?.toLowerCase()?Math.max(1,Math.min(3,Y.tileInfo.dpi/96)):1;ca=(L.x+L.y)/2/ca;if(null!=ea&&ea.length){L=ea[ea.length-1];L=(L.x+L.y)/2;var ja=(Z.x+Z.y)/2;if(ca<=ja)aa=0;else if(ca>=L)aa=ea.length,fa=8<ca/L;else{L=ja;for(let la=1;la<=ea.length;la++){ja=(ea[la-1].x+ea[la-1].y)/2;if(ca<=
ja){ca===ja?aa=la:"down"===W?(aa=la-1,fa=8<ca/L):aa="up"===W?la:ca-L>ja-ca||2<ca/L?la:la-1;break}L=ja}}W=0===aa?Z:ea[aa-1];fa&&(ea=Math.min(W.x,W.y),ca=D.getMetersPerUnitForSR(V.spatialReference),19567<ea*ca&&(fa=!1));return{pyramidLevel:aa,pyramidResolution:new y({x:W.x,y:W.y,spatialReference:V.spatialReference}),excessiveReading:fa}}aa=Math.log(L.x/Z.x)/Math.LN2;ca=Math.log(L.y/Z.y)/Math.LN2;ea=V.storageInfo.maximumPyramidLevel||0;aa="down"===W?Math.floor(Math.min(aa,ca)):"up"===W?Math.ceil(Math.max(aa,
ca)):Math.round((aa+ca)/2);0>aa?aa=0:aa>ea&&(fa=aa>ea+3,aa=ea);W=2**aa;V=new y({x:W*V.nativePixelSize.x,y:W*V.nativePixelSize.y,spatialReference:V.spatialReference});return{pyramidLevel:aa,pyramidResolution:V,excessiveReading:fa}};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/RasterCodec":function(){define("exports ../../../core/Error ../../../core/maybe ../PixelBlock ./ImageCanvasDecoder ./JpgPlus ./Lerc ./Lzw ./pixelRangeUtils ../../../chunks/Zlib ./Raw ./TiffDecoder ./utils".split(" "),
function(m,w,z,N,D,S,Q,P,H,y,u,c,e){async function l(A,n){if(!e.isPlatformLittleEndian)throw new w("rasterCoded:decode","lerc decoder is not supported on big endian platform");await Q.load();const {offset:C}=n,{width:E,height:I,pixelType:M,statistics:U,depthCount:F,noDataValues:x,bandMasks:K,pixels:J,mask:G}=Q.decode(A,{inputOffset:C,returnInterleaved:n.returnInterleaved});A=new N({width:E,height:I,pixelType:M.toLowerCase(),pixels:J,mask:G,statistics:U,bandMasks:K,depthCount:F,noDataValues:x});U?.length||
A.updateStatistics();return A}async function q(A,n){A=await c.decode(A,{...n,noDataValue:null});z.assertIsSome(A);A=new N({width:A.width,height:A.height,pixels:A.pixels,pixelType:A.pixelType.toLowerCase(),mask:A.mask,bandMasks:A.bandMasks,statistics:null});A.updateStatistics();return A}async function t(A,n){A=await c.decodeTileOrStrip(A,n.customOptions);A=new N({width:A.width,height:A.height,pixels:A.pixels,pixelType:A.pixelType.toLowerCase(),mask:A.mask,statistics:null});A.updateStatistics();return A}
function h(A,n){const C=n.pixelType||"u8",E=N.getPixelArrayConstructor(C),I="u8"===C?A:new E(A.buffer),M=[],U=n.planes||1;if(1===U)M.push(I);else for(let F=0;F<U;F++){const x=(n.width||1)*(n.height||A.length),K=new E(x);for(let J=0;J<x;J++)K[J]=I[J*U+F];M.push(K)}A=new N({width:n.width||1,height:n.height||A.length,pixels:M,pixelType:C,statistics:null});A.updateStatistics();return A}function p(A,n){A=(new y.Zlib(new Uint8Array(A))).getBytes();return h(A,n)}function v(A,n){A=P.decode(A,n.offset,n.eof,
!n.isInputBigEndian);return h(A,n)}function a(A,n){A=S.decode(A,n.hasNoZlibMask??void 0);A=new N({width:A.width,height:A.height,pixels:A.pixels,pixelType:"U8",mask:A.mask,statistics:null});A.updateStatistics();return A}function g(A,n){A=new Uint8Array(A);A=new r(A);const {width:C,height:E}=n;n=C*E;A=A.decode();let I=0;var M=0;let U;M=new Uint8Array(n);for(I=0;I<n;I++)M[I]=A[4*I+3];const F=new N({width:C,height:E,pixels:[],pixelType:"U8",mask:M,statistics:[]});for(I=0;3>I;I++){U=new Uint8Array(n);
for(M=0;M<n;M++)U[M]=A[4*M+I];F.addData({pixels:U})}F.updateStatistics();return F}async function d(A,n,C,E){A=await (new D).decode(A,{applyJpegMask:!1,format:n,...C},E);A=new N(A);A.updateStatistics();return A}function b(A){if(null==A)throw new w("rasterCodec:decode","parameter encodeddata is required.");A=new Uint8Array(A,0,10);let n="";255===A[0]&&216===A[1]?n="jpg":137===A[0]&&80===A[1]&&78===A[2]&&71===A[3]?n="png":67===A[0]&&110===A[1]&&116===A[2]&&90===A[3]&&73===A[4]&&109===A[5]&&97===A[6]&&
103===A[7]&&101===A[8]&&32===A[9]?n="lerc":76===A[0]&&101===A[1]&&114===A[2]&&99===A[3]&&50===A[4]&&32===A[5]?n="lerc2":73===A[0]&&73===A[1]&&42===A[2]&&0===A[3]||77===A[0]&&77===A[1]&&0===A[2]&&42===A[3]||73===A[0]&&73===A[1]&&43===A[2]&&0===A[3]||77===A[0]&&77===A[1]&&0===A[2]&&43===A[3]?n="tiff":71===A[0]&&73===A[1]&&70===A[2]?n="gif":66===A[0]&&77===A[1]?n="bmp":String.fromCharCode.apply(null,A).toLowerCase().includes("error")&&(n="error");return n}function f(A){let n=null;switch(A){case "lerc":case "lerc2":n=
l;break;case "jpg":n=a;break;case "png":n=g;break;case "bsq":case "bip":n=(C,E)=>{var I=E.pixelType,M=null;let U=null;switch(I?I.toLowerCase():"f32"){case "u1":case "u2":case "u4":case "u8":U=255;M=Uint8Array;break;case "u16":U=U||65535;M=Uint16Array;break;case "u32":U=U||2**32-1;M=Uint32Array;break;case "s8":U=U||-128;M=Int8Array;break;case "s16":U=U||-32768;M=Int16Array;break;case "s32":U=U||-(2**31);M=Int32Array;break;default:M=Float32Array}({pixelTypeCtor:I}={pixelTypeCtor:M,noDataValue:U});M=
u.decode;C=M(C,{width:E.width,height:E.height,pixelType:I,format:A});E=new N({width:E.width,height:E.height,pixels:C.pixels,pixelType:E.pixelType,mask:C.mask,statistics:null});E.updateStatistics();return E};break;case "tiff":n=q;break;case "deflate":n=p;break;case "lzw":n=v;break;case "error":n=()=>{throw new w("rasterCodec:decode","input data contains error");};break;default:n=()=>{throw new w("rasterCodec:decode","unsupported raster format");}}return n}function k(A,n=1){if(A){var {pixels:C,width:E,
height:I,mask:M}=A;if(C&&0!==C.length){var U=C.length,F=E-1,x=I-1,K=[],J,G,O=null,R=N.getPixelArrayConstructor(A.pixelType);if(0===n){for(n=0;n<U;n++){var T=C[n];var X=new R(F*x);for(J=0;J<x;J++){var L=J*E;for(G=0;G<F;G++)X[J*F+G]=T[L+G]}K.push(X)}if(null!=M)for(O=new Uint8Array(F*x),J=0;J<x;J++)for(L=J*E,G=0;G<F;G++)O[J*F+G]=M[L+G]}else{for(n=0;n<U;n++){T=C[n];X=new R(F*x);for(J=0;J<x;J++)for(L=J*E,G=0;G<F;G++)X[J*F+G]=(T[L+G]+T[L+G+1]+T[L+E+G]+T[L+E+G+1])/4;K.push(X)}if(M)for(O=new Uint8Array(F*
x),J=0;J<x;J++)for(L=J*E,G=0;G<F;G++)O[J*F+G]=Math.min.apply(null,[M[L+G],M[L+G+1],M[L+E+G],M[L+E+G+1]])}A.width=F;A.height=x;A.mask=O;A.pixels=K}}}var r=function(A){function n(M){var U,F;this.data=M;this.pos=8;this.palette=[];this.imgData=[];this.transparency={};this.animation=null;this.text={};for(F=null;;){var x=this.readUInt32();var K=M=void 0;M=[];for(K=0;4>K;++K)M.push(String.fromCharCode(this.data[this.pos++]));M=M.join("");switch(M){case "IHDR":this.width=this.readUInt32();this.height=this.readUInt32();
this.bits=this.data[this.pos++];this.colorType=this.data[this.pos++];this.compressionMethod=this.data[this.pos++];this.filterMethod=this.data[this.pos++];this.interlaceMethod=this.data[this.pos++];break;case "acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||Infinity,frames:[]};break;case "PLTE":this.palette=this.read(x);break;case "fcTL":F&&this.animation.frames.push(F);this.pos+=4;F={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()};
M=this.readUInt16();x=this.readUInt16()||100;F.delay=1E3*M/x;F.disposeOp=this.data[this.pos++];F.blendOp=this.data[this.pos++];F.data=[];break;case "IDAT":case "fdAT":"fdAT"===M&&(this.pos+=4,x-=4);M=(null!=F?F.data:void 0)||this.imgData;for(K=0;0<=x?K<x:K>x;0<=x?++K:--K)M.push(this.data[this.pos++]);break;case "tRNS":this.transparency={};switch(this.colorType){case 3:this.transparency.indexed=this.read(x);x=255-this.transparency.indexed.length;if(0<x)for(M=0;0<=x?M<x:M>x;0<=x?++M:--M)this.transparency.indexed.push(255);
break;case 0:this.transparency.grayscale=this.read(x)[0];break;case 2:this.transparency.rgb=this.read(x)}break;case "tEXt":K=this.read(x);x=K.indexOf(0);M=String.fromCharCode.apply(String,K.slice(0,x));this.text[M]=String.fromCharCode.apply(String,K.slice(x+1));break;case "IEND":F&&this.animation.frames.push(F);a:{switch(this.colorType){case 0:case 3:case 4:F=1;break a;case 2:case 6:F=3;break a}F=void 0}this.colors=F;this.hasAlphaChannel=4===(U=this.colorType)||6===U;U=this.colors+(this.hasAlphaChannel?
1:0);this.pixelBitlength=this.bits*U;a:{switch(this.colors){case 1:U="DeviceGray";break a;case 3:U="DeviceRGB";break a}U=void 0}this.colorSpace=U;this.imgData=new Uint8Array(this.imgData);return;default:this.pos+=x}this.pos+=4;if(this.pos>this.data.length)throw Error("Incomplete or corrupt PNG file");}}var C;n.load=function(M,U,F){"function"===typeof U&&(F=U);var x=new XMLHttpRequest;x.open("GET",M,!0);x.responseType="arraybuffer";x.onload=function(){var K=new Uint8Array(x.response||x.mozResponseArrayBuffer);
K=new n(K);"function"===typeof(null!=U?U.getContext:void 0)&&K.render(U);return"function"===typeof F?F(K):void 0};return x.send(null)};n.prototype.read=function(M){var U;var F=[];for(U=0;0<=M?U<M:U>M;0<=M?++U:--U)F.push(this.data[this.pos++]);return F};n.prototype.readUInt32=function(){var M=this.data[this.pos++]<<24;var U=this.data[this.pos++]<<16;var F=this.data[this.pos++]<<8;var x=this.data[this.pos++];return M|U|F|x};n.prototype.readUInt16=function(){var M=this.data[this.pos++]<<8;var U=this.data[this.pos++];
return M|U};n.prototype.decodePixels=function(M){var U,F,x,K,J,G,O,R;null==M&&(M=this.imgData);if(0===M.length)return new Uint8Array(0);M=new y.Zlib(M);M=M.getBytes();var T=this.pixelBitlength/8;var X=T*this.width;var L=new Uint8Array(X*this.height);var V=M.length;for(F=K=J=0;K<V;){switch(M[K++]){case 0:for(x=U=0;U<X;x=U+=1)L[F++]=M[K++];break;case 1:for(x=G=0;G<X;x=G+=1){U=M[K++];var W=x<T?0:L[F-T];L[F++]=(U+W)%256}break;case 2:for(x=W=0;W<X;x=W+=1){U=M[K++];var Y=(x-x%T)/T;G=J&&L[(J-1)*X+Y*T+x%
T];L[F++]=(G+U)%256}break;case 3:for(x=R=0;R<X;x=R+=1)U=M[K++],Y=(x-x%T)/T,W=x<T?0:L[F-T],G=J&&L[(J-1)*X+Y*T+x%T],L[F++]=(U+Math.floor((W+G)/2))%256;break;case 4:for(x=R=0;R<X;x=R+=1){U=M[K++];Y=(x-x%T)/T;W=x<T?0:L[F-T];0===J?G=O=0:(G=L[(J-1)*X+Y*T+x%T],O=Y&&L[(J-1)*X+(Y-1)*T+x%T]);var Z=W+G-O;x=Math.abs(Z-W);Y=Math.abs(Z-G);Z=Math.abs(Z-O);W=x<=Y&&x<=Z?W:Y<=Z?G:O;L[F++]=(U+W)%256}break;default:throw Error("Invalid filter algorithm: "+M[K-1]);}J++}return L};n.prototype.decodePalette=function(){var M,
U,F,x;var K=this.palette;var J=this.transparency.indexed||[];var G=new Uint8Array((J.length||0)+K.length);var O=0;K.length;var R=U=M=0;for(F=K.length;U<F;R=U+=3)G[O++]=K[R],G[O++]=K[R+1],G[O++]=K[R+2],G[O++]=null!=(x=J[M++])?x:255;return G};n.prototype.copyToImageData=function(M,U){var F,x;var K=this.colors;var J=null;var G=this.hasAlphaChannel;this.palette.length&&(J=null!=(F=this._decodedPalette)?F:this._decodedPalette=this.decodePalette(),K=4,G=!0);M=M.data||M;var O=M.length;var R=J||U;F=x=0;if(1===
K)for(;F<O;)K=J?4*U[F/4]:x,x=R[K++],M[F++]=x,M[F++]=x,M[F++]=x,M[F++]=G?R[K++]:this.transparency.grayscale&&this.transparency.grayscale===x?0:255,x=K;else for(;F<O;)K=J?4*U[F/4]:x,M[F++]=R[K++],M[F++]=R[K++],M[F++]=R[K++],M[F++]=G?R[K++]:this.transparency.rgb&&this.transparency.rgb[1]===R[K-3]&&this.transparency.rgb[3]===R[K-2]&&this.transparency.rgb[5]===R[K-1]?0:255,x=K};n.prototype.decode=function(){var M=new Uint8Array(this.width*this.height*4);this.copyToImageData(M,this.decodePixels());return M};
var E=(C=A.document&&A.document.createElement("canvas"))&&C.getContext("2d");var I=function(M){E.width=M.width;E.height=M.height;E.clearRect(0,0,M.width,M.height);E.putImageData(M,0,0);M=new Image;M.src=C.toDataURL();return M};n.prototype.decodeFrames=function(M){var U,F;if(this.animation){var x=this.animation.frames;var K=[];var J=U=0;for(F=x.length;U<F;J=++U){J=x[J];var G=M.createImageData(J.width,J.height);var O=this.decodePixels(new Uint8Array(J.data));this.copyToImageData(G,O);J.imageData=G;
K.push(J.image=I(G))}return K}};n.prototype.renderFrame=function(M,U){var F=this.animation.frames;var x=F[U];F=F[U-1];0===U&&M.clearRect(0,0,this.width,this.height);1===(null!=F?F.disposeOp:void 0)?M.clearRect(F.xOffset,F.yOffset,F.width,F.height):2===(null!=F?F.disposeOp:void 0)&&M.putImageData(F.imageData,F.xOffset,F.yOffset);0===x.blendOp&&M.clearRect(x.xOffset,x.yOffset,x.width,x.height);return M.drawImage(x.image,x.xOffset,x.yOffset)};n.prototype.animate=function(M){var U,F=this;var x=0;var K=
this.animation;var J=K.numFrames;var G=K.frames;var O=K.numPlays;return(U=function(){var R=x++%J;var T=G[R];F.renderFrame(M,R);if(1<J&&x/J<O)return F.animation._timeout=setTimeout(U,T.delay)})()};n.prototype.stopAnimation=function(){var M;return clearTimeout(null!=(M=this.animation)?M._timeout:void 0)};n.prototype.render=function(M){M._png&&M._png.stopAnimation();M._png=this;M.width=this.width;M.height=this.height;M=M.getContext("2d");if(this.animation)return this.decodeFrames(M),this.animate(M);
var U=M.createImageData(this.width,this.height);this.copyToImageData(U,this.decodePixels());return M.putImageData(U,0,0)};return n}(self);const B=new Set(["jpg","png","bmp","gif"]);m.decode=async function(A,n={},C){if(null==A)throw new w("rasterCodec:decode","missing encodeddata parameter.");let E=n.format?.toLowerCase();if(!("bsq"!==E&&"bip"!==E||null!=n.width&&null!=n.height))throw new w("rasterCodec:decode","requires width and height in options parameter.");if("tiff"===E&&n.customOptions)return t(A,
n);if(!E||"bsq"!==E&&"bip"!==E&&"deflate"!==E&&"lzw"!==E)E=b(A);if(n.useCanvas&&B.has(E))return d(A,E,n,C);C=f(E);n.isPoint&&(n={...n},null!=n.width&&n.width++,null!=n.height&&n.height++);A=await C(A,n);if(!A)return A;"jpg"!==E&&null!=n.noDataValue&&1===A.depthCount&&H.convertNoDataToMask(A,n.noDataValue,{customFloatTolerance:n.tolerance});n.isPoint&&k(A);return A};m.getFormat=function(A){A=b(A);"lerc2"===A?A="lerc":"error"===A&&(A="");return A};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},
"esri/layers/support/rasterFormats/ImageCanvasDecoder":function(){define(["../../../core/Error","../../../core/promiseUtils","../../../chunks/Zlib"],function(m,w,z){class N{constructor(D){this._ctx=this._canvas=null;D&&(this._canvas=D.canvas,this._ctx=D.ctx||D.canvas&&D.canvas.getContext("2d"))}decode(D,S,Q){if(!D||10>D.byteLength)throw new m("imagecanvasdecoder: decode","required a valid encoded data as input.");let {width:P=0,height:H=0,format:y}=S;const {applyJpegMask:u}=S;if(u&&(!P||!H))throw new m("imagecanvasdecoder: decode",
"image width and height are needed to apply jpeg mask directly to canvas");return new Promise((c,e)=>{let l=null;"jpg"===y&&u&&(l=N._getMask(D,{width:P,height:H}));const q=new Blob([new Uint8Array(D)],{type:"jpg"==="image/"+y?"jpeg":y}),t=URL.createObjectURL(q),h=new Image;let p;h.src=t;h.onload=()=>{URL.revokeObjectURL(t);if(w.isAborted(Q))e(w.createAbortError());else{P=h.width;H=h.height;if(this._canvas&&this._ctx){if(this._canvas.width!==P||this._canvas.height!==H)this._canvas.width=P,this._canvas.height=
H;this._ctx.clearRect(0,0,P,H)}else this._canvas=document.createElement("canvas"),this._canvas.width=P,this._canvas.height=H,this._ctx=this._canvas.getContext("2d");this._ctx.drawImage(h,0,0);var v=this._ctx.getImageData(0,0,P,H);p=v.data;var a;if(S.renderOnCanvas){if(l)for(a=0;a<l.length;a++)p[4*a+3]=l[a]?255:0;this._ctx.putImageData(v,0,0);c(null)}else{v=P*H;var g=new Uint8Array(v),d=new Uint8Array(v),b=new Uint8Array(v);if(l)for(a=0;a<v;a++)g[a]=p[4*a],d[a]=p[4*a+1],b[a]=p[4*a+2];else for(l=new Uint8Array(v),
a=0;a<v;a++)g[a]=p[4*a],d[a]=p[4*a+1],b[a]=p[4*a+2],l[a]=p[4*a+3];c({width:P,height:H,pixels:[g,d,b],mask:l,pixelType:"u8"})}}};h.onerror=()=>{URL.revokeObjectURL(t);e("cannot load image")}})}static _getMask(D,S){let Q=null;try{var P=new Uint8Array(D);D=0;var H=P.length-2;for(D=Math.ceil(P.length/2);D<H&&(255!==P[D]||217!==P[D+1]);D++);D+=2;if(D<P.length-1){const y=(new z.Zlib(P.subarray(D))).getBytes();Q=new Uint8Array(S.width*S.height);S=0;for(P=0;P<y.length;P++)for(H=7;0<=H;H--)Q[S++]=y[P]>>H&
1}}catch(y){}return Q}}return N})},"esri/chunks/Zlib":function(){define(["exports","./_commonjsHelpers"],function(m,w){var z={exports:{}};z.exports;(function(N){(function(D){D=D();void 0!==D&&(N.exports=D)})(function(){var D=function(){function S(){this.bufferLength=this.pos=0;this.eof=!1;this.buffer=null}S.prototype={ensureBuffer:function(Q){var P=this.buffer,H=P?P.byteLength:0;if(Q<H)return P;for(var y=512;y<Q;)y<<=1;Q=new Uint8Array(y);for(y=0;y<H;++y)Q[y]=P[y];return this.buffer=Q},getByte:function(){for(var Q=
this.pos;this.bufferLength<=Q;){if(this.eof)return null;this.readBlock()}return this.buffer[this.pos++]},getBytes:function(Q){var P=this.pos;if(Q){this.ensureBuffer(P+Q);for(Q=P+Q;!this.eof&&this.bufferLength<Q;)this.readBlock();var H=this.bufferLength;Q>H&&(Q=H)}else{for(;!this.eof;)this.readBlock();Q=this.bufferLength}this.pos=Q;return this.buffer.subarray(P,Q)},lookChar:function(){for(var Q=this.pos;this.bufferLength<=Q;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos])},
getChar:function(){for(var Q=this.pos;this.bufferLength<=Q;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos++])},makeSubStream:function(Q,P,H){for(var y=Q+P;this.bufferLength<=y&&!this.eof;)this.readBlock();return new Stream(this.buffer,Q,P,H)},skip:function(Q){Q||(Q=1);this.pos+=Q},reset:function(){this.pos=0}};return S}();return function(){function S(e){throw Error(e);}function Q(e){var l=0,q=e[l++],t=e[l++];-1!=q&&-1!=t||S("Invalid header in flate stream");
8!=(q&15)&&S("Unknown compression method in flate stream");0!=((q<<8)+t)%31&&S("Bad FCHECK in flate stream");t&32&&S("FDICT bit set in flate stream");this.bytes=e;this.bytesPos=l;this.codeBuf=this.codeSize=0;D.call(this)}if(!self||!self.Uint32Array)return null;var P=new Uint32Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),H=new Uint32Array([3,4,5,6,7,8,9,10,65547,65549,65551,65553,131091,131095,131099,131103,196643,196651,196659,196667,262211,262227,262243,262259,327811,327843,327875,327907,
258,258,258]),y=new Uint32Array([1,2,3,4,65541,65543,131081,131085,196625,196633,262177,262193,327745,327777,393345,393409,459009,459137,524801,525057,590849,591361,657409,658433,724993,727041,794625,798721,868353,876545]),u=[new Uint32Array([459008,524368,524304,524568,459024,524400,524336,590016,459016,524384,524320,589984,524288,524416,524352,590048,459012,524376,524312,589968,459028,524408,524344,590032,459020,524392,524328,59E4,524296,524424,524360,590064,459010,524372,524308,524572,459026,524404,
524340,590024,459018,524388,524324,589992,524292,524420,524356,590056,459014,524380,524316,589976,459030,524412,524348,590040,459022,524396,524332,590008,524300,524428,524364,590072,459009,524370,524306,524570,459025,524402,524338,590020,459017,524386,524322,589988,524290,524418,524354,590052,459013,524378,524314,589972,459029,524410,524346,590036,459021,524394,524330,590004,524298,524426,524362,590068,459011,524374,524310,524574,459027,524406,524342,590028,459019,524390,524326,589996,524294,524422,
524358,590060,459015,524382,524318,589980,459031,524414,524350,590044,459023,524398,524334,590012,524302,524430,524366,590076,459008,524369,524305,524569,459024,524401,524337,590018,459016,524385,524321,589986,524289,524417,524353,590050,459012,524377,524313,589970,459028,524409,524345,590034,459020,524393,524329,590002,524297,524425,524361,590066,459010,524373,524309,524573,459026,524405,524341,590026,459018,524389,524325,589994,524293,524421,524357,590058,459014,524381,524317,589978,459030,524413,
524349,590042,459022,524397,524333,590010,524301,524429,524365,590074,459009,524371,524307,524571,459025,524403,524339,590022,459017,524387,524323,589990,524291,524419,524355,590054,459013,524379,524315,589974,459029,524411,524347,590038,459021,524395,524331,590006,524299,524427,524363,590070,459011,524375,524311,524575,459027,524407,524343,590030,459019,524391,524327,589998,524295,524423,524359,590062,459015,524383,524319,589982,459031,524415,524351,590046,459023,524399,524335,590014,524303,524431,
524367,590078,459008,524368,524304,524568,459024,524400,524336,590017,459016,524384,524320,589985,524288,524416,524352,590049,459012,524376,524312,589969,459028,524408,524344,590033,459020,524392,524328,590001,524296,524424,524360,590065,459010,524372,524308,524572,459026,524404,524340,590025,459018,524388,524324,589993,524292,524420,524356,590057,459014,524380,524316,589977,459030,524412,524348,590041,459022,524396,524332,590009,524300,524428,524364,590073,459009,524370,524306,524570,459025,524402,
524338,590021,459017,524386,524322,589989,524290,524418,524354,590053,459013,524378,524314,589973,459029,524410,524346,590037,459021,524394,524330,590005,524298,524426,524362,590069,459011,524374,524310,524574,459027,524406,524342,590029,459019,524390,524326,589997,524294,524422,524358,590061,459015,524382,524318,589981,459031,524414,524350,590045,459023,524398,524334,590013,524302,524430,524366,590077,459008,524369,524305,524569,459024,524401,524337,590019,459016,524385,524321,589987,524289,524417,
524353,590051,459012,524377,524313,589971,459028,524409,524345,590035,459020,524393,524329,590003,524297,524425,524361,590067,459010,524373,524309,524573,459026,524405,524341,590027,459018,524389,524325,589995,524293,524421,524357,590059,459014,524381,524317,589979,459030,524413,524349,590043,459022,524397,524333,590011,524301,524429,524365,590075,459009,524371,524307,524571,459025,524403,524339,590023,459017,524387,524323,589991,524291,524419,524355,590055,459013,524379,524315,589975,459029,524411,
524347,590039,459021,524395,524331,590007,524299,524427,524363,590071,459011,524375,524311,524575,459027,524407,524343,590031,459019,524391,524327,589999,524295,524423,524359,590063,459015,524383,524319,589983,459031,524415,524351,590047,459023,524399,524335,590015,524303,524431,524367,590079]),9],c=[new Uint32Array([327680,327696,327688,327704,327684,327700,327692,327708,327682,327698,327690,327706,327686,327702,327694,0,327681,327697,327689,327705,327685,327701,327693,327709,327683,327699,327691,
327707,327687,327703,327695,0]),5];Q.prototype=Object.create(D.prototype);Q.prototype.getBits=function(e){for(var l=this.codeSize,q=this.codeBuf,t=this.bytes,h=this.bytesPos,p;l<e;)"undefined"==typeof(p=t[h++])&&S("Bad encoding in flate stream"),q|=p<<l,l+=8;this.codeBuf=q>>e;this.codeSize=l-=e;this.bytesPos=h;return q&(1<<e)-1};Q.prototype.getCode=function(e){var l=e[0],q=e[1];e=this.codeSize;for(var t=this.codeBuf,h=this.bytes,p=this.bytesPos;e<q;){var v;"undefined"==typeof(v=h[p++])&&S("Bad encoding in flate stream");
t|=v<<e;e+=8}q=l[t&(1<<q)-1];l=q>>16;q&=65535;(0==e||e<l||0==l)&&S("Bad encoding in flate stream");this.codeBuf=t>>l;this.codeSize=e-l;this.bytesPos=p;return q};Q.prototype.generateHuffmanTable=function(e){for(var l=e.length,q=0,t=0;t<l;++t)e[t]>q&&(q=e[t]);for(var h=1<<q,p=new Uint32Array(h),v=1,a=0,g=2;v<=q;++v,a<<=1,g<<=1)for(var d=0;d<l;++d)if(e[d]==v){var b=0,f=a;for(t=0;t<v;++t)b=b<<1|f&1,f>>=1;for(t=b;t<h;t+=g)p[t]=v<<16|d;++a}return[p,q]};Q.prototype.readBlock=function(){function e(b,f,k,
r,B){for(b=b.getBits(k)+r;0<b--;)f[a++]=B}var l=this.getBits(3);l&1&&(this.eof=!0);l>>=1;if(0==l){var q=this.bytes,t=this.bytesPos,h;"undefined"==typeof(h=q[t++])&&S("Bad block header in flate stream");var p=h;"undefined"==typeof(h=q[t++])&&S("Bad block header in flate stream");p|=h<<8;"undefined"==typeof(h=q[t++])&&S("Bad block header in flate stream");l=h;"undefined"==typeof(h=q[t++])&&S("Bad block header in flate stream");(l|h<<8)!=(~p&65535)&&S("Bad uncompressed block length in flate stream");
this.codeSize=this.codeBuf=0;h=this.bufferLength;l=this.ensureBuffer(h+p);this.bufferLength=p=h+p;for(var v=h;v<p;++v){if("undefined"==typeof(h=q[t++])){this.eof=!0;break}l[v]=h}this.bytesPos=t}else{if(1==l)t=u,h=c;else if(2==l){l=this.getBits(5)+257;h=this.getBits(5)+1;q=this.getBits(4)+4;t=Array(P.length);for(var a=0;a<q;)t[P[a++]]=this.getBits(3);t=this.generateHuffmanTable(t);a=q=0;h=l+h;for(p=Array(h);a<h;)v=this.getCode(t),16==v?e(this,p,2,3,q):17==v?e(this,p,3,3,q=0):18==v?e(this,p,7,11,q=
0):p[a++]=q=v;t=this.generateHuffmanTable(p.slice(0,l));h=this.generateHuffmanTable(p.slice(l,h))}else S("Unknown block type in flate stream");p=(l=this.buffer)?l.length:0;for(v=this.bufferLength;;){var g=this.getCode(t);if(256>g)v+1>=p&&(l=this.ensureBuffer(v+1),p=l.length),l[v++]=g;else{if(256==g){this.bufferLength=v;break}g-=257;g=H[g];var d=g>>16;0<d&&(d=this.getBits(d));q=(g&65535)+d;g=this.getCode(h);g=y[g];d=g>>16;0<d&&(d=this.getBits(d));g=(g&65535)+d;v+q>=p&&(l=this.ensureBuffer(v+q),p=l.length);
for(d=0;d<q;++d,++v)l[v]=l[v-g]}}}};return Q}()})})(z);w=w.getDefaultExportFromCjs(z.exports);m.Zlib=w})},"esri/layers/support/rasterFormats/JpgPlus":function(){define(["../../../chunks/Jpg","../../../chunks/Zlib"],function(m,w){class z{static decode(N,D=!1){const S=new Uint8Array(N);N=new m.JpegImage;N.parse(S);const {width:Q,height:P,numComponents:H,eof:y}=N,u=N.getData(Q,P,!0),c=Q*P;N=null;let e=0,l=0,q=0;if(!D&&y<S.length-1)try{var t=(new w.Zlib(S.subarray(y))).getBytes();N=new Uint8Array(c);
for(e=D=0;e<t.length;e++)for(q=7;0<=q;q--)N[D++]=t[e]>>q&1}catch{}if(1===H&&u.length===Q*P)t=new Uint8Array(u.buffer),t=[t,t,t];else{t=[];for(e=0;3>e;e++)t.push(new Uint8Array(c));for(l=q=0;l<c;l++)for(e=0;3>e;e++)t[e][l]=u[q++]}return{width:Q,height:P,pixels:t,mask:N}}}return z})},"esri/chunks/Jpg":function(){define(["exports","./_commonjsHelpers"],function(m,w){var z={exports:{}};z.exports;(function(N){(function(D){D=D();void 0!==D&&(N.exports=D)})(function(){var D=function(){function S(Q){this.message=
"JPEG error: "+Q}S.prototype=Error();S.prototype.name="JpegError";return S.constructor=S}();return function(){function S(){this.decodeTransform=null;this.colorTransform=-1}function Q(c,e){for(var l=0,q=[],t,h,p=16;0<p&&!c[p-1];)p--;q.push({children:[],index:0});var v=q[0],a;for(t=0;t<p;t++){for(h=0;h<c[t];h++){v=q.pop();for(v.children[v.index]=e[l];0<v.index;)v=q.pop();v.index++;for(q.push(v);q.length<=t;)q.push(a={children:[],index:0}),v.children[v.index]=a.children,v=a;l++}t+1<p&&(q.push(a={children:[],
index:0}),v.children[v.index]=a.children,v=a)}return q[0].children}function P(c,e,l,q,t,h,p,v,a){function g(){if(0<M)return M--,I>>M&1;I=c[e++];if(255===I){var Y=c[e++];if(Y)throw new D("unexpected marker "+(I<<8|Y).toString(16));}M=7;return I>>>7}function d(Y){for(;;){Y=Y[g()];if("number"===typeof Y)return Y;if("object"!==typeof Y)throw new D("invalid huffman sequence");}}function b(Y){for(var Z=0;0<Y;)Z=Z<<1|g(),Y--;return Z}function f(Y){if(1===Y)return 1===g()?1:-1;var Z=b(Y);return Z>=1<<Y-1?
Z:Z+(-1<<Y)+1}function k(Y,Z){var aa=d(Y.huffmanTableDC);aa=0===aa?0:f(aa);Y.blockData[Z]=Y.pred+=aa;for(aa=1;64>aa;){var fa=d(Y.huffmanTableAC),ea=fa&15;fa>>=4;if(0===ea){if(15>fa)break;aa+=16}else aa+=fa,Y.blockData[Z+u[aa]]=f(ea),aa++}}function r(Y,Z){var aa=d(Y.huffmanTableDC);aa=0===aa?0:f(aa)<<a;Y.blockData[Z]=Y.pred+=aa}function B(Y,Z){Y.blockData[Z]|=g()<<a}function A(Y,Z){if(0<U)U--;else for(var aa=h;aa<=p;){var fa=d(Y.huffmanTableAC),ea=fa&15;fa>>=4;if(0===ea){if(15>fa){U=b(fa)+(1<<fa)-
1;break}aa+=16}else aa+=fa,Y.blockData[Z+u[aa]]=f(ea)*(1<<a),aa++}}function n(Y,Z){for(var aa=h,fa=0,ea;aa<=p;){ea=u[aa];switch(F){case 0:fa=d(Y.huffmanTableAC);ea=fa&15;fa>>=4;if(0===ea)15>fa?(U=b(fa)+(1<<fa),F=4):(fa=16,F=1);else{if(1!==ea)throw new D("invalid ACn encoding");x=f(ea);F=fa?2:3}continue;case 1:case 2:Y.blockData[Z+ea]?Y.blockData[Z+ea]+=g()<<a:(fa--,0===fa&&(F=2===F?3:0));break;case 3:Y.blockData[Z+ea]?Y.blockData[Z+ea]+=g()<<a:(Y.blockData[Z+ea]=x<<a,F=0);break;case 4:Y.blockData[Z+
ea]&&(Y.blockData[Z+ea]+=g()<<a)}aa++}4===F&&(U--,0===U&&(F=0))}var C=l.mcusPerLine,E=e,I=0,M=0,U=0,F=0,x,K=q.length,J,G,O,R;v=l.progressive?0===h?0===v?r:B:0===v?A:n:k;var T=0;l=1===K?q[0].blocksPerLine*q[0].blocksPerColumn:C*l.mcusPerColumn;for(var X,L;T<l;){var V=t?Math.min(l-T,t):l;for(J=0;J<K;J++)q[J].pred=0;U=0;if(1===K){var W=q[0];for(R=0;R<V;R++)v(W,64*((W.blocksPerLine+1)*(T/W.blocksPerLine|0)+T%W.blocksPerLine)),T++}else for(R=0;R<V;R++){for(J=0;J<K;J++)for(W=q[J],X=W.h,L=W.v,G=0;G<L;G++)for(O=
0;O<X;O++)v(W,64*((W.blocksPerLine+1)*((T/C|0)*W.v+G)+(T%C*W.h+O)));T++}M=0;(W=y(c,e))&&W.invalid&&(console.log("decodeScan - unexpected MCU data, next marker is: "+W.invalid),e=W.offset);W=W&&W.marker;if(!W||65280>=W)throw new D("marker was not found");if(65488<=W&&65495>=W)e+=2;else break}(W=y(c,e))&&W.invalid&&(console.log("decodeScan - unexpected Scan data, next marker is: "+W.invalid),e=W.offset);return e-E}function H(c,e){c=e.blocksPerLine;for(var l=e.blocksPerColumn,q=new Int16Array(64),t=
0;t<l;t++)for(var h=0;h<c;h++){var p=void 0,v=void 0,a=void 0,g=void 0,d=void 0,b=void 0,f=void 0,k=void 0,r=d=b=g=v=p=void 0,B=void 0,A=void 0,n=void 0,C=64*((e.blocksPerLine+1)*t+h),E=q,I=e.quantizationTable,M=e.blockData;if(!I)throw new D("missing required Quantization Table.");for(var U=0;64>U;U+=8)p=M[C+U],k=M[C+U+1],f=M[C+U+2],b=M[C+U+3],d=M[C+U+4],g=M[C+U+5],a=M[C+U+6],v=M[C+U+7],p*=I[U],0===(k|f|b|d|g|a|v)?(p=5793*p+512>>10,E[U]=p,E[U+1]=p,E[U+2]=p,E[U+3]=p,E[U+4]=p,E[U+5]=p,E[U+6]=p,E[U+
7]=p):(k*=I[U+1],f*=I[U+2],b*=I[U+3],d*=I[U+4],g*=I[U+5],a*=I[U+6],v*=I[U+7],n=5793*p+128>>8,A=5793*d+128>>8,B=f,r=a,d=2896*(k-v)+128>>8,v=2896*(k+v)+128>>8,b<<=4,g<<=4,n=n+A+1>>1,A=n-A,p=3784*B+1567*r+128>>8,B=1567*B-3784*r+128>>8,r=p,d=d+g+1>>1,g=d-g,v=v+b+1>>1,b=v-b,n=n+r+1>>1,r=n-r,A=A+B+1>>1,B=A-B,p=2276*d+3406*v+2048>>12,d=3406*d-2276*v+2048>>12,v=p,p=799*b+4017*g+2048>>12,b=4017*b-799*g+2048>>12,g=p,E[U]=n+v,E[U+7]=n-v,E[U+1]=A+g,E[U+6]=A-g,E[U+2]=B+b,E[U+5]=B-b,E[U+3]=r+d,E[U+4]=r-d);for(I=
0;8>I;++I)p=E[I],k=E[I+8],f=E[I+16],b=E[I+24],d=E[I+32],g=E[I+40],a=E[I+48],v=E[I+56],0===(k|f|b|d|g|a|v)?(p=5793*p+8192>>14,p=-2040>p?0:2024<=p?255:p+2056>>4,M[C+I]=p,M[C+I+8]=p,M[C+I+16]=p,M[C+I+24]=p,M[C+I+32]=p,M[C+I+40]=p,M[C+I+48]=p,M[C+I+56]=p):(n=5793*p+2048>>12,A=5793*d+2048>>12,B=f,r=a,d=2896*(k-v)+2048>>12,v=2896*(k+v)+2048>>12,n=(n+A+1>>1)+4112,A=n-A,p=3784*B+1567*r+2048>>12,B=1567*B-3784*r+2048>>12,r=p,d=d+g+1>>1,g=d-g,v=v+b+1>>1,b=v-b,n=n+r+1>>1,r=n-r,A=A+B+1>>1,B=A-B,p=2276*d+3406*
v+2048>>12,d=3406*d-2276*v+2048>>12,v=p,p=799*b+4017*g+2048>>12,b=4017*b-799*g+2048>>12,g=p,p=n+v,v=n-v,k=A+g,a=A-g,f=B+b,g=B-b,b=r+d,d=r-d,p=16>p?0:4080<=p?255:p>>4,k=16>k?0:4080<=k?255:k>>4,f=16>f?0:4080<=f?255:f>>4,b=16>b?0:4080<=b?255:b>>4,d=16>d?0:4080<=d?255:d>>4,g=16>g?0:4080<=g?255:g>>4,a=16>a?0:4080<=a?255:a>>4,v=16>v?0:4080<=v?255:v>>4,M[C+I]=p,M[C+I+8]=k,M[C+I+16]=f,M[C+I+24]=b,M[C+I+32]=d,M[C+I+40]=g,M[C+I+48]=a,M[C+I+56]=v)}return e.blockData}function y(c,e,l){var q=c.length-1;l=l<e?
l:e;if(e>=q)return null;var t=c[e]<<8|c[e+1];if(65472<=t&&65534>=t)return{invalid:null,marker:t,offset:e};for(e=c[l]<<8|c[l+1];!(65472<=e&&65534>=e);){if(++l>=q)return null;e=c[l]<<8|c[l+1]}return{invalid:t.toString(16),marker:e,offset:l}}if(!self||!self.Uint8ClampedArray)return null;var u=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]);S.prototype=
{parse:function(c){function e(){var I=c[t]<<8|c[t+1];t+=2;return I}function l(){var I=e();I=t+I-2;var M=y(c,I,t);M&&M.invalid&&(console.log("readDataBlock - incorrect length, next marker is: "+M.invalid),I=M.offset);I=c.subarray(t,I);t+=I.length;return I}function q(I){for(var M=Math.ceil(I.samplesPerLine/8/I.maxH),U=Math.ceil(I.scanLines/8/I.maxV),F=0;F<I.components.length;F++){E=I.components[F];var x=Math.ceil(Math.ceil(I.samplesPerLine/8)*E.h/I.maxH),K=Math.ceil(Math.ceil(I.scanLines/8)*E.v/I.maxV);
E.blockData=new Int16Array(64*U*E.v*(M*E.h+1));E.blocksPerLine=x;E.blocksPerColumn=K}I.mcusPerLine=M;I.mcusPerColumn=U}var t=0,h=null,p=null,v=[],a=[],g=[],d=e();if(65496!==d)throw new D("SOI not found");for(d=e();65497!==d;){switch(d){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var b=l();65504===d&&74===b[0]&&70===b[1]&&73===b[2]&&70===b[3]&&0===b[4]&&(h=
{version:{major:b[5],minor:b[6]},densityUnits:b[7],xDensity:b[8]<<8|b[9],yDensity:b[10]<<8|b[11],thumbWidth:b[12],thumbHeight:b[13],thumbData:b.subarray(14,14+3*b[12]*b[13])});65518===d&&65===b[0]&&100===b[1]&&111===b[2]&&98===b[3]&&101===b[4]&&(p={version:b[5]<<8|b[6],flags0:b[7]<<8|b[8],flags1:b[9]<<8|b[10],transformCode:b[11]});break;case 65499:d=e()+t-2;for(var f;t<d;){var k=c[t++],r=new Uint16Array(64);if(0===k>>4)for(b=0;64>b;b++)f=u[b],r[f]=c[t++];else if(1===k>>4)for(b=0;64>b;b++)f=u[b],r[f]=
e();else throw new D("DQT - invalid table spec");v[k&15]=r}break;case 65472:case 65473:case 65474:if(B)throw new D("Only single frame JPEGs supported");e();var B={};B.extended=65473===d;B.progressive=65474===d;B.precision=c[t++];B.scanLines=e();B.samplesPerLine=e();B.components=[];B.componentIds={};b=c[t++];for(d=r=k=0;d<b;d++){f=c[t];var A=c[t+1]>>4;var n=c[t+1]&15;k<A&&(k=A);r<n&&(r=n);A=B.components.push({h:A,v:n,quantizationId:c[t+2],quantizationTable:null});B.componentIds[f]=A-1;t+=3}B.maxH=
k;B.maxV=r;q(B);break;case 65476:f=e();for(d=2;d<f;){k=c[t++];r=new Uint8Array(16);for(b=A=0;16>b;b++,t++)A+=r[b]=c[t];n=new Uint8Array(A);for(b=0;b<A;b++,t++)n[b]=c[t];d+=17+A;(0===k>>4?g:a)[k&15]=Q(r,n)}break;case 65501:e();var C=e();break;case 65498:e();f=c[t++];b=[];for(d=0;d<f;d++){k=B.componentIds[c[t++]];var E=B.components[k];k=c[t++];E.huffmanTableDC=g[k>>4];E.huffmanTableAC=a[k&15];b.push(E)}d=c[t++];f=c[t++];k=c[t++];d=P(c,t,B,b,C,d,f,k>>4,k&15);t+=d;break;case 65535:255!==c[t]&&t--;break;
default:if(255===c[t-3]&&192<=c[t-2]&&254>=c[t-2])t-=3;else throw new D("unknown marker "+d.toString(16));}d=e()}this.width=B.samplesPerLine;this.height=B.scanLines;this.jfif=h;this.eof=t;this.adobe=p;this.components=[];for(d=0;d<B.components.length;d++){E=B.components[d];if(h=v[E.quantizationId])E.quantizationTable=h;this.components.push({output:H(B,E),scaleX:E.h/B.maxH,scaleY:E.v/B.maxV,blocksPerLine:E.blocksPerLine,blocksPerColumn:E.blocksPerColumn})}this.numComponents=this.components.length},
_getLinearizedBlockData:function(c,e){var l=this.width/c,q=this.height/e,t,h,p=0,v=this.components.length,a=c*e*v,g=new Uint8ClampedArray(a),d=new Uint32Array(c);for(h=0;h<v;h++){var b=this.components[h];var f=b.scaleX*l;var k=b.scaleY*q;p=h;var r=b.output;var B=b.blocksPerLine+1<<3;for(t=0;t<c;t++)b=0|t*f,d[t]=(b&4294967288)<<3|b&7;for(f=0;f<e;f++)for(b=0|f*k,b=B*(b&4294967288)|(b&7)<<3,t=0;t<c;t++)g[p]=r[b+d[t]],p+=v}if(e=this.decodeTransform)for(h=0;h<a;)for(c=b=0;b<v;b++,h++,c+=2)g[h]=(g[h]*e[c]>>
8)+e[c+1];return g},_isColorConversionNeeded:function(){return this.adobe?!!this.adobe.transformCode:3===this.numComponents?0===this.colorTransform?!1:!0:1===this.colorTransform?!0:!1},_convertYccToRgb:function(c){for(var e,l,q,t=0,h=c.length;t<h;t+=3)e=c[t],l=c[t+1],q=c[t+2],c[t]=e-179.456+1.402*q,c[t+1]=e+135.459-.344*l-.714*q,c[t+2]=e-226.816+1.772*l;return c},_convertYcckToRgb:function(c){for(var e,l,q,t,h=0,p=0,v=c.length;p<v;p+=4)e=c[p],l=c[p+1],q=c[p+2],t=c[p+3],c[h++]=-122.67195406894+l*(-6.60635669420364E-5*
l+4.37130475926232E-4*q-5.4080610064599E-5*e+4.8449797120281E-4*t-.154362151871126)+q*(-9.57964378445773E-4*q+8.17076911346625E-4*e-.00477271405408747*t+1.53380253221734)+e*(9.61250184130688E-4*e-.00266257332283933*t+.48357088451265)+t*(-3.36197177618394E-4*t+.484791561490776),c[h++]=107.268039397724+l*(2.19927104525741E-5*l-6.40992018297945E-4*q+6.59397001245577E-4*e+4.26105652938837E-4*t-.176491792462875)+q*(-7.78269941513683E-4*q+.00130872261408275*e+7.70482631801132E-4*t-.151051492775562)+e*(.00126935368114843*
e-.00265090189010898*t+.25802910206845)+t*(-3.18913117588328E-4*t-.213742400323665),c[h++]=-20.810012546947+l*(-5.70115196973677E-4*l-2.63409051004589E-5*q+.0020741088115012*e-.00288260236853442*t+.814272968359295)+q*(-1.53496057440975E-5*q-1.32689043961446E-4*e+5.60833691242812E-4*t-.195152027534049)+e*(.00174418132927582*e-.00255243321439347*t+.116935020465145)+t*(-3.43531996510555E-4*t+.24165260232407);return c},_convertYcckToCmyk:function(c){for(var e,l,q,t=0,h=c.length;t<h;t+=4)e=c[t],l=c[t+
1],q=c[t+2],c[t]=434.456-e-1.402*q,c[t+1]=119.541-e+.344*l+.714*q,c[t+2]=481.816-e-1.772*l;return c},_convertCmykToRgb:function(c){for(var e,l,q,t,h=0,p=1/255,v=0,a=c.length;v<a;v+=4)e=c[v]*p,l=c[v+1]*p,q=c[v+2]*p,t=c[v+3]*p,c[h++]=255+e*(-4.387332384609988*e+54.48615194189176*l+18.82290502165302*q+212.25662451639585*t-285.2331026137004)+l*(1.7149763477362134*l-5.6096736904047315*q-17.873870861415444*t-5.497006427196366)+q*(-2.5217340131683033*q-21.248923337353073*t+17.5119270841813)-t*(21.86122147463605*
t+189.48180835922747),c[h++]=255+e*(8.841041422036149*e+60.118027045597366*l+6.871425592049007*q+31.159100130055922*t-79.2970844816548)+l*(-15.310361306967817*l+17.575251261109482*q+131.35250912493976*t-190.9453302588951)+q*(4.444339102852739*q+9.8632861493405*t-24.86741582555878)-t*(20.737325471181034*t+187.80453709719578),c[h++]=255+e*(.8842522430003296*e+8.078677503112928*l+30.89978309703729*q-.23883238689178934*t-14.183576799673286)+l*(10.49593273432072*l+63.02378494754052*q+50.606957656360734*
t-112.23884253719248)+q*(.03296041114873217*q+115.60384449646641*t-193.58209356861505)-t*(22.33816807309886*t+180.12613974708367);return c},getData:function(c,e,l){if(4<this.numComponents)throw new D("Unsupported color mode");c=this._getLinearizedBlockData(c,e);if(1===this.numComponents&&l){l=c.length;e=new Uint8ClampedArray(3*l);for(var q=0,t=0;t<l;t++){var h=c[t];e[q++]=h;e[q++]=h;e[q++]=h}return e}if(3===this.numComponents&&this._isColorConversionNeeded())return this._convertYccToRgb(c);if(4===
this.numComponents){if(this._isColorConversionNeeded())return l?this._convertYcckToRgb(c):this._convertYcckToCmyk(c);if(l)return this._convertCmykToRgb(c)}return c}};return S}()})})(z);w=w.getDefaultExportFromCjs(z.exports);m.JpegImage=w})},"esri/layers/support/rasterFormats/Lerc":function(){define(["require","exports","../../../assets"],function(m,w,z){function N(y,u,c){c.set(y.slice(u,u+c.length))}function D(y){const {_malloc:u,_free:c,_lerc_getBlobInfo:e,_lerc_getDataRanges:l,_lerc_decode_4D:q,
asm:t}=y;let h;const p=Object.values(t).find(a=>a&&"buffer"in a&&a.buffer===y.HEAPU8.buffer),v=a=>{a=a.map(b=>(b>>3<<3)+16);var g=a.reduce((b,f)=>b+f),d=u(g);h=new Uint8Array(p.buffer);g=a[0];a[0]=d;for(d=1;d<a.length;d++){const b=a[d];a[d]=a[d-1]+g;g=b}return a};H.getBlobInfo=a=>{var g=new Uint8Array(48),d=new Uint8Array(24);const [b,f,k]=v([a.length,g.length,d.length]);h.set(a,b);h.set(g,f);h.set(d,k);var r=e(b,a.length,f,k,12,3);if(r)throw c(b),Error(`lerc-getBlobInfo: error code is ${r}`);h=new Uint8Array(p.buffer);
N(h,f,g);N(h,k,d);g=new Uint32Array(g.buffer);var B=new Float64Array(d.buffer);const [A,n,,C,E,I,M,U,F,x,K]=g;d={version:A,depthCount:x,width:C,height:E,validPixelCount:M,bandCount:I,blobSize:U,maskCount:F,dataType:n,minValue:B[0],maxValue:B[1],maxZerror:B[2],statistics:[],bandCountWithNoData:K};if(K&&1<x)return c(b),d;if(1===x&&1===I)return c(b),d.statistics.push({minValue:B[0],maxValue:B[1]}),d;r=x*I*8;var J=new Uint8Array(r),G=new Uint8Array(r);g=b;var O=B=0;let R=!1;h.byteLength<b+2*r?(c(b),R=
!0,[g,B,O]=v([a.length,r,r]),h.set(a,g)):[B,O]=v([r,r]);h.set(J,B);h.set(G,O);if(r=l(g,a.length,x,I,B,O))throw c(g),R||c(B),Error(`lerc-getDataRanges: error code is ${r}`);h=new Uint8Array(p.buffer);N(h,B,J);N(h,O,G);a=new Float64Array(J.buffer);r=new Float64Array(G.buffer);G=d.statistics;for(J=0;J<I;J++)if(1<x){O=a.slice(J*x,(J+1)*x);const T=r.slice(J*x,(J+1)*x),X=Math.min.apply(null,O),L=Math.max.apply(null,T);G.push({minValue:X,maxValue:L,depthStats:{minValues:O,maxValues:T}})}else G.push({minValue:a[J],
maxValue:r[J]});c(g);R||c(B);return d};H.decode=(a,g)=>{const {maskCount:d,depthCount:b,bandCount:f,width:k,height:r,dataType:B,bandCountWithNoData:A}=g;var n=S[B],C=k*r;g=new Uint8Array(C*f);n=new Uint8Array(C*b*f*n.size);C=new Uint8Array(f);var E=new Uint8Array(8*f);const [I,M,U,F,x]=v([a.length,g.length,n.length,C.length,E.length]);h.set(a,I);h.set(g,M);h.set(n,U);h.set(C,F);h.set(E,x);if(a=q(I,a.length,d,M,b,k,r,f,B,U,F,x))throw c(I),Error(`lerc-decode: error code is ${a}`);h=new Uint8Array(p.buffer);
N(h,U,n);N(h,M,g);a=null;if(A){N(h,F,C);N(h,x,E);a=[];E=new Float64Array(E.buffer);for(let K=0;K<C.length;K++)a.push(C[K]?E[K]:null)}c(I);return{data:n,maskData:g,noDataValues:a}}}const S=[{pixelType:"S8",size:1,ctor:Int8Array,range:[-128,127]},{pixelType:"U8",size:1,ctor:Uint8Array,range:[0,255]},{pixelType:"S16",size:2,ctor:Int16Array,range:[-32768,32767]},{pixelType:"U16",size:2,ctor:Uint16Array,range:[0,65536]},{pixelType:"S32",size:4,ctor:Int32Array,range:[-2147483648,2147483647]},{pixelType:"U32",
size:4,ctor:Uint32Array,range:[0,4294967296]},{pixelType:"F32",size:4,ctor:Float32Array,range:[-3.4027999387901484E38,3.4027999387901484E38]},{pixelType:"F64",size:8,ctor:Float64Array,range:[-1.7976931348623157E308,1.7976931348623157E308]}];let Q=null,P=!1;const H={getBlobInfo:null,decode:null};w.decode=function(y,u={}){var c=u.inputOffset??0;y=y instanceof Uint8Array?y.subarray(c):new Uint8Array(y,c);c=H.getBlobInfo(y);const {data:e,maskData:l,noDataValues:q}=H.decode(y,c),{width:t,height:h,bandCount:p,
depthCount:v,dataType:a,maskCount:g,statistics:d}=c;var b=S[a],f=new b.ctor(e.buffer);y=[];c=[];const k=t*h;var r=k*v;for(var B=0;B<p;B++){var A=f.subarray(B*r,(B+1)*r);if(u.returnInterleaved)y.push(A);else{a:{var n=k,C=v;if(2>C)break a;const E=new b.ctor(n*C);for(let I=0,M=0;I<n;I++)for(let U=0,F=I;U<C;U++,F+=n)E[F]=A[M++];A=E}y.push(A)}c.push(l.subarray(B*r,(B+1)*r))}f=0===g?null:1===g?c[0]:new Uint8Array(k);if(1<g)for(f.set(c[0]),r=1;r<c.length;r++)for(B=c[r],A=0;A<k;A++)f[A]&=B[A];({noDataValue:u}=
u);r=null!=u&&b.range[0]<=u&&b.range[1]>=u;if(0<g&&r)for(r=0;r<p;r++)for(B=y[r],A=c[r]||f,n=0;n<k;n++)0===A[n]&&(B[n]=u);({pixelType:b}=b);return{width:t,height:h,bandCount:p,pixelType:b,depthCount:v,statistics:d,pixels:y,mask:f,bandMasks:g===p&&1<p?c:null,noDataValues:q}};w.getBlobInfo=function(y,u={}){y=y instanceof Uint8Array?y.subarray(u.inputOffset??0):new Uint8Array(y,u.inputOffset??0);return H.getBlobInfo(y)};w.isLoaded=function(){return P};w.load=function(){return Q?Q:Q=(new Promise((y,u)=>
m(["../../../chunks/lerc-wasm"],y,u))).then(y=>y.lercWasm).then(({default:y})=>y({locateFile:u=>z.getAssetUrl(`esri/layers/support/rasterFormats/${u}`)})).then(y=>{D(y);P=!0})};w.pixelTypeInfoMap=S;Object.defineProperty(w,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/Lzw":function(){define(["exports"],function(m){function w(S,Q,P,H=!0){if(0!==Q%4||0!==P%4){var y=new ArrayBuffer(4*Math.ceil(P/4));y=new Uint8Array(y);S=new Uint8Array(S,Q,P);if(H)for(H=0;H<y.length;H+=4)y[H]=
S[H+3],y[H+1]=S[H+2],y[H+2]=S[H+1],y[H+3]=S[H];else y.set(S);return new Uint32Array(y.buffer)}if(H){H=new Uint8Array(S,Q,P);y=new Uint8Array(H.length);for(S=0;S<y.length;S+=4)y[S]=H[S+3],y[S+1]=H[S+2],y[S+2]=H[S+1],y[S+3]=H[S];return new Uint32Array(y.buffer)}return new Uint32Array(S,Q,P/4)}function z(){const S=[];for(let Q=0;257>=Q;Q++)S[Q]=[Q];return S}function N(S,Q){for(let P=0;P<Q.length;P++)S.push(Q[P])}const D=new Set;D.add(511);D.add(1023);D.add(2047);D.add(4095);D.add(8191);m.decode=function(S,
Q,P,H=!0){S=w(S,Q,P,H);Q=9;H=z();let y=32,u=H.length,c=[],e=1,l=S[0],q=0;const t=S.length;P=8*(4*t-P);const h=[];for(;null!=l;){if(y>=Q)y-=Q,q=l>>>32-Q,l<<=Q;else{q=l>>>32-y;l=S[e++];var p=Q-y;y=32-p;q=(q<<p)+(l>>>y);l<<=p}if(257===q)break;if(256===q)Q=9,H=z(),u=H.length,c=[];else{p=H[q];if(null==p){if(q>H.length)throw Error("data integrity issue: code does not exist on code page");c.push(c[0]);H[u++]=c.slice();N(h,c)}else N(h,p),c.push(p[0]),1<c.length&&(H[u++]=c.slice()),c=p.slice();D.has(u)&&Q++;
0===y&&(l=S[e++],y=32);if(e>t||e===t&&y<=P)break}}return new Uint8Array(h)};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/Raw":function(){define(function(){const m=z=>{let N=1;switch(z){case Uint8Array:case Int8Array:N=1;break;case Uint16Array:case Int16Array:N=2;break;case Uint32Array:case Int32Array:case Float32Array:N=4;break;case Float64Array:N=8}return N};class w{static decode(z,N){var D=N.pixelType;const S=[],Q=N.width*N.height;var P=Math.floor(z.byteLength/
(N.width*N.height*m(N.pixelType)));const {bandIds:H,format:y}=N;N=H?.length||Math.floor(z.byteLength/(N.width*N.height*m(N.pixelType)));var u=z.byteLength-z.byteLength%(Q*m(D)),c=new D(z,0,Q*P);let e,l,q,t,h=null;if("bip"===y)for(e=0;e<N;e++){q=new D(Q);t=H?H[e]:e;for(l=0;l<Q;l++)q[l]=c[l*P+t];S.push(q)}else if("bsq"===y)for(e=0;e<N;e++)t=H?H[e]:e,S.push(c.subarray(t*Q,(t+1)*Q));if(u<z.byteLength-1)if(z=z.slice(u),8*z.byteLength<Q)h=null;else{z=new Uint8Array(z,0,Math.ceil(Q/8));D=new Uint8Array(Q);
for(u=c=u=N=P=0;u<z.length-1;u++)for(N=z[u],c=7;0<=c;c--)D[P++]=N>>c&1;for(c=7;P<Q-1;)N=z[z.length-1],D[P++]=N>>c&1,c--;h=D}return{pixels:S,mask:h}}}return w})},"esri/layers/support/rasterFormats/TiffDecoder":function(){define("exports ../rasterDatasets/byteStreamUtils ../../../chunks/Jpg ./Lerc ./Lzw ./pixelRangeUtils ./TiffTags ./utils ../../../chunks/Zlib".split(" "),function(m,w,z,N,D,S,Q,P,H){function y(F,x){let K="unknown";3===F?K=64===x?"f64":"f32":1===F?1===x?K="u1":2===x?K="u2":4===x?K="u4":
8>=x?K="u8":16>=x?K="u16":32>=x&&(K="u32"):2===F&&(8>=x?K="s8":16>=x?K="s16":32>=x&&(K="s32"));return K}function u(F){let x=null;switch(F?F.toLowerCase():"f32"){case "u1":case "u2":case "u4":case "u8":x=Uint8Array;break;case "u16":x=Uint16Array;break;case "u32":x=Uint32Array;break;case "s8":x=Int8Array;break;case "s16":x=Int16Array;break;case "s32":x=Int32Array;break;case "f64":x=Float64Array;break;default:x=Float32Array}return x}function c(F,x){return{x:x[0]*F.x+x[1]*F.y+x[2],y:x[3]*F.x+x[4]*F.y+
x[5]}}function e(F,x){return F.get(x)?.values?.[0]}function l(F,x,K,J=0,G=Q.tiffTags,O=4){var R=8===O;const T=R?r(new DataView(F,K,8),0,x):(new DataView(F,K,2)).getUint16(0,x),X=4+2*O;var L=R?8:2;R=L+T*X;if(K+R>F.byteLength)return{success:!1,ifd:null,nextIFD:null,requiredBufferSize:R};const V=K+R+4<=F.byteLength?B(new DataView(F,K+R,8===O?8:4),0,x,8===O):null;K+=L;L=new Map;let W,Y,Z,aa=0,fa=0;for(let ca=0;ca<T;ca++){var ea=new DataView(F,K+X*ca,X);W=ea.getUint16(0,x);Z=ea.getUint16(2,x);Y=Q.getTagName(W,
G);const ja=[];2===O?(aa=ea.getUint16(4,x),fa=ea.getUint16(6,x)):4===O?(aa=ea.getUint32(4,x),fa=ea.getUint32(8,x)):8===O&&(aa=B(ea,4,x,!0),fa=B(ea,12,x,!0),ja.push(ea.getUint32(12,x)),ja.push(ea.getUint32(16,x)));ea={id:W,type:Z,valueCount:aa,valueOffset:fa,valueOffsets:ja,values:null};a(F,x,ea,J,!1,O);L.set(Y,ea)}return{success:!0,ifd:L,nextIFD:V,requiredBufferSize:R}}function q(F,x){if(1!==x&&2!==x&&4!==x)return F;const K=new Uint8Array(F),J=8/x;F=new Uint8Array(F.byteLength*J);let G=0;const O=
2**x-1;for(let R=0;R<K.length;R++){const T=K[R];for(let X=0;X<J;X++)F[G++]=T<<x*X>>>8-x&O}return F.buffer}function t(F,x,K){const J=new z.JpegImage;J.parse(F);J.colorTransform=6===K?-1:0;F=J.getData(J.width,J.height,1!==x&&4!==x);return new Uint8Array(F.buffer)}function h(F){F=(new H.Zlib(F)).getBytes();var x=new ArrayBuffer(F.length);x=new Uint8Array(x);x.set(F);return x}async function p(F,x,K,J,G){var O=P.isPlatformLittleEndian===x,R=e(K,"BITSPERSAMPLE"),T=e(K,"SAMPLESPERPIXEL")??1,X=e(K,"PHOTOMETRICINTERPRETATION"),
L=e(K,"SAMPLEFORMAT")??1,V=y(L,R),W=e(K,"COMPRESSION")??1,Y=u(V);if(34887===W)return await N.load(),N.decode(F,{inputOffset:J}).pixels[0];if(1===W)X=F.slice(J,J+G),x=new Uint8Array(X);else if(8===W||32946===W)x=new Uint8Array(F,J,G),x=h(x),X=x.buffer;else if(6===W)x=new Uint8Array(F,J,G),x=t(x,T,X),X=x.buffer;else if(7===W){const Z=K.get("JPEGTABLES").values,aa=Z.length-2;x=new Uint8Array(aa+G-2);for(let fa=0;fa<aa;fa++)x[fa]=Z[fa];F=new Uint8Array(F,J+2,G-2);for(J=0;J<F.length;J++)x[aa+J]=F[J];x=
t(x,T,X);X=x.buffer}else if(5===W)x=D.decode(F,J,G,x),X=x.buffer;else throw Error("tiff-decode: unsupport compression "+W);X=q(X,R);if("u8"!==V&&"s8"!==V&&!O)switch(X=new ArrayBuffer(x.length),O=new Uint8Array(X),V){case "u16":case "s16":for(V=0;V<x.length;V+=2)O[V]=x[V+1],O[V+1]=x[V];break;case "u32":case "s32":case "f32":for(V=0;V<x.length;V+=4)O[V]=x[V+3],O[V+1]=x[V+2],O[V+2]=x[V+1],O[V+3]=x[V]}R=new Y(X);O=e(K,"PREDICTOR")??1;V=e(K,"TILEWIDTH");x=e(K,"TILELENGTH");if(1<O&&(5===W||8===W||32946===
W)&&V&&x){W=d(K);Y=new Y(R.length);Y.set(R);K=3===L&&3===O;W=W?1:T;T=K?4:1;L=V*T*W;K&&(Y=new Uint8Array(Y.buffer));for(O=0;O<x;O++)for(R=O*L,X=W;X<L;X++)Y[R+X]+=Y[R+X-W];if(K){K=new Uint8Array(Y.length);W*=V;for(V=0;V<x;V++)for(O=V*L,R=0;R<W;R++)for(X=0;X<T;X++)K[O+R*T+X]=Y[O+R+(T-X-1)*W];R=new Float32Array(K.buffer)}else R=Y}return R}async function v(F,x,K){const J=K.get("TILEOFFSETS")?.values;if(void 0===J)return null;const G=K.get("TILEBYTECOUNTS")?.values,{width:O,height:R,pixelType:T,tileWidth:X,
tileHeight:L}=g([K]);var V=d(K,x);const W=e(K,"SAMPLESPERPIXEL")||x.planes;var Y=O*R,Z=e(K,"BITSPERSAMPLE"),aa=34887===(e(K,"COMPRESSION")??1),fa=u(T);const ea=[];for(var ca=0;ca<W;ca++)ea.push(new fa(Y));let ja,la,oa,pa,qa,ra,sa,ua,ma;fa=Math.ceil(O/X);Y=(new Uint8Array(Y)).fill(255);ca=!1;if(0===Z%8)if(aa&&V&&1<W)for(V=Math.round(J.length/W),Z=0;Z<V;Z++){var wa=Math.floor(Z/fa)*L;oa=Z%fa*X;pa=wa*O+oa;for(aa=0;aa<W;aa++){var ba=Z*W+aa;0===G[ba]?(ba=null,ca=!0):ba=await p(F,x.littleEndian,K,J[ba],
G[ba]);ra=0;qa=pa;ua=Math.min(X,O-oa);sa=Math.min(L,R-wa);ma=ea[aa];for(ja=0;ja<sa;ja++)for(qa=pa+ja*O,ra=ja*X,la=0;la<ua;la++,qa++,ra++)ba?ma[qa]=ba[ra]:Y[qa]=0}}else for(Z=0;Z<J.length;Z++)for(wa=Math.floor(Z/fa)*L,oa=Z%fa*X,pa=wa*O+oa,0===G[Z]?(ba=null,ca=!0):ba=await p(F,x.littleEndian,K,J[Z],G[Z]),ra=0,qa=pa,ua=Math.min(X,O-oa),sa=Math.min(L,R-wa),wa=0;wa<W;wa++)if(ma=ea[wa],V||aa)for(ja=0;ja<sa;ja++)for(qa=pa+ja*O,ra=X*L*wa+ja*X,la=0;la<ua;la++,qa++,ra++)ba?ma[qa]=ba[ra]:Y[qa]=0;else for(ja=
0;ja<sa;ja++)for(qa=pa+ja*O,ra=ja*X*W+wa,la=0;la<ua;la++,qa++,ra+=W)ba?ma[qa]=ba[ra]:Y[qa]=0;return{width:O,height:R,pixelType:T,pixels:ea,mask:ca?Y:void 0}}function a(F,x,K,J=0,G=!1,O=4){if(K.values)return!0;var R=K.type,T=K.valueCount,X=K.valueOffset;let L=[];var V=E[R],W=8*V,Y=T*V,Z=T*E[R]*8,aa=8===O?64:32;O=K.valueOffsets;if(Z>aa&&Y>(G?F.byteLength:F?F.byteLength-X+J:0))return K.offlineOffsetSize=[X,Y],K.values=null,!1;if(Z<=aa)if(x||(32>=aa?X>>>=32-Z:(F=O?.length?O[0]:X>>>0,x=O?.length?O[1]:
Math.round((X-F)/4294967296),32>=Z?(X=F>>>32-Z,O[0]=X):(X=F*2**(32-Z)+(x>>>32-Z),O[0]=F,O[1]=x>>>32-Z))),1===T&&W===aa)L=[X];else if(64===aa)for(F=O?.length?O[0]:X>>>0,X=O?.length?O[1]:Math.round((X-F)/4294967296),x=F,V=32,F=1;F<=T;F++)Y=32-W*F%32,V<W?(Y=x<<Y>>>32-V,Z=X<<32-V>>>32-V,x=X,L.push(Y+Z*2**(W-V)),V-=32-(W-V)):(L.push(x<<Y>>>32-W),V-=W),0===V&&(V=32,x=X);else for(F=1;F<=T;F++)L.push(X<<32-W*F>>>32-W);else for(X-=J,G&&(X=0),T=X;T<X+Y;T+=V){switch(R){case 1:W=(new DataView(F,T,1)).getUint8(0);
break;case 2:W=(new DataView(F,T,1)).getUint8(0);break;case 3:W=(new DataView(F,T,2)).getUint16(0,x);break;case 4:case 13:W=(new DataView(F,T,4)).getUint32(0,x);break;case 5:W=(new DataView(F,T,4)).getUint32(0,x)/(new DataView(F,T+4,4)).getUint32(0,x);break;case 6:W=(new DataView(F,T,1)).getInt8(0);break;case 7:W=(new DataView(F,T,1)).getUint8(0);break;case 8:W=(new DataView(F,T,2)).getInt16(0,x);break;case 9:W=(new DataView(F,T,4)).getInt32(0,x);break;case 10:W=(new DataView(F,T,4)).getInt32(0,x)/
(new DataView(F,T+4,4)).getInt32(0,x);break;case 11:W=(new DataView(F,T,4)).getFloat32(0,x);break;case 12:W=(new DataView(F,T,8)).getFloat64(0,x);break;case 16:case 18:W=r(new DataView(F,T,8),0,x);break;case 17:O=new DataView(F,T,8);Z=(W=x)?O.getInt32(0,W):O.getUint32(0,W);O=W?O.getUint32(4,W):O.getInt32(4,W);aa=0<=(W?Z:O)?1:-1;W?Z*=aa:O*=aa;W=aa*(W?4294967296*O+Z:4294967296*Z+O);break;default:W=null}L.push(W)}if(2===R){R="";X=L;L=[];for(F=0;F<X.length;F++)0===X[F]&&""!==R?(L.push(R),R=""):R+=String.fromCharCode(X[F]);
""===R&&0!==L.length||L.push(R)}K.values=L;return!0}function g(F){var x=F[0];const K=e(x,"TILEWIDTH"),J=e(x,"TILELENGTH"),G=e(x,"IMAGEWIDTH"),O=e(x,"IMAGELENGTH");var R=e(x,"BITSPERSAMPLE");const T=e(x,"SAMPLESPERPIXEL");var X=e(x,"SAMPLEFORMAT")??1;const L=y(X,R),V=d(x);var W=x.get("GDAL_NODATA")?.values;let Y=null;W?.length&&(Y=W.map(ma=>parseFloat(ma)),Y.some(ma=>isNaN(ma))&&(Y=null));var Z=e(x,"COMPRESSION")??1;switch(Z){case 1:W="NONE";break;case 2:case 3:case 4:case 32771:W="CCITT";break;case 5:W=
"LZW";break;case 6:case 7:W="JPEG";break;case 32773:W="PACKBITS";break;case 8:case 32946:W="DEFLATE";break;case 34712:W="JPEG2000";break;case 34887:W="LERC";break;default:W=String(Z)}let aa=!0,fa="";I.has(Z)||(aa=!1,fa+="unsupported tag compression "+Z);3<X&&(aa=!1,fa+="unsupported tag sampleFormat "+X);1!==R&&2!==R&&4!==R&&0!==R%8&&(aa=!1,fa+="unsupported tag bitsPerSample "+R);R=x.get("GEOASCIIPARAMS")?.values?.[0];if(R){var ea=(ea=R.split("|").find(ma=>ma.includes("ESRI PE String \x3d ")))?ea.replace("ESRI PE String \x3d ",
""):"";ea=ea.startsWith("COMPD_CS")||ea.startsWith("PROJCS")||ea.startsWith("GEOGCS")?{wkid:null,wkt:ea}:null}X=x.get("GEOTIEPOINTS")?.values;R=x.get("GEOPIXELSCALE")?.values;Z=x.get("GEOTRANSMATRIX")?.values;var ca=x.has("GEOKEYDIRECTORY")?x.get("GEOKEYDIRECTORY").data:null,ja=!1;x=!1;if(ca){ja=2===e(ca,"GTRasterTypeGeoKey");var la=e(ca,"GTModelTypeGeoKey");2===la?(ca=e(ca,"GeographicTypeGeoKey"),1024<=ca&&32766>=ca&&(ea={wkid:ca}),ea||32767!==ca||(x=!0,ea={wkid:4326})):1===la&&(ca=e(ca,"ProjectedCSTypeGeoKey"),
1024<=ca&&32766>=ca&&(ea={wkid:ca}))}let oa;R&&X&&6<=X.length?(oa=[R[0],0,X[3]-X[0]*R[0],0,-Math.abs(R[1]),X[4]-X[1]*R[1]],ja&&(oa[2]-=.5*oa[0]+.5*oa[1],oa[5]-=.5*oa[3]+.5*oa[4])):Z&&16===Z.length&&(oa=ja?[Z[0],Z[1],Z[3]-.5*Z[0],Z[4],Z[5],Z[7]-.5*Z[5]]:[Z[0],Z[1],Z[3],Z[4],Z[5],Z[7]]);if(oa){X=[{x:0,y:O},{x:0,y:0},{x:G,y:O},{x:G,y:0}];ca=ja=Number.POSITIVE_INFINITY;let ma=la=Number.NEGATIVE_INFINITY;for(let wa=0;wa<X.length;wa++)Z=c(X[wa],oa),ja=Z.x>ja?ja:Z.x,la=Z.x<la?la:Z.x,ca=Z.y>ca?ca:Z.y,ma=
Z.y<ma?ma:Z.y;X={xmin:ja,xmax:la,ymin:ca,ymax:ma,spatialReference:ea}}else X={xmin:-.5,ymin:.5-O,xmax:G-.5,ymax:.5,spatialReference:ea};x&&(400<X.xmax-X.xmin||361<Math.max(Math.abs(X.xmin),Math.abs(X.xmax)))&&(ea=null,X.spatialReference=null);ea=b(F);let pa;let qa,ra;if(0<ea.length){qa=Math.round(Math.log(G/e(ea[0],"IMAGEWIDTH"))/Math.LN2);var sa=ea[ea.length-1];ra=Math.round(Math.log(G/e(sa,"IMAGEWIDTH"))/Math.LN2);pa=e(sa,"TILEWIDTH");sa=e(sa,"TILELENGTH")}pa=null!=ra&&0<ra?pa||K:null;sa=null!=
ra&&0<ra?sa||J:null;let ua;K&&(ua=[{maxCol:Math.ceil(G/K)-1,maxRow:Math.ceil(O/J)-1,minRow:0,minCol:0}],ea.forEach(ma=>{ua.push({maxCol:Math.ceil(e(ma,"IMAGEWIDTH")/e(ma,"TILEWIDTH"))-1,maxRow:Math.ceil(e(ma,"IMAGELENGTH")/e(ma,"TILELENGTH"))-1,minRow:0,minCol:0})}));Z=F[0].get("GDAL_METADATA")?.values?.[0];Z=U(Z);fa+=" "+C({width:G,height:O,tileWidth:K,tileHeight:J,planes:T,ifds:F});F=f(F).length===ea.length+1;return{width:G,height:O,tileWidth:K,tileHeight:J,planes:T,isBSQ:V,pixelType:L,compression:W,
noData:Y,hasMaskBand:F,isSupported:aa,message:fa,extent:X,isPseudoGeographic:x,affine:R?null:oa,firstPyramidLevel:qa,maximumPyramidLevel:ra,pyramidBlockWidth:pa,pyramidBlockHeight:sa,tileBoundary:ua,metadata:Z}}function d(F,x){return(F=F.get("PLANARCONFIGURATION")?.values)?2===F[0]:x?x.isBSQ:!1}function b(F){return F.filter(x=>1===e(x,"NEWSUBFILETYPE"))}function f(F){return F.filter(x=>{const K=4===((e(x,"NEWSUBFILETYPE")??0)&4);x=4===e(x,"PHOTOMETRICINTERPRETATION");return K&&x})}function k(F){const {littleEndian:x,
isBigTiff:K,firstIFDPos:J}=A(F);var G=J;const O=[];do if(G=n(F,x,G,0,Q.tiffTags,K?8:4),G.success)O.push(G.ifd),G=G.nextIFD;else break;while(0<G);F=g(O);G=b(O);const R=f(O);return{...F,littleEndian:x,isBigTiff:K,ifds:O,pyramidIFDs:G,maskIFDs:R}}function r(F,x,K){const J=F.getUint32(x,K);F=F.getUint32(x+4,K);return K?4294967296*F+J:4294967296*J+F}function B(F,x,K,J){return J?r(F,x,K):F.getUint32(x,K)}function A(F){var x=new DataView(F,0,16),K=x.getUint16(0,!1);F=null;if(18761===K)F=!0;else if(19789===
K)F=!1;else throw Error("unexpected endianess byte");var J=x.getUint16(2,F);if(42!==J&&43!==J)throw Error("unexpected tiff identifier");K=4;if(J=43===J){const G=x.getUint16(K,F);K+=2;if(8!==G)throw Error("unsupported bigtiff version");if(0!==x.getUint16(K,F))throw Error("unsupported bigtiff version");K+=2}x=B(x,K,F,J);return{littleEndian:F,isBigTiff:J,firstIFDPos:x}}function n(F,x,K,J=0,G=Q.tiffTags,O=4){K=l(F,x,K,J,G,O);let R;const T=K.ifd;T&&(Q.ifdTags.forEach((X,L)=>{T.has(L)&&(R=T.get(L),R.data=
l(F,x,R.valueOffset-J,J,X).ifd)}),T.has("GEOKEYDIRECTORY")&&(R=T.get("GEOKEYDIRECTORY"),(G=R.values)&&4<G.length&&(G=G[0]+"."+G[1]+"."+G[2],R.data=l(F,x,R.valueOffset+6-J,J,Q.geoKeys,2).ifd,R.data&&R.data.set("GEOTIFFVersion",{id:0,type:2,valueCount:1,valueOffset:null,values:[G]}))),T.has("XMP")&&(R=T.get("XMP"),G=R.values,"number"===typeof G[0]&&7===R.type&&(R.values=[w.bytesToUTF8(new Uint8Array(G))])));return K}function C(F){const {width:x,height:K,tileHeight:J,tileWidth:G}=F,O=F.planes,R=G?G*
J:x*K;F=e(F.ifds[0],"BITSPERSAMPLE");let T="";R*O>2**30/(8<F?F/8:1)&&(T=G?"tiled tiff exceeding 1 gigabits per tile is not supported":"scanline tiff exceeding 1 gigabits is not supported");return T}const E=[0,1,1,2,4,8,1,1,2,4,8,4,8,-1,-1,-1,8,8,8],I=new Set([1,5,6,7,8,34712,34887]),M=(F,x,K)=>{if(!(F&&0<F.length&&x&&K))return null;let J,G,O;const R=F[0].length,T=F.length,X=new Uint8Array(R);for(let V=0;V<T;V++)if(J=F[V],G=x[V],O=K[V],0===V)for(var L=0;L<R;L++)X[L]=J[L]<G||J[L]>O?0:1;else for(L=0;L<
R;L++)X[L]&&(X[L]=J[L]<G||J[L]>O?0:1);return X},U=F=>{if(!F)return null;var x=F.match(/<Item(.*?)Item>/gi);if(!x||0===x.length)return null;F=new Map;var K;for(var J=0;J<x.length;J++){var G=x[J];var O=G.slice(6,G.indexOf("\x3e"));var R=G.indexOf("sample\x3d");-1<R&&(K=G.slice(R+8,G.indexOf('"',R+8)));R=G.indexOf("name\x3d");-1<R&&(O=G.slice(R+6,G.indexOf('"',R+6)));O&&(G=G.slice(G.indexOf("\x3e")+1,G.indexOf("\x3c/Item\x3e")).trim(),null!=K?F.has(O)?F.get(O)[K]=G:F.set(O,[G]):F.set(O,G));K=null}x=
F.get("STATISTICS_MINIMUM");O=F.get("STATISTICS_MAXIMUM");J=F.get("STATISTICS_MEAN");G=F.get("STATISTICS_STDDEV");K=null;if(x&&O)for(K=[],R=0;R<x.length;R++)K.push({min:parseFloat(x[R]),max:parseFloat(O[R]),avg:J&&parseFloat(J[R]),stddev:G&&parseFloat(G[R])});O=F.get("BandName");J=F.get("WavelengthMin");G=F.get("WavelengthMax");x=null;if(O)for(x=[],R=0;R<O.length;R++)x.push({BandName:O[R],WavelengthMin:J&&parseFloat(J[R]),WavelengthMax:G&&parseFloat(G[R])});O=F.get("DataType");return{statistics:K,
bandProperties:x,dataType:O,rawMetadata:F}};m.decode=async function(F,x={}){var K=x.pyramidLevel||0,J=x.headerInfo||k(F);const {ifds:G,noData:O}=J;if(0===G.length)throw Error("no valid image file directory");var R=C(J);if(R)throw R;R=null;var T=-1===K?G[G.length-1]:G[K];x=O??x.noDataValue;if(J.tileWidth)R=await v(F,J,T);else{{const ra=P.isPlatformLittleEndian===J.littleEndian,sa=T.get("STRIPOFFSETS")?.values;if(void 0===sa)R=null;else{var {width:X,height:L,pixelType:V}=g([T]);K=e(T,"SAMPLESPERPIXEL")||
J.planes;var W=e(T,"PHOTOMETRICINTERPRETATION");R=X*L;var Y=e(T,"BITSPERSAMPLE"),Z=u(V),aa=new Z(R*K),fa=T.get("STRIPBYTECOUNTS")?.values,ea=e(T,"ROWSPERSTRIP"),ca=e(T,"COMPRESSION")??1;var ja=ea;if(0===Y%8)for(T=0;T<sa.length;T++){var la=T*ea*X*K;ja=(T+1)*ea>L?L-T*ea:ea;if("u8"===V||"s8"===V||ra)if(8===ca||32946===ca){var oa=new Uint8Array(F,sa[T],fa[T]);oa=h(oa);var pa=oa.buffer}else 6===ca?(oa=new Uint8Array(F,sa[T],fa[T]),oa=t(oa,K,W),pa=oa.buffer):5===ca?(oa=D.decode(F,sa[T],fa[T],J.littleEndian),
pa=oa.buffer):(fa[T]!==ja*X*K*Y/8&&console.log("strip byte counts is different than expected"),pa=F.slice(sa[T],sa[T]+fa[T]));else{if(6===ca||8===ca||32946===ca){oa=new Uint8Array(F,sa[T],fa[T]);var qa=h(oa);pa=qa.buffer}else fa[T]!==ja*X*K*Y/8&&console.log("strip byte counts is different than expected"),pa=new ArrayBuffer(fa[T]),oa=new Uint8Array(F,sa[T],fa[T]),qa=new Uint8Array(pa);switch(V){case "u16":case "s16":for(ja=0;ja<oa.length;ja+=2)qa[ja]=oa[ja+1],qa[ja+1]=oa[ja];break;case "u32":case "s32":case "f32":for(ja=
0;ja<oa.length;ja+=4)qa[ja]=oa[ja+3],qa[ja+1]=oa[ja+2],qa[ja+2]=oa[ja+1],qa[ja+3]=oa[ja]}}pa=q(pa,Y);ja=new Z(pa);aa.set(ja,la)}W=[];if(1===K)W.push(aa);else for(T=0;T<K;T++){J=new Z(R);for(F=0;F<R;F++)J[F]=aa[F*K+T];W.push(J)}R={width:X,height:L,pixelType:V,pixels:W}}}}if(!R)return R;null!=x&&S.convertNoDataToMask(R,x);return R};m.decodeTileOrStrip=async function(F,x){const {headerInfo:K,ifd:J,offsets:G,sizes:O}=x;var R=[];for(var T=0;T<G.length;T++){0===O[T]?1:0;var X=await p(F,K.littleEndian,J,
G[T],O[T]||F.byteLength);R.push(X)}var L=d(J,K);F=e(J,"BITSPERSAMPLE");T=e(J,"SAMPLEFORMAT")??1;T=y(T,F);var V=e(J,"SAMPLESPERPIXEL")||K.planes;const W=u(T);X=e(J,"TILEWIDTH");const Y=e(J,"TILELENGTH");var Z=e(J,"COMPRESSION")??1;const aa=X*Y;F=[];let fa=R[0];const ea=34887===Z;for(let ca=0;ca<V;ca++){Z=new W(aa);if(R.length===V)fa=R[ca],fa.length===aa&&(Z=fa);else if(fa.length)if(L||ea)Z=fa.length===aa?fa:fa.slice(aa*ca,aa*(ca+1));else for(let ja=0;ja<aa;ja++)Z[ja]=fa[ja*V+ca];F.push(Z)}R=K.noData?
K.noData[0]:x.noDataValue;L=(V=K.metadata?K.metadata.statistics:null)?V.map(ca=>ca.min):null;V=V?V.map(ca=>ca.max):null;T={pixelType:T,width:X,height:Y,pixels:F,noDataValue:R};null!=R?S.convertNoDataToMask(T,R):L&&V&&x.applyMinMaxConstraint&&(T.mask=M(F,L,V));return T};m.getImageInfo=g;m.getMaskIFDs=f;m.getPyramidIFDs=b;m.isBSQConfig=d;m.parseFieldValues=a;m.parseHeader=k;m.parseIFD=n;m.parseSignature=A;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/byteStreamUtils":function(){define(["exports"],
function(m){m.bytesToUTF8=function(w,z){let N=0,D="",S=0,Q=0;const P=w.length;for(;N<P;)if(Q=w[N++],S=Q>>4,8>S?S=1:15===S?(S=4,Q=(Q&7)<<18|(w[N++]&63)<<12|(w[N++]&63)<<6|w[N++]&63):14===S?(S=3,Q=(Q&15)<<12|(w[N++]&63)<<6|w[N++]&63):(S=2,Q=(Q&31)<<6|w[N++]&63),0!==Q||z)D+=String.fromCharCode(Q);return D};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/TiffTags":function(){define(function(){const m=(()=>{const D=[];D[254]="NEWSUBFILETYPE";D[255]="SUBFILETYPE";
D[256]="IMAGEWIDTH";D[257]="IMAGELENGTH";D[258]="BITSPERSAMPLE";D[259]="COMPRESSION";D[262]="PHOTOMETRICINTERPRETATION";D[263]="THRESHHOLDING";D[264]="CELLWIDTH";D[265]="CELLLENGTH";D[266]="FILLORDER";D[269]="DOCUMENTNAME";D[270]="IMAGEDESCRIPTION";D[271]="MAKE";D[272]="MODEL";D[273]="STRIPOFFSETS";D[274]="ORIENTATION";D[277]="SAMPLESPERPIXEL";D[278]="ROWSPERSTRIP";D[279]="STRIPBYTECOUNTS";D[280]="MINSAMPLEVALUE";D[281]="MAXSAMPLEVALUE";D[282]="XRESOLUTION";D[283]="YRESOLUTION";D[284]="PLANARCONFIGURATION";
D[285]="PAGENAME";D[286]="XPOSITION";D[287]="YPOSITION";D[288]="FREEOFFSETS";D[289]="FREEBYTECOUNTS";D[290]="GRAYRESPONSEUNIT";D[291]="GRAYRESPONSECURVE";D[292]="T4OPTIONS";D[293]="T6OPTIONS";D[296]="RESOLUTIONUNIT";D[297]="PAGENUMBER";D[300]="COLORRESPONSEUNIT";D[301]="TRANSFERFUNCTION";D[305]="SOFTWARE";D[306]="DATETIME";D[315]="ARTIST";D[316]="HOSTCOMPUTER";D[317]="PREDICTOR";D[318]="WHITEPOINT";D[319]="PRIMARYCHROMATICITIES";D[320]="COLORMAP";D[321]="HALFTONEHINTS";D[322]="TILEWIDTH";D[323]="TILELENGTH";
D[324]="TILEOFFSETS";D[325]="TILEBYTECOUNTS";D[326]="BADFAXLINES";D[327]="CLEANFAXDATA";D[328]="CONSECUTIVEBADFAXLINES";D[330]="SUBIFD";D[332]="INKSET";D[333]="INKNAMES";D[334]="NUMBEROFINKS";D[336]="DOTRANGE";D[337]="TARGETPRINTER";D[338]="EXTRASAMPLES";D[339]="SAMPLEFORMAT";D[340]="SMINSAMPLEVALUE";D[341]="SMAXSAMPLEVALUE";D[342]="TRANSFERRANGE";D[347]="JPEGTABLES";D[512]="JPEGPROC";D[513]="JPEGIFOFFSET";D[514]="JPEGIFBYTECOUNT";D[515]="JPEGRESTARTINTERVAL";D[517]="JPEGLOSSLESSPREDICTORS";D[518]=
"JPEGPOINTTRANSFORM";D[519]="JPEGQTABLES";D[520]="JPEGDCTABLES";D[521]="JPEGACTABLES";D[529]="YCBCRCOEFFICIENTS";D[530]="YCBCRSUBSAMPLING";D[531]="YCBCRPOSITIONING";D[532]="REFERENCEBLACKWHITE";D[700]="XMP";D[33550]="GEOPIXELSCALE";D[33922]="GEOTIEPOINTS";D[33432]="COPYRIGHT";D[42112]="GDAL_METADATA";D[42113]="GDAL_NODATA";D[50844]="RPCCOEFFICIENT";D[34264]="GEOTRANSMATRIX";D[34735]="GEOKEYDIRECTORY";D[34736]="GEODOUBLEPARAMS";D[34737]="GEOASCIIPARAMS";D[34665]="EXIFIFD";D[34853]="GPSIFD";D[40965]=
"INTEROPERABILITYIFD";return D})(),w=(()=>{const D=m.slice();D[36864]="ExifVersion";D[40960]="FlashpixVersion";D[40961]="ColorSpace";D[42240]="Gamma";D[37121]="ComponentsConfiguration";D[37122]="CompressedBitsPerPixel";D[40962]="PixelXDimension";D[40963]="PixelYDimension";D[37500]="MakerNote";D[37510]="UserComment";D[40964]="RelatedSoundFile";D[36867]="DateTimeOriginal";D[36868]="DateTimeDigitized";D[36880]="OffsetTime";D[36881]="OffsetTimeOriginal";D[36882]="OffsetTimeDigitized";D[37520]="SubSecTime";
D[37521]="SubSecTimeOriginal";D[37522]="SubSecTimeDigitized";D[37888]="Temperature";D[37889]="Humidity";D[37890]="Pressure";D[37891]="WaterDepth";D[37892]="Acceleration";D[37893]="CameraElevationAngle";D[42016]="ImageUniqueID";D[42032]="CameraOwnerName";D[42033]="BodySerialNumber";D[42034]="LensSpecification";D[42035]="LensMake";D[42036]="LensModel";D[42037]="LensSerialNumber";D[33434]="ExposureTime";D[33437]="FNumber";D[34850]="ExposureProgram";D[34852]="SpectralSensitivity";D[34855]="PhotographicSensitivity";
D[34856]="OECF";D[34864]="SensitivityType";D[34865]="StandardOutputSensitivity";D[34866]="RecommendedExposureIndex";D[34867]="ISOSpeed";D[34868]="ISOSpeedLatitudeyyy";D[34869]="ISOSpeedLatitudezzz";D[37377]="ShutterSpeedValue";D[37378]="ApertureValue";D[37379]="BrightnessValue";D[37380]="ExposureBiasValue";D[37381]="MaxApertureValue";D[37382]="SubjectDistance";D[37383]="MeteringMode";D[37384]="LightSource";D[37385]="Flash";D[37386]="FocalLength";D[37396]="SubjectArea";D[41483]="FlashEnergy";D[41484]=
"SpatialFrequencyResponse";D[41486]="FocalPlaneXResolution";D[41487]="FocalPlaneYResolution";D[41488]="FocalPlaneResolutionUnit";D[41492]="SubjectLocation";D[41493]="ExposureIndex";D[41495]="SensingMethod";D[41728]="FileSource";D[41729]="SceneType";D[41730]="CFAPattern";D[41985]="CustomRendered";D[41986]="ExposureMode";D[41987]="WhiteBalance";D[41988]="DigitalZoomRatio";D[41989]="FocalLengthIn35mmFilm";D[41990]="SceneCaptureType";D[41991]="GainControl";D[41992]="Contrast";D[41993]="Saturation";D[41994]=
"Sharpness";D[41995]="DeviceSettingDescription";D[41996]="SubjectDistanceRange";return D})(),z=(()=>{const D=[];D[1024]="GTModelTypeGeoKey";D[1025]="GTRasterTypeGeoKey";D[1026]="GTCitationGeoKey";D[2048]="GeographicTypeGeoKey";D[2049]="GeogCitationGeoKey";D[2050]="GeogGeodeticDatumGeoKey";D[2051]="GeogPrimeMeridianGeoKey";D[2052]="GeogLinearUnitsGeoKey";D[2053]="GeogLinearUnitSizeGeoKey";D[2054]="GeogAngularUnitsGeoKey";D[2055]="GeogAngularUnitSizeGeoKey";D[2056]="GeogEllipsoidGeoKey";D[2057]="GeogSemiMajorAxisGeoKey";
D[2058]="GeogSemiMinorAxisGeoKey";D[2059]="GeogInvFlatteningGeoKey";D[2061]="GeogPrimeMeridianLongGeoKey";D[2060]="GeogAzimuthUnitsGeoKey";D[3072]="ProjectedCSTypeGeoKey";D[3073]="PCSCitationGeoKey";D[3074]="ProjectionGeoKey";D[3075]="ProjCoordTransGeoKey";D[3076]="ProjLinearUnitsGeoKey";D[3077]="ProjLinearUnitSizeGeoKey";D[3078]="ProjStdParallel1GeoKey";D[3079]="ProjStdParallel2GeoKey";D[3080]="ProjNatOriginLongGeoKey";D[3081]="ProjNatOriginLatGeoKey";D[3082]="ProjFalseEastingGeoKey";D[3083]="ProjFalseNorthingGeoKey";
D[3084]="ProjFalseOriginLongGeoKey";D[3085]="ProjFalseOriginLatGeoKey";D[3086]="ProjFalseOriginEastingGeoKey";D[3087]="ProjFalseOriginNorthingGeoKey";D[3088]="ProjCenterLongGeoKey";D[3090]="ProjCenterEastingGeoKey";D[3091]="ProjCenterNorthingGeoKey";D[3092]="ProjScaleAtNatOriginGeoKey";D[3093]="ProjScaleAtCenterGeoKey";D[3094]="ProjAzimuthAngleGeoKey";D[3095]="ProjStraightVertPoleLongGeoKey";D[4096]="VerticalCSTypeGeoKey";D[4097]="VerticalCitationGeoKey";D[4098]="VerticalDatumGeoKey";D[4099]="VerticalUnitsGeoKey";
return D})(),N=new Map;N.set("EXIFIFD",w);N.set("GPSIFD","GPSVersionID GPSLatitudeRef GPSLatitude GPSLongitudeRef GPSLongitude GPSAltitudeRef GPSAltitude GPSTimeStamp GPSSatellites GPSStatus GPSMeasureMode GPSDOP GPSSpeedRef GPSSpeed GPSTrackRef GPSTrack GPSImgDirectionRef GPSImgDirection GPSMapDatum GPSDestLatitudeRef GPSDestLatitude GPSDestLongitudeRef GPSDestLongitude GPSDestBearingRef GPSDestBearing GPSDestDistanceRef GPSDestDistance GPSProcessingMethod GPSAreaInformation GPSDateStamp GPSDifferential GPSHPositioningError".split(" "));
return{tiffTags:m,ifdTags:N,geoKeys:z,getTagName:(D,S)=>{S=(S||m)[D];void 0===S&&(S="unknown"+String(D));return S}}})},"esri/layers/support/rasterFormats/utils":function(){define(["exports"],function(m){const w=new ArrayBuffer(4),z=new Uint8Array(w);(new Uint32Array(w))[0]=1;m.isPlatformLittleEndian=1===z[0];Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/clipUtils":function(){define(["require","exports","../../../core/unitUtils","../../../geometry/Extent",
"../PixelBlock"],function(m,w,z,N,D){function S(H,y,u){if(!H)return H;const {width:c,height:e}=H,l=y.width/c,q=y.height/e,{xmin:t,ymax:h}=y;if("extent"===u.type){y=(u.xmin-t)/l;var p=(u.xmax-t)/l,v=(h-u.ymax)/q;u=(h-u.ymin)/q;u=[[[y,v],[y,u],[p,u],[p,v],[y,v]]]}else u=u.rings.map(g=>g.map(([d,b])=>[(d-t)/l,(h-b)/q]));y=document.createElement("canvas");y.width=c;y.height=e;const a=y.getContext("2d");a.fillStyle="#f00";u.forEach(g=>{a.beginPath();a.moveTo(g[0][0],g[0][1]);for(let d=0;d<g.length;d++)a.lineTo(g[d][0],
g[d][1]);a.closePath();a.fill()});u=a.getImageData(0,0,c,e).data;y=H.mask;p=c*e;v=new Uint8Array(p);for(let g=0;g<p;g++)if(!y||y[g])v[g]=127<u[4*g+3]?255:0;return new D({pixelType:H.pixelType,width:c,height:e,mask:v,maskIsAlpha:!1,pixels:[...H.pixels]})}function Q(H,y,u){const {width:c,height:e}=H,l=new Uint8Array(c*e);var q=y.width/c,t=y.height/e;if(.5>u.width/q||.5>u.height/t)return new D({pixelType:H.pixelType,width:c,height:e,mask:l,pixels:[...H.pixels]});const {xmin:h,xmax:p,ymin:v,ymax:a}=y,
{xmin:g,xmax:d,ymin:b,ymax:f}=u;y=Math.max(h,g);var k=Math.min(p,d);u=Math.max(v,b);var r=Math.min(a,f),B=.5*q,A=.5*t;if(k-y<B||r-u<A||k<h+B||y>p-B||u>a-A||r<v+A)return new D({pixelType:H.pixelType,width:c,height:e,mask:l,pixels:[...H.pixels]});y=Math.max(0,(y-h)/q);k=Math.min(c,Math.max(0,(k-h)/q));r=Math.max(0,(a-r)/t);A=Math.min(e,Math.max(0,(a-u)/t));t=Math.round(y);q=Math.round(k)-1;B=Math.round(r);u=Math.round(A)-1;if(t===q&&.5<y%1&&.5>k%1||B===u&&.5<r%1&&.5>A%1)return new D({pixelType:H.pixelType,
width:c,height:e,mask:l,pixels:[...H.pixels]});if(0===t&&0===B&&q===c&&u===e)return H;y=H.mask;for(k=B;k<=u;k++)for(r=t;r<=q;r++)B=k*c+r,l[B]=y?y[B]:255;return new D({pixelType:H.pixelType,width:c,height:e,mask:l,pixels:[...H.pixels]})}function P(H,y,u){const {width:c,height:e}=H,l=new Uint8Array(c*e),q=y.width/c,t=y.height/e,{xmin:h,ymax:p}=y;({paths:y}=u);u=H.mask;for(let b=0;b<y.length;b++){const f=y[b];for(let k=0;k<f.length-1;k++){const [r,B]=f[k],[A,n]=f[k+1];let C=Math.floor((p-B)/t),E=Math.floor((p-
n)/t);if(E<C){var v=C;C=E;E=v}C=Math.max(0,C);E=Math.min(e-1,E);v=(A-r)/(n-B);for(let I=C;I<=E;I++){var a=I===C?Math.max(B,n):(e+1-I)*t,g=I===E?Math.min(B,n):a-t;a=n===B?Math.floor((r-h)/q):Math.floor((v*(a-B)+r-h)/q);g=n===B?Math.floor((A-h)/q):Math.floor((v*(g-B)+r-h)/q);if(g<a){var d=a;a=g;g=d}d=I*c;a=Math.max(0,a);g=Math.min(c-1,g);for(a=d+a;a<=d+g;a++)l[a]=u?u[a]:255}}}return new D({pixelType:H.pixelType,width:c,height:e,mask:l,pixels:[...H.pixels]})}w.clip=async function(H,y,u){if("extent"===
u.type)return Q(H,y,u);const {width:c,height:e}=H,l=new Uint8Array(c*e),{contains:q,intersects:t}=await new Promise((h,p)=>m(["../../../geometry/geometryEngine"],h,p));return t(y,u)?"polyline"===u.type?P(H,y,u):q(u,y)?H:S(H,y,u):new D({pixelType:H.pixelType,width:c,height:e,mask:l,maskIsAlpha:!1,pixels:[...H.pixels]})};w.snapToRaster=function(H,y,u,c=!0){var {spatialReference:e}=H;if(!u.spatialReference.equals(e)){var l=z.getMetersPerUnitForSR(u.spatialReference),q=z.getMetersPerUnitForSR(e);l!==
q&&(l/=q,u={x:u.x*l,y:u.y*l})}const {x:t,y:h}=u;let {xmin:p,xmax:v,ymax:a,ymin:g}="extent"===y.type?y:y.extent;const {xmin:d,ymax:b}=H.extent;c?(p=d+(p>d?t*Math.round((p-d)/t):0),a=b-(a<b?h*Math.round((b-a)/h):0),v=d+(v>d?t*Math.round((v-d)/t):0),g=b-(g<b?h*Math.round((b-g)/h):0),e=new N({xmin:p,ymax:a,xmax:v,ymin:g,spatialReference:e}),H=Math.round(e.width/t),y=Math.round(e.height/h)):(H=Math.floor((v-p)/t+.8),y=Math.floor((a-g)/h+.8),p=d+(p>d?t*Math.floor((p-d)/t+.1):0),a=b-(a<b?h*Math.floor((b-
a)/h+.1):0),e=new N({xmin:p,ymax:a,xmax:p+H*t,ymin:a-y*h,spatialReference:e}));return{extent:e,width:H,height:y}};Object.defineProperty(w,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/rasterFunctionHelper":function(){define("exports ../../../core/colorUtils ../../../core/Error ../../../core/lang ./AspectFunction ./BandArithmeticFunction ./ColormapFunction ./CompositeBandFunction ./ContrastBrightnessFunction ./ConvolutionFunction ./CurvatureFunction ./ExtractBandFunction ./LocalFunction ./MaskFunction ./NDVIFunction ./RemapFunction ./SlopeFunction ./StatisticsFunction ./StatisticsHistogramFunction ./StretchFunction ./TableFunction".split(" "),
function(m,w,z,N,D,S,Q,P,H,y,u,c,e,l,q,t,h,p,v,a,g){function d(x,K){({rasterFunctionArguments:x}=x);x&&(x.rasters||[x.raster]).forEach(J=>{J&&"number"!==typeof J&&("string"===typeof J?J.startsWith("http")&&(K.includes(J)||K.push(J)):"rasterFunctionArguments"in J&&d(J,K))})}function b(x,K){return"rasters"===K[0]&&Array.isArray(x.rasters)?x.rasters:K.map(J=>x[J])}function f(x){return!!(x&&"object"===typeof x&&x.rasterFunction&&x.rasterFunctionArguments)}function k(x){const {rasterFunction:K,rasterFunctionArguments:J}=
x,G={};for(const R in J){let T=J[R];var O=R.toLowerCase();if("rasters"===O&&Array.isArray(T))G.rasters=T.map(X=>f(X)?k(X):X);else switch(f(T)&&(T=k(T)),O){case "dra":G.dra=T;break;case "pspower":G.psPower=T;break;case "pszfactor":G.psZFactor=T;break;case "bandids":G.bandIds=T;break;default:O=R[0].toLowerCase()+R.slice(1),G[O]=T}}"Local"!==K||G.rasters?.length||(G.rasters=["$$"]);return{...x,rasterFunctionArguments:G}}function r(x,K){const {rasterFunction:J,rasterFunctionArguments:G}=x;var O=x.outputPixelType?.toLowerCase();
if(null==J||!F.has(J))throw new z("raster-function-helper",`unsupported raster function: ${J}`);var R=F.get(J);x=("function"===typeof R.ctor?R.ctor:R.ctor["default"]).fromJSON({...x,outputPixelType:O});({rasterArgumentNames:O}=x);R=[];const T=b(G,O),X="rasters"===O[0],L=[];for(let V=0;V<T.length;V++){const W=T[V];let Y;null==W||"string"===typeof W&&W.startsWith("$")?R.push(K?.raster):"string"===typeof W?K[W]&&R.push(K[W]):"number"!==typeof W&&"rasterFunction"in W&&(Y=r(W,K),X||(x.functionArguments[O[V]]=
Y),R.push(Y));X&&L.push(Y??W)}X&&(x.functionArguments.rasters=L);K&&(x.sourceRasters=R,K=K.raster?.url)&&(x.mainPrimaryRasterId=K);return x}function B(x,K){if(x&&K)for(const J in x){const G=x[J];G&&"object"===typeof G&&"type"in G&&("RasterFunctionTemplate"===G.type?B(G.arguments,K):"RasterFunctionVariable"===G.type&&null!=K[G.name]&&(G.value=K[G.name]))}}function A(x,K){if(!x||"object"!==typeof x)return x;const {value:J}=x;if(!J||"object"!==typeof J)return x.isDataset?"$$":J;if(Array.isArray(J))return 0===
J.length?[]:J.map(O=>"object"===typeof O&&"RasterFunctionVariable"===O.type?A(O,K):O);if("value"in J&&["number","string","boolean"].includes(typeof J.value))return J.value;if(x.isDataset&&"Scalar"!==J.type)return"$$";if(!("type"in J))return J;x=J;switch(J.type){case "Scalar":x=J.value;break;case "AlgorithmicColorRamp":x=n(J);break;case "MultiPartColorRamp":x={type:"multipart",colorRamps:J.ArrayOfColorRamp.map(n)};break;case "ArgumentArray":if(J.elements?.length&&"RasterStatistics"!==J.elements[0].type){x=
[];for(let O=0;O<J.elements.length;O++){const R=J.elements[O];var {type:G}=R;if(G)if("RasterFunctionTemplate"===G)({renderingRule:G}=C(R,K)),x.push(G),null!=R._object_id&&K.set(R._object_id,G);else if("RasterFunctionVariable"===G)G=A(R,K),x.push(G),null!=R._object_id&&K.set(R._object_id,G);else throw new z("raster-function-helper","unsupported raster function json.");else x.push(R)}}else x=J.elements}null!=J._object_id&&K.set(J._object_id,x);return x}function n(x){const K=x.algorithm??"esriHSVAlgorithm";
let {FromColor:J,ToColor:G}=x;if(!Array.isArray(J)){const {r:O,g:R,b:T}=w.toRGB({h:J.Hue,s:J.Saturation,v:J.Value});J=[O,R,T,J.AlphaValue]}if(!Array.isArray(G)){const {r:O,g:R,b:T}=w.toRGB({h:G.Hue,s:G.Saturation,v:G.Value});G=[O,R,T,G.AlphaValue]}return{type:"algorithmic",algorithm:K,fromColor:J,toColor:G}}function C(x,K,J){J&&B(x,J);K={renderingRule:{},templates:K};E(x,K);return K}function E(x,K){if(x&&K.renderingRule){var {renderingRule:J,templates:G}=K,{function:O,arguments:R,_object_id:T}=x;
if(O&&R){null!=T&&G.set(T,J);J.rasterFunction=O.type.replace("Function","");J.outputPixelType=O.pixelType;x={};J.rasterFunctionArguments=x;for(const X in R)"type"!==X&&"object_id"!==X&&"_object_ref_id"!==X&&((K=R[X])&&"object"===typeof K&&"type"in K&&("RasterFunctionTemplate"===K.type||"RasterFunctionVariable"===K.type)?("RasterFunctionVariable"===K.type?x[X]=A(K,G):(J.rasterFunctionArguments[X]={},E(K,{renderingRule:J.rasterFunctionArguments[X],templates:G})),null!=K._object_id&&G.set(K._object_id,
x[X])):x[X]=K);x.DEM&&!x.Raster&&(x.Raster=x.DEM,delete x.DEM);switch(J.rasterFunction){case "Stretch":M(x);break;case "Colormap":"randomcolorramp"===x.ColorRamp?.type?.toLowerCase()&&(delete x.ColorRamp,x.ColormapName="Random");0===x.ColorSchemeType&&delete x.ColorRamp;break;case "Convolution":null!=x.ConvolutionType&&(x.Type=x.ConvolutionType,delete x.ConvolutionType);break;case "Mask":U(x)}}}}function I(x){const {renderingRule:K,templates:J}=x;if("object"===typeof K&&K?.rasterFunctionArguments&&
J.size){({rasterFunctionArguments:x}=K);for(const G in x){const O=x[G],R="_object_ref_id"===G?O:O&&"object"===typeof O&&"_object_ref_id"in O?O._object_ref_id:null;if(null!=R){if(!J.has(R))throw new z("raster-function-helper",`unsupported raster function json. _object_ref_id: ${R} does not exist`);const T=J.get(R);"_object_ref_id"!==G?x[G]=T:T&&"object"===typeof T&&Object.assign(x,T)}else O&&"object"===typeof O&&(O.rasterFunctionArguments&&I({renderingRule:O,templates:J}),Array.isArray(O)&&O.forEach((T,
X)=>{if("object"===typeof T)if(null!=T._object_ref_id){if(!J.has(T._object_ref_id))throw new z("raster-function-helper",`unsupported raster function json. _object_ref_id: ${O} does not exist`);const L=J.get(R);L&&"object"===typeof L?Object.assign(T,L):O[X]=L}else I({renderingRule:T,templates:J})}))}}}function M(x){x.Statistics?.length&&"object"===typeof x.Statistics&&(x.Statistics=x.Statistics.map(K=>[K.min,K.max,K.mean,K.standardDeviation]));null!=x.NumberOfStandardDeviation&&(x.NumberOfStandardDeviations=
x.NumberOfStandardDeviation,delete x.NumberOfStandardDeviation)}function U(x){x.NoDataValues?.length&&"string"===typeof x.NoDataValues[0]&&(x.NoDataValues=x.NoDataValues.filter(K=>""!==K).map(K=>Number(K)))}const F=new Map;F.set("Aspect",{desc:"Aspect Function",ctor:D,rasterArgumentNames:["raster"]});F.set("BandArithmetic",{desc:"Band Arithmetic Function",ctor:S,rasterArgumentNames:["raster"]});F.set("Colormap",{desc:"Colormap Function",ctor:Q,rasterArgumentNames:["raster"]});F.set("CompositeBand",
{desc:"CompositeBand Function",ctor:P,rasterArgumentNames:["rasters"]});F.set("Convolution",{desc:"Convolution Function",ctor:y,rasterArgumentNames:["raster"]});F.set("ContrastBrightness",{desc:"Contrast Brightness Function",ctor:H,rasterArgumentNames:["raster"]});F.set("ExtractBand",{desc:"ExtractBand Function",ctor:c,rasterArgumentNames:["raster"]});F.set("Curvature",{desc:"Curvature Function",ctor:u,rasterArgumentNames:["raster"]});F.set("Local",{desc:"Local Function",ctor:e,rasterArgumentNames:["rasters"]});
F.set("Mask",{desc:"Mask Function",ctor:l,rasterArgumentNames:["raster"]});F.set("NDVI",{desc:"NDVI Function",ctor:q,rasterArgumentNames:["raster"]});F.set("Remap",{desc:"Remap Function",ctor:t,rasterArgumentNames:["raster"]});F.set("Slope",{desc:"Slope Function",ctor:h,rasterArgumentNames:["raster"]});F.set("Statistics",{desc:"Focal Statistics Function",ctor:p,rasterArgumentNames:["raster"]});F.set("StatisticsHistogram",{desc:"Statistics Histogram Function",ctor:v,rasterArgumentNames:["raster"]});
F.set("Stretch",{desc:"Stretch Function",ctor:a,rasterArgumentNames:["raster"]});F.set("Table",{desc:"Attribute Table Function",ctor:g,rasterArgumentNames:["raster"]});m.create=function(x,K){K=K??{};x=N.clone(x);if("function"in x&&"arguments"in x&&x.arguments){const J=new Map;x=C(x,J,K);I(x);if(!x.renderingRule)throw new z("raster-function-helper","Unsupported raster function json.");x=x.renderingRule}if("rasterFunction"in x)return x=k(x),r(x,K);throw new z("raster-function-helper","unsupported raster function json.");
};m.getPrimaryRasterUrls=d;m.getRasterValues=b;m.getSupportedFunctions=function(){const x=new Set;F.forEach((K,J)=>x.add(J));return x};m.register=function(x,K,J=["raster"],G=""){F.set(x,{desc:G,ctor:K,rasterArgumentNames:J})};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/AspectFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./AspectFunctionArguments ./BaseRasterFunction ./surfaceUtils".split(" "),
function(m,w,z,N,D,S,Q,P,H){z=class extends P{constructor(){super(...arguments);this.functionName="Aspect";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.isGCS=!1}_bindSourceRasters(){var y=this.sourceRasterInfos[0];this.isGCS=y.spatialReference?.isGeographic??!1;this.outputPixelType=this._getOutputPixelType("f32");y=y.clone();y.pixelType=this.outputPixelType;y.statistics=[{min:-1,max:360,avg:180,stddev:30}];y.histograms=null;y.colormap=null;y.attributeTable=null;y.bandCount=
1;this.rasterInfo=y;return{success:!0,supportsGPU:!0}}_processPixels(y){const u=y.pixelBlocks?.[0];if(null==u)return null;const {extent:c,primaryPixelSizes:e}=y;y=e?.[0];return H.aspect(u,{resolution:null==y?c?{x:c.width/u.width,y:c.height/u.height}:{x:1,y:1}:y})}};m.__decorate([w.property({json:{write:!0,name:"rasterFunction"}})],z.prototype,"functionName",void 0);m.__decorate([w.property({type:Q,json:{write:!0,name:"rasterFunctionArguments"}})],z.prototype,"functionArguments",void 0);m.__decorate([w.property()],
z.prototype,"rasterArgumentNames",void 0);m.__decorate([w.property({json:{write:!0}})],z.prototype,"isGCS",void 0);return z=m.__decorate([S.subclass("esri.layers.support.rasterFunctions.AspectFunction")],z)})},"esri/layers/support/rasterFunctions/AspectFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/Error ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(m,w,z,N,D,S,Q,P){var H;w=H=class extends P{clone(){return new H({raster:this.raster})}};return w=H=m.__decorate([Q.subclass("esri.layers.support.rasterFunctions.AspectFunctionArguments")],w)})},"esri/layers/support/rasterFunctions/BaseFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass".split(" "),
function(m,w,z,N,D,S,Q){w=class extends w.JSONSupport{constructor(){super(...arguments);this.raster=void 0}};m.__decorate([z.property({json:{write:!0}})],w.prototype,"raster",void 0);return w=m.__decorate([Q.subclass("esri.layers.support.rasterFunctions.AspectFunctionArguments")],w)})},"esri/layers/support/rasterFunctions/BaseRasterFunction":function(){define("../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/cast ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../PixelBlock ../RasterInfo".split(" "),
function(m,w,z,N,D,S,Q,P,H){const y=new Set("slope aspect curvature hillshade shadedrelief statistics".split(" "));w=class extends w.JSONSupport{constructor(){super(...arguments);this.functionArguments=null;this.readingBufferSize=0;this.id=-1;this.isNoopProcess=!1;this.rawInputBandIds=[];this.isInputBandIdsSwizzled=!1;this.swizzledBandSelection=[];this.isBranch=!1;this._bindingResult=null}get supportsGPU(){return this._bindingResult.supportsGPU}get flatWebGLFunctionChain(){var u=this.getWebGLProcessorDefinition();
if(!u)return null;const c=[u];({parameters:u}=u);for(u=u.rasters||u.raster&&[u.raster];u?.length;){c.unshift(...u);var e=[];for(var l=0;l<u.length;l++){var {parameters:q}=u[l];q=q.rasters||q.raster&&[q.raster];q?.length&&e.push(...q)}u=e}for(u=c.length-1;0<=u;u--)c[u].isNoopProcess&&c.splice(u,1);u=!1;for(e=0;e<c.length;e++)l=c[e],l.id=c.length-e-1,{rasters:l}=l.parameters,u=u||null!=l&&1<l.length;e=c.some(({name:t})=>y.has(t.toLowerCase()));return{functions:c,hasBranches:u,hasFocalFunction:e}}bind(u,
c=!1,e=-1){this.id=e+1;e=this._getRasterValues();let l=!0;for(let t=0;t<e.length;t++){var q=e[t];if(null!=q&&this._isRasterFunctionValue(q)){q=q.bind(u,c,this.id+t);if(!q.success)return this._bindingResult=q;l=l&&q.supportsGPU}}if(!this.rasterInfo||c)return this.sourceRasterInfos=this._getSourceRasterInfos(u),this._bindingResult=this._bindSourceRasters(),this._bindingResult.success&&this._patchRasterInfo(),this._bindingResult.supportsGPU=l&&this._bindingResult.supportsGPU,this.processInputBandIds(),
this._bindingResult;this._bindingResult={success:!0,supportsGPU:!0};this.processInputBandIds();return this._bindingResult}process(u){var c=this._getRasterValues();c=0===c.length?u.pixelBlocks??u.primaryPixelBlocks:c.map(e=>this._readRasterValue(e,u));return this._processPixels({...u,pixelBlocks:c})}processInputBandIds(){var u=this._getRasterValues().filter(this._isRasterFunctionValue);if(1<u.length)return this.rawInputBandIds=u.map(e=>e.processInputBandIds()[0]),this.isInputBandIdsSwizzled=this.rawInputBandIds.some((e,
l)=>e!==l),u=u.filter(e=>"ExtractBand"===e.functionName),u.length&&u.forEach((e,l)=>{e.isInputBandIdsSwizzled=!0;e.swizzledBandSelection=[l,l,l]}),this.rawInputBandIds;var c=u[0];if(c){if(u=c.processInputBandIds(),c.isInputBandIdsSwizzled)return this.rawInputBandIds=u}else{u=[];({bandCount:c}=this.sourceRasterInfos[0]);for(let e=0;e<c;e++)u.push(e)}u=this._getInputBandIds(u);this.isInputBandIdsSwizzled=u.some((e,l)=>e!==l);return this.rawInputBandIds=u}getPrimaryRasters(){const u=[],c=[];this._getPrimaryRasters(this,
u,c);return{rasters:u,rasterIds:c}}getWebGLProcessorDefinition(){const u=this._getWebGLParameters(),{raster:c,rasters:e}=this.functionArguments;e&&Array.isArray(e)&&e.length?(u.rasters=e.map(l=>this._isRasterFunctionValue(l)?l.getWebGLProcessorDefinition():"number"===typeof l?{name:"Constant",parameters:{value:l},pixelType:"f32",id:-1,isNoopProcess:!1}:{name:"Identity",parameters:{value:l},pixelType:"f32",id:-1,isNoopProcess:!1}),u.rasters.some(l=>null!=l)||(u.rasters=null)):this._isRasterFunctionValue(c)&&
(u.raster=c.getWebGLProcessorDefinition());return{name:this.functionName,parameters:u,pixelType:this.outputPixelType,id:this.id,isNoopProcess:this.isNoopProcess}}_getOutputPixelType(u){return"unknown"===this.outputPixelType?u:this.outputPixelType??u}_getWebGLParameters(){return{}}_getInputBandIds(u){return u}_isOutputRoundingNeeded(){const {outputPixelType:u}=this;return(u?.startsWith("u")||u?.startsWith("s"))??!1}_getRasterValues(){const {rasterArgumentNames:u}=this;return"rasters"===u[0]?this.functionArguments.rasters??
[]:u.flatMap(c=>this.functionArguments[c])}_getSourceRasterInfos(u){const c=this._getRasterValues(),{rasterInfos:e,rasterIds:l}=u;if(0===c.length)return e;const q=c.map(h=>{if(h&&"object"===typeof h&&"bind"in h&&h.rasterInfo)return h.rasterInfo;if("string"===typeof h&&l.includes(h))return e[l.indexOf(h)];if("number"!==typeof h)return e[0]}),t=q.find(h=>h)??e[0];q.forEach((h,p)=>{void 0===h&&(q[p]=t)});return q}_getPrimaryRasterId(u){return u?.url}_getPrimaryRasters(u,c=[],e=[]){for(let q=0;q<u.sourceRasters.length;q++){var l=
u.sourceRasters[q];if("number"!==typeof l)if("bind"in l)this._getPrimaryRasters(l,c,e);else{const t=this._getPrimaryRasterId(l);null==t||e.includes(t)||(this.mainPrimaryRasterId===t?(c.unshift(l),e.unshift(t)):(c.push(l),e.push(t)))}}}_isRasterFunctionValue(u){return null!=u&&"object"===typeof u&&"getWebGLProcessorDefinition"in u}_readRasterValue(u,c){var {primaryPixelBlocks:e}=c;if(null==u||"$$"===u)return u=e[0],null==u?null:u.clone();if("string"===typeof u)return u=c.primaryRasterIds.indexOf(u),
-1===u?null:e[u];if("number"===typeof u){e=e[0];if(null==e)return null;const {width:l,height:q,pixelType:t,mask:h}=e;e=h?new Uint8Array(h):null;c=new Float32Array(l*q);c.fill(u);u=Array(this.sourceRasterInfos[0].bandCount).fill(c);return new P({width:l,height:q,pixelType:t,pixels:u,mask:e})}return u.process(c)}_patchRasterInfo(){const {rasterInfo:u}=this;if(u?.keyProperties){var {bandCount:c,keyProperties:e,statistics:l,histograms:q}=u,t=e.BandProperties;t&&t.length!==c&&(u.keyProperties={...e,BandProperties:void 0});
l&&l.length!==c&&(u.statistics=l.length>c?l.slice(0,c):null);q&&q.length!==c&&(u.histograms=q.length>c?q.slice(0,c):null);e.BAND_COUNT&&Number(e.BAND_COUNT)!==c&&(u.keyProperties={...e,BAND_COUNT:"string"===typeof e.BAND_COUNT?String(c):c})}}};m.__decorate([z.property({json:{write:!0}})],w.prototype,"functionName",void 0);m.__decorate([z.property({json:{write:!0}})],w.prototype,"functionArguments",void 0);m.__decorate([z.property()],w.prototype,"rasterArgumentNames",void 0);m.__decorate([z.property({json:{write:!0}}),
N.cast(u=>u?.toLowerCase())],w.prototype,"outputPixelType",void 0);m.__decorate([z.property({json:{write:!0}})],w.prototype,"mainPrimaryRasterId",void 0);m.__decorate([z.property()],w.prototype,"sourceRasters",void 0);m.__decorate([z.property({type:[H],json:{write:!0}})],w.prototype,"sourceRasterInfos",void 0);m.__decorate([z.property({json:{write:!0}})],w.prototype,"rasterInfo",void 0);m.__decorate([z.property({json:{write:!0}})],w.prototype,"readingBufferSize",void 0);m.__decorate([z.property({json:{write:!0}})],
w.prototype,"id",void 0);m.__decorate([z.property()],w.prototype,"isNoopProcess",void 0);m.__decorate([z.property()],w.prototype,"supportsGPU",null);m.__decorate([z.property()],w.prototype,"rawInputBandIds",void 0);m.__decorate([z.property()],w.prototype,"isInputBandIdsSwizzled",void 0);m.__decorate([z.property()],w.prototype,"swizzledBandSelection",void 0);m.__decorate([z.property()],w.prototype,"isBranch",void 0);m.__decorate([z.property()],w.prototype,"flatWebGLFunctionChain",null);m.__decorate([z.property()],
w.prototype,"_bindingResult",void 0);return w=m.__decorate([Q.subclass("esri.layers.support.rasterFunctions.BaseRasterFunction")],w)})},"esri/layers/support/RasterInfo":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../geometry/Extent ../../geometry/SpatialReference ./RasterBandInfo ./RasterSensorInfo ./RasterStorageInfo".split(" "),
function(m,w,z,N,D,S,Q,P,H,y,u){var c;w=c=class extends w.JSONSupport{constructor(e){super(e);this.extent=this.colormap=this.bandCount=this.attributeTable=null;this.format=void 0;this.histograms=this.width=this.height=null;this.keyProperties={};this.pixelType=this.pixelSize=this.noDataValue=this.multidimensionalInfo=null;this.isPseudoSpatialReference=!1;this.transform=this.storageInfo=this.statistics=this.spatialReference=null}get bandInfos(){var e=this.keyProperties.BandProperties,{bandCount:l}=
this;if(!e?.length||e.length<l){e=[];for(let q=1;q<=l;q++)e.push(new H({name:"band_"+q}));return e}l=e.map(q=>H.fromJSON(q));for(e=0;e<l.length;e++)l[e].name=l[e].name||"band_"+(e+1);return l}get dataType(){const e=this.keyProperties?.DataType?.toLowerCase()??"generic";return"stdtime"===e?"standard-time":e}get nativeExtent(){return this._get("nativeExtent")||this.extent}set nativeExtent(e){e&&this._set("nativeExtent",e)}get nativePixelSize(){if(null==this.transform||!this.transform.affectsPixelSize)return this.pixelSize;
const e=this.nativeExtent;return{x:e.width/this.width,y:e.height/this.height}}get hasMultidimensionalTranspose(){return!!this.storageInfo?.transposeInfo}get sensorInfo(){if(this.keyProperties?.SensorName)return y.fromJSON(this.keyProperties)}clone(){return new c({attributeTable:z.clone(this.attributeTable),bandCount:this.bandCount,colormap:z.clone(this.colormap),extent:z.clone(this.extent),nativePixelSize:z.clone(this.nativePixelSize),format:this.format,height:this.height,width:this.width,histograms:z.clone(this.histograms),
keyProperties:z.clone(this.keyProperties),multidimensionalInfo:z.clone(this.multidimensionalInfo),noDataValue:this.noDataValue,pixelSize:z.clone(this.pixelSize),pixelType:this.pixelType,isPseudoSpatialReference:this.isPseudoSpatialReference,spatialReference:z.clone(this.spatialReference),statistics:z.clone(this.statistics),storageInfo:z.clone(this.storageInfo),transform:z.clone(this.transform)})}};m.__decorate([N.property({json:{write:!0}})],w.prototype,"attributeTable",void 0);m.__decorate([N.property({json:{write:!0}})],
w.prototype,"bandCount",void 0);m.__decorate([N.property({readOnly:!0})],w.prototype,"bandInfos",null);m.__decorate([N.property({json:{write:!0}})],w.prototype,"colormap",void 0);m.__decorate([N.property({type:String,readOnly:!0})],w.prototype,"dataType",null);m.__decorate([N.property({type:Q,json:{write:!0}})],w.prototype,"extent",void 0);m.__decorate([N.property({type:Q,json:{write:!0}})],w.prototype,"nativeExtent",null);m.__decorate([N.property({json:{write:!0}})],w.prototype,"nativePixelSize",
null);m.__decorate([N.property({json:{write:!0}})],w.prototype,"format",void 0);m.__decorate([N.property({json:{write:!0}})],w.prototype,"height",void 0);m.__decorate([N.property({json:{write:!0}})],w.prototype,"width",void 0);m.__decorate([N.property({json:{write:!0}})],w.prototype,"hasMultidimensionalTranspose",null);m.__decorate([N.property({json:{write:!0}})],w.prototype,"histograms",void 0);m.__decorate([N.property({json:{write:!0}})],w.prototype,"keyProperties",void 0);m.__decorate([N.property({json:{write:!0}})],
w.prototype,"multidimensionalInfo",void 0);m.__decorate([N.property({json:{write:!0}})],w.prototype,"noDataValue",void 0);m.__decorate([N.property({json:{write:!0}})],w.prototype,"pixelSize",void 0);m.__decorate([N.property({json:{write:!0}})],w.prototype,"pixelType",void 0);m.__decorate([N.property()],w.prototype,"isPseudoSpatialReference",void 0);m.__decorate([N.property({readOnly:!0})],w.prototype,"sensorInfo",null);m.__decorate([N.property({type:P,json:{write:!0}})],w.prototype,"spatialReference",
void 0);m.__decorate([N.property({json:{write:!0}})],w.prototype,"statistics",void 0);m.__decorate([N.property({type:u,json:{write:!0}})],w.prototype,"storageInfo",void 0);m.__decorate([N.property({json:{write:!0}})],w.prototype,"transform",void 0);return w=c=m.__decorate([S.subclass("esri.layers.support.RasterInfo")],w)})},"esri/layers/support/RasterBandInfo":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(m,w,z,N,D,S,Q){function P(y){y=Number(y);return isNaN(y)?void 0:y}var H;w=H=class extends w.JSONSupport{constructor(){super(...arguments);this.name=null;this.solarIrradiance=this.reflectanceGain=this.reflectanceBias=this.radianceGain=this.radianceBias=this.maxWavelength=this.minWavelength=void 0}clone(){return new H({name:this.name,minWavelength:this.minWavelength,maxWavelength:this.maxWavelength,radianceBias:this.radianceBias,radianceGain:this.radianceGain,reflectanceBias:this.reflectanceBias,
reflectanceGain:this.reflectanceGain,solarIrradiance:this.solarIrradiance})}};m.__decorate([z.property({json:{name:"BandName",write:!0}})],w.prototype,"name",void 0);m.__decorate([z.property({json:{name:"WavelengthMin",read:{reader:P},write:!0}})],w.prototype,"minWavelength",void 0);m.__decorate([z.property({json:{name:"WavelengthMax",read:{reader:P},write:!0}})],w.prototype,"maxWavelength",void 0);m.__decorate([z.property({json:{name:"RadianceBias",read:{reader:P},write:!0}})],w.prototype,"radianceBias",
void 0);m.__decorate([z.property({json:{name:"RadianceGain",read:{reader:P},write:!0}})],w.prototype,"radianceGain",void 0);m.__decorate([z.property({json:{name:"ReflectanceBias",read:{reader:P},write:!0}})],w.prototype,"reflectanceBias",void 0);m.__decorate([z.property({json:{name:"ReflectanceGain",read:{reader:P},write:!0}})],w.prototype,"reflectanceGain",void 0);m.__decorate([z.property({json:{name:"SolarIrradiance",read:{reader:P},write:!0}})],w.prototype,"solarIrradiance",void 0);return w=H=
m.__decorate([Q.subclass("esri.layers.support.RasterBandInfo")],w)})},"esri/layers/support/RasterSensorInfo":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer".split(" "),function(m,w,z,N,D,S,Q,P,H){function y(c){c=Number(c);return isNaN(c)?
void 0:c}var u;w=u=class extends w.JSONSupport{constructor(){super(...arguments);this.productName=this.cloudCover=this.acquisitionDate=void 0;this.sensorName=null;this.sunElevation=this.sunAzimuth=this.sensorElevation=this.sensorAzimuth=void 0}readAcquisitionDate(c){return new Date(c)}writeAcquisitionDate(c,e){e.AcquisitionDate=c.getTime()}clone(){return new u({acquisitionDate:this.acquisitionDate,cloudCover:this.cloudCover,productName:this.productName,sensorName:this.sensorName,sensorAzimuth:this.sensorAzimuth,
sensorElevation:this.sensorElevation,sunAzimuth:this.sunAzimuth,sunElevation:this.sunElevation})}};m.__decorate([z.property({json:{name:"AcquisitionDate",write:!0}})],w.prototype,"acquisitionDate",void 0);m.__decorate([Q.reader("acquisitionDate")],w.prototype,"readAcquisitionDate",null);m.__decorate([H.writer("acquisitionDate")],w.prototype,"writeAcquisitionDate",null);m.__decorate([z.property({json:{name:"CloudCover",read:{reader:y},write:!0}})],w.prototype,"cloudCover",void 0);m.__decorate([z.property({json:{name:"ProductName",
write:!0}})],w.prototype,"productName",void 0);m.__decorate([z.property({json:{name:"SensorName",write:!0}})],w.prototype,"sensorName",void 0);m.__decorate([z.property({json:{name:"SensorAzimuth",read:{reader:y},write:!0}})],w.prototype,"sensorAzimuth",void 0);m.__decorate([z.property({json:{name:"SensorElevation",read:{reader:y},write:!0}})],w.prototype,"sensorElevation",void 0);m.__decorate([z.property({json:{name:"SunAzimuth",read:{reader:y},write:!0}})],w.prototype,"sunAzimuth",void 0);m.__decorate([z.property({json:{name:"SunElevation",
read:{reader:y},write:!0}})],w.prototype,"sunElevation",void 0);return w=u=m.__decorate([P.subclass("esri.layers.support.RasterSensorInfo")],w)})},"esri/layers/support/rasterFunctions/surfaceUtils":function(){define(["exports","../PixelBlock","./pixelUtils"],function(m,w,z){function N(P){let {altitude:H,azimuth:y}=P;const {hillshadeType:u,pixelSizePower:c=1,pixelSizeFactor:e=1,scalingType:l,isGCS:q,resolution:t}=P;var h="multi-directional"===u?2*P.zFactor:P.zFactor;const {x:p,y:v}=t;P=h/(8*p);var a=
h/(8*v);q&&.001<h&&(P/=Q,a/=Q);"adjusted"===l&&(q?(P=p*Q,a=v*Q,P=(h+P**c*e)/(8*P),a=(h+a**c*e)/(8*a)):(P=(h+p**c*e)/(8*p),a=(h+v**c*e)/(8*v)));var g=(90-H)*Math.PI/180;h=Math.cos(g);let d=(360-y+90)*Math.PI/180,b=Math.sin(g)*Math.cos(d);g=Math.sin(g)*Math.sin(d);const f=[315,270,225,360,180,0],k=[60,60,60,60,60,90];var r=new Float32Array([3,5,3,2,1,4]);const B=r.reduce((I,M)=>I+M);r=r.map(I=>I/B);const A="multi-directional"===u?f.length:1,n=new Float32Array(6),C=new Float32Array(6),E=new Float32Array(6);
if("multi-directional"===u)for(let I=0;I<A;I++)H=k[I],y=f[I],g=(90-H)*Math.PI/180,h=Math.cos(g),d=(360-y+90)*Math.PI/180,b=Math.sin(g)*Math.cos(d),g=Math.sin(g)*Math.sin(d),n[I]=h,C[I]=b,E[I]=g;else n.fill(h),C.fill(b),E.fill(g);return{resolution:t,factor:[P,a],sinZcosA:b,sinZsinA:g,cosZ:h,sinZcosAs:C,sinZsinAs:E,cosZs:n,weights:r,hillshadeType:["traditional","multi-directional"].indexOf(u)}}function D(P,H){const {width:y,height:u}=P;var c=y*u;const e=new Uint8Array(c),l=null!=P.mask;let q;if(l){q=
new Uint8Array(P.mask);for(var t=0;t<q.length;t++)q[t]&&(e[t]=1,q[t]=1)}P=P.pixels[0];t=new Float32Array(c);const h=new Float32Array(c);let p=0;if(H){({resolution:v}=H);var v=v?(v.x+v.y)/2:1;p=200*H.zFactor/(v*v);v=new Float32Array(c)}H=H?.curvatureType;let a;let g;for(c=1;c<u-1;c++){const n=c*y;for(let C=1;C<y-1;C++){const E=n+C;if(!q||0!==q[E]){if(q){if(7>q[E-y-1]+q[E-y]+q[E-y+1]+q[E-1]+q[E+1]+q[E+y-1]+q[E+y]+q[E+y+1]){e[E]=0;continue}var d=q[E-y-1]?P[E-y-1]:P[E];var b=q[E-y]?P[E-y]:P[E];var f=
q[E-y+1]?P[E-y+1]:P[E];var k=q[E-1]?P[E-1]:P[E];var r=q[E+1]?P[E+1]:P[E];a=q[E+y-1]?P[E+y-1]:P[E];var B=q[E+y]?P[E+y]:P[E];g=q[E+y+1]?P[E+y+1]:P[E]}else d=P[E-y-1],b=P[E-y],f=P[E-y+1],k=P[E-1],r=P[E+1],a=P[E+y-1],B=P[E+y],g=P[E+y+1];t[E]=f+r+r+g-(d+k+k+a);h[E]=a+B+B+g-(d+b+b+f);if(null!=v){var A=P[E];const I=.5*(k+r)-A;A=.5*(b+B)-A;"standard"===H?v[E]=-p*(I+A):(d=(-d+f+a-g)/4,k=(-k+r)/2,b=(b-B)/2,B=k*k,r=b*b,(f=B+r)&&(v[E]="profile"===H?p*(I*B+A*r+d*k*b)/f:-p*(I*r+A*B-d*k*b)/f))}}}}return{outMask:l?
e:null,dzxs:t,dzys:h,curvatures:v}}function S(P,H,y){for(var u=0;u<y;u++)P[u*H]=P[u*H+1],P[(u+1)*H-1]=P[(u+1)*H-2];for(u=1;u<H-1;u++)P[u]=P[u+H],P[u+(y-1)*H]=P[u+(y-2)*H]}const Q=1/111E3;m.aspect=function(P,H={}){if(!z.isValidPixelBlock(P))return P;var {resolution:y}=H;H=y?1/y.x:1;y=y?1/y.y:1;const {dzxs:u,dzys:c,outMask:e}=D(P),{width:l,height:q}=P,t=new Float32Array(l*q);for(let p=1;p<q-1;p++){const v=p*l;for(let a=1;a<l-1;a++){var h=v+a;if(!e||e[h]){const g=u[h]*H;h=c[h]*y;let d=-1;if(0!==g||0!==
h)d=90-57.29578*Math.atan2(h,-g),0>d&&(d+=360),360===d?d=0:360<d&&(d%=360);t[v+a]=d}}}S(t,l,q);return new w({width:l,height:q,pixels:[t],mask:e,pixelType:"f32",validPixelCount:P.validPixelCount,statistics:[{minValue:-1,maxValue:360}]})};m.calculateHillshadeParams=N;m.curvature=function(P,H){if(!z.isValidPixelBlock(P))return P;const {curvatures:y,outMask:u}=D(P,H),{width:c,height:e}=P;S(y,c,e);P=new w({width:c,height:e,pixels:[y],mask:u,pixelType:"f32",validPixelCount:P.validPixelCount});P.updateStatistics();
return P};m.gcsFactor=Q;m.hillshade=function(P,H){if(!z.isValidPixelBlock(P))return P;const {factor:y,sinZcosA:u,sinZsinA:c,cosZ:e,sinZcosAs:l,sinZsinAs:q,cosZs:t,weights:h}=N(H),[p,v]=y;H="traditional"===H.hillshadeType;const {width:a,height:g}=P,d=new Uint8Array(a*g),{dzxs:b,dzys:f,outMask:k}=D(P);for(let B=1;B<g-1;B++){const A=B*a;for(let n=1;n<a-1;n++){const C=A+n;if(!k||k[C]){var r=b[C]*p;const E=f[C]*v,I=Math.sqrt(1+r*r+E*E);let M=0;if(H)r=255*(e+c*E-u*r)/I,0>r&&(r=0),M=r;else{const U=q.length;
for(let F=0;F<U;F++){let x=255*(t[F]+q[F]*E-l[F]*r)/I;0>x&&(x=0);M+=x*h[F]}}d[C]=M&255}}}S(d,a,g);return new w({width:a,height:g,pixels:[d],mask:k,pixelType:"u8",validPixelCount:P.validPixelCount,statistics:[{minValue:0,maxValue:255}]})};m.slope=function(P,H){if(!z.isValidPixelBlock(P))return P;var y=H.zFactor,u=H.pixelSizePower??1,c=H.pixelSizeFactor??1;const e=H.slopeType;var l=H.isGCS;const {x:q,y:t}=H.resolution;H=y/(8*q);let h=y/(8*t);l&&1E-4>Math.abs(y-1)&&(H/=Q,h/=Q);"adjusted"===e&&(H=(y+
q**u*c)/(8*q),h=(y+t**u*c)/(8*t));const {dzxs:p,dzys:v,outMask:a}=D(P),{width:g,height:d}=P;y=new Float32Array(g*d);for(u=1;u<d-1;u++)for(c=u*g,l=1;l<g-1;l++){var b=c+l;if(!a||a[b]){var f=p[b]*H;b=v[b]*h;f=Math.sqrt(f*f+b*b);y[c+l]="percent-rise"===e?100*f:57.2957795*Math.atan(f)}}S(y,g,d);P=new w({width:g,height:d,pixels:[y],mask:a,pixelType:"f32",validPixelCount:P.validPixelCount});P.updateStatistics();return P};m.tintHillshade=function(P,H,y,u){if(z.isValidPixelBlock(P)&&z.isValidPixelBlock(H)){var {min:c,
max:e}=u;u=P.pixels[0];var {pixels:l,mask:q}=H;H=l[0];var t=255.00001/(e-c),h=new Uint8ClampedArray(H.length),p=new Uint8ClampedArray(H.length),v=new Uint8ClampedArray(H.length),a=y.length-1;for(let b=0;b<H.length;b++){if(q&&0===q[b])continue;var g=Math.floor((H[b]-c)*t);const [f,k]=y[0>g?0:g>a?a:g];var d=u[b];g=d*k;const r=g*(1-Math.abs(f%2-1));d-=g;switch(Math.floor(f)){case 0:h[b]=g+d;p[b]=r+d;v[b]=d;break;case 1:h[b]=r+d;p[b]=g+d;v[b]=d;break;case 2:h[b]=d;p[b]=g+d;v[b]=r+d;break;case 3:h[b]=
d;p[b]=r+d;v[b]=g+d;break;case 4:h[b]=r+d;p[b]=d;v[b]=g+d;break;case 5:case 6:h[b]=g+d,p[b]=d,v[b]=r+d}}P.pixels=[h,p,v];P.updateStatistics()}};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/BandArithmeticFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BandArithmeticFunctionArguments ./bandIndexUtils ./BaseRasterFunction".split(" "),
function(m,w,z,N,D,S,Q,P,H){const y=new Set(["vari","mtvi2","rtvi-core","evi"]);z=class extends H{constructor(){super(...arguments);this.functionName="BandArithmetic";this.functionArguments=null;this.rasterArgumentNames=["raster"]}_bindSourceRasters(){this.outputPixelType=this._getOutputPixelType("f32");var u=this.sourceRasterInfos[0];if(2>u.bandCount)return{success:!1,supportsGPU:!1,error:"band-arithmetic-function: source raster has insufficient amount of raster bands"};u=u.clone();u.pixelType=this.outputPixelType;
u.statistics=null;u.histograms=null;u.bandCount="sultan"===this.functionArguments.method?3:1;u.keyProperties={...u.keyProperties,BandProperties:void 0};this.rasterInfo=u;return{success:!0,supportsGPU:!["custom","gvitm","sultan"].includes(this.functionArguments.method)}}_processPixels(u){u=u.pixelBlocks?.[0];if(null==u)return u;const {method:c,bandIndexes:e}=this.functionArguments,l=e.split(" ").map(q=>parseFloat(q));return P.calculateBandIndex(u,{method:c,bandIndexes:l,equation:e})}_getWebGLParameters(){const u=
this.functionArguments.bandIndexes.split(" ").map(q=>parseFloat(q)-1);2===u.length&&u.push(0);var c=this.isInputBandIdsSwizzled?[0,1,2]:u;const e=new Float32Array(3);({method:l}=this.functionArguments);switch(l){case "gndvi":case "nbr":case "ndbi":case "ndvi":case "ndvi-re":case "ndsi":case "ndmi":case "mndwi":c=P.getBandMatrix3([c[0],c[1],0]);var l="ndxi";break;case "ndwi":c=P.getBandMatrix3([c[1],c[0],0]);l="ndxi";break;case "sr":case "sr-re":case "iron-oxide":case "ferrous-minerals":case "clay-minerals":c=
P.getBandMatrix3([c[0],c[1],0]);l="sr";break;case "ci-g":case "ci-re":c=P.getBandMatrix3([c[0],c[1],0]);l="ci";break;case "savi":c=P.getBandMatrix3([c[0],c[1],0]);l="savi";e[0]=u[2]+1;break;case "tsavi":c=P.getBandMatrix3([c[0],c[1],0]);l="tsavi";e[0]=u[2]+1;e[1]=u[3]+1;e[2]=u[4]+1;break;case "msavi":c=P.getBandMatrix3([c[0],c[1],0]);l="msavi";break;case "gemi":c=P.getBandMatrix3([c[0],c[1],0]);l="gemi";break;case "pvi":c=P.getBandMatrix3([c[0],c[1],0]);l="tsavi";e[0]=u[2]+1;e[1]=u[3]+1;break;case "vari":c=
P.getBandMatrix3([c[0],c[1],c[2]]);l="vari";break;case "mtvi2":c=P.getBandMatrix3([c[0],c[1],c[2]]);l="mtvi2";break;case "rtvi-core":c=P.getBandMatrix3([c[0],c[1],c[2]]);l="rtvicore";break;case "evi":c=P.getBandMatrix3([c[0],c[1],c[2]]);l="evi";break;case "wndwi":c=P.getBandMatrix3([c[0],c[1],0]);l="wndwi";e[0]=u[3]?u[3]+1:.5;break;case "bai":c=P.getBandMatrix3([c[1],c[0],0]);l="bai";break;default:c=P.getBandMatrix3([0,1,2]),l="custom"}return{bandIndexMat3:c,indexType:l,adjustments:e}}_getInputBandIds(u){if("custom"===
this.functionArguments.method)return u;var c=this.functionArguments.bandIndexes.split(" ").map(q=>parseFloat(q)-1);const e=u.length;c=c.map(q=>q>=e?e-1:q);const l=y.has(this.functionArguments.method)?3:2;c=c.slice(0,l).map(q=>u[q]);2===c.length&&c.push(0);return c}};m.__decorate([w.property({json:{write:!0,name:"rasterFunction"}})],z.prototype,"functionName",void 0);m.__decorate([w.property({type:Q,json:{write:!0,name:"rasterFunctionArguments"}})],z.prototype,"functionArguments",void 0);m.__decorate([w.property()],
z.prototype,"rasterArgumentNames",void 0);return z=m.__decorate([S.subclass("esri.layers.support.rasterFunctions.BandArithmeticFunction")],z)})},"esri/layers/support/rasterFunctions/BandArithmeticFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./bandIndexUtils ./BaseFunctionArguments".split(" "),
function(m,w,z,N,D,S,Q,P){var H;N=H=class extends P{constructor(){super(...arguments);this.method="custom"}clone(){return new H({method:this.method,bandIndexes:this.bandIndexes,raster:w.clone(this.raster)})}};m.__decorate([z.property({json:{type:String,write:!0}})],N.prototype,"bandIndexes",void 0);m.__decorate([D.enumeration(Q.bandIndexMethodMap)],N.prototype,"method",void 0);return N=H=m.__decorate([S.subclass("esri.layers.support.rasterFunctions.BandArithmeticFunctionArguments")],N)})},"esri/layers/support/rasterFunctions/bandIndexUtils":function(){define(["exports",
"../../../core/jsonMap","../PixelBlock","./customBandIndexUtils","./pixelUtils"],function(m,w,z,N,D){function S(d,b,f){const k=f.length,r=new Float32Array(k);for(let B=0;B<k;B++)if(null==d||d[B]){const A=b[B],n=f[B],C=A+n;C&&(r[B]=(A-n)/C)}return[r]}function Q(d,b,f){const k=f.length,r=new Float32Array(k);for(let B=0;B<k;B++)if(null==d||d[B]){const A=b[B],n=f[B];n&&(r[B]=A/n)}return[r]}function P(d,b,f){const k=b.length,r=new Float32Array(k);for(let B=0;B<k;B++)if(null==d||d[B]){const A=b[B],n=f[B];
n&&(r[B]=A/n-1)}return[r]}function H(d,b,f,k){const r=f.length,B=new Float32Array(r);for(let A=0;A<r;A++)if(null==d||d[A]){const n=f[A],C=b[A],E=C+n+k;E&&(B[A]=(C-n)/E*(1+k))}return[B]}function y(d,b,f,k,r,B){const A=f.length,n=new Float32Array(A);B=-r*k+B*(1+k*k);for(let C=0;C<A;C++)if(null==d||d[C]){const E=f[C],I=b[C],M=r*I+E+B;M&&(n[C]=k*(I-k*E-r)/M)}return[n]}function u(d,b,f){const k=f.length,r=new Float32Array(k);for(let B=0;B<k;B++)if(null==d||d[B]){const A=b[B];r[B]=.5*(2*(A+1)-Math.sqrt((2*
A+1)**2-8*(A-f[B])))}return[r]}function c(d,b,f){const k=f.length,r=new Float32Array(k);for(let A=0;A<k;A++)if(null==d||d[A]){const n=f[A];var B=b[A];1!==n&&(B=(2*(B*B-n*n)+1.5*B+.5*n)/(B+n+.5),r[A]=B*(1-.25*B)-(n-.125)/(1-n))}return[r]}function e(d,b,f,k,r){const B=f.length,A=new Float32Array(B),n=Math.sqrt(1+k*k);for(let C=0;C<B;C++)if(null==d||d[C])A[C]=(b[C]-k*f[C]-r)/n;return[A]}function l(d,b){const [f,k,r,B,A,n]=b;b=f.length;const C=new Float32Array(b);for(let E=0;E<b;E++)if(null==d||d[E])C[E]=
-.2848*f[E]-.2435*k[E]-.5436*r[E]+.7243*B[E]+.084*A[E]-1.18*n[E];return[C]}function q(d,b){const [f,,k,r,B,A]=b;b=f.length;const n=new Float32Array(b),C=new Float32Array(b),E=new Float32Array(b);for(let I=0;I<b;I++)if(null==d||d[I])n[I]=A[I]?B[I]/A[I]*100:0,C[I]=f[I]?B[I]/f[I]*100:0,E[I]=r[I]?k[I]/r[I]*(B[I]/r[I])*100:0;return[n,C,E]}function t(d,b){const [f,k,r]=b;b=f.length;const B=new Float32Array(b);for(let A=0;A<b;A++)if(null==d||d[A])for(A=0;A<b;A++){const n=f[A],C=k[A],E=C+n-r[A];E&&(B[A]=
(C-n)/E)}return[B]}function h(d,b){const [f,k,r]=b;b=f.length;const B=new Float32Array(b);for(let A=0;A<b;A++)if(null==d||d[A])for(A=0;A<b;A++){const n=f[A],C=k[A],E=r[A];B[A]=1.5*(1.2*(n-E)-2.5*(C-E))*Math.sqrt((2*n+1)**2-6*n-5*Math.sqrt(C)-.5)}return[B]}function p(d,b){const [f,k,r]=b;b=f.length;const B=new Float32Array(b);for(let A=0;A<b;A++)if(null==d||d[A])for(A=0;A<b;A++){const n=f[A];B[A]=100*(n-k[A])-10*(n-r[A])}return[B]}function v(d,b){const [f,k,r]=b;b=f.length;const B=new Float32Array(b);
for(let A=0;A<b;A++)if(null==d||d[A])for(A=0;A<b;A++){const n=f[A],C=k[A],E=n+6*C-7.5*r[A]+1;E&&(B[A]=2.5*(n-C)/E)}return[B]}function a(d,b,f=.5){const [k,r,B]=b;b=r.length;const A=new Float32Array(b);for(let n=0;n<b;n++)if(null==d||d[n])for(n=0;n<b;n++){const C=k[n],E=r[n],I=B[n],M=C+f*E+(1-f)*I;M&&(A[n]=(C-f*E-(1-f)*I)/M)}return[A]}function g(d,b,f){const k=f.length,r=new Float32Array(k);for(let B=0;B<k;B++)if(null==d||d[B])for(B=0;B<k;B++){const A=(.1-b[B])**2+(.06-f[B])**2;A&&(r[B]=1/A)}return[r]}
w=new w.JSONMap({0:"custom",1:"ndvi",2:"savi",3:"tsavi",4:"msavi",5:"gemi",6:"pvi",7:"gvitm",8:"sultan",9:"vari",10:"gndvi",11:"sr",12:"ndvi-re",13:"sr-re",14:"mtvi2",15:"rtvi-core",16:"ci-re",17:"ci-g",18:"ndwi",19:"evi",20:"iron-oxide",21:"ferrous-minerals",22:"clay-minerals",23:"wndwi",24:"bai",25:"nbr",26:"ndbi",27:"ndmi",28:"ndsi",29:"mndwi"},{useNumericKeys:!0});m.bandIndexMethodMap=w;m.calculateBandIndex=function(d,b){if(!D.isValidPixelBlock(d))return d;const {equation:f,method:k}=b;b=b.bandIndexes.map(n=>
n-1);const {pixels:r,mask:B}=d;switch(k){case "gndvi":case "nbr":case "ndbi":case "ndvi":case "ndvi-re":case "ndsi":case "ndmi":case "mndwi":b=S(B,r[b[0]],r[b[1]]);break;case "ndwi":b=S(B,r[b[1]],r[b[0]]);break;case "sr":case "sr-re":case "iron-oxide":case "ferrous-minerals":case "clay-minerals":b=Q(B,r[b[0]],r[b[1]]);break;case "ci-g":case "ci-re":b=P(B,r[b[0]],r[b[1]]);break;case "savi":b=H(B,r[b[0]],r[b[1]],b[2]+1);break;case "tsavi":b=y(B,r[b[0]],r[b[1]],b[2]+1,b[3]+1,b[4]+1);break;case "msavi":b=
u(B,r[b[0]],r[b[1]]);break;case "gemi":b=c(B,r[b[0]],r[b[1]]);break;case "pvi":b=e(B,r[b[0]],r[b[1]],b[2]+1,b[3]+1);break;case "gvitm":b=l(B,[r[b[0]],r[b[1]],r[b[2]],r[b[3]],r[b[4]],r[b[5]]]);break;case "sultan":b=q(B,[r[b[0]],r[b[1]],r[b[2]],r[b[3]],r[b[4]],r[b[5]]]);break;case "vari":b=t(B,[r[b[0]],r[b[1]],r[b[2]]]);break;case "mtvi2":b=h(B,[r[b[0]],r[b[1]],r[b[2]]]);break;case "rtvi-core":b=p(B,[r[b[0]],r[b[1]],r[b[2]]]);break;case "evi":b=v(B,[r[b[0]],r[b[1]],r[b[2]]]);break;case "wndwi":b=a(B,
[r[b[0]],r[b[1]],r[b[2]]],b[3]?b[3]+1:.5);break;case "bai":b=g(B,r[b[0]],r[b[1]]);break;case "custom":b=N.calculateCustomBandIndex(B,r,f);break;default:return d}const A=null!=B?new Uint8Array(B.length):null;null!=B&&null!=A&&A.set(B);d=new z({width:d.width,height:d.height,pixelType:"f32",pixels:b,mask:A});d.updateStatistics();return d};m.calculateNDVI=function(d,b,f,k){const {mask:r,pixels:B,width:A,height:n}=d;d=B[f];b=B[b];f=b.length;const C=k?new Uint8Array(f):new Float32Array(f),E=k?100:1,I=k?
100.5:0;for(let M=0;M<f;M++)if(null==r||r[M]){const U=d[M],F=b[M],x=U+F;x&&(C[M]=(U-F)/x*E+I)}k=new z({width:A,height:n,mask:r,pixelType:k?"u8":"f32",pixels:[C]});k.updateStatistics();return k};m.getBandMatrix3=function(d){const b=new Float32Array(9);b[3*d[0]]=1;b[3*d[1]+1]=1;b[3*d[2]+2]=1;return b};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/customBandIndexUtils":function(){define(["exports","../../../core/has"],function(m,w){const z=new Set("+-*/()".split(""));
m.calculateCustomBandIndex=function(N,D,S){S=S.replaceAll(" ","");S.startsWith("-")&&(S="0"+S);S.startsWith("+")&&(S=S.slice(1,S.length));S=S.split("");var Q=[],P=[],H="";for(var y=0;y<S.length;y++){const l=S[y];z.has(l)?(""!==H&&P.push(parseFloat(H)),Q.push(l),H=""):"b"===l.toLowerCase()?(y++,H=l.concat(S[y]),P.push(D[parseInt(H[1],10)-1]),H=""):(H=H.concat(l),y===S.length-1&&P.push(parseFloat(H)))}let {ops:u,nums:c}={ops:Q,nums:P};if(0===u.length){N=1===c.length?c[0]:D[0];if(N instanceof Float32Array)return[N];
var e=new Float32Array(D[0].length);"number"===typeof N?e.fill(N):e.set(N);return[e]}for(;0<u.length;){e=u;if(1===e.length)e={opIndex:0,numIndex:0};else{Q=S=0;for(D=0;D<e.length;D++)if("("===e[D])S=D;else if(")"===e[D]){Q=D;break}P=0===Q?e:e.slice(S+1,Q);D=-1;for(H=0;H<P.length;H++)if("*"===P[H]||"/"===P[H]){D=H;break}if(!(-1<D))for(H=0;H<P.length;H++)if("+"===P[H]||"-"===P[H]){D=H;break}0<Q&&(D+=S+1);S=0;for(Q=0;Q<D;Q++)"("===e[Q]&&S++;e={opIndex:D,numIndex:D-S}}const {numIndex:l,opIndex:q}=e;Q=
S=D=void 0;e=N;H=u[q];P=c[l];y=c[l+1];if("number"===typeof P&&"number"===typeof y)e=P+y;else{"number"===typeof P?(D=y,Q=D.length,S=new Float32Array(Q),S.fill(P)):(Q=P.length,S=P,y.constructor===Number?(D=new Float32Array(Q),D.fill(y)):D=y);P=new Float32Array(Q);switch(H){case "+":for(H=0;H<Q;H++)if(null==e||e[H])P[H]=S[H]+D[H];break;case "-":for(H=0;H<Q;H++)if(null==e||e[H])P[H]=S[H]-D[H];break;case "*":for(H=0;H<Q;H++)if(null==e||e[H])P[H]=S[H]*D[H];break;case "/":for(H=0;H<Q;H++)(null==e||e[H])&&
D[H]&&(P[H]=S[H]/D[H]);break;case "(":case ")":throw Error("encountered error with custom band index equation");}e=P}if(1===u.length)break;else{D=u;D.splice(q,1);Q=S=0;do{Q=S=0;for(P=0;P<D.length;P++)if("("===D[P])S=P;else if(")"===D[P]){Q=P;break}Q===S+1&&D.splice(S,2)}while(Q===S+1);u=D;c.splice(l,2,e)}}return[e]};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/ColormapFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./ColormapFunctionArguments ./colormaps ../../../renderers/support/colorRampUtils".split(" "),
function(m,w,z,N,D,S,Q,P,H,y){z=class extends Q{constructor(){super(...arguments);this.functionName="Colormap";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.isNoopProcess=!0}_bindSourceRasters(){var u=this.sourceRasterInfos[0];if(1<u.bandCount)return{success:!1,supportsGPU:!1,error:"colormap-function: source data must be single band"};let {colormap:c,colormapName:e,colorRamp:l,colorRampName:q}=this.functionArguments;if(!c?.length)if(l)c=y.convertColorRampToColormap(l,{interpolateAlpha:!0});
else if(q){const t=y.getColorRampJSON(q);t&&(c=y.convertColorRampToColormap(t))}else e&&(c=H.getColormapByName(e));if(!c?.length)return{success:!1,supportsGPU:!1,error:"colormap-function: missing colormap argument"};this.outputPixelType=this._getOutputPixelType("u8");u=u.clone();u.pixelType=this.outputPixelType;u.colormap=c;u.bandCount=1;this.rasterInfo=u;return{success:!0,supportsGPU:!0}}_processPixels(u){return u.pixelBlocks?.[0]}};m.__decorate([w.property({json:{write:!0,name:"rasterFunction"}})],
z.prototype,"functionName",void 0);m.__decorate([w.property({type:P,json:{write:!0,name:"rasterFunctionArguments"}})],z.prototype,"functionArguments",void 0);m.__decorate([w.property()],z.prototype,"rasterArgumentNames",void 0);m.__decorate([w.property()],z.prototype,"isNoopProcess",void 0);m.__decorate([w.property({json:{write:!0}})],z.prototype,"indexedColormap",void 0);return z=m.__decorate([S.subclass("esri.layers.support.rasterFunctions.ColormapFunction")],z)})},"esri/layers/support/rasterFunctions/ColormapFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/cast ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments ../../../renderers/support/colorRampUtils ../../../rest/support/colorRamps".split(" "),
function(m,w,z,N,D,S,Q,P,H){var y;Q=y=class extends Q{castColormapName(u){if(!u)return null;u=u.toLowerCase();return P.rasterColormapNames.includes(u)?u:null}readColorRamp(u){return H.fromJSON(u)}readColorRampName(u,c){return u?(c=P.colorRampDict.jsonValues.find(e=>e.toLowerCase()===u.toLowerCase()))?P.colorRampDict.fromJSON(c):null:null}clone(){return new y({colormap:w.clone(this.colormap),colormapName:this.colormapName,colorRamp:this.colorRamp?.clone(),colorRampName:this.colorRampName})}};m.__decorate([z.property({type:[[Number]],
json:{write:!0}})],Q.prototype,"colormap",void 0);m.__decorate([z.property({type:String,json:{write:!0}})],Q.prototype,"colormapName",void 0);m.__decorate([N.cast("colormapName")],Q.prototype,"castColormapName",null);m.__decorate([z.property({types:H.types,json:{write:!0}})],Q.prototype,"colorRamp",void 0);m.__decorate([D.reader("colorRamp")],Q.prototype,"readColorRamp",null);m.__decorate([z.property({type:P.colorRampDict.apiValues,json:{type:P.colorRampDict.jsonValues,write:P.colorRampDict.write}})],
Q.prototype,"colorRampName",void 0);m.__decorate([D.reader("colorRampName")],Q.prototype,"readColorRampName",null);return Q=y=m.__decorate([S.subclass("esri.layers.support.rasterFunctions.ColormapFunctionArguments")],Q)})},"esri/layers/support/rasterFunctions/colormaps":function(){define(["exports","../../../renderers/support/colorRampUtils"],function(m,w){function z(P,H){const y=[],u=[];for(let c=0;c<P.length-1;c++)y.push({type:"algorithmic",algorithm:"esriHSVAlgorithm",fromColor:P[c].slice(1),toColor:P[c+
1].slice(1)}),u.push(P[c+1][0]-P[c][0]);P=P[P.length-1][0];H=H??u;return w.convertColorRampToColors({type:"multipart",colorRamps:y},{numColors:P,weights:H})}function N(){const P=z([[0,255,255,255],[70,0,255,0],[80,205,173,193],[100,150,150,150],[110,120,51,100],[130,120,100,200],[140,28,3,144],[160,6,0,55],[180,10,25,30],[201,6,7,27]]);for(let H=P.length;256>H;H++)P.push([6,27,7]);return P}function D(){const P=[];for(let H=0;256>H;H++){const y=[];for(let u=0;3>u;u++)y.push(Math.round(255*Math.random()));
P.push(y)}return P}const S=[[36,0,255],[36,0,255],[36,0,255],[36,0,255],[112,75,3],[113,76,3],[114,77,3],[115,77,3],[116,78,3],[117,79,3],[118,79,3],[119,80,3],[121,81,4],[122,82,4],[123,82,4],[124,83,4],[125,84,4],[126,84,4],[127,85,4],[128,86,4],[129,86,4],[130,87,4],[131,88,4],[132,89,4],[133,89,4],[134,90,4],[135,91,4],[136,91,4],[137,92,4],[138,93,4],[139,94,4],[140,94,4],[142,95,5],[143,96,5],[144,96,5],[145,97,5],[146,98,5],[147,99,5],[148,99,5],[149,100,5],[150,101,5],[151,101,5],[152,102,
5],[153,103,5],[154,104,5],[155,104,5],[156,105,5],[157,106,5],[158,106,5],[159,107,5],[160,108,5],[161,108,5],[162,109,5],[164,110,6],[165,111,6],[166,111,6],[167,112,6],[168,113,6],[169,113,6],[170,114,6],[171,115,6],[172,116,6],[173,116,6],[174,117,6],[245,0,0],[245,5,0],[245,10,0],[246,15,0],[246,20,0],[246,25,0],[246,30,0],[247,35,0],[247,40,0],[247,45,0],[247,50,0],[247,55,0],[248,60,0],[248,65,0],[248,70,0],[248,75,0],[249,81,0],[249,86,0],[249,91,0],[249,96,0],[250,101,0],[250,106,0],[250,
111,0],[250,116,0],[250,121,0],[251,126,0],[251,131,0],[251,136,0],[251,141,0],[252,146,0],[252,151,0],[252,156,0],[252,156,0],[251,159,0],[250,162,0],[249,165,0],[248,168,0],[247,171,0],[246,174,0],[245,177,0],[245,179,0],[244,182,0],[243,185,0],[242,188,0],[241,191,0],[240,194,0],[239,197,0],[238,200,0],[237,203,0],[236,206,0],[235,209,0],[234,212,0],[233,215,0],[232,218,0],[231,221,0],[230,224,0],[230,226,0],[229,229,0],[228,232,0],[227,235,0],[226,238,0],[225,241,0],[224,244,0],[223,247,0],[165,
247,0],[163,244,0],[161,240,0],[158,237,0],[156,233,1],[154,230,1],[152,227,1],[149,223,1],[147,220,1],[145,216,1],[143,213,1],[140,210,2],[138,206,2],[136,203,2],[134,200,2],[132,196,2],[129,193,2],[127,189,2],[125,186,3],[123,183,3],[120,179,3],[118,176,3],[116,172,3],[114,169,3],[111,166,3],[109,162,4],[107,159,4],[105,155,4],[103,152,4],[100,149,4],[98,145,4],[96,142,4],[94,138,5],[91,135,5],[89,132,5],[87,128,5],[85,125,5],[82,121,5],[80,118,5],[78,115,6],[76,111,6],[73,108,6],[71,105,6],[69,
101,6],[67,98,6],[65,94,6],[62,91,7],[60,88,7],[58,84,7],[56,81,7],[53,77,7],[51,74,7],[49,71,7],[47,67,8],[44,64,8],[42,60,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,
57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8]],Q=[[36,0,255],[36,0,255],[36,0,255],[36,0,255],[245,20,0],[245,24,0],[245,29,0],[245,31,0],[247,33,0],[247,33,0],[247,37,0],[247,41,0],[247,41,0],[247,41,
0],[247,45,0],[247,45,0],[247,47,0],[247,49,0],[247,49,0],[247,54,0],[247,54,0],[247,56,0],[247,58,0],[247,58,0],[250,62,0],[250,62,0],[250,62,0],[250,67,0],[250,67,0],[250,67,0],[250,69,0],[250,71,0],[250,71,0],[250,75,0],[250,75,0],[250,78,0],[250,79,0],[250,79,0],[250,79,0],[250,81,0],[250,83,0],[250,83,0],[250,87,0],[250,87,0],[250,90,0],[250,92,0],[252,93,0],[252,93,0],[252,97,0],[252,97,0],[252,97,0],[252,97,0],[252,101,0],[252,101,0],[252,101,0],[252,101,0],[252,105,0],[252,105,0],[252,107,
0],[252,109,0],[252,109,0],[252,113,13],[255,118,20],[255,119,23],[255,121,25],[255,126,33],[255,132,38],[255,133,40],[255,135,43],[255,141,48],[255,144,54],[255,150,59],[255,152,61],[255,153,64],[255,159,69],[255,163,77],[255,165,79],[255,168,82],[255,174,87],[255,176,92],[255,181,97],[255,183,99],[255,186,102],[255,191,107],[255,197,115],[255,201,120],[255,203,123],[255,205,125],[255,209,130],[255,214,138],[255,216,141],[255,218,143],[255,224,150],[255,228,156],[255,234,163],[255,236,165],[255,
238,168],[255,243,173],[255,248,181],[255,252,186],[253,252,186],[250,252,187],[244,250,180],[238,247,176],[234,246,173],[231,245,169],[223,240,163],[217,237,157],[211,235,150],[205,233,146],[200,230,142],[195,227,136],[189,224,132],[184,222,126],[180,220,123],[174,217,119],[169,214,114],[163,212,108],[160,210,105],[154,207,101],[148,204,96],[143,201,93],[138,199,88],[134,197,84],[130,194,81],[126,191,77],[117,189,70],[115,186,68],[112,184,64],[106,181,60],[100,179,55],[94,176,49],[92,174,47],[90,
173,45],[81,168,37],[75,166,33],[71,163,28],[66,160,24],[62,158,21],[56,156,14],[51,153,0],[51,153,0],[51,153,0],[50,150,0],[50,150,0],[50,150,0],[50,150,0],[49,148,0],[49,148,0],[49,148,0],[48,145,0],[48,145,0],[48,145,0],[48,145,0],[48,143,0],[48,143,0],[48,143,0],[48,143,0],[47,140,0],[47,140,0],[47,140,0],[47,140,0],[46,138,0],[46,138,0],[46,138,0],[46,138,0],[45,135,0],[45,135,0],[45,135,0],[45,135,0],[44,133,0],[44,133,0],[44,133,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[43,
130,0],[42,128,0],[42,128,0],[42,128,0],[42,125,0],[42,125,0],[42,125,0],[42,125,0],[41,122,0],[41,122,0],[41,122,0],[41,122,0],[40,120,0],[40,120,0],[40,120,0],[40,120,0],[40,120,0],[39,117,0],[39,117,0],[39,117,0],[39,117,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],
[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0]];m.getColormapByName=function(P){let H;switch(P){case "elevation":H=z([[0,0,191,191],[51,0,0,255],[102,255,0,255],[153,255,0,127],[204,191,63,127],[256,
20,20,20]]);break;case "gray":H=w.convertColorRampToColors({type:"algorithmic",algorithm:"esriHSVAlgorithm",fromColor:[0,0,0],toColor:[255,255,255]});break;case "hillshade":H=z([[0,38,41,54],[69,79,82,90],[131,156,156,156],[256,253,253,241]],[.268,.238,.495]);break;case "ndvi":H=S;break;case "ndvi2":H=N();break;case "ndvi3":H=Q;break;case "random":H=D()}return H?H=H.map((y,u)=>[u,...y]):null};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/CompositeBandFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./CompositeBandFunctionArguments ./pixelUtils".split(" "),
function(m,w,z,N,D,S,Q,P,H){z=class extends Q{constructor(){super(...arguments);this.functionName="CompositeBand";this.functionArguments=null;this.rasterArgumentNames=["rasters"]}_bindSourceRasters(){var {sourceRasterInfos:y}=this,u=y[0];this.outputPixelType=this._getOutputPixelType(u.pixelType);u=u.clone();u.attributeTable=null;u.colormap=null;u.pixelType=this.outputPixelType;u.bandCount=y.map(({bandCount:c})=>c).reduce((c,e)=>c+e);if(y.every(({statistics:c})=>null!=c&&c.length)){const c=[];y.forEach(({statistics:e})=>
null!=e&&c.push(...e));u.statistics=c}if(y.every(({histograms:c})=>null!=c&&c.length)){const c=[];y.forEach(({histograms:e})=>null!=e&&c.push(...e));u.histograms=c}1<u.bandCount&&(u.colormap=null,u.attributeTable=null);y=y.every(c=>c.keyProperties.BandProperties?.length)?y.flatMap(c=>c.keyProperties.BandProperties):void 0;u.keyProperties={...u.keyProperties,BandProperties:y};this.rasterInfo=u;return{success:!0,supportsGPU:3>=u.bandCount}}_processPixels(y){({pixelBlocks:y}=y);return y&&null!=y?.[0]?
H.compositeBands(y):null}_getWebGLParameters(){return{bandCount:this.rasterInfo.bandCount}}};m.__decorate([w.property({json:{write:!0,name:"rasterFunction"}})],z.prototype,"functionName",void 0);m.__decorate([w.property({type:P,json:{write:!0,name:"rasterFunctionArguments"}})],z.prototype,"functionArguments",void 0);m.__decorate([w.property()],z.prototype,"rasterArgumentNames",void 0);return z=m.__decorate([S.subclass("esri.layers.support.rasterFunctions.CompositeBandFunction")],z)})},"esri/layers/support/rasterFunctions/CompositeBandFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseFunctionArguments".split(" "),
function(m,w,z,N,D,S,Q){var P;N=P=class extends Q{constructor(){super(...arguments);this.rasters=[]}writeRasters(H,y){y.rasters=H.map(u=>"number"===typeof u||"string"===typeof u?u:u.toJSON())}clone(){return new P({rasters:w.clone(this.rasters)})}};m.__decorate([z.property({json:{write:!0}})],N.prototype,"rasters",void 0);m.__decorate([S.writer("rasters")],N.prototype,"writeRasters",null);return N=P=m.__decorate([D.subclass("esri.layers.support.rasterFunctions.CompositeBandFunctionArguments")],N)})},
"esri/layers/support/rasterFunctions/ContrastBrightnessFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./ContrastBrightnessFunctionArguments ./pixelUtils ./stretchUtils".split(" "),function(m,w,z,N,D,S,Q,P,H,y){z=class extends Q{constructor(){super(...arguments);this.functionName="ContrastBrightness";
this.functionArguments=null;this.rasterArgumentNames=["raster"];this.lookup=null}_bindSourceRasters(){var {sourceRasterInfos:u}=this;u=u[0];if("u8"!==u.pixelType)return{success:!1,supportsGPU:!1,error:"Only unsigned 8 bit raster is supported by ContrastBrightness function."};this.outputPixelType=this._getOutputPixelType("u8");u=u.clone();u.colormap=null;u.statistics=null;u.histograms=null;this.rasterInfo=u;const {contrastOffset:c,brightnessOffset:e}=this.functionArguments;this.lookup=y.createContrastBrightnessLUT(c,
e);return{success:!0,supportsGPU:!0}}_processPixels(u){u=u.pixelBlocks?.[0];return null==u?null:H.lookupPixels(u,{lut:u.pixels.map(()=>this.lookup),offset:0,outputPixelType:"u8"})}_getWebGLParameters(){const {contrastOffset:u,brightnessOffset:c}=this.functionArguments;return{contrastOffset:u,brightnessOffset:c}}};m.__decorate([w.property({json:{write:!0,name:"rasterFunction"}})],z.prototype,"functionName",void 0);m.__decorate([w.property({type:P,json:{write:!0,name:"rasterFunctionArguments"}})],z.prototype,
"functionArguments",void 0);m.__decorate([w.property()],z.prototype,"rasterArgumentNames",void 0);m.__decorate([w.property({json:{write:!0}})],z.prototype,"lookup",void 0);return z=m.__decorate([S.subclass("esri.layers.support.rasterFunctions.ContrastBrightnessFunction")],z)})},"esri/layers/support/rasterFunctions/ContrastBrightnessFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(m,w,z,N,D,S,Q){var P;z=P=class extends Q{constructor(){super(...arguments);this.brightnessOffset=this.contrastOffset=0}clone(){return new P({contrastOffset:this.contrastOffset,brightnessOffset:this.brightnessOffset,raster:this.raster})}};m.__decorate([w.property({json:{write:!0}})],z.prototype,"contrastOffset",void 0);m.__decorate([w.property({json:{write:!0}})],z.prototype,"brightnessOffset",void 0);return z=P=m.__decorate([S.subclass("esri.layers.support.rasterFunctions.ContrastBrightnessFunctionArguments")],
z)})},"esri/layers/support/rasterFunctions/stretchUtils":function(){define(["exports","../../../core/maybe","../PixelBlock","../rasterFormats/pixelRangeUtils","../../../renderers/support/stretchRendererUtils"],function(m,w,z,N,D){function S(e,l=256){l=Math.min(l,256);const {size:q,counts:t}=e;e=new Uint8Array(q);var h=t.reduce((d,b)=>d+b/l,0);let p=0;var v=0;let a=0,g=h;for(let d=0;d<q;d++)if(a+=t[d],!(d<q-1&&a+t[d+1]<g)){for(;p<l-1&&g<a;)p++,g+=h;for(;v<=d;v++)e[v]=p;v=d+1}for(h=v;h<q;h++)e[h]=l-
1;return e}function Q(e,l){e=Math.min(Math.max(e,-100),100);l=Math.min(Math.max(l??0,-100),100);let q=0,t=0;const h=new Uint8Array(256);for(q=0;256>q;q++)0<e&&100>e?t=(200*q-25500+510*l)/(2*(100-e))+128:0>=e&&-100<e?t=(200*q-25500+510*l)*(100+e)/2E4+128:100===e?(t=200*q-25500+256*(100-e)+510*l,t=0<t?255:0):-100===e&&(t=128),h[q]=255<t?255:0>t?0:t;return h}function P(e,l,q,t){let h=Infinity,p=-Infinity;var v=0,a=0,g=0,d=0;const b=e.length;var f=new Map,k=[];for(let r=0;r<b;r++){const B=e[r];if(!l||
l[r]){k.push(B);const A=(f.get(B)??0)+1;f.set(B,A);A>d&&(d=A,g=B);h=B<h?B:h;p=B>p?B:p;v+=B;a++}}if(0===a)return{statistics:{min:0,max:0,avg:0,stddev:0,mode:0,median:0},histogram:null};v/=a;d=0;for(f=0;f<b;f++)if(!l||l[f])d+=(e[f]-v)**2;f=l?l.filter(r=>r).length:b;d=1>=f?0:Math.sqrt(d/(f-1));k.sort((r,B)=>r-B);f=a>>>1;g={min:h,max:p,avg:v,stddev:d,mode:g,median:a%2?k[Math.floor(f)]:(k[f-1]+k[f])/2};if(!t)return{statistics:g,histogram:null};if(["u8","s8","u4","u2","u1"].includes(q)){a=p-h+1;q=new Uint32Array(a);
for(t=0;t<b;t++)l&&!l[t]||q[e[t]-h]++;return{statistics:g,histogram:{min:h-.5,max:p+.5,size:a,counts:q}}}q=new Uint32Array(256);t=(p-h)/256;if(0===t)return{statistics:g,histogram:{min:h,max:p,size:1,counts:(new Uint32Array(1)).fill(a)}};a=new Uint32Array(257);for(k=0;k<b;k++)l&&!l[k]||a[Math.floor((e[k]-h)/t)]++;for(e=0;255>e;e++)q[e]=a[e];q[255]=a[255]+a[256];return{statistics:g,histogram:{min:h,max:p,size:256,counts:q}}}function H(e){if(!e?.pixels?.length)return null;const {pixels:l,mask:q,bandMasks:t,
pixelType:h}=e,p=e.width*e.height,v=l.length;let a,g;let d;var b;const f=[],k=[];for(d=0;d<v;d++){var r=new Uint32Array(256);var B=l[d];var A=t?.[d]??q;if("u8"===h)if(a=-.5,g=255.5,A)for(b=0;b<p;b++)A[b]&&r[B[b]]++;else for(b=0;b<p;b++)r[B[b]]++;else{b=!1;e.statistics||(e.updateStatistics(),b=!0);var n=e.statistics;a=n[d].minValue;g=n[d].maxValue;var C=(g-a)/256;if(0===C)for(!n||e.validPixelCount||b||e.updateStatistics(),C=(e.validPixelCount||e.width*e.height)/256,b=0;256>b;b++)r[b]=Math.round(C*
(b+1))-Math.round(C*b);else{n=new Uint32Array(257);for(b=0;b<p;b++)A&&!A[b]||n[Math.floor((B[b]-a)/C)]++;for(b=0;255>b;b++)r[b]=n[b];r[255]=n[255]+n[256]}}f.push({min:a,max:g,size:256,counts:r});for(b=A=B=C=0;256>b;b++)C+=r[b],B+=b*r[b];B/=C;for(b=0;256>b;b++)A+=r[b]*(b-B)**2;b=Math.sqrt(A/(C-1));C=(g-a)/256;r=(B+.5)*C+a;C*=b;k.push({min:a,max:g,avg:r,stddev:C})}return{statistics:k,histograms:f}}function y(e,l){if(null==l||0===l.length)return e;const q=Math.max.apply(null,l),{minCutOff:t,maxCutOff:h,
outMin:p,outMax:v,histogramLut:a}=e;return t.length===l.length||t.length<=q?e:{minCutOff:l.map(g=>t[g]),maxCutOff:l.map(g=>h[g]),histogramLut:a?l.map(g=>a[g]):null,outMin:p,outMax:v}}function u(e,l){const q=new Float32Array(e);for(let t=0;t<e;t++)q[t]=1<l[t]?2<l[t]?6.5+(l[t]-2)**2.5:6.5+100*(2-l[t])**4:1;return q}const c=[.299,.587,.114];m.computeGammaCorrection=u;m.computeGammaValues=function(e,l,q){const t=[];for(let g=0;g<l.length;g++){var h=0,p=0,v=0;"min"in l[g]?{min:h,max:p,avg:v}=l[g]:[h,p,
v]=l[g];v=v??0;"u8"!==e&&(v=255*(v-h)/(p-h));q&&(v*=c[g]);h=t;p=h.push;if(0>=v||255<=v)v=1;else{var a=0;150!==v&&(a=150>=v?45*Math.cos(.01047*v):17*Math.sin(.021*v));a=Math.log((v+a)/255);0===a?v=1:(v=Math.log(v/255)/a,v=isNaN(v)?1:Math.min(9.9,Math.max(.01,v)))}p.call(h,v)}return t};m.computeStatisticsHistograms=function(e){const {pixels:l,mask:q,pixelType:t,bandMasks:h}=e;var p=l.map((v,a)=>P(v,h?.[a]??q,t,!0));e=p.map(({statistics:v})=>v);p=p.map(({histogram:v})=>v);return{statistics:e,histograms:p}};
m.createContrastBrightnessLUT=Q;m.createHistogramEqualizationLUT=S;m.createStretchLUT=function(e){const {minCutOff:l,maxCutOff:q,gamma:t,pixelType:h,rounding:p}=e,v=e.outMin||0,a=e.outMax||255;if(!["u8","u16","s8","s16"].includes(h))return null;const g=l.length;let d,b,f=0;"s8"===h?f=-127:"s16"===h&&(f=-32767);let k=256;["u16","s16"].includes(h)&&(k=65536);var r=[],B=[];const A=a-v;for(d=0;d<g;d++)B[d]=q[d]-l[d],r[d]=0===B[d]?0:A/B[d];let n;const C=[];let E,I;if(t&&t.length>=g)for(r=u(g,t),d=0;d<
g;d++){I=[];for(b=0;b<k;b++)if(0===B[d])I[b]=v;else{var M=b+f;n=(M-l[d])/B[d];E=1;1<t[d]&&(E-=(1/A)**(n*r[d]));M<q[d]&&M>l[d]?(M=E*A*n**(1/t[d])+v,I[b]="floor"===p?Math.floor(M):"round"===p?Math.round(M):M):I[b]=M>=q[d]?a:v}C[d]=I}else for(d=0;d<g;d++){I=[];for(b=0;b<k;b++)M=b+f,M<=l[d]?I[b]=v:M>=q[d]?I[b]=a:(B=(M-l[d])*r[d]+v,I[b]="floor"===p?Math.floor(B):"round"===p?Math.round(B):B);C[d]=I}if(null!=e.contrastOffset)for(e=Q(e.contrastOffset,e.brightnessOffset),d=0;d<g;d++)for(I=C[d],b=0;b<k;b++)I[b]=
e[I[b]];return{lut:C,offset:f}};m.estimateStatisticsFromHistograms=function(e){const l=[];for(let p=0;p<e.length;p++){const {min:v,max:a,size:g,counts:d}=e[p];let b=0;var q=0;for(var t=0;t<g;t++)b+=d[t],q+=t*d[t];q/=b;t=0;for(var h=0;h<g;h++)t+=d[h]*(h-q)**2;h=(a-v)/g;l.push({min:v,max:a,avg:(q+.5)*h+v,stddev:Math.sqrt(t/(b-1))*h})}return l};m.estimateStatisticsHistograms=H;m.getStretchCutoff=function(e,l){const {pixelBlock:q,bandIds:t,returnHistogramLut:h,rasterInfo:p}=l;var v=null;l=null;var a=
e.stretchType;"number"===typeof a&&(a=D.stretchTypeFunctionEnum[a]);e.dra?"minMax"===a&&q?.statistics?v=q.statistics.map(M=>[M.minValue,M.maxValue,0,0]):(l=H(q),v=null!=l?l.statistics:null,l=null!=l?l.histograms:null):(v=e.statistics?.length?e.statistics:p.statistics,l="histograms"in e?e.histograms:void 0,l||(l=p.histograms));"percentClip"!==a&&"histogramEqualization"!==a||l?.length||(a="minMax");var g=v?.length||l?.length||p.bandCount;const d=[],b=[];let f,k,r;v&&!Array.isArray(v[0])&&(v=v.map(M=>
[M.min,M.max,M.avg,M.stddev]));const [B,A]=N.getPixelValueRange(p.pixelType);if(!v?.length){v=[];for(k=0;k<g;k++)v.push([B,A,1,1]);"standardDeviation"===a&&(a="minMax")}switch(a){case "none":for(k=0;k<g;k++)d[k]=B,b[k]=A;break;case "minMax":for(k=0;k<g;k++){var n=v[k];d[k]=n[0];b[k]=n[1]}break;case "standardDeviation":({numberOfStandardDeviations:n=2}=e);for(k=0;k<g;k++){var C=v[k];d[k]=C[2]-n*C[3];b[k]=C[2]+n*C[3];d[k]<C[0]&&(d[k]=C[0]);b[k]>C[1]&&(b[k]=C[1])}break;case "histogramEqualization":w.assertIsSome(l);
for(k=0;k<g;k++)d[k]=l[k].min,b[k]=l[k].max;break;case "percentClip":w.assertIsSome(l);for(k=0;k<l.length;k++){v=l[k];C=new Uint32Array(v.size);var E=[...v.counts];20<=E.length&&(E[0]=E[1]=E[2]=E[E.length-1]=E[E.length-2]=0);n=0;g=(v.max-v.min)/v.size;f=-.5===v.min&&1===g?.5:0;for(r=0;r<v.size;r++)n+=E[r],C[r]=n;E=(e.minPercent||0)*n/100;d[k]=v.min+f;for(r=0;r<v.size;r++)if(C[r]>E){d[k]=v.min+g*(r+f);break}E=(1-(e.maxPercent||0)/100)*n;b[k]=v.max+f;for(r=v.size-2;0<=r;r--)if(C[r]<E){b[k]=v.min+g*
(r+2-f);break}b[k]<d[k]&&(v=d[k],d[k]=b[k],b[k]=v)}break;default:for(k=0;k<g;k++)n=v[k],d[k]=n[0],b[k]=n[1]}let I;"histogramEqualization"===a?(w.assertIsSome(l),a=l[0].size||256,e=0,h&&(I=l.map(M=>S(M)))):(a=e.max||255,e=e.min||0);return y({minCutOff:d,maxCutOff:b,outMax:a,outMin:e,histogramLut:I},t)};m.stretch=function(e,l){if(!e?.pixels?.length)return e;const {mask:q,bandMasks:t,width:h,height:p,pixels:v}=e,{minCutOff:a,maxCutOff:g,gamma:d}=l;var b=l.outMin||0;const f=l.outMax||255,k=h*p,r=l.outputPixelType||
"u8";e=e.pixels.map(()=>z.createEmptyBand(r,k));const B=e.length;var A=f-b,n=[],C=[];for(var E=0;E<B;E++)C[E]=g[E]-a[E],n[E]=0===C[E]?0:A/C[E];E=r.startsWith("u")||r.startsWith("s");l=!!l.isRenderer;if(d&&d.length>=B){n=u(B,d);for(var I=0;I<B;I++){var M=t?.[I]??q;for(let F=0;F<k;F++)if(null==M||M[F]){if(0===C[I]){e[I][F]=b;continue}var U=v[I][F];const x=(U-a[I])/C[I];let K=1;1<d[I]&&(K-=(1/A)**(x*n[I]));U<g[I]&&U>a[I]?(U=K*A*x**(1/d[I])+b,e[I][F]=l?Math.floor(U):E?Math.round(U):U):e[I][F]=U>=g[I]?
f:b}}}else for(A=0;A<B;A++)for(C=t?.[A]??q,I=0;I<k;I++)if(null==C||C[I])M=v[A][I],M<g[A]&&M>a[A]?(M=(M-a[A])*n[A]+b,e[A][I]=l?Math.floor(M):E?Math.round(M):M):e[A][I]=M>=g[A]?f:b;b=new z({width:h,height:p,mask:q,bandMasks:t,pixels:e,pixelType:r});b.updateStatistics();return b};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/ConvolutionFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../rasterFunctionConstants ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./ConvolutionFunctionArguments ./convolutionUtils".split(" "),
function(m,w,z,N,D,S,Q,P,H,y,u){z=class extends H{constructor(){super(...arguments);this.functionName="Convolution";this.rasterArgumentNames=["raster"]}_bindSourceRasters(){const {convolutionType:c,rows:e,cols:l,kernel:q}=this.functionArguments;if(!Object.values(Q.convolutionKernel).includes(c))return{success:!1,supportsGPU:!1,error:`convolution-function: the specified kernel type is not supported ${c}`};if(c!==Q.convolutionKernel.none&&e*l!==q.length)return{success:!1,supportsGPU:!1,error:"convolution-function: the specified rows and cols do not match the length of the kernel"};
var t=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType(t.pixelType);t=t.clone();t.pixelType=this.outputPixelType;const h=[Q.convolutionKernel.none,Q.convolutionKernel.sharpen,Q.convolutionKernel.sharpen2,Q.convolutionKernel.sharpening3x3,Q.convolutionKernel.sharpening5x5];"u8"===this.outputPixelType||h.includes(c)||(t.statistics=null,t.histograms=null);t.colormap=null;t.attributeTable=null;this.rasterInfo=t;return{success:!0,supportsGPU:25>=q.length}}_processPixels(c){c=c.pixelBlocks?.[0];
if(null==c||this.functionArguments.convolutionType===Q.convolutionKernel.none)return c;let {kernel:e,rows:l,cols:q}=this.functionArguments;const t=e.reduce((h,p)=>h+p);0!==t&&1!==t&&(e=e.map(h=>h/t));return u.convolute(c,{kernel:e,rows:l,cols:q,outputPixelType:this.outputPixelType})}_getWebGLParameters(){let {kernel:c}=this.functionArguments;const e=c.reduce((q,t)=>q+t);0!==e&&1!==e&&(c=c.map(q=>q/e));const l=new Float32Array(25);l.set(c);return{kernelRows:this.functionArguments.rows,kernelCols:this.functionArguments.cols,
kernel:l,clampRange:P.getPixelValueRange(this.outputPixelType)}}};m.__decorate([w.property({json:{write:!0,name:"rasterFunction"}})],z.prototype,"functionName",void 0);m.__decorate([w.property({type:y,json:{write:!0,name:"rasterFunctionArguments"}})],z.prototype,"functionArguments",void 0);m.__decorate([w.property()],z.prototype,"rasterArgumentNames",void 0);return z=m.__decorate([S.subclass("esri.layers.support.rasterFunctions.ConvolutionFunction")],z)})},"esri/layers/support/rasterFunctionConstants":function(){define(["exports"],
function(m){const w={plus:1,minus:2,times:3,sqrt:4,power:5,abs:10,divide:23,exp:25,exp10:26,exp2:27,int:30,float:32,ln:35,log10:36,log2:37,mod:44,negate:45,roundDown:48,roundUp:49,square:53,floatDivide:64,floorDivide:65},z={bitwiseAnd:11,bitwiseLeftShift:12,bitwiseNot:13,bitwiseOr:14,bitwiseRightShift:15,bitwiseXOr:16,booleanAnd:17,booleanNot:18,booleanOr:19,booleanXOr:20,equalTo:24,greaterThan:28,greaterThanEqual:29,lessThan:33,lessThanEqual:34,isNull:31,notEqual:46},N={acos:6,asin:7,atan:8,atanh:9,
cos:21,cosh:22,sin:51,sinh:52,tan:56,tanh:57,acosh:59,asinh:60,atan2:61},D={majority:38,max:39,mean:40,med:41,min:42,minority:43,range:47,stddev:54,sum:55,variety:58,majorityIgnoreNoData:66,maxIgnoreNoData:67,meanIgnoreNoData:68,medIgnoreNoData:69,minIgnoreNoData:70,minorityIgnoreNoData:71,rangeIgnoreNoData:72,stddevIgnoreNoData:73,sumIgnoreNoData:74,varietyIgnoreNoData:75},S={setNull:50,conditional:78},Q={...w,...z,...N,...D,...S};m.bandIndexType={userDefined:0,NDVI:1,SAVI:2,TSAVI:3,MSAVI:4,GEMI:5,
PVI:6,GVITM:7,Sultan:8,VARI:9,GNDVI:10,SR:11,NDVIRe:12,SRRe:13,MTVI2:14,RTVICore:15,CIRe:16,CIG:17,NDWI:18,EVI:19,ironOxide:20,ferrousMinerals:21,clayMinerals:22,WNDWI:23,BAI:24,NBR:25,NDBI:26,NDMI:27,NDSI:28,MNDWI:29};m.cellStatisticalOperation=D;m.colorRampName={aspect:"Aspect",blackToWhite:"Black to White",blueBright:"Blue Bright",blueLightToDark:"Blue Light to Dark",blueGreenBright:"Blue-Green Bright",blueGreenLightToDark:"Blue-Green Light to Dark",brownLightToDark:"Brown Light to Dark",brownToBlueGreenDivergingBright:"Brown to Blue Green Diverging, Bright",
brownToBlueGreenDivergingDark:"Brown to Blue Green Diverging, Dark",coefficientBias:"Coefficient Bias",coldToHotDiverging:"Cold to Hot Diverging",conditionNumber:"Condition Number",cyanToPurple:"Cyan to Purple",cyanLightToBlueDark:"Cyan-Light to Blue-Dark",distance:"Distance",elevation1:"Elevation #1",elevation2:"Elevation #2",errors:"Errors",grayLightToDark:"Gray Light to Dark",greenBright:"Green Bright",greenLightToDark:"Green Light to Dark",greenToBlue:"Green to Blue",orangeBright:"Orange Bright",
orangeLightToDark:"Orange Light to Dark",partialSpectrum:"Partial Spectrum",partialSpectrum1Diverging:"Partial Spectrum 1 Diverging",partialSpectrum2Diverging:"Partial Spectrum 2 Diverging",pinkToYellowGreenDivergingBright:"Pink to YellowGreen Diverging, Bright",pinkToYellowGreenDivergingDark:"Pink to YellowGreen Diverging, Dark",precipitation:"Precipitation",prediction:"Prediction",purpleBright:"Purple Bright",purpleToGreenDivergingBright:"Purple to Green Diverging, Bright",purpleToGreenDivergingDark:"Purple to Green Diverging, Dark",
purpleBlueBright:"Purple-Blue Bright",purpleBlueLightToDark:"Purple-Blue Light to Dark",purpleRedBright:"Purple-Red Bright",purpleRedLightToDark:"Purple-Red Light to Dark",redBright:"Red Bright",redLightToDark:"Red Light to Dark",redToBlueDivergingBright:"Red to Blue Diverging, Bright",redToBlueDivergingDark:"Red to Blue Diverging, Dark",redToGreen:"Red to Green",redToGreenDivergingBright:"Red to Green Diverging, Bright",redToGreenDivergingDark:"Red to Green Diverging, Dark",slope:"Slope",spectrumFullBright:"Spectrum-Full Bright",
spectrumFullDark:"Spectrum-Full Dark",spectrumFullLight:"Spectrum-Full Light",surface:"Surface",temperature:"Temperature",whiteToBlack:"White to Black",yellowToDarkRed:"Yellow to Dark Red",yellowToGreenToDarkBlue:"Yellow to Green to Dark Blue",yellowToRed:"Yellow to Red",yellowGreenBright:"Yellow-Green Bright",yellowGreenLightToDark:"Yellow-Green Light to Dark"};m.colormapName={random:"Random",NDVI:"NDVI",NDVI2:"NDVI2",NDVI3:"NDVI3",elevation:"Elevation",gray:"Gray",hillshade:"Hillshade"};m.convolutionKernel=
{userDefined:-1,lineDetectionHorizontal:0,lineDetectionVertical:1,lineDetectionLeftDiagonal:2,lineDetectionRightDiagonal:3,gradientNorth:4,gradientWest:5,gradientEast:6,gradientSouth:7,gradientNorthEast:8,gradientNorthWest:9,smoothArithmeticMean:10,smoothing3x3:11,smoothing5x5:12,sharpening3x3:13,sharpening5x5:14,laplacian3x3:15,laplacian5x5:16,sobelHorizontal:17,sobelVertical:18,sharpen:19,sharpen2:20,pointSpread:21,none:255};m.curvatureType={standard:0,platform:1,profile:2};m.localArithmeticOperation=
w;m.localConditionalOperation=S;m.localLogicalOperation=z;m.localOperators=Q;m.localTrigonometricOperation=N;m.missingBandAction={bestMatch:0,fail:1};m.noDataInterpretation={matchAny:0,matchAll:1};m.slopeType={degree:1,percentRise:2,adjusted:3};m.statisticsType={min:1,max:2,mean:3,standardDeviation:4,median:5,majority:6,minority:7};m.stretchType={none:0,standardDeviation:3,histogramEqualization:4,minMax:5,percentClip:6,sigmoid:9};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/ConvolutionFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../rasterFunctionConstants ./BaseFunctionArguments ./convolutionUtils".split(" "),
function(m,w,z,N,D,S,Q,P){var H;N=H=class extends Q{constructor(){super(...arguments);this.cols=this.rows=3;this.kernel=[0,0,0,0,1,0,0,0,0]}set convolutionType(y){this._set("convolutionType",y);const u=P.convolutionKernels.get(y);u&&y!==S.convolutionKernel.userDefined&&y!==S.convolutionKernel.none&&(y=Math.sqrt(u.length),this._set("kernel",u),this._set("cols",y),this._set("rows",y))}clone(){return new H({cols:this.cols,rows:this.rows,kernel:[...this.kernel],convolutionType:this.convolutionType,raster:w.clone(this.raster)})}};
m.__decorate([z.property({json:{type:Number,write:!0}})],N.prototype,"rows",void 0);m.__decorate([z.property({json:{type:Number,write:!0}})],N.prototype,"cols",void 0);m.__decorate([z.property({json:{name:"type",type:Number,write:!0}})],N.prototype,"convolutionType",null);m.__decorate([z.property({json:{type:[Number],write:!0}})],N.prototype,"kernel",void 0);return N=H=m.__decorate([D.subclass("esri.layers.support.rasterFunctions.ConvolutionFunctionArguments")],N)})},"esri/layers/support/rasterFunctions/convolutionUtils":function(){define(["exports",
"../PixelBlock","../rasterFunctionConstants","./mirror"],function(m,w,z,N){function D(y){const u=Math.sqrt(y.length),c=y.slice(0,u),e=[1];for(let l=1;l<u;l++){let q=null;for(let t=0;t<u;t++){const h=y[t+l*u],p=y[t];if(null==q)if(0===p){if(h)return{separable:!1,row:null,col:null}}else q=h/p;else if(h/p!==q)return{separable:!1,row:null,col:null}}if(null==q)return{separable:!1,row:null,col:null};e.push(q)}return{separable:!0,row:c,col:e}}function S(y,u,c,e,l,q,t){const h=new Float32Array(u*c),p=q.length,
v=t?0:e,a=t?e:0;t=t?1:u;for(let g=v;g<c-v;g++){const d=g*u;for(let b=a;b<u-a;b++){if(l&&!l[d+b])continue;let f=0;for(let k=0;k<p;k++)f+=y[d+b+(k-e)*t]*q[k];h[d+b]=f}}return h}function Q(y,u,c=!0){const {pixels:e,width:l,height:q,pixelType:t,mask:h}=y;y=e.length;const p=[],{kernel:v,rows:a,cols:g}=u;for(u=0;u<y;u++){var d=e[u],b=l,f=q,k=a,r=g,B=h,A=v;const n=new Float32Array(b*f),C=Math.floor(k/2),E=Math.floor(r/2);for(let I=C;I<f-C;I++){const M=I*b;for(let U=E;U<b-E;U++){if(B&&!B[M+U])continue;let F=
0;for(let x=0;x<k;x++)for(let K=0;K<r;K++)F+=d[M+U+(x-C)*b+K-E]*A[x*r+K];n[M+U]=F}}d=n;c&&N.mirror(d,l,q,a,g);p.push(d)}return new w({width:l,height:q,pixelType:t,pixels:p,mask:h})}function P(y,u,c,e=!0){const {pixels:l,width:q,height:t,pixelType:h,mask:p}=y;y=l.length;const v=[],a=u.length,g=c.length,d=Math.floor(a/2),b=Math.floor(g/2);for(let f=0;f<y;f++){let k=S(l[f],q,t,d,p,u,!0);k=S(k,q,t,b,p,c,!1);e&&N.mirror(k,q,t,a,g);v.push(k)}return new w({width:q,height:t,pixelType:h,pixels:v,mask:p})}
const H=new Map;H.set(z.convolutionKernel.none,[0,0,0,0,1,0,0,0,0]);H.set(z.convolutionKernel.lineDetectionHorizontal,[-1,-1,-1,2,2,2,-1,-1,-1]);H.set(z.convolutionKernel.lineDetectionVertical,[-1,2,-1,-1,2,-1,-1,2,-1]);H.set(z.convolutionKernel.lineDetectionLeftDiagonal,[2,-1,-1,-1,2,-1,-1,-1,2]);H.set(z.convolutionKernel.lineDetectionRightDiagonal,[-1,-1,2,-1,2,-1,2,-1,-1]);H.set(z.convolutionKernel.gradientNorth,[-1,-2,-1,0,0,0,1,2,1]);H.set(z.convolutionKernel.gradientWest,[-1,0,1,-2,0,2,-1,0,
1]);H.set(z.convolutionKernel.gradientEast,[1,0,-1,2,0,-2,1,0,-1]);H.set(z.convolutionKernel.gradientSouth,[1,2,1,0,0,0,-1,-2,-1]);H.set(z.convolutionKernel.gradientNorthEast,[0,-1,-2,1,0,-1,2,1,0]);H.set(z.convolutionKernel.gradientNorthWest,[-2,-1,0,-1,0,1,0,1,2]);H.set(z.convolutionKernel.smoothArithmeticMean,[.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111]);H.set(z.convolutionKernel.smoothing3x3,[.0625,.125,.0625,.125,
.25,.125,.0625,.125,.0625]);H.set(z.convolutionKernel.smoothing5x5,[1,1,1,1,1,1,4,4,4,1,1,4,12,4,1,1,4,4,4,1,1,1,1,1,1]);H.set(z.convolutionKernel.sharpening3x3,[-1,-1,-1,-1,9,-1,-1,-1,-1]);H.set(z.convolutionKernel.sharpening5x5,[-1,-3,-4,-3,-1,-3,0,6,0,-3,-4,6,21,6,-4,-3,0,6,0,-3,-1,-3,-4,-3,-1]);H.set(z.convolutionKernel.laplacian3x3,[0,-1,0,-1,4,-1,0,-1,0]);H.set(z.convolutionKernel.laplacian5x5,[0,0,-1,0,0,0,-1,-2,-1,0,-1,-2,17,-2,-1,0,-1,-2,-1,0,0,0,-1,0,0]);H.set(z.convolutionKernel.sobelHorizontal,
[-1,-2,-1,0,0,0,1,2,1]);H.set(z.convolutionKernel.sobelVertical,[-1,0,1,-2,0,2,-1,0,1]);H.set(z.convolutionKernel.sharpen,[0,-.25,0,-.25,2,-.25,0,-.25,0]);H.set(z.convolutionKernel.sharpen2,[-.25,-.25,-.25,-.25,3,-.25,-.25,-.25,-.25]);H.set(z.convolutionKernel.pointSpread,[-.627,.352,-.627,.352,2.923,.352,-.627,.352,-.627]);m.convolute=function(y,u){const c=D(u.kernel),e=!1!==u.mirrorEdges;y=c.separable?P(y,c.row,c.col,e):Q(y,u,e);({outputPixelType:u}=u);u&&y.clamp(u);return y};m.convoluteSeparable=
P;m.convolutionKernels=H;m.separateKernels=D;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/mirror":function(){define(["exports"],function(m){m.mirror=function(w,z,N,D,S){D=Math.floor(D/2);for(var Q=0;Q<D;Q++)for(var P=0;P<z;P++)w[Q*z+P]=w[(S-1-Q)*z+P],w[(N-1-Q)*z+P]=w[(N-S+Q)*z+P];D=Math.floor(S/2);for(Q=0;Q<N;Q++){P=Q*z;for(let H=0;H<D;H++)w[P+H]=w[P+S-1-H],w[P+z-H-1]=w[P+z+H-S]}};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},
"esri/layers/support/rasterFunctions/CurvatureFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./CurvatureFunctionArguments ./surfaceUtils".split(" "),function(m,w,z,N,D,S,Q,P,H){z=class extends Q{constructor(){super(...arguments);this.functionName="Curvature";this.functionArguments=null;this.rasterArgumentNames=
["raster"];this.isGCS=!1}_bindSourceRasters(){this.outputPixelType=this._getOutputPixelType("f32");const y=this.sourceRasterInfos[0].clone();y.pixelType=this.outputPixelType;y.statistics=null;y.histograms=null;y.colormap=null;y.attributeTable=null;y.bandCount=1;this.rasterInfo=y;this.isGCS=y.spatialReference?.isGeographic??!1;return{success:!0,supportsGPU:!0}}_processPixels(y){const u=y.pixelBlocks?.[0];if(null==u)return null;const {zFactor:c,curvatureType:e}=this.functionArguments,{extent:l,primaryPixelSizes:q}=
y;y=q?.[0];return H.curvature(u,{zFactor:this.isGCS&&1<=c?c*H.gcsFactor:c,curvatureType:e,resolution:null==y?l?{x:l.width/u.width,y:l.height/u.height}:{x:1,y:1}:y})}_getWebGLParameters(){const {zFactor:y,curvatureType:u}=this.functionArguments;return{curvatureType:u,zFactor:this.isGCS&&1<=y?y*H.gcsFactor:y}}};m.__decorate([w.property({json:{write:!0,name:"rasterFunction"}})],z.prototype,"functionName",void 0);m.__decorate([w.property({type:P,json:{write:!0,name:"rasterFunctionArguments"}})],z.prototype,
"functionArguments",void 0);m.__decorate([w.property()],z.prototype,"rasterArgumentNames",void 0);m.__decorate([w.property({json:{write:!0}})],z.prototype,"isGCS",void 0);return z=m.__decorate([S.subclass("esri.layers.support.rasterFunctions.CurvatureFunction")],z)})},"esri/layers/support/rasterFunctions/CurvatureFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/jsonMap ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(m,w,z,N,D,S,Q,P,H,y){var u;const c=new w.JSONMap({0:"standard",1:"platform",2:"profile"},{useNumericKeys:!0});w=u=class extends y{constructor(){super(...arguments);this.curvatureType="standard";this.zFactor=1}readCurvatureType(e,l){return c.fromJSON(l.type??l.curvatureType??0)}clone(){return new u({curvatureType:this.curvatureType,zFactor:this.zFactor,raster:this.raster})}};m.__decorate([z.property({json:{write:{target:"type"}}}),Q.enumeration(c)],w.prototype,"curvatureType",void 0);m.__decorate([P.reader("curvatureType",
["type","curvatureType"])],w.prototype,"readCurvatureType",null);m.__decorate([z.property({type:Number,json:{write:!0}})],w.prototype,"zFactor",void 0);return w=u=m.__decorate([H.subclass("esri.layers.support.rasterFunctions.CurvatureFunctionArguments")],w)})},"esri/layers/support/rasterFunctions/ExtractBandFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./bandIndexUtils ./BaseRasterFunction ./ExtractBandFunctionArguments ./pixelUtils".split(" "),
function(m,w,z,N,D,S,Q,P,H,y){z=class extends P{constructor(){super(...arguments);this.functionName="ExtractBand";this.functionArguments=null;this.rasterArgumentNames=["raster"]}_bindSourceRasters(){const {functionArguments:u,sourceRasterInfos:c}=this;var e=c[0];const {method:l,bandNames:q,bandWavelengths:t,bandIds:h,missingBandAction:p}=u,v=q?.length&&("name"===l||"id"!==l&&!h?.length),a=t?.length&&("wavelength"===l||"id"!==l&&!h?.length);var g=p===y.MissingBandAction.fail;g=v?this._matchBandNames(e,
q):a?this._matchBandWavelengths(e,t,g):this._matchBandIds(e,h,g);if(null==g)return{success:!1,supportsGPU:!1,error:`extract-band-function: Invalid ${v?"band names":a?"band wavelengths":"band ids"} for the imagery data source`};this.functionArguments.bandIds=g;this.functionArguments.method="id";this.outputPixelType=this._getOutputPixelType("f32");e=e.clone();e.pixelType=this.outputPixelType;e.bandCount=g.length;const {statistics:d,histograms:b}=e;null!=d&&d.length&&(e.statistics=g.map(k=>d[k]||d[d.length-
1]));null!=b&&b.length&&(e.histograms=g.map(k=>b[k]||b[b.length-1]));let f=e.keyProperties?.BandProperties;f?.length&&(f=g.map(k=>k>=f.length?f[f.length-1]:f[k]),e.keyProperties={...e.keyProperties,BandProperties:f});this.rasterInfo=e;return{success:!0,supportsGPU:3>=e.bandCount}}_processPixels(u){u=u.pixelBlocks?.[0];if(null==u)return null;const c=u.pixels.length,e=this.functionArguments.bandIds.map(l=>l>=c?c-1:l);return u.extractBands(e)}_getWebGLParameters(){let u;if(this.isInputBandIdsSwizzled)u=
this.swizzledBandSelection.length?this.swizzledBandSelection:[0,1,2];else{u=[...this.functionArguments.bandIds];0===u.length?u=[0,1,2]:3>u.length&&(u[1]=u[1]??u[0],u[2]=u[2]??u[1]);for(let c=0;3>c;c++)u[c]=Math.min(u[c],2)}return{bandIndexMat3:Q.getBandMatrix3(u)}}_getInputBandIds(u){const c=u.length;return this.functionArguments.bandIds.map(e=>e>=c?c-1:e).map(e=>u[e])}_matchBandNames(u,c){u=u.bandInfos.map(({name:l})=>l.toLowerCase());const e=[];for(let l=0;l<c.length;l++){const q=c[l].toLowerCase();
let t=u.indexOf(q);-1===t&&"nearinfrared"===q&&(t=u.findIndex(h=>h.startsWith("nearinfrared_1")),-1===t&&(t=u.findIndex(h=>h.startsWith("nearinfrared"))));if(-1===t)return null;e.push(t)}return e}_matchBandIds(u,c,e){const {bandCount:l}=u;return!c?.length||e&&c.some(q=>0>q||q>=l)?null:c}_matchBandWavelengths(u,c,e){var {bandInfos:l}=u;u=[];for(var q=0;q<l.length;q++){const {minWavelength:t,maxWavelength:h}=l[q];if(!t||!h)return null;u.push({minWavelength:t,maxWavelength:h})}({wavelengthMatchTolerance:l}=
this.functionArguments);q=[];for(let t=0;t<c.length;t++){const h=c[t];let p=!1,v=-1,a=Number.MAX_VALUE;for(let g=0;g<u.length;g++){const d=u[g],b=Math.abs(h-(d.minWavelength+d.maxWavelength)/2);h>=d.minWavelength&&h<=d.maxWavelength?b<a&&(p=!0,v=g,a=b):!p&&b<a&&(v=g,a=b)}!p&&l&&a<l&&(p=!0);if(!p&&e)return null;q.push(v)}return q}};m.__decorate([w.property({json:{write:!0,name:"rasterFunction"}})],z.prototype,"functionName",void 0);m.__decorate([w.property({type:H,json:{write:!0,name:"rasterFunctionArguments"}})],
z.prototype,"functionArguments",void 0);m.__decorate([w.property()],z.prototype,"rasterArgumentNames",void 0);return z=m.__decorate([S.subclass("esri.layers.support.rasterFunctions.ExtractBandFunction")],z)})},"esri/layers/support/rasterFunctions/ExtractBandFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments ./pixelUtils".split(" "),
function(m,w,z,N,D,S,Q,P,H){var y;z=y=class extends P{constructor(){super(...arguments);this.bandIds=[];this.bandNames=[];this.bandWavelengths=[];this.missingBandAction=H.MissingBandAction.bestMatch}clone(){return new y({bandIds:this.bandIds?.slice(),bandNames:this.bandNames?.slice(),bandWavelengths:this.bandWavelengths?.slice(),missingBandAction:this.missingBandAction,method:this.method,wavelengthMatchTolerance:this.wavelengthMatchTolerance})}};m.__decorate([w.property({json:{write:!0}})],z.prototype,
"bandIds",void 0);m.__decorate([w.property({json:{write:!0}})],z.prototype,"bandNames",void 0);m.__decorate([w.property({json:{write:!0}})],z.prototype,"bandWavelengths",void 0);m.__decorate([S.enumeration({0:"name",1:"wavelength",2:"id"})],z.prototype,"method",void 0);m.__decorate([w.property({json:{write:!0}})],z.prototype,"missingBandAction",void 0);m.__decorate([w.property({json:{write:!0}})],z.prototype,"wavelengthMatchTolerance",void 0);return z=y=m.__decorate([Q.subclass("esri.layers.support.rasterFunctions.ExtractBandFunctionArguments")],
z)})},"esri/layers/support/rasterFunctions/LocalFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../rasterFunctionConstants ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./LocalFunctionArguments ./localUtils".split(" "),function(m,w,z,N,D,S,Q,P,H,y,u){z=class extends H{constructor(){super(...arguments);
this.functionName="Local";this.functionArguments=null;this.rasterArgumentNames=["rasters"]}_bindSourceRasters(){var {sourceRasterInfos:c}=this,e=c[0];const {bandCount:l}=e;var {processAsMultiband:q}=this.functionArguments;if(c.some(p=>p.bandCount!==l))return{success:!1,supportsGPU:!1,error:"local-function: input rasters do not have same band count"};const {operation:t,rasters:h}=this.functionArguments;c=u.operandsCount[t];if(!(999===c||h.length===c||1>=h.length&&1===c))return{success:!1,supportsGPU:!1,
error:`local-function: the length of functionArguments.rasters does not match operation's requirement: ${c}`};this.outputPixelType=this._getOutputPixelType("f32");e=e.clone();e.pixelType=this.outputPixelType;e.statistics=null;e.histograms=null;e.colormap=null;e.attributeTable=null;e.bandCount=999!==c||q?l:1;if(q=u.getOutputDomain(t)){e.statistics=[];for(let p=0;p<e.bandCount;p++)e.statistics[p]={min:q[0],max:q[1],avg:(q[0]+q[1])/2,stddev:(q[0]+q[1])/10}}this.rasterInfo=e;return{success:!0,supportsGPU:1===
e.bandCount&&3>=c&&(11>t||16<t)}}_processPixels(c){({pixelBlocks:c}=c);return null==c||c.some(e=>null==e)?null:u.local(c,this.functionArguments.operation,{processAsMultiband:this.functionArguments.processAsMultiband,outputPixelType:this.outputPixelType??void 0})}_getWebGLParameters(){const {operation:c}=this.functionArguments,e=u.operandsCount[c],l=Object.keys(Q.localOperators).find(p=>Q.localOperators[p]===c)?.toLowerCase()??"undefined";var q=this.outputPixelType??"f32";let [t,h]=P.getPixelValueRange(q);
if(q=q.startsWith("u")||q.startsWith("s"))t-=1E-4,h+=1E-4;return{imageCount:e,operationName:l,domainRange:[t,h],isOutputRounded:q}}};m.__decorate([w.property({json:{write:!0,name:"rasterFunction"}})],z.prototype,"functionName",void 0);m.__decorate([w.property({type:y,json:{write:!0,name:"rasterFunctionArguments"}})],z.prototype,"functionArguments",void 0);m.__decorate([w.property()],z.prototype,"rasterArgumentNames",void 0);return z=m.__decorate([S.subclass("esri.layers.support.rasterFunctions.LocalFunction")],
z)})},"esri/layers/support/rasterFunctions/LocalFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseFunctionArguments".split(" "),function(m,w,z,N,D,S,Q){var P;N=P=class extends Q{constructor(){super(...arguments);this.rasters=[];this.processAsMultiband=!0}writeRasters(H,y){y.rasters=
H.map(u=>"number"===typeof u||"string"===typeof u?u:u.toJSON())}clone(){return new P({operation:this.operation,processAsMultiband:this.processAsMultiband,rasters:w.clone(this.rasters)})}};m.__decorate([z.property({json:{write:!0}})],N.prototype,"operation",void 0);m.__decorate([z.property({json:{write:!0}})],N.prototype,"rasters",void 0);m.__decorate([S.writer("rasters")],N.prototype,"writeRasters",null);m.__decorate([z.property({json:{write:!0}})],N.prototype,"processAsMultiband",void 0);return N=
P=m.__decorate([D.subclass("esri.layers.support.rasterFunctions.LocalFunctionArguments")],N)})},"esri/layers/support/rasterFunctions/localUtils":function(){define(["exports","../PixelBlock","../rasterFunctionConstants","../rasterFormats/pixelRangeUtils"],function(m,w,z,N){function D(ba,ia=!1){var da=ba.map(ha=>ha.mask);const ka=da.filter(ha=>null!=ha);var na=ba[0].pixels[0].length;if(0===ka.length)return(new Uint8Array(na)).fill(255);ba=new Uint8Array(ka[0]);if(1===ka.length)return ba;if(!ia){for(ia=
1;ia<ka.length;ia++)for(da=ka[ia],na=0;na<ba.length;na++)ba[na]&&(ba[na]=da[na]?255:0);return ba}if(ka.length!==da.length)return(new Uint8Array(na)).fill(255);for(ia=1;ia<ka.length;ia++)for(da=ka[ia],na=0;na<ba.length;na++)0===ba[na]&&(ba[na]=da[na]?255:0);return ba}function S(ba,ia,da){const [ka,na]=ba;ba=ka.length;da=w.createEmptyBand(da,ba);for(let ha=0;ha<ba;ha++)if(!ia||ia[ha])da[ha]=ka[ha]+na[ha];return da}function Q(ba,ia,da){[ba]=ba;ia=w.createEmptyBand("f32",ba.length);ia.set(ba);return ia}
function P(ba,ia,da){const [ka,na]=ba;ba=ka.length;da=w.createEmptyBand(da,ba);for(let ha=0;ha<ba;ha++)if(!ia||ia[ha])da[ha]=ka[ha]-na[ha];return da}function H(ba,ia,da){const [ka,na]=ba;ba=ka.length;da=w.createEmptyBand(da,ba);for(let ha=0;ha<ba;ha++)if(!ia||ia[ha])da[ha]=ka[ha]*na[ha];return da}function y(ba,ia,da){[ba]=ba;const ka=ba.length;da=w.createEmptyBand(da,ka);for(let na=0;na<ka;na++)if(!ia||ia[na])da[na]=Math.sign(ba[na])*Math.floor(Math.abs(ba[na]));return da}function u(ba,ia,da){const [ka,
na]=ba;ba=ka.length;da=w.createEmptyBand(da,ba);for(let ha=0;ha<ba;ha++)if(!ia||ia[ha])da[ha]=ka[ha]/na[ha];return da}function c(ba,ia,da){return u(ba,ia,"f32")}function e(ba,ia,da){const [ka,na]=ba;ba=ka.length;da=w.createEmptyBand(da,ba);for(let ha=0;ha<ba;ha++)if(!ia||ia[ha])da[ha]=Math.floor(ka[ha]/na[ha]);return da}function l(ba,ia,da,ka){ba=ba[0];const na=ba.length;da=w.createEmptyBand(da,na);if(ka===z.localTrigonometricOperation.atanh){for(ka=0;ka<na;ka++)if(ia[ka]){var ha=ba[ka];1<=Math.abs(ha)?
ia[ka]=0:da[ka]=Math.atanh(ha)}return da}ka=ka===z.localTrigonometricOperation.asin?Math.asin:Math.acos;for(ha=0;ha<na;ha++)if(ia[ha]){const ta=ba[ha];1<Math.abs(ta)?ia[ha]=0:da[ha]=ka(ta)}return da}function q(ba,ia,da,ka){[ba]=ba;const na=ba.length;da=w.createEmptyBand(da,na);for(let ha=0;ha<na;ha++)if(!ia||ia[ha])da[ha]=ka(ba[ha]);return da}function t(ba,ia,da,ka){const [na,ha]=ba;ba=na.length;da=w.createEmptyBand(da,ba);for(let ta=0;ta<ba;ta++)if(!ia||ia[ta])da[ta]=ka(na[ta],ha[ta]);return da}
function h(ba,ia,da){const [ka,na]=ba;ba=ka.length;da=w.createEmptyBand(da,ba);for(let ha=0;ha<ba;ha++)if(!ia||ia[ha])da[ha]=ka[ha]&na[ha];return da}function p(ba,ia,da){const [ka,na]=ba;ba=ka.length;da=w.createEmptyBand(da,ba);for(let ha=0;ha<ba;ha++)if(!ia||ia[ha])da[ha]=ka[ha]<<na[ha];return da}function v(ba,ia,da){[ba]=ba;const ka=ba.length;da=w.createEmptyBand(da,ka);for(let na=0;na<ka;na++)if(!ia||ia[na])da[na]=~ba[na];return da}function a(ba,ia,da){const [ka,na]=ba;ba=ka.length;da=w.createEmptyBand(da,
ba);for(let ha=0;ha<ba;ha++)if(!ia||ia[ha])da[ha]=ka[ha]|na[ha];return da}function g(ba,ia,da){const [ka,na]=ba;ba=ka.length;da=w.createEmptyBand(da,ba);for(let ha=0;ha<ba;ha++)if(!ia||ia[ha])da[ha]=ka[ha]>>na[ha];return da}function d(ba,ia,da){const [ka,na]=ba;ba=ka.length;da=w.createEmptyBand(da,ba);for(let ha=0;ha<ba;ha++)if(!ia||ia[ha])da[ha]=ka[ha]^na[ha];return da}function b(ba,ia,da){const [ka,na]=ba;ba=ka.length;da=w.createEmptyBand(da,ba);for(let ha=0;ha<ba;ha++)if(!ia||ia[ha])da[ha]=ka[ha]&&
na[ha]?1:0;return da}function f(ba,ia,da){[ba]=ba;const ka=ba.length;da=w.createEmptyBand(da,ka);for(let na=0;na<ka;na++)if(!ia||ia[na])da[na]=ba[na]?0:1;return da}function k(ba,ia,da){const [ka,na]=ba;ba=ka.length;da=w.createEmptyBand(da,ba);for(let ha=0;ha<ba;ha++)if(!ia||ia[ha])da[ha]=ka[ha]||na[ha]?1:0;return da}function r(ba,ia,da){const [ka,na]=ba;ba=ka.length;da=w.createEmptyBand(da,ba);for(let ha=0;ha<ba;ha++)if(!ia||ia[ha])da[ha]=(ka[ha]?1:0)^(na[ha]?1:0);return da}function B(ba,ia,da){const [ka,
na]=ba;ba=ka.length;da=w.createEmptyBand(da,ba);for(let ha=0;ha<ba;ha++)if(!ia||ia[ha])da[ha]=ka[ha]===na[ha]?1:0;return da}function A(ba,ia,da,ka){[ba]=ba;const na=ba.length;da=w.createEmptyBand(da,na);const ha=ka===Math.E;for(let ta=0;ta<na;ta++)if(!ia||ia[ta])da[ta]=ha?Math.exp(ba[ta]):ka**ba[ta];return da}function n(ba,ia,da){return A(ba,ia,da,10)}function C(ba,ia,da){return A(ba,ia,da,2)}function E(ba,ia,da){return A(ba,ia,da,Math.E)}function I(ba,ia,da,ka){[ba]=ba;const na=ba.length;da=w.createEmptyBand(da,
na);for(let ha=0;ha<na;ha++)if(!ia||ia[ha])0>=ba[ha]?ia[ha]=0:da[ha]=ka(ba[ha]);return da}function M(ba,ia,da){return I(ba,ia,da,Math.log10)}function U(ba,ia,da){return I(ba,ia,da,Math.log2)}function F(ba,ia,da){return I(ba,ia,da,Math.log)}function x(ba,ia,da){const [ka,na]=ba;ba=ka.length;da=w.createEmptyBand(da,ba);for(let ha=0;ha<ba;ha++)if(!ia||ia[ha])da[ha]=ka[ha]>na[ha]?1:0;return da}function K(ba,ia,da){const [ka,na]=ba;ba=ka.length;da=w.createEmptyBand(da,ba);for(let ha=0;ha<ba;ha++)if(!ia||
ia[ha])da[ha]=ka[ha]>=na[ha]?1:0;return da}function J(ba,ia,da){const [ka,na]=ba;ba=ka.length;da=w.createEmptyBand(da,ba);for(let ha=0;ha<ba;ha++)if(!ia||ia[ha])da[ha]=ka[ha]<na[ha]?1:0;return da}function G(ba,ia,da){const [ka,na]=ba;ba=ka.length;da=w.createEmptyBand(da,ba);for(let ha=0;ha<ba;ha++)if(!ia||ia[ha])da[ha]=ka[ha]<=na[ha]?1:0;return da}function O(ba,ia,da){[ba]=ba;ba=ba.length;da=w.createEmptyBand(da,ba);if(!ia)return da;for(let ka=0;ka<ba;ka++)da[ka]=ia[ka]?0:1;return da}function R(ba,
ia,da){const [ka,na]=ba;ba=ka.length;da=w.createEmptyBand(da,ba);for(let ha=0;ha<ba;ha++)if(!ia||ia[ha])da[ha]=ka[ha]%na[ha];return da}function T(ba,ia,da){[ba]=ba;const ka=ba.length;da=w.createEmptyBand(da,ka);for(let na=0;na<ka;na++)if(!ia||ia[na])da[na]=-ba[na];return da}function X(ba,ia,da){const [ka,na]=ba;ba=ka.length;da=w.createEmptyBand(da,ba);for(let ha=0;ha<ba;ha++)if(!ia||ia[ha])da[ha]=ka[ha]===na[ha]?0:1;return da}function L(ba,ia,da){const [ka,na]=ba;ba=ka.length;da=w.createEmptyBand(da,
ba);const ha=new Uint8Array(ba);for(let ta=0;ta<ba;ta++)null!=ia&&!ia[ta]||0!==ka[ta]||(da[ta]=na[ta],ha[ta]=255);return{band:da,mask:ha}}function V(ba,ia,da){const [ka,na,ha]=ba;ba=ka.length;da=w.createEmptyBand(da,ba);for(let ta=0;ta<ba;ta++)if(!ia||ia[ta])da[ta]=ka[ta]?na[ta]:ha[ta];return da}function W(ba,ia,da){const ka=ba.length;if(2>ka)return ba[0];const [na]=ba,ha=na.length;da=w.createEmptyBand(da,ha);for(let ta=0;ta<ha;ta++)if(!ia||ia[ta]){let va=na[ta];for(let xa=1;xa<ka;xa++){const ya=
ba[xa][ta];va<ya&&(va=ya)}da[ta]=va}return da}function Y(ba,ia,da){const ka=ba.length;if(2>ka)return ba[0];const [na]=ba,ha=na.length;da=w.createEmptyBand(da,ha);for(let ta=0;ta<ha;ta++)if(!ia||ia[ta]){let va=na[ta];for(let xa=1;xa<ka;xa++){const ya=ba[xa][ta];va>ya&&(va=ya)}da[ta]=va}return da}function Z(ba,ia,da){const ka=ba.length;if(2>ka)return ba[0];const [na]=ba,ha=na.length;da=w.createEmptyBand(da,ha);for(let ta=0;ta<ha;ta++)if(!ia||ia[ta]){let va=na[ta],xa=va;for(let ya=1;ya<ka;ya++){const Aa=
ba[ya][ta];xa<Aa?xa=Aa:va>Aa&&(va=Aa)}da[ta]=xa-va}return da}function aa(ba,ia,da){const ka=ba.length;if(2>ka)return ba[0];var [na]=ba;na=na.length;da=w.createEmptyBand(da,na);for(let ha=0;ha<na;ha++)if(!ia||ia[ha]){let ta=0;for(let va=0;va<ka;va++)ta+=ba[va][ha];da[ha]=ta/ka}return da}function fa(ba,ia,da){const ka=ba.length;if(2>ka)return ba[0];var [na]=ba;na=na.length;da=w.createEmptyBand(da,na);for(let ha=0;ha<na;ha++)if(!ia||ia[ha])for(let ta=0;ta<ka;ta++)da[ha]+=ba[ta][ha];return da}function ea(ba,
ia,da){const ka=ba.length;if(2>ka)return ba[0];var [na]=ba;na=na.length;da=w.createEmptyBand(da,na);for(let va=0;va<na;va++)if(!ia||ia[va]){const xa=new Float32Array(ka);let ya=0;for(var ha=0;ha<ka;ha++){var ta=ba[ha];ya+=ta[va];xa[ha]=ta[va]}ya/=ka;ha=0;for(ta=0;ta<ka;ta++)ha+=(xa[ta]-ya)**2;da[va]=Math.sqrt(ha/ka)}return da}function ca(ba,ia,da){const ka=ba.length;if(2>ka)return ba[0];const na=Math.floor(ka/2);var [ha]=ba;ha=ha.length;da=w.createEmptyBand(da,ha);const ta=new Float32Array(ka),va=
1===ka%2;for(let xa=0;xa<ha;xa++)if(!ia||ia[xa]){for(let ya=0;ya<ka;ya++)ta[ya]=ba[ya][xa];ta.sort();da[xa]=va?ta[na]:(ta[na]+ta[na-1])/2}return da}function ja(ba,ia,da){const [ka,na]=ba;if(null==na)return ka;ba=ka.length;da=w.createEmptyBand(da,ba);for(let ha=0;ha<ba;ha++)ia[ha]&&(ka[ha]===na[ha]?da[ha]=ka[ha]:ia[ha]=0);return da}function la(ba,ia,da){const ka=ba.length;if(2>=ka)return ja(ba,ia,da);const na=ba[0].length;da=w.createEmptyBand(da,na);const ha=new Map;for(let va=0;va<na;va++)if(!ia||
ia[va]){ha.clear();let xa;for(var ta=0;ta<ka;ta++)xa=ba[ta][va],ha.set(xa,ha.has(xa)?ha.get(xa)+1:1);let ya=ta=0;for(const Aa of ha.keys())ta=ha.get(Aa),ta>ya&&(ya=ta,xa=Aa);da[va]=xa}return da}function oa(ba,ia,da){const ka=ba.length;if(2>=ka)return ja(ba,ia,da);const na=ba[0].length;da=w.createEmptyBand(da,na);const ha=new Map;for(let va=0;va<na;va++)if(!ia||ia[va]){ha.clear();let xa;for(var ta=0;ta<ka;ta++)xa=ba[ta][va],ha.set(xa,ha.has(xa)?ha.get(xa)+1:1);ta=0;let ya=ba.length;for(const Aa of ha.keys())ta=
ha.get(Aa),ta<ya&&(ya=ta,xa=Aa);da[va]=xa}return da}function pa(ba,ia,da){const ka=ba.length;if(2>ka)return ba[0];var [na]=ba;na=na.length;da=w.createEmptyBand(da,na);const ha=new Set;for(let ta=0;ta<na;ta++)if(!ia||ia[ta]){ha.clear();let va;for(let xa=0;xa<ka;xa++)va=ba[xa][ta],ha.add(va);da[ta]=ha.size}return da}function qa(ba,ia,da,ka){let [na,ha]=N.getPixelValueRange(da);if(da=da.startsWith("u")||da.startsWith("s"))na-=1E-5,ha+=1E-5;for(let ta=0;ta<ia.length;ta++)if(ia[ta]){const va=ba[ta];isNaN(va)||
va<na||va>ha?ia[ta]=0:ka[ta]=da?Math.round(va):va}}const ra=new Map;ra.set(z.localTrigonometricOperation.acos,[0,Math.PI]);ra.set(z.localTrigonometricOperation.asin,[-Math.PI/2,Math.PI/2]);ra.set(z.localTrigonometricOperation.atan,[-Math.PI/2,Math.PI/2]);ra.set(z.localTrigonometricOperation.cos,[-1,1]);ra.set(z.localTrigonometricOperation.sin,[-1,1]);ra.set(z.localLogicalOperation.booleanAnd,[0,1]);ra.set(z.localLogicalOperation.booleanNot,[0,1]);ra.set(z.localLogicalOperation.booleanOr,[0,1]);ra.set(z.localLogicalOperation.booleanXOr,
[0,1]);ra.set(z.localLogicalOperation.equalTo,[0,1]);ra.set(z.localLogicalOperation.notEqual,[0,1]);ra.set(z.localLogicalOperation.greaterThan,[0,1]);ra.set(z.localLogicalOperation.greaterThanEqual,[0,1]);ra.set(z.localLogicalOperation.lessThan,[0,1]);ra.set(z.localLogicalOperation.lessThanEqual,[0,1]);ra.set(z.localLogicalOperation.isNull,[0,1]);const sa=new Map,ua=new Map,ma=new Map,wa=new Map;m.getOutputDomain=function(ba){return ra.get(ba)};m.local=function(ba,ia,da={}){sa.size||(sa.set(4,Math.sqrt),
sa.set(6,Math.acos),sa.set(7,Math.asin),sa.set(8,Math.atan),sa.set(9,Math.atanh),sa.set(10,Math.abs),sa.set(21,Math.cos),sa.set(22,Math.cosh),sa.set(48,Math.floor),sa.set(49,Math.ceil),sa.set(51,Math.sin),sa.set(52,Math.sinh),sa.set(56,Math.tan),sa.set(57,Math.tanh),sa.set(59,Math.acosh),sa.set(60,Math.asinh),sa.set(65,Math.floor),ua.set(5,Math.pow),ua.set(61,Math.atan2),ma.set(1,S),ma.set(2,P),ma.set(3,H),ma.set(11,h),ma.set(12,p),ma.set(13,v),ma.set(14,a),ma.set(15,g),ma.set(16,d),ma.set(17,b),
ma.set(18,f),ma.set(19,k),ma.set(20,r),ma.set(23,u),ma.set(24,B),ma.set(25,E),ma.set(26,n),ma.set(27,C),ma.set(28,x),ma.set(29,K),ma.set(30,y),ma.set(31,O),ma.set(32,Q),ma.set(33,J),ma.set(34,G),ma.set(35,F),ma.set(36,M),ma.set(37,U),ma.set(44,R),ma.set(45,T),ma.set(46,X),ma.set(64,c),ma.set(65,e),ma.set(76,V),ma.set(78,V),wa.set(38,la),wa.set(39,W),wa.set(40,aa),wa.set(41,ca),wa.set(42,Y),wa.set(43,oa),wa.set(47,Z),wa.set(54,ea),wa.set(55,fa),wa.set(58,pa),wa.set(66,la),wa.set(67,W),wa.set(68,aa),
wa.set(69,ca),wa.set(70,Y),wa.set(71,oa),wa.set(72,Z),wa.set(73,ea),wa.set(74,fa),wa.set(75,pa));var ka=D(ba,66<=ia&&75>=ia);const {outputPixelType:na="f32"}=da,ha=!wa.has(ia)||da.processAsMultiband,ta=ha?ba[0].pixels.length:1;da=[];for(let ya=0;ya<ta;ya++){var va=wa.has(ia)&&!ha?ba.flatMap(Aa=>Aa.pixels):ba.map(Aa=>Aa.pixels[ya]),xa=!0;ia===z.localConditionalOperation.setNull?(ka=L(va,ka,na),va=ka.band,ka=ka.mask,xa=!1):ma.has(ia)?va=ma.get(ia)(va,ka,"f64"):sa.has(ia)?va=ia===z.localTrigonometricOperation.asin||
ia===z.localTrigonometricOperation.acos||ia===z.localTrigonometricOperation.atanh?l(va,ka,"f64",ia):q(va,ka,"f64",sa.get(ia)):ua.has(ia)?va=t(va,ka,"f64",ua.get(ia)):wa.has(ia)?va=wa.get(ia)(va,ka,"f64"):(va=va[0],xa=!1);xa&&ia!==z.localLogicalOperation.isNull&&!ra.has(ia)&&(xa=w.createEmptyBand(na,va.length),ka||(ka=(new Uint8Array(va.length)).fill(255)),qa(va,ka,na,xa),va=xa);da.push(va)}ba=ba[0];return new w({width:ba.width,height:ba.height,pixelType:na,mask:ia===z.localLogicalOperation.isNull?
null:ka,pixels:da})};m.operandsCount=[0,2,2,2,1,2,1,1,1,1,1,2,2,1,2,2,2,2,1,2,2,1,1,2,2,1,1,1,2,2,1,1,1,2,2,1,1,1,999,999,999,999,999,999,2,1,2,999,1,1,2,1,1,1,999,999,1,1,999,1,1,2,999,999,2,2,999,999,999,999,999,999,999,999,999,999,3,999,3];Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/MaskFunction":function(){define("../../../chunks/tslib.es6 ../../../core/mathUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./MaskFunctionArguments ./pixelUtils".split(" "),
function(m,w,z,N,D,S,Q,P,H,y){N=class extends P{constructor(){super(...arguments);this.functionName="Mask";this.functionArguments=null;this.rasterArgumentNames=["raster"]}_bindSourceRasters(){var u=this.sourceRasterInfos[0].clone();const {pixelType:c}=u;this.outputPixelType=this._getOutputPixelType(c);u.pixelType=this.outputPixelType;this.rasterInfo=u;const {includedRanges:e,normalizedNoDataValues:l}=this.functionArguments;if(!e?.length&&!l?.length)return{success:!1,supportsGPU:!1,error:"missing includedRanges or noDataValues argument"};
let q=[];for(let t=0;t<u.bandCount;t++){const h=y.createMaskLUT(c,e?.slice(2*t,2*t+2),l?.[t]);if(null==h){q=null;break}q.push(h)}this.lookups=q;u=null!=l&&l.every(t=>t?.length===l[0]?.length);return{success:!0,supportsGPU:(!e||e.length<=2*y.maxMapSizeGpu)&&(!l||u&&l[0].length<=y.maxMapSizeGpu)}}_processPixels(u){u=u.pixelBlocks?.[0];if(null==u)return null;const {outputPixelType:c,lookups:e}=this,{includedRanges:l,noDataInterpretation:q,normalizedNoDataValues:t}=this.functionArguments;return y.mask(u,
{includedRanges:l,noDataValues:t,outputPixelType:c,matchAll:q===y.NoDataInterpretation.matchAll,lookups:e})}_getWebGLParameters(){const {includedRanges:u,normalizedNoDataValues:c}=this.functionArguments,e=new Float32Array(y.maxMapSizeGpu);e.fill(w.numberMaxFloat32);c?.[0]?.length&&e.set(c[0]);const l=new Float32Array(y.maxMapSizeGpu);for(let q=0;q<l.length;q+=2)l[q]=u?.[q]??-w.numberMaxFloat32,l[q+1]=u?.[q+1]??w.numberMaxFloat32;u&&u.length&&l.set(u);return{bandCount:this.sourceRasterInfos[0].bandCount,
noDataValues:e,includedRanges:l}}};m.__decorate([z.property({json:{write:!0,name:"rasterFunction"}})],N.prototype,"functionName",void 0);m.__decorate([z.property({type:H,json:{write:!0,name:"rasterFunctionArguments"}})],N.prototype,"functionArguments",void 0);m.__decorate([z.property()],N.prototype,"rasterArgumentNames",void 0);m.__decorate([z.property({json:{write:!0}})],N.prototype,"lookups",void 0);return N=m.__decorate([Q.subclass("esri.layers.support.rasterFunctions.MaskFunction")],N)})},"esri/layers/support/rasterFunctions/MaskFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments ./pixelUtils".split(" "),
function(m,w,z,N,D,S,Q,P){var H;z=H=class extends Q{constructor(){super(...arguments);this.noDataValues=this.includedRanges=null;this.noDataInterpretation=P.NoDataInterpretation.matchAny}get normalizedNoDataValues(){var {noDataValues:y}=this;if(!y?.length)return null;let u=!1;y=y.map(c=>"number"===typeof c?(u=!0,[c]):"string"===typeof c?(c=c.trim().split(" ").filter(e=>""!==e.trim()).map(e=>Number(e)),u=u||0<c.length,0===c.length?null:c):null);return u?y:null}clone(){return new H({includedRanges:this.includedRanges?.slice()??
[],noDataValues:this.noDataValues?.slice()??[],noDataInterpretation:this.noDataInterpretation})}};m.__decorate([w.property({json:{write:!0}})],z.prototype,"includedRanges",void 0);m.__decorate([w.property({json:{write:!0}})],z.prototype,"noDataValues",void 0);m.__decorate([w.property()],z.prototype,"normalizedNoDataValues",null);m.__decorate([w.property({json:{write:!0}})],z.prototype,"noDataInterpretation",void 0);return z=H=m.__decorate([S.subclass("esri.layers.support.rasterFunctions.MaskFunctionArguments")],
z)})},"esri/layers/support/rasterFunctions/NDVIFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./bandIndexUtils ./BaseRasterFunction ./NDVIFunctionArguments".split(" "),function(m,w,z,N,D,S,Q,P,H){z=class extends P{constructor(){super(...arguments);this.functionName="NDVI";this.functionArguments=null;this.rasterArgumentNames=
["raster"]}_bindSourceRasters(){const {scientificOutput:y,visibleBandID:u,infraredBandID:c}=this.functionArguments;this.outputPixelType=this._getOutputPixelType(y?"f32":"u8");var e=this.sourceRasterInfos[0];const l=Math.max(u,c);if(2>e.bandCount||l>=e.bandCount)return{success:!1,supportsGPU:!1,error:"ndvi-function: source raster has insufficient amount of raster bands"};e=e.clone();e.pixelType=this.outputPixelType;e.colormap=null;e.histograms=null;e.bandCount=1;e.keyProperties={...e.keyProperties,
BandProperties:void 0};const [q,t,h,p]=y?[-1,1,0,.1]:[0,200,100,10];e.statistics=[{min:q,max:t,avg:h,stddev:p}];this.rasterInfo=e;return{success:!0,supportsGPU:!0}}_processPixels(y){y=y.pixelBlocks?.[0];if(null==y)return null;const {visibleBandID:u,infraredBandID:c,scientificOutput:e}=this.functionArguments;return Q.calculateNDVI(y,u,c,!e)}_getWebGLParameters(){const {visibleBandID:y,infraredBandID:u,scientificOutput:c}=this.functionArguments;return{bandIndexMat3:Q.getBandMatrix3(this.isInputBandIdsSwizzled?
[0,1,2]:[u,y,0]),scaled:!c}}_getInputBandIds(y){const {visibleBandID:u,infraredBandID:c}=this.functionArguments;return[c,u,0].map(e=>y[e])}};m.__decorate([w.property({json:{write:!0,name:"rasterFunction"}})],z.prototype,"functionName",void 0);m.__decorate([w.property({type:H,json:{write:!0,name:"rasterFunctionArguments"}})],z.prototype,"functionArguments",void 0);m.__decorate([w.property()],z.prototype,"rasterArgumentNames",void 0);return z=m.__decorate([S.subclass("esri.layers.support.rasterFunctions.NDVIFunction")],
z)})},"esri/layers/support/rasterFunctions/NDVIFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),function(m,w,z,N,D,S,Q){var P;z=P=class extends Q{constructor(){super(...arguments);this.visibleBandID=0;this.infraredBandID=1;this.scientificOutput=!1}clone(){const {visibleBandID:H,
infraredBandID:y,scientificOutput:u}=this;return new P({visibleBandID:H,infraredBandID:y,scientificOutput:u})}};m.__decorate([w.property({json:{write:!0}})],z.prototype,"visibleBandID",void 0);m.__decorate([w.property({json:{write:!0}})],z.prototype,"infraredBandID",void 0);m.__decorate([w.property({json:{write:!0}})],z.prototype,"scientificOutput",void 0);return z=P=m.__decorate([S.subclass("esri.layers.support.rasterFunctions.NDVIFunctionArguments")],z)})},"esri/layers/support/rasterFunctions/RemapFunction":function(){define("../../../chunks/tslib.es6 ../../../core/mathUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./pixelUtils ./RemapFunctionArguments".split(" "),
function(m,w,z,N,D,S,Q,P,H,y,u){N=class extends H{constructor(){super(...arguments);this.functionName="Remap";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.lookup=null}_bindSourceRasters(){const c=this.sourceRasterInfos[0].clone(),{pixelType:e}=c;this.outputPixelType=this._getOutputPixelType(e);c.pixelType=this.outputPixelType;c.colormap=null;c.histograms=null;c.bandCount=1;c.attributeTable=null;const {statistics:l}=c,{allowUnmatched:q,outputValues:t,inputRanges:h,noDataRanges:p,
isLastInputRangeInclusive:v}=this.functionArguments;if(null!=l&&l.length&&t?.length)if(q){var a=Math.min.apply(null,[...t,l[0].min]),g=Math.max.apply(null,[...t,l[0].max]);c.statistics=[{...l[0],min:a,max:g}]}else{g=a=t[0];for(let d=0;d<t.length;d++)a=a>t[d]?t[d]:a,g=g>t[d]?g:t[d];c.statistics=[{...l[0],min:a,max:g}]}this.rasterInfo=c;this.lookup=q?null:y.createRemapLUT({srcPixelType:e,inputRanges:h,outputValues:t,noDataRanges:p,allowUnmatched:q,isLastInputRangeInclusive:v,outputPixelType:this.outputPixelType});
return{success:!0,supportsGPU:(!t||t.length<=y.maxMapSizeGpu)&&(!p||p.length<=y.maxMapSizeGpu)}}_processPixels(c){c=c.pixelBlocks?.[0];if(null==c)return null;const {lookup:e,outputPixelType:l}=this;if(e){const a=y.lookupPixels(c,{lut:[e.lut],offset:e.offset,outputPixelType:l});null!=a&&e.mask&&(a.mask=y.lookupBandValues(c.pixels[0],c.mask,e.mask,e.offset,"u8"));return a}const {inputRanges:q,outputValues:t,noDataRanges:h,allowUnmatched:p,isLastInputRangeInclusive:v}=this.functionArguments;return y.remap(c,
{inputRanges:q,outputValues:t,noDataRanges:h,outputPixelType:l,allowUnmatched:p,isLastInputRangeInclusive:v})}_getWebGLParameters(){const {allowUnmatched:c,noDataRanges:e,isLastInputRangeInclusive:l}=this.functionArguments,q=new Float32Array(3*y.maxMapSizeGpu);var t=this.functionArguments.inputRanges??[],h=this.functionArguments.outputValues??[];const p=h.length;for(let v=0;v<y.maxMapSizeGpu;v++)if(q[3*v]=t[2*v]??w.numberMaxFloat32-1,q[3*v+1]=t[2*v+1]??w.numberMaxFloat32,q[3*v+2]=h[v]??0,v<p&&(0<
v&&(q[3*v]-=1E-5),v<p-1||!l))q[3*v+1]-=1E-5;t=new Float32Array(2*y.maxMapSizeGpu);t.fill(w.numberMaxFloat32);e?.length&&t.set(e);h=P.getPixelValueRange(this.outputPixelType);return{allowUnmatched:c,rangeMaps:q,noDataRanges:t,clampRange:h}}};m.__decorate([z.property({json:{write:!0,name:"rasterFunction"}})],N.prototype,"functionName",void 0);m.__decorate([z.property({type:u,json:{write:!0,name:"rasterFunctionArguments"}})],N.prototype,"functionArguments",void 0);m.__decorate([z.property()],N.prototype,
"rasterArgumentNames",void 0);m.__decorate([z.property({json:{write:!0}})],N.prototype,"lookup",void 0);return N=m.__decorate([Q.subclass("esri.layers.support.rasterFunctions.RemapFunction")],N)})},"esri/layers/support/rasterFunctions/RemapFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(m,w,z,N,D,S,Q){var P;z=P=class extends Q{constructor(){super(...arguments);this.noDataRanges=this.outputValues=this.inputRanges=null;this.isLastInputRangeInclusive=this.allowUnmatched=!1}clone(){return new P({inputRanges:[...this.inputRanges],outputValues:[...this.outputValues],noDataRanges:[...this.noDataRanges],allowUnmatched:this.allowUnmatched,isLastInputRangeInclusive:this.isLastInputRangeInclusive})}};m.__decorate([w.property({json:{write:!0}})],z.prototype,"inputRanges",void 0);m.__decorate([w.property({json:{write:!0}})],
z.prototype,"outputValues",void 0);m.__decorate([w.property({json:{write:!0}})],z.prototype,"noDataRanges",void 0);m.__decorate([w.property({json:{write:!0}})],z.prototype,"allowUnmatched",void 0);m.__decorate([w.property({json:{write:!0}})],z.prototype,"isLastInputRangeInclusive",void 0);return z=P=m.__decorate([S.subclass("esri.layers.support.rasterFunctions.RemapFunctionArguments")],z)})},"esri/layers/support/rasterFunctions/SlopeFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./SlopeFunctionArguments ./surfaceUtils".split(" "),
function(m,w,z,N,D,S,Q,P,H){z=class extends Q{constructor(){super(...arguments);this.functionName="Slope";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.isGCS=!1}_bindSourceRasters(){this.outputPixelType=this._getOutputPixelType("f32");const y=this.sourceRasterInfos[0].clone();y.pixelType=this.outputPixelType;y.statistics="percent-rise"!==this.functionArguments.slopeType?[{min:0,max:90,avg:1,stddev:1}]:null;y.histograms=null;y.colormap=null;y.attributeTable=null;y.bandCount=
1;this.rasterInfo=y;this.isGCS=y.spatialReference?.isGeographic??!1;return{success:!0,supportsGPU:!0}}_processPixels(y){const u=y.pixelBlocks?.[0];if(null==u)return null;const {zFactor:c,slopeType:e,pixelSizePower:l,pixelSizeFactor:q}=this.functionArguments,{isGCS:t}=this,{extent:h,primaryPixelSizes:p}=y;y=p?.[0];return H.slope(u,{zFactor:c,slopeType:e,pixelSizePower:l,pixelSizeFactor:q,isGCS:t,resolution:null==y?h?{x:h.width/u.width,y:h.height/u.height}:{x:1,y:1}:y})}_getWebGLParameters(){const {zFactor:y,
slopeType:u,pixelSizeFactor:c,pixelSizePower:e}=this.functionArguments;return{zFactor:this.isGCS&&1<=y?y*H.gcsFactor:y,slopeType:u,pixelSizeFactor:c??0,pixelSizePower:e??0}}};m.__decorate([w.property({json:{write:!0,name:"rasterFunction"}})],z.prototype,"functionName",void 0);m.__decorate([w.property({type:P,json:{write:!0,name:"rasterFunctionArguments"}})],z.prototype,"functionArguments",void 0);m.__decorate([w.property()],z.prototype,"rasterArgumentNames",void 0);m.__decorate([w.property({json:{write:!0}})],
z.prototype,"isGCS",void 0);return z=m.__decorate([S.subclass("esri.layers.support.rasterFunctions.SlopeFunction")],z)})},"esri/layers/support/rasterFunctions/SlopeFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/jsonMap ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(m,w,z,N,D,S,Q,P,H){var y;w=new w.JSONMap({1:"degree",2:"percent-rise",3:"adjusted"},{useNumericKeys:!0});H=y=class extends H{constructor(){super(...arguments);this.slopeType="degree";this.zFactor=1;this.pixelSizePower=.664;this.pixelSizeFactor=.024;this.removeEdgeEffect=!1}clone(){return new y({slopeType:this.slopeType,zFactor:this.zFactor,pixelSizePower:this.pixelSizePower,pixelSizeFactor:this.pixelSizeFactor,removeEdgeEffect:this.removeEdgeEffect,raster:this.raster})}};m.__decorate([Q.enumeration(w)],
H.prototype,"slopeType",void 0);m.__decorate([z.property({type:Number,json:{write:!0}})],H.prototype,"zFactor",void 0);m.__decorate([z.property({type:Number,json:{name:"psPower",write:!0}})],H.prototype,"pixelSizePower",void 0);m.__decorate([z.property({type:Number,json:{name:"psZFactor",write:!0}})],H.prototype,"pixelSizeFactor",void 0);m.__decorate([z.property({type:Boolean,json:{write:!0}})],H.prototype,"removeEdgeEffect",void 0);return H=y=m.__decorate([P.subclass("esri.layers.support.rasterFunctions.SlopeFunctionArguments")],
H)})},"esri/layers/support/rasterFunctions/StatisticsFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./focalStatUtils ./StatisticsFunctionArguments".split(" "),function(m,w,z,N,D,S,Q,P,H,y){const u=new Set("min max mean median majority minority".split(" "));
z=class extends P{constructor(){super(...arguments);this.functionName="Statistics";this.rasterArgumentNames=["raster"]}_bindSourceRasters(){const {type:c}=this.functionArguments.toJSON();if(1>c||7<c)return{success:!1,supportsGPU:!1,error:`statistics-function: the given statistics type is not supported ${c}`};var e=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType(e.pixelType);e=e.clone();e.pixelType=this.outputPixelType;const {statisticsType:l}=this.functionArguments;u.has(l)||
(e.statistics=null,e.histograms=null,e.colormap=null,e.attributeTable=null);this.rasterInfo=e;return{success:!0,supportsGPU:3>=e.bandCount&&5>c}}_processPixels(c){c=c.pixelBlocks?.[0];if(null==c)return c;const {statisticsType:e,rows:l,cols:q,fillNoDataOnly:t}=this.functionArguments;return H.computeFocalStatistics(c,{kernelRows:l,kernelCols:q,fillNoDataOnly:t,outputPixelType:this.outputPixelType,statisticsType:e,mirrorEdges:!0})}_getWebGLParameters(){const {rows:c,cols:e,statisticsType:l,fillNoDataOnly:q}=
this.functionArguments;return{fillNoDataOnly:q,kernelRows:c,kernelCols:e,statisticsType:l,clampRange:Q.getPixelValueRange(this.outputPixelType)}}};m.__decorate([w.property({json:{write:!0,name:"rasterFunction"}})],z.prototype,"functionName",void 0);m.__decorate([w.property({type:y,json:{write:!0,name:"rasterFunctionArguments"}})],z.prototype,"functionArguments",void 0);m.__decorate([w.property()],z.prototype,"rasterArgumentNames",void 0);return z=m.__decorate([S.subclass("esri.layers.support.rasterFunctions.StatisticsFunction")],
z)})},"esri/layers/support/rasterFunctions/focalStatUtils":function(){define(["exports","../../../core/has","../../../core/jsonMap","../PixelBlock","./mirror"],function(m,w,z,N,D){function S(Q,P){const {fillNoDataOnly:H}=P,{band:y,width:u,height:c,mask:e,outBand:l}=Q;if(H&&!e)l.set(y);else{var {kernelRows:q,kernelCols:t}=P;Q=Math.floor(q/2);P=Math.floor(t/2);var h=l.slice(),p=new Uint32Array(u*c);for(var v=Q;v<c-Q;v++){var a=v*u;for(var g=P;g<u-P;g++){if(H&&e&&e[a+g])continue;const d=[];for(let b=
0;b<q;b++)for(let f=0;f<t;f++){const k=a+g+(b-Q)*u+f-P;e&&!e[k]||d.push(y[k])}d.length&&(d.sort((b,f)=>b-f),e?(h[a+g]=d[Math.floor((d.length-1)/2)],p[a+g]=d.length):l[a+g]=d[Math.floor((d.length-1)/2)])}}if(e)for(v=Q;v<c-Q;v++)for(a=v*u,g=P;g<u-P;g++)!p[a+g]||H&&e[a+g]||(l[a+g]=h[a+g],e[a+g]=255)}}w=new z.JSONMap({1:"min",2:"max",3:"mean",4:"stddev",5:"median",6:"majority",7:"minority"},{useNumericKeys:!0});m.computeFocalStatistics=function(Q,P){const {mask:H}=Q,{fillNoDataOnly:y}=P;if(y&&!H)return Q;
const {pixels:u,width:c,height:e,bandMasks:l,pixelType:q}=Q,t=u.length,h=c*e,p=[],{kernelRows:v,kernelCols:a,statisticsType:g,mirrorEdges:d}=P;if(y&&!H)return Q;const b=P.outputPixelType??q,f=[];for(let C=0;C<t;C++){const E=u[C],I=N.createEmptyBand(b,h);y&&I.set(E);const M=(l?.[C]??H)?.slice()??null,U={band:E,width:c,height:e,mask:M,outBand:I};switch(g){case "min":case "max":a:{var k=P;const {fillNoDataOnly:F}=k,{band:x,width:K,height:J,mask:G,outBand:O}=U;if(F&&!G){O.set(x);break a}const {kernelRows:R,
kernelCols:T,statisticsType:X}=k,L=Math.floor(R/2),V=Math.floor(T/2),W="min"===X,Y=O.slice(),Z=new Uint32Array(K*J);for(let aa=L;aa<J-L;aa++){const fa=aa*K;for(let ea=V;ea<K-V;ea++){let ca=W?Number.MAX_VALUE:-Number.MAX_VALUE,ja=0;for(let la=0;la<R;la++)for(let oa=0;oa<T;oa++){const pa=fa+ea+(la-L)*K+oa-V;if(!G||G[pa])ca=W?Math.min(ca,x[pa]):Math.max(ca,x[pa]),ja++}G?(Y[fa+ea]=0===ja?0:ca,Z[fa+ea]=ja):O[fa+ea]=0===ja?0:ca}}if(G)for(let aa=L;aa<J-L;aa++){const fa=aa*K;for(let ea=V;ea<K-V;ea++)!Z[fa+
ea]||F&&G[fa+ea]||(O[fa+ea]=Y[fa+ea],G[fa+ea]=255)}}break;case "mean":case "stddev":a:{var r=P;const {fillNoDataOnly:F}=r,{band:x,width:K,height:J,mask:G,outBand:O}=U;if(F&&!G){O.set(x);break a}const {statisticsType:R,kernelRows:T,kernelCols:X}=r,L="stddev"===R,V=K*J,W=new Float64Array(V),Y=new Float64Array(V),Z=new Uint32Array(V);for(let oa=0;oa<J;oa++){const pa=oa*K;let qa=0,ra=0,sa=0;for(let ua=0;ua<X;ua++)if(!G||G[pa+ua])qa+=x[pa+ua],L&&(ra+=x[pa+ua]**2),sa++;W[pa]=qa;Y[pa]=ra;Z[pa]=sa;for(let ua=
1;ua<=K-X;ua++){const ma=pa+ua-1,wa=ma+X;G?(G[ma]&&(sa--,qa-=x[ma],L&&(ra-=x[ma]**2)),G[wa]&&(sa++,qa+=x[wa],L&&(ra+=x[wa]**2))):(qa-=x[ma],qa+=x[wa],L&&(ra-=x[ma]**2,ra+=x[wa]**2));W[pa+ua]=qa;Z[pa+ua]=sa;L&&(Y[pa+ua]=ra)}}const aa=new Float64Array(V),fa=new Float64Array(V),ea=new Uint32Array(V),ca=T*K;for(let oa=0;oa<=K-X;oa++){let pa=0,qa=0,ra=0;for(let sa=0;sa<T;sa++){const ua=sa*K+oa;pa+=W[ua];ra+=Z[ua];L&&(qa+=Y[ua])}aa[oa]=pa;fa[oa]=qa;ea[oa]=ra;for(let sa=1;sa<=J-T;sa++){const ua=(sa-1)*K+
oa,ma=ua+ca;pa-=W[ua];pa+=W[ma];ra-=Z[ua];ra+=Z[ma];L&&(qa-=Y[ua],qa+=Y[ma]);aa[sa*K+oa]=pa;fa[sa*K+oa]=qa;ea[sa*K+oa]=ra}}const ja=Math.floor(T/2),la=Math.floor(X/2);for(let oa=ja;oa<J-ja;oa++){const pa=oa*K;for(let qa=la;qa<K-la;qa++){const ra=(oa-ja)*K+qa-la,sa=ea[ra];if(0===sa||F&&(!G||G[pa+qa]))continue;const ua=aa[ra]/sa;O[pa+qa]=L?Math.sqrt((fa[ra]-aa[ra]*ua)/sa):ua;G&&(G[pa+qa]=255)}}}break;case "median":S(U,P);break;case "majority":case "minority":a:{var B=P;const {fillNoDataOnly:F}=B,{band:x,
width:K,height:J,mask:G,outBand:O}=U;if(F&&!G){O.set(x);break a}const {kernelRows:R,kernelCols:T}=B,X=Math.floor(R/2),L=Math.floor(T/2),V="majority"===B.statisticsType,W=R*T,Y=O.slice(),Z=new Uint32Array(K*J);for(let aa=X;aa<J-X;aa++){const fa=aa*K;for(let ea=L;ea<K-L;ea++){if(F&&G&&G[fa+ea])continue;const ca=new Map;for(let pa=0;pa<R;pa++)for(let qa=0;qa<T;qa++){const ra=fa+ea+(pa-X)*K+qa-L;if(G&&!G[ra])continue;const sa=x[ra];ca.set(sa,ca.has(sa)?ca.get(sa)+1:1)}if(0===ca.size)continue;let ja=0,
la=0,oa=V?0:W+1;for(const pa of ca.keys())la=ca.get(pa),V===la>oa&&(oa=la,ja=pa);G?(Y[fa+ea]=ja,Z[fa+ea]=ca.size):O[fa+ea]=ja}}if(G)for(let aa=X;aa<J-X;aa++){const fa=aa*K;for(let ea=L;ea<K-L;ea++)!Z[fa+ea]||F&&G[fa+ea]||(O[fa+ea]=Y[fa+ea],G[fa+ea]=255)}}}d&&!y&&D.mirror(I,c,e,v,a);p.push(I);M&&f.push(M)}let A=f[0]??H;f.length!==t&&(f.length=0);if(1<t&&l?.length){A=new Uint8Array(h);A.set(f[0]);for(let C=1;C<l.length;C++){const E=l[C];for(let I=0;I<E.length;I++)0===E[I]&&(A[I]=0)}}const n=new N({pixelType:b,
width:c,height:e,pixels:p,bandMasks:l&&f.length?f:null,mask:A});n.updateStatistics();return n};m.statisticsTypeMap=w;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/StatisticsFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments ./focalStatUtils".split(" "),
function(m,w,z,N,D,S,Q,P){var H;N=H=class extends Q{constructor(){super(...arguments);this.cols=this.rows=3;this.fillNoDataOnly=!1;this.statisticsType="min"}clone(){return new H({rows:this.rows,cols:this.cols,fillNoDataOnly:this.fillNoDataOnly,statisticsType:this.statisticsType,raster:w.clone(this.raster)})}};m.__decorate([z.property({json:{write:!0,read:{source:["kernelRows","rows"],reader:(y,u)=>Number(y??u?.kernelRows??3)}}})],N.prototype,"rows",void 0);m.__decorate([z.property({json:{write:!0,
read:{source:["kernelCols","cols"],reader:(y,u)=>Number(y??u?.kernelCols??3)}}})],N.prototype,"cols",void 0);m.__decorate([z.property({json:{write:!0}})],N.prototype,"fillNoDataOnly",void 0);m.__decorate([z.property({json:{read:{source:["statisticsType","type"],reader:(y,u)=>P.statisticsTypeMap.fromJSON(u?.statisticsType??u?.type)??"min"},write:{target:"type"}}}),D.enumeration(P.statisticsTypeMap)],N.prototype,"statisticsType",void 0);return N=H=m.__decorate([S.subclass("esri.layers.support.rasterFunctions.StatisticsFunctionArguments")],
N)})},"esri/layers/support/rasterFunctions/StatisticsHistogramFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./StatisticsHistogramFunctionArguments".split(" "),function(m,w,z,N,D,S,Q,P){z=class extends Q{constructor(){super(...arguments);this.functionName="StatisticsHistogram";this.functionArguments=
null;this.rasterArgumentNames=["raster"];this.isNoopProcess=!0}_bindSourceRasters(){var H=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType("u8");H=H.clone();const {statistics:y,histograms:u}=this.functionArguments;u&&(H.histograms=u);y&&(H.statistics=y);this.rasterInfo=H;return{success:!0,supportsGPU:!0}}_processPixels(H){return H.pixelBlocks?.[0]}};m.__decorate([w.property({json:{write:!0,name:"rasterFunction"}})],z.prototype,"functionName",void 0);m.__decorate([w.property({type:P,
json:{write:!0,name:"rasterFunctionArguments"}})],z.prototype,"functionArguments",void 0);m.__decorate([w.property()],z.prototype,"rasterArgumentNames",void 0);m.__decorate([w.property({json:{write:!0}})],z.prototype,"indexedColormap",void 0);m.__decorate([w.property()],z.prototype,"isNoopProcess",void 0);return z=m.__decorate([S.subclass("esri.layers.support.rasterFunctions.StatisticsHistogramFunction")],z)})},"esri/layers/support/rasterFunctions/StatisticsHistogramFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseFunctionArguments".split(" "),
function(m,w,z,N,D,S,Q,P){var H;N=H=class extends P{constructor(){super(...arguments);this.histograms=this.statistics=null}readStatistics(y,u){if(!y?.length)return null;const c=[];y.forEach(e=>{c.push({min:e.min,max:e.max,avg:e.avg??e.mean,stddev:e.stddev??e.standardDeviation})});return c}writeStatistics(y,u,c){if(y?.length){var e=[];y.forEach(l=>{l={...l,mean:l.avg,standardDeviation:l.stddev};delete l.avg;delete l.stddev;e.push(l)});u[c]=e}}clone(){return new H({statistics:w.clone(this.statistics),
histograms:w.clone(this.histograms)})}};m.__decorate([z.property({json:{write:!0}})],N.prototype,"statistics",void 0);m.__decorate([D.reader("statistics")],N.prototype,"readStatistics",null);m.__decorate([Q.writer("statistics")],N.prototype,"writeStatistics",null);m.__decorate([z.property({json:{write:!0}})],N.prototype,"histograms",void 0);return N=H=m.__decorate([S.subclass("esri.layers.support.rasterFunctions.StatisticsHistogramFunctionArguments")],N)})},"esri/layers/support/rasterFunctions/StretchFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./pixelUtils ./StretchFunctionArguments ./stretchUtils".split(" "),
function(m,w,z,N,D,S,Q,P,H,y){z=class extends Q{constructor(){super(...arguments);this.functionName="Stretch";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.cutOffs=this.lookup=null}_bindSourceRasters(){this.cutOffs=this.lookup=null;var u=this.sourceRasterInfos[0];const {pixelType:c}=u;var {functionArguments:e}=this;const {dynamicRangeAdjustment:l,gamma:q,useGamma:t}=e;if(!l&&["u8","u16","s8","s16"].includes(c)){e=y.getStretchCutoff(e.toJSON(),{rasterInfo:u});const h=this._isOutputRoundingNeeded()?
"round":"float";this.lookup=y.createStretchLUT({pixelType:c,...e,gamma:t?q:null,rounding:h});this.cutOffs=e}else l||(this.cutOffs=y.getStretchCutoff(e.toJSON(),{rasterInfo:u}));this.outputPixelType=this._getOutputPixelType(c);u=u.clone();u.pixelType=this.outputPixelType;u.statistics=null;u.histograms=null;u.colormap=null;u.attributeTable=null;"u8"===this.outputPixelType&&(u.keyProperties.DataType="processed");this.rasterInfo=u;return{success:!0,supportsGPU:!l}}_processPixels(u){u=u.pixelBlocks?.[0];
if(null==u)return u;var {lookup:c}=this;if(c)return P.lookupPixels(u,{...c,outputPixelType:this.rasterInfo.pixelType});({functionArguments:c}=this);const e=this.cutOffs||y.getStretchCutoff(c.toJSON(),{rasterInfo:this.sourceRasterInfos[0],pixelBlock:u});return y.stretch(u,{...e,gamma:c.useGamma?c.gamma:null,outputPixelType:this.outputPixelType})}_getWebGLParameters(){const {outputMin:u=0,outputMax:c=255,gamma:e,useGamma:l}=this.functionArguments,q=2<=this.rasterInfo.bandCount?3:1,t=l&&e?.length?y.computeGammaCorrection(q,
e):[1,1,1],{minCutOff:h,maxCutOff:p}=this.cutOffs??{minCutOff:[0,0,0],maxCutOff:[255,255,255]};1===h.length&&(h[1]=h[2]=h[0],p[1]=p[2]=p[0]);const v=new Float32Array(q);var a;for(a=0;a<q;a++)v[a]=(c-u)/(p[a]-h[a]);a=this._isOutputRoundingNeeded();return{bandCount:q,outMin:u,outMax:c,minCutOff:h,maxCutOff:p,factor:v,useGamma:l,gamma:l&&e?e:[1,1,1],gammaCorrection:l&&t?t:[1,1,1],stretchType:this.functionArguments.stretchType,isOutputRounded:a,type:"stretch"}}};m.__decorate([w.property({json:{write:!0,
name:"rasterFunction"}})],z.prototype,"functionName",void 0);m.__decorate([w.property({type:H,json:{write:!0,name:"rasterFunctionArguments"}})],z.prototype,"functionArguments",void 0);m.__decorate([w.property()],z.prototype,"rasterArgumentNames",void 0);m.__decorate([w.property({json:{write:!0}})],z.prototype,"lookup",void 0);m.__decorate([w.property({json:{write:!0}})],z.prototype,"cutOffs",void 0);return z=m.__decorate([S.subclass("esri.layers.support.rasterFunctions.StretchFunction")],z)})},"esri/layers/support/rasterFunctions/StretchFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/jsonMap ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseFunctionArguments".split(" "),
function(m,w,z,N,D,S,Q,P,H){var y;w=new w.JSONMap({0:"none",3:"standard-deviation",4:"histogram-equalization",5:"min-max",6:"percent-clip",9:"sigmoid"},{useNumericKeys:!0});H=y=class extends H{constructor(){super(...arguments);this.dynamicRangeAdjustment=this.computeGamma=!1;this.gamma=[];this.statistics=this.histograms=null;this.stretchType="none";this.useGamma=!1}writeStatistics(u,c,e){u?.length&&(Array.isArray(u[0])||(u=u.map(l=>[l.min,l.max,l.avg,l.stddev])),c[e]=u)}clone(){return new y({stretchType:this.stretchType,
outputMin:this.outputMin,outputMax:this.outputMax,useGamma:this.useGamma,computeGamma:this.computeGamma,statistics:z.clone(this.statistics),gamma:z.clone(this.gamma),sigmoidStrengthLevel:this.sigmoidStrengthLevel,numberOfStandardDeviations:this.numberOfStandardDeviations,minPercent:this.minPercent,maxPercent:this.maxPercent,histograms:z.clone(this.histograms),dynamicRangeAdjustment:this.dynamicRangeAdjustment,raster:this.raster})}};m.__decorate([N.property({type:Boolean,json:{write:!0}})],H.prototype,
"computeGamma",void 0);m.__decorate([N.property({type:Boolean,json:{name:"dra",write:!0}})],H.prototype,"dynamicRangeAdjustment",void 0);m.__decorate([N.property({type:[Number],json:{write:!0}})],H.prototype,"gamma",void 0);m.__decorate([N.property()],H.prototype,"histograms",void 0);m.__decorate([N.property({type:Number,json:{write:!0}})],H.prototype,"maxPercent",void 0);m.__decorate([N.property({type:Number,json:{write:!0}})],H.prototype,"minPercent",void 0);m.__decorate([N.property({type:Number,
json:{write:!0}})],H.prototype,"numberOfStandardDeviations",void 0);m.__decorate([N.property({type:Number,json:{name:"max",write:!0}})],H.prototype,"outputMax",void 0);m.__decorate([N.property({type:Number,json:{name:"min",write:!0}})],H.prototype,"outputMin",void 0);m.__decorate([N.property({type:Number,json:{write:!0}})],H.prototype,"sigmoidStrengthLevel",void 0);m.__decorate([N.property({json:{type:[[Number]],write:!0}})],H.prototype,"statistics",void 0);m.__decorate([P.writer("statistics")],H.prototype,
"writeStatistics",null);m.__decorate([S.enumeration(w)],H.prototype,"stretchType",void 0);m.__decorate([N.property({type:Boolean,json:{write:!0}})],H.prototype,"useGamma",void 0);return H=y=m.__decorate([Q.subclass("esri.layers.support.rasterFunctions.StretchFunctionArguments")],H)})},"esri/layers/support/rasterFunctions/TableFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./TableFunctionArguments".split(" "),
function(m,w,z,N,D,S,Q,P){z=class extends Q{constructor(){super(...arguments);this.functionName="Table";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.isNoopProcess=!0}_bindSourceRasters(){var H=this.sourceRasterInfos[0];if(1<H.bandCount||H.pixelType.startsWith("f"))return{success:!1,supportsGPU:!1,error:"table-function: Source data must be single band and integer pixel type."};const {attributeTableAsRecordSet:y}=this.functionArguments;if(!y)return{success:!1,supportsGPU:!1,
error:"table-function: Missing attributeTableAsRecordSet argument."};this.outputPixelType=this._getOutputPixelType(H.pixelType);H=H.clone();H.pixelType=this.outputPixelType;H.bandCount=1;"thematic"!==H.dataType&&(H.keyProperties=H.keyProperties?{...H.keyProperties,DataType:"thematic"}:{DataType:"thematic"});this.rasterInfo=H;return{success:!0,supportsGPU:!0}}_processPixels(H){return H.pixelBlocks?.[0]}};m.__decorate([w.property({json:{write:!0,name:"rasterFunction"}})],z.prototype,"functionName",
void 0);m.__decorate([w.property({type:P,json:{write:!0,name:"rasterFunctionArguments"}})],z.prototype,"functionArguments",void 0);m.__decorate([w.property()],z.prototype,"rasterArgumentNames",void 0);m.__decorate([w.property()],z.prototype,"isNoopProcess",void 0);return z=m.__decorate([S.subclass("esri.layers.support.rasterFunctions.TableFunction")],z)})},"esri/layers/support/rasterFunctions/TableFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(m,w,z,N,D,S){var Q;N=Q=class extends S{constructor(){super(...arguments);this.attributeTableAsRecordSet=null}clone(){return new Q({attributeTableAsRecordSet:w.clone(this.attributeTableAsRecordSet)})}};m.__decorate([z.property({json:{write:!0}})],N.prototype,"attributeTableAsRecordSet",void 0);return N=Q=m.__decorate([D.subclass("esri.layers.support.rasterFunctions.TableFunctionArguments")],N)})},"esri/renderers/support/rasterRendererHelper":function(){define("exports ../../Color ../../rasterRenderers ../../core/unitUtils ../../layers/support/Field ../FlowRenderer ./AuthoringInfo ./ClassBreakInfo ./colorRampUtils ./rasterRendererChecks ./UniqueValueInfo ../../rest/support/ClassBreaksDefinition ../../rest/support/generateRendererUtils ../../rest/support/MultipartColorRamp ../RasterStretchRenderer ../UniqueValueRenderer ../RasterColormapRenderer ../RasterShadedReliefRenderer ../ClassBreaksRenderer ../VectorFieldRenderer".split(" "),
function(m,w,z,N,D,S,Q,P,H,y,u,c,e,l,q,t,h,p,v,a){function g(G,O){G=d(G,O?.variableName);const {bandCount:R}=G;let {bandIds:T,stretchType:X}=O||{};T?.some(Z=>Z>=R)&&(T=null);let L=G.statistics,V=G.histograms;1<R?(T=T?.length?T:b(G),L=null==L?null:T?.map(Z=>L[Z]),V=null==V?null:T?.map(Z=>V[Z])):T=[0];null==X&&(X=k(G));let W=!1;switch(X){case "none":W=!1;break;case "percent-clip":W=!V?.length;break;default:W=!L?.length}var {dataType:Y}=G;Y=1===T?.length&&K.has(Y)?F:null;Y=new q({stretchType:X,dynamicRangeAdjustment:W,
colorRamp:Y,outputMin:0,outputMax:255,gamma:1===T?.length?[1]:[1,1,1],useGamma:!1});"percent-clip"===X?Y.maxPercent=Y.minPercent=.25:"standard-deviation"===X&&(Y.numberOfStandardDeviations=2);if(!W&&(null!=G.multidimensionalInfo||O?.includeStatisticsInStretch))if("percent-clip"===X)Y.histograms=V;else if("min-max"===X||"standard-deviation"===X)Y.statistics=L;return Y}function d(G,O){var {multidimensionalInfo:R}=G;if(!O||!R)return G;R=R.variables.find(T=>T.name===O);if(!R)return G;G=G.clone();if(R){const {statistics:T,
histograms:X}=R;T?.length&&(G.statistics=T.map(L=>({min:L.min,max:L.max,avg:L.avg,stddev:L.stddev})));X?.length&&(G.histograms=X)}return G}function b(G){const O=G.bandCount;if(1===O)return null;if(2===O)return[0];({bandInfos:G}=G);let R;if(G.length===O){const {red:T,green:X,blue:L,nir:V}=f(G);null!=T&&null!=X&&null!=L?R=[T,X,L]:null!=V&&null!=T&&null!=X&&(R=[V,T,X])}!R&&3<=O&&(R=[0,1,2]);return R}function f(G){const O={};for(let X=0;X<G.length;X++){var R=G[X],T=R.name.toLowerCase();"red"===T?O.red=
X:"green"===T?O.green=X:"blue"===T?O.blue=X:"nearinfrared"===T||"nearinfrared_1"===T||"nir"===T?O.nir=X:R.maxWavelength&&R.minWavelength&&(T=R.minWavelength,R=R.maxWavelength,null==O.blue&&410<=T&&480>=T&&480<=R&&540>=R?O.blue=X:null==O.green&&490<=T&&560>=T&&560<=R&&610>=R?O.green=X:null==O.red&&595<=T&&670>=T&&660<=R&&730>=R?O.red=X:null==O.nir&&700<=T&&860>=T&&800<=R&&950>=R&&(O.nir=X))}return O}function k(G){let O="percent-clip";const {pixelType:R,dataType:T,histograms:X,statistics:L,multidimensionalInfo:V}=
G;G=K.has(T)||"generic"===T&&null!=V;"u8"!==R||"processed"!==T&&null!=X&&null!=L?"u8"===R||"elevation"===T||G?O="min-max":null!=X?O="percent-clip":null!=L&&(O="min-max"):O="none";return O}function r(G,O,R,T){if(!y.isUVRendererSupported(G,O))return null;const {attributeTable:X,statistics:L}=G,V=B(X,O),W=n(X,"red"),Y=n(X,"green"),Z=n(X,"blue");G=new Q;const aa=[],fa=new Set,ea=!!(W&&Y&&Z);if(null!=X)X.features.forEach(ca=>{var ja=ca.attributes[V.name];fa.has(ca.attributes[V.name])||null==ja||(fa.add(ja),
ja=!ea||"single"!==W.type&&"double"!==W.type||"single"!==Y.type&&"double"!==Y.type||"single"!==Z.type&&"double"!==Z.type||X.features.some(la=>1<la.attributes[W.name]||1<la.attributes[Y.name]||1<la.attributes[Z.name])?1:255,aa.push(new u({value:ca.attributes[V.name],label:ca.attributes[V.name]+"",symbol:{type:"simple-fill",style:"solid",outline:null,color:ea?new w([ca.attributes[W.name]*ja,ca.attributes[Y.name]*ja,ca.attributes[Z.name]*ja,1]):new w([0,0,0,0])}})))});else if(L?.[0])for(O=L[0].min;O<=
L[0].max;O++)aa.push(new u({value:O,label:O.toString(),symbol:{type:"simple-fill",style:"solid",outline:null,color:new w([0,0,0,0])}}));aa.sort((ca,ja)=>ca.value&&"string"===typeof ca.value.valueOf()?0:ca.value>ja.value?1:-1);if(!ea){const ca=H.convertColorRampToColormap(x,{numColors:aa.length});aa.forEach((ja,la)=>ja.symbol.color=new w(ca[la].slice(1,4)));G.colorRamp=x}if(R||T){const ca=R||H.convertColorRampToColormap(T,{numColors:aa.length}).map(ja=>ja.slice(1));aa.forEach((ja,la)=>ja.symbol.color=
new w(ca[la]));G.colorRamp=T}return new t({field:V.name,uniqueValueInfos:aa,authoringInfo:G})}function B(G,O,R){let T;null!=G?(T=O?G.fields.find(X=>O.toLowerCase()===X.name.toLowerCase()):A(G.fields),T||(R||(T=G.fields.find(X=>"string"===X.type)),T||(T=n(G,"value")))):T=new D({name:"value"});return T}function A(G){let O;for(let R=0;R<G.length;R++){const T=G[R].name.toLowerCase();if("string"===G[R].type){if(T.startsWith("class")){O=G[R];break}null==O&&(T.endsWith("name")||T.endsWith("type"))&&(O=G[R])}}return O}
function n(G,O){return null==G?null:G.fields.find(R=>R.name.toLowerCase()===O)}function C(G){if(!y.isColormapRendererSupported(G))return null;let O;const {attributeTable:R,colormap:T}=G;if(null!=R){const X=n(R,"value"),L=B(R,null,!0);"string"===L.type&&(O={},R.features.forEach(V=>{V=V.attributes;O[V[X.name]]=L?V[L.name]:V[X.name]}))}return h.createFromColormap(T,O)}function E(G,O,R){let T=0,X=0;null!=G.attributeTable?(G=G.attributeTable,T=X=G.features[0].attributes[O.name],G.features.forEach(L=>{L=
L.attributes[O.name];L<T&&(T=L);L>X&&(X=L)})):null!=G.histograms&&(G=G.histograms,T=G[0].min,X=G[0].max);return(X-T)/R}function I(G){if(!y.isVectorFieldRendererSupported(G))return null;if(null!=G.statistics&&G.statistics.length&&("vector-magdir"===G.dataType||"vector-uv"===G.dataType)){const {minMagnitude:R,maxMagnitude:T}=U(G.dataType,G.statistics);var O=[{type:"size",field:"Magnitude",minSize:10,maxSize:40,minDataValue:R,maxDataValue:T}]}G=null!=G.multidimensionalInfo?J.get(G.multidimensionalInfo.variables[0].unit):
null;O=new a({visualVariables:O,inputUnit:G,rotationType:"geographic"});O.visualVariables=[...O.sizeVariables,...O.rotationVariables];return O}function M(G){return{color:G.symbolLayers[0].material?.color,type:"esriSFS",style:"esriSFSSolid"}}function U(G,O){if("vector-magdir"===G)G=O[0].min,O=O[0].max;else{const R=O[0].min,T=O[0].max,X=O[1].min;O=O[1].max;G=0;O=Math.max(Math.abs(R),Math.abs(X),Math.abs(T),Math.abs(O))}return{minMagnitude:G,maxMagnitude:O}}const F=l.fromJSON({type:"multipart",colorRamps:[{fromColor:[0,
0,255],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]}]}),x=l.fromJSON(H.predefinedJsonColorRamps[0]),K=new Set("scientific standard-time vector-uv vector-magdir vector-u vector-v vector-magnitude vector-direction".split(" ")),J=new Map([["m/s","meter-per-second"],["km/h","kilometer-per-hour"],["knots","knots"],["ft/s","feet-per-second"],["mph","mile-per-hour"]]);m.createClassBreaksRenderer=function(G,O){G=d(G,O?.variableName);const {attributeTable:R}=
G;if(!y.isClassBreaksSupported(G))return null;const T=null!=G.histograms?G.histograms[0]:null,X=null!=O?.numClasses&&isFinite(O?.numClasses)?O.numClasses:5,L=new Q({classificationMethod:O?.classificationMethod,colorRamp:O?.colorRamp});let V=O?.field||"value";const W=[],Y=[],Z=null!=R,aa=Z&&R.fields.find(la=>"count"===la.name.toLowerCase()),fa=Z?R.fields.find(la=>la.name.toLowerCase()===V.toLowerCase()):void 0;if(fa&&Z){V=fa.name;const la=R.features.length;let oa=0;R.features.forEach(pa=>oa+=(aa?pa.attributes[aa.name]:
50)/la);R.features.forEach(pa=>{const qa=pa.attributes[fa.name];pa=aa?pa.attributes[aa.name]:50;if(0<pa){Y.push(pa);pa=Math.max(1,Math.round(pa/la/oa*1E3));for(let ra=0;ra<pa;ra++)W.push(qa)}})}else{var {pixelType:ea}=G;const la=(T.max-T.min)/T.size,oa=(ea=ea.includes("s")||ea.includes("u"))&&1===la?Math.floor(T.min+.5):T.min,pa=ea&&1===la?Math.floor(T.max-.5):T.max,qa=T.size;let ra=0,sa;T.counts.forEach(ua=>ra+=ua/qa);T.counts.forEach((ua,ma)=>{if(0<ua)for(Y.push(ua),ua=Math.max(1,Math.round(ua/
qa/ra*1E3)),sa=Z?R.features[ma].attributes[fa.name]:0===ma?oa:ma===qa-1?pa:T.min+la*(ma+.5),ma=0;ma<ua;ma++)W.push(sa)})}ea=O?.classificationMethod||"natural-breaks";let ca=O?.definedInterval;"defined-interval"!==ea||ca||(ca=E(G,fa,X));G=e.createGenerateRendererClassBreaks({values:W,valueFrequency:Y,normalizationTotal:null,definition:new c({classificationMethod:ea,breakCount:X,definedInterval:ca})});let ja=O?.colors;ja||(O=O?.colorRamp||F,L.colorRamp=O,ja=H.convertColorRampToColormap(O,{numColors:G.classBreaks.length,
interpolateAlpha:!0}).map(la=>la.slice(1)));O=G.classBreaks.map((la,oa)=>new P({minValue:la.minValue,maxValue:la.maxValue,label:la.label,symbol:{type:"simple-fill",color:ja[oa]}}));return new v({field:V,classBreakInfos:O,authoringInfo:L})};m.createColormapRenderer=C;m.createDefaultRenderer=function(G,O){const {attributeTable:R,colormap:T}=G;if(y.isVectorFieldRendererSupported(G)){var X=I(G);if(null!=X)return X}return null!=T&&(X=C(G),null!=X)||null!=R&&(X=r(G),null!=X)?X:g(G,O)};m.createFlowRenderer=
function(G){if(!y.isFlowRendererSupported(G))return null;let O;if(null!=G.statistics&&0<G.statistics.length&&("vector-magdir"===G.dataType||"vector-uv"===G.dataType)){const {minMagnitude:R,maxMagnitude:T}=U(G.dataType,G.statistics);O=[{type:"color",field:"Magnitude",stops:[{value:R,color:"#1020C0"},{value:T,color:"#C02010"}]}]}return new S({visualVariables:O})};m.createShadedReliefRenderer=function(G,O="traditional"){if(!y.isShadedReliefRendererSupported(G))return null;({extent:G}=G);G=G.width*N.getMetersPerUnitForSR(G.spatialReference);
return new p({hillshadeType:O,scalingType:5E6<G?"adjusted":"none"})};m.createStretchRenderer=g;m.createUVRenderer=r;m.createVectorFieldRenderer=I;m.estimateMagnitudeRange=U;m.getBandNames=function(G,O){const R=G.bandInfos.map(({name:T})=>T);return O?.length?O.map(T=>R[T]):R};m.getClassField=B;m.getDefaultBandCombination=b;m.getDefaultInterpolation=function(G,O,R){const T=["nearest","bilinear","cubic","majority"].find(X=>X===R?.toLowerCase());return"Map"===O?T??"bilinear":"standard-time"===G.dataType?
T??"nearest":"thematic"===G.dataType||G.attributeTable||G.colormap?"nearest"===T||"majority"===T?T:"nearest":T??"bilinear"};m.getDefinedInterval=E;m.getField=n;m.getSupportedRendererTypes=function(G,O=!1){const R=["raster-stretch"];y.isColormapRendererSupported(G,O)&&R.push("raster-colormap");y.isUVRendererSupported(G)&&R.push("unique-value");y.isClassBreaksSupported(G,O)&&R.push("class-breaks");y.isShadedReliefRendererSupported(G)&&R.push("raster-shaded-relief");y.isVectorFieldRendererSupported(G)&&
R.push("vector-field");y.isFlowRendererSupported(G)&&R.push("flow");return R};m.getVariableRasterInfo=d;m.getWellKnownBandIndexes=f;m.normalizeRendererJSON=function(G){if("uniqueValue"===G.type){var O=G.uniqueValueInfos;O?.[0].symbol?.symbolLayers?.length&&(G.uniqueValueInfos=O?.map(R=>({value:R.value,label:R.label,symbol:R.symbol?M(R.symbol):null})));return G}"classBreaks"===G.type&&(O=G.classBreakInfos,O[0].symbol?.symbolLayers?.length&&(G.classBreakInfos=O.map(R=>({classMinValue:R.classMinValue,
classMaxValue:R.classMaxValue,label:R.label,symbol:R.symbol?M(R.symbol):null}))));return G};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/rasterRendererChecks":function(){define(["exports"],function(m){function w(z){return["u8","s8"].includes(z.pixelType)&&null!=z.statistics?.[0]?.min&&null!=z.statistics[0]?.max&&1===z.bandCount}m.isClassBreaksSupported=function(z,N=!1){const {attributeTable:D,bandCount:S}=z;return 1===S&&(!N||null!=D||null!=z.histograms)};
m.isColormapRendererSupported=function(z,N=!1){const {bandCount:D,colormap:S,pixelType:Q}=z;return 1===D&&(!!S?.length||!N&&"u8"===Q)};m.isFlowRendererSupported=function(z){({dataType:z}=z);return"vector-uv"===z||"vector-magdir"===z};m.isShadedReliefRendererSupported=function(z){const {bandCount:N,dataType:D,pixelType:S}=z;return"elevation"===D||"generic"===D&&1===N&&("s16"===S||"s32"===S||"f32"===S||"f64"===S)};m.isSingleBand8BitRasterWithStats=w;m.isUVRendererSupported=function(z,N){const {attributeTable:D,
bandCount:S}=z;return null==D&&w(z)?!0:null==D||1<S||N&&null==D.fields.find(Q=>Q.name.toLowerCase()===N.toLowerCase())?!1:!0};m.isVectorFieldRendererSupported=function(z){({dataType:z}=z);return"vector-uv"===z||"vector-magdir"===z};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/ClassBreaksDefinition":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),
function(m,w,z,N,D,S,Q,P,H){D=new w.JSONMap({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"});w=new w.JSONMap({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});z=class extends z.JSONSupport{constructor(y){super(y);this.type="class-breaks-definition";
this.normalizationType=this.normalizationField=this.classificationMethod=this.classificationField=this.breakCount=null}set standardDeviationInterval(y){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",y)}set definedInterval(y){"defined-interval"===this.classificationMethod&&this._set("definedInterval",y)}};m.__decorate([P.enumeration({classBreaksDef:"class-breaks-definition"})],z.prototype,"type",void 0);m.__decorate([N.property({json:{write:!0}})],z.prototype,
"breakCount",void 0);m.__decorate([N.property({json:{write:!0}})],z.prototype,"classificationField",void 0);m.__decorate([N.property({type:String,json:{read:D.read,write:D.write}})],z.prototype,"classificationMethod",void 0);m.__decorate([N.property({json:{write:!0}})],z.prototype,"normalizationField",void 0);m.__decorate([N.property({json:{read:w.read,write:w.write}})],z.prototype,"normalizationType",void 0);m.__decorate([N.property({value:null,json:{write:!0}})],z.prototype,"standardDeviationInterval",
null);m.__decorate([N.property({value:null,json:{write:!0}})],z.prototype,"definedInterval",null);return z=m.__decorate([H.subclass("esri.rest.support.ClassBreaksDefinition")],z)})},"esri/rest/support/generateRendererUtils":function(){define(["exports","../../core/Logger"],function(m,w){function z(e){var l=e.definition;const {classificationMethod:q,normalizationType:t,definedInterval:h}=l;l=l.breakCount??1;const p=[];var v=e.values;if(0===v.length)return[];v=v.sort((k,r)=>k-r);var a=v[0],g=v[v.length-
1];if("equal-interval"===q)if(v.length>=l){v=(g-a)/l;e=a;for(var d=1;d<l;d++){var b=Number((a+d*v).toFixed(6));p.push({minValue:e,maxValue:b,label:N(e,b,t)});e=b}p.push({minValue:e,maxValue:g,label:N(e,g,t)})}else v.forEach(k=>{p.push({minValue:k,maxValue:k,label:N(k,k,t)})});else if("natural-breaks"===q){v=D(v);e=S(v.uniqueValues,e.valueFrequency||v.valueFrequency,l);for(d=1;d<l;d++)v.uniqueValues.length>d&&(b=Number(v.uniqueValues[e[d]].toFixed(6)),p.push({minValue:a,maxValue:b,label:N(a,b,t)}),
a=b);p.push({minValue:a,maxValue:g,label:N(a,g,t)})}else if("quantile"===q)if(v.length>=l&&a!==g){e=Math.ceil(v.length/l);d=0;for(b=1;b<l;b++){var f=e+d-1;f>v.length&&(f=v.length-1);0>f&&(f=0);p.push({minValue:a,maxValue:v[f],label:N(a,v[f],t)});a=v[f];d+=e;e=Math.ceil((v.length-d)/(l-b))}p.push({minValue:a,maxValue:g,label:N(a,g,t)})}else for(l=-1,g=0;g<v.length;g++)a=v[g],a!==l&&(l=a,p.push({minValue:l,maxValue:a,label:N(l,a,t)}),l=a);else if("standard-deviation"===q)if(e=H(v),d=y(v,e),0===d)p.push({minValue:v[0],
maxValue:v[0],label:N(v[0],v[0],t)});else{v=P(a,g,l,e,d)*d;d=0;for(b=l;1<=b;b--)f=Number((e-(b-.5)*v).toFixed(6)),p.push({minValue:a,maxValue:f,label:N(a,f,t)}),a=f,d++;b=Number((e+.5*v).toFixed(6));p.push({minValue:a,maxValue:b,label:N(a,b,t)});a=b;d++;for(f=1;f<=l;f++)b=d===2*l?g:Number((e+(f+.5)*v).toFixed(6)),p.push({minValue:a,maxValue:b,label:N(a,b,t)}),a=b,d++}else if("defined-interval"===q){if(!h)return p;l=v[0];g=v[v.length-1];v=Math.ceil((g-l)/h);a=l;for(e=1;e<v;e++)d=Number((l+e*h).toFixed(6)),
p.push({minValue:a,maxValue:d,label:N(a,d,t)}),a=d;p.push({minValue:a,maxValue:g,label:N(a,g,t)})}return p}function N(e,l,q){let t=null;return t=e===l?q&&"percent-of-total"===q?e+"%":e.toString():q&&"percent-of-total"===q?e+"% - "+l+"%":e+" - "+l}function D(e){const l=[],q=[];let t=Number.MIN_VALUE,h=1,p=-1;for(let v=0;v<e.length;v++){const a=e[v];a===t?(h++,q[p]=h):null!==a&&(l.push(a),t=a,h=1,q.push(h),p++)}return{uniqueValues:l,valueFrequency:q}}function S(e,l,q){var t=e.length;const h=[];q>t&&
(q=t);for(var p=0;p<q;p++)h.push(Math.round(p*t/q-1));h.push(t-1);p=Q(h,e,l,q);t=p.mean;p=p.sdcm;var v=q,a=0,g=0;let d=0,b=0,f=!0;for(let r=0;2>r&&f;r++){0===r&&(f=!1);for(var k=0;k<v-1;k++)for(;h[k+1]+1!==h[k+2];)if(h[k+1]+=1,a=u(k,h,e,l),d=a.sbMean,a=a.sbSdcm,g=u(k+1,h,e,l),b=g.sbMean,g=g.sbSdcm,a+g<p[k]+p[k+1])p[k]=a,p[k+1]=g,t[k]=d,t[k+1]=b,f=!0;else{--h[k+1];break}for(k=v-1;0<k;k--)for(;h[k]!==h[k-1]+1;)if(--h[k],a=u(k-1,h,e,l),d=a.sbMean,a=a.sbSdcm,g=u(k,h,e,l),b=g.sbMean,g=g.sbSdcm,a+g<p[k-
1]+p[k])p[k-1]=a,p[k]=g,t[k-1]=d,t[k]=b,f=!0;else{h[k]+=1;break}}f&&(p=Q(h,e,l,q));return h}function Q(e,l,q,t){let h=[];var p=[],v=[];let a=0;const g=[],d=[];for(var b=0;b<t;b++){var f=u(b,e,l,q);g.push(f.sbMean);d.push(f.sbSdcm);a+=d[b]}f=a;for(b=!0;b||a<f;){b=!1;h=[];for(p=0;p<t;p++)h.push(e[p]);for(v=0;v<t;v++)for(f=e[v]+1;f<=e[v+1];f++)if(p=l[f],0<v&&f!==e[v+1]&&Math.abs(p-g[v])>Math.abs(p-g[v-1]))e[v]=f;else if(v<t-1&&e[v]!==f-1&&Math.abs(p-g[v])>Math.abs(p-g[v+1])){e[v+1]=f-1;break}f=a;a=0;
p=[];v=[];for(let k=0;k<t;k++){p.push(g[k]);v.push(d[k]);const r=u(k,e,l,q);g[k]=r.sbMean;d[k]=r.sbSdcm;a+=d[k]}}if(a>f){for(l=0;l<t;l++)e[l]=h[l],g[l]=p[l],d[l]=v[l];a=f}return{mean:g,sdcm:d}}function P(e,l,q,t,h){e=Math.max(t-e,l-t)/h/q;return 1<=e?1:.5<=e?.5:.25}function H(e){let l=0;for(let q=0;q<e.length;q++)l+=e[q];return l/=e.length}function y(e,l){let q=0;for(let t=0;t<e.length;t++){const h=e[t];q+=(h-l)*(h-l)}q/=e.length;return Math.sqrt(q)}function u(e,l,q,t){var h=0,p=0;for(var v=l[e]+
1;v<=l[e+1];v++){const a=t[v];h+=q[v]*a;p+=a}0>=p&&c.warn("Exception in Natural Breaks calculation");h/=p;p=0;for(v=l[e]+1;v<=l[e+1];v++)p+=t[v]*(q[v]-h)**2;return{sbMean:h,sbSdcm:p}}const c=w.getLogger("esri.rest.support.generateRendererUtils");m.createGenerateRendererClassBreaks=function(e){const {normalizationTotal:l}=e;return{classBreaks:z(e),normalizationTotal:l}};m.createGenerateRendererUniqueValues=function(e){e=D(e);const l=[],q=e.uniqueValues.length;for(let t=0;t<q;t++){const h=e.uniqueValues[t];
l.push({value:h,count:e.valueFrequency[t],label:h.toString()})}return{uniqueValues:l}};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/RasterSymbolizer":function(){define("../../chunks/tslib.es6 ../../core/colorUtils ../../core/JSONSupport ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../layers/support/RasterInfo ../../layers/support/rasterFunctions/pixelUtils ../../layers/support/rasterFunctions/stretchUtils ../../layers/support/rasterFunctions/surfaceUtils ./colorRampUtils ./rasterRendererChecks".split(" "),
function(m,w,z,N,D,S,Q,P,H,y,u,c,e,l,q){function t(h){return u.isValidPixelBlock(h)&&0!==h.validPixelCount}z=class extends z.JSONSupport{constructor(h){super(h)}bind(){const {rendererJSON:h}=this;if(!h)return{success:!1};this.lookup={rendererJSON:{}};let p;switch(h.type){case "uniqueValue":p=this._updateUVRenderer(h);break;case "rasterColormap":p=this._updateColormapRenderer(h);break;case "rasterStretch":p=this._updateStretchRenderer(h);break;case "classBreaks":p=this._updateClassBreaksRenderer(h);
break;case "rasterShadedRelief":p=this._updateShadedReliefRenderer(h);break;case "vectorField":p=this._updateVectorFieldRenderer();break;case "flowRenderer":p=this._updateFlowRenderer()}return p}symbolize(h){let p=h?.pixelBlock;if(!t(p))return p;if(h.simpleStretchParams&&"rasterStretch"===this.rendererJSON.type)return this.simpleStretch(p,h.simpleStretchParams);try{3<p.pixels.length&&(p=p.extractBands([0,1,2]));let v;switch(this.rendererJSON.type){case "uniqueValue":case "rasterColormap":v=this._symbolizeColormap(p);
break;case "classBreaks":v=this._symbolizeClassBreaks(p);break;case "rasterStretch":v=this._symbolizeStretch(p,h.bandIds);break;case "rasterShadedRelief":const a=h.extent;v=this._symbolizeShadedRelief(p,{isGCS:a.spatialReference.isGeographic,resolution:{x:(a.xmax-a.xmin)/p.width,y:(a.ymax-a.ymin)/p.height}})}return v}catch(v){return N.getLogger(this).error("symbolize",v.message),p}}simpleStretch(h,p){if(!t(h))return h;try{return 3<h.pixels.length&&(h=h.extractBands([0,1,2])),c.stretch(h,{...p,isRenderer:!0})}catch(v){return N.getLogger(this).error("symbolize",
v.message),h}}generateWebGLParameters(h){if(["uniqueValue","rasterColormap","classBreaks"].includes(this.rendererJSON.type)){const {indexedColormap:d,offset:b}=this.lookup.colormapLut||{};return{colormap:d,colormapOffset:b,type:"lut"}}const {pixelBlock:p,isGCS:v,resolution:a,bandIds:g}=h;({rendererJSON:h}=this);return"rasterStretch"===h.type?this._generateStretchWebGLParams(p,h,g):"rasterShadedRelief"===h.type?this._generateShadedReliefWebGLParams(h,v,a??void 0):"vectorField"===h.type?this._generateVectorFieldWebGLParams(h):
null}_isLUTChanged(h){if(!this.lookup||!this.lookup.rendererJSON)return!0;if("colorRamp"in this.rendererJSON){const p=this.rendererJSON.colorRamp;if(h)return JSON.stringify(p)!==JSON.stringify(this.lookup.rendererJSON.colorRamp);({...this.rendererJSON});({...this.lookup.rendererJSON})}return JSON.stringify(this.rendererJSON)!==JSON.stringify(this.lookup.rendererJSON)}_symbolizeColormap(h){return this._isLUTChanged()&&!this.bind().success?h:u.colorize(h,this.lookup.colormapLut)}_symbolizeClassBreaks(h){const {canUseIndexedLUT:p}=
this._analyzeClassBreaks(this.rendererJSON);return this._isLUTChanged()&&!this.bind().success?h:p?u.colorize(h,this.lookup.colormapLut):u.remapColor(h,this.lookup.remapLut??[])}_symbolizeStretch(h,p){const {rasterInfo:v}=this,{pixelType:a,bandCount:g}=v,d=this.rendererJSON;var b=["u8","u16","s8","s16"].includes(a);let f;var {dra:k}=d;({gamma:r}=this.lookup);if("histogramEqualization"===d.stretchType){b=k?null:this.lookup?.histogramLut;p=c.getStretchCutoff(d,{rasterInfo:v,pixelBlock:h,bandIds:p,returnHistogramLut:!b});
var r=c.stretch(h,{...p,gamma:r,isRenderer:!0});r=u.lookupPixels(r,{lut:k?p.histogramLut:b,offset:0})}else if(b){if(k)k=c.getStretchCutoff(d,{rasterInfo:v,pixelBlock:h,bandIds:p}),f=c.createStretchLUT({pixelType:a,...k,gamma:r,rounding:"floor"});else{if(this._isLUTChanged()&&!this.bind().success)return h;f=this.lookup?this.lookup.stretchLut:null}if(!f)return h;1<g&&null!=p&&p.length===h?.pixels.length&&f?.lut.length===g&&(f={lut:p.map(B=>f.lut[B]),offset:f.offset});r=u.lookupPixels(h,f)}else k=c.getStretchCutoff(d,
{rasterInfo:v,pixelBlock:h,bandIds:p}),r=c.stretch(h,{...k,gamma:r,isRenderer:!0});if(d.colorRamp){if(this._isLUTChanged(!0)&&!this.bind().success)return h;r=u.colorize(r,this.lookup?.colormapLut)}return r}_symbolizeShadedRelief(h,p){var v=this.rendererJSON;p=e.hillshade(h,{...v,...p});if(!v.colorRamp||this._isLUTChanged(!0)&&!this.bind().success)return p;v=this.lookup?this.lookup.hsvMap:null;if(!v)return p;e.tintHillshade(p,h,v,this.rasterInfo.statistics?.[0]??{min:0,max:8E3});return p}_isVectorFieldData(){const {bandCount:h,
dataType:p}=this.rasterInfo;return 2===h&&("vector-magdir"===p||"vector-uv"===p)}_updateVectorFieldRenderer(){return this._isVectorFieldData()?{success:!0}:{success:!1,error:`Unsupported data type "${this.rasterInfo.dataType}"; VectorFieldRenderer only supports "vector-magdir" and "vector-uv".`}}_updateFlowRenderer(){return this._isVectorFieldData()?{success:!0}:{success:!1,error:`Unsupported data type "${this.rasterInfo.dataType}"; FlowRenderer only supports "vector-magdir" and "vector-uv".`}}_updateUVRenderer(h){const {bandCount:p,
attributeTable:v,pixelType:a}=this.rasterInfo,g=h.field1;if(!g)return{success:!1,error:"Unsupported renderer; missing UniqueValueRenderer.field."};const d=h.defaultSymbol;var b=1===p&&["u8","s8"].includes(a);if(!q.isUVRendererSupported(this.rasterInfo,g)&&!b)return{success:!1,error:"Unsupported data; UniqueValueRenderer is only supported on single band data with a valid raster attribute table."};const f=[];if(null!=v){const k=v.fields.find(r=>"value"===r.name.toLowerCase());if(!k)return{success:!1,
error:"Unsupported data; the data's raster attribute table does not have a value field."};v.features.forEach(r=>{const B=h.uniqueValueInfos?.find(A=>String(A.value)===String(r.attributes[g]))?.symbol?.color;B?f.push([r.attributes[k.name]].concat(B)):d&&f.push([r.attributes[k.name]].concat(d.color))})}else{if("value"!==g.toLowerCase())return{success:!1,error:'Unsupported renderer; UniqueValueRenderer.field must be "Value" when raster attribute table is not availalbe.'};h.uniqueValueInfos?.forEach(k=>
{const r=k?.symbol?.color;r?f.push([parseInt(""+k.value,10)].concat(r)):d&&f.push([parseInt(""+k.value,10)].concat(d?.color))})}if(0===f.length)return{success:!1,error:"Invalid UniqueValueRenderer. Cannot find matching records in the raster attribute table."};b=u.createColormapLUT({colormap:f});this.lookup={rendererJSON:h,colormapLut:b};this.canRenderInWebGL=this._isColormapSupportedByWebGL(b?.indexedColormap);return{success:!0}}_updateColormapRenderer(h){if(!q.isColormapRendererSupported(this.rasterInfo))return{success:!1,
error:"Unsupported data; the data source does not have a colormap."};var p=h.colormapInfos.map(v=>[v.value].concat(v.color)).sort((v,a)=>v[0]-a[0]);if(!p||0===p.length)return{success:!1,error:"Unsupported renderer; ColormapRenderer must have meaningful colormapInfos."};p=u.createColormapLUT({colormap:p});this.lookup={rendererJSON:h,colormapLut:p};this.canRenderInWebGL=this._isColormapSupportedByWebGL(p?.indexedColormap);return{success:!0}}_updateShadedReliefRenderer(h){if(!q.isShadedReliefRendererSupported(this.rasterInfo))return{success:!1,
error:`Unsupported data type "${this.rasterInfo.dataType}"; ShadedReliefRenderer only supports "elevation", or single band float/s16 data.`};if(h.colorRamp){var p=l.convertColorRampToColormap(h.colorRamp,{interpolateAlpha:!0});p=u.createColormapLUT({colormap:p});const v=[],a=p.indexedColormap;for(let g=0;g<a.length;g+=4){const d=w.toHSV({r:a[g],g:a[g+1],b:a[g+2]});v.push([d.h/60,d.s/100,255*d.v/100])}this.lookup={rendererJSON:h,colormapLut:p,hsvMap:v}}else this.lookup=null;this.canRenderInWebGL=!0;
return{success:!0}}_analyzeClassBreaks(h){const {attributeTable:p,pixelType:v}=this.rasterInfo,a=null!=p?p.fields.find(b=>"value"===b.name.toLowerCase()):null,g=null!=p?p.fields.find(b=>b.name.toLowerCase()===h.field.toLowerCase()):null,d=null!=a&&null!==g;return{canUseIndexedLUT:["u8","u16","s8","s16"].includes(v)||d,tableValueField:a,tableBreakField:g}}_updateClassBreaksRenderer(h){var {attributeTable:p}=this.rasterInfo;const {canUseIndexedLUT:v,tableValueField:a,tableBreakField:g}=this._analyzeClassBreaks(h);
var d=h.classBreakInfos;if(!d?.length)return{success:!1,error:"Unsupported renderer; missing or invalid ClassBreaksRenderer.classBreakInfos."};d=d.sort((B,A)=>B.classMaxValue-A.classMaxValue);var b=d[d.length-1],f=h.minValue;if(!v){var k=[];for(var r=0;r<d.length;r++)k.push({value:d[r].classMinValue??f,mappedColor:d[r].symbol.color}),f=d[r].classMaxValue;k.push({value:b.classMaxValue,mappedColor:b.symbol.color});this.lookup={rendererJSON:h,remapLut:k};this.canRenderInWebGL=!1;return{success:!0}}k=
[];if(null!=p&&null!=a&&null!==g&&a!==g){b=a.name;const B=g.name,A=d[d.length-1],{classMaxValue:n}=A;f=h.minValue;for(r of p.features){p=r.attributes[b];const C=r.attributes[B],E=C===n?A:C<f?null:d.find(({classMaxValue:I})=>I>C);E&&k.push([p].concat(E.symbol.color))}}else{f=Math.floor(h.minValue);for(r=0;r<d.length;r++){for(p=d[r];f<p.classMaxValue;f++)k.push([f].concat(p.symbol.color));f=Math.ceil(p.classMaxValue)}b.classMaxValue===f&&k.push([b.classMaxValue].concat(b.symbol.color))}d=u.createColormapLUT({colormap:k,
fillUnspecified:!1});this.lookup={rendererJSON:h,colormapLut:d};this.canRenderInWebGL=this._isColormapSupportedByWebGL(d?.indexedColormap);return{success:!0}}_isColormapSupportedByWebGL(h){return!!h?.length&&16384>=h.length}_isHistogramRequired(h){return"percentClip"===h||"histogramEqualization"===h}_isValidRasterStatistics(h){return null!=h&&0<h.length&&null!=h[0].min&&null!=h[0].max}_updateStretchRenderer(h){let {stretchType:p,dra:v}=h;if(!("none"===p||h.statistics?.length||this._isValidRasterStatistics(this.rasterInfo.statistics)||
v))return{success:!1,error:"Unsupported renderer; StretchRenderer.statistics is required when dynamic range adjustment is not used."};var a=h.histograms||this.rasterInfo.histograms;!this._isHistogramRequired(h.stretchType)||a?.length||v||(p="minMax");const {computeGamma:g,useGamma:d,colorRamp:b}=h;let {gamma:f}=h;d&&g&&!f?.length&&(f=c.computeGammaValues(this.rasterInfo.pixelType,h.statistics?.length?h.statistics:this.rasterInfo.statistics));var k=this.rasterInfo.pixelType;const r=!v&&["u8","u16",
"s8","s16"].includes(k);"histogramEqualization"===p?(k=a.map(B=>c.createHistogramEqualizationLUT(B)),this.lookup={rendererJSON:h,histogramLut:k}):r&&(a=c.getStretchCutoff(h,{rasterInfo:this.rasterInfo}),k=c.createStretchLUT({pixelType:k,...a,gamma:d?f:null,rounding:"floor"}),this.lookup={rendererJSON:h,stretchLut:k});b&&!this._isStretchColorRampNoop(b)&&(k=l.convertColorRampToColormap(b,{interpolateAlpha:!0}),this.lookup||(this.lookup={rendererJSON:h}),this.lookup.colormapLut=u.createColormapLUT({colormap:k}),
this.lookup.rendererJSON=h);this.lookup.gamma=d&&f?.length?f:null;this.canRenderInWebGL=!0;return{success:!0}}_isStretchColorRampNoop(h){return"algorithmic"===h.type&&["0,0,0,255","0,0,0"].includes(h.fromColor.join(","))&&["255,255,255,255","255,255,255"].includes(h.toColor.join(","))}_generateStretchWebGLParams(h,p,v){let a=null,g=null;var d=this.lookup?.colormapLut;p.colorRamp&&d&&(a=d.indexedColormap,g=d.offset);"histogramEqualization"===p.stretchType&&(p={...p,stretchType:"minMax"});({gamma:d}=
this.lookup);const b=!!(p.useGamma&&d&&d.some(E=>1!==E)),{minCutOff:f,maxCutOff:k,outMin:r,outMax:B}=c.getStretchCutoff(p,{rasterInfo:this.rasterInfo,pixelBlock:h,bandIds:v});var A=0;null!=h&&(A=h.getPlaneCount(),2===A&&(h=h.clone(),h.statistics=[h.statistics[0]],h.pixels=[h.pixels[0]]));({bandCount:h}=this.rasterInfo);v=Math.min(3,v?.length||A||h,h);h=new Float32Array(v);A=a||b?1:255;let n;for(n=0;n<f.length;n++)h[n]=k[n]===f[n]?0:(B-r)/(k[n]-f[n])/A;const C=new Float32Array(v);if(b&&d)for(n=0;n<
v;n++)C[n]=1<d[n]?2<d[n]?6.5+(d[n]-2)**2.5:6.5+100*(2-d[n])**4:1;return{bandCount:v,outMin:r/A,outMax:B/A,minCutOff:f,maxCutOff:k,factor:h,useGamma:b,gamma:b?d:[1,1,1],gammaCorrection:b?C:[1,1,1],colormap:a,colormapOffset:g,stretchType:p.stretchType,type:"stretch"}}_generateShadedReliefWebGLParams(h,p=!1,v={x:0,y:0}){let a=null,g=null;const d=this.lookup?.colormapLut;h.colorRamp&&d&&(a=d.indexedColormap,g=d.offset);p=e.calculateHillshadeParams({...h,isGCS:p,resolution:v});v=this.rasterInfo.statistics?.[0];
return{...p,minValue:v?.min??0,maxValue:v?.max??8E3,hillshadeType:"traditional"===h.hillshadeType?0:1,type:"hillshade",colormap:a,colormapOffset:g}}_generateVectorFieldWebGLParams(h){const {style:p,inputUnit:v,outputUnit:a,visualVariables:g,symbolTileSize:d,flowRepresentation:b}=h;let f;var k=this.rasterInfo.statistics?.[0].min??0,r=this.rasterInfo.statistics?.[0].max??50,B=g?.find(C=>"sizeInfo"===C.type)??{type:"sizeInfo",field:"Magnitude",maxDataValue:r,maxSize:.8*d,minDataValue:k,minSize:.2*d},
A=B.minDataValue??k,n=B.maxDataValue??r;r=null!=B.maxSize&&null!=B.minSize?[B.minSize/d,B.maxSize/d]:[.2,.8];"wind_speed"===p&&(r[0]=r[1]=(r[0]+r[1])/2);k=null!=A&&null!=n?[A,n]:null;if("classified_arrow"===p)if(null!=A&&null!=n&&null!=B)for(f=[],A=(B.maxDataValue-B.minDataValue)/5,n=0;6>n;n++)f.push(B.minDataValue+A*n);else f=[0,1E-6,3.5,7,10.5,14];B="flow_to"===b===("ocean_current_kn"===p||"ocean_current_m"===p)?0:Math.PI;A=g?.find(C=>"rotationInfo"===C.type);return{breakValues:f,dataRange:k,inputUnit:v,
outputUnit:a,symbolTileSize:d,symbolPercentRange:r,style:p||"single_arrow",rotation:B,rotationType:this.rasterInfo.storageInfo?.tileInfo&&"vector-uv"===this.rasterInfo.dataType?"geographic":A?.rotationType||h.rotationType,type:"vectorField"}}};m.__decorate([D.property({json:{write:!0}})],z.prototype,"rendererJSON",void 0);m.__decorate([D.property({type:y,json:{write:!0}})],z.prototype,"rasterInfo",void 0);m.__decorate([D.property({json:{write:!0}})],z.prototype,"lookup",void 0);m.__decorate([D.property()],
z.prototype,"canRenderInWebGL",void 0);return z=m.__decorate([H.subclass("esri.renderers.support.RasterSymbolizer")],z)})},"esri/rest/support/ImageHistogramParameters":function(){define("../../chunks/tslib.es6 ../../geometry ../../TimeExtent ../../core/deprecate ../../core/JSONSupport ../../core/lang ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../geometry/support/jsonUtils ../../layers/support/MosaicRule ../../layers/support/RasterFunction ../../geometry/Point".split(" "),
function(m,w,z,N,D,S,Q,P,H,y,u,c,e,l,q){var t;D=t=class extends D.JSONSupport{constructor(){super(...arguments);this.pixelSize=this.rasterFunction=this.mosaicRule=this.geometry=null;this.raster=void 0;this.timeExtent=null}writeGeometry(h,p,v){null!=h&&(p.geometryType=c.getJsonType(h),p[v]=h.toJSON())}get renderingRule(){N.deprecatedProperty(Q.getLogger(this),"renderingRule",{replacement:"rasterFunction",version:"4.27",warnOnce:!0});return this._get("rasterFunction")}set renderingRule(h){N.deprecatedProperty(Q.getLogger(this),
"renderingRule",{replacement:"rasterFunction",version:"4.27",warnOnce:!0});this._set("rasterFunction",h)}clone(){return new t(S.clone({geometry:this.geometry,mosaicRule:this.mosaicRule,rasterFunction:this.rasterFunction,pixelSize:this.pixelSize,raster:this.raster,timeExtent:this.timeExtent}))}};m.__decorate([P.property({types:w.geometryTypes,json:{read:c.fromJSON}})],D.prototype,"geometry",void 0);m.__decorate([u.writer("geometry")],D.prototype,"writeGeometry",null);m.__decorate([P.property({type:e,
json:{write:!0}})],D.prototype,"mosaicRule",void 0);m.__decorate([P.property({type:l})],D.prototype,"renderingRule",null);m.__decorate([P.property({type:l,json:{write:!0,name:"renderingRule"}})],D.prototype,"rasterFunction",void 0);m.__decorate([P.property({type:q,json:{write:!0}})],D.prototype,"pixelSize",void 0);m.__decorate([P.property({json:{write:!0}})],D.prototype,"raster",void 0);m.__decorate([P.property({type:z,json:{read:{source:"time"},write:{target:"time"}}})],D.prototype,"timeExtent",
void 0);return D=t=m.__decorate([y.subclass("esri.rest.support.ImageHistogramParameters")],D)})},"esri/layers/support/MosaicRule":function(){define("../../chunks/tslib.es6 ../../core/deprecate ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../core/accessorSupport/ensureType ../../geometry/Point ./DimensionalDefinition ./RasterFunction".split(" "),
function(m,w,z,N,D,S,Q,P,H,y,u,c,e,l,q){var t;const h=z.strict()({MT_FIRST:"first",MT_LAST:"last",MT_MIN:"min",MT_MAX:"max",MT_MEAN:"mean",MT_BLEND:"blend",MT_SUM:"sum"}),p=z.strict()({esriMosaicNone:"none",esriMosaicCenter:"center",esriMosaicNadir:"nadir",esriMosaicViewpoint:"viewpoint",esriMosaicAttribute:"attribute",esriMosaicLockRaster:"lock-raster",esriMosaicNorthwest:"northwest",esriMosaicSeamline:"seamline"});z=t=class extends N.JSONSupport{constructor(v){super(v);this.ascending=!0;this.where=
this.viewpoint=this.sortValue=this.sortField=this.operation=this.objectIds=this.multidimensionalDefinition=this.method=this.lockRasterIds=this.itemRasterFunction=null}readAscending(v,a){return null!=a.ascending?a.ascending:null!=a.sortAscending?a.sortAscending:!0}get itemRenderingRule(){w.deprecatedProperty(S.getLogger(this),"itemRenderingRule",{replacement:"itemRasterFunction",version:"4.27",warnOnce:!0});return this._get("itemRasterFunction")}set itemRenderingRule(v){w.deprecatedProperty(S.getLogger(this),
"itemRenderingRule",{replacement:"itemRasterFunction",version:"4.27",warnOnce:!0});this._set("itemRasterFunction",v)}readMethod(v,a){v=a.mosaicMethod||a.defaultMosaicMethod;switch(v?v.toLowerCase().replace("esrimosaic",""):""){case "byattribute":case "attribute":v="esriMosaicAttribute";break;case "lockraster":v="esriMosaicLockRaster";break;case "center":v="esriMosaicCenter";break;case "northwest":v="esriMosaicNorthwest";break;case "nadir":v="esriMosaicNadir";break;case "viewpoint":v="esriMosaicViewpoint";
break;case "seamline":v="esriMosaicSeamline";break;case "none":v="esriMosaicNone";break;default:v="esriMosaicNone"}return p.fromJSON(v)}writeMultidimensionalDefinition(v,a,g){null!=v&&(v=v.filter(({variableName:d,dimensionName:b})=>d&&"*"!==d||b),v.length&&(a[g]=v.map(d=>d.toJSON())))}readOperation(v,a){v=a.mosaicOperation;a=a.mosaicOperator?.toLowerCase();a=v||(a?h.toJSON(a):null);return h.fromJSON(a)||"first"}castSortValue(v){return null==v||"string"===typeof v||"number"===typeof v?v:`${v}`}clone(){return new t({ascending:this.ascending,
itemRasterFunction:D.clone(this.itemRasterFunction),lockRasterIds:D.clone(this.lockRasterIds),method:this.method,multidimensionalDefinition:D.clone(this.multidimensionalDefinition),objectIds:D.clone(this.objectIds),operation:this.operation,sortField:this.sortField,sortValue:this.sortValue,viewpoint:D.clone(this.viewpoint),where:this.where})}};m.__decorate([Q.property({type:Boolean,json:{write:!0}})],z.prototype,"ascending",void 0);m.__decorate([H.reader("ascending",["ascending","sortAscending"])],
z.prototype,"readAscending",null);m.__decorate([Q.property({type:q,json:{name:"itemRenderingRule",write:!0}})],z.prototype,"itemRasterFunction",void 0);m.__decorate([Q.property({type:q})],z.prototype,"itemRenderingRule",null);m.__decorate([Q.property({type:[c.Integer],json:{write:{overridePolicy(){return{enabled:"lock-raster"===this.method}}}}})],z.prototype,"lockRasterIds",void 0);m.__decorate([Q.property({type:String,json:{type:p.jsonValues,write:{target:"mosaicMethod",writer:p.write}}})],z.prototype,
"method",void 0);m.__decorate([H.reader("method",["mosaicMethod","defaultMosaicMethod"])],z.prototype,"readMethod",null);m.__decorate([Q.property({type:[l],json:{write:!0}})],z.prototype,"multidimensionalDefinition",void 0);m.__decorate([u.writer("multidimensionalDefinition")],z.prototype,"writeMultidimensionalDefinition",null);m.__decorate([Q.property({type:[c.Integer],json:{name:"fids",write:!0}})],z.prototype,"objectIds",void 0);m.__decorate([Q.property({json:{type:h.jsonValues,read:{reader:h.read},
write:{target:"mosaicOperation",writer:h.write}}})],z.prototype,"operation",void 0);m.__decorate([H.reader("operation",["mosaicOperation","mosaicOperator"])],z.prototype,"readOperation",null);m.__decorate([Q.property({type:String,json:{write:{overridePolicy(){return{enabled:"attribute"===this.method}}}}})],z.prototype,"sortField",void 0);m.__decorate([Q.property({type:[String,Number],json:{write:{allowNull:!0,overridePolicy(){return{enabled:"attribute"===this.method,allowNull:!0}}}}})],z.prototype,
"sortValue",void 0);m.__decorate([P.cast("sortValue")],z.prototype,"castSortValue",null);m.__decorate([Q.property({type:e,json:{write:!0}})],z.prototype,"viewpoint",void 0);m.__decorate([Q.property({type:String,json:{write:!0}})],z.prototype,"where",void 0);return z=t=m.__decorate([y.subclass("esri.layers.support.MosaicRule")],z)})},"esri/views/2d/engine/flow/dataUtils":function(){define("exports ../../../../geometry ../../../../core/has ../../../../core/Logger ../../../../core/mathUtils ../../../../core/promiseUtils ../../../../core/RandomLCG ../../../../geometry/support/spatialReferenceUtils ../../../../geometry/Extent".split(" "),
function(m,w,z,N,D,S,Q,P,H){function y(a,g){const d=e(g.data,g.width,g.height,a.smoothing);return a.interpolate?(b,f)=>{const k=Math.floor(b),r=Math.floor(f);if(0>k||k>=g.width||0>r||r>=g.height)return[0,0];b-=k;f-=r;const B=k<g.width-1?k+1:k,A=r<g.height-1?r+1:r;return[(d[2*(r*g.width+k)]*(1-f)+d[2*(A*g.width+k)]*f)*(1-b)+(d[2*(r*g.width+B)]*(1-f)+d[2*(A*g.width+B)]*f)*b,(d[2*(r*g.width+k)+1]*(1-f)+d[2*(A*g.width+k)+1]*f)*(1-b)+(d[2*(r*g.width+B)+1]*(1-f)+d[2*(A*g.width+B)+1]*f)*b]}:(b,f)=>{b=Math.round(b);
f=Math.round(f);return 0>b||b>=g.width||0>f||f>=g.height?[0,0]:[d[2*(f*g.width+b)],d[2*(f*g.width+b)+1]]}}function u(a,g,d,b,f,k,r,B,A){const n=[];let C=0,[E,I]=g(d,b);E*=a.velocityScale;I*=a.velocityScale;n.push({x:d,y:b,t:C,speed:Math.sqrt(E*E+I*I)});for(let F=0;F<a.verticesPerLine;F++){let [x,K]=g(d,b);x*=a.velocityScale;K*=a.velocityScale;const J=Math.sqrt(x*x+K*K);if(J<a.minSpeedThreshold)break;const G=x/J,O=K/J;d+=G*a.segmentLength;b+=O*a.segmentLength;C+=a.segmentLength/J;if(Math.acos(G*M+
O*U)>a.maxTurnAngle)break;if(a.collisions){var M=Math.round(d*A);var U=Math.round(b*A);if(0>M||M>r-1||0>U||U>B-1)break;const R=k[U*r+M];if(-1!==R&&R!==f)break;k[U*r+M]=f}n.push({x:d,y:b,t:C,speed:J});M=G;U=O}return n}function c(a,g,d,b){const f=[],k=new Q,r=1/Math.max(a.lineCollisionWidth,1),B=Math.round(d*r),A=Math.round(b*r),n=new Int32Array(B*A);for(var C=0;C<n.length;C++)n[C]=-1;C=[];for(let E=0;E<b;E+=a.lineSpacing)for(let I=0;I<d;I+=a.lineSpacing)C.push({x:I,y:E,sort:k.getFloat()});C.sort((E,
I)=>E.sort-I.sort);for(const {x:E,y:I}of C)k.getFloat()<a.density&&(d=u(a,g,E,I,f.length,n,B,A,r),2>d.length||f.push(d));return f}function e(a,g,d,b){if(0===b)return a;const f=Math.round(3*b),k=Array(2*f+1);var r=0;for(var B=-f;B<=f;B++){var A=Math.exp(-B*B/(b*b));k[B+f]=A;r+=A}for(b=-f;b<=f;b++)k[b+f]/=r;r=new Float32Array(a.length);for(b=0;b<d;b++)for(B=0;B<g;B++){var n=A=0;for(var C=-f;C<=f;C++)if(!(0>B+C||B+C>=g)){var E=k[C+f];A+=E*a[2*(b*g+(B+C))];n+=E*a[2*(b*g+(B+C))+1]}r[2*(b*g+B)]=A;r[2*(b*
g+B)+1]=n}a=new Float32Array(a.length);for(b=0;b<g;b++)for(B=0;B<d;B++){n=A=0;for(C=-f;C<=f;C++)0>B+C||B+C>=d||(E=k[C+f],A+=E*r[2*((B+C)*g+b)],n+=E*r[2*((B+C)*g+b)+1]);a[2*(B*g+b)]=A;a[2*(B*g+b)+1]=n}return a}function l(a,g){const d=new Q;var b=a.reduce((B,A)=>B+A.length,0);b=new Float32Array(4*b);const f=Array(a.length);let k=0,r=0;for(const B of a){a=k;for(const A of B)b[4*k]=A.x,b[4*k+1]=A.y,b[4*k+2]=A.t,b[4*k+3]=A.speed,k++;f[r++]={startVertex:a,numberOfVertices:B.length,totalTime:B[B.length-
1].t,timeSeed:g?d.getFloat():0}}return{lineVertices:b,lineDescriptors:f}}function q(a,g){function d(M,U,F,x,K,J,G,O){const R=9*A;let T=0;B[R+T++]=M;B[R+T++]=U;B[R+T++]=1;B[R+T++]=F;B[R+T++]=J;B[R+T++]=G;B[R+T++]=x/2;B[R+T++]=K/2;B[R+T++]=O;A++;B[R+T++]=M;B[R+T++]=U;B[R+T++]=-1;B[R+T++]=F;B[R+T++]=J;B[R+T++]=G;B[R+T++]=-x/2;B[R+T++]=-K/2;B[R+T++]=O;A++}const {lineVertices:b,lineDescriptors:f}=a;var k=a=0;for(var r of f)a+=2*r.numberOfVertices,k+=6*(r.numberOfVertices-1);const B=new Float32Array(9*
a);r=new Uint32Array(k);let A=0;a=0;for(const M of f){const {totalTime:U,timeSeed:F}=M;let x=k=null,K=null;var n=null,C=null,E=null;for(let J=0;J<M.numberOfVertices;J++){n=b[4*(M.startVertex+J)];const G=b[4*(M.startVertex+J)+1],O=b[4*(M.startVertex+J)+2],R=b[4*(M.startVertex+J)+3];let T=null,X=null;var I=null;let L=null;0<J&&(T=n-k,X=G-x,I=Math.sqrt(T*T+X*X),T/=I,X/=I,1<J?(C=T+C,E=X+E,I=Math.sqrt(C*C+E*E),C/=I,E/=I,I=Math.min(1/(C*T+E*X),g),C*=I,E*=I,I=-E,L=C):(I=-X,L=T),null!==I&&null!==L&&(d(k,
x,K,I,L,U,F,R),r[a++]=A-2,r[a++]=A,r[a++]=A-1,r[a++]=A,r[a++]=A+1,r[a++]=A-1));k=n;x=G;K=O;C=T;E=X;n=R}d(k,x,K,-E,C,U,F,n)}return{vertexData:B,indexData:r}}function t(a){function g(W,Y){var Z=O+T,aa=R+X,fa=Math.sqrt(Z*Z+aa*aa);Z/=fa;aa/=fa;var ea=O*Z+R*aa,ca=T+L,ja=X+V;fa=Math.sqrt(ca*ca+ja*ja);ca/=fa;ja/=fa;var la=T*ca+X*ja;fa=I;var oa=M,pa=U,qa=F;aa=-(aa/ea);Z/=ea;ea=x;var ra=K,sa=J,ua=G;ja=-(ja/la);ca/=la;la=16*C;let ma=0;for(const wa of[1,2])for(const ba of[1,2,3,4])A[la+ma++]=fa,A[la+ma++]=oa,
A[la+ma++]=pa,A[la+ma++]=qa,A[la+ma++]=ea,A[la+ma++]=ra,A[la+ma++]=sa,A[la+ma++]=ua,A[la+ma++]=wa,A[la+ma++]=ba,A[la+ma++]=W,A[la+ma++]=Y,A[la+ma++]=aa/2,A[la+ma++]=Z/2,A[la+ma++]=ja/2,A[la+ma++]=ca/2,C++;n[E++]=C-8;n[E++]=C-7;n[E++]=C-6;n[E++]=C-7;n[E++]=C-5;n[E++]=C-6;n[E++]=C-4;n[E++]=C-3;n[E++]=C-2;n[E++]=C-3;n[E++]=C-1;n[E++]=C-2}function d(W,Y,Z,aa,fa,ea){O=T;R=X;T=L;X=V;null==O&&null==R&&(O=T,R=X);if(null!=x&&null!=K){L=W-x;V=Y-K;const ca=Math.sqrt(L*L+V*V);L/=ca;V/=ca}null!=O&&null!=R&&g(fa,
ea);I=x;M=K;U=J;F=G;x=W;K=Y;J=Z;G=aa}function b(W,Y){O=T;R=X;T=L;X=V;null==O&&null==R&&(O=T,R=X);null!=O&&null!=R&&g(W,Y)}const {lineVertices:f,lineDescriptors:k}=a;let r=a=0;for(var B of k){const W=B.numberOfVertices-1;a+=8*W;r+=12*W}const A=new Float32Array(16*a),n=new Uint32Array(r);let C=0,E=0,I,M,U,F,x,K,J,G,O,R,T,X,L,V;for(const W of k){V=L=X=T=R=O=G=J=K=x=F=U=M=I=null;const {totalTime:Y,timeSeed:Z}=W;for(B=0;B<W.numberOfVertices;B++)d(f[4*(W.startVertex+B)],f[4*(W.startVertex+B)+1],f[4*(W.startVertex+
B)+2],f[4*(W.startVertex+B)+3],Y,Z);b(Y,Z)}return{vertexData:A,indexData:n}}function h(a,g){const d=g.pixels,{width:b,height:f}=g,k=new Float32Array(b*f*2),r=g.mask||new Uint8Array(b*f*2);g.mask||r.fill(255);if("vector-uv"===a)for(a=0;a<b*f;a++)k[2*a]=d[0][a],k[2*a+1]=-d[1][a];else if("vector-magdir"===a)for(a=0;a<b*f;a++){g=d[0][a];const B=D.deg2rad(d[1][a]),A=Math.sin(B-Math.PI/2);k[2*a]=Math.cos(B-Math.PI/2)*g;k[2*a+1]=A*g}return{data:k,mask:r,width:b,height:f}}async function p(a,g,d,b,f,k){const r=
{requestProjectedLocalDirections:!0,signal:k};null!=f&&(r.timeExtent=f);if("imagery"===a.type)return await a.load({signal:k}),f=a.rasterInfo.dataType,a=await a.fetchImage(g,d,b,r),null==a?.pixelData?.pixelBlock?{data:new Float32Array(d*b*2),mask:new Uint8Array(d*b),width:d,height:b}:h(f,a.pixelData.pixelBlock);await a.load({signal:k});f=a.rasterInfo.dataType;a=await a.fetchPixels(g,d,b,r);return null==a?.pixelBlock?{data:new Float32Array(d*b*2),mask:new Uint8Array(d*b),width:d,height:b}:h(f,a.pixelBlock)}
const v=N.getLogger("esri.views.2d.engine.flow.dataUtils");m.createAnimatedLinesData=l;m.createFlowMesh=async function(a,g,d,b){const f=performance.now();var k=y(g,d);const r=performance.now();d=c(g,k,d.width,d.height);g=performance.now();k=l(d,!0);d=performance.now();a="Streamlines"===a?q(k,10):t(k);k=performance.now();z("esri-2d-profiler")&&(v.info("I.1","_createFlowFieldFromData (ms)",Math.round(r-f)),v.info("I.2","_getStreamlines (ms)",Math.round(g-r)),v.info("I.3","createAnimatedLinesData (ms)",
Math.round(d-g)),v.info("I.4","create{Streamlines|Particles}Mesh (ms)",Math.round(k-d)),v.info("I.5","createFlowMesh (ms)",Math.round(k-f)),v.info("I.6","Mesh size (bytes)",a.vertexData.buffer.byteLength+a.indexData.buffer.byteLength));await Promise.resolve();S.throwIfAborted(b);return a};m.createParticlesMesh=t;m.createStreamlinesMesh=q;m.loadImagery=async function(a,g,d,b,f,k){const r=performance.now();var B=P.getInfo(g.spatialReference);if(!B)return d=await p(a,g,d,b,f,k),z("esri-2d-profiler")&&
v.info("I.7","loadImagery, early exit (ms)",Math.round(performance.now()-r)),z("esri-2d-profiler")&&v.info("I.9","Number of parts",1),d;const [A,n]=B.valid,C=Math.ceil(g.width/(n-A)),E=g.width/C,I=Math.round(d/C);let M=g.xmin;const U=[];B=performance.now();for(let F=0;F<C;F++){const x=new H({xmin:M,xmax:M+E,ymin:g.ymin,ymax:g.ymax,spatialReference:g.spatialReference});U.push(p(a,x,I,b,f,k));M+=E}a=await Promise.all(U);z("esri-2d-profiler")&&v.info("I.8","All calls to _fetchPart (ms)",Math.round(performance.now()-
B));z("esri-2d-profiler")&&v.info("I.9","Number of parts",a.length);b={data:new Float32Array(d*b*2),mask:new Uint8Array(d*b),width:d,height:b};g=0;for(const F of a){for(a=0;a<F.height;a++)for(f=0;f<F.width;f++)g+f>=d||(b.data[2*(a*d+g+f)]=F.data[2*(a*F.width+f)],b.data[2*(a*d+g+f)+1]=F.data[2*(a*F.width+f)+1],b.mask[a*d+g+f]=F.mask[a*F.width+f]);g+=F.width}z("esri-2d-profiler")&&v.info("I.10","loadImagery, general exit (ms)",Math.round(performance.now()-r));return b};Object.defineProperty(m,Symbol.toStringTag,
{value:"Module"})})},"esri/layers/support/rasterDatasets/RasterFactory":function(){define("../../../core/Error ./CloudRaster ./ImageAuxRaster ./ImageServerRaster ./MRFRaster ./TIFFRaster".split(" "),function(m,w,z,N,D,S){const Q=new Map;Q.set("CRF",{desc:"Cloud Raster Format",constructor:w});Q.set("MRF",{desc:"Meta Raster Format",constructor:D});Q.set("TIFF",{desc:"GeoTIFF",constructor:S});Q.set("RasterTileServer",{desc:"Raster Tile Server",constructor:N});Q.set("JPG",{desc:"JPG Raster Format",constructor:z});
Q.set("PNG",{desc:"PNG Raster Format",constructor:z});Q.set("GIF",{desc:"GIF Raster Format",constructor:z});Q.set("BMP",{desc:"BMP Raster Format",constructor:z});class P{static get supportedFormats(){const H=new Set;Q.forEach((y,u)=>H.add(u));return H}static async open(H){const {url:y,ioConfig:u,sourceJSON:c}=H;let e=H.datasetFormat;null==e&&y.lastIndexOf(".")&&(e=y.slice(y.lastIndexOf(".")+1).toUpperCase());if("OVR"===e||"TIF"===e)e="TIFF";else if("JPG"===e||"JPEG"===e||"JFIF"===e)e="JPG";y.toLowerCase().includes("/imageserver")&&
!y.toLowerCase().includes("/wcsserver")&&(e="RasterTileServer");const l={bandIds:null,sampling:null},q={url:y,sourceJSON:c,datasetFormat:e,ioConfig:u??l};let t,h;if(e&&this.supportedFormats.has(e)){if("CRF"===e&&!u?.enableCRF)throw new m("rasterfactory:open",`cannot open raster: ${y}`);t=Q.get(e).constructor;h=new t(q);await h.open({signal:H.signal});return h}if(e)throw new m("rasterfactory:open","not a supported format "+e);const p=Array.from(Q.keys());let v=0;const a=()=>{e=p[v++];if(!e||"CRF"===
e&&!u?.enableCRF)return null;t=Q.get(e).constructor;h=new t(q);return h.open({signal:H.signal}).then(()=>h).catch(()=>a())};return a()}static register(H,y,u){Q.has(H.toUpperCase())||Q.set(H.toUpperCase(),{desc:y,constructor:u})}}return P})},"esri/layers/support/rasterDatasets/CloudRaster":function(){define("../../../chunks/tslib.es6 ../../../geometry ../../../core/Error ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../LOD ../RasterInfo ../RasterStorageInfo ../TileInfo ./BaseRaster ./DBFParser ../rasterTransforms/utils ../../../rest/support/FeatureSet ../../../geometry/SpatialReference ../../../geometry/Extent ../../../geometry/Point".split(" "),
function(m,w,z,N,D,S,Q,P,H,y,u,c,e,l,q,t,h,p,v){const a=new Map;a.set("int16","esriFieldTypeSmallInteger");a.set("int32","esriFieldTypeInteger");a.set("int64","esriFieldTypeInteger");a.set("float32","esriFieldTypeSingle");a.set("float64","esriFieldTypeDouble");a.set("text","esriFieldTypeString");w=class extends e{constructor(){super(...arguments);this.storageInfo=null;this.datasetFormat="CRF"}async open(g){await this.init();({data:g}=await this.request(this.url+"/conf.json",{signal:g?.signal}));if(!this._validateHeader(g))throw new z("cloudraster:open",
"Invalid or unsupported conf.json.");this.datasetName=this.url.slice(this.url.lastIndexOf("/")+1);const {storageInfo:d,rasterInfo:b}=this._parseHeader(g);"thematic"===b.dataType&&(g=await this._fetchAuxiliaryInformation(),b.attributeTable=g);this._set("storageInfo",d);this._set("rasterInfo",b);this.ioConfig.retryCount=this.ioConfig.retryCount||0}async fetchRawTile(g,d,b,f={}){var {transposeInfo:k}=this.rasterInfo.storageInfo,{transposedVariableName:r}=f;g=(k=!(!k||!r))?0:this.rasterInfo.storageInfo.maximumPyramidLevel-
g;if(0>g)return null;r=this._buildCacheFilePath(g,d,b,f.multidimensionalDefinition,r);d=this._getIndexRecordFromBundle(d,b,k);b=await this.request(r,{range:{from:0,to:this.storageInfo.headerSize-1},responseType:"array-buffer",signal:f.signal});if(!b)return null;b=new Uint8Array(b.data);d=this._getTileEndAndContentType(b,d);if(0===d.recordSize)return null;f=await this.request(r,{range:{from:d.position,to:d.position+d.recordSize},responseType:"array-buffer",signal:f.signal});if(!f)return null;const [B,
A]=this._getTileSize(k);return this.decodePixelBlock(f.data,{width:B,height:A,planes:null,pixelType:null,returnInterleaved:k})}_validateHeader(g){const d="origin extent geodataXform LODInfos blockWidth blockHeight bandCount pixelType pixelSizeX pixelSizeY format packetSize".split(" ");return g&&"RasterInfo"===g.type&&!d.some(b=>!g[b])}_parseHeader(g){var d="u1 u2 u4 u8 s8 u16 s16 u32 s32 f32 f64".split(" ")[g.pixelType];const {bandCount:b,colormap:f,blockWidth:k,blockHeight:r,firstPyramidLevel:B,
maximumPyramidLevel:A}=g,n=g.statistics?.map(W=>({min:W.min,max:W.max,avg:W.mean,stddev:W.standardDeviation,median:W.median,mode:W.mode})),C=g.histograms?.[0]?.counts?.length?g.histograms:null;var E=g.extent.spatialReference,I=g.geodataXform?.spatialReference;E=new h(E?.wkid||E?.wkt||E?.wkt2?E:I);I=new p({xmin:g.extent.xmin,ymin:g.extent.ymin,xmax:g.extent.xmax,ymax:g.extent.ymax,spatialReference:E});const M=new v({x:g.pixelSizeX,y:g.pixelSizeY,spatialReference:E}),U=Math.round((I.xmax-I.xmin)/M.x),
F=Math.round((I.ymax-I.ymin)/M.y),x=this._parseTransform(g.geodataXform),K=x?I:null;x&&(I=x.forwardTransform(I),M.x=(I.xmax-I.xmin)/U,M.y=(I.ymax-I.ymin)/F);const J=g.properties??{};var G=g.format.toLowerCase().replace("cache/","");const O=new v(g.origin.x,g.origin.y,E);let R;var T;if(f?.colors)for(R=[],T=0;T<f.colors.length;T++){var X=f.colors[T];var L=f.values?f.values[T]:T;R.push([L,X&255,X<<16>>>24,X<<8>>>24,X>>>24])}X=g.LODInfos;L=[];for(T=0;T<X.levels.length;T++)L.push(new H({level:X.levels[T],
resolution:X.resolutions[T],scale:96/.0254*X.resolutions[T]}));X=new c({dpi:96,lods:L,format:G,origin:O,size:[k,r],spatialReference:E});G={recordSize:8,packetSize:g.packetSize,headerSize:g.packetSize*g.packetSize*8+64};L=[{maxCol:Math.ceil(U/k)-1,maxRow:Math.ceil(F/r)-1,minCol:0,minRow:0}];let V=2;if(0<A)for(T=0;T<A;T++)L.push({maxCol:Math.ceil(U/V/k)-1,maxRow:Math.ceil(F/V/r)-1,minCol:0,minRow:0}),V*=2;g=g.mdInfo;T=null;g&&J._yxs&&(T=J._yxs,T={packetSize:T.PacketSize,tileSize:[T.TileXSize,T.TileYSize]});
d=new y({width:U,height:F,pixelType:d,bandCount:b,extent:I,nativeExtent:K,transform:x,spatialReference:E,pixelSize:M,keyProperties:J,statistics:n,histograms:C,multidimensionalInfo:g,colormap:R,storageInfo:new u({blockWidth:k,blockHeight:r,pyramidBlockWidth:k,pyramidBlockHeight:r,origin:O,tileInfo:X,transposeInfo:T,firstPyramidLevel:B,maximumPyramidLevel:A,blockBoundary:L})});return{storageInfo:G,rasterInfo:d}}_parseTransform(g){if(!q.isTransformSupported(g))throw new z("cloudraster:open","the data contains unsupported geodata transform types");
g=q.readTransform(g);if("identity"===g.type)return null;if("polynomial"!==g.type||!g.forwardCoefficients?.length||!g.inverseCoefficients?.length)throw new z("cloudraster:open","the data contains unsupported geodata transforms - both forward and inverse coefficients are required currently");return g}async _fetchAuxiliaryInformation(g){var d=this.request(this.url+"/conf.vat.json",{signal:g}).then(f=>f.data).catch(()=>null);g=this.request(this.url+"/conf.vat.dbf",{responseType:"array-buffer",signal:g}).then(f=>
f.data).catch(()=>null);d=await Promise.all([d,g]);let b;if(d[0]){g=d[0].fields;const f=d[0].values;if(g&&f){g=g.map(r=>({type:"OID"===r.name?"esriFieldTypeOID":a.get(r.type),name:r.name,alias:r.alias||r.name}));const k=f.map(r=>({attributes:r}));g&&f&&(b={fields:g,features:k})}}!b&&d[1]&&(b=l.parse(d[1]).recordSet);return t.fromJSON(b)}_buildCacheFilePath(g,d,b,f,k){var r=this._getPackageSize(!!k);b=Math.floor(b/r)*r;d="R"+this._toHexString4(Math.floor(d/r)*r)+"C"+this._toHexString4(b);r="L";r=10<=
g?r+g.toString():r+("0"+g.toString());({multidimensionalInfo:g}=this.rasterInfo);const B=f?.[0];if(null==g||!B)return`${this.url}/_alllayers/${r}/${d}.bundle`;f="_yxs";if(!k){f=g.variables.find(A=>A.name===B.variableName).dimensions[0].values.indexOf(B.values[0]).toString(16);g=4-f.length;for(b=0;b<g;b++)f="0"+f;f="S"+f}k=this._getVariableFolderName(k||B.variableName);return`${this.url}/_alllayers/${k}/${f}/${r}/${d}.bundle`}_getPackageSize(g=!1){const {transposeInfo:d}=this.rasterInfo.storageInfo;
return g&&null!=d?d.packetSize??0:this.storageInfo.packetSize}_getTileSize(g=!1){const {storageInfo:d}=this.rasterInfo,{transposeInfo:b}=d;return g&&null!=b?b.tileSize:d.tileInfo.size}_getVariableFolderName(g){g=g.trim();return""===g?"_v":g.replaceAll(/[\{|\}\-]/g,"_").replace("\\*","_v")}_getIndexRecordFromBundle(g,d,b=!1){b=this._getPackageSize(b);g=g%b*b+d%b;if(0>g)throw Error("Invalid level / row / col");return g*this.storageInfo.recordSize+64}_getTileEndAndContentType(g,d){g=g.subarray(d,d+8);
d=0;let b;for(b=0;5>b;b++)d|=(g[b]&255)<<8*b;const f=d&0xffffffffff;d=0;for(b=5;8>b;b++)d|=(g[b]&255)<<8*(b-5);return{position:f,recordSize:d&0xffffffffff}}_toHexString4(g){g=g.toString(16);if(4!==g.length){let d=4-g.length;for(;0<d--;)g="0"+g}return g}};m.__decorate([N.property({readOnly:!0})],w.prototype,"storageInfo",void 0);m.__decorate([N.property({type:String,json:{write:!0}})],w.prototype,"datasetFormat",void 0);return w=m.__decorate([P.subclass("esri.layers.support.rasterDatasets.CloudRaster")],
w)})},"esri/layers/support/rasterDatasets/DBFParser":function(){define(["./byteStreamUtils"],function(m){function w(N){var D=N.fields;N=N.records;const S=D.some(u=>"oid"===u.name.toLowerCase())?"OBJECTID":"OID";D=[{name:S,type:"esriFieldTypeOID",alias:"OID"}].concat(D.map(u=>({name:u.name,type:"esriFieldType"+u.typeName,alias:u.name})));const Q=D.map(u=>u.name),P=[];let H=0,y=0;N.forEach(u=>{const c={};c[S]=H++;for(y=1;y<Q.length;y++)c[Q[y]]=u[y-1];P.push({attributes:c})});return{displayFieldName:"",
fields:D,features:P}}class z{static get supportedVersions(){return[5]}static parse(N){var D=new DataView(N),S=D.getUint8(0)&3;if(3!==S)return{header:{version:S},recordSet:null};const Q=D.getUint32(4,!0);var P=D.getUint16(8,!0);const H=D.getUint16(10,!0);P={version:S,recordCount:Q,headerByteCount:P,recordByteCount:H};let y=32;const u=[],c=[];if(3===S){for(;13!==D.getUint8(y);)S=String.fromCharCode(D.getUint8(y+11)).trim(),u.push({name:m.bytesToUTF8(new Uint8Array(N,y,11)),type:S,typeName:"String Date Double Boolean String Integer".split(" ")["CDFLMN".split("").indexOf(S)],
length:D.getUint8(y+16)}),y+=32;y+=1;if(0<u.length)for(;c.length<Q&&N.byteLength-y>H;){const e=[];32===D.getUint8(y)?(y+=1,u.forEach(l=>{if("C"===l.type)e.push(m.bytesToUTF8(new Uint8Array(N,y,l.length)).trim());else if("N"===l.type)e.push(parseInt(String.fromCharCode.apply(null,new Uint8Array(N,y,l.length)).trim(),10));else if("F"===l.type)e.push(parseFloat(String.fromCharCode.apply(null,new Uint8Array(N,y,l.length)).trim()));else if("D"===l.type){const q=String.fromCharCode.apply(null,new Uint8Array(N,
y,l.length)).trim();e.push(new Date(parseInt(q.substring(0,4),10),parseInt(q.substring(4,6),10)-1,parseInt(q.substring(6,8),10)))}y+=l.length}),c.push(e)):y+=H}}D=w({fields:u,records:c});return{header:P,fields:u,records:c,recordSet:D}}}return z})},"esri/layers/support/rasterTransforms/utils":function(){define(["exports","./GCSShiftTransform","./IdentityTransform","./PolynomialTransform"],function(m,w,z,N){const D={GCSShiftXform:w,IdentityXform:z,PolynomialXform:N},S=Object.keys(D);m.isTransformSupported=
function(Q){return!Q||S.includes(Q?.type)};m.readTransform=function(Q){if(!Q?.type)return null;var P=D[Q?.type];return P?(P=new P,P.read(Q),P):null};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterTransforms/GCSShiftTransform":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseRasterTransform".split(" "),
function(m,w,z,N,D,S,Q,P){var H;z=H=class extends P{constructor(){super(...arguments);this.type="gcs-shift";this.tolerance=1E-8}forwardTransform(y){y=y.clone();if("point"===y.type)return y.x>180+this.tolerance&&(y.x-=360),y;y.xmin>=180-this.tolerance?(y.xmax-=360,y.xmin-=360):y.xmax>180+this.tolerance&&(y.xmin=-180,y.xmax=180);return y}inverseTransform(y){y=y.clone();if("point"===y.type)return y.x<-this.tolerance&&(y.x+=360),y;y.xmin<-this.tolerance&&(y.xmin+=360,y.xmax+=360);return y}clone(){return new H({tolerance:this.tolerance})}};
m.__decorate([S.enumeration({GCSShiftXform:"gcs-shift"})],z.prototype,"type",void 0);m.__decorate([w.property()],z.prototype,"tolerance",void 0);return z=H=m.__decorate([Q.subclass("esri.layers.support.rasterTransforms.GCSShiftTransform")],z)})},"esri/layers/support/rasterTransforms/BaseRasterTransform":function(){define("../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass".split(" "),
function(m,w,z,N,D,S,Q){w=class extends w.JSONSupport{get affectsPixelSize(){return!1}forwardTransform(P){return P}inverseTransform(P){return P}};m.__decorate([z.property()],w.prototype,"affectsPixelSize",null);m.__decorate([z.property({json:{write:!0}})],w.prototype,"spatialReference",void 0);return w=m.__decorate([Q.subclass("esri.layers.support.rasterTransforms.BaseRasterTransform")],w)})},"esri/layers/support/rasterTransforms/IdentityTransform":function(){define("../../../chunks/tslib.es6 ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/Error ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseRasterTransform".split(" "),
function(m,w,z,N,D,S,Q,P,H){var y;w=y=class extends H{constructor(){super(...arguments);this.type="identity"}clone(){return new y}};m.__decorate([Q.enumeration({IdentityXform:"identity"})],w.prototype,"type",void 0);return w=y=m.__decorate([P.subclass("esri.layers.support.rasterTransforms.IdentityTransform")],w)})},"esri/layers/support/rasterTransforms/PolynomialTransform":function(){define("../../../chunks/tslib.es6 ../../../geometry ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseRasterTransform ../../../geometry/Point ../../../geometry/Extent".split(" "),
function(m,w,z,N,D,S,Q,P,H,y,u,c,e){function l(h,p,v){const {x:a,y:g}=p;if(2>v)return{x:h[0]+a*h[2]+g*h[4],y:h[1]+a*h[3]+g*h[5]};if(2===v){p=a*a;v=g*g;var d=a*g;return{x:h[0]+a*h[2]+g*h[4]+p*h[6]+d*h[8]+v*h[10],y:h[1]+a*h[3]+g*h[5]+p*h[7]+d*h[9]+v*h[11]}}p=a*a;v=g*g;d=a*g;const b=p*a,f=p*g,k=a*v,r=g*v;return{x:h[0]+a*h[2]+g*h[4]+p*h[6]+d*h[8]+v*h[10]+b*h[12]+f*h[14]+k*h[16]+r*h[18],y:h[1]+a*h[3]+g*h[5]+p*h[7]+d*h[9]+v*h[11]+b*h[13]+f*h[15]+k*h[17]+r*h[19]}}function q(h,p,v){const {xmin:a,ymin:g,xmax:d,
ymax:b,spatialReference:f}=p;p=[];if(2>v)p.push({x:a,y:b}),p.push({x:d,y:b}),p.push({x:a,y:g}),p.push({x:d,y:g});else{var k=10;for(var r=0;r<k;r++)p.push({x:a,y:g+(b-g)*r/(k-1)}),p.push({x:d,y:g+(b-g)*r/(k-1)});k=8;for(r=1;r<=k;r++)p.push({x:a+(d-a)*r/k,y:g}),p.push({x:a+(d-a)*r/k,y:b})}p=p.map(B=>l(h,B,v));k=p.map(B=>B.x);p=p.map(B=>B.y);return new e({xmin:Math.min.apply(null,k),xmax:Math.max.apply(null,k),ymin:Math.min.apply(null,p),ymax:Math.max.apply(null,p),spatialReference:f})}var t;w=t=class extends u{constructor(){super(...arguments);
this.polynomialOrder=1;this.type="polynomial"}readForwardCoefficients(h,p){const {coeffX:v,coeffY:a}=p;if(!v?.length||!a?.length||v.length!==a.length)return null;h=[];for(p=0;p<v.length;p++)h.push(v[p]),h.push(a[p]);return h}writeForwardCoefficients(h,p,v){v=[];const a=[];for(let g=0;g<h?.length;g++)0===g%2?v.push(h[g]):a.push(h[g]);p.coeffX=v;p.coeffY=a}get inverseCoefficients(){var h=this._get("inverseCoefficients"),p=this._get("forwardCoefficients");if(!h&&p&&2>this.polynomialOrder){const [v,a,
g,d,b,f]=p;h=g*f-b*d;p=b*d-g*f;h=[(b*a-v*f)/h,(g*a-v*d)/p,f/h,d/p,-b/h,-g/p]}return h}set inverseCoefficients(h){this._set("inverseCoefficients",h)}readInverseCoefficients(h,p){const {inverseCoeffX:v,inverseCoeffY:a}=p;if(!v?.length||!a?.length||v.length!==a.length)return null;h=[];for(p=0;p<v.length;p++)h.push(v[p]),h.push(a[p]);return h}writeInverseCoefficients(h,p,v){v=[];const a=[];for(let g=0;g<h?.length;g++)0===g%2?v.push(h[g]):a.push(h[g]);p.inverseCoeffX=v;p.inverseCoeffY=a}get affectsPixelSize(){return 0<
this.polynomialOrder}forwardTransform(h){if("point"===h.type){const p=l(this.forwardCoefficients,h,this.polynomialOrder);return new c({x:p.x,y:p.y,spatialReference:h.spatialReference})}return q(this.forwardCoefficients,h,this.polynomialOrder)}inverseTransform(h){if("point"===h.type){const p=l(this.inverseCoefficients,h,this.polynomialOrder);return new c({x:p.x,y:p.y,spatialReference:h.spatialReference})}return q(this.inverseCoefficients,h,this.polynomialOrder)}clone(){return new t({polynomialOrder:this.polynomialOrder,
forwardCoefficients:this.forwardCoefficients?[...this.forwardCoefficients]:null,inverseCoefficients:this.inverseCoefficients?[...this.inverseCoefficients]:null})}};m.__decorate([z.property({json:{write:!0}})],w.prototype,"polynomialOrder",void 0);m.__decorate([z.property()],w.prototype,"forwardCoefficients",void 0);m.__decorate([P.reader("forwardCoefficients",["coeffX","coeffY"])],w.prototype,"readForwardCoefficients",null);m.__decorate([y.writer("forwardCoefficients")],w.prototype,"writeForwardCoefficients",
null);m.__decorate([z.property({json:{write:!0}})],w.prototype,"inverseCoefficients",null);m.__decorate([P.reader("inverseCoefficients",["inverseCoeffX","inverseCoeffY"])],w.prototype,"readInverseCoefficients",null);m.__decorate([y.writer("inverseCoefficients")],w.prototype,"writeInverseCoefficients",null);m.__decorate([z.property()],w.prototype,"affectsPixelSize",null);m.__decorate([Q.enumeration({PolynomialXform:"polynomial"})],w.prototype,"type",void 0);return w=t=m.__decorate([H.subclass("esri.layers.support.rasterTransforms.PolynomialTransform")],
w)})},"esri/layers/support/rasterDatasets/ImageAuxRaster":function(){define("../../../chunks/tslib.es6 ../../../geometry ../../../core/Error ../../../core/has ../../../core/promiseUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ./BaseRaster ./InMemoryRaster ./pamParser ../rasterFormats/RasterCodec ../rasterFunctions/stretchUtils ../rasterTransforms/PolynomialTransform ../../../geometry/SpatialReference ../../../geometry/Extent".split(" "),
function(m,w,z,N,D,S,Q,P,H,y,u,c,e,l,q,t,h){w=class extends y{async open(p){await this.init();var v=await this._fetchData(p);let {spatialReference:a,statistics:g,histograms:d,transform:b}=await this._fetchAuxiliaryData(p);(p=!a)&&(a=new t({wkid:3857}));d?.length&&null==g&&(g=l.estimateStatisticsFromHistograms(d));const {width:f,height:k}=v;let r=new h({xmin:-.5,ymin:.5-k,xmax:f-.5,ymax:.5,spatialReference:a});const B=b?b.forwardTransform(r):r;var A=!0;b&&(A=(A=b.forwardCoefficients)&&0===A[1]&&0===
A[2])&&(b=null,r=B);v=new u({data:{extent:B,nativeExtent:r,transform:b,pixelBlock:v,statistics:g,histograms:d,keyProperties:{DateType:"Processed"},isPseudoSpatialReference:p}});await v.open();v.data=null;this._set("rasterInfo",v.rasterInfo);this._inMemoryRaster=v}fetchRawTile(p,v,a,g={}){return this._inMemoryRaster.fetchRawTile(p,v,a,g)}async _fetchData(p){({data:p}=await this.request(this.url,{responseType:"array-buffer",signal:p?.signal}));var v=e.getFormat(p).toUpperCase();if("JPG"===v||"PNG"===
v||"GIF"===v||"BMP"===v)this._set("datasetFormat",v);else throw new z("image-aux-raster:open","the data is not a supported format");v=v.toLowerCase();const a="gif"===v||"bmp"===v||!N("ios");p=await this.decodePixelBlock(p,{format:v,useCanvas:a,hasNoZlibMask:!0});if(null==p)throw new z("image-aux-raster:open","the data cannot be decoded");return p}async _fetchAuxiliaryData(p){p=p?.signal;var v=this.ioConfig.skipExtensions??[],a=v.includes("aux.xml")?null:this.request(this.url+".aux.xml",{responseType:"xml",
signal:p}),g=this.datasetFormat;v=(g="JPG"===g?"jgw":"PNG"===g?"pgw":"BMP"===g?"bpw":null)&&v.includes(g)?null:this.request(this.url.slice(0,this.url.lastIndexOf("."))+"."+g,{responseType:"text",signal:p});a=await D.eachAlways([a,v]);if(p?.aborted)throw D.createAbortError();p=c.parsePAMInfo(a[0].value?.data);p.transform||(a=a[1].value?a[1].value.data.split("\n").slice(0,6).map(d=>Number(d)):null,p.transform=6===a?.length?new q({forwardCoefficients:[a[4],a[5],a[0],-a[1],a[2],-a[3]]}):null);return p}};
m.__decorate([S.property({type:String,json:{write:!0}})],w.prototype,"datasetFormat",void 0);return w=m.__decorate([H.subclass("esri.layers.support.rasterDatasets.ImageAuxRaster")],w)})},"esri/layers/support/rasterDatasets/InMemoryRaster":function(){define("../../../chunks/tslib.es6 ../../../geometry ../../../core/Error ../../../core/promiseUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../RasterInfo ./BaseRaster ../rasterFunctions/pixelUtils ../rasterFunctions/stretchUtils ../../../geometry/Extent ../../../geometry/SpatialReference".split(" "),
function(m,w,z,N,D,S,Q,P,H,y,u,c,e,l,q){w=class extends u{constructor(){super(...arguments);this.datasetFormat="MEMORY";this.data=null}async open(t){await this.init();var h=this.data;const {pixelBlock:p,statistics:v,histograms:a,name:g,keyProperties:d,nativeExtent:b,transform:f}=this.data,{width:k,height:r,pixelType:B}=p,A=h.extent??new l({xmin:-.5,ymin:.5,xmax:k-.5,ymax:r-.5,spatialReference:new q({wkid:3857})});h=new y({width:k,height:r,pixelType:B,extent:A,nativeExtent:b,transform:f,pixelSize:{x:A.width/
k,y:A.height/r},spatialReference:A.spatialReference,bandCount:p.pixels.length,keyProperties:d||{},statistics:v,isPseudoSpatialReference:h.isPseudoSpatialReference??!h.extent,histograms:a});this.createRemoteDatasetStorageInfo(h,512,512);this._set("rasterInfo",h);this.updateTileInfo();await this._buildInMemoryRaster(p,{width:512,height:512},t);this.datasetName=g;this.url="/InMemory/"+g}fetchRawTile(t,h,p,v){t=this._pixelBlockTiles.get(`${t}/${h}/${p}`);return Promise.resolve(t)}async _buildInMemoryRaster(t,
h,p){var v=this.rasterInfo.storageInfo.maximumPyramidLevel;const a=this.rasterJobHandler?this.rasterJobHandler.split({pixelBlock:t,tileSize:h,maximumPyramidLevel:v},p):Promise.resolve(c.split(t,h,v));h=null!=this.rasterInfo.statistics;v=null!=this.rasterInfo.histograms;t=h?Promise.resolve({statistics:null,histograms:null}):this.rasterJobHandler?this.rasterJobHandler.estimateStatisticsHistograms({pixelBlock:t},p):Promise.resolve(e.estimateStatisticsHistograms(t));t=await N.eachAlways([a,t]);if(!t[0].value&&
t[1].value)throw new z("inmemory-raster:open","failed to build in memory raster");this._pixelBlockTiles=t[0].value;h||(this.rasterInfo.statistics=t[1].value?.statistics);v||(this.rasterInfo.histograms=t[1].value?.histograms)}};m.__decorate([D.property({type:String,json:{write:!0}})],w.prototype,"datasetFormat",void 0);m.__decorate([D.property()],w.prototype,"data",void 0);return w=m.__decorate([H.subclass("esri.layers.support.rasterDatasets.InMemoryRaster")],w)})},"esri/layers/support/rasterDatasets/pamParser":function(){define("exports ../../../geometry ../../../core/arrayUtils ../../../geometry/support/spatialReferenceUtils ./xmlUtilities ../rasterTransforms/PolynomialTransform ../../../geometry/SpatialReference".split(" "),
function(m,w,z,N,D,S,Q){function P(e,l){if(!e||!l)return null;const q=[];for(let t=0;t<e.length;t++)q.push(e[t]),q.push(l[t]);return q}function H(e){var l=D.getElement(e,"GeodataXform");e=D.getElementNumericValue(l,"SpatialReference/WKID")||D.getElementValue(l,"SpatialReference/WKT");e=u(e);if("typens:PolynomialXform"!==l.getAttribute("xsi:type"))return{spatialReference:e,transform:null};var q=D.getElementNumericValue(l,"PolynomialOrder")??1,t=D.getElementNumericValues(l,"CoeffX/Double");const h=
D.getElementNumericValues(l,"CoeffY/Double");var p=D.getElementNumericValues(l,"InverseCoeffX/Double");l=D.getElementNumericValues(l,"InverseCoeffY/Double");t=P(t,h);p=P(p,l);q=t&&p&&t.length&&p.length?new S({spatialReference:e,polynomialOrder:q,forwardCoefficients:t,inverseCoefficients:p}):null;return{spatialReference:e,transform:q}}function y(e){const l=D.getElementNumericValue(e,"NoDataValue");var q=D.getElement(e,"Histograms/HistItem");const t=D.getElementNumericValue(q,"HistMin"),h=D.getElementNumericValue(q,
"HistMax"),p=D.getElementNumericValue(q,"BucketCount");q=D.getElementValue(q,"HistCounts")?.split("|").map(b=>Number(b));let v,a,g,d;D.getElements(e,"Metadata/MDI").forEach(b=>{const f=Number(b.textContent??b.nodeValue);switch(b.getAttribute("key").toUpperCase()){case "STATISTICS_MINIMUM":v=f;break;case "STATISTICS_MAXIMUM":a=f;break;case "STATISTICS_MEAN":g=f;break;case "STATISTICS_STDDEV":d=f}});e=D.getElementNumericValue(e,"Metadata/SourceBandIndex");return{noDataValue:l,histogram:q?.length&&null!=
t&&null!=h?{min:t,max:h,size:p||q.length,counts:q}:null,sourceBandIndex:e,statistics:null!=v&&null!=a?{min:v,max:a,avg:g,stddev:d}:null}}function u(e){if(!e)return null;var l=Number(e);if(!isNaN(l)&&0!==l)return new Q({wkid:l});e=String(e).trim();if(N.isWKT2(e))return new Q({wkt2:e});var q=e.toUpperCase();if(q.startsWith("COMPD_CS")){if(!q.includes("VERTCS")||!q.includes("GEOGCS")&&!q.startsWith("PROJCS"))return null;l=q.indexOf("VERTCS");const t=q.indexOf("PROJCS");q=-1<t?t:q.indexOf("GEOGCS");if(-1===
q)return null;q=e.slice(q,e.lastIndexOf("]",l)+1).trim();e=e.slice(l,e.lastIndexOf("]")).trim();l=(l=c(q))?new Q({wkid:l}):new Q({wkt:q});if(e=c(e))l.vcsWkid=e;return l}if(!q.startsWith("GEOGCS")&&!q.startsWith("PROJCS"))return null;l=c(e);return 0!==l?new Q({wkid:l}):new Q({wkt:e})}function c(e){var l=e.replaceAll("]","[").replaceAll('"',"").split("[").map(t=>t.trim()).filter(t=>""!==t);l=l[l.length-1].split(",");const q=l[0]?.toLowerCase();return"epsg"!==q&&"esri"!==q||!e.endsWith('"]]')||(e=Number(l[1]),
isNaN(e)||0===e)?0:e}m.parsePAMInfo=function(e){if("pamdataset"!==e?.documentElement.tagName?.toLowerCase())return{};const l={spatialReference:null,transform:null,metadata:{},rasterBands:[],statistics:null,histograms:null};e.documentElement.childNodes.forEach(q=>{if(1===q.nodeType)if(D.isSameTagIgnoreNS(q,"SRS"))l.spatialReference||(q=D.getElementValue(q),l.spatialReference=u(q));else if(D.isSameTagIgnoreNS(q,"Metadata"))if("xml:ESRI"===q.getAttribute("domain")){const {spatialReference:t,transform:h}=
H(q);l.transform=h;l.spatialReference||(l.spatialReference=t)}else D.getElements(q,"MDI").forEach(t=>l.metadata[t.getAttribute("key")]=D.getElementValue(t));else D.isSameTagIgnoreNS(q,"PAMRasterBand")&&(q=y(q),null!=q.sourceBandIndex&&null==l.rasterBands[q.sourceBandIndex]?l.rasterBands[q.sourceBandIndex]=q:l.rasterBands.push(q))});e=l.rasterBands;e.length&&(l.statistics=e[0].statistics?e.map(q=>q.statistics).filter(z.isSome):null,l.histograms=e[0].histogram?e.map(q=>q.histogram).filter(z.isSome):
null);return l};m.parseSpatialReference=u;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/xmlUtilities":function(){define(["exports"],function(m){function w(S,Q){if(!S||!Q)return[];var P=Q;Q.includes("/")?(P=Q.slice(0,Q.indexOf("/")),Q=Q.slice(Q.indexOf("/")+1)):Q="";const H=[];if(Q){S=w(S,P);for(P=0;P<S.length;P++)w(S[P],Q).forEach(y=>H.push(y));return H}Q=S.getElementsByTagNameNS("*",P);if(!Q||0===Q.length)return[];for(S=0;S<Q.length;S++)H.push(Q[S]||
Q.item(S));return H}function z(S,Q){if(!S||!Q)return null;let P=Q;Q.includes("/")?(P=Q.slice(0,Q.indexOf("/")),Q=Q.slice(Q.indexOf("/")+1)):Q="";S=w(S,P);return 0<S.length?Q?z(S[0],Q):S[0]:null}function N(S,Q=null){if(S=Q?z(S,Q):S)if(S=S.textContent||S.nodeValue)return S.trim();return null}function D(S,Q){S=w(S,Q);Q=[];let P;for(let H=0;H<S.length;H++)if(P=S[H].textContent||S[H].nodeValue)P=P.trim(),""!==P&&Q.push(P);return Q}m.getElement=z;m.getElementNumericValue=function(S,Q){S=N(S,Q);return Number(S)};
m.getElementNumericValues=function(S,Q){return D(S,Q).map(P=>Number(P))};m.getElementValue=N;m.getElementValues=D;m.getElements=w;m.getNodeNameIgnoreNS=function(S){return S.nodeName.slice(S.nodeName.lastIndexOf(":")+1)};m.getSpaceDelimitedNumericValues=function(S,Q=null){return N(S,Q)?.split(" ").map(P=>Number(P))??[]};m.isSameTagIgnoreNS=function(S,Q){S=S?.nodeName?.toLowerCase();Q=Q.toLowerCase();return S.slice(S.lastIndexOf(":")+1)===Q};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},
"esri/layers/support/rasterDatasets/ImageServerRaster":function(){define("../../../chunks/tslib.es6 ../../../geometry ../../../core/Error ../../../core/maybe ../../../core/urlUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../RasterInfo ../RasterStorageInfo ../TileInfo ../TilemapCache ./BaseRaster ../rasterFunctions/pixelUtils ../rasterTransforms/GCSShiftTransform ../../../rest/imageService/fetchRasterInfo ../../../geometry/SpatialReference ../../../geometry/Point ../../../geometry/Extent".split(" "),
function(m,w,z,N,D,S,Q,P,H,y,u,c,e,l,q,t,h,p,v,a,g){function d(b,f){if(!b)return null;const {minScale:k,maxScale:r,minLOD:B,maxLOD:A}=f;if(null!=B&&null!=A)return e.fromJSON({...b,lods:b.lods.filter(({level:n})=>null!=n&&n>=B&&n<=A)});if(0!==k&&0!==r){const n=k?Math.round(1E4*k)/1E4:Infinity,C=r?Math.round(1E4*r)/1E4:-Infinity;return e.fromJSON({...b,lods:b.lods.filter(E=>{E=Math.round(1E4*E.scale)/1E4;return E<=n&&E>=C})})}return e.fromJSON(b)}w=class extends q{constructor(){super(...arguments);
this._levelOffset=0;this._slices=this._tilemapCache=null;this.datasetFormat="RasterTileServer";this.tileType=null}async open(b){await this.init();var f=b?.signal;b=this.sourceJSON?{data:this.sourceJSON}:await this.request(this.url,{query:{f:"json"},signal:f});b.ssl&&(this.url=this.url.replace(/^http:/i,"https:"));this.sourceJSON=b=b.data;if(!b)throw new z("imageserverraster:open","cannot initialize tiled image service, missing service info");if(!b.tileInfo)throw new z("imageserverraster:open","use ImageryLayer to open non-tiled image services");
this._fixScaleInServiceInfo();var k="jpg jpeg png png8 png24 png32 mixed".split(" ");this.tileType=b.cacheType;null==this.tileType&&(k.includes(b.tileInfo.format.toLowerCase())?this.tileType="Map":"lerc"===b.tileInfo.format.toLowerCase()?this.tileType="Elevation":this.tileType="Raster");this.datasetName=b.name?.slice(b.name.indexOf("/")+1)??"";f=await this._fetchRasterInfo({signal:f});if(null==f)throw new z("image-server-raster:open","cannot initialize image service");p.patchServiceInfo(f,b);k="Map"===
this.tileType?d(b.tileInfo,b):e.fromJSON(b.tileInfo);N.assertIsSome(k);const [r,B]=this._computeMinMaxLOD(f,k),{extent:A,pixelSize:n}=f,C=.5/f.width*n.x,E=Math.max(n.x,n.y),{lods:I}=k;if("Map"!==this.tileType&&0!==b.maxScale||Math.abs(n.x-n.y)>C||!I.some(T=>Math.abs(T.resolution-E)<C))n.x=n.y=r.resolution,f.width=Math.ceil((A.xmax-A.xmin)/n.x-.1),f.height=Math.ceil((A.ymax-A.ymin)/n.y-.1);const M=r.level-B.level,[U,F]=k.size,x=[],K=[];I.forEach((T,X)=>{T.level>=B.level&&T.level<=r.level&&x.push({x:T.resolution,
y:T.resolution});X<I.length-1&&K.push(Math.round(10*T.resolution/I[X+1].resolution)/10)});x.sort((T,X)=>T.x-X.x);const J=this.computeBlockBoundary(A,U,F,k.origin,x,M),G=1<x.length?x.slice(1):null;var O;b.transposeInfo&&(O={tileSize:[b.transposeInfo.rows,b.transposeInfo.cols],packetSize:f.keyProperties?._yxs.PacketSize??0});const R=1>=K.length||3<=K.length&&K.slice(0,-1).every(T=>T===K[0])?K[0]??2:Math.round(10/(B.resolution/r.resolution)**(-1/M))/10;f.storageInfo=new c({blockWidth:k.size[0],blockHeight:k.size[1],
pyramidBlockWidth:k.size[0],pyramidBlockHeight:k.size[1],pyramidResolutions:G,pyramidScalingFactor:R,compression:k.format,origin:k.origin,firstPyramidLevel:1,maximumPyramidLevel:M,tileInfo:k,transposeInfo:O,blockBoundary:J});this._fixGCSShift(f);this._set("rasterInfo",f);b.capabilities.toLowerCase().includes("tilemap")&&(O={tileInfo:f.storageInfo.tileInfo,parsedUrl:D.urlToObject(this.url),url:this.url,tileServers:[]},this._tilemapCache=new l.TilemapCache({layer:O}))}async fetchRawTile(b,f,k,r={}){const {storageInfo:B,
extent:A}=this.rasterInfo;var {transposeInfo:n}=B,C=null!=n&&!!r.transposedVariableName;if(this._slices&&!C&&null==r.sliceId)return null;({data:r}=await this.request(`${this.url}/tile/${C?0:B.maximumPyramidLevel-b+this._levelOffset}/${f}/${k}`,{query:this._slices?C?{variable:r.transposedVariableName}:{sliceId:r.sliceId||0}:null,responseType:"array-buffer",signal:r.signal}));if(!r)return null;n=C?n.tileSize:B.tileInfo.size;C=await this.decodePixelBlock(r,{width:n[0],height:n[1],planes:null,pixelType:null,
isPoint:"Elevation"===this.tileType,returnInterleaved:C,noDataValue:this.rasterInfo.noDataValue});if(null==C)return null;n=B.blockBoundary[b];if("jpg"!==B.compression||k>n.minCol&&k<n.maxCol&&f>n.minRow&&f<n.maxRow)return C;const {origin:E,blockWidth:I,blockHeight:M}=B,{x:U,y:F}=this.getPyramidPixelSize(b);var x=Math.round((A.xmin-E.x)/U)%I;b=Math.round((A.xmax-E.x)/U)%I||I;var K=Math.round((E.y-A.ymax)/F)%M;r=Math.round((E.y-A.ymin)/F)%M||M;x=k===n.minCol?x:0;K=f===n.minRow?K:0;t.setValidBoundary(C,
{x,y:K},{width:(k===n.maxCol?b:I)-x,height:(f===n.maxRow?r:M)-K});return C}getSliceIndex(b){if(!this._slices||null==b||0===b.length)return null;for(let f=0;f<this._slices.length;f++){const k=this._slices[f].multidimensionalDefinition;if(k.length===b.length&&!k.some(r=>{var B=b.find(n=>r.variableName===n.variableName&&n.dimensionName===r.dimensionName);if(!B)return!0;const A=Array.isArray(r.values[0])?`${r.values[0][0]}-${r.values[0][1]}`:r.values[0];B=Array.isArray(B.values[0])?`${B.values[0][0]}-${B.values[0][1]}`:
B.values[0];return A!==B}))return f}return null}async fetchVariableStatisticsHistograms(b,f){var k=this.request(this.url+"/statistics",{query:{variable:b,f:"json"},signal:f}).then(r=>r.data?.statistics);b=this.request(this.url+"/histograms",{query:{variable:b,f:"json"},signal:f}).then(r=>r.data?.histograms);k=await Promise.all([k,b]);k[0]&&k[0].forEach(r=>{r.avg=r.mean;r.stddev=r.standardDeviation});k[1]?.[0]?.counts?.length||(k[1]=null);return{statistics:k[0]||null,histograms:k[1]||null}}async computeBestPyramidLevelForLocation(b,
f={}){if(!this._tilemapCache)return 0;b=this.identifyPixelLocation(b,0,f.datumTransformation);if(null===b)return null;let k=0;var {maximumPyramidLevel:r}=this.rasterInfo.storageInfo;r=r-k+this._levelOffset;const B=b.srcLocation;for(;0<=r;){try{if("available"===await this._tilemapCache.fetchAvailability(r,b.row,b.col,f))break}catch{}r--;k++;b=this.identifyPixelLocation(B,k,f.datumTransformation);if(null===b)return null}return-1===r||null==b?null:k}async _fetchRasterInfo(b){var f=this.sourceJSON;if("Map"===
this.tileType){b=f.fullExtent||f.extent;var k=Math.ceil((b.xmax-b.xmin)/f.pixelSizeX-.1);const r=Math.ceil((b.ymax-b.ymin)/f.pixelSizeY-.1),B=v.fromJSON(f.spatialReference||b.spatialReference);f=new a({x:f.pixelSizeX,y:f.pixelSizeY,spatialReference:B});return new u({width:k,height:r,bandCount:3,extent:g.fromJSON(b),spatialReference:B,pixelSize:f,pixelType:"u8",statistics:null,keyProperties:{DataType:"processed"}})}({signal:k}=b);b=p.fetchServiceRasterInfo(this.url,this.sourceJSON,{signal:k,query:this.ioConfig.customFetchParameters});
f=f.hasMultidimensions?this.request(`${this.url}/slices`,{query:{f:"json"},signal:k}).then(r=>r.data?.slices).catch(()=>null):null;f=await Promise.all([b,f]);this._slices=f[1];return f[0]}_fixScaleInServiceInfo(){const {sourceJSON:b}=this;b.minScale&&0>b.minScale&&(b.minScale=0);b.maxScale&&0>b.maxScale&&(b.maxScale=0)}_fixGCSShift(b){const {extent:f,spatialReference:k}=b;-1<f.xmin&&181<f.xmax&&k?.wkid&&k.isGeographic&&(b.nativeExtent=b.extent,b.transform=new h,b.extent=b.transform.forwardTransform(f))}_computeMinMaxLOD(b,
f){const {pixelSize:k}=b,r=.5/b.width*k.x;({lods:b}=f);var B=f.lodAt(Math.max.apply(null,b.map(E=>E.level)));f=f.lodAt(Math.min.apply(null,b.map(E=>E.level)));var {tileType:A}=this;if("Map"===A)return this._levelOffset=b[0].level,[B,f];if("Raster"===A)return[b.find(E=>E.resolution===k.x)??B,f];const {minScale:n,maxScale:C}=this.sourceJSON;A=B;0<C&&((A=b.find(E=>Math.abs(E.scale-C)<r))||(A=b.filter(E=>E.scale>C).sort((E,I)=>E.scale>I.scale?1:-1)[0]??B));B=f;0<n&&(B=b.find(E=>Math.abs(E.scale-n)<r)??
f,this._levelOffset=B.level-f.level);return[A,B]}};m.__decorate([S.property({type:String,json:{write:!0}})],w.prototype,"datasetFormat",void 0);m.__decorate([S.property()],w.prototype,"tileType",void 0);return w=m.__decorate([y.subclass("esri.layers.support.rasterDatasets.ImageServerRaster")],w)})},"esri/layers/support/TilemapCache":function(){define("exports ../../chunks/tslib.es6 ../../request ../../core/Accessor ../../core/ByteSizeUnit ../../core/Error ../../core/handleUtils ../../core/LRUCache ../../core/PooledArray ../../core/promiseUtils ../../core/reactiveUtils ../../core/scheduling ../../core/urlUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ./TileKey ./Tilemap".split(" "),
function(m,w,z,N,D,S,Q,P,H,y,u,c,e,l,q,t,h,p,v,a){var g;m.TilemapCache=g=class extends N{constructor(d){super(d);this._pendingTilemapRequests={};this.request=z;this.size=32;this._prefetchingEnabled=!0}initialize(){this._tilemapCache=new P.LRUCache(2*D.ByteSizeUnit.MEGABYTES);this.addHandles([u.watch(()=>{const {layer:d}=this;return[d?.parsedUrl,d?.tileServers,d?.apiKey,d?.customParameters]},()=>this._initializeTilemapDefinition(),u.initial)])}get effectiveMinLOD(){return this.minLOD??this.layer.tileInfo.lods[0].level}get effectiveMaxLOD(){return this.maxLOD??
this.layer.tileInfo.lods[this.layer.tileInfo.lods.length-1].level}fetchTilemap(d,b,f,k){if(!this.layer.tileInfo.lodAt(d)||d<this.effectiveMinLOD||d>this.effectiveMaxLOD)return Promise.reject(new S("tilemap-cache:level-unavailable",`Level ${d} is unavailable in the service`));const r=this._tmpTilemapDefinition;if(d=this._tilemapFromCache(d,b,f,r))return Promise.resolve(d);const B=k?.signal;k={...k,signal:null};return new Promise((A,n)=>{y.onAbort(B,()=>n(y.createAbortError()));const C=a.tilemapDefinitionId(r);
let E=this._pendingTilemapRequests[C];if(!E){E=a.Tilemap.fromDefinition(r,k).then(M=>{this._tilemapCache.put(C,M,M.byteSize);return M});const I=()=>{delete this._pendingTilemapRequests[C]};this._pendingTilemapRequests[C]=E;E.then(I,I)}E.then(A,n)})}getAvailability(d,b,f){return!this.layer.tileInfo.lodAt(d)||d<this.effectiveMinLOD||d>this.effectiveMaxLOD?"unavailable":(d=this._tilemapFromCache(d,b,f,this._tmpTilemapDefinition))?d.getAvailability(b,f):"unknown"}fetchAvailability(d,b,f,k){return!this.layer.tileInfo.lodAt(d)||
d<this.effectiveMinLOD||d>this.effectiveMaxLOD?Promise.reject(new S("tile-map:tile-unavailable","Tile is not available",{level:d,row:b,col:f})):this.fetchTilemap(d,b,f,k).catch(r=>r).then(r=>{if(r instanceof a.Tilemap){r=r.getAvailability(b,f);if("unavailable"===r)throw new S("tile-map:tile-unavailable","Tile is not available",{level:d,row:b,col:f});return r}if(y.isAbortError(r))throw r;return"unknown"})}fetchAvailabilityUpsample(d,b,f,k,r){k.level=d;k.row=b;k.col=f;const B=this.layer.tileInfo;B.updateTileInfo(k);
const A=this.fetchAvailability(d,b,f,r).catch(n=>{if(y.isAbortError(n))throw n;if(B.upsampleTile(k))return this.fetchAvailabilityUpsample(k.level,k.row,k.col,k,r);throw n;});this._fetchAvailabilityUpsamplePrefetch(k.id,d,b,f,r,A);return A}async _fetchAvailabilityUpsamplePrefetch(d,b,f,k,r,B){if(this._prefetchingEnabled&&null!=d){var A=`prefetch-${d}`;if(!this.hasHandles(A)){var n=new AbortController;B.then(()=>n.abort(),()=>n.abort());var C=!1;B=Q.makeHandle(()=>{C||(C=!0,n.abort())});this.addHandles(B,
A);await c.waitTicks(10,n.signal).catch(()=>{});C||(C=!0,this.removeHandles(A));if(!y.isAborted(n))for(d=new v.TileKey(d,b,f,k),r={...r,signal:n.signal},b=this.layer.tileInfo,f=0;g._prefetches.length<g._maxPrefetch&&b.upsampleTile(d);++f){const E=this.fetchAvailability(d.level,d.row,d.col,r);g._prefetches.push(E);k=()=>{g._prefetches.removeUnordered(E)};E.then(k,k)}}}}_initializeTilemapDefinition(){if(this.layer.parsedUrl){var {parsedUrl:d,apiKey:b,customParameters:f}=this.layer;this._tilemapCache.clear();
this._tmpTilemapDefinition={service:{url:d.path,query:e.objectToQuery({...d.query,...f,token:b??d.query?.token}),tileServers:this.layer.tileServers,request:this.request},width:this.size,height:this.size,level:0,row:0,col:0}}}_tilemapFromCache(d,b,f,k){k.level=d;k.row=b-b%this.size;k.col=f-f%this.size;d=a.tilemapDefinitionId(k);return this._tilemapCache.get(d)}get test(){const d=this;return{get prefetchingEnabled(){return d._prefetchingEnabled},set prefetchingEnabled(b){d._prefetchingEnabled=b},hasTilemap(b,
f,k){return!!d._tilemapFromCache(b,f,k,d._tmpTilemapDefinition)}}}};m.TilemapCache._maxPrefetch=4;m.TilemapCache._prefetches=new H({initialSize:g._maxPrefetch});w.__decorate([l.property({constructOnly:!0})],m.TilemapCache.prototype,"layer",void 0);w.__decorate([l.property({constructOnly:!0})],m.TilemapCache.prototype,"minLOD",void 0);w.__decorate([l.property({constructOnly:!0})],m.TilemapCache.prototype,"maxLOD",void 0);w.__decorate([l.property({constructOnly:!0})],m.TilemapCache.prototype,"request",
void 0);w.__decorate([l.property({constructOnly:!0})],m.TilemapCache.prototype,"size",void 0);m.TilemapCache=g=w.__decorate([p.subclass("esri.layers.support.TilemapCache")],m.TilemapCache);Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/core/ByteSizeUnit":function(){define(["exports"],function(m){m.ByteSizeUnit=void 0;var w=m.ByteSizeUnit||(m.ByteSizeUnit={});w[w.KILOBYTES=1024]="KILOBYTES";w[w.MEGABYTES=1048576]="MEGABYTES";w[w.GIGABYTES=1073741824]="GIGABYTES";Object.defineProperty(m,
Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/Tilemap":function(){define("exports ../../request ../../core/arrayUtils ../../core/Error ../../core/lang ../../core/typedArrayUtil ../../geometry/support/UintArray".split(" "),function(m,w,z,N,D,S,Q){function P(y){if(y.service.tileServers?.length){var u=y.service.tileServers;u=`${u&&u.length?u[y.row%u.length]:y.service.url}/tilemap/${y.level}/${y.row}/${y.col}/${y.width}/${y.height}`}else u=`${y.service.url}/tilemap/${y.level}/${y.row}/${y.col}/${y.width}/${y.height}`;
(y=y.service.query)&&(u=`${u}?${y}`);return u}class H{constructor(y){this._validateJSON(y);const {location:u,data:c}=y;this.location=Object.freeze(D.clone(u));let e=y=!0;const l=Q.newUintArray(Math.ceil(this.location.width*this.location.height/32));let q=0;for(let t=0;t<c.length;t++){const h=t%32;c[t]?(e=!1,l[q]|=1<<h):y=!1;31===h&&++q}e?(this._availability="unavailable",this.byteSize=40):y?(this._availability="available",this.byteSize=40):(this._availability=l,this.byteSize=40+S.estimateSize(l))}getAvailability(y,
u){if("unavailable"===this._availability||"available"===this._availability)return this._availability;y=(y-this.location.top)*this.location.width+(u-this.location.left);u=y>>5;const c=this._availability;return 0>u||u>c.length?"unknown":c[u]&1<<y%32?"available":"unavailable"}static fromDefinition(y,u){const c=y.service.request||w,{row:e,col:l,width:q,height:t}=y,h={query:{f:"json"}};u=u?{...h,...u}:h;return c(P(y),u).then(p=>p.data).catch(p=>{if(p&&p.details&&422===p.details.httpStatus)return{location:{top:e,
left:l,width:q,height:t},valid:!0,data:z.constant(q*t,0)};throw p;}).then(p=>{if(p.location&&(p.location.top!==e||p.location.left!==l||p.location.width!==q||p.location.height!==t))throw new N("tilemap:location-mismatch","Tilemap response for different location than requested",{response:p,definition:{top:e,left:l,width:q,height:t}});return H.fromJSON(p)})}static fromJSON(y){return Object.freeze(new H(y))}_validateJSON(y){if(!y?.location)throw new N("tilemap:missing-location","Location missing from tilemap response");
if(!1===y.valid)throw new N("tilemap:invalid","Tilemap response was marked as invalid");if(!y.data)throw new N("tilemap:missing-data","Data missing from tilemap response");if(!Array.isArray(y.data))throw new N("tilemap:data-mismatch","Data must be an array of numbers");if(y.data.length!==y.location.width*y.location.height)throw new N("tilemap:data-mismatch","Number of data items does not match width/height of tilemap");}}m.Tilemap=H;m.tilemapDefinitionId=function(y){return`${y.level}/${y.row}/${y.col}/${y.width}/${y.height}`};
Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/UintArray":function(){define(["exports","../../core/typedArrayUtil"],function(m,w){m.newUintArray=function(z,N=!1){return z<=w.nativeArrayMaxSize?N?Array(z).fill(0):Array(z):new Uint32Array(z)};m.uintArrayFrom=function(z){return(w.isArray(z)?z.length:z.byteLength/8)<=w.nativeArrayMaxSize?Array.from(z):new Uint32Array(z)};m.uintSubArray=function(z,N,D){return Array.isArray(z)?z.slice(N,N+D):z.subarray(N,N+D)};Object.defineProperty(m,
Symbol.toStringTag,{value:"Module"})})},"esri/rest/imageService/fetchRasterInfo":function(){define("exports ../../request ../../geometry/Extent ../../geometry/Point ../../geometry/SpatialReference ../../layers/support/RasterInfo ../utils ../support/FeatureSet".split(" "),function(m,w,z,N,D,S,Q,P){async function H(y,u,c){y=Q.parseUrl(y);const {rasterFunction:e,sourceJSON:l}=u||{};u=e?JSON.stringify(e.rasterFunctionDefinition||e):null;u=Q.encode({...y.query,renderingRule:u,f:"json"});u=Q.asValidOptions(u,
c);y=y.path;c=l||await w(y,u).then(k=>k.data);var q=c.hasRasterAttributeTable?w(`${y}/rasterAttributeTable`,u):null,t=c.hasColormap?w(`${y}/colormap`,u):null,h=c.hasHistograms?w(`${y}/histograms`,u):null,p=10.3<=c.currentVersion?w(`${y}/keyProperties`,u):null;y=c.hasMultidimensions?w(`${y}/multidimensionalInfo`,u):null;q=await Promise.allSettled([q,t,h,p,y]);y=null;if(c.minValues&&c.minValues.length===c.bandCount)for(y=[],u=0;u<c.minValues.length;u++)y.push({min:c.minValues[u],max:c.maxValues[u],
avg:c.meanValues[u],stddev:c.stdvValues[u]});t=z.fromJSON(c.extent);u=Math.ceil(t.width/c.pixelSizeX-.1);t=Math.ceil(t.height/c.pixelSizeY-.1);h=D.fromJSON(c.spatialReference||c.extent.spatialReference);p="fulfilled"===q[0].status?q[0].value?.data:null;p=p?.features?.length?P.fromJSON(p):null;var v="fulfilled"===q[1].status?q[1].value?.data.colormap:null;v=v?.length?v:null;var a="fulfilled"===q[2].status?q[2].value?.data.histograms:null;a=a?.[0]?.counts?.length?a:null;const g="fulfilled"===q[3].status?
q[3].value?.data??{}:{};q="fulfilled"===q[4].status?q[4].value?.data.multidimensionalInfo:null;(q=q?.variables?.length?q:null)&&q.variables.forEach(k=>{k.statistics?.length&&k.statistics.forEach(r=>{r.avg=r.mean;r.stddev=r.standardDeviation})});const {defaultVariable:d,serviceDataType:b}=c;d&&d!==g.DefaultVariable&&(g.DefaultVariable=d);b?.includes("esriImageServiceDataTypeVector")&&!b.includes(g.DataType)&&(g.DataType=b.replace("esriImageServiceDataType",""));let f=c.noDataValue;c.noDataValues?.length&&
c.noDataValues.some(k=>k!==f)&&(f=c.noDataValues);return new S({width:u,height:t,bandCount:c.bandCount,extent:z.fromJSON(c.extent),spatialReference:h,pixelSize:new N({x:c.pixelSizeX,y:c.pixelSizeY,spatialReference:h}),pixelType:c.pixelType.toLowerCase(),statistics:y,attributeTable:p,colormap:v,histograms:a,keyProperties:g,noDataValue:f,multidimensionalInfo:q})}m.fetchServiceRasterInfo=function(y,u,c){return H(y,{sourceJSON:u},c)};m.generateRasterInfo=function(y,u,c){return H(y,{rasterFunction:u},
c)};m.patchServiceInfo=function(y,u){y.attributeTable||(u.hasRasterAttributeTable=!1);y.histograms||(u.hasHistograms=!1);y.colormap||(u.hasColormap=!1);y.multidimensionalInfo||(u.hasMultidimensions=!1)};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/MRFRaster":function(){define("../../../chunks/tslib.es6 ../../../geometry ../../../core/Error ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../PixelBlock ../RasterInfo ../RasterStorageInfo ./BaseRaster ./pamParser ./xmlUtilities ../rasterFormats/utils ../rasterFunctions/stretchUtils ../../../geometry/SpatialReference ../../../geometry/Extent ../../../geometry/Point".split(" "),
function(m,w,z,N,D,S,Q,P,H,y,u,c,e,l,q,t,h,p,v){const a=new Map;a.set("Int8","s8");a.set("UInt8","u8");a.set("Int16","s16");a.set("UInt16","u16");a.set("Int32","s32");a.set("UInt32","u32");a.set("Float32","f32");a.set("Float64","f32");a.set("Double64","f32");const g=new Map;g.set("none",{blobExtension:".til",isOneSegment:!0,decoderFormat:"bip"});g.set("lerc",{blobExtension:".lrc",isOneSegment:!1,decoderFormat:"lerc"});g.set("deflate",{blobExtension:".pzp",isOneSegment:!0,decoderFormat:"deflate"});
g.set("jpeg",{blobExtension:".pjg",isOneSegment:!0,decoderFormat:"jpg"});w=class extends c{constructor(){super(...arguments);this._storageIndex=this._files=null;this.datasetFormat="MRF"}async open(d){await this.init();this.datasetName=this.url.slice(this.url.lastIndexOf("/")+1);var b=d?d.signal:null,f=await this.request(this.url,{responseType:"xml",signal:b});const {rasterInfo:k,files:r}=this._parseHeader(f.data);-1===this.ioConfig.skipExtensions?.indexOf("aux.xml")&&(d=await this._fetchAuxiliaryData(d),
null!=d&&(k.statistics=d.statistics??k.statistics,(k.histograms=d.histograms)&&null==k.statistics&&(k.statistics=t.estimateStatisticsFromHistograms(d.histograms))));this._set("rasterInfo",k);this._files=r;b=await this.request(r.index,{responseType:"array-buffer",signal:b});this._storageIndex=this._parseIndex(b.data);const {blockWidth:B,blockHeight:A}=this.rasterInfo.storageInfo;b=this.rasterInfo.storageInfo.pyramidScalingFactor;const {width:n,height:C}=this.rasterInfo;d=[];f=this._getBandSegmentCount();
let E=0,I=-1;for(;E<this._storageIndex.length;){I++;const M=Math.ceil(n/B/b**I)-1,U=Math.ceil(C/A/b**I)-1;E+=(M+1)*(U+1)*f*4;d.push({maxRow:U,maxCol:M,minCol:0,minRow:0})}this.rasterInfo.storageInfo.blockBoundary=d;0<I&&(this.rasterInfo.storageInfo.firstPyramidLevel=1,this.rasterInfo.storageInfo.maximumPyramidLevel=I);this.updateTileInfo()}async fetchRawTile(d,b,f,k={}){const {blockWidth:r,blockHeight:B,blockBoundary:A}=this.rasterInfo.storageInfo;var n=A[d];if(!n||n.maxRow<b||n.maxCol<f||n.minRow>
b||n.minCol>f)return null;const {bandCount:C,pixelType:E}=this.rasterInfo,{ranges:I,actualTileWidth:M,actualTileHeight:U}=this._getTileLocation(d,b,f);if(!I||0===I.length)return null;if(0===I[0].from&&0===I[0].to)return d=new Uint8Array(r*B),new H({width:r,height:B,pixels:null,mask:d,validPixelCount:0});({bandIds:b}=this.ioConfig);f=this._getBandSegmentCount();n=[];for(d=d=0;d<f;d++)b&&!b.includes(d)||n.push(this.request(this._files.data,{range:{from:I[d].from,to:I[d].to},responseType:"array-buffer",
signal:k.signal}));k=await Promise.all(n);d=k.map(x=>x.data.byteLength).reduce((x,K)=>x+K);n=new Uint8Array(d);let F=0;for(d=0;d<f;d++)n.set(new Uint8Array(k[d].data),F),F+=k[d].data.byteLength;d=g.get(this.rasterInfo.storageInfo.compression).decoderFormat;b=await this.decodePixelBlock(n.buffer,{width:r,height:B,format:d,planes:b?.length||C,pixelType:E});if(null==b)return null;({noDataValue:k}=this.rasterInfo);if(null!=k&&"lerc"!==d&&!b.mask&&(k=k[0],null!=k)){f=b.width*b.height;n=new Uint8Array(f);
if(1E24<Math.abs(k))for(d=0;d<f;d++)1E-6<Math.abs((b.pixels[0][d]-k)/k)&&(n[d]=1);else for(d=0;d<f;d++)b.pixels[0][d]!==k&&(n[d]=1);b.mask=n}f=k=0;if(M!==r||U!==B)if(n=b.mask)for(d=0;d<B;d++)for(f=d*r,k=d<U?M:0;k<r;k++)n[f+k]=0;else for(n=new Uint8Array(r*B),b.mask=n,d=0;d<U;d++)for(f=d*r,k=0;k<M;k++)n[f+k]=1;return b}_parseIndex(d){if(0<d.byteLength%16)throw Error("invalid array buffer must be multiples of 16");let b,f,k,r,B;if(q.isPlatformLittleEndian){b=new Uint8Array(d);k=new ArrayBuffer(d.byteLength);
f=new Uint8Array(k);for(r=0;r<d.byteLength/4;r++)for(B=0;4>B;B++)f[4*r+B]=b[4*r+3-B];d=new Uint32Array(k)}else d=new Uint32Array(d);return d}_getBandSegmentCount(){return g.get(this.rasterInfo.storageInfo.compression).isOneSegment?1:this.rasterInfo.bandCount}_getTileLocation(d,b,f){const {blockWidth:k,blockHeight:r,pyramidScalingFactor:B}=this.rasterInfo.storageInfo,{width:A,height:n}=this.rasterInfo,C=this._getBandSegmentCount();let E,I;var M,U=0;let F=0;for(M=0;M<d;M++)F=B**M,E=Math.ceil(A/k/F),
I=Math.ceil(n/r/F),U+=E*I;F=B**d;E=Math.ceil(A/k/F);I=Math.ceil(n/r/F);U=4*(U+(b*E+f))*C;d=this._storageIndex.subarray(U,U+4*C);U=M=0;const x=[];for(let K=0;K<C;K++)M=d[4*K]*2**32+d[4*K+1],U=M+d[4*K+2]*2**32+d[4*K+3],x.push({from:M,to:U});return{ranges:x,actualTileWidth:f<E-1?k:Math.ceil(A/F)-k*(E-1),actualTileHeight:b<I-1?r:Math.ceil(n/F)-r*(I-1)}}_parseHeader(d){var b=l.getElement(d,"MRF_META/Raster");if(!b)throw new z("mrf:open","not a valid MRF format");var f=l.getElement(b,"Size"),k=parseInt(f.getAttribute("x"),
10),r=parseInt(f.getAttribute("y"),10);const B=parseInt(f.getAttribute("c"),10);f=(l.getElementValue(b,"Compression")||"none").toLowerCase();if(!g.has(f))throw new z("mrf:open","currently does not support compression "+f);var A=l.getElementValue(b,"DataType")||"UInt8";const n=a.get(A);if(null==n)throw new z("mrf:open","currently does not support pixel type "+A);var C=l.getElement(b,"PageSize");A=parseInt(C.getAttribute("x"),10);C=parseInt(C.getAttribute("y"),10);b=l.getElement(b,"DataValues");let E;
b&&(b=b.getAttribute("NoData"),null!=b&&(E=b.trim().split(" ").map(J=>parseFloat(J))));if(l.getElement(d,"MRF_META/CachedSource"))throw new z("mrf:open","currently does not support MRF referencing other data files");var I=l.getElement(d,"MRF_META/GeoTags"),M=l.getElement(I,"BoundingBox");b=!1;if(null!=M){var U=parseFloat(M.getAttribute("minx"));var F=parseFloat(M.getAttribute("miny")),x=parseFloat(M.getAttribute("maxx"));M=parseFloat(M.getAttribute("maxy"));var K=l.getElementValue(I,"Projection")||
"";I=h.WGS84;"LOCAL_CS[]"!==K?K.toLowerCase().startsWith("epsg:")?(K=Number(K.slice(5)),isNaN(K)||0===K||(I=new h({wkid:K}))):I=e.parseSpatialReference(K)??h.WGS84:(b=!0,I=new h({wkid:3857}));U=new p(U,F,x,M);U.spatialReference=I}else b=!0,U=new p({xmin:-.5,ymin:.5-r,xmax:k-.5,ymax:.5,spatialReference:new h({wkid:3857})});F=l.getElement(d,"MRF_META/Rsets");x=parseInt(F?.getAttribute("scale")||"2",10);F=U.spatialReference;A=new u({origin:new v({x:U.xmin,y:U.ymax,spatialReference:F}),blockWidth:A,blockHeight:C,
pyramidBlockWidth:A,pyramidBlockHeight:C,compression:f,pyramidScalingFactor:x});C=new v({x:U.width/k,y:U.height/r,spatialReference:F});k=new y({width:k,height:r,extent:U,isPseudoSpatialReference:b,spatialReference:F,bandCount:B,pixelType:n,pixelSize:C,noDataValue:E,storageInfo:A});r=l.getElementValue(d,"datafile");d=l.getElementValue(d,"IndexFile");d={mrf:this.url,index:d||this.url.replace(".mrf",".idx"),data:r||this.url.replace(".mrf",g.get(f).blobExtension)};return{rasterInfo:k,files:d}}async _fetchAuxiliaryData(d){try{const {data:b}=
await this.request(this.url+".aux.xml",{responseType:"xml",signal:d?.signal});return e.parsePAMInfo(b)}catch{return null}}};m.__decorate([N.property()],w.prototype,"_files",void 0);m.__decorate([N.property()],w.prototype,"_storageIndex",void 0);m.__decorate([N.property({type:String,json:{write:!0}})],w.prototype,"datasetFormat",void 0);return w=m.__decorate([P.subclass("esri.layers.support.rasterIO.MRFRaster")],w)})},"esri/layers/support/rasterDatasets/TIFFRaster":function(){define("../../../chunks/tslib.es6 ../../../geometry ../../../core/arrayUtils ../../../core/Error ../../../core/Logger ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/has ../../../core/accessorSupport/decorators/subclass ../RasterInfo ../RasterStorageInfo ./BaseRaster ./DBFParser ./pamParser ../rasterFormats/TiffDecoder ../rasterFormats/TiffTags ../rasterFunctions/stretchUtils ../rasterTransforms/PolynomialTransform ../../../rest/support/FeatureSet ../../../geometry/SpatialReference ../../../geometry/Extent ../../../geometry/Point".split(" "),
function(m,w,z,N,D,S,Q,P,H,y,u,c,e,l,q,t,h,p,v,a,g,d){w=class extends c{constructor(){super(...arguments);this._headerInfo=this._files=null;this._bufferSize=1048576;this.datasetFormat="TIFF"}async open(b){await this.init();var f=b?b.signal:null,{data:k}=await this.request(this.url,{range:{from:0,to:this._bufferSize},responseType:"array-buffer",signal:f});if(!k)throw new N("tiffraster:open","failed to open url "+this.url);this.datasetName=this.url.slice(this.url.lastIndexOf("/")+1,this.url.lastIndexOf("."));
const {littleEndian:r,firstIFDPos:B,isBigTiff:A}=q.parseSignature(k);var n=[];await this._readIFDs(n,k,r,B,0,A?8:4,f);const {imageInfo:C,rasterInfo:E}=this._parseIFDs(n);f=q.getPyramidIFDs(n);k=q.getMaskIFDs(n);this._headerInfo={littleEndian:r,isBigTiff:A,ifds:n,pyramidIFDs:f,maskIFDs:k,...C};this._set("rasterInfo",E);if(!C.isSupported)throw new N("tiffraster:open","this tiff is not supported: "+C.message);if(!C.tileWidth)throw new N("tiffraster:open","none-tiled tiff is not optimized for access, convert to COG and retry.");
E.isPseudoSpatialReference&&D.getLogger(this).warn("The spatial reference for this tiff is unsupported. Only EPSG spatial reference codes and Esri WKTs are supported.");f=n[0].get("PREDICTOR")?.values?.[0];if(3===n[0].get("SAMPLEFORMAT")?.values?.[0]&&2===f)throw new N("tiffraster:open","unsupported horizontal difference encoding. Predictor\x3d3 is supported for floatting point data");({skipExtensions:n=[]}=this.ioConfig);n.includes("aux.xml")||(f=await this._fetchAuxiliaryMetaData(b),null!=f&&this._processPAMInfo(f,
E));n.includes("vat.dbf")||1!==E.bandCount||"u8"!==E.pixelType||(E.attributeTable=await this._fetchAuxiliaryTable(b),null!=E.attributeTable&&(E.keyProperties.DataType="thematic"));this.updateTileInfo()}async fetchRawTile(b,f,k,r={}){if(!this._headerInfo?.isSupported||this.isBlockOutside(b,f,k))return null;const B=await this._fetchRawTiffTile(b,f,k,!1,r);null!=B&&this._headerInfo.hasMaskBand&&(b=await this._fetchRawTiffTile(b,f,k,!0,r),null!=b&&b.pixels[0]instanceof Uint8Array&&(B.mask=b.pixels[0]));
return B}_parseIFDs(b){const f=q.getImageInfo(b),{width:k,height:r,tileWidth:B,tileHeight:A,planes:n,pixelType:C,compression:E,firstPyramidLevel:I,maximumPyramidLevel:M,pyramidBlockWidth:U,pyramidBlockHeight:F,tileBoundary:x,affine:K,metadata:J}=f;let G=l.parseSpatialReference(f.extent.spatialReference?.wkt||f.extent.spatialReference?.wkid);var O=!!f.isPseudoGeographic;null==G&&(O=!0,G=new a({wkid:3857}));const R=new g({...f.extent,spatialReference:G});var T=R?new d({x:R.xmin,y:R.ymax,spatialReference:G}):
new d({x:0,y:0});T=new u({blockWidth:B,blockHeight:A,pyramidBlockWidth:U,pyramidBlockHeight:F,compression:E,origin:T,firstPyramidLevel:I,maximumPyramidLevel:M,blockBoundary:x});const X=new d({x:(R.xmax-R.xmin)/k,y:(R.ymax-R.ymin)/r,spatialReference:G}),L=J?{BandProperties:J.bandProperties,DataType:J.dataType}:{};let V=null;var W=b[0].get("PHOTOMETRICINTERPRETATION")?.values?.[0];b=b[0].get("COLORMAP")?.values;if(3>=W&&3<b?.length&&0===b.length%3){V=[];W=b.length/3;for(let Y=0;Y<W;Y++)V.push([Y,b[Y]>>>
8,b[Y+W]>>>8,b[Y+2*W]>>>8])}O=new y({width:k,height:r,bandCount:n,pixelType:C,pixelSize:X,storageInfo:T,spatialReference:G,isPseudoSpatialReference:O,keyProperties:L,extent:R,colormap:V,statistics:J?J.statistics:null});K?.length&&(O.nativeExtent=new g({xmin:-.5,ymin:.5-r,xmax:k-.5,ymax:.5,spatialReference:G}),O.transform=new p({polynomialOrder:1,forwardCoefficients:[K[2]+K[0]/2,K[5]-K[3]/2,K[0],K[3],-K[1],-K[4]]}),O.extent=O.transform.forwardTransform(O.nativeExtent),O.pixelSize=new d({x:(R.xmax-
R.xmin)/k,y:(R.ymax-R.ymin)/r,spatialReference:G}),T.origin.x=-.5,T.origin.y=.5);return{imageInfo:f,rasterInfo:O}}_processPAMInfo(b,f){f.statistics=b.statistics??f.statistics;(f.histograms=b.histograms)&&null==f.statistics&&(f.statistics=h.estimateStatisticsFromHistograms(b.histograms));if(b.transform&&null==f.transform){f.transform=b.transform;f.nativeExtent=f.extent;const k=f.transform.forwardTransform(f.nativeExtent);f.pixelSize=new d({x:(k.xmax-k.xmin)/f.width,y:(k.ymax-k.ymin)/f.height,spatialReference:f.spatialReference});
f.extent=k}f.isPseudoSpatialReference&&b.spatialReference&&(f.spatialReference=b.spatialReference,f.extent.spatialReference=f.nativeExtent.spatialReference=f.storageInfo.origin.spatialReference=f.spatialReference)}async _readIFDs(b,f,k,r,B,A=4,n){if(!r)return null;if(r>=f.byteLength||0>r)f=(await this.request(this.url,{range:{from:r+B,to:r+B+this._bufferSize},responseType:"array-buffer",signal:n})).data,B=r+B,r=0;r=await this._readIFD(f,k,r,B,t.tiffTags,A,n);b.push(r.ifd);if(!r.nextIFD)return null;
await this._readIFDs(b,f,k,r.nextIFD-B,B,A,n)}async _readIFD(b,f,k,r,B=t.tiffTags,A=4,n){if(!b)return null;k=q.parseIFD(b,f,k,r,B,A);if(k.success){const C=[];k.ifd?.forEach(E=>{E.values||C.push(E)});0<C.length&&(A=C.map(E=>E.offlineOffsetSize).filter(z.isSome),B=Math.min.apply(null,A.map(E=>E[0])),Math.min.apply(null,A.map(E=>E[0]+E[1]))-B<=this._bufferSize&&({data:A}=await this.request(this.url,{range:{from:B,to:B+this._bufferSize},responseType:"array-buffer",signal:n}),b=A,r=B,C.forEach(E=>q.parseFieldValues(b,
f,E,r))));k.ifd?.has("GEOKEYDIRECTORY")&&(B=k.ifd.get("GEOKEYDIRECTORY"),(A=B?.values)&&4<A.length&&(A=A[0]+"."+A[1]+"."+A[2],n=await this._readIFD(b,f,B.valueOffset+6-r,r,t.geoKeys,2,n),B.data=n.ifd,B.data&&B.data.set("GEOTIFFVersion",{id:0,type:2,valueCount:1,valueOffset:null,values:[A]})));return k}if(k.requiredBufferSize&&k.requiredBufferSize!==b.byteLength)return b=(await this.request(this.url,{range:{from:r,to:r+k.requiredBufferSize+4},responseType:"array-buffer",signal:n})).data,b.byteLength<
k.requiredBufferSize?null:this._readIFD(b,f,0,r,t.tiffTags,4,n)}async _fetchRawTiffTile(b,f,k,r,B={}){f=this._getTileLocation(b,f,k,r);if(!f)return null;const {ranges:A,actualTileWidth:n,actualTileHeight:C,ifd:E}=f;f=A.map(F=>this.request(this.url,{range:F,responseType:"array-buffer",signal:B.signal}));f=await Promise.all(f);k=f.map(F=>F.data.byteLength).reduce((F,x)=>F+x);k=1===f.length?f[0].data:new ArrayBuffer(k);r=[0];var I=[0];if(1<f.length){const F=new Uint8Array(k);for(let x=0,K=0;x<f.length;x++){const J=
f[x].data;F.set(new Uint8Array(J),K);r[x]=K;K+=J.byteLength;I[x]=J.byteLength}}const {blockWidth:M,blockHeight:U}=this.getBlockWidthHeight(b);b=await this.decodePixelBlock(k,{format:"tiff",customOptions:{headerInfo:this._headerInfo,ifd:E,offsets:r,sizes:I},width:M,height:U,planes:null,pixelType:null});if(null==b)return null;if(n!==M||C!==U)if(I=b.mask)for(f=0;f<U;f++)for(r=f*M,k=f<C?n:0;k<M;k++)I[r+k]=0;else for(I=new Uint8Array(M*U),b.mask=I,f=0;f<C;f++)for(r=f*M,k=0;k<n;k++)I[r+k]=1;return b}_getTileLocation(b,
f,k,r=!1){const {firstPyramidLevel:B,blockBoundary:A}=this.rasterInfo.storageInfo;var n=0===b?0:b-(B-1);({_headerInfo:b}=this);if(!b)return null;r=r?b.maskIFDs[n]:0===n?b?.ifds[0]:b?.pyramidIFDs[n-1];if(!r)return null;var C=q.isBSQConfig(r,b);b=r.get("TILEOFFSETS")?.values;if(void 0===b)return null;const E=r.get("TILEBYTECOUNTS")?.values,{minRow:I,minCol:M,maxRow:U,maxCol:F}=A[n];if(f>U||k>F||f<I||k<M)return null;n=r.get("IMAGEWIDTH")?.values?.[0];const x=r.get("IMAGELENGTH")?.values?.[0],K=r.get("TILEWIDTH")?.values?.[0],
J=r.get("TILELENGTH")?.values?.[0],G=[];if(C){({bandCount:C}=this.rasterInfo);for(let O=0;O<C;O++){const R=O*(U+1)*(F+1)+f*(F+1)+k;G[O]={from:b[R],to:b[R]+E[R]-1}}}else C=f*(F+1)+k,G.push({from:b[C],to:b[C]+E[C]-1});for(b=0;b<G.length;b++)if(null==G[b].from||!G[b].to||0>G[b].to)return null;return{ranges:G,ifd:r,actualTileWidth:k===F?n%K||K:K,actualTileHeight:f===U?x%J||J:J}}async _fetchAuxiliaryMetaData(b){try{const {data:f}=await this.request(this.url+".aux.xml",{responseType:"xml",signal:b?.signal});
return l.parsePAMInfo(f)}catch{return null}}async _fetchAuxiliaryTable(b){try{const {data:f}=await this.request(this.url+".vat.dbf",{responseType:"array-buffer",signal:b?.signal}),k=e.parse(f);return k?.recordSet?v.fromJSON(k.recordSet):null}catch{return null}}};m.__decorate([S.property()],w.prototype,"_files",void 0);m.__decorate([S.property()],w.prototype,"_headerInfo",void 0);m.__decorate([S.property()],w.prototype,"_bufferSize",void 0);m.__decorate([S.property({type:String,json:{write:!0}})],
w.prototype,"datasetFormat",void 0);return w=m.__decorate([H.subclass("esri.layers.support.rasterDatasets.TIFFRaster")],w)})},"*noref":1}});
define("require ../chunks/tslib.es6 ../PopupTemplate ../core/Clonable ../core/Error ../core/Logger ../core/MultiOriginJSONSupport ../core/promiseUtils ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/subclass ./Layer ./mixins/ArcGISService ./mixins/BlendLayer ./mixins/CustomParametersMixin ./mixins/ImageryTileMixin ./mixins/OperationalLayer ./mixins/PortalLayer ./mixins/RefreshableLayer ./mixins/ScaleRangeLayer ./mixins/TemporalLayer ./support/commonProperties ./support/Field ./support/rasterEnums ./support/RasterFunction ./support/rasterDatasets/FunctionRaster ./support/rasterDatasets/RasterFactory ./support/rasterFunctions/rasterFunctionHelper ../support/popupUtils ../webdoc/interfaces".split(" "),function(m,
w,z,N,D,S,Q,P,H,y,u,c,e,l,q,t,h,p,v,a,g,d,b,f,k,r,B,A,n,C,E,I,M,U){N=class extends p.BlendLayer(f.ScaleRangeLayer(g.OperationalLayer(d.PortalLayer(v.CustomParametersMixin(a.ImageryTileMixin(k.TemporalLayer(h.ArcGISService(b.RefreshableLayer(Q.MultiOriginJSONMixin(N.ClonableMixin(t))))))))))){constructor(...F){super(...F);this._primaryRasters=[];this.interpolation=this.bandIds=null;this.legendEnabled=!0;this.isReference=null;this.listMode="show";this.version=this.sourceJSON=null;this.type="imagery-tile";
this.operationalLayerType="ArcGISTiledImageServiceLayer";this.popupEnabled=!0;this.fields=this.popupTemplate=null;this._debouncedSaveOperations=P.debounce(async(x,K,J)=>{const {save:G,saveAs:O}=await new Promise((R,T)=>m(["./save/imageryUtils"],R,T));switch(x){case U.SaveOperationType.SAVE:return G(this,K);case U.SaveOperationType.SAVE_AS:return O(this,J,K)}})}normalizeCtorArgs(F,x){return"string"===typeof F?{url:F,...x}:F}load(F){const x=null!=F?F.signal:null;this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Image Service"]},
F).catch(P.throwIfAbortError).then(()=>this._openRaster(x)));return Promise.resolve(this)}get defaultPopupTemplate(){return this.createPopupTemplate()}get rasterFields(){var F=new B({name:"Raster.ServicePixelValue",alias:"Pixel Value",domain:null,editable:!1,length:50,type:"string"}),x=new B({name:"Raster.ServicePixelValue.Raw",alias:"Raw Pixel Value",domain:null,editable:!1,length:50,type:"string"});F=[F,x];({rasterInfo:x}=this);var K=x?.attributeTable;if(K=null!=K?K.fields:null)K=K.filter(J=>"oid"!==
J.type&&"value"!==J.name.toLowerCase()).map(J=>{const G=J.clone();G.name="Raster."+J.name;return G}),F.push(...K);K=x?.dataType;x=x?.multidimensionalInfo;"vector-magdir"!==K&&"vector-uv"!==K||null==x||(x=x.variables[0].unit?.trim(),F.push(new B({name:"Raster.Magnitude",alias:"Magnitude"+(x?` (${x})`:""),domain:null,editable:!1,type:"double"})),F.push(new B({name:"Raster.Direction",alias:"Direction (\u00b0)",domain:null,editable:!1,type:"double"})));return F}createPopupTemplate(F){const {rasterFields:x}=
this,K=new Set(x.map(({name:J})=>J).filter(J=>"raster.servicepixelvalue.raw"!==J.toLowerCase()));return M.createPopupTemplate({fields:x,title:this.title},{...F,visibleFieldNames:K})}async generateRasterInfo(F,x){F=u.ensureClass(n,F);if(!F)return this.rasterInfo;try{const K={raster:this._primaryRasters[0]};1<this._primaryRasters.length&&this._primaryRasters.forEach(O=>K[O.url]=O);const J=I.create(F.functionDefinition?.toJSON()??F.toJSON(),K),G=new C({rasterFunction:J});await G.open(x);return G.rasterInfo}catch(K){if(K instanceof
D)throw K;throw new D("imagery-tile-layer","the given raster function is not supported");}}async save(F){return this._debouncedSaveOperations(U.SaveOperationType.SAVE,F)}async saveAs(F,x){return this._debouncedSaveOperations(U.SaveOperationType.SAVE_AS,x,F)}write(F,x){const K=this._primaryRasters[0]??this.raster;if(this.loaded?"RasterTileServer"===K.datasetFormat&&("Raster"===K.tileType||"Map"===K.tileType):this.url&&/\/ImageServer(\/|\/?$)/i.test(this.url))return super.write(F,x);x?.messages&&x.messages.push(new D("layer:unsupported",
`Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${`${x.origin}/${x.layerContainerType||"operational-layers"}`}'`,{layer:this}));return null}async _openRaster(F){let x=!1;if(this.raster)this.raster.rasterInfo||await this.raster.open(),"Function"===this.raster.datasetFormat?(x=!0,this._primaryRasters=this.raster.primaryRasters.rasters):this._primaryRasters=[this.raster],this.url=this.raster.url;else{var {rasterFunction:K}=this;const G=[this.url];
K&&I.getPrimaryRasterUrls(K.toJSON(),G);var J=await Promise.all(G.map(R=>E.open({url:R,sourceJSON:this.sourceJSON,ioConfig:{sampling:"closest",...this.ioConfig,customFetchParameters:this.customParameters},signal:F})));const O=J.findIndex(R=>null==R);if(-1<O)throw new D("imagery-tile-layer:open",`cannot open raster: ${G[O]}`);this._primaryRasters=J;if(K){const R={raster:this._primaryRasters[0]};1<this._primaryRasters.length&&this._primaryRasters.forEach(T=>R[T.url]=T);K=I.create(K.functionDefinition?.toJSON()??
K.toJSON(),R);K=new C({rasterFunction:K});try{await K.open(),this.raster=K}catch(T){K=S.getLogger(this),T instanceof D&&K.error("imagery-tile-layer:open",T.message),K.warn("imagery-tile-layer:open","the raster function cannot be applied and is removed"),this._set("rasterFunction",null),this.raster=J[0]}}else this.raster=J[0]}J=this.raster.rasterInfo;if(!J)throw new D("imagery-tile-layer:load","cannot load resources on "+this.url);this._set("rasterInfo",x?J:this._primaryRasters[0].rasterInfo);this._set("spatialReference",
J.spatialReference);this.sourceJSON=this.sourceJSON||this.raster.sourceJSON;null!=this.sourceJSON?this.read("Map"===this.raster.tileType&&null!=this.sourceJSON.minLOD&&null!=this.sourceJSON.maxLOD?this.sourceJSON:{...this.sourceJSON,minScale:0,maxScale:0},{origin:"service"}):this.read({tileInfo:this.rasterInfo.storageInfo.tileInfo.toJSON()},{origin:"service"});this.title||(this.title=this.raster.datasetName);"Map"===this.raster.tileType&&(this.popupEnabled=!1);this._configDefaultSettings();this.addHandles(H.watch(()=>
this.customParameters,G=>{this.raster&&(this.raster.ioConfig.customFetchParameters=G)}))}};w.__decorate([y.property({clonable:!1})],N.prototype,"_primaryRasters",void 0);w.__decorate([y.property({type:[u.Integer],json:{write:{overridePolicy(){return{enabled:!this.loaded||"Raster"===this.raster.tileType||"0,1,2"!==this.bandIds?.join(",")}}}}})],N.prototype,"bandIds",void 0);w.__decorate([y.property({json:{write:{overridePolicy(){return{enabled:!this.loaded||"Raster"===this.raster.tileType||"bilinear"!==
this.interpolation}}}}}),l.enumeration(A.interpolationKebab)],N.prototype,"interpolation",void 0);w.__decorate([y.property(r.legendEnabled)],N.prototype,"legendEnabled",void 0);w.__decorate([y.property({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],N.prototype,"isReference",void 0);w.__decorate([y.property({type:["show","hide"]})],N.prototype,"listMode",void 0);w.__decorate([y.property({json:{read:!0,write:!0}})],N.prototype,"blendMode",void 0);w.__decorate([y.property()],
N.prototype,"sourceJSON",void 0);w.__decorate([y.property({readOnly:!0,json:{origins:{service:{read:{source:"currentVersion"}}}}})],N.prototype,"version",void 0);w.__decorate([y.property({readOnly:!0,json:{read:!1}})],N.prototype,"type",void 0);w.__decorate([y.property({type:["ArcGISTiledImageServiceLayer"]})],N.prototype,"operationalLayerType",void 0);w.__decorate([y.property({type:Boolean,value:!0,json:{read:{source:"disablePopup",reader(F,x){return!x.disablePopup}},write:{target:"disablePopup",
overridePolicy(){return{enabled:!this.loaded||"Raster"===this.raster.tileType}},writer(F,x,K){x[K]=!F}}}})],N.prototype,"popupEnabled",void 0);w.__decorate([y.property({type:z,json:{read:{source:"popupInfo"},write:{target:"popupInfo",overridePolicy(){return{enabled:!this.loaded||"Raster"===this.raster.tileType}}}}})],N.prototype,"popupTemplate",void 0);w.__decorate([y.property({readOnly:!0})],N.prototype,"defaultPopupTemplate",null);w.__decorate([y.property({readOnly:!0,type:[B]})],N.prototype,"fields",
void 0);w.__decorate([y.property({readOnly:!0,type:[B]})],N.prototype,"rasterFields",null);return N=w.__decorate([q.subclass("esri.layers.ImageryTileLayer")],N)});