// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.28/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/graphics/featureConversionUtils":function(){define("exports ../../core/Error ../../core/Logger ../../core/maybe ../../geometry/support/aaBoundingBox ../../geometry/support/aaBoundingRect ../../geometry/support/jsonUtils ./OptimizedFeature ./OptimizedFeatureSet ./OptimizedGeometry".split(" "),function(c,e,A,w,L,n,g,u,f,p){function x(y,F){return y?F?4:3:F?3:2}function H(y,F,K,W){if(y){if(K)return F&&W?C:Va;if(F&&W)return h}else if(F&&W)return Va;return Sa}function D({scale:y,
translate:F},K){return Math.round((K-F[0])/y[0])}function v({scale:y,translate:F},K){return Math.round((F[1]-K)/y[1])}function q({scale:y,translate:F},K,W){return K*y[W]+F[W]}function a(y){y=y.coords;return{x:y[0],y:y[1]}}function r(y,F){y.coords[0]=F.x;y.coords[1]=F.y;return y}function z(y){y=y.coords;return{x:y[0],y:y[1],z:y[2]}}function E(y,F){y.coords[0]=F.x;y.coords[1]=F.y;y.coords[2]=F.z;return y}function R(y){y=y.coords;return{x:y[0],y:y[1],m:y[2]}}function d(y,F){y.coords[0]=F.x;y.coords[1]=
F.y;y.coords[2]=F.m;return y}function G(y){y=y.coords;return{x:y[0],y:y[1],z:y[2],m:y[3]}}function T(y,F){y.coords[0]=F.x;y.coords[1]=F.y;y.coords[2]=F.z;y.coords[3]=F.m;return y}function J(y,F){return y&&F?T:y?E:F?d:r}function Q(y,F,K,W,Y){K=J(K,W);for(const {geometry:ba,attributes:ea}of F)F=null!=ba?K(new p,ba):null,y.push(new u.OptimizedFeature(F,ea,null,Y?ea[Y]:void 0));return y}function P(y,F,K,W){for(const {geometry:Y,attributes:ba}of F)y.push({attributes:ba,geometry:null!=Y?V(Y,K,W):null});
return y}function V(y,F,K){if(null==y)return null;const W=x(F,K),Y=[];for(let ba=0;ba<y.coords.length;ba+=W){const ea=[];for(let ia=0;ia<W;ia++)ea.push(y.coords[ba+ia]);Y.push(ea)}return F?K?{points:Y,hasZ:F,hasM:K}:{points:Y,hasZ:F}:K?{points:Y,hasM:K}:{points:Y}}function l(y,F,K,W,Y){K=x(K,W);for(const {geometry:ba,attributes:ea}of F)F=null!=ba?N(new p,ba,K):null,y.push(new u.OptimizedFeature(F,ea,null,Y?ea[Y]:void 0));return y}function N(y,F,K=x(F.hasZ,F.hasM)){y.lengths[0]=F.points.length;const W=
y.coords;let Y=0;for(const ba of F.points)for(F=0;F<K;F++)W[Y++]=ba[F];return y}function m(y,F,K){if(!y)return null;const W=x(F,K),{coords:Y,lengths:ba}=y;y=[];let ea=0;for(const ia of ba){const la=[];for(let ra=0;ra<ia;ra++){const oa=[];for(let qa=0;qa<W;qa++)oa.push(Y[ea++]);la.push(oa)}y.push(la)}return F?K?{paths:y,hasZ:F,hasM:K}:{paths:y,hasZ:F}:K?{paths:y,hasM:K}:{paths:y}}function t(y,F,K,W,Y){K=x(K,W);for(const {geometry:ba,attributes:ea}of F)F=null!=ba?M(new p,ba,K):null,y.push(new u.OptimizedFeature(F,
ea,null,Y?ea[Y]:void 0));return y}function M(y,F,K=x(F.hasZ,F.hasM)){const {lengths:W,coords:Y}=y;let ba=0;for(const ea of F.paths){for(const ia of ea)for(F=0;F<K;F++)Y[ba++]=ia[F];W.push(ea.length)}return y}function I(y,F,K){if(!y)return null;const W=x(F,K),{coords:Y,lengths:ba}=y;y=[];let ea=0;for(const ia of ba){const la=[];for(let ra=0;ra<ia;ra++){const oa=[];for(let qa=0;qa<W;qa++)oa.push(Y[ea++]);la.push(oa)}y.push(la)}return F?K?{rings:y,hasZ:F,hasM:K}:{rings:y,hasZ:F}:K?{rings:y,hasM:K}:{rings:y}}
function S(y,F,K,W,Y){for(const {geometry:ba,centroid:ea,attributes:ia}of F){F=null!=ba?Z(new p,ba,K,W):null;const la=Y?ia[Y]:void 0;null!=ea?y.push(new u.OptimizedFeature(F,ia,r(new p,ea),la)):y.push(new u.OptimizedFeature(F,ia,null,la))}return y}function Z(y,F,K=F.hasZ,W=F.hasM){return ca(y,F.rings,K,W)}function ca(y,F,K,W){K=x(K,W);const {lengths:Y,coords:ba}=y;W=0;Da(y);for(const ea of F){for(const ia of ea)for(F=0;F<K;F++)ba[W++]=ia[F];Y.push(ea.length)}return y}function ja(y,F,K,W,Y,ba){Ia(y);
if(!K){for(const ea of F)y.push(new u.OptimizedFeature(null,ea.attributes,null,ba?ea.attributes[ba]:void 0));return y}switch(K){case "esriGeometryPoint":return Q(y,F,W,Y,ba);case "esriGeometryMultipoint":return l(y,F,W,Y,ba);case "esriGeometryPolyline":return t(y,F,W,Y,ba);case "esriGeometryPolygon":return S(y,F,W,Y,ba);default:Pa.error("convertToFeatureSet:unknown-geometry",new e(`Unable to parse unknown geometry type '${K}'`)),Ia(y)}return y}function na(y,F,K,W){y=y&&("coords"in y?y:y.geometry);
if(null==y)return null;switch(F){case "esriGeometryPoint":return F=a,K&&W?F=G:K?F=z:W&&(F=R),F(y);case "esriGeometryMultipoint":return V(y,K,W);case "esriGeometryPolyline":return m(y,K,W);case "esriGeometryPolygon":return I(y,K,W);default:return Pa.error("convertToGeometry:unknown-geometry",new e(`Unable to parse unknown geometry type '${F}'`)),null}}function ta(y,F,K,W,Y){Ia(y);if(null==K){for(const ea of F)y.push({attributes:ea.attributes});return y}switch(K){case "esriGeometryPoint":K=a;W&&Y?K=
G:W?K=z:Y&&(K=R);for(var ba of F){const {geometry:ea,attributes:ia}=ba;W=null!=ea?K(ea):null;y.push({attributes:ia,geometry:W})}break;case "esriGeometryMultipoint":return P(y,F,W,Y);case "esriGeometryPolyline":for(const {geometry:ea,attributes:ia}of F)y.push({attributes:ia,geometry:null!=ea?m(ea,W,Y):null});break;case "esriGeometryPolygon":for(const {geometry:ea,attributes:ia,centroid:la}of F)ba=null!=ea?I(ea,W,Y):null,null!=la?(F=a(la),y.push({attributes:ia,centroid:F,geometry:ba})):y.push({attributes:ia,
geometry:ba});break;default:Pa.error("convertToFeatureSet:unknown-geometry",new e(`Unable to parse unknown geometry type '${K}'`))}return y}function ua(y,F,K,W,Y,ba,ea=K,ia=W){Da(y);if(!F?.coords.length)return null;Y=Na[Y];const {coords:la,lengths:ra}=F;F=x(K,W);const oa=x(K&&ea,W&&ia);K=H(K,W,ea,ia);if(!ra.length)return K(y.coords,la,0,0,D(ba,la[0]),v(ba,la[1])),Da(y,F,0),y;let qa,Ca=0,wa,Ba=0;for(const Aa of ra){if(Aa<Y)continue;let ya=0;wa=Ba;ia=W=D(ba,la[Ca]);qa=ea=v(ba,la[Ca+1]);K(y.coords,la,
wa,Ca,ia,qa);ya++;Ca+=F;wa+=oa;for(let Ha=1;Ha<Aa;Ha++,Ca+=F)if(ia=D(ba,la[Ca]),qa=v(ba,la[Ca+1]),ia!==W||qa!==ea)K(y.coords,la,wa,Ca,ia-W,qa-ea),wa+=oa,ya++,W=ia,ea=qa;ya>=Y&&(y.lengths.push(ya),Ba=wa)}Ia(y.coords,Ba);return y.coords.length?y:null}function sa(y,F,K,W,Y,ba,ea){let ia=W,la=0;for(let oa=ba+K;oa<ea;oa+=K){var ra=F[oa];const qa=F[oa+1],Ca=F[ea],wa=F[ea+1];let Ba=F[ba],Aa=F[ba+1],ya=Ca-Ba,Ha=wa-Aa;if(0!==ya||0!==Ha){const Qa=((ra-Ba)*ya+(qa-Aa)*Ha)/(ya*ya+Ha*Ha);1<Qa?(Ba=Ca,Aa=wa):0<Qa&&
(Ba+=ya*Qa,Aa+=Ha*Qa)}ya=ra-Ba;Ha=qa-Aa;ra=ya*ya+Ha*Ha;ra>ia&&(la=oa,ia=ra)}ia>W&&(la-ba>K&&sa(y,F,K,W,Y,ba,la),Y(y,F,y.length,la,F[la],F[la+1]),ea-la>K&&sa(y,F,K,W,Y,la,ea))}function va(y,F,K,W,Y){const {coords:ba,lengths:ea}=F;K=x(K,W);if(!ba.length)return y!==F&&Da(y),y;w.assertIsSome(Y);const {originPosition:ia,scale:la,translate:ra}=Y;Y=ha;Y.originPosition=ia;W=Y.scale;W[0]=la[0]??1;W[1]=-(la[1]??1);W[2]=la[2]??1;W[3]=la[3]??1;var oa=Y.translate;oa[0]=ra[0]??0;oa[1]=ra[1]??0;oa[2]=ra[2]??0;oa[3]=
ra[3]??0;if(!ea.length){for(W=0;W<K;++W)y.coords[W]=q(Y,ba[W],W);y!==F&&Da(y,K,0);return y}oa=0;for(let Ca=0;Ca<ea.length;Ca++){const wa=ea[Ca];y.lengths[Ca]=wa;for(var qa=0;qa<K;++qa)y.coords[oa+qa]=q(Y,ba[oa+qa],qa);qa=y.coords[oa];let Ba=y.coords[oa+1];oa+=K;for(let Aa=1;Aa<wa;Aa++,oa+=K){qa+=ba[oa]*W[0];Ba+=ba[oa+1]*W[1];y.coords[oa]=qa;y.coords[oa+1]=Ba;for(let ya=2;ya<K;++ya)y.coords[oa+ya]=q(Y,ba[oa+ya],ya)}}y!==F&&Da(y,ba.length,ea.length);return y}function xa(y,F,K,W){let Y=0,ba=y[W*F],ea=
y[W*(F+1)];for(let ia=1;ia<K;ia++){const la=ba+y[W*(F+ia)],ra=ea+y[W*(F+ia)+1],oa=(la-ba)*(ra+ea);ba=la;ea=ra;Y+=oa}return.5*Y}function Da(y,F=0,K=0){Ia(y.lengths,K);Ia(y.coords,F)}function Ia(y,F=0){y.length!==F&&(y.length=F)}const Pa=A.getLogger("esri.layers.graphics.featureConversionUtils"),Na={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0,esriGeometryEnvelope:0},Sa=(y,F,K,W,Y,ba)=>{y[K]=Y;y[K+1]=ba},Va=(y,F,K,W,Y,ba)=>{y[K]=Y;y[K+1]=ba;y[K+2]=F[W+2]},
h=(y,F,K,W,Y,ba)=>{y[K]=Y;y[K+1]=ba;y[K+2]=F[W+3]},C=(y,F,K,W,Y,ba)=>{y[K]=Y;y[K+1]=ba;y[K+2]=F[W+2];y[K+3]=F[W+3]},X=[],aa=[],ha={originPosition:"lowerLeft",scale:[1,1,1,1],translate:[0,0,0,0]};c.convertFromFeature=function(y,F,K,W,Y){X[0]=y;[y]=ja(aa,X,F,K,W,Y);Ia(X);Ia(aa);return y};c.convertFromFeatureSet=function(y,F){const K=new f,{hasM:W,hasZ:Y,features:ba,objectIdFieldName:ea,spatialReference:ia,geometryType:la,exceededTransferLimit:ra,transform:oa,fields:qa}=y;qa&&(K.fields=qa);K.geometryType=
la??null;K.objectIdFieldName=ea??F??null;K.spatialReference=ia??null;if(!K.objectIdFieldName)return Pa.error(new e("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),K;ba&&ja(K.features,ba,la,Y,W,K.objectIdFieldName);ra&&(K.exceededTransferLimit=ra);W&&(K.hasM=W);Y&&(K.hasZ=Y);oa&&(K.transform=oa);return K};c.convertFromFeatures=ja;c.convertFromGeometry=function(y,F,K){if(null==y)return null;const W=new p;"hasZ"in y&&null==F&&(F=y.hasZ);"hasM"in y&&null==K&&(K=y.hasM);
if(g.isPoint(y))return J(null!=F?F:null!=y.z,null!=K?K:null!=y.m)(W,y);if(g.isPolygon(y))return Z(W,y,F,K);if(g.isPolyline(y))return M(W,y,x(F,K));if(g.isMultipoint(y))return N(W,y,x(F,K));Pa.error("convertFromGeometry:unknown-geometry",new e(`Unable to parse unknown geometry type '${y}'`))};c.convertFromGraphics=function(y,F,K,W,Y,ba){const ea=y.length;switch(K){case "esriGeometryPoint":Q(y,F,W,Y,ba);break;case "esriGeometryMultipoint":l(y,F,W,Y,ba);break;case "esriGeometryPolyline":t(y,F,W,Y,ba);
break;case "esriGeometryPolygon":S(y,F,W,Y,ba);break;default:Pa.error("convertToFeatureSet:unknown-geometry",new e(`Unable to parse unknown geometry type '${K}'`))}for(W=0;W<F.length;W++)y[W+ea].geometryType=K,y[W+ea].insertAfter=F[W].insertAfter,y[W+ea].groupId=F[W].groupId;return y};c.convertFromMultipoint=N;c.convertFromMultipointFeatures=l;c.convertFromNestedArray=ca;c.convertFromPoint=function(y,F,K=J(null!=F.z,null!=F.m)){return K(y,F)};c.convertFromPointFeatures=Q;c.convertFromPolygon=Z;c.convertFromPolyline=
M;c.convertFromPolylineFeatures=t;c.convertToFeature=function(y,F,K,W){aa[0]=y;ta(X,aa,F,K,W);y=X[0];Ia(X);Ia(aa);return y};c.convertToFeatureSet=function(y){const {objectIdFieldName:F,spatialReference:K,transform:W,fields:Y,hasM:ba,hasZ:ea,features:ia,geometryType:la,exceededTransferLimit:ra,uniqueIdField:oa,queryGeometry:qa,queryGeometryType:Ca}=y;y=ta([],ia,la,ea,ba);const wa=na(qa,Ca,!1,!1);y={features:y,fields:Y,geometryType:la,objectIdFieldName:F,spatialReference:K,uniqueIdField:oa,queryGeometry:wa};
W&&(y.transform=W);ra&&(y.exceededTransferLimit=ra);ba&&(y.hasM=ba);ea&&(y.hasZ=ea);return y};c.convertToFeatures=ta;c.convertToGeometry=na;c.convertToMultipoint=V;c.convertToMultipointFeatures=P;c.convertToPoint=function(y,F,K){return y?F?K?G(y):z(y):K?R(y):a(y):null};c.convertToPolygon=I;c.convertToPolyline=m;c.deltaDecodeGeometry=function(y,F){if(null==y)return null;const K=y.clone(),W=y.coords;y=y.lengths;let Y=0;for(let ia=0;ia<y.length;ia++){const la=y[ia];var ba=W[F*Y],ea=W[F*Y+1];for(let ra=
1;ra<la;ra++)ba+=W[F*(Y+ra)],ea+=W[F*(Y+ra)+1],K.coords[F*(Y+ra)]=ba,K.coords[F*(Y+ra)+1]=ea;Y+=la}return K};c.deltaEncodeGeometry=function(y,F){const K=y.clone(),W=y.coords;y=y.lengths;let Y=0;for(let ea=0;ea<y.length;ea++){const ia=y[ea];let la=W[F*Y];var ba=W[F*Y+1];for(let ra=1;ra<ia;ra++){const oa=W[F*(Y+ra)],qa=W[F*(Y+ra)+1];ba=qa-ba;K.coords[F*(Y+ra)]=oa-la;K.coords[F*(Y+ra)+1]=ba;la=oa;ba=qa}Y+=ia}return K};c.generalizeOptimizedGeometry=function(y,F,K,W,Y,ba,ea=K,ia=W){Da(y);if(!F?.coords.length)return null;
Y=Na[Y];const {coords:la,lengths:ra}=F;F=x(K,W);const oa=x(K&&ea,W&&ia);K=H(K,W,ea,ia);if(!ra.length)return K(y.coords,la,0,0,la[0],la[1]),Da(y,F,0),y;W=0;ba*=ba;for(const qa of ra){if(qa<Y){W+=qa*F;continue}ea=y.coords.length/oa;ia=W;const Ca=W+(qa-1)*F;K(y.coords,la,y.coords.length,ia,la[ia],la[ia+1]);sa(y.coords,la,F,ba,K,ia,Ca);K(y.coords,la,y.coords.length,Ca,la[Ca],la[Ca+1]);ia=y.coords.length/oa-ea;ia>=Y?y.lengths.push(ia):Ia(y.coords,ea*oa);W+=qa*F}return y.coords.length?y:null};c.getBoundsOptimizedGeometry=
function(y,F,K,W){if(!F?.coords?.length)return null;K=x(K,W);let Y=W=Number.POSITIVE_INFINITY,ba=Number.NEGATIVE_INFINITY,ea=Number.NEGATIVE_INFINITY;if(F&&F.coords){F=F.coords;for(let ia=0;ia<F.length;ia+=K){const la=F[ia],ra=F[ia+1];W=Math.min(W,la);ba=Math.max(ba,la);Y=Math.min(Y,ra);ea=Math.max(ea,ra)}}L.is(y)?L.fromRectValues(y,W,Y,ba,ea):n.fromValues(W,Y,ba,ea,y);return y};c.getQuantizedArea=function(y,F){const {coords:K,lengths:W}=y;let Y=y=0;for(let ba=0;ba<W.length;ba++){const ea=W[ba];Y+=
xa(K,y,ea,F);y+=ea}return Math.abs(Y)};c.getQuantizedBoundsOptimizedGeometry=function(y,F,K,W){K=x(K,W);const {lengths:Y,coords:ba}=F;W=F=Number.POSITIVE_INFINITY;let ea=Number.NEGATIVE_INFINITY,ia=Number.NEGATIVE_INFINITY,la=0;for(const ra of Y){let oa=ba[la],qa=ba[la+1];F=Math.min(oa,F);W=Math.min(qa,W);ea=Math.max(oa,ea);ia=Math.max(qa,ia);la+=K;for(let Ca=1;Ca<ra;Ca++,la+=K){const wa=ba[la],Ba=ba[la+1];oa+=wa;qa+=Ba;0>wa&&(F=Math.min(F,oa));0<wa&&(ea=Math.max(ea,oa));0>Ba?W=Math.min(W,qa):0<Ba&&
(ia=Math.max(ia,qa))}}y[0]=F;y[1]=W;y[2]=ea;y[3]=ia;return y};c.getSignedQuantizedRingArea=xa;c.quantizeOptimizedFeatureSet=function(y,F){const {geometryType:K,features:W,hasM:Y,hasZ:ba}=F;if(!y)return F;for(let ea=0;ea<W.length;ea++){const ia=W[ea],la=ia.weakClone();la.geometry=new p;ua(la.geometry,ia.geometry,Y,ba,K,y);ia.centroid&&(la.centroid=new p,ua(la.centroid,ia.centroid,Y,ba,"esriGeometryPoint",y));W[ea]=la}F.transform=y;return F};c.quantizeOptimizedGeometry=ua;c.quantizeX=D;c.quantizeY=
v;c.removeCollinearVectices=function(y,F,K,W,Y){if(!F?.coords?.length)return null;K=Na[K];const {coords:ba,lengths:ea}=F;F=H(W,Y,W,Y);W=x(W,Y);let ia=Y=0,la=0,ra=0;for(const Ca of ea){ia=ra;F(y.coords,ba,ia,Y,ba[Y],ba[Y+1]);Y+=W;var oa=ba[Y];let wa=ba[Y+1],Ba=oa,Aa=wa;var qa=wa/oa;ia+=W;F(y.coords,ba,ia,Y,Ba,Aa);Y+=W;for(let ya=2;ya<Ca;ya++){oa=ba[Y];wa=ba[Y+1];const Ha=wa/oa,Qa=qa===Ha||!isFinite(qa)&&!isFinite(Ha);qa=Qa&&isFinite(Ha)?0<=qa&&0<=Ha||0>=qa&&0>=Ha:0<=Aa&&0<=wa||0>=Aa&&0>=wa;Qa&&qa?
(Ba+=oa,Aa+=wa):(Ba=oa,Aa=wa,ia+=W);F(y.coords,ba,ia,Y,Ba,Aa);Y+=W;qa=Ha}ia+=W;oa=(ia-ra)/W;oa>=K&&(y.lengths[la]=oa,ra=ia,la++)}y.coords.length>ra&&(y.coords.length=ra);y.lengths.length>la&&(y.lengths.length=la);return y.coords.length&&y.lengths.length?y:null};c.removeZMValues=function(y,F,K,W,Y,ba){Da(y);y.lengths.push(...F.lengths);if(K===Y&&W===ba)for(var ea=0;ea<F.coords.length;ea++)y.coords.push(F.coords[ea]);else for(ea=x(K,W),K=H(K,W,Y,ba),F=F.coords,W=0;W<F.length;W+=ea)K(y.coords,F,y.coords.length,
W,F[W],F[W+1]);return y};c.unquantizeOptimizedFeatureSet=function(y){const {transform:F,features:K,hasM:W,hasZ:Y}=y;if(!F)return y;for(const ba of K)null!=ba.geometry&&va(ba.geometry,ba.geometry,W,Y,F),null!=ba.centroid&&va(ba.centroid,ba.centroid,W,Y,F);y.transform=null;return y};c.unquantizeOptimizedGeometry=va;c.unquantizeValue=q;c.unquantizeX=function(y,F){return q(y,F,0)};c.unquantizeY=function(y,F){return q(y,-F,1)};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/aaBoundingBox":function(){define(["exports",
"../Extent","./aaBoundingRect"],function(c,e,A){function w(q=D){return[q[0],q[1],q[2],q[3],q[4],q[5]]}function L(q,a,r,z,E,R,d=w()){d[0]=q;d[1]=a;d[2]=r;d[3]=z;d[4]=E;d[5]=R;return d}function n(q){return q[0]>=q[3]?0:q[3]-q[0]}function g(q){return q[1]>=q[4]?0:q[4]-q[1]}function u(q){return q[2]>=q[5]?0:q[5]-q[2]}function f(q,a){return Math.max(a[0],q[0])<=Math.min(a[3],q[3])&&Math.max(a[1],q[1])<=Math.min(a[4],q[4])&&Math.max(a[2],q[2])<=Math.min(a[5],q[5])}function p(q,a){q[0]=a[0];q[1]=a[1];q[2]=
a[2];q[3]=a[3];q[4]=a[4];q[5]=a[5];return q}function x(q){return 6===q.length}const H=[Infinity,Infinity,Infinity,-Infinity,-Infinity,-Infinity],D=[0,0,0,0,0,0],v=w();c.allFinite=function(q){for(let a=0;6>a;a++)if(!isFinite(q[a]))return!1;return!0};c.center=function(q,a=[0,0,0]){a[0]=q[0]+n(q)/2;a[1]=q[1]+g(q)/2;a[2]=q[2]+u(q)/2;return a};c.contains=function(q,a){return a[0]>=q[0]&&a[1]>=q[1]&&a[2]>=q[2]&&a[3]<=q[3]&&a[4]<=q[4]&&a[5]<=q[5]};c.containsPoint=function(q,a){return a[0]>=q[0]&&a[1]>=q[1]&&
a[2]>=q[2]&&a[0]<=q[3]&&a[1]<=q[4]&&a[2]<=q[5]};c.containsPointWithMargin=function(q,a,r){return a[0]>=q[0]-r&&a[1]>=q[1]-r&&a[2]>=q[2]-r&&a[0]<=q[3]+r&&a[1]<=q[4]+r&&a[2]<=q[5]+r};c.create=w;c.depth=g;c.diameter=function(q){const a=n(q),r=u(q);q=g(q);return Math.sqrt(a*a+r*r+q*q)};c.empty=function(q){return q?p(q,H):w(H)};c.equals=function(q,a,r){if(null==q||null==a)return q===a;if(!x(q)||!x(a))return!1;if(r)for(let z=0;z<q.length;z++){if(!r(q[z],a[z]))return!1}else for(r=0;r<q.length;r++)if(q[r]!==
a[r])return!1;return!0};c.expandWithAABB=function(q,a){q[0]=Math.min(q[0],a[0]);q[1]=Math.min(q[1],a[1]);q[2]=Math.min(q[2],a[2]);q[3]=Math.max(q[3],a[3]);q[4]=Math.max(q[4],a[4]);q[5]=Math.max(q[5],a[5])};c.expandWithBuffer=function(q,a,r=0,z=a.length/3){let E=q[0],R=q[1],d=q[2],G=q[3],T=q[4],J=q[5];for(let Q=0;Q<z;Q++)E=Math.min(E,a[r+3*Q]),R=Math.min(R,a[r+3*Q+1]),d=Math.min(d,a[r+3*Q+2]),G=Math.max(G,a[r+3*Q]),T=Math.max(T,a[r+3*Q+1]),J=Math.max(J,a[r+3*Q+2]);q[0]=E;q[1]=R;q[2]=d;q[3]=G;q[4]=
T;q[5]=J};c.expandWithNestedArray=function(q,a,r){const z=a.length;let E=q[0],R=q[1],d=q[2],G=q[3],T=q[4],J=q[5];if(r)for(r=0;r<z;r++){var Q=a[r];E=Math.min(E,Q[0]);R=Math.min(R,Q[1]);d=Math.min(d,Q[2]);G=Math.max(G,Q[0]);T=Math.max(T,Q[1]);J=Math.max(J,Q[2])}else for(r=0;r<z;r++)Q=a[r],E=Math.min(E,Q[0]),R=Math.min(R,Q[1]),G=Math.max(G,Q[0]),T=Math.max(T,Q[1]);q[0]=E;q[1]=R;q[2]=d;q[3]=G;q[4]=T;q[5]=J};c.expandWithOffset=function(q,a,r,z){q[0]=Math.min(q[0],q[0]+a);q[3]=Math.max(q[3],q[3]+a);q[1]=
Math.min(q[1],q[1]+r);q[4]=Math.max(q[4],q[4]+r);q[2]=Math.min(q[2],q[2]+z);q[5]=Math.max(q[5],q[5]+z)};c.expandWithRect=function(q,a){q[0]=Math.min(q[0],a[0]);q[1]=Math.min(q[1],a[1]);q[3]=Math.max(q[3],a[2]);q[4]=Math.max(q[4],a[3])};c.expandWithVec3=function(q,a){q[0]=Math.min(q[0],a[0]);q[1]=Math.min(q[1],a[1]);q[2]=Math.min(q[2],a[2]);q[3]=Math.max(q[3],a[0]);q[4]=Math.max(q[4],a[1]);q[5]=Math.max(q[5],a[2])};c.fromExtent=function(q,a=w()){a[0]=q.xmin;a[1]=q.ymin;a[2]=q.hasZ?q.zmin:-Infinity;
a[3]=q.xmax;a[4]=q.ymax;a[5]=q.hasZ?q.zmax:Infinity;return a};c.fromMinMax=function(q,a,r=w()){r[0]=q[0];r[1]=q[1];r[2]=q[2];r[3]=a[0];r[4]=a[1];r[5]=a[2];return r};c.fromRect=function(q,a){q[0]=a[0];q[1]=a[1];q[2]=Number.NEGATIVE_INFINITY;q[3]=a[2];q[4]=a[3];q[5]=Number.POSITIVE_INFINITY;return q};c.fromRectValues=function(q,a,r,z,E){q[0]=a;q[1]=r;q[2]=Number.NEGATIVE_INFINITY;q[3]=z;q[4]=E;q[5]=Number.POSITIVE_INFINITY;return q};c.fromValues=L;c.getMax=function(q,a){a[0]=q[3];a[1]=q[4];a[2]=q[5];
return a};c.getMin=function(q,a){a[0]=q[0];a[1]=q[1];a[2]=q[2];return a};c.height=u;c.intersects=f;c.intersectsClippingArea=function(q,a){return null==a?!0:f(q,a)};c.is=x;c.isPoint=function(q){return 0===n(q)&&0===g(q)&&0===u(q)};c.maximumDimension=function(q){return Math.max(n(q),u(q),g(q))};c.negativeInfinity=H;c.offset=function(q,a,r,z,E=q){E[0]=q[0]+a;E[1]=q[1]+r;E[2]=q[2]+z;E[3]=q[3]+a;E[4]=q[4]+r;E[5]=q[5]+z;return E};c.positiveInfinity=[-Infinity,-Infinity,-Infinity,Infinity,Infinity,Infinity];
c.scale=function(q,a,r=q){const z=q[0]+n(q)/2,E=q[1]+g(q)/2,R=q[2]+u(q)/2;r[0]=z+(q[0]-z)*a;r[1]=E+(q[1]-E)*a;r[2]=R+(q[2]-R)*a;r[3]=z+(q[3]-z)*a;r[4]=E+(q[4]-E)*a;r[5]=R+(q[5]-R)*a;return r};c.set=p;c.setMax=function(q,a,r=q){r[3]=a[0];r[4]=a[1];r[5]=a[2];r!==q&&(r[0]=q[0],r[1]=q[1],r[2]=q[2]);return q};c.setMin=function(q,a,r=q){r[0]=a[0];r[1]=a[1];r[2]=a[2];r!==q&&(r[3]=q[3],r[4]=q[4],r[5]=q[5]);return r};c.size=function(q,a=[0,0,0]){a[0]=n(q);a[1]=g(q);a[2]=u(q);return a};c.toExtent=function(q,
a){return isFinite(q[2])||isFinite(q[5])?new e({xmin:q[0],xmax:q[3],ymin:q[1],ymax:q[4],zmin:q[2],zmax:q[5],spatialReference:a}):new e({xmin:q[0],xmax:q[3],ymin:q[1],ymax:q[4],spatialReference:a})};c.toRect=function(q,a){a||(a=A.create());a[0]=q[0];a[1]=q[1];a[2]=q[3];a[3]=q[4];return a};c.width=n;c.wrap=function(q,a,r,z,E,R){return L(q,a,r,z,E,R,v)};c.zero=D;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/OptimizedFeature":function(){define(["exports"],function(c){class e{constructor(w=
null,L={},n,g){this.geometry=w;this.attributes=L;this.centroid=n;this.objectId=g;this.geohashY=this.geohashX=this.displayId=0}weakClone(){const w=new e(this.geometry,this.attributes,this.centroid,this.objectId);w.displayId=this.displayId;w.geohashX=this.geohashX;w.geohashY=this.geohashY;return w}}class A extends e{}c.OptimizedFeature=e;c.OptimizedFeatureWithGeometry=A;c.hasGeometry=function(w){return!!w.geometry?.coords?.length};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/OptimizedFeatureSet":function(){define(function(){class c{constructor(){this.spatialReference=
this.geometryType=this.geometryProperties=this.geohashFieldName=this.globalIdFieldName=this.objectIdFieldName=null;this.hasM=this.hasZ=!1;this.features=[];this.fields=[];this.transform=null;this.exceededTransferLimit=!1;this.queryGeometry=this.queryGeometryType=this.uniqueIdField=null}weakClone(){const e=new c;e.objectIdFieldName=this.objectIdFieldName;e.globalIdFieldName=this.globalIdFieldName;e.geohashFieldName=this.geohashFieldName;e.geometryProperties=this.geometryProperties;e.geometryType=this.geometryType;
e.spatialReference=this.spatialReference;e.hasZ=this.hasZ;e.hasM=this.hasM;e.features=this.features;e.fields=this.fields;e.transform=this.transform;e.exceededTransferLimit=this.exceededTransferLimit;e.uniqueIdField=this.uniqueIdField;e.queryGeometry=this.queryGeometry;e.queryGeometryType=this.queryGeometryType;return e}}return c})},"esri/layers/graphics/OptimizedGeometry":function(){define(function(){class c{constructor(e=[],A=[],w=!1){this.lengths=e??[];this.coords=A??[];this.hasIndeterminateRingOrder=
w}static fromRect(e){const [A,w,L,n]=e;e=L-A;const g=n-w;return new c([5],[A,w,e,0,0,g,-e,0,0,-g])}get isPoint(){return 0===this.lengths.length}get maxLength(){return Math.max(...this.lengths)}get size(){return this.lengths.reduce((e,A)=>e+A)}forEachVertex(e){let A=0;this.lengths.length||e(this.coords[0],this.coords[1]);for(let w=0;w<this.lengths.length;w++){const L=this.lengths[w];for(let n=0;n<L;n++)e(this.coords[2*(n+A)],this.coords[2*(n+A)+1]);A+=L}}clone(e){return e?(e.set(this.coords),new c(this.lengths.slice(),
e,this.hasIndeterminateRingOrder)):new c(this.lengths.slice(),this.coords.slice(),this.hasIndeterminateRingOrder)}}return c})},"esri/layers/graphics/objectIdUtils":function(){define(["exports"],function(c){c.findLastObjectIdFromFeatures=function(e,A){let w=0;for(const L of A)A=L.attributes?.[e],"number"===typeof A&&isFinite(A)&&(w=Math.max(w,A));return w};c.initialObjectId=1;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/FeatureStore":function(){define("../../../core/arrayUtils ../../../core/Error ../../../core/Evented ../../../core/Logger ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../featureConversionUtils ./BoundsStore ./geometryUtils ./optimizedFeatureQueryEngineAdapter".split(" "),
function(c,e,A,w,L,n,g,u,f,p){const x=L.create();class H{constructor(D){this.geometryInfo=D;this._boundsStore=new u.BoundsStore;this._featuresById=new Map;this._markedIds=new Set;this.events=new A;this.featureAdapter=p.optimizedFeatureQueryEngineAdapter}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){return this._boundsStore.fullBounds}get storeStatistics(){let D=
0;this._featuresById.forEach(v=>{null!=v.geometry&&v.geometry.coords&&(D+=v.geometry.coords.length)});return{featureCount:this._featuresById.size,vertexCount:D/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}getFullExtent(D){if(null==this.fullBounds)return null;const [v,q,a,r]=this.fullBounds;return{xmin:v,ymin:q,xmax:a,ymax:r,spatialReference:f.cleanFromGeometryEngine(D)}}add(D){this._add(D);this._emitChanged()}addMany(D){for(const v of D)this._add(v);this._emitChanged()}upsertMany(D){D=D.map(v=>this._upsert(v));
this._emitChanged();return D.filter(c.isSome)}clear(){this._featuresById.clear();this._boundsStore.clear();this._emitChanged()}removeById(D){D=this._featuresById.get(D);if(!D)return null;this._remove(D);this._emitChanged();return D}removeManyById(D){this._boundsStore.invalidateIndex();for(const v of D)(D=this._featuresById.get(v))&&this._remove(D);this._emitChanged()}forEachBounds(D,v){for(const q of D)(D=this._boundsStore.get(q.objectId))&&v(L.fromRect(x,D))}getFeature(D){return this._featuresById.get(D)}has(D){return this._featuresById.has(D)}forEach(D){this._featuresById.forEach(v=>
D(v))}forEachInBounds(D,v){this._boundsStore.forEachInBounds(D,q=>{v(this._featuresById.get(q))})}startMarkingUsedFeatures(){this._boundsStore.invalidateIndex();this._markedIds.clear()}sweep(){let D=!1;this._featuresById.forEach((v,q)=>{this._markedIds.has(q)||(D=!0,this._remove(v))});this._markedIds.clear();D&&this._emitChanged()}_emitChanged(){this.events.emit("changed",void 0)}_add(D){if(D){var v=D.objectId;if(null==v)w.getLogger("esri.layers.graphics.data.FeatureStore").error(new e("featurestore:invalid-feature",
"feature id is missing",{feature:D}));else{var q=this._featuresById.get(v);this._markedIds.add(v);if(q){D.displayId=q.displayId;var a=this._boundsStore.get(v);this._boundsStore.delete(v)}else if(null!=this.onFeatureAdd)this.onFeatureAdd(D);D.geometry?.coords?.length?(a=g.getBoundsOptimizedGeometry(null!=a?a:n.create(),D.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),null!=a&&this._boundsStore.set(v,a)):this._boundsStore.set(v,null);this._featuresById.set(v,D)}}}_upsert(D){const v=D?.objectId;
if(null==v)return w.getLogger("esri.layers.graphics.data.FeatureStore").error(new e("featurestore:invalid-feature","feature id is missing",{feature:D})),null;const q=this._featuresById.get(v);if(!q)return this._add(D),D;this._markedIds.add(v);const {geometry:a,attributes:r}=D;for(const z in r)q.attributes[z]=r[z];a&&(q.geometry=a,this._boundsStore.set(v,g.getBoundsOptimizedGeometry(n.create(),a,this.geometryInfo.hasZ,this.geometryInfo.hasM)??null));return q}_remove(D){if(null!=this.onFeatureRemove)this.onFeatureRemove(D);
const v=D.objectId;this._markedIds.delete(v);this._boundsStore.delete(v);this._featuresById.delete(v);return D}}return H})},"esri/layers/graphics/data/BoundsStore":function(){define(["exports","../../../core/has","../../../core/libs/rbush/PooledRBush","../../../geometry/support/aaBoundingRect"],function(c,e,A,w){function L(u,f,p){n.minX=f[0];n.minY=f[1];n.maxX=f[2];n.maxY=f[3];u.search(n,p)}const n={minX:0,minY:0,maxX:0,maxY:0};class g{constructor(){this._indexInvalid=!1;this._boundsToLoad=[];this._boundsById=
new Map;this._idByBounds=new Map;this._index=new A.PooledRBush(9,e("esri-csp-restrictions")?u=>({minX:u[0],minY:u[1],maxX:u[2],maxY:u[3]}):["[0]","[1]","[2]","[3]"]);this._loadIndex=()=>{if(this._indexInvalid){const u=Array(this._idByBounds.size);let f=0;this._idByBounds.forEach((p,x)=>{u[f++]=x});this._indexInvalid=!1;this._index.clear();this._index.load(u)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter(u=>this._idByBounds.has(u))))),this._boundsToLoad.length=
0)}}get fullBounds(){if(!this._boundsById.size)return null;const u=w.empty();for(const f of this._boundsById.values())f&&(u[0]=Math.min(f[0],u[0]),u[1]=Math.min(f[1],u[1]),u[2]=Math.max(f[2],u[2]),u[3]=Math.max(f[3],u[3]));return u}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=!1;this._boundsToLoad.length=0;this._boundsById.clear();this._idByBounds.clear();this._index.clear()}delete(u){const f=this._boundsById.get(u);this._boundsById.delete(u);f&&(this._idByBounds.delete(f),this._indexInvalid||
this._index.remove(f))}forEachInBounds(u,f){this._loadIndex();L(this._index,u,p=>f(this._idByBounds.get(p)))}get(u){return this._boundsById.get(u)}has(u){return this._boundsById.has(u)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(u,f){if(!this._indexInvalid){const p=this._boundsById.get(u);p&&(this._index.remove(p),this._idByBounds.delete(p))}this._boundsById.set(u,f);f&&(this._idByBounds.set(f,u),this._indexInvalid||(this._boundsToLoad.push(f),5E4<
this._boundsToLoad.length&&this._loadIndex()))}}c.BoundsStore=g;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/rbush/PooledRBush":function(){define(["exports","../../arrayUtils","../../PooledArray","../../../chunks/quickselect"],function(c,e,A,w){function L(J,Q){n(J,0,J.children.length,Q,J)}function n(J,Q,P,V,l){l||(l=new G([]));l.minX=Infinity;l.minY=Infinity;l.maxX=-Infinity;l.maxY=-Infinity;for(let N=Q,m;N<P;N++)m=J.children[N],g(l,J.leaf?V(m):m);return l}function g(J,
Q){J.minX=Math.min(J.minX,Q.minX);J.minY=Math.min(J.minY,Q.minY);J.maxX=Math.max(J.maxX,Q.maxX);J.maxY=Math.max(J.maxY,Q.maxY)}function u(J,Q){return J.minX-Q.minX}function f(J,Q){return J.minY-Q.minY}function p(J){return(J.maxX-J.minX)*(J.maxY-J.minY)}function x(J){return J.maxX-J.minX+(J.maxY-J.minY)}function H(J,Q){return J.minX<=Q.minX&&J.minY<=Q.minY&&Q.maxX<=J.maxX&&Q.maxY<=J.maxY}function D(J,Q){return Q.minX<=J.maxX&&Q.minY<=J.maxY&&Q.maxX>=J.minX&&Q.maxY>=J.minY}function v(J,Q,P,V,l){for(Q=
[Q,P];Q.length;){P=Q.pop();const N=Q.pop();if(P-N<=V)continue;const m=N+Math.ceil((P-N)/V/2)*V;w.quickselect(J,m,N,P,l);Q.push(N,m,m,P)}}class q{constructor(J=9,Q){this._compareMinX=u;this._compareMinY=f;this._toBBox=P=>P;this._maxEntries=Math.max(4,J||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));Q&&("function"===typeof Q?this._toBBox=Q:this._initFormat(Q));this.clear()}destroy(){this.clear();a.prune();r.prune();z.prune();E.prune()}all(J){this._all(this._data,J)}search(J,Q){let P=
this._data;const V=this._toBBox;if(D(J,P))for(a.clear();P;){for(let l=0,N=P.children.length;l<N;l++){const m=P.children[l],t=P.leaf?V(m):m;D(J,t)&&(P.leaf?Q(m):H(J,t)?this._all(m,Q):a.push(m))}P=a.pop()}}collides(J){let Q=this._data;const P=this._toBBox;if(!D(J,Q))return!1;for(a.clear();Q;){for(let V=0,l=Q.children.length;V<l;V++){const N=Q.children[V],m=Q.leaf?P(N):N;if(D(J,m)){if(Q.leaf||H(J,m))return!0;a.push(N)}}Q=a.pop()}return!1}load(J){if(!J.length)return this;if(J.length<this._minEntries){for(let Q=
0,P=J.length;Q<P;Q++)this.insert(J[Q]);return this}J=this._build(J.slice(0,J.length),0,J.length-1,0);if(this._data.children.length)if(this._data.height===J.height)this._splitRoot(this._data,J);else{if(this._data.height<J.height){const Q=this._data;this._data=J;J=Q}this._insert(J,this._data.height-J.height-1,!0)}else this._data=J;return this}insert(J){J&&this._insert(J,this._data.height-1);return this}clear(){this._data=new G([]);return this}remove(J){if(!J)return this;let Q=this._data,P=null,V=0,
l=!1,N;const m=this._toBBox(J);z.clear();for(E.clear();Q||0<z.length;){Q||(Q=z.pop(),P=z.data[z.length-1],V=E.pop()??0,l=!0);if(Q.leaf&&(N=e.indexOf(Q.children,J,Q.children.length,Q.indexHint),-1!==N)){Q.children.splice(N,1);z.push(Q);this._condense(z);break}l||Q.leaf||!H(Q,m)?P?(V++,Q=P.children[V],l=!1):Q=null:(z.push(Q),E.push(V),V=0,P=Q,Q=Q.children[0])}return this}toJSON(){return this._data}fromJSON(J){this._data=J;return this}_all(J,Q){for(r.clear();J;){if(!0===J.leaf)for(const P of J.children)Q(P);
else r.pushArray(J.children);J=r.pop()??null}}_build(J,Q,P,V){var l=P-Q+1,N=this._maxEntries;if(l<=N)return J=new G(J.slice(Q,P+1)),L(J,this._toBBox),J;V||(V=Math.ceil(Math.log(l)/Math.log(N)),N=Math.ceil(l/N**(V-1)));const m=new T([]);m.height=V;l=Math.ceil(l/N);N=l*Math.ceil(Math.sqrt(N));for(v(J,Q,P,N,this._compareMinX);Q<=P;Q+=N){const t=Math.min(Q+N-1,P);v(J,Q,t,l,this._compareMinY);for(let M=Q;M<=t;M+=l)m.children.push(this._build(J,M,Math.min(M+l-1,t),V-1))}L(m,this._toBBox);return m}_chooseSubtree(J,
Q,P,V){for(;;){V.push(Q);if(!0===Q.leaf||V.length-1===P)break;let l=Infinity,N=Infinity,m=void 0;for(let t=0,M=Q.children.length;t<M;t++){const I=Q.children[t],S=p(I),Z=(Math.max(I.maxX,J.maxX)-Math.min(I.minX,J.minX))*(Math.max(I.maxY,J.maxY)-Math.min(I.minY,J.minY))-S;Z<N?(N=Z,l=S<l?S:l,m=I):Z===N&&S<l&&(l=S,m=I)}Q=m||Q.children[0]}return Q}_insert(J,Q,P){var V=this._toBBox;P=P?J:V(J);z.clear();V=this._chooseSubtree(P,this._data,Q,z);V.children.push(J);for(g(V,P);0<=Q;)if(z.data[Q].children.length>
this._maxEntries)this._split(z,Q),Q--;else break;this._adjustParentBBoxes(P,z,Q)}_split(J,Q){const P=J.data[Q];var V=P.children.length;const l=this._minEntries;this._chooseSplitAxis(P,l,V);(V=this._chooseSplitIndex(P,l,V))?(V=P.children.splice(V,P.children.length-V),V=P.leaf?new G(V):new T(V),V.height=P.height,L(P,this._toBBox),L(V,this._toBBox),Q?J.data[Q-1].children.push(V):this._splitRoot(P,V)):console.log("  Error: assertion failed at PooledRBush._split: no valid split index")}_splitRoot(J,Q){this._data=
new T([J,Q]);this._data.height=J.height+1;L(this._data,this._toBBox)}_chooseSplitIndex(J,Q,P){let V,l,N=void 0;V=l=Infinity;for(let t=Q;t<=P-Q;t++){var m=n(J,0,t,this._toBBox);const M=n(J,t,P,this._toBBox),I=Math.max(0,Math.min(m.maxX,M.maxX)-Math.max(m.minX,M.minX))*Math.max(0,Math.min(m.maxY,M.maxY)-Math.max(m.minY,M.minY));m=p(m)+p(M);I<V?(V=I,N=t,l=m<l?m:l):I===V&&m<l&&(l=m,N=t)}return N}_chooseSplitAxis(J,Q,P){const V=J.leaf?this._compareMinX:u,l=J.leaf?this._compareMinY:f,N=this._allDistMargin(J,
Q,P,V);Q=this._allDistMargin(J,Q,P,l);N<Q&&J.children.sort(V)}_allDistMargin(J,Q,P,V){J.children.sort(V);V=this._toBBox;var l=n(J,0,Q,V);const N=n(J,P-Q,P,V);let m=x(l)+x(N);for(let t=Q;t<P-Q;t++){const M=J.children[t];g(l,J.leaf?V(M):M);m+=x(l)}for(P=P-Q-1;P>=Q;P--)l=J.children[P],g(N,J.leaf?V(l):l),m+=x(N);return m}_adjustParentBBoxes(J,Q,P){for(;0<=P;P--)g(Q.data[P],J)}_condense(J){for(let Q=J.length-1;0<=Q;Q--){const P=J.data[Q];if(0===P.children.length)if(0<Q){const V=J.data[Q-1],l=V.children;
l.splice(e.indexOf(l,P,l.length,V.indexHint),1)}else this.clear();else L(P,this._toBBox)}}_initFormat(J){const Q=["return a"," - b",";"];this._compareMinX=new Function("a","b",Q.join(J[0]));this._compareMinY=new Function("a","b",Q.join(J[1]));this._toBBox=new Function("a","return {minX: a"+J[0]+", minY: a"+J[1]+", maxX: a"+J[2]+", maxY: a"+J[3]+"};")}}const a=new A,r=new A,z=new A,E=new A({deallocator:void 0});class R{constructor(){this.minY=this.minX=Infinity;this.maxY=this.maxX=-Infinity}}class d extends R{constructor(){super(...arguments);
this.height=1;this.indexHint=new e.PositionHint}}class G extends d{constructor(J){super();this.children=J;this.leaf=!0}}class T extends d{constructor(J){super();this.children=J;this.leaf=!1}}c.BBox=R;c.PooledRBush=q;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/quickselect":function(){define(["exports","./_commonjsHelpers"],function(c,e){var A={exports:{}};A.exports;(function(w){(function(L){L=L();void 0!==L&&(w.exports=L)})(function(){function L(u,f,p,x,H){for(;x>p;){if(600<
x-p){var D=x-p+1,v=f-p+1,q=Math.log(D),a=.5*Math.exp(2*q/3);q=.5*Math.sqrt(q*a*(D-a)/D)*(0>v-D/2?-1:1);L(u,f,Math.max(p,Math.floor(f-v*a/D+q)),Math.min(x,Math.floor(f+(D-v)*a/D+q)),H)}D=u[f];v=p;a=x;n(u,p,f);for(0<H(u[x],D)&&n(u,p,x);v<a;){n(u,v,a);v++;for(a--;0>H(u[v],D);)v++;for(;0<H(u[a],D);)a--}0===H(u[p],D)?n(u,p,a):(a++,n(u,a,x));a<=f&&(p=a+1);f<=a&&(x=a-1)}}function n(u,f,p){var x=u[f];u[f]=u[p];u[p]=x}function g(u,f){return u<f?-1:u>f?1:0}return function(u,f,p,x,H){L(u,f,p||0,x||u.length-
1,H||g)}})})(A);e=e.getDefaultExportFromCjs(A.exports);c.quickselect=e})},"esri/layers/graphics/data/geometryUtils":function(){define(["exports","../featureConversionUtils","../OptimizedGeometry"],function(c,e,A){const w=new A,L=new A,n=new A,g={esriGeometryPoint:e.convertToPoint,esriGeometryPolyline:e.convertToPolyline,esriGeometryPolygon:e.convertToPolygon,esriGeometryMultipoint:e.convertToMultipoint},u=(f,p)=>"_geVersion"!==f?p:void 0;c.cleanFromGeometryEngine=function(f){return f&&"_geVersion"in
f?JSON.parse(JSON.stringify(f,u)):f};c.getGeometry=function(f,p,x,H,D,v,q=p,a=x){const r=p&&q,z=x&&a;H=null!=H?"coords"in H?H:H.geometry:null;if(null==H)return null;if(D)return p=e.generalizeOptimizedGeometry(L,H,p,x,f,D,q,a),v&&(p=e.quantizeOptimizedGeometry(n,p,r,z,f,v)),g[f]?.(p,r,z)??null;if(v)return v=e.quantizeOptimizedGeometry(n,H,p,x,f,v,q,a),g[f]?.(v,r,z)??null;e.removeZMValues(w,H,p,x,q,a);return g[f]?.(w,r,z)??null};c.transformCentroid=function(f,p,x,H=f.hasZ,D=f.hasM){if(null==p)return null;
const v=f.hasZ&&H,q=f.hasM&&D;return x?(f=e.quantizeOptimizedGeometry(n,p,f.hasZ,f.hasM,"esriGeometryPoint",x,H,D),e.convertToPoint(f,v,q)):e.convertToPoint(p,v,q)};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/optimizedFeatureQueryEngineAdapter":function(){define(["exports","../centroid","../OptimizedFeature","../OptimizedGeometry"],function(c,e,A,w){c.optimizedFeatureQueryEngineAdapter={getObjectId(L){return L.objectId},getAttributes(L){return L.attributes},
getAttribute(L,n){return L.attributes[n]},cloneWithGeometry(L,n){return new A.OptimizedFeature(n,L.attributes,null,L.objectId)},getGeometry(L){return L.geometry},getCentroid(L,n){null==L.centroid&&(L.centroid=e.getCentroidOptimizedGeometry(new w,L.geometry,n.hasZ,n.hasM));return L.centroid}};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/centroid":function(){define(["exports"],function(c){function e(w,L,n,g,u,f,p=1){f=u?f?4:3:f?3:2;let x=n,H=n+f,D=0,v=0,q=n=
0,a=0;for(let r=0,z=g-1;r<z;r++,x+=f,H+=f){g=L[x];const E=L[x+1],R=L[x+2],d=L[H],G=L[H+1],T=L[H+2];let J=g*G-d*E;q+=J;D+=(g+d)*J;v+=(E+G)*J;u&&(J=g*T-d*R,n+=(R+T)*J,a+=J);g<w[0]&&(w[0]=g);g>w[1]&&(w[1]=g);E<w[2]&&(w[2]=E);E>w[3]&&(w[3]=E);u&&(R<w[4]&&(w[4]=R),R>w[5]&&(w[5]=R))}0<q*p&&(q*=-1);0<a*p&&(a*=-1);if(!q)return null;w=[D,v,.5*q];u&&(w[3]=n,w[4]=.5*a);return w}function A(w,L,n,g,u){u=g?u?4:3:u?3:2;let f=L,p=L+u,x=0,H=0,D=0,v=0;for(let z=0,E=n-1;z<E;z++,f+=u,p+=u){var q=w[f];const R=w[f+1],
d=w[f+2],G=w[p],T=w[p+1],J=w[p+2];if(g){var a=G-q;var r=T-R;const Q=J-d;a=Math.sqrt(a*a+r*r+Q*Q)}else a=G-q,r=T-R,a=Math.sqrt(a*a+r*r);a&&(x+=a,g?(q=[q+.5*(G-q),R+.5*(T-R),d+.5*(J-d)],H+=a*q[0],D+=a*q[1],v+=a*q[2]):(q=[q+.5*(G-q),R+.5*(T-R)],H+=a*q[0],D+=a*q[1]))}return 0<x?g?[H/x,D/x,v/x]:[H/x,D/x]:0<n?g?[w[L],w[L+1],w[L+2]]:[w[L],w[L+1]]:null}c.getCentroidOptimizedGeometry=function(w,L,n,g,u){if(!L?.lengths.length)return null;const f="upperLeft"===u?.originPosition?-1:1;w.lengths.length&&(w.lengths.length=
0);w.coords.length&&(w.coords.length=0);u=w.coords;const p=[],x=n?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:H,coords:D}=L,v=n?g?4:3:g?3:2;let q=0;for(var a of H){const r=e(x,D,q,a,n,g,f);r&&p.push(r);q+=a*v}p.sort((r,z)=>{let E=f*r[2]-f*z[2];0===E&&n&&(E=r[4]-z[4]);return E});p.length&&
(a=6*p[0][2],u[0]=p[0][0]/a,u[1]=p[0][1]/a,n&&(a=6*p[0][4],u[2]=0!==a?p[0][3]/a:0),u[0]<x[0]||u[0]>x[1]||u[1]<x[2]||u[1]>x[3]||n&&(u[2]<x[4]||u[2]>x[5]))&&(u.length=0);if(!u.length)if(L=L.lengths[0]?A(D,0,H[0],n,g):null)u[0]=L[0],u[1]=L[1],n&&2<L.length&&(u[2]=L[2]);else return null;return w};c.lineCentroid=A;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/projectionSupport":function(){define("exports ../../../core/arrayUtils ../../../core/promiseUtils ../../../geometry/projection ../../../geometry/geometryAdapters/json ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),
function(c,e,A,w,L,n,g){function u(a,r){if(!r)return null;if("x"in r){var z={x:0,y:0};[z.x,z.y]=a(r.x,r.y,x);null!=r.z&&(z.z=r.z);null!=r.m&&(z.m=r.m);return z}return"xmin"in r?(z={xmin:0,ymin:0,xmax:0,ymax:0},[z.xmin,z.ymin]=a(r.xmin,r.ymin,x),[z.xmax,z.ymax]=a(r.xmax,r.ymax,x),r.hasZ&&(z.zmin=r.zmin,z.zmax=r.zmax,z.hasZ=!0),r.hasM&&(z.mmin=r.mmin,z.mmax=r.mmax,z.hasM=!0),z):"rings"in r?{rings:f(r.rings,a),hasM:r.hasM,hasZ:r.hasZ}:"paths"in r?{paths:f(r.paths,a),hasM:r.hasM,hasZ:r.hasZ}:"points"in
r?{points:p(r.points,a),hasM:r.hasM,hasZ:r.hasZ}:null}function f(a,r){const z=[];for(const E of a)z.push(p(E,r));return z}function p(a,r){const z=[];for(const E of a)a=r(E[0],E[1],[0,0]),z.push(a),2<E.length&&a.push(E[2]),3<E.length&&a.push(E[3]);return z}const x=[0,0],H=u.bind(null,g.lngLatToXY),D=u.bind(null,g.xyToLngLat);class v{constructor(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}async push(a,r,z,E){if(!a?.length||!r||!z||n.equals(r,z))return a;a={geometries:a,inSpatialReference:r,
outSpatialReference:z,geographicTransformation:E,resolve:A.createResolver()};this._jobs.push(a);this._timer??(this._timer=setTimeout(this._process,10));return a.resolve.promise}_process(){this._timer=null;const a=this._jobs.shift();if(a){var {geometries:r,inSpatialReference:z,outSpatialReference:E,resolve:R,geographicTransformation:d}=a;g.canProject(z,E)?n.isWebMercator(E)?R(r.map(H)):R(r.map(D)):R(w.projectMany(L.jsonAdapter,r,z,E,d,null));0<this._jobs.length&&(this._timer=setTimeout(this._process,
10))}}}const q=new v;c.checkProjectionSupport=async function(a,r){a&&r&&(a=Array.isArray(a)?a.map(z=>null!=z.geometry?z.geometry.spatialReference:null).filter(e.isSome):[a],await w.initializeProjection(a.map(z=>({source:z,dest:r}))))};c.project=function(a,r,z,E){if(!a)return a;z||(z=r,r=a.spatialReference);return n.isValid(r)&&n.isValid(z)&&!n.equals(r,z)?g.canProject(r,z)?(a=n.isWebMercator(z)?H(a):D(a),a.spatialReference=z,a):w.projectMany(L.jsonAdapter,[a],r,z,null,E)[0]:a};c.projectMany=function(a,
r,z,E){return q.push(a,r,z,E)};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/geometryAdapters/json":function(){define(["exports"],function(c){class e{constructor(g,u,f){this.x=g;this.y=u;this.spatialReference=f;this.m=this.z=void 0}}class A{constructor(g,u,f,p){this.rings=g;this.spatialReference=u;this.hasM=this.hasZ=void 0;f&&(this.hasZ=f);p&&(this.hasM=p)}}class w{constructor(g,u,f,p){this.paths=g;this.spatialReference=u;this.hasM=this.hasZ=void 0;f&&(this.hasZ=
f);p&&(this.hasM=p)}}class L{constructor(g,u,f,p){this.points=g;this.spatialReference=u;this.hasM=this.hasZ=void 0;f&&(this.hasZ=f);p&&(this.hasM=p)}}class n{constructor(g,u,f,p,x){this.xmin=g;this.ymin=u;this.xmax=f;this.ymax=p;this.spatialReference=x;this.mmax=this.mmin=this.zmax=this.zmin=void 0}}c.jsonAdapter={convertToGEGeometry:function(g,u){return null==u?null:g.convertJSONToGeometry(u)},exportPoint:function(g,u,f){f=new e(g.getPointX(u),g.getPointY(u),f);const p=g.hasZ(u),x=g.hasM(u);p&&(f.z=
g.getPointZ(u));x&&(f.m=g.getPointM(u));return f},exportPolygon:function(g,u,f){return new A(g.exportPaths(u),f,g.hasZ(u),g.hasM(u))},exportPolyline:function(g,u,f){return new w(g.exportPaths(u),f,g.hasZ(u),g.hasM(u))},exportMultipoint:function(g,u,f){return new L(g.exportPoints(u),f,g.hasZ(u),g.hasM(u))},exportExtent:function(g,u,f){var p=g.hasZ(u);const x=g.hasM(u);f=new n(g.getXMin(u),g.getYMin(u),g.getXMax(u),g.getYMax(u),f);p&&(p=g.getZExtent(u),f.zmin=p.vmin,f.zmax=p.vmax);x&&(g=g.getMExtent(u),
f.mmin=g.vmin,f.mmax=g.vmax);return f}};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/QueryEngine":function(){define("exports ../../../core/arrayUtils ../../../core/Error ../../../core/JSONSupport ../../../core/lang ../../../core/maybe ../../../core/MemCache ../../../core/promiseUtils ../../../core/unitUtils ../../../geometry/projection ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./attributeSupport ./geometryUtils ./projectionSupport ./QueryEngineCapabilities ./QueryEngineResult ./queryUtils ./queryValidationUtils ./spatialQuerySupport ./timeSupport ../../support/FieldsIndex ../../../views/support/Scheduler".split(" "),
function(c,e,A,w,L,n,g,u,f,p,x,H,D,v,q,a,r,z,E,R,d,G,T,J,Q,P,V,l){class N{constructor(I,S=null,Z,ca,ja){this.attributes=I;this.geometry=Z;this.centroid=ca;this.filterFlags=ja;this.groupId=-1;this.displayId=S}}const m=new g.MemCacheStorage(2E6);let t=0;class M{constructor(I){this._changeHandle=this._geometryQueryCache=null;this.capabilities={query:d.queryCapabilities};this.geometryType=I.geometryType;this.hasM=!!I.hasM;this.hasZ=!!I.hasZ;this.objectIdField=I.objectIdField;this.spatialReference=I.spatialReference;
this.definitionExpression=I.definitionExpression;this.featureStore=I.featureStore;this.aggregateAdapter=I.aggregateAdapter;this._changeHandle=this.featureStore.events.on("changed",()=>this.clearCache());this.timeInfo=I.timeInfo;I.cacheSpatialQueries&&(this._geometryQueryCache=new g.MemCache(t++ +"$$",m));this.fieldsIndex=w.isSerializable(I.fieldsIndex)?I.fieldsIndex:V.fromJSON(I.fieldsIndex);this.availableFields=null==I.availableFields?new Set(this.fieldsIndex.fields.map(S=>S.name)):new Set(I.availableFields.map(S=>
this.fieldsIndex.get(S)?.name).filter(S=>null!=S));I.scheduler&&I.priority&&(this._frameTask=I.scheduler.registerTask(I.priority))}destroy(){this._frameTask=n.removeMaybe(this._frameTask);this.clearCache();n.destroyMaybe(this._geometryQueryCache);this._changeHandle=n.removeMaybe(this._changeHandle)}get featureAdapter(){return this.featureStore.featureAdapter}clearCache(){this._geometryQueryCache?.clear();this._fullExtentPromise=this._timeExtentPromise=this._allFeaturesPromise=null}async executeQuery(I,
S){try{return(await this._executeQuery(I,{},S)).createQueryResponse()}catch(Z){if(Z!==T.queryEngineEmptyResult)throw Z;return(new G.QueryEngineResult([],I,this)).createQueryResponse()}}async executeQueryForCount(I={},S){try{return(await this._executeQuery(I,{returnGeometry:!1,returnCentroid:!1,outSR:null},S)).createQueryResponseForCount()}catch(Z){if(Z!==T.queryEngineEmptyResult)throw Z;return 0}}async executeQueryForExtent(I,S){const Z=I.outSR;try{const ca=await this._executeQuery(I,{returnGeometry:!0,
returnCentroid:!1,outSR:null},S),ja=ca.size;if(!ja)return{count:0,extent:null};const na=await this._getBounds(ca.items,ca.spatialReference,Z||this.spatialReference);return{count:ja,extent:na}}catch(ca){if(ca===T.queryEngineEmptyResult)return{count:0,extent:null};throw ca;}}async executeQueryForIds(I,S){return this.executeQueryForIdSet(I,S).then(Z=>Array.from(Z))}async executeQueryForIdSet(I,S){try{const Z=await this._executeQuery(I,{returnGeometry:!0,returnCentroid:!1,outSR:null},S),ca=Z.items,ja=
new Set;await this._reschedule(()=>{for(const na of ca)ja.add(Z.featureAdapter.getObjectId(na))},S);return ja}catch(Z){if(Z===T.queryEngineEmptyResult)return new Set;throw Z;}}async executeQueryForSnapping(I,S){const {point:Z,distance:ca,returnEdge:ja,vertexMode:na}=I;if(!ja&&"none"===na)return{candidates:[]};let ta=L.clone(I.query);ta=await this._schedule(()=>T.normalizeQueryLike(ta,this.definitionExpression,this.spatialReference),S);ta=await this._reschedule(()=>J.validateQuery(ta,{availableFields:this.availableFields,
fieldsIndex:this.fieldsIndex,geometryType:this.geometryType,spatialReference:this.spatialReference}),S);const ua=!a.equals(Z.spatialReference,this.spatialReference);ua&&await R.checkProjectionSupport(Z.spatialReference,this.spatialReference);var sa="number"===typeof ca?ca:ca.x,va="number"===typeof ca?ca:ca.y;sa={xmin:Z.x-sa,xmax:Z.x+sa,ymin:Z.y-va,ymax:Z.y+va,spatialReference:Z.spatialReference};sa=ua?R.project(sa,this.spatialReference):sa;if(!sa)return{candidates:[]};va=(await q.normalizeCentralMeridian(v.fromJSON(Z),
null,{signal:S}))[0];const xa=(await q.normalizeCentralMeridian(v.fromJSON(sa),null,{signal:S}))[0];if(null==va||null==xa)return{candidates:[]};const Da=new G.QueryEngineResult(await this._reschedule(()=>this._searchFeatures(this._getQueryBBoxes(xa.toJSON())),S),ta,this);await this._reschedule(()=>this._executeObjectIdsQuery(Da),S);await this._reschedule(()=>this._executeTimeQuery(Da),S);await this._reschedule(()=>this._executeAttributesQuery(Da),S);await this._reschedule(()=>this._executeGeometryQueryForSnapping(Da,
S),S);va=va.toJSON();va=ua?R.project(va,this.spatialReference):va;return Da.createSnappingResponse({...I,point:va,distance:ua?Math.max(sa.xmax-sa.xmin,sa.ymax-sa.ymin)/2:ca},Z.spatialReference)}async executeQueryForLatestObservations(I,S){if(!this.timeInfo?.trackIdField)throw new A("unsupported-query","Missing timeInfo or timeInfo.trackIdField",{query:I,timeInfo:this.timeInfo});try{const Z=await this._executeQuery(I,{},S);await this._reschedule(()=>this._filterLatest(Z),S);return Z.createQueryResponse()}catch(Z){if(Z!==
T.queryEngineEmptyResult)throw Z;return(new G.QueryEngineResult([],I,this)).createQueryResponse()}}async executeQueryForSummaryStatistics(I={},S,Z){const {field:ca,normalizationField:ja,valueExpression:na}=S;return(await this._executeQueryForStatistics(I,{field:ca,normalizationField:ja,valueExpression:na},Z)).createSummaryStatisticsResponse(S)}async executeQueryForUniqueValues(I={},S,Z){const {field:ca,field2:ja,field3:na,valueExpression:ta}=S;return(await this._executeQueryForStatistics(I,{field:ca,
field2:ja,field3:na,valueExpression:ta},Z)).createUniqueValuesResponse(S)}async executeQueryForClassBreaks(I={},S,Z){const {field:ca,normalizationField:ja,valueExpression:na}=S;return(await this._executeQueryForStatistics(I,{field:ca,normalizationField:ja,valueExpression:na},Z)).createClassBreaksResponse(S)}async executeQueryForHistogram(I={},S,Z){const {field:ca,normalizationField:ja,valueExpression:na}=S;return(await this._executeQueryForStatistics(I,{field:ca,normalizationField:ja,valueExpression:na},
Z)).createHistogramResponse(S)}async fetchRecomputedExtents(I){this._timeExtentPromise||(this._timeExtentPromise=P.getTimeExtent(this.timeInfo,this.featureStore));const [S,Z]=await Promise.all([this._getFullExtent(),this._timeExtentPromise]);u.throwIfAborted(I);return{fullExtent:S,timeExtent:Z}}async _getBounds(I,S,Z){const ca=x.set(x.create(),x.negativeInfinity);await this.featureStore.forEachBounds(I,ja=>x.expandWithAABB(ca,ja));I={xmin:ca[0],ymin:ca[1],xmax:ca[3],ymax:ca[4],spatialReference:E.cleanFromGeometryEngine(this.spatialReference)};
this.hasZ&&isFinite(ca[2])&&isFinite(ca[5])&&(I.zmin=ca[2],I.zmax=ca[5]);S=R.project(I,S,Z);S.spatialReference=E.cleanFromGeometryEngine(Z);0===S.xmax-S.xmin&&(Z=f.getMetersPerUnitForSR(S.spatialReference),S.xmin-=Z,S.xmax+=Z);0===S.ymax-S.ymin&&(Z=f.getMetersPerUnitForSR(S.spatialReference),S.ymin-=Z,S.ymax+=Z);this.hasZ&&null!=S.zmin&&null!=S.zmax&&0===S.zmax-S.zmin&&(Z=f.getMetersPerUnitForSR(S.spatialReference),S.zmin-=Z,S.zmax+=Z);return S}_getFullExtent(){this._fullExtentPromise||(this._fullExtentPromise=
"getFullExtent"in this.featureStore&&this.featureStore.getFullExtent?Promise.resolve(this.featureStore.getFullExtent(this.spatialReference)):this._getAllFeatures().then(I=>this._getBounds(I,this.spatialReference,this.spatialReference)));return this._fullExtentPromise}async _schedule(I,S){return null!=this._frameTask?this._frameTask.schedule(I,S):I(l.noBudget)}async _reschedule(I,S){return null!=this._frameTask?this._frameTask.reschedule(I,S):I(l.noBudget)}async _getAllFeaturesQueryEngineResult(I){return new G.QueryEngineResult(await this._getAllFeatures(),
I,this)}async _getAllFeatures(){if(null==this._allFeaturesPromise){const Z=[];this._allFeaturesPromise=(async()=>{await this.featureStore.forEach(ca=>Z.push(ca))})().then(()=>Z)}const I=this._allFeaturesPromise,S=await I;return I===this._allFeaturesPromise?S.slice():this._getAllFeatures()}async _executeQuery(I,S,Z){I=L.clone(I);I=await this._schedule(()=>T.normalizeQuery(I,this.definitionExpression,this.spatialReference),Z);I=await this._reschedule(()=>J.validateQuery(I,{availableFields:this.availableFields,
fieldsIndex:this.fieldsIndex,geometryType:this.geometryType,spatialReference:this.spatialReference}),Z);I={...I,...S};const ca=await this._reschedule(()=>this._executeSceneFilterQuery(I,Z),Z),ja=await this._reschedule(()=>this._executeGeometryQuery(I,ca,Z),Z);await this._reschedule(()=>this._executeAggregateIdsQuery(ja),Z);await this._reschedule(()=>this._executeObjectIdsQuery(ja),Z);await this._reschedule(()=>this._executeTimeQuery(ja),Z);await this._reschedule(()=>this._executeAttributesQuery(ja),
Z);return ja}async _executeSceneFilterQuery(I,S){if(null==I.sceneFilter)return null;const {outSR:Z,returnGeometry:ca,returnCentroid:ja}=I;var na=this.featureStore.featureSpatialReference,ta=I.sceneFilter.geometry;const ua=null==na||a.equals(na,ta.spatialReference)?ta:R.project(ta,na);if(!ua)return null;na=ca||ja;na=a.isValid(Z)&&!a.equals(this.spatialReference,Z)&&na?async Da=>this._project(Da,Z):Da=>Da;const sa=this.featureAdapter;ta=await this._reschedule(()=>this._searchFeatures(this._getQueryBBoxes(ua)),
S);if("disjoint"===I.sceneFilter.spatialRelationship){if(!ta.length)return null;const Da=new Set;for(var va of ta)Da.add(sa.getObjectId(va));const Ia=await this._reschedule(()=>this._getAllFeatures(),S);va=await this._reschedule(async()=>{const Pa=await Q.getSpatialQueryOperator("esriSpatialRelDisjoint",ua,this.geometryType,this.hasZ,this.hasM),Na=await this._runSpatialFilter(Ia,Sa=>!Da.has(sa.getObjectId(Sa))||Pa(sa.getGeometry(Sa)),S);return new G.QueryEngineResult(Na,I,this)},S);return na(va)}if(!ta.length)return new G.QueryEngineResult([],
I,this);if(this._canExecuteSinglePass(ua,I))return na(new G.QueryEngineResult(ta,I,this));const xa=await Q.getSpatialQueryOperator("esriSpatialRelContains",ua,this.geometryType,this.hasZ,this.hasM);va=await this._runSpatialFilter(ta,Da=>xa(sa.getGeometry(Da)),S);return na(new G.QueryEngineResult(va,I,this))}async _executeGeometryQuery(I,S,Z){if(null!=S&&0===S.items.length)return S;I=null!=S?S.query:I;const {geometry:ca,outSR:ja,spatialRel:na,returnGeometry:ta,returnCentroid:ua}=I;var sa=this.featureStore.featureSpatialReference;
const va=!ca||null==sa||a.equals(sa,ca.spatialReference)?ca:R.project(ca,sa),xa=ta||ua,Da=a.isValid(ja)&&!a.equals(this.spatialReference,ja),Ia=this._geometryQueryCache&&null==S?Da&&xa?JSON.stringify({originalFilterGeometry:ca,spatialRelationship:na,outSpatialReference:ja}):JSON.stringify({originalFilterGeometry:ca,spatialRelationship:na}):null;sa=Ia?this._geometryQueryCache.get(Ia):null;if(null!=sa)return new G.QueryEngineResult(sa,I,this);sa=async h=>{Da&&xa&&await this._project(h,ja);Ia&&this._geometryQueryCache.put(Ia,
h.items,h.items.length+1);return h};if(!va)return sa(null!=S?S:await this._getAllFeaturesQueryEngineResult(I));const Pa=this.featureAdapter;let Na=await this._reschedule(()=>this._searchFeatures(this._getQueryBBoxes(ca)),Z);if("esriSpatialRelDisjoint"===na){if(!Na.length)return sa(null!=S?S:await this._getAllFeaturesQueryEngineResult(I));const h=new Set;for(var Sa of Na)h.add(Pa.getObjectId(Sa));const C=null!=S?S.items:await this._reschedule(()=>this._getAllFeatures(),Z);Sa=await this._reschedule(async()=>
{const X=await Q.getSpatialQueryOperator(na,va,this.geometryType,this.hasZ,this.hasM),aa=await this._runSpatialFilter(C,ha=>!h.has(Pa.getObjectId(ha))||X(Pa.getGeometry(ha)),Z);return new G.QueryEngineResult(aa,I,this)},Z);return sa(Sa)}if(null!=S){const h=new e.PositionHint;Na=Na.filter(C=>0<=e.indexOf(S.items,C,S.items.length,h))}if(!Na.length)return sa=new G.QueryEngineResult([],I,this),Ia&&this._geometryQueryCache.put(Ia,sa.items,1),sa;if(this._canExecuteSinglePass(va,I))return sa(new G.QueryEngineResult(Na,
I,this));const Va=await Q.getSpatialQueryOperator(na,va,this.geometryType,this.hasZ,this.hasM);Sa=await this._runSpatialFilter(Na,h=>Va(Pa.getGeometry(h)),Z);return sa(new G.QueryEngineResult(Sa,I,this))}async _executeGeometryQueryForSnapping(I,S){const {query:Z}=I,{spatialRel:ca}=Z;if(I?.items?.length&&Z.geometry&&ca){var ja=await Q.getSpatialQueryOperator(ca,Z.geometry,this.geometryType,this.hasZ,this.hasM);S=await this._runSpatialFilter(I.items,na=>ja(na.geometry),S);I.items=S}}_executeAggregateIdsQuery(I){if(0!==
I.items.length&&I.query.aggregateIds?.length&&null!=this.aggregateAdapter){var S=new Set;for(const ca of I.query.aggregateIds)this.aggregateAdapter.getFeatureObjectIds(ca).forEach(ja=>S.add(ja));var Z=this.featureAdapter.getObjectId;I.items=I.items.filter(ca=>S.has(Z(ca)))}}_executeObjectIdsQuery(I){if(0!==I.items.length&&I.query.objectIds?.length){var S=new Set(I.query.objectIds),Z=this.featureAdapter.getObjectId;I.items=I.items.filter(ca=>S.has(Z(ca)))}}_executeTimeQuery(I){if(0!==I.items.length){var S=
P.getTimeOperator(this.timeInfo,I.query.timeExtent,this.featureAdapter);null!=S&&(I.items=I.items.filter(S))}}_executeAttributesQuery(I){if(0!==I.items.length){var S=z.getWhereClause(I.query.where,this.fieldsIndex);if(S){if(!S.isStandardized)throw new TypeError("Where clause is not standardized");I.items=I.items.filter(Z=>S.testFeature(Z,this.featureAdapter))}}}async _runSpatialFilter(I,S,Z){if(!S)return I;if(null==this._frameTask)return I.filter(ta=>S(ta));let ca=0;const ja=[],na=async ta=>{for(;ca<
I.length;){const ua=I[ca++];S(ua)&&(ja.push(ua),ta.madeProgress());ta.done&&await this._reschedule(sa=>na(sa),Z)}};return this._reschedule(ta=>na(ta),Z).then(()=>ja)}_filterLatest(I){const {trackIdField:S,startTimeField:Z,endTimeField:ca}=this.timeInfo,ja=ca||Z,na=new Map,ta=this.featureAdapter.getAttribute;for(const ua of I.items){const sa=ta(ua,S),va=ta(ua,ja),xa=na.get(sa);(!xa||va>ta(xa,ja))&&na.set(sa,ua)}I.items=Array.from(na.values())}_canExecuteSinglePass(I,S){({spatialRel:S}=S);return Q.canQueryWithRBush(I)&&
("esriSpatialRelEnvelopeIntersects"===S||"esriGeometryPoint"===this.geometryType&&("esriSpatialRelIntersects"===S||"esriSpatialRelContains"===S))}async _project(I,S){if(!S||a.equals(this.spatialReference,S))return I;const Z=this.featureAdapter;let ca=void 0;try{const ja=await this._getFullExtent();ca=p.getTransformation(this.spatialReference,S,ja)}catch{}S=await R.projectMany(I.items.map(ja=>E.getGeometry(this.geometryType,this.hasZ,this.hasM,Z.getGeometry(ja))),this.spatialReference,S,ca);I.items=
S.map((ja,na)=>Z.cloneWithGeometry(I.items[na],r.convertFromGeometry(ja,this.hasZ,this.hasM)));return I}_getQueryBBoxes(I){if(Q.canQueryWithRBush(I)){if(v.isExtent(I))return[H.fromValues(Math.min(I.xmin,I.xmax),Math.min(I.ymin,I.ymax),Math.max(I.xmin,I.xmax),Math.max(I.ymin,I.ymax))];if(v.isPolygon(I))return I.rings.map(S=>H.fromValues(Math.min(S[0][0],S[2][0]),Math.min(S[0][1],S[2][1]),Math.max(S[0][0],S[2][0]),Math.max(S[0][1],S[2][1])))}return[D.getBoundsXY(H.create(),I)]}async _searchFeatures(I){const S=
new Set;await Promise.all(I.map(Z=>this.featureStore.forEachInBounds(Z,ca=>S.add(ca))));I=Array.from(S.values());S.clear();return I}async _executeQueryForStatistics(I,S,Z){I=L.clone(I);try{I=await this._schedule(()=>T.normalizeQuery(I,this.definitionExpression,this.spatialReference),Z);I=await this._reschedule(()=>J.validateStatisticsQuery(I,S,{availableFields:this.availableFields,fieldsIndex:this.fieldsIndex,geometryType:this.geometryType,spatialReference:this.spatialReference}),Z);const ca=await this._reschedule(()=>
this._executeSceneFilterQuery(I,Z),Z),ja=await this._reschedule(()=>this._executeGeometryQuery(I,ca,Z),Z);await this._reschedule(()=>this._executeAggregateIdsQuery(ja),Z);await this._reschedule(()=>this._executeObjectIdsQuery(ja),Z);await this._reschedule(()=>this._executeTimeQuery(ja),Z);await this._reschedule(()=>this._executeAttributesQuery(ja),Z);return ja}catch(ca){if(ca!==T.queryEngineEmptyResult)throw ca;return new G.QueryEngineResult([],I,this)}}}c.Feature=N;c.QueryEngine=M;Object.defineProperty(c,
Symbol.toStringTag,{value:"Module"})})},"esri/core/MemCache":function(){define(["exports","./PooledArray"],function(c,e){c.RemoveMode=void 0;(function(n){n[n.ALL=0]="ALL";n[n.SOME=1]="SOME"})(c.RemoveMode||(c.RemoveMode={}));class A{constructor(n,g,u){this.name=n;this._storage=g;this.id=`${L++}:`;this.maxSize=this.size=0;this._removeFunc=!1;this._miss=this._hit=0;this._storage.register(this);u&&(this._storage.registerRemoveFunc(this.id,u),this._removeFunc=!0)}destroy(){this._storage.clear(this);this._removeFunc&&
this._storage.deregisterRemoveFunc(this.id);this._storage.deregister(this);this._storage=null}get hitRate(){return this._hit/(this._hit+this._miss)}get sizeAll(){return this._storage.size}resetHitRate(){this._hit=this._miss=0}put(n,g,u,f=0){this._storage.put(this,n,g,u,f)}get(n){n=this._storage.get(this,n);void 0===n?++this._miss:++this._hit;return n}peek(n){return this._storage.peek(this,n)}pop(n){n=this._storage.pop(this,n);void 0===n?++this._miss:++this._hit;return n}updateSize(n,g,u){this._storage.updateSize(this,
n,g,u)}clear(){this._storage.clear(this)}clearAll(){this._storage.clearAll()}get performanceInfo(){return this._storage.performanceInfo}resetStats(){this._storage.resetStats()}}class w{get size(){return this._size}constructor(n=10485760){this._maxSize=n;this._db=new Map;this._miss=this._hit=this._size=0;this._removeFuncs=new e;this._users=new e}destroy(){this.clearAll();this._removeFuncs.clear();this._users.clear();this._db=null}register(n){this._users.push(n)}deregister(n){this._users.removeUnordered(n)}registerRemoveFunc(n,
g){this._removeFuncs.push([n,g])}deregisterRemoveFunc(n){this._removeFuncs.filterInPlace(g=>g[0]!==n)}get maxSize(){return this._maxSize}set maxSize(n){this._maxSize=Math.max(n,0);this._checkSizeLimits()}put(n,g,u,f,p){g=n.id+g;const x=this._db.get(g);x&&(this._size-=x.size,n.size-=x.size,this._db.delete(g),x.entry!==u&&this._notifyRemove(g,x.entry,c.RemoveMode.ALL));f>this._maxSize?this._notifyRemove(g,u,c.RemoveMode.ALL):void 0===u?console.warn("Refusing to cache undefined entry "):!f||0>f?(console.warn(`Refusing to cache entry with size ${f} for key ${g}`),
this._notifyRemove(g,u,c.RemoveMode.ALL)):(p=1+Math.max(p,-3)- -3,this._db.set(g,{entry:u,size:f,lifetime:p,lives:p}),this._size+=f,n.size+=f,this._checkSizeLimits())}updateSize(n,g,u,f){g=n.id+g;const p=this._db.get(g);if(p&&p.entry===u){this._size-=p.size;for(n.size-=p.size;f>this._maxSize;)if(f=this._notifyRemove(g,u,c.RemoveMode.SOME),!(null!=f&&0<f)){this._db.delete(g);return}p.size=f;this._size+=f;n.size+=f;this._checkSizeLimits()}}pop(n,g){g=n.id+g;const u=this._db.get(g);if(u)return this._size-=
u.size,n.size-=u.size,this._db.delete(g),++this._hit,u.entry;++this._miss}get(n,g){g=n.id+g;n=this._db.get(g);if(void 0===n)++this._miss;else return this._db.delete(g),n.lives=n.lifetime,this._db.set(g,n),++this._hit,n.entry}peek(n,g){(n=this._db.get(n.id+g))?++this._hit:++this._miss;return n?.entry}get performanceInfo(){const n={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},g={},u=
[];this._db.forEach((x,H)=>{const D=x.lifetime;u[D]=(u[D]||0)+x.size;this._users.forAll(v=>{const {id:q,name:a}=v;H.startsWith(q)&&(g[a]=(g[a]||0)+x.size)})});const f={};this._users.forAll(x=>{const H=x.name;"hitRate"in x&&"number"===typeof x.hitRate&&!isNaN(x.hitRate)&&0<x.hitRate?(g[H]=g[H]||0,f[H]=Math.round(100*x.hitRate)+"%"):f[H]="0%"});var p=Object.keys(g);p.sort((x,H)=>g[H]-g[x]);p.forEach(x=>n[x]=Math.round(g[x]/2**20)+"MB / "+f[x]);for(p=u.length-1;0<=p;--p){const x=u[p];x&&(n["Priority "+
(p+-3-1)]=Math.round(x/this._size*100)+"%")}return n}resetStats(){this._hit=this._miss=0;this._users.forAll(n=>n.resetHitRate())}clear(n){const g=n.id;this._db.forEach((u,f)=>{f.startsWith(g)&&(this._size-=u.size,this._db.delete(f),this._notifyRemove(f,u.entry,c.RemoveMode.ALL))});n.size=0}clearAll(){this._db.forEach((n,g)=>this._notifyRemove(g,n.entry,c.RemoveMode.ALL));this._users.forEach(n=>n.size=0);this._size=0;this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(n,
g,u){let f;this._removeFuncs.some(p=>n.startsWith(p[0])?(p=p[1](g,u),"number"===typeof p&&(f=p),!0):!1);return f}_checkSizeLimits(){if(this._size>this._maxSize)for(const [n,g]of this._db)if(this._purgeItem(n,g),this._size<=.9*this.maxSize)return;this._users.forEach(n=>{if(0<n.maxSize&&n.size>n.maxSize)for(const [g,u]of this._db)if(g.startsWith(n.id)&&(this._purgeItem(g,u,n),n.size<=.9*n.maxSize))break})}_purgeItem(n,g,u=this._users.find(f=>n.startsWith(f.id))){this._db.delete(n);if(1>=g.lives){this._size-=
g.size;u&&(u.size-=g.size);const f=this._notifyRemove(n,g.entry,c.RemoveMode.SOME);null!=f&&0<f&&(this._size+=f,u&&(u.size+=f),g.lives=g.lifetime,g.size=f,this._db.set(n,g))}else--g.lives,this._db.set(n,g)}}let L=0;c.MemCache=A;c.MemCacheStorage=w;c.minPriority=-3;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/normalizeUtils":function(){define("exports ../../config ../../core/Error ../../core/Logger ../Polygon ../Polyline ./normalizeUtilsCommon ./spatialReferenceUtils ./webMercatorUtils ../../rest/geometryService/cut ../../rest/geometryService/simplify".split(" "),
function(c,e,A,w,L,n,g,u,f,p,x){function H(E){const R=[];let d=0,G=0;for(let T=0;T<E.length;T++){const J=E[T];let Q=null;for(let P=0;P<J.length;P++)Q=J[P],R.push(Q),0===P?G=d=Q[0]:(d=Math.min(d,Q[0]),G=Math.max(G,Q[0]));Q&&R.push([(d+G)/2,0])}return R}function D(E,R){if(!(E instanceof n||E instanceof L))throw z.error("straightLineDensify: the input geometry is neither polyline nor polygon"),new A("straightLineDensify: the input geometry is neither polyline nor polygon");var d=g.getGeometryParts(E);
const G=[];for(const J of d){d=[];G.push(d);d.push([J[0][0],J[0][1]]);for(let Q=0;Q<J.length-1;Q++){const P=J[Q][0],V=J[Q][1],l=J[Q+1][0],N=J[Q+1][1];var T=Math.sqrt((l-P)*(l-P)+(N-V)*(N-V));const m=(N-V)/T,t=(l-P)/T,M=T/R;if(1<M){for(let I=1;I<=M-1;I++){const S=I*R;d.push([t*S+P,m*S+V])}T=(T+Math.floor(M-1)*R)/2;d.push([t*T+P,m*T+V])}d.push([l,N])}}return"polygon"===E.type?new L({rings:G,spatialReference:E.spatialReference}):new n({paths:G,spatialReference:E.spatialReference})}function v(E,R,d){R&&
(E=D(E,1E6),E=f.webMercatorToGeographic(E,!0));d&&(E=g.updatePolyGeometry(E,d));return E}function q(E,R,d){if(Array.isArray(E)){var G=E[0];G>R?(d=g.offsetMagnitude(G,R),E[0]=G+-2*d*R):G<d&&(R=g.offsetMagnitude(G,d),E[0]=G+-2*R*d)}else G=E.x,G>R?(d=g.offsetMagnitude(G,R),E=E.clone().offset(-2*d*R,0)):G<d&&(R=g.offsetMagnitude(G,d),E=E.clone().offset(-2*R*d,0));return E}function a(E,R){let d=-1;for(let G=0;G<R.cutIndexes.length;G++){const T=R.cutIndexes[G],J=R.geometries[G],Q=g.getGeometryParts(J);
for(let P=0;P<Q.length;P++){const V=Q[P];V.some(l=>{if(180>l[0])return!0;l=0;for(var N=0;N<V.length;N++){var m=V[N][0];l=m>l?m:l}l=Number(l.toFixed(9));l=-360*g.offsetMagnitude(l,180);for(N=0;N<V.length;N++)m=J.getPoint(P,N),J.setPoint(P,N,m.clone().offset(l,0));return!0})}if(T===d)if("polygon"===E[0].type)for(const P of g.getGeometryParts(J))E[T]=E[T].addRing(P);else{if("polyline"===E[0].type)for(const P of g.getGeometryParts(J))E[T]=E[T].addPath(P)}else d=T,E[T]=J}return E}async function r(E,R,
d){if(!Array.isArray(E))return r([E],R);R&&"string"!==typeof R&&z.warn("normalizeCentralMeridian()","The url object is deprecated, use the url string instead");var G="string"===typeof R?R:R?.url??e.geometryServiceUrl;let T,J,Q;let P=0;var V=[];R=[];for(var l of E)if(null==l)R.push(l);else{if(!N){var N=l.spatialReference;var m=u.getInfo(N);var t=(T=N.isWebMercator)?102100:4326;J=g.cutParams[t].maxX;Q=g.cutParams[t].minX;var M=g.cutParams[t].plus180Line;t=g.cutParams[t].minus180Line}if(m)if("mesh"===
l.type)R.push(l);else if("point"===l.type)R.push(q(l.clone(),J,Q));else if("multipoint"===l.type){var I=l.clone();I.points=I.points.map(S=>q(S,J,Q));R.push(I)}else if("extent"===l.type)I=l.clone()._normalize(!1,!1,m),R.push(I.rings?new L(I):I);else if(l.extent){I=l.extent;const S=2*g.offsetMagnitude(I.xmin,Q)*J;let Z=0===S?l.clone():g.updatePolyGeometry(l.clone(),S);I.offset(S,0);I.intersects(M)&&I.xmax!==J?(P=I.xmax>P?I.xmax:P,Z=v(Z,T),V.push(Z),R.push("cut")):I.intersects(t)&&I.xmin!==Q?(P=2*I.xmax*
J>P?2*I.xmax*J:P,Z=v(Z,T,360),V.push(Z),R.push("cut")):R.push(Z)}else R.push(l.clone());else R.push(l)}N=g.offsetMagnitude(P,J);m=-90;M=N;for(l=new n;0<N;)t=-180+360*N,l.addPath([[t,m],[t,-1*m]]),m*=-1,N--;if(0<V.length&&0<M){N=await p.cut(G,V,l,d);N=a(V,N);m=[];V=[];for(M=0;M<R.length;M++)l=R[M],"cut"!==l?V.push(l):(l=N.shift(),t=E[M],null!=t&&"polygon"===t.type&&t.rings&&1<t.rings.length&&l.rings.length>=t.rings.length?(m.push(l),V.push("simplify")):V.push(T?f.geographicToWebMercator(l):l));if(!m.length)return V;
R=await x.simplify(G,m,d);E=[];for(d=0;d<V.length;d++)G=V[d],"simplify"!==G?E.push(G):E.push(T?f.geographicToWebMercator(R.shift()):R.shift());return E}E=[];for(d=0;d<R.length;d++)G=R[d],"cut"!==G?E.push(G):(G=V.shift(),E.push(!0===T?f.geographicToWebMercator(G):G));return E}const z=w.getLogger("esri.geometry.support.normalizeUtils");c.getClosestDenormalizedXToReference=function(E,R,d){d=u.getInfo(d);if(null==d)return E;const [G,T]=d.valid;d=2*T;let J=0,Q=0;R>T?J=Math.ceil(Math.abs(R-T)/d):R<G&&(J=
-Math.ceil(Math.abs(R-G)/d));E>T?Q=Math.ceil(Math.abs(E-T)/d):E<G&&(Q=-Math.ceil(Math.abs(E-G)/d));E+=(J-Q)*d;R=E-R;R>T?E-=d:R<G&&(E+=d);return E};c.getDenormalizedExtent=function(E){if(!E)return null;const R=E.extent;if(!R)return null;var d=E.spatialReference&&u.getInfo(E.spatialReference);if(!d)return R;const [G,T]=d.valid;({width:d}=R);let {xmin:J,xmax:Q}=R;[J,Q]=[Q,J];if("extent"===E.type||0===d||d<=T||d>2*T||J<G||Q>T)return R;let P;switch(E.type){case "polygon":if(1<E.rings.length)P=H(E.rings);
else return R;break;case "polyline":if(1<E.paths.length)P=H(E.paths);else return R;break;case "multipoint":P=E.points}E=R.clone();for(let V=0;V<P.length;V++){let l=P[V][0];0>l?(l+=T,Q=Math.max(l,Q)):(l-=T,J=Math.min(l,J))}E.xmin=J;E.xmax=Q;return E.width<d?(E.xmin-=T,E.xmax-=T,E):R};c.normalizeCentralMeridian=r;c.normalizeMapX=function(E,R){if(R=u.getInfo(R)){const [d,G]=R.valid;R=G-d;if(E<d)for(;E<d;)E+=R;if(E>G)for(;E>G;)E-=R}return E};c.straightLineDensify=D;Object.defineProperty(c,Symbol.toStringTag,
{value:"Module"})})},"esri/geometry/support/normalizeUtilsCommon":function(){define(["exports","../Polyline","../SpatialReference","./jsonUtils"],function(c,e,A,w){function L(n){return w.isPolygon(n)?n.rings:n.paths}e={102100:{maxX:2.0037508342788905E7,minX:-2.0037508342788905E7,plus180Line:new e({paths:[[[2.0037508342788905E7,-2.0037508342788905E7],[2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:A.WebMercator}),minus180Line:new e({paths:[[[-2.0037508342788905E7,-2.0037508342788905E7],
[-2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:A.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new e({paths:[[[180,-180],[180,180]]],spatialReference:A.WGS84}),minus180Line:new e({paths:[[[-180,-180],[-180,180]]],spatialReference:A.WGS84})}};c.cutParams=e;c.getGeometryParts=L;c.offsetMagnitude=function(n,g){return Math.ceil((n-g)/(2*g))};c.updatePolyGeometry=function(n,g){const u=L(n);for(const f of u)for(const p of f)p[0]+=g;return n};Object.defineProperty(c,Symbol.toStringTag,
{value:"Module"})})},"esri/rest/geometryService/cut":function(){define("exports ../../geometry ../../request ../../geometry/support/jsonUtils ../../geometry/support/spatialReferenceUtils ../utils".split(" "),function(c,e,A,w,L,n){c.cut=async function(g,u,f,p){g=n.parseUrl(g);const x=u[0].spatialReference;u={...p,responseType:"json",query:{...g.query,f:"json",sr:L.srToRESTValue(x),target:JSON.stringify({geometryType:w.getJsonType(u[0]),geometries:u}),cutter:JSON.stringify(f)}};u=await A(g.path+"/cut",
u);const {cutIndexes:H,geometries:D=[]}=u.data;return{cutIndexes:H,geometries:D.map(v=>{v=w.fromJSON(v);v.spatialReference=x;return v})}};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/rest/utils":function(){define("exports ../config ../kernel ../core/lang ../core/urlUtils ../support/apiKeyUtils".split(" "),function(c,e,A,w,L,n){function g(u,f,p){const x={};for(const D in u)if("declaredClass"!==D){var H=u[D];if(null!=H&&"function"!==typeof H)if(Array.isArray(H)){x[D]=[];for(let v=
0;v<H.length;v++)x[D][v]=g(H[v])}else"object"===typeof H?H.toJSON?(H=H.toJSON(p?.[D]),x[D]=f?H:JSON.stringify(H)):x[D]=f?H:JSON.stringify(H):x[D]=H}return x}c.asValidOptions=function(u,f){return f?{...f,query:{...(u??{}),...f.query}}:{query:u}};c.encode=g;c.getToken=function(u,f){return u?n.supportsApiKey(u)&&(f||e.apiKey)?f||e.apiKey:A.id?.findCredential(u)?.token:null};c.parseUrl=function(u){return"string"===typeof u?L.urlToObject(u):w.clone(u)};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},
"esri/rest/geometryService/simplify":function(){define("exports ../../request ../../core/urlUtils ../../geometry/support/jsonUtils ../../geometry/support/spatialReferenceUtils ./utils".split(" "),function(c,e,A,w,L,n){c.simplify=async function(g,u,f){const p="string"===typeof g?A.urlToObject(g):g;g=u[0].spatialReference;const x=w.getJsonType(u[0]);u={...f,query:{...p.query,f:"json",sr:L.srToRESTValue(g),geometries:JSON.stringify(n.encodeGeometries(u))}};({data:u}=await e(p.path+"/simplify",u));return n.decodeGeometries(u.geometries,
x,g)};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/rest/geometryService/utils":function(){define(["exports","../../geometry/support/jsonUtils"],function(c,e){c.decodeGeometries=function(A,w,L){const n=e.getGeometryType(w);return A.map(g=>{g=n.fromJSON(g);g.spatialReference=L;return g})};c.encodeGeometries=function(A){return{geometryType:e.getJsonType(A[0]),geometries:A.map(w=>w.toJSON())}};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/attributeSupport":function(){define(["exports",
"../../../core/Error","../../../core/sql/WhereClauseCache","../../support/fieldType"],function(c,e,A,w){function L(D,v,q={}){const a=n(v,D);if(!a)throw q=p.getError(v,D),new e("unsupported-query","invalid SQL expression",{expression:v,error:q});D=q.expressionName||"expression";if(q.validateStandardized&&!a.isStandardized)throw new e("unsupported-query",`${D} is not standard`,{expression:v});if(q.validateAggregate&&!a.isAggregate)throw new e("unsupported-query",`${D} does not contain a valid aggregate function`,
{expression:v});return a.fieldNames}function n(D,v){return D?p.get(D,v):null}function g(D){return/\((.*?)\)/.test(D)?D:D.split(" as ")[0]}function u(D,v,q,a={}){const r=new Map;var z=a.allowedFieldTypes??H;for(const E of q)if("*"!==E)if(D.get(E))f(r,D,v,z,E);else try{const R=g(E),d=L(D,R,{validateStandardized:!0});for(const G of d)f(r,D,v,z,G)}catch(R){r.set(E,{type:"expression-error",expression:E,error:R})}if(r.size)throw new e("unsupported-query",`${a.expressionName??"expression"} contains invalid or missing fields`,
{errors:Array.from(r.values()),query:a.query});}function f(D,v,q,a,r){"*"!==r&&((v=v.get(r))?q.has(v.name)?!1===a?.has(v.type)&&D.set(r,{type:"invalid-type",fieldName:v.name,fieldType:w.kebabDict.fromJSON(v.type),allowedFieldTypes:Array.from(a,z=>w.kebabDict.fromJSON(z))}):D.set(r,{type:"missing-field",fieldName:v.name}):D.set(r,{type:"invalid-field",fieldName:r}))}const p=new A.WhereClauseCache(50,500);A=new Set("esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeBigInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong".split(" "));
const x=new Set(["esriFieldTypeDate","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]),H=new Set(["esriFieldTypeString","esriFieldTypeGUID","esriFieldTypeGlobalID",...A,...x]);c.allDateAndTimeFieldTypes=x;c.getAliasFromFieldName=function(D){return D.split(" as ")[1]};c.getExpressionFromFieldName=g;c.getWhereClause=n;c.numericFieldTypes=A;c.validateFields=u;c.validateHaving=function(D,v,q,a,r){if(!q)return!0;const z=L(D,q,{validateAggregate:!0,expressionName:"having clause"});
u(D,v,z,{expressionName:"having clause",query:r});if(!n(q,D)?.getExpressions().every(E=>{const {aggregateType:R,field:d}=E,G=D.get(d)?.name;return a.some(T=>{const {onStatisticField:J,statisticType:Q}=T;return D.get(J)?.name===G&&Q.toLowerCase().trim()===R})}))throw new e("unsupported-query","expressions in having clause should also exist in outStatistics",{having:q});return!0};c.validateWhere=function(D,v,q,a){if(!q)return!0;q=L(D,q,{validateStandardized:!0,expressionName:"where clause"});u(D,v,
q,{expressionName:"where clause",query:a});return!0};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/WhereClauseCache":function(){define(["exports","../LRUCache","./WhereClause"],function(c,e,A){class w{constructor(L,n){this._cache=new e.LRUCache(L);this._invalidCache=new e.LRUCache(n)}get(L,n){const g=`${n.uid}:${L}`,u=this._cache.get(g);if(u)return u;if(null!=this._invalidCache.get(g))return null;try{const f=A.WhereClause.create(L,n);this._cache.put(g,f);return f}catch(f){return this._invalidCache.put(g,
f),null}}getError(L,n){return this._invalidCache.get(`${n.uid}:${L}`)??null}}c.WhereClauseCache=w;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/core/LRUCache":function(){define(["exports","./MemCache"],function(c,e){class A{constructor(w,L){this._storage=new e.MemCacheStorage;this.name=this.id="";this.size=0;this._storage.maxSize=w;this._storage.register(this);L&&this._storage.registerRemoveFunc("",L)}destroy(){this._storage.deregister(this);this._storage.destroy()}put(w,L,
n=1){this._storage.put(this,w,L,n,1)}pop(w){return this._storage.pop(this,w)}get(w){return this._storage.get(this,w)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(w){this._storage.maxSize=w}resetHitRate(){}}c.LRUCache=A;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/WhereClause":function(){define("exports ../../arcade/ArcadeDate ../../arcade/featureset/support/errorsupport ../has ./AggregateFunctions ./DateOnly ./sqlArithmeticUtils ./sqlCompareUtils ./sqlDateParsingUtils ./SqlInterval ./SqlTimestampOffset ./StandardizedFunctions ./TimeOnly ./WhereGrammar ../../chunks/datetime".split(" "),
function(c,e,A,w,L,n,g,u,f,p,x,H,D,v,q){function a(l){return Array.isArray(l)?l:[l]}function r(l){return null!==l?!0!==l:null}function z(l,N){return null!=l&&null!=N?!0===l&&!0===N:!1===l||!1===N?!1:null}function E(l,N){return null!=l&&null!=N?!0===l||!0===N:!0===l||!0===N?!0:null}function R(l,N){if(null==l)return null;let m=!1;for(const t of N)if(null==t)m=null;else if(l===t){m=!0;break}return m}function d(l,N,m){if(null==l)return null;let t="",M=P.Normal;for(let I=0;I<N.length;I++){const S=N.charAt(I);
switch(M){case P.Normal:S===m?M=P.Escaped:t="-[]/{}()*+?.\\^$|".includes(S)?t+("\\"+S):"%"===S?t+".*":"_"===S?t+".":t+S;break;case P.Escaped:t="-[]/{}()*+?.\\^$|".includes(S)?t+("\\"+S):t+S,M=P.Normal}}return(new RegExp("^"+t+"$","m")).test(l)}function G(l,N,m,t){l=t.getAttribute(l,N);N=m?.get(N);return null==l||"esriFieldTypeDate"!==N?.type&&"date"!==N?.type?null==l||"esriFieldTypeDateOnly"!==N?.type&&"date-only"!==N?.type?null==l||"esriFieldTypeTimeOnly"!==N?.type&&"time-only"!==N?.type?null==l||
"esriFieldTypeTimestampOffset"!==N?.type&&"timestamp-offset"!==N?.type?l:new x.SqlTimeStampOffset(l):D.TimeOnly.fromReader(l):n.DateOnly.fromReader(l):f.convertToExecutingTimeZone(new Date(l),m?.getLuxonTimeZone(N.name)??q.FixedOffsetZone.utcInstance)}const T=new Set(["current_timestamp","current_date","current_time"]);class J{static makeBool(l){return!0===l}static featureValue(l,N,m,t){return G(l,N,m,t)}static equalsNull(l){return null===l}static applyLike(l,N,m){return d(l,N,m)}static ensureArray(l){return a(l)}static applyIn(l,
N){return R(l,N)}static currentDate(l){return n.DateOnly.fromNow(l)}static makeSqlInterval(l,N,m){return p.SqlInterval.createFromValueAndQualifer(l,N,m)}static convertInterval(l){return l instanceof p.SqlInterval?l.valueInMilliseconds():l}static currentTimestamp(l){return f.convertToExecutingTimeZone(new Date,l)}static compare(l,N,m,t){return u.sqlCompare(N,m,l)}static calculate(l,N,m,t){return g.sqlCalculateFunction(l,N,m,t)}static evaluateTime(l){return f.parseTime(l)}static evaluateTimestamp(l,
N,m){return f.parseTimestamp(l,N,m)}static evaluateDate(l,N){return f.parseDate(l,N)}static evaluateFunction(l,N,m){return H.evaluateFunction(l,N,m)}static lookup(l,N){l=N[l];return void 0===l?null:l}static between(l,N,m){return null==l||null==N[0]||null==N[1]?null:u.sqlCompare(l,N[0],"\x3e\x3d")&&u.sqlCompare(l,N[1],"\x3c\x3d")}static notbetween(l,N,m){return null==l||null==N[0]||null==N[1]?null:u.sqlCompare(l,N[0],"\x3c")||u.sqlCompare(l,N[1],"\x3e")}static ternaryNot(l){return r(l)}static ternaryAnd(l,
N){return z(l,N)}static ternaryOr(l,N){return E(l,N)}}class Q{constructor(l,N,m="UTC"){this.fieldsIndex=N;this.timeZone=m;this.parameters={};this._hasDateFunctions=void 0;this.parseTree=v.WhereGrammar.parse(l);const {isStandardized:t,isAggregate:M,referencedFieldNames:I}=this._extractExpressionInfo(N);this._referencedFieldNames=I;this.isStandardized=t;this.isAggregate=M}static convertValueToStorageFormat(l,N=null){if(null===N)return f.isDate(l)?l.getTime():f.isDateTime(l)?l.toMillis():f.isTimestampOffset(l)?
l.toStorageFormat():f.isTimeOnly(l)?l.toStorageString():f.isDateOnly(l)?l.toStorageFormat():l;switch(N){case "date":if(f.isDate(l))return l.getTime();if(f.isDateTime(l))return l.toMillis();if(f.isTimestampOffset(l))return l.toMilliseconds();if(f.isDateOnly(l))return l.toNumber();break;case "date-only":if(f.isDate(l))return n.DateOnly.fromDateJS(l).toString();if(f.isTimestampOffset(l))return n.DateOnly.fromSqlTimeStampOffset(l).toString();if(f.isDateTime(l))return n.DateOnly.fromDateTime(l).toString();
break;case "time-only":if(f.isDate(l))return D.TimeOnly.fromDateJS(l).toStorageString();if(f.isDateTime(l))return D.TimeOnly.fromDateTime(l).toStorageString();if(f.isTimestampOffset(l))return D.TimeOnly.fromSqlTimeStampOffset(l).toStorageString();if(f.isTimeOnly(l))return l.toStorageString();break;case "timestamp-offset":if(f.isDate(l))return x.SqlTimeStampOffset.fromJSDate(l).toStorageFormat();if(f.isDateTime(l))return x.SqlTimeStampOffset.fromDateTime(l).toStorageFormat();if(f.isTimestampOffset(l))return l.toStorageFormat()}return l}static create(l,
N,m="UTC"){return new Q(l,N,m)}get fieldNames(){return this._referencedFieldNames}testSet(l,N=V){return!!this._evaluateNode(this.parseTree,null,N,l)}calculateValue(l,N=V){l=this._evaluateNode(this.parseTree,l,N,null);return l instanceof p.SqlInterval?l.valueInMilliseconds()/864E5:l}calculateValueCompiled(l,N=V){if(null!=this.parseTree._compiledVersion)return this.parseTree._compiledVersion(l,this.parameters,N,this.fieldsIndex,this.timeZone);if(w("esri-csp-restrictions"))return this.calculateValue(l,
N);this._compileMe();return this.parseTree._compiledVersion(l,this.parameters,N,this.fieldsIndex,this.timeZone)}testFeature(l,N=V){return!!this._evaluateNode(this.parseTree,l,N,null)}testFeatureCompiled(l,N=V){if(null!=this.parseTree._compiledVersion)return!!this.parseTree._compiledVersion(l,this.parameters,N,this.fieldsIndex,this.timeZone);if(w("esri-csp-restrictions"))return this.testFeature(l,N);this._compileMe();return!!this.parseTree._compiledVersion(l,this.parameters,N,this.fieldsIndex,this.timeZone)}get hasDateFunctions(){if(null!=
this._hasDateFunctions)return this._hasDateFunctions;this._hasDateFunctions=!1;this._visitAll(this.parseTree,l=>{"current-time"===l.type?this._hasDateFunctions=!0:"function"===l.type&&(this._hasDateFunctions=this._hasDateFunctions||T.has(l.name.toLowerCase()))});return this._hasDateFunctions}getFunctions(){const l=new Set;this._visitAll(this.parseTree,N=>{"function"===N.type&&l.add(N.name.toLowerCase())});return Array.from(l)}getExpressions(){const l=new Map;this._visitAll(this.parseTree,N=>{if("function"===
N.type){const m=N.name.toLowerCase();N=N.args.value[0];if("column-reference"===N.type){N=N.column;const t=`${m}-${N}`;l.has(t)||l.set(t,{aggregateType:m,field:N})}}});return[...l.values()]}getVariables(){const l=new Set;this._visitAll(this.parseTree,N=>{"parameter"===N.type&&l.add(N.value.toLowerCase())});return Array.from(l)}_compileMe(){const l="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=(new Function("feature","lookups","attributeAdapter",
"fieldsIndex","timeZone",l)).bind(J)}_extractExpressionInfo(l){const N=[],m=new Set;let t=!0,M=!1;this._visitAll(this.parseTree,I=>{switch(I.type){case "column-reference":var S=l?.get(I.column);let Z;S?S=Z=S.name??"":(Z=I.column,S=Z.toLowerCase());m.has(S)||(m.add(S),N.push(Z));I.column=Z;break;case "function":const {name:ca,args:ja}=I;I=ja.value.length;t&&(t=H.isStandardized(ca,I));!1===M&&(M=L.isAggregate(ca,I))}});return{referencedFieldNames:Array.from(N),isStandardized:t,isAggregate:M}}_visitAll(l,
N){if(null!=l)switch(N(l),l.type){case "when-clause":this._visitAll(l.operand,N);this._visitAll(l.value,N);break;case "case-expression":for(const m of l.clauses)this._visitAll(m,N);"simple"===l.format&&this._visitAll(l.operand,N);null!==l.else&&this._visitAll(l.else,N);break;case "expression-list":for(const m of l.value)this._visitAll(m,N);break;case "unary-expression":this._visitAll(l.expr,N);break;case "binary-expression":this._visitAll(l.left,N);this._visitAll(l.right,N);break;case "function":this._visitAll(l.args,
N)}}evaluateNodeToJavaScript(l){switch(l.type){case "interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(l.value)+", "+JSON.stringify(l.qualifier)+","+JSON.stringify(l.op)+")";case "case-expression":var N="";if("simple"===l.format){var m=this.evaluateNodeToJavaScript(l.operand);N="( ";for(let t=0;t<l.clauses.length;t++)N+=" (this.compare('\x3d',"+m+","+this.evaluateNodeToJavaScript(l.clauses[t].operand)+") ? ("+this.evaluateNodeToJavaScript(l.clauses[t].value)+") : "}else for(N=
"( ",m=0;m<l.clauses.length;m++)N+=" this.makeBool("+this.evaluateNodeToJavaScript(l.clauses[m].operand)+")\x3d\x3d\x3dtrue ? ("+this.evaluateNodeToJavaScript(l.clauses[m].value)+") : ";N=null!==l.else?N+this.evaluateNodeToJavaScript(l.else):N+"null";return N+" )";case "parameter":return"this.lookup("+JSON.stringify(l.value.toLowerCase())+",lookups)";case "expression-list":N="[";for(m of l.value)"["!==N&&(N+=","),N+=this.evaluateNodeToJavaScript(m);return N+"]";case "unary-expression":return"this.ternaryNot("+
this.evaluateNodeToJavaScript(l.expr)+")";case "binary-expression":switch(l.operator){case "AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(l.left)+","+this.evaluateNodeToJavaScript(l.right)+" )";case "OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(l.left)+","+this.evaluateNodeToJavaScript(l.right)+" )";case "IS":if("null"!==l.right.type)throw new A.SqlError(A.SqlErrorCodes.UnsupportedIsRhs);return"this.equalsNull("+this.evaluateNodeToJavaScript(l.left)+")";case "ISNOT":if("null"!==
l.right.type)throw new A.SqlError(A.SqlErrorCodes.UnsupportedIsRhs);return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(l.left)+")))";case "IN":return"this.applyIn("+this.evaluateNodeToJavaScript(l.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(l.right)+"))";case "NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(l.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(l.right)+")))";case "BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(l.left)+
","+this.evaluateNodeToJavaScript(l.right)+", timeZone)";case "NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(l.left)+","+this.evaluateNodeToJavaScript(l.right)+", timeZone)";case "LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(l.left)+","+this.evaluateNodeToJavaScript(l.right)+","+JSON.stringify(l.escape)+")";case "NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(l.left)+","+this.evaluateNodeToJavaScript(l.right)+","+JSON.stringify(l.escape)+
"))";case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return"this.compare("+JSON.stringify(l.operator)+","+this.evaluateNodeToJavaScript(l.left)+","+this.evaluateNodeToJavaScript(l.right)+", timeZone)";case "*":case "-":case "+":case "/":case "||":return"this.calculate("+JSON.stringify(l.operator)+","+this.evaluateNodeToJavaScript(l.left)+","+this.evaluateNodeToJavaScript(l.right)+", timeZone)"}throw new A.SqlError(A.SqlErrorCodes.UnsupportedOperator,{operator:l.operator});
case "null":case "boolean":case "string":case "number":return JSON.stringify(l.value);case "time":return"this.evaluateTime(JSON.stringify(node.value))";case "date":return"this.evaluateDate(JSON.stringify(node.value), 'unknown')";case "timestamp":return"this.evaluateTimestamp(JSON.stringify(node.value), 'unknown')";case "current-time":return"date"===l.mode?"this.currentDate(timeZone)":"this.currentTimestamp(timeZone)";case "column-reference":return"this.featureValue(feature,"+JSON.stringify(l.column)+
",fieldsIndex,attributeAdapter)";case "function":return"this.evaluateFunction("+JSON.stringify(l.name)+","+this.evaluateNodeToJavaScript(l.args)+", timeZone)"}throw new A.SqlError(A.SqlErrorCodes.UnsupportedSyntax,{node:l.type});}_evaluateNode(l,N,m,t){switch(l.type){case "interval":return m=this._evaluateNode(l.value,N,m,t),p.SqlInterval.createFromValueAndQualifer(m,l.qualifier,l.op);case "case-expression":if("simple"===l.format){var M=this._evaluateNode(l.operand,N,m,t);for(var I=0;I<l.clauses.length;I++)if(u.sqlCompare(M,
this._evaluateNode(l.clauses[I].operand,N,m,t),"\x3d",this.timeZone))return this._evaluateNode(l.clauses[I].value,N,m,t)}else for(M=0;M<l.clauses.length;M++)if(!0===this._evaluateNode(l.clauses[M].operand,N,m,t))return this._evaluateNode(l.clauses[M].value,N,m,t);return null!==l.else?this._evaluateNode(l.else,N,m,t):null;case "parameter":return l=this.parameters[l.value.toLowerCase()],f.isDate(l)?q.DateTime.fromJSDate(l):l instanceof e.ArcadeDate?l.toDateTime():l;case "expression-list":M=[];for(var S of l.value)M.push(this._evaluateNode(S,
N,m,t));return M;case "unary-expression":return r(this._evaluateNode(l.expr,N,m,t));case "binary-expression":switch(l.operator){case "AND":return z(this._evaluateNode(l.left,N,m,t),this._evaluateNode(l.right,N,m,t));case "OR":return E(this._evaluateNode(l.left,N,m,t),this._evaluateNode(l.right,N,m,t));case "IS":if("null"!==l.right.type)throw new A.SqlError(A.SqlErrorCodes.UnsupportedIsRhs);return null===this._evaluateNode(l.left,N,m,t);case "ISNOT":if("null"!==l.right.type)throw new A.SqlError(A.SqlErrorCodes.UnsupportedIsRhs);
return null!==this._evaluateNode(l.left,N,m,t);case "IN":return M=a(this._evaluateNode(l.right,N,m,t)),R(this._evaluateNode(l.left,N,m,t),M);case "NOT IN":return M=a(this._evaluateNode(l.right,N,m,t)),r(R(this._evaluateNode(l.left,N,m,t),M));case "BETWEEN":return M=this._evaluateNode(l.left,N,m,t),l=this._evaluateNode(l.right,N,m,t),null==M||null==l[0]||null==l[1]?null:u.sqlCompare(M,l[0],"\x3e\x3d",this.timeZone)&&u.sqlCompare(M,l[1],"\x3c\x3d",this.timeZone);case "NOTBETWEEN":return M=this._evaluateNode(l.left,
N,m,t),l=this._evaluateNode(l.right,N,m,t),null==M||null==l[0]||null==l[1]?null:u.sqlCompare(M,l[0],"\x3c",this.timeZone)||u.sqlCompare(M,l[1],"\x3e",this.timeZone);case "LIKE":return d(this._evaluateNode(l.left,N,m,t),this._evaluateNode(l.right,N,m,t),l.escape);case "NOT LIKE":return r(d(this._evaluateNode(l.left,N,m,t),this._evaluateNode(l.right,N,m,t),l.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return u.sqlCompare(this._evaluateNode(l.left,N,m,
t),this._evaluateNode(l.right,N,m,t),l.operator,this.timeZone);case "-":case "+":case "*":case "/":case "||":return g.sqlCalculateFunction(l.operator,this._evaluateNode(l.left,N,m,t),this._evaluateNode(l.right,N,m,t),this.timeZone)}case "null":case "boolean":case "string":case "number":return l.value;case "date":return l.parsedValue??(l.parsedValue=f.parseDate(l.value,"unknown")),l.parsedValue;case "timestamp":return l.parsedValue??(l.parsedValue=f.parseTimestamp(l.value,"unknown")),l.parsedValue;
case "time":return f.parseTime(l.value);case "current-time":return"date"===l.mode?n.DateOnly.fromNow(this.timeZone):f.convertToExecutingTimeZone(new Date,this.timeZone);case "column-reference":return G(N,l.column,this.fieldsIndex,m);case "data-type":return l.value;case "function":if(this.isAggregate&&L.isAggregate(l.name,l.args.value.length)){N=[];for(M of l.args?.value||[]){S=[];for(I of t||[])S.push(this._evaluateNode(M,I,m,null));N.push(S)}return L.aggregateFunction(l.name,N)}m=this._evaluateNode(l.args,
N,m,t);return H.evaluateFunction(l.name,m,this.timeZone)}throw new A.SqlError(A.SqlErrorCodes.UnsupportedSyntax,{node:l.type});}}var P;(function(l){l[l.Normal=0]="Normal";l[l.Escaped=1]="Escaped"})(P||(P={}));const V={getAttribute(l,N){return(l&&"object"===typeof l.attributes?l.attributes:l)[N]}};c.WhereClause=Q;c.defaultAttributeAdapter=V;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/ArcadeDate":function(){define(["exports","../core/string","../core/sql/UnknownTimeZone",
"../chunks/datetime"],function(c,e,A,w){function L(p,x,H){return p<x?p-x:p>H?p-H:0}function n(p,x=!0){if(p instanceof w.Zone)return p;if("system"===p.toLowerCase())return"system";if("utc"===p.toLowerCase())return"UTC";if("unknown"===p.toLowerCase())return A.UnknownTimeZone.instance;if(/^[\+\-]?[0-9]{1,2}([:][0-9]{2})?$/.test(p)){const H=w.FixedOffsetZone.parseSpecifier("UTC"+(p.startsWith("+")||p.startsWith("-")?"":"+")+p);if(H)return H}p=w.IANAZone.create(p);if(!p.isValid){if(x)throw new u(c.ArcadeDateErrorCodes.TimeZoneNotRecognized);
return null}return p}c.ArcadeDateErrorCodes=void 0;(c.ArcadeDateErrorCodes||(c.ArcadeDateErrorCodes={})).TimeZoneNotRecognized="TimeZoneNotRecognized";const g={[c.ArcadeDateErrorCodes.TimeZoneNotRecognized]:"Timezone identifier has not been recognized."};class u extends Error{constructor(p,x){super(e.replace(g[p],x));this.declaredRootClass="esri.arcade.arcadedate.dateerror";Error.captureStackTrace&&Error.captureStackTrace(this,u)}}class f{constructor(p){this._date=p;this.declaredRootClass="esri.arcade.arcadedate"}static fromParts(p=
0,x=1,H=1,D=0,v=0,q=0,a=0,r){if(isNaN(p)||isNaN(x)||isNaN(H)||isNaN(D)||isNaN(v)||isNaN(q)||isNaN(a))return null;const z=w.DateTime.local(p,x).daysInMonth;p=w.DateTime.fromObject({day:1>H?1:H>z?z:H,year:p,month:1>x?1:12<x?12:x,hour:0>D?0:23<D?23:D,minute:0>v?0:59<v?59:v,second:0>q?0:59<q?59:q,millisecond:0>a?0:999<a?999:a},{zone:n(r)});p=p.plus({months:L(x,1,12),days:L(H,1,z),hours:L(D,0,23),minutes:L(v,0,59),seconds:L(q,0,59),milliseconds:L(a,0,999)});return new f(p)}static get systemTimeZoneCanonicalName(){return Intl.DateTimeFormat().resolvedOptions().timeZone??
"system"}static arcadeDateAndZoneToArcadeDate(p,x){x=n(x);return p.isUnknownTimeZone||x===A.UnknownTimeZone.instance?f.fromParts(p.year,p.monthJS+1,p.day,p.hour,p.minute,p.second,p.millisecond,x):new f(p._date.setZone(x))}static dateJSToArcadeDate(p){return new f(w.DateTime.fromJSDate(p,{zone:"system"}))}static dateJSAndZoneToArcadeDate(p,x="system"){x=n(x);return new f(w.DateTime.fromJSDate(p,{zone:x}))}static unknownEpochToArcadeDate(p){return new f(w.DateTime.fromMillis(p,{zone:A.UnknownTimeZone.instance}))}static unknownDateJSToArcadeDate(p){return new f(w.DateTime.fromMillis(p.getTime(),
{zone:A.UnknownTimeZone.instance}))}static epochToArcadeDate(p,x="system"){x=n(x);return new f(w.DateTime.fromMillis(p,{zone:x}))}static dateTimeToArcadeDate(p){return new f(p)}clone(){return new f(this._date)}changeTimeZone(p){p=n(p);return f.dateTimeToArcadeDate(this._date.setZone(p))}static dateTimeAndZoneToArcadeDate(p,x){x=n(x);return p.zone===A.UnknownTimeZone.instance||x===A.UnknownTimeZone.instance?f.fromParts(p.year,p.month,p.day,p.hour,p.minute,p.second,p.millisecond,x):new f(p.setZone(x))}static nowToArcadeDate(p){p=
n(p);return new f(w.DateTime.fromJSDate(new Date,{zone:p}))}static nowUTCToArcadeDate(){return new f(w.DateTime.utc())}get isSystem(){return"system"===this.timeZone||this.timeZone===f.systemTimeZoneCanonicalName}equals(p){return this.isSystem&&p.isSystem?this.toNumber()===p.toNumber():this.isUnknownTimeZone!==p.isUnknownTimeZone?!1:this._date.equals(p._date)}get isUnknownTimeZone(){return this._date.zone===A.UnknownTimeZone.instance}get isValid(){return this._date.isValid}get hour(){return this._date.hour}get second(){return this._date.second}get day(){return this._date.day}get dayOfWeekISO(){return this._date.weekday}get dayOfWeekJS(){let p=
this._date.weekday;6<p&&(p=0);return p}get millisecond(){return this._date.millisecond}get monthISO(){return this._date.month}get weekISO(){return this._date.weekNumber}get yearISO(){return this._date.weekYear}get monthJS(){return this._date.month-1}get year(){return this._date.year}get minute(){return this._date.minute}get zone(){return this._date.zone}get timeZoneOffset(){return this.isUnknownTimeZone?0:this._date.offset}get timeZone(){if(this.isUnknownTimeZone)return"unknown";if("system"===this._date.zone.type)return"system";
const p=this.zone;return"fixed"===p.type?0===p.fixed?"UTC":p.formatOffset(0,"short"):p.name}stringify(){return JSON.stringify(this.toJSDate())}plus(p){return new f(this._date.plus(p))}diff(p,x="milliseconds"){return this._date.diff(p._date,x)[x]}toISODate(){return this._date.toISODate()}toISOString(p){return p?this._date.toISO({suppressMilliseconds:!0,includeOffset:!this.isUnknownTimeZone}):this._date.toISO({includeOffset:!this.isUnknownTimeZone})}toISOTime(p,x){return this._date.toISOTime({suppressMilliseconds:p,
includeOffset:x&&!this.isUnknownTimeZone})}toFormat(p,x){this.isUnknownTimeZone&&(p=p.replaceAll("Z",""));return this._date.toFormat(p,x)}toJSDate(){return this._date.toJSDate()}toSQLValue(){return this._date.toFormat("yyyy-LL-dd HH:mm:ss")}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}toDateTime(){return this._date}toNumber(){return this._date.toMillis()}getTime(){return this._date.toMillis()}toUTC(){return new f(this._date.toUTC())}toLocal(){return new f(this._date.toLocal())}toString(){return this.toISOString(!0)}static fromReaderAsTimeStampOffset(p){if(!p)return null;
p=w.DateTime.fromISO(p,{setZone:!0});return new f(p)}}c.ArcadeDate=f;c.ArcadeDateError=u;c.ArcadeDateErrorMessages=g;c.createDateTimeZone=n;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/UnknownTimeZone":function(){define(["exports","../../chunks/datetime"],function(c,e){function A(L){return L instanceof e.Zone?L===w.instance?!0:!1:"unknown"===L?.toString().toLowerCase()?!0:!1}class w{}w.instance=new e.IANAZone("Etc/UTC");c.UnknownTimeZone=w;c.adoptTimeZone=function(L,
n){return e.DateTime.fromObject({day:L.day,year:L.year,month:L.month,hour:L.hour,minute:L.minute,second:L.second,millisecond:L.millisecond},{zone:n})};c.isUnknownTimeZone=A;c.substituteUnknownTimezone=function(L){return A(L)?w.instance:L};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/featureset/support/errorsupport":function(){define(["exports","../../../core/string"],function(c,e){c.SqlErrorCodes=void 0;(function(g){g.InvalidFunctionParameters="InvalidFunctionParameters";
g.InvalidValueForAggregateFunction="InvalidValueForAggregateFunction";g.UnsupportedSqlFunction="UnsupportedSqlFunction";g.UnsupportedOperator="UnsupportedOperator";g.UnsupportedSyntax="UnsupportedSyntax";g.UnsupportedIsRhs="UnsupportedIsRhs";g.UnsupportedIsLhs="UnsupportedIsLhs";g.InvalidDataType="InvalidDataType";g.CannotCastValue="CannotCastValue";g.FunctionNotRecognized="FunctionNotRecognized";g.InvalidTime="InvalidTime";g.InvalidParameterCount="InvalidParameterCount";g.InvalidTimeStamp="InvalidTimeStamp";
g.InvalidDate="InvalidDate";g.InvalidOperator="InvalidOperator";g.IllegalInterval="IllegalInterval";g.YearMonthIntervals="YearMonthIntervals";g.PrimarySecondaryQualifiers="PrimarySecondaryQualifiers";g.MissingStatisticParameters="MissingStatisticParameters"})(c.SqlErrorCodes||(c.SqlErrorCodes={}));const A={[c.SqlErrorCodes.InvalidValueForAggregateFunction]:"Invalid value used in aggregate function",[c.SqlErrorCodes.MissingStatisticParameters]:"Statistic does not have 1 or 0 Parameters",[c.SqlErrorCodes.InvalidFunctionParameters]:"Invalid parameters for call to {function}",
[c.SqlErrorCodes.UnsupportedIsLhs]:"Unsupported left hand expression in is statement",[c.SqlErrorCodes.UnsupportedIsRhs]:"Unsupported right hand expression in is statement",[c.SqlErrorCodes.UnsupportedOperator]:"Unsupported operator - {operator}",[c.SqlErrorCodes.UnsupportedSyntax]:"Unsupported syntax - {node}",[c.SqlErrorCodes.UnsupportedSqlFunction]:"Sql function not found \x3d {function}",[c.SqlErrorCodes.InvalidDataType]:"Invalid sql data type",[c.SqlErrorCodes.InvalidDate]:"Invalid date encountered",
[c.SqlErrorCodes.InvalidOperator]:"Invalid operator encountered",[c.SqlErrorCodes.InvalidTime]:"Invalid time encountered",[c.SqlErrorCodes.IllegalInterval]:"Illegal interval",[c.SqlErrorCodes.FunctionNotRecognized]:"Function not recognized",[c.SqlErrorCodes.InvalidTimeStamp]:"Invalid timestamp encountered",[c.SqlErrorCodes.InvalidParameterCount]:"Invalid parameter count for call to {name}",[c.SqlErrorCodes.PrimarySecondaryQualifiers]:"Primary and Secondary SqlInterval qualifiers not supported",[c.SqlErrorCodes.YearMonthIntervals]:"Year-Month Intervals not supported",
[c.SqlErrorCodes.CannotCastValue]:"Cannot cast value to the required data type"};class w extends Error{constructor(g,u){super(e.replace(A[g],u));this.declaredRootClass="esri.arcade.featureset.support.sqlerror";Error.captureStackTrace&&Error.captureStackTrace(this,w)}}c.FeatureSetErrorCodes=void 0;(function(g){g.NeverReach="NeverReach";g.NotImplemented="NotImplemented";g.Cancelled="Cancelled";g.InvalidStatResponse="InvalidStatResponse";g.InvalidRequest="InvalidRequest";g.RequestFailed="RequestFailed";
g.MissingFeatures="MissingFeatures";g.AggregationFieldNotFound="AggregationFieldNotFound";g.DataElementsNotFound="DataElementsNotFound"})(c.FeatureSetErrorCodes||(c.FeatureSetErrorCodes={}));const L={[c.FeatureSetErrorCodes.Cancelled]:"Cancelled",[c.FeatureSetErrorCodes.InvalidStatResponse]:"Invalid statistics response from service",[c.FeatureSetErrorCodes.InvalidRequest]:"Invalid request",[c.FeatureSetErrorCodes.RequestFailed]:"Request failed - {reason}",[c.FeatureSetErrorCodes.MissingFeatures]:"Missing features",
[c.FeatureSetErrorCodes.AggregationFieldNotFound]:"Aggregation field not found",[c.FeatureSetErrorCodes.DataElementsNotFound]:"Data elements not found on service",[c.FeatureSetErrorCodes.NeverReach]:"Encountered unreachable logic",[c.FeatureSetErrorCodes.NotImplemented]:"Not implemented"};class n extends Error{constructor(g,u){super(e.replace(L[g],u));this.declaredRootClass="esri.arcade.featureset.support.featureseterror";Error.captureStackTrace&&Error.captureStackTrace(this,n)}}c.FeatureSetError=
n;c.FeatureSetErrorMessages=L;c.SqlError=w;c.SqlErrorMessages=A;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/AggregateFunctions":function(){define("exports ../../arcade/featureset/support/errorsupport ./DateOnly ./SqlTimestampOffset ./TimeOnly ../../chunks/datetime".split(" "),function(c,e,A,w,L,n){function g(x){if(null===x)return null;let H=0,D=0;for(let v=0;v<x.length;v++){const q=x[v];if(null!==q){if("number"!==typeof q)throw new e.SqlError(e.SqlErrorCodes.InvalidValueForAggregateFunction);
D++;H+=q}}return 0===D?null:H/x.length}function u(x,H){if(null===x)return null;let D=null,v=null;for(const q of x)x=q,x=q instanceof A.DateOnly?q.toNumber():q instanceof L.TimeOnly?q.toNumber():q instanceof n.DateTime?q.toMillis():q instanceof w.SqlTimeStampOffset?q.toMilliseconds():q,null===D?(D=q,v=x):"max"===H&&null!==v&&null!==x&&v<=x?(D=q,v=x):"min"===H&&null!==v&&null!==x&&v>=x&&(D=q,v=x);return D}function f(x){if(null===x)return null;x=x.filter(v=>null!==v);if(0===x.length)return null;const H=
g(x);if(null===H)return null;let D=0;for(const v of x){if("number"!==typeof v)throw new e.SqlError(e.SqlErrorCodes.InvalidValueForAggregateFunction);D+=(H-v)**2}return D/(x.length-1)}const p={min:{minParams:1,maxParams:1,evaluate:x=>u(x[0],"min")},max:{minParams:1,maxParams:1,evaluate:x=>u(x[0],"max")},avg:{minParams:1,maxParams:1,evaluate:x=>g(x[0])},sum:{minParams:1,maxParams:1,evaluate:x=>{x=x[0];if(null===x)x=null;else{var H=0;for(let D=0;D<x.length;D++){const v=x[D];if(null!==v){if("number"!==
typeof v)throw new e.SqlError(e.SqlErrorCodes.InvalidValueForAggregateFunction);H+=v}}x=H}return x}},stddev:{minParams:1,maxParams:1,evaluate:x=>{x=x[0];null===x?x=null:(x=f(x),x=null===x?null:Math.sqrt(x));return x}},count:{minParams:1,maxParams:1,evaluate:x=>null==x[0]?null:x[0].length},var:{minParams:1,maxParams:1,evaluate:x=>f(x[0])}};c.aggregateFunction=function(x,H){const D=p[x.toLowerCase()];if(null==D)throw new e.SqlError(e.SqlErrorCodes.FunctionNotRecognized);if(H.length<D.minParams||H.length>
D.maxParams)throw new e.SqlError(e.SqlErrorCodes.InvalidParameterCount,{name:x.toUpperCase()});return D.evaluate(H)};c.isAggregate=function(x,H){x=p[x.toLowerCase()];return null!=x&&H>=x.minParams&&H<=x.maxParams};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/DateOnly":function(){define(["exports","../../arcade/ArcadeDate","../../intl/locale","../../chunks/datetime"],function(c,e,A,w){function L(g){g=g.replaceAll(/LTS|LT|LL?L?L?|l{1,4}/g,"[$\x26]");let u="";const f=
/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;for(const p of g.match(f)||[])switch(p){case "D":u+="d";break;case "DD":u+="dd";break;case "DDD":u+="o";break;case "d":u+="c";break;case "ddd":u+="ccc";break;case "dddd":u+="cccc";break;case "M":u+="L";break;case "MM":u+="LL";break;case "MMM":u+="LLL";break;case "MMMM":u+="LLLL";break;case "YY":u+="yy";
break;case "Y":case "YYYY":u+="yyyy";break;case "Q":u+="q";break;case "X":case "x":u+=p;break;default:u=2<=p.length&&"["===p.slice(0,1)&&"]"===p.slice(-1)?u+`'${p.slice(1,-1)}'`:u+`'${p}'`}return u}class n{constructor(g,u,f){this._year=g;this._month=u;this._day=f;this.declaredRootClass="esri.core.sql.dateonly"}get month(){return this._month}get monthJS(){return this._month-1}get year(){return this._year}get day(){return this._day}get isValid(){return this.toDateTime("unknown").isValid}equals(g){return g instanceof
n&&g.day===this.day&&g.month===this.month&&g.year===this.year}clone(){return new n(this._year,this._month,this._day)}toDateTime(g){return w.DateTime.fromObject({day:this.day,month:this.month,year:this.year},{zone:e.createDateTimeZone(g)})}toDateTimeLuxon(g){return w.DateTime.fromObject({day:this.day,month:this.month,year:this.year},{zone:e.createDateTimeZone(g)})}toString(){return`${this.year.toString().padStart(4,"0")}-${this.month.toString().padStart(2,"0")}-${this.day.toString().padStart(2,"0")}`}toFormat(g=
null){if(null===g||""===g)return this.toString();g=L(g);if(!g)return"";const u=this.toDateTime("unknown");return e.ArcadeDate.dateTimeToArcadeDate(u).toFormat(g,{locale:A.getLocale(),numberingSystem:"latn"})}toArcadeDate(){const g=this.toDateTime("unknown");return e.ArcadeDate.dateTimeToArcadeDate(g)}toNumber(){return this.toDateTime("unknown").toMillis()}toJSDate(){return this.toDateTime("unknown").toJSDate()}toStorageFormat(){return this.toFormat("yyyy-LL-dd")}toSQLValue(){return this.toFormat("yyyy-LL-dd")}toSQLWithKeyword(){return"date '"+
this.toFormat("yyyy-LL-dd")+"'"}plus(g,u){return n.fromDateTime(this.toUTCDateTime().plus({[g]:u}))}toUTCDateTime(){return w.DateTime.utc(this.year,this.month,this.day,0,0,0,0)}difference(g,u){switch(u.toLowerCase()){case "days":case "day":case "d":return this.toUTCDateTime().diff(g.toUTCDateTime(),"days").days;case "months":case "month":return this.toUTCDateTime().diff(g.toUTCDateTime(),"months").months;case "minutes":case "minute":case "m":return"M"===u?this.toUTCDateTime().diff(g.toUTCDateTime(),
"months").months:this.toUTCDateTime().diff(g.toUTCDateTime(),"minutes").minutes;case "seconds":case "second":case "s":return this.toUTCDateTime().diff(g.toUTCDateTime(),"seconds").seconds;case "milliseconds":case "millisecond":case "ms":return this.toUTCDateTime().diff(g.toUTCDateTime(),"milliseconds").milliseconds;case "hours":case "hour":case "h":return this.toUTCDateTime().diff(g.toUTCDateTime(),"hours").hours;case "years":case "year":case "y":return this.toUTCDateTime().diff(g.toUTCDateTime(),
"years").years;default:return this.toUTCDateTime().diff(g.toUTCDateTime(),"milliseconds").milliseconds}}static fromMilliseconds(g){g=w.DateTime.fromMillis(g,{zone:w.FixedOffsetZone.utcInstance});return g.isValid?n.fromParts(g.year,g.month,g.day):null}static fromSeconds(g){g=w.DateTime.fromSeconds(g,{zone:w.FixedOffsetZone.utcInstance});return g.isValid?n.fromParts(g.year,g.month,g.day):null}static fromReader(g){if(!g)return null;g=g.split("-");return 3!==g.length?null:new n(parseInt(g[0],10),parseInt(g[1],
10),parseInt(g[2],10))}static fromParts(g,u,f){g=new n(g,u,f);return!1===g.isValid?null:g}static fromDateJS(g){return n.fromParts(g.getFullYear(),g.getMonth()+1,g.getDay())}static fromDateTime(g){return n.fromParts(g.year,g.month,g.day)}static fromSqlTimeStampOffset(g){return this.fromDateTime(g.toDateTime())}static fromString(g,u=null){if(""===g||null===g)return null;var f=[];if(u)(u=L(u))&&f.push(u);else if(null===u||""===u)return g=w.DateTime.fromISO(g,{setZone:!0}),g.isValid?n.fromParts(g.year,
g.month,g.day):null;for(const p of f)if(f=w.DateTime.fromFormat(g,u??p),f.isValid)return new n(f.year,f.month,f.day);return null}static fromNow(g="system"){g=w.DateTime.fromJSDate(new Date).setZone(e.createDateTimeZone(g));return new n(g.year,g.month,g.day)}}c.DateOnly=n;c.standardiseDateOnlyFormat=L;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/SqlTimestampOffset":function(){define(["exports","../../chunks/datetime"],function(c,e){function A(L){return Number.isNaN(L)||
0===L?L:Math.trunc(L)}class w{constructor(L){this._timeStampOffset=L;this._date=null}toDateTime(){this._date??(this._date=e.DateTime.fromISO(this._timeStampOffset,{setZone:!0}));return this._date}get isValid(){return this.toDateTime().isValid}get timezoneOffsetHour(){return A(this.toDateTime().offset/60)}get timezoneOffsetMinutes(){return A(this.toDateTime().offset%60)}toMilliseconds(){return this.toDateTime().toMillis()}get hour(){return this.toDateTime().hour}get minute(){return this.toDateTime().minute}get second(){return this.toDateTime().second}get day(){return this.toDateTime().day}get month(){return this.toDateTime().month}get year(){return this.toDateTime().year}startOfDay(){return w.fromDateTime(this.toDateTime().startOf("day"))}static fromJSDate(L){return new w(e.DateTime.fromJSDate(L).toISO({includeOffset:!0}))}static fromDateTime(L){return new w(L.toISO({includeOffset:!0}))}static fromParts(L,
n,g=0,u=0,f=0,p=0,x=0,H=!1,D=0,v=0){L=`${L.toString().padStart(4,"0")}-${n.toString().padStart(2,"0")}-${g.toString().padStart(2,"0")}`;n="";10>p&&(n="0");u=`${u.toString().padStart(2,"0")}:${f.toString().padStart(2,"0")}:${n+p.toString()}`;0!==x&&(u+="."+x.toString().padStart(3,"0"));x=`${H?"-":"+"}${D.toString().padStart(2,"0")}:${v.toString().padStart(2,"0")}`;return new w(L+"T"+u+x)}toStorageFormat(){return this._timeStampOffset}toString(){return this._timeStampOffset}toSQLValue(){let L=this.toDateTime().toSQL({includeOffset:!0,
includeOffsetSpace:!0});L&&(L=L.replace(".000",""));return L}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}addMilliseconds(L){L=this.toDateTime().plus(L);return w.fromDateTime(L)}}c.SqlTimeStampOffset=w;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/TimeOnly":function(){define(["exports","../../arcade/kernel","../../intl/locale","../../chunks/datetime"],function(c,e,A,w){function L(g){if(!g)return"";const u=/(a|A|hh?|HH?|mm?|ss?|SSS|S|.)/g;let f="";for(const p of g.match(u)||
[])switch(p){case "SSS":f+=p;break;case "A":case "a":f+="a";break;case "m":case "mm":case "h":case "hh":case "H":case "HH":case "s":case "ss":f+=p;break;default:f+=`'${p}'`}return f}class n{constructor(g,u,f,p){this._hour=g;this._minute=u;this._second=f;this._millisecond=p;this.declaredRootClass="esri.core.sql.timeonly"}get hour(){return this._hour}get minute(){return this._minute}get second(){return this._second}get millisecond(){return this._millisecond}equals(g){return g instanceof n&&g.hour===
this.hour&&g.minute===this.minute&&g.second===this.second&&g.millisecond===this.millisecond}clone(){return new n(this.hour,this.minute,this.second,this.millisecond)}isValid(){return e.isInteger(this.hour)&&e.isInteger(this.minute)&&e.isInteger(this.second)&&e.isInteger(this.millisecond)&&0<=this.hour&&24>this.hour&&0<=this.minute&&60>this.minute&&0<=this.second&&60>this.second&&0<=this.millisecond&&1E3>this.millisecond}toString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,
"0")}:${this.second.toString().padStart(2,"0")}`+(0<this.millisecond?"."+this.millisecond.toString().padStart(3,"0"):"")}toSQLValue(){return this.toString()}toSQLWithKeyword(){return`time '${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}${0<this.millisecond?"."+this.millisecond.toString().padStart(3,"0"):""}'`}toStorageString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,
"0")}`}toFormat(g=null){return null===g||""===g?this.toString():(g=L(g))?w.DateTime.local(1970,1,1,this._hour,this._minute,this._second,this._millisecond).toFormat(g,{locale:A.getLocale(),numberingSystem:"latn"}):""}toNumber(){return this.millisecond+1E3*this.second+6E4*this.minute+36E5*this.hour}static fromParts(g,u,f,p){g=new n(g,u,f,p);return g.isValid()?g:null}static fromReader(g){if(!g)return null;g=g.split(":");return 3!==g.length?null:new n(parseInt(g[0],10),parseInt(g[1],10),parseInt(g[2],
10),0)}static fromMilliseconds(g){return 864E5<g||0>g?null:new n(Math.floor(g/36E5%24),Math.floor(g/6E4%60),Math.floor(g/1E3%60),Math.floor(g%1E3))}static fromDateJS(g){return new n(g.getHours(),g.getMinutes(),g.getSeconds(),g.getMilliseconds())}static fromDateTime(g){return new n(g.hour,g.minute,g.second,g.millisecond)}static fromSqlTimeStampOffset(g){return this.fromDateTime(g.toDateTime())}static fromString(g,u=null){if(""===g||null===g)return null;const f=[];if(u)(u=L(u))&&f.push(u);else if(null===
u||""===u)f.push("HH:mm:ss"),f.push("HH:mm:ss.SSS"),f.push("hh:mm:ss a"),f.push("hh:mm:ss.SSS a"),f.push("HH:mm"),f.push("hh:mm a"),f.push("H:mm"),f.push("h:mm a"),f.push("H:mm:ss"),f.push("h:mm:ss a"),f.push("H:mm:ss.SSS"),f.push("h:mm:ss.SSS a");for(const p of f)if(u=w.DateTime.fromFormat(g,p),u.isValid)return new n(u.hour,u.minute,u.second,u.millisecond);return null}plus(g,u){switch(g){case "days":case "years":case "months":return this.clone();case "hours":case "minutes":case "seconds":case "milliseconds":return n.fromDateTime(this.toUTCDateTime().plus({[g]:u}))}return null}toUTCDateTime(){return w.DateTime.utc(1970,
1,1,this.hour,this.minute,this.second,this.millisecond)}difference(g,u){switch(u.toLowerCase()){case "days":case "day":case "d":return this.toUTCDateTime().diff(g.toUTCDateTime(),"days").days;case "months":case "month":return this.toUTCDateTime().diff(g.toUTCDateTime(),"months").months;case "minutes":case "minute":case "m":return"M"===u?this.toUTCDateTime().diff(g.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(g.toUTCDateTime(),"minutes").minutes;case "seconds":case "second":case "s":return this.toUTCDateTime().diff(g.toUTCDateTime(),
"seconds").seconds;case "milliseconds":case "millisecond":case "ms":return this.toUTCDateTime().diff(g.toUTCDateTime(),"milliseconds").milliseconds;case "hours":case "hour":case "h":return this.toUTCDateTime().diff(g.toUTCDateTime(),"hours").hours;case "years":case "year":case "y":return this.toUTCDateTime().diff(g.toUTCDateTime(),"years").years;default:return this.toUTCDateTime().diff(g.toUTCDateTime(),"milliseconds").milliseconds}}}c.TimeOnly=n;c.standardiseTimeFormat=L;Object.defineProperty(c,
Symbol.toStringTag,{value:"Module"})})},"esri/arcade/kernel":function(){define(["exports","../geometry/Extent"],function(c,e){c.cloneGeometry=function(A){if(null==A)return null;const w=A.clone();void 0!==A.cache._geVersion&&(w.cache._geVersion=A.cache._geVersion);return w};c.convertLinearUnitsToCode=function(A){if(null==A)return null;if("number"===typeof A)return A;A=A.toLowerCase();A=A.replaceAll(/\s/g,"");A=A.replaceAll("-","");switch(A){case "meters":case "meter":case "m":case "squaremeters":case "squaremeter":return 9001;
case "miles":case "mile":case "squaremile":case "squaremiles":return 9093;case "kilometers":case "kilometer":case "squarekilometers":case "squarekilometer":case "km":return 9036;case "yard":case "yd":case "yards":case "squareyards":case "squareyard":return 9096;case "feet":case "ft":case "foot":case "squarefeet":case "squarefoot":return 9002;case "nmi":case "nauticalmile":case "nauticalmiles":case "squarenauticalmile":case "squarenauticalmiles":return 9030}return null};c.convertSquareUnitsToCode=
function(A){if(null==A)return null;if("number"===typeof A)return A;A=A.toLowerCase();A=A.replaceAll(/\s/g,"");A=A.replaceAll("-","");switch(A){case "meters":case "meter":case "m":case "squaremeters":case "squaremeter":return 109404;case "miles":case "mile":case "squaremile":case "squaremiles":return 109439;case "kilometers":case "kilometer":case "squarekilometers":case "squarekilometer":case "km":return 109414;case "acres":case "acre":case "ac":return 109402;case "hectares":case "hectare":case "ha":return 109401;
case "yard":case "yd":case "yards":case "squareyards":case "squareyard":return 109442;case "feet":case "ft":case "foot":case "squarefeet":case "squarefoot":return 109405;case "nmi":case "nauticalmile":case "nauticalmiles":case "squarenauticalmile":case "squarenauticalmiles":return 109409}return null};c.isInteger=function(A){return"number"===typeof A&&isFinite(A)&&Math.floor(A)===A};c.sameGeomType=function(A,w){return A===w||"point"===A&&"esriGeometryPoint"===w||"polyline"===A&&"esriGeometryPolyline"===
w||"polygon"===A&&"esriGeometryPolygon"===w||"extent"===A&&"esriGeometryEnvelope"===w||"multipoint"===A&&"esriGeometryMultipoint"===w||"point"===w&&"esriGeometryPoint"===A||"polyline"===w&&"esriGeometryPolyline"===A||"polygon"===w&&"esriGeometryPolygon"===A||"extent"===w&&"esriGeometryEnvelope"===A||"multipoint"===w&&"esriGeometryMultipoint"===A?!0:!1};c.shapeExtent=function(A){if(null==A)return null;switch(A.type){case "polygon":case "multipoint":case "polyline":return A.extent;case "point":return new e({xmin:A.x,
ymin:A.y,xmax:A.x,ymax:A.y,spatialReference:A.spatialReference});case "extent":return A}return null};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/sqlArithmeticUtils":function(){define(["exports","../../arcade/featureset/support/errorsupport","./sqlDateParsingUtils","./SqlInterval","./StandardizedFunctions"],function(c,e,A,w,L){function n(y,F,K){switch(K){case "+":return y+F;case "-":return y-F;case "*":return y*F;case "/":return y/F}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);
}function g(y,F,K){switch(K){case "+":return F.plus({milliseconds:y.valueInMilliseconds()});case "-":return y.valueInMilliseconds()-F.toMillis()}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function u(y,F,K){switch(K){case "+":return F.plus("milliseconds",y.valueInMilliseconds())}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function f(y,F,K){switch(K){case "+":return F.plus("milliseconds",y.valueInMilliseconds())}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function p(y,
F,K){switch(K){case "+":return y.plus("milliseconds",F.valueInMilliseconds());case "-":return y.plus("milliseconds",-1*F.valueInMilliseconds())}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function x(y,F,K){switch(K){case "+":return F.addMilliseconds(y.valueInMilliseconds())}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function H(y,F,K){switch(K){case "+":return w.SqlInterval.createFromMilliseconds(y.valueInMilliseconds()+F.valueInMilliseconds());case "-":return w.SqlInterval.createFromMilliseconds(y.valueInMilliseconds()-
F.valueInMilliseconds());case "*":return w.SqlInterval.createFromMilliseconds(y.valueInMilliseconds()*F.valueInMilliseconds());case "/":return w.SqlInterval.createFromMilliseconds(y.valueInMilliseconds()/F.valueInMilliseconds())}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function D(y,F,K){switch(K){case "+":return w.SqlInterval.createFromMilliseconds(y.valueInMilliseconds()+F);case "-":return w.SqlInterval.createFromMilliseconds(y.valueInMilliseconds()-F);case "*":return w.SqlInterval.createFromMilliseconds(y.valueInMilliseconds()*
F);case "/":return w.SqlInterval.createFromMilliseconds(y.valueInMilliseconds()/F)}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function v(y,F,K){switch(K){case "+":return w.SqlInterval.createFromMilliseconds(y+F.valueInMilliseconds());case "-":return w.SqlInterval.createFromMilliseconds(y-F.valueInMilliseconds());case "*":return w.SqlInterval.createFromMilliseconds(y*F.valueInMilliseconds());case "/":return w.SqlInterval.createFromMilliseconds(y/F.valueInMilliseconds())}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);
}function q(y,F,K){switch(K){case "+":return y.plus("milliseconds",F.valueInMilliseconds());case "-":return y.plus("milliseconds",-1*F.valueInMilliseconds())}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function a(y,F,K){switch(K){case "+":return y.plus({milliseconds:F.valueInMilliseconds()});case "-":return y.minus({milliseconds:F.valueInMilliseconds()})}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function r(y,F,K){switch(K){case "+":return y.addMilliseconds(F.valueInMilliseconds());
case "-":return y.addMilliseconds(-1*F.valueInMilliseconds())}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function z(y,F,K){F*=864E5;switch(K){case "+":return y.plus({milliseconds:F});case "-":return y.minus({milliseconds:F})}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function E(y,F,K){F*=864E5;switch(K){case "+":return y.plus("milliseconds",F);case "-":return y.plus("milliseconds",-1*F)}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function R(y,F,K){F*=864E5;switch(K){case "+":return y.plus("milliseconds",
F);case "-":return y.plus("milliseconds",-1*F)}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function d(y,F,K){throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function G(y,F,K){F*=864E5;switch(K){case "+":return y.addMilliseconds(F);case "-":return y.addMilliseconds(-1*F)}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function T(y,F,K){throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function J(y,F,K){throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function Q(y,
F,K){throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function P(y,F,K){F=parseFloat(F);if(isNaN(F))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);return n(y,F,K)}function V(y,F,K){y=parseFloat(y);if(isNaN(y))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);return n(y,F,K)}function l(y,F,K){switch(K){case "+":return y+F}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function N(y,F,K){throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function m(y,F,K){throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);
}function t(y,F,K){switch(K){case "-":return y.toDateTimeLuxon(F.zone).diff(F).as("days")}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function M(y,F,K){switch(K){case "-":return y.toDateTimeLuxon(F.toDateTime().zone).diff(F.toDateTime()).as("days")}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function I(y,F,K){switch(K){case "-":return y.toDateTimeLuxon("UTC").diff(F.toDateTimeLuxon("UTC")).as("days")}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function S(y,F,K){throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);
}function Z(y,F,K){throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function ca(y,F,K){switch(K){case "-":return y.toDateTime().diff(F.toDateTimeLuxon(y.toDateTime().zone)).as("days")}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function ja(y,F,K){switch(K){case "-":return y.toDateTime().diff(F).as("days")}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function na(y,F,K){switch(K){case "-":return y.toDateTime().diff(F.toDateTime()).as("days")}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);
}function ta(y,F,K){throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function ua(y,F,K){throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function sa(y,F,K){throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function va(y,F,K){throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function xa(y,F,K){switch(K){case "-":return y.diff(F).as("days")}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function Da(y,F,K){switch(K){case "-":return y.diff(F.toDateTimeLuxon(y.zone)).as("days")}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);
}function Ia(y,F,K){switch(K){case "-":return y.diff(F.toDateTime()).as("days")}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function Pa(y,F,K){throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function Na(y,F,K){throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function Sa(y,F,K){throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function Va(y,F,K){throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function h(y,F,K){throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);
}function C(y,F,K){throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function X(y,F,K){throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function aa(y,F,K){throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}function ha(y,F,K){throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}c.calculateDateOnlyAndDateOnly=I;c.calculateDateOnlyAndDateTime=t;c.calculateDateOnlyAndNumber=E;c.calculateDateOnlyAndSqlInterval=q;c.calculateDateOnlyAndString=Na;c.calculateDateOnlyAndTimeOnly=S;c.calculateDateOnlyAndTimestamp=
M;c.calculateDateTimeAndDateOnly=Da;c.calculateDateTimeAndDateTime=xa;c.calculateDateTimeAndNumber=z;c.calculateDateTimeAndSqlInterval=a;c.calculateDateTimeAndString=Va;c.calculateDateTimeAndTimeOnly=Pa;c.calculateDateTimeAndTimestamp=Ia;c.calculateNumberAndDateOnly=Q;c.calculateNumberAndDateTime=d;c.calculateNumberAndNumber=n;c.calculateNumberAndSqlInterval=v;c.calculateNumberAndString=P;c.calculateNumberAndTimeOnly=J;c.calculateNumberAndTimestamp=T;c.calculateSqlIntervalAndDateOnly=f;c.calculateSqlIntervalAndDateTime=
g;c.calculateSqlIntervalAndNumber=D;c.calculateSqlIntervalAndSqlInterval=H;c.calculateSqlIntervalAndString=N;c.calculateSqlIntervalAndTimeOnly=u;c.calculateSqlIntervalAndTimestamp=x;c.calculateStringAndDateOnly=X;c.calculateStringAndDateTime=aa;c.calculateStringAndNumber=V;c.calculateStringAndSqlInterval=m;c.calculateStringAndString=l;c.calculateStringAndTimeOnly=C;c.calculateStringAndTimestamp=ha;c.calculateTimeOnlyAndDateOnly=ua;c.calculateTimeOnlyAndDateTime=ta;c.calculateTimeOnlyAndNumber=R;c.calculateTimeOnlyAndSqlInterval=
p;c.calculateTimeOnlyAndString=Sa;c.calculateTimeOnlyAndTimeOnly=va;c.calculateTimeOnlyAndTimestamp=sa;c.calculateTimestampAndDateOnly=ca;c.calculateTimestampAndDateTime=ja;c.calculateTimestampAndNumber=G;c.calculateTimestampAndSqlInterval=r;c.calculateTimestampAndString=h;c.calculateTimestampAndTimeOnly=Z;c.calculateTimestampAndTimestamp=na;c.sqlCalculateFunction=function(y,F,K,W){if("||"===y)return L.evaluateFunction("concat",[F,K],W);if(null===F||null===K)return null;if(A.isNumber(F)){if(A.isNumber(K))return n(F,
K,y);if(A.isSqlInterval(K))return v(F,K,y);if(A.isTimeOnly(K))return J();if(A.isDateOnly(K))return Q();if(A.isTimestampOffset(K))return T();if(A.isDateTime(K))return d();if(A.isString(K))return P(F,K,y)}else if(A.isDateOnly(F)){if(A.isNumber(K))return E(F,K,y);if(A.isSqlInterval(K))return q(F,K,y);if(A.isTimeOnly(K))return S();if(A.isDateOnly(K))return I(F,K,y);if(A.isTimestampOffset(K))return M(F,K,y);if(A.isDateTime(K))return t(F,K,y);if(A.isString(K))return Na()}else if(A.isTimeOnly(F)){if(A.isNumber(K))return R(F,
K,y);if(A.isSqlInterval(K))return p(F,K,y);if(A.isTimeOnly(K))return va();if(A.isDateOnly(K))return ua();if(A.isTimestampOffset(K))return sa();if(A.isDateTime(K))return ta();if(A.isString(K))return Sa()}else if(A.isSqlInterval(F)){if(A.isNumber(K))return D(F,K,y);if(A.isSqlInterval(K))return H(F,K,y);if(A.isTimeOnly(K))return u(F,K,y);if(A.isDateOnly(K))return f(F,K,y);if(A.isTimestampOffset(K))return x(F,K,y);if(A.isDateTime(K))return g(F,K,y);if(A.isString(K))return N()}else if(A.isDateTime(F)){if(A.isNumber(K))return z(F,
K,y);if(A.isSqlInterval(K))return a(F,K,y);if(A.isTimeOnly(K))return Pa();if(A.isDateOnly(K))return Da(F,K,y);if(A.isTimestampOffset(K))return Ia(F,K,y);if(A.isDateTime(K))return xa(F,K,y);if(A.isString(K))return Va()}else if(A.isTimestampOffset(F)){if(A.isNumber(K))return G(F,K,y);if(A.isSqlInterval(K))return r(F,K,y);if(A.isTimeOnly(K))return Z();if(A.isDateOnly(K))return ca(F,K,y);if(A.isTimestampOffset(K))return na(F,K,y);if(A.isDateTime(K))return ja(F,K,y);if(A.isString(K))return h()}else if(A.isString(F)){if(A.isNumber(K))return V(F,
K,y);if(A.isSqlInterval(K))return m();if(A.isTimeOnly(K))return C();if(A.isDateOnly(K))return X();if(A.isTimestampOffset(K))return ha();if(A.isDateTime(K))return aa();if(A.isString(K))return l(F,K,y)}throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/sqlDateParsingUtils":function(){define("exports ../../arcade/featureset/support/errorsupport ./DateOnly ./SqlInterval ./SqlTimestampOffset ./TimeOnly ./UnknownTimeZone ../../chunks/datetime".split(" "),
function(c,e,A,w,L,n,g,u){function f(z,E,R){R=v.exec(z);if(null!==R){const [,d,G,T,J,Q,P,V]=R;z=u.DateTime.fromObject({year:parseInt(d,10),month:parseInt(G,10),day:parseInt(T,10),hour:parseInt(J,10),minute:parseInt(Q,10),second:parseInt(P,10),millisecond:V?parseInt(V.replace(".",""),10):0},{zone:g.substituteUnknownTimezone(E)});if(!1===z.isValid)throw new e.SqlError(e.SqlErrorCodes.InvalidTimeStamp);return z}R=q.exec(z);if(null!==R){const [,d,G,T,J,Q,P,V,l,N,m]=R;z=L.SqlTimeStampOffset.fromParts(parseInt(d,
10),parseInt(G,10),parseInt(T,10),parseInt(J,10),parseInt(Q,10),parseInt(P,10),V?parseInt(V.replace(".",""),10):0,"-"===l,parseInt(N,10),parseInt(m,10));if(!1===z.isValid)throw new e.SqlError(e.SqlErrorCodes.InvalidTimeStamp);return z}R=a.exec(z);if(null!==R){const [,d,G,T,J,Q,P,V,l]=R;z=L.SqlTimeStampOffset.fromParts(parseInt(d,10),parseInt(G,10),parseInt(T,10),parseInt(J,10),parseInt(Q,10),0,0,"-"===P,parseInt(V,10),parseInt(l,10));if(!1===z.isValid)throw new e.SqlError(e.SqlErrorCodes.InvalidTimeStamp);
return z}R=r.exec(z);if(null!==R){const [,d,G,T,J,Q]=R;z=u.DateTime.fromObject({year:parseInt(d,10),month:parseInt(G,10),day:parseInt(T,10),hour:parseInt(J,10),minute:parseInt(Q,10),second:0},{zone:g.substituteUnknownTimezone(E)});if(!1===z.isValid)throw new e.SqlError(e.SqlErrorCodes.InvalidTimeStamp);return z}R=D.exec(z);if(null!==R){const [,d,G,T]=R;z=u.DateTime.fromObject({year:parseInt(d,10),month:parseInt(G,10),day:parseInt(T,10),hour:0,minute:0,second:0},{zone:g.substituteUnknownTimezone(E)});
if(!1===z.isValid)throw new e.SqlError(e.SqlErrorCodes.InvalidTimeStamp);return z}throw new e.SqlError(e.SqlErrorCodes.InvalidTimeStamp);}const p=/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/,x=/^(\d{1,2}):(\d{1,2})$/,H=/^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/,D=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,v=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$/,q=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$/,a=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$/,
r=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/;c.convertToExecutingTimeZone=function(z,E){if(E instanceof u.Zone)return E===g.UnknownTimeZone.instance?u.DateTime.fromMillis(z.getTime(),{zone:g.UnknownTimeZone.instance}):u.DateTime.fromJSDate(z,{zone:E});switch(E){case "system":case "local":case null:return u.DateTime.fromJSDate(z);default:return"unknown"===E?.toLowerCase()?u.DateTime.fromMillis(z.getTime(),{zone:g.UnknownTimeZone.instance}):u.DateTime.fromJSDate(z,{zone:E})}};c.isDate=function(z){return z instanceof
Date};c.isDateOnly=function(z){return z instanceof A.DateOnly};c.isDateTime=function(z){return z instanceof u.DateTime};c.isNumber=function(z){return"number"===typeof z};c.isSqlInterval=function(z){return z instanceof w.SqlInterval};c.isString=function(z){return"string"===typeof z||z instanceof String};c.isTimeOnly=function(z){return z instanceof n.TimeOnly};c.isTimestampOffset=function(z){return z instanceof L.SqlTimeStampOffset};c.parseDate=function(z,E){const R=D.exec(z);if(null===R)try{return f(z,
E)}catch{throw new e.SqlError(e.SqlErrorCodes.InvalidDate);}const [,d,G,T]=R;z=A.DateOnly.fromParts(parseInt(d,10),parseInt(G,10),parseInt(T,10));if(null===z)throw new e.SqlError(e.SqlErrorCodes.InvalidDate);return z};c.parseTime=function(z){let E=p.exec(z);if(null!==E){const [,R,d,G]=E;z=n.TimeOnly.fromParts(parseInt(R,10),parseInt(d,10),parseInt(G,10),0);if(null!==z)return z;throw new e.SqlError(e.SqlErrorCodes.InvalidTime);}E=x.exec(z);if(null!==E){const [,R,d]=E;z=n.TimeOnly.fromParts(parseInt(R,
10),parseInt(d,10),0,0);if(null!==z)return z;throw new e.SqlError(e.SqlErrorCodes.InvalidTime);}E=H.exec(z);if(null!==E){const [,R,d,G,T]=E;z=n.TimeOnly.fromParts(parseInt(R,10),parseInt(d,10),parseInt(G,10),parseInt(T,10));if(null!==z)return z}throw new e.SqlError(e.SqlErrorCodes.InvalidTime);};c.parseTimestamp=f;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/SqlInterval":function(){define(["exports","../../arcade/featureset/support/errorsupport"],function(c,e){class A{constructor(){this.op=
"+";this.millis=this.minute=this.year=this.month=this.hour=this.second=this.day=0}static _fixDefaults(w){if(null!==w.precision||null!==w.secondary)throw new e.SqlError(e.SqlErrorCodes.PrimarySecondaryQualifiers);}static _parseSecondsComponent(w,L){L.includes(".")?(L=L.split("."),w.second=parseFloat(L[0]),w.millis=parseInt(L[1],10)):w.second=parseFloat(L)}static createFromMilliseconds(w){const L=new A;L.second=w/1E3;return L}static createFromValueAndQualifer(w,L,n){let g=null;const u=new A;u.op="-"===
n?"-":"+";if("interval-period"===L.type){A._fixDefaults(L);n=RegExp("^[0-9]{1,}$");if("year"===L.period||"month"===L.period)throw new e.SqlError(e.SqlErrorCodes.YearMonthIntervals);if("second"===L.period)if(/^[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/.test(w))A._parseSecondsComponent(u,w);else throw new e.SqlError(e.SqlErrorCodes.IllegalInterval);else if(n.test(w))u[L.period]=parseFloat(w);else throw new e.SqlError(e.SqlErrorCodes.IllegalInterval);}else{A._fixDefaults(L.start);A._fixDefaults(L.end);if("year"===
L.start.period||"month"===L.start.period||"year"===L.end.period||"month"===L.end.period)throw new e.SqlError(e.SqlErrorCodes.YearMonthIntervals);switch(L.start.period){case "day":switch(L.end.period){case "hour":g=RegExp("^[0-9]{1,} [0-9]{1,}$");if(g.test(w))u[L.start.period]=parseFloat(w.split(" ")[0]),u[L.end.period]=parseFloat(w.split(" ")[1]);else throw new e.SqlError(e.SqlErrorCodes.IllegalInterval);break;case "minute":g=RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$");if(g.test(w))u[L.start.period]=
parseFloat(w.split(" ")[0]),w=w.split(" ")[1].split(":"),u.hour=parseFloat(w[0]),u.minute=parseFloat(w[1]);else throw new e.SqlError(e.SqlErrorCodes.IllegalInterval);break;case "second":g=RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(g.test(w))u[L.start.period]=parseFloat(w.split(" ")[0]),w=w.split(" ")[1].split(":"),u.hour=parseFloat(w[0]),u.minute=parseFloat(w[1]),A._parseSecondsComponent(u,w[2]);else throw new e.SqlError(e.SqlErrorCodes.IllegalInterval);break;default:throw new e.SqlError(e.SqlErrorCodes.IllegalInterval);
}break;case "hour":switch(L.end.period){case "minute":g=RegExp("^[0-9]{1,}:[0-9]{1,}$");if(g.test(w))u.hour=parseFloat(w.split(":")[0]),u.minute=parseFloat(w.split(":")[1]);else throw new e.SqlError(e.SqlErrorCodes.IllegalInterval);break;case "second":g=RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(g.test(w))w=w.split(":"),u.hour=parseFloat(w[0]),u.minute=parseFloat(w[1]),A._parseSecondsComponent(u,w[2]);else throw new e.SqlError(e.SqlErrorCodes.IllegalInterval);break;default:throw new e.SqlError(e.SqlErrorCodes.IllegalInterval);
}break;case "minute":switch(L.end.period){case "second":g=RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(g.test(w))w=w.split(":"),u.minute=parseFloat(w[0]),A._parseSecondsComponent(u,w[1]);else throw new e.SqlError(e.SqlErrorCodes.IllegalInterval);break;default:throw new e.SqlError(e.SqlErrorCodes.IllegalInterval);}break;default:throw new e.SqlError(e.SqlErrorCodes.IllegalInterval);}}return u}valueInMilliseconds(){return("-"===this.op?-1:1)*(this.millis+1E3*this.second+6E4*this.minute+36E5*
this.hour+864E5*this.day+365/12*this.month*864E5+31536E6*this.year)}}c.SqlInterval=A;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/StandardizedFunctions":function(){define("exports ../../arcade/featureset/support/errorsupport ../string ./DateOnly ./sqlCompareUtils ./sqlDateParsingUtils ./TimeOnly ../../chunks/datetime".split(" "),function(c,e,A,w,L,n,g,u){function f(a){return"string"===typeof a||a instanceof String}function p(a){return n.isDate(a)||n.isDateOnly(a)||
n.isDateTime(a)||n.isTimeOnly(a)||n.isTimestampOffset(a)?!1:!0}function x(a){return n.isDateOnly(a)||n.isTimeOnly(a)?a.toString():n.isTimestampOffset(a)?a.toSQLValue():n.isDateTime(a)?0===a.millisecond?a.toFormat("yyyy-LL-dd HH:mm:ss"):a.toSQL({includeOffset:!1}):n.isDate(a)?x(u.DateTime.fromJSDate(a)):a.toString()}function H(a){if(n.isDate(a))return w.DateOnly.fromDateJS(a);if(n.isDateTime(a))return w.DateOnly.fromParts(a.year,a.month,a.day);if(n.isDateOnly(a))return a;if(n.isTimeOnly(a))throw new e.SqlError(e.SqlErrorCodes.CannotCastValue);
if(n.isTimestampOffset(a)&&null===w.DateOnly.fromParts(a.year,a.month,a.day))throw new e.SqlError(e.SqlErrorCodes.CannotCastValue);if(f(a)&&(a=w.DateOnly.fromReader(a),null!==a&&a.isValid))return a;throw new e.SqlError(e.SqlErrorCodes.CannotCastValue);}function D(a,r,z){if(n.isDate(a))return n.convertToExecutingTimeZone(a,r);if(n.isDateTime(a))return a;if(n.isDateOnly(a))return a.toDateTimeLuxon("unknown");if(n.isTimeOnly(a))throw new e.SqlError(e.SqlErrorCodes.CannotCastValue);if(n.isTimestampOffset(a))return a;
if(f(a))return n.parseTimestamp(a,"unknown",z);throw new e.SqlError(e.SqlErrorCodes.CannotCastValue);}function v(a){if(n.isDate(a))return g.TimeOnly.fromDateJS(a);if(n.isDateTime(a))return g.TimeOnly.fromDateTime(a);if(n.isDateOnly(a))throw new e.SqlError(e.SqlErrorCodes.CannotCastValue);if(n.isTimeOnly(a))return a;if(n.isTimestampOffset(a))return g.TimeOnly.fromSqlTimeStampOffset(a);if(f(a))return n.parseTime(a);throw new e.SqlError(e.SqlErrorCodes.CannotCastValue);}const q={extract:{minParams:2,
maxParams:2,evaluate:([a,r])=>{if(null==r)return null;if(n.isDate(r))switch(a.toUpperCase()){case "SECOND":return r.getSeconds();case "MINUTE":return r.getMinutes();case "HOUR":return r.getHours();case "DAY":return r.getDate();case "MONTH":return r.getMonth()+1;case "YEAR":return r.getFullYear();case "TIMEZONE_HOUR":return 0;case "TIMEZONE_MINUTE":return 0}else if(n.isDateTime(r))switch(a.toUpperCase()){case "SECOND":return r.second;case "MINUTE":return r.minute;case "HOUR":return r.hour;case "DAY":return r.day;
case "MONTH":return r.month;case "YEAR":return r.year}else if(n.isDateOnly(r))switch(a.toUpperCase()){case "DAY":return r.day;case "MONTH":return r.month;case "YEAR":return r.year}else if(n.isTimeOnly(r))switch(a.toUpperCase()){case "SECOND":return r.second;case "MINUTE":return r.minute;case "HOUR":return r.hour}else if(n.isTimestampOffset(r))switch(a.toUpperCase()){case "SECOND":return r.second;case "MINUTE":return r.minute;case "HOUR":return r.hour;case "DAY":return r.day;case "MONTH":return r.month;
case "YEAR":return r.year;case "TIMEZONE_HOUR":return r.timezoneOffsetHour;case "TIMEZONE_MINUTE":return r.timezoneOffsetMinutes}throw new e.SqlError(e.SqlErrorCodes.InvalidFunctionParameters,{function:"EXTRACT"});}},substring:{minParams:2,maxParams:3,evaluate:a=>{if(2===a.length){const [r,z]=a;return null==r||null==z?null:r.toString().substring(z-1)}if(3===a.length){const [r,z,E]=a;return null==r||null==z||null==E?null:0>=E?"":r.toString().substring(z-1,z+E-1)}}},position:{minParams:2,maxParams:2,
evaluate:([a,r])=>null==a||null==r?null:r.indexOf(a)+1},trim:{minParams:2,maxParams:3,evaluate:a=>{var r=3===a.length,z=r?a[1]:" ";r=r?a[2]:a[1];if(null==z||null==r)return null;z=`(${A.escapeRegExpString(z)})`;switch(a[0]){case "BOTH":return r.replaceAll(new RegExp(`^${z}*|${z}*$`,"g"),"");case "LEADING":return r.replaceAll(new RegExp(`^${z}*`,"g"),"");case "TRAILING":return r.replaceAll(new RegExp(`${z}*$`,"g"),"")}throw new e.SqlError(e.SqlErrorCodes.InvalidFunctionParameters,{function:"TRIM"});
}},abs:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.abs(a[0])},ceiling:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.ceil(a[0])},floor:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.floor(a[0])},log:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.log(a[0])},log10:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.log(a[0])*Math.LOG10E},sin:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.sin(a[0])},cos:{minParams:1,maxParams:1,evaluate:a=>
null==a[0]?null:Math.cos(a[0])},tan:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.tan(a[0])},asin:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.asin(a[0])},acos:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.acos(a[0])},atan:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.atan(a[0])},sign:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:0<a[0]?1:0>a[1]?-1:0},power:{minParams:2,maxParams:2,evaluate:a=>null==a[0]||null==a[1]?null:a[0]**a[1]},mod:{minParams:2,
maxParams:2,evaluate:a=>null==a[0]||null==a[1]?null:a[0]%a[1]},round:{minParams:1,maxParams:2,evaluate:a=>{const r=a[0];a=2===a.length?10**a[1]:1;return null==r?null:Math.round(r*a)/a}},truncate:{minParams:1,maxParams:2,evaluate:a=>null==a[0]?null:1===a.length?parseInt(a[0].toFixed(0),10):parseFloat(a[0].toFixed(a[1]))},char_length:{minParams:1,maxParams:1,evaluate:a=>f(a[0])?a[0].length:0},concat:{minParams:1,maxParams:Infinity,evaluate:a=>{let r="";for(let z=0;z<a.length;z++){if(null==a[z])return null;
r+=a[z].toString()}return r}},lower:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:a[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:a[0].toString().toUpperCase()},coalesce:{minParams:1,maxParams:Infinity,evaluate:a=>{for(const r of a)if(null!==r)return r;return null}},cosh:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.cosh(a[0])},sinh:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.sinh(a[0])},tanh:{minParams:1,maxParams:1,evaluate:a=>
null==a[0]?null:Math.tanh(a[0])},nullif:{minParams:2,maxParams:2,evaluate:(a,r)=>L.sqlCompare(a[0],a[1],"\x3d")?null:a[0]},cast:{minParams:2,maxParams:2,evaluate:(a,r)=>{const z=a[0];a=a[1];if(null===z)return null;switch(a.type){case "integer":if(!p(z))throw new e.SqlError(e.SqlErrorCodes.CannotCastValue);r=parseInt(z,10);if(isNaN(r))throw new e.SqlError(e.SqlErrorCodes.CannotCastValue);return r;case "smallint":if(!p(z))throw new e.SqlError(e.SqlErrorCodes.CannotCastValue);r=parseInt(z,10);if(isNaN(r))throw new e.SqlError(e.SqlErrorCodes.CannotCastValue);
if(32767<r||-32767>r)throw new e.SqlError(e.SqlErrorCodes.CannotCastValue);return r;case "float":case "real":if(!p(z))throw new e.SqlError(e.SqlErrorCodes.CannotCastValue);r=parseFloat(z);if(isNaN(r))throw new e.SqlError(e.SqlErrorCodes.CannotCastValue);return r;case "time":return v(z);case "date":return H(z);case "timestamp":return D(z,r,!0===a.withtimezone);case "varchar":r=x(z);if(r.length>a.size)throw new e.SqlError(e.SqlErrorCodes.CannotCastValue);return r;default:throw new e.SqlError(e.SqlErrorCodes.InvalidDataType);
}}}};c.evaluateFunction=function(a,r,z){const E=q[a.toLowerCase()];if(null==E)throw new e.SqlError(e.SqlErrorCodes.FunctionNotRecognized);if(r.length<E.minParams||r.length>E.maxParams)throw new e.SqlError(e.SqlErrorCodes.InvalidParameterCount,{name:a.toUpperCase()});return E.evaluate(r,z)};c.isStandardized=function(a,r){a=q[a.toLowerCase()];return null!=a&&r>=a.minParams&&r<=a.maxParams};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/sqlCompareUtils":function(){define("exports ../../arcade/featureset/support/errorsupport ./sqlDateParsingUtils ./SqlTimestampOffset ./UnknownTimeZone ../../chunks/datetime".split(" "),
function(c,e,A,w,L,n){function g(a){return A.isDateTime(a)||A.isTimestampOffset(a)?!0:!1}function u(a){return A.isDateTime(a)||A.isDateOnly(a)||A.isTimestampOffset(a)||A.isTimeOnly(a)?!0:!1}function f(a){if(A.isDateTime(a))return a.toMillis();if(A.isDateOnly(a))return a.toNumber();if(A.isTimestampOffset(a))return a.toMilliseconds();throw new e.SqlError(e.SqlErrorCodes.InvalidDataType);}function p(a,r,z){switch(z){case "\x3c\x3e":return a!==r;case "\x3d":return a===r;case "\x3e":return a>r;case "\x3c":return a<
r;case "\x3e\x3d":return a>=r;case "\x3c\x3d":return a<=r}}function x(a,r,z){const E=parseFloat(r);if(!isNaN(E))return p(a,E,z);a=a.toString();switch(z){case "\x3c\x3e":return a!==r;case "\x3d":return a===r;case "\x3e":return a>r;case "\x3c":return a<r;case "\x3e\x3d":return a>=r;case "\x3c\x3d":return a<=r}}function H(a,r,z){const E=parseFloat(a);if(!isNaN(E))return p(E,r,z);r=r.toString();switch(z){case "\x3c\x3e":return a!==r;case "\x3d":return a===r;case "\x3e":return a>r;case "\x3c":return a<
r;case "\x3e\x3d":return a>=r;case "\x3c\x3d":return a<=r}}function D(a,r,z){switch(z){case "\x3c\x3e":return a!==r;case "\x3d":return a===r;case "\x3e":return a>r;case "\x3c":return a<r;case "\x3e\x3d":return a>=r;case "\x3c\x3d":return a<=r}}function v(a,r,z){a instanceof w.SqlTimeStampOffset&&(a=a.toDateTime());r instanceof w.SqlTimeStampOffset&&(r=r.toDateTime());a=q(a);r=q(r);switch(z){case "\x3c\x3e":return a!==r;case "\x3d":return a===r;case "\x3e":return a>r;case "\x3c":return a<r;case "\x3e\x3d":return a>=
r;case "\x3c\x3d":return a<=r}}function q(a){return 321408E5*a.year+26784E5*a.month+864E5*a.day+36E5*a.hour+6E4*a.minute+1E3*a.second+a.millisecond}c.dateValueInMilliseconds=f;c.isDateOrTimeValue=u;c.isDateTimeComparableValue=g;c.sqlCompare=function(a,r,z,E){if(null==a||null==r)return null;if(A.isNumber(a)){if(A.isNumber(r))return p(a,r,z);if(A.isString(r))return x(a,r,z);if(u(r))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);if(A.isDateOnly(r))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);
}else if(A.isString(a)){if(A.isNumber(r))return H(a,r,z);if(A.isString(r))return D(a,r,z);if(A.isDateTime(r))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);if(A.isDateOnly(r))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);if(A.isTimeOnly(r))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);if(A.isTimestampOffset(r))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}else if(A.isDateTime(a)){if(g(r)){if(a instanceof n.DateTime&&L.isUnknownTimeZone(a.zone)){if(r instanceof n.DateTime&&
!1===L.isUnknownTimeZone(r.zone)||r instanceof w.SqlTimeStampOffset)return v(a,r,z)}else if(r instanceof n.DateTime&&L.isUnknownTimeZone(r.zone)&&(a instanceof n.DateTime&&!1===L.isUnknownTimeZone(a.zone)||a instanceof w.SqlTimeStampOffset))return v(a,r,z);return p(f(a),f(r),z)}if(A.isString(r))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);if(A.isDateOnly(r))return r=r.toDateTimeLuxon(a.zone),a=a.startOf("day"),p(a.toMillis(),r.toMillis(),z);if(A.isTimeOnly(r))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);
if(A.isNumber(r))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}else if(A.isDateOnly(a)){if(A.isTimestampOffset(r))return a=a.toDateTimeLuxon(r.toDateTime().zone),r=r.startOfDay(),p(a.toMillis(),r.toMilliseconds(),z);if(A.isDateTime(r))return a=a.toDateTimeLuxon(r.zone),r=r.startOf("day"),p(a.toMillis(),r.toMillis(),z);if(A.isString(r))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);if(A.isDateOnly(r))return p(a.toNumber(),r.toNumber(),z);if(A.isTimeOnly(r))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);
if(A.isNumber(r))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}else if(A.isTimeOnly(a)){if(A.isTimeOnly(r))return p(a.toNumber(),r.toNumber(),z);if(A.isString(r))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);if(A.isNumber(r))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);if(A.isDateOnly(r))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);if(g(r))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}else if(A.isTimestampOffset(a)){if(g(r))return r instanceof n.DateTime&&
L.isUnknownTimeZone(r.zone)?v(a,r,z):p(f(a),f(r),z);if(A.isString(r))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);if(A.isDateOnly(r))return r=r.toDateTimeLuxon(a.toDateTime().zone),a=a.startOfDay(),p(a.toMilliseconds(),r.toMillis(),z);if(A.isTimeOnly(r))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);if(A.isNumber(r))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);}switch(z){case "\x3c\x3e":return a!==r;case "\x3d":return a===r;case "\x3e":return a>r;case "\x3c":return a<r;case "\x3e\x3d":return a>=
r;case "\x3c\x3d":return a<=r}};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/WhereGrammar":function(){define(["exports","../../chunks/_commonjsHelpers"],function(c,e){var A={exports:{}};A.exports;(function(n){(function(g,u){n.exports&&(n.exports=u())})(e.commonjsGlobal,function(){function g(f,p,x,H){f=Error.call(this,f);Object.setPrototypeOf&&Object.setPrototypeOf(f,g.prototype);f.expected=p;f.found=x;f.location=H;f.name="SyntaxError";return f}function u(f,p,x){x=
x||" ";if(f.length>p)return f;p-=f.length;x+=x.repeat(p);return f+x.slice(0,p)}(function(f,p){function x(){this.constructor=f}x.prototype=p.prototype;f.prototype=new x})(g,Error);g.prototype.format=function(f){var p="Error: "+this.message;if(this.location){var x=null,H;for(H=0;H<f.length;H++)if(f[H].source===this.location.source){x=f[H].text.split(/\r\n|\n|\r/g);break}f=this.location.start;H=this.location.source&&"function"===typeof this.location.source.offset?this.location.source.offset(f):f;var D=
this.location.source+":"+H.line+":"+H.column;if(x){var v=this.location.end,q=u("",H.line.toString().length," ");x=x[f.line-1];v=(f.line===v.line?v.column:x.length+1)-f.column||1;p+="\n --\x3e "+D+"\n"+q+" |\n"+H.line+" | "+x+"\n"+q+" | "+u("",f.column-1," ")+u("",v,"^")}else p+="\n at "+D}return p};g.buildMessage=function(f,p){function x(a){return a.charCodeAt(0).toString(16).toUpperCase()}function H(a){return a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,
"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(r){return"\\x0"+x(r)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(r){return"\\x"+x(r)})}function D(a){return a.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(r){return"\\x0"+x(r)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(r){return"\\x"+x(r)})}function v(a){return q[a.type](a)}var q={literal:function(a){return'"'+
H(a.text)+'"'},class:function(a){var r=a.parts.map(function(z){return Array.isArray(z)?D(z[0])+"-"+D(z[1]):D(z)});return"["+(a.inverted?"^":"")+r.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(a){return a.description}};return"Expected "+function(a){a=a.map(v);var r,z;a.sort();if(0<a.length){for(z=r=1;r<a.length;r++)a[r-1]!==a[r]&&(a[z]=a[r],z++);a.length=z}switch(a.length){case 1:return a[0];case 2:return a[0]+" or "+a[1];default:return a.slice(0,
-1).join(", ")+", or "+a[a.length-1]}}(f)+" but "+(p?'"'+H(p)+'"':"end of input")+" found."};return{SyntaxError:g,parse:function(f,p){function x(B,O){O=void 0!==O?O:q(ma,k);throw new g(B,null,null,O);}function H(B,O){return{type:"literal",text:B,ignoreCase:O}}function D(B,O,U){return{type:"class",parts:B,inverted:O,ignoreCase:U}}function v(B){var O=Zb[B],U;if(!O){for(U=B-1;!Zb[U];)U--;O=Zb[U];for(O={line:O.line,column:O.column};U<B;)10===f.charCodeAt(U)?(O.line++,O.column=1):O.column++,U++;Zb[B]=
O}return O}function q(B,O,U){var da=v(B),pa=v(O);B={source:Mb,start:{offset:B,line:da.line,column:da.column},end:{offset:O,line:pa.line,column:pa.column}};U&&Mb&&"function"===typeof Mb.offset&&(B.start=Mb.offset(B.start),B.end=Mb.offset(B.end));return B}function a(B){k<eb||(k>eb&&(eb=k,zc=[]),zc.push(B))}function r(){var B=k;ka();var O=E();O!==b?(ka(),ma=B,B=O):(k=B,B=b);return B}function z(){var B=k;var O=E();if(O!==b){var U=[];var da=k;var pa=ka();var za=Wa();if(za!==b){var Ea=ka();var Fa=E();Fa!==
b?da=pa=[pa,za,Ea,Fa]:(k=da,da=b)}else k=da,da=b;for(;da!==b;)U.push(da),da=k,pa=ka(),za=Wa(),za!==b?(Ea=ka(),Fa=E(),Fa!==b?da=pa=[pa,za,Ea,Fa]:(k=da,da=b)):(k=da,da=b);ma=B;B={type:"expression-list"};O=[O];for(da=0;da<U.length;da++)O.push(U[da][3]);B.value=O}else k=B,B=b;return B}function E(){var B=k;var O=R();if(O!==b){var U=[];var da=k;var pa=ka();var za=K();if(za!==b){var Ea=ka();var Fa=R();Fa!==b?da=pa=[pa,za,Ea,Fa]:(k=da,da=b)}else k=da,da=b;for(;da!==b;)U.push(da),da=k,pa=ka(),za=K(),za!==
b?(Ea=ka(),Fa=R(),Fa!==b?da=pa=[pa,za,Ea,Fa]:(k=da,da=b)):(k=da,da=b);ma=B;B=nb(O,U)}else k=B,B=b;return B}function R(){var B=k;var O=d();if(O!==b){var U=[];var da=k;var pa=ka();var za=F();if(za!==b){var Ea=ka();var Fa=d();Fa!==b?da=pa=[pa,za,Ea,Fa]:(k=da,da=b)}else k=da,da=b;for(;da!==b;)U.push(da),da=k,pa=ka(),za=F(),za!==b?(Ea=ka(),Fa=d(),Fa!==b?da=pa=[pa,za,Ea,Fa]:(k=da,da=b)):(k=da,da=b);ma=B;B=nb(O,U)}else k=B,B=b;return B}function d(){var B=k;var O=y();if(O===b){O=k;if(33===f.charCodeAt(k)){var U=
Nd;k++}else U=b,0===fa&&a(Od);if(U!==b){var da=k;fa++;if(61===f.charCodeAt(k)){var pa=Sc;k++}else pa=b,0===fa&&a(Tc);fa--;pa===b?da=void 0:(k=da,da=b);da!==b?O=U=[U,da]:(k=O,O=b)}else k=O,O=b}O!==b?(U=ka(),da=d(),da!==b?(ma=B,B={type:"unary-expression",operator:"NOT",expr:da}):(k=B,B=b)):(k=B,B=b);if(B===b){O=k;B=Q();if(B!==b){ka();U=k;da=[];pa=k;var za=ka();var Ea=G();if(Ea!==b){var Fa=ka();var ob=Q();ob!==b?pa=za=[za,Ea,Fa,ob]:(k=pa,pa=b)}else k=pa,pa=b;if(pa!==b)for(;pa!==b;)da.push(pa),pa=k,za=
ka(),Ea=G(),Ea!==b?(Fa=ka(),ob=Q(),ob!==b?pa=za=[za,Ea,Fa,ob]:(k=pa,pa=b)):(k=pa,pa=b);else da=b;da!==b&&(ma=U,da={type:"arithmetic",tail:da});U=da;U===b&&(U=k,da=J(),da!==b?(ka(),pa=Ja(),pa!==b?(ka(),pa=z(),pa!==b?(ka(),za=Ka(),za!==b?(ma=U,U={op:da,right:pa}):(k=U,U=b)):(k=U,U=b)):(k=U,U=b)):(k=U,U=b),U===b&&(U=k,da=J(),da!==b?(ka(),pa=Ja(),pa!==b?(ka(),pa=Ka(),pa!==b?(ma=U,U={op:da,right:{type:"expression-list",value:[]}}):(k=U,U=b)):(k=U,U=b)):(k=U,U=b),U===b&&(U=k,da=J(),da!==b?(ka(),pa=ca(),
pa!==b?(ma=U,U={op:da,right:pa}):(k=U,U=b)):(k=U,U=b))),U===b&&(U=k,za=y(),za!==b?(ka(),da=W(),da!==b?(ka(),pa=Q(),pa!==b?(ka(),Ea=F(),Ea!==b?(ka(),za=Q(),za!==b?(ma=U,U={op:"NOT"+da,right:{type:"expression-list",value:[pa,za]}}):(k=U,U=b)):(k=U,U=b)):(k=U,U=b)):(k=U,U=b)):(k=U,U=b),U===b&&(U=k,za=W(),za!==b?(ka(),da=Q(),da!==b?(ka(),pa=F(),pa!==b?(ka(),Ea=Q(),Ea!==b?(ma=U,U={op:za,right:{type:"expression-list",value:[da,Ea]}}):(k=U,U=b)):(k=U,U=b)):(k=U,U=b)):(k=U,U=b)),U===b&&(U=k,da=aa(),da!==
b?(ka(),pa=y(),pa!==b?(ka(),pa=Q(),pa!==b?(ma=U,U={op:da+"NOT",right:pa}):(k=U,U=b)):(k=U,U=b)):(k=U,U=b),U===b&&(U=k,da=aa(),da!==b?(ka(),pa=Q(),pa!==b?(ma=U,U={op:da,right:pa}):(k=U,U=b)):(k=U,U=b)),U===b&&(U=k,da=T(),da!==b?(ka(),pa=va(),pa!==b?(ka(),za=k,f.substr(k,6).toLowerCase()===Pd?(Ea=f.substr(k,6),k+=6):(Ea=b,0===fa&&a(Qd)),Ea!==b?(Ea=k,fa++,Fa=M(),fa--,Fa===b?Ea=void 0:(k=Ea,Ea=b),Ea!==b?(ma=za,za="ESCAPE"):(k=za,za=b)):(k=za,za=b),za!==b?(ka(),za=xa(),za!==b?(ma=U,U={op:da,right:pa,escape:za.value}):
(k=U,U=b)):(k=U,U=b)):(k=U,U=b)):(k=U,U=b),U===b&&(U=k,da=T(),da!==b?(ka(),pa=va(),pa!==b?(ma=U,U={op:da,right:pa,escape:""}):(k=U,U=b)):(k=U,U=b))))));U===b&&(U=null);ma=O;O=U;""==O||void 0==O||null==O?O=B:(U=null,O=U="arithmetic"==O.type?nb(B,O.tail):Nb(O.op,B,O.right,O.escape))}else k=O,O=b;B=O}return B}function G(){if(f.substr(k,2)===Uc){var B=Uc;k+=2}else B=b,0===fa&&a(Rd);B===b&&(62===f.charCodeAt(k)?(B=Sd,k++):(B=b,0===fa&&a(Td)),B===b&&(f.substr(k,2)===Vc?(B=Vc,k+=2):(B=b,0===fa&&a(Ud)),B===
b&&(f.substr(k,2)===Wc?(B=Wc,k+=2):(B=b,0===fa&&a(Vd)),B===b&&(60===f.charCodeAt(k)?(B=Wd,k++):(B=b,0===fa&&a(Xd)),B===b&&(61===f.charCodeAt(k)?(B=Sc,k++):(B=b,0===fa&&a(Tc)),B===b&&(f.substr(k,2)===Xc?(B=Xc,k+=2):(B=b,0===fa&&a(Yd))))))));return B}function T(){var B;var O=B=k;var U=y();if(U!==b){var da=ka();var pa=ha();pa!==b?O=U=[U,da,pa]:(k=O,O=b)}else k=O,O=b;O!==b&&(ma=B,O=O[0]+" "+O[2]);B=O;B===b&&(B=ha());return B}function J(){var B;var O=B=k;var U=y();if(U!==b){var da=ka();var pa=X();pa!==
b?O=U=[U,da,pa]:(k=O,O=b)}else k=O,O=b;O!==b&&(ma=B,O=O[0]+" "+O[2]);B=O;B===b&&(B=X());return B}function Q(){var B=k;var O=V();if(O!==b){var U=[];var da=k;var pa=ka();var za=P();if(za!==b){var Ea=ka();var Fa=V();Fa!==b?da=pa=[pa,za,Ea,Fa]:(k=da,da=b)}else k=da,da=b;for(;da!==b;)U.push(da),da=k,pa=ka(),za=P(),za!==b?(Ea=ka(),Fa=V(),Fa!==b?da=pa=[pa,za,Ea,Fa]:(k=da,da=b)):(k=da,da=b);ma=B;B=nb(O,U)}else k=B,B=b;return B}function P(){if(43===f.charCodeAt(k)){var B=Ac;k++}else B=b,0===fa&&a(Bc);B===
b&&(45===f.charCodeAt(k)?(B=Cc,k++):(B=b,0===fa&&a(Dc)),B===b&&(f.substr(k,2)===Yc?(B=Yc,k+=2):(B=b,0===fa&&a(Zd))));return B}function V(){var B=k;var O=N();if(O!==b){var U=[];var da=k;var pa=ka();var za=l();if(za!==b){var Ea=ka();var Fa=N();Fa!==b?da=pa=[pa,za,Ea,Fa]:(k=da,da=b)}else k=da,da=b;for(;da!==b;)U.push(da),da=k,pa=ka(),za=l(),za!==b?(Ea=ka(),Fa=N(),Fa!==b?da=pa=[pa,za,Ea,Fa]:(k=da,da=b)):(k=da,da=b);ma=B;B=nb(O,U)}else k=B,B=b;return B}function l(){if(42===f.charCodeAt(k)){var B=$d;k++}else B=
b,0===fa&&a(ae);B===b&&(47===f.charCodeAt(k)?(B=be,k++):(B=b,0===fa&&a(ce)));return B}function N(){var B=xa();if(B===b){var O=k;var U=k;var da=Na();if(da!==b){var pa=Sa();if(pa!==b){var za=Va();za!==b?(ma=U,U=parseFloat(da+pa+za)):(k=U,U=b)}else k=U,U=b}else k=U,U=b;U===b&&(U=k,da=Na(),da!==b?(pa=Sa(),pa!==b?(ma=U,U=parseFloat(da+pa)):(k=U,U=b)):(k=U,U=b),U===b&&(U=k,da=Na(),da!==b?(pa=Va(),pa!==b?(ma=U,U=parseFloat(da+pa)):(k=U,U=b)):(k=U,U=b),U===b&&(U=k,da=Na(),da!==b&&(ma=U,da=parseFloat(da)),
U=da)));var Ea=U;if(Ea!==b){var Fa=k;fa++;var ob=t();fa--;ob===b?Fa=void 0:(k=Fa,Fa=b);Fa!==b?(ma=O,O={type:"number",value:Ea}):(k=O,O=b)}else k=O,O=b;B=O;if(B===b){var pb=k;var Jb=k;if(f.substr(k,4).toLowerCase()===de){var $b=f.substr(k,4);k+=4}else $b=b,0===fa&&a(ee);if($b!==b){var Ob=k;fa++;var fe=M();fa--;fe===b?Ob=void 0:(k=Ob,Ob=b);Ob!==b?Jb=$b=[$b,Ob]:(k=Jb,Jb=b)}else k=Jb,Jb=b;var qb=Jb;qb!==b&&(ma=pb,qb={type:"boolean",value:!0});pb=qb;if(pb===b){pb=k;var Kb=k;if(f.substr(k,5).toLowerCase()===
ge){var ac=f.substr(k,5);k+=5}else ac=b,0===fa&&a(he);if(ac!==b){var Pb=k;fa++;var ie=M();fa--;ie===b?Pb=void 0:(k=Pb,Pb=b);Pb!==b?Kb=ac=[ac,Pb]:(k=Kb,Kb=b)}else k=Kb,Kb=b;qb=Kb;qb!==b&&(ma=pb,qb={type:"boolean",value:!1});pb=qb}B=pb;if(B===b){var je=k;var Lb=k;if(f.substr(k,4).toLowerCase()===ke){var bc=f.substr(k,4);k+=4}else bc=b,0===fa&&a(le);if(bc!==b){var Qb=k;fa++;var me=M();fa--;me===b?Qb=void 0:(k=Qb,Qb=b);Qb!==b?Lb=bc=[bc,Qb]:(k=Lb,Lb=b)}else k=Lb,Lb=b;var Ec=Lb;Ec!==b&&(ma=je,Ec={type:"null",
value:null});B=Ec;if(B===b){var rb=k;if(ia()!==b){ka();var cc=va();cc!==b?(ma=rb,"string"===cc.type&&!0!==/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(cc.value)&&x("Date literal is invalid"),rb={type:"date",
value:cc.value}):(k=rb,rb=b)}else k=rb,rb=b;B=rb;if(B===b){var sb=k;if(ea()!==b){ka();var dc=va();dc!==b?(ma=sb,"string"===dc.type&&!0!==/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(dc.value)&&x("Timestamp literal is invalid"),
sb={type:"timestamp",value:dc.value}):(k=sb,sb=b)}else k=sb,sb=b;B=sb;if(B===b){var Ta=k;var Fc=ra();if(Fc!==b){ka();if(45===f.charCodeAt(k)){var hb=Cc;k++}else hb=b,0===fa&&a(Dc);hb===b&&(43===f.charCodeAt(k)?(hb=Ac,k++):(hb=b,0===fa&&a(Bc)));if(hb!==b){ka();var Rb=va();if(Rb!==b){ka();var Zc=na();Zc!==b?(ma=Ta,Ta={type:"interval",value:Rb,qualifier:Zc,op:hb}):(k=Ta,Ta=b)}else k=Ta,Ta=b}else k=Ta,Ta=b}else k=Ta,Ta=b;Ta===b&&(Ta=k,Fc=ra(),Fc!==b?(ka(),hb=va(),hb!==b?(ka(),Rb=na(),Rb!==b?(ma=Ta,Ta=
{type:"interval",value:hb,qualifier:Rb,op:""}):(k=Ta,Ta=b)):(k=Ta,Ta=b)):(k=Ta,Ta=b));B=Ta;if(B===b){var tb=k;if(la()!==b){ka();var ec=va();ec!==b?(ma=tb,"string"===ec.type&&!0!==/^(\d{1,2}):(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/.test(ec.value)&&x("Time literal is invalid"),tb={type:"time",value:ec.value}):(k=tb,tb=b)}else k=tb,tb=b;B=tb}}}}}}}var La=B;if(La===b){var Za=k;var ub=k;if(f.substr(k,7).toLowerCase()===ne){var $c=f.substr(k,7);k+=7}else $c=
b,0===fa&&a(oe);if($c!==b){var fc=k;fa++;var pe=M();fa--;pe===b?fc=void 0:(k=fc,fc=b);fc!==b?(ma=ub,ub="EXTRACT"):(k=ub,ub=b)}else k=ub,ub=b;if(ub!==b){ka();var qe=Ja();if(qe!==b){ka();var $a=oa();if($a===b&&($a=qa(),$a===b&&($a=Ca(),$a===b&&($a=wa(),$a===b&&($a=Ba(),$a===b&&($a=Aa(),$a===b)))))){var vb=k;if(f.substr(k,13).toLowerCase()===re){var ad=f.substr(k,13);k+=13}else ad=b,0===fa&&a(se);if(ad!==b){var gc=k;fa++;var te=M();fa--;te===b?gc=void 0:(k=gc,gc=b);gc!==b?(ma=vb,vb="TIMEZONE_HOUR"):
(k=vb,vb=b)}else k=vb,vb=b;$a=vb;if($a===b){var wb=k;if(f.substr(k,15).toLowerCase()===ue){var bd=f.substr(k,15);k+=15}else bd=b,0===fa&&a(ve);if(bd!==b){var hc=k;fa++;var we=M();fa--;we===b?hc=void 0:(k=hc,hc=b);hc!==b?(ma=wb,wb="TIMEZONE_MINUTE"):(k=wb,wb=b)}else k=wb,wb=b;$a=wb}}var cd=$a;if(cd!==b){ka();var xe=Y();if(xe!==b){ka();var dd=E();if(dd!==b){ka();var ye=Ka();ye!==b?(ma=Za,Za={type:"function",name:"extract",args:{type:"expression-list",value:[{type:"string",value:cd},dd]}}):(k=Za,Za=
b)}else k=Za,Za=b}else k=Za,Za=b}else k=Za,Za=b}else k=Za,Za=b}else k=Za,Za=b;La=Za;if(La===b){var ab=k;var xb=k;if(f.substr(k,9).toLowerCase()===ze){var ed=f.substr(k,9);k+=9}else ed=b,0===fa&&a(Ae);if(ed!==b){var ic=k;fa++;var Be=M();fa--;Be===b?ic=void 0:(k=ic,ic=b);ic!==b?(ma=xb,xb="SUBSTRING"):(k=xb,xb=b)}else k=xb,xb=b;if(xb!==b){ka();var Ce=Ja();if(Ce!==b){ka();var Gc=E();if(Gc!==b){ka();var De=Y();if(De!==b){ka();var Hc=E();if(Hc!==b){ka();var ib=k;var yb=k;if(f.substr(k,3).toLowerCase()===
Ee){var fd=f.substr(k,3);k+=3}else fd=b,0===fa&&a(Fe);if(fd!==b){var jc=k;fa++;var Ge=M();fa--;Ge===b?jc=void 0:(k=jc,jc=b);jc!==b?(ma=yb,yb="FOR"):(k=yb,yb=b)}else k=yb,yb=b;var Sb=yb;if(Sb!==b){var He=ka();var gd=E();if(gd!==b){var Ie=ka();ib=Sb=[Sb,He,gd,Ie]}else k=ib,ib=b}else k=ib,ib=b;ib===b&&(ib=null);Sb=Ka();Sb!==b?(ma=ab,ab={type:"function",name:"substring",args:{type:"expression-list",value:ib?[Gc,Hc,ib[2]]:[Gc,Hc]}}):(k=ab,ab=b)}else k=ab,ab=b}else k=ab,ab=b}else k=ab,ab=b}else k=ab,ab=
b}else k=ab,ab=b;La=ab;if(La===b){var Oa=k;var Ic=ba();if(Ic!==b){ka();var Jc=Ja();if(Jc!==b){ka();var jb=ja();jb===b&&(jb=null);ka();var Tb=E();if(Tb!==b){ka();var Kc=Y();if(Kc!==b){ka();var hd=E();if(hd!==b){ka();var Je=Ka();Je!==b?(ma=Oa,Oa={type:"function",name:"trim",args:{type:"expression-list",value:[{type:"string",value:null==jb?"BOTH":jb},Tb,hd]}}):(k=Oa,Oa=b)}else k=Oa,Oa=b}else k=Oa,Oa=b}else k=Oa,Oa=b}else k=Oa,Oa=b}else k=Oa,Oa=b;Oa===b&&(Oa=k,Ic=ba(),Ic!==b?(ka(),Jc=Ja(),Jc!==b?(ka(),
jb=ja(),jb===b&&(jb=null),ka(),Tb=E(),Tb!==b?(ka(),Kc=Ka(),Kc!==b?(ma=Oa,Oa={type:"function",name:"trim",args:{type:"expression-list",value:[{type:"string",value:null==jb?"BOTH":jb},Tb]}}):(k=Oa,Oa=b)):(k=Oa,Oa=b)):(k=Oa,Oa=b)):(k=Oa,Oa=b));La=Oa;if(La===b){var bb=k;var zb=k;if(f.substr(k,8).toLowerCase()===Ke){var id=f.substr(k,8);k+=8}else id=b,0===fa&&a(Le);if(id!==b){var kc=k;fa++;var Me=M();fa--;Me===b?kc=void 0:(k=kc,kc=b);kc!==b?(ma=zb,zb="POSITION"):(k=zb,zb=b)}else k=zb,zb=b;if(zb!==b){ka();
var Ne=Ja();if(Ne!==b){ka();var jd=E();if(jd!==b){ka();var Oe=X();if(Oe!==b){ka();var kd=E();if(kd!==b){ka();var Pe=Ka();Pe!==b?(ma=bb,bb={type:"function",name:"position",args:{type:"expression-list",value:[jd,kd]}}):(k=bb,bb=b)}else k=bb,bb=b}else k=bb,bb=b}else k=bb,bb=b}else k=bb,bb=b}else k=bb,bb=b;La=bb;if(La===b){var cb=k;var Ab=k;if(f.substr(k,4).toLowerCase()===Qe){var ld=f.substr(k,4);k+=4}else ld=b,0===fa&&a(Re);if(ld!==b){var lc=k;fa++;var Se=M();fa--;Se===b?lc=void 0:(k=lc,lc=b);lc!==
b?(ma=Ab,Ab="CAST"):(k=Ab,Ab=b)}else k=Ab,Ab=b;if(Ab!==b){ka();var Te=Ja();if(Te!==b){ka();var md=E();if(md!==b){ka();var Bb=k;if(f.substr(k,2).toLowerCase()===Ue){var nd=f.substr(k,2);k+=2}else nd=b,0===fa&&a(Ve);if(nd!==b){var mc=k;fa++;var We=M();fa--;We===b?mc=void 0:(k=mc,mc=b);mc!==b?(ma=Bb,Bb="AS"):(k=Bb,Bb=b)}else k=Bb,Bb=b;var Xe=Bb;if(Xe!==b){ka();var Ga=k;var Cb=k;if(f.substr(k,7).toLowerCase()===Ye){var od=f.substr(k,7);k+=7}else od=b,0===fa&&a(Ze);if(od!==b){var nc=k;fa++;var $e=M();
fa--;$e===b?nc=void 0:(k=nc,nc=b);nc!==b?(ma=Cb,Cb="INTEGER"):(k=Cb,Cb=b)}else k=Cb,Cb=b;var Ma=Cb;Ma!==b&&(ma=Ga,Ma={type:"data-type",value:{type:"integer"}});Ga=Ma;if(Ga===b){Ga=k;var Db=k;if(f.substr(k,8).toLowerCase()===af){var pd=f.substr(k,8);k+=8}else pd=b,0===fa&&a(bf);if(pd!==b){var oc=k;fa++;var cf=M();fa--;cf===b?oc=void 0:(k=oc,oc=b);oc!==b?(ma=Db,Db="SMALLINT"):(k=Db,Db=b)}else k=Db,Db=b;Ma=Db;Ma!==b&&(ma=Ga,Ma={type:"data-type",value:{type:"smallint"}});Ga=Ma;if(Ga===b){Ga=k;var Eb=
k;if(f.substr(k,5).toLowerCase()===df){var qd=f.substr(k,5);k+=5}else qd=b,0===fa&&a(ef);if(qd!==b){var pc=k;fa++;var ff=M();fa--;ff===b?pc=void 0:(k=pc,pc=b);pc!==b?(ma=Eb,Eb="FLOAT"):(k=Eb,Eb=b)}else k=Eb,Eb=b;Ma=Eb;Ma!==b&&(ma=Ga,Ma={type:"data-type",value:{type:"float"}});Ga=Ma;if(Ga===b){Ga=k;var Fb=k;if(f.substr(k,4).toLowerCase()===gf){var rd=f.substr(k,4);k+=4}else rd=b,0===fa&&a(hf);if(rd!==b){var qc=k;fa++;var jf=M();fa--;jf===b?qc=void 0:(k=qc,qc=b);qc!==b?(ma=Fb,Fb="REAL"):(k=Fb,Fb=b)}else k=
Fb,Fb=b;Ma=Fb;Ma!==b&&(ma=Ga,Ma={type:"data-type",value:{type:"real"}});Ga=Ma;if(Ga===b&&(Ga=k,Ma=ia(),Ma!==b&&(ma=Ga,Ma={type:"data-type",value:{type:"date"}}),Ga=Ma,Ga===b&&(Ga=k,Ma=ea(),Ma!==b&&(ma=Ga,Ma={type:"data-type",value:{type:"timestamp"}}),Ga=Ma,Ga===b&&(Ga=k,Ma=la(),Ma!==b&&(ma=Ga,Ma={type:"data-type",value:{type:"time"}}),Ga=Ma,Ga===b)))){Ga=k;var Gb=k;if(f.substr(k,7).toLowerCase()===kf){var sd=f.substr(k,7);k+=7}else sd=b,0===fa&&a(lf);if(sd!==b){var rc=k;fa++;var mf=M();fa--;mf===
b?rc=void 0:(k=rc,rc=b);rc!==b?(ma=Gb,Gb="VARCHAR"):(k=Gb,Gb=b)}else k=Gb,Gb=b;Ma=Gb;if(Ma!==b){ka();var nf=Ja();if(nf!==b){ka();var td=h();if(td!==b){ka();var of=Ka();of!==b?(ma=Ga,Ga={type:"data-type",value:{type:"varchar",size:parseInt(td)}}):(k=Ga,Ga=b)}else k=Ga,Ga=b}else k=Ga,Ga=b}else k=Ga,Ga=b}}}}var ud=Ga;if(ud!==b){ka();var pf=Ka();pf!==b?(ma=cb,cb={type:"function",name:"cast",args:{type:"expression-list",value:[md,ud]}}):(k=cb,cb=b)}else k=cb,cb=b}else k=cb,cb=b}else k=cb,cb=b}else k=cb,
cb=b}else k=cb,cb=b;La=cb;if(La===b){var kb=k;var db=k;var Ub=m();Ub!==b&&(ma=db);db=Ub;if(db===b)if(db=k,96===f.charCodeAt(k)?(Ub=vd,k++):(Ub=b,0===fa&&a(wd)),Ub!==b){var sc=[];if(xd.test(f.charAt(k))){var lb=f.charAt(k);k++}else lb=b,0===fa&&a(yd);if(lb!==b)for(;lb!==b;)sc.push(lb),xd.test(f.charAt(k))?(lb=f.charAt(k),k++):(lb=b,0===fa&&a(yd));else sc=b;sc!==b?(96===f.charCodeAt(k)?(lb=vd,k++):(lb=b,0===fa&&a(wd)),lb!==b?(ma=db,db=sc.join("")):(k=db,db=b)):(k=db,db=b)}else k=db,db=b;var zd=db;if(zd!==
b){ka();var qf=Ja();if(qf!==b){ka();var tc=z();tc===b&&(tc=null);ka();var rf=Ka();rf!==b?(ma=kb,kb={type:"function",name:zd,args:tc?tc:{type:"expression-list",value:[]}}):(k=kb,kb=b)}else k=kb,kb=b}else k=kb,kb=b;La=kb;if(La===b){var fb;var Ua=k;var Lc=ya();if(Lc!==b){ka();var Vb=E();if(Vb!==b){ka();var Wb=[];for(fb=Ia();fb!==b;)Wb.push(fb),fb=Ia();fb=ka();var uc=Ha();uc!==b?(ma=Ua,Ua={type:"case-expression",format:"simple",operand:Vb,clauses:Wb,else:null}):(k=Ua,Ua=b)}else k=Ua,Ua=b}else k=Ua,Ua=
b;if(Ua===b)if(Ua=k,Lc=ya(),Lc!==b)if(ka(),Vb=E(),Vb!==b){ka();Wb=[];for(fb=Ia();fb!==b;)Wb.push(fb),fb=Ia();fb=ka();uc=Pa();if(uc!==b){ka();var sf=Ha();sf!==b?(ma=Ua,Ua={type:"case-expression",format:"simple",operand:Vb,clauses:Wb,else:uc.value}):(k=Ua,Ua=b)}else k=Ua,Ua=b}else k=Ua,Ua=b;else k=Ua,Ua=b;var Mc=Ua;if(Mc===b){var gb;var Xa=k;var Nc=ya();if(Nc!==b){ka();var Xb=[];for(gb=Da();gb!==b;)Xb.push(gb),gb=Da();gb=ka();var vc=Ha();vc!==b?(ma=Xa,Xa={type:"case-expression",format:"searched",clauses:Xb,
else:null}):(k=Xa,Xa=b)}else k=Xa,Xa=b;if(Xa===b)if(Xa=k,Nc=ya(),Nc!==b){ka();Xb=[];for(gb=Da();gb!==b;)Xb.push(gb),gb=Da();gb=ka();vc=Pa();if(vc!==b){ka();var tf=Ha();tf!==b?(ma=Xa,Xa={type:"case-expression",format:"searched",clauses:Xb,else:vc.value}):(k=Xa,Xa=b)}else k=Xa,Xa=b}else k=Xa,Xa=b;Mc=Xa}La=Mc;if(La===b){var Hb=k;var uf=k;var wc;var Yb=k;var Ad=t();if(Ad!==b){var Bd=[];for(wc=I();wc!==b;)Bd.push(wc),wc=I();ma=Yb;Yb=Ad+Bd.join("")}else k=Yb,Yb=b;var Cd=Yb;Cd!==b&&(ma=uf);var mb=Cd;if(mb!==
b){ma=Hb;var Oc=mb;mb=/^CURRENT_DATE$/i.test(Oc)?{type:"current-time",mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(Oc)?{type:"current-time",mode:"timestamp"}:{type:"column-reference",table:"",column:Oc}}Hb=mb;if(Hb===b){Hb=k;var Ib=k;if(Z()!==b){var xc;var vf=k;var Pc=[];for(xc=S();xc!==b;)Pc.push(xc),xc=S();ma=vf;var wf=Pc=Pc.join("");var xf=Z();xf!==b?(ma=Ib,Ib=wf):(k=Ib,Ib=b)}else k=Ib,Ib=b;mb=Ib;mb!==b&&(ma=Hb,mb={type:"column-reference",table:"",column:mb,delimited:!0});Hb=mb}La=Hb;if(La===b&&(La=
ca(),La===b)){La=k;var yf=Ja();if(yf!==b){ka();var Qc=E();if(Qc!==b){ka();var zf=Ka();zf!==b?(ma=La,Qc.paren=!0,La=Qc):(k=La,La=b)}else k=La,La=b}else k=La,La=b}}}}}}}}}return La}function m(){var B;var O=k;var U=t();if(U!==b){var da=[];for(B=M();B!==b;)da.push(B),B=M();ma=O;O=U+da.join("")}else k=O,O=b;return O}function t(){if(Af.test(f.charAt(k))){var B=f.charAt(k);k++}else B=b,0===fa&&a(Bf);return B}function M(){if(Cf.test(f.charAt(k))){var B=f.charAt(k);k++}else B=b,0===fa&&a(Df);return B}function I(){if(Dd.test(f.charAt(k))){var B=
f.charAt(k);k++}else B=b,0===fa&&a(Ed);return B}function S(){if(Dd.test(f.charAt(k))){var B=f.charAt(k);k++}else B=b,0===fa&&a(Ed);if(B===b)if(B=k,Z()!==b){var O=Z();O!==b?(ma=B,B='"'):(k=B,B=b)}else k=B,B=b;return B}function Z(){if(Ef.test(f.charAt(k))){var B=f.charAt(k);k++}else B=b,0===fa&&a(Ff);return B}function ca(){var B;var O=B=k;if(64===f.charCodeAt(k)){var U=Gf;k++}else U=b,0===fa&&a(Hf);if(U!==b){var da=m();da!==b?O=U=[U,da]:(k=O,O=b)}else k=O,O=b;O!==b&&(ma=B,O={type:"parameter",value:O[1]});
return O}function ja(){var B=k;if(f.substr(k,7).toLowerCase()===If){var O=f.substr(k,7);k+=7}else O=b,0===fa&&a(Jf);if(O!==b){O=k;fa++;var U=M();fa--;U===b?O=void 0:(k=O,O=b);O!==b?(ma=B,B="LEADING"):(k=B,B=b)}else k=B,B=b;B===b&&(B=k,f.substr(k,8).toLowerCase()===Kf?(O=f.substr(k,8),k+=8):(O=b,0===fa&&a(Lf)),O!==b?(O=k,fa++,U=M(),fa--,U===b?O=void 0:(k=O,O=b),O!==b?(ma=B,B="TRAILING"):(k=B,B=b)):(k=B,B=b),B===b&&(B=k,f.substr(k,4).toLowerCase()===Mf?(O=f.substr(k,4),k+=4):(O=b,0===fa&&a(Nf)),O!==
b?(O=k,fa++,U=M(),fa--,U===b?O=void 0:(k=O,O=b),O!==b?(ma=B,B="BOTH"):(k=B,B=b)):(k=B,B=b)));return B}function na(){var B=k;var O=k;var U=ta();if(U!==b){ka();var da=Ja();if(da!==b)if(ka(),da=sa(),da!==b){ka();var pa=Ka();pa!==b?(ma=O,O={type:"interval-period",period:U.value,precision:da,secondary:null}):(k=O,O=b)}else k=O,O=b;else k=O,O=b}else k=O,O=b;O===b&&(O=k,U=ta(),U!==b&&(ma=O,U={type:"interval-period",period:U.value,precision:null,secondary:null}),O=U);if(O!==b)if(ka(),U=k,f.substr(k,2).toLowerCase()===
Of?(da=f.substr(k,2),k+=2):(da=b,0===fa&&a(Pf)),da!==b?(da=k,fa++,pa=M(),fa--,pa===b?da=void 0:(k=da,da=b),da!==b?(ma=U,U="TO"):(k=U,U=b)):(k=U,U=b),U!==b){ka();U=k;da=ta();da!==b&&(ma=U,da={type:"interval-period",period:da.value,precision:null,secondary:null});U=da;if(U===b){U=k;da=Aa();if(da!==b)if(ka(),da=Ja(),da!==b)if(ka(),da=sa(),da!==b)if(ka(),pa=Wa(),pa!==b)if(ka(),pa=ua(),pa!==b){ka();var za=Ka();za!==b?(ma=U,U={type:"interval-period",period:"second",precision:da,secondary:pa}):(k=U,U=b)}else k=
U,U=b;else k=U,U=b;else k=U,U=b;else k=U,U=b;else k=U,U=b;U===b&&(U=k,da=Aa(),da!==b?(ka(),da=Ja(),da!==b?(ka(),da=sa(),da!==b?(ka(),pa=Ka(),pa!==b?(ma=U,U={type:"interval-period",period:"second",precision:da,secondary:null}):(k=U,U=b)):(k=U,U=b)):(k=U,U=b)):(k=U,U=b),U===b&&(U=k,da=Aa(),da!==b&&(ma=U,da={type:"interval-period",period:"second",precision:null,secondary:null}),U=da))}U!==b?(ma=B,B={type:"interval-qualifier",start:O,end:U}):(k=B,B=b)}else k=B,B=b;else k=B,B=b;B===b&&(B=k,U=ta(),U!==
b?(ka(),O=Ja(),O!==b?(ka(),O=ua(),O!==b?(ka(),da=Ka(),da!==b?(ma=B,B={type:"interval-period",period:U.value,precision:O,secondary:null}):(k=B,B=b)):(k=B,B=b)):(k=B,B=b)):(k=B,B=b),B===b&&(B=k,U=ta(),U!==b&&(ma=B,U={type:"interval-period",period:U.value,precision:null,secondary:null}),B=U,B===b&&(B=k,U=Aa(),U!==b?(ka(),O=Ja(),O!==b?(ka(),O=sa(),O!==b?(ka(),da=Wa(),da!==b?(ka(),U=ua(),U!==b?(ka(),da=Ka(),da!==b?(ma=B,B={type:"interval-period",period:"second",precision:O,secondary:U}):(k=B,B=b)):(k=
B,B=b)):(k=B,B=b)):(k=B,B=b)):(k=B,B=b)):(k=B,B=b),B===b&&(B=k,U=Aa(),U!==b?(ka(),O=Ja(),O!==b?(ka(),O=ua(),O!==b?(ka(),da=Ka(),da!==b?(ma=B,B={type:"interval-period",period:"second",precision:O,secondary:null}):(k=B,B=b)):(k=B,B=b)):(k=B,B=b)):(k=B,B=b),B===b&&(B=k,U=Aa(),U!==b&&(ma=B,U={type:"interval-period",period:"second",precision:null,secondary:null}),B=U)))));return B}function ta(){var B=k;var O=Ca();O!==b&&(ma=B,O={type:"string",value:"day"});B=O;B===b&&(B=k,O=wa(),O!==b&&(ma=B,O={type:"string",
value:"hour"}),B=O,B===b&&(B=k,O=Ba(),O!==b&&(ma=B,O={type:"string",value:"minute"}),B=O,B===b&&(B=k,O=qa(),O!==b&&(ma=B,O={type:"string",value:"month"}),B=O,B===b&&(B=k,O=oa(),O!==b&&(ma=B,O={type:"string",value:"year"}),B=O))));return B}function ua(){var B=k;var O=h();O!==b&&(ma=B,O=parseFloat(O));return O}function sa(){var B=k;var O=h();O!==b&&(ma=B,O=parseFloat(O));return O}function va(){var B=xa();B===b&&(B=ca());return B}function xa(){var B=k;if(39===f.charCodeAt(k)){var O=Fd;k++}else O=b,0===
fa&&a(Gd);O===b&&(f.substr(k,2)===Hd?(O=Hd,k+=2):(O=b,0===fa&&a(Qf)));if(O!==b){O=[];var U=k;if(f.substr(k,2)===yc){var da=yc;k+=2}else da=b,0===fa&&a(Id);da!==b&&(ma=U,da="'");U=da;U===b&&(Jd.test(f.charAt(k))?(U=f.charAt(k),k++):(U=b,0===fa&&a(Kd)));for(;U!==b;)O.push(U),U=k,f.substr(k,2)===yc?(da=yc,k+=2):(da=b,0===fa&&a(Id)),da!==b&&(ma=U,da="'"),U=da,U===b&&(Jd.test(f.charAt(k))?(U=f.charAt(k),k++):(U=b,0===fa&&a(Kd)));39===f.charCodeAt(k)?(U=Fd,k++):(U=b,0===fa&&a(Gd));U!==b?(ma=B,B={type:"string",
value:O.join("")}):(k=B,B=b)}else k=B,B=b;return B}function Da(){var B=k;if(Qa()!==b){ka();var O=E();if(O!==b){ka();var U=Ya();U!==b?(ka(),U=E(),U!==b?(ma=B,B={type:"when-clause",operand:O,value:U}):(k=B,B=b)):(k=B,B=b)}else k=B,B=b}else k=B,B=b;return B}function Ia(){var B=k;if(Qa()!==b){ka();var O=E();if(O!==b){ka();var U=Ya();U!==b?(ka(),U=E(),U!==b?(ma=B,B={type:"when-clause",operand:O,value:U}):(k=B,B=b)):(k=B,B=b)}else k=B,B=b}else k=B,B=b;return B}function Pa(){var B=k;var O=k;if(f.substr(k,
4).toLowerCase()===Rf){var U=f.substr(k,4);k+=4}else U=b,0===fa&&a(Sf);if(U!==b){U=k;fa++;var da=M();fa--;da===b?U=void 0:(k=U,U=b);U!==b?(ma=O,O="ELSE"):(k=O,O=b)}else k=O,O=b;O!==b?(ka(),O=E(),O!==b?(ma=B,B={type:"else-clause",value:O}):(k=B,B=b)):(k=B,B=b);return B}function Na(){var B=h();if(B===b){B=k;if(45===f.charCodeAt(k)){var O=Cc;k++}else O=b,0===fa&&a(Dc);O===b&&(43===f.charCodeAt(k)?(O=Ac,k++):(O=b,0===fa&&a(Bc)));if(O!==b){var U=h();U!==b?(ma=B,B=O[0]+U):(k=B,B=b)}else k=B,B=b}return B}
function Sa(){var B=k;if(46===f.charCodeAt(k)){var O=Tf;k++}else O=b,0===fa&&a(Uf);O!==b?(O=h(),O===b&&(O=null),ma=B,B="."+(null!=O?O:"")):(k=B,B=b);return B}function Va(){var B;var O=B=k;if(Vf.test(f.charAt(k))){var U=f.charAt(k);k++}else U=b,0===fa&&a(Wf);U!==b?(Xf.test(f.charAt(k))?(U=f.charAt(k),k++):(U=b,0===fa&&a(Yf)),U===b&&(U=null),ma=O,O="e"+(null===U?"":U)):(k=O,O=b);O!==b?(U=h(),U!==b?(ma=B,B=O+U):(k=B,B=b)):(k=B,B=b);return B}function h(){var B=k;var O=[];var U=C();if(U!==b)for(;U!==b;)O.push(U),
U=C();else O=b;O!==b&&(ma=B,O=O.join(""));return O}function C(){if(Zf.test(f.charAt(k))){var B=f.charAt(k);k++}else B=b,0===fa&&a($f);return B}function X(){var B=k;if(f.substr(k,2).toLowerCase()===ag){var O=f.substr(k,2);k+=2}else O=b,0===fa&&a(bg);if(O!==b){O=k;fa++;var U=M();fa--;U===b?O=void 0:(k=O,O=b);O!==b?(ma=B,B="IN"):(k=B,B=b)}else k=B,B=b;return B}function aa(){var B=k;if(f.substr(k,2).toLowerCase()===cg){var O=f.substr(k,2);k+=2}else O=b,0===fa&&a(dg);if(O!==b){O=k;fa++;var U=M();fa--;
U===b?O=void 0:(k=O,O=b);O!==b?(ma=B,B="IS"):(k=B,B=b)}else k=B,B=b;return B}function ha(){var B=k;if(f.substr(k,4).toLowerCase()===eg){var O=f.substr(k,4);k+=4}else O=b,0===fa&&a(fg);if(O!==b){O=k;fa++;var U=M();fa--;U===b?O=void 0:(k=O,O=b);O!==b?(ma=B,B="LIKE"):(k=B,B=b)}else k=B,B=b;return B}function y(){var B=k;if(f.substr(k,3).toLowerCase()===gg){var O=f.substr(k,3);k+=3}else O=b,0===fa&&a(hg);if(O!==b){O=k;fa++;var U=M();fa--;U===b?O=void 0:(k=O,O=b);O!==b?(ma=B,B="NOT"):(k=B,B=b)}else k=B,
B=b;return B}function F(){var B=k;if(f.substr(k,3).toLowerCase()===ig){var O=f.substr(k,3);k+=3}else O=b,0===fa&&a(jg);if(O!==b){O=k;fa++;var U=M();fa--;U===b?O=void 0:(k=O,O=b);O!==b?(ma=B,B="AND"):(k=B,B=b)}else k=B,B=b;return B}function K(){var B=k;if(f.substr(k,2).toLowerCase()===kg){var O=f.substr(k,2);k+=2}else O=b,0===fa&&a(lg);if(O!==b){O=k;fa++;var U=M();fa--;U===b?O=void 0:(k=O,O=b);O!==b?(ma=B,B="OR"):(k=B,B=b)}else k=B,B=b;return B}function W(){var B=k;if(f.substr(k,7).toLowerCase()===
mg){var O=f.substr(k,7);k+=7}else O=b,0===fa&&a(ng);if(O!==b){O=k;fa++;var U=M();fa--;U===b?O=void 0:(k=O,O=b);O!==b?(ma=B,B="BETWEEN"):(k=B,B=b)}else k=B,B=b;return B}function Y(){var B=k;if(f.substr(k,4).toLowerCase()===og){var O=f.substr(k,4);k+=4}else O=b,0===fa&&a(pg);if(O!==b){O=k;fa++;var U=M();fa--;U===b?O=void 0:(k=O,O=b);O!==b?(ma=B,B="FROM"):(k=B,B=b)}else k=B,B=b;return B}function ba(){var B=k;if(f.substr(k,4).toLowerCase()===qg){var O=f.substr(k,4);k+=4}else O=b,0===fa&&a(rg);if(O!==
b){O=k;fa++;var U=M();fa--;U===b?O=void 0:(k=O,O=b);O!==b?(ma=B,B="TRIM"):(k=B,B=b)}else k=B,B=b;return B}function ea(){var B=k;if(f.substr(k,9).toLowerCase()===sg){var O=f.substr(k,9);k+=9}else O=b,0===fa&&a(tg);if(O!==b){O=k;fa++;var U=M();fa--;U===b?O=void 0:(k=O,O=b);O!==b?(ma=B,B="TIMESTAMP"):(k=B,B=b)}else k=B,B=b;return B}function ia(){var B=k;if(f.substr(k,4).toLowerCase()===ug){var O=f.substr(k,4);k+=4}else O=b,0===fa&&a(vg);if(O!==b){O=k;fa++;var U=M();fa--;U===b?O=void 0:(k=O,O=b);O!==
b?(ma=B,B="DATE"):(k=B,B=b)}else k=B,B=b;return B}function la(){var B=k;if(f.substr(k,4).toLowerCase()===wg){var O=f.substr(k,4);k+=4}else O=b,0===fa&&a(xg);if(O!==b){O=k;fa++;var U=M();fa--;U===b?O=void 0:(k=O,O=b);O!==b?(ma=B,B="TIME"):(k=B,B=b)}else k=B,B=b;return B}function ra(){var B=k;if(f.substr(k,8).toLowerCase()===yg){var O=f.substr(k,8);k+=8}else O=b,0===fa&&a(zg);if(O!==b){O=k;fa++;var U=M();fa--;U===b?O=void 0:(k=O,O=b);O!==b?(ma=B,B="INTERVAL"):(k=B,B=b)}else k=B,B=b;return B}function oa(){var B=
k;if(f.substr(k,4).toLowerCase()===Ag){var O=f.substr(k,4);k+=4}else O=b,0===fa&&a(Bg);if(O!==b){O=k;fa++;var U=M();fa--;U===b?O=void 0:(k=O,O=b);O!==b?(ma=B,B="YEAR"):(k=B,B=b)}else k=B,B=b;return B}function qa(){var B=k;if(f.substr(k,5).toLowerCase()===Cg){var O=f.substr(k,5);k+=5}else O=b,0===fa&&a(Dg);if(O!==b){O=k;fa++;var U=M();fa--;U===b?O=void 0:(k=O,O=b);O!==b?(ma=B,B="MONTH"):(k=B,B=b)}else k=B,B=b;return B}function Ca(){var B=k;if(f.substr(k,3).toLowerCase()===Eg){var O=f.substr(k,3);k+=
3}else O=b,0===fa&&a(Fg);if(O!==b){O=k;fa++;var U=M();fa--;U===b?O=void 0:(k=O,O=b);O!==b?(ma=B,B="DAY"):(k=B,B=b)}else k=B,B=b;return B}function wa(){var B=k;if(f.substr(k,4).toLowerCase()===Gg){var O=f.substr(k,4);k+=4}else O=b,0===fa&&a(Hg);if(O!==b){O=k;fa++;var U=M();fa--;U===b?O=void 0:(k=O,O=b);O!==b?(ma=B,B="HOUR"):(k=B,B=b)}else k=B,B=b;return B}function Ba(){var B=k;if(f.substr(k,6).toLowerCase()===Ig){var O=f.substr(k,6);k+=6}else O=b,0===fa&&a(Jg);if(O!==b){O=k;fa++;var U=M();fa--;U===
b?O=void 0:(k=O,O=b);O!==b?(ma=B,B="MINUTE"):(k=B,B=b)}else k=B,B=b;return B}function Aa(){var B=k;if(f.substr(k,6).toLowerCase()===Kg){var O=f.substr(k,6);k+=6}else O=b,0===fa&&a(Lg);if(O!==b){O=k;fa++;var U=M();fa--;U===b?O=void 0:(k=O,O=b);O!==b?(ma=B,B="SECOND"):(k=B,B=b)}else k=B,B=b;return B}function ya(){var B=k;if(f.substr(k,4).toLowerCase()===Mg){var O=f.substr(k,4);k+=4}else O=b,0===fa&&a(Ng);if(O!==b){O=k;fa++;var U=M();fa--;U===b?O=void 0:(k=O,O=b);O!==b?(ma=B,B="CASE"):(k=B,B=b)}else k=
B,B=b;return B}function Ha(){var B=k;if(f.substr(k,3).toLowerCase()===Og){var O=f.substr(k,3);k+=3}else O=b,0===fa&&a(Pg);if(O!==b){O=k;fa++;var U=M();fa--;U===b?O=void 0:(k=O,O=b);O!==b?(ma=B,B="END"):(k=B,B=b)}else k=B,B=b;return B}function Qa(){var B=k;if(f.substr(k,4).toLowerCase()===Qg){var O=f.substr(k,4);k+=4}else O=b,0===fa&&a(Rg);if(O!==b){O=k;fa++;var U=M();fa--;U===b?O=void 0:(k=O,O=b);O!==b?(ma=B,B="WHEN"):(k=B,B=b)}else k=B,B=b;return B}function Ya(){var B=k;if(f.substr(k,4).toLowerCase()===
Sg){var O=f.substr(k,4);k+=4}else O=b,0===fa&&a(Tg);if(O!==b){O=k;fa++;var U=M();fa--;U===b?O=void 0:(k=O,O=b);O!==b?(ma=B,B="THEN"):(k=B,B=b)}else k=B,B=b;return B}function Wa(){if(44===f.charCodeAt(k)){var B=Ug;k++}else B=b,0===fa&&a(Vg);return B}function Ja(){if(40===f.charCodeAt(k)){var B=Wg;k++}else B=b,0===fa&&a(Xg);return B}function Ka(){if(41===f.charCodeAt(k)){var B=Yg;k++}else B=b,0===fa&&a(Zg);return B}function ka(){var B;var O=[];for(B=Ra();B!==b;)O.push(B),B=Ra();return O}function Ra(){if($g.test(f.charAt(k))){var B=
f.charAt(k);k++}else B=b,0===fa&&a(ah);return B}function Nb(B,O,U,da){B={type:"binary-expression",operator:B,left:O,right:U};void 0!==da&&(B.escape=da);return B}function nb(B,O){for(var U=0;U<O.length;U++)B=Nb(O[U][1],B,O[U][3]);return B}p=void 0!==p?p:{};var b={},Mb=p.grammarSource,Ld={start:r},Md=r,Nd="!",Sc="\x3d",Uc="\x3e\x3d",Sd="\x3e",Vc="\x3c\x3d",Wc="\x3c\x3e",Wd="\x3c",Xc="!\x3d",Ac="+",Cc="-",Yc="||",$d="*",be="/",Gf="@",Fd="'",Hd="N'",yc="''",Tf=".",ke="null",de="true",ge="false",ag="in",
cg="is",eg="like",Pd="escape",gg="not",ig="and",kg="or",mg="between",og="from",Ee="for",ze="substring",ne="extract",qg="trim",Ke="position",sg="timestamp",ug="date",wg="time",If="leading",Kf="trailing",Mf="both",Qe="cast",Ue="as",Ye="integer",af="smallint",df="float",gf="real",kf="varchar",Of="to",yg="interval",Ag="year",re="timezone_hour",ue="timezone_minute",Cg="month",Eg="day",Gg="hour",Ig="minute",Kg="second",Mg="case",Og="end",Qg="when",Sg="then",Rf="else",Ug=",",Wg="(",Yg=")",vd="`",Af=/^[A-Za-z_\x80-\uFFFF]/,
Cf=/^[A-Za-z0-9_]/,Dd=/^[A-Za-z0-9_.\x80-\uFFFF]/,Ef=/^["]/,Jd=/^[^']/,Zf=/^[0-9]/,Vf=/^[eE]/,Xf=/^[+\-]/,$g=/^[ \t\n\r]/,xd=/^[^`]/,Od=H("!",!1),Tc=H("\x3d",!1),Rd=H("\x3e\x3d",!1),Td=H("\x3e",!1),Ud=H("\x3c\x3d",!1),Vd=H("\x3c\x3e",!1),Xd=H("\x3c",!1),Yd=H("!\x3d",!1),Bc=H("+",!1),Dc=H("-",!1),Zd=H("||",!1),ae=H("*",!1),ce=H("/",!1),Bf=D([["A","Z"],["a","z"],"_",["\u0080","\uffff"]],!1,!1),Df=D([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),Ed=D([["A","Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],
!1,!1),Ff=D(['"'],!1,!1),Hf=H("@",!1),Gd=H("'",!1),Qf=H("N'",!1),Id=H("''",!1),Kd=D(["'"],!0,!1),Uf=H(".",!1),$f=D([["0","9"]],!1,!1),Wf=D(["e","E"],!1,!1),Yf=D(["+","-"],!1,!1),le=H("NULL",!0),ee=H("TRUE",!0),he=H("FALSE",!0),bg=H("IN",!0),dg=H("IS",!0),fg=H("LIKE",!0),Qd=H("ESCAPE",!0),hg=H("NOT",!0),jg=H("AND",!0),lg=H("OR",!0),ng=H("BETWEEN",!0),pg=H("FROM",!0),Fe=H("FOR",!0),Ae=H("SUBSTRING",!0),oe=H("EXTRACT",!0),rg=H("TRIM",!0),Le=H("POSITION",!0),tg=H("TIMESTAMP",!0),vg=H("DATE",!0),xg=H("TIME",
!0),Jf=H("LEADING",!0),Lf=H("TRAILING",!0),Nf=H("BOTH",!0),Re=H("CAST",!0),Ve=H("AS",!0),Ze=H("INTEGER",!0),bf=H("SMALLINT",!0),ef=H("FLOAT",!0),hf=H("REAL",!0),lf=H("VARCHAR",!0),Pf=H("TO",!0),zg=H("INTERVAL",!0),Bg=H("YEAR",!0),se=H("TIMEZONE_HOUR",!0),ve=H("TIMEZONE_MINUTE",!0),Dg=H("MONTH",!0),Fg=H("DAY",!0),Hg=H("HOUR",!0),Jg=H("MINUTE",!0),Lg=H("SECOND",!0),Ng=H("CASE",!0),Pg=H("END",!0),Rg=H("WHEN",!0),Tg=H("THEN",!0),Sf=H("ELSE",!0),Vg=H(",",!1),Xg=H("(",!1),Zg=H(")",!1),ah=D([" ","\t","\n",
"\r"],!1,!1),wd=H("`",!1),yd=D(["`"],!0,!1),k=0,ma=0,Zb=[{line:1,column:1}],eb=0,zc=[],fa=0;if("startRule"in p){if(!(p.startRule in Ld))throw Error("Can't start parsing from rule \""+p.startRule+'".');Md=Ld[p.startRule]}var Rc=Md();if(Rc!==b&&k===f.length)return Rc;Rc!==b&&k<f.length&&a({type:"end"});throw function(B,O,U){return new g(g.buildMessage(B,O),B,O,U)}(zc,eb<f.length?f.charAt(eb):null,eb<f.length?q(eb,eb+1):q(eb,eb));}}})})(A);var w=A.exports;class L{static parse(n){return w.parse(n)}}c.WhereGrammar=
L;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/fieldType":function(){define(["exports","../../core/jsonMap"],function(c,e){e=new e.JSONMap({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",
esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml",esriFieldTypeBigInteger:"big-integer",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimeOnly:"time-only",esriFieldTypeTimestampOffset:"timestamp-offset"});c.kebabDict=e;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/QueryEngineCapabilities":function(){define(["exports"],function(c){c.queryCapabilities={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,
centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByAnonymous:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,
supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/QueryEngineResult":function(){define("require exports ../../../core/lang ../../../geometry/support/centroid ../../../geometry/support/extentUtils ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ./AttributesBuilder ./geometryUtils ./projectionSupport ./SnappingCandidate ../../support/fieldUtils ../../../statistics/utils".split(" "),
function(c,e,A,w,L,n,g,u,f,p,x,H,D){function v(z,E,R,d){const G=d.x-R.x;d=d.y-R.y;E=Math.min(1,Math.max(0,((E.x-R.x)*G+(E.y-R.y)*d)/(G*G+d*d)));z.x=R.x+G*E;z.y=R.y+d*E}function q(z,E){return z?E?4:3:E?3:2}class a{constructor(z,E,R){this.items=z;this.query=E;this.geometryType=R.geometryType;this.hasM=R.hasM;this.hasZ=R.hasZ;this.fieldsIndex=R.fieldsIndex;this.objectIdField=R.objectIdField;this.spatialReference=R.spatialReference;this.featureAdapter=R.featureAdapter}get size(){return this.items.length}createQueryResponseForCount(){const z=
new u(this.query,this.featureAdapter,this.fieldsIndex);if(!this.query.outStatistics)return z.countDistinctValues(this.items);const {groupByFieldsForStatistics:E,having:R,outStatistics:d}=this.query;if(!E?.length)return 1;const G=new Map,T=new Map,J=new Set;for(const V of d){var {statisticType:Q}=V;Q="exceedslimit"!==Q?V.onStatisticField:void 0;if(!T.has(Q)){var P=[];for(const l of E){const N=this._getAttributeValues(z,l,G);P.push(N)}T.set(Q,this._calculateUniqueValues(P,z.returnDistinctValues))}Q=
T.get(Q);for(const l in Q){const {data:N,items:m}=Q[l];P=N.join(",");R&&!z.validateItems(m,R)||J.add(P)}}return J.size}async createQueryResponse(){let z;z=this.query.outStatistics?this.query.outStatistics.some(E=>"exceedslimit"===E.statisticType)?this._createExceedsLimitQueryResponse(this.query):await this._createStatisticsQueryResponse(this.query):this._createFeatureQueryResponse(this.query);if(this.query.returnQueryGeometry){const E=this.query.geometry;g.isValid(this.query.outSR)&&!g.equals(E.spatialReference,
this.query.outSR)?z.queryGeometry=f.cleanFromGeometryEngine({spatialReference:this.query.outSR,...p.project(E,E.spatialReference,this.query.outSR)}):z.queryGeometry=f.cleanFromGeometryEngine({spatialReference:this.query.outSR,...E})}return z}createSnappingResponse(z,E){const R=this.featureAdapter,d=q(this.hasZ,this.hasM),{point:G,mode:T}=z,J="number"===typeof z.distance?z.distance:z.distance.x,Q="number"===typeof z.distance?z.distance:z.distance.y,P={candidates:[]},V="esriGeometryPolygon"===this.geometryType;
E=this._getPointCreator(T,this.spatialReference,E);const l=new r(null,0),N=new r(null,0),m={x:0,y:0,z:0};for(const ja of this.items){var t=R.getGeometry(ja);if(null==t)continue;const {coords:na,lengths:ta}=t;l.coords=na;N.coords=na;if(z.returnEdge){t=0;for(var M=0;M<ta.length;M++){var I=ta[M];for(var S=0;S<I;S++,t+=d){var Z=l;Z.coordsIndex=t;if(S!==I-1){const ua=N;ua.coordsIndex=t+d;const sa=m;v(m,G,Z,ua);var ca=(G.x-sa.x)/J;const va=(G.y-sa.y)/Q;ca=ca*ca+va*va;1>=ca&&P.candidates.push(x.makeEdgeCandidate(R.getObjectId(ja),
E(sa),Math.sqrt(ca),E(Z),E(ua)))}}}}if("none"!==z.vertexMode)if(t=V?na.length-d:na.length,"all"===z.vertexMode)for(M=0;M<t;M+=d)I=l,I.coordsIndex=M,S=(G.x-I.x)/J,Z=(G.y-I.y)/Q,S=S*S+Z*Z,1>=S&&P.candidates.push(x.makeVertexCandidate(R.getObjectId(ja),E(I),Math.sqrt(S)));else if("ends"===z.vertexMode){t=[0];V||t.push(na.length-d);for(const ua of t)t=l,t.coordsIndex=ua,M=(G.x-t.x)/J,I=(G.y-t.y)/Q,M=M*M+I*I,1>=M&&P.candidates.push(x.makeVertexCandidate(R.getObjectId(ja),E(t),Math.sqrt(M)))}}P.candidates.sort((ja,
na)=>ja.distance-na.distance);return P}_getPointCreator(z,E,R){const d=null==R||g.equals(E,R)?T=>T:T=>p.project(T,E,R),{hasZ:G}=this;return"3d"===z?G?({x:T,y:J,z:Q})=>d({x:T,y:J,z:Q}):({x:T,y:J})=>d({x:T,y:J,z:0}):({x:T,y:J})=>d({x:T,y:J})}async createSummaryStatisticsResponse(z){const {field:E,valueExpression:R,normalizationField:d,normalizationType:G,normalizationTotal:T,minValue:J,maxValue:Q,scale:P,timeZone:V}=z;var l=this.fieldsIndex.get(E);z=H.isDateField(l)||H.isDateOnlyField(l)||H.isTimestampOffsetField(l);
const N=await this._getDataValues({field:E,valueExpression:R,normalizationField:d,normalizationType:G,normalizationTotal:T,scale:P,timeZone:V}),m=D.isNullCountSupported({normalizationType:G,normalizationField:d,minValue:J,maxValue:Q}),t={value:.5,fieldType:l?.type};l=H.isStringField(l)?D.calculateStringStatistics({values:N,supportsNullCount:m,percentileParams:t}):D.calculateStatistics({values:N,minValue:J,maxValue:Q,useSampleStdDev:!G,supportsNullCount:m,percentileParams:t});return D.processSummaryStatisticsResult(l,
z)}async createUniqueValuesResponse(z){const {field:E,valueExpression:R,domains:d,returnAllCodedValues:G,scale:T,timeZone:J}=z;var Q=await this._getDataValues({field:E,field2:z.field2,field3:z.field3,fieldDelimiter:z.fieldDelimiter,valueExpression:R,scale:T,timeZone:J},!1);Q=D.calculateUniqueValuesCount(Q);return D.createUVResult(Q,d,G,z.fieldDelimiter)}async createClassBreaksResponse(z){const {field:E,valueExpression:R,normalizationField:d,normalizationType:G,normalizationTotal:T,classificationMethod:J,
standardDeviationInterval:Q,minValue:P,maxValue:V,numClasses:l,scale:N,timeZone:m}=z;z=await this._getDataValues({field:E,valueExpression:R,normalizationField:d,normalizationType:G,normalizationTotal:T,scale:N,timeZone:m});z=D.calculateClassBreaks(z,{field:E,normalizationField:d,normalizationType:G,normalizationTotal:T,classificationMethod:J,standardDeviationInterval:Q,minValue:P,maxValue:V,numClasses:l});return D.resolveCBResult(z,J)}async createHistogramResponse(z){const {field:E,valueExpression:R,
normalizationField:d,normalizationType:G,normalizationTotal:T,classificationMethod:J,standardDeviationInterval:Q,minValue:P,maxValue:V,numBins:l,scale:N,timeZone:m}=z;z=await this._getDataValues({field:E,valueExpression:R,normalizationField:d,normalizationType:G,normalizationTotal:T,scale:N,timeZone:m});return D.calculateHistogram(z,{field:E,normalizationField:d,normalizationType:G,normalizationTotal:T,classificationMethod:J,standardDeviationInterval:Q,minValue:P,maxValue:V,numBins:l})}_sortFeatures(z,
E,R){if(1<z.length&&E?.length)for(const d of E.reverse()){E=d.split(" ");const G=E[0],T=this.fieldsIndex.get(G);E=E[1]?"desc"===E[1].toLowerCase():!1;const J=D.getAttributeComparator(T?.type,E);z.sort((Q,P)=>{Q=R(Q,G,T);P=R(P,G,T);return J(Q,P)})}}_createFeatureQueryResponse(z){const E=this.items,{geometryType:R,hasM:d,hasZ:G,objectIdField:T,spatialReference:J}=this,{outFields:Q,outSR:P,quantizationParameters:V,resultRecordCount:l,resultOffset:N,returnZ:m,returnM:t}=z,M=null!=l?E.length>(N||0)+l:
!1,I=Q&&(Q.includes("*")?[...this.fieldsIndex.fields]:Q.map(S=>this.fieldsIndex.get(S)));return{exceededTransferLimit:M,features:this._createFeatures(z,E),fields:I,geometryType:R,hasM:d&&t,hasZ:G&&m,objectIdFieldName:T,spatialReference:f.cleanFromGeometryEngine(P||J),transform:V&&n.toQuantizationTransform(V)||null}}_createFeatures(z,E){const R=new u(z,this.featureAdapter,this.fieldsIndex),{hasM:d,hasZ:G}=this,{orderByFields:T,quantizationParameters:J,returnGeometry:Q,returnCentroid:P,maxAllowableOffset:V,
resultOffset:l,resultRecordCount:N,returnZ:m=!1,returnM:t=!1}=z,M=G&&m,I=d&&t;z=[];var S=0;E=[...E];this._sortFeatures(E,T,(ja,na,ta)=>R.getFieldValue(ja,na,ta));if(this.geometryType&&(Q||P)){var Z=n.toQuantizationTransform(J)??void 0;if(Q&&!P)for(var ca of E)z[S++]={attributes:R.getAttributes(ca),geometry:f.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(ca),V,Z,M,I)};else if(!Q&&P)for(const ja of E)z[S++]={attributes:R.getAttributes(ja),centroid:f.transformCentroid(this,
this.featureAdapter.getCentroid(ja,this),Z)};else for(const ja of E)z[S++]={attributes:R.getAttributes(ja),centroid:f.transformCentroid(this,this.featureAdapter.getCentroid(ja,this),Z),geometry:f.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(ja),V,Z,M,I)}}else for(Z of E)(ca=R.getAttributes(Z))&&(z[S++]={attributes:ca});S=l||0;null!=N&&(z=z.slice(S,Math.min(z.length,S+N)));return z}_createExceedsLimitQueryResponse(z){var E=!1;let R=Number.POSITIVE_INFINITY,d=Number.POSITIVE_INFINITY;
E=Number.POSITIVE_INFINITY;for(const G of z.outStatistics??[])if("exceedslimit"===G.statisticType){R=null!=G.maxPointCount?G.maxPointCount:Number.POSITIVE_INFINITY;d=null!=G.maxRecordCount?G.maxRecordCount:Number.POSITIVE_INFINITY;E=null!=G.maxVertexCount?G.maxVertexCount:Number.POSITIVE_INFINITY;break}if("esriGeometryPoint"===this.geometryType)E=this.items.length>R;else if(this.items.length>d)E=!0;else{z=q(this.hasZ,this.hasM);const G=this.featureAdapter;E=this.items.reduce((T,J)=>{J=G.getGeometry(J);
return T+(null!=J&&J.coords.length||0)},0)/z>E}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(E)}}]}}async _createStatisticsQueryResponse(z){var E={attributes:{}};const R=[],d=new Map,G=new Map,T=new Map,J=new Map,Q=new u(z,this.featureAdapter,this.fieldsIndex);var P=z.outStatistics;const {groupByFieldsForStatistics:V,having:l,orderByFields:N,resultRecordCount:m}=
z;z=V?.length;const t=!!z,M=t?V[0]:null,I=t&&!this.fieldsIndex.get(M);for(const na of P??[]){const {outStatisticFieldName:ta,statisticType:ua}=na;P=na;const sa="exceedslimit"!==ua?na.onStatisticField:void 0,va="percentile_disc"===ua||"percentile_cont"===ua;var S="EnvelopeAggregate"===ua||"CentroidAggregate"===ua||"ConvexHullAggregate"===ua;const xa=t&&1===z&&(sa===M||I)&&"count"===ua;if(t){if(!T.has(sa)){var Z=[];for(const Da of V){var ca=this._getAttributeValues(Q,Da,d);Z.push(ca)}T.set(sa,this._calculateUniqueValues(Z,
S?!1:Q.returnDistinctValues))}Z=T.get(sa);if(!Z)continue;ca=Object.keys(Z);for(const Da of ca){const {count:Ia,data:Pa,items:Na,itemPositions:Sa}=Z[Da];ca=Pa.join(",");if(!l||Q.validateItems(Na,l)){const Va=J.get(ca)||{attributes:{}};if(S){Va.aggregateGeometries||(Va.aggregateGeometries={});const {aggregateGeometries:C,outStatisticFieldName:X}=await this._getAggregateGeometry(P,Na);Va.aggregateGeometries[X]=C}else{var ja=null;if(xa)ja=Ia;else{const C=this._getAttributeValues(Q,sa,d);ja=Sa.map(X=>
C[X]);ja=va&&"statisticParameters"in P?this._getPercentileValue(P,ja):this._getStatisticValue(P,ja,null,Q.returnDistinctValues)}Va.attributes[ta]=ja}let h=0;V.forEach((C,X)=>Va.attributes[this.fieldsIndex.get(C)?C:`EXPR_${++h}`]=Pa[X]);J.set(ca,Va)}}}else if(S){E.aggregateGeometries||(E.aggregateGeometries={});const {aggregateGeometries:Da,outStatisticFieldName:Ia}=await this._getAggregateGeometry(P,this.items);E.aggregateGeometries[Ia]=Da}else S=this._getAttributeValues(Q,sa,d),E.attributes[ta]=
va&&"statisticParameters"in P?this._getPercentileValue(P,S):this._getStatisticValue(P,S,G,Q.returnDistinctValues);P="min"!==ua&&"max"!==ua||!H.isStringField(this.fieldsIndex.get(sa))&&!this._isAnyDateField(sa)?null:this.fieldsIndex.get(sa)?.type;R.push({name:ta,alias:ta,type:P||"esriFieldTypeDouble"})}E=t?Array.from(J.values()):[E];this._sortFeatures(E,N,(na,ta)=>na.attributes[ta]);m&&(E.length=Math.min(m,E.length));return{fields:R,features:E}}_isAnyDateField(z){z=this.fieldsIndex.get(z);return H.isDateField(z)||
H.isDateOnlyField(z)||H.isTimestampOffsetField(z)||H.isTimeOnlyField(z)}async _getAggregateGeometry(z,E){const {convexHull:R,union:d}=await new Promise((m,t)=>c(["../../../geometry/geometryEngineJSON"],m,t)),{statisticType:G,outStatisticFieldName:T}=z,{featureAdapter:J,spatialReference:Q,geometryType:P,hasZ:V,hasM:l}=this;E=E.map(m=>f.getGeometry(P,V,l,J.getGeometry(m)));const N=R(Q,E,!0)[0];z={aggregateGeometries:null,outStatisticFieldName:null};"EnvelopeAggregate"===G?(E=N?L.getPolygonExtent(N):
L.getGeometryExtent(d(Q,E)),z.aggregateGeometries={...E,spatialReference:Q},z.outStatisticFieldName=T||"extent"):"CentroidAggregate"===G?(E=N?w.polygonCentroid(N):w.extentCentroid(L.getGeometryExtent(d(Q,E))),z.aggregateGeometries={x:E[0],y:E[1],spatialReference:Q},z.outStatisticFieldName=T||"centroid"):"ConvexHullAggregate"===G&&(z.aggregateGeometries=N,z.outStatisticFieldName=T||"convexHull");return z}_getStatisticValue(z,E,R,d){const {onStatisticField:G,statisticType:T}=z;z=null;z=R?.has(G)?R.get(G):
H.isStringField(this.fieldsIndex.get(G))||this._isAnyDateField(G)?D.calculateStringStatistics({values:E,returnDistinct:d}):D.calculateStatistics({values:d?[...(new Set(E))]:E,minValue:null,maxValue:null,useSampleStdDev:!0});R&&R.set(G,z);return z["var"===T?"variance":T]}_getPercentileValue(z,E){const {onStatisticField:R,statisticParameters:d,statisticType:G}=z,{value:T,orderBy:J}=d;z=this.fieldsIndex.get(R);return D.calculatePercentile(E,{value:T,orderBy:J,fieldType:z?.type,isDiscrete:"percentile_disc"===
G})}_getAttributeValues(z,E,R){if(R.has(E))return R.get(E);const d=this.fieldsIndex.get(E),G=this.items.map(T=>z.getFieldValue(T,E,d));R.set(E,G);return G}_calculateUniqueValues(z,E){const R={},d=this.items,G=d.length;for(let T=0;T<G;T++){const J=d[T],Q=[];for(const V of z)Q.push(V[T]);const P=Q.join(",");null==R[P]?R[P]={count:1,data:Q,items:[J],itemPositions:[T]}:(E||R[P].count++,R[P].items.push(J),R[P].itemPositions.push(T))}return R}async _getDataValues(z,E=!0){const R=new u(this.query,this.featureAdapter,
this.fieldsIndex),{valueExpression:d,scale:G,timeZone:T}=z;return d?R.getExpressionValues(this.items,d,{viewingMode:"map",scale:G,spatialReference:this.query.outSR||this.spatialReference},{geometryType:this.geometryType,hasZ:this.hasZ,hasM:this.hasM},T):R.getDataValues(this.items,A.clone(z),E)}}class r{constructor(z,E){this.coords=z;this.coordsIndex=E}get x(){return this.coords[this.coordsIndex]}get y(){return this.coords[this.coordsIndex+1]}get z(){return this.coords[this.coordsIndex+2]}}e.QueryEngineResult=
a;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/quantizationUtils":function(){define(["exports","./jsonUtils"],function(c,e){function A({scale:P,translate:V},l){return Math.round((l-V[0])/P[0])}function w({scale:P,translate:V},l){return Math.round((V[1]-l)/P[1])}function L(P,V,l){const N=[];let m,t,M,I;for(let S=0;S<l.length;S++){const Z=l[S];if(0<S){if(M=A(P,Z[0]),I=w(P,Z[1]),M!==m||I!==t)N.push(V(Z,M-m,I-t)),m=M,t=I}else m=A(P,Z[0]),t=w(P,Z[1]),N.push(V(Z,
m,t))}return 0<N.length?N:null}function n(P,V,l,N){return L(P,l?N?Q:J:N?J:T,V)}function g(P,V,l,N){const m=[];l=l?N?Q:J:N?J:T;for(N=0;N<V.length;N++){const t=L(P,l,V[N]);t&&3<=t.length&&m.push(t)}return m.length?m:null}function u(P,V,l,N){const m=[];l=l?N?Q:J:N?J:T;for(N=0;N<V.length;N++){const t=L(P,l,V[N]);t&&2<=t.length&&m.push(t)}return m.length?m:null}function f({scale:P,translate:V},l){return l*P[0]+V[0]}function p({scale:P,translate:V},l){return V[1]-l*P[1]}function x(P,V,l){const N=Array(l.length);
if(!l.length)return N;const [m,t]=P.scale;let M=f(P,l[0][0]);P=p(P,l[0][1]);N[0]=V(l[0],M,P);for(let I=1;I<l.length;I++){const S=l[I];M+=S[0]*m;P-=S[1]*t;N[I]=V(S,M,P)}return N}function H(P,V,l){const N=Array(l.length);for(let m=0;m<l.length;m++)N[m]=x(P,V,l[m]);return N}function D(P,V,l,N){return x(P,l?N?Q:J:N?J:T,V)}function v(P,V,l,N){return H(P,l?N?Q:J:N?J:T,V)}function q(P,V,l,N){return H(P,l?N?Q:J:N?J:T,V)}function a(P,V,l){let [N,m]=l[0],t=Math.min(N,V[0]),M=Math.min(m,V[1]),I=Math.max(N,V[2]);
V=Math.max(m,V[3]);for(let S=1;S<l.length;S++){const [Z,ca]=l[S];N+=Z;m+=ca;0>Z&&(t=Math.min(t,N));0<Z&&(I=Math.max(I,N));0>ca?M=Math.min(M,m):0<ca&&(V=Math.max(V,m))}P[0]=t;P[1]=M;P[2]=I;P[3]=V;return P}function r(P,V){if(!V.length)return null;P[0]=P[1]=Number.POSITIVE_INFINITY;P[2]=P[3]=Number.NEGATIVE_INFINITY;for(let l=0;l<V.length;l++)a(P,P,V[l]);return P}function z(P,V,l,N,m){V.xmin=A(P,l.xmin);V.ymin=w(P,l.ymin);V.xmax=A(P,l.xmax);V.ymax=w(P,l.ymax);V!==l&&(N&&(V.zmin=l.zmin,V.zmax=l.zmax),
m&&(V.mmin=l.mmin,V.mmax=l.mmax));return V}function E(P,V,l,N,m){V.points=n(P,l.points,N,m)??[];return V}function R(P,V,l,N,m){V.x=A(P,l.x);V.y=w(P,l.y);V!==l&&(N&&(V.z=l.z),m&&(V.m=l.m));return V}function d(P,V,l,N,m){P=g(P,l.rings,N,m);if(!P)return null;V.rings=P;return V}function G(P,V,l,N,m){P=u(P,l.paths,N,m);if(!P)return null;V.paths=P;return V}const T=(P,V,l)=>[V,l],J=(P,V,l)=>[V,l,P[2]],Q=(P,V,l)=>[V,l,P[2],P[3]];c.equals=function(P,V){if(P===V||null==P&&null==V)return!0;if(null==P||null==
V)return!1;let l,N,m,t;P&&"upperLeft"===P.originPosition?(l=P.translate[0],N=P.translate[1],P=P.scale[0]):(l=null!=P.extent?P.extent.xmin:0,N=null!=P.extent?P.extent.ymax:0,P=P.tolerance);V&&"upperLeft"===V.originPosition?(m=V.translate[0],t=V.translate[1],V=V.scale[0]):(m=null!=V.extent?V.extent.xmin:0,t=null!=V.extent?V.extent.ymax:0,V=V.tolerance);return l===m&&N===t&&P===V};c.getQuantizedBoundsCoordsArray=a;c.getQuantizedBoundsCoordsArrayArray=r;c.getQuantizedBoundsPaths=function(P){return r([0,
0,0,0],P)};c.getQuantizedBoundsPoints=function(P){const V=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return a(V,V,P)};c.getQuantizedBoundsRings=function(P){return r([0,0,0,0],P)};c.quantizeBounds=function(P,V,l){V[0]=A(P,l[0]);V[3]=w(P,l[1]);V[2]=A(P,l[2]);V[1]=w(P,l[3]);return V};c.quantizeExtent=z;c.quantizeGeometry=function(P,V){return P&&V?e.isPoint(V)?R(P,{},V,!1,!1):e.isPolyline(V)?G(P,{},V,!1,!1):e.isPolygon(V)?d(P,{},V,!1,!1):e.isMultipoint(V)?
E(P,{},V,!1,!1):e.isExtent(V)?z(P,{},V,!1,!1):null:null};c.quantizeMultipoint=E;c.quantizePaths=u;c.quantizePoint=R;c.quantizePoints=n;c.quantizePolygon=d;c.quantizePolyline=G;c.quantizeRings=g;c.quantizeX=A;c.quantizeY=w;c.toQuantizationTransform=function(P){return P?{originPosition:"upper-left"===P.originPosition?"upperLeft":"lower-left"===P.originPosition?"lowerLeft":P.originPosition,scale:P.tolerance?[P.tolerance,P.tolerance]:[1,1],translate:null!=P.extent?[P.extent.xmin,P.extent.ymax]:[0,0]}:
null};c.unquantizeBounds=function(P,V,l){return l?(V[0]=f(P,l[0]),V[1]=p(P,l[3]),V[2]=f(P,l[2]),V[3]=p(P,l[1]),V):[f(P,V[0]),p(P,V[3]),f(P,V[2]),p(P,V[1])]};c.unquantizeCoordsArray=x;c.unquantizeCoordsArrayArray=H;c.unquantizeExtent=function(P,V,l,N,m){V.xmin=f(P,l.xmin);V.ymin=p(P,l.ymin);V.xmax=f(P,l.xmax);V.ymax=p(P,l.ymax);V!==l&&(N&&(V.zmin=l.zmin,V.zmax=l.zmax),m&&(V.mmin=l.mmin,V.mmax=l.mmax));return V};c.unquantizeMultipoint=function(P,V,l,N,m){null!=l&&(V.points=D(P,l.points,N,m));return V};
c.unquantizePaths=v;c.unquantizePoint=function(P,V,l,N,m){if(null==l)return V;V.x=f(P,l.x);V.y=p(P,l.y);V!==l&&(N&&(V.z=l.z),m&&(V.m=l.m));return V};c.unquantizePoints=D;c.unquantizePolygon=function(P,V,l,N,m){null!=l&&(V.rings=q(P,l.rings,N,m));return V};c.unquantizePolyline=function(P,V,l,N,m){null!=l&&(V.paths=v(P,l.paths,N,m));return V};c.unquantizeRings=q;c.unquantizeX=f;c.unquantizeY=p;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/AttributesBuilder":function(){define("./attributeSupport ./geometryUtils ../../support/fieldUtils ../../../smartMapping/statistics/support/utils ../../../statistics/utils ../../../support/arcadeOnDemand".split(" "),
function(c,e,A,w,L,n){class g{constructor(u,f,p){this._fieldDataCache=new Map;this._returnDistinctMap=new Map;this.returnDistinctValues=u.returnDistinctValues??!1;this.fieldsIndex=p;this.featureAdapter=f;if((f=u.outFields)&&!f.includes("*")){this.outFields=f;u=0;for(const H of f){var x=c.getExpressionFromFieldName(H);x=(f=this.fieldsIndex.get(x))?null:c.getWhereClause(x,p);f=f?f.name:c.getAliasFromFieldName(H)||`FIELD_EXP_${u++}`;this._fieldDataCache.set(H,{alias:f,clause:x})}}}countDistinctValues(u){if(!this.returnDistinctValues)return u.length;
u.forEach(f=>this.getAttributes(f));return this._returnDistinctMap.size}getAttributes(u){u=this._processAttributesForOutFields(u);return this._processAttributesForDistinctValues(u)}getFieldValue(u,f,p){const x=p?p.name:f;let H=null;this._fieldDataCache.has(x)?H=this._fieldDataCache.get(x)?.clause:p||(H=c.getWhereClause(f,this.fieldsIndex),this._fieldDataCache.set(x,{alias:x,clause:H}));return p?this.featureAdapter.getAttribute(u,x):H?.calculateValue(u,this.featureAdapter)}getDataValues(u,f,p=!0){const x=
f.normalizationType,H=f.normalizationTotal,D=this.fieldsIndex.get(f.field),v=A.isDateOnlyField(D)||A.isTimestampOffsetField(D),q=A.isTimeOnlyField(D);return u.map(a=>{let r=f.field&&this.getFieldValue(a,f.field,this.fieldsIndex.get(f.field));f.field2?(r=`${L.processNullValue(r)}${f.fieldDelimiter}${L.processNullValue(this.getFieldValue(a,f.field2,this.fieldsIndex.get(f.field2)))}`,f.field3&&(r=`${r}${f.fieldDelimiter}${L.processNullValue(this.getFieldValue(a,f.field3,this.fieldsIndex.get(f.field3)))}`)):
"string"===typeof r&&p&&(v?r=r?(new Date(r)).getTime():null:q&&(r=r?w.timeOnlyToMilliseconds(r):null));x&&Number.isFinite(r)&&(a="field"===x&&f.normalizationField?this.getFieldValue(a,f.normalizationField,this.fieldsIndex.get(f.normalizationField)):null,r=L.getNormalizedValue(r,x,a,H));return r})}async getExpressionValues(u,f,p,x,H){const {arcadeUtils:D}=await n.loadArcade(),v=D.hasGeometryOperations(f);v&&await D.enableGeometryOperations();const q=D.createFunction(f),a=D.getViewInfo(p),r={fields:this.fieldsIndex.fields};
return u.map(z=>{z={attributes:this.featureAdapter.getAttributes(z),layer:r,geometry:v?{...e.getGeometry(x.geometryType,x.hasZ,x.hasM,this.featureAdapter.getGeometry(z)),spatialReference:p?.spatialReference}:null};z=D.createExecContext(z,a,H);return D.executeFunction(q,z)})}validateItem(u,f){this._fieldDataCache.has(f)||this._fieldDataCache.set(f,{alias:f,clause:c.getWhereClause(f,this.fieldsIndex)});return this._fieldDataCache.get(f)?.clause?.testFeature(u,this.featureAdapter)??!1}validateItems(u,
f){this._fieldDataCache.has(f)||this._fieldDataCache.set(f,{alias:f,clause:c.getWhereClause(f,this.fieldsIndex)});return this._fieldDataCache.get(f)?.clause?.testSet(u,this.featureAdapter)??!1}_processAttributesForOutFields(u){const f=this.outFields;if(!f?.length)return this.featureAdapter.getAttributes(u);const p={};for(const x of f){const {alias:H,clause:D}=this._fieldDataCache.get(x);p[H]=D?D.calculateValue(u,this.featureAdapter):this.featureAdapter.getAttribute(u,H)}return p}_processAttributesForDistinctValues(u){if(null==
u||!this.returnDistinctValues)return u;var f=this.outFields,p=[];if(f)for(const H of f){var {alias:x}=this._fieldDataCache.get(H);p.push(u[x])}else for(x in u)p.push(u[x]);f=`${(f||["*"]).join(",")}=${p.join(",")}`;p=this._returnDistinctMap.get(f)||0;this._returnDistinctMap.set(f,++p);return 1<p?null:u}}return g})},"esri/smartMapping/statistics/support/utils":function(){define("exports ../../../geometry ../../../core/Error ../../../core/screenUtils ../../../core/timeUtils ../../../geometry/SpatialReference ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ../../../layers/support/fieldUtils ../../../renderers/support/heatmapUtils ../../support/utils ../../../statistics/utils ../../../support/arcadeOnDemand ../../../geometry/Point".split(" "),
function(c,e,A,w,L,n,g,u,f,p,x,H,D,v){function q(d){d=R.exec(d);if(!d)return null;const {hh:G,mm:T,ss:J,ms:Q}=d.groups;return Number(G)*L.millisecondsPerTimeUnit.hours+Number(T)*L.millisecondsPerTimeUnit.minutes+Number(J)*L.millisecondsPerTimeUnit.seconds+Number(Q||0)}function a(d,G){d=null!=d?d:"";null!=G&&G&&(d=d?"("+d+") AND ("+G+")":G);return d}function r(d){const G=d.layer;return d.fields.filter(T=>!G.getField(T))}function z(d){const G=d.layer;return d.fields.filter(T=>{T=G.getFieldUsageInfo(T);
return!T||!T.supportsStatistics})}let E=null;const R=/^(?<hh>([0-1][0-9])|([2][0-3])):(?<mm>[0-5][0-9])(:(?<ss>[0-5][0-9]))?([.](?<ms>\d+))?$/;c.calculateHeatmapStats=function(d,G=18,T,J,Q,P){const V=new Float64Array(Q*P);G=Math.round(w.pt2px(G));let l=Number.POSITIVE_INFINITY,N=Number.NEGATIVE_INFINITY;var m=0;let t=0,M=0,I=0;T=p.createValueFunction(J,T);for(const {geometry:Z,attributes:ca}of d){const {x:ja,y:na}=Z;d=Math.max(0,ja-G);m=Math.max(0,na-G);J=Math.min(P,na+G);const ta=Math.min(Q,ja+G),
ua=+T(ca);for(let sa=m;sa<J;sa++)for(let va=d;va<ta;va++){m=sa*Q+va;const xa=p.evaluateDensityKernel(va-ja,sa-na,G);var S=V[m];m=V[m]+=xa*ua;S=m-S;t+=S;M+=S*S;m<l&&(l=m);m>N&&(N=m);I++}}return I?{mean:t/I,stdDev:Math.sqrt((M-t*t/I)/I),min:l,max:N,mid:(N-l)/2,count:I}:{mean:0,stddev:0,min:0,max:0,mid:0,count:0}};c.getDataValues=async function(d,G,T=!0){if(!G)return[];const {field:J,field2:Q,field3:P,fieldDelimiter:V,fieldInfos:l,timeZone:N}=d;var m=J&&l?.find(sa=>sa.name.toLowerCase()===J.toLowerCase());
const t=m?f.isTimeOnlyField(m):!1,M=m?x.isAnyDateField(m):!1,I=d.valueExpression,S=d.normalizationType,Z=d.normalizationField,ca=d.normalizationTotal,ja=[];m=d.viewInfoParams;let na=null,ta=null;if(I){if(!E){const {arcadeUtils:sa}=await D.loadArcade();E=sa}E.hasGeometryOperations(I)&&await E.enableGeometryOperations();na=E.createFunction(I);ta=m?E.getViewInfo({viewingMode:m.viewingMode,scale:m.scale,spatialReference:new n(m.spatialReference)}):null}d=d.fieldInfos;const ua=G[0]&&"declaredClass"in G[0]&&
"esri.Graphic"===G[0].declaredClass||!d?null:{fields:d};G.forEach(sa=>{var va=sa.attributes;if(I){var xa=E.createExecContext(ua?{...sa,layer:ua}:sa,ta,N);xa=E.executeFunction(na,xa)}else va&&(xa=va[J],Q?(xa=`${H.processNullValue(xa)}${V}${H.processNullValue(va[Q])}`,P&&(xa=`${xa}${V}${H.processNullValue(va[P])}`)):"string"===typeof xa&&T&&(M?xa=xa?(new Date(xa)).getTime():null:t&&(xa=xa?q(xa):null)));S&&"number"===typeof xa&&isFinite(xa)&&(va=va&&parseFloat(va[Z]),xa=H.getNormalizedValue(xa,S,va,
ca));ja.push(xa)});return ja};c.getRangeExpr=function(d,G,T){G=null!=G?d+" \x3e\x3d "+G:"";d=null!=T?d+" \x3c\x3d "+T:"";T="";return(T=G&&d?a(G,d):G||d)?"("+T+")":""};c.getSQLFilterForNormalization=function(d){const G=d.field,T=d.normalizationType;d=d.normalizationField;let J;if("field"===T)J="(NOT "+d+" \x3d 0)";else if("log"===T||"natural-log"===T||"square-root"===T)J=`(${G} > 0)`;return J};c.getSumOfAttributesExpr=function(d,G,T){const J=[],Q=[],P=[],V=[],l=[];d.forEach((t,M)=>{const I=t.field?
"field":"expression",S=t.field||t.valueExpression;t.field?(l.push(S),Q.push(`var ${I}${M} = Number($feature["${S}"]);`)):(J.push(`function getValueForExpr${M}() {\n  ${S} \n}`),Q.push(`var ${I}${M} = Number(getValueForExpr${M}());`));T||P.push(`${I}${M} = IIf(${I}${M} < 0, 0, ${I}${M});`);V.push(`${I}${M}`)});d="return sum;";const N=J.length?null:l.reduce((t,M)=>`${t} + ${M}`);let m=null;G||T?G?T||(d="return IIf(sum \x3e\x3d 0, sum, null);",N&&(m=`(( ${N} ) >= 0)`)):(d="return IIf(sum !\x3d 0, sum, null);",
N&&(m=`(( ${N} ) <> 0)`)):(d="return IIf(sum \x3e 0, sum, null);",N&&(m=`(( ${N} ) > 0)`));return{valueExpression:[J.length?J.join("\n"):"",Q.join("\n"),P.join("\n"),`var sum = ${V.join(" + ")};`,d].filter(Boolean).join("\n\n"),sqlExpression:N,sqlWhere:m}};c.mergeWhereClauses=a;c.quantizeFeatures=function(d,G,T,J){const Q=u.isWrappable(T)?u.getInfo(T):null,P=Q?Math.round((Q.valid[1]-Q.valid[0])/G.scale[0]):null;return d.map(V=>{const l=new v(V.geometry);g.quantizePoint(G,l,l,l.hasZ,l.hasM);if(Q){var N=
P??0,m=J[0];0>l.x?l.x+=N:l.x>m&&(l.x-=N)}V.geometry=l;return V})};c.timeOnlyToMilliseconds=q;c.verifyBasicFieldValidity=function(d,G,T){const J=r({layer:d,fields:G});if(J.length)return new A(T,"Unknown fields: "+J.join(", ")+". You can only use fields defined in the layer schema");d=z({layer:d,fields:G});if(d.length)return new A(T,"Unsupported fields: "+d.join(", ")+". You can only use fields that can be fetched i.e. AdapterFieldUsageInfo.supportsStatistics must be true")};c.verifyFieldType=function(d,
G,T,J){let Q;G?G.name!==d.objectIdField&&J.includes(G.type)||(Q=new A(T,"'field' should be one of these types: "+J.join(","))):Q=new A(T,"'field' is not defined in the layer schema");return Q};c.verifyFilterValidty=function(d,G){if(d&&"intersects"!==d.spatialRelationship)return new A(G,"Only 'intersects' spatialRelationship is supported for featureFilter")};c.verifyNumericField=function(d,G,T){let J;G?G.name!==d.objectIdField&&f.isNumericField(G)||(J=new A(T,"'field' should be one of these numeric types: "+
f.numericTypes.join(","))):J=new A(T,"'field' is not defined in the layer schema");return J};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/core/screenUtils":function(){define(["exports"],function(c){function e(w){return w?72*w/96:0}const A=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i;c.castRenderScreenPointArray=function(w){return w};c.castRenderScreenPointArray3=function(w){return w};c.castScreenPointArray=function(w){return w};c.createRenderScreenPoint=function(w=0,L=0){return{x:w,
y:L}};c.createRenderScreenPointArray=function(w=0,L=0){return[w,L]};c.createRenderScreenPointArray3=function(w=0,L=0,n=0){return[w,L,n]};c.createScreenPoint=function(w=0,L=0){return{x:w,y:L}};c.createScreenPointArray=function(w=0,L=0){return[w,L]};c.pt2px=function(w){return w?w/72*96:0};c.px2pt=e;c.screenPointArrayToObject=function(w,L){return L?(L.x=w[0],L.y=w[1],L):{x:w[0],y:w[1]}};c.screenPointObjectToArray=function(w,L){return L?(L[0]=w.x,L[1]=w.y,2<L.length&&(L[2]=0),L):[w.x,w.y]};c.toPt=function(w){if("string"===
typeof w){var L=w.match(A);if(L){var n=Number(L[1]);L=L[3]&&L[3].toLowerCase();w="-"===w.charAt(0);n="px"===L?e(n):n;return w?-n:n}console.warn("screenUtils.toPt: input not recognized!");return null}return w};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/core/timeUtils":function(){define(["exports","../intl/date","../time/timeZoneUtils","../chunks/datetime"],function(c,e,A,w){function L(u,f,p){return 0===u?0:u*g[f]/g[p]}function n(u){switch(u){case "milliseconds":return"millisecond";
case "seconds":return"second";case "minutes":return"minute";case "hours":return"hour";case "days":return"day";case "weeks":return"week";case "months":return"month";case "years":return"year"}}const g={milliseconds:1,seconds:1E3,minutes:6E4,hours:36E5,days:864E5,weeks:6048E5,months:26784E5,years:31536E6,decades:31536E7,centuries:31536E8};c.convertTime=L;c.isValidDate=function(u){return u instanceof Date&&!isNaN(u.getTime())};c.makeUTCTime=function(u,f,p="milliseconds"){f=new Date(L(f,p,"milliseconds"));
f.setUTCFullYear(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate());return f};c.mergeTimeExtents=function(u,f){return u&&f?u.intersection(f):u||f};c.millisecondsPerTimeUnit=g;c.offsetDate=function(u,f,p,x=A.system){x=new w.IANAZone(e.resolveTimeZone(x));u=w.DateTime.fromJSDate(u,{zone:x});x="decades"===p||"centuries"===p?"year":n(p);"decades"===p&&(f*=10);"centuries"===p&&(f*=100);return u.plus({[x]:f}).toJSDate()};c.offsetDateUTC=function(u,f,p="milliseconds"){u=u.getTime();f=L(f,p,"milliseconds");
return new Date(u+f)};c.resetUTCDate=function(u,f){u=new Date(u.getTime());u.setUTCFullYear(f.getFullYear(),f.getMonth(),f.getDate());return u};c.timeSinceUTCMidnight=function(u,f="milliseconds"){const p=L(u.getUTCHours(),"hours","milliseconds"),x=L(u.getUTCMinutes(),"minutes","milliseconds"),H=L(u.getUTCSeconds(),"seconds","milliseconds");u=u.getUTCMilliseconds();return L(p+x+H+u,"milliseconds",f)};c.truncateDate=function(u,f,p=A.system){p=new w.IANAZone(e.resolveTimeZone(p));u=w.DateTime.fromJSDate(u,
{zone:p});if("decades"===f||"centuries"===f)return u=u.startOf("year"),{year:p}=u,u.set({year:p-p%("decades"===f?10:100)}).toJSDate();f=n(f);return u.startOf(f).toJSDate()};c.truncateLocalTime=function(u){const f=new Date(0);f.setHours(0);f.setMinutes(0);f.setSeconds(0);f.setMilliseconds(0);f.setFullYear(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate());return f};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/heatmapUtils":function(){define(["exports","../../core/mathUtils",
"../../core/screenUtils","../../chunks/vec4","../../chunks/vec4f64"],function(c,e,A,w,L){function n(p,x,H,D){let {color:v,ratio:q}=x,{color:a,ratio:r}=H;r===q&&(1===r?q-=1E-6:r+=1E-6);x=e.clamp((D-q)/(r-q),0,1);w.lerp(p,v.toArray(),a.toArray(),x)}function g(p,x,H,D,v){p=new Uint32Array(p*p);x="buffer"in x?x:new Float64Array(x);H="buffer"in H?new Uint32Array(H.buffer):new Uint32Array((new Uint8Array(H)).buffer);v=H.length/(v-D);for(let q=0;q<x.length;q++)p[q]=H[e.clamp(Math.floor((x[q]-D)*v),0,H.length-
1)];return p.buffer}function u(p,x,H){p=Math.sqrt(p**2+x**2)/H;return 1<p?0:3/(Math.PI*H**2)*(1-p**2)**2}function f(p,x){return null!=p?"string"===typeof x?H=>-1*+H.readAttribute(p):H=>+H.readAttribute(p)+x:H=>1}c.calculateHeatmapIntensityInfoReaders=function(p,x,H,D){const {radius:v,fieldOffset:q,field:a}=x;x=Math.round(A.pt2px(v));const r=new Float64Array(H*D);let z=Number.NEGATIVE_INFINITY;const E=f(a,q),R=new Set;for(const J of p)for(p=J.getCursor();p.next();){var d=p.getObjectId();if(R.has(d))continue;
R.add(d);d=p.readLegacyPointGeometry();if(-128>d.x||d.x>=H+128||-128>d.y||d.y>D+128)continue;const Q=+E(p),P=Math.max(0,Math.round(d.x)-x);var G=Math.max(0,Math.round(d.y)-x);const V=Math.min(D,Math.round(d.y)+x),l=Math.min(H,Math.round(d.x)+x);for(;G<V;G++)for(let N=P;N<l;N++){var T=G*H+N;const m=u(d.x-N,d.y-G,x);T=r[T]+=m*Q;T>z&&(z=T)}}return{matrix:r.buffer,max:z}};c.createHeatmapImageData=g;c.createValueFunction=function(p,x){return"function"===typeof p?p:p?"string"===typeof x?H=>-1*+H[p]:H=>
+H[p]+x:()=>1};c.createValueFunctionCursor=f;c.drawHeatmap=function(p,x,H,D,v,q){p.canvas.width=p.canvas.height=x;p.clearRect(0,0,x,x);const a=p.getImageData(0,0,x,x);H&&D&&a.data.set(new Uint8ClampedArray(g(x,H,D,v,q)));p.putImageData(a,0,0)};c.evaluateDensityKernel=u;c.gaussianBlurRadiusPxToKernelDensityRadiusPt=function(p){return A.px2pt(2.4*p)};c.generateGradient=function(p){const x=new Uint8ClampedArray(2048);p=p.filter(({ratio:a})=>0<=a&&1>=a).sort((a,r)=>a.ratio-r.ratio).map(({color:a,ratio:r})=>
({color:a,ratio:Math.max(r,.001)}));if(1>p.length)return x;let H=p[0],D=p[0],v=1;const q=L.create();for(let a=0;512>a;a++){const r=(a+.5)/512;for(;r>D.ratio&&v<p.length;)H=D,D=p[v++];n(q,H,D,r);x.set(q,4*a)}return x};c.kernelDensityRadiusPtToGaussianBlurRadiusPx=function(p){return A.pt2px(p)/2.4};c.magicKernelDensityRadiusInflationFactor=2.4;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/smartMapping/support/utils":function(){define("exports ../../intl/date ../../layers/support/fieldUtils ../../support/arcadeOnDemand ../../support/basemapUtils ../../time/timeZoneUtils".split(" "),
function(c,e,A,w,L,n){function g(v){return String(v).padStart(2,"0")}function u(v,q,a){if("date"===q||"number"===q){"number"===q&&(v=new Date(v));q=a?v.getFullYear():v.getUTCFullYear();const r=g((a?v.getMonth():v.getUTCMonth())+1),z=g(a?v.getDate():v.getUTCDate()),E=g(a?v.getHours():v.getUTCHours()),R=g(a?v.getMinutes():v.getUTCMinutes());v=g(a?v.getSeconds():v.getUTCSeconds());v=`TIMESTAMP'${q}-${r}-${z} ${E}:${R}:${v}'`}return v}function f(v,q){if(q instanceof Date)return"date";if("number"===typeof q)return"number";
if("string"===typeof q&&(v=v.getField(q),"\x3cnow\x3e"!==q.toLowerCase()&&A.isDateField(v)))return"field"}const p={light:"streets gray topo terrain oceans osm gray-vector streets-vector topo-vector streets-relief-vector streets-navigation-vector topo-3d navigation-3d arcgis-light-gray arcgis-navigation arcgis-streets arcgis-streets-relief arcgis-topographic arcgis-oceans osm-standard osm-standard-relief osm-streets osm-streets-relief osm-light-gray arcgis-terrain arcgis-charted-territory arcgis-community arcgis-colored-pencil arcgis-modern-antique arcgis-midcentury arcgis-newspaper arcgis-hillshade-light".split(" "),
dark:"satellite hybrid dark-gray dark-gray-vector streets-night-vector navigation-dark-3d arcgis-imagery arcgis-imagery-standard arcgis-dark-gray arcgis-navigation-night arcgis-streets-night osm-dark-gray arcgis-nova arcgis-hillshade-dark".split(" ")},x={years:365,months:30,days:1,hours:1/24,minutes:1/1440,seconds:1/86400,milliseconds:1/864E5},H=new Set(["integer","small-integer"]);let D=null;c.castIntegerFieldToFloat=function(v){return`cast(${v} as float)`};c.dateTypes=["date","date-only","timestamp-offset"];
c.defaultBasemapGroups=p;c.fieldDelimiter=",";c.formatAnyDate=function(v,q){const {format:a,timeZoneOptions:r,fieldType:z}=q??{};let E;r&&({timeZone:R,timeZoneName:E}=n.getTimeZoneFormattingOptions(r.layerTimeZone,r.datesInUnknownTimezone,r.viewTimeZone,e.convertDateFormatToIntlOptions(a||"short-date-short-time"),z));if("string"===typeof v&&isNaN(Date.parse("time-only"===z?`1970-01-01T${v}Z`:v)))return v;switch(z){case "date-only":var R=e.convertDateFormatToIntlOptions(a||"short-date");return"string"===
typeof v?e.formatDateOnly(v,{...R}):e.formatDate(v,{...R,timeZone:n.utc});case "time-only":return R=e.convertDateFormatToIntlOptions(a||"short-time"),"string"===typeof v?e.formatTimeOnly(v,R):e.formatDate(v,{...R,timeZone:n.utc});case "timestamp-offset":if(!R&&"string"===typeof v&&(new Date(v)).toISOString()!==v)return v;R=(q=a||r?e.convertDateFormatToIntlOptions(a||"short-date-short-time"):void 0)?{...q,timeZone:R,timeZoneName:E}:void 0;return"string"===typeof v?e.formatTimestamp(v,R):e.formatDate(v,
R);default:return q=a||r?e.convertDateFormatToIntlOptions(a||"short-date-short-time"):void 0,e.formatDate("string"===typeof v?new Date(v):v,q?{...q,timeZone:R,timeZoneName:E}:void 0)}};c.getBasemapGroup=function(v,q=p){for(const a in q)if(q[a].includes(v))return a};c.getBasemapId=function(v,q,a=!0){let r=null;v&&("string"===typeof v?q.includes(v)&&(r=v):r=L.getWellKnownBasemapId(v));return a?r||"gray":r};c.getDateDiffSQL=function(v,q,a,r){const {hasQueryEngine:z}=v;a=u(a,f(v,a),z);v=u(q,f(v,q),z);
v=`(${a} - ${v})`;r=x[r];q="/";1>r&&(r=1/r,q="*");return{sqlExpression:1===r?v:`(${v} ${q} ${r})`,sqlWhere:null}};c.getDateType=f;c.getFieldsList=async function(v){const {field:q,field2:a,field3:r,normalizationField:z,valueExpression:E}=v;v=[];E&&(D||({arcadeUtils:v}=await w.loadArcade(),D=v),v=D.extractFieldNames(E));q&&v.push(q);a&&v.push(a);r&&v.push(r);z&&v.push(z);return v};c.getNormalizationType=function(v){let q=v.normalizationType;q||(v.normalizationField?q="field":null!=v.normalizationTotal&&
(q="percent-of-total"));return q??void 0};c.isAnyDateField=function(v){return A.isDateField(v)||A.isDateOnlyField(v)||A.isTimestampOffsetField(v)};c.isIntegerField=function(v,q){v=q&&v.getField(q);return!!v&&H.has(v.type)};c.unitValueInDays=x;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/support/basemapUtils":function(){define("exports ../Basemap ../config ../core/Collection ../core/Logger ../core/maybe ../core/urlUtils ../core/accessorSupport/ensureType ../layers/effects/utils ./basemapDefinitions".split(" "),
function(c,e,A,w,L,n,g,u,f,p){function x(m,t){let M;if("string"===typeof m){const I=m in p.esriBasemapDefinitions,S=!I&&m.includes("/");if(!I&&!S)return t=Object.entries(p.esriBasemapDefinitions).filter(([,Z])=>A.apiKey&&!Z.classic||!A.apiKey&&(Z.classic||Z.is3d)).map(([Z])=>`"${Z}"`).sort().join(", "),V.warn(`Unable to find basemap definition for: ${m}. Try one of these: ${t}`),null;t&&(M=t[m]);M||(M=I?e.fromId(m):new e({style:{id:m}}),t&&(t[m]=M))}else M=u.ensureType(e,m);M?.destroyed&&(V.warn("The provided basemap is already destroyed",
{basemap:M}),M=null);return M}function H(m){if(l)return l(m);let t=null;m=a(m);const M=!m?.baseLayers.length;for(const S in p.esriBasemapDefinitions){var I=R(p.esriBasemapDefinitions[S]);I=G(m,I,{mustMatchReferences:M});if("equal"===I){t=S;break}"base-layers-equal"===I&&(t=S)}return t}function D(m,t){const M=new w;m.forEach(I=>{const S=t.find(Z=>"scene"!==Z.type&&J(z(I),z(Z)))||I;M.includes(S)?M.push(I):M.push(S)});return M}function v(m){if(q(m.url))return!0;if("vector-tile"===m.type)for(const t in m.sourceNameToSource)if(q(m.sourceNameToSource[t]?.sourceUrl))return!0;
return!1}function q(m){if(!m)return!1;m=new g.Url(g.makeAbsolute(m));return!!m.authority&&N.test(m.authority)}function a(m){return m?!m.loaded&&m.resourceInfo?R(m.resourceInfo.data):{baseLayers:r(m.baseLayers),referenceLayers:r(m.referenceLayers)}:null}function r(m){return(w.isCollection(m)?m.toArray():m).map(z)}function z(m){return{type:m.type,effect:"effect"in m?m.effect:void 0,url:Q("urlTemplate"in m&&m.urlTemplate||m.url||"styleUrl"in m&&m.styleUrl||""),minScale:"minScale"in m&&null!=m.minScale?
m.minScale:0,maxScale:"maxScale"in m&&null!=m.maxScale?m.maxScale:0,opacity:null!=m.opacity?m.opacity:1,visible:null!=m.visible?!!m.visible:!0,sublayers:"map-image"!==m.type&&"wms"!==m.type||null==m.sublayers?void 0:m.sublayers?.map(t=>({id:t.id,visible:t.visible})),activeLayerId:"wmts"===m.type?m.activeLayer?.id:void 0}}function E(m){return m.isReference||"ArcGISSceneServiceLayer"===m.layerType}function R(m){return m?{baseLayers:d((m.baseMapLayers??[]).filter(t=>!E(t))),referenceLayers:d((m.baseMapLayers??
[]).filter(t=>E(t)))}:null}function d(m){return m.map(t=>{let M;switch(t.layerType){case "VectorTileLayer":M="vector-tile";break;case "ArcGISTiledMapServiceLayer":M="tile";break;case "ArcGISSceneServiceLayer":M="scene";break;default:M="unknown"}return{type:M,effect:t.effect,url:Q(t.templateUrl||t.urlTemplate||t.styleUrl||t.url),minScale:t.minScale??0,maxScale:t.maxScale??0,opacity:t.opacity??1,visible:null!=t.visibility?!!t.visibility:!0,sublayers:void 0,activeLayerId:void 0}})}function G(m,t,M){return null!=
m!==(null!=t)?"not-equal":m&&t?T(m.baseLayers,t.baseLayers)?T(m.referenceLayers,t.referenceLayers)?"equal":M.mustMatchReferences?"not-equal":"base-layers-equal":"not-equal":"equal"}function T(m,t){if(m.length!==t.length)return!1;for(let M=0;M<m.length;M++)if(!J(m[M],t[M]))return!1;return!0}function J(m,t){if(m.type!==t.type||m.url!==t.url||m.minScale!==t.minScale||m.maxScale!==t.maxScale||m.visible!==t.visible||m.opacity!==t.opacity||!f.effectEquals(m.effect,t.effect))return!1;if(null!=m.activeLayerId||
null!=t.activeLayerId)return m.activeLayerId===t.activeLayerId;if(null!=m.sublayers||null!=t.sublayers){if(null==m.sublayers||null==t.sublayers||m.sublayers.length!==t.sublayers.length)return!1;for(let M=0;M<m.sublayers.length;M++){const I=m.sublayers.at(M),S=t.sublayers.at(M);if(I?.id!==S?.id||I?.visible!==S?.visible)return!1}}return!0}function Q(m){return m?g.normalize(m).replace(/^\s*https?:/i,"").toLowerCase():""}function P(m){return"portalItem"in m?m.portalItem?.thumbnailUrl:void 0}const V=L.getLogger("esri.support.basemapUtils");
let l;const N=/^(basemaps|ibasemaps).*-api\.arcgis\.com$/i;c.clonePreservingTiledLayers=function(m,t=null){m=x(m);if(!m)return null;m=m.clone();t&&(m.baseLayers=D(m.baseLayers,t.baseLayers),m.referenceLayers=D(m.referenceLayers,t.referenceLayers));return m};c.contentEquals=function(m,t){if(m===t||null!=m?.portalItem?.id&&m.portalItem.id===t?.portalItem?.id)return!0;m=a(m);t=a(t);return"equal"===G(m,t,{mustMatchReferences:!0})};c.createCache=function(){return{}};c.destroyCache=function(m){for(const t in m)n.destroyMaybe(m[t]),
delete m[t]};c.ensureType=x;c.findSpatialReference=function(m,t){if(null==t||null==m)return{spatialReference:null,updating:!1};if("not-loaded"===t.loadStatus)return t.load(),{spatialReference:null,updating:!0};if(t.spatialReference)return{spatialReference:t.spatialReference,updating:!1};if(0===t.baseLayers.length)return{spatialReference:null,updating:!1};t=t.baseLayers.at(0);switch(t.loadStatus){case "not-loaded":t.load();case "loading":return{spatialReference:null,updating:!0};case "failed":return{spatialReference:null,
updating:!1}}t=(("supportedSpatialReferences"in t?t.supportedSpatialReferences:null)||["tileInfo"in t?t.tileInfo?.spatialReference:t.spatialReference]).filter(Boolean);const M=m.spatialReference;return M?{spatialReference:t.find(I=>M.equals(I))??t[0]??null,updating:!1}:{spatialReference:t[0],updating:!1}};c.getBasemapThumbnailUrl=function(m){if(!m)return null;var {thumbnailUrl:t}=m;return t?t:(t=H(m))?p.esriBasemapDefinitions[t].thumbnailUrl:n.mappedFind(m.baseLayers,P)};c.getWellKnownBasemapId=H;
c.hasDeveloperBasemapLayer=function(m){return!!m?.baseLayers.concat(m.referenceLayers).some(v)};c.isBasemap3D=function(m){return"Web Scene"===m.portalItem?.type};c.isBasemapInBeta=function(m){return!!m?.portalItem?.tags?.some(t=>"beta"===t.toLowerCase())};c.isBasemapLayer=function(m,t){return m.basemap?.referenceLayers?.some(M=>M.uid===t)||m.basemap?.baseLayers?.some(M=>M.uid===t)};c.isDeveloperBasemapLayer=v;c.overrideGetWellKnownBasemapId=function(m){l=m};Object.defineProperty(c,Symbol.toStringTag,
{value:"Module"})})},"esri/Basemap":function(){define("require ./chunks/tslib.es6 ./request ./core/Collection ./core/collectionUtils ./core/JSONSupport ./core/lang ./core/Loadable ./core/loadAll ./core/Logger ./core/maybe ./core/promiseUtils ./core/urlUtils ./core/accessorSupport/decorators/property ./core/accessorSupport/ensureType ./core/accessorSupport/decorators/subclass ./core/accessorSupport/decorators/writer ./geometry/SpatialReference ./portal/Portal ./portal/PortalItem ./support/basemapDefinitions ./support/BasemapStyle ./webdoc/support/writeUtils".split(" "),
function(c,e,A,w,L,n,g,u,f,p,x,H,D,v,q,a,r,z,E,R,d,G,T){var J;let Q=0;n=J=class extends n.JSONSupportMixin(u){constructor(l){super(l);this.thumbnailUrl=this.style=this.spatialReference=this.portalItem=this.id=null;this.title="Basemap";this.id=Date.now().toString(16)+"-basemap-"+Q++;this.baseLayers=new w;this.referenceLayers=new w;const N=m=>{m.parent&&m.parent!==this&&"remove"in m.parent&&m.parent.remove(m);m.parent=this;"elevation"===m.type&&p.getLogger(this).error(`Layer '${m.title}, id:${m.id}' of type '${m.type}' is not supported as a basemap layer and will therefore be ignored.`)};
this.addHandles([this.baseLayers.on("after-add",m=>N(m.item)),this.referenceLayers.on("after-add",m=>N(m.item)),this.baseLayers.on("after-remove",m=>{m.item.parent=null}),this.referenceLayers.on("after-remove",m=>{m.item.parent=null})])}initialize(){this.when().catch(l=>{p.getLogger(this).error("#load()",`Failed to load basemap (title: '${this.title}', id: '${this.id}')`,l)});this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){var l=this.baseLayers.toArray();for(const N of l)N.destroy();
l=this.referenceLayers.toArray();for(const N of l)N.destroy();this.baseLayers.destroy();this.referenceLayers.destroy();this.portalItem=x.destroyMaybe(this.portalItem)}normalizeCtorArgs(l){l&&"resourceInfo"in l&&(this._set("resourceInfo",l.resourceInfo),l={...l},delete l.resourceInfo);return l}set baseLayers(l){this._set("baseLayers",L.referenceSetter(l,this._get("baseLayers")))}_writeBaseLayers(l,N,m){const t=[];l&&(m={...m,layerContainerType:"basemap"},this.baseLayers.forEach(M=>{M=T.getLayerJSON(M,
m.webmap?m.webmap.getLayerJSONFromResourceInfo(M):null,m);null!=M&&t.push(M)}),this.referenceLayers.forEach(M=>{const I=T.getLayerJSON(M,m.webmap?m.webmap.getLayerJSONFromResourceInfo(M):null,m);null!=I&&("scene"!==M.type&&(I.isReference=!0),t.push(I))}));N.baseMapLayers=t}set referenceLayers(l){this._set("referenceLayers",L.referenceSetter(l,this._get("referenceLayers")))}writeTitle(l,N){N.title=l||"Basemap"}load(l){this.addResolvingPromise(this._loadFromSource(l));return Promise.resolve(this)}loadAll(){return f.loadAll(this,
l=>{l(this.baseLayers,this.referenceLayers)})}clone(){const l={id:this.id,title:this.title,portalItem:this.portalItem,baseLayers:this.baseLayers.map(N=>g.isClonable(N)?N.clone():N),referenceLayers:this.referenceLayers.map(N=>g.isClonable(N)?N.clone():N)};this.loaded&&(l.loadStatus="loaded");return(new J({resourceInfo:this.resourceInfo})).set(l)}read(l,N){this.resourceInfo||this._set("resourceInfo",{data:l,context:N});super.read(l,N)}write(l,N){l=l||{};N?.origin||(N={origin:"web-map",...N});super.write(l,
N);!this.loaded&&this.resourceInfo?.data.baseMapLayers&&(l.baseMapLayers=this.resourceInfo.data.baseMapLayers.map(m=>{m=g.clone(m);m.url&&D.isProtocolRelative(m.url)&&(m.url=`https:${m.url}`);m.templateUrl&&D.isProtocolRelative(m.templateUrl)&&(m.templateUrl=`https:${m.templateUrl}`);return m}));return l}async _loadFromSource(l){const {resourceInfo:N,portalItem:m,style:t}=this;H.throwIfAborted(l);const M=[];N?(M.push(this._loadLayersFromJSON(N.data,N.context?N.context.url:null,l)),N.data.id&&!N.data.title&&
M.push(d.getBasemapTitle(N.data.id).then(I=>{I&&this.read({title:I},N.context)}))):m?M.push(this._loadFromItem(m,l)):t&&M.push(this._loadFromStylesService(t,l));await Promise.all(M)}async _loadLayersFromJSON(l,N,m){const t=this.resourceInfo?.context,M=this.portalItem?.portal||t?.portal||null,I=V[t?.origin||""]??"web-map",{populateOperationalLayers:S}=await new Promise((ca,ja)=>c(["./layers/support/layersCreator"],ca,ja)),Z=[];H.throwIfAborted(m);if(l.baseMapLayers&&Array.isArray(l.baseMapLayers)){N=
{context:{...t,origin:I,url:N,portal:M,layerContainerType:"basemap"},defaultLayerType:"DefaultTileLayer"};const ca=ja=>"web-scene"===I&&"ArcGISSceneServiceLayer"===ja.layerType||ja.isReference;m=S(this.baseLayers,l.baseMapLayers.filter(ja=>!ca(ja)),N);Z.push(m);l=S(this.referenceLayers,l.baseMapLayers.filter(ca),N);Z.push(l)}await Promise.allSettled(Z)}async _loadFromItem(l,N){const m=await (await l.load(N)).fetchData("json",N),t=D.urlToObject(l.itemUrl??"");this._set("resourceInfo",{data:m.baseMap??
{},context:{origin:P[l.type||""]??"web-map",portal:l.portal||E.getDefault(),url:t}});this.read(this.resourceInfo.data,this.resourceInfo.context);this.read({spatialReference:m.spatialReference},this.resourceInfo.context);this.read({title:l.title,thumbnailUrl:l.thumbnailUrl},{origin:"portal-item",portal:l.portal||E.getDefault(),url:t});return this._loadLayersFromJSON(this.resourceInfo.data,t,N)}async _loadFromStylesService(l,N){var m=`${l.serviceUrl}/${l.id}`;l=(await A(m,{query:{language:l.getLanguageParamValue()},
signal:N?.signal})).data;if(l.baseMap&&Array.isArray(l.baseMap.baseMapLayers))for(const t of l.baseMap.baseMapLayers)if(!t.customParameters&&t.styleUrl?.includes("?")){const M=D.urlToObject(t.styleUrl);M.query&&(t.styleUrl=M.path,t.customParameters=M.query)}m=D.urlToObject(m);this._set("resourceInfo",{data:l.baseMap??{},context:{origin:"web-map",url:m}});this.read(this.resourceInfo.data,this.resourceInfo.context);this.read({spatialReference:l.spatialReference},this.resourceInfo.context);return this._loadLayersFromJSON(this.resourceInfo.data,
m,N)}static fromId(l){return(l=d.esriBasemapDefinitions[l])?l.itemId?new J({portalItem:{id:l.itemId,portal:{url:"https://www.arcgis.com"}}}):J.fromJSON(l,{origin:l.is3d?"web-scene":"web-map"}):null}};e.__decorate([v.property({json:{write:{ignoreOrigin:!0,target:"baseMapLayers",writer(l,N,m,t){this._writeBaseLayers(l,N,t)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{baseMapLayers:{type:w}},writer(l,N,m,t){this._writeBaseLayers(l,N,t)}}}}}})],n.prototype,"baseLayers",null);e.__decorate([v.property({type:String,
json:{origins:{"web-scene":{write:!0}}}})],n.prototype,"id",void 0);e.__decorate([v.property({type:R})],n.prototype,"portalItem",void 0);e.__decorate([v.property()],n.prototype,"referenceLayers",null);e.__decorate([v.property({readOnly:!0})],n.prototype,"resourceInfo",void 0);e.__decorate([v.property({type:z})],n.prototype,"spatialReference",void 0);e.__decorate([v.property({type:G})],n.prototype,"style",void 0);e.__decorate([v.property()],n.prototype,"thumbnailUrl",void 0);e.__decorate([v.property({type:String,
json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],n.prototype,"title",void 0);e.__decorate([r.writer("title")],n.prototype,"writeTitle",null);n=J=e.__decorate([a.subclass("esri.Basemap")],n);const P={"Web Scene":"web-scene","Web Map":"web-map","Link Chart":"link-chart"},V={"web-scene":"web-scene","web-map":"web-map","link-chart":"link-chart"};return n})},"esri/core/collectionUtils":function(){define(["exports","./Collection"],function(c,e){c.castForReferenceSetter=function(A){return A};c.referenceSetter=
function(A,w,L=e){w||(w=new L);if(w===A)return w;w.removeAll();A&&(Array.isArray(A)||"items"in A&&Array.isArray(A.items))?w.addMany(A):A&&w.add(A);return w};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/core/Loadable":function(){define("../chunks/tslib.es6 ./Error ./maybe ./Promise ./promiseUtils ./Warning ./accessorSupport/decorators/property ./accessorSupport/decorators/subclass".split(" "),function(c,e,A,w,L,n,g,u){const f=p=>{p=class extends p{constructor(...x){super(...x);
this.loadError=this._loadController=null;this.loadStatus="not-loaded";this._set("loadWarnings",[]);this.addResolvingPromise(new Promise(H=>{const D=this.load.bind(this);this.load=v=>{const q=new Promise((a,r)=>{const z=L.onAbortOrThrow(v,r);this.destroyed&&r(new e("load:instance-destroyed",`Instance of '${this.declaredClass||this.constructor.name}' is already destroyed`,{instance:this}));this.when(a,r).finally(()=>{z&&z.remove()})});if("not-loaded"===this.loadStatus){this._set("loadStatus","loading");
const a=this._loadController=new AbortController;D({signal:a.signal})}H();return q}}));this.when(()=>{this._set("loadStatus","loaded");this._loadController=null},H=>{this._set("loadStatus","failed");this._set("loadError",H);this._loadController=null})}destroy(){this._loadController&&(this._loadController=A.abortMaybe(this._loadController),this._promiseProps.abort());this._set("loadError",null);this._set("loadWarnings",[])}get loaded(){return"loaded"===this.loadStatus}get loadWarnings(){return this._get("loadWarnings")}load(){return null}cancelLoad(){if(this.isFulfilled())return this;
this._set("loadError",new e("load:cancelled","Cancelled"));this._loadController?.abort();this._promiseProps.abort();return this}};c.__decorate([g.property({readOnly:!0})],p.prototype,"loaded",null);c.__decorate([g.property({readOnly:!0})],p.prototype,"loadError",void 0);c.__decorate([g.property({clonable:!1})],p.prototype,"loadStatus",void 0);c.__decorate([g.property({type:[n],readOnly:!0})],p.prototype,"loadWarnings",null);return p=c.__decorate([u.subclass("esri.core.Loadable")],p)};w=class extends f(w.EsriPromise){};
w=c.__decorate([u.subclass("esri.core.Loadable")],w);(function(p){p.LoadableMixin=f;p.isLoadable=function(x){return!(!x||!x.load)}})(w||(w={}));return w})},"esri/core/Promise":function(){define(["exports","../chunks/tslib.es6","./Accessor","./promiseUtils","./accessorSupport/decorators/subclass"],function(c,e,A,w,L){var n;(function(f){f[f.PENDING=0]="PENDING";f[f.RESOLVED=1]="RESOLVED";f[f.REJECTED=2]="REJECTED"})(n||(n={}));class g{constructor(){this._resolver=w.createResolver();this._status=n.PENDING;
this._resolvingPromises=[];this._resolver.promise.then(()=>{this._status=n.RESOLVED;this._cleanUp()},()=>{this._status=n.REJECTED;this._cleanUp()});this.promise=this._resolver.promise}destroy(){this._cleanUp()}addResolvingPromise(f){this._resolvingPromises.push(f);this._tryResolve()}isResolved(){return this._status===n.RESOLVED}isRejected(){return this._status===n.REJECTED}isFulfilled(){return this._status!==n.PENDING}abort(){this._resolver.reject(w.createAbortError())}_cleanUp(){this._resolvingPromises=
this._allPromise=null}_tryResolve(){if(!this.isFulfilled()){var f=w.createResolver(),p=[...this._resolvingPromises,f.promise],x=this._allPromise=Promise.all(p);x.then(()=>{this.isFulfilled()||this._allPromise!==x||this._resolver.resolve()},H=>{this.isFulfilled()||this._allPromise!==x||w.isAbortError(H)||this._resolver.reject(H)});f.resolve()}}}const u=f=>{f=class extends f{constructor(...p){super(...p);this._promiseProps=new g;this.addResolvingPromise(Promise.resolve())}destroy(){this._promiseProps.destroy()}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(p,
x){return this._promiseProps.promise.then(()=>this).then(p,x)}catch(p){return this.when(null,p)}addResolvingPromise(p){p&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in p?p.when():p)}};return f=e.__decorate([L.subclass("esri.core.Promise")],f)};c.EsriPromise=class extends u(A){};c.EsriPromise=e.__decorate([L.subclass("esri.core.Promise")],c.EsriPromise);c.EsriPromiseMixin=u;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/core/loadAll":function(){define(["exports",
"./asyncUtils","./Collection","./Loadable"],function(c,e,A,w){async function L(n,g){const u=[],f=(...x)=>{for(const H of x)null!=H&&(Array.isArray(H)?f(...H):A.isCollection(H)?H.forEach(D=>f(D)):w.isLoadable(H)&&u.push(H))};g(f);let p=null;await e.map(u,async x=>{x=await e.result("loadAll"in x&&"function"===typeof x.loadAll?x.loadAll():x.load());!1!==x.ok||p||(p=x)});if(p)throw p.error;return n}c.loadAll=async function(n,g){await n.load();return L(n,g)};c.loadAllChildren=L;Object.defineProperty(c,
Symbol.toStringTag,{value:"Module"})})},"esri/portal/Portal":function(){define("require ../chunks/tslib.es6 ../config ../kernel ../request ../core/Error ../core/JSONSupport ../core/Loadable ../core/maybe ../core/promiseUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../geometry/Extent ../intl/locale ./portalDefault ./PortalGroup ./PortalQueryParams ./PortalQueryResult ./PortalUser ../support/apiKeyUtils".split(" "),
function(c,e,A,w,L,n,g,u,f,p,x,H,D,v,q,a,r,z,E,R,d,G,T,J){function Q(t){const M=w.id;return()=>{const I=t.deref();I&&M.findCredential(I.restUrl)&&I.signIn().catch(()=>{})}}const P=t=>Object.freeze(Object.defineProperty({__proto__:null,default:t},Symbol.toStringTag,{value:"Module"}));var V;let l;const N={PortalGroup:()=>Promise.resolve({default:R}),PortalItem:()=>new Promise((t,M)=>c(["./PortalItem"],I=>t(P(I)),M)),PortalUser:()=>Promise.resolve({default:T})};g=V=class extends g.JSONSupportMixin(u){constructor(t){super(t);
this.access=this._esriIdCredentialCreateHandle=null;this.allSSL=!1;this.authMode="auto";this.bingKey=this.basemapGalleryGroupQuery3D=this.basemapGalleryGroupQuery=this.authorizedCrossOriginDomains=null;this.canProvisionDirectPurchase=this.canListPreProvisionedItems=this.canListData=this.canListApps=!1;this.canSearchPublic=!0;this.canSignInIDP=this.canSignInArcGIS=this.canSharePublic=this.canShareBingPublic=!1;this.colorSetsGroupQuery=null;this.commentsEnabled=!1;this.livingAtlasGroupQuery=this.galleryTemplatesGroupQuery=
this.featuredItemsGroupQuery=this.featuredGroups=this.eueiEnabled=this.devBasemapGalleryGroupQuery=this.description=this.defaultVectorBasemap=this.defaultExtent=this.defaultDevBasemap=this.defaultBasemap=this.customBaseUrl=this.culture=this.created=null;this.hasCategorySchema=!1;this.ipCntryCode=this.id=this.httpsPort=this.httpPort=this.homePageFeaturedContentCount=this.homePageFeaturedContent=this.helperServices=null;this.isReadOnly=this.isPortal=!1;this.rotatorPanels=this.region=this.portalProperties=
this.portalMode=this.portalHostname=this.name=this.modified=this.maxTokenExpirationMinutes=this.layerTemplatesGroupQuery=null;this.showHomePageDescription=!1;this.sourceJSON=null;this.supportsHostedServices=!1;this.units=this.templatesGroupQuery=this.symbolSetsGroupQuery=null;this.url=A.portalUrl;this.user=this.urlKey=null;this.use3dBasemaps=!0;this.useVectorBasemaps=this.useStandardizedQuery=!1;this.vectorBasemapGalleryGroupQuery=null}normalizeCtorArgs(t){return"string"===typeof t?{url:t}:t}destroy(){m.unregister(this);
this.defaultBasemap=f.destroyMaybe(this.defaultBasemap);this.defaultDevBasemap=f.destroyMaybe(this.defaultDevBasemap);this.defaultVectorBasemap=f.destroyMaybe(this.defaultVectorBasemap);this._esriIdCredentialCreateHandle=f.removeMaybe(this._esriIdCredentialCreateHandle)}readAuthorizedCrossOriginDomains(t){if(t)for(const M of t)A.request.trustedServers.includes(M)||A.request.trustedServers.push(M);return t}readDefaultBasemap(t){return this._readBasemap(t)}readDefaultDevBasemap(t){return this._readBasemap(t)}readDefaultVectorBasemap(t){return this._readBasemap(t)}get extraQuery(){const t=
!this.user?.orgId||this.canSearchPublic;return this.id&&!t?` AND orgid:${this.id}`:null}get isOrganization(){return!!this.access}get itemPageUrl(){return this.url?`${this.url}/home/item.html`:null}get restUrl(){let t=this.url;if(t){const M=t.indexOf("/sharing");t=0<M?t.substring(0,M):this.url.replace(/\/+$/,"");t+="/sharing/rest"}return t}get thumbnailUrl(){const t=this.restUrl,M=this.thumbnail;return t&&M?this._normalizeSSL(t+"/portals/self/resources/"+M):null}readUrlKey(t){return t?t.toLowerCase():
t}readUser(t){let M=null;t&&(M=T.fromJSON(t),M.portal=this);return M}load(t){const M=(new Promise((I,S)=>c(["../Basemap"],Z=>I(P(Z)),S))).then(({default:I})=>{p.throwIfAborted(t);l=I}).then(()=>this.sourceJSON?this.sourceJSON:this.fetchSelf(this.authMode,!1,t)).then(I=>{if(w.id){const S=w.id;this.credential=S.findCredential(this.restUrl);this.credential||this.authMode!==V.AUTH_MODE_AUTO||(this._esriIdCredentialCreateHandle?.remove(),this._esriIdCredentialCreateHandle=S.on("credential-create",Q(new WeakRef(this))),
m.register(this,this._esriIdCredentialCreateHandle,this))}this.sourceJSON=I;this.read(I)});this.addResolvingPromise(M);return Promise.resolve(this)}async createElevationLayers(){await this.load();const t=this._getHelperService("defaultElevationLayers"),M=(await new Promise((I,S)=>c(["../layers/ElevationLayer"],Z=>I(P(Z)),S))).default;return t?t.map(I=>new M({id:I.id,url:I.url})):[]}async fetchBasemaps(t,M){const I=await this._fetchBasemaps(t,M);!0===M?.include3d&&!1!==this.use3dBasemaps&&(t=await this._fetchBasemaps3D(t,
M),I.unshift(...t));return I}fetchCategorySchema(t){return this.hasCategorySchema?this.request(this.restUrl+"/portals/self/categorySchema",t).then(M=>M.categorySchema):p.isAborted(t)?Promise.reject(p.createAbortError()):Promise.resolve([])}fetchFeaturedGroups(t){const M=this.featuredGroups,I=new d;I.num=100;I.sortField="title";if(M&&M.length){const S=[];for(const Z of M)S.push(`(title:"${Z.title}" AND owner:${Z.owner})`);I.query=S.join(" OR ");return this.queryGroups(I,t).then(Z=>Z.results)}return p.isAborted(t)?
Promise.reject(p.createAbortError()):Promise.resolve([])}fetchRegions(t){const M=this.user?.culture||this.culture||z.getLocale();return this.request(this.restUrl+"/portals/regions",{...t,query:{culture:M}})}fetchSettings(t){const M=this.user?.culture||this.culture||z.getLocale();return this.request(this.restUrl+"/portals/self/settings",{...t,query:{culture:M}})}static getDefault(){return E.ensureDefaultPortalInstance(()=>new V)}queryGroups(t,M){return this.queryPortal("/community/groups",t,"PortalGroup",
M)}queryItems(t,M){return this.queryPortal("/search",t,"PortalItem",M)}queryUsers(t,M){t.sortField||(t.sortField="username");return this.queryPortal("/community/users",t,"PortalUser",M)}fetchSelf(t=this.authMode,M=!1,I){const S=this.restUrl+"/portals/self";t={authMode:t,query:{culture:z.getLocale().toLowerCase()},...I};"auto"===t.authMode&&(t.authMode="no-prompt");M&&(t.query.default=!0);return this.request(S,t)}queryPortal(t,M,I,S){const Z=H.ensureType(d,M),ca=ja=>this.request(this.restUrl+t,{...Z.toRequestOptions(this),
...S}).then(na=>{const ta=Z.clone();ta.start=na.nextStart;return new G({nextQueryParams:ta,queryParams:Z,total:na.total,results:V._resultsToTypedArray(ja,{portal:this},na,S)})}).then(na=>Promise.all(na.results.map(ta=>"function"===typeof ta.when?ta.when():na)).then(()=>na,ta=>{p.throwIfAbortError(ta);return na}));return I&&N[I]?N[I]().then(({default:ja})=>{p.throwIfAborted(S);return ca(ja)}):ca()}signIn(){if(this.authMode===V.AUTH_MODE_ANONYMOUS)return Promise.reject(new n("portal:invalid-auth-mode",
`Current "authMode"' is "${this.authMode}"`));if("failed"===this.loadStatus)return Promise.reject(this.loadError);const t=M=>Promise.resolve().then(()=>{if("not-loaded"===this.loadStatus)return M||(this.authMode="immediate"),this.load().then(()=>null);if("loading"===this.loadStatus)return this.load().then(()=>{if(this.credential)return null;this.credential=M;return this.fetchSelf("immediate")});if(this.user&&this.credential===M)return null;this.credential=M;return this.fetchSelf("immediate")}).then(I=>
{I&&(this.sourceJSON=I,this.read(I))});return w.id?w.id.getCredential(this.restUrl).then(M=>t(M)):t(this.credential)}normalizeUrl(t){const M=this.credential?.token;return this._normalizeSSL(M?t+(t.includes("?")?"\x26":"?")+"token\x3d"+M:t)}requestToTypedArray(t,M,I){return this.request(t,M).then(S=>{const Z=V._resultsToTypedArray(I,{portal:this},S);return Promise.all(Z.map(ca=>"function"===typeof ca.when?ca.when():S)).then(()=>Z,()=>Z)})}request(t,M={}){const I={f:"json",...M.query},{authMode:S=this.authMode===
V.AUTH_MODE_ANONYMOUS?"anonymous":"auto",body:Z=null,cacheBust:ca=!1,method:ja="auto",responseType:na="json",signal:ta}=M;M={authMode:S,body:Z,cacheBust:ca,method:ja,query:I,responseType:na,timeout:0,signal:ta};return L(this._normalizeSSL(t),M).then(ua=>ua.data)}toJSON(){throw new n("internal:not-yet-implemented","Portal.toJSON is not yet implemented");}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw Error("JSON object is already hydrated");return new V({sourceJSON:t})}_getHelperService(t){const M=
this.helperServices&&this.helperServices[t];if(!M)throw new n("portal:service-not-found",`The \`helperServices\` do not include an entry named "${t}"`);return M}async _fetchBasemaps(t,M){const I=new d;I.query=t||(A.apiKey&&J.supportsApiKey(this.url)?this.devBasemapGalleryGroupQuery:this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery);I.disableExtraQuery=!0;t=await this.queryGroups(I,M);if(!t.total)return[];t=t.results[0];I.num=100;I.query='type:"Web Map" -type:"Web Application"';
I.sortField=t.sortField||"name";I.sortOrder=t.sortOrder||"desc";M=await t.queryItems(I,M);return M.total?M.results.filter(S=>"Web Map"===S.type).map(S=>new l({portalItem:S})):[]}async _fetchBasemaps3D(t,M){t=t||this.basemapGalleryGroupQuery3D;if(!t)return[];t=new d({query:t,disableExtraQuery:!0});var I=await this.queryGroups(t,M);if(!I.total)return[];I=I.results[0];t.num=100;t.query='type:"Web Scene"';t.sortField=I.sortField||"name";t.sortOrder=I.sortOrder||"desc";M=await I.queryItems(t,M);return M.total?
M.results.filter(S=>"Web Scene"===S.type).map(S=>new l({portalItem:S})):[]}_normalizeSSL(t){return t.replace(/^http:/i,"https:").replace(":7080",":7443")}_readBasemap(t){return t?(t=l.fromJSON(t),t.portalItem={portal:this},t):null}static _resultsToTypedArray(t,M,I,S){let Z=[];if(I){const ca=null!=S?S.signal:null;Z=I.listings||I.notifications||I.userInvitations||I.tags||I.items||I.groups||I.comments||I.provisions||I.results||I.relatedItems||I;if(t||M)Z=Z.map(ja=>{ja=Object.assign(t?t.fromJSON(ja):
ja,M);"function"===typeof ja.load&&ja.load(ca);return ja})}else Z=[];return Z}};g.AUTH_MODE_ANONYMOUS="anonymous";g.AUTH_MODE_AUTO="auto";g.AUTH_MODE_IMMEDIATE="immediate";e.__decorate([x.property()],g.prototype,"access",void 0);e.__decorate([x.property()],g.prototype,"allSSL",void 0);e.__decorate([x.property()],g.prototype,"authMode",void 0);e.__decorate([x.property()],g.prototype,"authorizedCrossOriginDomains",void 0);e.__decorate([q.reader("authorizedCrossOriginDomains")],g.prototype,"readAuthorizedCrossOriginDomains",
null);e.__decorate([x.property()],g.prototype,"basemapGalleryGroupQuery",void 0);e.__decorate([x.property({json:{name:"3DBasemapGalleryGroupQuery"}})],g.prototype,"basemapGalleryGroupQuery3D",void 0);e.__decorate([x.property()],g.prototype,"bingKey",void 0);e.__decorate([x.property()],g.prototype,"canListApps",void 0);e.__decorate([x.property()],g.prototype,"canListData",void 0);e.__decorate([x.property()],g.prototype,"canListPreProvisionedItems",void 0);e.__decorate([x.property()],g.prototype,"canProvisionDirectPurchase",
void 0);e.__decorate([x.property()],g.prototype,"canSearchPublic",void 0);e.__decorate([x.property()],g.prototype,"canShareBingPublic",void 0);e.__decorate([x.property()],g.prototype,"canSharePublic",void 0);e.__decorate([x.property()],g.prototype,"canSignInArcGIS",void 0);e.__decorate([x.property()],g.prototype,"canSignInIDP",void 0);e.__decorate([x.property()],g.prototype,"colorSetsGroupQuery",void 0);e.__decorate([x.property()],g.prototype,"commentsEnabled",void 0);e.__decorate([x.property({type:Date})],
g.prototype,"created",void 0);e.__decorate([x.property()],g.prototype,"credential",void 0);e.__decorate([x.property()],g.prototype,"culture",void 0);e.__decorate([x.property()],g.prototype,"currentVersion",void 0);e.__decorate([x.property()],g.prototype,"customBaseUrl",void 0);e.__decorate([x.property()],g.prototype,"defaultBasemap",void 0);e.__decorate([q.reader("defaultBasemap")],g.prototype,"readDefaultBasemap",null);e.__decorate([x.property()],g.prototype,"defaultDevBasemap",void 0);e.__decorate([q.reader("defaultDevBasemap")],
g.prototype,"readDefaultDevBasemap",null);e.__decorate([x.property({type:r})],g.prototype,"defaultExtent",void 0);e.__decorate([x.property()],g.prototype,"defaultVectorBasemap",void 0);e.__decorate([q.reader("defaultVectorBasemap")],g.prototype,"readDefaultVectorBasemap",null);e.__decorate([x.property()],g.prototype,"description",void 0);e.__decorate([x.property()],g.prototype,"devBasemapGalleryGroupQuery",void 0);e.__decorate([x.property()],g.prototype,"eueiEnabled",void 0);e.__decorate([x.property({readOnly:!0})],
g.prototype,"extraQuery",null);e.__decorate([x.property()],g.prototype,"featuredGroups",void 0);e.__decorate([x.property()],g.prototype,"featuredItemsGroupQuery",void 0);e.__decorate([x.property()],g.prototype,"galleryTemplatesGroupQuery",void 0);e.__decorate([x.property()],g.prototype,"livingAtlasGroupQuery",void 0);e.__decorate([x.property()],g.prototype,"hasCategorySchema",void 0);e.__decorate([x.property()],g.prototype,"helpBase",void 0);e.__decorate([x.property()],g.prototype,"helperServices",
void 0);e.__decorate([x.property()],g.prototype,"helpMap",void 0);e.__decorate([x.property()],g.prototype,"homePageFeaturedContent",void 0);e.__decorate([x.property()],g.prototype,"homePageFeaturedContentCount",void 0);e.__decorate([x.property()],g.prototype,"httpPort",void 0);e.__decorate([x.property()],g.prototype,"httpsPort",void 0);e.__decorate([x.property()],g.prototype,"id",void 0);e.__decorate([x.property()],g.prototype,"ipCntryCode",void 0);e.__decorate([x.property({readOnly:!0})],g.prototype,
"isOrganization",null);e.__decorate([x.property()],g.prototype,"isPortal",void 0);e.__decorate([x.property()],g.prototype,"isReadOnly",void 0);e.__decorate([x.property({readOnly:!0})],g.prototype,"itemPageUrl",null);e.__decorate([x.property()],g.prototype,"layerTemplatesGroupQuery",void 0);e.__decorate([x.property()],g.prototype,"maxTokenExpirationMinutes",void 0);e.__decorate([x.property({type:Date})],g.prototype,"modified",void 0);e.__decorate([x.property()],g.prototype,"name",void 0);e.__decorate([x.property()],
g.prototype,"portalHostname",void 0);e.__decorate([x.property()],g.prototype,"portalMode",void 0);e.__decorate([x.property()],g.prototype,"portalProperties",void 0);e.__decorate([x.property()],g.prototype,"region",void 0);e.__decorate([x.property({readOnly:!0})],g.prototype,"restUrl",null);e.__decorate([x.property()],g.prototype,"rotatorPanels",void 0);e.__decorate([x.property()],g.prototype,"showHomePageDescription",void 0);e.__decorate([x.property()],g.prototype,"sourceJSON",void 0);e.__decorate([x.property()],
g.prototype,"staticImagesUrl",void 0);e.__decorate([x.property({json:{name:"2DStylesGroupQuery"}})],g.prototype,"stylesGroupQuery2d",void 0);e.__decorate([x.property({json:{name:"stylesGroupQuery"}})],g.prototype,"stylesGroupQuery3d",void 0);e.__decorate([x.property()],g.prototype,"supportsHostedServices",void 0);e.__decorate([x.property()],g.prototype,"symbolSetsGroupQuery",void 0);e.__decorate([x.property()],g.prototype,"templatesGroupQuery",void 0);e.__decorate([x.property()],g.prototype,"thumbnail",
void 0);e.__decorate([x.property({readOnly:!0})],g.prototype,"thumbnailUrl",null);e.__decorate([x.property()],g.prototype,"units",void 0);e.__decorate([x.property()],g.prototype,"url",void 0);e.__decorate([x.property()],g.prototype,"urlKey",void 0);e.__decorate([q.reader("urlKey")],g.prototype,"readUrlKey",null);e.__decorate([x.property()],g.prototype,"user",void 0);e.__decorate([q.reader("user")],g.prototype,"readUser",null);e.__decorate([x.property()],g.prototype,"use3dBasemaps",void 0);e.__decorate([x.property()],
g.prototype,"useStandardizedQuery",void 0);e.__decorate([x.property()],g.prototype,"useVectorBasemaps",void 0);e.__decorate([x.property()],g.prototype,"vectorBasemapGalleryGroupQuery",void 0);e=g=V=e.__decorate([a.subclass("esri.portal.Portal")],g);const m=new FinalizationRegistry(t=>{t.remove()});return e})},"esri/portal/portalDefault":function(){define(["exports"],function(c){let e;c.clearDefaultPortalInstance=function(){e=void 0};c.ensureDefaultPortalInstance=function(A){if(!e||e.destroyed)e=A();
return e};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/portal/PortalGroup":function(){define("../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./PortalQueryParams".split(" "),function(c,e,A,w,L,n,g,u,f){var p;A=p=class extends A.JSONSupport{constructor(x){super(x);this.id=this.description=this.created=this.access=null;
this.isInvitationOnly=!1;this.title=this.tags=this.sourceJSON=this.sortOrder=this.sortField=this.snippet=this.portal=this.owner=this.modified=null}get thumbnailUrl(){const x=this.url,H=this.thumbnail;return x&&H&&this.portal?this.portal?.normalizeUrl(`${x}/info/${H}?f=json`):null}get url(){const x=this.portal?.restUrl;return x?x+"/community/groups/"+this.id:null}fetchCategorySchema(x){return this.portal.request(this.url+"/categorySchema",x).then(H=>{H=H.categorySchema||[];return H.some(D=>"contentCategorySetsGroupQuery.LivingAtlas"===
D.source)?this._fetchCategorySchemaSet("LivingAtlas",x):H})}fetchMembers(x){return this.portal.request(this.url+"/users",x)}getThumbnailUrl(x){let H=this.thumbnailUrl;H&&x&&(H+=`&w=${x}`);return H}toJSON(){throw new e("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented");}static fromJSON(x){if(!x)return null;if(x.declaredClass)throw Error("JSON object is already hydrated");const H=new p;H.sourceJSON=x;H.read(x);return H}queryItems(x,H){x=L.ensureType(f,x);const D=this.portal;
if(5<parseFloat(D.currentVersion))return x=x||new f,D.queryPortal(`/content/groups/${this.id}/search`,x,"PortalItem",H);x=x?x.clone():new f;x.query="group:"+this.id+(x.query?" "+x.query:"");return D.queryItems(x,H)}_fetchCategorySchemaSet(x,H){const D=this.portal;return D.fetchSelf(D.authMode,!0,H).then(v=>{if(v=v.contentCategorySetsGroupQuery){const q=new f;q.disableExtraQuery=!0;q.num=1;q.query=v;return D.queryGroups(q,H)}throw new e("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found");
}).then(v=>{if(v.total){v=v.results[0];const q=new f;q.num=1;q.query=`typekeywords:"${x}"`;return v.queryItems(q,H)}throw new e("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found");}).then(v=>v.total?v.results[0].fetchData("json",H).then(q=>{q=q?.categorySchema;return q?.length?q:[]}):[])}};c.__decorate([w.property()],A.prototype,"access",void 0);c.__decorate([w.property({type:Date})],A.prototype,"created",void 0);c.__decorate([w.property()],A.prototype,"description",
void 0);c.__decorate([w.property()],A.prototype,"id",void 0);c.__decorate([w.property()],A.prototype,"isInvitationOnly",void 0);c.__decorate([w.property({type:Date})],A.prototype,"modified",void 0);c.__decorate([w.property()],A.prototype,"owner",void 0);c.__decorate([w.property()],A.prototype,"portal",void 0);c.__decorate([w.property()],A.prototype,"snippet",void 0);c.__decorate([w.property()],A.prototype,"sortField",void 0);c.__decorate([w.property()],A.prototype,"sortOrder",void 0);c.__decorate([w.property()],
A.prototype,"sourceJSON",void 0);c.__decorate([w.property()],A.prototype,"tags",void 0);c.__decorate([w.property()],A.prototype,"thumbnail",void 0);c.__decorate([w.property({readOnly:!0})],A.prototype,"thumbnailUrl",null);c.__decorate([w.property()],A.prototype,"title",void 0);c.__decorate([w.property({readOnly:!0})],A.prototype,"url",null);return A=p=c.__decorate([u.subclass("esri.portal.PortalGroup")],A)})},"esri/portal/PortalQueryParams":function(){define("../chunks/tslib.es6 ../core/Accessor ../core/jsonMap ../core/lang ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ../geometry/Extent ../geometry/SpatialReference ../geometry/support/webMercatorUtils".split(" "),
function(c,e,A,w,L,n,g,u,f,p){var x;const H=new A.JSONMap({avgRating:"avg-rating",numRatings:"num-ratings",numComments:"num-comments",numViews:"num-views"});e=x=class extends e{constructor(D){super(D);this.categories=null;this.disableExtraQuery=!1;this.filter=this.extent=null;this.num=10;this.sortField=this.query=null;this.start=1}get sortOrder(){return this._get("sortOrder")||"asc"}set sortOrder(D){"asc"!==D&&"desc"!==D||this._set("sortOrder",D)}clone(){return new x({categories:this.categories?w.clone(this.categories):
null,disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():null,filter:this.filter,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})}toRequestOptions(D,v){let q=[];this.categories&&(q=this.categories.map(z=>Array.isArray(z)?JSON.stringify(z):z));let a="";if(this.extent){var r=p.project(this.extent,f.WGS84);null!=r&&(a=`${r.xmin},${r.ymin},${r.xmax},${r.ymax}`)}r=this.query;!this.disableExtraQuery&&D.extraQuery&&(r="("+r+")"+
D.extraQuery);D={categories:q,bbox:a,q:r,filter:this.filter,num:this.num,sortField:null,sortOrder:null,start:this.start};this.sortField&&(D.sortField=this.sortField.split(",").map(z=>H.toJSON(z.trim())).join(","),D.sortOrder=this.sortOrder);return{query:{...v,...D}}}};c.__decorate([L.property()],e.prototype,"categories",void 0);c.__decorate([L.property()],e.prototype,"disableExtraQuery",void 0);c.__decorate([L.property({type:u})],e.prototype,"extent",void 0);c.__decorate([L.property()],e.prototype,
"filter",void 0);c.__decorate([L.property()],e.prototype,"num",void 0);c.__decorate([L.property()],e.prototype,"query",void 0);c.__decorate([L.property()],e.prototype,"sortField",void 0);c.__decorate([L.property()],e.prototype,"sortOrder",null);c.__decorate([L.property()],e.prototype,"start",void 0);return e=x=c.__decorate([g.subclass("esri.portal.PortalQueryParams")],e)})},"esri/portal/PortalQueryResult":function(){define("../chunks/tslib.es6 ../core/Accessor ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass".split(" "),
function(c,e,A,w,L,n,g){e=class extends e{constructor(u){super(u);this.total=this.results=this.queryParams=this.nextQueryParams=null}};c.__decorate([A.property()],e.prototype,"nextQueryParams",void 0);c.__decorate([A.property()],e.prototype,"queryParams",void 0);c.__decorate([A.property()],e.prototype,"results",void 0);c.__decorate([A.property()],e.prototype,"total",void 0);return e=c.__decorate([g.subclass("esri.portal.PortalQueryResult")],e)})},"esri/portal/PortalUser":function(){define("require ../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./PortalFolder ./PortalGroup".split(" "),
function(c,e,A,w,L,n,g,u,f,p,x){var H;w=H=class extends w.JSONSupport{constructor(...D){super(...D);this.userType=this.username=this.units=this.sourceJSON=this.roleId=this.role=this.region=this.privileges=this.preferredView=this.portal=this.orgId=this.modified=this.fullName=this.email=this.description=this.culture=this.created=this.access=null}get thumbnailUrl(){const D=this.url,v=this.thumbnail;return D&&v?this.portal.normalizeUrl(`${D}/info/${v}?f=json`):null}get userContentUrl(){const D=this.portal?.restUrl;
return D?`${D}/content/users/${this.username}`:null}get url(){const D=this.portal?.restUrl;return D?`${D}/community/users/${this.username}`:null}addItem(D){const v=D&&D.item;var q=D?.data;D=D?.folder;const a={method:"post"};v&&(a.query=v.createPostQuery(),null!=q&&("string"===typeof q?a.query.text=q:"object"===typeof q&&(a.query.text=JSON.stringify(q))));q=this.userContentUrl;D&&(q+="/"+("string"===typeof D?D:D.id));return this.portal.request(q+"/addItem",a).then(r=>{v.id=r.id;v.portal=this.portal;
return v.loaded?v.reload():v.load()})}deleteItem(D){let v=this.userContentUrl;D.ownerFolder&&(v+="/"+D.ownerFolder);return this.portal.request(v+`/items/${D.id}/delete`,{method:"post"}).then(()=>{D.id=null;D.portal=null})}deleteItems(D){const v=this.userContentUrl+"/deleteItems";var q=D.map(a=>a.id);return q.length?(q={method:"post",query:{items:q.join(",")}},this.portal.request(v,q).then(()=>{D.forEach(a=>{a.id=null;a.portal=null})})):Promise.resolve(void 0)}fetchFolders(){return this.portal.request(this.userContentUrl??
"",{query:{num:1}}).then(D=>D&&D.folders?D.folders.map(v=>{v=p.fromJSON(v);v.portal=this.portal;return v}):[])}fetchGroups(){return this.portal.request(this.url??"").then(D=>D&&D.groups?D.groups.map(v=>{v=x.fromJSON(v);v.portal=this.portal;return v}):[])}fetchItems(D){const v=D??{};let q=this.userContentUrl??"";v.folder&&(q+="/"+v.folder.id);let a;return(new Promise((r,z)=>c(["./PortalItem"],E=>r(Object.freeze(Object.defineProperty({__proto__:null,default:E},Symbol.toStringTag,{value:"Module"}))),
z))).then(({default:r})=>{a=r;return this.portal.request(q,{query:{folders:!1,num:v.num||10,start:v.start||1,sortField:v.sortField||"created",sortOrder:v.sortOrder||"asc"}})}).then(r=>{let z;return r?.items?(z=r.items.map(E=>{E=a.fromJSON(E);E.portal=this.portal;return E}),Promise.all(z.map(E=>E.load())).catch(E=>E).then(()=>({items:z,nextStart:r.nextStart,total:r.total}))):{items:[],nextStart:-1,total:0}})}fetchTags(){return this.portal.request(this.url+"/tags").then(D=>D.tags)}getThumbnailUrl(D){let v=
this.thumbnailUrl;v&&D&&(v+=`&w=${D}`);return v}queryFavorites(D){return this.favGroupId?(this._favGroup||(this._favGroup=new x({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(D)):Promise.reject(new A("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))}toJSON(){throw new A("internal:not-yet-implemented","PortalUser.toJSON is not yet implemented");}static fromJSON(D){if(!D)return null;if(D.declaredClass)throw Error("JSON object is already hydrated");
const v=new H;v.sourceJSON=D;v.read(D);return v}};e.__decorate([L.property()],w.prototype,"access",void 0);e.__decorate([L.property({type:Date})],w.prototype,"created",void 0);e.__decorate([L.property()],w.prototype,"culture",void 0);e.__decorate([L.property()],w.prototype,"description",void 0);e.__decorate([L.property()],w.prototype,"email",void 0);e.__decorate([L.property()],w.prototype,"favGroupId",void 0);e.__decorate([L.property()],w.prototype,"fullName",void 0);e.__decorate([L.property({type:Date})],
w.prototype,"modified",void 0);e.__decorate([L.property()],w.prototype,"orgId",void 0);e.__decorate([L.property()],w.prototype,"portal",void 0);e.__decorate([L.property()],w.prototype,"preferredView",void 0);e.__decorate([L.property()],w.prototype,"privileges",void 0);e.__decorate([L.property()],w.prototype,"region",void 0);e.__decorate([L.property()],w.prototype,"role",void 0);e.__decorate([L.property()],w.prototype,"roleId",void 0);e.__decorate([L.property()],w.prototype,"sourceJSON",void 0);e.__decorate([L.property()],
w.prototype,"thumbnail",void 0);e.__decorate([L.property({readOnly:!0})],w.prototype,"thumbnailUrl",null);e.__decorate([L.property()],w.prototype,"units",void 0);e.__decorate([L.property({readOnly:!0})],w.prototype,"userContentUrl",null);e.__decorate([L.property({readOnly:!0})],w.prototype,"url",null);e.__decorate([L.property()],w.prototype,"username",void 0);e.__decorate([L.property()],w.prototype,"userType",void 0);return w=H=e.__decorate([f.subclass("esri.portal.PortalUser")],w)})},"esri/portal/PortalFolder":function(){define("../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass".split(" "),
function(c,e,A,w,L,n,g,u){A=class extends A.JSONSupport{constructor(f){super(f);this.username=this.title=this.portal=this.id=this.created=null}get url(){const f=this.portal?.restUrl;return f?`${f}/content/users/${this.username}/${this.id}`:null}toJSON(){throw new e("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented");}};c.__decorate([w.property({type:Date})],A.prototype,"created",void 0);c.__decorate([w.property()],A.prototype,"id",void 0);c.__decorate([w.property()],A.prototype,
"portal",void 0);c.__decorate([w.property()],A.prototype,"title",void 0);c.__decorate([w.property({readOnly:!0})],A.prototype,"url",null);c.__decorate([w.property()],A.prototype,"username",void 0);return A=c.__decorate([u.subclass("esri.portal.PortalFolder")],A)})},"esri/portal/PortalItem":function(){define("require ../chunks/tslib.es6 ../assets ../kernel ../core/Error ../core/JSONSupport ../core/lang ../core/Loadable ../core/urlUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../geometry/Extent ./Portal ./PortalItemResource ./PortalRating".split(" "),
function(c,e,A,w,L,n,g,u,f,p,x,H,D,v,q,a,r){var z;const E=new Set("Map Service;Feature Service;Feature Collection;Scene Service;Image Service;Stream Service;Vector Tile Service;GeoJson;CSV;KML;WFS;WMTS;WMS;Feed".split(";")),R=new Set(["KML","GeoJson","CSV"]);n=z=class extends n.JSONSupportMixin(u){static from(d){return x.ensureClass(z,d)}constructor(d){super(d);this.id=this.groupCategories=this.extent=this.description=this.culture=this.created=this.categories=this.avgRating=this.applicationProxies=
this.apiKey=this.accessInformation=this.access=null;this.isOrgItem=!1;this.url=this.typeKeywords=this.type=this.title=this.tags=this.spatialReference=this.sourceUrl=this.sourceJSON=this.snippet=this.size=this.screenshots=this.portal=this.ownerFolder=this.owner=this.numViews=this.numRatings=this.numComments=this.name=this.modified=this.licenseInfo=this.itemControl=null}destroy(){this.portal=null}get displayName(){const d=this.type,G=this.typeKeywords||[];let T=d;"Feature Service"===d||"Feature Collection"===
d?T=G.includes("Table")?"Table":G.includes("Route Layer")?"Route Layer":G.includes("Markup")?"Markup":"Feature Layer":"Image Service"===d?T=G.includes("Elevation 3D Layer")?"Elevation Layer":G.includes("Tiled Imagery")?"Tiled Imagery Layer":"Imagery Layer":"Scene Service"===d?T="Scene Layer":"Video Service"===d?T="Video Layer":"Scene Package"===d?T="Scene Layer Package":"Stream Service"===d?T="Feature Layer":"Geoprocessing Service"===d?T=G.includes("Web Tool")?"Tool":"Geoprocessing Service":"Geocoding Service"===
d?T="Locator":"Geoenrichment Service"===d?T="GeoEnrichment Service":"Microsoft Powerpoint"===d?T="Microsoft PowerPoint":"GeoJson"===d?T="GeoJSON":"Globe Service"===d?T="Globe Layer":"Vector Tile Service"===d?T="Tile Layer":"netCDF"===d?T="NetCDF":"Map Service"===d?T=G.includes("Spatiotemporal")||!G.includes("Hosted Service")&&!G.includes("Tiled")||G.includes("Relational")?"Map Image Layer":"Tile Layer":d&&d.toLowerCase().includes("add in")?T=d.replaceAll(/(add in)/gi,"Add-In"):"datastore catalog service"===
d?T="Big Data File Share":"Compact Tile Package"===d?T="Tile Package (tpkx)":"OGCFeatureServer"===d?T="OGC Feature Layer":"web mapping application"===d&&G.includes("configurableApp")?T="Instant App":"Insights Page"===d?T="Insights Report":"Excalibur Imagery Project"===d&&(T="Excalibur Project");return T}readExtent(d){return d&&d.length?new v(d[0][0],d[0][1],d[1][0],d[1][1]):null}get iconUrl(){var d=this.type?.toLowerCase()||"";const G=this.typeKeywords||[];var T=!1;let J=!1,Q=!1,P=!1,V=!1,l=!1;T=
!1;0<d.indexOf("service")||"feature collection"===d||"kml"===d||"wms"===d||"wmts"===d||"wfs"===d?(T=G.includes("Hosted Service"),"feature service"===d||"feature collection"===d||"kml"===d||"wfs"===d?(J=G.includes("Table"),Q=G.includes("Route Layer"),P=G.includes("Markup"),V=G.includes("Spatiotemporal"),l=G.includes("UtilityNetwork"),d=V&&J?"spatiotemporaltable":J?"table":Q?"routelayer":P?"markup":V?"spatiotemporal":T?"featureshosted":l?"utilitynetwork":"features"):d="map service"===d||"wms"===d||
"wmts"===d?T||G.includes("Tiled")||"wmts"===d?"maptiles":"mapimages":"scene service"===d?G.includes("Line")?"sceneweblayerline":G.includes("3DObject")?"sceneweblayermultipatch":G.includes("Point")?"sceneweblayerpoint":G.includes("IntegratedMesh")?"sceneweblayermesh":G.includes("PointCloud")?"sceneweblayerpointcloud":G.includes("Polygon")?"sceneweblayerpolygon":G.includes("Building")?"sceneweblayerbuilding":G.includes("Voxel")?"sceneweblayervoxel":"sceneweblayer":"image service"===d?G.includes("Elevation 3D Layer")?
"elevationlayer":G.includes("Tiled Imagery")?"tiledimagerylayer":"imagery":"stream service"===d?"streamlayer":"video service"===d?G.includes("Live Stream")?"livestreamvideolayer":"videolayer":"vector tile service"===d?"vectortile":"datastore catalog service"===d?"datastorecollection":"geocoding service"===d?"geocodeservice":"geoprocessing service"===d?G.includes("Web Tool")?"tool":"layers":"geodata service"===d?"geodataservice":"3dtiles service"===d?"3dtileslayer":"layers"):d="web map"===d||"cityengine web scene"===
d?"maps":"web scene"===d?G.includes("ViewingMode-Local")?"webscenelocal":"websceneglobal":"web mapping application"===d&&G.includes("configurableApp")?"instantapps":"web mapping application"===d||"mobile application"===d||"application"===d||"operation view"===d||"desktop application"===d?"apps":"map document"===d||"map package"===d||"published map"===d||"scene document"===d||"globe document"===d||"basemap package"===d||"mobile basemap package"===d||"mobile map package"===d||"project package"===d||
"project template"===d||"pro map"===d||"layout"===d||"layer"===d&&G.includes("ArcGIS Pro")||"explorer map"===d&&G.indexOf("Explorer Document")?"mapsgray":"service definition"===d||"csv"===d||"shapefile"===d||"cad drawing"===d||"geojson"===d||"netcdf"===d||"administrative report"===d?"datafiles":"explorer add in"===d||"desktop add in"===d||"windows viewer add in"===d||"windows viewer configuration"===d?"appsgray":"360 vr experience"===d?"360vr":"arcgis pro add in"===d||"arcgis pro configuration"===
d?"addindesktop":"rule package"===d||"file geodatabase"===d||"sqlite geodatabase"===d||"csv collection"===d||"kml collection"===d||"windows mobile package"===d||"map template"===d||"desktop application template"===d||"gml"===d||"arcpad package"===d||"code sample"===d||"document link"===d||"earth configuration"===d||"operations dashboard add in"===d||"rules package"===d||"image"===d||"workflow manager package"===d||"explorer map"===d&&G.includes("Explorer Mapping Application")||G.includes("Document")?
"datafilesgray":"network analysis service"===d||"geoprocessing service"===d||"geodata service"===d||"geometry service"===d||"geoprocessing package"===d||"locator package"===d||"geoprocessing sample"===d||"workflow manager service"===d?"toolsgray":"layer"===d||"layer package"===d||"explorer layer"===d?"layersgray":"scene package"===d?"scenepackage":"3dtiles package"===d?"3dtileslayerpackage":"mobile scene package"===d?"mobilescenepackage":"tile package"===d||"compact tile package"===d?"tilepackage":
"task file"===d?"taskfile":"report template"===d?"report-template":"statistical data collection"===d?"statisticaldatacollection":"insights workbook"===d?"workbook":"insights model"===d?"insightsmodel":"insights page"===d?"insightspage":"insights theme"===d?"insightstheme":"hub initiative"===d?"hubinitiative":"hubpage"===d?"hubpage":"hub event"===d?"hubevent":"hub site application"===d?"hubsite":"hub project"===d?"hubproject":"relational database connection"===d?"relationaldatabaseconnection":"big data file share"===
d?"datastorecollection":"image collection"===d?"imagecollection":"style"===d?"style":"desktop style"===d?"desktopstyle":"dashboard"===d?"dashboard":"raster function template"===d?"rasterprocessingtemplate":"vector tile package"===d?"vectortilepackage":"ortho mapping project"===d?"orthomappingproject":"ortho mapping template"===d?"orthomappingtemplate":"solution"===d?"solutions":"geopackage"===d?"geopackage":"deep learning package"===d?"deeplearningpackage":"real time analytic"===d?"realtimeanalytics":
"big data analytic"===d?"bigdataanalytics":"feed"===d?"feed":"excalibur imagery project"===d?"excaliburimageryproject":"notebook"===d?"notebook":"storymap"===d?"storymap":"survey123 add in"===d?"survey123addin":"mission"===d?"mission":"mission report"===d?"missionreport":"mission template"===d?"missiontemplate":"quickcapture project"===d?"quickcaptureproject":"pro report"===d?"proreport":"pro report template"===d?"proreporttemplate":"urban model"===d?"urbanmodel":"web experience"===d?"experiencebuilder":
"web experience template"===d?"webexperiencetemplate":"experience builder widget"===d?"experiencebuilderwidget":"experience builder widget package"===d?"experiencebuilderwidgetpackage":"workflow"===d?"workflow":"insights script"===d?"insightsscript":"kernel gateway connection"===d?"kernelgatewayconnection":"hub initiative template"===d?"hubinitiativetemplate":"storymap theme"===d?"storymaptheme":"knowledge graph"===d?"knowledgegraph":"knowledge studio project"===d?"knowledgestudio":"native application"===
d?"nativeapp":"native application installer"===d?"nativeappinstaller":"link chart"===d?"linkchart":"investigation"===d?"investigation":"ogcfeatureserver"===d?"features":"pro project"===d?"proproject":"insights workbook package"===d?"insightsworkbookpackage":"apache parquet"===d?"apacheparquet":"notebook code snippets"===d||"notebook code snippet library"===d?"notebookcodesnippets":"suitability model"===d?"suitabilitymodel":"esri classifier definition"===d?"classifierdefinition":"esri classification schema"===
d?"classificationschema":"insights data engineering workbook"===d?"dataengineeringworkbook":"insights data engineering model"===d?"dataengineeringmodel":"deep learning studio project"===d?"deeplearningproject":"discussion"===d?"discussion":"allsource project"===d?"allsourceproject":"api key"===d?"apikey":"data pipeline"===d?"datapipelines":"group layer"===d?(T=G.includes("Map"))?"layergroup2d":"layergroup":"media layer"===d?"onlinemedialayer":"form"===d?G.includes("Survey123")?"survey":"datafilesgray":
"maps";return d?A.getAssetUrl("esri/images/portal/"+d+"16.png"):null}get isLayer(){return null!=this.type&&E.has(this.type)}get itemCdnUrl(){let d=this.itemUrl;d&&w.id&&!w.id.findCredential(d)&&(d=w.id._normalizeAGOLorgDomain(d),d=d.replace(/^https?:\/\/www\.arcgis\.com/,"https://cdn.arcgis.com"),d=d.replace(/^https?:\/\/devext\.arcgis\.com/,"https://cdndev.arcgis.com"),d=d.replace(/^https?:\/\/qaext\.arcgis\.com/,"https://cdnqa.arcgis.com"));return d}get itemPageUrl(){const d=this.portal?.itemPageUrl;
return d&&this.id?`${d}?id=${this.id}`:null}get itemUrl(){const d=this.portal?.restUrl;return d&&this.id?`${d}/content/items/${this.id}`:null}get thumbnailUrl(){const d=this.itemUrl,G=this.thumbnail;return d&&G?this.portal?.normalizeUrl(`${d}/info/${G}?f=json`)??null:null}get userItemUrl(){const d=this.portal?.restUrl;if(!d)return null;const G=this.owner||this.portal?.user?.username;return G?`${d}/content/users/${this.ownerFolder?`${G}/${this.ownerFolder}`:G}/items/${this.id}`:null}load(d){const G=
this.portal??(this.portal=q.getDefault()),T=G.load(d).then(()=>this.sourceJSON?this.sourceJSON:this.id&&this.itemUrl?G.request(this.itemUrl,{signal:null!=d?d.signal:null,query:{token:this.apiKey}}):{}).then(J=>{this.sourceJSON=J;this.read(J)});this.addResolvingPromise(T);return Promise.resolve(this)}async addRating(d){const G={method:"post",query:{}};d instanceof r&&(d=d.rating);null==d||isNaN(d)||"number"!==typeof d||(G.query.rating=d);if(!this.portal)return null;await this.portal.request(this.itemUrl+
"/addRating",G);return new r({rating:d,created:new Date})}clone(){var d={access:this.access,accessInformation:this.accessInformation,applicationProxies:g.clone(this.applicationProxies),avgRating:this.avgRating,categories:g.clone(this.categories),created:g.clone(this.created),culture:this.culture,description:this.description,extent:g.clone(this.extent),groupCategories:g.clone(this.groupCategories),id:this.id,itemControl:this.itemControl,licenseInfo:this.licenseInfo,modified:g.clone(this.modified),
name:this.name,numComments:this.numComments,numRatings:this.numRatings,numViews:this.numViews,owner:this.owner,ownerFolder:this.ownerFolder,portal:this.portal,screenshots:g.clone(this.screenshots),size:this.size,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:g.clone(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:g.clone(this.typeKeywords),url:this.url};this.loaded&&(d.loadStatus="loaded");d=(new z({sourceJSON:this.sourceJSON})).set(d);
d._set("isOrgItem",this.isOrgItem);return d}createPostQuery(){const d=this.toJSON();for(var G of["tags","typeKeywords","categories"])d[G]=d[G]?.join(", ");({extent:G}=d);G&&(d.extent=JSON.stringify(G));return d}async deleteRating(){await this.portal.request(this.itemUrl+"/deleteRating",{method:"post"})}fetchData(d="json",G){return this.portal.request(this.itemUrl+"/data",{responseType:d,...G,query:{token:this.apiKey}})}async fetchRating(d){d=await this.portal.request(this.itemUrl+"/rating",{query:{token:this.apiKey},
...d});return null!=d.rating?(d.created=new Date(d.created),new r(d)):null}fetchRelatedItems(d,G){return this.portal.requestToTypedArray(this.itemUrl+"/relatedItems",{query:{...d,token:this.apiKey},...G},z)}getThumbnailUrl(d){let G=this.thumbnailUrl;G&&d&&(G+=`&w=${d}`);return G}reload(){return this.portal.request(this.itemUrl??"",{cacheBust:!0,query:{token:this.apiKey}}).then(d=>{this.sourceJSON=d;this.read(d);return this})}update(d){return this.id?this.load().then(()=>this.portal.signIn()).then(()=>
{const G=d?.data,T={method:"post"};T.query=this.createPostQuery();for(const J in T.query)null===T.query[J]&&(T.query[J]="");T.query.clearEmptyFields=!0;null!=G&&("string"===typeof G?T.query.text=G:"object"===typeof G&&(T.query.text=JSON.stringify(G)));return this.portal.request(`${this.userItemUrl}/update`,T).then(()=>this.reload())}):Promise.reject(new L("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async copy(d){if(!this.id)throw new L("portal:item-does-not-exist",
"The item does not exist yet");await this.load();const {portal:G,itemUrl:T}=this;await G.signIn();const {copyResources:J,folder:Q,tags:P,title:V}=d||{};d={method:"post",query:{copyPrivateResources:"all"===J,folder:"string"===typeof Q?Q:Q?.id,includeResources:!!J,tags:P?.join(","),title:V}};({itemId:d}=await G.request(`${T}/copy`,d));return new z({id:d,portal:G})}updateThumbnail(d){return this.id?this.load().then(()=>this.portal.signIn()).then(()=>{const G=d.thumbnail,T=d.filename,J={method:"post"};
if("string"===typeof G)f.isDataProtocol(G)?J.query={data:G}:J.query={url:f.makeAbsolute(G)},null!=T&&(J.query.filename=T);else{const Q=new FormData;null!=T?Q.append("file",G,T):Q.append("file",G);J.body=Q}return this.portal.request(`${this.userItemUrl}/updateThumbnail`,J).then(()=>this.reload())}):Promise.reject(new L("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async fetchResources(d={},G){const {fetchResources:T}=await new Promise((J,Q)=>c(["./support/resourceUtils"],
J,Q));return T(this,d,G)}async addResource(d,G,T){const {addOrUpdateResource:J}=await new Promise((Q,P)=>c(["./support/resourceUtils"],Q,P));d.portalItem=this;return J(d,"add",G,T)}async removeResource(d,G){const {removeResource:T}=await new Promise((J,Q)=>c(["./support/resourceUtils"],J,Q));if(d.portalItem&&d.portalItem.itemUrl!==this.itemUrl)throw new L("removeresource:portal-item-mismatch","The portal item associated with the provided resource does not match the item");return T(this,d,G)}async removeAllResources(d){const {removeAllResources:G}=
await new Promise((T,J)=>c(["./support/resourceUtils"],T,J));return G(this,d)}resourceFromPath(d){return new a({portalItem:this,path:d})}toJSON(){var d=this.extent;d={accessInformation:this.accessInformation,categories:g.clone(this.categories),created:this.created?.getTime(),description:this.description,extent:d&&[[d.xmin,d.ymin],[d.xmax,d.ymax]],id:this.id,isOrgItem:this.isOrgItem,licenseInfo:this.licenseInfo,modified:this.modified?.getTime(),name:this.name,owner:this.owner,ownerFolder:this.ownerFolder,
snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:g.clone(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:g.clone(this.typeKeywords),url:this.url};return g.fixJson(d)}static fromJSON(d){if(!d)return null;if(d.declaredClass)throw Error("JSON object is already hydrated");return new z({sourceJSON:d})}_getPostQuery(){const d=this.toJSON();for(const G in d)"tags"===G&&null!==d[G]&&(d[G]=d[G].join(", ")),"typeKeywords"===G&&null!==
d[G]&&(d[G]=d[G].join(", ")),"extent"===G&&d[G]&&(d[G]=JSON.stringify(d[G]));return d}};e.__decorate([p.property({type:["private","shared","org","public"]})],n.prototype,"access",void 0);e.__decorate([p.property()],n.prototype,"accessInformation",void 0);e.__decorate([p.property({type:String})],n.prototype,"apiKey",void 0);e.__decorate([p.property({json:{read:{source:"appProxies"}}})],n.prototype,"applicationProxies",void 0);e.__decorate([p.property()],n.prototype,"avgRating",void 0);e.__decorate([p.property()],
n.prototype,"categories",void 0);e.__decorate([p.property({type:Date})],n.prototype,"created",void 0);e.__decorate([p.property()],n.prototype,"culture",void 0);e.__decorate([p.property()],n.prototype,"description",void 0);e.__decorate([p.property({readOnly:!0})],n.prototype,"displayName",null);e.__decorate([p.property({type:v})],n.prototype,"extent",void 0);e.__decorate([H.reader("extent")],n.prototype,"readExtent",null);e.__decorate([p.property()],n.prototype,"groupCategories",void 0);e.__decorate([p.property({readOnly:!0})],
n.prototype,"iconUrl",null);e.__decorate([p.property()],n.prototype,"id",void 0);e.__decorate([p.property({readOnly:!0})],n.prototype,"isLayer",null);e.__decorate([p.property({type:Boolean,readOnly:!0})],n.prototype,"isOrgItem",void 0);e.__decorate([p.property()],n.prototype,"itemControl",void 0);e.__decorate([p.property({readOnly:!0})],n.prototype,"itemPageUrl",null);e.__decorate([p.property({readOnly:!0})],n.prototype,"itemUrl",null);e.__decorate([p.property()],n.prototype,"licenseInfo",void 0);
e.__decorate([p.property({type:Date})],n.prototype,"modified",void 0);e.__decorate([p.property()],n.prototype,"name",void 0);e.__decorate([p.property()],n.prototype,"numComments",void 0);e.__decorate([p.property()],n.prototype,"numRatings",void 0);e.__decorate([p.property()],n.prototype,"numViews",void 0);e.__decorate([p.property()],n.prototype,"owner",void 0);e.__decorate([p.property()],n.prototype,"ownerFolder",void 0);e.__decorate([p.property({type:q})],n.prototype,"portal",void 0);e.__decorate([p.property()],
n.prototype,"screenshots",void 0);e.__decorate([p.property()],n.prototype,"size",void 0);e.__decorate([p.property()],n.prototype,"snippet",void 0);e.__decorate([p.property()],n.prototype,"sourceJSON",void 0);e.__decorate([p.property({type:String})],n.prototype,"sourceUrl",void 0);e.__decorate([p.property({type:String})],n.prototype,"spatialReference",void 0);e.__decorate([p.property()],n.prototype,"tags",void 0);e.__decorate([p.property()],n.prototype,"thumbnail",void 0);e.__decorate([p.property({readOnly:!0})],
n.prototype,"thumbnailUrl",null);e.__decorate([p.property()],n.prototype,"title",void 0);e.__decorate([p.property()],n.prototype,"type",void 0);e.__decorate([p.property()],n.prototype,"typeKeywords",void 0);e.__decorate([p.property({type:String,json:{read(d,G){R.has(G.type)&&(G=this.portal?.restUrl,d||(d=G&&this.id?`${G}/content/items/${this.id}/data`:null));return d}}})],n.prototype,"url",void 0);e.__decorate([p.property({readOnly:!0})],n.prototype,"userItemUrl",null);return n=z=e.__decorate([D.subclass("esri.portal.PortalItem")],
n)})},"esri/portal/PortalItemResource":function(){define("require ../chunks/tslib.es6 ../core/Accessor ../core/Error ../core/Logger ../core/urlUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass".split(" "),function(c,e,A,w,L,n,g,u,f,p,x){A=class extends A{constructor(H){super(H);this.portalItem=null}normalizeCtorArgs(H){return H?.portalItem&&H.path?{...H,path:this._normalizePath(H.path,
H.portalItem)}:H}set path(H){null!=H&&n.isAbsolute(H)?L.getLogger(this).error("portalitemresource:invalid-path","A portal item resource path must be relative"):this._set("path",H)}_castPath(H){return this._normalizePath(H,this.portalItem)}get url(){return this.portalItem&&this.path?`${this.portalItem.itemUrl}/resources/${this.path}`:null}get cdnUrl(){return this.portalItem&&this.path?`${this.portalItem.itemCdnUrl}/resources/${this.path}`:null}get itemRelativeUrl(){return this.portalItem&&this.path?
`./resources/${this.path}`:null}fetch(H="json",D){const v=this.cdnUrl;if(null==v)throw new w("portal-item-resource:fetch","Portal item resource does not refer to a valid item or path");return this.portalItem.portal.request(v,{responseType:H,query:{token:this.portalItem.apiKey},signal:D?.signal})}async update(H,D){const {addOrUpdateResource:v}=await new Promise((q,a)=>c(["./support/resourceUtils"],q,a));return v(this,"update",H,D)}hasPath(){return null!=this.path}_normalizePath(H,D){if(null==H)return H;
H=H.replace(/^\/+/,"");null!=D&&n.isAbsolute(H)&&(H=n.makeRelative(H,D.itemUrl));return H?.replace(/^\/+/,"").replace(/^(\.\/)?resources\//,"")}};e.__decorate([g.property()],A.prototype,"portalItem",void 0);e.__decorate([g.property({type:String,value:null})],A.prototype,"path",null);e.__decorate([u.cast("path")],A.prototype,"_castPath",null);e.__decorate([g.property({type:String,readOnly:!0})],A.prototype,"url",null);e.__decorate([g.property({type:String,readOnly:!0})],A.prototype,"cdnUrl",null);
e.__decorate([g.property({type:String,readOnly:!0})],A.prototype,"itemRelativeUrl",null);return A=e.__decorate([x.subclass("esri.portal.PortalItemResource")],A)})},"esri/portal/PortalRating":function(){define("../chunks/tslib.es6 ../core/Accessor ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass".split(" "),function(c,e,A,w,L,n,g){e=class extends e{constructor(u){super(u);this.rating=this.created=
null}};c.__decorate([A.property()],e.prototype,"created",void 0);c.__decorate([A.property()],e.prototype,"rating",void 0);return e=c.__decorate([g.subclass("esri.portal.PortalRating")],e)})},"esri/support/basemapDefinitions":function(){define(["exports","../assets","../intl/messages"],function(c,e,A){c.esriBasemapDefinitions={satellite:{id:"satellite",classic:!0,get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/satellite.jpg")},baseMapLayers:[{id:"satellite-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",
layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1}]},hybrid:{id:"hybrid",classic:!0,get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/hybrid.jpg")},baseMapLayers:[{id:"hybrid-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1},{id:"hybrid-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/30d6b8271e1849cd9c3042060001f425/resources/styles/root.json",
layerType:"VectorTileLayer",title:"Hybrid Reference Layer",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},terrain:{id:"terrain",classic:!0,get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/terrain.jpg")},baseMapLayers:[{id:"terrain-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Terrain Base",showLegend:!1,visibility:!0,opacity:1},{id:"terrain-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer",
layerType:"ArcGISTiledMapServiceLayer",title:"World Reference Overlay",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},oceans:{id:"oceans",classic:!0,get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/oceans.jpg")},baseMapLayers:[{id:"oceans-base-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Base",showLegend:!1,visibility:!0,opacity:1},{id:"oceans-reference-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer",
layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},osm:{id:"osm",classic:!0,get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/osm.jpg")},baseMapLayers:[{id:"osm-base-layer",layerType:"OpenStreetMap",title:"Open Street Map",showLegend:!1,visibility:!0,opacity:1}]},"dark-gray-vector":{id:"dark-gray-vector",classic:!0,get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/dark-gray-vector.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",
styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/5e9b3685f4c24d8781073dd928ebda50/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Base",visibility:!0,opacity:1},{id:"dark-gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/747cb7a5329c478cbe6981076cc879c5/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get "dark-gray"(){return{...this["dark-gray-vector"],
id:"dark-gray"}},"gray-vector":{id:"gray-vector",classic:!0,get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/gray-vector.jpg")},baseMapLayers:[{id:"gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/291da5eab3a0412593b66d384379f89f/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Base",visibility:!0,opacity:1},{id:"gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/1768e8369a214dfab4e2167d5c5f2454/resources/styles/root.json",
layerType:"VectorTileLayer",title:"Light Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get gray(){return{...this["gray-vector"],id:"gray"}},"streets-vector":{id:"streets-vector",classic:!0,get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/streets-vector.jpg")},baseMapLayers:[{id:"streets-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/de26a3cf4cc9451298ea173c4b324736/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets",visibility:!0,
opacity:1}]},get streets(){return{...this["streets-vector"],id:"streets"}},"topo-vector":{id:"topo-vector",classic:!0,get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/topo-vector.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"topo-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/7dc6cea0b1764a1f9af2e679f642f0f5/resources/styles/root.json",
layerType:"VectorTileLayer",title:"World Topo",visibility:!0,opacity:1}]},get topo(){return{...this["topo-vector"],id:"topo"}},"streets-night-vector":{id:"streets-night-vector",classic:!0,get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/streets-night.jpg")},baseMapLayers:[{id:"streets-night-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/86f556a2d1fd468181855a35e344567f/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Night",visibility:!0,
opacity:1}]},"streets-relief-vector":{id:"streets-relief-vector",classic:!0,get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/streets-relief.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"streets-relief-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/b266e6d17fc345b498345613930fbd76/resources/styles/root.json",
title:"World Streets Relief",layerType:"VectorTileLayer",visibility:!0,opacity:1}]},"streets-navigation-vector":{id:"streets-navigation-vector",classic:!0,get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/streets-navigation.jpg")},baseMapLayers:[{id:"streets-navigation-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Navigation",visibility:!0,opacity:1}]},
"topo-3d":{id:"topo-3d",is3d:!0,get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/topo-3d.png")},baseMapLayers:[{id:"topo-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/1e7d1784d1ef4b79ba6764d0bd6c3150/resources/styles/root.json",layerType:"VectorTileLayer",title:"Topographic",visibility:!0,opacity:1},{id:"topo-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Trees_Thematic_v1/SceneServer",itemId:"f75fef56b2d944fe92ef9f7737b4f953",
layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-3d":{id:"navigation-3d",
is3d:!0,get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/navigation-3d.jpg")},baseMapLayers:[{id:"navigation-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/ccc904ff872b4144b94934e55e32784b/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation",visibility:!0,opacity:1},{id:"navigation-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",
layerType:"ArcGISSceneServiceLayer"},{id:"navigation-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-dark-3d":{id:"navigation-dark-3d",itemId:"5a1365328b4943f09a54cf5fd1205707",is3d:!0,baseMapLayers:[{id:"navigation-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/451a1777ab3f4bf095fae24a117439d9/resources/styles/root.json",
layerType:"VectorTileLayer",title:"Navigation Dark"},{id:"navigation-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",
layerType:"ArcGISSceneServiceLayer"}]},"arcgis-imagery":{get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/hybrid.jpg")},title:"Imagery Hybrid",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},
"arcgis-imagery-standard":{get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/satellite.jpg")},title:"Imagery",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"}]},"arcgis-imagery-labels":{title:"Hybrid [Reference]",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",
isReference:!0}]},"arcgis-light-gray":{get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/gray-vector.jpg")},title:"Light Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Base",title:"Light Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Labels",title:"Light Gray Canvas Labels",isReference:!0}]},"arcgis-dark-gray":{get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/dark-gray.jpg")},
title:"Dark Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Base",title:"Dark Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Labels",title:"Dark Gray Canvas Labels",isReference:!0}]},"arcgis-navigation":{get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/streets-navigation.jpg")},title:"Navigation",baseMapLayers:[{layerType:"VectorTileLayer",
styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Navigation",title:"World Navigation Map"}]},"arcgis-navigation-night":{title:"Navigation (Dark Mode)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:NavigationNight",title:"World Navigation Map (Dark Mode)"}]},"arcgis-streets":{get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/streets-vector.jpg")},title:"Streets",baseMapLayers:[{layerType:"VectorTileLayer",
styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Streets",title:"World Street Map"}]},"arcgis-streets-night":{get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/streets-night.jpg")},title:"Streets (Night)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsNight",title:"World Street Map (Night)"}]},"arcgis-streets-relief":{get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/streets-relief.jpg")},
title:"Streets (with Relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsRelief:Base",title:"World Street Map (with Relief)"}]},"arcgis-topographic":{get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/topo.jpg")},title:"Topographic",
baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Topographic:Base",title:"World Topographic Map"}]},"arcgis-oceans":{get thumbnailUrl(){return e.getAssetUrl("esri/images/basemap/oceans.jpg")},title:"Oceans",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",
showLegend:!1,title:"World Ocean Base",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Oceans:Labels",title:"World Ocean Reference",isReference:!0}]},"osm-standard":{title:"OpenStreetMap",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Standard",title:"OpenStreetMap"}]},"osm-standard-relief":{title:"OpenStreetMap (with relief)",
baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StandardRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-streets":{title:"OpenStreetMap (Streets)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Streets",
title:"OpenStreetMap (Streets)"}]},"osm-streets-relief":{title:"OpenStreetMap (Streets with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StreetsRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-light-gray":{title:"OpenStreetMap (Light Gray Canvas)",
baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Base",title:"OSM (Light Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Labels",title:"OSM (Light Gray Reference)",isReference:!0}]},"osm-dark-gray":{title:"OpenStreetMap (Dark Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Base",
title:"OSM (Dark Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Labels",title:"OSM (Dark Gray Reference)",isReference:!0}]},"arcgis-terrain":{title:"Terrain with Labels",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Base",
title:"World Terrain Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Detail",title:"World Terrain Reference",isReference:!0}]},"arcgis-community":{title:"Community",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Community",title:"Community"}]},"arcgis-charted-territory":{title:"Charted Territory",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,
title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ChartedTerritory:Base",title:"Charted Territory"}]},"arcgis-colored-pencil":{title:"Colored Pencil",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ColoredPencil",title:"Colored Pencil"}]},"arcgis-nova":{title:"Nova",
baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Nova",title:"Nova"}]},"arcgis-modern-antique":{title:"Modern Antique",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ModernAntique:Base",
title:"Modern Antique"}]},"arcgis-midcentury":{title:"Mid-Century",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Midcentury",title:"Mid-Century"}]},"arcgis-newspaper":{title:"Newspaper",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Newspaper",title:"Newspaper"}]},"arcgis-hillshade-light":{title:"Hillshade",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",
showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"}]},"arcgis-hillshade-dark":{title:"Hillshade (Dark)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade (Dark)",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade_Dark/MapServer"}]},"arcgis-human-geography":{title:"Human Geography",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Base",
title:"Human Geography Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Detail",title:"Human Geography Detail",isReference:!0},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Label",title:"Human Geography Label",isReference:!0}]},"arcgis-human-geography-dark":{title:"Human Geography (Dark)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Base",
title:"Human Geography Dark Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Detail",title:"Human Geography Dark Detail",isReference:!0},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Label",title:"Human Geography Dark Label",isReference:!0}]}};c.getBasemapTitle=async function(w){if(w){var L=w.includes("-vector")?w.slice(0,w.indexOf("-vector")):
w.includes("-3d")?w.slice(0,w.indexOf("-3d")):w,n=await A.fetchMessageBundle("esri/t9n/basemaps");return n[w]||n[L]}};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/support/BasemapStyle":function(){define("../chunks/tslib.es6 ../core/Accessor ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ../intl/locale".split(" "),function(c,e,A,w,L,n,g,u){const f=new Set("ar bs ca hr cs da nl en et fi fr de el he hu id it ja ko lv lt nb pl ro ru sr es sv th tr uk vi".split(" "));
e=class extends e{constructor(p){super(p);this.language=this.id=null;this.serviceUrl="https://basemapstyles-api.arcgis.com/arcgis/rest/services/styles/v2/webmaps"}getLanguageParamValue(){if(this.language)return this.language;var p=u.getLocale().toLowerCase();switch(p){case "pt-br":return"pt-BR";case "pt-pt":return"pt-PT";case "zh-cn":return"zh-CN";case "zh-hk":return"zh-HK";case "zh-tw":return"zh-TW"}p=u.getLanguage(p);return"pt"===p?"pt-BR":p&&f.has(p)?p:"global"}};c.__decorate([A.property()],e.prototype,
"id",void 0);c.__decorate([A.property()],e.prototype,"language",void 0);c.__decorate([A.property()],e.prototype,"serviceUrl",void 0);return e=c.__decorate([g.subclass("esri.support.BasemapStyle")],e)})},"esri/webdoc/support/writeUtils":function(){define("exports ../../core/Error ../../core/lang ../../core/object ../../core/accessorSupport/extensions/serializableProperty/writer ../../layers/support/layerUtils".split(" "),function(c,e,A,w,L,n){function g(p,x){"maxScale"in p&&(x.maxScale=L.numberToJSON(p.maxScale)??
void 0);"minScale"in p&&(x.minScale=L.numberToJSON(p.minScale)??void 0)}const u=new Set("bing-maps imagery imagery-tile map-image open-street-map tile unknown unsupported vector-tile web-tile wms wmts".split(" ")),f=new Set("csv feature geo-rss geojson group imagery imagery-tile kml map-image map-notes media ogc-feature oriented-imagery route stream subtype-group tile unknown unsupported vector-tile web-tile wfs wms wmts".split(" "));c.disableRestrictedWriting=function(p){u.add(p);f.add(p)};c.enableRestrictedWriting=
function(p){u.delete(p);f.delete(p)};c.getLayerJSON=function(p,x,H){if(!p.persistenceEnabled)return null;if(!("write"in p&&p.write))return H?.messages&&H.messages.push(new e("layer:unsupported",`Layers (${p.title}, ${p.id}) of type '${p.declaredClass}' cannot be persisted`,{layer:p})),null;if(n.isFeatureCollectionLayer(p)&&!p.isTable)x=p.resourceInfo;else{if(H.restrictedWebMapWriting){var D="basemap"===H.layerContainerType?u:"operational-layers"===H.layerContainerType?f:null;D=null!=D?D.has(p.type)&&
!n.isFeatureCollectionLayer(p):!0}else D=!0;if(D)return x={},p.write(x,H)?x:null}if(null!=x){x=A.clone(x);if(H=x)n.isFeatureCollectionLayer(p)?(D=w.getDeepValue("featureCollection.layers",H)?.[0]?.layerDefinition)&&g(p,D):"group"!==p.type&&g(p,H);if(H&&(H.id=p.id,"blendMode"in p&&(H.blendMode=p.blendMode,"normal"===H.blendMode&&delete H.blendMode),H.opacity=L.numberToJSON(p.opacity)??void 0,H.title=p.title||"Layer",H.visibility=p.visible,"legendEnabled"in p&&"wmts"!==p.type))if(n.isFeatureCollectionLayer(p)){if(H=
H.featureCollection)H.showLegend=p.legendEnabled}else H.showLegend=p.legendEnabled}return x};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/layerUtils":function(){define(["exports","../../kernel","../../request"],function(c,e,A){function w(n){return"scene"===n?.type}function L(n){n=n?.type;return"imagery-tile"===n||"tile"===n||"open-street-map"===n||"vector-tile"===n||"web-tile"===n||"wmts"===n}c.getEffectiveEditingEnabled=function(n){a:if("editingEnabled"in n)switch(n.type){case "csv":case "feature":case "geojson":case "oriented-imagery":case "scene":case "subtype-group":case "subtype-sublayer":var g=
!0;break a;default:g=!1}else g=!1;return g?"effectiveEditingEnabled"in n?n.effectiveEditingEnabled:n.editingEnabled:!1};c.getEffectiveLayerCapabilities=function(n){a:if("capabilities"in n)switch(n.type){case "csv":case "feature":case "geojson":case "imagery":case "knowledge-graph-sublayer":case "ogc-feature":case "oriented-imagery":case "scene":case "subtype-group":case "subtype-sublayer":case "wfs":var g=!0;break a;default:g=!1}else g=!1;return g?"effectiveCapabilities"in n?n.effectiveCapabilities:
n.capabilities:null};c.getOwningPortalUrl=async function(n,g){var u=e.id?.findServerInfo(n);if(null!=u?.currentVersion)return u.owningSystemUrl||null;u=n.toLowerCase().indexOf("/rest/services");if(-1===u)return null;n=`${n.substring(0,u)}/rest/info`;({data:g}=await A(n,{query:{f:"json"},responseType:"json",signal:null!=g?g.signal:null}));return g?.owningSystemUrl||null};c.getTileMaxtrixSetFromActiveLayer=function(n){if(n.activeLayer){const g=n.activeLayer.tileMatrixSet;if(g)return g;if(n=n.activeLayer.tileMatrixSets)return n}return null};
c.isBaseLayer=function(n){return null!=n?.parent&&"declaredClass"in n.parent&&"esri.Basemap"===n.parent.declaredClass&&n.parent.baseLayers.includes(n)};c.isBasemap3DSupportedLayer=function(n){return L(n)||w(n)};c.isBasemapSupportedTiledLayer=L;c.isFeatureCollectionLayer=function(n){return"feature"===n?.type&&!n.url&&"memory"===n.source?.type};c.isFeatureLayer=function(n){return null!=n&&"object"===typeof n&&"type"in n&&"feature"===n.type};c.isFeatureServiceLayer=function(n){return"feature"===n?.type&&
"feature-layer"===n.source?.type};c.isGraphicsLayer=function(n){return null!=n&&"object"===typeof n&&"type"in n&&"graphics"===n.type};c.isGroupLayer=function(n){return null!=n&&"type"in n&&"group"===n.type};c.isImageryTileLayer=function(n){return"imagery-tile"===n?.type};c.isKnowledgeGraphLayer=function(n){return null!=n&&"object"===typeof n&&"type"in n&&"knowledge-graph"===n.type&&"layers"in n};c.isLayerWithFeatureLayerSource=function(n){return("feature"===n?.type||"subtype-group"===n?.type)&&"feature-layer"===
n.source?.type};c.isMapNotesLayer=function(n){return null!=n&&"object"===typeof n&&"type"in n&&"map-notes"===n.type&&"sublayers"in n};c.isSceneLayer=w;c.isSceneServiceLayer=function(n){n=n?.type;return"building-scene"===n||"integrated-mesh"===n||"point-cloud"===n||"scene"===n};c.isSubtypeGroupLayer=function(n){return null!=n&&"object"===typeof n&&"type"in n&&"subtype-group"===n.type&&"sublayers"in n};c.isTable=function(n){return null!=n&&"object"===typeof n&&"isTable"in n&&!!n.isTable};c.isTiledLayer=
function(n){n=n?.type;return"base-tile"===n||"tile"===n||"elevation"===n||"imagery-tile"===n||"base-elevation"===n||"open-street-map"===n||"wcs"===n||"web-tile"===n||"wmts"===n||"vector-tile"===n};c.isVoxelLayer=function(n){return"voxel"===n?.type};c.sceneServiceLayerTypeToClassName={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};c.serializeLayerDefinitions=function(n){const g=/[:;]/,u=[];let f=!1;if(n&&(n.forEach((p,
x)=>{u.push([x,p]);!f&&g.test(p)&&(f=!0)}),0<u.length)){if(f){const p={};u.forEach(x=>{p[x[0]]=x[1]});n=JSON.stringify(p)}else{const p=[];u.forEach(x=>{p.push(x[0]+":"+x[1])});n=p.join(";")}return n}return null};c.serializeTimeOptions=function(n){if(n){var g=[];n.forEach((u,f)=>{g.push('"'+f+'":'+JSON.stringify(u))});if(g.length)return"{"+g.join(",")+"}"}};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/layers/effects/utils":function(){define(["exports","./effects"],function(c,
e){c.canInterpolateEffects=function(A,w){const L=A.length>w.length?A:w;return(A.length>w.length?w:A).every((n,g)=>n.type===L[g].type)};c.effectEquals=function(A,w){A=JSON.stringify(A??null);w=JSON.stringify(w??null);return A===w};c.isEffectFunctions=function(A){return(A=A[0])?"type"in A:!1};c.normalizeEffects=function(A,w){const L=A.length>w.length?A:w;A=A.length>w.length?w:A;for(w=A.length;w<L.length;w++)A.push(e.createEffectWithInitialValues(L[w]))};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},
"esri/layers/effects/effects":function(){define(["exports","../../colorUtils","../../core/screenUtils","../../chunks/mat4f32","./colorMatrixFunctions"],function(c,e,A,w,L){function n(v,q,a){return v+(q-v)*a}function g(v){return Math.round(1E3*A.px2pt(v))/1E3}class u{constructor(v,q,a){this.strength=v;this.radius=q;this.threshold=a;this.type="bloom"}interpolate(v,q,a){this.strength=n(v.strength,q.strength,a);this.radius=n(v.radius,q.radius,a);this.threshold=n(v.threshold,q.threshold,a)}clone(){return new u(this.strength,
this.radius,this.threshold)}toJSON(){return{type:"bloom",radius:g(this.radius),strength:this.strength,threshold:this.threshold}}}class f{constructor(v){this.radius=v;this.type="blur"}interpolate(v,q,a){this.radius=Math.round(n(v.radius,q.radius,a))}clone(){return new f(this.radius)}toJSON(){return{type:"blur",radius:g(this.radius)}}}class p{constructor(v,q){this.type=v;this.amount=q;if("invert"===this.type||"grayscale"===this.type||"sepia"===this.type)this.amount=Math.min(this.amount,1)}get colorMatrix(){this._colorMatrix||
this._updateMatrix();return this._colorMatrix}interpolate(v,q,a){this.amount=n(v.amount,q.amount,a);this._updateMatrix()}clone(){return new p(this.type,this.amount)}toJSON(){return{type:this.type,amount:this.amount}}_updateMatrix(){const v=this._colorMatrix||w.create();switch(this.type){case "brightness":this._colorMatrix=L.brightness(v,this.amount);break;case "contrast":this._colorMatrix=L.contrast(v,this.amount);break;case "grayscale":this._colorMatrix=L.grayscale(v,this.amount);break;case "invert":this._colorMatrix=
L.invert(v,this.amount);break;case "saturate":this._colorMatrix=L.saturate(v,this.amount);break;case "sepia":this._colorMatrix=L.sepia(v,this.amount)}}}class x{constructor(v,q,a,r){this.offsetX=v;this.offsetY=q;this.blurRadius=a;this.color=r;this.type="drop-shadow"}interpolate(v,q,a){this.offsetX=n(v.offsetX,q.offsetX,a);this.offsetY=n(v.offsetY,q.offsetY,a);this.blurRadius=n(v.blurRadius,q.blurRadius,a);this.color[0]=Math.round(n(v.color[0],q.color[0],a));this.color[1]=Math.round(n(v.color[1],q.color[1],
a));this.color[2]=Math.round(n(v.color[2],q.color[2],a));this.color[3]=n(v.color[3],q.color[3],a)}clone(){return new x(this.offsetX,this.offsetY,this.blurRadius,[...this.color])}toJSON(){const v=[...this.color];v[3]*=255;return{type:"drop-shadow",xoffset:g(this.offsetX),yoffset:g(this.offsetY),blurRadius:g(this.blurRadius),color:v}}}class H{constructor(v){this.angle=v;this.type="hue-rotate"}get colorMatrix(){this._colorMatrix||this._updateMatrix();return this._colorMatrix}interpolate(v,q,a){this.angle=
n(v.angle,q.angle,a);this._updateMatrix()}clone(){return new H(this.angle)}toJSON(){return{type:"hue-rotate",angle:this.angle}}_updateMatrix(){const v=this._colorMatrix||w.create();this._colorMatrix=L.rotateHue(v,this.angle)}}class D{constructor(v){this.amount=v;this.type="opacity";this.amount=Math.min(this.amount,1)}interpolate(v,q,a){this.amount=n(v.amount,q.amount,a)}clone(){return new D(this.amount)}toJSON(){return{type:"opacity",amount:this.amount}}}c.BloomEffect=u;c.BlurEffect=f;c.ColorMatrixEffect=
p;c.DropShadowEffect=x;c.HueRotateEffect=H;c.OpacityEffect=D;c.createEffectWithInitialValues=function(v){switch(v.type){case "grayscale":case "sepia":case "invert":return new p(v.type,0);case "saturate":case "brightness":case "contrast":return new p(v.type,1);case "opacity":return new D(1);case "hue-rotate":return new H(0);case "blur":return new f(0);case "drop-shadow":return new x(0,0,0,[...e.getNamedColor("transparent")]);case "bloom":return new u(0,0,1)}};Object.defineProperty(c,Symbol.toStringTag,
{value:"Module"})})},"esri/chunks/mat4f32":function(){define(["exports"],function(c){function e(){const u=new Float32Array(16);u[0]=1;u[5]=1;u[10]=1;u[15]=1;return u}function A(u){const f=new Float32Array(16);f[0]=u[0];f[1]=u[1];f[2]=u[2];f[3]=u[3];f[4]=u[4];f[5]=u[5];f[6]=u[6];f[7]=u[7];f[8]=u[8];f[9]=u[9];f[10]=u[10];f[11]=u[11];f[12]=u[12];f[13]=u[13];f[14]=u[14];f[15]=u[15];return f}function w(u,f,p,x,H,D,v,q,a,r,z,E,R,d,G,T){const J=new Float32Array(16);J[0]=u;J[1]=f;J[2]=p;J[3]=x;J[4]=H;J[5]=
D;J[6]=v;J[7]=q;J[8]=a;J[9]=r;J[10]=z;J[11]=E;J[12]=R;J[13]=d;J[14]=G;J[15]=T;return J}function L(u,f){return new Float32Array(u,f,16)}const n=e(),g=Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:n,clone:A,create:e,createView:L,fromValues:w},Symbol.toStringTag,{value:"Module"}));c.IDENTITY=n;c.clone=A;c.create=e;c.createView=L;c.fromValues=w;c.mat4f32=g})},"esri/layers/effects/colorMatrixFunctions":function(){define(["exports","../../chunks/mat4"],function(c,e){c.brightness=(A,w)=>{A=
e.set(A,w,0,0,0,0,w,0,0,0,0,w,0,0,0,0,1);return e.transpose(A,A)};c.contrast=(A,w)=>{A=e.set(A,w,0,0,.5-.5*w,0,w,0,.5-.5*w,0,0,w,.5-.5*w,0,0,0,1);return e.transpose(A,A)};c.grayscale=(A,w)=>{w=1-w;A=e.set(A,.2126+.7874*w,.7152-.7152*w,.0722-.0722*w,0,.2126-.2126*w,.7152+.2848*w,.0722-.0722*w,0,.2126-.2126*w,.7152-.7152*w,.0722+.9278*w,0,0,0,0,1);return e.transpose(A,A)};c.invert=(A,w)=>{const L=1-2*w;A=e.set(A,L,0,0,w,0,L,0,w,0,0,L,w,0,0,0,1);return e.transpose(A,A)};c.rotateHue=(A,w)=>{const L=Math.sin(w*
Math.PI/180);w=Math.cos(w*Math.PI/180);A=e.set(A,.213+.787*w-.213*L,.715-.715*w-.715*L,.072-.072*w+.928*L,0,.213-.213*w+.143*L,.715+.285*w+.14*L,.072-.072*w-.283*L,0,.213-.213*w-.787*L,.715-.715*w+.715*L,.072+.928*w+.072*L,0,0,0,0,1);return e.transpose(A,A)};c.saturate=(A,w)=>{A=e.set(A,.213+.787*w,.715-.715*w,.072-.072*w,0,.213-.213*w,.715+.285*w,.072-.072*w,0,.213-.213*w,.715-.715*w,.072+.928*w,0,0,0,0,1);return e.transpose(A,A)};c.sepia=(A,w)=>{w=1-w;A=e.set(A,.393+.607*w,.769-.769*w,.189-.189*
w,0,.349-.349*w,.686+.314*w,.168-.168*w,0,.272-.272*w,.534-.534*w,.131+.869*w,0,0,0,0,1);return e.transpose(A,A)};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/mat4":function(){define(["exports","./vec3f64","./common"],function(c,e,A){function w(h,C){h[0]=C[0];h[1]=C[1];h[2]=C[2];h[3]=C[3];h[4]=C[4];h[5]=C[5];h[6]=C[6];h[7]=C[7];h[8]=C[8];h[9]=C[9];h[10]=C[10];h[11]=C[11];h[12]=C[12];h[13]=C[13];h[14]=C[14];h[15]=C[15];return h}function L(h,C,X,aa,ha,y,F,K,W,Y,ba,ea,
ia,la,ra,oa,qa){h[0]=C;h[1]=X;h[2]=aa;h[3]=ha;h[4]=y;h[5]=F;h[6]=K;h[7]=W;h[8]=Y;h[9]=ba;h[10]=ea;h[11]=ia;h[12]=la;h[13]=ra;h[14]=oa;h[15]=qa;return h}function n(h){h[0]=1;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=1;h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[10]=1;h[11]=0;h[12]=0;h[13]=0;h[14]=0;h[15]=1;return h}function g(h,C){if(h===C){const X=C[1],aa=C[2],ha=C[3],y=C[6],F=C[7],K=C[11];h[1]=C[4];h[2]=C[8];h[3]=C[12];h[4]=X;h[6]=C[9];h[7]=C[13];h[8]=aa;h[9]=y;h[11]=C[14];h[12]=ha;h[13]=F;h[14]=K}else h[0]=C[0],h[1]=
C[4],h[2]=C[8],h[3]=C[12],h[4]=C[1],h[5]=C[5],h[6]=C[9],h[7]=C[13],h[8]=C[2],h[9]=C[6],h[10]=C[10],h[11]=C[14],h[12]=C[3],h[13]=C[7],h[14]=C[11],h[15]=C[15];return h}function u(h,C){f(h,C)||n(h);return h}function f(h,C){const X=C[0],aa=C[1],ha=C[2],y=C[3],F=C[4],K=C[5],W=C[6],Y=C[7],ba=C[8],ea=C[9],ia=C[10],la=C[11],ra=C[12],oa=C[13],qa=C[14];C=C[15];const Ca=X*K-aa*F,wa=X*W-ha*F,Ba=X*Y-y*F,Aa=aa*W-ha*K,ya=aa*Y-y*K,Ha=ha*Y-y*W,Qa=ba*oa-ea*ra,Ya=ba*qa-ia*ra,Wa=ba*C-la*ra,Ja=ea*qa-ia*oa,Ka=ea*C-la*
oa,ka=ia*C-la*qa;let Ra=Ca*ka-wa*Ka+Ba*Ja+Aa*Wa-ya*Ya+Ha*Qa;if(!Ra)return null;Ra=1/Ra;h[0]=(K*ka-W*Ka+Y*Ja)*Ra;h[1]=(ha*Ka-aa*ka-y*Ja)*Ra;h[2]=(oa*Ha-qa*ya+C*Aa)*Ra;h[3]=(ia*ya-ea*Ha-la*Aa)*Ra;h[4]=(W*Wa-F*ka-Y*Ya)*Ra;h[5]=(X*ka-ha*Wa+y*Ya)*Ra;h[6]=(qa*Ba-ra*Ha-C*wa)*Ra;h[7]=(ba*Ha-ia*Ba+la*wa)*Ra;h[8]=(F*Ka-K*Wa+Y*Qa)*Ra;h[9]=(aa*Wa-X*Ka-y*Qa)*Ra;h[10]=(ra*ya-oa*Ba+C*Ca)*Ra;h[11]=(ea*Ba-ba*ya-la*Ca)*Ra;h[12]=(K*Ya-F*Ja-W*Qa)*Ra;h[13]=(X*Ja-aa*Ya+ha*Qa)*Ra;h[14]=(oa*wa-ra*Aa-qa*Ca)*Ra;h[15]=(ba*
Aa-ea*wa+ia*Ca)*Ra;return h}function p(h,C){const X=C[0],aa=C[1],ha=C[2],y=C[3],F=C[4],K=C[5],W=C[6],Y=C[7],ba=C[8],ea=C[9],ia=C[10],la=C[11],ra=C[12],oa=C[13],qa=C[14];C=C[15];h[0]=K*(ia*C-la*qa)-ea*(W*C-Y*qa)+oa*(W*la-Y*ia);h[1]=-(aa*(ia*C-la*qa)-ea*(ha*C-y*qa)+oa*(ha*la-y*ia));h[2]=aa*(W*C-Y*qa)-K*(ha*C-y*qa)+oa*(ha*Y-y*W);h[3]=-(aa*(W*la-Y*ia)-K*(ha*la-y*ia)+ea*(ha*Y-y*W));h[4]=-(F*(ia*C-la*qa)-ba*(W*C-Y*qa)+ra*(W*la-Y*ia));h[5]=X*(ia*C-la*qa)-ba*(ha*C-y*qa)+ra*(ha*la-y*ia);h[6]=-(X*(W*C-Y*qa)-
F*(ha*C-y*qa)+ra*(ha*Y-y*W));h[7]=X*(W*la-Y*ia)-F*(ha*la-y*ia)+ba*(ha*Y-y*W);h[8]=F*(ea*C-la*oa)-ba*(K*C-Y*oa)+ra*(K*la-Y*ea);h[9]=-(X*(ea*C-la*oa)-ba*(aa*C-y*oa)+ra*(aa*la-y*ea));h[10]=X*(K*C-Y*oa)-F*(aa*C-y*oa)+ra*(aa*Y-y*K);h[11]=-(X*(K*la-Y*ea)-F*(aa*la-y*ea)+ba*(aa*Y-y*K));h[12]=-(F*(ea*qa-ia*oa)-ba*(K*qa-W*oa)+ra*(K*ia-W*ea));h[13]=X*(ea*qa-ia*oa)-ba*(aa*qa-ha*oa)+ra*(aa*ia-ha*ea);h[14]=-(X*(K*qa-W*oa)-F*(aa*qa-ha*oa)+ra*(aa*W-ha*K));h[15]=X*(K*ia-W*ea)-F*(aa*ia-ha*ea)+ba*(aa*W-ha*K);return h}
function x(h){const C=h[0],X=h[1],aa=h[2],ha=h[3],y=h[4],F=h[5],K=h[6],W=h[7],Y=h[8],ba=h[9],ea=h[10],ia=h[11],la=h[12],ra=h[13],oa=h[14];h=h[15];return(C*F-X*y)*(ea*h-ia*oa)-(C*K-aa*y)*(ba*h-ia*ra)+(C*W-ha*y)*(ba*oa-ea*ra)+(X*K-aa*F)*(Y*h-ia*la)-(X*W-ha*F)*(Y*oa-ea*la)+(aa*W-ha*K)*(Y*ra-ba*la)}function H(h,C,X){const aa=C[0],ha=C[1],y=C[2],F=C[3],K=C[4],W=C[5],Y=C[6],ba=C[7],ea=C[8],ia=C[9],la=C[10],ra=C[11],oa=C[12],qa=C[13],Ca=C[14];C=C[15];let wa=X[0],Ba=X[1],Aa=X[2],ya=X[3];h[0]=wa*aa+Ba*K+Aa*
ea+ya*oa;h[1]=wa*ha+Ba*W+Aa*ia+ya*qa;h[2]=wa*y+Ba*Y+Aa*la+ya*Ca;h[3]=wa*F+Ba*ba+Aa*ra+ya*C;wa=X[4];Ba=X[5];Aa=X[6];ya=X[7];h[4]=wa*aa+Ba*K+Aa*ea+ya*oa;h[5]=wa*ha+Ba*W+Aa*ia+ya*qa;h[6]=wa*y+Ba*Y+Aa*la+ya*Ca;h[7]=wa*F+Ba*ba+Aa*ra+ya*C;wa=X[8];Ba=X[9];Aa=X[10];ya=X[11];h[8]=wa*aa+Ba*K+Aa*ea+ya*oa;h[9]=wa*ha+Ba*W+Aa*ia+ya*qa;h[10]=wa*y+Ba*Y+Aa*la+ya*Ca;h[11]=wa*F+Ba*ba+Aa*ra+ya*C;wa=X[12];Ba=X[13];Aa=X[14];ya=X[15];h[12]=wa*aa+Ba*K+Aa*ea+ya*oa;h[13]=wa*ha+Ba*W+Aa*ia+ya*qa;h[14]=wa*y+Ba*Y+Aa*la+ya*Ca;
h[15]=wa*F+Ba*ba+Aa*ra+ya*C;return h}function D(h,C,X){const aa=X[0],ha=X[1];X=X[2];if(C===h)h[12]=C[0]*aa+C[4]*ha+C[8]*X+C[12],h[13]=C[1]*aa+C[5]*ha+C[9]*X+C[13],h[14]=C[2]*aa+C[6]*ha+C[10]*X+C[14],h[15]=C[3]*aa+C[7]*ha+C[11]*X+C[15];else{const y=C[0],F=C[1],K=C[2],W=C[3],Y=C[4],ba=C[5],ea=C[6],ia=C[7],la=C[8],ra=C[9],oa=C[10],qa=C[11];h[0]=y;h[1]=F;h[2]=K;h[3]=W;h[4]=Y;h[5]=ba;h[6]=ea;h[7]=ia;h[8]=la;h[9]=ra;h[10]=oa;h[11]=qa;h[12]=y*aa+Y*ha+la*X+C[12];h[13]=F*aa+ba*ha+ra*X+C[13];h[14]=K*aa+ea*
ha+oa*X+C[14];h[15]=W*aa+ia*ha+qa*X+C[15]}return h}function v(h,C,X){const aa=X[0],ha=X[1];X=X[2];h[0]=C[0]*aa;h[1]=C[1]*aa;h[2]=C[2]*aa;h[3]=C[3]*aa;h[4]=C[4]*ha;h[5]=C[5]*ha;h[6]=C[6]*ha;h[7]=C[7]*ha;h[8]=C[8]*X;h[9]=C[9]*X;h[10]=C[10]*X;h[11]=C[11]*X;h[12]=C[12];h[13]=C[13];h[14]=C[14];h[15]=C[15];return h}function q(h,C,X,aa){let ha=aa[0],y=aa[1];aa=aa[2];let F=Math.sqrt(ha*ha+y*y+aa*aa);var K=void 0,W=void 0;let Y=void 0,ba=void 0,ea=void 0,ia=void 0,la=void 0,ra=void 0,oa=void 0,qa=void 0,Ca=
void 0,wa=void 0,Ba=void 0,Aa=void 0,ya=void 0,Ha=void 0,Qa=void 0,Ya=void 0,Wa=void 0,Ja=void 0,Ka=void 0,ka=void 0;W=K=void 0;if(F<A.getEpsilon())return null;F=1/F;ha*=F;y*=F;aa*=F;K=Math.sin(X);W=Math.cos(X);Y=1-W;ba=C[0];ea=C[1];ia=C[2];la=C[3];ra=C[4];oa=C[5];qa=C[6];Ca=C[7];wa=C[8];Ba=C[9];Aa=C[10];ya=C[11];Ha=ha*ha*Y+W;Qa=y*ha*Y+aa*K;Ya=aa*ha*Y-y*K;Wa=ha*y*Y-aa*K;Ja=y*y*Y+W;Ka=aa*y*Y+ha*K;ka=ha*aa*Y+y*K;K=y*aa*Y-ha*K;W=aa*aa*Y+W;h[0]=ba*Ha+ra*Qa+wa*Ya;h[1]=ea*Ha+oa*Qa+Ba*Ya;h[2]=ia*Ha+qa*Qa+
Aa*Ya;h[3]=la*Ha+Ca*Qa+ya*Ya;h[4]=ba*Wa+ra*Ja+wa*Ka;h[5]=ea*Wa+oa*Ja+Ba*Ka;h[6]=ia*Wa+qa*Ja+Aa*Ka;h[7]=la*Wa+Ca*Ja+ya*Ka;h[8]=ba*ka+ra*K+wa*W;h[9]=ea*ka+oa*K+Ba*W;h[10]=ia*ka+qa*K+Aa*W;h[11]=la*ka+Ca*K+ya*W;C!==h&&(h[12]=C[12],h[13]=C[13],h[14]=C[14],h[15]=C[15]);return h}function a(h,C,X){const aa=Math.sin(X);X=Math.cos(X);const ha=C[4],y=C[5],F=C[6],K=C[7],W=C[8],Y=C[9],ba=C[10],ea=C[11];C!==h&&(h[0]=C[0],h[1]=C[1],h[2]=C[2],h[3]=C[3],h[12]=C[12],h[13]=C[13],h[14]=C[14],h[15]=C[15]);h[4]=ha*X+W*
aa;h[5]=y*X+Y*aa;h[6]=F*X+ba*aa;h[7]=K*X+ea*aa;h[8]=W*X-ha*aa;h[9]=Y*X-y*aa;h[10]=ba*X-F*aa;h[11]=ea*X-K*aa;return h}function r(h,C,X){const aa=Math.sin(X);X=Math.cos(X);const ha=C[0],y=C[1],F=C[2],K=C[3],W=C[8],Y=C[9],ba=C[10],ea=C[11];C!==h&&(h[4]=C[4],h[5]=C[5],h[6]=C[6],h[7]=C[7],h[12]=C[12],h[13]=C[13],h[14]=C[14],h[15]=C[15]);h[0]=ha*X-W*aa;h[1]=y*X-Y*aa;h[2]=F*X-ba*aa;h[3]=K*X-ea*aa;h[8]=ha*aa+W*X;h[9]=y*aa+Y*X;h[10]=F*aa+ba*X;h[11]=K*aa+ea*X;return h}function z(h,C,X){const aa=Math.sin(X);
X=Math.cos(X);const ha=C[0],y=C[1],F=C[2],K=C[3],W=C[4],Y=C[5],ba=C[6],ea=C[7];C!==h&&(h[8]=C[8],h[9]=C[9],h[10]=C[10],h[11]=C[11],h[12]=C[12],h[13]=C[13],h[14]=C[14],h[15]=C[15]);h[0]=ha*X+W*aa;h[1]=y*X+Y*aa;h[2]=F*X+ba*aa;h[3]=K*X+ea*aa;h[4]=W*X-ha*aa;h[5]=Y*X-y*aa;h[6]=ba*X-F*aa;h[7]=ea*X-K*aa;return h}function E(h,C){h[0]=1;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=1;h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[10]=1;h[11]=0;h[12]=C[0];h[13]=C[1];h[14]=C[2];h[15]=1;return h}function R(h,C){h[0]=C[0];h[1]=0;h[2]=0;h[3]=
0;h[4]=0;h[5]=C[1];h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[10]=C[2];h[11]=0;h[12]=0;h[13]=0;h[14]=0;h[15]=1;return h}function d(h,C,X){if(0===C)return n(h);let aa=X[0],ha=X[1];X=X[2];let y=Math.sqrt(aa*aa+ha*ha+X*X),F=void 0,K=void 0,W=void 0;if(y<A.getEpsilon())return null;y=1/y;aa*=y;ha*=y;X*=y;F=Math.sin(C);K=Math.cos(C);W=1-K;h[0]=aa*aa*W+K;h[1]=ha*aa*W+X*F;h[2]=X*aa*W-ha*F;h[3]=0;h[4]=aa*ha*W-X*F;h[5]=ha*ha*W+K;h[6]=X*ha*W+aa*F;h[7]=0;h[8]=aa*X*W+ha*F;h[9]=ha*X*W-aa*F;h[10]=X*X*W+K;h[11]=0;h[12]=0;h[13]=
0;h[14]=0;h[15]=1;return h}function G(h,C){const X=Math.sin(C);C=Math.cos(C);h[0]=1;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=C;h[6]=X;h[7]=0;h[8]=0;h[9]=-X;h[10]=C;h[11]=0;h[12]=0;h[13]=0;h[14]=0;h[15]=1;return h}function T(h,C){const X=Math.sin(C);C=Math.cos(C);h[0]=C;h[1]=0;h[2]=-X;h[3]=0;h[4]=0;h[5]=1;h[6]=0;h[7]=0;h[8]=X;h[9]=0;h[10]=C;h[11]=0;h[12]=0;h[13]=0;h[14]=0;h[15]=1;return h}function J(h,C){const X=Math.sin(C);C=Math.cos(C);h[0]=C;h[1]=X;h[2]=0;h[3]=0;h[4]=-X;h[5]=C;h[6]=0;h[7]=0;h[8]=0;h[9]=
0;h[10]=1;h[11]=0;h[12]=0;h[13]=0;h[14]=0;h[15]=1;return h}function Q(h,C,X){var aa=C[0],ha=C[1],y=C[2],F=C[3],K=aa+aa,W=ha+ha;const Y=y+y;C=aa*K;const ba=aa*W;aa*=Y;const ea=ha*W;ha*=Y;y*=Y;K*=F;W*=F;F*=Y;h[0]=1-(ea+y);h[1]=ba+F;h[2]=aa-W;h[3]=0;h[4]=ba-F;h[5]=1-(C+y);h[6]=ha+K;h[7]=0;h[8]=aa+W;h[9]=ha-K;h[10]=1-(C+ea);h[11]=0;h[12]=X[0];h[13]=X[1];h[14]=X[2];h[15]=1;return h}function P(h,C){const X=Va,aa=-C[0],ha=-C[1],y=-C[2],F=C[3],K=C[4],W=C[5],Y=C[6],ba=C[7],ea=aa*aa+ha*ha+y*y+F*F;0<ea?(X[0]=
2*(K*F+ba*aa+W*y-Y*ha)/ea,X[1]=2*(W*F+ba*ha+Y*aa-K*y)/ea,X[2]=2*(Y*F+ba*y+K*ha-W*aa)/ea):(X[0]=2*(K*F+ba*aa+W*y-Y*ha),X[1]=2*(W*F+ba*ha+Y*aa-K*y),X[2]=2*(Y*F+ba*y+K*ha-W*aa));Q(h,C,X);return h}function V(h,C){h[0]=C[12];h[1]=C[13];h[2]=C[14];return h}function l(h,C){const X=C[0],aa=C[1],ha=C[2],y=C[4],F=C[5],K=C[6],W=C[8],Y=C[9];C=C[10];h[0]=Math.sqrt(X*X+aa*aa+ha*ha);h[1]=Math.sqrt(y*y+F*F+K*K);h[2]=Math.sqrt(W*W+Y*Y+C*C);return h}function N(h,C){const X=C[0]+C[5]+C[10];let aa=0;0<X?(aa=2*Math.sqrt(X+
1),h[3]=.25*aa,h[0]=(C[6]-C[9])/aa,h[1]=(C[8]-C[2])/aa,h[2]=(C[1]-C[4])/aa):C[0]>C[5]&&C[0]>C[10]?(aa=2*Math.sqrt(1+C[0]-C[5]-C[10]),h[3]=(C[6]-C[9])/aa,h[0]=.25*aa,h[1]=(C[1]+C[4])/aa,h[2]=(C[8]+C[2])/aa):C[5]>C[10]?(aa=2*Math.sqrt(1+C[5]-C[0]-C[10]),h[3]=(C[8]-C[2])/aa,h[0]=(C[1]+C[4])/aa,h[1]=.25*aa,h[2]=(C[6]+C[9])/aa):(aa=2*Math.sqrt(1+C[10]-C[0]-C[5]),h[3]=(C[1]-C[4])/aa,h[0]=(C[8]+C[2])/aa,h[1]=(C[6]+C[9])/aa,h[2]=.25*aa);return h}function m(h,C,X,aa){var ha=C[0],y=C[1],F=C[2],K=C[3],W=ha+
ha,Y=y+y,ba=F+F;C=ha*W;const ea=ha*Y;ha*=ba;const ia=y*Y;y*=ba;F*=ba;W*=K;Y*=K;K*=ba;ba=aa[0];const la=aa[1];aa=aa[2];h[0]=(1-(ia+F))*ba;h[1]=(ea+K)*ba;h[2]=(ha-Y)*ba;h[3]=0;h[4]=(ea-K)*la;h[5]=(1-(C+F))*la;h[6]=(y+W)*la;h[7]=0;h[8]=(ha+Y)*aa;h[9]=(y-W)*aa;h[10]=(1-(C+ia))*aa;h[11]=0;h[12]=X[0];h[13]=X[1];h[14]=X[2];h[15]=1;return h}function t(h,C,X,aa,ha){var y=C[0],F=C[1],K=C[2],W=C[3],Y=y+y,ba=F+F,ea=K+K;C=y*Y;var ia=y*ba,la=y*ea;y=F*ba;F*=ea;var ra=K*ea;K=W*Y;ba*=W;const oa=W*ea;var qa=aa[0],
Ca=aa[1];ea=aa[2];aa=ha[0];W=ha[1];ha=ha[2];Y=(1-(y+ra))*qa;const wa=(ia+oa)*qa;qa*=la-ba;ia=(ia-oa)*Ca;ra=(1-(C+ra))*Ca;Ca*=F+K;la=(la+ba)*ea;F=(F-K)*ea;C=(1-(C+y))*ea;h[0]=Y;h[1]=wa;h[2]=qa;h[3]=0;h[4]=ia;h[5]=ra;h[6]=Ca;h[7]=0;h[8]=la;h[9]=F;h[10]=C;h[11]=0;h[12]=X[0]+aa-(Y*aa+ia*W+la*ha);h[13]=X[1]+W-(wa*aa+ra*W+F*ha);h[14]=X[2]+ha-(qa*aa+Ca*W+C*ha);h[15]=1;return h}function M(h,C){var X=C[0],aa=C[1],ha=C[2];C=C[3];var y=X+X,F=aa+aa;const K=ha+ha;X*=y;const W=aa*y;aa*=F;const Y=ha*y,ba=ha*F;ha*=
K;y*=C;F*=C;C*=K;h[0]=1-aa-ha;h[1]=W+C;h[2]=Y-F;h[3]=0;h[4]=W-C;h[5]=1-X-ha;h[6]=ba+y;h[7]=0;h[8]=Y+F;h[9]=ba-y;h[10]=1-X-aa;h[11]=0;h[12]=0;h[13]=0;h[14]=0;h[15]=1;return h}function I(h,C,X,aa,ha,y,F){const K=1/(X-C),W=1/(ha-aa),Y=1/(y-F);h[0]=2*y*K;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=2*y*W;h[6]=0;h[7]=0;h[8]=(X+C)*K;h[9]=(ha+aa)*W;h[10]=(F+y)*Y;h[11]=-1;h[12]=0;h[13]=0;h[14]=F*y*2*Y;h[15]=0;return h}function S(h,C,X,aa,ha){C=1/Math.tan(C/2);let y=void 0;h[0]=C/X;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=C;
h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[11]=-1;h[12]=0;h[13]=0;h[15]=0;null!=ha&&Infinity!==ha?(y=1/(aa-ha),h[10]=(ha+aa)*y,h[14]=2*ha*aa*y):(h[10]=-1,h[14]=-2*aa);return h}function Z(h,C,X,aa){const ha=Math.tan(C.upDegrees*Math.PI/180),y=Math.tan(C.downDegrees*Math.PI/180),F=Math.tan(C.leftDegrees*Math.PI/180);C=Math.tan(C.rightDegrees*Math.PI/180);const K=2/(F+C),W=2/(ha+y);h[0]=K;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=W;h[6]=0;h[7]=0;h[8]=-((F-C)*K*.5);h[9]=(ha-y)*W*.5;h[10]=aa/(X-aa);h[11]=-1;h[12]=0;h[13]=0;
h[14]=aa*X/(X-aa);h[15]=0;return h}function ca(h,C,X,aa,ha,y,F){const K=1/(C-X),W=1/(aa-ha),Y=1/(y-F);h[0]=-2*K;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=-2*W;h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[10]=2*Y;h[11]=0;h[12]=(C+X)*K;h[13]=(ha+aa)*W;h[14]=(F+y)*Y;h[15]=1;return h}function ja(h,C,X,aa){const ha=C[0],y=C[1];C=C[2];let F=ha-X[0],K=y-X[1];X=C-X[2];var W=A.getEpsilon();if(Math.abs(F)<W&&Math.abs(K)<W&&Math.abs(X)<W)n(h);else{var Y=1/Math.sqrt(F*F+K*K+X*X);F*=Y;K*=Y;X*=Y;Y=aa[0];var ba=aa[1];W=aa[2];aa=ba*X-W*
K;W=W*F-Y*X;ba=Y*K-ba*F;(Y=Math.sqrt(aa*aa+W*W+ba*ba))?(Y=1/Y,aa*=Y,W*=Y,ba*=Y):ba=W=aa=0;var ea=K*ba-X*W,ia=X*aa-F*ba,la=F*W-K*aa;(Y=Math.sqrt(ea*ea+ia*ia+la*la))?(Y=1/Y,ea*=Y,ia*=Y,la*=Y):la=ia=ea=0;h[0]=aa;h[1]=ea;h[2]=F;h[3]=0;h[4]=W;h[5]=ia;h[6]=K;h[7]=0;h[8]=ba;h[9]=la;h[10]=X;h[11]=0;h[12]=-(aa*ha+W*y+ba*C);h[13]=-(ea*ha+ia*y+la*C);h[14]=-(F*ha+K*y+X*C);h[15]=1}}function na(h,C,X,aa){const ha=C[0],y=C[1];C=C[2];var F=aa[0];const K=aa[1];var W=aa[2];aa=ha-X[0];let Y=y-X[1];X=C-X[2];let ba=aa*
aa+Y*Y+X*X;0<ba&&(ba=1/Math.sqrt(ba),aa*=ba,Y*=ba,X*=ba);let ea=K*X-W*Y;W=W*aa-F*X;F=F*Y-K*aa;ba=ea*ea+W*W+F*F;0<ba&&(ba=1/Math.sqrt(ba),ea*=ba,W*=ba,F*=ba);h[0]=ea;h[1]=W;h[2]=F;h[3]=0;h[4]=Y*F-X*W;h[5]=X*ea-aa*F;h[6]=aa*W-Y*ea;h[7]=0;h[8]=aa;h[9]=Y;h[10]=X;h[11]=0;h[12]=ha;h[13]=y;h[14]=C;h[15]=1;return h}function ta(h){return"mat4("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+", "+h[4]+", "+h[5]+", "+h[6]+", "+h[7]+", "+h[8]+", "+h[9]+", "+h[10]+", "+h[11]+", "+h[12]+", "+h[13]+", "+h[14]+", "+h[15]+")"}
function ua(h){return Math.sqrt(h[0]**2+h[1]**2+h[2]**2+h[3]**2+h[4]**2+h[5]**2+h[6]**2+h[7]**2+h[8]**2+h[9]**2+h[10]**2+h[11]**2+h[12]**2+h[13]**2+h[14]**2+h[15]**2)}function sa(h,C,X){h[0]=C[0]+X[0];h[1]=C[1]+X[1];h[2]=C[2]+X[2];h[3]=C[3]+X[3];h[4]=C[4]+X[4];h[5]=C[5]+X[5];h[6]=C[6]+X[6];h[7]=C[7]+X[7];h[8]=C[8]+X[8];h[9]=C[9]+X[9];h[10]=C[10]+X[10];h[11]=C[11]+X[11];h[12]=C[12]+X[12];h[13]=C[13]+X[13];h[14]=C[14]+X[14];h[15]=C[15]+X[15];return h}function va(h,C,X){h[0]=C[0]-X[0];h[1]=C[1]-X[1];
h[2]=C[2]-X[2];h[3]=C[3]-X[3];h[4]=C[4]-X[4];h[5]=C[5]-X[5];h[6]=C[6]-X[6];h[7]=C[7]-X[7];h[8]=C[8]-X[8];h[9]=C[9]-X[9];h[10]=C[10]-X[10];h[11]=C[11]-X[11];h[12]=C[12]-X[12];h[13]=C[13]-X[13];h[14]=C[14]-X[14];h[15]=C[15]-X[15];return h}function xa(h,C,X){h[0]=C[0]*X;h[1]=C[1]*X;h[2]=C[2]*X;h[3]=C[3]*X;h[4]=C[4]*X;h[5]=C[5]*X;h[6]=C[6]*X;h[7]=C[7]*X;h[8]=C[8]*X;h[9]=C[9]*X;h[10]=C[10]*X;h[11]=C[11]*X;h[12]=C[12]*X;h[13]=C[13]*X;h[14]=C[14]*X;h[15]=C[15]*X;return h}function Da(h,C,X,aa){h[0]=C[0]+
X[0]*aa;h[1]=C[1]+X[1]*aa;h[2]=C[2]+X[2]*aa;h[3]=C[3]+X[3]*aa;h[4]=C[4]+X[4]*aa;h[5]=C[5]+X[5]*aa;h[6]=C[6]+X[6]*aa;h[7]=C[7]+X[7]*aa;h[8]=C[8]+X[8]*aa;h[9]=C[9]+X[9]*aa;h[10]=C[10]+X[10]*aa;h[11]=C[11]+X[11]*aa;h[12]=C[12]+X[12]*aa;h[13]=C[13]+X[13]*aa;h[14]=C[14]+X[14]*aa;h[15]=C[15]+X[15]*aa;return h}function Ia(h,C){return h[0]===C[0]&&h[1]===C[1]&&h[2]===C[2]&&h[3]===C[3]&&h[4]===C[4]&&h[5]===C[5]&&h[6]===C[6]&&h[7]===C[7]&&h[8]===C[8]&&h[9]===C[9]&&h[10]===C[10]&&h[11]===C[11]&&h[12]===C[12]&&
h[13]===C[13]&&h[14]===C[14]&&h[15]===C[15]}function Pa(h,C){if(h===C)return!0;const X=h[0],aa=h[1],ha=h[2],y=h[3],F=h[4],K=h[5],W=h[6],Y=h[7],ba=h[8],ea=h[9],ia=h[10],la=h[11],ra=h[12],oa=h[13],qa=h[14];h=h[15];const Ca=C[0],wa=C[1],Ba=C[2],Aa=C[3],ya=C[4],Ha=C[5],Qa=C[6],Ya=C[7],Wa=C[8],Ja=C[9],Ka=C[10],ka=C[11],Ra=C[12],Nb=C[13],nb=C[14];C=C[15];const b=A.getEpsilon();return Math.abs(X-Ca)<=b*Math.max(1,Math.abs(X),Math.abs(Ca))&&Math.abs(aa-wa)<=b*Math.max(1,Math.abs(aa),Math.abs(wa))&&Math.abs(ha-
Ba)<=b*Math.max(1,Math.abs(ha),Math.abs(Ba))&&Math.abs(y-Aa)<=b*Math.max(1,Math.abs(y),Math.abs(Aa))&&Math.abs(F-ya)<=b*Math.max(1,Math.abs(F),Math.abs(ya))&&Math.abs(K-Ha)<=b*Math.max(1,Math.abs(K),Math.abs(Ha))&&Math.abs(W-Qa)<=b*Math.max(1,Math.abs(W),Math.abs(Qa))&&Math.abs(Y-Ya)<=b*Math.max(1,Math.abs(Y),Math.abs(Ya))&&Math.abs(ba-Wa)<=b*Math.max(1,Math.abs(ba),Math.abs(Wa))&&Math.abs(ea-Ja)<=b*Math.max(1,Math.abs(ea),Math.abs(Ja))&&Math.abs(ia-Ka)<=b*Math.max(1,Math.abs(ia),Math.abs(Ka))&&Math.abs(la-
ka)<=b*Math.max(1,Math.abs(la),Math.abs(ka))&&Math.abs(ra-Ra)<=b*Math.max(1,Math.abs(ra),Math.abs(Ra))&&Math.abs(oa-Nb)<=b*Math.max(1,Math.abs(oa),Math.abs(Nb))&&Math.abs(qa-nb)<=b*Math.max(1,Math.abs(qa),Math.abs(nb))&&Math.abs(h-C)<=b*Math.max(1,Math.abs(h),Math.abs(C))}function Na(h){const C=A.getEpsilon(),X=h[0],aa=h[1],ha=h[2],y=h[4],F=h[5],K=h[6],W=h[8],Y=h[9];h=h[10];return Math.abs(1-(X*X+y*y+W*W))<=C&&Math.abs(1-(aa*aa+F*F+Y*Y))<=C&&Math.abs(1-(ha*ha+K*K+h*h))<=C}function Sa(h){return 1===
h[0]&&0===h[1]&&0===h[2]&&0===h[4]&&1===h[5]&&0===h[6]&&0===h[8]&&0===h[9]&&1===h[10]}const Va=e.create();e=Object.freeze(Object.defineProperty({__proto__:null,add:sa,adjoint:p,copy:w,determinant:x,equals:Pa,exactEquals:Ia,frob:ua,fromQuat:M,fromQuat2:P,fromRotation:d,fromRotationTranslation:Q,fromRotationTranslationScale:m,fromRotationTranslationScaleOrigin:t,fromScaling:R,fromTranslation:E,fromXRotation:G,fromYRotation:T,fromZRotation:J,frustum:I,getRotation:N,getScaling:l,getTranslation:V,hasIdentityRotation:Sa,
identity:n,invert:f,invertOrIdentity:u,isOrthoNormal:Na,lookAt:ja,mul:H,multiply:H,multiplyScalar:xa,multiplyScalarAndAdd:Da,ortho:ca,perspective:S,perspectiveFromFieldOfView:Z,rotate:q,rotateX:a,rotateY:r,rotateZ:z,scale:v,set:L,str:ta,sub:va,subtract:va,targetTo:na,translate:D,transpose:g},Symbol.toStringTag,{value:"Module"}));c.add=sa;c.adjoint=p;c.copy=w;c.determinant=x;c.equals=Pa;c.exactEquals=Ia;c.frob=ua;c.fromQuat=M;c.fromQuat2=P;c.fromRotation=d;c.fromRotationTranslation=Q;c.fromRotationTranslationScale=
m;c.fromRotationTranslationScaleOrigin=t;c.fromScaling=R;c.fromTranslation=E;c.fromXRotation=G;c.fromYRotation=T;c.fromZRotation=J;c.frustum=I;c.getRotation=N;c.getScaling=l;c.getTranslation=V;c.hasIdentityRotation=Sa;c.identity=n;c.invert=f;c.invertOrIdentity=u;c.isOrthoNormal=Na;c.lookAt=ja;c.mat4=e;c.mul=H;c.multiply=H;c.multiplyScalar=xa;c.multiplyScalarAndAdd=Da;c.ortho=ca;c.perspective=S;c.perspectiveFromFieldOfView=Z;c.rotate=q;c.rotateX=a;c.rotateY=r;c.rotateZ=z;c.scale=v;c.set=L;c.str=ta;
c.sub=va;c.subtract=va;c.targetTo=na;c.translate=D;c.transpose=g})},"esri/statistics/utils":function(){define(["exports","../rest/support/ClassBreaksDefinition","../rest/support/generateRendererUtils"],function(c,e,A){function w(m){return null==m||"string"===typeof m&&!m?"\x3cNull\x3e":m}function L(m){const t=null!=m.minValue||null!=m.maxValue,M=!!m.sqlExpression&&m.supportsSQLExpression;return!(null!=m.normalizationField||null!=m.normalizationType)&&!t&&!M}function n(m){const {values:t,useSampleStdDev:M,
supportsNullCount:I}=m;var S=Number.POSITIVE_INFINITY;let Z=Number.NEGATIVE_INFINITY,ca=null,ja=null;var na=null;let ta=null,ua=0;const sa=null==m.minValue?-Infinity:m.minValue,va=null==m.maxValue?Infinity:m.maxValue;for(const xa of t)Number.isFinite(xa)?xa>=sa&&xa<=va&&(ca=null===ca?xa:ca+xa,S=Math.min(S,xa),Z=Math.max(Z,xa),ua++):"string"===typeof xa&&ua++;if(ua&&null!=ca){ja=ca/ua;na=0;for(const xa of t)Number.isFinite(xa)&&xa>=sa&&xa<=va&&(na+=(xa-ja)**2);ta=M?1<ua?na/(ua-1):0:0<ua?na/ua:0;na=
Math.sqrt(ta)}else Z=S=null;S={avg:ja,count:ua,max:Z,min:S,stddev:na,sum:ca,variance:ta};I&&(S.nullcount=t.length-ua);m.percentileParams&&(S.median=g(t,m.percentileParams));return S}function g(m,t){const {fieldType:M,value:I,orderBy:S,isDiscrete:Z}=t,ca=u(M,"desc"===S);m=[...m].filter(ua=>null!=ua).sort((ua,sa)=>ca(ua,sa));if(0===m.length)return null;if(0>=I)return m[0];if(1<=I)return m[m.length-1];var ja=(m.length-1)*I,na=Math.floor(ja);t=na+1;ja%=1;na=m[na];const ta=m[t];return t>=m.length||Z||
"string"===typeof na||"string"===typeof ta?na:na*(1-ja)+ta*ja}function u(m,t){if(m){if(E.has(m))return t?l:N;if(R.has(m))return f(t,!1);if("esriFieldTypeTimestampOffset"===m)return t?Q:J;const Z=f(t,!0);if("esriFieldTypeString"===m)return Z;if("esriFieldTypeGUID"===m||"esriFieldTypeGlobalID"===m)return(ca,ja)=>Z(p(ca),p(ja))}const M=t?1:-1,I=t?l:N,S=f(t,!0);return(Z,ca)=>"number"===typeof Z&&"number"===typeof ca?I(Z,ca):"string"===typeof Z&&"string"===typeof ca?S(Z,ca):M}function f(m,t){if(!t)return m?
V:P;const M=m?G:T;return m?(I,S)=>{const Z=M(I,S);if(null!=Z)return Z;I=I.toUpperCase();S=S.toUpperCase();return I>S?-1:I<S?1:0}:(I,S)=>{const Z=M(I,S);if(null!=Z)return Z;I=I.toUpperCase();S=S.toUpperCase();return I<S?-1:I>S?1:0}}function p(m){return m.substr(24,12)+m.substr(19,4)+m.substr(16,2)+m.substr(14,2)+m.substr(11,2)+m.substr(9,2)+m.substr(6,2)+m.substr(4,2)+m.substr(2,2)+m.substr(0,2)}function x(m){return"coded-value"!==m?.type?[]:m.codedValues.map(t=>t.code)}function H(m,t){const M=v({field:t.field,
normalizationType:t.normalizationType,normalizationField:t.normalizationField,classificationMethod:t.classificationMethod,standardDeviationInterval:t.standardDeviationInterval,breakCount:t.numClasses||5});m=D(m,t.minValue,t.maxValue);return A.createGenerateRendererClassBreaks({definition:M,values:m,normalizationTotal:t.normalizationTotal})}function D(m,t,M){const I=null==t?-Infinity:t,S=null==M?Infinity:M;return m.filter(Z=>Number.isFinite(Z)&&Z>=I&&Z<=S)}function v(m){const {breakCount:t,field:M,
normalizationField:I,normalizationType:S}=m,Z=m.classificationMethod||"equal-interval";return new e({breakCount:t,classificationField:M,classificationMethod:Z,normalizationField:"field"===S?I:void 0,normalizationType:S,standardDeviationInterval:"standard-deviation"===Z?m.standardDeviationInterval||1:void 0})}function q(m,t){const {field:M,classificationMethod:I,standardDeviationInterval:S,normalizationType:Z,normalizationField:ca,normalizationTotal:ja,minValue:na,maxValue:ta}=t,ua=t.numBins||10;let sa=
t=null,va=null;I&&"equal-interval"!==I||Z?({classBreaks:m}=H(m,{field:M,normalizationType:Z,normalizationField:ca,normalizationTotal:ja,classificationMethod:I,standardDeviationInterval:S,minValue:na,maxValue:ta,numClasses:ua}),t=m[0].minValue,sa=m[m.length-1].maxValue,va=m.map(xa=>[xa.minValue,xa.maxValue])):(null!=na&&null!=ta?(t=na,sa=ta):(m=n({values:m,minValue:na,maxValue:ta,useSampleStdDev:!Z,supportsNullCount:L({normalizationType:Z,normalizationField:ca,minValue:na,maxValue:ta})}),t=m.min??
null,sa=m.max??null),va=r(t??0,sa??0,ua));return{min:t,max:sa,intervals:va}}function a(m,t){let M=-1;for(let I=m.length-1;0<=I;I--)if(t>=m[I][0]){M=I;break}return M}function r(m,t,M){const I=(t-m)/M,S=[];let Z;for(let ca=1;ca<=M;ca++)Z=m+I,Z=Number(Z.toFixed(16)),S.push([m,ca===M?t:Z]),m=Z;return S}const z=/\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*/gi,E=new Set("esriFieldTypeDate esriFieldTypeInteger esriFieldTypeSmallInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong esriFieldTypeOID esriFieldTypeBigInteger".split(" ")),
R=new Set(["esriFieldTypeTimeOnly","esriFieldTypeDateOnly"]),d="min max avg stddev count sum variance nullcount median".split(" "),G=(m,t)=>null==m?null==t?0:1:null==t?-1:null,T=(m,t)=>null==m?null==t?0:-1:null==t?1:null,J=(m,t)=>T(m,t)??(m===t?0:(new Date(m)).getTime()-(new Date(t)).getTime()),Q=(m,t)=>G(m,t)??(m===t?0:(new Date(t)).getTime()-(new Date(m)).getTime()),P=(m,t)=>T(m,t)??(m===t?0:m<t?-1:1),V=(m,t)=>G(m,t)??(m===t?0:m<t?1:-1),l=(m,t)=>G(m,t)??t-m,N=(m,t)=>T(m,t)??m-t;c.calculateClassBreaks=
H;c.calculateHistogram=function(m,t){var M=q(m,t);if(null==M.min&&null==M.max)return{bins:[],minValue:M.min,maxValue:M.max,normalizationTotal:t.normalizationTotal};const I=M.intervals,S=M.min??0;M=M.max??0;const Z=I.map((ca,ja)=>({minValue:I[ja][0],maxValue:I[ja][1],count:0}));for(const ca of m)null!=ca&&ca>=S&&ca<=M&&(m=a(I,ca),-1<m&&Z[m].count++);return{bins:Z,minValue:S,maxValue:M,normalizationTotal:t.normalizationTotal}};c.calculatePercentile=g;c.calculateStatistics=n;c.calculateStringStatistics=
function(m){const t=m.returnDistinct?[...(new Set(m.values))]:m.values;var M=t.filter(S=>null!=S).sort();const I=M.length;M={count:I,min:M[0],max:M[I-1]};m.supportsNullCount&&(M.nullcount=t.length-I);m.percentileParams&&(M.median=g(t,m.percentileParams));return M};c.calculateUniqueValuesCount=function(m){const t={};for(let M of m){if(null==M||"string"===typeof M&&""===M.trim())M=null;null==t[M]?t[M]={count:1,data:M}:t[M].count++}return{count:t}};c.createClassBreaksDefinition=v;c.createUVResult=function(m,
t,M,I){m=m.count;const S=[];if(M&&t){M=[];var Z=x(t[0]);for(const ca of Z)if(t[1]){Z=x(t[1]);for(const ja of Z)if(t[2]){Z=x(t[2]);for(const na of Z)M.push(`${w(ca)}${I}${w(ja)}${I}${w(na)}`)}else M.push(`${w(ca)}${I}${w(ja)}`)}else M.push(ca);for(const ca of M)m.hasOwnProperty(ca)||(m[ca]={data:ca,count:0})}for(const ca in m)t=m[ca],S.push({value:t.data,count:t.count,label:t.label});return{uniqueValueInfos:S}};c.getAttributeComparator=u;c.getEqualIntervalBins=r;c.getNormalizedValue=function(m,t,M,
I){let S=null;switch(t){case "log":0!==m&&(S=Math.log(m)*Math.LOG10E);break;case "percent-of-total":Number.isFinite(I)&&0!==I&&(S=m/I*100);break;case "field":Number.isFinite(M)&&0!==M&&(S=m/M);break;case "natural-log":0<m&&(S=Math.log(m));break;case "square-root":0<m&&(S=m**.5)}return S};c.isNullCountSupported=L;c.processNullValue=w;c.processSummaryStatisticsResult=function(m,t){let M;for(M in m)d.includes(M)&&(Number.isFinite(m[M])||(m[M]=null));if(!t)return m;["avg","stddev","variance"].forEach(I=>
{null!=m[I]&&(m[I]=Math.ceil(m[I]??0))});return m};c.resolveCBResult=function(m,t){let M=m.classBreaks;const I=M[0]?.minValue,S=M[M.length-1]?.maxValue,Z="standard-deviation"===t;M=M.map(ca=>{const ja=ca.label;ca={minValue:ca.minValue,maxValue:ca.maxValue,label:ja};if(Z&&ja){const na=ja.match(z)?.map(ta=>+ta.trim())??[];2===na.length?(ca.minStdDev=na[0],ca.maxStdDev=na[1],0>na[0]&&0<na[1]&&(ca.hasAvg=!0)):1===na.length&&(ja.includes("\x3c")?(ca.minStdDev=null,ca.maxStdDev=na[0]):ja.includes("\x3e")&&
(ca.minStdDev=na[0],ca.maxStdDev=null))}return ca});return{minValue:I,maxValue:S,classBreakInfos:M,normalizationTotal:m.normalizationTotal}};c.statisticTypes=d;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/ClassBreaksDefinition":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),
function(c,e,A,w,L,n,g,u,f){L=new e.JSONMap({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"});e=new e.JSONMap({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});A=class extends A.JSONSupport{constructor(p){super(p);this.type="class-breaks-definition";
this.normalizationType=this.normalizationField=this.classificationMethod=this.classificationField=this.breakCount=null}set standardDeviationInterval(p){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",p)}set definedInterval(p){"defined-interval"===this.classificationMethod&&this._set("definedInterval",p)}};c.__decorate([u.enumeration({classBreaksDef:"class-breaks-definition"})],A.prototype,"type",void 0);c.__decorate([w.property({json:{write:!0}})],A.prototype,
"breakCount",void 0);c.__decorate([w.property({json:{write:!0}})],A.prototype,"classificationField",void 0);c.__decorate([w.property({type:String,json:{read:L.read,write:L.write}})],A.prototype,"classificationMethod",void 0);c.__decorate([w.property({json:{write:!0}})],A.prototype,"normalizationField",void 0);c.__decorate([w.property({json:{read:e.read,write:e.write}})],A.prototype,"normalizationType",void 0);c.__decorate([w.property({value:null,json:{write:!0}})],A.prototype,"standardDeviationInterval",
null);c.__decorate([w.property({value:null,json:{write:!0}})],A.prototype,"definedInterval",null);return A=c.__decorate([f.subclass("esri.rest.support.ClassBreaksDefinition")],A)})},"esri/core/accessorSupport/decorators/enumeration":function(){define(["exports","../../jsonMap","./property"],function(c,e,A){c.enumeration=function(w,L={}){w=w instanceof e.JSONMap?w:new e.JSONMap(w,L);w={type:L?.ignoreUnknown??!0?w.apiValues:String,json:{type:w.jsonValues,read:L?.readOnly?!1:{reader:w.read},write:{writer:w.write}}};
void 0!==L?.readOnly&&(w.readOnly=!!L.readOnly);void 0!==L?.default&&(w.json.default=L.default);void 0!==L?.name&&(w.json.name=L.name);void 0!==L?.nonNullable&&(w.nonNullable=L.nonNullable);return A.property(w)};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/generateRendererUtils":function(){define(["exports","../../core/Logger"],function(c,e){function A(D){var v=D.definition;const {classificationMethod:q,normalizationType:a,definedInterval:r}=v;v=v.breakCount??
1;const z=[];var E=D.values;if(0===E.length)return[];E=E.sort((Q,P)=>Q-P);var R=E[0],d=E[E.length-1];if("equal-interval"===q)if(E.length>=v){E=(d-R)/v;D=R;for(var G=1;G<v;G++){var T=Number((R+G*E).toFixed(6));z.push({minValue:D,maxValue:T,label:w(D,T,a)});D=T}z.push({minValue:D,maxValue:d,label:w(D,d,a)})}else E.forEach(Q=>{z.push({minValue:Q,maxValue:Q,label:w(Q,Q,a)})});else if("natural-breaks"===q){E=L(E);D=n(E.uniqueValues,D.valueFrequency||E.valueFrequency,v);for(G=1;G<v;G++)E.uniqueValues.length>
G&&(T=Number(E.uniqueValues[D[G]].toFixed(6)),z.push({minValue:R,maxValue:T,label:w(R,T,a)}),R=T);z.push({minValue:R,maxValue:d,label:w(R,d,a)})}else if("quantile"===q)if(E.length>=v&&R!==d){D=Math.ceil(E.length/v);G=0;for(T=1;T<v;T++){var J=D+G-1;J>E.length&&(J=E.length-1);0>J&&(J=0);z.push({minValue:R,maxValue:E[J],label:w(R,E[J],a)});R=E[J];G+=D;D=Math.ceil((E.length-G)/(v-T))}z.push({minValue:R,maxValue:d,label:w(R,d,a)})}else for(v=-1,d=0;d<E.length;d++)R=E[d],R!==v&&(v=R,z.push({minValue:v,
maxValue:R,label:w(v,R,a)}),v=R);else if("standard-deviation"===q)if(D=f(E),G=p(E,D),0===G)z.push({minValue:E[0],maxValue:E[0],label:w(E[0],E[0],a)});else{E=u(R,d,v,D,G)*G;G=0;for(T=v;1<=T;T--)J=Number((D-(T-.5)*E).toFixed(6)),z.push({minValue:R,maxValue:J,label:w(R,J,a)}),R=J,G++;T=Number((D+.5*E).toFixed(6));z.push({minValue:R,maxValue:T,label:w(R,T,a)});R=T;G++;for(J=1;J<=v;J++)T=G===2*v?d:Number((D+(J+.5)*E).toFixed(6)),z.push({minValue:R,maxValue:T,label:w(R,T,a)}),R=T,G++}else if("defined-interval"===
q){if(!r)return z;v=E[0];d=E[E.length-1];E=Math.ceil((d-v)/r);R=v;for(D=1;D<E;D++)G=Number((v+D*r).toFixed(6)),z.push({minValue:R,maxValue:G,label:w(R,G,a)}),R=G;z.push({minValue:R,maxValue:d,label:w(R,d,a)})}return z}function w(D,v,q){let a=null;return a=D===v?q&&"percent-of-total"===q?D+"%":D.toString():q&&"percent-of-total"===q?D+"% - "+v+"%":D+" - "+v}function L(D){const v=[],q=[];let a=Number.MIN_VALUE,r=1,z=-1;for(let E=0;E<D.length;E++){const R=D[E];R===a?(r++,q[z]=r):null!==R&&(v.push(R),
a=R,r=1,q.push(r),z++)}return{uniqueValues:v,valueFrequency:q}}function n(D,v,q){var a=D.length;const r=[];q>a&&(q=a);for(var z=0;z<q;z++)r.push(Math.round(z*a/q-1));r.push(a-1);z=g(r,D,v,q);a=z.mean;z=z.sdcm;var E=q,R=0,d=0;let G=0,T=0,J=!0;for(let P=0;2>P&&J;P++){0===P&&(J=!1);for(var Q=0;Q<E-1;Q++)for(;r[Q+1]+1!==r[Q+2];)if(r[Q+1]+=1,R=x(Q,r,D,v),G=R.sbMean,R=R.sbSdcm,d=x(Q+1,r,D,v),T=d.sbMean,d=d.sbSdcm,R+d<z[Q]+z[Q+1])z[Q]=R,z[Q+1]=d,a[Q]=G,a[Q+1]=T,J=!0;else{--r[Q+1];break}for(Q=E-1;0<Q;Q--)for(;r[Q]!==
r[Q-1]+1;)if(--r[Q],R=x(Q-1,r,D,v),G=R.sbMean,R=R.sbSdcm,d=x(Q,r,D,v),T=d.sbMean,d=d.sbSdcm,R+d<z[Q-1]+z[Q])z[Q-1]=R,z[Q]=d,a[Q-1]=G,a[Q]=T,J=!0;else{r[Q]+=1;break}}J&&(z=g(r,D,v,q));return r}function g(D,v,q,a){let r=[];var z=[],E=[];let R=0;const d=[],G=[];for(var T=0;T<a;T++){var J=x(T,D,v,q);d.push(J.sbMean);G.push(J.sbSdcm);R+=G[T]}J=R;for(T=!0;T||R<J;){T=!1;r=[];for(z=0;z<a;z++)r.push(D[z]);for(E=0;E<a;E++)for(J=D[E]+1;J<=D[E+1];J++)if(z=v[J],0<E&&J!==D[E+1]&&Math.abs(z-d[E])>Math.abs(z-d[E-
1]))D[E]=J;else if(E<a-1&&D[E]!==J-1&&Math.abs(z-d[E])>Math.abs(z-d[E+1])){D[E+1]=J-1;break}J=R;R=0;z=[];E=[];for(let Q=0;Q<a;Q++){z.push(d[Q]);E.push(G[Q]);const P=x(Q,D,v,q);d[Q]=P.sbMean;G[Q]=P.sbSdcm;R+=G[Q]}}if(R>J){for(v=0;v<a;v++)D[v]=r[v],d[v]=z[v],G[v]=E[v];R=J}return{mean:d,sdcm:G}}function u(D,v,q,a,r){D=Math.max(a-D,v-a)/r/q;return 1<=D?1:.5<=D?.5:.25}function f(D){let v=0;for(let q=0;q<D.length;q++)v+=D[q];return v/=D.length}function p(D,v){let q=0;for(let a=0;a<D.length;a++){const r=
D[a];q+=(r-v)*(r-v)}q/=D.length;return Math.sqrt(q)}function x(D,v,q,a){var r=0,z=0;for(var E=v[D]+1;E<=v[D+1];E++){const R=a[E];r+=q[E]*R;z+=R}0>=z&&H.warn("Exception in Natural Breaks calculation");r/=z;z=0;for(E=v[D]+1;E<=v[D+1];E++)z+=a[E]*(q[E]-r)**2;return{sbMean:r,sbSdcm:z}}const H=e.getLogger("esri.rest.support.generateRendererUtils");c.createGenerateRendererClassBreaks=function(D){const {normalizationTotal:v}=D;return{classBreaks:A(D),normalizationTotal:v}};c.createGenerateRendererUniqueValues=
function(D){D=L(D);const v=[],q=D.uniqueValues.length;for(let a=0;a<q;a++){const r=D.uniqueValues[a];v.push({value:r,count:D.valueFrequency[a],label:r.toString()})}return{uniqueValues:v}};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/SnappingCandidate":function(){define(["exports"],function(c){c.makeEdgeCandidate=function(e,A,w,L,n,g=!1){return{objectId:e,target:A,distance:w,type:"edge",start:L,end:n,draped:g}};c.makeVertexCandidate=function(e,A,w){return{objectId:e,
target:A,distance:w,type:"vertex"}};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/queryUtils":function(){define("require exports ../../../core/jsonMap ../../../core/unitUtils ../../../geometry/projection ../../../geometry/support/extentUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ./projectionSupport".split(" "),function(c,e,A,w,L,n,g,u,f,p){async function x(r,z,E){if(!r)return null;
var {where:R}=r;r.where=R=R?.trim();if(!R||/^1 *= *1$/.test(R)||z&&z===R)r.where=null;if(!r.geometry)return r;z=await D(r);r.distance=0;r.units=null;"esriSpatialRelEnvelopeIntersects"===r.spatialRel&&({spatialReference:R}=r.geometry,z=n.getGeometryExtent(z),z.spatialReference=R);if(z){await p.checkProjectionSupport(z.spatialReference,E);R=z.spatialReference;z=H(z,E)&&g.isExtent(z)?{spatialReference:R,rings:[[[z.xmin,z.ymin],[z.xmin,z.ymax],[z.xmax,z.ymax],[z.xmax,z.ymin],[z.xmin,z.ymin]]]}:z;R=(await u.normalizeCentralMeridian(g.fromJSON(z)))[0];
if(null==R)throw a;const d="quantizationParameters"in r&&r.quantizationParameters?.tolerance||"maxAllowableOffset"in r&&r.maxAllowableOffset||0;z=d&&H(z,E)?{densificationStep:8*d}:void 0;R=R.toJSON();z=p.project(R,R.spatialReference,E,z);if(!z)throw a;z.spatialReference=E;r.geometry=z}return r}function H(r,z){if(!r)return!1;const E=r.spatialReference;return(g.isExtent(r)||g.isPolygon(r)||g.isPolyline(r))&&!f.equals(E,z)&&!L.canProjectWithoutEngine(E,z)}async function D(r){const {distance:z,units:E}=
r,R=r.geometry;if(null==z||"vertexAttributes"in R)return R;var d=R.spatialReference;r=E?q.fromJSON(E):w.getUnitString(d);d=d&&(f.isGeographic(d)||f.isWebMercator(d))?R:await p.checkProjectionSupport(d,f.WGS84).then(()=>p.project(R,f.WGS84));return(await v())(d.spatialReference,d,z,r)}async function v(){return(await new Promise((r,z)=>c(["../../../geometry/geometryEngineJSON"],r,z))).geodesicBuffer}const q=new A.JSONMap({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",
esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),a=Object.freeze({});e.normalizeQuery=async function(r,z,E){const {outFields:R,orderByFields:d,groupByFieldsForStatistics:G,outStatistics:T}=r;if(R)for(var J=0;J<R.length;J++)R[J]=R[J].trim();if(d)for(J=0;J<d.length;J++)d[J]=d[J].trim();if(G)for(J=0;J<G.length;J++)G[J]=G[J].trim();if(T)for(J=0;J<T.length;J++)T[J].onStatisticField&&(T[J].onStatisticField=T[J].onStatisticField.trim());
r.geometry&&!r.outSR&&(r.outSR=r.geometry.spatialReference);return x(r,z,E)};e.normalizeQueryLike=x;e.queryEngineEmptyResult=a;e.unitsKebabDict=q;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/queryValidationUtils":function(){define("exports ../../../core/Error ./attributeSupport ./projectionSupport ./spatialQuerySupport ../../../support/arcadeOnDemand".split(" "),function(c,e,A,w,L,n){function g(H,D,v){const {outFields:q,orderByFields:a,returnDistinctValues:r,
outStatistics:z}=v,E=z?z.map(R=>R.outStatisticFieldName&&R.outStatisticFieldName.toLowerCase()).filter(Boolean):[];if(a&&0<a.length){const R=a.map(d=>{const G=d.toLowerCase();return G.includes(" asc")?G.split(" asc")[0]:G.includes(" desc")?G.split(" desc")[0]:d}).filter(d=>!E.includes(d));A.validateFields(H,D,R,{expressionName:"orderByFields",query:v})}if(q&&0<q.length)A.validateFields(H,D,q,{expressionName:"outFields",query:v});else if(r)throw new e("unsupported-query","outFields should be specified for returnDistinctValues",
{query:v});A.validateWhere(H,D,v.where,v)}function u(H,D,v){const {outStatistics:q,groupByFieldsForStatistics:a,having:r}=v;var z=a?.length,E=q?.length;if(r){if(!z||!E)throw new e("unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:v});A.validateHaving(H,D,r,q,v)}if(E&&p(q)){E=q.map(R=>R.onStatisticField).filter(Boolean);A.validateFields(H,D,E,{expressionName:"onStatisticFields",query:v});z&&A.validateFields(H,D,a,{expressionName:"groupByFieldsForStatistics",
query:v});for(const R of q){const {onStatisticField:d,statisticType:G}=R;if(("percentile_disc"===G||"percentile_cont"===G)&&"statisticParameters"in R){if({statisticParameters:z}=R,!z)throw new e("unsupported-query","statisticParameters should be set for percentile type",{definition:R,query:v});}else H.get(d)&&"count"!==G&&"min"!==G&&"max"!==G&&A.validateFields(H,D,[d],{expressionName:`outStatistics with '${G}' statistic type`,allowedFieldTypes:x,query:v})}}}async function f(H,D,v,q){var a=[];v.valueExpression&&
({arcadeUtils:a}=await n.loadArcade(),a=a.extractFieldNames(v.valueExpression));v.field&&a.push(v.field);v.field2&&a.push(v.field2);v.field3&&a.push(v.field3);v.normalizationField&&a.push(v.normalizationField);if(!a.length&&!v.valueExpression)throw new e("unsupported-query","field or valueExpression is required",{params:v});A.validateFields(H,D,a,{expressionName:"statistics",query:q})}function p(H){return null!=H&&H.every(D=>"exceedslimit"!==D.statisticType)}const x=new Set([...A.numericFieldTypes,
...A.allDateAndTimeFieldTypes]);c.validateQuery=async function(H,{fieldsIndex:D,geometryType:v,spatialReference:q,availableFields:a}){if(0>(H.distance??0)||null!=H.geometryPrecision||H.multipatchOption&&"xyFootprint"!==H.multipatchOption||H.pixelSize||H.relationParam||H.text)throw new e("unsupported-query","Unsupported query options",{query:H});g(D,a,H);u(D,a,H);return Promise.all([L.checkSpatialQuerySupport(H,v,q),w.checkProjectionSupport(q,H.outSR)]).then(()=>H)};c.validateStatisticsQuery=async function(H,
D,{fieldsIndex:v,geometryType:q,spatialReference:a,availableFields:r}){if(0>(H.distance??0)||null!=H.geometryPrecision||H.multipatchOption||H.pixelSize||H.relationParam||H.text||H.outStatistics||H.groupByFieldsForStatistics||H.having||H.orderByFields)throw new e("unsupported-query","Unsupported query options",{query:H});g(v,r,H);return Promise.all([f(v,r,D,H),L.checkSpatialQuerySupport(H,q,a),w.checkProjectionSupport(a,H.outSR)]).then(()=>H)};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},
"esri/layers/graphics/data/spatialQuerySupport":function(){define("require exports ../../../core/Error ../../../geometry/support/contains ../../../geometry/support/intersects ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ../contains ../featureConversionUtils ../OptimizedGeometry ./geometryUtils ./projectionSupport".split(" "),function(c,e,A,w,L,n,g,u,f,p,x,H){function D(){return new Promise((z,E)=>c(["../../../geometry/geometryEngineJSON"],z,E))}const v={esriSpatialRelIntersects:"intersects",
esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null};var q={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,
esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},a={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},r={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};e.canQueryWithRBush=function(z){if(n.isExtent(z))return!0;if(n.isPolygon(z)){for(const E of z.rings)if(5!==E.length||E[0][0]!==E[1][0]||E[0][0]!==E[4][0]||E[2][0]!==E[3][0]||E[0][1]!==E[3][1]||E[0][1]!==
E[4][1]||E[1][1]!==E[2][1])return!1;return!0}return!1};e.checkSpatialQuerySupport=async function(z,E,R){const {spatialRel:d,geometry:G}=z;if(G){if(null==d||!0!==q[d])throw new A("unsupported-query","Unsupported query spatial relationship",{query:z});if(g.isValid(G.spatialReference)&&g.isValid(R)){if(null==G||!0!==a[n.getJsonType(G)])throw new A("unsupported-query","Unsupported query geometry type",{query:z});if(null==E||!0!==r[E])throw new A("unsupported-query","Unsupported layer geometry type",{query:z});
if(z.outSR)return H.checkProjectionSupport(z.geometry?.spatialReference,z.outSR)}}};e.getSpatialQueryOperator=function(z,E,R,d,G){if(n.isPolygon(E)&&"esriGeometryPoint"===R&&("esriSpatialRelIntersects"===z||"esriSpatialRelContains"===z)){const T=f.convertFromPolygon(new p,E,!1,!1);return Promise.resolve(J=>u.polygonContainsPoint(T,!1,!1,J))}if(n.isPolygon(E)&&"esriGeometryMultipoint"===R){const T=f.convertFromPolygon(new p,E,!1,!1);if("esriSpatialRelContains"===z)return Promise.resolve(J=>u.polygonContainsMultipoint(T,
!1,!1,J,d,G))}if(n.isExtent(E)&&"esriGeometryPoint"===R&&("esriSpatialRelIntersects"===z||"esriSpatialRelContains"===z))return Promise.resolve(T=>w.extentContainsPoint(E,x.getGeometry(R,d,G,T)));if(n.isExtent(E)&&"esriGeometryMultipoint"===R&&"esriSpatialRelContains"===z)return Promise.resolve(T=>w.extentContainsMultipoint(E,x.getGeometry(R,d,G,T)));if(n.isExtent(E)&&"esriSpatialRelIntersects"===z){const T=L.getExtentIntersector(R);return Promise.resolve(J=>T(E,x.getGeometry(R,d,G,J)))}return D().then(T=>
{const J=T[v[z]].bind(null,E.spatialReference,E);return Q=>J(x.getGeometry(R,d,G,Q))})};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/intersects":function(){define(["exports","./intersectsBase"],function(c,e){c.extentIntersectsExtent=e.extentIntersectsExtent;c.extentIntersectsMultipoint=e.extentIntersectsMultipoint;c.extentIntersectsPoint=e.extentIntersectsPoint;c.extentIntersectsPolygon=e.extentIntersectsPolygon;c.extentIntersectsPolyline=e.extentIntersectsPolyline;
c.extentIntersectsRings=e.extentIntersectsRings;c.getFeatureExtentIntersector=e.getFeatureExtentIntersector;c.isSelfIntersecting=e.isSelfIntersecting;c.segmentIntersects=e.segmentIntersects;c.getExtentIntersector=function(A){return"mesh"===A?e.extentIntersectsExtent:e.getFeatureExtentIntersector(A)};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/contains":function(){define(["exports"],function(c){function e(A,w,L,n,g){if(!A)return!1;w=w?L?4:3:L?3:2;const {coords:u,
lengths:f}=A;L=!1;A=0;for(const x of f){var p=A;for(let H=A,D=A+x*w;H<D;H+=w){p=H+w;p===D&&(p=A);const v=u[H],q=u[H+1],a=u[p];p=u[p+1];(q<g&&p>=g||p<g&&q>=g)&&v+(g-q)/(p-q)*(a-v)<n&&(L=!L)}A+=x*w}return L}c.polygonContainsCoords=e;c.polygonContainsMultipoint=function(A,w,L,n,g,u){g=g?u?4:3:u?3:2;const {coords:f,lengths:p}=n;if(!p)return!1;for(let x=0,H=0;x<p.length;x++,H+=g)if(!e(A,w,L,f[H],f[H+1]))return!1;return!0};c.polygonContainsPoint=function(A,w,L,n){return e(A,w,L,n.coords[0],n.coords[1])};
Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/timeSupport":function(){define(["exports"],function(c){function e(L,n,g,u,f){if(null!=u&&null!=f)return p=>{const x=L(p,n);p=L(p,g);return(null==x||x<=f)&&(null==p||p>=u)};if(null!=u)return p=>{p=L(p,g);return null==p||p>=u};if(null!=f)return p=>{p=L(p,n);return null==p||p<=f}}function A(L,n,g,u){if(null!=g&&null!=u&&g===u)return f=>L(f,n)===g;if(null!=g&&null!=u)return f=>{f=L(f,n);return null!=f&&f>=g&&f<=
u};if(null!=g)return f=>{f=L(f,n);return null!=f&&f>=g};if(null!=u)return f=>{f=L(f,n);return null!=f&&f<=u}}function w(){return()=>!1}c.getTimeExtent=async function(L,n){if(!L)return null;const g=n.featureAdapter,{startTimeField:u,endTimeField:f}=L;let p=Number.POSITIVE_INFINITY,x=Number.NEGATIVE_INFINITY;if(u&&f)await n.forEach(H=>{const D=g.getAttribute(H,u);H=g.getAttribute(H,f);null==D||isNaN(D)||(p=Math.min(p,D));null==H||isNaN(H)||(x=Math.max(x,H))});else{const H=u||f;await n.forEach(D=>{D=
g.getAttribute(D,H);null==D||isNaN(D)||(p=Math.min(p,D),x=Math.max(x,D))})}return{start:p,end:x}};c.getTimeOperator=function(L,n,g){if(!n||!L)return null;const {startTimeField:u,endTimeField:f}=L;if(!u&&!f)return null;const {start:p,end:x}=n;if(null===p&&null===x)return null;if(void 0===p&&void 0===x)return w();L=g.getAttributeAsTimestamp?.bind(g)??g.getAttribute.bind(g);return u&&f?e(L,u,f,p,x):A(L,u||f,p,x)};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/FieldsIndex":function(){define("../../core/Error ../../core/JSONSupport ../../core/Logger ../../core/MapUtils ../../core/sql/UnknownTimeZone ./fieldUtils ../../time/timeZoneUtils ../../chunks/datetime".split(" "),
function(c,e,A,w,L,n,g,u){function f(v){return v.trim().toLowerCase()}function p(v){const q=new Map;if(!v.fields)return q;const a=!0===v.datesInUnknownTimezone,{timeInfo:r,editFieldsInfo:z}=v;var E=(r?"startField"in r?r.startField:r.startTimeField:"")??"";const R=(r?"endField"in r?r.endField:r.endTimeField:"")??"",d="dateFieldsTimeZone"in v?v.dateFieldsTimeZone??null:v.dateFieldsTimeReference?g.fromTimeReference(v.dateFieldsTimeReference):null,G=z?"timeZone"in z?z.timeZone??d:z.dateFieldsTimeReference?
g.fromTimeReference(z.dateFieldsTimeReference):d??g.utc:null,T=r?"timeZone"in r?r.timeZone??d:r.timeReference?g.fromTimeReference(r.timeReference):d:null;E=new Map([[f(z?.creationDateField??""),G],[f(z?.editDateField??""),G],[f(E),T],[f(R),T]]);for(const {name:J,type:Q}of v.fields)D.has(Q)?q.set(J,g.unknown):"date"!==Q&&"esriFieldTypeDate"!==Q?q.set(J,null):a?q.set(J,g.unknown):(v=E.get(f(J??""))??d,q.set(J,v));return q}const x=new Map;class H{static fromJSON(v){return new H(v.fields,v.timeZoneByFieldName)}static fromLayer(v){return new H(v.fields??
[],p(v))}static fromLayerJSON(v){return new H(v.fields??[],p(v))}constructor(v=[],q){this._fieldsMap=new Map;this._normalizedFieldsMap=new Map;this._dateFieldsSet=new Set;this._numericFieldsSet=new Set;this._requiredFields=null;this.dateFields=[];this.numericFields=[];this.fields=v||[];this._timeZoneByFieldName=q?new Map(q):null;v=[];for(const a of this.fields){q=a?.name;const r=n.normalizeFieldName(q)?.toLowerCase()??"";if(q&&r){const z=f(q);this._fieldsMap.set(q,a);this._fieldsMap.set(z,a);this._normalizedFieldsMap.set(r,
a);v.push(`${z}:${a.type}:${this._timeZoneByFieldName?.get(q)}`);n.isDateField(a)?(this.dateFields.push(a),this._dateFieldsSet.add(a)):n.isNumericField(a)&&(this._numericFieldsSet.add(a),this.numericFields.push(a));n.isObjectIDField(a)||n.isGlobalIDField(a)||(a.editable=null==a.editable||!!a.editable,a.nullable=null==a.nullable||!!a.nullable)}}v.sort();this.uid=v.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const v of this.fields)n.isObjectIDField(v)||n.isGlobalIDField(v)||
v.nullable||void 0!==n.getFieldDefaultValue(v)||this._requiredFields.push(v)}return this._requiredFields}equals(v){return this.uid===v?.uid}has(v){return null!=this.get(v)}get(v){if(v){var q=this._fieldsMap.get(v);if(q)return q;(q=this._fieldsMap.get(f(v))??this._normalizedFieldsMap.get(n.normalizeFieldName(v)?.toLowerCase()??""))&&this._fieldsMap.set(v,q);return q}}getTimeZone(v){v=this.get(v&&"string"!==typeof v?v.name:v);return v?this._timeZoneByFieldName?this._timeZoneByFieldName.get(v.name):
"date"===v.type||"esriFieldTypeDate"===v.type?(A.getLogger("esri.layers.support.FieldsIndex").error(new c("getTimeZone:no-timezone-information",`no time zone information for field '${v.name}'`)),g.utc):D.has(v.type)?g.unknown:null:null}getLuxonTimeZone(v){const q=this.getTimeZone(v);return q?q===g.unknown?L.UnknownTimeZone.instance:q===g.utc?u.FixedOffsetZone.utcInstance:w.getOrCreateMapValue(x,q,()=>u.IANAZone.create(q)):null}isDateField(v){return this._dateFieldsSet.has(this.get(v))}isTimeOnlyField(v){return n.isTimeOnlyField(this.get(v))}isNumericField(v){return this._numericFieldsSet.has(this.get(v))}normalizeFieldName(v){return this.get(v)?.name??
void 0}toJSON(){return{fields:this.fields.map(v=>e.isSerializable(v)?v.toJSON():v),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}}const D=new Set("time-only date-only timestamp-offset esriFieldTypeDateOnly esriFieldTypeTimeOnly esriFieldTypeTimestampOffset".split(" "));return H})},"esri/views/support/Scheduler":function(){define("exports ../../core/Handles ../../core/has ../../core/Logger ../../core/maybe ../../core/PerformanceSampler ../../core/PooledArray ../../core/promiseUtils ../../core/reactiveUtils ../../core/signal ../../core/time ../../layers/support/PromiseQueue ./debugFlags ./RenderState".split(" "),
function(c,e,A,w,L,n,g,u,f,p,x,H,D,v){function q(P){return a.has(P)?a.get(P):"number"===typeof P?P:1}c.Task=void 0;(function(P){P[P.YIELD=1]="YIELD"})(c.Task||(c.Task={}));c.TaskPriority=void 0;(function(P){P.RESOURCE_CONTROLLER_IMMEDIATE="immediate";P.RESOURCE_CONTROLLER="schedule";P.SLIDE="slide";P.STREAM_DATA_LOADER="stream loader";P.ELEVATION_QUERY="elevation query";P.TERRAIN_SURFACE="terrain";P.SURFACE_GEOMETRY_UPDATES="surface geometry updates";P.LOD_RENDERER="LoD renderer";P.GRAPHICS_CORE=
"Graphics3D";P.I3S_CONTROLLER="I3S";P.POINT_CLOUD_LAYER="point cloud";P.FEATURE_TILE_FETCHER="feature fetcher";P.OVERLAY="overlay";P.STAGE="stage";P.GRAPHICS_DECONFLICTOR="graphics deconflictor";P.FILTER_VISIBILITY="Graphics3D filter visibility";P.SCALE_VISIBILITY="Graphics3D scale visibility";P.FRUSTUM_VISIBILITY="Graphics3D frustum visibility";P.POINT_OF_INTEREST_FREQUENT="POI frequent";P.POINT_OF_INTEREST_INFREQUENT="POI infrequent";P.LABELER="labeler";P.FEATURE_QUERY_ENGINE="feature query";P.FEATURE_TILE_TREE=
"feature tile tree";P.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree";P.ELEVATION_ALIGNMENT="elevation alignment";P.TEXT_TEXTURE_ATLAS="text texture atlas";P.TEXTURE_UNLOAD="texture unload";P.LINE_OF_SIGHT_TOOL="line of sight tool";P.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool";P.ELEVATION_PROFILE="elevation profile";P.SNAPPING="snapping";P.SHADOW_ACCUMULATOR="shadow accumulator";P.CLOUDS_GENERATOR="clouds generator";P[P.NONE=0]="NONE";P[P.TEST_PRIO=1]="TEST_PRIO"})(c.TaskPriority||
(c.TaskPriority={}));const a=new Map([[c.TaskPriority.RESOURCE_CONTROLLER_IMMEDIATE,0],[c.TaskPriority.RESOURCE_CONTROLLER,4],[c.TaskPriority.SLIDE,0],[c.TaskPriority.STREAM_DATA_LOADER,0],[c.TaskPriority.ELEVATION_QUERY,0],[c.TaskPriority.TERRAIN_SURFACE,1],[c.TaskPriority.SURFACE_GEOMETRY_UPDATES,1],[c.TaskPriority.LOD_RENDERER,2],[c.TaskPriority.GRAPHICS_CORE,2],[c.TaskPriority.I3S_CONTROLLER,2],[c.TaskPriority.POINT_CLOUD_LAYER,2],[c.TaskPriority.FEATURE_TILE_FETCHER,2],[c.TaskPriority.OVERLAY,
4],[c.TaskPriority.STAGE,4],[c.TaskPriority.GRAPHICS_DECONFLICTOR,4],[c.TaskPriority.FILTER_VISIBILITY,4],[c.TaskPriority.SCALE_VISIBILITY,4],[c.TaskPriority.FRUSTUM_VISIBILITY,4],[c.TaskPriority.CLOUDS_GENERATOR,4],[c.TaskPriority.POINT_OF_INTEREST_FREQUENT,6],[c.TaskPriority.POINT_OF_INTEREST_INFREQUENT,30],[c.TaskPriority.LABELER,8],[c.TaskPriority.FEATURE_QUERY_ENGINE,8],[c.TaskPriority.FEATURE_TILE_TREE,16],[c.TaskPriority.FEATURE_TILE_TREE_ACTIVE,0],[c.TaskPriority.ELEVATION_ALIGNMENT,12],[c.TaskPriority.TEXT_TEXTURE_ATLAS,
12],[c.TaskPriority.TEXTURE_UNLOAD,12],[c.TaskPriority.LINE_OF_SIGHT_TOOL,16],[c.TaskPriority.LINE_OF_SIGHT_TOOL_INTERACTIVE,0],[c.TaskPriority.SNAPPING,0],[c.TaskPriority.SHADOW_ACCUMULATOR,30]]),r=x.Milliseconds(6.5),z=x.Milliseconds(1),E=x.Milliseconds(30),R=x.Milliseconds(1E3/30),d=x.Milliseconds(100);var G;(function(P){class V{get updating(){return this._updating.value}_updatingChanged(){this._updating.value=this._tasks.some(m=>m.needsUpdate)}constructor(){this._updating=p.signal(!0);this._microTaskQueued=
!1;this._frameNumber=0;this.performanceInfo={total:new n("total"),tasks:new Map};this._frameTaskTimes=new Map;this._budget=new N;this._state=v.RenderState.INTERACTING;this._tasks=new g;this._runQueue=new g;this._load=0;this._idleStateCallbacks=new g;this._debug=this._forceTask=this._idleUpdatesStartFired=!1;this._debugHandle=f.watch(()=>D.SCHEDULER_LOG_SLOW_TASKS,t=>this._debug=t,f.initial);for(const t of Object.keys(c.TaskPriority))this.performanceInfo.tasks.set(c.TaskPriority[t],new n(c.TaskPriority[t]));
const m=this;this._test={FRAME_SAFETY_BUDGET:r,INTERACTING_BUDGET:R,IDLE_BUDGET:d,get availableBudget(){return m._budget.budget},usedBudget:0,getBudget:()=>m._budget,setBudget:t=>m._budget=t,updateTask:t=>this._updateTask(t),getState:t=>this._getState(t),getRuntime:t=>this._getRuntime(t),frameTaskTimes:this._frameTaskTimes,resetRuntimes:()=>this._resetRuntimes(),getRunning:()=>this._getRunning()}}destroy(){this._tasks.toArray().forEach(m=>m.remove());this._tasks.clear();L.removeMaybe(this._debugHandle);
this._microTaskQueued=!1;this._updatingChanged()}taskRunningChanged(m){this._updatingChanged();m&&0<this._budget.remaining&&!this._microTaskQueued&&(this._microTaskQueued=!0,queueMicrotask(()=>{this._microTaskQueued&&(this._microTaskQueued=!1,0<this._budget.remaining&&this._schedule()&&this.frame())}))}registerTask(m,t){const M=q(m);t=new l(this,m,t,M);this._tasks.push(t);this._updatingChanged();this.performanceInfo.tasks.has(m)||this.performanceInfo.tasks.set(m,new n(m));return t}registerIdleStateCallbacks(m,
t){const M={idleBegin:m,idleEnd:t};this._idleStateCallbacks.push(M);this.state===v.RenderState.IDLE&&this._idleUpdatesStartFired&&M.idleBegin();const I=this;return{remove:()=>this._removeIdleStateCallbacks(M),set idleBegin(S){I._idleUpdatesStartFired&&(M.idleEnd(),I._state===v.RenderState.IDLE&&S());M.idleBegin=S},set idleEnd(S){M.idleEnd=S}}}get load(){return this._load}set state(m){this._state!==m&&(this._state=m,this.state!==v.RenderState.IDLE&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=
!1,this._idleStateCallbacks.forAll(t=>t.idleEnd())))}get state(){return this._state}updateBudget(m){this._test.usedBudget=0;++this._frameNumber;let t=r,M=m.frameDuration,I=z;switch(this.state){case v.RenderState.IDLE:t=x.Milliseconds(0);M=x.Milliseconds(Math.max(d,m.frameDuration));I=E;break;case v.RenderState.INTERACTING:M=x.Milliseconds(Math.max(R,m.frameDuration))}M=x.Milliseconds(M-m.elapsedFrameTime-t);if(this.state!==v.RenderState.IDLE&&M<z&&!this._forceTask)return this._forceTask=!0,!1;M=x.Milliseconds(Math.max(M,
I));this._budget.reset(M,this.state);this._updateLoad();return this._schedule()}frame(){this._microTaskQueued=this._forceTask=!1;switch(this.state){case v.RenderState.IDLE:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll(m=>m.idleBegin()));this._runIdle();break;case v.RenderState.INTERACTING:this._runInteracting();break;default:this._runAnimating()}this._test.usedBudget=this._budget.elapsed}stopFrame(){this._budget.reset(x.Milliseconds(0),this._state);this._budget.madeProgress()}_removeIdleStateCallbacks(m){this._idleUpdatesStartFired&&
m.idleEnd();this._idleStateCallbacks.removeUnordered(m)}removeTask(m){this._tasks.removeUnordered(m);this._runQueue.removeUnordered(m);this._updatingChanged()}_updateTask(m){this._tasks.forAll(t=>{t.name===m&&t.setPriority(m)})}_getState(m){if(this._runQueue.some(M=>M.name===m))return c.TaskState.SCHEDULED;let t=c.TaskState.IDLE;this._tasks.forAll(M=>{M.name===m&&M.needsUpdate&&(1>=M.schedulePriority?t=c.TaskState.READY:t!==c.TaskState.READY&&(t=c.TaskState.WAITING))});return t}_getRuntime(m){let t=
0;this._tasks.forAll(M=>{M.name===m&&(t+=M.runtime)});return t}_resetRuntimes(){this._tasks.forAll(m=>m.runtime=0)}_getRunning(){const m=new Map;this._tasks.forAll(M=>{M.needsUpdate&&m.set(M.name,(m.get(M.name)||0)+1)});if(0===m.size)return null;let t="";m.forEach((M,I)=>{t=1<M?t+` ${M}x ${I}`:t+` ${I}`});return t}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){const m=this._tasks.reduce((t,M)=>M.needsUpdate?++t:t,0);this._load=.9*this._load+m*(1-.9)}_schedule(){this._runQueue.filterInPlace(m=>
{if(m.needsUpdate)return!0;m.schedulePriority=m.basePriority;return!1});for(this._tasks.forAll(m=>{0===m.basePriority&&m.needsUpdate&&!this._runQueue.includes(m)&&m.blockFrame!==this._frameNumber&&this._runQueue.unshift(m)});0===this._runQueue.length;){let m=!1;this._tasks.forAll(t=>{if(t.needsUpdate&&0!==t.schedulePriority&&0!==t.basePriority&&t.blockFrame!==this._frameNumber)switch(m=!0,t.schedulePriority){case 1:t.schedulePriority=0;this._runQueue.push(t);break;default:--t.schedulePriority}});
if(!m)return this._updatingChanged(),!1}this._updatingChanged();return!0}_run(){const m=this._budget.now();this._startFrameTaskTimes();do for(;0<this._runQueue.length;){var t=this._budget.now();const M=this._runQueue.pop();this._budget.resetProgress();try{M.task.runTask(this._budget)===c.Task.YIELD&&(M.blockFrame=this._frameNumber)}catch(I){w.getLogger("esri.views.support.Scheduler").error(`Exception in task "${M.name}"`,I),M.blockFrame=this._frameNumber}!this._budget.hasProgressed&&M.blockFrame!==
this._frameNumber&&M.needsUpdate&&(M.blockFrame=this._frameNumber);M.schedulePriority=M.basePriority;t=this._budget.now()-t;M.runtime+=t;this._frameTaskTimes.set(M.priority,this._frameTaskTimes.get(M.priority)+t);this._debug&&t>2*this._budget.budget&&console.log("Task",M.name,"used",t,"of max",this._budget.budget,"ms");if(0>=this._budget.remaining){this._updatingChanged();this._recordFrameTaskTimes(this._budget.now()-m);return}}while(this._schedule());this._updatingChanged();this._recordFrameTaskTimes(this._budget.now()-
m)}_startFrameTaskTimes(){for(const m of Object.keys(c.TaskPriority))this._frameTaskTimes.set(c.TaskPriority[m],0)}_recordFrameTaskTimes(m){this._frameTaskTimes.forEach((t,M)=>this.performanceInfo.tasks.get(M).record(t));this.performanceInfo.total.record(m)}get test(){return this._test}}P.Scheduler=V;class l{get task(){return this._task.value}get updating(){return this._queue.running}constructor(m,t,M,I){this._scheduler=m;this.name=t;this._basePriority=I;this.runtime=this.blockFrame=0;this._queue=
new H.PromiseQueue;this._handles=new e;this.schedulePriority=this._basePriority;this._task=p.signal(null!=M?M:this._queue);this._handles.add(f.when(()=>this.task.running,S=>m.taskRunningChanged(S)))}remove(){this.processQueue(T);this._scheduler.removeTask(this);this.schedule=Q.schedule;this.reschedule=Q.reschedule;this._handles.destroy()}get basePriority(){return this._basePriority}setPriority(m){this.name=m;m=q(m);if(0===this._basePriority||0!==this.schedulePriority)this.schedulePriority=m;this._basePriority=
m}get priority(){return this.name}set priority(m){this.setPriority(m)}get needsUpdate(){return this.updating||this.task.running}schedule(m,t,M){return this._queue.push(m,t,M)}reschedule(m,t,M){return this._queue.unshift(m,t,M)}processQueue(m){this._queue.runTask(m)}}class N{constructor(){this._begin="undefined"!==typeof performance?performance.now():0;this._budget=0;this._state=v.RenderState.IDLE;this._progressed=this._done=!1;this._enabled=!0}run(m){if(this.done)return!1;!0===m()&&this.madeProgress();
return!0}get done(){return this._done}get budget(){return this._budget}madeProgress(){this._progressed=!0;return this._done=this.elapsed>=this._budget&&this._enabled}get state(){return this._state}get enabled(){return this._enabled}set enabled(m){this._enabled=m}reset(m,t){this._begin=this.now();this._budget=m;this._state=t;this.resetProgress()}get remaining(){return Math.max(this._budget-this.elapsed,0)}now(){return performance.now()}get elapsed(){return performance.now()-this._begin}resetProgress(){this._done=
this._progressed=!1}get hasProgressed(){return this._progressed}}P.Budget=N})(G||(G={}));c.TaskState=void 0;(function(P){P.SCHEDULED="s";P.READY="r";P.WAITING="w";P.IDLE="i"})(c.TaskState||(c.TaskState={}));const T=(()=>{const P=new G.Budget;P.enabled=!1;return P})();class J{remove(){}processQueue(){}schedule(P,V,l){try{if(u.isAborted(V)){const N=u.createAbortError();return l?Promise.resolve(l(N)):Promise.reject(N)}return u.when(P(T))}catch(N){return Promise.reject(N)}}reschedule(P,V,l){return this.schedule(P,
V,l)}}const Q=new J;c.ImmediateTask=Q;c.getTaskPriority=q;c.newScheduler=function(){return new G.Scheduler};c.noBudget=T;c.taskPriorities=a;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/core/signal":function(){define(["exports","./lang","./accessorSupport/tracking","./accessorSupport/tracking/SimpleObservable"],function(c,e,A,w){class L{constructor(n,g){this._observable=new w.SimpleObservable;this._value=n;this._equalityFunction=g}get value(){A.trackAccess(this._observable);
return this._value}set value(n){this._equalityFunction(n,this._value)||(this._value=n,this._observable.notify())}mutate(n){n(this._value);this._observable.notify()}}c.signal=function(n,g=e.equalsShallow){return new L(n,g)};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/PromiseQueue":function(){define(["exports","../../core/promiseUtils","../../core/signal"],function(c,e,A){class w{constructor(){this._tasks=[];this._running=A.signal(!1)}get length(){return this._tasks.length}get running(){return this._running.value}destroy(){this.cancelAll()}runTask(n){for(;!n.done&&
this._process(n);)n.madeProgress()}push(n,g,u){this._running.value=!0;return new Promise((f,p)=>this._tasks.push(new L(f,p,n,g,u)))}unshift(n,g,u){this._running.value=!0;return new Promise((f,p)=>this._tasks.unshift(new L(f,p,n,g,u)))}_process(n){if(0===this._tasks.length)return!1;const g=this._tasks.shift();try{const u=e.isAborted(g.signal);if(u&&!g.abortCallback)g.reject(e.createAbortError());else{const f=u?g.abortCallback?.(e.createAbortError()):g.callback(n);e.isPromiseLike(f)?f.then(g.resolve,
g.reject):g.resolve(f)}}catch(u){g.reject(u)}this._running.value=0<this._tasks.length;return!0}cancelAll(){const n=e.createAbortError();for(const g of this._tasks)if(g.abortCallback){const u=g.abortCallback(n);g.resolve(u)}else g.reject(n);this._tasks.length=0;this._running.value=!1}}class L{constructor(n,g,u,f,p){this.resolve=n;this.reject=g;this.callback=u;this.signal=f;this.abortCallback=p}}c.PromiseQueue=w;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/debugFlags":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(c,e,A,w,L,n,g){e=class extends e{constructor(){super(...arguments);this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=this.SCHEDULER_LOG_SLOW_TASKS=!1}};c.__decorate([A.property()],e.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0);c.__decorate([A.property()],e.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0);e=c.__decorate([g.subclass("esri.views.support.DebugFlags")],e);return new e})},"esri/views/support/RenderState":function(){define(["exports"],function(c){c.RenderState=
void 0;var e=c.RenderState||(c.RenderState={});e[e.ANIMATING=0]="ANIMATING";e[e.INTERACTING=1]="INTERACTING";e[e.IDLE=2]="IDLE";Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/sources/support/clientSideDefaults":function(){define(["exports","../../../../core/has","../../../../core/lang","../../data/QueryEngineCapabilities","../../../../symbols/support/defaultsJSON"],function(c,e,A,w,L){const n=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let g=1;c.createCapabilities=function(u,
f){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:u},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:f,supportsDelete:f,supportsEditing:f,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:f,supportsExceedsLimitStatistics:!0,
supportsAsyncConvert3D:!1},query:w.queryCapabilities,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},editing:{supportsGeometryUpdate:f,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsAsyncApplyEdits:!1,
zDefault:void 0}}};c.createDefaultAttributesFunction=function(u,f){if(e("esri-csp-restrictions"))return()=>({[f]:null,...u});try{let p=`this.${f} = null;`;for(const H in u){const D=n.test(H)?`.${H}`:`["${H}"]`;p+=`this${D} = ${JSON.stringify(u[H])};`}const x=(new Function(`\n      return class AttributesClass$${g++} {\n        constructor() {\n          ${p};\n        }\n      }\n    `))();return()=>new x}catch(p){return()=>({[f]:null,...u})}};c.createDefaultTemplate=function(u={}){return[{name:"New Feature",
description:"",prototype:{attributes:A.clone(u)}}]};c.createDrawingInfo=function(u){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===u||"esriGeometryMultipoint"===u?L.defaultPointSymbolJSON:"esriGeometryPolyline"===u?L.defaultPolylineSymbolJSON:L.defaultPolygonSymbolJSON}}};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/defaultsJSON":function(){define(["exports"],function(c){const e=[252,146,31,255],A={type:"esriSMS",style:"esriSMSCircle",size:6,color:e,
outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},w={type:"esriSLS",style:"esriSLSSolid",width:.75,color:e};c.defaultColor=e;c.defaultOutlineColor=[153,153,153,255];c.defaultPointSymbolJSON=A;c.defaultPolygonSymbolJSON={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}};c.defaultPolylineSymbolJSON=w;c.defaultTextSymbolJSON={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",
size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0};c.errorPointSymbolJSON={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5};c.errorPolygonSymbolJSON={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null};c.errorPolylineSymbolJSON={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/sources/support/sourceUtils":function(){define(["require",
"exports","../../../../core/date","../../../../geometry/support/spatialReferenceUtils","../../../support/fieldUtils"],function(c,e,A,w,L){function n(D){return new f(D)}async function g(){null==H&&(H=await new Promise((D,v)=>c(["../../../../geometry/geometryEngineJSON"],D,v)));return H}class u{constructor(){this.description=this.code=null}}class f{constructor(D){this.error=new u;this.objectId=this.globalId=null;this.success=!1;this.uniqueId=null;this.error.description=D}}class p{constructor(D){this.globalId=
null;this.success=!0;this.objectId=this.uniqueId=D}}const x=new Set;let H;e.createFeatureEditErrorResult=n;e.createFeatureEditSuccessResult=function(D){return new p(D)};e.loadGeometryEngineForSimplify=async function(D,v){!w.isValid(D)||"esriGeometryPolygon"!==v&&"esriGeometryPolyline"!==v||await g()};e.mixAttributes=function(D,v,q,a=!1){x.clear();for(const E in q){const R=D.get(E);if(!R)continue;var r=R,z=q[E];let d=z;L.isNumericField(r)&&"string"===typeof z?d=parseFloat(z):L.isStringField(r)&&null!=
z&&"string"!==typeof z?d=String(z):L.isDateField(r)&&"string"===typeof z&&(d=A.parseDate(z));r=L.sanitizeNullFieldValue(d);x.add(R.name);if(R&&(a||R.editable)){if(z=L.validateFieldValue(R,r))return n(L.validationErrorToString(z,R,r));v[R.name]=r}}for(const E of D?.requiredFields??[])if(!x.has(E.name))return n(`missing required field "${E.name}"`);return null};e.parseStringDateFieldValues=function(D,v){if(D?.length)for(const {name:q}of D)"string"===typeof v[q]&&(v[q]=A.parseDate(v[q]))};e.simplify=
function(D,v){if(!D||!w.isValid(v))return D;if("rings"in D||"paths"in D){if(null==H)throw new TypeError("geometry engine not loaded");return H.simplify(v,D)}return D};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/date":function(){define(["exports"],function(c){function e(g){const u=new Date(g);if(Number.isNaN(u.getTime()))g=!1;else{var f=!0;if(n&&/\d+\W*$/.test(g)&&(g=g.match(/[a-zA-Z]{2,}/))){f=!1;let p=0;for(;!f&&p<=g.length;)f=!L.test(g[p]),p++;f=!f}g=f}return g?Number.isNaN(u.getTime())?
null:u.getTime()-6E4*u.getTimezoneOffset():null}function A(g){g=w.exec(g);if(!g?.groups)return null;g=g.groups;const u=+g.year,f=+g.month-1,p=+g.day,x=+(g.hours??0),H=+(g.minutes??0),D=+(g.seconds??0);if(23<x||59<H||59<D)return null;var v=g.ms??"0";v=v?+v.padEnd(3,"0").substring(0,3):0;g=g.isUTC||!g.offsetSign?Date.UTC(u,f,p,x,H,D,v):6E4*("+"===g.offsetSign?-1:1)*(60*+g.offsetHours+ +g.offsetMinutes)+Date.UTC(u,f,p,x,H,D,v);return Number.isNaN(g)?null:g}const w=/^(?:(?<year>-?\d{4,})-(?<month>\d{2})-(?<day>\d{2}))(?:T(?<hours>\d{2}):(?<minutes>\d{2}):(?<seconds>\d{2})(?:\.(?<ms>\d+))?)?(?:(?<isUTC>Z)|(?:(?<offsetSign>\+|-)(?<offsetHours>\d{2}):(?<offsetMinutes>\d{2})))?$/,
L=/^((jan(uary)?)|(feb(ruary)?)|(mar(ch)?)|(apr(il)?)|(may)|(jun(e)?)|(jul(y)?)|(aug(ust)?)|(sep(tember)?)|(oct(ober)?)|(nov(ember)?)|(dec(ember)?)|(am)|(pm)|(gmt)|(utc))$/i,n=!Number.isNaN((new Date("technology 10")).getTime());c.isDateString=function(g){return null!=A(g)||null!=e(g)};c.isISO8601Date=function(g){return w.test(g)};c.parseDate=function(g){return A(g)??e(g)};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define("../../../../core/Error ../../../../geometry/support/jsonUtils ../../../../geometry/support/spatialReferenceUtils ../../featureConversionUtils ../../objectIdUtils ../../data/FeatureStore ../../data/projectionSupport ../../data/QueryEngine ./clientSideDefaults ./sourceUtils ../../../support/FieldsIndex ../../../support/fieldType ../../../support/fieldUtils ../../../../time/timeZoneUtils".split(" "),function(c,e,A,w,L,n,g,u,f,p,x,H,D,v){function q(d){return e.isPoint(d)?null!=d.z:!!d.hasZ}function a(d){return e.isPoint(d)?
null!=d.m:!!d.hasM}const r=A.WGS84,z={xmin:-180,ymin:-90,xmax:180,ymax:90,spatialReference:A.WGS84},E={hasAttachments:!1,capabilities:"query, editing, create, delete, update",useStandardizedQueries:!0,supportsCoordinatesQuantization:!0,supportsReturningQueryGeometry:!0,advancedQueryCapabilities:{supportsQueryAttachments:!1,supportsStatistics:!0,supportsPercentileStatistics:!0,supportsReturningGeometryCentroid:!0,supportsQueryWithDistance:!0,supportsDistinct:!0,supportsReturningQueryExtent:!0,supportsReturningGeometryProperties:!1,
supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQueryWithResultType:!1,supportsSqlExpression:!0,supportsDisjointSpatialRel:!0}};class R{constructor(){this._nextObjectId=this._queryEngine=null}destroy(){this._queryEngine?.destroy();this._queryEngine=this._createDefaultAttributes=null}async load(d){var G=[];const {features:T}=d;var J=this._inferLayerProperties(T,d.fields);const Q=d.fields||[],P=null!=d.hasM?d.hasM:!!J.hasM,V=null!=d.hasZ?d.hasZ:!!J.hasZ,l=!d.spatialReference&&
!J.spatialReference,N=l?r:d.spatialReference||J.spatialReference,m=l?z:null,t=d.geometryType||J.geometryType,M=!t;let I=d.objectIdField||J.objectIdField,S=d.timeInfo;const Z=new x(Q);if(!M&&(l&&G.push({name:"feature-layer:spatial-reference-not-found",message:"Spatial reference not provided or found in features. Defaults to WGS84"}),!t))throw new c("feature-layer:missing-property","geometryType not set and couldn't be inferred from the provided features");if(!I)throw new c("feature-layer:missing-property",
"objectIdField not set and couldn't be found in the provided fields");J.objectIdField&&I!==J.objectIdField&&(G.push({name:"feature-layer:duplicated-oid-field",message:`Provided objectIdField "${I}" doesn't match the field name "${J.objectIdField}", found in the provided fields`}),I=J.objectIdField);I&&!J.objectIdField&&((J=Z.get(I))?(I=J.name,J.type="esriFieldTypeOID",J.editable=!1,J.nullable=!1):Q.unshift({alias:I,name:I,type:"esriFieldTypeOID",editable:!1,nullable:!1}));for(var ca of Q){null==ca.name&&
(ca.name=ca.alias);null==ca.alias&&(ca.alias=ca.name);if(!ca.name)throw new c("feature-layer:invalid-field-name","field name is missing",{field:ca});ca.name===I&&(ca.type="esriFieldTypeOID");if(!H.kebabDict.jsonValues.includes(ca.type))throw new c("feature-layer:invalid-field-type",`invalid type for field "${ca.name}"`,{field:ca});null==ca.length&&(ca.length=D.getFieldDefaultLength(ca))}ca={};for(var ja of Q)"esriFieldTypeOID"!==ja.type&&"esriFieldTypeGlobalID"!==ja.type&&(J=D.getFieldDefaultValue(ja),
void 0!==J&&(ca[ja.name]=J));S&&(S.startTimeField&&((ja=Z.get(S.startTimeField))?(S.startTimeField=ja.name,ja.type="esriFieldTypeDate"):S.startTimeField=null),S.endTimeField&&((ja=Z.get(S.endTimeField))?(S.endTimeField=ja.name,ja.type="esriFieldTypeDate"):S.endTimeField=null),S.trackIdField&&((ja=Z.get(S.trackIdField))?S.trackIdField=ja.name:(S.trackIdField=null,G.push({name:"feature-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:S}}))),S.startTimeField||
S.endTimeField||(G.push({name:"feature-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing or invalid",details:{timeInfo:S}}),S=null));d=Z.dateFields.length?{timeZoneIANA:d.dateFieldsTimeZone??v.utc}:null;this._createDefaultAttributes=f.createDefaultAttributesFunction(ca,I);G={warnings:G,featureErrors:[],layerDefinition:{...E,drawingInfo:f.createDrawingInfo(t),templates:f.createDefaultTemplate(ca),extent:m,geometryType:t,objectIdField:I,fields:Q,hasZ:V,hasM:P,timeInfo:S,dateFieldsTimeReference:d},
assignedObjectIds:{}};this._queryEngine=new u.QueryEngine({fieldsIndex:x.fromLayerJSON({fields:Q,timeInfo:S,dateFieldsTimeReference:d}),geometryType:t,hasM:P,hasZ:V,objectIdField:I,spatialReference:N,featureStore:new n({geometryType:t,hasM:P,hasZ:V}),timeInfo:S,cacheSpatialQueries:!0});if(!T?.length)return this._nextObjectId=L.initialObjectId,G;this._nextObjectId=L.findLastObjectIdFromFeatures(I,T)+1;await g.checkProjectionSupport(T,N);return this._loadInitialFeatures(G,T)}async applyEdits(d){const {spatialReference:G,
geometryType:T}=this._queryEngine;await Promise.all([p.loadGeometryEngineForSimplify(G,T),g.checkProjectionSupport(d.adds,G),g.checkProjectionSupport(d.updates,G)]);return this._applyEdits(d)}queryFeatures(d,G={}){return this._queryEngine.executeQuery(d,G.signal)}queryFeatureCount(d,G={}){return this._queryEngine.executeQueryForCount(d,G.signal)}queryObjectIds(d,G={}){return this._queryEngine.executeQueryForIds(d,G.signal)}queryExtent(d,G={}){return this._queryEngine.executeQueryForExtent(d,G.signal)}querySnapping(d,
G={}){return this._queryEngine.executeQueryForSnapping(d,G.signal)}_inferLayerProperties(d,G){let T=void 0,J=void 0,Q=null,P=null,V=null;for(const l of d)if(d=l.geometry,null!=d&&(Q||(Q=e.getJsonType(d)),P||(P=d.spatialReference),null==T&&(T=q(d)),null==J&&(J=a(d)),Q&&P&&null!=T&&null!=J))break;if(G&&G.length){let l=null;G.some(N=>{const m="esriFieldTypeOID"===N.type,t=!N.type&&N.name&&"objectid"===N.name.toLowerCase();l=N;return m||t})&&(V=l.name)}return{geometryType:Q,spatialReference:P,objectIdField:V,
hasM:J,hasZ:T}}async _loadInitialFeatures(d,G){const {geometryType:T,hasM:J,hasZ:Q,objectIdField:P,spatialReference:V,featureStore:l,fieldsIndex:N}=this._queryEngine,m=[];for(const I of G){null!=I.uid&&(d.assignedObjectIds[I.uid]=-1);if(I.geometry&&T!==e.getJsonType(I.geometry)){d.featureErrors.push(p.createFeatureEditErrorResult("Incorrect geometry type."));continue}G=this._createDefaultAttributes();const S=p.mixAttributes(N,G,I.attributes,!0);S?d.featureErrors.push(S):(this._assignObjectId(G,I.attributes,
!0),I.attributes=G,null!=I.uid&&(d.assignedObjectIds[I.uid]=I.attributes[P]),null!=I.geometry&&(I.geometry=g.project(I.geometry,I.geometry.spatialReference,V)),m.push(I))}l.addMany(w.convertFromFeatures([],m,T,Q,J,P));const {fullExtent:t,timeExtent:M}=await this._queryEngine.fetchRecomputedExtents();d.layerDefinition.extent=t;if(M){const {start:I,end:S}=M;d.layerDefinition.timeInfo.timeExtent=[I,S]}return d}async _applyEdits(d){const {adds:G,updates:T,deletes:J}=d;d={addResults:[],deleteResults:[],
updateResults:[],uidToObjectId:{}};G?.length&&this._applyAddEdits(d,G);T?.length&&this._applyUpdateEdits(d,T);if(J?.length){for(const V of J)d.deleteResults.push(p.createFeatureEditSuccessResult(V));this._queryEngine.featureStore.removeManyById(J)}const {fullExtent:Q,timeExtent:P}=await this._queryEngine.fetchRecomputedExtents();return{extent:Q,timeExtent:P,featureEditResults:d}}_applyAddEdits(d,G){const {addResults:T}=d,{geometryType:J,hasM:Q,hasZ:P,objectIdField:V,spatialReference:l,featureStore:N,
fieldsIndex:m}=this._queryEngine,t=[];for(const M of G){if(M.geometry&&J!==e.getJsonType(M.geometry)){T.push(p.createFeatureEditErrorResult("Incorrect geometry type."));continue}G=this._createDefaultAttributes();const I=p.mixAttributes(m,G,M.attributes);I?T.push(I):(this._assignObjectId(G,M.attributes),M.attributes=G,null!=M.uid&&(d.uidToObjectId[M.uid]=M.attributes[V]),null!=M.geometry&&(G=M.geometry.spatialReference??l,M.geometry=g.project(p.simplify(M.geometry,G),G,l)),t.push(M),T.push(p.createFeatureEditSuccessResult(M.attributes[V])))}N.addMany(w.convertFromFeatures([],
t,J,P,Q,V))}_applyUpdateEdits({updateResults:d},G){const {geometryType:T,hasM:J,hasZ:Q,objectIdField:P,spatialReference:V,featureStore:l,fieldsIndex:N}=this._queryEngine;for(const t of G){const {attributes:M,geometry:I}=t;G=M?.[P];if(null==G){d.push(p.createFeatureEditErrorResult(`Identifier field ${P} missing`));continue}if(!l.has(G)){d.push(p.createFeatureEditErrorResult(`Feature with object id ${G} missing`));continue}const S=w.convertToFeature(l.getFeature(G),T,Q,J);if(null!=I){if(T!==e.getJsonType(I)){d.push(p.createFeatureEditErrorResult("Incorrect geometry type."));
continue}var m=I.spatialReference??V;S.geometry=g.project(p.simplify(I,m),m,V)}if(M&&(m=p.mixAttributes(N,S.attributes,M))){d.push(m);continue}l.add(w.convertFromFeature(S,T,Q,J,P));d.push(p.createFeatureEditSuccessResult(G))}}_assignObjectId(d,G,T=!1){const J=this._queryEngine.objectIdField;T?G&&isFinite(G[J])?d[J]=G[J]:d[J]=this._nextObjectId++:d[J]=this._nextObjectId++}}return R});