// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.28/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/graphics/featureConversionUtils":function(){define("exports ../../core/Error ../../core/Logger ../../core/maybe ../../geometry/support/aaBoundingBox ../../geometry/support/aaBoundingRect ../../geometry/support/jsonUtils ./OptimizedFeature ./OptimizedFeatureSet ./OptimizedGeometry".split(" "),function(b,d,A,u,I,p,f,v,g,t){function w(z,G){return z?G?4:3:G?3:2}function C(z,G,K,W){if(z){if(K)return G&&W?E:Ta;if(G&&W)return h}else if(G&&W)return Ta;return La}function B({scale:z,
translate:G},K){return Math.round((K-G[0])/z[0])}function r({scale:z,translate:G},K){return Math.round((G[1]-K)/z[1])}function l({scale:z,translate:G},K,W){return K*z[W]+G[W]}function a(z){z=z.coords;return{x:z[0],y:z[1]}}function q(z,G){z.coords[0]=G.x;z.coords[1]=G.y;return z}function y(z){z=z.coords;return{x:z[0],y:z[1],z:z[2]}}function F(z,G){z.coords[0]=G.x;z.coords[1]=G.y;z.coords[2]=G.z;return z}function Q(z){z=z.coords;return{x:z[0],y:z[1],m:z[2]}}function e(z,G){z.coords[0]=G.x;z.coords[1]=
G.y;z.coords[2]=G.m;return z}function H(z){z=z.coords;return{x:z[0],y:z[1],z:z[2],m:z[3]}}function S(z,G){z.coords[0]=G.x;z.coords[1]=G.y;z.coords[2]=G.z;z.coords[3]=G.m;return z}function J(z,G){return z&&G?S:z?F:G?e:q}function R(z,G,K,W,Z){K=J(K,W);for(const {geometry:ba,attributes:ea}of G)G=null!=ba?K(new t,ba):null,z.push(new v.OptimizedFeature(G,ea,null,Z?ea[Z]:void 0));return z}function P(z,G,K,W){for(const {geometry:Z,attributes:ba}of G)z.push({attributes:ba,geometry:null!=Z?V(Z,K,W):null});
return z}function V(z,G,K){if(null==z)return null;const W=w(G,K),Z=[];for(let ba=0;ba<z.coords.length;ba+=W){const ea=[];for(let la=0;la<W;la++)ea.push(z.coords[ba+la]);Z.push(ea)}return G?K?{points:Z,hasZ:G,hasM:K}:{points:Z,hasZ:G}:K?{points:Z,hasM:K}:{points:Z}}function m(z,G,K,W,Z){K=w(K,W);for(const {geometry:ba,attributes:ea}of G)G=null!=ba?O(new t,ba,K):null,z.push(new v.OptimizedFeature(G,ea,null,Z?ea[Z]:void 0));return z}function O(z,G,K=w(G.hasZ,G.hasM)){z.lengths[0]=G.points.length;const W=
z.coords;let Z=0;for(const ba of G.points)for(G=0;G<K;G++)W[Z++]=ba[G];return z}function n(z,G,K){if(!z)return null;const W=w(G,K),{coords:Z,lengths:ba}=z;z=[];let ea=0;for(const la of ba){const na=[];for(let wa=0;wa<la;wa++){const ta=[];for(let va=0;va<W;va++)ta.push(Z[ea++]);na.push(ta)}z.push(na)}return G?K?{paths:z,hasZ:G,hasM:K}:{paths:z,hasZ:G}:K?{paths:z,hasM:K}:{paths:z}}function x(z,G,K,W,Z){K=w(K,W);for(const {geometry:ba,attributes:ea}of G)G=null!=ba?M(new t,ba,K):null,z.push(new v.OptimizedFeature(G,
ea,null,Z?ea[Z]:void 0));return z}function M(z,G,K=w(G.hasZ,G.hasM)){const {lengths:W,coords:Z}=z;let ba=0;for(const ea of G.paths){for(const la of ea)for(G=0;G<K;G++)Z[ba++]=la[G];W.push(ea.length)}return z}function L(z,G,K){if(!z)return null;const W=w(G,K),{coords:Z,lengths:ba}=z;z=[];let ea=0;for(const la of ba){const na=[];for(let wa=0;wa<la;wa++){const ta=[];for(let va=0;va<W;va++)ta.push(Z[ea++]);na.push(ta)}z.push(na)}return G?K?{rings:z,hasZ:G,hasM:K}:{rings:z,hasZ:G}:K?{rings:z,hasM:K}:{rings:z}}
function T(z,G,K,W,Z){for(const {geometry:ba,centroid:ea,attributes:la}of G){G=null!=ba?Y(new t,ba,K,W):null;const na=Z?la[Z]:void 0;null!=ea?z.push(new v.OptimizedFeature(G,la,q(new t,ea),na)):z.push(new v.OptimizedFeature(G,la,null,na))}return z}function Y(z,G,K=G.hasZ,W=G.hasM){return fa(z,G.rings,K,W)}function fa(z,G,K,W){K=w(K,W);const {lengths:Z,coords:ba}=z;W=0;xa(z);for(const ea of G){for(const la of ea)for(G=0;G<K;G++)ba[W++]=la[G];Z.push(ea.length)}return z}function oa(z,G,K,W,Z,ba){Ba(z);
if(!K){for(const ea of G)z.push(new v.OptimizedFeature(null,ea.attributes,null,ba?ea.attributes[ba]:void 0));return z}switch(K){case "esriGeometryPoint":return R(z,G,W,Z,ba);case "esriGeometryMultipoint":return m(z,G,W,Z,ba);case "esriGeometryPolyline":return x(z,G,W,Z,ba);case "esriGeometryPolygon":return T(z,G,W,Z,ba);default:Ka.error("convertToFeatureSet:unknown-geometry",new d(`Unable to parse unknown geometry type '${K}'`)),Ba(z)}return z}function sa(z,G,K,W){z=z&&("coords"in z?z:z.geometry);
if(null==z)return null;switch(G){case "esriGeometryPoint":return G=a,K&&W?G=H:K?G=y:W&&(G=Q),G(z);case "esriGeometryMultipoint":return V(z,K,W);case "esriGeometryPolyline":return n(z,K,W);case "esriGeometryPolygon":return L(z,K,W);default:return Ka.error("convertToGeometry:unknown-geometry",new d(`Unable to parse unknown geometry type '${G}'`)),null}}function ca(z,G,K,W,Z){Ba(z);if(null==K){for(const ea of G)z.push({attributes:ea.attributes});return z}switch(K){case "esriGeometryPoint":K=a;W&&Z?K=
H:W?K=y:Z&&(K=Q);for(var ba of G){const {geometry:ea,attributes:la}=ba;W=null!=ea?K(ea):null;z.push({attributes:la,geometry:W})}break;case "esriGeometryMultipoint":return P(z,G,W,Z);case "esriGeometryPolyline":for(const {geometry:ea,attributes:la}of G)z.push({attributes:la,geometry:null!=ea?n(ea,W,Z):null});break;case "esriGeometryPolygon":for(const {geometry:ea,attributes:la,centroid:na}of G)ba=null!=ea?L(ea,W,Z):null,null!=na?(G=a(na),z.push({attributes:la,centroid:G,geometry:ba})):z.push({attributes:la,
geometry:ba});break;default:Ka.error("convertToFeatureSet:unknown-geometry",new d(`Unable to parse unknown geometry type '${K}'`))}return z}function ka(z,G,K,W,Z,ba,ea=K,la=W){xa(z);if(!G?.coords.length)return null;Z=Fa[Z];const {coords:na,lengths:wa}=G;G=w(K,W);const ta=w(K&&ea,W&&la);K=C(K,W,ea,la);if(!wa.length)return K(z.coords,na,0,0,B(ba,na[0]),r(ba,na[1])),xa(z,G,0),z;let va,Ea=0,ya,Da=0;for(const Ca of wa){if(Ca<Z)continue;let za=0;ya=Da;la=W=B(ba,na[Ea]);va=ea=r(ba,na[Ea+1]);K(z.coords,na,
ya,Ea,la,va);za++;Ea+=G;ya+=ta;for(let Ja=1;Ja<Ca;Ja++,Ea+=G)if(la=B(ba,na[Ea]),va=r(ba,na[Ea+1]),la!==W||va!==ea)K(z.coords,na,ya,Ea,la-W,va-ea),ya+=ta,za++,W=la,ea=va;za>=Z&&(z.lengths.push(za),Da=ya)}Ba(z.coords,Da);return z.coords.length?z:null}function ia(z,G,K,W,Z,ba,ea){let la=W,na=0;for(let ta=ba+K;ta<ea;ta+=K){var wa=G[ta];const va=G[ta+1],Ea=G[ea],ya=G[ea+1];let Da=G[ba],Ca=G[ba+1],za=Ea-Da,Ja=ya-Ca;if(0!==za||0!==Ja){const Ra=((wa-Da)*za+(va-Ca)*Ja)/(za*za+Ja*Ja);1<Ra?(Da=Ea,Ca=ya):0<Ra&&
(Da+=za*Ra,Ca+=Ja*Ra)}za=wa-Da;Ja=va-Ca;wa=za*za+Ja*Ja;wa>la&&(na=ta,la=wa)}la>W&&(na-ba>K&&ia(z,G,K,W,Z,ba,na),Z(z,G,z.length,na,G[na],G[na+1]),ea-na>K&&ia(z,G,K,W,Z,na,ea))}function ra(z,G,K,W,Z){const {coords:ba,lengths:ea}=G;K=w(K,W);if(!ba.length)return z!==G&&xa(z),z;u.assertIsSome(Z);const {originPosition:la,scale:na,translate:wa}=Z;Z=ja;Z.originPosition=la;W=Z.scale;W[0]=na[0]??1;W[1]=-(na[1]??1);W[2]=na[2]??1;W[3]=na[3]??1;var ta=Z.translate;ta[0]=wa[0]??0;ta[1]=wa[1]??0;ta[2]=wa[2]??0;ta[3]=
wa[3]??0;if(!ea.length){for(W=0;W<K;++W)z.coords[W]=l(Z,ba[W],W);z!==G&&xa(z,K,0);return z}ta=0;for(let Ea=0;Ea<ea.length;Ea++){const ya=ea[Ea];z.lengths[Ea]=ya;for(var va=0;va<K;++va)z.coords[ta+va]=l(Z,ba[ta+va],va);va=z.coords[ta];let Da=z.coords[ta+1];ta+=K;for(let Ca=1;Ca<ya;Ca++,ta+=K){va+=ba[ta]*W[0];Da+=ba[ta+1]*W[1];z.coords[ta]=va;z.coords[ta+1]=Da;for(let za=2;za<K;++za)z.coords[ta+za]=l(Z,ba[ta+za],za)}}z!==G&&xa(z,ba.length,ea.length);return z}function pa(z,G,K,W){let Z=0,ba=z[W*G],ea=
z[W*(G+1)];for(let la=1;la<K;la++){const na=ba+z[W*(G+la)],wa=ea+z[W*(G+la)+1],ta=(na-ba)*(wa+ea);ba=na;ea=wa;Z+=ta}return.5*Z}function xa(z,G=0,K=0){Ba(z.lengths,K);Ba(z.coords,G)}function Ba(z,G=0){z.length!==G&&(z.length=G)}const Ka=A.getLogger("esri.layers.graphics.featureConversionUtils"),Fa={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0,esriGeometryEnvelope:0},La=(z,G,K,W,Z,ba)=>{z[K]=Z;z[K+1]=ba},Ta=(z,G,K,W,Z,ba)=>{z[K]=Z;z[K+1]=ba;z[K+2]=G[W+2]},
h=(z,G,K,W,Z,ba)=>{z[K]=Z;z[K+1]=ba;z[K+2]=G[W+3]},E=(z,G,K,W,Z,ba)=>{z[K]=Z;z[K+1]=ba;z[K+2]=G[W+2];z[K+3]=G[W+3]},X=[],aa=[],ja={originPosition:"lowerLeft",scale:[1,1,1,1],translate:[0,0,0,0]};b.convertFromFeature=function(z,G,K,W,Z){X[0]=z;[z]=oa(aa,X,G,K,W,Z);Ba(X);Ba(aa);return z};b.convertFromFeatureSet=function(z,G){const K=new g,{hasM:W,hasZ:Z,features:ba,objectIdFieldName:ea,spatialReference:la,geometryType:na,exceededTransferLimit:wa,transform:ta,fields:va}=z;va&&(K.fields=va);K.geometryType=
na??null;K.objectIdFieldName=ea??G??null;K.spatialReference=la??null;if(!K.objectIdFieldName)return Ka.error(new d("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),K;ba&&oa(K.features,ba,na,Z,W,K.objectIdFieldName);wa&&(K.exceededTransferLimit=wa);W&&(K.hasM=W);Z&&(K.hasZ=Z);ta&&(K.transform=ta);return K};b.convertFromFeatures=oa;b.convertFromGeometry=function(z,G,K){if(null==z)return null;const W=new t;"hasZ"in z&&null==G&&(G=z.hasZ);"hasM"in z&&null==K&&(K=z.hasM);
if(f.isPoint(z))return J(null!=G?G:null!=z.z,null!=K?K:null!=z.m)(W,z);if(f.isPolygon(z))return Y(W,z,G,K);if(f.isPolyline(z))return M(W,z,w(G,K));if(f.isMultipoint(z))return O(W,z,w(G,K));Ka.error("convertFromGeometry:unknown-geometry",new d(`Unable to parse unknown geometry type '${z}'`))};b.convertFromGraphics=function(z,G,K,W,Z,ba){const ea=z.length;switch(K){case "esriGeometryPoint":R(z,G,W,Z,ba);break;case "esriGeometryMultipoint":m(z,G,W,Z,ba);break;case "esriGeometryPolyline":x(z,G,W,Z,ba);
break;case "esriGeometryPolygon":T(z,G,W,Z,ba);break;default:Ka.error("convertToFeatureSet:unknown-geometry",new d(`Unable to parse unknown geometry type '${K}'`))}for(W=0;W<G.length;W++)z[W+ea].geometryType=K,z[W+ea].insertAfter=G[W].insertAfter,z[W+ea].groupId=G[W].groupId;return z};b.convertFromMultipoint=O;b.convertFromMultipointFeatures=m;b.convertFromNestedArray=fa;b.convertFromPoint=function(z,G,K=J(null!=G.z,null!=G.m)){return K(z,G)};b.convertFromPointFeatures=R;b.convertFromPolygon=Y;b.convertFromPolyline=
M;b.convertFromPolylineFeatures=x;b.convertToFeature=function(z,G,K,W){aa[0]=z;ca(X,aa,G,K,W);z=X[0];Ba(X);Ba(aa);return z};b.convertToFeatureSet=function(z){const {objectIdFieldName:G,spatialReference:K,transform:W,fields:Z,hasM:ba,hasZ:ea,features:la,geometryType:na,exceededTransferLimit:wa,uniqueIdField:ta,queryGeometry:va,queryGeometryType:Ea}=z;z=ca([],la,na,ea,ba);const ya=sa(va,Ea,!1,!1);z={features:z,fields:Z,geometryType:na,objectIdFieldName:G,spatialReference:K,uniqueIdField:ta,queryGeometry:ya};
W&&(z.transform=W);wa&&(z.exceededTransferLimit=wa);ba&&(z.hasM=ba);ea&&(z.hasZ=ea);return z};b.convertToFeatures=ca;b.convertToGeometry=sa;b.convertToMultipoint=V;b.convertToMultipointFeatures=P;b.convertToPoint=function(z,G,K){return z?G?K?H(z):y(z):K?Q(z):a(z):null};b.convertToPolygon=L;b.convertToPolyline=n;b.deltaDecodeGeometry=function(z,G){if(null==z)return null;const K=z.clone(),W=z.coords;z=z.lengths;let Z=0;for(let la=0;la<z.length;la++){const na=z[la];var ba=W[G*Z],ea=W[G*Z+1];for(let wa=
1;wa<na;wa++)ba+=W[G*(Z+wa)],ea+=W[G*(Z+wa)+1],K.coords[G*(Z+wa)]=ba,K.coords[G*(Z+wa)+1]=ea;Z+=na}return K};b.deltaEncodeGeometry=function(z,G){const K=z.clone(),W=z.coords;z=z.lengths;let Z=0;for(let ea=0;ea<z.length;ea++){const la=z[ea];let na=W[G*Z];var ba=W[G*Z+1];for(let wa=1;wa<la;wa++){const ta=W[G*(Z+wa)],va=W[G*(Z+wa)+1];ba=va-ba;K.coords[G*(Z+wa)]=ta-na;K.coords[G*(Z+wa)+1]=ba;na=ta;ba=va}Z+=la}return K};b.generalizeOptimizedGeometry=function(z,G,K,W,Z,ba,ea=K,la=W){xa(z);if(!G?.coords.length)return null;
Z=Fa[Z];const {coords:na,lengths:wa}=G;G=w(K,W);const ta=w(K&&ea,W&&la);K=C(K,W,ea,la);if(!wa.length)return K(z.coords,na,0,0,na[0],na[1]),xa(z,G,0),z;W=0;ba*=ba;for(const va of wa){if(va<Z){W+=va*G;continue}ea=z.coords.length/ta;la=W;const Ea=W+(va-1)*G;K(z.coords,na,z.coords.length,la,na[la],na[la+1]);ia(z.coords,na,G,ba,K,la,Ea);K(z.coords,na,z.coords.length,Ea,na[Ea],na[Ea+1]);la=z.coords.length/ta-ea;la>=Z?z.lengths.push(la):Ba(z.coords,ea*ta);W+=va*G}return z.coords.length?z:null};b.getBoundsOptimizedGeometry=
function(z,G,K,W){if(!G?.coords?.length)return null;K=w(K,W);let Z=W=Number.POSITIVE_INFINITY,ba=Number.NEGATIVE_INFINITY,ea=Number.NEGATIVE_INFINITY;if(G&&G.coords){G=G.coords;for(let la=0;la<G.length;la+=K){const na=G[la],wa=G[la+1];W=Math.min(W,na);ba=Math.max(ba,na);Z=Math.min(Z,wa);ea=Math.max(ea,wa)}}I.is(z)?I.fromRectValues(z,W,Z,ba,ea):p.fromValues(W,Z,ba,ea,z);return z};b.getQuantizedArea=function(z,G){const {coords:K,lengths:W}=z;let Z=z=0;for(let ba=0;ba<W.length;ba++){const ea=W[ba];Z+=
pa(K,z,ea,G);z+=ea}return Math.abs(Z)};b.getQuantizedBoundsOptimizedGeometry=function(z,G,K,W){K=w(K,W);const {lengths:Z,coords:ba}=G;W=G=Number.POSITIVE_INFINITY;let ea=Number.NEGATIVE_INFINITY,la=Number.NEGATIVE_INFINITY,na=0;for(const wa of Z){let ta=ba[na],va=ba[na+1];G=Math.min(ta,G);W=Math.min(va,W);ea=Math.max(ta,ea);la=Math.max(va,la);na+=K;for(let Ea=1;Ea<wa;Ea++,na+=K){const ya=ba[na],Da=ba[na+1];ta+=ya;va+=Da;0>ya&&(G=Math.min(G,ta));0<ya&&(ea=Math.max(ea,ta));0>Da?W=Math.min(W,va):0<Da&&
(la=Math.max(la,va))}}z[0]=G;z[1]=W;z[2]=ea;z[3]=la;return z};b.getSignedQuantizedRingArea=pa;b.quantizeOptimizedFeatureSet=function(z,G){const {geometryType:K,features:W,hasM:Z,hasZ:ba}=G;if(!z)return G;for(let ea=0;ea<W.length;ea++){const la=W[ea],na=la.weakClone();na.geometry=new t;ka(na.geometry,la.geometry,Z,ba,K,z);la.centroid&&(na.centroid=new t,ka(na.centroid,la.centroid,Z,ba,"esriGeometryPoint",z));W[ea]=na}G.transform=z;return G};b.quantizeOptimizedGeometry=ka;b.quantizeX=B;b.quantizeY=
r;b.removeCollinearVectices=function(z,G,K,W,Z){if(!G?.coords?.length)return null;K=Fa[K];const {coords:ba,lengths:ea}=G;G=C(W,Z,W,Z);W=w(W,Z);let la=Z=0,na=0,wa=0;for(const Ea of ea){la=wa;G(z.coords,ba,la,Z,ba[Z],ba[Z+1]);Z+=W;var ta=ba[Z];let ya=ba[Z+1],Da=ta,Ca=ya;var va=ya/ta;la+=W;G(z.coords,ba,la,Z,Da,Ca);Z+=W;for(let za=2;za<Ea;za++){ta=ba[Z];ya=ba[Z+1];const Ja=ya/ta,Ra=va===Ja||!isFinite(va)&&!isFinite(Ja);va=Ra&&isFinite(Ja)?0<=va&&0<=Ja||0>=va&&0>=Ja:0<=Ca&&0<=ya||0>=Ca&&0>=ya;Ra&&va?
(Da+=ta,Ca+=ya):(Da=ta,Ca=ya,la+=W);G(z.coords,ba,la,Z,Da,Ca);Z+=W;va=Ja}la+=W;ta=(la-wa)/W;ta>=K&&(z.lengths[na]=ta,wa=la,na++)}z.coords.length>wa&&(z.coords.length=wa);z.lengths.length>na&&(z.lengths.length=na);return z.coords.length&&z.lengths.length?z:null};b.removeZMValues=function(z,G,K,W,Z,ba){xa(z);z.lengths.push(...G.lengths);if(K===Z&&W===ba)for(var ea=0;ea<G.coords.length;ea++)z.coords.push(G.coords[ea]);else for(ea=w(K,W),K=C(K,W,Z,ba),G=G.coords,W=0;W<G.length;W+=ea)K(z.coords,G,z.coords.length,
W,G[W],G[W+1]);return z};b.unquantizeOptimizedFeatureSet=function(z){const {transform:G,features:K,hasM:W,hasZ:Z}=z;if(!G)return z;for(const ba of K)null!=ba.geometry&&ra(ba.geometry,ba.geometry,W,Z,G),null!=ba.centroid&&ra(ba.centroid,ba.centroid,W,Z,G);z.transform=null;return z};b.unquantizeOptimizedGeometry=ra;b.unquantizeValue=l;b.unquantizeX=function(z,G){return l(z,G,0)};b.unquantizeY=function(z,G){return l(z,-G,1)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/aaBoundingBox":function(){define(["exports",
"../Extent","./aaBoundingRect"],function(b,d,A){function u(l=B){return[l[0],l[1],l[2],l[3],l[4],l[5]]}function I(l,a,q,y,F,Q,e=u()){e[0]=l;e[1]=a;e[2]=q;e[3]=y;e[4]=F;e[5]=Q;return e}function p(l){return l[0]>=l[3]?0:l[3]-l[0]}function f(l){return l[1]>=l[4]?0:l[4]-l[1]}function v(l){return l[2]>=l[5]?0:l[5]-l[2]}function g(l,a){return Math.max(a[0],l[0])<=Math.min(a[3],l[3])&&Math.max(a[1],l[1])<=Math.min(a[4],l[4])&&Math.max(a[2],l[2])<=Math.min(a[5],l[5])}function t(l,a){l[0]=a[0];l[1]=a[1];l[2]=
a[2];l[3]=a[3];l[4]=a[4];l[5]=a[5];return l}function w(l){return 6===l.length}const C=[Infinity,Infinity,Infinity,-Infinity,-Infinity,-Infinity],B=[0,0,0,0,0,0],r=u();b.allFinite=function(l){for(let a=0;6>a;a++)if(!isFinite(l[a]))return!1;return!0};b.center=function(l,a=[0,0,0]){a[0]=l[0]+p(l)/2;a[1]=l[1]+f(l)/2;a[2]=l[2]+v(l)/2;return a};b.contains=function(l,a){return a[0]>=l[0]&&a[1]>=l[1]&&a[2]>=l[2]&&a[3]<=l[3]&&a[4]<=l[4]&&a[5]<=l[5]};b.containsPoint=function(l,a){return a[0]>=l[0]&&a[1]>=l[1]&&
a[2]>=l[2]&&a[0]<=l[3]&&a[1]<=l[4]&&a[2]<=l[5]};b.containsPointWithMargin=function(l,a,q){return a[0]>=l[0]-q&&a[1]>=l[1]-q&&a[2]>=l[2]-q&&a[0]<=l[3]+q&&a[1]<=l[4]+q&&a[2]<=l[5]+q};b.create=u;b.depth=f;b.diameter=function(l){const a=p(l),q=v(l);l=f(l);return Math.sqrt(a*a+q*q+l*l)};b.empty=function(l){return l?t(l,C):u(C)};b.equals=function(l,a,q){if(null==l||null==a)return l===a;if(!w(l)||!w(a))return!1;if(q)for(let y=0;y<l.length;y++){if(!q(l[y],a[y]))return!1}else for(q=0;q<l.length;q++)if(l[q]!==
a[q])return!1;return!0};b.expandWithAABB=function(l,a){l[0]=Math.min(l[0],a[0]);l[1]=Math.min(l[1],a[1]);l[2]=Math.min(l[2],a[2]);l[3]=Math.max(l[3],a[3]);l[4]=Math.max(l[4],a[4]);l[5]=Math.max(l[5],a[5])};b.expandWithBuffer=function(l,a,q=0,y=a.length/3){let F=l[0],Q=l[1],e=l[2],H=l[3],S=l[4],J=l[5];for(let R=0;R<y;R++)F=Math.min(F,a[q+3*R]),Q=Math.min(Q,a[q+3*R+1]),e=Math.min(e,a[q+3*R+2]),H=Math.max(H,a[q+3*R]),S=Math.max(S,a[q+3*R+1]),J=Math.max(J,a[q+3*R+2]);l[0]=F;l[1]=Q;l[2]=e;l[3]=H;l[4]=
S;l[5]=J};b.expandWithNestedArray=function(l,a,q){const y=a.length;let F=l[0],Q=l[1],e=l[2],H=l[3],S=l[4],J=l[5];if(q)for(q=0;q<y;q++){var R=a[q];F=Math.min(F,R[0]);Q=Math.min(Q,R[1]);e=Math.min(e,R[2]);H=Math.max(H,R[0]);S=Math.max(S,R[1]);J=Math.max(J,R[2])}else for(q=0;q<y;q++)R=a[q],F=Math.min(F,R[0]),Q=Math.min(Q,R[1]),H=Math.max(H,R[0]),S=Math.max(S,R[1]);l[0]=F;l[1]=Q;l[2]=e;l[3]=H;l[4]=S;l[5]=J};b.expandWithOffset=function(l,a,q,y){l[0]=Math.min(l[0],l[0]+a);l[3]=Math.max(l[3],l[3]+a);l[1]=
Math.min(l[1],l[1]+q);l[4]=Math.max(l[4],l[4]+q);l[2]=Math.min(l[2],l[2]+y);l[5]=Math.max(l[5],l[5]+y)};b.expandWithRect=function(l,a){l[0]=Math.min(l[0],a[0]);l[1]=Math.min(l[1],a[1]);l[3]=Math.max(l[3],a[2]);l[4]=Math.max(l[4],a[3])};b.expandWithVec3=function(l,a){l[0]=Math.min(l[0],a[0]);l[1]=Math.min(l[1],a[1]);l[2]=Math.min(l[2],a[2]);l[3]=Math.max(l[3],a[0]);l[4]=Math.max(l[4],a[1]);l[5]=Math.max(l[5],a[2])};b.fromExtent=function(l,a=u()){a[0]=l.xmin;a[1]=l.ymin;a[2]=l.hasZ?l.zmin:-Infinity;
a[3]=l.xmax;a[4]=l.ymax;a[5]=l.hasZ?l.zmax:Infinity;return a};b.fromMinMax=function(l,a,q=u()){q[0]=l[0];q[1]=l[1];q[2]=l[2];q[3]=a[0];q[4]=a[1];q[5]=a[2];return q};b.fromRect=function(l,a){l[0]=a[0];l[1]=a[1];l[2]=Number.NEGATIVE_INFINITY;l[3]=a[2];l[4]=a[3];l[5]=Number.POSITIVE_INFINITY;return l};b.fromRectValues=function(l,a,q,y,F){l[0]=a;l[1]=q;l[2]=Number.NEGATIVE_INFINITY;l[3]=y;l[4]=F;l[5]=Number.POSITIVE_INFINITY;return l};b.fromValues=I;b.getMax=function(l,a){a[0]=l[3];a[1]=l[4];a[2]=l[5];
return a};b.getMin=function(l,a){a[0]=l[0];a[1]=l[1];a[2]=l[2];return a};b.height=v;b.intersects=g;b.intersectsClippingArea=function(l,a){return null==a?!0:g(l,a)};b.is=w;b.isPoint=function(l){return 0===p(l)&&0===f(l)&&0===v(l)};b.maximumDimension=function(l){return Math.max(p(l),v(l),f(l))};b.negativeInfinity=C;b.offset=function(l,a,q,y,F=l){F[0]=l[0]+a;F[1]=l[1]+q;F[2]=l[2]+y;F[3]=l[3]+a;F[4]=l[4]+q;F[5]=l[5]+y;return F};b.positiveInfinity=[-Infinity,-Infinity,-Infinity,Infinity,Infinity,Infinity];
b.scale=function(l,a,q=l){const y=l[0]+p(l)/2,F=l[1]+f(l)/2,Q=l[2]+v(l)/2;q[0]=y+(l[0]-y)*a;q[1]=F+(l[1]-F)*a;q[2]=Q+(l[2]-Q)*a;q[3]=y+(l[3]-y)*a;q[4]=F+(l[4]-F)*a;q[5]=Q+(l[5]-Q)*a;return q};b.set=t;b.setMax=function(l,a,q=l){q[3]=a[0];q[4]=a[1];q[5]=a[2];q!==l&&(q[0]=l[0],q[1]=l[1],q[2]=l[2]);return l};b.setMin=function(l,a,q=l){q[0]=a[0];q[1]=a[1];q[2]=a[2];q!==l&&(q[3]=l[3],q[4]=l[4],q[5]=l[5]);return q};b.size=function(l,a=[0,0,0]){a[0]=p(l);a[1]=f(l);a[2]=v(l);return a};b.toExtent=function(l,
a){return isFinite(l[2])||isFinite(l[5])?new d({xmin:l[0],xmax:l[3],ymin:l[1],ymax:l[4],zmin:l[2],zmax:l[5],spatialReference:a}):new d({xmin:l[0],xmax:l[3],ymin:l[1],ymax:l[4],spatialReference:a})};b.toRect=function(l,a){a||(a=A.create());a[0]=l[0];a[1]=l[1];a[2]=l[3];a[3]=l[4];return a};b.width=p;b.wrap=function(l,a,q,y,F,Q){return I(l,a,q,y,F,Q,r)};b.zero=B;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/OptimizedFeature":function(){define(["exports"],function(b){class d{constructor(u=
null,I={},p,f){this.geometry=u;this.attributes=I;this.centroid=p;this.objectId=f;this.geohashY=this.geohashX=this.displayId=0}weakClone(){const u=new d(this.geometry,this.attributes,this.centroid,this.objectId);u.displayId=this.displayId;u.geohashX=this.geohashX;u.geohashY=this.geohashY;return u}}class A extends d{}b.OptimizedFeature=d;b.OptimizedFeatureWithGeometry=A;b.hasGeometry=function(u){return!!u.geometry?.coords?.length};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/OptimizedFeatureSet":function(){define(function(){class b{constructor(){this.spatialReference=
this.geometryType=this.geometryProperties=this.geohashFieldName=this.globalIdFieldName=this.objectIdFieldName=null;this.hasM=this.hasZ=!1;this.features=[];this.fields=[];this.transform=null;this.exceededTransferLimit=!1;this.queryGeometry=this.queryGeometryType=this.uniqueIdField=null}weakClone(){const d=new b;d.objectIdFieldName=this.objectIdFieldName;d.globalIdFieldName=this.globalIdFieldName;d.geohashFieldName=this.geohashFieldName;d.geometryProperties=this.geometryProperties;d.geometryType=this.geometryType;
d.spatialReference=this.spatialReference;d.hasZ=this.hasZ;d.hasM=this.hasM;d.features=this.features;d.fields=this.fields;d.transform=this.transform;d.exceededTransferLimit=this.exceededTransferLimit;d.uniqueIdField=this.uniqueIdField;d.queryGeometry=this.queryGeometry;d.queryGeometryType=this.queryGeometryType;return d}}return b})},"esri/layers/graphics/OptimizedGeometry":function(){define(function(){class b{constructor(d=[],A=[],u=!1){this.lengths=d??[];this.coords=A??[];this.hasIndeterminateRingOrder=
u}static fromRect(d){const [A,u,I,p]=d;d=I-A;const f=p-u;return new b([5],[A,u,d,0,0,f,-d,0,0,-f])}get isPoint(){return 0===this.lengths.length}get maxLength(){return Math.max(...this.lengths)}get size(){return this.lengths.reduce((d,A)=>d+A)}forEachVertex(d){let A=0;this.lengths.length||d(this.coords[0],this.coords[1]);for(let u=0;u<this.lengths.length;u++){const I=this.lengths[u];for(let p=0;p<I;p++)d(this.coords[2*(p+A)],this.coords[2*(p+A)+1]);A+=I}}clone(d){return d?(d.set(this.coords),new b(this.lengths.slice(),
d,this.hasIndeterminateRingOrder)):new b(this.lengths.slice(),this.coords.slice(),this.hasIndeterminateRingOrder)}}return b})},"esri/layers/graphics/data/FeatureStore":function(){define("../../../core/arrayUtils ../../../core/Error ../../../core/Evented ../../../core/Logger ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../featureConversionUtils ./BoundsStore ./geometryUtils ./optimizedFeatureQueryEngineAdapter".split(" "),function(b,d,A,u,I,p,f,v,g,t){const w=I.create();
class C{constructor(B){this.geometryInfo=B;this._boundsStore=new v.BoundsStore;this._featuresById=new Map;this._markedIds=new Set;this.events=new A;this.featureAdapter=t.optimizedFeatureQueryEngineAdapter}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){return this._boundsStore.fullBounds}get storeStatistics(){let B=0;this._featuresById.forEach(r=>
{null!=r.geometry&&r.geometry.coords&&(B+=r.geometry.coords.length)});return{featureCount:this._featuresById.size,vertexCount:B/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}getFullExtent(B){if(null==this.fullBounds)return null;const [r,l,a,q]=this.fullBounds;return{xmin:r,ymin:l,xmax:a,ymax:q,spatialReference:g.cleanFromGeometryEngine(B)}}add(B){this._add(B);this._emitChanged()}addMany(B){for(const r of B)this._add(r);this._emitChanged()}upsertMany(B){B=B.map(r=>this._upsert(r));this._emitChanged();return B.filter(b.isSome)}clear(){this._featuresById.clear();
this._boundsStore.clear();this._emitChanged()}removeById(B){B=this._featuresById.get(B);if(!B)return null;this._remove(B);this._emitChanged();return B}removeManyById(B){this._boundsStore.invalidateIndex();for(const r of B)(B=this._featuresById.get(r))&&this._remove(B);this._emitChanged()}forEachBounds(B,r){for(const l of B)(B=this._boundsStore.get(l.objectId))&&r(I.fromRect(w,B))}getFeature(B){return this._featuresById.get(B)}has(B){return this._featuresById.has(B)}forEach(B){this._featuresById.forEach(r=>
B(r))}forEachInBounds(B,r){this._boundsStore.forEachInBounds(B,l=>{r(this._featuresById.get(l))})}startMarkingUsedFeatures(){this._boundsStore.invalidateIndex();this._markedIds.clear()}sweep(){let B=!1;this._featuresById.forEach((r,l)=>{this._markedIds.has(l)||(B=!0,this._remove(r))});this._markedIds.clear();B&&this._emitChanged()}_emitChanged(){this.events.emit("changed",void 0)}_add(B){if(B){var r=B.objectId;if(null==r)u.getLogger("esri.layers.graphics.data.FeatureStore").error(new d("featurestore:invalid-feature",
"feature id is missing",{feature:B}));else{var l=this._featuresById.get(r);this._markedIds.add(r);if(l){B.displayId=l.displayId;var a=this._boundsStore.get(r);this._boundsStore.delete(r)}else if(null!=this.onFeatureAdd)this.onFeatureAdd(B);B.geometry?.coords?.length?(a=f.getBoundsOptimizedGeometry(null!=a?a:p.create(),B.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),null!=a&&this._boundsStore.set(r,a)):this._boundsStore.set(r,null);this._featuresById.set(r,B)}}}_upsert(B){const r=B?.objectId;
if(null==r)return u.getLogger("esri.layers.graphics.data.FeatureStore").error(new d("featurestore:invalid-feature","feature id is missing",{feature:B})),null;const l=this._featuresById.get(r);if(!l)return this._add(B),B;this._markedIds.add(r);const {geometry:a,attributes:q}=B;for(const y in q)l.attributes[y]=q[y];a&&(l.geometry=a,this._boundsStore.set(r,f.getBoundsOptimizedGeometry(p.create(),a,this.geometryInfo.hasZ,this.geometryInfo.hasM)??null));return l}_remove(B){if(null!=this.onFeatureRemove)this.onFeatureRemove(B);
const r=B.objectId;this._markedIds.delete(r);this._boundsStore.delete(r);this._featuresById.delete(r);return B}}return C})},"esri/layers/graphics/data/BoundsStore":function(){define(["exports","../../../core/has","../../../core/libs/rbush/PooledRBush","../../../geometry/support/aaBoundingRect"],function(b,d,A,u){function I(v,g,t){p.minX=g[0];p.minY=g[1];p.maxX=g[2];p.maxY=g[3];v.search(p,t)}const p={minX:0,minY:0,maxX:0,maxY:0};class f{constructor(){this._indexInvalid=!1;this._boundsToLoad=[];this._boundsById=
new Map;this._idByBounds=new Map;this._index=new A.PooledRBush(9,d("esri-csp-restrictions")?v=>({minX:v[0],minY:v[1],maxX:v[2],maxY:v[3]}):["[0]","[1]","[2]","[3]"]);this._loadIndex=()=>{if(this._indexInvalid){const v=Array(this._idByBounds.size);let g=0;this._idByBounds.forEach((t,w)=>{v[g++]=w});this._indexInvalid=!1;this._index.clear();this._index.load(v)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter(v=>this._idByBounds.has(v))))),this._boundsToLoad.length=
0)}}get fullBounds(){if(!this._boundsById.size)return null;const v=u.empty();for(const g of this._boundsById.values())g&&(v[0]=Math.min(g[0],v[0]),v[1]=Math.min(g[1],v[1]),v[2]=Math.max(g[2],v[2]),v[3]=Math.max(g[3],v[3]));return v}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=!1;this._boundsToLoad.length=0;this._boundsById.clear();this._idByBounds.clear();this._index.clear()}delete(v){const g=this._boundsById.get(v);this._boundsById.delete(v);g&&(this._idByBounds.delete(g),this._indexInvalid||
this._index.remove(g))}forEachInBounds(v,g){this._loadIndex();I(this._index,v,t=>g(this._idByBounds.get(t)))}get(v){return this._boundsById.get(v)}has(v){return this._boundsById.has(v)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(v,g){if(!this._indexInvalid){const t=this._boundsById.get(v);t&&(this._index.remove(t),this._idByBounds.delete(t))}this._boundsById.set(v,g);g&&(this._idByBounds.set(g,v),this._indexInvalid||(this._boundsToLoad.push(g),5E4<
this._boundsToLoad.length&&this._loadIndex()))}}b.BoundsStore=f;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/rbush/PooledRBush":function(){define(["exports","../../arrayUtils","../../PooledArray","../../../chunks/quickselect"],function(b,d,A,u){function I(J,R){p(J,0,J.children.length,R,J)}function p(J,R,P,V,m){m||(m=new H([]));m.minX=Infinity;m.minY=Infinity;m.maxX=-Infinity;m.maxY=-Infinity;for(let O=R,n;O<P;O++)n=J.children[O],f(m,J.leaf?V(n):n);return m}function f(J,
R){J.minX=Math.min(J.minX,R.minX);J.minY=Math.min(J.minY,R.minY);J.maxX=Math.max(J.maxX,R.maxX);J.maxY=Math.max(J.maxY,R.maxY)}function v(J,R){return J.minX-R.minX}function g(J,R){return J.minY-R.minY}function t(J){return(J.maxX-J.minX)*(J.maxY-J.minY)}function w(J){return J.maxX-J.minX+(J.maxY-J.minY)}function C(J,R){return J.minX<=R.minX&&J.minY<=R.minY&&R.maxX<=J.maxX&&R.maxY<=J.maxY}function B(J,R){return R.minX<=J.maxX&&R.minY<=J.maxY&&R.maxX>=J.minX&&R.maxY>=J.minY}function r(J,R,P,V,m){for(R=
[R,P];R.length;){P=R.pop();const O=R.pop();if(P-O<=V)continue;const n=O+Math.ceil((P-O)/V/2)*V;u.quickselect(J,n,O,P,m);R.push(O,n,n,P)}}class l{constructor(J=9,R){this._compareMinX=v;this._compareMinY=g;this._toBBox=P=>P;this._maxEntries=Math.max(4,J||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));R&&("function"===typeof R?this._toBBox=R:this._initFormat(R));this.clear()}destroy(){this.clear();a.prune();q.prune();y.prune();F.prune()}all(J){this._all(this._data,J)}search(J,R){let P=
this._data;const V=this._toBBox;if(B(J,P))for(a.clear();P;){for(let m=0,O=P.children.length;m<O;m++){const n=P.children[m],x=P.leaf?V(n):n;B(J,x)&&(P.leaf?R(n):C(J,x)?this._all(n,R):a.push(n))}P=a.pop()}}collides(J){let R=this._data;const P=this._toBBox;if(!B(J,R))return!1;for(a.clear();R;){for(let V=0,m=R.children.length;V<m;V++){const O=R.children[V],n=R.leaf?P(O):O;if(B(J,n)){if(R.leaf||C(J,n))return!0;a.push(O)}}R=a.pop()}return!1}load(J){if(!J.length)return this;if(J.length<this._minEntries){for(let R=
0,P=J.length;R<P;R++)this.insert(J[R]);return this}J=this._build(J.slice(0,J.length),0,J.length-1,0);if(this._data.children.length)if(this._data.height===J.height)this._splitRoot(this._data,J);else{if(this._data.height<J.height){const R=this._data;this._data=J;J=R}this._insert(J,this._data.height-J.height-1,!0)}else this._data=J;return this}insert(J){J&&this._insert(J,this._data.height-1);return this}clear(){this._data=new H([]);return this}remove(J){if(!J)return this;let R=this._data,P=null,V=0,
m=!1,O;const n=this._toBBox(J);y.clear();for(F.clear();R||0<y.length;){R||(R=y.pop(),P=y.data[y.length-1],V=F.pop()??0,m=!0);if(R.leaf&&(O=d.indexOf(R.children,J,R.children.length,R.indexHint),-1!==O)){R.children.splice(O,1);y.push(R);this._condense(y);break}m||R.leaf||!C(R,n)?P?(V++,R=P.children[V],m=!1):R=null:(y.push(R),F.push(V),V=0,P=R,R=R.children[0])}return this}toJSON(){return this._data}fromJSON(J){this._data=J;return this}_all(J,R){for(q.clear();J;){if(!0===J.leaf)for(const P of J.children)R(P);
else q.pushArray(J.children);J=q.pop()??null}}_build(J,R,P,V){var m=P-R+1,O=this._maxEntries;if(m<=O)return J=new H(J.slice(R,P+1)),I(J,this._toBBox),J;V||(V=Math.ceil(Math.log(m)/Math.log(O)),O=Math.ceil(m/O**(V-1)));const n=new S([]);n.height=V;m=Math.ceil(m/O);O=m*Math.ceil(Math.sqrt(O));for(r(J,R,P,O,this._compareMinX);R<=P;R+=O){const x=Math.min(R+O-1,P);r(J,R,x,m,this._compareMinY);for(let M=R;M<=x;M+=m)n.children.push(this._build(J,M,Math.min(M+m-1,x),V-1))}I(n,this._toBBox);return n}_chooseSubtree(J,
R,P,V){for(;;){V.push(R);if(!0===R.leaf||V.length-1===P)break;let m=Infinity,O=Infinity,n=void 0;for(let x=0,M=R.children.length;x<M;x++){const L=R.children[x],T=t(L),Y=(Math.max(L.maxX,J.maxX)-Math.min(L.minX,J.minX))*(Math.max(L.maxY,J.maxY)-Math.min(L.minY,J.minY))-T;Y<O?(O=Y,m=T<m?T:m,n=L):Y===O&&T<m&&(m=T,n=L)}R=n||R.children[0]}return R}_insert(J,R,P){var V=this._toBBox;P=P?J:V(J);y.clear();V=this._chooseSubtree(P,this._data,R,y);V.children.push(J);for(f(V,P);0<=R;)if(y.data[R].children.length>
this._maxEntries)this._split(y,R),R--;else break;this._adjustParentBBoxes(P,y,R)}_split(J,R){const P=J.data[R];var V=P.children.length;const m=this._minEntries;this._chooseSplitAxis(P,m,V);(V=this._chooseSplitIndex(P,m,V))?(V=P.children.splice(V,P.children.length-V),V=P.leaf?new H(V):new S(V),V.height=P.height,I(P,this._toBBox),I(V,this._toBBox),R?J.data[R-1].children.push(V):this._splitRoot(P,V)):console.log("  Error: assertion failed at PooledRBush._split: no valid split index")}_splitRoot(J,R){this._data=
new S([J,R]);this._data.height=J.height+1;I(this._data,this._toBBox)}_chooseSplitIndex(J,R,P){let V,m,O=void 0;V=m=Infinity;for(let x=R;x<=P-R;x++){var n=p(J,0,x,this._toBBox);const M=p(J,x,P,this._toBBox),L=Math.max(0,Math.min(n.maxX,M.maxX)-Math.max(n.minX,M.minX))*Math.max(0,Math.min(n.maxY,M.maxY)-Math.max(n.minY,M.minY));n=t(n)+t(M);L<V?(V=L,O=x,m=n<m?n:m):L===V&&n<m&&(m=n,O=x)}return O}_chooseSplitAxis(J,R,P){const V=J.leaf?this._compareMinX:v,m=J.leaf?this._compareMinY:g,O=this._allDistMargin(J,
R,P,V);R=this._allDistMargin(J,R,P,m);O<R&&J.children.sort(V)}_allDistMargin(J,R,P,V){J.children.sort(V);V=this._toBBox;var m=p(J,0,R,V);const O=p(J,P-R,P,V);let n=w(m)+w(O);for(let x=R;x<P-R;x++){const M=J.children[x];f(m,J.leaf?V(M):M);n+=w(m)}for(P=P-R-1;P>=R;P--)m=J.children[P],f(O,J.leaf?V(m):m),n+=w(O);return n}_adjustParentBBoxes(J,R,P){for(;0<=P;P--)f(R.data[P],J)}_condense(J){for(let R=J.length-1;0<=R;R--){const P=J.data[R];if(0===P.children.length)if(0<R){const V=J.data[R-1],m=V.children;
m.splice(d.indexOf(m,P,m.length,V.indexHint),1)}else this.clear();else I(P,this._toBBox)}}_initFormat(J){const R=["return a"," - b",";"];this._compareMinX=new Function("a","b",R.join(J[0]));this._compareMinY=new Function("a","b",R.join(J[1]));this._toBBox=new Function("a","return {minX: a"+J[0]+", minY: a"+J[1]+", maxX: a"+J[2]+", maxY: a"+J[3]+"};")}}const a=new A,q=new A,y=new A,F=new A({deallocator:void 0});class Q{constructor(){this.minY=this.minX=Infinity;this.maxY=this.maxX=-Infinity}}class e extends Q{constructor(){super(...arguments);
this.height=1;this.indexHint=new d.PositionHint}}class H extends e{constructor(J){super();this.children=J;this.leaf=!0}}class S extends e{constructor(J){super();this.children=J;this.leaf=!1}}b.BBox=Q;b.PooledRBush=l;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/quickselect":function(){define(["exports","./_commonjsHelpers"],function(b,d){var A={exports:{}};A.exports;(function(u){(function(I){I=I();void 0!==I&&(u.exports=I)})(function(){function I(v,g,t,w,C){for(;w>t;){if(600<
w-t){var B=w-t+1,r=g-t+1,l=Math.log(B),a=.5*Math.exp(2*l/3);l=.5*Math.sqrt(l*a*(B-a)/B)*(0>r-B/2?-1:1);I(v,g,Math.max(t,Math.floor(g-r*a/B+l)),Math.min(w,Math.floor(g+(B-r)*a/B+l)),C)}B=v[g];r=t;a=w;p(v,t,g);for(0<C(v[w],B)&&p(v,t,w);r<a;){p(v,r,a);r++;for(a--;0>C(v[r],B);)r++;for(;0<C(v[a],B);)a--}0===C(v[t],B)?p(v,t,a):(a++,p(v,a,w));a<=g&&(t=a+1);g<=a&&(w=a-1)}}function p(v,g,t){var w=v[g];v[g]=v[t];v[t]=w}function f(v,g){return v<g?-1:v>g?1:0}return function(v,g,t,w,C){I(v,g,t||0,w||v.length-
1,C||f)}})})(A);d=d.getDefaultExportFromCjs(A.exports);b.quickselect=d})},"esri/layers/graphics/data/geometryUtils":function(){define(["exports","../featureConversionUtils","../OptimizedGeometry"],function(b,d,A){const u=new A,I=new A,p=new A,f={esriGeometryPoint:d.convertToPoint,esriGeometryPolyline:d.convertToPolyline,esriGeometryPolygon:d.convertToPolygon,esriGeometryMultipoint:d.convertToMultipoint},v=(g,t)=>"_geVersion"!==g?t:void 0;b.cleanFromGeometryEngine=function(g){return g&&"_geVersion"in
g?JSON.parse(JSON.stringify(g,v)):g};b.getGeometry=function(g,t,w,C,B,r,l=t,a=w){const q=t&&l,y=w&&a;C=null!=C?"coords"in C?C:C.geometry:null;if(null==C)return null;if(B)return t=d.generalizeOptimizedGeometry(I,C,t,w,g,B,l,a),r&&(t=d.quantizeOptimizedGeometry(p,t,q,y,g,r)),f[g]?.(t,q,y)??null;if(r)return r=d.quantizeOptimizedGeometry(p,C,t,w,g,r,l,a),f[g]?.(r,q,y)??null;d.removeZMValues(u,C,t,w,l,a);return f[g]?.(u,q,y)??null};b.transformCentroid=function(g,t,w,C=g.hasZ,B=g.hasM){if(null==t)return null;
const r=g.hasZ&&C,l=g.hasM&&B;return w?(g=d.quantizeOptimizedGeometry(p,t,g.hasZ,g.hasM,"esriGeometryPoint",w,C,B),d.convertToPoint(g,r,l)):d.convertToPoint(t,r,l)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/optimizedFeatureQueryEngineAdapter":function(){define(["exports","../centroid","../OptimizedFeature","../OptimizedGeometry"],function(b,d,A,u){b.optimizedFeatureQueryEngineAdapter={getObjectId(I){return I.objectId},getAttributes(I){return I.attributes},
getAttribute(I,p){return I.attributes[p]},cloneWithGeometry(I,p){return new A.OptimizedFeature(p,I.attributes,null,I.objectId)},getGeometry(I){return I.geometry},getCentroid(I,p){null==I.centroid&&(I.centroid=d.getCentroidOptimizedGeometry(new u,I.geometry,p.hasZ,p.hasM));return I.centroid}};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/centroid":function(){define(["exports"],function(b){function d(u,I,p,f,v,g,t=1){g=v?g?4:3:g?3:2;let w=p,C=p+g,B=0,r=0,l=p=
0,a=0;for(let q=0,y=f-1;q<y;q++,w+=g,C+=g){f=I[w];const F=I[w+1],Q=I[w+2],e=I[C],H=I[C+1],S=I[C+2];let J=f*H-e*F;l+=J;B+=(f+e)*J;r+=(F+H)*J;v&&(J=f*S-e*Q,p+=(Q+S)*J,a+=J);f<u[0]&&(u[0]=f);f>u[1]&&(u[1]=f);F<u[2]&&(u[2]=F);F>u[3]&&(u[3]=F);v&&(Q<u[4]&&(u[4]=Q),Q>u[5]&&(u[5]=Q))}0<l*t&&(l*=-1);0<a*t&&(a*=-1);if(!l)return null;u=[B,r,.5*l];v&&(u[3]=p,u[4]=.5*a);return u}function A(u,I,p,f,v){v=f?v?4:3:v?3:2;let g=I,t=I+v,w=0,C=0,B=0,r=0;for(let y=0,F=p-1;y<F;y++,g+=v,t+=v){var l=u[g];const Q=u[g+1],
e=u[g+2],H=u[t],S=u[t+1],J=u[t+2];if(f){var a=H-l;var q=S-Q;const R=J-e;a=Math.sqrt(a*a+q*q+R*R)}else a=H-l,q=S-Q,a=Math.sqrt(a*a+q*q);a&&(w+=a,f?(l=[l+.5*(H-l),Q+.5*(S-Q),e+.5*(J-e)],C+=a*l[0],B+=a*l[1],r+=a*l[2]):(l=[l+.5*(H-l),Q+.5*(S-Q)],C+=a*l[0],B+=a*l[1]))}return 0<w?f?[C/w,B/w,r/w]:[C/w,B/w]:0<p?f?[u[I],u[I+1],u[I+2]]:[u[I],u[I+1]]:null}b.getCentroidOptimizedGeometry=function(u,I,p,f,v){if(!I?.lengths.length)return null;const g="upperLeft"===v?.originPosition?-1:1;u.lengths.length&&(u.lengths.length=
0);u.coords.length&&(u.coords.length=0);v=u.coords;const t=[],w=p?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:C,coords:B}=I,r=p?f?4:3:f?3:2;let l=0;for(var a of C){const q=d(w,B,l,a,p,f,g);q&&t.push(q);l+=a*r}t.sort((q,y)=>{let F=g*q[2]-g*y[2];0===F&&p&&(F=q[4]-y[4]);return F});t.length&&
(a=6*t[0][2],v[0]=t[0][0]/a,v[1]=t[0][1]/a,p&&(a=6*t[0][4],v[2]=0!==a?t[0][3]/a:0),v[0]<w[0]||v[0]>w[1]||v[1]<w[2]||v[1]>w[3]||p&&(v[2]<w[4]||v[2]>w[5]))&&(v.length=0);if(!v.length)if(I=I.lengths[0]?A(B,0,C[0],p,f):null)v[0]=I[0],v[1]=I[1],p&&2<I.length&&(v[2]=I[2]);else return null;return u};b.lineCentroid=A;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/projectionSupport":function(){define("exports ../../../core/arrayUtils ../../../core/promiseUtils ../../../geometry/projection ../../../geometry/geometryAdapters/json ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),
function(b,d,A,u,I,p,f){function v(a,q){if(!q)return null;if("x"in q){var y={x:0,y:0};[y.x,y.y]=a(q.x,q.y,w);null!=q.z&&(y.z=q.z);null!=q.m&&(y.m=q.m);return y}return"xmin"in q?(y={xmin:0,ymin:0,xmax:0,ymax:0},[y.xmin,y.ymin]=a(q.xmin,q.ymin,w),[y.xmax,y.ymax]=a(q.xmax,q.ymax,w),q.hasZ&&(y.zmin=q.zmin,y.zmax=q.zmax,y.hasZ=!0),q.hasM&&(y.mmin=q.mmin,y.mmax=q.mmax,y.hasM=!0),y):"rings"in q?{rings:g(q.rings,a),hasM:q.hasM,hasZ:q.hasZ}:"paths"in q?{paths:g(q.paths,a),hasM:q.hasM,hasZ:q.hasZ}:"points"in
q?{points:t(q.points,a),hasM:q.hasM,hasZ:q.hasZ}:null}function g(a,q){const y=[];for(const F of a)y.push(t(F,q));return y}function t(a,q){const y=[];for(const F of a)a=q(F[0],F[1],[0,0]),y.push(a),2<F.length&&a.push(F[2]),3<F.length&&a.push(F[3]);return y}const w=[0,0],C=v.bind(null,f.lngLatToXY),B=v.bind(null,f.xyToLngLat);class r{constructor(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}async push(a,q,y,F){if(!a?.length||!q||!y||p.equals(q,y))return a;a={geometries:a,inSpatialReference:q,
outSpatialReference:y,geographicTransformation:F,resolve:A.createResolver()};this._jobs.push(a);this._timer??(this._timer=setTimeout(this._process,10));return a.resolve.promise}_process(){this._timer=null;const a=this._jobs.shift();if(a){var {geometries:q,inSpatialReference:y,outSpatialReference:F,resolve:Q,geographicTransformation:e}=a;f.canProject(y,F)?p.isWebMercator(F)?Q(q.map(C)):Q(q.map(B)):Q(u.projectMany(I.jsonAdapter,q,y,F,e,null));0<this._jobs.length&&(this._timer=setTimeout(this._process,
10))}}}const l=new r;b.checkProjectionSupport=async function(a,q){a&&q&&(a=Array.isArray(a)?a.map(y=>null!=y.geometry?y.geometry.spatialReference:null).filter(d.isSome):[a],await u.initializeProjection(a.map(y=>({source:y,dest:q}))))};b.project=function(a,q,y,F){if(!a)return a;y||(y=q,q=a.spatialReference);return p.isValid(q)&&p.isValid(y)&&!p.equals(q,y)?f.canProject(q,y)?(a=p.isWebMercator(y)?C(a):B(a),a.spatialReference=y,a):u.projectMany(I.jsonAdapter,[a],q,y,null,F)[0]:a};b.projectMany=function(a,
q,y,F){return l.push(a,q,y,F)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/geometryAdapters/json":function(){define(["exports"],function(b){class d{constructor(f,v,g){this.x=f;this.y=v;this.spatialReference=g;this.m=this.z=void 0}}class A{constructor(f,v,g,t){this.rings=f;this.spatialReference=v;this.hasM=this.hasZ=void 0;g&&(this.hasZ=g);t&&(this.hasM=t)}}class u{constructor(f,v,g,t){this.paths=f;this.spatialReference=v;this.hasM=this.hasZ=void 0;g&&(this.hasZ=
g);t&&(this.hasM=t)}}class I{constructor(f,v,g,t){this.points=f;this.spatialReference=v;this.hasM=this.hasZ=void 0;g&&(this.hasZ=g);t&&(this.hasM=t)}}class p{constructor(f,v,g,t,w){this.xmin=f;this.ymin=v;this.xmax=g;this.ymax=t;this.spatialReference=w;this.mmax=this.mmin=this.zmax=this.zmin=void 0}}b.jsonAdapter={convertToGEGeometry:function(f,v){return null==v?null:f.convertJSONToGeometry(v)},exportPoint:function(f,v,g){g=new d(f.getPointX(v),f.getPointY(v),g);const t=f.hasZ(v),w=f.hasM(v);t&&(g.z=
f.getPointZ(v));w&&(g.m=f.getPointM(v));return g},exportPolygon:function(f,v,g){return new A(f.exportPaths(v),g,f.hasZ(v),f.hasM(v))},exportPolyline:function(f,v,g){return new u(f.exportPaths(v),g,f.hasZ(v),f.hasM(v))},exportMultipoint:function(f,v,g){return new I(f.exportPoints(v),g,f.hasZ(v),f.hasM(v))},exportExtent:function(f,v,g){var t=f.hasZ(v);const w=f.hasM(v);g=new p(f.getXMin(v),f.getYMin(v),f.getXMax(v),f.getYMax(v),g);t&&(t=f.getZExtent(v),g.zmin=t.vmin,g.zmax=t.vmax);w&&(f=f.getMExtent(v),
g.mmin=f.vmin,g.mmax=f.vmax);return g}};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/QueryEngine":function(){define("exports ../../../core/arrayUtils ../../../core/Error ../../../core/JSONSupport ../../../core/lang ../../../core/maybe ../../../core/MemCache ../../../core/promiseUtils ../../../core/unitUtils ../../../geometry/projection ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./attributeSupport ./geometryUtils ./projectionSupport ./QueryEngineCapabilities ./QueryEngineResult ./queryUtils ./queryValidationUtils ./spatialQuerySupport ./timeSupport ../../support/FieldsIndex ../../../views/support/Scheduler".split(" "),
function(b,d,A,u,I,p,f,v,g,t,w,C,B,r,l,a,q,y,F,Q,e,H,S,J,R,P,V,m){class O{constructor(L,T=null,Y,fa,oa){this.attributes=L;this.geometry=Y;this.centroid=fa;this.filterFlags=oa;this.groupId=-1;this.displayId=T}}const n=new f.MemCacheStorage(2E6);let x=0;class M{constructor(L){this._changeHandle=this._geometryQueryCache=null;this.capabilities={query:e.queryCapabilities};this.geometryType=L.geometryType;this.hasM=!!L.hasM;this.hasZ=!!L.hasZ;this.objectIdField=L.objectIdField;this.spatialReference=L.spatialReference;
this.definitionExpression=L.definitionExpression;this.featureStore=L.featureStore;this.aggregateAdapter=L.aggregateAdapter;this._changeHandle=this.featureStore.events.on("changed",()=>this.clearCache());this.timeInfo=L.timeInfo;L.cacheSpatialQueries&&(this._geometryQueryCache=new f.MemCache(x++ +"$$",n));this.fieldsIndex=u.isSerializable(L.fieldsIndex)?L.fieldsIndex:V.fromJSON(L.fieldsIndex);this.availableFields=null==L.availableFields?new Set(this.fieldsIndex.fields.map(T=>T.name)):new Set(L.availableFields.map(T=>
this.fieldsIndex.get(T)?.name).filter(T=>null!=T));L.scheduler&&L.priority&&(this._frameTask=L.scheduler.registerTask(L.priority))}destroy(){this._frameTask=p.removeMaybe(this._frameTask);this.clearCache();p.destroyMaybe(this._geometryQueryCache);this._changeHandle=p.removeMaybe(this._changeHandle)}get featureAdapter(){return this.featureStore.featureAdapter}clearCache(){this._geometryQueryCache?.clear();this._fullExtentPromise=this._timeExtentPromise=this._allFeaturesPromise=null}async executeQuery(L,
T){try{return(await this._executeQuery(L,{},T)).createQueryResponse()}catch(Y){if(Y!==S.queryEngineEmptyResult)throw Y;return(new H.QueryEngineResult([],L,this)).createQueryResponse()}}async executeQueryForCount(L={},T){try{return(await this._executeQuery(L,{returnGeometry:!1,returnCentroid:!1,outSR:null},T)).createQueryResponseForCount()}catch(Y){if(Y!==S.queryEngineEmptyResult)throw Y;return 0}}async executeQueryForExtent(L,T){const Y=L.outSR;try{const fa=await this._executeQuery(L,{returnGeometry:!0,
returnCentroid:!1,outSR:null},T),oa=fa.size;if(!oa)return{count:0,extent:null};const sa=await this._getBounds(fa.items,fa.spatialReference,Y||this.spatialReference);return{count:oa,extent:sa}}catch(fa){if(fa===S.queryEngineEmptyResult)return{count:0,extent:null};throw fa;}}async executeQueryForIds(L,T){return this.executeQueryForIdSet(L,T).then(Y=>Array.from(Y))}async executeQueryForIdSet(L,T){try{const Y=await this._executeQuery(L,{returnGeometry:!0,returnCentroid:!1,outSR:null},T),fa=Y.items,oa=
new Set;await this._reschedule(()=>{for(const sa of fa)oa.add(Y.featureAdapter.getObjectId(sa))},T);return oa}catch(Y){if(Y===S.queryEngineEmptyResult)return new Set;throw Y;}}async executeQueryForSnapping(L,T){const {point:Y,distance:fa,returnEdge:oa,vertexMode:sa}=L;if(!oa&&"none"===sa)return{candidates:[]};let ca=I.clone(L.query);ca=await this._schedule(()=>S.normalizeQueryLike(ca,this.definitionExpression,this.spatialReference),T);ca=await this._reschedule(()=>J.validateQuery(ca,{availableFields:this.availableFields,
fieldsIndex:this.fieldsIndex,geometryType:this.geometryType,spatialReference:this.spatialReference}),T);const ka=!a.equals(Y.spatialReference,this.spatialReference);ka&&await Q.checkProjectionSupport(Y.spatialReference,this.spatialReference);var ia="number"===typeof fa?fa:fa.x,ra="number"===typeof fa?fa:fa.y;ia={xmin:Y.x-ia,xmax:Y.x+ia,ymin:Y.y-ra,ymax:Y.y+ra,spatialReference:Y.spatialReference};ia=ka?Q.project(ia,this.spatialReference):ia;if(!ia)return{candidates:[]};ra=(await l.normalizeCentralMeridian(r.fromJSON(Y),
null,{signal:T}))[0];const pa=(await l.normalizeCentralMeridian(r.fromJSON(ia),null,{signal:T}))[0];if(null==ra||null==pa)return{candidates:[]};const xa=new H.QueryEngineResult(await this._reschedule(()=>this._searchFeatures(this._getQueryBBoxes(pa.toJSON())),T),ca,this);await this._reschedule(()=>this._executeObjectIdsQuery(xa),T);await this._reschedule(()=>this._executeTimeQuery(xa),T);await this._reschedule(()=>this._executeAttributesQuery(xa),T);await this._reschedule(()=>this._executeGeometryQueryForSnapping(xa,
T),T);ra=ra.toJSON();ra=ka?Q.project(ra,this.spatialReference):ra;return xa.createSnappingResponse({...L,point:ra,distance:ka?Math.max(ia.xmax-ia.xmin,ia.ymax-ia.ymin)/2:fa},Y.spatialReference)}async executeQueryForLatestObservations(L,T){if(!this.timeInfo?.trackIdField)throw new A("unsupported-query","Missing timeInfo or timeInfo.trackIdField",{query:L,timeInfo:this.timeInfo});try{const Y=await this._executeQuery(L,{},T);await this._reschedule(()=>this._filterLatest(Y),T);return Y.createQueryResponse()}catch(Y){if(Y!==
S.queryEngineEmptyResult)throw Y;return(new H.QueryEngineResult([],L,this)).createQueryResponse()}}async executeQueryForSummaryStatistics(L={},T,Y){const {field:fa,normalizationField:oa,valueExpression:sa}=T;return(await this._executeQueryForStatistics(L,{field:fa,normalizationField:oa,valueExpression:sa},Y)).createSummaryStatisticsResponse(T)}async executeQueryForUniqueValues(L={},T,Y){const {field:fa,field2:oa,field3:sa,valueExpression:ca}=T;return(await this._executeQueryForStatistics(L,{field:fa,
field2:oa,field3:sa,valueExpression:ca},Y)).createUniqueValuesResponse(T)}async executeQueryForClassBreaks(L={},T,Y){const {field:fa,normalizationField:oa,valueExpression:sa}=T;return(await this._executeQueryForStatistics(L,{field:fa,normalizationField:oa,valueExpression:sa},Y)).createClassBreaksResponse(T)}async executeQueryForHistogram(L={},T,Y){const {field:fa,normalizationField:oa,valueExpression:sa}=T;return(await this._executeQueryForStatistics(L,{field:fa,normalizationField:oa,valueExpression:sa},
Y)).createHistogramResponse(T)}async fetchRecomputedExtents(L){this._timeExtentPromise||(this._timeExtentPromise=P.getTimeExtent(this.timeInfo,this.featureStore));const [T,Y]=await Promise.all([this._getFullExtent(),this._timeExtentPromise]);v.throwIfAborted(L);return{fullExtent:T,timeExtent:Y}}async _getBounds(L,T,Y){const fa=w.set(w.create(),w.negativeInfinity);await this.featureStore.forEachBounds(L,oa=>w.expandWithAABB(fa,oa));L={xmin:fa[0],ymin:fa[1],xmax:fa[3],ymax:fa[4],spatialReference:F.cleanFromGeometryEngine(this.spatialReference)};
this.hasZ&&isFinite(fa[2])&&isFinite(fa[5])&&(L.zmin=fa[2],L.zmax=fa[5]);T=Q.project(L,T,Y);T.spatialReference=F.cleanFromGeometryEngine(Y);0===T.xmax-T.xmin&&(Y=g.getMetersPerUnitForSR(T.spatialReference),T.xmin-=Y,T.xmax+=Y);0===T.ymax-T.ymin&&(Y=g.getMetersPerUnitForSR(T.spatialReference),T.ymin-=Y,T.ymax+=Y);this.hasZ&&null!=T.zmin&&null!=T.zmax&&0===T.zmax-T.zmin&&(Y=g.getMetersPerUnitForSR(T.spatialReference),T.zmin-=Y,T.zmax+=Y);return T}_getFullExtent(){this._fullExtentPromise||(this._fullExtentPromise=
"getFullExtent"in this.featureStore&&this.featureStore.getFullExtent?Promise.resolve(this.featureStore.getFullExtent(this.spatialReference)):this._getAllFeatures().then(L=>this._getBounds(L,this.spatialReference,this.spatialReference)));return this._fullExtentPromise}async _schedule(L,T){return null!=this._frameTask?this._frameTask.schedule(L,T):L(m.noBudget)}async _reschedule(L,T){return null!=this._frameTask?this._frameTask.reschedule(L,T):L(m.noBudget)}async _getAllFeaturesQueryEngineResult(L){return new H.QueryEngineResult(await this._getAllFeatures(),
L,this)}async _getAllFeatures(){if(null==this._allFeaturesPromise){const Y=[];this._allFeaturesPromise=(async()=>{await this.featureStore.forEach(fa=>Y.push(fa))})().then(()=>Y)}const L=this._allFeaturesPromise,T=await L;return L===this._allFeaturesPromise?T.slice():this._getAllFeatures()}async _executeQuery(L,T,Y){L=I.clone(L);L=await this._schedule(()=>S.normalizeQuery(L,this.definitionExpression,this.spatialReference),Y);L=await this._reschedule(()=>J.validateQuery(L,{availableFields:this.availableFields,
fieldsIndex:this.fieldsIndex,geometryType:this.geometryType,spatialReference:this.spatialReference}),Y);L={...L,...T};const fa=await this._reschedule(()=>this._executeSceneFilterQuery(L,Y),Y),oa=await this._reschedule(()=>this._executeGeometryQuery(L,fa,Y),Y);await this._reschedule(()=>this._executeAggregateIdsQuery(oa),Y);await this._reschedule(()=>this._executeObjectIdsQuery(oa),Y);await this._reschedule(()=>this._executeTimeQuery(oa),Y);await this._reschedule(()=>this._executeAttributesQuery(oa),
Y);return oa}async _executeSceneFilterQuery(L,T){if(null==L.sceneFilter)return null;const {outSR:Y,returnGeometry:fa,returnCentroid:oa}=L;var sa=this.featureStore.featureSpatialReference,ca=L.sceneFilter.geometry;const ka=null==sa||a.equals(sa,ca.spatialReference)?ca:Q.project(ca,sa);if(!ka)return null;sa=fa||oa;sa=a.isValid(Y)&&!a.equals(this.spatialReference,Y)&&sa?async xa=>this._project(xa,Y):xa=>xa;const ia=this.featureAdapter;ca=await this._reschedule(()=>this._searchFeatures(this._getQueryBBoxes(ka)),
T);if("disjoint"===L.sceneFilter.spatialRelationship){if(!ca.length)return null;const xa=new Set;for(var ra of ca)xa.add(ia.getObjectId(ra));const Ba=await this._reschedule(()=>this._getAllFeatures(),T);ra=await this._reschedule(async()=>{const Ka=await R.getSpatialQueryOperator("esriSpatialRelDisjoint",ka,this.geometryType,this.hasZ,this.hasM),Fa=await this._runSpatialFilter(Ba,La=>!xa.has(ia.getObjectId(La))||Ka(ia.getGeometry(La)),T);return new H.QueryEngineResult(Fa,L,this)},T);return sa(ra)}if(!ca.length)return new H.QueryEngineResult([],
L,this);if(this._canExecuteSinglePass(ka,L))return sa(new H.QueryEngineResult(ca,L,this));const pa=await R.getSpatialQueryOperator("esriSpatialRelContains",ka,this.geometryType,this.hasZ,this.hasM);ra=await this._runSpatialFilter(ca,xa=>pa(ia.getGeometry(xa)),T);return sa(new H.QueryEngineResult(ra,L,this))}async _executeGeometryQuery(L,T,Y){if(null!=T&&0===T.items.length)return T;L=null!=T?T.query:L;const {geometry:fa,outSR:oa,spatialRel:sa,returnGeometry:ca,returnCentroid:ka}=L;var ia=this.featureStore.featureSpatialReference;
const ra=!fa||null==ia||a.equals(ia,fa.spatialReference)?fa:Q.project(fa,ia),pa=ca||ka,xa=a.isValid(oa)&&!a.equals(this.spatialReference,oa),Ba=this._geometryQueryCache&&null==T?xa&&pa?JSON.stringify({originalFilterGeometry:fa,spatialRelationship:sa,outSpatialReference:oa}):JSON.stringify({originalFilterGeometry:fa,spatialRelationship:sa}):null;ia=Ba?this._geometryQueryCache.get(Ba):null;if(null!=ia)return new H.QueryEngineResult(ia,L,this);ia=async h=>{xa&&pa&&await this._project(h,oa);Ba&&this._geometryQueryCache.put(Ba,
h.items,h.items.length+1);return h};if(!ra)return ia(null!=T?T:await this._getAllFeaturesQueryEngineResult(L));const Ka=this.featureAdapter;let Fa=await this._reschedule(()=>this._searchFeatures(this._getQueryBBoxes(fa)),Y);if("esriSpatialRelDisjoint"===sa){if(!Fa.length)return ia(null!=T?T:await this._getAllFeaturesQueryEngineResult(L));const h=new Set;for(var La of Fa)h.add(Ka.getObjectId(La));const E=null!=T?T.items:await this._reschedule(()=>this._getAllFeatures(),Y);La=await this._reschedule(async()=>
{const X=await R.getSpatialQueryOperator(sa,ra,this.geometryType,this.hasZ,this.hasM),aa=await this._runSpatialFilter(E,ja=>!h.has(Ka.getObjectId(ja))||X(Ka.getGeometry(ja)),Y);return new H.QueryEngineResult(aa,L,this)},Y);return ia(La)}if(null!=T){const h=new d.PositionHint;Fa=Fa.filter(E=>0<=d.indexOf(T.items,E,T.items.length,h))}if(!Fa.length)return ia=new H.QueryEngineResult([],L,this),Ba&&this._geometryQueryCache.put(Ba,ia.items,1),ia;if(this._canExecuteSinglePass(ra,L))return ia(new H.QueryEngineResult(Fa,
L,this));const Ta=await R.getSpatialQueryOperator(sa,ra,this.geometryType,this.hasZ,this.hasM);La=await this._runSpatialFilter(Fa,h=>Ta(Ka.getGeometry(h)),Y);return ia(new H.QueryEngineResult(La,L,this))}async _executeGeometryQueryForSnapping(L,T){const {query:Y}=L,{spatialRel:fa}=Y;if(L?.items?.length&&Y.geometry&&fa){var oa=await R.getSpatialQueryOperator(fa,Y.geometry,this.geometryType,this.hasZ,this.hasM);T=await this._runSpatialFilter(L.items,sa=>oa(sa.geometry),T);L.items=T}}_executeAggregateIdsQuery(L){if(0!==
L.items.length&&L.query.aggregateIds?.length&&null!=this.aggregateAdapter){var T=new Set;for(const fa of L.query.aggregateIds)this.aggregateAdapter.getFeatureObjectIds(fa).forEach(oa=>T.add(oa));var Y=this.featureAdapter.getObjectId;L.items=L.items.filter(fa=>T.has(Y(fa)))}}_executeObjectIdsQuery(L){if(0!==L.items.length&&L.query.objectIds?.length){var T=new Set(L.query.objectIds),Y=this.featureAdapter.getObjectId;L.items=L.items.filter(fa=>T.has(Y(fa)))}}_executeTimeQuery(L){if(0!==L.items.length){var T=
P.getTimeOperator(this.timeInfo,L.query.timeExtent,this.featureAdapter);null!=T&&(L.items=L.items.filter(T))}}_executeAttributesQuery(L){if(0!==L.items.length){var T=y.getWhereClause(L.query.where,this.fieldsIndex);if(T){if(!T.isStandardized)throw new TypeError("Where clause is not standardized");L.items=L.items.filter(Y=>T.testFeature(Y,this.featureAdapter))}}}async _runSpatialFilter(L,T,Y){if(!T)return L;if(null==this._frameTask)return L.filter(ca=>T(ca));let fa=0;const oa=[],sa=async ca=>{for(;fa<
L.length;){const ka=L[fa++];T(ka)&&(oa.push(ka),ca.madeProgress());ca.done&&await this._reschedule(ia=>sa(ia),Y)}};return this._reschedule(ca=>sa(ca),Y).then(()=>oa)}_filterLatest(L){const {trackIdField:T,startTimeField:Y,endTimeField:fa}=this.timeInfo,oa=fa||Y,sa=new Map,ca=this.featureAdapter.getAttribute;for(const ka of L.items){const ia=ca(ka,T),ra=ca(ka,oa),pa=sa.get(ia);(!pa||ra>ca(pa,oa))&&sa.set(ia,ka)}L.items=Array.from(sa.values())}_canExecuteSinglePass(L,T){({spatialRel:T}=T);return R.canQueryWithRBush(L)&&
("esriSpatialRelEnvelopeIntersects"===T||"esriGeometryPoint"===this.geometryType&&("esriSpatialRelIntersects"===T||"esriSpatialRelContains"===T))}async _project(L,T){if(!T||a.equals(this.spatialReference,T))return L;const Y=this.featureAdapter;let fa=void 0;try{const oa=await this._getFullExtent();fa=t.getTransformation(this.spatialReference,T,oa)}catch{}T=await Q.projectMany(L.items.map(oa=>F.getGeometry(this.geometryType,this.hasZ,this.hasM,Y.getGeometry(oa))),this.spatialReference,T,fa);L.items=
T.map((oa,sa)=>Y.cloneWithGeometry(L.items[sa],q.convertFromGeometry(oa,this.hasZ,this.hasM)));return L}_getQueryBBoxes(L){if(R.canQueryWithRBush(L)){if(r.isExtent(L))return[C.fromValues(Math.min(L.xmin,L.xmax),Math.min(L.ymin,L.ymax),Math.max(L.xmin,L.xmax),Math.max(L.ymin,L.ymax))];if(r.isPolygon(L))return L.rings.map(T=>C.fromValues(Math.min(T[0][0],T[2][0]),Math.min(T[0][1],T[2][1]),Math.max(T[0][0],T[2][0]),Math.max(T[0][1],T[2][1])))}return[B.getBoundsXY(C.create(),L)]}async _searchFeatures(L){const T=
new Set;await Promise.all(L.map(Y=>this.featureStore.forEachInBounds(Y,fa=>T.add(fa))));L=Array.from(T.values());T.clear();return L}async _executeQueryForStatistics(L,T,Y){L=I.clone(L);try{L=await this._schedule(()=>S.normalizeQuery(L,this.definitionExpression,this.spatialReference),Y);L=await this._reschedule(()=>J.validateStatisticsQuery(L,T,{availableFields:this.availableFields,fieldsIndex:this.fieldsIndex,geometryType:this.geometryType,spatialReference:this.spatialReference}),Y);const fa=await this._reschedule(()=>
this._executeSceneFilterQuery(L,Y),Y),oa=await this._reschedule(()=>this._executeGeometryQuery(L,fa,Y),Y);await this._reschedule(()=>this._executeAggregateIdsQuery(oa),Y);await this._reschedule(()=>this._executeObjectIdsQuery(oa),Y);await this._reschedule(()=>this._executeTimeQuery(oa),Y);await this._reschedule(()=>this._executeAttributesQuery(oa),Y);return oa}catch(fa){if(fa!==S.queryEngineEmptyResult)throw fa;return new H.QueryEngineResult([],L,this)}}}b.Feature=O;b.QueryEngine=M;Object.defineProperty(b,
Symbol.toStringTag,{value:"Module"})})},"esri/core/MemCache":function(){define(["exports","./PooledArray"],function(b,d){b.RemoveMode=void 0;(function(p){p[p.ALL=0]="ALL";p[p.SOME=1]="SOME"})(b.RemoveMode||(b.RemoveMode={}));class A{constructor(p,f,v){this.name=p;this._storage=f;this.id=`${I++}:`;this.maxSize=this.size=0;this._removeFunc=!1;this._miss=this._hit=0;this._storage.register(this);v&&(this._storage.registerRemoveFunc(this.id,v),this._removeFunc=!0)}destroy(){this._storage.clear(this);this._removeFunc&&
this._storage.deregisterRemoveFunc(this.id);this._storage.deregister(this);this._storage=null}get hitRate(){return this._hit/(this._hit+this._miss)}get sizeAll(){return this._storage.size}resetHitRate(){this._hit=this._miss=0}put(p,f,v,g=0){this._storage.put(this,p,f,v,g)}get(p){p=this._storage.get(this,p);void 0===p?++this._miss:++this._hit;return p}peek(p){return this._storage.peek(this,p)}pop(p){p=this._storage.pop(this,p);void 0===p?++this._miss:++this._hit;return p}updateSize(p,f,v){this._storage.updateSize(this,
p,f,v)}clear(){this._storage.clear(this)}clearAll(){this._storage.clearAll()}get performanceInfo(){return this._storage.performanceInfo}resetStats(){this._storage.resetStats()}}class u{get size(){return this._size}constructor(p=10485760){this._maxSize=p;this._db=new Map;this._miss=this._hit=this._size=0;this._removeFuncs=new d;this._users=new d}destroy(){this.clearAll();this._removeFuncs.clear();this._users.clear();this._db=null}register(p){this._users.push(p)}deregister(p){this._users.removeUnordered(p)}registerRemoveFunc(p,
f){this._removeFuncs.push([p,f])}deregisterRemoveFunc(p){this._removeFuncs.filterInPlace(f=>f[0]!==p)}get maxSize(){return this._maxSize}set maxSize(p){this._maxSize=Math.max(p,0);this._checkSizeLimits()}put(p,f,v,g,t){f=p.id+f;const w=this._db.get(f);w&&(this._size-=w.size,p.size-=w.size,this._db.delete(f),w.entry!==v&&this._notifyRemove(f,w.entry,b.RemoveMode.ALL));g>this._maxSize?this._notifyRemove(f,v,b.RemoveMode.ALL):void 0===v?console.warn("Refusing to cache undefined entry "):!g||0>g?(console.warn(`Refusing to cache entry with size ${g} for key ${f}`),
this._notifyRemove(f,v,b.RemoveMode.ALL)):(t=1+Math.max(t,-3)- -3,this._db.set(f,{entry:v,size:g,lifetime:t,lives:t}),this._size+=g,p.size+=g,this._checkSizeLimits())}updateSize(p,f,v,g){f=p.id+f;const t=this._db.get(f);if(t&&t.entry===v){this._size-=t.size;for(p.size-=t.size;g>this._maxSize;)if(g=this._notifyRemove(f,v,b.RemoveMode.SOME),!(null!=g&&0<g)){this._db.delete(f);return}t.size=g;this._size+=g;p.size+=g;this._checkSizeLimits()}}pop(p,f){f=p.id+f;const v=this._db.get(f);if(v)return this._size-=
v.size,p.size-=v.size,this._db.delete(f),++this._hit,v.entry;++this._miss}get(p,f){f=p.id+f;p=this._db.get(f);if(void 0===p)++this._miss;else return this._db.delete(f),p.lives=p.lifetime,this._db.set(f,p),++this._hit,p.entry}peek(p,f){(p=this._db.get(p.id+f))?++this._hit:++this._miss;return p?.entry}get performanceInfo(){const p={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},f={},v=
[];this._db.forEach((w,C)=>{const B=w.lifetime;v[B]=(v[B]||0)+w.size;this._users.forAll(r=>{const {id:l,name:a}=r;C.startsWith(l)&&(f[a]=(f[a]||0)+w.size)})});const g={};this._users.forAll(w=>{const C=w.name;"hitRate"in w&&"number"===typeof w.hitRate&&!isNaN(w.hitRate)&&0<w.hitRate?(f[C]=f[C]||0,g[C]=Math.round(100*w.hitRate)+"%"):g[C]="0%"});var t=Object.keys(f);t.sort((w,C)=>f[C]-f[w]);t.forEach(w=>p[w]=Math.round(f[w]/2**20)+"MB / "+g[w]);for(t=v.length-1;0<=t;--t){const w=v[t];w&&(p["Priority "+
(t+-3-1)]=Math.round(w/this._size*100)+"%")}return p}resetStats(){this._hit=this._miss=0;this._users.forAll(p=>p.resetHitRate())}clear(p){const f=p.id;this._db.forEach((v,g)=>{g.startsWith(f)&&(this._size-=v.size,this._db.delete(g),this._notifyRemove(g,v.entry,b.RemoveMode.ALL))});p.size=0}clearAll(){this._db.forEach((p,f)=>this._notifyRemove(f,p.entry,b.RemoveMode.ALL));this._users.forEach(p=>p.size=0);this._size=0;this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(p,
f,v){let g;this._removeFuncs.some(t=>p.startsWith(t[0])?(t=t[1](f,v),"number"===typeof t&&(g=t),!0):!1);return g}_checkSizeLimits(){if(this._size>this._maxSize)for(const [p,f]of this._db)if(this._purgeItem(p,f),this._size<=.9*this.maxSize)return;this._users.forEach(p=>{if(0<p.maxSize&&p.size>p.maxSize)for(const [f,v]of this._db)if(f.startsWith(p.id)&&(this._purgeItem(f,v,p),p.size<=.9*p.maxSize))break})}_purgeItem(p,f,v=this._users.find(g=>p.startsWith(g.id))){this._db.delete(p);if(1>=f.lives){this._size-=
f.size;v&&(v.size-=f.size);const g=this._notifyRemove(p,f.entry,b.RemoveMode.SOME);null!=g&&0<g&&(this._size+=g,v&&(v.size+=g),f.lives=f.lifetime,f.size=g,this._db.set(p,f))}else--f.lives,this._db.set(p,f)}}let I=0;b.MemCache=A;b.MemCacheStorage=u;b.minPriority=-3;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/normalizeUtils":function(){define("exports ../../config ../../core/Error ../../core/Logger ../Polygon ../Polyline ./normalizeUtilsCommon ./spatialReferenceUtils ./webMercatorUtils ../../rest/geometryService/cut ../../rest/geometryService/simplify".split(" "),
function(b,d,A,u,I,p,f,v,g,t,w){function C(F){const Q=[];let e=0,H=0;for(let S=0;S<F.length;S++){const J=F[S];let R=null;for(let P=0;P<J.length;P++)R=J[P],Q.push(R),0===P?H=e=R[0]:(e=Math.min(e,R[0]),H=Math.max(H,R[0]));R&&Q.push([(e+H)/2,0])}return Q}function B(F,Q){if(!(F instanceof p||F instanceof I))throw y.error("straightLineDensify: the input geometry is neither polyline nor polygon"),new A("straightLineDensify: the input geometry is neither polyline nor polygon");var e=f.getGeometryParts(F);
const H=[];for(const J of e){e=[];H.push(e);e.push([J[0][0],J[0][1]]);for(let R=0;R<J.length-1;R++){const P=J[R][0],V=J[R][1],m=J[R+1][0],O=J[R+1][1];var S=Math.sqrt((m-P)*(m-P)+(O-V)*(O-V));const n=(O-V)/S,x=(m-P)/S,M=S/Q;if(1<M){for(let L=1;L<=M-1;L++){const T=L*Q;e.push([x*T+P,n*T+V])}S=(S+Math.floor(M-1)*Q)/2;e.push([x*S+P,n*S+V])}e.push([m,O])}}return"polygon"===F.type?new I({rings:H,spatialReference:F.spatialReference}):new p({paths:H,spatialReference:F.spatialReference})}function r(F,Q,e){Q&&
(F=B(F,1E6),F=g.webMercatorToGeographic(F,!0));e&&(F=f.updatePolyGeometry(F,e));return F}function l(F,Q,e){if(Array.isArray(F)){var H=F[0];H>Q?(e=f.offsetMagnitude(H,Q),F[0]=H+-2*e*Q):H<e&&(Q=f.offsetMagnitude(H,e),F[0]=H+-2*Q*e)}else H=F.x,H>Q?(e=f.offsetMagnitude(H,Q),F=F.clone().offset(-2*e*Q,0)):H<e&&(Q=f.offsetMagnitude(H,e),F=F.clone().offset(-2*Q*e,0));return F}function a(F,Q){let e=-1;for(let H=0;H<Q.cutIndexes.length;H++){const S=Q.cutIndexes[H],J=Q.geometries[H],R=f.getGeometryParts(J);
for(let P=0;P<R.length;P++){const V=R[P];V.some(m=>{if(180>m[0])return!0;m=0;for(var O=0;O<V.length;O++){var n=V[O][0];m=n>m?n:m}m=Number(m.toFixed(9));m=-360*f.offsetMagnitude(m,180);for(O=0;O<V.length;O++)n=J.getPoint(P,O),J.setPoint(P,O,n.clone().offset(m,0));return!0})}if(S===e)if("polygon"===F[0].type)for(const P of f.getGeometryParts(J))F[S]=F[S].addRing(P);else{if("polyline"===F[0].type)for(const P of f.getGeometryParts(J))F[S]=F[S].addPath(P)}else e=S,F[S]=J}return F}async function q(F,Q,
e){if(!Array.isArray(F))return q([F],Q);Q&&"string"!==typeof Q&&y.warn("normalizeCentralMeridian()","The url object is deprecated, use the url string instead");var H="string"===typeof Q?Q:Q?.url??d.geometryServiceUrl;let S,J,R;let P=0;var V=[];Q=[];for(var m of F)if(null==m)Q.push(m);else{if(!O){var O=m.spatialReference;var n=v.getInfo(O);var x=(S=O.isWebMercator)?102100:4326;J=f.cutParams[x].maxX;R=f.cutParams[x].minX;var M=f.cutParams[x].plus180Line;x=f.cutParams[x].minus180Line}if(n)if("mesh"===
m.type)Q.push(m);else if("point"===m.type)Q.push(l(m.clone(),J,R));else if("multipoint"===m.type){var L=m.clone();L.points=L.points.map(T=>l(T,J,R));Q.push(L)}else if("extent"===m.type)L=m.clone()._normalize(!1,!1,n),Q.push(L.rings?new I(L):L);else if(m.extent){L=m.extent;const T=2*f.offsetMagnitude(L.xmin,R)*J;let Y=0===T?m.clone():f.updatePolyGeometry(m.clone(),T);L.offset(T,0);L.intersects(M)&&L.xmax!==J?(P=L.xmax>P?L.xmax:P,Y=r(Y,S),V.push(Y),Q.push("cut")):L.intersects(x)&&L.xmin!==R?(P=2*L.xmax*
J>P?2*L.xmax*J:P,Y=r(Y,S,360),V.push(Y),Q.push("cut")):Q.push(Y)}else Q.push(m.clone());else Q.push(m)}O=f.offsetMagnitude(P,J);n=-90;M=O;for(m=new p;0<O;)x=-180+360*O,m.addPath([[x,n],[x,-1*n]]),n*=-1,O--;if(0<V.length&&0<M){O=await t.cut(H,V,m,e);O=a(V,O);n=[];V=[];for(M=0;M<Q.length;M++)m=Q[M],"cut"!==m?V.push(m):(m=O.shift(),x=F[M],null!=x&&"polygon"===x.type&&x.rings&&1<x.rings.length&&m.rings.length>=x.rings.length?(n.push(m),V.push("simplify")):V.push(S?g.geographicToWebMercator(m):m));if(!n.length)return V;
Q=await w.simplify(H,n,e);F=[];for(e=0;e<V.length;e++)H=V[e],"simplify"!==H?F.push(H):F.push(S?g.geographicToWebMercator(Q.shift()):Q.shift());return F}F=[];for(e=0;e<Q.length;e++)H=Q[e],"cut"!==H?F.push(H):(H=V.shift(),F.push(!0===S?g.geographicToWebMercator(H):H));return F}const y=u.getLogger("esri.geometry.support.normalizeUtils");b.getClosestDenormalizedXToReference=function(F,Q,e){e=v.getInfo(e);if(null==e)return F;const [H,S]=e.valid;e=2*S;let J=0,R=0;Q>S?J=Math.ceil(Math.abs(Q-S)/e):Q<H&&(J=
-Math.ceil(Math.abs(Q-H)/e));F>S?R=Math.ceil(Math.abs(F-S)/e):F<H&&(R=-Math.ceil(Math.abs(F-H)/e));F+=(J-R)*e;Q=F-Q;Q>S?F-=e:Q<H&&(F+=e);return F};b.getDenormalizedExtent=function(F){if(!F)return null;const Q=F.extent;if(!Q)return null;var e=F.spatialReference&&v.getInfo(F.spatialReference);if(!e)return Q;const [H,S]=e.valid;({width:e}=Q);let {xmin:J,xmax:R}=Q;[J,R]=[R,J];if("extent"===F.type||0===e||e<=S||e>2*S||J<H||R>S)return Q;let P;switch(F.type){case "polygon":if(1<F.rings.length)P=C(F.rings);
else return Q;break;case "polyline":if(1<F.paths.length)P=C(F.paths);else return Q;break;case "multipoint":P=F.points}F=Q.clone();for(let V=0;V<P.length;V++){let m=P[V][0];0>m?(m+=S,R=Math.max(m,R)):(m-=S,J=Math.min(m,J))}F.xmin=J;F.xmax=R;return F.width<e?(F.xmin-=S,F.xmax-=S,F):Q};b.normalizeCentralMeridian=q;b.normalizeMapX=function(F,Q){if(Q=v.getInfo(Q)){const [e,H]=Q.valid;Q=H-e;if(F<e)for(;F<e;)F+=Q;if(F>H)for(;F>H;)F-=Q}return F};b.straightLineDensify=B;Object.defineProperty(b,Symbol.toStringTag,
{value:"Module"})})},"esri/geometry/support/normalizeUtilsCommon":function(){define(["exports","../Polyline","../SpatialReference","./jsonUtils"],function(b,d,A,u){function I(p){return u.isPolygon(p)?p.rings:p.paths}d={102100:{maxX:2.0037508342788905E7,minX:-2.0037508342788905E7,plus180Line:new d({paths:[[[2.0037508342788905E7,-2.0037508342788905E7],[2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:A.WebMercator}),minus180Line:new d({paths:[[[-2.0037508342788905E7,-2.0037508342788905E7],
[-2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:A.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new d({paths:[[[180,-180],[180,180]]],spatialReference:A.WGS84}),minus180Line:new d({paths:[[[-180,-180],[-180,180]]],spatialReference:A.WGS84})}};b.cutParams=d;b.getGeometryParts=I;b.offsetMagnitude=function(p,f){return Math.ceil((p-f)/(2*f))};b.updatePolyGeometry=function(p,f){const v=I(p);for(const g of v)for(const t of g)t[0]+=f;return p};Object.defineProperty(b,Symbol.toStringTag,
{value:"Module"})})},"esri/rest/geometryService/cut":function(){define("exports ../../geometry ../../request ../../geometry/support/jsonUtils ../../geometry/support/spatialReferenceUtils ../utils".split(" "),function(b,d,A,u,I,p){b.cut=async function(f,v,g,t){f=p.parseUrl(f);const w=v[0].spatialReference;v={...t,responseType:"json",query:{...f.query,f:"json",sr:I.srToRESTValue(w),target:JSON.stringify({geometryType:u.getJsonType(v[0]),geometries:v}),cutter:JSON.stringify(g)}};v=await A(f.path+"/cut",
v);const {cutIndexes:C,geometries:B=[]}=v.data;return{cutIndexes:C,geometries:B.map(r=>{r=u.fromJSON(r);r.spatialReference=w;return r})}};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/rest/utils":function(){define("exports ../config ../kernel ../core/lang ../core/urlUtils ../support/apiKeyUtils".split(" "),function(b,d,A,u,I,p){function f(v,g,t){const w={};for(const B in v)if("declaredClass"!==B){var C=v[B];if(null!=C&&"function"!==typeof C)if(Array.isArray(C)){w[B]=[];for(let r=
0;r<C.length;r++)w[B][r]=f(C[r])}else"object"===typeof C?C.toJSON?(C=C.toJSON(t?.[B]),w[B]=g?C:JSON.stringify(C)):w[B]=g?C:JSON.stringify(C):w[B]=C}return w}b.asValidOptions=function(v,g){return g?{...g,query:{...(v??{}),...g.query}}:{query:v}};b.encode=f;b.getToken=function(v,g){return v?p.supportsApiKey(v)&&(g||d.apiKey)?g||d.apiKey:A.id?.findCredential(v)?.token:null};b.parseUrl=function(v){return"string"===typeof v?I.urlToObject(v):u.clone(v)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},
"esri/rest/geometryService/simplify":function(){define("exports ../../request ../../core/urlUtils ../../geometry/support/jsonUtils ../../geometry/support/spatialReferenceUtils ./utils".split(" "),function(b,d,A,u,I,p){b.simplify=async function(f,v,g){const t="string"===typeof f?A.urlToObject(f):f;f=v[0].spatialReference;const w=u.getJsonType(v[0]);v={...g,query:{...t.query,f:"json",sr:I.srToRESTValue(f),geometries:JSON.stringify(p.encodeGeometries(v))}};({data:v}=await d(t.path+"/simplify",v));return p.decodeGeometries(v.geometries,
w,f)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/rest/geometryService/utils":function(){define(["exports","../../geometry/support/jsonUtils"],function(b,d){b.decodeGeometries=function(A,u,I){const p=d.getGeometryType(u);return A.map(f=>{f=p.fromJSON(f);f.spatialReference=I;return f})};b.encodeGeometries=function(A){return{geometryType:d.getJsonType(A[0]),geometries:A.map(u=>u.toJSON())}};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/attributeSupport":function(){define(["exports",
"../../../core/Error","../../../core/sql/WhereClauseCache","../../support/fieldType"],function(b,d,A,u){function I(B,r,l={}){const a=p(r,B);if(!a)throw l=t.getError(r,B),new d("unsupported-query","invalid SQL expression",{expression:r,error:l});B=l.expressionName||"expression";if(l.validateStandardized&&!a.isStandardized)throw new d("unsupported-query",`${B} is not standard`,{expression:r});if(l.validateAggregate&&!a.isAggregate)throw new d("unsupported-query",`${B} does not contain a valid aggregate function`,
{expression:r});return a.fieldNames}function p(B,r){return B?t.get(B,r):null}function f(B){return/\((.*?)\)/.test(B)?B:B.split(" as ")[0]}function v(B,r,l,a={}){const q=new Map;var y=a.allowedFieldTypes??C;for(const F of l)if("*"!==F)if(B.get(F))g(q,B,r,y,F);else try{const Q=f(F),e=I(B,Q,{validateStandardized:!0});for(const H of e)g(q,B,r,y,H)}catch(Q){q.set(F,{type:"expression-error",expression:F,error:Q})}if(q.size)throw new d("unsupported-query",`${a.expressionName??"expression"} contains invalid or missing fields`,
{errors:Array.from(q.values()),query:a.query});}function g(B,r,l,a,q){"*"!==q&&((r=r.get(q))?l.has(r.name)?!1===a?.has(r.type)&&B.set(q,{type:"invalid-type",fieldName:r.name,fieldType:u.kebabDict.fromJSON(r.type),allowedFieldTypes:Array.from(a,y=>u.kebabDict.fromJSON(y))}):B.set(q,{type:"missing-field",fieldName:r.name}):B.set(q,{type:"invalid-field",fieldName:q}))}const t=new A.WhereClauseCache(50,500);A=new Set("esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeBigInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong".split(" "));
const w=new Set(["esriFieldTypeDate","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]),C=new Set(["esriFieldTypeString","esriFieldTypeGUID","esriFieldTypeGlobalID",...A,...w]);b.allDateAndTimeFieldTypes=w;b.getAliasFromFieldName=function(B){return B.split(" as ")[1]};b.getExpressionFromFieldName=f;b.getWhereClause=p;b.numericFieldTypes=A;b.validateFields=v;b.validateHaving=function(B,r,l,a,q){if(!l)return!0;const y=I(B,l,{validateAggregate:!0,expressionName:"having clause"});
v(B,r,y,{expressionName:"having clause",query:q});if(!p(l,B)?.getExpressions().every(F=>{const {aggregateType:Q,field:e}=F,H=B.get(e)?.name;return a.some(S=>{const {onStatisticField:J,statisticType:R}=S;return B.get(J)?.name===H&&R.toLowerCase().trim()===Q})}))throw new d("unsupported-query","expressions in having clause should also exist in outStatistics",{having:l});return!0};b.validateWhere=function(B,r,l,a){if(!l)return!0;l=I(B,l,{validateStandardized:!0,expressionName:"where clause"});v(B,r,
l,{expressionName:"where clause",query:a});return!0};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/WhereClauseCache":function(){define(["exports","../LRUCache","./WhereClause"],function(b,d,A){class u{constructor(I,p){this._cache=new d.LRUCache(I);this._invalidCache=new d.LRUCache(p)}get(I,p){const f=`${p.uid}:${I}`,v=this._cache.get(f);if(v)return v;if(null!=this._invalidCache.get(f))return null;try{const g=A.WhereClause.create(I,p);this._cache.put(f,g);return g}catch(g){return this._invalidCache.put(f,
g),null}}getError(I,p){return this._invalidCache.get(`${p.uid}:${I}`)??null}}b.WhereClauseCache=u;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/LRUCache":function(){define(["exports","./MemCache"],function(b,d){class A{constructor(u,I){this._storage=new d.MemCacheStorage;this.name=this.id="";this.size=0;this._storage.maxSize=u;this._storage.register(this);I&&this._storage.registerRemoveFunc("",I)}destroy(){this._storage.deregister(this);this._storage.destroy()}put(u,I,
p=1){this._storage.put(this,u,I,p,1)}pop(u){return this._storage.pop(this,u)}get(u){return this._storage.get(this,u)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(u){this._storage.maxSize=u}resetHitRate(){}}b.LRUCache=A;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/WhereClause":function(){define("exports ../../arcade/ArcadeDate ../../arcade/featureset/support/errorsupport ../has ./AggregateFunctions ./DateOnly ./sqlArithmeticUtils ./sqlCompareUtils ./sqlDateParsingUtils ./SqlInterval ./SqlTimestampOffset ./StandardizedFunctions ./TimeOnly ./WhereGrammar ../../chunks/datetime".split(" "),
function(b,d,A,u,I,p,f,v,g,t,w,C,B,r,l){function a(m){return Array.isArray(m)?m:[m]}function q(m){return null!==m?!0!==m:null}function y(m,O){return null!=m&&null!=O?!0===m&&!0===O:!1===m||!1===O?!1:null}function F(m,O){return null!=m&&null!=O?!0===m||!0===O:!0===m||!0===O?!0:null}function Q(m,O){if(null==m)return null;let n=!1;for(const x of O)if(null==x)n=null;else if(m===x){n=!0;break}return n}function e(m,O,n){if(null==m)return null;let x="",M=P.Normal;for(let L=0;L<O.length;L++){const T=O.charAt(L);
switch(M){case P.Normal:T===n?M=P.Escaped:x="-[]/{}()*+?.\\^$|".includes(T)?x+("\\"+T):"%"===T?x+".*":"_"===T?x+".":x+T;break;case P.Escaped:x="-[]/{}()*+?.\\^$|".includes(T)?x+("\\"+T):x+T,M=P.Normal}}return(new RegExp("^"+x+"$","m")).test(m)}function H(m,O,n,x){m=x.getAttribute(m,O);O=n?.get(O);return null==m||"esriFieldTypeDate"!==O?.type&&"date"!==O?.type?null==m||"esriFieldTypeDateOnly"!==O?.type&&"date-only"!==O?.type?null==m||"esriFieldTypeTimeOnly"!==O?.type&&"time-only"!==O?.type?null==m||
"esriFieldTypeTimestampOffset"!==O?.type&&"timestamp-offset"!==O?.type?m:new w.SqlTimeStampOffset(m):B.TimeOnly.fromReader(m):p.DateOnly.fromReader(m):g.convertToExecutingTimeZone(new Date(m),n?.getLuxonTimeZone(O.name)??l.FixedOffsetZone.utcInstance)}const S=new Set(["current_timestamp","current_date","current_time"]);class J{static makeBool(m){return!0===m}static featureValue(m,O,n,x){return H(m,O,n,x)}static equalsNull(m){return null===m}static applyLike(m,O,n){return e(m,O,n)}static ensureArray(m){return a(m)}static applyIn(m,
O){return Q(m,O)}static currentDate(m){return p.DateOnly.fromNow(m)}static makeSqlInterval(m,O,n){return t.SqlInterval.createFromValueAndQualifer(m,O,n)}static convertInterval(m){return m instanceof t.SqlInterval?m.valueInMilliseconds():m}static currentTimestamp(m){return g.convertToExecutingTimeZone(new Date,m)}static compare(m,O,n,x){return v.sqlCompare(O,n,m)}static calculate(m,O,n,x){return f.sqlCalculateFunction(m,O,n,x)}static evaluateTime(m){return g.parseTime(m)}static evaluateTimestamp(m,
O,n){return g.parseTimestamp(m,O,n)}static evaluateDate(m,O){return g.parseDate(m,O)}static evaluateFunction(m,O,n){return C.evaluateFunction(m,O,n)}static lookup(m,O){m=O[m];return void 0===m?null:m}static between(m,O,n){return null==m||null==O[0]||null==O[1]?null:v.sqlCompare(m,O[0],"\x3e\x3d")&&v.sqlCompare(m,O[1],"\x3c\x3d")}static notbetween(m,O,n){return null==m||null==O[0]||null==O[1]?null:v.sqlCompare(m,O[0],"\x3c")||v.sqlCompare(m,O[1],"\x3e")}static ternaryNot(m){return q(m)}static ternaryAnd(m,
O){return y(m,O)}static ternaryOr(m,O){return F(m,O)}}class R{constructor(m,O,n="UTC"){this.fieldsIndex=O;this.timeZone=n;this.parameters={};this._hasDateFunctions=void 0;this.parseTree=r.WhereGrammar.parse(m);const {isStandardized:x,isAggregate:M,referencedFieldNames:L}=this._extractExpressionInfo(O);this._referencedFieldNames=L;this.isStandardized=x;this.isAggregate=M}static convertValueToStorageFormat(m,O=null){if(null===O)return g.isDate(m)?m.getTime():g.isDateTime(m)?m.toMillis():g.isTimestampOffset(m)?
m.toStorageFormat():g.isTimeOnly(m)?m.toStorageString():g.isDateOnly(m)?m.toStorageFormat():m;switch(O){case "date":if(g.isDate(m))return m.getTime();if(g.isDateTime(m))return m.toMillis();if(g.isTimestampOffset(m))return m.toMilliseconds();if(g.isDateOnly(m))return m.toNumber();break;case "date-only":if(g.isDate(m))return p.DateOnly.fromDateJS(m).toString();if(g.isTimestampOffset(m))return p.DateOnly.fromSqlTimeStampOffset(m).toString();if(g.isDateTime(m))return p.DateOnly.fromDateTime(m).toString();
break;case "time-only":if(g.isDate(m))return B.TimeOnly.fromDateJS(m).toStorageString();if(g.isDateTime(m))return B.TimeOnly.fromDateTime(m).toStorageString();if(g.isTimestampOffset(m))return B.TimeOnly.fromSqlTimeStampOffset(m).toStorageString();if(g.isTimeOnly(m))return m.toStorageString();break;case "timestamp-offset":if(g.isDate(m))return w.SqlTimeStampOffset.fromJSDate(m).toStorageFormat();if(g.isDateTime(m))return w.SqlTimeStampOffset.fromDateTime(m).toStorageFormat();if(g.isTimestampOffset(m))return m.toStorageFormat()}return m}static create(m,
O,n="UTC"){return new R(m,O,n)}get fieldNames(){return this._referencedFieldNames}testSet(m,O=V){return!!this._evaluateNode(this.parseTree,null,O,m)}calculateValue(m,O=V){m=this._evaluateNode(this.parseTree,m,O,null);return m instanceof t.SqlInterval?m.valueInMilliseconds()/864E5:m}calculateValueCompiled(m,O=V){if(null!=this.parseTree._compiledVersion)return this.parseTree._compiledVersion(m,this.parameters,O,this.fieldsIndex,this.timeZone);if(u("esri-csp-restrictions"))return this.calculateValue(m,
O);this._compileMe();return this.parseTree._compiledVersion(m,this.parameters,O,this.fieldsIndex,this.timeZone)}testFeature(m,O=V){return!!this._evaluateNode(this.parseTree,m,O,null)}testFeatureCompiled(m,O=V){if(null!=this.parseTree._compiledVersion)return!!this.parseTree._compiledVersion(m,this.parameters,O,this.fieldsIndex,this.timeZone);if(u("esri-csp-restrictions"))return this.testFeature(m,O);this._compileMe();return!!this.parseTree._compiledVersion(m,this.parameters,O,this.fieldsIndex,this.timeZone)}get hasDateFunctions(){if(null!=
this._hasDateFunctions)return this._hasDateFunctions;this._hasDateFunctions=!1;this._visitAll(this.parseTree,m=>{"current-time"===m.type?this._hasDateFunctions=!0:"function"===m.type&&(this._hasDateFunctions=this._hasDateFunctions||S.has(m.name.toLowerCase()))});return this._hasDateFunctions}getFunctions(){const m=new Set;this._visitAll(this.parseTree,O=>{"function"===O.type&&m.add(O.name.toLowerCase())});return Array.from(m)}getExpressions(){const m=new Map;this._visitAll(this.parseTree,O=>{if("function"===
O.type){const n=O.name.toLowerCase();O=O.args.value[0];if("column-reference"===O.type){O=O.column;const x=`${n}-${O}`;m.has(x)||m.set(x,{aggregateType:n,field:O})}}});return[...m.values()]}getVariables(){const m=new Set;this._visitAll(this.parseTree,O=>{"parameter"===O.type&&m.add(O.value.toLowerCase())});return Array.from(m)}_compileMe(){const m="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=(new Function("feature","lookups","attributeAdapter",
"fieldsIndex","timeZone",m)).bind(J)}_extractExpressionInfo(m){const O=[],n=new Set;let x=!0,M=!1;this._visitAll(this.parseTree,L=>{switch(L.type){case "column-reference":var T=m?.get(L.column);let Y;T?T=Y=T.name??"":(Y=L.column,T=Y.toLowerCase());n.has(T)||(n.add(T),O.push(Y));L.column=Y;break;case "function":const {name:fa,args:oa}=L;L=oa.value.length;x&&(x=C.isStandardized(fa,L));!1===M&&(M=I.isAggregate(fa,L))}});return{referencedFieldNames:Array.from(O),isStandardized:x,isAggregate:M}}_visitAll(m,
O){if(null!=m)switch(O(m),m.type){case "when-clause":this._visitAll(m.operand,O);this._visitAll(m.value,O);break;case "case-expression":for(const n of m.clauses)this._visitAll(n,O);"simple"===m.format&&this._visitAll(m.operand,O);null!==m.else&&this._visitAll(m.else,O);break;case "expression-list":for(const n of m.value)this._visitAll(n,O);break;case "unary-expression":this._visitAll(m.expr,O);break;case "binary-expression":this._visitAll(m.left,O);this._visitAll(m.right,O);break;case "function":this._visitAll(m.args,
O)}}evaluateNodeToJavaScript(m){switch(m.type){case "interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(m.value)+", "+JSON.stringify(m.qualifier)+","+JSON.stringify(m.op)+")";case "case-expression":var O="";if("simple"===m.format){var n=this.evaluateNodeToJavaScript(m.operand);O="( ";for(let x=0;x<m.clauses.length;x++)O+=" (this.compare('\x3d',"+n+","+this.evaluateNodeToJavaScript(m.clauses[x].operand)+") ? ("+this.evaluateNodeToJavaScript(m.clauses[x].value)+") : "}else for(O=
"( ",n=0;n<m.clauses.length;n++)O+=" this.makeBool("+this.evaluateNodeToJavaScript(m.clauses[n].operand)+")\x3d\x3d\x3dtrue ? ("+this.evaluateNodeToJavaScript(m.clauses[n].value)+") : ";O=null!==m.else?O+this.evaluateNodeToJavaScript(m.else):O+"null";return O+" )";case "parameter":return"this.lookup("+JSON.stringify(m.value.toLowerCase())+",lookups)";case "expression-list":O="[";for(n of m.value)"["!==O&&(O+=","),O+=this.evaluateNodeToJavaScript(n);return O+"]";case "unary-expression":return"this.ternaryNot("+
this.evaluateNodeToJavaScript(m.expr)+")";case "binary-expression":switch(m.operator){case "AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(m.left)+","+this.evaluateNodeToJavaScript(m.right)+" )";case "OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(m.left)+","+this.evaluateNodeToJavaScript(m.right)+" )";case "IS":if("null"!==m.right.type)throw new A.SqlError(A.SqlErrorCodes.UnsupportedIsRhs);return"this.equalsNull("+this.evaluateNodeToJavaScript(m.left)+")";case "ISNOT":if("null"!==
m.right.type)throw new A.SqlError(A.SqlErrorCodes.UnsupportedIsRhs);return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(m.left)+")))";case "IN":return"this.applyIn("+this.evaluateNodeToJavaScript(m.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(m.right)+"))";case "NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(m.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(m.right)+")))";case "BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(m.left)+
","+this.evaluateNodeToJavaScript(m.right)+", timeZone)";case "NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(m.left)+","+this.evaluateNodeToJavaScript(m.right)+", timeZone)";case "LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(m.left)+","+this.evaluateNodeToJavaScript(m.right)+","+JSON.stringify(m.escape)+")";case "NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(m.left)+","+this.evaluateNodeToJavaScript(m.right)+","+JSON.stringify(m.escape)+
"))";case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return"this.compare("+JSON.stringify(m.operator)+","+this.evaluateNodeToJavaScript(m.left)+","+this.evaluateNodeToJavaScript(m.right)+", timeZone)";case "*":case "-":case "+":case "/":case "||":return"this.calculate("+JSON.stringify(m.operator)+","+this.evaluateNodeToJavaScript(m.left)+","+this.evaluateNodeToJavaScript(m.right)+", timeZone)"}throw new A.SqlError(A.SqlErrorCodes.UnsupportedOperator,{operator:m.operator});
case "null":case "boolean":case "string":case "number":return JSON.stringify(m.value);case "time":return"this.evaluateTime(JSON.stringify(node.value))";case "date":return"this.evaluateDate(JSON.stringify(node.value), 'unknown')";case "timestamp":return"this.evaluateTimestamp(JSON.stringify(node.value), 'unknown')";case "current-time":return"date"===m.mode?"this.currentDate(timeZone)":"this.currentTimestamp(timeZone)";case "column-reference":return"this.featureValue(feature,"+JSON.stringify(m.column)+
",fieldsIndex,attributeAdapter)";case "function":return"this.evaluateFunction("+JSON.stringify(m.name)+","+this.evaluateNodeToJavaScript(m.args)+", timeZone)"}throw new A.SqlError(A.SqlErrorCodes.UnsupportedSyntax,{node:m.type});}_evaluateNode(m,O,n,x){switch(m.type){case "interval":return n=this._evaluateNode(m.value,O,n,x),t.SqlInterval.createFromValueAndQualifer(n,m.qualifier,m.op);case "case-expression":if("simple"===m.format){var M=this._evaluateNode(m.operand,O,n,x);for(var L=0;L<m.clauses.length;L++)if(v.sqlCompare(M,
this._evaluateNode(m.clauses[L].operand,O,n,x),"\x3d",this.timeZone))return this._evaluateNode(m.clauses[L].value,O,n,x)}else for(M=0;M<m.clauses.length;M++)if(!0===this._evaluateNode(m.clauses[M].operand,O,n,x))return this._evaluateNode(m.clauses[M].value,O,n,x);return null!==m.else?this._evaluateNode(m.else,O,n,x):null;case "parameter":return m=this.parameters[m.value.toLowerCase()],g.isDate(m)?l.DateTime.fromJSDate(m):m instanceof d.ArcadeDate?m.toDateTime():m;case "expression-list":M=[];for(var T of m.value)M.push(this._evaluateNode(T,
O,n,x));return M;case "unary-expression":return q(this._evaluateNode(m.expr,O,n,x));case "binary-expression":switch(m.operator){case "AND":return y(this._evaluateNode(m.left,O,n,x),this._evaluateNode(m.right,O,n,x));case "OR":return F(this._evaluateNode(m.left,O,n,x),this._evaluateNode(m.right,O,n,x));case "IS":if("null"!==m.right.type)throw new A.SqlError(A.SqlErrorCodes.UnsupportedIsRhs);return null===this._evaluateNode(m.left,O,n,x);case "ISNOT":if("null"!==m.right.type)throw new A.SqlError(A.SqlErrorCodes.UnsupportedIsRhs);
return null!==this._evaluateNode(m.left,O,n,x);case "IN":return M=a(this._evaluateNode(m.right,O,n,x)),Q(this._evaluateNode(m.left,O,n,x),M);case "NOT IN":return M=a(this._evaluateNode(m.right,O,n,x)),q(Q(this._evaluateNode(m.left,O,n,x),M));case "BETWEEN":return M=this._evaluateNode(m.left,O,n,x),m=this._evaluateNode(m.right,O,n,x),null==M||null==m[0]||null==m[1]?null:v.sqlCompare(M,m[0],"\x3e\x3d",this.timeZone)&&v.sqlCompare(M,m[1],"\x3c\x3d",this.timeZone);case "NOTBETWEEN":return M=this._evaluateNode(m.left,
O,n,x),m=this._evaluateNode(m.right,O,n,x),null==M||null==m[0]||null==m[1]?null:v.sqlCompare(M,m[0],"\x3c",this.timeZone)||v.sqlCompare(M,m[1],"\x3e",this.timeZone);case "LIKE":return e(this._evaluateNode(m.left,O,n,x),this._evaluateNode(m.right,O,n,x),m.escape);case "NOT LIKE":return q(e(this._evaluateNode(m.left,O,n,x),this._evaluateNode(m.right,O,n,x),m.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return v.sqlCompare(this._evaluateNode(m.left,O,n,
x),this._evaluateNode(m.right,O,n,x),m.operator,this.timeZone);case "-":case "+":case "*":case "/":case "||":return f.sqlCalculateFunction(m.operator,this._evaluateNode(m.left,O,n,x),this._evaluateNode(m.right,O,n,x),this.timeZone)}case "null":case "boolean":case "string":case "number":return m.value;case "date":return m.parsedValue??(m.parsedValue=g.parseDate(m.value,"unknown")),m.parsedValue;case "timestamp":return m.parsedValue??(m.parsedValue=g.parseTimestamp(m.value,"unknown")),m.parsedValue;
case "time":return g.parseTime(m.value);case "current-time":return"date"===m.mode?p.DateOnly.fromNow(this.timeZone):g.convertToExecutingTimeZone(new Date,this.timeZone);case "column-reference":return H(O,m.column,this.fieldsIndex,n);case "data-type":return m.value;case "function":if(this.isAggregate&&I.isAggregate(m.name,m.args.value.length)){O=[];for(M of m.args?.value||[]){T=[];for(L of x||[])T.push(this._evaluateNode(M,L,n,null));O.push(T)}return I.aggregateFunction(m.name,O)}n=this._evaluateNode(m.args,
O,n,x);return C.evaluateFunction(m.name,n,this.timeZone)}throw new A.SqlError(A.SqlErrorCodes.UnsupportedSyntax,{node:m.type});}}var P;(function(m){m[m.Normal=0]="Normal";m[m.Escaped=1]="Escaped"})(P||(P={}));const V={getAttribute(m,O){return(m&&"object"===typeof m.attributes?m.attributes:m)[O]}};b.WhereClause=R;b.defaultAttributeAdapter=V;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/ArcadeDate":function(){define(["exports","../core/string","../core/sql/UnknownTimeZone",
"../chunks/datetime"],function(b,d,A,u){function I(t,w,C){return t<w?t-w:t>C?t-C:0}function p(t,w=!0){if(t instanceof u.Zone)return t;if("system"===t.toLowerCase())return"system";if("utc"===t.toLowerCase())return"UTC";if("unknown"===t.toLowerCase())return A.UnknownTimeZone.instance;if(/^[\+\-]?[0-9]{1,2}([:][0-9]{2})?$/.test(t)){const C=u.FixedOffsetZone.parseSpecifier("UTC"+(t.startsWith("+")||t.startsWith("-")?"":"+")+t);if(C)return C}t=u.IANAZone.create(t);if(!t.isValid){if(w)throw new v(b.ArcadeDateErrorCodes.TimeZoneNotRecognized);
return null}return t}b.ArcadeDateErrorCodes=void 0;(b.ArcadeDateErrorCodes||(b.ArcadeDateErrorCodes={})).TimeZoneNotRecognized="TimeZoneNotRecognized";const f={[b.ArcadeDateErrorCodes.TimeZoneNotRecognized]:"Timezone identifier has not been recognized."};class v extends Error{constructor(t,w){super(d.replace(f[t],w));this.declaredRootClass="esri.arcade.arcadedate.dateerror";Error.captureStackTrace&&Error.captureStackTrace(this,v)}}class g{constructor(t){this._date=t;this.declaredRootClass="esri.arcade.arcadedate"}static fromParts(t=
0,w=1,C=1,B=0,r=0,l=0,a=0,q){if(isNaN(t)||isNaN(w)||isNaN(C)||isNaN(B)||isNaN(r)||isNaN(l)||isNaN(a))return null;const y=u.DateTime.local(t,w).daysInMonth;t=u.DateTime.fromObject({day:1>C?1:C>y?y:C,year:t,month:1>w?1:12<w?12:w,hour:0>B?0:23<B?23:B,minute:0>r?0:59<r?59:r,second:0>l?0:59<l?59:l,millisecond:0>a?0:999<a?999:a},{zone:p(q)});t=t.plus({months:I(w,1,12),days:I(C,1,y),hours:I(B,0,23),minutes:I(r,0,59),seconds:I(l,0,59),milliseconds:I(a,0,999)});return new g(t)}static get systemTimeZoneCanonicalName(){return Intl.DateTimeFormat().resolvedOptions().timeZone??
"system"}static arcadeDateAndZoneToArcadeDate(t,w){w=p(w);return t.isUnknownTimeZone||w===A.UnknownTimeZone.instance?g.fromParts(t.year,t.monthJS+1,t.day,t.hour,t.minute,t.second,t.millisecond,w):new g(t._date.setZone(w))}static dateJSToArcadeDate(t){return new g(u.DateTime.fromJSDate(t,{zone:"system"}))}static dateJSAndZoneToArcadeDate(t,w="system"){w=p(w);return new g(u.DateTime.fromJSDate(t,{zone:w}))}static unknownEpochToArcadeDate(t){return new g(u.DateTime.fromMillis(t,{zone:A.UnknownTimeZone.instance}))}static unknownDateJSToArcadeDate(t){return new g(u.DateTime.fromMillis(t.getTime(),
{zone:A.UnknownTimeZone.instance}))}static epochToArcadeDate(t,w="system"){w=p(w);return new g(u.DateTime.fromMillis(t,{zone:w}))}static dateTimeToArcadeDate(t){return new g(t)}clone(){return new g(this._date)}changeTimeZone(t){t=p(t);return g.dateTimeToArcadeDate(this._date.setZone(t))}static dateTimeAndZoneToArcadeDate(t,w){w=p(w);return t.zone===A.UnknownTimeZone.instance||w===A.UnknownTimeZone.instance?g.fromParts(t.year,t.month,t.day,t.hour,t.minute,t.second,t.millisecond,w):new g(t.setZone(w))}static nowToArcadeDate(t){t=
p(t);return new g(u.DateTime.fromJSDate(new Date,{zone:t}))}static nowUTCToArcadeDate(){return new g(u.DateTime.utc())}get isSystem(){return"system"===this.timeZone||this.timeZone===g.systemTimeZoneCanonicalName}equals(t){return this.isSystem&&t.isSystem?this.toNumber()===t.toNumber():this.isUnknownTimeZone!==t.isUnknownTimeZone?!1:this._date.equals(t._date)}get isUnknownTimeZone(){return this._date.zone===A.UnknownTimeZone.instance}get isValid(){return this._date.isValid}get hour(){return this._date.hour}get second(){return this._date.second}get day(){return this._date.day}get dayOfWeekISO(){return this._date.weekday}get dayOfWeekJS(){let t=
this._date.weekday;6<t&&(t=0);return t}get millisecond(){return this._date.millisecond}get monthISO(){return this._date.month}get weekISO(){return this._date.weekNumber}get yearISO(){return this._date.weekYear}get monthJS(){return this._date.month-1}get year(){return this._date.year}get minute(){return this._date.minute}get zone(){return this._date.zone}get timeZoneOffset(){return this.isUnknownTimeZone?0:this._date.offset}get timeZone(){if(this.isUnknownTimeZone)return"unknown";if("system"===this._date.zone.type)return"system";
const t=this.zone;return"fixed"===t.type?0===t.fixed?"UTC":t.formatOffset(0,"short"):t.name}stringify(){return JSON.stringify(this.toJSDate())}plus(t){return new g(this._date.plus(t))}diff(t,w="milliseconds"){return this._date.diff(t._date,w)[w]}toISODate(){return this._date.toISODate()}toISOString(t){return t?this._date.toISO({suppressMilliseconds:!0,includeOffset:!this.isUnknownTimeZone}):this._date.toISO({includeOffset:!this.isUnknownTimeZone})}toISOTime(t,w){return this._date.toISOTime({suppressMilliseconds:t,
includeOffset:w&&!this.isUnknownTimeZone})}toFormat(t,w){this.isUnknownTimeZone&&(t=t.replaceAll("Z",""));return this._date.toFormat(t,w)}toJSDate(){return this._date.toJSDate()}toSQLValue(){return this._date.toFormat("yyyy-LL-dd HH:mm:ss")}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}toDateTime(){return this._date}toNumber(){return this._date.toMillis()}getTime(){return this._date.toMillis()}toUTC(){return new g(this._date.toUTC())}toLocal(){return new g(this._date.toLocal())}toString(){return this.toISOString(!0)}static fromReaderAsTimeStampOffset(t){if(!t)return null;
t=u.DateTime.fromISO(t,{setZone:!0});return new g(t)}}b.ArcadeDate=g;b.ArcadeDateError=v;b.ArcadeDateErrorMessages=f;b.createDateTimeZone=p;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/UnknownTimeZone":function(){define(["exports","../../chunks/datetime"],function(b,d){function A(I){return I instanceof d.Zone?I===u.instance?!0:!1:"unknown"===I?.toString().toLowerCase()?!0:!1}class u{}u.instance=new d.IANAZone("Etc/UTC");b.UnknownTimeZone=u;b.adoptTimeZone=function(I,
p){return d.DateTime.fromObject({day:I.day,year:I.year,month:I.month,hour:I.hour,minute:I.minute,second:I.second,millisecond:I.millisecond},{zone:p})};b.isUnknownTimeZone=A;b.substituteUnknownTimezone=function(I){return A(I)?u.instance:I};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/featureset/support/errorsupport":function(){define(["exports","../../../core/string"],function(b,d){b.SqlErrorCodes=void 0;(function(f){f.InvalidFunctionParameters="InvalidFunctionParameters";
f.InvalidValueForAggregateFunction="InvalidValueForAggregateFunction";f.UnsupportedSqlFunction="UnsupportedSqlFunction";f.UnsupportedOperator="UnsupportedOperator";f.UnsupportedSyntax="UnsupportedSyntax";f.UnsupportedIsRhs="UnsupportedIsRhs";f.UnsupportedIsLhs="UnsupportedIsLhs";f.InvalidDataType="InvalidDataType";f.CannotCastValue="CannotCastValue";f.FunctionNotRecognized="FunctionNotRecognized";f.InvalidTime="InvalidTime";f.InvalidParameterCount="InvalidParameterCount";f.InvalidTimeStamp="InvalidTimeStamp";
f.InvalidDate="InvalidDate";f.InvalidOperator="InvalidOperator";f.IllegalInterval="IllegalInterval";f.YearMonthIntervals="YearMonthIntervals";f.PrimarySecondaryQualifiers="PrimarySecondaryQualifiers";f.MissingStatisticParameters="MissingStatisticParameters"})(b.SqlErrorCodes||(b.SqlErrorCodes={}));const A={[b.SqlErrorCodes.InvalidValueForAggregateFunction]:"Invalid value used in aggregate function",[b.SqlErrorCodes.MissingStatisticParameters]:"Statistic does not have 1 or 0 Parameters",[b.SqlErrorCodes.InvalidFunctionParameters]:"Invalid parameters for call to {function}",
[b.SqlErrorCodes.UnsupportedIsLhs]:"Unsupported left hand expression in is statement",[b.SqlErrorCodes.UnsupportedIsRhs]:"Unsupported right hand expression in is statement",[b.SqlErrorCodes.UnsupportedOperator]:"Unsupported operator - {operator}",[b.SqlErrorCodes.UnsupportedSyntax]:"Unsupported syntax - {node}",[b.SqlErrorCodes.UnsupportedSqlFunction]:"Sql function not found \x3d {function}",[b.SqlErrorCodes.InvalidDataType]:"Invalid sql data type",[b.SqlErrorCodes.InvalidDate]:"Invalid date encountered",
[b.SqlErrorCodes.InvalidOperator]:"Invalid operator encountered",[b.SqlErrorCodes.InvalidTime]:"Invalid time encountered",[b.SqlErrorCodes.IllegalInterval]:"Illegal interval",[b.SqlErrorCodes.FunctionNotRecognized]:"Function not recognized",[b.SqlErrorCodes.InvalidTimeStamp]:"Invalid timestamp encountered",[b.SqlErrorCodes.InvalidParameterCount]:"Invalid parameter count for call to {name}",[b.SqlErrorCodes.PrimarySecondaryQualifiers]:"Primary and Secondary SqlInterval qualifiers not supported",[b.SqlErrorCodes.YearMonthIntervals]:"Year-Month Intervals not supported",
[b.SqlErrorCodes.CannotCastValue]:"Cannot cast value to the required data type"};class u extends Error{constructor(f,v){super(d.replace(A[f],v));this.declaredRootClass="esri.arcade.featureset.support.sqlerror";Error.captureStackTrace&&Error.captureStackTrace(this,u)}}b.FeatureSetErrorCodes=void 0;(function(f){f.NeverReach="NeverReach";f.NotImplemented="NotImplemented";f.Cancelled="Cancelled";f.InvalidStatResponse="InvalidStatResponse";f.InvalidRequest="InvalidRequest";f.RequestFailed="RequestFailed";
f.MissingFeatures="MissingFeatures";f.AggregationFieldNotFound="AggregationFieldNotFound";f.DataElementsNotFound="DataElementsNotFound"})(b.FeatureSetErrorCodes||(b.FeatureSetErrorCodes={}));const I={[b.FeatureSetErrorCodes.Cancelled]:"Cancelled",[b.FeatureSetErrorCodes.InvalidStatResponse]:"Invalid statistics response from service",[b.FeatureSetErrorCodes.InvalidRequest]:"Invalid request",[b.FeatureSetErrorCodes.RequestFailed]:"Request failed - {reason}",[b.FeatureSetErrorCodes.MissingFeatures]:"Missing features",
[b.FeatureSetErrorCodes.AggregationFieldNotFound]:"Aggregation field not found",[b.FeatureSetErrorCodes.DataElementsNotFound]:"Data elements not found on service",[b.FeatureSetErrorCodes.NeverReach]:"Encountered unreachable logic",[b.FeatureSetErrorCodes.NotImplemented]:"Not implemented"};class p extends Error{constructor(f,v){super(d.replace(I[f],v));this.declaredRootClass="esri.arcade.featureset.support.featureseterror";Error.captureStackTrace&&Error.captureStackTrace(this,p)}}b.FeatureSetError=
p;b.FeatureSetErrorMessages=I;b.SqlError=u;b.SqlErrorMessages=A;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/AggregateFunctions":function(){define("exports ../../arcade/featureset/support/errorsupport ./DateOnly ./SqlTimestampOffset ./TimeOnly ../../chunks/datetime".split(" "),function(b,d,A,u,I,p){function f(w){if(null===w)return null;let C=0,B=0;for(let r=0;r<w.length;r++){const l=w[r];if(null!==l){if("number"!==typeof l)throw new d.SqlError(d.SqlErrorCodes.InvalidValueForAggregateFunction);
B++;C+=l}}return 0===B?null:C/w.length}function v(w,C){if(null===w)return null;let B=null,r=null;for(const l of w)w=l,w=l instanceof A.DateOnly?l.toNumber():l instanceof I.TimeOnly?l.toNumber():l instanceof p.DateTime?l.toMillis():l instanceof u.SqlTimeStampOffset?l.toMilliseconds():l,null===B?(B=l,r=w):"max"===C&&null!==r&&null!==w&&r<=w?(B=l,r=w):"min"===C&&null!==r&&null!==w&&r>=w&&(B=l,r=w);return B}function g(w){if(null===w)return null;w=w.filter(r=>null!==r);if(0===w.length)return null;const C=
f(w);if(null===C)return null;let B=0;for(const r of w){if("number"!==typeof r)throw new d.SqlError(d.SqlErrorCodes.InvalidValueForAggregateFunction);B+=(C-r)**2}return B/(w.length-1)}const t={min:{minParams:1,maxParams:1,evaluate:w=>v(w[0],"min")},max:{minParams:1,maxParams:1,evaluate:w=>v(w[0],"max")},avg:{minParams:1,maxParams:1,evaluate:w=>f(w[0])},sum:{minParams:1,maxParams:1,evaluate:w=>{w=w[0];if(null===w)w=null;else{var C=0;for(let B=0;B<w.length;B++){const r=w[B];if(null!==r){if("number"!==
typeof r)throw new d.SqlError(d.SqlErrorCodes.InvalidValueForAggregateFunction);C+=r}}w=C}return w}},stddev:{minParams:1,maxParams:1,evaluate:w=>{w=w[0];null===w?w=null:(w=g(w),w=null===w?null:Math.sqrt(w));return w}},count:{minParams:1,maxParams:1,evaluate:w=>null==w[0]?null:w[0].length},var:{minParams:1,maxParams:1,evaluate:w=>g(w[0])}};b.aggregateFunction=function(w,C){const B=t[w.toLowerCase()];if(null==B)throw new d.SqlError(d.SqlErrorCodes.FunctionNotRecognized);if(C.length<B.minParams||C.length>
B.maxParams)throw new d.SqlError(d.SqlErrorCodes.InvalidParameterCount,{name:w.toUpperCase()});return B.evaluate(C)};b.isAggregate=function(w,C){w=t[w.toLowerCase()];return null!=w&&C>=w.minParams&&C<=w.maxParams};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/DateOnly":function(){define(["exports","../../arcade/ArcadeDate","../../intl/locale","../../chunks/datetime"],function(b,d,A,u){function I(f){f=f.replaceAll(/LTS|LT|LL?L?L?|l{1,4}/g,"[$\x26]");let v="";const g=
/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;for(const t of f.match(g)||[])switch(t){case "D":v+="d";break;case "DD":v+="dd";break;case "DDD":v+="o";break;case "d":v+="c";break;case "ddd":v+="ccc";break;case "dddd":v+="cccc";break;case "M":v+="L";break;case "MM":v+="LL";break;case "MMM":v+="LLL";break;case "MMMM":v+="LLLL";break;case "YY":v+="yy";
break;case "Y":case "YYYY":v+="yyyy";break;case "Q":v+="q";break;case "X":case "x":v+=t;break;default:v=2<=t.length&&"["===t.slice(0,1)&&"]"===t.slice(-1)?v+`'${t.slice(1,-1)}'`:v+`'${t}'`}return v}class p{constructor(f,v,g){this._year=f;this._month=v;this._day=g;this.declaredRootClass="esri.core.sql.dateonly"}get month(){return this._month}get monthJS(){return this._month-1}get year(){return this._year}get day(){return this._day}get isValid(){return this.toDateTime("unknown").isValid}equals(f){return f instanceof
p&&f.day===this.day&&f.month===this.month&&f.year===this.year}clone(){return new p(this._year,this._month,this._day)}toDateTime(f){return u.DateTime.fromObject({day:this.day,month:this.month,year:this.year},{zone:d.createDateTimeZone(f)})}toDateTimeLuxon(f){return u.DateTime.fromObject({day:this.day,month:this.month,year:this.year},{zone:d.createDateTimeZone(f)})}toString(){return`${this.year.toString().padStart(4,"0")}-${this.month.toString().padStart(2,"0")}-${this.day.toString().padStart(2,"0")}`}toFormat(f=
null){if(null===f||""===f)return this.toString();f=I(f);if(!f)return"";const v=this.toDateTime("unknown");return d.ArcadeDate.dateTimeToArcadeDate(v).toFormat(f,{locale:A.getLocale(),numberingSystem:"latn"})}toArcadeDate(){const f=this.toDateTime("unknown");return d.ArcadeDate.dateTimeToArcadeDate(f)}toNumber(){return this.toDateTime("unknown").toMillis()}toJSDate(){return this.toDateTime("unknown").toJSDate()}toStorageFormat(){return this.toFormat("yyyy-LL-dd")}toSQLValue(){return this.toFormat("yyyy-LL-dd")}toSQLWithKeyword(){return"date '"+
this.toFormat("yyyy-LL-dd")+"'"}plus(f,v){return p.fromDateTime(this.toUTCDateTime().plus({[f]:v}))}toUTCDateTime(){return u.DateTime.utc(this.year,this.month,this.day,0,0,0,0)}difference(f,v){switch(v.toLowerCase()){case "days":case "day":case "d":return this.toUTCDateTime().diff(f.toUTCDateTime(),"days").days;case "months":case "month":return this.toUTCDateTime().diff(f.toUTCDateTime(),"months").months;case "minutes":case "minute":case "m":return"M"===v?this.toUTCDateTime().diff(f.toUTCDateTime(),
"months").months:this.toUTCDateTime().diff(f.toUTCDateTime(),"minutes").minutes;case "seconds":case "second":case "s":return this.toUTCDateTime().diff(f.toUTCDateTime(),"seconds").seconds;case "milliseconds":case "millisecond":case "ms":return this.toUTCDateTime().diff(f.toUTCDateTime(),"milliseconds").milliseconds;case "hours":case "hour":case "h":return this.toUTCDateTime().diff(f.toUTCDateTime(),"hours").hours;case "years":case "year":case "y":return this.toUTCDateTime().diff(f.toUTCDateTime(),
"years").years;default:return this.toUTCDateTime().diff(f.toUTCDateTime(),"milliseconds").milliseconds}}static fromMilliseconds(f){f=u.DateTime.fromMillis(f,{zone:u.FixedOffsetZone.utcInstance});return f.isValid?p.fromParts(f.year,f.month,f.day):null}static fromSeconds(f){f=u.DateTime.fromSeconds(f,{zone:u.FixedOffsetZone.utcInstance});return f.isValid?p.fromParts(f.year,f.month,f.day):null}static fromReader(f){if(!f)return null;f=f.split("-");return 3!==f.length?null:new p(parseInt(f[0],10),parseInt(f[1],
10),parseInt(f[2],10))}static fromParts(f,v,g){f=new p(f,v,g);return!1===f.isValid?null:f}static fromDateJS(f){return p.fromParts(f.getFullYear(),f.getMonth()+1,f.getDay())}static fromDateTime(f){return p.fromParts(f.year,f.month,f.day)}static fromSqlTimeStampOffset(f){return this.fromDateTime(f.toDateTime())}static fromString(f,v=null){if(""===f||null===f)return null;var g=[];if(v)(v=I(v))&&g.push(v);else if(null===v||""===v)return f=u.DateTime.fromISO(f,{setZone:!0}),f.isValid?p.fromParts(f.year,
f.month,f.day):null;for(const t of g)if(g=u.DateTime.fromFormat(f,v??t),g.isValid)return new p(g.year,g.month,g.day);return null}static fromNow(f="system"){f=u.DateTime.fromJSDate(new Date).setZone(d.createDateTimeZone(f));return new p(f.year,f.month,f.day)}}b.DateOnly=p;b.standardiseDateOnlyFormat=I;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/SqlTimestampOffset":function(){define(["exports","../../chunks/datetime"],function(b,d){function A(I){return Number.isNaN(I)||
0===I?I:Math.trunc(I)}class u{constructor(I){this._timeStampOffset=I;this._date=null}toDateTime(){this._date??(this._date=d.DateTime.fromISO(this._timeStampOffset,{setZone:!0}));return this._date}get isValid(){return this.toDateTime().isValid}get timezoneOffsetHour(){return A(this.toDateTime().offset/60)}get timezoneOffsetMinutes(){return A(this.toDateTime().offset%60)}toMilliseconds(){return this.toDateTime().toMillis()}get hour(){return this.toDateTime().hour}get minute(){return this.toDateTime().minute}get second(){return this.toDateTime().second}get day(){return this.toDateTime().day}get month(){return this.toDateTime().month}get year(){return this.toDateTime().year}startOfDay(){return u.fromDateTime(this.toDateTime().startOf("day"))}static fromJSDate(I){return new u(d.DateTime.fromJSDate(I).toISO({includeOffset:!0}))}static fromDateTime(I){return new u(I.toISO({includeOffset:!0}))}static fromParts(I,
p,f=0,v=0,g=0,t=0,w=0,C=!1,B=0,r=0){I=`${I.toString().padStart(4,"0")}-${p.toString().padStart(2,"0")}-${f.toString().padStart(2,"0")}`;p="";10>t&&(p="0");v=`${v.toString().padStart(2,"0")}:${g.toString().padStart(2,"0")}:${p+t.toString()}`;0!==w&&(v+="."+w.toString().padStart(3,"0"));w=`${C?"-":"+"}${B.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`;return new u(I+"T"+v+w)}toStorageFormat(){return this._timeStampOffset}toString(){return this._timeStampOffset}toSQLValue(){let I=this.toDateTime().toSQL({includeOffset:!0,
includeOffsetSpace:!0});I&&(I=I.replace(".000",""));return I}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}addMilliseconds(I){I=this.toDateTime().plus(I);return u.fromDateTime(I)}}b.SqlTimeStampOffset=u;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/TimeOnly":function(){define(["exports","../../arcade/kernel","../../intl/locale","../../chunks/datetime"],function(b,d,A,u){function I(f){if(!f)return"";const v=/(a|A|hh?|HH?|mm?|ss?|SSS|S|.)/g;let g="";for(const t of f.match(v)||
[])switch(t){case "SSS":g+=t;break;case "A":case "a":g+="a";break;case "m":case "mm":case "h":case "hh":case "H":case "HH":case "s":case "ss":g+=t;break;default:g+=`'${t}'`}return g}class p{constructor(f,v,g,t){this._hour=f;this._minute=v;this._second=g;this._millisecond=t;this.declaredRootClass="esri.core.sql.timeonly"}get hour(){return this._hour}get minute(){return this._minute}get second(){return this._second}get millisecond(){return this._millisecond}equals(f){return f instanceof p&&f.hour===
this.hour&&f.minute===this.minute&&f.second===this.second&&f.millisecond===this.millisecond}clone(){return new p(this.hour,this.minute,this.second,this.millisecond)}isValid(){return d.isInteger(this.hour)&&d.isInteger(this.minute)&&d.isInteger(this.second)&&d.isInteger(this.millisecond)&&0<=this.hour&&24>this.hour&&0<=this.minute&&60>this.minute&&0<=this.second&&60>this.second&&0<=this.millisecond&&1E3>this.millisecond}toString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,
"0")}:${this.second.toString().padStart(2,"0")}`+(0<this.millisecond?"."+this.millisecond.toString().padStart(3,"0"):"")}toSQLValue(){return this.toString()}toSQLWithKeyword(){return`time '${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}${0<this.millisecond?"."+this.millisecond.toString().padStart(3,"0"):""}'`}toStorageString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,
"0")}`}toFormat(f=null){return null===f||""===f?this.toString():(f=I(f))?u.DateTime.local(1970,1,1,this._hour,this._minute,this._second,this._millisecond).toFormat(f,{locale:A.getLocale(),numberingSystem:"latn"}):""}toNumber(){return this.millisecond+1E3*this.second+6E4*this.minute+36E5*this.hour}static fromParts(f,v,g,t){f=new p(f,v,g,t);return f.isValid()?f:null}static fromReader(f){if(!f)return null;f=f.split(":");return 3!==f.length?null:new p(parseInt(f[0],10),parseInt(f[1],10),parseInt(f[2],
10),0)}static fromMilliseconds(f){return 864E5<f||0>f?null:new p(Math.floor(f/36E5%24),Math.floor(f/6E4%60),Math.floor(f/1E3%60),Math.floor(f%1E3))}static fromDateJS(f){return new p(f.getHours(),f.getMinutes(),f.getSeconds(),f.getMilliseconds())}static fromDateTime(f){return new p(f.hour,f.minute,f.second,f.millisecond)}static fromSqlTimeStampOffset(f){return this.fromDateTime(f.toDateTime())}static fromString(f,v=null){if(""===f||null===f)return null;const g=[];if(v)(v=I(v))&&g.push(v);else if(null===
v||""===v)g.push("HH:mm:ss"),g.push("HH:mm:ss.SSS"),g.push("hh:mm:ss a"),g.push("hh:mm:ss.SSS a"),g.push("HH:mm"),g.push("hh:mm a"),g.push("H:mm"),g.push("h:mm a"),g.push("H:mm:ss"),g.push("h:mm:ss a"),g.push("H:mm:ss.SSS"),g.push("h:mm:ss.SSS a");for(const t of g)if(v=u.DateTime.fromFormat(f,t),v.isValid)return new p(v.hour,v.minute,v.second,v.millisecond);return null}plus(f,v){switch(f){case "days":case "years":case "months":return this.clone();case "hours":case "minutes":case "seconds":case "milliseconds":return p.fromDateTime(this.toUTCDateTime().plus({[f]:v}))}return null}toUTCDateTime(){return u.DateTime.utc(1970,
1,1,this.hour,this.minute,this.second,this.millisecond)}difference(f,v){switch(v.toLowerCase()){case "days":case "day":case "d":return this.toUTCDateTime().diff(f.toUTCDateTime(),"days").days;case "months":case "month":return this.toUTCDateTime().diff(f.toUTCDateTime(),"months").months;case "minutes":case "minute":case "m":return"M"===v?this.toUTCDateTime().diff(f.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(f.toUTCDateTime(),"minutes").minutes;case "seconds":case "second":case "s":return this.toUTCDateTime().diff(f.toUTCDateTime(),
"seconds").seconds;case "milliseconds":case "millisecond":case "ms":return this.toUTCDateTime().diff(f.toUTCDateTime(),"milliseconds").milliseconds;case "hours":case "hour":case "h":return this.toUTCDateTime().diff(f.toUTCDateTime(),"hours").hours;case "years":case "year":case "y":return this.toUTCDateTime().diff(f.toUTCDateTime(),"years").years;default:return this.toUTCDateTime().diff(f.toUTCDateTime(),"milliseconds").milliseconds}}}b.TimeOnly=p;b.standardiseTimeFormat=I;Object.defineProperty(b,
Symbol.toStringTag,{value:"Module"})})},"esri/arcade/kernel":function(){define(["exports","../geometry/Extent"],function(b,d){b.cloneGeometry=function(A){if(null==A)return null;const u=A.clone();void 0!==A.cache._geVersion&&(u.cache._geVersion=A.cache._geVersion);return u};b.convertLinearUnitsToCode=function(A){if(null==A)return null;if("number"===typeof A)return A;A=A.toLowerCase();A=A.replaceAll(/\s/g,"");A=A.replaceAll("-","");switch(A){case "meters":case "meter":case "m":case "squaremeters":case "squaremeter":return 9001;
case "miles":case "mile":case "squaremile":case "squaremiles":return 9093;case "kilometers":case "kilometer":case "squarekilometers":case "squarekilometer":case "km":return 9036;case "yard":case "yd":case "yards":case "squareyards":case "squareyard":return 9096;case "feet":case "ft":case "foot":case "squarefeet":case "squarefoot":return 9002;case "nmi":case "nauticalmile":case "nauticalmiles":case "squarenauticalmile":case "squarenauticalmiles":return 9030}return null};b.convertSquareUnitsToCode=
function(A){if(null==A)return null;if("number"===typeof A)return A;A=A.toLowerCase();A=A.replaceAll(/\s/g,"");A=A.replaceAll("-","");switch(A){case "meters":case "meter":case "m":case "squaremeters":case "squaremeter":return 109404;case "miles":case "mile":case "squaremile":case "squaremiles":return 109439;case "kilometers":case "kilometer":case "squarekilometers":case "squarekilometer":case "km":return 109414;case "acres":case "acre":case "ac":return 109402;case "hectares":case "hectare":case "ha":return 109401;
case "yard":case "yd":case "yards":case "squareyards":case "squareyard":return 109442;case "feet":case "ft":case "foot":case "squarefeet":case "squarefoot":return 109405;case "nmi":case "nauticalmile":case "nauticalmiles":case "squarenauticalmile":case "squarenauticalmiles":return 109409}return null};b.isInteger=function(A){return"number"===typeof A&&isFinite(A)&&Math.floor(A)===A};b.sameGeomType=function(A,u){return A===u||"point"===A&&"esriGeometryPoint"===u||"polyline"===A&&"esriGeometryPolyline"===
u||"polygon"===A&&"esriGeometryPolygon"===u||"extent"===A&&"esriGeometryEnvelope"===u||"multipoint"===A&&"esriGeometryMultipoint"===u||"point"===u&&"esriGeometryPoint"===A||"polyline"===u&&"esriGeometryPolyline"===A||"polygon"===u&&"esriGeometryPolygon"===A||"extent"===u&&"esriGeometryEnvelope"===A||"multipoint"===u&&"esriGeometryMultipoint"===A?!0:!1};b.shapeExtent=function(A){if(null==A)return null;switch(A.type){case "polygon":case "multipoint":case "polyline":return A.extent;case "point":return new d({xmin:A.x,
ymin:A.y,xmax:A.x,ymax:A.y,spatialReference:A.spatialReference});case "extent":return A}return null};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/sqlArithmeticUtils":function(){define(["exports","../../arcade/featureset/support/errorsupport","./sqlDateParsingUtils","./SqlInterval","./StandardizedFunctions"],function(b,d,A,u,I){function p(z,G,K){switch(K){case "+":return z+G;case "-":return z-G;case "*":return z*G;case "/":return z/G}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);
}function f(z,G,K){switch(K){case "+":return G.plus({milliseconds:z.valueInMilliseconds()});case "-":return z.valueInMilliseconds()-G.toMillis()}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function v(z,G,K){switch(K){case "+":return G.plus("milliseconds",z.valueInMilliseconds())}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function g(z,G,K){switch(K){case "+":return G.plus("milliseconds",z.valueInMilliseconds())}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function t(z,
G,K){switch(K){case "+":return z.plus("milliseconds",G.valueInMilliseconds());case "-":return z.plus("milliseconds",-1*G.valueInMilliseconds())}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function w(z,G,K){switch(K){case "+":return G.addMilliseconds(z.valueInMilliseconds())}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function C(z,G,K){switch(K){case "+":return u.SqlInterval.createFromMilliseconds(z.valueInMilliseconds()+G.valueInMilliseconds());case "-":return u.SqlInterval.createFromMilliseconds(z.valueInMilliseconds()-
G.valueInMilliseconds());case "*":return u.SqlInterval.createFromMilliseconds(z.valueInMilliseconds()*G.valueInMilliseconds());case "/":return u.SqlInterval.createFromMilliseconds(z.valueInMilliseconds()/G.valueInMilliseconds())}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function B(z,G,K){switch(K){case "+":return u.SqlInterval.createFromMilliseconds(z.valueInMilliseconds()+G);case "-":return u.SqlInterval.createFromMilliseconds(z.valueInMilliseconds()-G);case "*":return u.SqlInterval.createFromMilliseconds(z.valueInMilliseconds()*
G);case "/":return u.SqlInterval.createFromMilliseconds(z.valueInMilliseconds()/G)}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function r(z,G,K){switch(K){case "+":return u.SqlInterval.createFromMilliseconds(z+G.valueInMilliseconds());case "-":return u.SqlInterval.createFromMilliseconds(z-G.valueInMilliseconds());case "*":return u.SqlInterval.createFromMilliseconds(z*G.valueInMilliseconds());case "/":return u.SqlInterval.createFromMilliseconds(z/G.valueInMilliseconds())}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);
}function l(z,G,K){switch(K){case "+":return z.plus("milliseconds",G.valueInMilliseconds());case "-":return z.plus("milliseconds",-1*G.valueInMilliseconds())}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function a(z,G,K){switch(K){case "+":return z.plus({milliseconds:G.valueInMilliseconds()});case "-":return z.minus({milliseconds:G.valueInMilliseconds()})}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function q(z,G,K){switch(K){case "+":return z.addMilliseconds(G.valueInMilliseconds());
case "-":return z.addMilliseconds(-1*G.valueInMilliseconds())}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function y(z,G,K){G*=864E5;switch(K){case "+":return z.plus({milliseconds:G});case "-":return z.minus({milliseconds:G})}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function F(z,G,K){G*=864E5;switch(K){case "+":return z.plus("milliseconds",G);case "-":return z.plus("milliseconds",-1*G)}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function Q(z,G,K){G*=864E5;switch(K){case "+":return z.plus("milliseconds",
G);case "-":return z.plus("milliseconds",-1*G)}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function e(z,G,K){throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function H(z,G,K){G*=864E5;switch(K){case "+":return z.addMilliseconds(G);case "-":return z.addMilliseconds(-1*G)}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function S(z,G,K){throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function J(z,G,K){throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function R(z,
G,K){throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function P(z,G,K){G=parseFloat(G);if(isNaN(G))throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);return p(z,G,K)}function V(z,G,K){z=parseFloat(z);if(isNaN(z))throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);return p(z,G,K)}function m(z,G,K){switch(K){case "+":return z+G}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function O(z,G,K){throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function n(z,G,K){throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);
}function x(z,G,K){switch(K){case "-":return z.toDateTimeLuxon(G.zone).diff(G).as("days")}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function M(z,G,K){switch(K){case "-":return z.toDateTimeLuxon(G.toDateTime().zone).diff(G.toDateTime()).as("days")}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function L(z,G,K){switch(K){case "-":return z.toDateTimeLuxon("UTC").diff(G.toDateTimeLuxon("UTC")).as("days")}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function T(z,G,K){throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);
}function Y(z,G,K){throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function fa(z,G,K){switch(K){case "-":return z.toDateTime().diff(G.toDateTimeLuxon(z.toDateTime().zone)).as("days")}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function oa(z,G,K){switch(K){case "-":return z.toDateTime().diff(G).as("days")}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function sa(z,G,K){switch(K){case "-":return z.toDateTime().diff(G.toDateTime()).as("days")}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);
}function ca(z,G,K){throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function ka(z,G,K){throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function ia(z,G,K){throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function ra(z,G,K){throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function pa(z,G,K){switch(K){case "-":return z.diff(G).as("days")}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function xa(z,G,K){switch(K){case "-":return z.diff(G.toDateTimeLuxon(z.zone)).as("days")}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);
}function Ba(z,G,K){switch(K){case "-":return z.diff(G.toDateTime()).as("days")}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function Ka(z,G,K){throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function Fa(z,G,K){throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function La(z,G,K){throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function Ta(z,G,K){throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function h(z,G,K){throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);
}function E(z,G,K){throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function X(z,G,K){throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function aa(z,G,K){throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function ja(z,G,K){throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}b.calculateDateOnlyAndDateOnly=L;b.calculateDateOnlyAndDateTime=x;b.calculateDateOnlyAndNumber=F;b.calculateDateOnlyAndSqlInterval=l;b.calculateDateOnlyAndString=Fa;b.calculateDateOnlyAndTimeOnly=T;b.calculateDateOnlyAndTimestamp=
M;b.calculateDateTimeAndDateOnly=xa;b.calculateDateTimeAndDateTime=pa;b.calculateDateTimeAndNumber=y;b.calculateDateTimeAndSqlInterval=a;b.calculateDateTimeAndString=Ta;b.calculateDateTimeAndTimeOnly=Ka;b.calculateDateTimeAndTimestamp=Ba;b.calculateNumberAndDateOnly=R;b.calculateNumberAndDateTime=e;b.calculateNumberAndNumber=p;b.calculateNumberAndSqlInterval=r;b.calculateNumberAndString=P;b.calculateNumberAndTimeOnly=J;b.calculateNumberAndTimestamp=S;b.calculateSqlIntervalAndDateOnly=g;b.calculateSqlIntervalAndDateTime=
f;b.calculateSqlIntervalAndNumber=B;b.calculateSqlIntervalAndSqlInterval=C;b.calculateSqlIntervalAndString=O;b.calculateSqlIntervalAndTimeOnly=v;b.calculateSqlIntervalAndTimestamp=w;b.calculateStringAndDateOnly=X;b.calculateStringAndDateTime=aa;b.calculateStringAndNumber=V;b.calculateStringAndSqlInterval=n;b.calculateStringAndString=m;b.calculateStringAndTimeOnly=E;b.calculateStringAndTimestamp=ja;b.calculateTimeOnlyAndDateOnly=ka;b.calculateTimeOnlyAndDateTime=ca;b.calculateTimeOnlyAndNumber=Q;b.calculateTimeOnlyAndSqlInterval=
t;b.calculateTimeOnlyAndString=La;b.calculateTimeOnlyAndTimeOnly=ra;b.calculateTimeOnlyAndTimestamp=ia;b.calculateTimestampAndDateOnly=fa;b.calculateTimestampAndDateTime=oa;b.calculateTimestampAndNumber=H;b.calculateTimestampAndSqlInterval=q;b.calculateTimestampAndString=h;b.calculateTimestampAndTimeOnly=Y;b.calculateTimestampAndTimestamp=sa;b.sqlCalculateFunction=function(z,G,K,W){if("||"===z)return I.evaluateFunction("concat",[G,K],W);if(null===G||null===K)return null;if(A.isNumber(G)){if(A.isNumber(K))return p(G,
K,z);if(A.isSqlInterval(K))return r(G,K,z);if(A.isTimeOnly(K))return J();if(A.isDateOnly(K))return R();if(A.isTimestampOffset(K))return S();if(A.isDateTime(K))return e();if(A.isString(K))return P(G,K,z)}else if(A.isDateOnly(G)){if(A.isNumber(K))return F(G,K,z);if(A.isSqlInterval(K))return l(G,K,z);if(A.isTimeOnly(K))return T();if(A.isDateOnly(K))return L(G,K,z);if(A.isTimestampOffset(K))return M(G,K,z);if(A.isDateTime(K))return x(G,K,z);if(A.isString(K))return Fa()}else if(A.isTimeOnly(G)){if(A.isNumber(K))return Q(G,
K,z);if(A.isSqlInterval(K))return t(G,K,z);if(A.isTimeOnly(K))return ra();if(A.isDateOnly(K))return ka();if(A.isTimestampOffset(K))return ia();if(A.isDateTime(K))return ca();if(A.isString(K))return La()}else if(A.isSqlInterval(G)){if(A.isNumber(K))return B(G,K,z);if(A.isSqlInterval(K))return C(G,K,z);if(A.isTimeOnly(K))return v(G,K,z);if(A.isDateOnly(K))return g(G,K,z);if(A.isTimestampOffset(K))return w(G,K,z);if(A.isDateTime(K))return f(G,K,z);if(A.isString(K))return O()}else if(A.isDateTime(G)){if(A.isNumber(K))return y(G,
K,z);if(A.isSqlInterval(K))return a(G,K,z);if(A.isTimeOnly(K))return Ka();if(A.isDateOnly(K))return xa(G,K,z);if(A.isTimestampOffset(K))return Ba(G,K,z);if(A.isDateTime(K))return pa(G,K,z);if(A.isString(K))return Ta()}else if(A.isTimestampOffset(G)){if(A.isNumber(K))return H(G,K,z);if(A.isSqlInterval(K))return q(G,K,z);if(A.isTimeOnly(K))return Y();if(A.isDateOnly(K))return fa(G,K,z);if(A.isTimestampOffset(K))return sa(G,K,z);if(A.isDateTime(K))return oa(G,K,z);if(A.isString(K))return h()}else if(A.isString(G)){if(A.isNumber(K))return V(G,
K,z);if(A.isSqlInterval(K))return n();if(A.isTimeOnly(K))return E();if(A.isDateOnly(K))return X();if(A.isTimestampOffset(K))return ja();if(A.isDateTime(K))return aa();if(A.isString(K))return m(G,K,z)}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/sqlDateParsingUtils":function(){define("exports ../../arcade/featureset/support/errorsupport ./DateOnly ./SqlInterval ./SqlTimestampOffset ./TimeOnly ./UnknownTimeZone ../../chunks/datetime".split(" "),
function(b,d,A,u,I,p,f,v){function g(y,F,Q){Q=r.exec(y);if(null!==Q){const [,e,H,S,J,R,P,V]=Q;y=v.DateTime.fromObject({year:parseInt(e,10),month:parseInt(H,10),day:parseInt(S,10),hour:parseInt(J,10),minute:parseInt(R,10),second:parseInt(P,10),millisecond:V?parseInt(V.replace(".",""),10):0},{zone:f.substituteUnknownTimezone(F)});if(!1===y.isValid)throw new d.SqlError(d.SqlErrorCodes.InvalidTimeStamp);return y}Q=l.exec(y);if(null!==Q){const [,e,H,S,J,R,P,V,m,O,n]=Q;y=I.SqlTimeStampOffset.fromParts(parseInt(e,
10),parseInt(H,10),parseInt(S,10),parseInt(J,10),parseInt(R,10),parseInt(P,10),V?parseInt(V.replace(".",""),10):0,"-"===m,parseInt(O,10),parseInt(n,10));if(!1===y.isValid)throw new d.SqlError(d.SqlErrorCodes.InvalidTimeStamp);return y}Q=a.exec(y);if(null!==Q){const [,e,H,S,J,R,P,V,m]=Q;y=I.SqlTimeStampOffset.fromParts(parseInt(e,10),parseInt(H,10),parseInt(S,10),parseInt(J,10),parseInt(R,10),0,0,"-"===P,parseInt(V,10),parseInt(m,10));if(!1===y.isValid)throw new d.SqlError(d.SqlErrorCodes.InvalidTimeStamp);
return y}Q=q.exec(y);if(null!==Q){const [,e,H,S,J,R]=Q;y=v.DateTime.fromObject({year:parseInt(e,10),month:parseInt(H,10),day:parseInt(S,10),hour:parseInt(J,10),minute:parseInt(R,10),second:0},{zone:f.substituteUnknownTimezone(F)});if(!1===y.isValid)throw new d.SqlError(d.SqlErrorCodes.InvalidTimeStamp);return y}Q=B.exec(y);if(null!==Q){const [,e,H,S]=Q;y=v.DateTime.fromObject({year:parseInt(e,10),month:parseInt(H,10),day:parseInt(S,10),hour:0,minute:0,second:0},{zone:f.substituteUnknownTimezone(F)});
if(!1===y.isValid)throw new d.SqlError(d.SqlErrorCodes.InvalidTimeStamp);return y}throw new d.SqlError(d.SqlErrorCodes.InvalidTimeStamp);}const t=/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/,w=/^(\d{1,2}):(\d{1,2})$/,C=/^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/,B=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,r=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$/,l=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$/,a=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$/,
q=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/;b.convertToExecutingTimeZone=function(y,F){if(F instanceof v.Zone)return F===f.UnknownTimeZone.instance?v.DateTime.fromMillis(y.getTime(),{zone:f.UnknownTimeZone.instance}):v.DateTime.fromJSDate(y,{zone:F});switch(F){case "system":case "local":case null:return v.DateTime.fromJSDate(y);default:return"unknown"===F?.toLowerCase()?v.DateTime.fromMillis(y.getTime(),{zone:f.UnknownTimeZone.instance}):v.DateTime.fromJSDate(y,{zone:F})}};b.isDate=function(y){return y instanceof
Date};b.isDateOnly=function(y){return y instanceof A.DateOnly};b.isDateTime=function(y){return y instanceof v.DateTime};b.isNumber=function(y){return"number"===typeof y};b.isSqlInterval=function(y){return y instanceof u.SqlInterval};b.isString=function(y){return"string"===typeof y||y instanceof String};b.isTimeOnly=function(y){return y instanceof p.TimeOnly};b.isTimestampOffset=function(y){return y instanceof I.SqlTimeStampOffset};b.parseDate=function(y,F){const Q=B.exec(y);if(null===Q)try{return g(y,
F)}catch{throw new d.SqlError(d.SqlErrorCodes.InvalidDate);}const [,e,H,S]=Q;y=A.DateOnly.fromParts(parseInt(e,10),parseInt(H,10),parseInt(S,10));if(null===y)throw new d.SqlError(d.SqlErrorCodes.InvalidDate);return y};b.parseTime=function(y){let F=t.exec(y);if(null!==F){const [,Q,e,H]=F;y=p.TimeOnly.fromParts(parseInt(Q,10),parseInt(e,10),parseInt(H,10),0);if(null!==y)return y;throw new d.SqlError(d.SqlErrorCodes.InvalidTime);}F=w.exec(y);if(null!==F){const [,Q,e]=F;y=p.TimeOnly.fromParts(parseInt(Q,
10),parseInt(e,10),0,0);if(null!==y)return y;throw new d.SqlError(d.SqlErrorCodes.InvalidTime);}F=C.exec(y);if(null!==F){const [,Q,e,H,S]=F;y=p.TimeOnly.fromParts(parseInt(Q,10),parseInt(e,10),parseInt(H,10),parseInt(S,10));if(null!==y)return y}throw new d.SqlError(d.SqlErrorCodes.InvalidTime);};b.parseTimestamp=g;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/SqlInterval":function(){define(["exports","../../arcade/featureset/support/errorsupport"],function(b,d){class A{constructor(){this.op=
"+";this.millis=this.minute=this.year=this.month=this.hour=this.second=this.day=0}static _fixDefaults(u){if(null!==u.precision||null!==u.secondary)throw new d.SqlError(d.SqlErrorCodes.PrimarySecondaryQualifiers);}static _parseSecondsComponent(u,I){I.includes(".")?(I=I.split("."),u.second=parseFloat(I[0]),u.millis=parseInt(I[1],10)):u.second=parseFloat(I)}static createFromMilliseconds(u){const I=new A;I.second=u/1E3;return I}static createFromValueAndQualifer(u,I,p){let f=null;const v=new A;v.op="-"===
p?"-":"+";if("interval-period"===I.type){A._fixDefaults(I);p=RegExp("^[0-9]{1,}$");if("year"===I.period||"month"===I.period)throw new d.SqlError(d.SqlErrorCodes.YearMonthIntervals);if("second"===I.period)if(/^[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/.test(u))A._parseSecondsComponent(v,u);else throw new d.SqlError(d.SqlErrorCodes.IllegalInterval);else if(p.test(u))v[I.period]=parseFloat(u);else throw new d.SqlError(d.SqlErrorCodes.IllegalInterval);}else{A._fixDefaults(I.start);A._fixDefaults(I.end);if("year"===
I.start.period||"month"===I.start.period||"year"===I.end.period||"month"===I.end.period)throw new d.SqlError(d.SqlErrorCodes.YearMonthIntervals);switch(I.start.period){case "day":switch(I.end.period){case "hour":f=RegExp("^[0-9]{1,} [0-9]{1,}$");if(f.test(u))v[I.start.period]=parseFloat(u.split(" ")[0]),v[I.end.period]=parseFloat(u.split(" ")[1]);else throw new d.SqlError(d.SqlErrorCodes.IllegalInterval);break;case "minute":f=RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$");if(f.test(u))v[I.start.period]=
parseFloat(u.split(" ")[0]),u=u.split(" ")[1].split(":"),v.hour=parseFloat(u[0]),v.minute=parseFloat(u[1]);else throw new d.SqlError(d.SqlErrorCodes.IllegalInterval);break;case "second":f=RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(f.test(u))v[I.start.period]=parseFloat(u.split(" ")[0]),u=u.split(" ")[1].split(":"),v.hour=parseFloat(u[0]),v.minute=parseFloat(u[1]),A._parseSecondsComponent(v,u[2]);else throw new d.SqlError(d.SqlErrorCodes.IllegalInterval);break;default:throw new d.SqlError(d.SqlErrorCodes.IllegalInterval);
}break;case "hour":switch(I.end.period){case "minute":f=RegExp("^[0-9]{1,}:[0-9]{1,}$");if(f.test(u))v.hour=parseFloat(u.split(":")[0]),v.minute=parseFloat(u.split(":")[1]);else throw new d.SqlError(d.SqlErrorCodes.IllegalInterval);break;case "second":f=RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(f.test(u))u=u.split(":"),v.hour=parseFloat(u[0]),v.minute=parseFloat(u[1]),A._parseSecondsComponent(v,u[2]);else throw new d.SqlError(d.SqlErrorCodes.IllegalInterval);break;default:throw new d.SqlError(d.SqlErrorCodes.IllegalInterval);
}break;case "minute":switch(I.end.period){case "second":f=RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(f.test(u))u=u.split(":"),v.minute=parseFloat(u[0]),A._parseSecondsComponent(v,u[1]);else throw new d.SqlError(d.SqlErrorCodes.IllegalInterval);break;default:throw new d.SqlError(d.SqlErrorCodes.IllegalInterval);}break;default:throw new d.SqlError(d.SqlErrorCodes.IllegalInterval);}}return v}valueInMilliseconds(){return("-"===this.op?-1:1)*(this.millis+1E3*this.second+6E4*this.minute+36E5*
this.hour+864E5*this.day+365/12*this.month*864E5+31536E6*this.year)}}b.SqlInterval=A;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/StandardizedFunctions":function(){define("exports ../../arcade/featureset/support/errorsupport ../string ./DateOnly ./sqlCompareUtils ./sqlDateParsingUtils ./TimeOnly ../../chunks/datetime".split(" "),function(b,d,A,u,I,p,f,v){function g(a){return"string"===typeof a||a instanceof String}function t(a){return p.isDate(a)||p.isDateOnly(a)||
p.isDateTime(a)||p.isTimeOnly(a)||p.isTimestampOffset(a)?!1:!0}function w(a){return p.isDateOnly(a)||p.isTimeOnly(a)?a.toString():p.isTimestampOffset(a)?a.toSQLValue():p.isDateTime(a)?0===a.millisecond?a.toFormat("yyyy-LL-dd HH:mm:ss"):a.toSQL({includeOffset:!1}):p.isDate(a)?w(v.DateTime.fromJSDate(a)):a.toString()}function C(a){if(p.isDate(a))return u.DateOnly.fromDateJS(a);if(p.isDateTime(a))return u.DateOnly.fromParts(a.year,a.month,a.day);if(p.isDateOnly(a))return a;if(p.isTimeOnly(a))throw new d.SqlError(d.SqlErrorCodes.CannotCastValue);
if(p.isTimestampOffset(a)&&null===u.DateOnly.fromParts(a.year,a.month,a.day))throw new d.SqlError(d.SqlErrorCodes.CannotCastValue);if(g(a)&&(a=u.DateOnly.fromReader(a),null!==a&&a.isValid))return a;throw new d.SqlError(d.SqlErrorCodes.CannotCastValue);}function B(a,q,y){if(p.isDate(a))return p.convertToExecutingTimeZone(a,q);if(p.isDateTime(a))return a;if(p.isDateOnly(a))return a.toDateTimeLuxon("unknown");if(p.isTimeOnly(a))throw new d.SqlError(d.SqlErrorCodes.CannotCastValue);if(p.isTimestampOffset(a))return a;
if(g(a))return p.parseTimestamp(a,"unknown",y);throw new d.SqlError(d.SqlErrorCodes.CannotCastValue);}function r(a){if(p.isDate(a))return f.TimeOnly.fromDateJS(a);if(p.isDateTime(a))return f.TimeOnly.fromDateTime(a);if(p.isDateOnly(a))throw new d.SqlError(d.SqlErrorCodes.CannotCastValue);if(p.isTimeOnly(a))return a;if(p.isTimestampOffset(a))return f.TimeOnly.fromSqlTimeStampOffset(a);if(g(a))return p.parseTime(a);throw new d.SqlError(d.SqlErrorCodes.CannotCastValue);}const l={extract:{minParams:2,
maxParams:2,evaluate:([a,q])=>{if(null==q)return null;if(p.isDate(q))switch(a.toUpperCase()){case "SECOND":return q.getSeconds();case "MINUTE":return q.getMinutes();case "HOUR":return q.getHours();case "DAY":return q.getDate();case "MONTH":return q.getMonth()+1;case "YEAR":return q.getFullYear();case "TIMEZONE_HOUR":return 0;case "TIMEZONE_MINUTE":return 0}else if(p.isDateTime(q))switch(a.toUpperCase()){case "SECOND":return q.second;case "MINUTE":return q.minute;case "HOUR":return q.hour;case "DAY":return q.day;
case "MONTH":return q.month;case "YEAR":return q.year}else if(p.isDateOnly(q))switch(a.toUpperCase()){case "DAY":return q.day;case "MONTH":return q.month;case "YEAR":return q.year}else if(p.isTimeOnly(q))switch(a.toUpperCase()){case "SECOND":return q.second;case "MINUTE":return q.minute;case "HOUR":return q.hour}else if(p.isTimestampOffset(q))switch(a.toUpperCase()){case "SECOND":return q.second;case "MINUTE":return q.minute;case "HOUR":return q.hour;case "DAY":return q.day;case "MONTH":return q.month;
case "YEAR":return q.year;case "TIMEZONE_HOUR":return q.timezoneOffsetHour;case "TIMEZONE_MINUTE":return q.timezoneOffsetMinutes}throw new d.SqlError(d.SqlErrorCodes.InvalidFunctionParameters,{function:"EXTRACT"});}},substring:{minParams:2,maxParams:3,evaluate:a=>{if(2===a.length){const [q,y]=a;return null==q||null==y?null:q.toString().substring(y-1)}if(3===a.length){const [q,y,F]=a;return null==q||null==y||null==F?null:0>=F?"":q.toString().substring(y-1,y+F-1)}}},position:{minParams:2,maxParams:2,
evaluate:([a,q])=>null==a||null==q?null:q.indexOf(a)+1},trim:{minParams:2,maxParams:3,evaluate:a=>{var q=3===a.length,y=q?a[1]:" ";q=q?a[2]:a[1];if(null==y||null==q)return null;y=`(${A.escapeRegExpString(y)})`;switch(a[0]){case "BOTH":return q.replaceAll(new RegExp(`^${y}*|${y}*$`,"g"),"");case "LEADING":return q.replaceAll(new RegExp(`^${y}*`,"g"),"");case "TRAILING":return q.replaceAll(new RegExp(`${y}*$`,"g"),"")}throw new d.SqlError(d.SqlErrorCodes.InvalidFunctionParameters,{function:"TRIM"});
}},abs:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.abs(a[0])},ceiling:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.ceil(a[0])},floor:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.floor(a[0])},log:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.log(a[0])},log10:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.log(a[0])*Math.LOG10E},sin:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.sin(a[0])},cos:{minParams:1,maxParams:1,evaluate:a=>
null==a[0]?null:Math.cos(a[0])},tan:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.tan(a[0])},asin:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.asin(a[0])},acos:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.acos(a[0])},atan:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.atan(a[0])},sign:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:0<a[0]?1:0>a[1]?-1:0},power:{minParams:2,maxParams:2,evaluate:a=>null==a[0]||null==a[1]?null:a[0]**a[1]},mod:{minParams:2,
maxParams:2,evaluate:a=>null==a[0]||null==a[1]?null:a[0]%a[1]},round:{minParams:1,maxParams:2,evaluate:a=>{const q=a[0];a=2===a.length?10**a[1]:1;return null==q?null:Math.round(q*a)/a}},truncate:{minParams:1,maxParams:2,evaluate:a=>null==a[0]?null:1===a.length?parseInt(a[0].toFixed(0),10):parseFloat(a[0].toFixed(a[1]))},char_length:{minParams:1,maxParams:1,evaluate:a=>g(a[0])?a[0].length:0},concat:{minParams:1,maxParams:Infinity,evaluate:a=>{let q="";for(let y=0;y<a.length;y++){if(null==a[y])return null;
q+=a[y].toString()}return q}},lower:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:a[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:a[0].toString().toUpperCase()},coalesce:{minParams:1,maxParams:Infinity,evaluate:a=>{for(const q of a)if(null!==q)return q;return null}},cosh:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.cosh(a[0])},sinh:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.sinh(a[0])},tanh:{minParams:1,maxParams:1,evaluate:a=>
null==a[0]?null:Math.tanh(a[0])},nullif:{minParams:2,maxParams:2,evaluate:(a,q)=>I.sqlCompare(a[0],a[1],"\x3d")?null:a[0]},cast:{minParams:2,maxParams:2,evaluate:(a,q)=>{const y=a[0];a=a[1];if(null===y)return null;switch(a.type){case "integer":if(!t(y))throw new d.SqlError(d.SqlErrorCodes.CannotCastValue);q=parseInt(y,10);if(isNaN(q))throw new d.SqlError(d.SqlErrorCodes.CannotCastValue);return q;case "smallint":if(!t(y))throw new d.SqlError(d.SqlErrorCodes.CannotCastValue);q=parseInt(y,10);if(isNaN(q))throw new d.SqlError(d.SqlErrorCodes.CannotCastValue);
if(32767<q||-32767>q)throw new d.SqlError(d.SqlErrorCodes.CannotCastValue);return q;case "float":case "real":if(!t(y))throw new d.SqlError(d.SqlErrorCodes.CannotCastValue);q=parseFloat(y);if(isNaN(q))throw new d.SqlError(d.SqlErrorCodes.CannotCastValue);return q;case "time":return r(y);case "date":return C(y);case "timestamp":return B(y,q,!0===a.withtimezone);case "varchar":q=w(y);if(q.length>a.size)throw new d.SqlError(d.SqlErrorCodes.CannotCastValue);return q;default:throw new d.SqlError(d.SqlErrorCodes.InvalidDataType);
}}}};b.evaluateFunction=function(a,q,y){const F=l[a.toLowerCase()];if(null==F)throw new d.SqlError(d.SqlErrorCodes.FunctionNotRecognized);if(q.length<F.minParams||q.length>F.maxParams)throw new d.SqlError(d.SqlErrorCodes.InvalidParameterCount,{name:a.toUpperCase()});return F.evaluate(q,y)};b.isStandardized=function(a,q){a=l[a.toLowerCase()];return null!=a&&q>=a.minParams&&q<=a.maxParams};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/sqlCompareUtils":function(){define("exports ../../arcade/featureset/support/errorsupport ./sqlDateParsingUtils ./SqlTimestampOffset ./UnknownTimeZone ../../chunks/datetime".split(" "),
function(b,d,A,u,I,p){function f(a){return A.isDateTime(a)||A.isTimestampOffset(a)?!0:!1}function v(a){return A.isDateTime(a)||A.isDateOnly(a)||A.isTimestampOffset(a)||A.isTimeOnly(a)?!0:!1}function g(a){if(A.isDateTime(a))return a.toMillis();if(A.isDateOnly(a))return a.toNumber();if(A.isTimestampOffset(a))return a.toMilliseconds();throw new d.SqlError(d.SqlErrorCodes.InvalidDataType);}function t(a,q,y){switch(y){case "\x3c\x3e":return a!==q;case "\x3d":return a===q;case "\x3e":return a>q;case "\x3c":return a<
q;case "\x3e\x3d":return a>=q;case "\x3c\x3d":return a<=q}}function w(a,q,y){const F=parseFloat(q);if(!isNaN(F))return t(a,F,y);a=a.toString();switch(y){case "\x3c\x3e":return a!==q;case "\x3d":return a===q;case "\x3e":return a>q;case "\x3c":return a<q;case "\x3e\x3d":return a>=q;case "\x3c\x3d":return a<=q}}function C(a,q,y){const F=parseFloat(a);if(!isNaN(F))return t(F,q,y);q=q.toString();switch(y){case "\x3c\x3e":return a!==q;case "\x3d":return a===q;case "\x3e":return a>q;case "\x3c":return a<
q;case "\x3e\x3d":return a>=q;case "\x3c\x3d":return a<=q}}function B(a,q,y){switch(y){case "\x3c\x3e":return a!==q;case "\x3d":return a===q;case "\x3e":return a>q;case "\x3c":return a<q;case "\x3e\x3d":return a>=q;case "\x3c\x3d":return a<=q}}function r(a,q,y){a instanceof u.SqlTimeStampOffset&&(a=a.toDateTime());q instanceof u.SqlTimeStampOffset&&(q=q.toDateTime());a=l(a);q=l(q);switch(y){case "\x3c\x3e":return a!==q;case "\x3d":return a===q;case "\x3e":return a>q;case "\x3c":return a<q;case "\x3e\x3d":return a>=
q;case "\x3c\x3d":return a<=q}}function l(a){return 321408E5*a.year+26784E5*a.month+864E5*a.day+36E5*a.hour+6E4*a.minute+1E3*a.second+a.millisecond}b.dateValueInMilliseconds=g;b.isDateOrTimeValue=v;b.isDateTimeComparableValue=f;b.sqlCompare=function(a,q,y,F){if(null==a||null==q)return null;if(A.isNumber(a)){if(A.isNumber(q))return t(a,q,y);if(A.isString(q))return w(a,q,y);if(v(q))throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);if(A.isDateOnly(q))throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);
}else if(A.isString(a)){if(A.isNumber(q))return C(a,q,y);if(A.isString(q))return B(a,q,y);if(A.isDateTime(q))throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);if(A.isDateOnly(q))throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);if(A.isTimeOnly(q))throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);if(A.isTimestampOffset(q))throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}else if(A.isDateTime(a)){if(f(q)){if(a instanceof p.DateTime&&I.isUnknownTimeZone(a.zone)){if(q instanceof p.DateTime&&
!1===I.isUnknownTimeZone(q.zone)||q instanceof u.SqlTimeStampOffset)return r(a,q,y)}else if(q instanceof p.DateTime&&I.isUnknownTimeZone(q.zone)&&(a instanceof p.DateTime&&!1===I.isUnknownTimeZone(a.zone)||a instanceof u.SqlTimeStampOffset))return r(a,q,y);return t(g(a),g(q),y)}if(A.isString(q))throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);if(A.isDateOnly(q))return q=q.toDateTimeLuxon(a.zone),a=a.startOf("day"),t(a.toMillis(),q.toMillis(),y);if(A.isTimeOnly(q))throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);
if(A.isNumber(q))throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}else if(A.isDateOnly(a)){if(A.isTimestampOffset(q))return a=a.toDateTimeLuxon(q.toDateTime().zone),q=q.startOfDay(),t(a.toMillis(),q.toMilliseconds(),y);if(A.isDateTime(q))return a=a.toDateTimeLuxon(q.zone),q=q.startOf("day"),t(a.toMillis(),q.toMillis(),y);if(A.isString(q))throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);if(A.isDateOnly(q))return t(a.toNumber(),q.toNumber(),y);if(A.isTimeOnly(q))throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);
if(A.isNumber(q))throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}else if(A.isTimeOnly(a)){if(A.isTimeOnly(q))return t(a.toNumber(),q.toNumber(),y);if(A.isString(q))throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);if(A.isNumber(q))throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);if(A.isDateOnly(q))throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);if(f(q))throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}else if(A.isTimestampOffset(a)){if(f(q))return q instanceof p.DateTime&&
I.isUnknownTimeZone(q.zone)?r(a,q,y):t(g(a),g(q),y);if(A.isString(q))throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);if(A.isDateOnly(q))return q=q.toDateTimeLuxon(a.toDateTime().zone),a=a.startOfDay(),t(a.toMilliseconds(),q.toMillis(),y);if(A.isTimeOnly(q))throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);if(A.isNumber(q))throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}switch(y){case "\x3c\x3e":return a!==q;case "\x3d":return a===q;case "\x3e":return a>q;case "\x3c":return a<q;case "\x3e\x3d":return a>=
q;case "\x3c\x3d":return a<=q}};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/WhereGrammar":function(){define(["exports","../../chunks/_commonjsHelpers"],function(b,d){var A={exports:{}};A.exports;(function(p){(function(f,v){p.exports&&(p.exports=v())})(d.commonjsGlobal,function(){function f(g,t,w,C){g=Error.call(this,g);Object.setPrototypeOf&&Object.setPrototypeOf(g,f.prototype);g.expected=t;g.found=w;g.location=C;g.name="SyntaxError";return g}function v(g,t,w){w=
w||" ";if(g.length>t)return g;t-=g.length;w+=w.repeat(t);return g+w.slice(0,t)}(function(g,t){function w(){this.constructor=g}w.prototype=t.prototype;g.prototype=new w})(f,Error);f.prototype.format=function(g){var t="Error: "+this.message;if(this.location){var w=null,C;for(C=0;C<g.length;C++)if(g[C].source===this.location.source){w=g[C].text.split(/\r\n|\n|\r/g);break}g=this.location.start;C=this.location.source&&"function"===typeof this.location.source.offset?this.location.source.offset(g):g;var B=
this.location.source+":"+C.line+":"+C.column;if(w){var r=this.location.end,l=v("",C.line.toString().length," ");w=w[g.line-1];r=(g.line===r.line?r.column:w.length+1)-g.column||1;t+="\n --\x3e "+B+"\n"+l+" |\n"+C.line+" | "+w+"\n"+l+" | "+v("",g.column-1," ")+v("",r,"^")}else t+="\n at "+B}return t};f.buildMessage=function(g,t){function w(a){return a.charCodeAt(0).toString(16).toUpperCase()}function C(a){return a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,
"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(q){return"\\x0"+w(q)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(q){return"\\x"+w(q)})}function B(a){return a.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(q){return"\\x0"+w(q)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(q){return"\\x"+w(q)})}function r(a){return l[a.type](a)}var l={literal:function(a){return'"'+
C(a.text)+'"'},class:function(a){var q=a.parts.map(function(y){return Array.isArray(y)?B(y[0])+"-"+B(y[1]):B(y)});return"["+(a.inverted?"^":"")+q.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(a){return a.description}};return"Expected "+function(a){a=a.map(r);var q,y;a.sort();if(0<a.length){for(y=q=1;q<a.length;q++)a[q-1]!==a[q]&&(a[y]=a[q],y++);a.length=y}switch(a.length){case 1:return a[0];case 2:return a[0]+" or "+a[1];default:return a.slice(0,
-1).join(", ")+", or "+a[a.length-1]}}(g)+" but "+(t?'"'+C(t)+'"':"end of input")+" found."};return{SyntaxError:f,parse:function(g,t){function w(D,N){N=void 0!==N?N:l(qa,k);throw new f(D,null,null,N);}function C(D,N){return{type:"literal",text:D,ignoreCase:N}}function B(D,N,U){return{type:"class",parts:D,inverted:N,ignoreCase:U}}function r(D){var N=Zb[D],U;if(!N){for(U=D-1;!Zb[U];)U--;N=Zb[U];for(N={line:N.line,column:N.column};U<D;)10===g.charCodeAt(U)?(N.line++,N.column=1):N.column++,U++;Zb[D]=
N}return N}function l(D,N,U){var da=r(D),ua=r(N);D={source:Mb,start:{offset:D,line:da.line,column:da.column},end:{offset:N,line:ua.line,column:ua.column}};U&&Mb&&"function"===typeof Mb.offset&&(D.start=Mb.offset(D.start),D.end=Mb.offset(D.end));return D}function a(D){k<eb||(k>eb&&(eb=k,zc=[]),zc.push(D))}function q(){var D=k;ma();var N=F();N!==c?(ma(),qa=D,D=N):(k=D,D=c);return D}function y(){var D=k;var N=F();if(N!==c){var U=[];var da=k;var ua=ma();var Aa=Wa();if(Aa!==c){var Ga=ma();var Ha=F();Ha!==
c?da=ua=[ua,Aa,Ga,Ha]:(k=da,da=c)}else k=da,da=c;for(;da!==c;)U.push(da),da=k,ua=ma(),Aa=Wa(),Aa!==c?(Ga=ma(),Ha=F(),Ha!==c?da=ua=[ua,Aa,Ga,Ha]:(k=da,da=c)):(k=da,da=c);qa=D;D={type:"expression-list"};N=[N];for(da=0;da<U.length;da++)N.push(U[da][3]);D.value=N}else k=D,D=c;return D}function F(){var D=k;var N=Q();if(N!==c){var U=[];var da=k;var ua=ma();var Aa=K();if(Aa!==c){var Ga=ma();var Ha=Q();Ha!==c?da=ua=[ua,Aa,Ga,Ha]:(k=da,da=c)}else k=da,da=c;for(;da!==c;)U.push(da),da=k,ua=ma(),Aa=K(),Aa!==
c?(Ga=ma(),Ha=Q(),Ha!==c?da=ua=[ua,Aa,Ga,Ha]:(k=da,da=c)):(k=da,da=c);qa=D;D=nb(N,U)}else k=D,D=c;return D}function Q(){var D=k;var N=e();if(N!==c){var U=[];var da=k;var ua=ma();var Aa=G();if(Aa!==c){var Ga=ma();var Ha=e();Ha!==c?da=ua=[ua,Aa,Ga,Ha]:(k=da,da=c)}else k=da,da=c;for(;da!==c;)U.push(da),da=k,ua=ma(),Aa=G(),Aa!==c?(Ga=ma(),Ha=e(),Ha!==c?da=ua=[ua,Aa,Ga,Ha]:(k=da,da=c)):(k=da,da=c);qa=D;D=nb(N,U)}else k=D,D=c;return D}function e(){var D=k;var N=z();if(N===c){N=k;if(33===g.charCodeAt(k)){var U=
Nd;k++}else U=c,0===ha&&a(Od);if(U!==c){var da=k;ha++;if(61===g.charCodeAt(k)){var ua=Sc;k++}else ua=c,0===ha&&a(Tc);ha--;ua===c?da=void 0:(k=da,da=c);da!==c?N=U=[U,da]:(k=N,N=c)}else k=N,N=c}N!==c?(U=ma(),da=e(),da!==c?(qa=D,D={type:"unary-expression",operator:"NOT",expr:da}):(k=D,D=c)):(k=D,D=c);if(D===c){N=k;D=R();if(D!==c){ma();U=k;da=[];ua=k;var Aa=ma();var Ga=H();if(Ga!==c){var Ha=ma();var ob=R();ob!==c?ua=Aa=[Aa,Ga,Ha,ob]:(k=ua,ua=c)}else k=ua,ua=c;if(ua!==c)for(;ua!==c;)da.push(ua),ua=k,Aa=
ma(),Ga=H(),Ga!==c?(Ha=ma(),ob=R(),ob!==c?ua=Aa=[Aa,Ga,Ha,ob]:(k=ua,ua=c)):(k=ua,ua=c);else da=c;da!==c&&(qa=U,da={type:"arithmetic",tail:da});U=da;U===c&&(U=k,da=J(),da!==c?(ma(),ua=Ma(),ua!==c?(ma(),ua=y(),ua!==c?(ma(),Aa=Na(),Aa!==c?(qa=U,U={op:da,right:ua}):(k=U,U=c)):(k=U,U=c)):(k=U,U=c)):(k=U,U=c),U===c&&(U=k,da=J(),da!==c?(ma(),ua=Ma(),ua!==c?(ma(),ua=Na(),ua!==c?(qa=U,U={op:da,right:{type:"expression-list",value:[]}}):(k=U,U=c)):(k=U,U=c)):(k=U,U=c),U===c&&(U=k,da=J(),da!==c?(ma(),ua=fa(),
ua!==c?(qa=U,U={op:da,right:ua}):(k=U,U=c)):(k=U,U=c))),U===c&&(U=k,Aa=z(),Aa!==c?(ma(),da=W(),da!==c?(ma(),ua=R(),ua!==c?(ma(),Ga=G(),Ga!==c?(ma(),Aa=R(),Aa!==c?(qa=U,U={op:"NOT"+da,right:{type:"expression-list",value:[ua,Aa]}}):(k=U,U=c)):(k=U,U=c)):(k=U,U=c)):(k=U,U=c)):(k=U,U=c),U===c&&(U=k,Aa=W(),Aa!==c?(ma(),da=R(),da!==c?(ma(),ua=G(),ua!==c?(ma(),Ga=R(),Ga!==c?(qa=U,U={op:Aa,right:{type:"expression-list",value:[da,Ga]}}):(k=U,U=c)):(k=U,U=c)):(k=U,U=c)):(k=U,U=c)),U===c&&(U=k,da=aa(),da!==
c?(ma(),ua=z(),ua!==c?(ma(),ua=R(),ua!==c?(qa=U,U={op:da+"NOT",right:ua}):(k=U,U=c)):(k=U,U=c)):(k=U,U=c),U===c&&(U=k,da=aa(),da!==c?(ma(),ua=R(),ua!==c?(qa=U,U={op:da,right:ua}):(k=U,U=c)):(k=U,U=c)),U===c&&(U=k,da=S(),da!==c?(ma(),ua=ra(),ua!==c?(ma(),Aa=k,g.substr(k,6).toLowerCase()===Pd?(Ga=g.substr(k,6),k+=6):(Ga=c,0===ha&&a(Qd)),Ga!==c?(Ga=k,ha++,Ha=M(),ha--,Ha===c?Ga=void 0:(k=Ga,Ga=c),Ga!==c?(qa=Aa,Aa="ESCAPE"):(k=Aa,Aa=c)):(k=Aa,Aa=c),Aa!==c?(ma(),Aa=pa(),Aa!==c?(qa=U,U={op:da,right:ua,escape:Aa.value}):
(k=U,U=c)):(k=U,U=c)):(k=U,U=c)):(k=U,U=c),U===c&&(U=k,da=S(),da!==c?(ma(),ua=ra(),ua!==c?(qa=U,U={op:da,right:ua,escape:""}):(k=U,U=c)):(k=U,U=c))))));U===c&&(U=null);qa=N;N=U;""==N||void 0==N||null==N?N=D:(U=null,N=U="arithmetic"==N.type?nb(D,N.tail):Nb(N.op,D,N.right,N.escape))}else k=N,N=c;D=N}return D}function H(){if(g.substr(k,2)===Uc){var D=Uc;k+=2}else D=c,0===ha&&a(Rd);D===c&&(62===g.charCodeAt(k)?(D=Sd,k++):(D=c,0===ha&&a(Td)),D===c&&(g.substr(k,2)===Vc?(D=Vc,k+=2):(D=c,0===ha&&a(Ud)),D===
c&&(g.substr(k,2)===Wc?(D=Wc,k+=2):(D=c,0===ha&&a(Vd)),D===c&&(60===g.charCodeAt(k)?(D=Wd,k++):(D=c,0===ha&&a(Xd)),D===c&&(61===g.charCodeAt(k)?(D=Sc,k++):(D=c,0===ha&&a(Tc)),D===c&&(g.substr(k,2)===Xc?(D=Xc,k+=2):(D=c,0===ha&&a(Yd))))))));return D}function S(){var D;var N=D=k;var U=z();if(U!==c){var da=ma();var ua=ja();ua!==c?N=U=[U,da,ua]:(k=N,N=c)}else k=N,N=c;N!==c&&(qa=D,N=N[0]+" "+N[2]);D=N;D===c&&(D=ja());return D}function J(){var D;var N=D=k;var U=z();if(U!==c){var da=ma();var ua=X();ua!==
c?N=U=[U,da,ua]:(k=N,N=c)}else k=N,N=c;N!==c&&(qa=D,N=N[0]+" "+N[2]);D=N;D===c&&(D=X());return D}function R(){var D=k;var N=V();if(N!==c){var U=[];var da=k;var ua=ma();var Aa=P();if(Aa!==c){var Ga=ma();var Ha=V();Ha!==c?da=ua=[ua,Aa,Ga,Ha]:(k=da,da=c)}else k=da,da=c;for(;da!==c;)U.push(da),da=k,ua=ma(),Aa=P(),Aa!==c?(Ga=ma(),Ha=V(),Ha!==c?da=ua=[ua,Aa,Ga,Ha]:(k=da,da=c)):(k=da,da=c);qa=D;D=nb(N,U)}else k=D,D=c;return D}function P(){if(43===g.charCodeAt(k)){var D=Ac;k++}else D=c,0===ha&&a(Bc);D===
c&&(45===g.charCodeAt(k)?(D=Cc,k++):(D=c,0===ha&&a(Dc)),D===c&&(g.substr(k,2)===Yc?(D=Yc,k+=2):(D=c,0===ha&&a(Zd))));return D}function V(){var D=k;var N=O();if(N!==c){var U=[];var da=k;var ua=ma();var Aa=m();if(Aa!==c){var Ga=ma();var Ha=O();Ha!==c?da=ua=[ua,Aa,Ga,Ha]:(k=da,da=c)}else k=da,da=c;for(;da!==c;)U.push(da),da=k,ua=ma(),Aa=m(),Aa!==c?(Ga=ma(),Ha=O(),Ha!==c?da=ua=[ua,Aa,Ga,Ha]:(k=da,da=c)):(k=da,da=c);qa=D;D=nb(N,U)}else k=D,D=c;return D}function m(){if(42===g.charCodeAt(k)){var D=$d;k++}else D=
c,0===ha&&a(ae);D===c&&(47===g.charCodeAt(k)?(D=be,k++):(D=c,0===ha&&a(ce)));return D}function O(){var D=pa();if(D===c){var N=k;var U=k;var da=Fa();if(da!==c){var ua=La();if(ua!==c){var Aa=Ta();Aa!==c?(qa=U,U=parseFloat(da+ua+Aa)):(k=U,U=c)}else k=U,U=c}else k=U,U=c;U===c&&(U=k,da=Fa(),da!==c?(ua=La(),ua!==c?(qa=U,U=parseFloat(da+ua)):(k=U,U=c)):(k=U,U=c),U===c&&(U=k,da=Fa(),da!==c?(ua=Ta(),ua!==c?(qa=U,U=parseFloat(da+ua)):(k=U,U=c)):(k=U,U=c),U===c&&(U=k,da=Fa(),da!==c&&(qa=U,da=parseFloat(da)),
U=da)));var Ga=U;if(Ga!==c){var Ha=k;ha++;var ob=x();ha--;ob===c?Ha=void 0:(k=Ha,Ha=c);Ha!==c?(qa=N,N={type:"number",value:Ga}):(k=N,N=c)}else k=N,N=c;D=N;if(D===c){var pb=k;var Jb=k;if(g.substr(k,4).toLowerCase()===de){var $b=g.substr(k,4);k+=4}else $b=c,0===ha&&a(ee);if($b!==c){var Ob=k;ha++;var fe=M();ha--;fe===c?Ob=void 0:(k=Ob,Ob=c);Ob!==c?Jb=$b=[$b,Ob]:(k=Jb,Jb=c)}else k=Jb,Jb=c;var qb=Jb;qb!==c&&(qa=pb,qb={type:"boolean",value:!0});pb=qb;if(pb===c){pb=k;var Kb=k;if(g.substr(k,5).toLowerCase()===
ge){var ac=g.substr(k,5);k+=5}else ac=c,0===ha&&a(he);if(ac!==c){var Pb=k;ha++;var ie=M();ha--;ie===c?Pb=void 0:(k=Pb,Pb=c);Pb!==c?Kb=ac=[ac,Pb]:(k=Kb,Kb=c)}else k=Kb,Kb=c;qb=Kb;qb!==c&&(qa=pb,qb={type:"boolean",value:!1});pb=qb}D=pb;if(D===c){var je=k;var Lb=k;if(g.substr(k,4).toLowerCase()===ke){var bc=g.substr(k,4);k+=4}else bc=c,0===ha&&a(le);if(bc!==c){var Qb=k;ha++;var me=M();ha--;me===c?Qb=void 0:(k=Qb,Qb=c);Qb!==c?Lb=bc=[bc,Qb]:(k=Lb,Lb=c)}else k=Lb,Lb=c;var Ec=Lb;Ec!==c&&(qa=je,Ec={type:"null",
value:null});D=Ec;if(D===c){var rb=k;if(la()!==c){ma();var cc=ra();cc!==c?(qa=rb,"string"===cc.type&&!0!==/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(cc.value)&&w("Date literal is invalid"),rb={type:"date",
value:cc.value}):(k=rb,rb=c)}else k=rb,rb=c;D=rb;if(D===c){var sb=k;if(ea()!==c){ma();var dc=ra();dc!==c?(qa=sb,"string"===dc.type&&!0!==/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(dc.value)&&w("Timestamp literal is invalid"),
sb={type:"timestamp",value:dc.value}):(k=sb,sb=c)}else k=sb,sb=c;D=sb;if(D===c){var Ua=k;var Fc=wa();if(Fc!==c){ma();if(45===g.charCodeAt(k)){var hb=Cc;k++}else hb=c,0===ha&&a(Dc);hb===c&&(43===g.charCodeAt(k)?(hb=Ac,k++):(hb=c,0===ha&&a(Bc)));if(hb!==c){ma();var Rb=ra();if(Rb!==c){ma();var Zc=sa();Zc!==c?(qa=Ua,Ua={type:"interval",value:Rb,qualifier:Zc,op:hb}):(k=Ua,Ua=c)}else k=Ua,Ua=c}else k=Ua,Ua=c}else k=Ua,Ua=c;Ua===c&&(Ua=k,Fc=wa(),Fc!==c?(ma(),hb=ra(),hb!==c?(ma(),Rb=sa(),Rb!==c?(qa=Ua,Ua=
{type:"interval",value:hb,qualifier:Rb,op:""}):(k=Ua,Ua=c)):(k=Ua,Ua=c)):(k=Ua,Ua=c));D=Ua;if(D===c){var tb=k;if(na()!==c){ma();var ec=ra();ec!==c?(qa=tb,"string"===ec.type&&!0!==/^(\d{1,2}):(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/.test(ec.value)&&w("Time literal is invalid"),tb={type:"time",value:ec.value}):(k=tb,tb=c)}else k=tb,tb=c;D=tb}}}}}}}var Oa=D;if(Oa===c){var Za=k;var ub=k;if(g.substr(k,7).toLowerCase()===ne){var $c=g.substr(k,7);k+=7}else $c=
c,0===ha&&a(oe);if($c!==c){var fc=k;ha++;var pe=M();ha--;pe===c?fc=void 0:(k=fc,fc=c);fc!==c?(qa=ub,ub="EXTRACT"):(k=ub,ub=c)}else k=ub,ub=c;if(ub!==c){ma();var qe=Ma();if(qe!==c){ma();var $a=ta();if($a===c&&($a=va(),$a===c&&($a=Ea(),$a===c&&($a=ya(),$a===c&&($a=Da(),$a===c&&($a=Ca(),$a===c)))))){var vb=k;if(g.substr(k,13).toLowerCase()===re){var ad=g.substr(k,13);k+=13}else ad=c,0===ha&&a(se);if(ad!==c){var gc=k;ha++;var te=M();ha--;te===c?gc=void 0:(k=gc,gc=c);gc!==c?(qa=vb,vb="TIMEZONE_HOUR"):
(k=vb,vb=c)}else k=vb,vb=c;$a=vb;if($a===c){var wb=k;if(g.substr(k,15).toLowerCase()===ue){var bd=g.substr(k,15);k+=15}else bd=c,0===ha&&a(ve);if(bd!==c){var hc=k;ha++;var we=M();ha--;we===c?hc=void 0:(k=hc,hc=c);hc!==c?(qa=wb,wb="TIMEZONE_MINUTE"):(k=wb,wb=c)}else k=wb,wb=c;$a=wb}}var cd=$a;if(cd!==c){ma();var xe=Z();if(xe!==c){ma();var dd=F();if(dd!==c){ma();var ye=Na();ye!==c?(qa=Za,Za={type:"function",name:"extract",args:{type:"expression-list",value:[{type:"string",value:cd},dd]}}):(k=Za,Za=
c)}else k=Za,Za=c}else k=Za,Za=c}else k=Za,Za=c}else k=Za,Za=c}else k=Za,Za=c;Oa=Za;if(Oa===c){var ab=k;var xb=k;if(g.substr(k,9).toLowerCase()===ze){var ed=g.substr(k,9);k+=9}else ed=c,0===ha&&a(Ae);if(ed!==c){var ic=k;ha++;var Be=M();ha--;Be===c?ic=void 0:(k=ic,ic=c);ic!==c?(qa=xb,xb="SUBSTRING"):(k=xb,xb=c)}else k=xb,xb=c;if(xb!==c){ma();var Ce=Ma();if(Ce!==c){ma();var Gc=F();if(Gc!==c){ma();var De=Z();if(De!==c){ma();var Hc=F();if(Hc!==c){ma();var ib=k;var yb=k;if(g.substr(k,3).toLowerCase()===
Ee){var fd=g.substr(k,3);k+=3}else fd=c,0===ha&&a(Fe);if(fd!==c){var jc=k;ha++;var Ge=M();ha--;Ge===c?jc=void 0:(k=jc,jc=c);jc!==c?(qa=yb,yb="FOR"):(k=yb,yb=c)}else k=yb,yb=c;var Sb=yb;if(Sb!==c){var He=ma();var gd=F();if(gd!==c){var Ie=ma();ib=Sb=[Sb,He,gd,Ie]}else k=ib,ib=c}else k=ib,ib=c;ib===c&&(ib=null);Sb=Na();Sb!==c?(qa=ab,ab={type:"function",name:"substring",args:{type:"expression-list",value:ib?[Gc,Hc,ib[2]]:[Gc,Hc]}}):(k=ab,ab=c)}else k=ab,ab=c}else k=ab,ab=c}else k=ab,ab=c}else k=ab,ab=
c}else k=ab,ab=c;Oa=ab;if(Oa===c){var Qa=k;var Ic=ba();if(Ic!==c){ma();var Jc=Ma();if(Jc!==c){ma();var jb=oa();jb===c&&(jb=null);ma();var Tb=F();if(Tb!==c){ma();var Kc=Z();if(Kc!==c){ma();var hd=F();if(hd!==c){ma();var Je=Na();Je!==c?(qa=Qa,Qa={type:"function",name:"trim",args:{type:"expression-list",value:[{type:"string",value:null==jb?"BOTH":jb},Tb,hd]}}):(k=Qa,Qa=c)}else k=Qa,Qa=c}else k=Qa,Qa=c}else k=Qa,Qa=c}else k=Qa,Qa=c}else k=Qa,Qa=c;Qa===c&&(Qa=k,Ic=ba(),Ic!==c?(ma(),Jc=Ma(),Jc!==c?(ma(),
jb=oa(),jb===c&&(jb=null),ma(),Tb=F(),Tb!==c?(ma(),Kc=Na(),Kc!==c?(qa=Qa,Qa={type:"function",name:"trim",args:{type:"expression-list",value:[{type:"string",value:null==jb?"BOTH":jb},Tb]}}):(k=Qa,Qa=c)):(k=Qa,Qa=c)):(k=Qa,Qa=c)):(k=Qa,Qa=c));Oa=Qa;if(Oa===c){var bb=k;var zb=k;if(g.substr(k,8).toLowerCase()===Ke){var id=g.substr(k,8);k+=8}else id=c,0===ha&&a(Le);if(id!==c){var kc=k;ha++;var Me=M();ha--;Me===c?kc=void 0:(k=kc,kc=c);kc!==c?(qa=zb,zb="POSITION"):(k=zb,zb=c)}else k=zb,zb=c;if(zb!==c){ma();
var Ne=Ma();if(Ne!==c){ma();var jd=F();if(jd!==c){ma();var Oe=X();if(Oe!==c){ma();var kd=F();if(kd!==c){ma();var Pe=Na();Pe!==c?(qa=bb,bb={type:"function",name:"position",args:{type:"expression-list",value:[jd,kd]}}):(k=bb,bb=c)}else k=bb,bb=c}else k=bb,bb=c}else k=bb,bb=c}else k=bb,bb=c}else k=bb,bb=c;Oa=bb;if(Oa===c){var cb=k;var Ab=k;if(g.substr(k,4).toLowerCase()===Qe){var ld=g.substr(k,4);k+=4}else ld=c,0===ha&&a(Re);if(ld!==c){var lc=k;ha++;var Se=M();ha--;Se===c?lc=void 0:(k=lc,lc=c);lc!==
c?(qa=Ab,Ab="CAST"):(k=Ab,Ab=c)}else k=Ab,Ab=c;if(Ab!==c){ma();var Te=Ma();if(Te!==c){ma();var md=F();if(md!==c){ma();var Bb=k;if(g.substr(k,2).toLowerCase()===Ue){var nd=g.substr(k,2);k+=2}else nd=c,0===ha&&a(Ve);if(nd!==c){var mc=k;ha++;var We=M();ha--;We===c?mc=void 0:(k=mc,mc=c);mc!==c?(qa=Bb,Bb="AS"):(k=Bb,Bb=c)}else k=Bb,Bb=c;var Xe=Bb;if(Xe!==c){ma();var Ia=k;var Cb=k;if(g.substr(k,7).toLowerCase()===Ye){var od=g.substr(k,7);k+=7}else od=c,0===ha&&a(Ze);if(od!==c){var nc=k;ha++;var $e=M();
ha--;$e===c?nc=void 0:(k=nc,nc=c);nc!==c?(qa=Cb,Cb="INTEGER"):(k=Cb,Cb=c)}else k=Cb,Cb=c;var Pa=Cb;Pa!==c&&(qa=Ia,Pa={type:"data-type",value:{type:"integer"}});Ia=Pa;if(Ia===c){Ia=k;var Db=k;if(g.substr(k,8).toLowerCase()===af){var pd=g.substr(k,8);k+=8}else pd=c,0===ha&&a(bf);if(pd!==c){var oc=k;ha++;var cf=M();ha--;cf===c?oc=void 0:(k=oc,oc=c);oc!==c?(qa=Db,Db="SMALLINT"):(k=Db,Db=c)}else k=Db,Db=c;Pa=Db;Pa!==c&&(qa=Ia,Pa={type:"data-type",value:{type:"smallint"}});Ia=Pa;if(Ia===c){Ia=k;var Eb=
k;if(g.substr(k,5).toLowerCase()===df){var qd=g.substr(k,5);k+=5}else qd=c,0===ha&&a(ef);if(qd!==c){var pc=k;ha++;var ff=M();ha--;ff===c?pc=void 0:(k=pc,pc=c);pc!==c?(qa=Eb,Eb="FLOAT"):(k=Eb,Eb=c)}else k=Eb,Eb=c;Pa=Eb;Pa!==c&&(qa=Ia,Pa={type:"data-type",value:{type:"float"}});Ia=Pa;if(Ia===c){Ia=k;var Fb=k;if(g.substr(k,4).toLowerCase()===gf){var rd=g.substr(k,4);k+=4}else rd=c,0===ha&&a(hf);if(rd!==c){var qc=k;ha++;var jf=M();ha--;jf===c?qc=void 0:(k=qc,qc=c);qc!==c?(qa=Fb,Fb="REAL"):(k=Fb,Fb=c)}else k=
Fb,Fb=c;Pa=Fb;Pa!==c&&(qa=Ia,Pa={type:"data-type",value:{type:"real"}});Ia=Pa;if(Ia===c&&(Ia=k,Pa=la(),Pa!==c&&(qa=Ia,Pa={type:"data-type",value:{type:"date"}}),Ia=Pa,Ia===c&&(Ia=k,Pa=ea(),Pa!==c&&(qa=Ia,Pa={type:"data-type",value:{type:"timestamp"}}),Ia=Pa,Ia===c&&(Ia=k,Pa=na(),Pa!==c&&(qa=Ia,Pa={type:"data-type",value:{type:"time"}}),Ia=Pa,Ia===c)))){Ia=k;var Gb=k;if(g.substr(k,7).toLowerCase()===kf){var sd=g.substr(k,7);k+=7}else sd=c,0===ha&&a(lf);if(sd!==c){var rc=k;ha++;var mf=M();ha--;mf===
c?rc=void 0:(k=rc,rc=c);rc!==c?(qa=Gb,Gb="VARCHAR"):(k=Gb,Gb=c)}else k=Gb,Gb=c;Pa=Gb;if(Pa!==c){ma();var nf=Ma();if(nf!==c){ma();var td=h();if(td!==c){ma();var of=Na();of!==c?(qa=Ia,Ia={type:"data-type",value:{type:"varchar",size:parseInt(td)}}):(k=Ia,Ia=c)}else k=Ia,Ia=c}else k=Ia,Ia=c}else k=Ia,Ia=c}}}}var ud=Ia;if(ud!==c){ma();var pf=Na();pf!==c?(qa=cb,cb={type:"function",name:"cast",args:{type:"expression-list",value:[md,ud]}}):(k=cb,cb=c)}else k=cb,cb=c}else k=cb,cb=c}else k=cb,cb=c}else k=cb,
cb=c}else k=cb,cb=c;Oa=cb;if(Oa===c){var kb=k;var db=k;var Ub=n();Ub!==c&&(qa=db);db=Ub;if(db===c)if(db=k,96===g.charCodeAt(k)?(Ub=vd,k++):(Ub=c,0===ha&&a(wd)),Ub!==c){var sc=[];if(xd.test(g.charAt(k))){var lb=g.charAt(k);k++}else lb=c,0===ha&&a(yd);if(lb!==c)for(;lb!==c;)sc.push(lb),xd.test(g.charAt(k))?(lb=g.charAt(k),k++):(lb=c,0===ha&&a(yd));else sc=c;sc!==c?(96===g.charCodeAt(k)?(lb=vd,k++):(lb=c,0===ha&&a(wd)),lb!==c?(qa=db,db=sc.join("")):(k=db,db=c)):(k=db,db=c)}else k=db,db=c;var zd=db;if(zd!==
c){ma();var qf=Ma();if(qf!==c){ma();var tc=y();tc===c&&(tc=null);ma();var rf=Na();rf!==c?(qa=kb,kb={type:"function",name:zd,args:tc?tc:{type:"expression-list",value:[]}}):(k=kb,kb=c)}else k=kb,kb=c}else k=kb,kb=c;Oa=kb;if(Oa===c){var fb;var Va=k;var Lc=za();if(Lc!==c){ma();var Vb=F();if(Vb!==c){ma();var Wb=[];for(fb=Ba();fb!==c;)Wb.push(fb),fb=Ba();fb=ma();var uc=Ja();uc!==c?(qa=Va,Va={type:"case-expression",format:"simple",operand:Vb,clauses:Wb,else:null}):(k=Va,Va=c)}else k=Va,Va=c}else k=Va,Va=
c;if(Va===c)if(Va=k,Lc=za(),Lc!==c)if(ma(),Vb=F(),Vb!==c){ma();Wb=[];for(fb=Ba();fb!==c;)Wb.push(fb),fb=Ba();fb=ma();uc=Ka();if(uc!==c){ma();var sf=Ja();sf!==c?(qa=Va,Va={type:"case-expression",format:"simple",operand:Vb,clauses:Wb,else:uc.value}):(k=Va,Va=c)}else k=Va,Va=c}else k=Va,Va=c;else k=Va,Va=c;var Mc=Va;if(Mc===c){var gb;var Xa=k;var Nc=za();if(Nc!==c){ma();var Xb=[];for(gb=xa();gb!==c;)Xb.push(gb),gb=xa();gb=ma();var vc=Ja();vc!==c?(qa=Xa,Xa={type:"case-expression",format:"searched",clauses:Xb,
else:null}):(k=Xa,Xa=c)}else k=Xa,Xa=c;if(Xa===c)if(Xa=k,Nc=za(),Nc!==c){ma();Xb=[];for(gb=xa();gb!==c;)Xb.push(gb),gb=xa();gb=ma();vc=Ka();if(vc!==c){ma();var tf=Ja();tf!==c?(qa=Xa,Xa={type:"case-expression",format:"searched",clauses:Xb,else:vc.value}):(k=Xa,Xa=c)}else k=Xa,Xa=c}else k=Xa,Xa=c;Mc=Xa}Oa=Mc;if(Oa===c){var Hb=k;var uf=k;var wc;var Yb=k;var Ad=x();if(Ad!==c){var Bd=[];for(wc=L();wc!==c;)Bd.push(wc),wc=L();qa=Yb;Yb=Ad+Bd.join("")}else k=Yb,Yb=c;var Cd=Yb;Cd!==c&&(qa=uf);var mb=Cd;if(mb!==
c){qa=Hb;var Oc=mb;mb=/^CURRENT_DATE$/i.test(Oc)?{type:"current-time",mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(Oc)?{type:"current-time",mode:"timestamp"}:{type:"column-reference",table:"",column:Oc}}Hb=mb;if(Hb===c){Hb=k;var Ib=k;if(Y()!==c){var xc;var vf=k;var Pc=[];for(xc=T();xc!==c;)Pc.push(xc),xc=T();qa=vf;var wf=Pc=Pc.join("");var xf=Y();xf!==c?(qa=Ib,Ib=wf):(k=Ib,Ib=c)}else k=Ib,Ib=c;mb=Ib;mb!==c&&(qa=Hb,mb={type:"column-reference",table:"",column:mb,delimited:!0});Hb=mb}Oa=Hb;if(Oa===c&&(Oa=
fa(),Oa===c)){Oa=k;var yf=Ma();if(yf!==c){ma();var Qc=F();if(Qc!==c){ma();var zf=Na();zf!==c?(qa=Oa,Qc.paren=!0,Oa=Qc):(k=Oa,Oa=c)}else k=Oa,Oa=c}else k=Oa,Oa=c}}}}}}}}}return Oa}function n(){var D;var N=k;var U=x();if(U!==c){var da=[];for(D=M();D!==c;)da.push(D),D=M();qa=N;N=U+da.join("")}else k=N,N=c;return N}function x(){if(Af.test(g.charAt(k))){var D=g.charAt(k);k++}else D=c,0===ha&&a(Bf);return D}function M(){if(Cf.test(g.charAt(k))){var D=g.charAt(k);k++}else D=c,0===ha&&a(Df);return D}function L(){if(Dd.test(g.charAt(k))){var D=
g.charAt(k);k++}else D=c,0===ha&&a(Ed);return D}function T(){if(Dd.test(g.charAt(k))){var D=g.charAt(k);k++}else D=c,0===ha&&a(Ed);if(D===c)if(D=k,Y()!==c){var N=Y();N!==c?(qa=D,D='"'):(k=D,D=c)}else k=D,D=c;return D}function Y(){if(Ef.test(g.charAt(k))){var D=g.charAt(k);k++}else D=c,0===ha&&a(Ff);return D}function fa(){var D;var N=D=k;if(64===g.charCodeAt(k)){var U=Gf;k++}else U=c,0===ha&&a(Hf);if(U!==c){var da=n();da!==c?N=U=[U,da]:(k=N,N=c)}else k=N,N=c;N!==c&&(qa=D,N={type:"parameter",value:N[1]});
return N}function oa(){var D=k;if(g.substr(k,7).toLowerCase()===If){var N=g.substr(k,7);k+=7}else N=c,0===ha&&a(Jf);if(N!==c){N=k;ha++;var U=M();ha--;U===c?N=void 0:(k=N,N=c);N!==c?(qa=D,D="LEADING"):(k=D,D=c)}else k=D,D=c;D===c&&(D=k,g.substr(k,8).toLowerCase()===Kf?(N=g.substr(k,8),k+=8):(N=c,0===ha&&a(Lf)),N!==c?(N=k,ha++,U=M(),ha--,U===c?N=void 0:(k=N,N=c),N!==c?(qa=D,D="TRAILING"):(k=D,D=c)):(k=D,D=c),D===c&&(D=k,g.substr(k,4).toLowerCase()===Mf?(N=g.substr(k,4),k+=4):(N=c,0===ha&&a(Nf)),N!==
c?(N=k,ha++,U=M(),ha--,U===c?N=void 0:(k=N,N=c),N!==c?(qa=D,D="BOTH"):(k=D,D=c)):(k=D,D=c)));return D}function sa(){var D=k;var N=k;var U=ca();if(U!==c){ma();var da=Ma();if(da!==c)if(ma(),da=ia(),da!==c){ma();var ua=Na();ua!==c?(qa=N,N={type:"interval-period",period:U.value,precision:da,secondary:null}):(k=N,N=c)}else k=N,N=c;else k=N,N=c}else k=N,N=c;N===c&&(N=k,U=ca(),U!==c&&(qa=N,U={type:"interval-period",period:U.value,precision:null,secondary:null}),N=U);if(N!==c)if(ma(),U=k,g.substr(k,2).toLowerCase()===
Of?(da=g.substr(k,2),k+=2):(da=c,0===ha&&a(Pf)),da!==c?(da=k,ha++,ua=M(),ha--,ua===c?da=void 0:(k=da,da=c),da!==c?(qa=U,U="TO"):(k=U,U=c)):(k=U,U=c),U!==c){ma();U=k;da=ca();da!==c&&(qa=U,da={type:"interval-period",period:da.value,precision:null,secondary:null});U=da;if(U===c){U=k;da=Ca();if(da!==c)if(ma(),da=Ma(),da!==c)if(ma(),da=ia(),da!==c)if(ma(),ua=Wa(),ua!==c)if(ma(),ua=ka(),ua!==c){ma();var Aa=Na();Aa!==c?(qa=U,U={type:"interval-period",period:"second",precision:da,secondary:ua}):(k=U,U=c)}else k=
U,U=c;else k=U,U=c;else k=U,U=c;else k=U,U=c;else k=U,U=c;U===c&&(U=k,da=Ca(),da!==c?(ma(),da=Ma(),da!==c?(ma(),da=ia(),da!==c?(ma(),ua=Na(),ua!==c?(qa=U,U={type:"interval-period",period:"second",precision:da,secondary:null}):(k=U,U=c)):(k=U,U=c)):(k=U,U=c)):(k=U,U=c),U===c&&(U=k,da=Ca(),da!==c&&(qa=U,da={type:"interval-period",period:"second",precision:null,secondary:null}),U=da))}U!==c?(qa=D,D={type:"interval-qualifier",start:N,end:U}):(k=D,D=c)}else k=D,D=c;else k=D,D=c;D===c&&(D=k,U=ca(),U!==
c?(ma(),N=Ma(),N!==c?(ma(),N=ka(),N!==c?(ma(),da=Na(),da!==c?(qa=D,D={type:"interval-period",period:U.value,precision:N,secondary:null}):(k=D,D=c)):(k=D,D=c)):(k=D,D=c)):(k=D,D=c),D===c&&(D=k,U=ca(),U!==c&&(qa=D,U={type:"interval-period",period:U.value,precision:null,secondary:null}),D=U,D===c&&(D=k,U=Ca(),U!==c?(ma(),N=Ma(),N!==c?(ma(),N=ia(),N!==c?(ma(),da=Wa(),da!==c?(ma(),U=ka(),U!==c?(ma(),da=Na(),da!==c?(qa=D,D={type:"interval-period",period:"second",precision:N,secondary:U}):(k=D,D=c)):(k=
D,D=c)):(k=D,D=c)):(k=D,D=c)):(k=D,D=c)):(k=D,D=c),D===c&&(D=k,U=Ca(),U!==c?(ma(),N=Ma(),N!==c?(ma(),N=ka(),N!==c?(ma(),da=Na(),da!==c?(qa=D,D={type:"interval-period",period:"second",precision:N,secondary:null}):(k=D,D=c)):(k=D,D=c)):(k=D,D=c)):(k=D,D=c),D===c&&(D=k,U=Ca(),U!==c&&(qa=D,U={type:"interval-period",period:"second",precision:null,secondary:null}),D=U)))));return D}function ca(){var D=k;var N=Ea();N!==c&&(qa=D,N={type:"string",value:"day"});D=N;D===c&&(D=k,N=ya(),N!==c&&(qa=D,N={type:"string",
value:"hour"}),D=N,D===c&&(D=k,N=Da(),N!==c&&(qa=D,N={type:"string",value:"minute"}),D=N,D===c&&(D=k,N=va(),N!==c&&(qa=D,N={type:"string",value:"month"}),D=N,D===c&&(D=k,N=ta(),N!==c&&(qa=D,N={type:"string",value:"year"}),D=N))));return D}function ka(){var D=k;var N=h();N!==c&&(qa=D,N=parseFloat(N));return N}function ia(){var D=k;var N=h();N!==c&&(qa=D,N=parseFloat(N));return N}function ra(){var D=pa();D===c&&(D=fa());return D}function pa(){var D=k;if(39===g.charCodeAt(k)){var N=Fd;k++}else N=c,0===
ha&&a(Gd);N===c&&(g.substr(k,2)===Hd?(N=Hd,k+=2):(N=c,0===ha&&a(Qf)));if(N!==c){N=[];var U=k;if(g.substr(k,2)===yc){var da=yc;k+=2}else da=c,0===ha&&a(Id);da!==c&&(qa=U,da="'");U=da;U===c&&(Jd.test(g.charAt(k))?(U=g.charAt(k),k++):(U=c,0===ha&&a(Kd)));for(;U!==c;)N.push(U),U=k,g.substr(k,2)===yc?(da=yc,k+=2):(da=c,0===ha&&a(Id)),da!==c&&(qa=U,da="'"),U=da,U===c&&(Jd.test(g.charAt(k))?(U=g.charAt(k),k++):(U=c,0===ha&&a(Kd)));39===g.charCodeAt(k)?(U=Fd,k++):(U=c,0===ha&&a(Gd));U!==c?(qa=D,D={type:"string",
value:N.join("")}):(k=D,D=c)}else k=D,D=c;return D}function xa(){var D=k;if(Ra()!==c){ma();var N=F();if(N!==c){ma();var U=Ya();U!==c?(ma(),U=F(),U!==c?(qa=D,D={type:"when-clause",operand:N,value:U}):(k=D,D=c)):(k=D,D=c)}else k=D,D=c}else k=D,D=c;return D}function Ba(){var D=k;if(Ra()!==c){ma();var N=F();if(N!==c){ma();var U=Ya();U!==c?(ma(),U=F(),U!==c?(qa=D,D={type:"when-clause",operand:N,value:U}):(k=D,D=c)):(k=D,D=c)}else k=D,D=c}else k=D,D=c;return D}function Ka(){var D=k;var N=k;if(g.substr(k,
4).toLowerCase()===Rf){var U=g.substr(k,4);k+=4}else U=c,0===ha&&a(Sf);if(U!==c){U=k;ha++;var da=M();ha--;da===c?U=void 0:(k=U,U=c);U!==c?(qa=N,N="ELSE"):(k=N,N=c)}else k=N,N=c;N!==c?(ma(),N=F(),N!==c?(qa=D,D={type:"else-clause",value:N}):(k=D,D=c)):(k=D,D=c);return D}function Fa(){var D=h();if(D===c){D=k;if(45===g.charCodeAt(k)){var N=Cc;k++}else N=c,0===ha&&a(Dc);N===c&&(43===g.charCodeAt(k)?(N=Ac,k++):(N=c,0===ha&&a(Bc)));if(N!==c){var U=h();U!==c?(qa=D,D=N[0]+U):(k=D,D=c)}else k=D,D=c}return D}
function La(){var D=k;if(46===g.charCodeAt(k)){var N=Tf;k++}else N=c,0===ha&&a(Uf);N!==c?(N=h(),N===c&&(N=null),qa=D,D="."+(null!=N?N:"")):(k=D,D=c);return D}function Ta(){var D;var N=D=k;if(Vf.test(g.charAt(k))){var U=g.charAt(k);k++}else U=c,0===ha&&a(Wf);U!==c?(Xf.test(g.charAt(k))?(U=g.charAt(k),k++):(U=c,0===ha&&a(Yf)),U===c&&(U=null),qa=N,N="e"+(null===U?"":U)):(k=N,N=c);N!==c?(U=h(),U!==c?(qa=D,D=N+U):(k=D,D=c)):(k=D,D=c);return D}function h(){var D=k;var N=[];var U=E();if(U!==c)for(;U!==c;)N.push(U),
U=E();else N=c;N!==c&&(qa=D,N=N.join(""));return N}function E(){if(Zf.test(g.charAt(k))){var D=g.charAt(k);k++}else D=c,0===ha&&a($f);return D}function X(){var D=k;if(g.substr(k,2).toLowerCase()===ag){var N=g.substr(k,2);k+=2}else N=c,0===ha&&a(bg);if(N!==c){N=k;ha++;var U=M();ha--;U===c?N=void 0:(k=N,N=c);N!==c?(qa=D,D="IN"):(k=D,D=c)}else k=D,D=c;return D}function aa(){var D=k;if(g.substr(k,2).toLowerCase()===cg){var N=g.substr(k,2);k+=2}else N=c,0===ha&&a(dg);if(N!==c){N=k;ha++;var U=M();ha--;
U===c?N=void 0:(k=N,N=c);N!==c?(qa=D,D="IS"):(k=D,D=c)}else k=D,D=c;return D}function ja(){var D=k;if(g.substr(k,4).toLowerCase()===eg){var N=g.substr(k,4);k+=4}else N=c,0===ha&&a(fg);if(N!==c){N=k;ha++;var U=M();ha--;U===c?N=void 0:(k=N,N=c);N!==c?(qa=D,D="LIKE"):(k=D,D=c)}else k=D,D=c;return D}function z(){var D=k;if(g.substr(k,3).toLowerCase()===gg){var N=g.substr(k,3);k+=3}else N=c,0===ha&&a(hg);if(N!==c){N=k;ha++;var U=M();ha--;U===c?N=void 0:(k=N,N=c);N!==c?(qa=D,D="NOT"):(k=D,D=c)}else k=D,
D=c;return D}function G(){var D=k;if(g.substr(k,3).toLowerCase()===ig){var N=g.substr(k,3);k+=3}else N=c,0===ha&&a(jg);if(N!==c){N=k;ha++;var U=M();ha--;U===c?N=void 0:(k=N,N=c);N!==c?(qa=D,D="AND"):(k=D,D=c)}else k=D,D=c;return D}function K(){var D=k;if(g.substr(k,2).toLowerCase()===kg){var N=g.substr(k,2);k+=2}else N=c,0===ha&&a(lg);if(N!==c){N=k;ha++;var U=M();ha--;U===c?N=void 0:(k=N,N=c);N!==c?(qa=D,D="OR"):(k=D,D=c)}else k=D,D=c;return D}function W(){var D=k;if(g.substr(k,7).toLowerCase()===
mg){var N=g.substr(k,7);k+=7}else N=c,0===ha&&a(ng);if(N!==c){N=k;ha++;var U=M();ha--;U===c?N=void 0:(k=N,N=c);N!==c?(qa=D,D="BETWEEN"):(k=D,D=c)}else k=D,D=c;return D}function Z(){var D=k;if(g.substr(k,4).toLowerCase()===og){var N=g.substr(k,4);k+=4}else N=c,0===ha&&a(pg);if(N!==c){N=k;ha++;var U=M();ha--;U===c?N=void 0:(k=N,N=c);N!==c?(qa=D,D="FROM"):(k=D,D=c)}else k=D,D=c;return D}function ba(){var D=k;if(g.substr(k,4).toLowerCase()===qg){var N=g.substr(k,4);k+=4}else N=c,0===ha&&a(rg);if(N!==
c){N=k;ha++;var U=M();ha--;U===c?N=void 0:(k=N,N=c);N!==c?(qa=D,D="TRIM"):(k=D,D=c)}else k=D,D=c;return D}function ea(){var D=k;if(g.substr(k,9).toLowerCase()===sg){var N=g.substr(k,9);k+=9}else N=c,0===ha&&a(tg);if(N!==c){N=k;ha++;var U=M();ha--;U===c?N=void 0:(k=N,N=c);N!==c?(qa=D,D="TIMESTAMP"):(k=D,D=c)}else k=D,D=c;return D}function la(){var D=k;if(g.substr(k,4).toLowerCase()===ug){var N=g.substr(k,4);k+=4}else N=c,0===ha&&a(vg);if(N!==c){N=k;ha++;var U=M();ha--;U===c?N=void 0:(k=N,N=c);N!==
c?(qa=D,D="DATE"):(k=D,D=c)}else k=D,D=c;return D}function na(){var D=k;if(g.substr(k,4).toLowerCase()===wg){var N=g.substr(k,4);k+=4}else N=c,0===ha&&a(xg);if(N!==c){N=k;ha++;var U=M();ha--;U===c?N=void 0:(k=N,N=c);N!==c?(qa=D,D="TIME"):(k=D,D=c)}else k=D,D=c;return D}function wa(){var D=k;if(g.substr(k,8).toLowerCase()===yg){var N=g.substr(k,8);k+=8}else N=c,0===ha&&a(zg);if(N!==c){N=k;ha++;var U=M();ha--;U===c?N=void 0:(k=N,N=c);N!==c?(qa=D,D="INTERVAL"):(k=D,D=c)}else k=D,D=c;return D}function ta(){var D=
k;if(g.substr(k,4).toLowerCase()===Ag){var N=g.substr(k,4);k+=4}else N=c,0===ha&&a(Bg);if(N!==c){N=k;ha++;var U=M();ha--;U===c?N=void 0:(k=N,N=c);N!==c?(qa=D,D="YEAR"):(k=D,D=c)}else k=D,D=c;return D}function va(){var D=k;if(g.substr(k,5).toLowerCase()===Cg){var N=g.substr(k,5);k+=5}else N=c,0===ha&&a(Dg);if(N!==c){N=k;ha++;var U=M();ha--;U===c?N=void 0:(k=N,N=c);N!==c?(qa=D,D="MONTH"):(k=D,D=c)}else k=D,D=c;return D}function Ea(){var D=k;if(g.substr(k,3).toLowerCase()===Eg){var N=g.substr(k,3);k+=
3}else N=c,0===ha&&a(Fg);if(N!==c){N=k;ha++;var U=M();ha--;U===c?N=void 0:(k=N,N=c);N!==c?(qa=D,D="DAY"):(k=D,D=c)}else k=D,D=c;return D}function ya(){var D=k;if(g.substr(k,4).toLowerCase()===Gg){var N=g.substr(k,4);k+=4}else N=c,0===ha&&a(Hg);if(N!==c){N=k;ha++;var U=M();ha--;U===c?N=void 0:(k=N,N=c);N!==c?(qa=D,D="HOUR"):(k=D,D=c)}else k=D,D=c;return D}function Da(){var D=k;if(g.substr(k,6).toLowerCase()===Ig){var N=g.substr(k,6);k+=6}else N=c,0===ha&&a(Jg);if(N!==c){N=k;ha++;var U=M();ha--;U===
c?N=void 0:(k=N,N=c);N!==c?(qa=D,D="MINUTE"):(k=D,D=c)}else k=D,D=c;return D}function Ca(){var D=k;if(g.substr(k,6).toLowerCase()===Kg){var N=g.substr(k,6);k+=6}else N=c,0===ha&&a(Lg);if(N!==c){N=k;ha++;var U=M();ha--;U===c?N=void 0:(k=N,N=c);N!==c?(qa=D,D="SECOND"):(k=D,D=c)}else k=D,D=c;return D}function za(){var D=k;if(g.substr(k,4).toLowerCase()===Mg){var N=g.substr(k,4);k+=4}else N=c,0===ha&&a(Ng);if(N!==c){N=k;ha++;var U=M();ha--;U===c?N=void 0:(k=N,N=c);N!==c?(qa=D,D="CASE"):(k=D,D=c)}else k=
D,D=c;return D}function Ja(){var D=k;if(g.substr(k,3).toLowerCase()===Og){var N=g.substr(k,3);k+=3}else N=c,0===ha&&a(Pg);if(N!==c){N=k;ha++;var U=M();ha--;U===c?N=void 0:(k=N,N=c);N!==c?(qa=D,D="END"):(k=D,D=c)}else k=D,D=c;return D}function Ra(){var D=k;if(g.substr(k,4).toLowerCase()===Qg){var N=g.substr(k,4);k+=4}else N=c,0===ha&&a(Rg);if(N!==c){N=k;ha++;var U=M();ha--;U===c?N=void 0:(k=N,N=c);N!==c?(qa=D,D="WHEN"):(k=D,D=c)}else k=D,D=c;return D}function Ya(){var D=k;if(g.substr(k,4).toLowerCase()===
Sg){var N=g.substr(k,4);k+=4}else N=c,0===ha&&a(Tg);if(N!==c){N=k;ha++;var U=M();ha--;U===c?N=void 0:(k=N,N=c);N!==c?(qa=D,D="THEN"):(k=D,D=c)}else k=D,D=c;return D}function Wa(){if(44===g.charCodeAt(k)){var D=Ug;k++}else D=c,0===ha&&a(Vg);return D}function Ma(){if(40===g.charCodeAt(k)){var D=Wg;k++}else D=c,0===ha&&a(Xg);return D}function Na(){if(41===g.charCodeAt(k)){var D=Yg;k++}else D=c,0===ha&&a(Zg);return D}function ma(){var D;var N=[];for(D=Sa();D!==c;)N.push(D),D=Sa();return N}function Sa(){if($g.test(g.charAt(k))){var D=
g.charAt(k);k++}else D=c,0===ha&&a(ah);return D}function Nb(D,N,U,da){D={type:"binary-expression",operator:D,left:N,right:U};void 0!==da&&(D.escape=da);return D}function nb(D,N){for(var U=0;U<N.length;U++)D=Nb(N[U][1],D,N[U][3]);return D}t=void 0!==t?t:{};var c={},Mb=t.grammarSource,Ld={start:q},Md=q,Nd="!",Sc="\x3d",Uc="\x3e\x3d",Sd="\x3e",Vc="\x3c\x3d",Wc="\x3c\x3e",Wd="\x3c",Xc="!\x3d",Ac="+",Cc="-",Yc="||",$d="*",be="/",Gf="@",Fd="'",Hd="N'",yc="''",Tf=".",ke="null",de="true",ge="false",ag="in",
cg="is",eg="like",Pd="escape",gg="not",ig="and",kg="or",mg="between",og="from",Ee="for",ze="substring",ne="extract",qg="trim",Ke="position",sg="timestamp",ug="date",wg="time",If="leading",Kf="trailing",Mf="both",Qe="cast",Ue="as",Ye="integer",af="smallint",df="float",gf="real",kf="varchar",Of="to",yg="interval",Ag="year",re="timezone_hour",ue="timezone_minute",Cg="month",Eg="day",Gg="hour",Ig="minute",Kg="second",Mg="case",Og="end",Qg="when",Sg="then",Rf="else",Ug=",",Wg="(",Yg=")",vd="`",Af=/^[A-Za-z_\x80-\uFFFF]/,
Cf=/^[A-Za-z0-9_]/,Dd=/^[A-Za-z0-9_.\x80-\uFFFF]/,Ef=/^["]/,Jd=/^[^']/,Zf=/^[0-9]/,Vf=/^[eE]/,Xf=/^[+\-]/,$g=/^[ \t\n\r]/,xd=/^[^`]/,Od=C("!",!1),Tc=C("\x3d",!1),Rd=C("\x3e\x3d",!1),Td=C("\x3e",!1),Ud=C("\x3c\x3d",!1),Vd=C("\x3c\x3e",!1),Xd=C("\x3c",!1),Yd=C("!\x3d",!1),Bc=C("+",!1),Dc=C("-",!1),Zd=C("||",!1),ae=C("*",!1),ce=C("/",!1),Bf=B([["A","Z"],["a","z"],"_",["\u0080","\uffff"]],!1,!1),Df=B([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),Ed=B([["A","Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],
!1,!1),Ff=B(['"'],!1,!1),Hf=C("@",!1),Gd=C("'",!1),Qf=C("N'",!1),Id=C("''",!1),Kd=B(["'"],!0,!1),Uf=C(".",!1),$f=B([["0","9"]],!1,!1),Wf=B(["e","E"],!1,!1),Yf=B(["+","-"],!1,!1),le=C("NULL",!0),ee=C("TRUE",!0),he=C("FALSE",!0),bg=C("IN",!0),dg=C("IS",!0),fg=C("LIKE",!0),Qd=C("ESCAPE",!0),hg=C("NOT",!0),jg=C("AND",!0),lg=C("OR",!0),ng=C("BETWEEN",!0),pg=C("FROM",!0),Fe=C("FOR",!0),Ae=C("SUBSTRING",!0),oe=C("EXTRACT",!0),rg=C("TRIM",!0),Le=C("POSITION",!0),tg=C("TIMESTAMP",!0),vg=C("DATE",!0),xg=C("TIME",
!0),Jf=C("LEADING",!0),Lf=C("TRAILING",!0),Nf=C("BOTH",!0),Re=C("CAST",!0),Ve=C("AS",!0),Ze=C("INTEGER",!0),bf=C("SMALLINT",!0),ef=C("FLOAT",!0),hf=C("REAL",!0),lf=C("VARCHAR",!0),Pf=C("TO",!0),zg=C("INTERVAL",!0),Bg=C("YEAR",!0),se=C("TIMEZONE_HOUR",!0),ve=C("TIMEZONE_MINUTE",!0),Dg=C("MONTH",!0),Fg=C("DAY",!0),Hg=C("HOUR",!0),Jg=C("MINUTE",!0),Lg=C("SECOND",!0),Ng=C("CASE",!0),Pg=C("END",!0),Rg=C("WHEN",!0),Tg=C("THEN",!0),Sf=C("ELSE",!0),Vg=C(",",!1),Xg=C("(",!1),Zg=C(")",!1),ah=B([" ","\t","\n",
"\r"],!1,!1),wd=C("`",!1),yd=B(["`"],!0,!1),k=0,qa=0,Zb=[{line:1,column:1}],eb=0,zc=[],ha=0;if("startRule"in t){if(!(t.startRule in Ld))throw Error("Can't start parsing from rule \""+t.startRule+'".');Md=Ld[t.startRule]}var Rc=Md();if(Rc!==c&&k===g.length)return Rc;Rc!==c&&k<g.length&&a({type:"end"});throw function(D,N,U){return new f(f.buildMessage(D,N),D,N,U)}(zc,eb<g.length?g.charAt(eb):null,eb<g.length?l(eb,eb+1):l(eb,eb));}}})})(A);var u=A.exports;class I{static parse(p){return u.parse(p)}}b.WhereGrammar=
I;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/fieldType":function(){define(["exports","../../core/jsonMap"],function(b,d){d=new d.JSONMap({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",
esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml",esriFieldTypeBigInteger:"big-integer",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimeOnly:"time-only",esriFieldTypeTimestampOffset:"timestamp-offset"});b.kebabDict=d;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/QueryEngineCapabilities":function(){define(["exports"],function(b){b.queryCapabilities={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,
centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByAnonymous:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,
supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/QueryEngineResult":function(){define("require exports ../../../core/lang ../../../geometry/support/centroid ../../../geometry/support/extentUtils ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ./AttributesBuilder ./geometryUtils ./projectionSupport ./SnappingCandidate ../../support/fieldUtils ../../../statistics/utils".split(" "),
function(b,d,A,u,I,p,f,v,g,t,w,C,B){function r(y,F,Q,e){const H=e.x-Q.x;e=e.y-Q.y;F=Math.min(1,Math.max(0,((F.x-Q.x)*H+(F.y-Q.y)*e)/(H*H+e*e)));y.x=Q.x+H*F;y.y=Q.y+e*F}function l(y,F){return y?F?4:3:F?3:2}class a{constructor(y,F,Q){this.items=y;this.query=F;this.geometryType=Q.geometryType;this.hasM=Q.hasM;this.hasZ=Q.hasZ;this.fieldsIndex=Q.fieldsIndex;this.objectIdField=Q.objectIdField;this.spatialReference=Q.spatialReference;this.featureAdapter=Q.featureAdapter}get size(){return this.items.length}createQueryResponseForCount(){const y=
new v(this.query,this.featureAdapter,this.fieldsIndex);if(!this.query.outStatistics)return y.countDistinctValues(this.items);const {groupByFieldsForStatistics:F,having:Q,outStatistics:e}=this.query;if(!F?.length)return 1;const H=new Map,S=new Map,J=new Set;for(const V of e){var {statisticType:R}=V;R="exceedslimit"!==R?V.onStatisticField:void 0;if(!S.has(R)){var P=[];for(const m of F){const O=this._getAttributeValues(y,m,H);P.push(O)}S.set(R,this._calculateUniqueValues(P,y.returnDistinctValues))}R=
S.get(R);for(const m in R){const {data:O,items:n}=R[m];P=O.join(",");Q&&!y.validateItems(n,Q)||J.add(P)}}return J.size}async createQueryResponse(){let y;y=this.query.outStatistics?this.query.outStatistics.some(F=>"exceedslimit"===F.statisticType)?this._createExceedsLimitQueryResponse(this.query):await this._createStatisticsQueryResponse(this.query):this._createFeatureQueryResponse(this.query);if(this.query.returnQueryGeometry){const F=this.query.geometry;f.isValid(this.query.outSR)&&!f.equals(F.spatialReference,
this.query.outSR)?y.queryGeometry=g.cleanFromGeometryEngine({spatialReference:this.query.outSR,...t.project(F,F.spatialReference,this.query.outSR)}):y.queryGeometry=g.cleanFromGeometryEngine({spatialReference:this.query.outSR,...F})}return y}createSnappingResponse(y,F){const Q=this.featureAdapter,e=l(this.hasZ,this.hasM),{point:H,mode:S}=y,J="number"===typeof y.distance?y.distance:y.distance.x,R="number"===typeof y.distance?y.distance:y.distance.y,P={candidates:[]},V="esriGeometryPolygon"===this.geometryType;
F=this._getPointCreator(S,this.spatialReference,F);const m=new q(null,0),O=new q(null,0),n={x:0,y:0,z:0};for(const oa of this.items){var x=Q.getGeometry(oa);if(null==x)continue;const {coords:sa,lengths:ca}=x;m.coords=sa;O.coords=sa;if(y.returnEdge){x=0;for(var M=0;M<ca.length;M++){var L=ca[M];for(var T=0;T<L;T++,x+=e){var Y=m;Y.coordsIndex=x;if(T!==L-1){const ka=O;ka.coordsIndex=x+e;const ia=n;r(n,H,Y,ka);var fa=(H.x-ia.x)/J;const ra=(H.y-ia.y)/R;fa=fa*fa+ra*ra;1>=fa&&P.candidates.push(w.makeEdgeCandidate(Q.getObjectId(oa),
F(ia),Math.sqrt(fa),F(Y),F(ka)))}}}}if("none"!==y.vertexMode)if(x=V?sa.length-e:sa.length,"all"===y.vertexMode)for(M=0;M<x;M+=e)L=m,L.coordsIndex=M,T=(H.x-L.x)/J,Y=(H.y-L.y)/R,T=T*T+Y*Y,1>=T&&P.candidates.push(w.makeVertexCandidate(Q.getObjectId(oa),F(L),Math.sqrt(T)));else if("ends"===y.vertexMode){x=[0];V||x.push(sa.length-e);for(const ka of x)x=m,x.coordsIndex=ka,M=(H.x-x.x)/J,L=(H.y-x.y)/R,M=M*M+L*L,1>=M&&P.candidates.push(w.makeVertexCandidate(Q.getObjectId(oa),F(x),Math.sqrt(M)))}}P.candidates.sort((oa,
sa)=>oa.distance-sa.distance);return P}_getPointCreator(y,F,Q){const e=null==Q||f.equals(F,Q)?S=>S:S=>t.project(S,F,Q),{hasZ:H}=this;return"3d"===y?H?({x:S,y:J,z:R})=>e({x:S,y:J,z:R}):({x:S,y:J})=>e({x:S,y:J,z:0}):({x:S,y:J})=>e({x:S,y:J})}async createSummaryStatisticsResponse(y){const {field:F,valueExpression:Q,normalizationField:e,normalizationType:H,normalizationTotal:S,minValue:J,maxValue:R,scale:P,timeZone:V}=y;var m=this.fieldsIndex.get(F);y=C.isDateField(m)||C.isDateOnlyField(m)||C.isTimestampOffsetField(m);
const O=await this._getDataValues({field:F,valueExpression:Q,normalizationField:e,normalizationType:H,normalizationTotal:S,scale:P,timeZone:V}),n=B.isNullCountSupported({normalizationType:H,normalizationField:e,minValue:J,maxValue:R}),x={value:.5,fieldType:m?.type};m=C.isStringField(m)?B.calculateStringStatistics({values:O,supportsNullCount:n,percentileParams:x}):B.calculateStatistics({values:O,minValue:J,maxValue:R,useSampleStdDev:!H,supportsNullCount:n,percentileParams:x});return B.processSummaryStatisticsResult(m,
y)}async createUniqueValuesResponse(y){const {field:F,valueExpression:Q,domains:e,returnAllCodedValues:H,scale:S,timeZone:J}=y;var R=await this._getDataValues({field:F,field2:y.field2,field3:y.field3,fieldDelimiter:y.fieldDelimiter,valueExpression:Q,scale:S,timeZone:J},!1);R=B.calculateUniqueValuesCount(R);return B.createUVResult(R,e,H,y.fieldDelimiter)}async createClassBreaksResponse(y){const {field:F,valueExpression:Q,normalizationField:e,normalizationType:H,normalizationTotal:S,classificationMethod:J,
standardDeviationInterval:R,minValue:P,maxValue:V,numClasses:m,scale:O,timeZone:n}=y;y=await this._getDataValues({field:F,valueExpression:Q,normalizationField:e,normalizationType:H,normalizationTotal:S,scale:O,timeZone:n});y=B.calculateClassBreaks(y,{field:F,normalizationField:e,normalizationType:H,normalizationTotal:S,classificationMethod:J,standardDeviationInterval:R,minValue:P,maxValue:V,numClasses:m});return B.resolveCBResult(y,J)}async createHistogramResponse(y){const {field:F,valueExpression:Q,
normalizationField:e,normalizationType:H,normalizationTotal:S,classificationMethod:J,standardDeviationInterval:R,minValue:P,maxValue:V,numBins:m,scale:O,timeZone:n}=y;y=await this._getDataValues({field:F,valueExpression:Q,normalizationField:e,normalizationType:H,normalizationTotal:S,scale:O,timeZone:n});return B.calculateHistogram(y,{field:F,normalizationField:e,normalizationType:H,normalizationTotal:S,classificationMethod:J,standardDeviationInterval:R,minValue:P,maxValue:V,numBins:m})}_sortFeatures(y,
F,Q){if(1<y.length&&F?.length)for(const e of F.reverse()){F=e.split(" ");const H=F[0],S=this.fieldsIndex.get(H);F=F[1]?"desc"===F[1].toLowerCase():!1;const J=B.getAttributeComparator(S?.type,F);y.sort((R,P)=>{R=Q(R,H,S);P=Q(P,H,S);return J(R,P)})}}_createFeatureQueryResponse(y){const F=this.items,{geometryType:Q,hasM:e,hasZ:H,objectIdField:S,spatialReference:J}=this,{outFields:R,outSR:P,quantizationParameters:V,resultRecordCount:m,resultOffset:O,returnZ:n,returnM:x}=y,M=null!=m?F.length>(O||0)+m:
!1,L=R&&(R.includes("*")?[...this.fieldsIndex.fields]:R.map(T=>this.fieldsIndex.get(T)));return{exceededTransferLimit:M,features:this._createFeatures(y,F),fields:L,geometryType:Q,hasM:e&&x,hasZ:H&&n,objectIdFieldName:S,spatialReference:g.cleanFromGeometryEngine(P||J),transform:V&&p.toQuantizationTransform(V)||null}}_createFeatures(y,F){const Q=new v(y,this.featureAdapter,this.fieldsIndex),{hasM:e,hasZ:H}=this,{orderByFields:S,quantizationParameters:J,returnGeometry:R,returnCentroid:P,maxAllowableOffset:V,
resultOffset:m,resultRecordCount:O,returnZ:n=!1,returnM:x=!1}=y,M=H&&n,L=e&&x;y=[];var T=0;F=[...F];this._sortFeatures(F,S,(oa,sa,ca)=>Q.getFieldValue(oa,sa,ca));if(this.geometryType&&(R||P)){var Y=p.toQuantizationTransform(J)??void 0;if(R&&!P)for(var fa of F)y[T++]={attributes:Q.getAttributes(fa),geometry:g.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(fa),V,Y,M,L)};else if(!R&&P)for(const oa of F)y[T++]={attributes:Q.getAttributes(oa),centroid:g.transformCentroid(this,
this.featureAdapter.getCentroid(oa,this),Y)};else for(const oa of F)y[T++]={attributes:Q.getAttributes(oa),centroid:g.transformCentroid(this,this.featureAdapter.getCentroid(oa,this),Y),geometry:g.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(oa),V,Y,M,L)}}else for(Y of F)(fa=Q.getAttributes(Y))&&(y[T++]={attributes:fa});T=m||0;null!=O&&(y=y.slice(T,Math.min(y.length,T+O)));return y}_createExceedsLimitQueryResponse(y){var F=!1;let Q=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY;
F=Number.POSITIVE_INFINITY;for(const H of y.outStatistics??[])if("exceedslimit"===H.statisticType){Q=null!=H.maxPointCount?H.maxPointCount:Number.POSITIVE_INFINITY;e=null!=H.maxRecordCount?H.maxRecordCount:Number.POSITIVE_INFINITY;F=null!=H.maxVertexCount?H.maxVertexCount:Number.POSITIVE_INFINITY;break}if("esriGeometryPoint"===this.geometryType)F=this.items.length>Q;else if(this.items.length>e)F=!0;else{y=l(this.hasZ,this.hasM);const H=this.featureAdapter;F=this.items.reduce((S,J)=>{J=H.getGeometry(J);
return S+(null!=J&&J.coords.length||0)},0)/y>F}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(F)}}]}}async _createStatisticsQueryResponse(y){var F={attributes:{}};const Q=[],e=new Map,H=new Map,S=new Map,J=new Map,R=new v(y,this.featureAdapter,this.fieldsIndex);var P=y.outStatistics;const {groupByFieldsForStatistics:V,having:m,orderByFields:O,resultRecordCount:n}=
y;y=V?.length;const x=!!y,M=x?V[0]:null,L=x&&!this.fieldsIndex.get(M);for(const sa of P??[]){const {outStatisticFieldName:ca,statisticType:ka}=sa;P=sa;const ia="exceedslimit"!==ka?sa.onStatisticField:void 0,ra="percentile_disc"===ka||"percentile_cont"===ka;var T="EnvelopeAggregate"===ka||"CentroidAggregate"===ka||"ConvexHullAggregate"===ka;const pa=x&&1===y&&(ia===M||L)&&"count"===ka;if(x){if(!S.has(ia)){var Y=[];for(const xa of V){var fa=this._getAttributeValues(R,xa,e);Y.push(fa)}S.set(ia,this._calculateUniqueValues(Y,
T?!1:R.returnDistinctValues))}Y=S.get(ia);if(!Y)continue;fa=Object.keys(Y);for(const xa of fa){const {count:Ba,data:Ka,items:Fa,itemPositions:La}=Y[xa];fa=Ka.join(",");if(!m||R.validateItems(Fa,m)){const Ta=J.get(fa)||{attributes:{}};if(T){Ta.aggregateGeometries||(Ta.aggregateGeometries={});const {aggregateGeometries:E,outStatisticFieldName:X}=await this._getAggregateGeometry(P,Fa);Ta.aggregateGeometries[X]=E}else{var oa=null;if(pa)oa=Ba;else{const E=this._getAttributeValues(R,ia,e);oa=La.map(X=>
E[X]);oa=ra&&"statisticParameters"in P?this._getPercentileValue(P,oa):this._getStatisticValue(P,oa,null,R.returnDistinctValues)}Ta.attributes[ca]=oa}let h=0;V.forEach((E,X)=>Ta.attributes[this.fieldsIndex.get(E)?E:`EXPR_${++h}`]=Ka[X]);J.set(fa,Ta)}}}else if(T){F.aggregateGeometries||(F.aggregateGeometries={});const {aggregateGeometries:xa,outStatisticFieldName:Ba}=await this._getAggregateGeometry(P,this.items);F.aggregateGeometries[Ba]=xa}else T=this._getAttributeValues(R,ia,e),F.attributes[ca]=
ra&&"statisticParameters"in P?this._getPercentileValue(P,T):this._getStatisticValue(P,T,H,R.returnDistinctValues);P="min"!==ka&&"max"!==ka||!C.isStringField(this.fieldsIndex.get(ia))&&!this._isAnyDateField(ia)?null:this.fieldsIndex.get(ia)?.type;Q.push({name:ca,alias:ca,type:P||"esriFieldTypeDouble"})}F=x?Array.from(J.values()):[F];this._sortFeatures(F,O,(sa,ca)=>sa.attributes[ca]);n&&(F.length=Math.min(n,F.length));return{fields:Q,features:F}}_isAnyDateField(y){y=this.fieldsIndex.get(y);return C.isDateField(y)||
C.isDateOnlyField(y)||C.isTimestampOffsetField(y)||C.isTimeOnlyField(y)}async _getAggregateGeometry(y,F){const {convexHull:Q,union:e}=await new Promise((n,x)=>b(["../../../geometry/geometryEngineJSON"],n,x)),{statisticType:H,outStatisticFieldName:S}=y,{featureAdapter:J,spatialReference:R,geometryType:P,hasZ:V,hasM:m}=this;F=F.map(n=>g.getGeometry(P,V,m,J.getGeometry(n)));const O=Q(R,F,!0)[0];y={aggregateGeometries:null,outStatisticFieldName:null};"EnvelopeAggregate"===H?(F=O?I.getPolygonExtent(O):
I.getGeometryExtent(e(R,F)),y.aggregateGeometries={...F,spatialReference:R},y.outStatisticFieldName=S||"extent"):"CentroidAggregate"===H?(F=O?u.polygonCentroid(O):u.extentCentroid(I.getGeometryExtent(e(R,F))),y.aggregateGeometries={x:F[0],y:F[1],spatialReference:R},y.outStatisticFieldName=S||"centroid"):"ConvexHullAggregate"===H&&(y.aggregateGeometries=O,y.outStatisticFieldName=S||"convexHull");return y}_getStatisticValue(y,F,Q,e){const {onStatisticField:H,statisticType:S}=y;y=null;y=Q?.has(H)?Q.get(H):
C.isStringField(this.fieldsIndex.get(H))||this._isAnyDateField(H)?B.calculateStringStatistics({values:F,returnDistinct:e}):B.calculateStatistics({values:e?[...(new Set(F))]:F,minValue:null,maxValue:null,useSampleStdDev:!0});Q&&Q.set(H,y);return y["var"===S?"variance":S]}_getPercentileValue(y,F){const {onStatisticField:Q,statisticParameters:e,statisticType:H}=y,{value:S,orderBy:J}=e;y=this.fieldsIndex.get(Q);return B.calculatePercentile(F,{value:S,orderBy:J,fieldType:y?.type,isDiscrete:"percentile_disc"===
H})}_getAttributeValues(y,F,Q){if(Q.has(F))return Q.get(F);const e=this.fieldsIndex.get(F),H=this.items.map(S=>y.getFieldValue(S,F,e));Q.set(F,H);return H}_calculateUniqueValues(y,F){const Q={},e=this.items,H=e.length;for(let S=0;S<H;S++){const J=e[S],R=[];for(const V of y)R.push(V[S]);const P=R.join(",");null==Q[P]?Q[P]={count:1,data:R,items:[J],itemPositions:[S]}:(F||Q[P].count++,Q[P].items.push(J),Q[P].itemPositions.push(S))}return Q}async _getDataValues(y,F=!0){const Q=new v(this.query,this.featureAdapter,
this.fieldsIndex),{valueExpression:e,scale:H,timeZone:S}=y;return e?Q.getExpressionValues(this.items,e,{viewingMode:"map",scale:H,spatialReference:this.query.outSR||this.spatialReference},{geometryType:this.geometryType,hasZ:this.hasZ,hasM:this.hasM},S):Q.getDataValues(this.items,A.clone(y),F)}}class q{constructor(y,F){this.coords=y;this.coordsIndex=F}get x(){return this.coords[this.coordsIndex]}get y(){return this.coords[this.coordsIndex+1]}get z(){return this.coords[this.coordsIndex+2]}}d.QueryEngineResult=
a;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/quantizationUtils":function(){define(["exports","./jsonUtils"],function(b,d){function A({scale:P,translate:V},m){return Math.round((m-V[0])/P[0])}function u({scale:P,translate:V},m){return Math.round((V[1]-m)/P[1])}function I(P,V,m){const O=[];let n,x,M,L;for(let T=0;T<m.length;T++){const Y=m[T];if(0<T){if(M=A(P,Y[0]),L=u(P,Y[1]),M!==n||L!==x)O.push(V(Y,M-n,L-x)),n=M,x=L}else n=A(P,Y[0]),x=u(P,Y[1]),O.push(V(Y,
n,x))}return 0<O.length?O:null}function p(P,V,m,O){return I(P,m?O?R:J:O?J:S,V)}function f(P,V,m,O){const n=[];m=m?O?R:J:O?J:S;for(O=0;O<V.length;O++){const x=I(P,m,V[O]);x&&3<=x.length&&n.push(x)}return n.length?n:null}function v(P,V,m,O){const n=[];m=m?O?R:J:O?J:S;for(O=0;O<V.length;O++){const x=I(P,m,V[O]);x&&2<=x.length&&n.push(x)}return n.length?n:null}function g({scale:P,translate:V},m){return m*P[0]+V[0]}function t({scale:P,translate:V},m){return V[1]-m*P[1]}function w(P,V,m){const O=Array(m.length);
if(!m.length)return O;const [n,x]=P.scale;let M=g(P,m[0][0]);P=t(P,m[0][1]);O[0]=V(m[0],M,P);for(let L=1;L<m.length;L++){const T=m[L];M+=T[0]*n;P-=T[1]*x;O[L]=V(T,M,P)}return O}function C(P,V,m){const O=Array(m.length);for(let n=0;n<m.length;n++)O[n]=w(P,V,m[n]);return O}function B(P,V,m,O){return w(P,m?O?R:J:O?J:S,V)}function r(P,V,m,O){return C(P,m?O?R:J:O?J:S,V)}function l(P,V,m,O){return C(P,m?O?R:J:O?J:S,V)}function a(P,V,m){let [O,n]=m[0],x=Math.min(O,V[0]),M=Math.min(n,V[1]),L=Math.max(O,V[2]);
V=Math.max(n,V[3]);for(let T=1;T<m.length;T++){const [Y,fa]=m[T];O+=Y;n+=fa;0>Y&&(x=Math.min(x,O));0<Y&&(L=Math.max(L,O));0>fa?M=Math.min(M,n):0<fa&&(V=Math.max(V,n))}P[0]=x;P[1]=M;P[2]=L;P[3]=V;return P}function q(P,V){if(!V.length)return null;P[0]=P[1]=Number.POSITIVE_INFINITY;P[2]=P[3]=Number.NEGATIVE_INFINITY;for(let m=0;m<V.length;m++)a(P,P,V[m]);return P}function y(P,V,m,O,n){V.xmin=A(P,m.xmin);V.ymin=u(P,m.ymin);V.xmax=A(P,m.xmax);V.ymax=u(P,m.ymax);V!==m&&(O&&(V.zmin=m.zmin,V.zmax=m.zmax),
n&&(V.mmin=m.mmin,V.mmax=m.mmax));return V}function F(P,V,m,O,n){V.points=p(P,m.points,O,n)??[];return V}function Q(P,V,m,O,n){V.x=A(P,m.x);V.y=u(P,m.y);V!==m&&(O&&(V.z=m.z),n&&(V.m=m.m));return V}function e(P,V,m,O,n){P=f(P,m.rings,O,n);if(!P)return null;V.rings=P;return V}function H(P,V,m,O,n){P=v(P,m.paths,O,n);if(!P)return null;V.paths=P;return V}const S=(P,V,m)=>[V,m],J=(P,V,m)=>[V,m,P[2]],R=(P,V,m)=>[V,m,P[2],P[3]];b.equals=function(P,V){if(P===V||null==P&&null==V)return!0;if(null==P||null==
V)return!1;let m,O,n,x;P&&"upperLeft"===P.originPosition?(m=P.translate[0],O=P.translate[1],P=P.scale[0]):(m=null!=P.extent?P.extent.xmin:0,O=null!=P.extent?P.extent.ymax:0,P=P.tolerance);V&&"upperLeft"===V.originPosition?(n=V.translate[0],x=V.translate[1],V=V.scale[0]):(n=null!=V.extent?V.extent.xmin:0,x=null!=V.extent?V.extent.ymax:0,V=V.tolerance);return m===n&&O===x&&P===V};b.getQuantizedBoundsCoordsArray=a;b.getQuantizedBoundsCoordsArrayArray=q;b.getQuantizedBoundsPaths=function(P){return q([0,
0,0,0],P)};b.getQuantizedBoundsPoints=function(P){const V=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return a(V,V,P)};b.getQuantizedBoundsRings=function(P){return q([0,0,0,0],P)};b.quantizeBounds=function(P,V,m){V[0]=A(P,m[0]);V[3]=u(P,m[1]);V[2]=A(P,m[2]);V[1]=u(P,m[3]);return V};b.quantizeExtent=y;b.quantizeGeometry=function(P,V){return P&&V?d.isPoint(V)?Q(P,{},V,!1,!1):d.isPolyline(V)?H(P,{},V,!1,!1):d.isPolygon(V)?e(P,{},V,!1,!1):d.isMultipoint(V)?
F(P,{},V,!1,!1):d.isExtent(V)?y(P,{},V,!1,!1):null:null};b.quantizeMultipoint=F;b.quantizePaths=v;b.quantizePoint=Q;b.quantizePoints=p;b.quantizePolygon=e;b.quantizePolyline=H;b.quantizeRings=f;b.quantizeX=A;b.quantizeY=u;b.toQuantizationTransform=function(P){return P?{originPosition:"upper-left"===P.originPosition?"upperLeft":"lower-left"===P.originPosition?"lowerLeft":P.originPosition,scale:P.tolerance?[P.tolerance,P.tolerance]:[1,1],translate:null!=P.extent?[P.extent.xmin,P.extent.ymax]:[0,0]}:
null};b.unquantizeBounds=function(P,V,m){return m?(V[0]=g(P,m[0]),V[1]=t(P,m[3]),V[2]=g(P,m[2]),V[3]=t(P,m[1]),V):[g(P,V[0]),t(P,V[3]),g(P,V[2]),t(P,V[1])]};b.unquantizeCoordsArray=w;b.unquantizeCoordsArrayArray=C;b.unquantizeExtent=function(P,V,m,O,n){V.xmin=g(P,m.xmin);V.ymin=t(P,m.ymin);V.xmax=g(P,m.xmax);V.ymax=t(P,m.ymax);V!==m&&(O&&(V.zmin=m.zmin,V.zmax=m.zmax),n&&(V.mmin=m.mmin,V.mmax=m.mmax));return V};b.unquantizeMultipoint=function(P,V,m,O,n){null!=m&&(V.points=B(P,m.points,O,n));return V};
b.unquantizePaths=r;b.unquantizePoint=function(P,V,m,O,n){if(null==m)return V;V.x=g(P,m.x);V.y=t(P,m.y);V!==m&&(O&&(V.z=m.z),n&&(V.m=m.m));return V};b.unquantizePoints=B;b.unquantizePolygon=function(P,V,m,O,n){null!=m&&(V.rings=l(P,m.rings,O,n));return V};b.unquantizePolyline=function(P,V,m,O,n){null!=m&&(V.paths=r(P,m.paths,O,n));return V};b.unquantizeRings=l;b.unquantizeX=g;b.unquantizeY=t;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/AttributesBuilder":function(){define("./attributeSupport ./geometryUtils ../../support/fieldUtils ../../../smartMapping/statistics/support/utils ../../../statistics/utils ../../../support/arcadeOnDemand".split(" "),
function(b,d,A,u,I,p){class f{constructor(v,g,t){this._fieldDataCache=new Map;this._returnDistinctMap=new Map;this.returnDistinctValues=v.returnDistinctValues??!1;this.fieldsIndex=t;this.featureAdapter=g;if((g=v.outFields)&&!g.includes("*")){this.outFields=g;v=0;for(const C of g){var w=b.getExpressionFromFieldName(C);w=(g=this.fieldsIndex.get(w))?null:b.getWhereClause(w,t);g=g?g.name:b.getAliasFromFieldName(C)||`FIELD_EXP_${v++}`;this._fieldDataCache.set(C,{alias:g,clause:w})}}}countDistinctValues(v){if(!this.returnDistinctValues)return v.length;
v.forEach(g=>this.getAttributes(g));return this._returnDistinctMap.size}getAttributes(v){v=this._processAttributesForOutFields(v);return this._processAttributesForDistinctValues(v)}getFieldValue(v,g,t){const w=t?t.name:g;let C=null;this._fieldDataCache.has(w)?C=this._fieldDataCache.get(w)?.clause:t||(C=b.getWhereClause(g,this.fieldsIndex),this._fieldDataCache.set(w,{alias:w,clause:C}));return t?this.featureAdapter.getAttribute(v,w):C?.calculateValue(v,this.featureAdapter)}getDataValues(v,g,t=!0){const w=
g.normalizationType,C=g.normalizationTotal,B=this.fieldsIndex.get(g.field),r=A.isDateOnlyField(B)||A.isTimestampOffsetField(B),l=A.isTimeOnlyField(B);return v.map(a=>{let q=g.field&&this.getFieldValue(a,g.field,this.fieldsIndex.get(g.field));g.field2?(q=`${I.processNullValue(q)}${g.fieldDelimiter}${I.processNullValue(this.getFieldValue(a,g.field2,this.fieldsIndex.get(g.field2)))}`,g.field3&&(q=`${q}${g.fieldDelimiter}${I.processNullValue(this.getFieldValue(a,g.field3,this.fieldsIndex.get(g.field3)))}`)):
"string"===typeof q&&t&&(r?q=q?(new Date(q)).getTime():null:l&&(q=q?u.timeOnlyToMilliseconds(q):null));w&&Number.isFinite(q)&&(a="field"===w&&g.normalizationField?this.getFieldValue(a,g.normalizationField,this.fieldsIndex.get(g.normalizationField)):null,q=I.getNormalizedValue(q,w,a,C));return q})}async getExpressionValues(v,g,t,w,C){const {arcadeUtils:B}=await p.loadArcade(),r=B.hasGeometryOperations(g);r&&await B.enableGeometryOperations();const l=B.createFunction(g),a=B.getViewInfo(t),q={fields:this.fieldsIndex.fields};
return v.map(y=>{y={attributes:this.featureAdapter.getAttributes(y),layer:q,geometry:r?{...d.getGeometry(w.geometryType,w.hasZ,w.hasM,this.featureAdapter.getGeometry(y)),spatialReference:t?.spatialReference}:null};y=B.createExecContext(y,a,C);return B.executeFunction(l,y)})}validateItem(v,g){this._fieldDataCache.has(g)||this._fieldDataCache.set(g,{alias:g,clause:b.getWhereClause(g,this.fieldsIndex)});return this._fieldDataCache.get(g)?.clause?.testFeature(v,this.featureAdapter)??!1}validateItems(v,
g){this._fieldDataCache.has(g)||this._fieldDataCache.set(g,{alias:g,clause:b.getWhereClause(g,this.fieldsIndex)});return this._fieldDataCache.get(g)?.clause?.testSet(v,this.featureAdapter)??!1}_processAttributesForOutFields(v){const g=this.outFields;if(!g?.length)return this.featureAdapter.getAttributes(v);const t={};for(const w of g){const {alias:C,clause:B}=this._fieldDataCache.get(w);t[C]=B?B.calculateValue(v,this.featureAdapter):this.featureAdapter.getAttribute(v,C)}return t}_processAttributesForDistinctValues(v){if(null==
v||!this.returnDistinctValues)return v;var g=this.outFields,t=[];if(g)for(const C of g){var {alias:w}=this._fieldDataCache.get(C);t.push(v[w])}else for(w in v)t.push(v[w]);g=`${(g||["*"]).join(",")}=${t.join(",")}`;t=this._returnDistinctMap.get(g)||0;this._returnDistinctMap.set(g,++t);return 1<t?null:v}}return f})},"esri/smartMapping/statistics/support/utils":function(){define("exports ../../../geometry ../../../core/Error ../../../core/screenUtils ../../../core/timeUtils ../../../geometry/SpatialReference ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ../../../layers/support/fieldUtils ../../../renderers/support/heatmapUtils ../../support/utils ../../../statistics/utils ../../../support/arcadeOnDemand ../../../geometry/Point".split(" "),
function(b,d,A,u,I,p,f,v,g,t,w,C,B,r){function l(e){e=Q.exec(e);if(!e)return null;const {hh:H,mm:S,ss:J,ms:R}=e.groups;return Number(H)*I.millisecondsPerTimeUnit.hours+Number(S)*I.millisecondsPerTimeUnit.minutes+Number(J)*I.millisecondsPerTimeUnit.seconds+Number(R||0)}function a(e,H){e=null!=e?e:"";null!=H&&H&&(e=e?"("+e+") AND ("+H+")":H);return e}function q(e){const H=e.layer;return e.fields.filter(S=>!H.getField(S))}function y(e){const H=e.layer;return e.fields.filter(S=>{S=H.getFieldUsageInfo(S);
return!S||!S.supportsStatistics})}let F=null;const Q=/^(?<hh>([0-1][0-9])|([2][0-3])):(?<mm>[0-5][0-9])(:(?<ss>[0-5][0-9]))?([.](?<ms>\d+))?$/;b.calculateHeatmapStats=function(e,H=18,S,J,R,P){const V=new Float64Array(R*P);H=Math.round(u.pt2px(H));let m=Number.POSITIVE_INFINITY,O=Number.NEGATIVE_INFINITY;var n=0;let x=0,M=0,L=0;S=t.createValueFunction(J,S);for(const {geometry:Y,attributes:fa}of e){const {x:oa,y:sa}=Y;e=Math.max(0,oa-H);n=Math.max(0,sa-H);J=Math.min(P,sa+H);const ca=Math.min(R,oa+H),
ka=+S(fa);for(let ia=n;ia<J;ia++)for(let ra=e;ra<ca;ra++){n=ia*R+ra;const pa=t.evaluateDensityKernel(ra-oa,ia-sa,H);var T=V[n];n=V[n]+=pa*ka;T=n-T;x+=T;M+=T*T;n<m&&(m=n);n>O&&(O=n);L++}}return L?{mean:x/L,stdDev:Math.sqrt((M-x*x/L)/L),min:m,max:O,mid:(O-m)/2,count:L}:{mean:0,stddev:0,min:0,max:0,mid:0,count:0}};b.getDataValues=async function(e,H,S=!0){if(!H)return[];const {field:J,field2:R,field3:P,fieldDelimiter:V,fieldInfos:m,timeZone:O}=e;var n=J&&m?.find(ia=>ia.name.toLowerCase()===J.toLowerCase());
const x=n?g.isTimeOnlyField(n):!1,M=n?w.isAnyDateField(n):!1,L=e.valueExpression,T=e.normalizationType,Y=e.normalizationField,fa=e.normalizationTotal,oa=[];n=e.viewInfoParams;let sa=null,ca=null;if(L){if(!F){const {arcadeUtils:ia}=await B.loadArcade();F=ia}F.hasGeometryOperations(L)&&await F.enableGeometryOperations();sa=F.createFunction(L);ca=n?F.getViewInfo({viewingMode:n.viewingMode,scale:n.scale,spatialReference:new p(n.spatialReference)}):null}e=e.fieldInfos;const ka=H[0]&&"declaredClass"in H[0]&&
"esri.Graphic"===H[0].declaredClass||!e?null:{fields:e};H.forEach(ia=>{var ra=ia.attributes;if(L){var pa=F.createExecContext(ka?{...ia,layer:ka}:ia,ca,O);pa=F.executeFunction(sa,pa)}else ra&&(pa=ra[J],R?(pa=`${C.processNullValue(pa)}${V}${C.processNullValue(ra[R])}`,P&&(pa=`${pa}${V}${C.processNullValue(ra[P])}`)):"string"===typeof pa&&S&&(M?pa=pa?(new Date(pa)).getTime():null:x&&(pa=pa?l(pa):null)));T&&"number"===typeof pa&&isFinite(pa)&&(ra=ra&&parseFloat(ra[Y]),pa=C.getNormalizedValue(pa,T,ra,
fa));oa.push(pa)});return oa};b.getRangeExpr=function(e,H,S){H=null!=H?e+" \x3e\x3d "+H:"";e=null!=S?e+" \x3c\x3d "+S:"";S="";return(S=H&&e?a(H,e):H||e)?"("+S+")":""};b.getSQLFilterForNormalization=function(e){const H=e.field,S=e.normalizationType;e=e.normalizationField;let J;if("field"===S)J="(NOT "+e+" \x3d 0)";else if("log"===S||"natural-log"===S||"square-root"===S)J=`(${H} > 0)`;return J};b.getSumOfAttributesExpr=function(e,H,S){const J=[],R=[],P=[],V=[],m=[];e.forEach((x,M)=>{const L=x.field?
"field":"expression",T=x.field||x.valueExpression;x.field?(m.push(T),R.push(`var ${L}${M} = Number($feature["${T}"]);`)):(J.push(`function getValueForExpr${M}() {\n  ${T} \n}`),R.push(`var ${L}${M} = Number(getValueForExpr${M}());`));S||P.push(`${L}${M} = IIf(${L}${M} < 0, 0, ${L}${M});`);V.push(`${L}${M}`)});e="return sum;";const O=J.length?null:m.reduce((x,M)=>`${x} + ${M}`);let n=null;H||S?H?S||(e="return IIf(sum \x3e\x3d 0, sum, null);",O&&(n=`(( ${O} ) >= 0)`)):(e="return IIf(sum !\x3d 0, sum, null);",
O&&(n=`(( ${O} ) <> 0)`)):(e="return IIf(sum \x3e 0, sum, null);",O&&(n=`(( ${O} ) > 0)`));return{valueExpression:[J.length?J.join("\n"):"",R.join("\n"),P.join("\n"),`var sum = ${V.join(" + ")};`,e].filter(Boolean).join("\n\n"),sqlExpression:O,sqlWhere:n}};b.mergeWhereClauses=a;b.quantizeFeatures=function(e,H,S,J){const R=v.isWrappable(S)?v.getInfo(S):null,P=R?Math.round((R.valid[1]-R.valid[0])/H.scale[0]):null;return e.map(V=>{const m=new r(V.geometry);f.quantizePoint(H,m,m,m.hasZ,m.hasM);if(R){var O=
P??0,n=J[0];0>m.x?m.x+=O:m.x>n&&(m.x-=O)}V.geometry=m;return V})};b.timeOnlyToMilliseconds=l;b.verifyBasicFieldValidity=function(e,H,S){const J=q({layer:e,fields:H});if(J.length)return new A(S,"Unknown fields: "+J.join(", ")+". You can only use fields defined in the layer schema");e=y({layer:e,fields:H});if(e.length)return new A(S,"Unsupported fields: "+e.join(", ")+". You can only use fields that can be fetched i.e. AdapterFieldUsageInfo.supportsStatistics must be true")};b.verifyFieldType=function(e,
H,S,J){let R;H?H.name!==e.objectIdField&&J.includes(H.type)||(R=new A(S,"'field' should be one of these types: "+J.join(","))):R=new A(S,"'field' is not defined in the layer schema");return R};b.verifyFilterValidty=function(e,H){if(e&&"intersects"!==e.spatialRelationship)return new A(H,"Only 'intersects' spatialRelationship is supported for featureFilter")};b.verifyNumericField=function(e,H,S){let J;H?H.name!==e.objectIdField&&g.isNumericField(H)||(J=new A(S,"'field' should be one of these numeric types: "+
g.numericTypes.join(","))):J=new A(S,"'field' is not defined in the layer schema");return J};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/screenUtils":function(){define(["exports"],function(b){function d(u){return u?72*u/96:0}const A=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i;b.castRenderScreenPointArray=function(u){return u};b.castRenderScreenPointArray3=function(u){return u};b.castScreenPointArray=function(u){return u};b.createRenderScreenPoint=function(u=0,I=0){return{x:u,
y:I}};b.createRenderScreenPointArray=function(u=0,I=0){return[u,I]};b.createRenderScreenPointArray3=function(u=0,I=0,p=0){return[u,I,p]};b.createScreenPoint=function(u=0,I=0){return{x:u,y:I}};b.createScreenPointArray=function(u=0,I=0){return[u,I]};b.pt2px=function(u){return u?u/72*96:0};b.px2pt=d;b.screenPointArrayToObject=function(u,I){return I?(I.x=u[0],I.y=u[1],I):{x:u[0],y:u[1]}};b.screenPointObjectToArray=function(u,I){return I?(I[0]=u.x,I[1]=u.y,2<I.length&&(I[2]=0),I):[u.x,u.y]};b.toPt=function(u){if("string"===
typeof u){var I=u.match(A);if(I){var p=Number(I[1]);I=I[3]&&I[3].toLowerCase();u="-"===u.charAt(0);p="px"===I?d(p):p;return u?-p:p}console.warn("screenUtils.toPt: input not recognized!");return null}return u};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/timeUtils":function(){define(["exports","../intl/date","../time/timeZoneUtils","../chunks/datetime"],function(b,d,A,u){function I(v,g,t){return 0===v?0:v*f[g]/f[t]}function p(v){switch(v){case "milliseconds":return"millisecond";
case "seconds":return"second";case "minutes":return"minute";case "hours":return"hour";case "days":return"day";case "weeks":return"week";case "months":return"month";case "years":return"year"}}const f={milliseconds:1,seconds:1E3,minutes:6E4,hours:36E5,days:864E5,weeks:6048E5,months:26784E5,years:31536E6,decades:31536E7,centuries:31536E8};b.convertTime=I;b.isValidDate=function(v){return v instanceof Date&&!isNaN(v.getTime())};b.makeUTCTime=function(v,g,t="milliseconds"){g=new Date(I(g,t,"milliseconds"));
g.setUTCFullYear(v.getUTCFullYear(),v.getUTCMonth(),v.getUTCDate());return g};b.mergeTimeExtents=function(v,g){return v&&g?v.intersection(g):v||g};b.millisecondsPerTimeUnit=f;b.offsetDate=function(v,g,t,w=A.system){w=new u.IANAZone(d.resolveTimeZone(w));v=u.DateTime.fromJSDate(v,{zone:w});w="decades"===t||"centuries"===t?"year":p(t);"decades"===t&&(g*=10);"centuries"===t&&(g*=100);return v.plus({[w]:g}).toJSDate()};b.offsetDateUTC=function(v,g,t="milliseconds"){v=v.getTime();g=I(g,t,"milliseconds");
return new Date(v+g)};b.resetUTCDate=function(v,g){v=new Date(v.getTime());v.setUTCFullYear(g.getFullYear(),g.getMonth(),g.getDate());return v};b.timeSinceUTCMidnight=function(v,g="milliseconds"){const t=I(v.getUTCHours(),"hours","milliseconds"),w=I(v.getUTCMinutes(),"minutes","milliseconds"),C=I(v.getUTCSeconds(),"seconds","milliseconds");v=v.getUTCMilliseconds();return I(t+w+C+v,"milliseconds",g)};b.truncateDate=function(v,g,t=A.system){t=new u.IANAZone(d.resolveTimeZone(t));v=u.DateTime.fromJSDate(v,
{zone:t});if("decades"===g||"centuries"===g)return v=v.startOf("year"),{year:t}=v,v.set({year:t-t%("decades"===g?10:100)}).toJSDate();g=p(g);return v.startOf(g).toJSDate()};b.truncateLocalTime=function(v){const g=new Date(0);g.setHours(0);g.setMinutes(0);g.setSeconds(0);g.setMilliseconds(0);g.setFullYear(v.getUTCFullYear(),v.getUTCMonth(),v.getUTCDate());return g};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/heatmapUtils":function(){define(["exports","../../core/mathUtils",
"../../core/screenUtils","../../chunks/vec4","../../chunks/vec4f64"],function(b,d,A,u,I){function p(t,w,C,B){let {color:r,ratio:l}=w,{color:a,ratio:q}=C;q===l&&(1===q?l-=1E-6:q+=1E-6);w=d.clamp((B-l)/(q-l),0,1);u.lerp(t,r.toArray(),a.toArray(),w)}function f(t,w,C,B,r){t=new Uint32Array(t*t);w="buffer"in w?w:new Float64Array(w);C="buffer"in C?new Uint32Array(C.buffer):new Uint32Array((new Uint8Array(C)).buffer);r=C.length/(r-B);for(let l=0;l<w.length;l++)t[l]=C[d.clamp(Math.floor((w[l]-B)*r),0,C.length-
1)];return t.buffer}function v(t,w,C){t=Math.sqrt(t**2+w**2)/C;return 1<t?0:3/(Math.PI*C**2)*(1-t**2)**2}function g(t,w){return null!=t?"string"===typeof w?C=>-1*+C.readAttribute(t):C=>+C.readAttribute(t)+w:C=>1}b.calculateHeatmapIntensityInfoReaders=function(t,w,C,B){const {radius:r,fieldOffset:l,field:a}=w;w=Math.round(A.pt2px(r));const q=new Float64Array(C*B);let y=Number.NEGATIVE_INFINITY;const F=g(a,l),Q=new Set;for(const J of t)for(t=J.getCursor();t.next();){var e=t.getObjectId();if(Q.has(e))continue;
Q.add(e);e=t.readLegacyPointGeometry();if(-128>e.x||e.x>=C+128||-128>e.y||e.y>B+128)continue;const R=+F(t),P=Math.max(0,Math.round(e.x)-w);var H=Math.max(0,Math.round(e.y)-w);const V=Math.min(B,Math.round(e.y)+w),m=Math.min(C,Math.round(e.x)+w);for(;H<V;H++)for(let O=P;O<m;O++){var S=H*C+O;const n=v(e.x-O,e.y-H,w);S=q[S]+=n*R;S>y&&(y=S)}}return{matrix:q.buffer,max:y}};b.createHeatmapImageData=f;b.createValueFunction=function(t,w){return"function"===typeof t?t:t?"string"===typeof w?C=>-1*+C[t]:C=>
+C[t]+w:()=>1};b.createValueFunctionCursor=g;b.drawHeatmap=function(t,w,C,B,r,l){t.canvas.width=t.canvas.height=w;t.clearRect(0,0,w,w);const a=t.getImageData(0,0,w,w);C&&B&&a.data.set(new Uint8ClampedArray(f(w,C,B,r,l)));t.putImageData(a,0,0)};b.evaluateDensityKernel=v;b.gaussianBlurRadiusPxToKernelDensityRadiusPt=function(t){return A.px2pt(2.4*t)};b.generateGradient=function(t){const w=new Uint8ClampedArray(2048);t=t.filter(({ratio:a})=>0<=a&&1>=a).sort((a,q)=>a.ratio-q.ratio).map(({color:a,ratio:q})=>
({color:a,ratio:Math.max(q,.001)}));if(1>t.length)return w;let C=t[0],B=t[0],r=1;const l=I.create();for(let a=0;512>a;a++){const q=(a+.5)/512;for(;q>B.ratio&&r<t.length;)C=B,B=t[r++];p(l,C,B,q);w.set(l,4*a)}return w};b.kernelDensityRadiusPtToGaussianBlurRadiusPx=function(t){return A.pt2px(t)/2.4};b.magicKernelDensityRadiusInflationFactor=2.4;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/smartMapping/support/utils":function(){define("exports ../../intl/date ../../layers/support/fieldUtils ../../support/arcadeOnDemand ../../support/basemapUtils ../../time/timeZoneUtils".split(" "),
function(b,d,A,u,I,p){function f(r){return String(r).padStart(2,"0")}function v(r,l,a){if("date"===l||"number"===l){"number"===l&&(r=new Date(r));l=a?r.getFullYear():r.getUTCFullYear();const q=f((a?r.getMonth():r.getUTCMonth())+1),y=f(a?r.getDate():r.getUTCDate()),F=f(a?r.getHours():r.getUTCHours()),Q=f(a?r.getMinutes():r.getUTCMinutes());r=f(a?r.getSeconds():r.getUTCSeconds());r=`TIMESTAMP'${l}-${q}-${y} ${F}:${Q}:${r}'`}return r}function g(r,l){if(l instanceof Date)return"date";if("number"===typeof l)return"number";
if("string"===typeof l&&(r=r.getField(l),"\x3cnow\x3e"!==l.toLowerCase()&&A.isDateField(r)))return"field"}const t={light:"streets gray topo terrain oceans osm gray-vector streets-vector topo-vector streets-relief-vector streets-navigation-vector topo-3d navigation-3d arcgis-light-gray arcgis-navigation arcgis-streets arcgis-streets-relief arcgis-topographic arcgis-oceans osm-standard osm-standard-relief osm-streets osm-streets-relief osm-light-gray arcgis-terrain arcgis-charted-territory arcgis-community arcgis-colored-pencil arcgis-modern-antique arcgis-midcentury arcgis-newspaper arcgis-hillshade-light".split(" "),
dark:"satellite hybrid dark-gray dark-gray-vector streets-night-vector navigation-dark-3d arcgis-imagery arcgis-imagery-standard arcgis-dark-gray arcgis-navigation-night arcgis-streets-night osm-dark-gray arcgis-nova arcgis-hillshade-dark".split(" ")},w={years:365,months:30,days:1,hours:1/24,minutes:1/1440,seconds:1/86400,milliseconds:1/864E5},C=new Set(["integer","small-integer"]);let B=null;b.castIntegerFieldToFloat=function(r){return`cast(${r} as float)`};b.dateTypes=["date","date-only","timestamp-offset"];
b.defaultBasemapGroups=t;b.fieldDelimiter=",";b.formatAnyDate=function(r,l){const {format:a,timeZoneOptions:q,fieldType:y}=l??{};let F;q&&({timeZone:Q,timeZoneName:F}=p.getTimeZoneFormattingOptions(q.layerTimeZone,q.datesInUnknownTimezone,q.viewTimeZone,d.convertDateFormatToIntlOptions(a||"short-date-short-time"),y));if("string"===typeof r&&isNaN(Date.parse("time-only"===y?`1970-01-01T${r}Z`:r)))return r;switch(y){case "date-only":var Q=d.convertDateFormatToIntlOptions(a||"short-date");return"string"===
typeof r?d.formatDateOnly(r,{...Q}):d.formatDate(r,{...Q,timeZone:p.utc});case "time-only":return Q=d.convertDateFormatToIntlOptions(a||"short-time"),"string"===typeof r?d.formatTimeOnly(r,Q):d.formatDate(r,{...Q,timeZone:p.utc});case "timestamp-offset":if(!Q&&"string"===typeof r&&(new Date(r)).toISOString()!==r)return r;Q=(l=a||q?d.convertDateFormatToIntlOptions(a||"short-date-short-time"):void 0)?{...l,timeZone:Q,timeZoneName:F}:void 0;return"string"===typeof r?d.formatTimestamp(r,Q):d.formatDate(r,
Q);default:return l=a||q?d.convertDateFormatToIntlOptions(a||"short-date-short-time"):void 0,d.formatDate("string"===typeof r?new Date(r):r,l?{...l,timeZone:Q,timeZoneName:F}:void 0)}};b.getBasemapGroup=function(r,l=t){for(const a in l)if(l[a].includes(r))return a};b.getBasemapId=function(r,l,a=!0){let q=null;r&&("string"===typeof r?l.includes(r)&&(q=r):q=I.getWellKnownBasemapId(r));return a?q||"gray":q};b.getDateDiffSQL=function(r,l,a,q){const {hasQueryEngine:y}=r;a=v(a,g(r,a),y);r=v(l,g(r,l),y);
r=`(${a} - ${r})`;q=w[q];l="/";1>q&&(q=1/q,l="*");return{sqlExpression:1===q?r:`(${r} ${l} ${q})`,sqlWhere:null}};b.getDateType=g;b.getFieldsList=async function(r){const {field:l,field2:a,field3:q,normalizationField:y,valueExpression:F}=r;r=[];F&&(B||({arcadeUtils:r}=await u.loadArcade(),B=r),r=B.extractFieldNames(F));l&&r.push(l);a&&r.push(a);q&&r.push(q);y&&r.push(y);return r};b.getNormalizationType=function(r){let l=r.normalizationType;l||(r.normalizationField?l="field":null!=r.normalizationTotal&&
(l="percent-of-total"));return l??void 0};b.isAnyDateField=function(r){return A.isDateField(r)||A.isDateOnlyField(r)||A.isTimestampOffsetField(r)};b.isIntegerField=function(r,l){r=l&&r.getField(l);return!!r&&C.has(r.type)};b.unitValueInDays=w;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/support/basemapUtils":function(){define("exports ../Basemap ../config ../core/Collection ../core/Logger ../core/maybe ../core/urlUtils ../core/accessorSupport/ensureType ../layers/effects/utils ./basemapDefinitions".split(" "),
function(b,d,A,u,I,p,f,v,g,t){function w(n,x){let M;if("string"===typeof n){const L=n in t.esriBasemapDefinitions,T=!L&&n.includes("/");if(!L&&!T)return x=Object.entries(t.esriBasemapDefinitions).filter(([,Y])=>A.apiKey&&!Y.classic||!A.apiKey&&(Y.classic||Y.is3d)).map(([Y])=>`"${Y}"`).sort().join(", "),V.warn(`Unable to find basemap definition for: ${n}. Try one of these: ${x}`),null;x&&(M=x[n]);M||(M=L?d.fromId(n):new d({style:{id:n}}),x&&(x[n]=M))}else M=v.ensureType(d,n);M?.destroyed&&(V.warn("The provided basemap is already destroyed",
{basemap:M}),M=null);return M}function C(n){if(m)return m(n);let x=null;n=a(n);const M=!n?.baseLayers.length;for(const T in t.esriBasemapDefinitions){var L=Q(t.esriBasemapDefinitions[T]);L=H(n,L,{mustMatchReferences:M});if("equal"===L){x=T;break}"base-layers-equal"===L&&(x=T)}return x}function B(n,x){const M=new u;n.forEach(L=>{const T=x.find(Y=>"scene"!==Y.type&&J(y(L),y(Y)))||L;M.includes(T)?M.push(L):M.push(T)});return M}function r(n){if(l(n.url))return!0;if("vector-tile"===n.type)for(const x in n.sourceNameToSource)if(l(n.sourceNameToSource[x]?.sourceUrl))return!0;
return!1}function l(n){if(!n)return!1;n=new f.Url(f.makeAbsolute(n));return!!n.authority&&O.test(n.authority)}function a(n){return n?!n.loaded&&n.resourceInfo?Q(n.resourceInfo.data):{baseLayers:q(n.baseLayers),referenceLayers:q(n.referenceLayers)}:null}function q(n){return(u.isCollection(n)?n.toArray():n).map(y)}function y(n){return{type:n.type,effect:"effect"in n?n.effect:void 0,url:R("urlTemplate"in n&&n.urlTemplate||n.url||"styleUrl"in n&&n.styleUrl||""),minScale:"minScale"in n&&null!=n.minScale?
n.minScale:0,maxScale:"maxScale"in n&&null!=n.maxScale?n.maxScale:0,opacity:null!=n.opacity?n.opacity:1,visible:null!=n.visible?!!n.visible:!0,sublayers:"map-image"!==n.type&&"wms"!==n.type||null==n.sublayers?void 0:n.sublayers?.map(x=>({id:x.id,visible:x.visible})),activeLayerId:"wmts"===n.type?n.activeLayer?.id:void 0}}function F(n){return n.isReference||"ArcGISSceneServiceLayer"===n.layerType}function Q(n){return n?{baseLayers:e((n.baseMapLayers??[]).filter(x=>!F(x))),referenceLayers:e((n.baseMapLayers??
[]).filter(x=>F(x)))}:null}function e(n){return n.map(x=>{let M;switch(x.layerType){case "VectorTileLayer":M="vector-tile";break;case "ArcGISTiledMapServiceLayer":M="tile";break;case "ArcGISSceneServiceLayer":M="scene";break;default:M="unknown"}return{type:M,effect:x.effect,url:R(x.templateUrl||x.urlTemplate||x.styleUrl||x.url),minScale:x.minScale??0,maxScale:x.maxScale??0,opacity:x.opacity??1,visible:null!=x.visibility?!!x.visibility:!0,sublayers:void 0,activeLayerId:void 0}})}function H(n,x,M){return null!=
n!==(null!=x)?"not-equal":n&&x?S(n.baseLayers,x.baseLayers)?S(n.referenceLayers,x.referenceLayers)?"equal":M.mustMatchReferences?"not-equal":"base-layers-equal":"not-equal":"equal"}function S(n,x){if(n.length!==x.length)return!1;for(let M=0;M<n.length;M++)if(!J(n[M],x[M]))return!1;return!0}function J(n,x){if(n.type!==x.type||n.url!==x.url||n.minScale!==x.minScale||n.maxScale!==x.maxScale||n.visible!==x.visible||n.opacity!==x.opacity||!g.effectEquals(n.effect,x.effect))return!1;if(null!=n.activeLayerId||
null!=x.activeLayerId)return n.activeLayerId===x.activeLayerId;if(null!=n.sublayers||null!=x.sublayers){if(null==n.sublayers||null==x.sublayers||n.sublayers.length!==x.sublayers.length)return!1;for(let M=0;M<n.sublayers.length;M++){const L=n.sublayers.at(M),T=x.sublayers.at(M);if(L?.id!==T?.id||L?.visible!==T?.visible)return!1}}return!0}function R(n){return n?f.normalize(n).replace(/^\s*https?:/i,"").toLowerCase():""}function P(n){return"portalItem"in n?n.portalItem?.thumbnailUrl:void 0}const V=I.getLogger("esri.support.basemapUtils");
let m;const O=/^(basemaps|ibasemaps).*-api\.arcgis\.com$/i;b.clonePreservingTiledLayers=function(n,x=null){n=w(n);if(!n)return null;n=n.clone();x&&(n.baseLayers=B(n.baseLayers,x.baseLayers),n.referenceLayers=B(n.referenceLayers,x.referenceLayers));return n};b.contentEquals=function(n,x){if(n===x||null!=n?.portalItem?.id&&n.portalItem.id===x?.portalItem?.id)return!0;n=a(n);x=a(x);return"equal"===H(n,x,{mustMatchReferences:!0})};b.createCache=function(){return{}};b.destroyCache=function(n){for(const x in n)p.destroyMaybe(n[x]),
delete n[x]};b.ensureType=w;b.findSpatialReference=function(n,x){if(null==x||null==n)return{spatialReference:null,updating:!1};if("not-loaded"===x.loadStatus)return x.load(),{spatialReference:null,updating:!0};if(x.spatialReference)return{spatialReference:x.spatialReference,updating:!1};if(0===x.baseLayers.length)return{spatialReference:null,updating:!1};x=x.baseLayers.at(0);switch(x.loadStatus){case "not-loaded":x.load();case "loading":return{spatialReference:null,updating:!0};case "failed":return{spatialReference:null,
updating:!1}}x=(("supportedSpatialReferences"in x?x.supportedSpatialReferences:null)||["tileInfo"in x?x.tileInfo?.spatialReference:x.spatialReference]).filter(Boolean);const M=n.spatialReference;return M?{spatialReference:x.find(L=>M.equals(L))??x[0]??null,updating:!1}:{spatialReference:x[0],updating:!1}};b.getBasemapThumbnailUrl=function(n){if(!n)return null;var {thumbnailUrl:x}=n;return x?x:(x=C(n))?t.esriBasemapDefinitions[x].thumbnailUrl:p.mappedFind(n.baseLayers,P)};b.getWellKnownBasemapId=C;
b.hasDeveloperBasemapLayer=function(n){return!!n?.baseLayers.concat(n.referenceLayers).some(r)};b.isBasemap3D=function(n){return"Web Scene"===n.portalItem?.type};b.isBasemapInBeta=function(n){return!!n?.portalItem?.tags?.some(x=>"beta"===x.toLowerCase())};b.isBasemapLayer=function(n,x){return n.basemap?.referenceLayers?.some(M=>M.uid===x)||n.basemap?.baseLayers?.some(M=>M.uid===x)};b.isDeveloperBasemapLayer=r;b.overrideGetWellKnownBasemapId=function(n){m=n};Object.defineProperty(b,Symbol.toStringTag,
{value:"Module"})})},"esri/Basemap":function(){define("require ./chunks/tslib.es6 ./request ./core/Collection ./core/collectionUtils ./core/JSONSupport ./core/lang ./core/Loadable ./core/loadAll ./core/Logger ./core/maybe ./core/promiseUtils ./core/urlUtils ./core/accessorSupport/decorators/property ./core/accessorSupport/ensureType ./core/accessorSupport/decorators/subclass ./core/accessorSupport/decorators/writer ./geometry/SpatialReference ./portal/Portal ./portal/PortalItem ./support/basemapDefinitions ./support/BasemapStyle ./webdoc/support/writeUtils".split(" "),
function(b,d,A,u,I,p,f,v,g,t,w,C,B,r,l,a,q,y,F,Q,e,H,S){var J;let R=0;p=J=class extends p.JSONSupportMixin(v){constructor(m){super(m);this.thumbnailUrl=this.style=this.spatialReference=this.portalItem=this.id=null;this.title="Basemap";this.id=Date.now().toString(16)+"-basemap-"+R++;this.baseLayers=new u;this.referenceLayers=new u;const O=n=>{n.parent&&n.parent!==this&&"remove"in n.parent&&n.parent.remove(n);n.parent=this;"elevation"===n.type&&t.getLogger(this).error(`Layer '${n.title}, id:${n.id}' of type '${n.type}' is not supported as a basemap layer and will therefore be ignored.`)};
this.addHandles([this.baseLayers.on("after-add",n=>O(n.item)),this.referenceLayers.on("after-add",n=>O(n.item)),this.baseLayers.on("after-remove",n=>{n.item.parent=null}),this.referenceLayers.on("after-remove",n=>{n.item.parent=null})])}initialize(){this.when().catch(m=>{t.getLogger(this).error("#load()",`Failed to load basemap (title: '${this.title}', id: '${this.id}')`,m)});this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){var m=this.baseLayers.toArray();for(const O of m)O.destroy();
m=this.referenceLayers.toArray();for(const O of m)O.destroy();this.baseLayers.destroy();this.referenceLayers.destroy();this.portalItem=w.destroyMaybe(this.portalItem)}normalizeCtorArgs(m){m&&"resourceInfo"in m&&(this._set("resourceInfo",m.resourceInfo),m={...m},delete m.resourceInfo);return m}set baseLayers(m){this._set("baseLayers",I.referenceSetter(m,this._get("baseLayers")))}_writeBaseLayers(m,O,n){const x=[];m&&(n={...n,layerContainerType:"basemap"},this.baseLayers.forEach(M=>{M=S.getLayerJSON(M,
n.webmap?n.webmap.getLayerJSONFromResourceInfo(M):null,n);null!=M&&x.push(M)}),this.referenceLayers.forEach(M=>{const L=S.getLayerJSON(M,n.webmap?n.webmap.getLayerJSONFromResourceInfo(M):null,n);null!=L&&("scene"!==M.type&&(L.isReference=!0),x.push(L))}));O.baseMapLayers=x}set referenceLayers(m){this._set("referenceLayers",I.referenceSetter(m,this._get("referenceLayers")))}writeTitle(m,O){O.title=m||"Basemap"}load(m){this.addResolvingPromise(this._loadFromSource(m));return Promise.resolve(this)}loadAll(){return g.loadAll(this,
m=>{m(this.baseLayers,this.referenceLayers)})}clone(){const m={id:this.id,title:this.title,portalItem:this.portalItem,baseLayers:this.baseLayers.map(O=>f.isClonable(O)?O.clone():O),referenceLayers:this.referenceLayers.map(O=>f.isClonable(O)?O.clone():O)};this.loaded&&(m.loadStatus="loaded");return(new J({resourceInfo:this.resourceInfo})).set(m)}read(m,O){this.resourceInfo||this._set("resourceInfo",{data:m,context:O});super.read(m,O)}write(m,O){m=m||{};O?.origin||(O={origin:"web-map",...O});super.write(m,
O);!this.loaded&&this.resourceInfo?.data.baseMapLayers&&(m.baseMapLayers=this.resourceInfo.data.baseMapLayers.map(n=>{n=f.clone(n);n.url&&B.isProtocolRelative(n.url)&&(n.url=`https:${n.url}`);n.templateUrl&&B.isProtocolRelative(n.templateUrl)&&(n.templateUrl=`https:${n.templateUrl}`);return n}));return m}async _loadFromSource(m){const {resourceInfo:O,portalItem:n,style:x}=this;C.throwIfAborted(m);const M=[];O?(M.push(this._loadLayersFromJSON(O.data,O.context?O.context.url:null,m)),O.data.id&&!O.data.title&&
M.push(e.getBasemapTitle(O.data.id).then(L=>{L&&this.read({title:L},O.context)}))):n?M.push(this._loadFromItem(n,m)):x&&M.push(this._loadFromStylesService(x,m));await Promise.all(M)}async _loadLayersFromJSON(m,O,n){const x=this.resourceInfo?.context,M=this.portalItem?.portal||x?.portal||null,L=V[x?.origin||""]??"web-map",{populateOperationalLayers:T}=await new Promise((fa,oa)=>b(["./layers/support/layersCreator"],fa,oa)),Y=[];C.throwIfAborted(n);if(m.baseMapLayers&&Array.isArray(m.baseMapLayers)){O=
{context:{...x,origin:L,url:O,portal:M,layerContainerType:"basemap"},defaultLayerType:"DefaultTileLayer"};const fa=oa=>"web-scene"===L&&"ArcGISSceneServiceLayer"===oa.layerType||oa.isReference;n=T(this.baseLayers,m.baseMapLayers.filter(oa=>!fa(oa)),O);Y.push(n);m=T(this.referenceLayers,m.baseMapLayers.filter(fa),O);Y.push(m)}await Promise.allSettled(Y)}async _loadFromItem(m,O){const n=await (await m.load(O)).fetchData("json",O),x=B.urlToObject(m.itemUrl??"");this._set("resourceInfo",{data:n.baseMap??
{},context:{origin:P[m.type||""]??"web-map",portal:m.portal||F.getDefault(),url:x}});this.read(this.resourceInfo.data,this.resourceInfo.context);this.read({spatialReference:n.spatialReference},this.resourceInfo.context);this.read({title:m.title,thumbnailUrl:m.thumbnailUrl},{origin:"portal-item",portal:m.portal||F.getDefault(),url:x});return this._loadLayersFromJSON(this.resourceInfo.data,x,O)}async _loadFromStylesService(m,O){var n=`${m.serviceUrl}/${m.id}`;m=(await A(n,{query:{language:m.getLanguageParamValue()},
signal:O?.signal})).data;if(m.baseMap&&Array.isArray(m.baseMap.baseMapLayers))for(const x of m.baseMap.baseMapLayers)if(!x.customParameters&&x.styleUrl?.includes("?")){const M=B.urlToObject(x.styleUrl);M.query&&(x.styleUrl=M.path,x.customParameters=M.query)}n=B.urlToObject(n);this._set("resourceInfo",{data:m.baseMap??{},context:{origin:"web-map",url:n}});this.read(this.resourceInfo.data,this.resourceInfo.context);this.read({spatialReference:m.spatialReference},this.resourceInfo.context);return this._loadLayersFromJSON(this.resourceInfo.data,
n,O)}static fromId(m){return(m=e.esriBasemapDefinitions[m])?m.itemId?new J({portalItem:{id:m.itemId,portal:{url:"https://www.arcgis.com"}}}):J.fromJSON(m,{origin:m.is3d?"web-scene":"web-map"}):null}};d.__decorate([r.property({json:{write:{ignoreOrigin:!0,target:"baseMapLayers",writer(m,O,n,x){this._writeBaseLayers(m,O,x)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{baseMapLayers:{type:u}},writer(m,O,n,x){this._writeBaseLayers(m,O,x)}}}}}})],p.prototype,"baseLayers",null);d.__decorate([r.property({type:String,
json:{origins:{"web-scene":{write:!0}}}})],p.prototype,"id",void 0);d.__decorate([r.property({type:Q})],p.prototype,"portalItem",void 0);d.__decorate([r.property()],p.prototype,"referenceLayers",null);d.__decorate([r.property({readOnly:!0})],p.prototype,"resourceInfo",void 0);d.__decorate([r.property({type:y})],p.prototype,"spatialReference",void 0);d.__decorate([r.property({type:H})],p.prototype,"style",void 0);d.__decorate([r.property()],p.prototype,"thumbnailUrl",void 0);d.__decorate([r.property({type:String,
json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],p.prototype,"title",void 0);d.__decorate([q.writer("title")],p.prototype,"writeTitle",null);p=J=d.__decorate([a.subclass("esri.Basemap")],p);const P={"Web Scene":"web-scene","Web Map":"web-map","Link Chart":"link-chart"},V={"web-scene":"web-scene","web-map":"web-map","link-chart":"link-chart"};return p})},"esri/core/collectionUtils":function(){define(["exports","./Collection"],function(b,d){b.castForReferenceSetter=function(A){return A};b.referenceSetter=
function(A,u,I=d){u||(u=new I);if(u===A)return u;u.removeAll();A&&(Array.isArray(A)||"items"in A&&Array.isArray(A.items))?u.addMany(A):A&&u.add(A);return u};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/Loadable":function(){define("../chunks/tslib.es6 ./Error ./maybe ./Promise ./promiseUtils ./Warning ./accessorSupport/decorators/property ./accessorSupport/decorators/subclass".split(" "),function(b,d,A,u,I,p,f,v){const g=t=>{t=class extends t{constructor(...w){super(...w);
this.loadError=this._loadController=null;this.loadStatus="not-loaded";this._set("loadWarnings",[]);this.addResolvingPromise(new Promise(C=>{const B=this.load.bind(this);this.load=r=>{const l=new Promise((a,q)=>{const y=I.onAbortOrThrow(r,q);this.destroyed&&q(new d("load:instance-destroyed",`Instance of '${this.declaredClass||this.constructor.name}' is already destroyed`,{instance:this}));this.when(a,q).finally(()=>{y&&y.remove()})});if("not-loaded"===this.loadStatus){this._set("loadStatus","loading");
const a=this._loadController=new AbortController;B({signal:a.signal})}C();return l}}));this.when(()=>{this._set("loadStatus","loaded");this._loadController=null},C=>{this._set("loadStatus","failed");this._set("loadError",C);this._loadController=null})}destroy(){this._loadController&&(this._loadController=A.abortMaybe(this._loadController),this._promiseProps.abort());this._set("loadError",null);this._set("loadWarnings",[])}get loaded(){return"loaded"===this.loadStatus}get loadWarnings(){return this._get("loadWarnings")}load(){return null}cancelLoad(){if(this.isFulfilled())return this;
this._set("loadError",new d("load:cancelled","Cancelled"));this._loadController?.abort();this._promiseProps.abort();return this}};b.__decorate([f.property({readOnly:!0})],t.prototype,"loaded",null);b.__decorate([f.property({readOnly:!0})],t.prototype,"loadError",void 0);b.__decorate([f.property({clonable:!1})],t.prototype,"loadStatus",void 0);b.__decorate([f.property({type:[p],readOnly:!0})],t.prototype,"loadWarnings",null);return t=b.__decorate([v.subclass("esri.core.Loadable")],t)};u=class extends g(u.EsriPromise){};
u=b.__decorate([v.subclass("esri.core.Loadable")],u);(function(t){t.LoadableMixin=g;t.isLoadable=function(w){return!(!w||!w.load)}})(u||(u={}));return u})},"esri/core/Promise":function(){define(["exports","../chunks/tslib.es6","./Accessor","./promiseUtils","./accessorSupport/decorators/subclass"],function(b,d,A,u,I){var p;(function(g){g[g.PENDING=0]="PENDING";g[g.RESOLVED=1]="RESOLVED";g[g.REJECTED=2]="REJECTED"})(p||(p={}));class f{constructor(){this._resolver=u.createResolver();this._status=p.PENDING;
this._resolvingPromises=[];this._resolver.promise.then(()=>{this._status=p.RESOLVED;this._cleanUp()},()=>{this._status=p.REJECTED;this._cleanUp()});this.promise=this._resolver.promise}destroy(){this._cleanUp()}addResolvingPromise(g){this._resolvingPromises.push(g);this._tryResolve()}isResolved(){return this._status===p.RESOLVED}isRejected(){return this._status===p.REJECTED}isFulfilled(){return this._status!==p.PENDING}abort(){this._resolver.reject(u.createAbortError())}_cleanUp(){this._resolvingPromises=
this._allPromise=null}_tryResolve(){if(!this.isFulfilled()){var g=u.createResolver(),t=[...this._resolvingPromises,g.promise],w=this._allPromise=Promise.all(t);w.then(()=>{this.isFulfilled()||this._allPromise!==w||this._resolver.resolve()},C=>{this.isFulfilled()||this._allPromise!==w||u.isAbortError(C)||this._resolver.reject(C)});g.resolve()}}}const v=g=>{g=class extends g{constructor(...t){super(...t);this._promiseProps=new f;this.addResolvingPromise(Promise.resolve())}destroy(){this._promiseProps.destroy()}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(t,
w){return this._promiseProps.promise.then(()=>this).then(t,w)}catch(t){return this.when(null,t)}addResolvingPromise(t){t&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in t?t.when():t)}};return g=d.__decorate([I.subclass("esri.core.Promise")],g)};b.EsriPromise=class extends v(A){};b.EsriPromise=d.__decorate([I.subclass("esri.core.Promise")],b.EsriPromise);b.EsriPromiseMixin=v;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/loadAll":function(){define(["exports",
"./asyncUtils","./Collection","./Loadable"],function(b,d,A,u){async function I(p,f){const v=[],g=(...w)=>{for(const C of w)null!=C&&(Array.isArray(C)?g(...C):A.isCollection(C)?C.forEach(B=>g(B)):u.isLoadable(C)&&v.push(C))};f(g);let t=null;await d.map(v,async w=>{w=await d.result("loadAll"in w&&"function"===typeof w.loadAll?w.loadAll():w.load());!1!==w.ok||t||(t=w)});if(t)throw t.error;return p}b.loadAll=async function(p,f){await p.load();return I(p,f)};b.loadAllChildren=I;Object.defineProperty(b,
Symbol.toStringTag,{value:"Module"})})},"esri/portal/Portal":function(){define("require ../chunks/tslib.es6 ../config ../kernel ../request ../core/Error ../core/JSONSupport ../core/Loadable ../core/maybe ../core/promiseUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../geometry/Extent ../intl/locale ./portalDefault ./PortalGroup ./PortalQueryParams ./PortalQueryResult ./PortalUser ../support/apiKeyUtils".split(" "),
function(b,d,A,u,I,p,f,v,g,t,w,C,B,r,l,a,q,y,F,Q,e,H,S,J){function R(x){const M=u.id;return()=>{const L=x.deref();L&&M.findCredential(L.restUrl)&&L.signIn().catch(()=>{})}}const P=x=>Object.freeze(Object.defineProperty({__proto__:null,default:x},Symbol.toStringTag,{value:"Module"}));var V;let m;const O={PortalGroup:()=>Promise.resolve({default:Q}),PortalItem:()=>new Promise((x,M)=>b(["./PortalItem"],L=>x(P(L)),M)),PortalUser:()=>Promise.resolve({default:S})};f=V=class extends f.JSONSupportMixin(v){constructor(x){super(x);
this.access=this._esriIdCredentialCreateHandle=null;this.allSSL=!1;this.authMode="auto";this.bingKey=this.basemapGalleryGroupQuery3D=this.basemapGalleryGroupQuery=this.authorizedCrossOriginDomains=null;this.canProvisionDirectPurchase=this.canListPreProvisionedItems=this.canListData=this.canListApps=!1;this.canSearchPublic=!0;this.canSignInIDP=this.canSignInArcGIS=this.canSharePublic=this.canShareBingPublic=!1;this.colorSetsGroupQuery=null;this.commentsEnabled=!1;this.livingAtlasGroupQuery=this.galleryTemplatesGroupQuery=
this.featuredItemsGroupQuery=this.featuredGroups=this.eueiEnabled=this.devBasemapGalleryGroupQuery=this.description=this.defaultVectorBasemap=this.defaultExtent=this.defaultDevBasemap=this.defaultBasemap=this.customBaseUrl=this.culture=this.created=null;this.hasCategorySchema=!1;this.ipCntryCode=this.id=this.httpsPort=this.httpPort=this.homePageFeaturedContentCount=this.homePageFeaturedContent=this.helperServices=null;this.isReadOnly=this.isPortal=!1;this.rotatorPanels=this.region=this.portalProperties=
this.portalMode=this.portalHostname=this.name=this.modified=this.maxTokenExpirationMinutes=this.layerTemplatesGroupQuery=null;this.showHomePageDescription=!1;this.sourceJSON=null;this.supportsHostedServices=!1;this.units=this.templatesGroupQuery=this.symbolSetsGroupQuery=null;this.url=A.portalUrl;this.user=this.urlKey=null;this.use3dBasemaps=!0;this.useVectorBasemaps=this.useStandardizedQuery=!1;this.vectorBasemapGalleryGroupQuery=null}normalizeCtorArgs(x){return"string"===typeof x?{url:x}:x}destroy(){n.unregister(this);
this.defaultBasemap=g.destroyMaybe(this.defaultBasemap);this.defaultDevBasemap=g.destroyMaybe(this.defaultDevBasemap);this.defaultVectorBasemap=g.destroyMaybe(this.defaultVectorBasemap);this._esriIdCredentialCreateHandle=g.removeMaybe(this._esriIdCredentialCreateHandle)}readAuthorizedCrossOriginDomains(x){if(x)for(const M of x)A.request.trustedServers.includes(M)||A.request.trustedServers.push(M);return x}readDefaultBasemap(x){return this._readBasemap(x)}readDefaultDevBasemap(x){return this._readBasemap(x)}readDefaultVectorBasemap(x){return this._readBasemap(x)}get extraQuery(){const x=
!this.user?.orgId||this.canSearchPublic;return this.id&&!x?` AND orgid:${this.id}`:null}get isOrganization(){return!!this.access}get itemPageUrl(){return this.url?`${this.url}/home/item.html`:null}get restUrl(){let x=this.url;if(x){const M=x.indexOf("/sharing");x=0<M?x.substring(0,M):this.url.replace(/\/+$/,"");x+="/sharing/rest"}return x}get thumbnailUrl(){const x=this.restUrl,M=this.thumbnail;return x&&M?this._normalizeSSL(x+"/portals/self/resources/"+M):null}readUrlKey(x){return x?x.toLowerCase():
x}readUser(x){let M=null;x&&(M=S.fromJSON(x),M.portal=this);return M}load(x){const M=(new Promise((L,T)=>b(["../Basemap"],Y=>L(P(Y)),T))).then(({default:L})=>{t.throwIfAborted(x);m=L}).then(()=>this.sourceJSON?this.sourceJSON:this.fetchSelf(this.authMode,!1,x)).then(L=>{if(u.id){const T=u.id;this.credential=T.findCredential(this.restUrl);this.credential||this.authMode!==V.AUTH_MODE_AUTO||(this._esriIdCredentialCreateHandle?.remove(),this._esriIdCredentialCreateHandle=T.on("credential-create",R(new WeakRef(this))),
n.register(this,this._esriIdCredentialCreateHandle,this))}this.sourceJSON=L;this.read(L)});this.addResolvingPromise(M);return Promise.resolve(this)}async createElevationLayers(){await this.load();const x=this._getHelperService("defaultElevationLayers"),M=(await new Promise((L,T)=>b(["../layers/ElevationLayer"],Y=>L(P(Y)),T))).default;return x?x.map(L=>new M({id:L.id,url:L.url})):[]}async fetchBasemaps(x,M){const L=await this._fetchBasemaps(x,M);!0===M?.include3d&&!1!==this.use3dBasemaps&&(x=await this._fetchBasemaps3D(x,
M),L.unshift(...x));return L}fetchCategorySchema(x){return this.hasCategorySchema?this.request(this.restUrl+"/portals/self/categorySchema",x).then(M=>M.categorySchema):t.isAborted(x)?Promise.reject(t.createAbortError()):Promise.resolve([])}fetchFeaturedGroups(x){const M=this.featuredGroups,L=new e;L.num=100;L.sortField="title";if(M&&M.length){const T=[];for(const Y of M)T.push(`(title:"${Y.title}" AND owner:${Y.owner})`);L.query=T.join(" OR ");return this.queryGroups(L,x).then(Y=>Y.results)}return t.isAborted(x)?
Promise.reject(t.createAbortError()):Promise.resolve([])}fetchRegions(x){const M=this.user?.culture||this.culture||y.getLocale();return this.request(this.restUrl+"/portals/regions",{...x,query:{culture:M}})}fetchSettings(x){const M=this.user?.culture||this.culture||y.getLocale();return this.request(this.restUrl+"/portals/self/settings",{...x,query:{culture:M}})}static getDefault(){return F.ensureDefaultPortalInstance(()=>new V)}queryGroups(x,M){return this.queryPortal("/community/groups",x,"PortalGroup",
M)}queryItems(x,M){return this.queryPortal("/search",x,"PortalItem",M)}queryUsers(x,M){x.sortField||(x.sortField="username");return this.queryPortal("/community/users",x,"PortalUser",M)}fetchSelf(x=this.authMode,M=!1,L){const T=this.restUrl+"/portals/self";x={authMode:x,query:{culture:y.getLocale().toLowerCase()},...L};"auto"===x.authMode&&(x.authMode="no-prompt");M&&(x.query.default=!0);return this.request(T,x)}queryPortal(x,M,L,T){const Y=C.ensureType(e,M),fa=oa=>this.request(this.restUrl+x,{...Y.toRequestOptions(this),
...T}).then(sa=>{const ca=Y.clone();ca.start=sa.nextStart;return new H({nextQueryParams:ca,queryParams:Y,total:sa.total,results:V._resultsToTypedArray(oa,{portal:this},sa,T)})}).then(sa=>Promise.all(sa.results.map(ca=>"function"===typeof ca.when?ca.when():sa)).then(()=>sa,ca=>{t.throwIfAbortError(ca);return sa}));return L&&O[L]?O[L]().then(({default:oa})=>{t.throwIfAborted(T);return fa(oa)}):fa()}signIn(){if(this.authMode===V.AUTH_MODE_ANONYMOUS)return Promise.reject(new p("portal:invalid-auth-mode",
`Current "authMode"' is "${this.authMode}"`));if("failed"===this.loadStatus)return Promise.reject(this.loadError);const x=M=>Promise.resolve().then(()=>{if("not-loaded"===this.loadStatus)return M||(this.authMode="immediate"),this.load().then(()=>null);if("loading"===this.loadStatus)return this.load().then(()=>{if(this.credential)return null;this.credential=M;return this.fetchSelf("immediate")});if(this.user&&this.credential===M)return null;this.credential=M;return this.fetchSelf("immediate")}).then(L=>
{L&&(this.sourceJSON=L,this.read(L))});return u.id?u.id.getCredential(this.restUrl).then(M=>x(M)):x(this.credential)}normalizeUrl(x){const M=this.credential?.token;return this._normalizeSSL(M?x+(x.includes("?")?"\x26":"?")+"token\x3d"+M:x)}requestToTypedArray(x,M,L){return this.request(x,M).then(T=>{const Y=V._resultsToTypedArray(L,{portal:this},T);return Promise.all(Y.map(fa=>"function"===typeof fa.when?fa.when():T)).then(()=>Y,()=>Y)})}request(x,M={}){const L={f:"json",...M.query},{authMode:T=this.authMode===
V.AUTH_MODE_ANONYMOUS?"anonymous":"auto",body:Y=null,cacheBust:fa=!1,method:oa="auto",responseType:sa="json",signal:ca}=M;M={authMode:T,body:Y,cacheBust:fa,method:oa,query:L,responseType:sa,timeout:0,signal:ca};return I(this._normalizeSSL(x),M).then(ka=>ka.data)}toJSON(){throw new p("internal:not-yet-implemented","Portal.toJSON is not yet implemented");}static fromJSON(x){if(!x)return null;if(x.declaredClass)throw Error("JSON object is already hydrated");return new V({sourceJSON:x})}_getHelperService(x){const M=
this.helperServices&&this.helperServices[x];if(!M)throw new p("portal:service-not-found",`The \`helperServices\` do not include an entry named "${x}"`);return M}async _fetchBasemaps(x,M){const L=new e;L.query=x||(A.apiKey&&J.supportsApiKey(this.url)?this.devBasemapGalleryGroupQuery:this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery);L.disableExtraQuery=!0;x=await this.queryGroups(L,M);if(!x.total)return[];x=x.results[0];L.num=100;L.query='type:"Web Map" -type:"Web Application"';
L.sortField=x.sortField||"name";L.sortOrder=x.sortOrder||"desc";M=await x.queryItems(L,M);return M.total?M.results.filter(T=>"Web Map"===T.type).map(T=>new m({portalItem:T})):[]}async _fetchBasemaps3D(x,M){x=x||this.basemapGalleryGroupQuery3D;if(!x)return[];x=new e({query:x,disableExtraQuery:!0});var L=await this.queryGroups(x,M);if(!L.total)return[];L=L.results[0];x.num=100;x.query='type:"Web Scene"';x.sortField=L.sortField||"name";x.sortOrder=L.sortOrder||"desc";M=await L.queryItems(x,M);return M.total?
M.results.filter(T=>"Web Scene"===T.type).map(T=>new m({portalItem:T})):[]}_normalizeSSL(x){return x.replace(/^http:/i,"https:").replace(":7080",":7443")}_readBasemap(x){return x?(x=m.fromJSON(x),x.portalItem={portal:this},x):null}static _resultsToTypedArray(x,M,L,T){let Y=[];if(L){const fa=null!=T?T.signal:null;Y=L.listings||L.notifications||L.userInvitations||L.tags||L.items||L.groups||L.comments||L.provisions||L.results||L.relatedItems||L;if(x||M)Y=Y.map(oa=>{oa=Object.assign(x?x.fromJSON(oa):
oa,M);"function"===typeof oa.load&&oa.load(fa);return oa})}else Y=[];return Y}};f.AUTH_MODE_ANONYMOUS="anonymous";f.AUTH_MODE_AUTO="auto";f.AUTH_MODE_IMMEDIATE="immediate";d.__decorate([w.property()],f.prototype,"access",void 0);d.__decorate([w.property()],f.prototype,"allSSL",void 0);d.__decorate([w.property()],f.prototype,"authMode",void 0);d.__decorate([w.property()],f.prototype,"authorizedCrossOriginDomains",void 0);d.__decorate([l.reader("authorizedCrossOriginDomains")],f.prototype,"readAuthorizedCrossOriginDomains",
null);d.__decorate([w.property()],f.prototype,"basemapGalleryGroupQuery",void 0);d.__decorate([w.property({json:{name:"3DBasemapGalleryGroupQuery"}})],f.prototype,"basemapGalleryGroupQuery3D",void 0);d.__decorate([w.property()],f.prototype,"bingKey",void 0);d.__decorate([w.property()],f.prototype,"canListApps",void 0);d.__decorate([w.property()],f.prototype,"canListData",void 0);d.__decorate([w.property()],f.prototype,"canListPreProvisionedItems",void 0);d.__decorate([w.property()],f.prototype,"canProvisionDirectPurchase",
void 0);d.__decorate([w.property()],f.prototype,"canSearchPublic",void 0);d.__decorate([w.property()],f.prototype,"canShareBingPublic",void 0);d.__decorate([w.property()],f.prototype,"canSharePublic",void 0);d.__decorate([w.property()],f.prototype,"canSignInArcGIS",void 0);d.__decorate([w.property()],f.prototype,"canSignInIDP",void 0);d.__decorate([w.property()],f.prototype,"colorSetsGroupQuery",void 0);d.__decorate([w.property()],f.prototype,"commentsEnabled",void 0);d.__decorate([w.property({type:Date})],
f.prototype,"created",void 0);d.__decorate([w.property()],f.prototype,"credential",void 0);d.__decorate([w.property()],f.prototype,"culture",void 0);d.__decorate([w.property()],f.prototype,"currentVersion",void 0);d.__decorate([w.property()],f.prototype,"customBaseUrl",void 0);d.__decorate([w.property()],f.prototype,"defaultBasemap",void 0);d.__decorate([l.reader("defaultBasemap")],f.prototype,"readDefaultBasemap",null);d.__decorate([w.property()],f.prototype,"defaultDevBasemap",void 0);d.__decorate([l.reader("defaultDevBasemap")],
f.prototype,"readDefaultDevBasemap",null);d.__decorate([w.property({type:q})],f.prototype,"defaultExtent",void 0);d.__decorate([w.property()],f.prototype,"defaultVectorBasemap",void 0);d.__decorate([l.reader("defaultVectorBasemap")],f.prototype,"readDefaultVectorBasemap",null);d.__decorate([w.property()],f.prototype,"description",void 0);d.__decorate([w.property()],f.prototype,"devBasemapGalleryGroupQuery",void 0);d.__decorate([w.property()],f.prototype,"eueiEnabled",void 0);d.__decorate([w.property({readOnly:!0})],
f.prototype,"extraQuery",null);d.__decorate([w.property()],f.prototype,"featuredGroups",void 0);d.__decorate([w.property()],f.prototype,"featuredItemsGroupQuery",void 0);d.__decorate([w.property()],f.prototype,"galleryTemplatesGroupQuery",void 0);d.__decorate([w.property()],f.prototype,"livingAtlasGroupQuery",void 0);d.__decorate([w.property()],f.prototype,"hasCategorySchema",void 0);d.__decorate([w.property()],f.prototype,"helpBase",void 0);d.__decorate([w.property()],f.prototype,"helperServices",
void 0);d.__decorate([w.property()],f.prototype,"helpMap",void 0);d.__decorate([w.property()],f.prototype,"homePageFeaturedContent",void 0);d.__decorate([w.property()],f.prototype,"homePageFeaturedContentCount",void 0);d.__decorate([w.property()],f.prototype,"httpPort",void 0);d.__decorate([w.property()],f.prototype,"httpsPort",void 0);d.__decorate([w.property()],f.prototype,"id",void 0);d.__decorate([w.property()],f.prototype,"ipCntryCode",void 0);d.__decorate([w.property({readOnly:!0})],f.prototype,
"isOrganization",null);d.__decorate([w.property()],f.prototype,"isPortal",void 0);d.__decorate([w.property()],f.prototype,"isReadOnly",void 0);d.__decorate([w.property({readOnly:!0})],f.prototype,"itemPageUrl",null);d.__decorate([w.property()],f.prototype,"layerTemplatesGroupQuery",void 0);d.__decorate([w.property()],f.prototype,"maxTokenExpirationMinutes",void 0);d.__decorate([w.property({type:Date})],f.prototype,"modified",void 0);d.__decorate([w.property()],f.prototype,"name",void 0);d.__decorate([w.property()],
f.prototype,"portalHostname",void 0);d.__decorate([w.property()],f.prototype,"portalMode",void 0);d.__decorate([w.property()],f.prototype,"portalProperties",void 0);d.__decorate([w.property()],f.prototype,"region",void 0);d.__decorate([w.property({readOnly:!0})],f.prototype,"restUrl",null);d.__decorate([w.property()],f.prototype,"rotatorPanels",void 0);d.__decorate([w.property()],f.prototype,"showHomePageDescription",void 0);d.__decorate([w.property()],f.prototype,"sourceJSON",void 0);d.__decorate([w.property()],
f.prototype,"staticImagesUrl",void 0);d.__decorate([w.property({json:{name:"2DStylesGroupQuery"}})],f.prototype,"stylesGroupQuery2d",void 0);d.__decorate([w.property({json:{name:"stylesGroupQuery"}})],f.prototype,"stylesGroupQuery3d",void 0);d.__decorate([w.property()],f.prototype,"supportsHostedServices",void 0);d.__decorate([w.property()],f.prototype,"symbolSetsGroupQuery",void 0);d.__decorate([w.property()],f.prototype,"templatesGroupQuery",void 0);d.__decorate([w.property()],f.prototype,"thumbnail",
void 0);d.__decorate([w.property({readOnly:!0})],f.prototype,"thumbnailUrl",null);d.__decorate([w.property()],f.prototype,"units",void 0);d.__decorate([w.property()],f.prototype,"url",void 0);d.__decorate([w.property()],f.prototype,"urlKey",void 0);d.__decorate([l.reader("urlKey")],f.prototype,"readUrlKey",null);d.__decorate([w.property()],f.prototype,"user",void 0);d.__decorate([l.reader("user")],f.prototype,"readUser",null);d.__decorate([w.property()],f.prototype,"use3dBasemaps",void 0);d.__decorate([w.property()],
f.prototype,"useStandardizedQuery",void 0);d.__decorate([w.property()],f.prototype,"useVectorBasemaps",void 0);d.__decorate([w.property()],f.prototype,"vectorBasemapGalleryGroupQuery",void 0);d=f=V=d.__decorate([a.subclass("esri.portal.Portal")],f);const n=new FinalizationRegistry(x=>{x.remove()});return d})},"esri/portal/portalDefault":function(){define(["exports"],function(b){let d;b.clearDefaultPortalInstance=function(){d=void 0};b.ensureDefaultPortalInstance=function(A){if(!d||d.destroyed)d=A();
return d};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/portal/PortalGroup":function(){define("../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./PortalQueryParams".split(" "),function(b,d,A,u,I,p,f,v,g){var t;A=t=class extends A.JSONSupport{constructor(w){super(w);this.id=this.description=this.created=this.access=null;
this.isInvitationOnly=!1;this.title=this.tags=this.sourceJSON=this.sortOrder=this.sortField=this.snippet=this.portal=this.owner=this.modified=null}get thumbnailUrl(){const w=this.url,C=this.thumbnail;return w&&C&&this.portal?this.portal?.normalizeUrl(`${w}/info/${C}?f=json`):null}get url(){const w=this.portal?.restUrl;return w?w+"/community/groups/"+this.id:null}fetchCategorySchema(w){return this.portal.request(this.url+"/categorySchema",w).then(C=>{C=C.categorySchema||[];return C.some(B=>"contentCategorySetsGroupQuery.LivingAtlas"===
B.source)?this._fetchCategorySchemaSet("LivingAtlas",w):C})}fetchMembers(w){return this.portal.request(this.url+"/users",w)}getThumbnailUrl(w){let C=this.thumbnailUrl;C&&w&&(C+=`&w=${w}`);return C}toJSON(){throw new d("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented");}static fromJSON(w){if(!w)return null;if(w.declaredClass)throw Error("JSON object is already hydrated");const C=new t;C.sourceJSON=w;C.read(w);return C}queryItems(w,C){w=I.ensureType(g,w);const B=this.portal;
if(5<parseFloat(B.currentVersion))return w=w||new g,B.queryPortal(`/content/groups/${this.id}/search`,w,"PortalItem",C);w=w?w.clone():new g;w.query="group:"+this.id+(w.query?" "+w.query:"");return B.queryItems(w,C)}_fetchCategorySchemaSet(w,C){const B=this.portal;return B.fetchSelf(B.authMode,!0,C).then(r=>{if(r=r.contentCategorySetsGroupQuery){const l=new g;l.disableExtraQuery=!0;l.num=1;l.query=r;return B.queryGroups(l,C)}throw new d("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found");
}).then(r=>{if(r.total){r=r.results[0];const l=new g;l.num=1;l.query=`typekeywords:"${w}"`;return r.queryItems(l,C)}throw new d("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found");}).then(r=>r.total?r.results[0].fetchData("json",C).then(l=>{l=l?.categorySchema;return l?.length?l:[]}):[])}};b.__decorate([u.property()],A.prototype,"access",void 0);b.__decorate([u.property({type:Date})],A.prototype,"created",void 0);b.__decorate([u.property()],A.prototype,"description",
void 0);b.__decorate([u.property()],A.prototype,"id",void 0);b.__decorate([u.property()],A.prototype,"isInvitationOnly",void 0);b.__decorate([u.property({type:Date})],A.prototype,"modified",void 0);b.__decorate([u.property()],A.prototype,"owner",void 0);b.__decorate([u.property()],A.prototype,"portal",void 0);b.__decorate([u.property()],A.prototype,"snippet",void 0);b.__decorate([u.property()],A.prototype,"sortField",void 0);b.__decorate([u.property()],A.prototype,"sortOrder",void 0);b.__decorate([u.property()],
A.prototype,"sourceJSON",void 0);b.__decorate([u.property()],A.prototype,"tags",void 0);b.__decorate([u.property()],A.prototype,"thumbnail",void 0);b.__decorate([u.property({readOnly:!0})],A.prototype,"thumbnailUrl",null);b.__decorate([u.property()],A.prototype,"title",void 0);b.__decorate([u.property({readOnly:!0})],A.prototype,"url",null);return A=t=b.__decorate([v.subclass("esri.portal.PortalGroup")],A)})},"esri/portal/PortalQueryParams":function(){define("../chunks/tslib.es6 ../core/Accessor ../core/jsonMap ../core/lang ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ../geometry/Extent ../geometry/SpatialReference ../geometry/support/webMercatorUtils".split(" "),
function(b,d,A,u,I,p,f,v,g,t){var w;const C=new A.JSONMap({avgRating:"avg-rating",numRatings:"num-ratings",numComments:"num-comments",numViews:"num-views"});d=w=class extends d{constructor(B){super(B);this.categories=null;this.disableExtraQuery=!1;this.filter=this.extent=null;this.num=10;this.sortField=this.query=null;this.start=1}get sortOrder(){return this._get("sortOrder")||"asc"}set sortOrder(B){"asc"!==B&&"desc"!==B||this._set("sortOrder",B)}clone(){return new w({categories:this.categories?u.clone(this.categories):
null,disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():null,filter:this.filter,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})}toRequestOptions(B,r){let l=[];this.categories&&(l=this.categories.map(y=>Array.isArray(y)?JSON.stringify(y):y));let a="";if(this.extent){var q=t.project(this.extent,g.WGS84);null!=q&&(a=`${q.xmin},${q.ymin},${q.xmax},${q.ymax}`)}q=this.query;!this.disableExtraQuery&&B.extraQuery&&(q="("+q+")"+
B.extraQuery);B={categories:l,bbox:a,q,filter:this.filter,num:this.num,sortField:null,sortOrder:null,start:this.start};this.sortField&&(B.sortField=this.sortField.split(",").map(y=>C.toJSON(y.trim())).join(","),B.sortOrder=this.sortOrder);return{query:{...r,...B}}}};b.__decorate([I.property()],d.prototype,"categories",void 0);b.__decorate([I.property()],d.prototype,"disableExtraQuery",void 0);b.__decorate([I.property({type:v})],d.prototype,"extent",void 0);b.__decorate([I.property()],d.prototype,
"filter",void 0);b.__decorate([I.property()],d.prototype,"num",void 0);b.__decorate([I.property()],d.prototype,"query",void 0);b.__decorate([I.property()],d.prototype,"sortField",void 0);b.__decorate([I.property()],d.prototype,"sortOrder",null);b.__decorate([I.property()],d.prototype,"start",void 0);return d=w=b.__decorate([f.subclass("esri.portal.PortalQueryParams")],d)})},"esri/portal/PortalQueryResult":function(){define("../chunks/tslib.es6 ../core/Accessor ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass".split(" "),
function(b,d,A,u,I,p,f){d=class extends d{constructor(v){super(v);this.total=this.results=this.queryParams=this.nextQueryParams=null}};b.__decorate([A.property()],d.prototype,"nextQueryParams",void 0);b.__decorate([A.property()],d.prototype,"queryParams",void 0);b.__decorate([A.property()],d.prototype,"results",void 0);b.__decorate([A.property()],d.prototype,"total",void 0);return d=b.__decorate([f.subclass("esri.portal.PortalQueryResult")],d)})},"esri/portal/PortalUser":function(){define("require ../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./PortalFolder ./PortalGroup".split(" "),
function(b,d,A,u,I,p,f,v,g,t,w){var C;u=C=class extends u.JSONSupport{constructor(...B){super(...B);this.userType=this.username=this.units=this.sourceJSON=this.roleId=this.role=this.region=this.privileges=this.preferredView=this.portal=this.orgId=this.modified=this.fullName=this.email=this.description=this.culture=this.created=this.access=null}get thumbnailUrl(){const B=this.url,r=this.thumbnail;return B&&r?this.portal.normalizeUrl(`${B}/info/${r}?f=json`):null}get userContentUrl(){const B=this.portal?.restUrl;
return B?`${B}/content/users/${this.username}`:null}get url(){const B=this.portal?.restUrl;return B?`${B}/community/users/${this.username}`:null}addItem(B){const r=B&&B.item;var l=B?.data;B=B?.folder;const a={method:"post"};r&&(a.query=r.createPostQuery(),null!=l&&("string"===typeof l?a.query.text=l:"object"===typeof l&&(a.query.text=JSON.stringify(l))));l=this.userContentUrl;B&&(l+="/"+("string"===typeof B?B:B.id));return this.portal.request(l+"/addItem",a).then(q=>{r.id=q.id;r.portal=this.portal;
return r.loaded?r.reload():r.load()})}deleteItem(B){let r=this.userContentUrl;B.ownerFolder&&(r+="/"+B.ownerFolder);return this.portal.request(r+`/items/${B.id}/delete`,{method:"post"}).then(()=>{B.id=null;B.portal=null})}deleteItems(B){const r=this.userContentUrl+"/deleteItems";var l=B.map(a=>a.id);return l.length?(l={method:"post",query:{items:l.join(",")}},this.portal.request(r,l).then(()=>{B.forEach(a=>{a.id=null;a.portal=null})})):Promise.resolve(void 0)}fetchFolders(){return this.portal.request(this.userContentUrl??
"",{query:{num:1}}).then(B=>B&&B.folders?B.folders.map(r=>{r=t.fromJSON(r);r.portal=this.portal;return r}):[])}fetchGroups(){return this.portal.request(this.url??"").then(B=>B&&B.groups?B.groups.map(r=>{r=w.fromJSON(r);r.portal=this.portal;return r}):[])}fetchItems(B){const r=B??{};let l=this.userContentUrl??"";r.folder&&(l+="/"+r.folder.id);let a;return(new Promise((q,y)=>b(["./PortalItem"],F=>q(Object.freeze(Object.defineProperty({__proto__:null,default:F},Symbol.toStringTag,{value:"Module"}))),
y))).then(({default:q})=>{a=q;return this.portal.request(l,{query:{folders:!1,num:r.num||10,start:r.start||1,sortField:r.sortField||"created",sortOrder:r.sortOrder||"asc"}})}).then(q=>{let y;return q?.items?(y=q.items.map(F=>{F=a.fromJSON(F);F.portal=this.portal;return F}),Promise.all(y.map(F=>F.load())).catch(F=>F).then(()=>({items:y,nextStart:q.nextStart,total:q.total}))):{items:[],nextStart:-1,total:0}})}fetchTags(){return this.portal.request(this.url+"/tags").then(B=>B.tags)}getThumbnailUrl(B){let r=
this.thumbnailUrl;r&&B&&(r+=`&w=${B}`);return r}queryFavorites(B){return this.favGroupId?(this._favGroup||(this._favGroup=new w({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(B)):Promise.reject(new A("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))}toJSON(){throw new A("internal:not-yet-implemented","PortalUser.toJSON is not yet implemented");}static fromJSON(B){if(!B)return null;if(B.declaredClass)throw Error("JSON object is already hydrated");
const r=new C;r.sourceJSON=B;r.read(B);return r}};d.__decorate([I.property()],u.prototype,"access",void 0);d.__decorate([I.property({type:Date})],u.prototype,"created",void 0);d.__decorate([I.property()],u.prototype,"culture",void 0);d.__decorate([I.property()],u.prototype,"description",void 0);d.__decorate([I.property()],u.prototype,"email",void 0);d.__decorate([I.property()],u.prototype,"favGroupId",void 0);d.__decorate([I.property()],u.prototype,"fullName",void 0);d.__decorate([I.property({type:Date})],
u.prototype,"modified",void 0);d.__decorate([I.property()],u.prototype,"orgId",void 0);d.__decorate([I.property()],u.prototype,"portal",void 0);d.__decorate([I.property()],u.prototype,"preferredView",void 0);d.__decorate([I.property()],u.prototype,"privileges",void 0);d.__decorate([I.property()],u.prototype,"region",void 0);d.__decorate([I.property()],u.prototype,"role",void 0);d.__decorate([I.property()],u.prototype,"roleId",void 0);d.__decorate([I.property()],u.prototype,"sourceJSON",void 0);d.__decorate([I.property()],
u.prototype,"thumbnail",void 0);d.__decorate([I.property({readOnly:!0})],u.prototype,"thumbnailUrl",null);d.__decorate([I.property()],u.prototype,"units",void 0);d.__decorate([I.property({readOnly:!0})],u.prototype,"userContentUrl",null);d.__decorate([I.property({readOnly:!0})],u.prototype,"url",null);d.__decorate([I.property()],u.prototype,"username",void 0);d.__decorate([I.property()],u.prototype,"userType",void 0);return u=C=d.__decorate([g.subclass("esri.portal.PortalUser")],u)})},"esri/portal/PortalFolder":function(){define("../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass".split(" "),
function(b,d,A,u,I,p,f,v){A=class extends A.JSONSupport{constructor(g){super(g);this.username=this.title=this.portal=this.id=this.created=null}get url(){const g=this.portal?.restUrl;return g?`${g}/content/users/${this.username}/${this.id}`:null}toJSON(){throw new d("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented");}};b.__decorate([u.property({type:Date})],A.prototype,"created",void 0);b.__decorate([u.property()],A.prototype,"id",void 0);b.__decorate([u.property()],A.prototype,
"portal",void 0);b.__decorate([u.property()],A.prototype,"title",void 0);b.__decorate([u.property({readOnly:!0})],A.prototype,"url",null);b.__decorate([u.property()],A.prototype,"username",void 0);return A=b.__decorate([v.subclass("esri.portal.PortalFolder")],A)})},"esri/portal/PortalItem":function(){define("require ../chunks/tslib.es6 ../assets ../kernel ../core/Error ../core/JSONSupport ../core/lang ../core/Loadable ../core/urlUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../geometry/Extent ./Portal ./PortalItemResource ./PortalRating".split(" "),
function(b,d,A,u,I,p,f,v,g,t,w,C,B,r,l,a,q){var y;const F=new Set("Map Service;Feature Service;Feature Collection;Scene Service;Image Service;Stream Service;Vector Tile Service;GeoJson;CSV;KML;WFS;WMTS;WMS;Feed".split(";")),Q=new Set(["KML","GeoJson","CSV"]);p=y=class extends p.JSONSupportMixin(v){static from(e){return w.ensureClass(y,e)}constructor(e){super(e);this.id=this.groupCategories=this.extent=this.description=this.culture=this.created=this.categories=this.avgRating=this.applicationProxies=
this.apiKey=this.accessInformation=this.access=null;this.isOrgItem=!1;this.url=this.typeKeywords=this.type=this.title=this.tags=this.spatialReference=this.sourceUrl=this.sourceJSON=this.snippet=this.size=this.screenshots=this.portal=this.ownerFolder=this.owner=this.numViews=this.numRatings=this.numComments=this.name=this.modified=this.licenseInfo=this.itemControl=null}destroy(){this.portal=null}get displayName(){const e=this.type,H=this.typeKeywords||[];let S=e;"Feature Service"===e||"Feature Collection"===
e?S=H.includes("Table")?"Table":H.includes("Route Layer")?"Route Layer":H.includes("Markup")?"Markup":"Feature Layer":"Image Service"===e?S=H.includes("Elevation 3D Layer")?"Elevation Layer":H.includes("Tiled Imagery")?"Tiled Imagery Layer":"Imagery Layer":"Scene Service"===e?S="Scene Layer":"Video Service"===e?S="Video Layer":"Scene Package"===e?S="Scene Layer Package":"Stream Service"===e?S="Feature Layer":"Geoprocessing Service"===e?S=H.includes("Web Tool")?"Tool":"Geoprocessing Service":"Geocoding Service"===
e?S="Locator":"Geoenrichment Service"===e?S="GeoEnrichment Service":"Microsoft Powerpoint"===e?S="Microsoft PowerPoint":"GeoJson"===e?S="GeoJSON":"Globe Service"===e?S="Globe Layer":"Vector Tile Service"===e?S="Tile Layer":"netCDF"===e?S="NetCDF":"Map Service"===e?S=H.includes("Spatiotemporal")||!H.includes("Hosted Service")&&!H.includes("Tiled")||H.includes("Relational")?"Map Image Layer":"Tile Layer":e&&e.toLowerCase().includes("add in")?S=e.replaceAll(/(add in)/gi,"Add-In"):"datastore catalog service"===
e?S="Big Data File Share":"Compact Tile Package"===e?S="Tile Package (tpkx)":"OGCFeatureServer"===e?S="OGC Feature Layer":"web mapping application"===e&&H.includes("configurableApp")?S="Instant App":"Insights Page"===e?S="Insights Report":"Excalibur Imagery Project"===e&&(S="Excalibur Project");return S}readExtent(e){return e&&e.length?new r(e[0][0],e[0][1],e[1][0],e[1][1]):null}get iconUrl(){var e=this.type?.toLowerCase()||"";const H=this.typeKeywords||[];var S=!1;let J=!1,R=!1,P=!1,V=!1,m=!1;S=
!1;0<e.indexOf("service")||"feature collection"===e||"kml"===e||"wms"===e||"wmts"===e||"wfs"===e?(S=H.includes("Hosted Service"),"feature service"===e||"feature collection"===e||"kml"===e||"wfs"===e?(J=H.includes("Table"),R=H.includes("Route Layer"),P=H.includes("Markup"),V=H.includes("Spatiotemporal"),m=H.includes("UtilityNetwork"),e=V&&J?"spatiotemporaltable":J?"table":R?"routelayer":P?"markup":V?"spatiotemporal":S?"featureshosted":m?"utilitynetwork":"features"):e="map service"===e||"wms"===e||
"wmts"===e?S||H.includes("Tiled")||"wmts"===e?"maptiles":"mapimages":"scene service"===e?H.includes("Line")?"sceneweblayerline":H.includes("3DObject")?"sceneweblayermultipatch":H.includes("Point")?"sceneweblayerpoint":H.includes("IntegratedMesh")?"sceneweblayermesh":H.includes("PointCloud")?"sceneweblayerpointcloud":H.includes("Polygon")?"sceneweblayerpolygon":H.includes("Building")?"sceneweblayerbuilding":H.includes("Voxel")?"sceneweblayervoxel":"sceneweblayer":"image service"===e?H.includes("Elevation 3D Layer")?
"elevationlayer":H.includes("Tiled Imagery")?"tiledimagerylayer":"imagery":"stream service"===e?"streamlayer":"video service"===e?H.includes("Live Stream")?"livestreamvideolayer":"videolayer":"vector tile service"===e?"vectortile":"datastore catalog service"===e?"datastorecollection":"geocoding service"===e?"geocodeservice":"geoprocessing service"===e?H.includes("Web Tool")?"tool":"layers":"geodata service"===e?"geodataservice":"3dtiles service"===e?"3dtileslayer":"layers"):e="web map"===e||"cityengine web scene"===
e?"maps":"web scene"===e?H.includes("ViewingMode-Local")?"webscenelocal":"websceneglobal":"web mapping application"===e&&H.includes("configurableApp")?"instantapps":"web mapping application"===e||"mobile application"===e||"application"===e||"operation view"===e||"desktop application"===e?"apps":"map document"===e||"map package"===e||"published map"===e||"scene document"===e||"globe document"===e||"basemap package"===e||"mobile basemap package"===e||"mobile map package"===e||"project package"===e||
"project template"===e||"pro map"===e||"layout"===e||"layer"===e&&H.includes("ArcGIS Pro")||"explorer map"===e&&H.indexOf("Explorer Document")?"mapsgray":"service definition"===e||"csv"===e||"shapefile"===e||"cad drawing"===e||"geojson"===e||"netcdf"===e||"administrative report"===e?"datafiles":"explorer add in"===e||"desktop add in"===e||"windows viewer add in"===e||"windows viewer configuration"===e?"appsgray":"360 vr experience"===e?"360vr":"arcgis pro add in"===e||"arcgis pro configuration"===
e?"addindesktop":"rule package"===e||"file geodatabase"===e||"sqlite geodatabase"===e||"csv collection"===e||"kml collection"===e||"windows mobile package"===e||"map template"===e||"desktop application template"===e||"gml"===e||"arcpad package"===e||"code sample"===e||"document link"===e||"earth configuration"===e||"operations dashboard add in"===e||"rules package"===e||"image"===e||"workflow manager package"===e||"explorer map"===e&&H.includes("Explorer Mapping Application")||H.includes("Document")?
"datafilesgray":"network analysis service"===e||"geoprocessing service"===e||"geodata service"===e||"geometry service"===e||"geoprocessing package"===e||"locator package"===e||"geoprocessing sample"===e||"workflow manager service"===e?"toolsgray":"layer"===e||"layer package"===e||"explorer layer"===e?"layersgray":"scene package"===e?"scenepackage":"3dtiles package"===e?"3dtileslayerpackage":"mobile scene package"===e?"mobilescenepackage":"tile package"===e||"compact tile package"===e?"tilepackage":
"task file"===e?"taskfile":"report template"===e?"report-template":"statistical data collection"===e?"statisticaldatacollection":"insights workbook"===e?"workbook":"insights model"===e?"insightsmodel":"insights page"===e?"insightspage":"insights theme"===e?"insightstheme":"hub initiative"===e?"hubinitiative":"hubpage"===e?"hubpage":"hub event"===e?"hubevent":"hub site application"===e?"hubsite":"hub project"===e?"hubproject":"relational database connection"===e?"relationaldatabaseconnection":"big data file share"===
e?"datastorecollection":"image collection"===e?"imagecollection":"style"===e?"style":"desktop style"===e?"desktopstyle":"dashboard"===e?"dashboard":"raster function template"===e?"rasterprocessingtemplate":"vector tile package"===e?"vectortilepackage":"ortho mapping project"===e?"orthomappingproject":"ortho mapping template"===e?"orthomappingtemplate":"solution"===e?"solutions":"geopackage"===e?"geopackage":"deep learning package"===e?"deeplearningpackage":"real time analytic"===e?"realtimeanalytics":
"big data analytic"===e?"bigdataanalytics":"feed"===e?"feed":"excalibur imagery project"===e?"excaliburimageryproject":"notebook"===e?"notebook":"storymap"===e?"storymap":"survey123 add in"===e?"survey123addin":"mission"===e?"mission":"mission report"===e?"missionreport":"mission template"===e?"missiontemplate":"quickcapture project"===e?"quickcaptureproject":"pro report"===e?"proreport":"pro report template"===e?"proreporttemplate":"urban model"===e?"urbanmodel":"web experience"===e?"experiencebuilder":
"web experience template"===e?"webexperiencetemplate":"experience builder widget"===e?"experiencebuilderwidget":"experience builder widget package"===e?"experiencebuilderwidgetpackage":"workflow"===e?"workflow":"insights script"===e?"insightsscript":"kernel gateway connection"===e?"kernelgatewayconnection":"hub initiative template"===e?"hubinitiativetemplate":"storymap theme"===e?"storymaptheme":"knowledge graph"===e?"knowledgegraph":"knowledge studio project"===e?"knowledgestudio":"native application"===
e?"nativeapp":"native application installer"===e?"nativeappinstaller":"link chart"===e?"linkchart":"investigation"===e?"investigation":"ogcfeatureserver"===e?"features":"pro project"===e?"proproject":"insights workbook package"===e?"insightsworkbookpackage":"apache parquet"===e?"apacheparquet":"notebook code snippets"===e||"notebook code snippet library"===e?"notebookcodesnippets":"suitability model"===e?"suitabilitymodel":"esri classifier definition"===e?"classifierdefinition":"esri classification schema"===
e?"classificationschema":"insights data engineering workbook"===e?"dataengineeringworkbook":"insights data engineering model"===e?"dataengineeringmodel":"deep learning studio project"===e?"deeplearningproject":"discussion"===e?"discussion":"allsource project"===e?"allsourceproject":"api key"===e?"apikey":"data pipeline"===e?"datapipelines":"group layer"===e?(S=H.includes("Map"))?"layergroup2d":"layergroup":"media layer"===e?"onlinemedialayer":"form"===e?H.includes("Survey123")?"survey":"datafilesgray":
"maps";return e?A.getAssetUrl("esri/images/portal/"+e+"16.png"):null}get isLayer(){return null!=this.type&&F.has(this.type)}get itemCdnUrl(){let e=this.itemUrl;e&&u.id&&!u.id.findCredential(e)&&(e=u.id._normalizeAGOLorgDomain(e),e=e.replace(/^https?:\/\/www\.arcgis\.com/,"https://cdn.arcgis.com"),e=e.replace(/^https?:\/\/devext\.arcgis\.com/,"https://cdndev.arcgis.com"),e=e.replace(/^https?:\/\/qaext\.arcgis\.com/,"https://cdnqa.arcgis.com"));return e}get itemPageUrl(){const e=this.portal?.itemPageUrl;
return e&&this.id?`${e}?id=${this.id}`:null}get itemUrl(){const e=this.portal?.restUrl;return e&&this.id?`${e}/content/items/${this.id}`:null}get thumbnailUrl(){const e=this.itemUrl,H=this.thumbnail;return e&&H?this.portal?.normalizeUrl(`${e}/info/${H}?f=json`)??null:null}get userItemUrl(){const e=this.portal?.restUrl;if(!e)return null;const H=this.owner||this.portal?.user?.username;return H?`${e}/content/users/${this.ownerFolder?`${H}/${this.ownerFolder}`:H}/items/${this.id}`:null}load(e){const H=
this.portal??(this.portal=l.getDefault()),S=H.load(e).then(()=>this.sourceJSON?this.sourceJSON:this.id&&this.itemUrl?H.request(this.itemUrl,{signal:null!=e?e.signal:null,query:{token:this.apiKey}}):{}).then(J=>{this.sourceJSON=J;this.read(J)});this.addResolvingPromise(S);return Promise.resolve(this)}async addRating(e){const H={method:"post",query:{}};e instanceof q&&(e=e.rating);null==e||isNaN(e)||"number"!==typeof e||(H.query.rating=e);if(!this.portal)return null;await this.portal.request(this.itemUrl+
"/addRating",H);return new q({rating:e,created:new Date})}clone(){var e={access:this.access,accessInformation:this.accessInformation,applicationProxies:f.clone(this.applicationProxies),avgRating:this.avgRating,categories:f.clone(this.categories),created:f.clone(this.created),culture:this.culture,description:this.description,extent:f.clone(this.extent),groupCategories:f.clone(this.groupCategories),id:this.id,itemControl:this.itemControl,licenseInfo:this.licenseInfo,modified:f.clone(this.modified),
name:this.name,numComments:this.numComments,numRatings:this.numRatings,numViews:this.numViews,owner:this.owner,ownerFolder:this.ownerFolder,portal:this.portal,screenshots:f.clone(this.screenshots),size:this.size,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:f.clone(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:f.clone(this.typeKeywords),url:this.url};this.loaded&&(e.loadStatus="loaded");e=(new y({sourceJSON:this.sourceJSON})).set(e);
e._set("isOrgItem",this.isOrgItem);return e}createPostQuery(){const e=this.toJSON();for(var H of["tags","typeKeywords","categories"])e[H]=e[H]?.join(", ");({extent:H}=e);H&&(e.extent=JSON.stringify(H));return e}async deleteRating(){await this.portal.request(this.itemUrl+"/deleteRating",{method:"post"})}fetchData(e="json",H){return this.portal.request(this.itemUrl+"/data",{responseType:e,...H,query:{token:this.apiKey}})}async fetchRating(e){e=await this.portal.request(this.itemUrl+"/rating",{query:{token:this.apiKey},
...e});return null!=e.rating?(e.created=new Date(e.created),new q(e)):null}fetchRelatedItems(e,H){return this.portal.requestToTypedArray(this.itemUrl+"/relatedItems",{query:{...e,token:this.apiKey},...H},y)}getThumbnailUrl(e){let H=this.thumbnailUrl;H&&e&&(H+=`&w=${e}`);return H}reload(){return this.portal.request(this.itemUrl??"",{cacheBust:!0,query:{token:this.apiKey}}).then(e=>{this.sourceJSON=e;this.read(e);return this})}update(e){return this.id?this.load().then(()=>this.portal.signIn()).then(()=>
{const H=e?.data,S={method:"post"};S.query=this.createPostQuery();for(const J in S.query)null===S.query[J]&&(S.query[J]="");S.query.clearEmptyFields=!0;null!=H&&("string"===typeof H?S.query.text=H:"object"===typeof H&&(S.query.text=JSON.stringify(H)));return this.portal.request(`${this.userItemUrl}/update`,S).then(()=>this.reload())}):Promise.reject(new I("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async copy(e){if(!this.id)throw new I("portal:item-does-not-exist",
"The item does not exist yet");await this.load();const {portal:H,itemUrl:S}=this;await H.signIn();const {copyResources:J,folder:R,tags:P,title:V}=e||{};e={method:"post",query:{copyPrivateResources:"all"===J,folder:"string"===typeof R?R:R?.id,includeResources:!!J,tags:P?.join(","),title:V}};({itemId:e}=await H.request(`${S}/copy`,e));return new y({id:e,portal:H})}updateThumbnail(e){return this.id?this.load().then(()=>this.portal.signIn()).then(()=>{const H=e.thumbnail,S=e.filename,J={method:"post"};
if("string"===typeof H)g.isDataProtocol(H)?J.query={data:H}:J.query={url:g.makeAbsolute(H)},null!=S&&(J.query.filename=S);else{const R=new FormData;null!=S?R.append("file",H,S):R.append("file",H);J.body=R}return this.portal.request(`${this.userItemUrl}/updateThumbnail`,J).then(()=>this.reload())}):Promise.reject(new I("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async fetchResources(e={},H){const {fetchResources:S}=await new Promise((J,R)=>b(["./support/resourceUtils"],
J,R));return S(this,e,H)}async addResource(e,H,S){const {addOrUpdateResource:J}=await new Promise((R,P)=>b(["./support/resourceUtils"],R,P));e.portalItem=this;return J(e,"add",H,S)}async removeResource(e,H){const {removeResource:S}=await new Promise((J,R)=>b(["./support/resourceUtils"],J,R));if(e.portalItem&&e.portalItem.itemUrl!==this.itemUrl)throw new I("removeresource:portal-item-mismatch","The portal item associated with the provided resource does not match the item");return S(this,e,H)}async removeAllResources(e){const {removeAllResources:H}=
await new Promise((S,J)=>b(["./support/resourceUtils"],S,J));return H(this,e)}resourceFromPath(e){return new a({portalItem:this,path:e})}toJSON(){var e=this.extent;e={accessInformation:this.accessInformation,categories:f.clone(this.categories),created:this.created?.getTime(),description:this.description,extent:e&&[[e.xmin,e.ymin],[e.xmax,e.ymax]],id:this.id,isOrgItem:this.isOrgItem,licenseInfo:this.licenseInfo,modified:this.modified?.getTime(),name:this.name,owner:this.owner,ownerFolder:this.ownerFolder,
snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:f.clone(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:f.clone(this.typeKeywords),url:this.url};return f.fixJson(e)}static fromJSON(e){if(!e)return null;if(e.declaredClass)throw Error("JSON object is already hydrated");return new y({sourceJSON:e})}_getPostQuery(){const e=this.toJSON();for(const H in e)"tags"===H&&null!==e[H]&&(e[H]=e[H].join(", ")),"typeKeywords"===H&&null!==
e[H]&&(e[H]=e[H].join(", ")),"extent"===H&&e[H]&&(e[H]=JSON.stringify(e[H]));return e}};d.__decorate([t.property({type:["private","shared","org","public"]})],p.prototype,"access",void 0);d.__decorate([t.property()],p.prototype,"accessInformation",void 0);d.__decorate([t.property({type:String})],p.prototype,"apiKey",void 0);d.__decorate([t.property({json:{read:{source:"appProxies"}}})],p.prototype,"applicationProxies",void 0);d.__decorate([t.property()],p.prototype,"avgRating",void 0);d.__decorate([t.property()],
p.prototype,"categories",void 0);d.__decorate([t.property({type:Date})],p.prototype,"created",void 0);d.__decorate([t.property()],p.prototype,"culture",void 0);d.__decorate([t.property()],p.prototype,"description",void 0);d.__decorate([t.property({readOnly:!0})],p.prototype,"displayName",null);d.__decorate([t.property({type:r})],p.prototype,"extent",void 0);d.__decorate([C.reader("extent")],p.prototype,"readExtent",null);d.__decorate([t.property()],p.prototype,"groupCategories",void 0);d.__decorate([t.property({readOnly:!0})],
p.prototype,"iconUrl",null);d.__decorate([t.property()],p.prototype,"id",void 0);d.__decorate([t.property({readOnly:!0})],p.prototype,"isLayer",null);d.__decorate([t.property({type:Boolean,readOnly:!0})],p.prototype,"isOrgItem",void 0);d.__decorate([t.property()],p.prototype,"itemControl",void 0);d.__decorate([t.property({readOnly:!0})],p.prototype,"itemPageUrl",null);d.__decorate([t.property({readOnly:!0})],p.prototype,"itemUrl",null);d.__decorate([t.property()],p.prototype,"licenseInfo",void 0);
d.__decorate([t.property({type:Date})],p.prototype,"modified",void 0);d.__decorate([t.property()],p.prototype,"name",void 0);d.__decorate([t.property()],p.prototype,"numComments",void 0);d.__decorate([t.property()],p.prototype,"numRatings",void 0);d.__decorate([t.property()],p.prototype,"numViews",void 0);d.__decorate([t.property()],p.prototype,"owner",void 0);d.__decorate([t.property()],p.prototype,"ownerFolder",void 0);d.__decorate([t.property({type:l})],p.prototype,"portal",void 0);d.__decorate([t.property()],
p.prototype,"screenshots",void 0);d.__decorate([t.property()],p.prototype,"size",void 0);d.__decorate([t.property()],p.prototype,"snippet",void 0);d.__decorate([t.property()],p.prototype,"sourceJSON",void 0);d.__decorate([t.property({type:String})],p.prototype,"sourceUrl",void 0);d.__decorate([t.property({type:String})],p.prototype,"spatialReference",void 0);d.__decorate([t.property()],p.prototype,"tags",void 0);d.__decorate([t.property()],p.prototype,"thumbnail",void 0);d.__decorate([t.property({readOnly:!0})],
p.prototype,"thumbnailUrl",null);d.__decorate([t.property()],p.prototype,"title",void 0);d.__decorate([t.property()],p.prototype,"type",void 0);d.__decorate([t.property()],p.prototype,"typeKeywords",void 0);d.__decorate([t.property({type:String,json:{read(e,H){Q.has(H.type)&&(H=this.portal?.restUrl,e||(e=H&&this.id?`${H}/content/items/${this.id}/data`:null));return e}}})],p.prototype,"url",void 0);d.__decorate([t.property({readOnly:!0})],p.prototype,"userItemUrl",null);return p=y=d.__decorate([B.subclass("esri.portal.PortalItem")],
p)})},"esri/portal/PortalItemResource":function(){define("require ../chunks/tslib.es6 ../core/Accessor ../core/Error ../core/Logger ../core/urlUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass".split(" "),function(b,d,A,u,I,p,f,v,g,t,w){A=class extends A{constructor(C){super(C);this.portalItem=null}normalizeCtorArgs(C){return C?.portalItem&&C.path?{...C,path:this._normalizePath(C.path,
C.portalItem)}:C}set path(C){null!=C&&p.isAbsolute(C)?I.getLogger(this).error("portalitemresource:invalid-path","A portal item resource path must be relative"):this._set("path",C)}_castPath(C){return this._normalizePath(C,this.portalItem)}get url(){return this.portalItem&&this.path?`${this.portalItem.itemUrl}/resources/${this.path}`:null}get cdnUrl(){return this.portalItem&&this.path?`${this.portalItem.itemCdnUrl}/resources/${this.path}`:null}get itemRelativeUrl(){return this.portalItem&&this.path?
`./resources/${this.path}`:null}fetch(C="json",B){const r=this.cdnUrl;if(null==r)throw new u("portal-item-resource:fetch","Portal item resource does not refer to a valid item or path");return this.portalItem.portal.request(r,{responseType:C,query:{token:this.portalItem.apiKey},signal:B?.signal})}async update(C,B){const {addOrUpdateResource:r}=await new Promise((l,a)=>b(["./support/resourceUtils"],l,a));return r(this,"update",C,B)}hasPath(){return null!=this.path}_normalizePath(C,B){if(null==C)return C;
C=C.replace(/^\/+/,"");null!=B&&p.isAbsolute(C)&&(C=p.makeRelative(C,B.itemUrl));return C?.replace(/^\/+/,"").replace(/^(\.\/)?resources\//,"")}};d.__decorate([f.property()],A.prototype,"portalItem",void 0);d.__decorate([f.property({type:String,value:null})],A.prototype,"path",null);d.__decorate([v.cast("path")],A.prototype,"_castPath",null);d.__decorate([f.property({type:String,readOnly:!0})],A.prototype,"url",null);d.__decorate([f.property({type:String,readOnly:!0})],A.prototype,"cdnUrl",null);
d.__decorate([f.property({type:String,readOnly:!0})],A.prototype,"itemRelativeUrl",null);return A=d.__decorate([w.subclass("esri.portal.PortalItemResource")],A)})},"esri/portal/PortalRating":function(){define("../chunks/tslib.es6 ../core/Accessor ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass".split(" "),function(b,d,A,u,I,p,f){d=class extends d{constructor(v){super(v);this.rating=this.created=
null}};b.__decorate([A.property()],d.prototype,"created",void 0);b.__decorate([A.property()],d.prototype,"rating",void 0);return d=b.__decorate([f.subclass("esri.portal.PortalRating")],d)})},"esri/support/basemapDefinitions":function(){define(["exports","../assets","../intl/messages"],function(b,d,A){b.esriBasemapDefinitions={satellite:{id:"satellite",classic:!0,get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/satellite.jpg")},baseMapLayers:[{id:"satellite-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",
layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1}]},hybrid:{id:"hybrid",classic:!0,get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/hybrid.jpg")},baseMapLayers:[{id:"hybrid-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1},{id:"hybrid-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/30d6b8271e1849cd9c3042060001f425/resources/styles/root.json",
layerType:"VectorTileLayer",title:"Hybrid Reference Layer",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},terrain:{id:"terrain",classic:!0,get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/terrain.jpg")},baseMapLayers:[{id:"terrain-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Terrain Base",showLegend:!1,visibility:!0,opacity:1},{id:"terrain-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer",
layerType:"ArcGISTiledMapServiceLayer",title:"World Reference Overlay",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},oceans:{id:"oceans",classic:!0,get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/oceans.jpg")},baseMapLayers:[{id:"oceans-base-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Base",showLegend:!1,visibility:!0,opacity:1},{id:"oceans-reference-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer",
layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},osm:{id:"osm",classic:!0,get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/osm.jpg")},baseMapLayers:[{id:"osm-base-layer",layerType:"OpenStreetMap",title:"Open Street Map",showLegend:!1,visibility:!0,opacity:1}]},"dark-gray-vector":{id:"dark-gray-vector",classic:!0,get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/dark-gray-vector.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",
styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/5e9b3685f4c24d8781073dd928ebda50/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Base",visibility:!0,opacity:1},{id:"dark-gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/747cb7a5329c478cbe6981076cc879c5/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get "dark-gray"(){return{...this["dark-gray-vector"],
id:"dark-gray"}},"gray-vector":{id:"gray-vector",classic:!0,get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/gray-vector.jpg")},baseMapLayers:[{id:"gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/291da5eab3a0412593b66d384379f89f/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Base",visibility:!0,opacity:1},{id:"gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/1768e8369a214dfab4e2167d5c5f2454/resources/styles/root.json",
layerType:"VectorTileLayer",title:"Light Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get gray(){return{...this["gray-vector"],id:"gray"}},"streets-vector":{id:"streets-vector",classic:!0,get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/streets-vector.jpg")},baseMapLayers:[{id:"streets-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/de26a3cf4cc9451298ea173c4b324736/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets",visibility:!0,
opacity:1}]},get streets(){return{...this["streets-vector"],id:"streets"}},"topo-vector":{id:"topo-vector",classic:!0,get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/topo-vector.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"topo-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/7dc6cea0b1764a1f9af2e679f642f0f5/resources/styles/root.json",
layerType:"VectorTileLayer",title:"World Topo",visibility:!0,opacity:1}]},get topo(){return{...this["topo-vector"],id:"topo"}},"streets-night-vector":{id:"streets-night-vector",classic:!0,get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/streets-night.jpg")},baseMapLayers:[{id:"streets-night-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/86f556a2d1fd468181855a35e344567f/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Night",visibility:!0,
opacity:1}]},"streets-relief-vector":{id:"streets-relief-vector",classic:!0,get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/streets-relief.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"streets-relief-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/b266e6d17fc345b498345613930fbd76/resources/styles/root.json",
title:"World Streets Relief",layerType:"VectorTileLayer",visibility:!0,opacity:1}]},"streets-navigation-vector":{id:"streets-navigation-vector",classic:!0,get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/streets-navigation.jpg")},baseMapLayers:[{id:"streets-navigation-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Navigation",visibility:!0,opacity:1}]},
"topo-3d":{id:"topo-3d",is3d:!0,get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/topo-3d.png")},baseMapLayers:[{id:"topo-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/1e7d1784d1ef4b79ba6764d0bd6c3150/resources/styles/root.json",layerType:"VectorTileLayer",title:"Topographic",visibility:!0,opacity:1},{id:"topo-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Trees_Thematic_v1/SceneServer",itemId:"f75fef56b2d944fe92ef9f7737b4f953",
layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-3d":{id:"navigation-3d",
is3d:!0,get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/navigation-3d.jpg")},baseMapLayers:[{id:"navigation-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/ccc904ff872b4144b94934e55e32784b/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation",visibility:!0,opacity:1},{id:"navigation-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",
layerType:"ArcGISSceneServiceLayer"},{id:"navigation-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-dark-3d":{id:"navigation-dark-3d",itemId:"5a1365328b4943f09a54cf5fd1205707",is3d:!0,baseMapLayers:[{id:"navigation-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/451a1777ab3f4bf095fae24a117439d9/resources/styles/root.json",
layerType:"VectorTileLayer",title:"Navigation Dark"},{id:"navigation-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",
layerType:"ArcGISSceneServiceLayer"}]},"arcgis-imagery":{get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/hybrid.jpg")},title:"Imagery Hybrid",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},
"arcgis-imagery-standard":{get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/satellite.jpg")},title:"Imagery",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"}]},"arcgis-imagery-labels":{title:"Hybrid [Reference]",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",
isReference:!0}]},"arcgis-light-gray":{get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/gray-vector.jpg")},title:"Light Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Base",title:"Light Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Labels",title:"Light Gray Canvas Labels",isReference:!0}]},"arcgis-dark-gray":{get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/dark-gray.jpg")},
title:"Dark Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Base",title:"Dark Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Labels",title:"Dark Gray Canvas Labels",isReference:!0}]},"arcgis-navigation":{get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/streets-navigation.jpg")},title:"Navigation",baseMapLayers:[{layerType:"VectorTileLayer",
styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Navigation",title:"World Navigation Map"}]},"arcgis-navigation-night":{title:"Navigation (Dark Mode)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:NavigationNight",title:"World Navigation Map (Dark Mode)"}]},"arcgis-streets":{get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/streets-vector.jpg")},title:"Streets",baseMapLayers:[{layerType:"VectorTileLayer",
styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Streets",title:"World Street Map"}]},"arcgis-streets-night":{get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/streets-night.jpg")},title:"Streets (Night)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsNight",title:"World Street Map (Night)"}]},"arcgis-streets-relief":{get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/streets-relief.jpg")},
title:"Streets (with Relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsRelief:Base",title:"World Street Map (with Relief)"}]},"arcgis-topographic":{get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/topo.jpg")},title:"Topographic",
baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Topographic:Base",title:"World Topographic Map"}]},"arcgis-oceans":{get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/oceans.jpg")},title:"Oceans",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",
showLegend:!1,title:"World Ocean Base",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Oceans:Labels",title:"World Ocean Reference",isReference:!0}]},"osm-standard":{title:"OpenStreetMap",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Standard",title:"OpenStreetMap"}]},"osm-standard-relief":{title:"OpenStreetMap (with relief)",
baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StandardRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-streets":{title:"OpenStreetMap (Streets)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Streets",
title:"OpenStreetMap (Streets)"}]},"osm-streets-relief":{title:"OpenStreetMap (Streets with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StreetsRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-light-gray":{title:"OpenStreetMap (Light Gray Canvas)",
baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Base",title:"OSM (Light Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Labels",title:"OSM (Light Gray Reference)",isReference:!0}]},"osm-dark-gray":{title:"OpenStreetMap (Dark Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Base",
title:"OSM (Dark Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Labels",title:"OSM (Dark Gray Reference)",isReference:!0}]},"arcgis-terrain":{title:"Terrain with Labels",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Base",
title:"World Terrain Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Detail",title:"World Terrain Reference",isReference:!0}]},"arcgis-community":{title:"Community",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Community",title:"Community"}]},"arcgis-charted-territory":{title:"Charted Territory",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,
title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ChartedTerritory:Base",title:"Charted Territory"}]},"arcgis-colored-pencil":{title:"Colored Pencil",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ColoredPencil",title:"Colored Pencil"}]},"arcgis-nova":{title:"Nova",
baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Nova",title:"Nova"}]},"arcgis-modern-antique":{title:"Modern Antique",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ModernAntique:Base",
title:"Modern Antique"}]},"arcgis-midcentury":{title:"Mid-Century",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Midcentury",title:"Mid-Century"}]},"arcgis-newspaper":{title:"Newspaper",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Newspaper",title:"Newspaper"}]},"arcgis-hillshade-light":{title:"Hillshade",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",
showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"}]},"arcgis-hillshade-dark":{title:"Hillshade (Dark)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade (Dark)",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade_Dark/MapServer"}]},"arcgis-human-geography":{title:"Human Geography",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Base",
title:"Human Geography Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Detail",title:"Human Geography Detail",isReference:!0},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Label",title:"Human Geography Label",isReference:!0}]},"arcgis-human-geography-dark":{title:"Human Geography (Dark)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Base",
title:"Human Geography Dark Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Detail",title:"Human Geography Dark Detail",isReference:!0},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Label",title:"Human Geography Dark Label",isReference:!0}]}};b.getBasemapTitle=async function(u){if(u){var I=u.includes("-vector")?u.slice(0,u.indexOf("-vector")):
u.includes("-3d")?u.slice(0,u.indexOf("-3d")):u,p=await A.fetchMessageBundle("esri/t9n/basemaps");return p[u]||p[I]}};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/support/BasemapStyle":function(){define("../chunks/tslib.es6 ../core/Accessor ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ../intl/locale".split(" "),function(b,d,A,u,I,p,f,v){const g=new Set("ar bs ca hr cs da nl en et fi fr de el he hu id it ja ko lv lt nb pl ro ru sr es sv th tr uk vi".split(" "));
d=class extends d{constructor(t){super(t);this.language=this.id=null;this.serviceUrl="https://basemapstyles-api.arcgis.com/arcgis/rest/services/styles/v2/webmaps"}getLanguageParamValue(){if(this.language)return this.language;var t=v.getLocale().toLowerCase();switch(t){case "pt-br":return"pt-BR";case "pt-pt":return"pt-PT";case "zh-cn":return"zh-CN";case "zh-hk":return"zh-HK";case "zh-tw":return"zh-TW"}t=v.getLanguage(t);return"pt"===t?"pt-BR":t&&g.has(t)?t:"global"}};b.__decorate([A.property()],d.prototype,
"id",void 0);b.__decorate([A.property()],d.prototype,"language",void 0);b.__decorate([A.property()],d.prototype,"serviceUrl",void 0);return d=b.__decorate([f.subclass("esri.support.BasemapStyle")],d)})},"esri/webdoc/support/writeUtils":function(){define("exports ../../core/Error ../../core/lang ../../core/object ../../core/accessorSupport/extensions/serializableProperty/writer ../../layers/support/layerUtils".split(" "),function(b,d,A,u,I,p){function f(t,w){"maxScale"in t&&(w.maxScale=I.numberToJSON(t.maxScale)??
void 0);"minScale"in t&&(w.minScale=I.numberToJSON(t.minScale)??void 0)}const v=new Set("bing-maps imagery imagery-tile map-image open-street-map tile unknown unsupported vector-tile web-tile wms wmts".split(" ")),g=new Set("csv feature geo-rss geojson group imagery imagery-tile kml map-image map-notes media ogc-feature oriented-imagery route stream subtype-group tile unknown unsupported vector-tile web-tile wfs wms wmts".split(" "));b.disableRestrictedWriting=function(t){v.add(t);g.add(t)};b.enableRestrictedWriting=
function(t){v.delete(t);g.delete(t)};b.getLayerJSON=function(t,w,C){if(!t.persistenceEnabled)return null;if(!("write"in t&&t.write))return C?.messages&&C.messages.push(new d("layer:unsupported",`Layers (${t.title}, ${t.id}) of type '${t.declaredClass}' cannot be persisted`,{layer:t})),null;if(p.isFeatureCollectionLayer(t)&&!t.isTable)w=t.resourceInfo;else{if(C.restrictedWebMapWriting){var B="basemap"===C.layerContainerType?v:"operational-layers"===C.layerContainerType?g:null;B=null!=B?B.has(t.type)&&
!p.isFeatureCollectionLayer(t):!0}else B=!0;if(B)return w={},t.write(w,C)?w:null}if(null!=w){w=A.clone(w);if(C=w)p.isFeatureCollectionLayer(t)?(B=u.getDeepValue("featureCollection.layers",C)?.[0]?.layerDefinition)&&f(t,B):"group"!==t.type&&f(t,C);if(C&&(C.id=t.id,"blendMode"in t&&(C.blendMode=t.blendMode,"normal"===C.blendMode&&delete C.blendMode),C.opacity=I.numberToJSON(t.opacity)??void 0,C.title=t.title||"Layer",C.visibility=t.visible,"legendEnabled"in t&&"wmts"!==t.type))if(p.isFeatureCollectionLayer(t)){if(C=
C.featureCollection)C.showLegend=t.legendEnabled}else C.showLegend=t.legendEnabled}return w};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/layerUtils":function(){define(["exports","../../kernel","../../request"],function(b,d,A){function u(p){return"scene"===p?.type}function I(p){p=p?.type;return"imagery-tile"===p||"tile"===p||"open-street-map"===p||"vector-tile"===p||"web-tile"===p||"wmts"===p}b.getEffectiveEditingEnabled=function(p){a:if("editingEnabled"in p)switch(p.type){case "csv":case "feature":case "geojson":case "oriented-imagery":case "scene":case "subtype-group":case "subtype-sublayer":var f=
!0;break a;default:f=!1}else f=!1;return f?"effectiveEditingEnabled"in p?p.effectiveEditingEnabled:p.editingEnabled:!1};b.getEffectiveLayerCapabilities=function(p){a:if("capabilities"in p)switch(p.type){case "csv":case "feature":case "geojson":case "imagery":case "knowledge-graph-sublayer":case "ogc-feature":case "oriented-imagery":case "scene":case "subtype-group":case "subtype-sublayer":case "wfs":var f=!0;break a;default:f=!1}else f=!1;return f?"effectiveCapabilities"in p?p.effectiveCapabilities:
p.capabilities:null};b.getOwningPortalUrl=async function(p,f){var v=d.id?.findServerInfo(p);if(null!=v?.currentVersion)return v.owningSystemUrl||null;v=p.toLowerCase().indexOf("/rest/services");if(-1===v)return null;p=`${p.substring(0,v)}/rest/info`;({data:f}=await A(p,{query:{f:"json"},responseType:"json",signal:null!=f?f.signal:null}));return f?.owningSystemUrl||null};b.getTileMaxtrixSetFromActiveLayer=function(p){if(p.activeLayer){const f=p.activeLayer.tileMatrixSet;if(f)return f;if(p=p.activeLayer.tileMatrixSets)return p}return null};
b.isBaseLayer=function(p){return null!=p?.parent&&"declaredClass"in p.parent&&"esri.Basemap"===p.parent.declaredClass&&p.parent.baseLayers.includes(p)};b.isBasemap3DSupportedLayer=function(p){return I(p)||u(p)};b.isBasemapSupportedTiledLayer=I;b.isFeatureCollectionLayer=function(p){return"feature"===p?.type&&!p.url&&"memory"===p.source?.type};b.isFeatureLayer=function(p){return null!=p&&"object"===typeof p&&"type"in p&&"feature"===p.type};b.isFeatureServiceLayer=function(p){return"feature"===p?.type&&
"feature-layer"===p.source?.type};b.isGraphicsLayer=function(p){return null!=p&&"object"===typeof p&&"type"in p&&"graphics"===p.type};b.isGroupLayer=function(p){return null!=p&&"type"in p&&"group"===p.type};b.isImageryTileLayer=function(p){return"imagery-tile"===p?.type};b.isKnowledgeGraphLayer=function(p){return null!=p&&"object"===typeof p&&"type"in p&&"knowledge-graph"===p.type&&"layers"in p};b.isLayerWithFeatureLayerSource=function(p){return("feature"===p?.type||"subtype-group"===p?.type)&&"feature-layer"===
p.source?.type};b.isMapNotesLayer=function(p){return null!=p&&"object"===typeof p&&"type"in p&&"map-notes"===p.type&&"sublayers"in p};b.isSceneLayer=u;b.isSceneServiceLayer=function(p){p=p?.type;return"building-scene"===p||"integrated-mesh"===p||"point-cloud"===p||"scene"===p};b.isSubtypeGroupLayer=function(p){return null!=p&&"object"===typeof p&&"type"in p&&"subtype-group"===p.type&&"sublayers"in p};b.isTable=function(p){return null!=p&&"object"===typeof p&&"isTable"in p&&!!p.isTable};b.isTiledLayer=
function(p){p=p?.type;return"base-tile"===p||"tile"===p||"elevation"===p||"imagery-tile"===p||"base-elevation"===p||"open-street-map"===p||"wcs"===p||"web-tile"===p||"wmts"===p||"vector-tile"===p};b.isVoxelLayer=function(p){return"voxel"===p?.type};b.sceneServiceLayerTypeToClassName={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};b.serializeLayerDefinitions=function(p){const f=/[:;]/,v=[];let g=!1;if(p&&(p.forEach((t,
w)=>{v.push([w,t]);!g&&f.test(t)&&(g=!0)}),0<v.length)){if(g){const t={};v.forEach(w=>{t[w[0]]=w[1]});p=JSON.stringify(t)}else{const t=[];v.forEach(w=>{t.push(w[0]+":"+w[1])});p=t.join(";")}return p}return null};b.serializeTimeOptions=function(p){if(p){var f=[];p.forEach((v,g)=>{f.push('"'+g+'":'+JSON.stringify(v))});if(f.length)return"{"+f.join(",")+"}"}};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/layers/effects/utils":function(){define(["exports","./effects"],function(b,
d){b.canInterpolateEffects=function(A,u){const I=A.length>u.length?A:u;return(A.length>u.length?u:A).every((p,f)=>p.type===I[f].type)};b.effectEquals=function(A,u){A=JSON.stringify(A??null);u=JSON.stringify(u??null);return A===u};b.isEffectFunctions=function(A){return(A=A[0])?"type"in A:!1};b.normalizeEffects=function(A,u){const I=A.length>u.length?A:u;A=A.length>u.length?u:A;for(u=A.length;u<I.length;u++)A.push(d.createEffectWithInitialValues(I[u]))};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},
"esri/layers/effects/effects":function(){define(["exports","../../colorUtils","../../core/screenUtils","../../chunks/mat4f32","./colorMatrixFunctions"],function(b,d,A,u,I){function p(r,l,a){return r+(l-r)*a}function f(r){return Math.round(1E3*A.px2pt(r))/1E3}class v{constructor(r,l,a){this.strength=r;this.radius=l;this.threshold=a;this.type="bloom"}interpolate(r,l,a){this.strength=p(r.strength,l.strength,a);this.radius=p(r.radius,l.radius,a);this.threshold=p(r.threshold,l.threshold,a)}clone(){return new v(this.strength,
this.radius,this.threshold)}toJSON(){return{type:"bloom",radius:f(this.radius),strength:this.strength,threshold:this.threshold}}}class g{constructor(r){this.radius=r;this.type="blur"}interpolate(r,l,a){this.radius=Math.round(p(r.radius,l.radius,a))}clone(){return new g(this.radius)}toJSON(){return{type:"blur",radius:f(this.radius)}}}class t{constructor(r,l){this.type=r;this.amount=l;if("invert"===this.type||"grayscale"===this.type||"sepia"===this.type)this.amount=Math.min(this.amount,1)}get colorMatrix(){this._colorMatrix||
this._updateMatrix();return this._colorMatrix}interpolate(r,l,a){this.amount=p(r.amount,l.amount,a);this._updateMatrix()}clone(){return new t(this.type,this.amount)}toJSON(){return{type:this.type,amount:this.amount}}_updateMatrix(){const r=this._colorMatrix||u.create();switch(this.type){case "brightness":this._colorMatrix=I.brightness(r,this.amount);break;case "contrast":this._colorMatrix=I.contrast(r,this.amount);break;case "grayscale":this._colorMatrix=I.grayscale(r,this.amount);break;case "invert":this._colorMatrix=
I.invert(r,this.amount);break;case "saturate":this._colorMatrix=I.saturate(r,this.amount);break;case "sepia":this._colorMatrix=I.sepia(r,this.amount)}}}class w{constructor(r,l,a,q){this.offsetX=r;this.offsetY=l;this.blurRadius=a;this.color=q;this.type="drop-shadow"}interpolate(r,l,a){this.offsetX=p(r.offsetX,l.offsetX,a);this.offsetY=p(r.offsetY,l.offsetY,a);this.blurRadius=p(r.blurRadius,l.blurRadius,a);this.color[0]=Math.round(p(r.color[0],l.color[0],a));this.color[1]=Math.round(p(r.color[1],l.color[1],
a));this.color[2]=Math.round(p(r.color[2],l.color[2],a));this.color[3]=p(r.color[3],l.color[3],a)}clone(){return new w(this.offsetX,this.offsetY,this.blurRadius,[...this.color])}toJSON(){const r=[...this.color];r[3]*=255;return{type:"drop-shadow",xoffset:f(this.offsetX),yoffset:f(this.offsetY),blurRadius:f(this.blurRadius),color:r}}}class C{constructor(r){this.angle=r;this.type="hue-rotate"}get colorMatrix(){this._colorMatrix||this._updateMatrix();return this._colorMatrix}interpolate(r,l,a){this.angle=
p(r.angle,l.angle,a);this._updateMatrix()}clone(){return new C(this.angle)}toJSON(){return{type:"hue-rotate",angle:this.angle}}_updateMatrix(){const r=this._colorMatrix||u.create();this._colorMatrix=I.rotateHue(r,this.angle)}}class B{constructor(r){this.amount=r;this.type="opacity";this.amount=Math.min(this.amount,1)}interpolate(r,l,a){this.amount=p(r.amount,l.amount,a)}clone(){return new B(this.amount)}toJSON(){return{type:"opacity",amount:this.amount}}}b.BloomEffect=v;b.BlurEffect=g;b.ColorMatrixEffect=
t;b.DropShadowEffect=w;b.HueRotateEffect=C;b.OpacityEffect=B;b.createEffectWithInitialValues=function(r){switch(r.type){case "grayscale":case "sepia":case "invert":return new t(r.type,0);case "saturate":case "brightness":case "contrast":return new t(r.type,1);case "opacity":return new B(1);case "hue-rotate":return new C(0);case "blur":return new g(0);case "drop-shadow":return new w(0,0,0,[...d.getNamedColor("transparent")]);case "bloom":return new v(0,0,1)}};Object.defineProperty(b,Symbol.toStringTag,
{value:"Module"})})},"esri/chunks/mat4f32":function(){define(["exports"],function(b){function d(){const v=new Float32Array(16);v[0]=1;v[5]=1;v[10]=1;v[15]=1;return v}function A(v){const g=new Float32Array(16);g[0]=v[0];g[1]=v[1];g[2]=v[2];g[3]=v[3];g[4]=v[4];g[5]=v[5];g[6]=v[6];g[7]=v[7];g[8]=v[8];g[9]=v[9];g[10]=v[10];g[11]=v[11];g[12]=v[12];g[13]=v[13];g[14]=v[14];g[15]=v[15];return g}function u(v,g,t,w,C,B,r,l,a,q,y,F,Q,e,H,S){const J=new Float32Array(16);J[0]=v;J[1]=g;J[2]=t;J[3]=w;J[4]=C;J[5]=
B;J[6]=r;J[7]=l;J[8]=a;J[9]=q;J[10]=y;J[11]=F;J[12]=Q;J[13]=e;J[14]=H;J[15]=S;return J}function I(v,g){return new Float32Array(v,g,16)}const p=d(),f=Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:p,clone:A,create:d,createView:I,fromValues:u},Symbol.toStringTag,{value:"Module"}));b.IDENTITY=p;b.clone=A;b.create=d;b.createView=I;b.fromValues=u;b.mat4f32=f})},"esri/layers/effects/colorMatrixFunctions":function(){define(["exports","../../chunks/mat4"],function(b,d){b.brightness=(A,u)=>{A=
d.set(A,u,0,0,0,0,u,0,0,0,0,u,0,0,0,0,1);return d.transpose(A,A)};b.contrast=(A,u)=>{A=d.set(A,u,0,0,.5-.5*u,0,u,0,.5-.5*u,0,0,u,.5-.5*u,0,0,0,1);return d.transpose(A,A)};b.grayscale=(A,u)=>{u=1-u;A=d.set(A,.2126+.7874*u,.7152-.7152*u,.0722-.0722*u,0,.2126-.2126*u,.7152+.2848*u,.0722-.0722*u,0,.2126-.2126*u,.7152-.7152*u,.0722+.9278*u,0,0,0,0,1);return d.transpose(A,A)};b.invert=(A,u)=>{const I=1-2*u;A=d.set(A,I,0,0,u,0,I,0,u,0,0,I,u,0,0,0,1);return d.transpose(A,A)};b.rotateHue=(A,u)=>{const I=Math.sin(u*
Math.PI/180);u=Math.cos(u*Math.PI/180);A=d.set(A,.213+.787*u-.213*I,.715-.715*u-.715*I,.072-.072*u+.928*I,0,.213-.213*u+.143*I,.715+.285*u+.14*I,.072-.072*u-.283*I,0,.213-.213*u-.787*I,.715-.715*u+.715*I,.072+.928*u+.072*I,0,0,0,0,1);return d.transpose(A,A)};b.saturate=(A,u)=>{A=d.set(A,.213+.787*u,.715-.715*u,.072-.072*u,0,.213-.213*u,.715+.285*u,.072-.072*u,0,.213-.213*u,.715-.715*u,.072+.928*u,0,0,0,0,1);return d.transpose(A,A)};b.sepia=(A,u)=>{u=1-u;A=d.set(A,.393+.607*u,.769-.769*u,.189-.189*
u,0,.349-.349*u,.686+.314*u,.168-.168*u,0,.272-.272*u,.534-.534*u,.131+.869*u,0,0,0,0,1);return d.transpose(A,A)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/mat4":function(){define(["exports","./vec3f64","./common"],function(b,d,A){function u(h,E){h[0]=E[0];h[1]=E[1];h[2]=E[2];h[3]=E[3];h[4]=E[4];h[5]=E[5];h[6]=E[6];h[7]=E[7];h[8]=E[8];h[9]=E[9];h[10]=E[10];h[11]=E[11];h[12]=E[12];h[13]=E[13];h[14]=E[14];h[15]=E[15];return h}function I(h,E,X,aa,ja,z,G,K,W,Z,ba,ea,
la,na,wa,ta,va){h[0]=E;h[1]=X;h[2]=aa;h[3]=ja;h[4]=z;h[5]=G;h[6]=K;h[7]=W;h[8]=Z;h[9]=ba;h[10]=ea;h[11]=la;h[12]=na;h[13]=wa;h[14]=ta;h[15]=va;return h}function p(h){h[0]=1;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=1;h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[10]=1;h[11]=0;h[12]=0;h[13]=0;h[14]=0;h[15]=1;return h}function f(h,E){if(h===E){const X=E[1],aa=E[2],ja=E[3],z=E[6],G=E[7],K=E[11];h[1]=E[4];h[2]=E[8];h[3]=E[12];h[4]=X;h[6]=E[9];h[7]=E[13];h[8]=aa;h[9]=z;h[11]=E[14];h[12]=ja;h[13]=G;h[14]=K}else h[0]=E[0],h[1]=
E[4],h[2]=E[8],h[3]=E[12],h[4]=E[1],h[5]=E[5],h[6]=E[9],h[7]=E[13],h[8]=E[2],h[9]=E[6],h[10]=E[10],h[11]=E[14],h[12]=E[3],h[13]=E[7],h[14]=E[11],h[15]=E[15];return h}function v(h,E){g(h,E)||p(h);return h}function g(h,E){const X=E[0],aa=E[1],ja=E[2],z=E[3],G=E[4],K=E[5],W=E[6],Z=E[7],ba=E[8],ea=E[9],la=E[10],na=E[11],wa=E[12],ta=E[13],va=E[14];E=E[15];const Ea=X*K-aa*G,ya=X*W-ja*G,Da=X*Z-z*G,Ca=aa*W-ja*K,za=aa*Z-z*K,Ja=ja*Z-z*W,Ra=ba*ta-ea*wa,Ya=ba*va-la*wa,Wa=ba*E-na*wa,Ma=ea*va-la*ta,Na=ea*E-na*
ta,ma=la*E-na*va;let Sa=Ea*ma-ya*Na+Da*Ma+Ca*Wa-za*Ya+Ja*Ra;if(!Sa)return null;Sa=1/Sa;h[0]=(K*ma-W*Na+Z*Ma)*Sa;h[1]=(ja*Na-aa*ma-z*Ma)*Sa;h[2]=(ta*Ja-va*za+E*Ca)*Sa;h[3]=(la*za-ea*Ja-na*Ca)*Sa;h[4]=(W*Wa-G*ma-Z*Ya)*Sa;h[5]=(X*ma-ja*Wa+z*Ya)*Sa;h[6]=(va*Da-wa*Ja-E*ya)*Sa;h[7]=(ba*Ja-la*Da+na*ya)*Sa;h[8]=(G*Na-K*Wa+Z*Ra)*Sa;h[9]=(aa*Wa-X*Na-z*Ra)*Sa;h[10]=(wa*za-ta*Da+E*Ea)*Sa;h[11]=(ea*Da-ba*za-na*Ea)*Sa;h[12]=(K*Ya-G*Ma-W*Ra)*Sa;h[13]=(X*Ma-aa*Ya+ja*Ra)*Sa;h[14]=(ta*ya-wa*Ca-va*Ea)*Sa;h[15]=(ba*
Ca-ea*ya+la*Ea)*Sa;return h}function t(h,E){const X=E[0],aa=E[1],ja=E[2],z=E[3],G=E[4],K=E[5],W=E[6],Z=E[7],ba=E[8],ea=E[9],la=E[10],na=E[11],wa=E[12],ta=E[13],va=E[14];E=E[15];h[0]=K*(la*E-na*va)-ea*(W*E-Z*va)+ta*(W*na-Z*la);h[1]=-(aa*(la*E-na*va)-ea*(ja*E-z*va)+ta*(ja*na-z*la));h[2]=aa*(W*E-Z*va)-K*(ja*E-z*va)+ta*(ja*Z-z*W);h[3]=-(aa*(W*na-Z*la)-K*(ja*na-z*la)+ea*(ja*Z-z*W));h[4]=-(G*(la*E-na*va)-ba*(W*E-Z*va)+wa*(W*na-Z*la));h[5]=X*(la*E-na*va)-ba*(ja*E-z*va)+wa*(ja*na-z*la);h[6]=-(X*(W*E-Z*va)-
G*(ja*E-z*va)+wa*(ja*Z-z*W));h[7]=X*(W*na-Z*la)-G*(ja*na-z*la)+ba*(ja*Z-z*W);h[8]=G*(ea*E-na*ta)-ba*(K*E-Z*ta)+wa*(K*na-Z*ea);h[9]=-(X*(ea*E-na*ta)-ba*(aa*E-z*ta)+wa*(aa*na-z*ea));h[10]=X*(K*E-Z*ta)-G*(aa*E-z*ta)+wa*(aa*Z-z*K);h[11]=-(X*(K*na-Z*ea)-G*(aa*na-z*ea)+ba*(aa*Z-z*K));h[12]=-(G*(ea*va-la*ta)-ba*(K*va-W*ta)+wa*(K*la-W*ea));h[13]=X*(ea*va-la*ta)-ba*(aa*va-ja*ta)+wa*(aa*la-ja*ea);h[14]=-(X*(K*va-W*ta)-G*(aa*va-ja*ta)+wa*(aa*W-ja*K));h[15]=X*(K*la-W*ea)-G*(aa*la-ja*ea)+ba*(aa*W-ja*K);return h}
function w(h){const E=h[0],X=h[1],aa=h[2],ja=h[3],z=h[4],G=h[5],K=h[6],W=h[7],Z=h[8],ba=h[9],ea=h[10],la=h[11],na=h[12],wa=h[13],ta=h[14];h=h[15];return(E*G-X*z)*(ea*h-la*ta)-(E*K-aa*z)*(ba*h-la*wa)+(E*W-ja*z)*(ba*ta-ea*wa)+(X*K-aa*G)*(Z*h-la*na)-(X*W-ja*G)*(Z*ta-ea*na)+(aa*W-ja*K)*(Z*wa-ba*na)}function C(h,E,X){const aa=E[0],ja=E[1],z=E[2],G=E[3],K=E[4],W=E[5],Z=E[6],ba=E[7],ea=E[8],la=E[9],na=E[10],wa=E[11],ta=E[12],va=E[13],Ea=E[14];E=E[15];let ya=X[0],Da=X[1],Ca=X[2],za=X[3];h[0]=ya*aa+Da*K+Ca*
ea+za*ta;h[1]=ya*ja+Da*W+Ca*la+za*va;h[2]=ya*z+Da*Z+Ca*na+za*Ea;h[3]=ya*G+Da*ba+Ca*wa+za*E;ya=X[4];Da=X[5];Ca=X[6];za=X[7];h[4]=ya*aa+Da*K+Ca*ea+za*ta;h[5]=ya*ja+Da*W+Ca*la+za*va;h[6]=ya*z+Da*Z+Ca*na+za*Ea;h[7]=ya*G+Da*ba+Ca*wa+za*E;ya=X[8];Da=X[9];Ca=X[10];za=X[11];h[8]=ya*aa+Da*K+Ca*ea+za*ta;h[9]=ya*ja+Da*W+Ca*la+za*va;h[10]=ya*z+Da*Z+Ca*na+za*Ea;h[11]=ya*G+Da*ba+Ca*wa+za*E;ya=X[12];Da=X[13];Ca=X[14];za=X[15];h[12]=ya*aa+Da*K+Ca*ea+za*ta;h[13]=ya*ja+Da*W+Ca*la+za*va;h[14]=ya*z+Da*Z+Ca*na+za*Ea;
h[15]=ya*G+Da*ba+Ca*wa+za*E;return h}function B(h,E,X){const aa=X[0],ja=X[1];X=X[2];if(E===h)h[12]=E[0]*aa+E[4]*ja+E[8]*X+E[12],h[13]=E[1]*aa+E[5]*ja+E[9]*X+E[13],h[14]=E[2]*aa+E[6]*ja+E[10]*X+E[14],h[15]=E[3]*aa+E[7]*ja+E[11]*X+E[15];else{const z=E[0],G=E[1],K=E[2],W=E[3],Z=E[4],ba=E[5],ea=E[6],la=E[7],na=E[8],wa=E[9],ta=E[10],va=E[11];h[0]=z;h[1]=G;h[2]=K;h[3]=W;h[4]=Z;h[5]=ba;h[6]=ea;h[7]=la;h[8]=na;h[9]=wa;h[10]=ta;h[11]=va;h[12]=z*aa+Z*ja+na*X+E[12];h[13]=G*aa+ba*ja+wa*X+E[13];h[14]=K*aa+ea*
ja+ta*X+E[14];h[15]=W*aa+la*ja+va*X+E[15]}return h}function r(h,E,X){const aa=X[0],ja=X[1];X=X[2];h[0]=E[0]*aa;h[1]=E[1]*aa;h[2]=E[2]*aa;h[3]=E[3]*aa;h[4]=E[4]*ja;h[5]=E[5]*ja;h[6]=E[6]*ja;h[7]=E[7]*ja;h[8]=E[8]*X;h[9]=E[9]*X;h[10]=E[10]*X;h[11]=E[11]*X;h[12]=E[12];h[13]=E[13];h[14]=E[14];h[15]=E[15];return h}function l(h,E,X,aa){let ja=aa[0],z=aa[1];aa=aa[2];let G=Math.sqrt(ja*ja+z*z+aa*aa);var K=void 0,W=void 0;let Z=void 0,ba=void 0,ea=void 0,la=void 0,na=void 0,wa=void 0,ta=void 0,va=void 0,Ea=
void 0,ya=void 0,Da=void 0,Ca=void 0,za=void 0,Ja=void 0,Ra=void 0,Ya=void 0,Wa=void 0,Ma=void 0,Na=void 0,ma=void 0;W=K=void 0;if(G<A.getEpsilon())return null;G=1/G;ja*=G;z*=G;aa*=G;K=Math.sin(X);W=Math.cos(X);Z=1-W;ba=E[0];ea=E[1];la=E[2];na=E[3];wa=E[4];ta=E[5];va=E[6];Ea=E[7];ya=E[8];Da=E[9];Ca=E[10];za=E[11];Ja=ja*ja*Z+W;Ra=z*ja*Z+aa*K;Ya=aa*ja*Z-z*K;Wa=ja*z*Z-aa*K;Ma=z*z*Z+W;Na=aa*z*Z+ja*K;ma=ja*aa*Z+z*K;K=z*aa*Z-ja*K;W=aa*aa*Z+W;h[0]=ba*Ja+wa*Ra+ya*Ya;h[1]=ea*Ja+ta*Ra+Da*Ya;h[2]=la*Ja+va*Ra+
Ca*Ya;h[3]=na*Ja+Ea*Ra+za*Ya;h[4]=ba*Wa+wa*Ma+ya*Na;h[5]=ea*Wa+ta*Ma+Da*Na;h[6]=la*Wa+va*Ma+Ca*Na;h[7]=na*Wa+Ea*Ma+za*Na;h[8]=ba*ma+wa*K+ya*W;h[9]=ea*ma+ta*K+Da*W;h[10]=la*ma+va*K+Ca*W;h[11]=na*ma+Ea*K+za*W;E!==h&&(h[12]=E[12],h[13]=E[13],h[14]=E[14],h[15]=E[15]);return h}function a(h,E,X){const aa=Math.sin(X);X=Math.cos(X);const ja=E[4],z=E[5],G=E[6],K=E[7],W=E[8],Z=E[9],ba=E[10],ea=E[11];E!==h&&(h[0]=E[0],h[1]=E[1],h[2]=E[2],h[3]=E[3],h[12]=E[12],h[13]=E[13],h[14]=E[14],h[15]=E[15]);h[4]=ja*X+W*
aa;h[5]=z*X+Z*aa;h[6]=G*X+ba*aa;h[7]=K*X+ea*aa;h[8]=W*X-ja*aa;h[9]=Z*X-z*aa;h[10]=ba*X-G*aa;h[11]=ea*X-K*aa;return h}function q(h,E,X){const aa=Math.sin(X);X=Math.cos(X);const ja=E[0],z=E[1],G=E[2],K=E[3],W=E[8],Z=E[9],ba=E[10],ea=E[11];E!==h&&(h[4]=E[4],h[5]=E[5],h[6]=E[6],h[7]=E[7],h[12]=E[12],h[13]=E[13],h[14]=E[14],h[15]=E[15]);h[0]=ja*X-W*aa;h[1]=z*X-Z*aa;h[2]=G*X-ba*aa;h[3]=K*X-ea*aa;h[8]=ja*aa+W*X;h[9]=z*aa+Z*X;h[10]=G*aa+ba*X;h[11]=K*aa+ea*X;return h}function y(h,E,X){const aa=Math.sin(X);
X=Math.cos(X);const ja=E[0],z=E[1],G=E[2],K=E[3],W=E[4],Z=E[5],ba=E[6],ea=E[7];E!==h&&(h[8]=E[8],h[9]=E[9],h[10]=E[10],h[11]=E[11],h[12]=E[12],h[13]=E[13],h[14]=E[14],h[15]=E[15]);h[0]=ja*X+W*aa;h[1]=z*X+Z*aa;h[2]=G*X+ba*aa;h[3]=K*X+ea*aa;h[4]=W*X-ja*aa;h[5]=Z*X-z*aa;h[6]=ba*X-G*aa;h[7]=ea*X-K*aa;return h}function F(h,E){h[0]=1;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=1;h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[10]=1;h[11]=0;h[12]=E[0];h[13]=E[1];h[14]=E[2];h[15]=1;return h}function Q(h,E){h[0]=E[0];h[1]=0;h[2]=0;h[3]=
0;h[4]=0;h[5]=E[1];h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[10]=E[2];h[11]=0;h[12]=0;h[13]=0;h[14]=0;h[15]=1;return h}function e(h,E,X){if(0===E)return p(h);let aa=X[0],ja=X[1];X=X[2];let z=Math.sqrt(aa*aa+ja*ja+X*X),G=void 0,K=void 0,W=void 0;if(z<A.getEpsilon())return null;z=1/z;aa*=z;ja*=z;X*=z;G=Math.sin(E);K=Math.cos(E);W=1-K;h[0]=aa*aa*W+K;h[1]=ja*aa*W+X*G;h[2]=X*aa*W-ja*G;h[3]=0;h[4]=aa*ja*W-X*G;h[5]=ja*ja*W+K;h[6]=X*ja*W+aa*G;h[7]=0;h[8]=aa*X*W+ja*G;h[9]=ja*X*W-aa*G;h[10]=X*X*W+K;h[11]=0;h[12]=0;h[13]=
0;h[14]=0;h[15]=1;return h}function H(h,E){const X=Math.sin(E);E=Math.cos(E);h[0]=1;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=E;h[6]=X;h[7]=0;h[8]=0;h[9]=-X;h[10]=E;h[11]=0;h[12]=0;h[13]=0;h[14]=0;h[15]=1;return h}function S(h,E){const X=Math.sin(E);E=Math.cos(E);h[0]=E;h[1]=0;h[2]=-X;h[3]=0;h[4]=0;h[5]=1;h[6]=0;h[7]=0;h[8]=X;h[9]=0;h[10]=E;h[11]=0;h[12]=0;h[13]=0;h[14]=0;h[15]=1;return h}function J(h,E){const X=Math.sin(E);E=Math.cos(E);h[0]=E;h[1]=X;h[2]=0;h[3]=0;h[4]=-X;h[5]=E;h[6]=0;h[7]=0;h[8]=0;h[9]=
0;h[10]=1;h[11]=0;h[12]=0;h[13]=0;h[14]=0;h[15]=1;return h}function R(h,E,X){var aa=E[0],ja=E[1],z=E[2],G=E[3],K=aa+aa,W=ja+ja;const Z=z+z;E=aa*K;const ba=aa*W;aa*=Z;const ea=ja*W;ja*=Z;z*=Z;K*=G;W*=G;G*=Z;h[0]=1-(ea+z);h[1]=ba+G;h[2]=aa-W;h[3]=0;h[4]=ba-G;h[5]=1-(E+z);h[6]=ja+K;h[7]=0;h[8]=aa+W;h[9]=ja-K;h[10]=1-(E+ea);h[11]=0;h[12]=X[0];h[13]=X[1];h[14]=X[2];h[15]=1;return h}function P(h,E){const X=Ta,aa=-E[0],ja=-E[1],z=-E[2],G=E[3],K=E[4],W=E[5],Z=E[6],ba=E[7],ea=aa*aa+ja*ja+z*z+G*G;0<ea?(X[0]=
2*(K*G+ba*aa+W*z-Z*ja)/ea,X[1]=2*(W*G+ba*ja+Z*aa-K*z)/ea,X[2]=2*(Z*G+ba*z+K*ja-W*aa)/ea):(X[0]=2*(K*G+ba*aa+W*z-Z*ja),X[1]=2*(W*G+ba*ja+Z*aa-K*z),X[2]=2*(Z*G+ba*z+K*ja-W*aa));R(h,E,X);return h}function V(h,E){h[0]=E[12];h[1]=E[13];h[2]=E[14];return h}function m(h,E){const X=E[0],aa=E[1],ja=E[2],z=E[4],G=E[5],K=E[6],W=E[8],Z=E[9];E=E[10];h[0]=Math.sqrt(X*X+aa*aa+ja*ja);h[1]=Math.sqrt(z*z+G*G+K*K);h[2]=Math.sqrt(W*W+Z*Z+E*E);return h}function O(h,E){const X=E[0]+E[5]+E[10];let aa=0;0<X?(aa=2*Math.sqrt(X+
1),h[3]=.25*aa,h[0]=(E[6]-E[9])/aa,h[1]=(E[8]-E[2])/aa,h[2]=(E[1]-E[4])/aa):E[0]>E[5]&&E[0]>E[10]?(aa=2*Math.sqrt(1+E[0]-E[5]-E[10]),h[3]=(E[6]-E[9])/aa,h[0]=.25*aa,h[1]=(E[1]+E[4])/aa,h[2]=(E[8]+E[2])/aa):E[5]>E[10]?(aa=2*Math.sqrt(1+E[5]-E[0]-E[10]),h[3]=(E[8]-E[2])/aa,h[0]=(E[1]+E[4])/aa,h[1]=.25*aa,h[2]=(E[6]+E[9])/aa):(aa=2*Math.sqrt(1+E[10]-E[0]-E[5]),h[3]=(E[1]-E[4])/aa,h[0]=(E[8]+E[2])/aa,h[1]=(E[6]+E[9])/aa,h[2]=.25*aa);return h}function n(h,E,X,aa){var ja=E[0],z=E[1],G=E[2],K=E[3],W=ja+
ja,Z=z+z,ba=G+G;E=ja*W;const ea=ja*Z;ja*=ba;const la=z*Z;z*=ba;G*=ba;W*=K;Z*=K;K*=ba;ba=aa[0];const na=aa[1];aa=aa[2];h[0]=(1-(la+G))*ba;h[1]=(ea+K)*ba;h[2]=(ja-Z)*ba;h[3]=0;h[4]=(ea-K)*na;h[5]=(1-(E+G))*na;h[6]=(z+W)*na;h[7]=0;h[8]=(ja+Z)*aa;h[9]=(z-W)*aa;h[10]=(1-(E+la))*aa;h[11]=0;h[12]=X[0];h[13]=X[1];h[14]=X[2];h[15]=1;return h}function x(h,E,X,aa,ja){var z=E[0],G=E[1],K=E[2],W=E[3],Z=z+z,ba=G+G,ea=K+K;E=z*Z;var la=z*ba,na=z*ea;z=G*ba;G*=ea;var wa=K*ea;K=W*Z;ba*=W;const ta=W*ea;var va=aa[0],
Ea=aa[1];ea=aa[2];aa=ja[0];W=ja[1];ja=ja[2];Z=(1-(z+wa))*va;const ya=(la+ta)*va;va*=na-ba;la=(la-ta)*Ea;wa=(1-(E+wa))*Ea;Ea*=G+K;na=(na+ba)*ea;G=(G-K)*ea;E=(1-(E+z))*ea;h[0]=Z;h[1]=ya;h[2]=va;h[3]=0;h[4]=la;h[5]=wa;h[6]=Ea;h[7]=0;h[8]=na;h[9]=G;h[10]=E;h[11]=0;h[12]=X[0]+aa-(Z*aa+la*W+na*ja);h[13]=X[1]+W-(ya*aa+wa*W+G*ja);h[14]=X[2]+ja-(va*aa+Ea*W+E*ja);h[15]=1;return h}function M(h,E){var X=E[0],aa=E[1],ja=E[2];E=E[3];var z=X+X,G=aa+aa;const K=ja+ja;X*=z;const W=aa*z;aa*=G;const Z=ja*z,ba=ja*G;ja*=
K;z*=E;G*=E;E*=K;h[0]=1-aa-ja;h[1]=W+E;h[2]=Z-G;h[3]=0;h[4]=W-E;h[5]=1-X-ja;h[6]=ba+z;h[7]=0;h[8]=Z+G;h[9]=ba-z;h[10]=1-X-aa;h[11]=0;h[12]=0;h[13]=0;h[14]=0;h[15]=1;return h}function L(h,E,X,aa,ja,z,G){const K=1/(X-E),W=1/(ja-aa),Z=1/(z-G);h[0]=2*z*K;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=2*z*W;h[6]=0;h[7]=0;h[8]=(X+E)*K;h[9]=(ja+aa)*W;h[10]=(G+z)*Z;h[11]=-1;h[12]=0;h[13]=0;h[14]=G*z*2*Z;h[15]=0;return h}function T(h,E,X,aa,ja){E=1/Math.tan(E/2);let z=void 0;h[0]=E/X;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=E;
h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[11]=-1;h[12]=0;h[13]=0;h[15]=0;null!=ja&&Infinity!==ja?(z=1/(aa-ja),h[10]=(ja+aa)*z,h[14]=2*ja*aa*z):(h[10]=-1,h[14]=-2*aa);return h}function Y(h,E,X,aa){const ja=Math.tan(E.upDegrees*Math.PI/180),z=Math.tan(E.downDegrees*Math.PI/180),G=Math.tan(E.leftDegrees*Math.PI/180);E=Math.tan(E.rightDegrees*Math.PI/180);const K=2/(G+E),W=2/(ja+z);h[0]=K;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=W;h[6]=0;h[7]=0;h[8]=-((G-E)*K*.5);h[9]=(ja-z)*W*.5;h[10]=aa/(X-aa);h[11]=-1;h[12]=0;h[13]=0;
h[14]=aa*X/(X-aa);h[15]=0;return h}function fa(h,E,X,aa,ja,z,G){const K=1/(E-X),W=1/(aa-ja),Z=1/(z-G);h[0]=-2*K;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=-2*W;h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[10]=2*Z;h[11]=0;h[12]=(E+X)*K;h[13]=(ja+aa)*W;h[14]=(G+z)*Z;h[15]=1;return h}function oa(h,E,X,aa){const ja=E[0],z=E[1];E=E[2];let G=ja-X[0],K=z-X[1];X=E-X[2];var W=A.getEpsilon();if(Math.abs(G)<W&&Math.abs(K)<W&&Math.abs(X)<W)p(h);else{var Z=1/Math.sqrt(G*G+K*K+X*X);G*=Z;K*=Z;X*=Z;Z=aa[0];var ba=aa[1];W=aa[2];aa=ba*X-W*
K;W=W*G-Z*X;ba=Z*K-ba*G;(Z=Math.sqrt(aa*aa+W*W+ba*ba))?(Z=1/Z,aa*=Z,W*=Z,ba*=Z):ba=W=aa=0;var ea=K*ba-X*W,la=X*aa-G*ba,na=G*W-K*aa;(Z=Math.sqrt(ea*ea+la*la+na*na))?(Z=1/Z,ea*=Z,la*=Z,na*=Z):na=la=ea=0;h[0]=aa;h[1]=ea;h[2]=G;h[3]=0;h[4]=W;h[5]=la;h[6]=K;h[7]=0;h[8]=ba;h[9]=na;h[10]=X;h[11]=0;h[12]=-(aa*ja+W*z+ba*E);h[13]=-(ea*ja+la*z+na*E);h[14]=-(G*ja+K*z+X*E);h[15]=1}}function sa(h,E,X,aa){const ja=E[0],z=E[1];E=E[2];var G=aa[0];const K=aa[1];var W=aa[2];aa=ja-X[0];let Z=z-X[1];X=E-X[2];let ba=aa*
aa+Z*Z+X*X;0<ba&&(ba=1/Math.sqrt(ba),aa*=ba,Z*=ba,X*=ba);let ea=K*X-W*Z;W=W*aa-G*X;G=G*Z-K*aa;ba=ea*ea+W*W+G*G;0<ba&&(ba=1/Math.sqrt(ba),ea*=ba,W*=ba,G*=ba);h[0]=ea;h[1]=W;h[2]=G;h[3]=0;h[4]=Z*G-X*W;h[5]=X*ea-aa*G;h[6]=aa*W-Z*ea;h[7]=0;h[8]=aa;h[9]=Z;h[10]=X;h[11]=0;h[12]=ja;h[13]=z;h[14]=E;h[15]=1;return h}function ca(h){return"mat4("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+", "+h[4]+", "+h[5]+", "+h[6]+", "+h[7]+", "+h[8]+", "+h[9]+", "+h[10]+", "+h[11]+", "+h[12]+", "+h[13]+", "+h[14]+", "+h[15]+")"}
function ka(h){return Math.sqrt(h[0]**2+h[1]**2+h[2]**2+h[3]**2+h[4]**2+h[5]**2+h[6]**2+h[7]**2+h[8]**2+h[9]**2+h[10]**2+h[11]**2+h[12]**2+h[13]**2+h[14]**2+h[15]**2)}function ia(h,E,X){h[0]=E[0]+X[0];h[1]=E[1]+X[1];h[2]=E[2]+X[2];h[3]=E[3]+X[3];h[4]=E[4]+X[4];h[5]=E[5]+X[5];h[6]=E[6]+X[6];h[7]=E[7]+X[7];h[8]=E[8]+X[8];h[9]=E[9]+X[9];h[10]=E[10]+X[10];h[11]=E[11]+X[11];h[12]=E[12]+X[12];h[13]=E[13]+X[13];h[14]=E[14]+X[14];h[15]=E[15]+X[15];return h}function ra(h,E,X){h[0]=E[0]-X[0];h[1]=E[1]-X[1];
h[2]=E[2]-X[2];h[3]=E[3]-X[3];h[4]=E[4]-X[4];h[5]=E[5]-X[5];h[6]=E[6]-X[6];h[7]=E[7]-X[7];h[8]=E[8]-X[8];h[9]=E[9]-X[9];h[10]=E[10]-X[10];h[11]=E[11]-X[11];h[12]=E[12]-X[12];h[13]=E[13]-X[13];h[14]=E[14]-X[14];h[15]=E[15]-X[15];return h}function pa(h,E,X){h[0]=E[0]*X;h[1]=E[1]*X;h[2]=E[2]*X;h[3]=E[3]*X;h[4]=E[4]*X;h[5]=E[5]*X;h[6]=E[6]*X;h[7]=E[7]*X;h[8]=E[8]*X;h[9]=E[9]*X;h[10]=E[10]*X;h[11]=E[11]*X;h[12]=E[12]*X;h[13]=E[13]*X;h[14]=E[14]*X;h[15]=E[15]*X;return h}function xa(h,E,X,aa){h[0]=E[0]+
X[0]*aa;h[1]=E[1]+X[1]*aa;h[2]=E[2]+X[2]*aa;h[3]=E[3]+X[3]*aa;h[4]=E[4]+X[4]*aa;h[5]=E[5]+X[5]*aa;h[6]=E[6]+X[6]*aa;h[7]=E[7]+X[7]*aa;h[8]=E[8]+X[8]*aa;h[9]=E[9]+X[9]*aa;h[10]=E[10]+X[10]*aa;h[11]=E[11]+X[11]*aa;h[12]=E[12]+X[12]*aa;h[13]=E[13]+X[13]*aa;h[14]=E[14]+X[14]*aa;h[15]=E[15]+X[15]*aa;return h}function Ba(h,E){return h[0]===E[0]&&h[1]===E[1]&&h[2]===E[2]&&h[3]===E[3]&&h[4]===E[4]&&h[5]===E[5]&&h[6]===E[6]&&h[7]===E[7]&&h[8]===E[8]&&h[9]===E[9]&&h[10]===E[10]&&h[11]===E[11]&&h[12]===E[12]&&
h[13]===E[13]&&h[14]===E[14]&&h[15]===E[15]}function Ka(h,E){if(h===E)return!0;const X=h[0],aa=h[1],ja=h[2],z=h[3],G=h[4],K=h[5],W=h[6],Z=h[7],ba=h[8],ea=h[9],la=h[10],na=h[11],wa=h[12],ta=h[13],va=h[14];h=h[15];const Ea=E[0],ya=E[1],Da=E[2],Ca=E[3],za=E[4],Ja=E[5],Ra=E[6],Ya=E[7],Wa=E[8],Ma=E[9],Na=E[10],ma=E[11],Sa=E[12],Nb=E[13],nb=E[14];E=E[15];const c=A.getEpsilon();return Math.abs(X-Ea)<=c*Math.max(1,Math.abs(X),Math.abs(Ea))&&Math.abs(aa-ya)<=c*Math.max(1,Math.abs(aa),Math.abs(ya))&&Math.abs(ja-
Da)<=c*Math.max(1,Math.abs(ja),Math.abs(Da))&&Math.abs(z-Ca)<=c*Math.max(1,Math.abs(z),Math.abs(Ca))&&Math.abs(G-za)<=c*Math.max(1,Math.abs(G),Math.abs(za))&&Math.abs(K-Ja)<=c*Math.max(1,Math.abs(K),Math.abs(Ja))&&Math.abs(W-Ra)<=c*Math.max(1,Math.abs(W),Math.abs(Ra))&&Math.abs(Z-Ya)<=c*Math.max(1,Math.abs(Z),Math.abs(Ya))&&Math.abs(ba-Wa)<=c*Math.max(1,Math.abs(ba),Math.abs(Wa))&&Math.abs(ea-Ma)<=c*Math.max(1,Math.abs(ea),Math.abs(Ma))&&Math.abs(la-Na)<=c*Math.max(1,Math.abs(la),Math.abs(Na))&&Math.abs(na-
ma)<=c*Math.max(1,Math.abs(na),Math.abs(ma))&&Math.abs(wa-Sa)<=c*Math.max(1,Math.abs(wa),Math.abs(Sa))&&Math.abs(ta-Nb)<=c*Math.max(1,Math.abs(ta),Math.abs(Nb))&&Math.abs(va-nb)<=c*Math.max(1,Math.abs(va),Math.abs(nb))&&Math.abs(h-E)<=c*Math.max(1,Math.abs(h),Math.abs(E))}function Fa(h){const E=A.getEpsilon(),X=h[0],aa=h[1],ja=h[2],z=h[4],G=h[5],K=h[6],W=h[8],Z=h[9];h=h[10];return Math.abs(1-(X*X+z*z+W*W))<=E&&Math.abs(1-(aa*aa+G*G+Z*Z))<=E&&Math.abs(1-(ja*ja+K*K+h*h))<=E}function La(h){return 1===
h[0]&&0===h[1]&&0===h[2]&&0===h[4]&&1===h[5]&&0===h[6]&&0===h[8]&&0===h[9]&&1===h[10]}const Ta=d.create();d=Object.freeze(Object.defineProperty({__proto__:null,add:ia,adjoint:t,copy:u,determinant:w,equals:Ka,exactEquals:Ba,frob:ka,fromQuat:M,fromQuat2:P,fromRotation:e,fromRotationTranslation:R,fromRotationTranslationScale:n,fromRotationTranslationScaleOrigin:x,fromScaling:Q,fromTranslation:F,fromXRotation:H,fromYRotation:S,fromZRotation:J,frustum:L,getRotation:O,getScaling:m,getTranslation:V,hasIdentityRotation:La,
identity:p,invert:g,invertOrIdentity:v,isOrthoNormal:Fa,lookAt:oa,mul:C,multiply:C,multiplyScalar:pa,multiplyScalarAndAdd:xa,ortho:fa,perspective:T,perspectiveFromFieldOfView:Y,rotate:l,rotateX:a,rotateY:q,rotateZ:y,scale:r,set:I,str:ca,sub:ra,subtract:ra,targetTo:sa,translate:B,transpose:f},Symbol.toStringTag,{value:"Module"}));b.add=ia;b.adjoint=t;b.copy=u;b.determinant=w;b.equals=Ka;b.exactEquals=Ba;b.frob=ka;b.fromQuat=M;b.fromQuat2=P;b.fromRotation=e;b.fromRotationTranslation=R;b.fromRotationTranslationScale=
n;b.fromRotationTranslationScaleOrigin=x;b.fromScaling=Q;b.fromTranslation=F;b.fromXRotation=H;b.fromYRotation=S;b.fromZRotation=J;b.frustum=L;b.getRotation=O;b.getScaling=m;b.getTranslation=V;b.hasIdentityRotation=La;b.identity=p;b.invert=g;b.invertOrIdentity=v;b.isOrthoNormal=Fa;b.lookAt=oa;b.mat4=d;b.mul=C;b.multiply=C;b.multiplyScalar=pa;b.multiplyScalarAndAdd=xa;b.ortho=fa;b.perspective=T;b.perspectiveFromFieldOfView=Y;b.rotate=l;b.rotateX=a;b.rotateY=q;b.rotateZ=y;b.scale=r;b.set=I;b.str=ca;
b.sub=ra;b.subtract=ra;b.targetTo=sa;b.translate=B;b.transpose=f})},"esri/statistics/utils":function(){define(["exports","../rest/support/ClassBreaksDefinition","../rest/support/generateRendererUtils"],function(b,d,A){function u(n){return null==n||"string"===typeof n&&!n?"\x3cNull\x3e":n}function I(n){const x=null!=n.minValue||null!=n.maxValue,M=!!n.sqlExpression&&n.supportsSQLExpression;return!(null!=n.normalizationField||null!=n.normalizationType)&&!x&&!M}function p(n){const {values:x,useSampleStdDev:M,
supportsNullCount:L}=n;var T=Number.POSITIVE_INFINITY;let Y=Number.NEGATIVE_INFINITY,fa=null,oa=null;var sa=null;let ca=null,ka=0;const ia=null==n.minValue?-Infinity:n.minValue,ra=null==n.maxValue?Infinity:n.maxValue;for(const pa of x)Number.isFinite(pa)?pa>=ia&&pa<=ra&&(fa=null===fa?pa:fa+pa,T=Math.min(T,pa),Y=Math.max(Y,pa),ka++):"string"===typeof pa&&ka++;if(ka&&null!=fa){oa=fa/ka;sa=0;for(const pa of x)Number.isFinite(pa)&&pa>=ia&&pa<=ra&&(sa+=(pa-oa)**2);ca=M?1<ka?sa/(ka-1):0:0<ka?sa/ka:0;sa=
Math.sqrt(ca)}else Y=T=null;T={avg:oa,count:ka,max:Y,min:T,stddev:sa,sum:fa,variance:ca};L&&(T.nullcount=x.length-ka);n.percentileParams&&(T.median=f(x,n.percentileParams));return T}function f(n,x){const {fieldType:M,value:L,orderBy:T,isDiscrete:Y}=x,fa=v(M,"desc"===T);n=[...n].filter(ka=>null!=ka).sort((ka,ia)=>fa(ka,ia));if(0===n.length)return null;if(0>=L)return n[0];if(1<=L)return n[n.length-1];var oa=(n.length-1)*L,sa=Math.floor(oa);x=sa+1;oa%=1;sa=n[sa];const ca=n[x];return x>=n.length||Y||
"string"===typeof sa||"string"===typeof ca?sa:sa*(1-oa)+ca*oa}function v(n,x){if(n){if(F.has(n))return x?m:O;if(Q.has(n))return g(x,!1);if("esriFieldTypeTimestampOffset"===n)return x?R:J;const Y=g(x,!0);if("esriFieldTypeString"===n)return Y;if("esriFieldTypeGUID"===n||"esriFieldTypeGlobalID"===n)return(fa,oa)=>Y(t(fa),t(oa))}const M=x?1:-1,L=x?m:O,T=g(x,!0);return(Y,fa)=>"number"===typeof Y&&"number"===typeof fa?L(Y,fa):"string"===typeof Y&&"string"===typeof fa?T(Y,fa):M}function g(n,x){if(!x)return n?
V:P;const M=n?H:S;return n?(L,T)=>{const Y=M(L,T);if(null!=Y)return Y;L=L.toUpperCase();T=T.toUpperCase();return L>T?-1:L<T?1:0}:(L,T)=>{const Y=M(L,T);if(null!=Y)return Y;L=L.toUpperCase();T=T.toUpperCase();return L<T?-1:L>T?1:0}}function t(n){return n.substr(24,12)+n.substr(19,4)+n.substr(16,2)+n.substr(14,2)+n.substr(11,2)+n.substr(9,2)+n.substr(6,2)+n.substr(4,2)+n.substr(2,2)+n.substr(0,2)}function w(n){return"coded-value"!==n?.type?[]:n.codedValues.map(x=>x.code)}function C(n,x){const M=r({field:x.field,
normalizationType:x.normalizationType,normalizationField:x.normalizationField,classificationMethod:x.classificationMethod,standardDeviationInterval:x.standardDeviationInterval,breakCount:x.numClasses||5});n=B(n,x.minValue,x.maxValue);return A.createGenerateRendererClassBreaks({definition:M,values:n,normalizationTotal:x.normalizationTotal})}function B(n,x,M){const L=null==x?-Infinity:x,T=null==M?Infinity:M;return n.filter(Y=>Number.isFinite(Y)&&Y>=L&&Y<=T)}function r(n){const {breakCount:x,field:M,
normalizationField:L,normalizationType:T}=n,Y=n.classificationMethod||"equal-interval";return new d({breakCount:x,classificationField:M,classificationMethod:Y,normalizationField:"field"===T?L:void 0,normalizationType:T,standardDeviationInterval:"standard-deviation"===Y?n.standardDeviationInterval||1:void 0})}function l(n,x){const {field:M,classificationMethod:L,standardDeviationInterval:T,normalizationType:Y,normalizationField:fa,normalizationTotal:oa,minValue:sa,maxValue:ca}=x,ka=x.numBins||10;let ia=
x=null,ra=null;L&&"equal-interval"!==L||Y?({classBreaks:n}=C(n,{field:M,normalizationType:Y,normalizationField:fa,normalizationTotal:oa,classificationMethod:L,standardDeviationInterval:T,minValue:sa,maxValue:ca,numClasses:ka}),x=n[0].minValue,ia=n[n.length-1].maxValue,ra=n.map(pa=>[pa.minValue,pa.maxValue])):(null!=sa&&null!=ca?(x=sa,ia=ca):(n=p({values:n,minValue:sa,maxValue:ca,useSampleStdDev:!Y,supportsNullCount:I({normalizationType:Y,normalizationField:fa,minValue:sa,maxValue:ca})}),x=n.min??
null,ia=n.max??null),ra=q(x??0,ia??0,ka));return{min:x,max:ia,intervals:ra}}function a(n,x){let M=-1;for(let L=n.length-1;0<=L;L--)if(x>=n[L][0]){M=L;break}return M}function q(n,x,M){const L=(x-n)/M,T=[];let Y;for(let fa=1;fa<=M;fa++)Y=n+L,Y=Number(Y.toFixed(16)),T.push([n,fa===M?x:Y]),n=Y;return T}const y=/\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*/gi,F=new Set("esriFieldTypeDate esriFieldTypeInteger esriFieldTypeSmallInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong esriFieldTypeOID esriFieldTypeBigInteger".split(" ")),
Q=new Set(["esriFieldTypeTimeOnly","esriFieldTypeDateOnly"]),e="min max avg stddev count sum variance nullcount median".split(" "),H=(n,x)=>null==n?null==x?0:1:null==x?-1:null,S=(n,x)=>null==n?null==x?0:-1:null==x?1:null,J=(n,x)=>S(n,x)??(n===x?0:(new Date(n)).getTime()-(new Date(x)).getTime()),R=(n,x)=>H(n,x)??(n===x?0:(new Date(x)).getTime()-(new Date(n)).getTime()),P=(n,x)=>S(n,x)??(n===x?0:n<x?-1:1),V=(n,x)=>H(n,x)??(n===x?0:n<x?1:-1),m=(n,x)=>H(n,x)??x-n,O=(n,x)=>S(n,x)??n-x;b.calculateClassBreaks=
C;b.calculateHistogram=function(n,x){var M=l(n,x);if(null==M.min&&null==M.max)return{bins:[],minValue:M.min,maxValue:M.max,normalizationTotal:x.normalizationTotal};const L=M.intervals,T=M.min??0;M=M.max??0;const Y=L.map((fa,oa)=>({minValue:L[oa][0],maxValue:L[oa][1],count:0}));for(const fa of n)null!=fa&&fa>=T&&fa<=M&&(n=a(L,fa),-1<n&&Y[n].count++);return{bins:Y,minValue:T,maxValue:M,normalizationTotal:x.normalizationTotal}};b.calculatePercentile=f;b.calculateStatistics=p;b.calculateStringStatistics=
function(n){const x=n.returnDistinct?[...(new Set(n.values))]:n.values;var M=x.filter(T=>null!=T).sort();const L=M.length;M={count:L,min:M[0],max:M[L-1]};n.supportsNullCount&&(M.nullcount=x.length-L);n.percentileParams&&(M.median=f(x,n.percentileParams));return M};b.calculateUniqueValuesCount=function(n){const x={};for(let M of n){if(null==M||"string"===typeof M&&""===M.trim())M=null;null==x[M]?x[M]={count:1,data:M}:x[M].count++}return{count:x}};b.createClassBreaksDefinition=r;b.createUVResult=function(n,
x,M,L){n=n.count;const T=[];if(M&&x){M=[];var Y=w(x[0]);for(const fa of Y)if(x[1]){Y=w(x[1]);for(const oa of Y)if(x[2]){Y=w(x[2]);for(const sa of Y)M.push(`${u(fa)}${L}${u(oa)}${L}${u(sa)}`)}else M.push(`${u(fa)}${L}${u(oa)}`)}else M.push(fa);for(const fa of M)n.hasOwnProperty(fa)||(n[fa]={data:fa,count:0})}for(const fa in n)x=n[fa],T.push({value:x.data,count:x.count,label:x.label});return{uniqueValueInfos:T}};b.getAttributeComparator=v;b.getEqualIntervalBins=q;b.getNormalizedValue=function(n,x,M,
L){let T=null;switch(x){case "log":0!==n&&(T=Math.log(n)*Math.LOG10E);break;case "percent-of-total":Number.isFinite(L)&&0!==L&&(T=n/L*100);break;case "field":Number.isFinite(M)&&0!==M&&(T=n/M);break;case "natural-log":0<n&&(T=Math.log(n));break;case "square-root":0<n&&(T=n**.5)}return T};b.isNullCountSupported=I;b.processNullValue=u;b.processSummaryStatisticsResult=function(n,x){let M;for(M in n)e.includes(M)&&(Number.isFinite(n[M])||(n[M]=null));if(!x)return n;["avg","stddev","variance"].forEach(L=>
{null!=n[L]&&(n[L]=Math.ceil(n[L]??0))});return n};b.resolveCBResult=function(n,x){let M=n.classBreaks;const L=M[0]?.minValue,T=M[M.length-1]?.maxValue,Y="standard-deviation"===x;M=M.map(fa=>{const oa=fa.label;fa={minValue:fa.minValue,maxValue:fa.maxValue,label:oa};if(Y&&oa){const sa=oa.match(y)?.map(ca=>+ca.trim())??[];2===sa.length?(fa.minStdDev=sa[0],fa.maxStdDev=sa[1],0>sa[0]&&0<sa[1]&&(fa.hasAvg=!0)):1===sa.length&&(oa.includes("\x3c")?(fa.minStdDev=null,fa.maxStdDev=sa[0]):oa.includes("\x3e")&&
(fa.minStdDev=sa[0],fa.maxStdDev=null))}return fa});return{minValue:L,maxValue:T,classBreakInfos:M,normalizationTotal:n.normalizationTotal}};b.statisticTypes=e;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/ClassBreaksDefinition":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,d,A,u,I,p,f,v,g){I=new d.JSONMap({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"});d=new d.JSONMap({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});A=class extends A.JSONSupport{constructor(t){super(t);this.type="class-breaks-definition";
this.normalizationType=this.normalizationField=this.classificationMethod=this.classificationField=this.breakCount=null}set standardDeviationInterval(t){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",t)}set definedInterval(t){"defined-interval"===this.classificationMethod&&this._set("definedInterval",t)}};b.__decorate([v.enumeration({classBreaksDef:"class-breaks-definition"})],A.prototype,"type",void 0);b.__decorate([u.property({json:{write:!0}})],A.prototype,
"breakCount",void 0);b.__decorate([u.property({json:{write:!0}})],A.prototype,"classificationField",void 0);b.__decorate([u.property({type:String,json:{read:I.read,write:I.write}})],A.prototype,"classificationMethod",void 0);b.__decorate([u.property({json:{write:!0}})],A.prototype,"normalizationField",void 0);b.__decorate([u.property({json:{read:d.read,write:d.write}})],A.prototype,"normalizationType",void 0);b.__decorate([u.property({value:null,json:{write:!0}})],A.prototype,"standardDeviationInterval",
null);b.__decorate([u.property({value:null,json:{write:!0}})],A.prototype,"definedInterval",null);return A=b.__decorate([g.subclass("esri.rest.support.ClassBreaksDefinition")],A)})},"esri/core/accessorSupport/decorators/enumeration":function(){define(["exports","../../jsonMap","./property"],function(b,d,A){b.enumeration=function(u,I={}){u=u instanceof d.JSONMap?u:new d.JSONMap(u,I);u={type:I?.ignoreUnknown??!0?u.apiValues:String,json:{type:u.jsonValues,read:I?.readOnly?!1:{reader:u.read},write:{writer:u.write}}};
void 0!==I?.readOnly&&(u.readOnly=!!I.readOnly);void 0!==I?.default&&(u.json.default=I.default);void 0!==I?.name&&(u.json.name=I.name);void 0!==I?.nonNullable&&(u.nonNullable=I.nonNullable);return A.property(u)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/generateRendererUtils":function(){define(["exports","../../core/Logger"],function(b,d){function A(B){var r=B.definition;const {classificationMethod:l,normalizationType:a,definedInterval:q}=r;r=r.breakCount??
1;const y=[];var F=B.values;if(0===F.length)return[];F=F.sort((R,P)=>R-P);var Q=F[0],e=F[F.length-1];if("equal-interval"===l)if(F.length>=r){F=(e-Q)/r;B=Q;for(var H=1;H<r;H++){var S=Number((Q+H*F).toFixed(6));y.push({minValue:B,maxValue:S,label:u(B,S,a)});B=S}y.push({minValue:B,maxValue:e,label:u(B,e,a)})}else F.forEach(R=>{y.push({minValue:R,maxValue:R,label:u(R,R,a)})});else if("natural-breaks"===l){F=I(F);B=p(F.uniqueValues,B.valueFrequency||F.valueFrequency,r);for(H=1;H<r;H++)F.uniqueValues.length>
H&&(S=Number(F.uniqueValues[B[H]].toFixed(6)),y.push({minValue:Q,maxValue:S,label:u(Q,S,a)}),Q=S);y.push({minValue:Q,maxValue:e,label:u(Q,e,a)})}else if("quantile"===l)if(F.length>=r&&Q!==e){B=Math.ceil(F.length/r);H=0;for(S=1;S<r;S++){var J=B+H-1;J>F.length&&(J=F.length-1);0>J&&(J=0);y.push({minValue:Q,maxValue:F[J],label:u(Q,F[J],a)});Q=F[J];H+=B;B=Math.ceil((F.length-H)/(r-S))}y.push({minValue:Q,maxValue:e,label:u(Q,e,a)})}else for(r=-1,e=0;e<F.length;e++)Q=F[e],Q!==r&&(r=Q,y.push({minValue:r,
maxValue:Q,label:u(r,Q,a)}),r=Q);else if("standard-deviation"===l)if(B=g(F),H=t(F,B),0===H)y.push({minValue:F[0],maxValue:F[0],label:u(F[0],F[0],a)});else{F=v(Q,e,r,B,H)*H;H=0;for(S=r;1<=S;S--)J=Number((B-(S-.5)*F).toFixed(6)),y.push({minValue:Q,maxValue:J,label:u(Q,J,a)}),Q=J,H++;S=Number((B+.5*F).toFixed(6));y.push({minValue:Q,maxValue:S,label:u(Q,S,a)});Q=S;H++;for(J=1;J<=r;J++)S=H===2*r?e:Number((B+(J+.5)*F).toFixed(6)),y.push({minValue:Q,maxValue:S,label:u(Q,S,a)}),Q=S,H++}else if("defined-interval"===
l){if(!q)return y;r=F[0];e=F[F.length-1];F=Math.ceil((e-r)/q);Q=r;for(B=1;B<F;B++)H=Number((r+B*q).toFixed(6)),y.push({minValue:Q,maxValue:H,label:u(Q,H,a)}),Q=H;y.push({minValue:Q,maxValue:e,label:u(Q,e,a)})}return y}function u(B,r,l){let a=null;return a=B===r?l&&"percent-of-total"===l?B+"%":B.toString():l&&"percent-of-total"===l?B+"% - "+r+"%":B+" - "+r}function I(B){const r=[],l=[];let a=Number.MIN_VALUE,q=1,y=-1;for(let F=0;F<B.length;F++){const Q=B[F];Q===a?(q++,l[y]=q):null!==Q&&(r.push(Q),
a=Q,q=1,l.push(q),y++)}return{uniqueValues:r,valueFrequency:l}}function p(B,r,l){var a=B.length;const q=[];l>a&&(l=a);for(var y=0;y<l;y++)q.push(Math.round(y*a/l-1));q.push(a-1);y=f(q,B,r,l);a=y.mean;y=y.sdcm;var F=l,Q=0,e=0;let H=0,S=0,J=!0;for(let P=0;2>P&&J;P++){0===P&&(J=!1);for(var R=0;R<F-1;R++)for(;q[R+1]+1!==q[R+2];)if(q[R+1]+=1,Q=w(R,q,B,r),H=Q.sbMean,Q=Q.sbSdcm,e=w(R+1,q,B,r),S=e.sbMean,e=e.sbSdcm,Q+e<y[R]+y[R+1])y[R]=Q,y[R+1]=e,a[R]=H,a[R+1]=S,J=!0;else{--q[R+1];break}for(R=F-1;0<R;R--)for(;q[R]!==
q[R-1]+1;)if(--q[R],Q=w(R-1,q,B,r),H=Q.sbMean,Q=Q.sbSdcm,e=w(R,q,B,r),S=e.sbMean,e=e.sbSdcm,Q+e<y[R-1]+y[R])y[R-1]=Q,y[R]=e,a[R-1]=H,a[R]=S,J=!0;else{q[R]+=1;break}}J&&(y=f(q,B,r,l));return q}function f(B,r,l,a){let q=[];var y=[],F=[];let Q=0;const e=[],H=[];for(var S=0;S<a;S++){var J=w(S,B,r,l);e.push(J.sbMean);H.push(J.sbSdcm);Q+=H[S]}J=Q;for(S=!0;S||Q<J;){S=!1;q=[];for(y=0;y<a;y++)q.push(B[y]);for(F=0;F<a;F++)for(J=B[F]+1;J<=B[F+1];J++)if(y=r[J],0<F&&J!==B[F+1]&&Math.abs(y-e[F])>Math.abs(y-e[F-
1]))B[F]=J;else if(F<a-1&&B[F]!==J-1&&Math.abs(y-e[F])>Math.abs(y-e[F+1])){B[F+1]=J-1;break}J=Q;Q=0;y=[];F=[];for(let R=0;R<a;R++){y.push(e[R]);F.push(H[R]);const P=w(R,B,r,l);e[R]=P.sbMean;H[R]=P.sbSdcm;Q+=H[R]}}if(Q>J){for(r=0;r<a;r++)B[r]=q[r],e[r]=y[r],H[r]=F[r];Q=J}return{mean:e,sdcm:H}}function v(B,r,l,a,q){B=Math.max(a-B,r-a)/q/l;return 1<=B?1:.5<=B?.5:.25}function g(B){let r=0;for(let l=0;l<B.length;l++)r+=B[l];return r/=B.length}function t(B,r){let l=0;for(let a=0;a<B.length;a++){const q=
B[a];l+=(q-r)*(q-r)}l/=B.length;return Math.sqrt(l)}function w(B,r,l,a){var q=0,y=0;for(var F=r[B]+1;F<=r[B+1];F++){const Q=a[F];q+=l[F]*Q;y+=Q}0>=y&&C.warn("Exception in Natural Breaks calculation");q/=y;y=0;for(F=r[B]+1;F<=r[B+1];F++)y+=a[F]*(l[F]-q)**2;return{sbMean:q,sbSdcm:y}}const C=d.getLogger("esri.rest.support.generateRendererUtils");b.createGenerateRendererClassBreaks=function(B){const {normalizationTotal:r}=B;return{classBreaks:A(B),normalizationTotal:r}};b.createGenerateRendererUniqueValues=
function(B){B=I(B);const r=[],l=B.uniqueValues.length;for(let a=0;a<l;a++){const q=B.uniqueValues[a];r.push({value:q,count:B.valueFrequency[a],label:q.toString()})}return{uniqueValues:r}};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/SnappingCandidate":function(){define(["exports"],function(b){b.makeEdgeCandidate=function(d,A,u,I,p,f=!1){return{objectId:d,target:A,distance:u,type:"edge",start:I,end:p,draped:f}};b.makeVertexCandidate=function(d,A,u){return{objectId:d,
target:A,distance:u,type:"vertex"}};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/queryUtils":function(){define("require exports ../../../core/jsonMap ../../../core/unitUtils ../../../geometry/projection ../../../geometry/support/extentUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ./projectionSupport".split(" "),function(b,d,A,u,I,p,f,v,g,t){async function w(q,y,F){if(!q)return null;
var {where:Q}=q;q.where=Q=Q?.trim();if(!Q||/^1 *= *1$/.test(Q)||y&&y===Q)q.where=null;if(!q.geometry)return q;y=await B(q);q.distance=0;q.units=null;"esriSpatialRelEnvelopeIntersects"===q.spatialRel&&({spatialReference:Q}=q.geometry,y=p.getGeometryExtent(y),y.spatialReference=Q);if(y){await t.checkProjectionSupport(y.spatialReference,F);Q=y.spatialReference;y=C(y,F)&&f.isExtent(y)?{spatialReference:Q,rings:[[[y.xmin,y.ymin],[y.xmin,y.ymax],[y.xmax,y.ymax],[y.xmax,y.ymin],[y.xmin,y.ymin]]]}:y;Q=(await v.normalizeCentralMeridian(f.fromJSON(y)))[0];
if(null==Q)throw a;const e="quantizationParameters"in q&&q.quantizationParameters?.tolerance||"maxAllowableOffset"in q&&q.maxAllowableOffset||0;y=e&&C(y,F)?{densificationStep:8*e}:void 0;Q=Q.toJSON();y=t.project(Q,Q.spatialReference,F,y);if(!y)throw a;y.spatialReference=F;q.geometry=y}return q}function C(q,y){if(!q)return!1;const F=q.spatialReference;return(f.isExtent(q)||f.isPolygon(q)||f.isPolyline(q))&&!g.equals(F,y)&&!I.canProjectWithoutEngine(F,y)}async function B(q){const {distance:y,units:F}=
q,Q=q.geometry;if(null==y||"vertexAttributes"in Q)return Q;var e=Q.spatialReference;q=F?l.fromJSON(F):u.getUnitString(e);e=e&&(g.isGeographic(e)||g.isWebMercator(e))?Q:await t.checkProjectionSupport(e,g.WGS84).then(()=>t.project(Q,g.WGS84));return(await r())(e.spatialReference,e,y,q)}async function r(){return(await new Promise((q,y)=>b(["../../../geometry/geometryEngineJSON"],q,y))).geodesicBuffer}const l=new A.JSONMap({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",
esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),a=Object.freeze({});d.normalizeQuery=async function(q,y,F){const {outFields:Q,orderByFields:e,groupByFieldsForStatistics:H,outStatistics:S}=q;if(Q)for(var J=0;J<Q.length;J++)Q[J]=Q[J].trim();if(e)for(J=0;J<e.length;J++)e[J]=e[J].trim();if(H)for(J=0;J<H.length;J++)H[J]=H[J].trim();if(S)for(J=0;J<S.length;J++)S[J].onStatisticField&&(S[J].onStatisticField=S[J].onStatisticField.trim());
q.geometry&&!q.outSR&&(q.outSR=q.geometry.spatialReference);return w(q,y,F)};d.normalizeQueryLike=w;d.queryEngineEmptyResult=a;d.unitsKebabDict=l;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/queryValidationUtils":function(){define("exports ../../../core/Error ./attributeSupport ./projectionSupport ./spatialQuerySupport ../../../support/arcadeOnDemand".split(" "),function(b,d,A,u,I,p){function f(C,B,r){const {outFields:l,orderByFields:a,returnDistinctValues:q,
outStatistics:y}=r,F=y?y.map(Q=>Q.outStatisticFieldName&&Q.outStatisticFieldName.toLowerCase()).filter(Boolean):[];if(a&&0<a.length){const Q=a.map(e=>{const H=e.toLowerCase();return H.includes(" asc")?H.split(" asc")[0]:H.includes(" desc")?H.split(" desc")[0]:e}).filter(e=>!F.includes(e));A.validateFields(C,B,Q,{expressionName:"orderByFields",query:r})}if(l&&0<l.length)A.validateFields(C,B,l,{expressionName:"outFields",query:r});else if(q)throw new d("unsupported-query","outFields should be specified for returnDistinctValues",
{query:r});A.validateWhere(C,B,r.where,r)}function v(C,B,r){const {outStatistics:l,groupByFieldsForStatistics:a,having:q}=r;var y=a?.length,F=l?.length;if(q){if(!y||!F)throw new d("unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:r});A.validateHaving(C,B,q,l,r)}if(F&&t(l)){F=l.map(Q=>Q.onStatisticField).filter(Boolean);A.validateFields(C,B,F,{expressionName:"onStatisticFields",query:r});y&&A.validateFields(C,B,a,{expressionName:"groupByFieldsForStatistics",
query:r});for(const Q of l){const {onStatisticField:e,statisticType:H}=Q;if(("percentile_disc"===H||"percentile_cont"===H)&&"statisticParameters"in Q){if({statisticParameters:y}=Q,!y)throw new d("unsupported-query","statisticParameters should be set for percentile type",{definition:Q,query:r});}else C.get(e)&&"count"!==H&&"min"!==H&&"max"!==H&&A.validateFields(C,B,[e],{expressionName:`outStatistics with '${H}' statistic type`,allowedFieldTypes:w,query:r})}}}async function g(C,B,r,l){var a=[];r.valueExpression&&
({arcadeUtils:a}=await p.loadArcade(),a=a.extractFieldNames(r.valueExpression));r.field&&a.push(r.field);r.field2&&a.push(r.field2);r.field3&&a.push(r.field3);r.normalizationField&&a.push(r.normalizationField);if(!a.length&&!r.valueExpression)throw new d("unsupported-query","field or valueExpression is required",{params:r});A.validateFields(C,B,a,{expressionName:"statistics",query:l})}function t(C){return null!=C&&C.every(B=>"exceedslimit"!==B.statisticType)}const w=new Set([...A.numericFieldTypes,
...A.allDateAndTimeFieldTypes]);b.validateQuery=async function(C,{fieldsIndex:B,geometryType:r,spatialReference:l,availableFields:a}){if(0>(C.distance??0)||null!=C.geometryPrecision||C.multipatchOption&&"xyFootprint"!==C.multipatchOption||C.pixelSize||C.relationParam||C.text)throw new d("unsupported-query","Unsupported query options",{query:C});f(B,a,C);v(B,a,C);return Promise.all([I.checkSpatialQuerySupport(C,r,l),u.checkProjectionSupport(l,C.outSR)]).then(()=>C)};b.validateStatisticsQuery=async function(C,
B,{fieldsIndex:r,geometryType:l,spatialReference:a,availableFields:q}){if(0>(C.distance??0)||null!=C.geometryPrecision||C.multipatchOption||C.pixelSize||C.relationParam||C.text||C.outStatistics||C.groupByFieldsForStatistics||C.having||C.orderByFields)throw new d("unsupported-query","Unsupported query options",{query:C});f(r,q,C);return Promise.all([g(r,q,B,C),I.checkSpatialQuerySupport(C,l,a),u.checkProjectionSupport(a,C.outSR)]).then(()=>C)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},
"esri/layers/graphics/data/spatialQuerySupport":function(){define("require exports ../../../core/Error ../../../geometry/support/contains ../../../geometry/support/intersects ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ../contains ../featureConversionUtils ../OptimizedGeometry ./geometryUtils ./projectionSupport".split(" "),function(b,d,A,u,I,p,f,v,g,t,w,C){function B(){return new Promise((y,F)=>b(["../../../geometry/geometryEngineJSON"],y,F))}const r={esriSpatialRelIntersects:"intersects",
esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null};var l={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,
esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},a={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},q={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};d.canQueryWithRBush=function(y){if(p.isExtent(y))return!0;if(p.isPolygon(y)){for(const F of y.rings)if(5!==F.length||F[0][0]!==F[1][0]||F[0][0]!==F[4][0]||F[2][0]!==F[3][0]||F[0][1]!==F[3][1]||F[0][1]!==
F[4][1]||F[1][1]!==F[2][1])return!1;return!0}return!1};d.checkSpatialQuerySupport=async function(y,F,Q){const {spatialRel:e,geometry:H}=y;if(H){if(null==e||!0!==l[e])throw new A("unsupported-query","Unsupported query spatial relationship",{query:y});if(f.isValid(H.spatialReference)&&f.isValid(Q)){if(null==H||!0!==a[p.getJsonType(H)])throw new A("unsupported-query","Unsupported query geometry type",{query:y});if(null==F||!0!==q[F])throw new A("unsupported-query","Unsupported layer geometry type",{query:y});
if(y.outSR)return C.checkProjectionSupport(y.geometry?.spatialReference,y.outSR)}}};d.getSpatialQueryOperator=function(y,F,Q,e,H){if(p.isPolygon(F)&&"esriGeometryPoint"===Q&&("esriSpatialRelIntersects"===y||"esriSpatialRelContains"===y)){const S=g.convertFromPolygon(new t,F,!1,!1);return Promise.resolve(J=>v.polygonContainsPoint(S,!1,!1,J))}if(p.isPolygon(F)&&"esriGeometryMultipoint"===Q){const S=g.convertFromPolygon(new t,F,!1,!1);if("esriSpatialRelContains"===y)return Promise.resolve(J=>v.polygonContainsMultipoint(S,
!1,!1,J,e,H))}if(p.isExtent(F)&&"esriGeometryPoint"===Q&&("esriSpatialRelIntersects"===y||"esriSpatialRelContains"===y))return Promise.resolve(S=>u.extentContainsPoint(F,w.getGeometry(Q,e,H,S)));if(p.isExtent(F)&&"esriGeometryMultipoint"===Q&&"esriSpatialRelContains"===y)return Promise.resolve(S=>u.extentContainsMultipoint(F,w.getGeometry(Q,e,H,S)));if(p.isExtent(F)&&"esriSpatialRelIntersects"===y){const S=I.getExtentIntersector(Q);return Promise.resolve(J=>S(F,w.getGeometry(Q,e,H,J)))}return B().then(S=>
{const J=S[r[y]].bind(null,F.spatialReference,F);return R=>J(w.getGeometry(Q,e,H,R))})};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/intersects":function(){define(["exports","./intersectsBase"],function(b,d){b.extentIntersectsExtent=d.extentIntersectsExtent;b.extentIntersectsMultipoint=d.extentIntersectsMultipoint;b.extentIntersectsPoint=d.extentIntersectsPoint;b.extentIntersectsPolygon=d.extentIntersectsPolygon;b.extentIntersectsPolyline=d.extentIntersectsPolyline;
b.extentIntersectsRings=d.extentIntersectsRings;b.getFeatureExtentIntersector=d.getFeatureExtentIntersector;b.isSelfIntersecting=d.isSelfIntersecting;b.segmentIntersects=d.segmentIntersects;b.getExtentIntersector=function(A){return"mesh"===A?d.extentIntersectsExtent:d.getFeatureExtentIntersector(A)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/contains":function(){define(["exports"],function(b){function d(A,u,I,p,f){if(!A)return!1;u=u?I?4:3:I?3:2;const {coords:v,
lengths:g}=A;I=!1;A=0;for(const w of g){var t=A;for(let C=A,B=A+w*u;C<B;C+=u){t=C+u;t===B&&(t=A);const r=v[C],l=v[C+1],a=v[t];t=v[t+1];(l<f&&t>=f||t<f&&l>=f)&&r+(f-l)/(t-l)*(a-r)<p&&(I=!I)}A+=w*u}return I}b.polygonContainsCoords=d;b.polygonContainsMultipoint=function(A,u,I,p,f,v){f=f?v?4:3:v?3:2;const {coords:g,lengths:t}=p;if(!t)return!1;for(let w=0,C=0;w<t.length;w++,C+=f)if(!d(A,u,I,g[C],g[C+1]))return!1;return!0};b.polygonContainsPoint=function(A,u,I,p){return d(A,u,I,p.coords[0],p.coords[1])};
Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/timeSupport":function(){define(["exports"],function(b){function d(I,p,f,v,g){if(null!=v&&null!=g)return t=>{const w=I(t,p);t=I(t,f);return(null==w||w<=g)&&(null==t||t>=v)};if(null!=v)return t=>{t=I(t,f);return null==t||t>=v};if(null!=g)return t=>{t=I(t,p);return null==t||t<=g}}function A(I,p,f,v){if(null!=f&&null!=v&&f===v)return g=>I(g,p)===f;if(null!=f&&null!=v)return g=>{g=I(g,p);return null!=g&&g>=f&&g<=
v};if(null!=f)return g=>{g=I(g,p);return null!=g&&g>=f};if(null!=v)return g=>{g=I(g,p);return null!=g&&g<=v}}function u(){return()=>!1}b.getTimeExtent=async function(I,p){if(!I)return null;const f=p.featureAdapter,{startTimeField:v,endTimeField:g}=I;let t=Number.POSITIVE_INFINITY,w=Number.NEGATIVE_INFINITY;if(v&&g)await p.forEach(C=>{const B=f.getAttribute(C,v);C=f.getAttribute(C,g);null==B||isNaN(B)||(t=Math.min(t,B));null==C||isNaN(C)||(w=Math.max(w,C))});else{const C=v||g;await p.forEach(B=>{B=
f.getAttribute(B,C);null==B||isNaN(B)||(t=Math.min(t,B),w=Math.max(w,B))})}return{start:t,end:w}};b.getTimeOperator=function(I,p,f){if(!p||!I)return null;const {startTimeField:v,endTimeField:g}=I;if(!v&&!g)return null;const {start:t,end:w}=p;if(null===t&&null===w)return null;if(void 0===t&&void 0===w)return u();I=f.getAttributeAsTimestamp?.bind(f)??f.getAttribute.bind(f);return v&&g?d(I,v,g,t,w):A(I,v||g,t,w)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/FieldsIndex":function(){define("../../core/Error ../../core/JSONSupport ../../core/Logger ../../core/MapUtils ../../core/sql/UnknownTimeZone ./fieldUtils ../../time/timeZoneUtils ../../chunks/datetime".split(" "),
function(b,d,A,u,I,p,f,v){function g(r){return r.trim().toLowerCase()}function t(r){const l=new Map;if(!r.fields)return l;const a=!0===r.datesInUnknownTimezone,{timeInfo:q,editFieldsInfo:y}=r;var F=(q?"startField"in q?q.startField:q.startTimeField:"")??"";const Q=(q?"endField"in q?q.endField:q.endTimeField:"")??"",e="dateFieldsTimeZone"in r?r.dateFieldsTimeZone??null:r.dateFieldsTimeReference?f.fromTimeReference(r.dateFieldsTimeReference):null,H=y?"timeZone"in y?y.timeZone??e:y.dateFieldsTimeReference?
f.fromTimeReference(y.dateFieldsTimeReference):e??f.utc:null,S=q?"timeZone"in q?q.timeZone??e:q.timeReference?f.fromTimeReference(q.timeReference):e:null;F=new Map([[g(y?.creationDateField??""),H],[g(y?.editDateField??""),H],[g(F),S],[g(Q),S]]);for(const {name:J,type:R}of r.fields)B.has(R)?l.set(J,f.unknown):"date"!==R&&"esriFieldTypeDate"!==R?l.set(J,null):a?l.set(J,f.unknown):(r=F.get(g(J??""))??e,l.set(J,r));return l}const w=new Map;class C{static fromJSON(r){return new C(r.fields,r.timeZoneByFieldName)}static fromLayer(r){return new C(r.fields??
[],t(r))}static fromLayerJSON(r){return new C(r.fields??[],t(r))}constructor(r=[],l){this._fieldsMap=new Map;this._normalizedFieldsMap=new Map;this._dateFieldsSet=new Set;this._numericFieldsSet=new Set;this._requiredFields=null;this.dateFields=[];this.numericFields=[];this.fields=r||[];this._timeZoneByFieldName=l?new Map(l):null;r=[];for(const a of this.fields){l=a?.name;const q=p.normalizeFieldName(l)?.toLowerCase()??"";if(l&&q){const y=g(l);this._fieldsMap.set(l,a);this._fieldsMap.set(y,a);this._normalizedFieldsMap.set(q,
a);r.push(`${y}:${a.type}:${this._timeZoneByFieldName?.get(l)}`);p.isDateField(a)?(this.dateFields.push(a),this._dateFieldsSet.add(a)):p.isNumericField(a)&&(this._numericFieldsSet.add(a),this.numericFields.push(a));p.isObjectIDField(a)||p.isGlobalIDField(a)||(a.editable=null==a.editable||!!a.editable,a.nullable=null==a.nullable||!!a.nullable)}}r.sort();this.uid=r.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const r of this.fields)p.isObjectIDField(r)||p.isGlobalIDField(r)||
r.nullable||void 0!==p.getFieldDefaultValue(r)||this._requiredFields.push(r)}return this._requiredFields}equals(r){return this.uid===r?.uid}has(r){return null!=this.get(r)}get(r){if(r){var l=this._fieldsMap.get(r);if(l)return l;(l=this._fieldsMap.get(g(r))??this._normalizedFieldsMap.get(p.normalizeFieldName(r)?.toLowerCase()??""))&&this._fieldsMap.set(r,l);return l}}getTimeZone(r){r=this.get(r&&"string"!==typeof r?r.name:r);return r?this._timeZoneByFieldName?this._timeZoneByFieldName.get(r.name):
"date"===r.type||"esriFieldTypeDate"===r.type?(A.getLogger("esri.layers.support.FieldsIndex").error(new b("getTimeZone:no-timezone-information",`no time zone information for field '${r.name}'`)),f.utc):B.has(r.type)?f.unknown:null:null}getLuxonTimeZone(r){const l=this.getTimeZone(r);return l?l===f.unknown?I.UnknownTimeZone.instance:l===f.utc?v.FixedOffsetZone.utcInstance:u.getOrCreateMapValue(w,l,()=>v.IANAZone.create(l)):null}isDateField(r){return this._dateFieldsSet.has(this.get(r))}isTimeOnlyField(r){return p.isTimeOnlyField(this.get(r))}isNumericField(r){return this._numericFieldsSet.has(this.get(r))}normalizeFieldName(r){return this.get(r)?.name??
void 0}toJSON(){return{fields:this.fields.map(r=>d.isSerializable(r)?r.toJSON():r),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}}const B=new Set("time-only date-only timestamp-offset esriFieldTypeDateOnly esriFieldTypeTimeOnly esriFieldTypeTimestampOffset".split(" "));return C})},"esri/views/support/Scheduler":function(){define("exports ../../core/Handles ../../core/has ../../core/Logger ../../core/maybe ../../core/PerformanceSampler ../../core/PooledArray ../../core/promiseUtils ../../core/reactiveUtils ../../core/signal ../../core/time ../../layers/support/PromiseQueue ./debugFlags ./RenderState".split(" "),
function(b,d,A,u,I,p,f,v,g,t,w,C,B,r){function l(P){return a.has(P)?a.get(P):"number"===typeof P?P:1}b.Task=void 0;(function(P){P[P.YIELD=1]="YIELD"})(b.Task||(b.Task={}));b.TaskPriority=void 0;(function(P){P.RESOURCE_CONTROLLER_IMMEDIATE="immediate";P.RESOURCE_CONTROLLER="schedule";P.SLIDE="slide";P.STREAM_DATA_LOADER="stream loader";P.ELEVATION_QUERY="elevation query";P.TERRAIN_SURFACE="terrain";P.SURFACE_GEOMETRY_UPDATES="surface geometry updates";P.LOD_RENDERER="LoD renderer";P.GRAPHICS_CORE=
"Graphics3D";P.I3S_CONTROLLER="I3S";P.POINT_CLOUD_LAYER="point cloud";P.FEATURE_TILE_FETCHER="feature fetcher";P.OVERLAY="overlay";P.STAGE="stage";P.GRAPHICS_DECONFLICTOR="graphics deconflictor";P.FILTER_VISIBILITY="Graphics3D filter visibility";P.SCALE_VISIBILITY="Graphics3D scale visibility";P.FRUSTUM_VISIBILITY="Graphics3D frustum visibility";P.POINT_OF_INTEREST_FREQUENT="POI frequent";P.POINT_OF_INTEREST_INFREQUENT="POI infrequent";P.LABELER="labeler";P.FEATURE_QUERY_ENGINE="feature query";P.FEATURE_TILE_TREE=
"feature tile tree";P.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree";P.ELEVATION_ALIGNMENT="elevation alignment";P.TEXT_TEXTURE_ATLAS="text texture atlas";P.TEXTURE_UNLOAD="texture unload";P.LINE_OF_SIGHT_TOOL="line of sight tool";P.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool";P.ELEVATION_PROFILE="elevation profile";P.SNAPPING="snapping";P.SHADOW_ACCUMULATOR="shadow accumulator";P.CLOUDS_GENERATOR="clouds generator";P[P.NONE=0]="NONE";P[P.TEST_PRIO=1]="TEST_PRIO"})(b.TaskPriority||
(b.TaskPriority={}));const a=new Map([[b.TaskPriority.RESOURCE_CONTROLLER_IMMEDIATE,0],[b.TaskPriority.RESOURCE_CONTROLLER,4],[b.TaskPriority.SLIDE,0],[b.TaskPriority.STREAM_DATA_LOADER,0],[b.TaskPriority.ELEVATION_QUERY,0],[b.TaskPriority.TERRAIN_SURFACE,1],[b.TaskPriority.SURFACE_GEOMETRY_UPDATES,1],[b.TaskPriority.LOD_RENDERER,2],[b.TaskPriority.GRAPHICS_CORE,2],[b.TaskPriority.I3S_CONTROLLER,2],[b.TaskPriority.POINT_CLOUD_LAYER,2],[b.TaskPriority.FEATURE_TILE_FETCHER,2],[b.TaskPriority.OVERLAY,
4],[b.TaskPriority.STAGE,4],[b.TaskPriority.GRAPHICS_DECONFLICTOR,4],[b.TaskPriority.FILTER_VISIBILITY,4],[b.TaskPriority.SCALE_VISIBILITY,4],[b.TaskPriority.FRUSTUM_VISIBILITY,4],[b.TaskPriority.CLOUDS_GENERATOR,4],[b.TaskPriority.POINT_OF_INTEREST_FREQUENT,6],[b.TaskPriority.POINT_OF_INTEREST_INFREQUENT,30],[b.TaskPriority.LABELER,8],[b.TaskPriority.FEATURE_QUERY_ENGINE,8],[b.TaskPriority.FEATURE_TILE_TREE,16],[b.TaskPriority.FEATURE_TILE_TREE_ACTIVE,0],[b.TaskPriority.ELEVATION_ALIGNMENT,12],[b.TaskPriority.TEXT_TEXTURE_ATLAS,
12],[b.TaskPriority.TEXTURE_UNLOAD,12],[b.TaskPriority.LINE_OF_SIGHT_TOOL,16],[b.TaskPriority.LINE_OF_SIGHT_TOOL_INTERACTIVE,0],[b.TaskPriority.SNAPPING,0],[b.TaskPriority.SHADOW_ACCUMULATOR,30]]),q=w.Milliseconds(6.5),y=w.Milliseconds(1),F=w.Milliseconds(30),Q=w.Milliseconds(1E3/30),e=w.Milliseconds(100);var H;(function(P){class V{get updating(){return this._updating.value}_updatingChanged(){this._updating.value=this._tasks.some(n=>n.needsUpdate)}constructor(){this._updating=t.signal(!0);this._microTaskQueued=
!1;this._frameNumber=0;this.performanceInfo={total:new p("total"),tasks:new Map};this._frameTaskTimes=new Map;this._budget=new O;this._state=r.RenderState.INTERACTING;this._tasks=new f;this._runQueue=new f;this._load=0;this._idleStateCallbacks=new f;this._debug=this._forceTask=this._idleUpdatesStartFired=!1;this._debugHandle=g.watch(()=>B.SCHEDULER_LOG_SLOW_TASKS,x=>this._debug=x,g.initial);for(const x of Object.keys(b.TaskPriority))this.performanceInfo.tasks.set(b.TaskPriority[x],new p(b.TaskPriority[x]));
const n=this;this._test={FRAME_SAFETY_BUDGET:q,INTERACTING_BUDGET:Q,IDLE_BUDGET:e,get availableBudget(){return n._budget.budget},usedBudget:0,getBudget:()=>n._budget,setBudget:x=>n._budget=x,updateTask:x=>this._updateTask(x),getState:x=>this._getState(x),getRuntime:x=>this._getRuntime(x),frameTaskTimes:this._frameTaskTimes,resetRuntimes:()=>this._resetRuntimes(),getRunning:()=>this._getRunning()}}destroy(){this._tasks.toArray().forEach(n=>n.remove());this._tasks.clear();I.removeMaybe(this._debugHandle);
this._microTaskQueued=!1;this._updatingChanged()}taskRunningChanged(n){this._updatingChanged();n&&0<this._budget.remaining&&!this._microTaskQueued&&(this._microTaskQueued=!0,queueMicrotask(()=>{this._microTaskQueued&&(this._microTaskQueued=!1,0<this._budget.remaining&&this._schedule()&&this.frame())}))}registerTask(n,x){const M=l(n);x=new m(this,n,x,M);this._tasks.push(x);this._updatingChanged();this.performanceInfo.tasks.has(n)||this.performanceInfo.tasks.set(n,new p(n));return x}registerIdleStateCallbacks(n,
x){const M={idleBegin:n,idleEnd:x};this._idleStateCallbacks.push(M);this.state===r.RenderState.IDLE&&this._idleUpdatesStartFired&&M.idleBegin();const L=this;return{remove:()=>this._removeIdleStateCallbacks(M),set idleBegin(T){L._idleUpdatesStartFired&&(M.idleEnd(),L._state===r.RenderState.IDLE&&T());M.idleBegin=T},set idleEnd(T){M.idleEnd=T}}}get load(){return this._load}set state(n){this._state!==n&&(this._state=n,this.state!==r.RenderState.IDLE&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=
!1,this._idleStateCallbacks.forAll(x=>x.idleEnd())))}get state(){return this._state}updateBudget(n){this._test.usedBudget=0;++this._frameNumber;let x=q,M=n.frameDuration,L=y;switch(this.state){case r.RenderState.IDLE:x=w.Milliseconds(0);M=w.Milliseconds(Math.max(e,n.frameDuration));L=F;break;case r.RenderState.INTERACTING:M=w.Milliseconds(Math.max(Q,n.frameDuration))}M=w.Milliseconds(M-n.elapsedFrameTime-x);if(this.state!==r.RenderState.IDLE&&M<y&&!this._forceTask)return this._forceTask=!0,!1;M=w.Milliseconds(Math.max(M,
L));this._budget.reset(M,this.state);this._updateLoad();return this._schedule()}frame(){this._microTaskQueued=this._forceTask=!1;switch(this.state){case r.RenderState.IDLE:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll(n=>n.idleBegin()));this._runIdle();break;case r.RenderState.INTERACTING:this._runInteracting();break;default:this._runAnimating()}this._test.usedBudget=this._budget.elapsed}stopFrame(){this._budget.reset(w.Milliseconds(0),this._state);this._budget.madeProgress()}_removeIdleStateCallbacks(n){this._idleUpdatesStartFired&&
n.idleEnd();this._idleStateCallbacks.removeUnordered(n)}removeTask(n){this._tasks.removeUnordered(n);this._runQueue.removeUnordered(n);this._updatingChanged()}_updateTask(n){this._tasks.forAll(x=>{x.name===n&&x.setPriority(n)})}_getState(n){if(this._runQueue.some(M=>M.name===n))return b.TaskState.SCHEDULED;let x=b.TaskState.IDLE;this._tasks.forAll(M=>{M.name===n&&M.needsUpdate&&(1>=M.schedulePriority?x=b.TaskState.READY:x!==b.TaskState.READY&&(x=b.TaskState.WAITING))});return x}_getRuntime(n){let x=
0;this._tasks.forAll(M=>{M.name===n&&(x+=M.runtime)});return x}_resetRuntimes(){this._tasks.forAll(n=>n.runtime=0)}_getRunning(){const n=new Map;this._tasks.forAll(M=>{M.needsUpdate&&n.set(M.name,(n.get(M.name)||0)+1)});if(0===n.size)return null;let x="";n.forEach((M,L)=>{x=1<M?x+` ${M}x ${L}`:x+` ${L}`});return x}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){const n=this._tasks.reduce((x,M)=>M.needsUpdate?++x:x,0);this._load=.9*this._load+n*(1-.9)}_schedule(){this._runQueue.filterInPlace(n=>
{if(n.needsUpdate)return!0;n.schedulePriority=n.basePriority;return!1});for(this._tasks.forAll(n=>{0===n.basePriority&&n.needsUpdate&&!this._runQueue.includes(n)&&n.blockFrame!==this._frameNumber&&this._runQueue.unshift(n)});0===this._runQueue.length;){let n=!1;this._tasks.forAll(x=>{if(x.needsUpdate&&0!==x.schedulePriority&&0!==x.basePriority&&x.blockFrame!==this._frameNumber)switch(n=!0,x.schedulePriority){case 1:x.schedulePriority=0;this._runQueue.push(x);break;default:--x.schedulePriority}});
if(!n)return this._updatingChanged(),!1}this._updatingChanged();return!0}_run(){const n=this._budget.now();this._startFrameTaskTimes();do for(;0<this._runQueue.length;){var x=this._budget.now();const M=this._runQueue.pop();this._budget.resetProgress();try{M.task.runTask(this._budget)===b.Task.YIELD&&(M.blockFrame=this._frameNumber)}catch(L){u.getLogger("esri.views.support.Scheduler").error(`Exception in task "${M.name}"`,L),M.blockFrame=this._frameNumber}!this._budget.hasProgressed&&M.blockFrame!==
this._frameNumber&&M.needsUpdate&&(M.blockFrame=this._frameNumber);M.schedulePriority=M.basePriority;x=this._budget.now()-x;M.runtime+=x;this._frameTaskTimes.set(M.priority,this._frameTaskTimes.get(M.priority)+x);this._debug&&x>2*this._budget.budget&&console.log("Task",M.name,"used",x,"of max",this._budget.budget,"ms");if(0>=this._budget.remaining){this._updatingChanged();this._recordFrameTaskTimes(this._budget.now()-n);return}}while(this._schedule());this._updatingChanged();this._recordFrameTaskTimes(this._budget.now()-
n)}_startFrameTaskTimes(){for(const n of Object.keys(b.TaskPriority))this._frameTaskTimes.set(b.TaskPriority[n],0)}_recordFrameTaskTimes(n){this._frameTaskTimes.forEach((x,M)=>this.performanceInfo.tasks.get(M).record(x));this.performanceInfo.total.record(n)}get test(){return this._test}}P.Scheduler=V;class m{get task(){return this._task.value}get updating(){return this._queue.running}constructor(n,x,M,L){this._scheduler=n;this.name=x;this._basePriority=L;this.runtime=this.blockFrame=0;this._queue=
new C.PromiseQueue;this._handles=new d;this.schedulePriority=this._basePriority;this._task=t.signal(null!=M?M:this._queue);this._handles.add(g.when(()=>this.task.running,T=>n.taskRunningChanged(T)))}remove(){this.processQueue(S);this._scheduler.removeTask(this);this.schedule=R.schedule;this.reschedule=R.reschedule;this._handles.destroy()}get basePriority(){return this._basePriority}setPriority(n){this.name=n;n=l(n);if(0===this._basePriority||0!==this.schedulePriority)this.schedulePriority=n;this._basePriority=
n}get priority(){return this.name}set priority(n){this.setPriority(n)}get needsUpdate(){return this.updating||this.task.running}schedule(n,x,M){return this._queue.push(n,x,M)}reschedule(n,x,M){return this._queue.unshift(n,x,M)}processQueue(n){this._queue.runTask(n)}}class O{constructor(){this._begin="undefined"!==typeof performance?performance.now():0;this._budget=0;this._state=r.RenderState.IDLE;this._progressed=this._done=!1;this._enabled=!0}run(n){if(this.done)return!1;!0===n()&&this.madeProgress();
return!0}get done(){return this._done}get budget(){return this._budget}madeProgress(){this._progressed=!0;return this._done=this.elapsed>=this._budget&&this._enabled}get state(){return this._state}get enabled(){return this._enabled}set enabled(n){this._enabled=n}reset(n,x){this._begin=this.now();this._budget=n;this._state=x;this.resetProgress()}get remaining(){return Math.max(this._budget-this.elapsed,0)}now(){return performance.now()}get elapsed(){return performance.now()-this._begin}resetProgress(){this._done=
this._progressed=!1}get hasProgressed(){return this._progressed}}P.Budget=O})(H||(H={}));b.TaskState=void 0;(function(P){P.SCHEDULED="s";P.READY="r";P.WAITING="w";P.IDLE="i"})(b.TaskState||(b.TaskState={}));const S=(()=>{const P=new H.Budget;P.enabled=!1;return P})();class J{remove(){}processQueue(){}schedule(P,V,m){try{if(v.isAborted(V)){const O=v.createAbortError();return m?Promise.resolve(m(O)):Promise.reject(O)}return v.when(P(S))}catch(O){return Promise.reject(O)}}reschedule(P,V,m){return this.schedule(P,
V,m)}}const R=new J;b.ImmediateTask=R;b.getTaskPriority=l;b.newScheduler=function(){return new H.Scheduler};b.noBudget=S;b.taskPriorities=a;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/signal":function(){define(["exports","./lang","./accessorSupport/tracking","./accessorSupport/tracking/SimpleObservable"],function(b,d,A,u){class I{constructor(p,f){this._observable=new u.SimpleObservable;this._value=p;this._equalityFunction=f}get value(){A.trackAccess(this._observable);
return this._value}set value(p){this._equalityFunction(p,this._value)||(this._value=p,this._observable.notify())}mutate(p){p(this._value);this._observable.notify()}}b.signal=function(p,f=d.equalsShallow){return new I(p,f)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/PromiseQueue":function(){define(["exports","../../core/promiseUtils","../../core/signal"],function(b,d,A){class u{constructor(){this._tasks=[];this._running=A.signal(!1)}get length(){return this._tasks.length}get running(){return this._running.value}destroy(){this.cancelAll()}runTask(p){for(;!p.done&&
this._process(p);)p.madeProgress()}push(p,f,v){this._running.value=!0;return new Promise((g,t)=>this._tasks.push(new I(g,t,p,f,v)))}unshift(p,f,v){this._running.value=!0;return new Promise((g,t)=>this._tasks.unshift(new I(g,t,p,f,v)))}_process(p){if(0===this._tasks.length)return!1;const f=this._tasks.shift();try{const v=d.isAborted(f.signal);if(v&&!f.abortCallback)f.reject(d.createAbortError());else{const g=v?f.abortCallback?.(d.createAbortError()):f.callback(p);d.isPromiseLike(g)?g.then(f.resolve,
f.reject):f.resolve(g)}}catch(v){f.reject(v)}this._running.value=0<this._tasks.length;return!0}cancelAll(){const p=d.createAbortError();for(const f of this._tasks)if(f.abortCallback){const v=f.abortCallback(p);f.resolve(v)}else f.reject(p);this._tasks.length=0;this._running.value=!1}}class I{constructor(p,f,v,g,t){this.resolve=p;this.reject=f;this.callback=v;this.signal=g;this.abortCallback=t}}b.PromiseQueue=u;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/debugFlags":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,d,A,u,I,p,f){d=class extends d{constructor(){super(...arguments);this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=this.SCHEDULER_LOG_SLOW_TASKS=!1}};b.__decorate([A.property()],d.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0);b.__decorate([A.property()],d.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0);d=b.__decorate([f.subclass("esri.views.support.DebugFlags")],d);return new d})},"esri/views/support/RenderState":function(){define(["exports"],function(b){b.RenderState=
void 0;var d=b.RenderState||(b.RenderState={});d[d.ANIMATING=0]="ANIMATING";d[d.INTERACTING=1]="INTERACTING";d[d.IDLE=2]="IDLE";Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/sources/geojson/geojson":function(){define("exports ../../../../core/date ../../../../core/Error ../../../../geometry/support/spatialReferenceUtils ../../OptimizedFeature ../../OptimizedGeometry ../../../support/fieldUtils".split(" "),function(b,d,A,u,I,p,f){function*v(e){switch(e.type){case "Feature":yield e;
break;case "FeatureCollection":for(const H of e.features)H&&(yield H)}}function*g(e){if(e)switch(e.type){case "Point":yield e.coordinates;break;case "LineString":case "MultiPoint":yield*e.coordinates;break;case "MultiLineString":case "Polygon":for(const H of e.coordinates)yield*H;break;case "MultiPolygon":for(const H of e.coordinates)for(const S of H)yield*S}}function*t(e,H={}){const {geometryType:S,objectIdField:J}=H;for(const R of e){const {geometry:P,properties:V,id:m}=R;if(P&&Q[P.type]!==S)continue;
e=V||{};let O=void 0;J&&(O=e[J],null==m||O||(e[J]=O=m));yield new I.OptimizedFeature(P?r(new p,P,H):null,e,null,O??void 0)}}function w(e){for(const H of e)if(2<H.length)return!0;return!1}function C(e){let H=0;for(let S=0;S<e.length;S++){const J=e[S],R=e[(S+1)%e.length];H+=J[0]*R[1]-R[0]*J[1]}return 0>=H}function B(e){const H=e[0],S=e[e.length-1];H[0]===S[0]&&H[1]===S[1]&&H[2]===S[2]||e.push(H);return e}function r(e,H,S){switch(H.type){case "LineString":return q(e,H.coordinates,S),e;case "MultiLineString":for(const R of H.coordinates)q(e,
R,S);return e;case "MultiPoint":return q(e,H.coordinates,S),e;case "MultiPolygon":for(var J of H.coordinates)for(l(e,J[0],S),H=1;H<J.length;H++)a(e,J[H],S);return e;case "Point":return F(e,H.coordinates,S),e;case "Polygon":J=H.coordinates;l(e,J[0],S);for(H=1;H<J.length;H++)a(e,J[H],S);return e}}function l(e,H,S){H=B(H);C(H)?q(e,H,S):y(e,H,S)}function a(e,H,S){H=B(H);C(H)?y(e,H,S):q(e,H,S)}function q(e,H,S){for(const J of H)F(e,J,S);e.lengths.push(H.length)}function y(e,H,S){for(let J=H.length-1;0<=
J;J--)F(e,H[J],S);e.lengths.push(H.length)}function F(e,H,S){const [J,R,P]=H;e.coords.push(J,R);S.hasZ&&e.coords.push(P||0)}const Q={LineString:"esriGeometryPolyline",MultiLineString:"esriGeometryPolyline",MultiPoint:"esriGeometryMultipoint",Point:"esriGeometryPoint",Polygon:"esriGeometryPolygon",MultiPolygon:"esriGeometryPolygon"};b.createOptimizedFeatures=function(e,H){return Array.from(t(v(e),H))};b.getGeometryType=function(e){return Q[e]};b.inferLayerProperties=function(e,H={}){const S=[];var J=
new Set;const R=new Set;var P=!1;let V=null,m=!1,O=void 0;({geometryType:H=null}=H);var n=!1;for(const x of v(e)){const {geometry:M,properties:L,id:T}=x;if(M&&(H||(H=Q[M.type]),Q[M.type]!==H))continue;P||(P=g(M),P=w(P));!m&&(m=null!=T)&&(O=typeof T,L&&(V=Object.keys(L).filter(Y=>L[Y]===T)));L&&V&&m&&null!=T&&(1<V.length?V=V.filter(Y=>L[Y]===T):1===V.length&&(V=L[V[0]]===T?V:[]));if(!n&&L){e=!0;for(const Y in L){if(J.has(Y))continue;n=L[Y];if(null==n){e=!1;R.add(Y);continue}a:switch(typeof n){case "string":n=
d.isISO8601Date(n)?"esriFieldTypeDate":"esriFieldTypeString";break a;case "number":n="esriFieldTypeDouble";break a;default:n="unknown"}if("unknown"===n){R.add(Y);continue}R.delete(Y);J.add(Y);const fa=f.normalizeFieldName(Y);fa&&S.push({name:fa,alias:Y,type:n})}n=e}}if(J=f.normalizeFieldName(1===V?.length&&V[0]||null)??void 0)for(const x of S)if(x.name===J&&f.isNumericField(x)){x.type="esriFieldTypeOID";break}return{fields:S,geometryType:H,hasZ:P,objectIdFieldName:J,objectIdFieldType:O,unknownFields:Array.from(R)}};
b.validateGeoJSON=function(e,H=4326){if(!e)throw new A("geojson-layer:empty","GeoJSON data is empty");if("Feature"!==e.type&&"FeatureCollection"!==e.type)throw new A("geojson-layer:unsupported-geojson-object","missing or not supported GeoJSON object type",{data:e});({crs:e}=e);if(e){var S="string"===typeof e?e:"name"===e.type?e.properties.name:"EPSG"===e.type?e.properties.code:null;H=u.isWGS84({wkid:H})?RegExp(".*(CRS84H?|4326)$","i"):new RegExp(`.*(${H})$`,"i");if(!S||!H.test(S))throw new A("geojson:unsupported-crs",
"unsupported GeoJSON 'crs' member",{crs:e});}};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/date":function(){define(["exports"],function(b){function d(f){const v=new Date(f);if(Number.isNaN(v.getTime()))f=!1;else{var g=!0;if(p&&/\d+\W*$/.test(f)&&(f=f.match(/[a-zA-Z]{2,}/))){g=!1;let t=0;for(;!g&&t<=f.length;)g=!I.test(f[t]),t++;g=!g}f=g}return f?Number.isNaN(v.getTime())?null:v.getTime()-6E4*v.getTimezoneOffset():null}function A(f){f=u.exec(f);if(!f?.groups)return null;
f=f.groups;const v=+f.year,g=+f.month-1,t=+f.day,w=+(f.hours??0),C=+(f.minutes??0),B=+(f.seconds??0);if(23<w||59<C||59<B)return null;var r=f.ms??"0";r=r?+r.padEnd(3,"0").substring(0,3):0;f=f.isUTC||!f.offsetSign?Date.UTC(v,g,t,w,C,B,r):6E4*("+"===f.offsetSign?-1:1)*(60*+f.offsetHours+ +f.offsetMinutes)+Date.UTC(v,g,t,w,C,B,r);return Number.isNaN(f)?null:f}const u=/^(?:(?<year>-?\d{4,})-(?<month>\d{2})-(?<day>\d{2}))(?:T(?<hours>\d{2}):(?<minutes>\d{2}):(?<seconds>\d{2})(?:\.(?<ms>\d+))?)?(?:(?<isUTC>Z)|(?:(?<offsetSign>\+|-)(?<offsetHours>\d{2}):(?<offsetMinutes>\d{2})))?$/,
I=/^((jan(uary)?)|(feb(ruary)?)|(mar(ch)?)|(apr(il)?)|(may)|(jun(e)?)|(jul(y)?)|(aug(ust)?)|(sep(tember)?)|(oct(ober)?)|(nov(ember)?)|(dec(ember)?)|(am)|(pm)|(gmt)|(utc))$/i,p=!Number.isNaN((new Date("technology 10")).getTime());b.isDateString=function(f){return null!=A(f)||null!=d(f)};b.isISO8601Date=function(f){return u.test(f)};b.parseDate=function(f){return A(f)??d(f)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/sources/support/sourceUtils":function(){define(["require",
"exports","../../../../core/date","../../../../geometry/support/spatialReferenceUtils","../../../support/fieldUtils"],function(b,d,A,u,I){function p(B){return new g(B)}async function f(){null==C&&(C=await new Promise((B,r)=>b(["../../../../geometry/geometryEngineJSON"],B,r)));return C}class v{constructor(){this.description=this.code=null}}class g{constructor(B){this.error=new v;this.objectId=this.globalId=null;this.success=!1;this.uniqueId=null;this.error.description=B}}class t{constructor(B){this.globalId=
null;this.success=!0;this.objectId=this.uniqueId=B}}const w=new Set;let C;d.createFeatureEditErrorResult=p;d.createFeatureEditSuccessResult=function(B){return new t(B)};d.loadGeometryEngineForSimplify=async function(B,r){!u.isValid(B)||"esriGeometryPolygon"!==r&&"esriGeometryPolyline"!==r||await f()};d.mixAttributes=function(B,r,l,a=!1){w.clear();for(const F in l){const Q=B.get(F);if(!Q)continue;var q=Q,y=l[F];let e=y;I.isNumericField(q)&&"string"===typeof y?e=parseFloat(y):I.isStringField(q)&&null!=
y&&"string"!==typeof y?e=String(y):I.isDateField(q)&&"string"===typeof y&&(e=A.parseDate(y));q=I.sanitizeNullFieldValue(e);w.add(Q.name);if(Q&&(a||Q.editable)){if(y=I.validateFieldValue(Q,q))return p(I.validationErrorToString(y,Q,q));r[Q.name]=q}}for(const F of B?.requiredFields??[])if(!w.has(F.name))return p(`missing required field "${F.name}"`);return null};d.parseStringDateFieldValues=function(B,r){if(B?.length)for(const {name:l}of B)"string"===typeof r[l]&&(r[l]=A.parseDate(r[l]))};d.simplify=
function(B,r){if(!B||!u.isValid(r))return B;if("rings"in B||"paths"in B){if(null==C)throw new TypeError("geometry engine not loaded");return C.simplify(r,B)}return B};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/ogc/wfsUtils":function(){define("exports ../../geometry ../../request ../../core/Error ../../core/iteratorUtils ../../core/urlUtils ../../geometry/projection ../../geometry/support/spatialReferenceUtils ../../geometry/support/typeUtils ../graphics/sources/geojson/geojson ./xmlUtils ../support/arcgisLayerUrl ../support/Field ../support/fieldUtils ../../geometry/SpatialReference ../../geometry/Extent".split(" "),
function(b,d,A,u,I,p,f,v,g,t,w,C,B,r,l,a){function q(ca){ca=M(ca);T(ca);Y(ca);ca=ca.firstElementChild;const ka=I.cache(Q(ca));return{operations:y(ca),get featureTypes(){return Array.from(ka())},readFeatureTypes:ka}}function y(ca){let ka=!1;const ia={GetCapabilities:{url:""},DescribeFeatureType:{url:""},GetFeature:{url:"",outputFormat:null,supportsPagination:!1}};w.visitXML(ca,{OperationsMetadata:{Operation:ra=>{switch(ra.getAttribute("name")){case "GetCapabilities":return{DCP:{HTTP:{Get:pa=>{ia.GetCapabilities.url=
pa.getAttribute("xlink:href")}}}};case "DescribeFeatureType":return{DCP:{HTTP:{Get:pa=>{ia.DescribeFeatureType.url=pa.getAttribute("xlink:href")}}}};case "GetFeature":return{DCP:{HTTP:{Get:pa=>{ia.GetFeature.url=pa.getAttribute("xlink:href")}}},Parameter:pa=>{if("outputFormat"===pa.getAttribute("name"))return{AllowedValues:{Value:xa=>{(xa=xa.textContent)&&oa.has(xa.toLowerCase())&&(ia.GetFeature.outputFormat=xa)}}}}}}},Constraint:ra=>{switch(ra.getAttribute("name")){case "KVPEncoding":return{DefaultValue:pa=>
{ka="true"===pa.textContent.toLowerCase()}};case "ImplementsResultPaging":return{DefaultValue:pa=>{ia.GetFeature.supportsPagination="true"===pa.textContent.toLowerCase()}}}}}});if(!ka)throw new u("wfs-layer:kvp-encoding-not-supported","WFS service doesn't support key/value pair (KVP) encoding");if(null==ia.GetFeature.outputFormat)throw new u("wfs-layer:geojson-not-supported","WFS service doesn't support GeoJSON output format");return ia}function F(ca){ca=parseInt(ca.textContent?.match(/(?<wkid>\d+$)/i)?.groups?.wkid??
"",10);if(!Number.isNaN(ca))return ca}function Q(ca){return w.iterateXML(ca,{FeatureTypeList:{FeatureType:ka=>{const ia={typeName:"undefined:undefined",name:"",title:"",description:"",extent:null,namespacePrefix:"",namespaceUri:"",defaultSpatialReference:4326,supportedSpatialReferences:[]},ra=new Set;w.visitXML(ka,{Name:pa=>{const {name:xa,prefix:Ba}=L(pa.textContent);ia.typeName=`${Ba}:${xa}`;ia.name=xa;ia.namespacePrefix=Ba;ia.namespaceUri=pa.lookupNamespaceURI(Ba)},Abstract:pa=>{ia.description=
pa.textContent},Title:pa=>{ia.title=pa.textContent},WGS84BoundingBox:pa=>{ia.extent=e(pa)},DefaultCRS:pa=>{if(pa=F(pa))ia.defaultSpatialReference=pa,ra.add(pa)},OtherCRS:pa=>{(pa=F(pa))&&ra.add(pa)}});ia.title||(ia.title=ia.name);ra.add(4326);ia.supportedSpatialReferences.push(...ra);return ia}}})}function e(ca){let ka,ia,ra,pa;for(const xa of ca.children)switch(xa.localName){case "LowerCorner":[ka,ia]=xa.textContent.split(" ").map(Ba=>Number.parseFloat(Ba));break;case "UpperCorner":[ra,pa]=xa.textContent.split(" ").map(Ba=>
Number.parseFloat(Ba))}return{xmin:ka,ymin:ia,xmax:ra,ymax:pa,spatialReference:v.WGS84}}function H(ca,ka,ia){return I.find(ca,ra=>ia?ra.name===ka&&ra.namespaceUri===ia:ra.typeName===ka||ra.name===ka)}async function S(ca,ka,ia,ra={}){ca=ca.readFeatureTypes();ia=ka?H(ca,ka,ia):ca.next().value;({spatialReference:ca=new l({wkid:ia?.defaultSpatialReference})}=ra);if(null==ia){if(ka)throw new u("wfs-layer:feature-type-not-found",`The type '${ka}' could not be found in the service`);throw new u("wfs-layer:empty-service",
"The service is empty");}ka=new a({...ia.extent,spatialReference:l.WGS84});if(!v.equals(ka.spatialReference,ca))try{await f.initializeProjection(ka.spatialReference,ca,void 0,ra),ka=f.project(ka,ca)}catch{throw new u("wfs-layer:unsupported-spatial-reference","Projection not supported");}return{extent:ka,spatialReference:ca,featureType:ia}}async function J(ca,ka,ia,ra={}){const {typeName:pa}=ka,[xa,Ba]=await Promise.allSettled([V(ca.operations.DescribeFeatureType.url,pa,ra),P(ca,pa,ia,ra)]);ca=La=>
new u("wfs-layer:getWFSLayerTypeInfo-error",`An error occurred while getting info about the feature type '${pa}'`,{error:La});if("rejected"===xa.status)throw ca(xa.reason);if("rejected"===Ba.status)throw ca(Ba.reason);const {fields:Ka,errors:Fa}=xa.value??{};ca=xa.value?.geometryType||Ba.value?.geometryType;ka=Ba.value?.swapXY??!1;if(null==ca)throw new u("wfs-layer:unknown-geometry-type",`The geometry type could not be determined for type '${pa}`,{typeName:pa,geometryType:ca,fields:Ka,errors:Fa});
return{...R(Ka??[]),geometryType:ca,swapXY:ka}}function R(ca){const ka=ca.find(ra=>"geometry"===ra.type);let ia=ca.find(ra=>"oid"===ra.type);ca=ca.filter(ra=>"geometry"!==ra.type);ia||(ia=new B({name:"__esri_wfs_id__",type:"oid",alias:"__esri_wfs_id__"}),ca.unshift(ia));return{geometryField:ka?.name??null,objectIdField:ia.name,fields:ca}}async function P(ca,ka,ia,ra={}){let pa,xa=!1;const [Ba,Ka]=await Promise.all([n(ca.operations.GetFeature.url,ka,ia,ca.operations.GetFeature.outputFormat,{...ra,
count:1}),A(ca.operations.GetFeature.url,{responseType:"text",query:x(ka,ia,void 0,{...ra,count:1}),signal:ra?.signal})]);if(ca="FeatureCollection"===Ba.type&&Ba.features[0]?.geometry){pa=g.featureGeometryTypeKebabDictionary.fromJSON(t.getGeometryType(ca.type));switch(ca.type){case "Point":var Fa=ca.coordinates;break;case "LineString":case "MultiPoint":Fa=ca.coordinates[0];break;case "MultiLineString":case "Polygon":Fa=ca.coordinates[0][0];break;case "MultiPolygon":Fa=ca.coordinates[0][0][0]}if(ka=
/<[^>]*pos[^>]*> *(-?\d+(?:\.\d+)?) (-?\d+(?:\.\d+)?)/.exec(Ka.data))ca=Fa[0].toFixed(3),Fa=Fa[1].toFixed(3),ia=parseFloat(ka[1]).toFixed(3),ka=parseFloat(ka[2]).toFixed(3),ca===ka&&Fa===ia&&(xa=!0)}return{geometryType:pa,swapXY:xa}}async function V(ca,ka,ia){ca=await A(ca,{responseType:"text",query:{SERVICE:"WFS",REQUEST:"DescribeFeatureType",VERSION:"2.0.0",TYPENAME:ka,...ia?.customParameters},signal:ia?.signal});return m(ka,ca.data)}function m(ca,ka){const {name:ia}=L(ca);ka=M(ka);Y(ka);const ra=
I.find(w.iterateXML(ka.firstElementChild,{element:pa=>({name:pa.getAttribute("name"),typeName:L(pa.getAttribute("type")).name})}),({name:pa})=>pa===ia);if(null!=ra){const pa=I.find(w.iterateXML(ka.firstElementChild,{complexType:xa=>xa}),xa=>xa.getAttribute("name")===ra.typeName);if(null!=pa)return O(pa)}throw new u("wfs-layer:feature-type-not-found",`Type '${ca}' not found in document`,{document:(new XMLSerializer).serializeToString(ka)});}function O(ca){const ka=[],ia=[];let ra=void 0;var pa=w.iterateXML(ca,
{complexContent:{extension:{sequence:{element:xa=>xa}}}});for(const xa of pa){pa=xa.getAttribute("name");if(!pa)continue;let Ba,Ka;xa.hasAttribute("type")?Ba=L(xa.getAttribute("type")).name:w.visitXML(xa,{simpleType:{restriction:Ta=>{Ba=L(Ta.getAttribute("base")).name;return{maxLength:h=>{Ka=+h.getAttribute("value")}}}}});if(!Ba)continue;const Fa="true"===xa.getAttribute("nillable");let La=!1;switch(Ba.toLowerCase()){case "integer":case "nonpositiveinteger":case "negativeinteger":case "long":case "int":case "short":case "byte":case "nonnegativeinteger":case "unsignedlong":case "unsignedint":case "unsignedshort":case "unsignedbyte":case "positiveinteger":ia.push(new B({name:pa,
alias:pa,type:"integer",nullable:Fa,length:r.getFieldDefaultLength("integer")}));break;case "float":case "double":case "decimal":ia.push(new B({name:pa,alias:pa,type:"double",nullable:Fa,length:r.getFieldDefaultLength("double")}));break;case "boolean":case "string":case "gyearmonth":case "gyear":case "gmonthday":case "gday":case "gmonth":case "anyuri":case "qname":case "notation":case "normalizedstring":case "token":case "language":case "idrefs":case "entities":case "nmtoken":case "nmtokens":case "name":case "ncname":case "id":case "idref":case "entity":case "duration":case "time":ia.push(new B({name:pa,
alias:pa,type:"string",nullable:Fa,length:Ka??r.getFieldDefaultLength("string")}));break;case "datetime":case "date":ia.push(new B({name:pa,alias:pa,type:"date",nullable:Fa,length:Ka??r.getFieldDefaultLength("date")}));break;case "pointpropertytype":ra="point";La=!0;break;case "multipointpropertytype":ra="multipoint";La=!0;break;case "curvepropertytype":case "multicurvepropertytype":case "multilinestringpropertytype":ra="polyline";La=!0;break;case "surfacepropertytype":case "multisurfacepropertytype":case "multipolygonpropertytype":ra=
"polygon";La=!0;break;case "geometrypropertytype":case "multigeometrypropertytype":La=!0;ka.push(new u("wfs-layer:unknown-geometry-type",`geometry type '${Ba}' is not supported`,{type:(new XMLSerializer).serializeToString(ca)}));break;default:ka.push(new u("wfs-layer:unknown-field-type",`Unknown field type '${Ba}'`,{type:(new XMLSerializer).serializeToString(ca)}))}La&&ia.push(new B({name:pa,alias:pa,type:"geometry",nullable:Fa}))}for(const xa of ia)if("integer"===xa.type&&!xa.nullable&&sa.has(xa.name.toLowerCase())){xa.type=
"oid";break}return{geometryType:ra,fields:ia,errors:ka}}async function n(ca,ka,ia,ra,pa){({data:ca}=await A(ca,{responseType:"text",query:x(ka,ia,ra,pa),signal:pa?.signal}));ca=ca.replaceAll(/": +(-?\d+),(\d+)(,)?/g,'": $1.$2$3');try{return JSON.parse(ca)}catch(xa){throw new u("wfs-layer:malformed-json","Error while parsing the\u00a0response",{response:ca,error:xa});}}function x(ca,ka,ia,ra){return{SERVICE:"WFS",REQUEST:"GetFeature",VERSION:"2.0.0",TYPENAMES:ca,OUTPUTFORMAT:ia,SRSNAME:"EPSG:"+("number"===
typeof ka?ka:ka.wkid),STARTINDEX:ra?.startIndex,COUNT:ra?.count,...ra?.customParameters}}function M(ca){return(new DOMParser).parseFromString(ca.trim(),"text/xml")}function L(ca){const [ka,ia]=ca.split(":");return{prefix:ia?ka:"",name:ia??ka}}function T(ca){if((ca=ca.firstElementChild?.getAttribute("version"))&&"2.0.0"!==ca)throw new u("wfs-layer:unsupported-wfs-version",`Unsupported WFS version ${ca}. Supported version: ${"2.0.0"}`);}function Y(ca){let ka="",ia="";w.visitXML(ca.firstElementChild,
{Exception:ra=>{ka=ra.getAttribute("exceptionCode");return{ExceptionText:pa=>{ia=pa.textContent}}}});if(ka)throw new u(`wfs-layer:${ka}`,ia);}function fa(ca,ka,ia){const ra={wkid:ka.defaultSpatialReference};ia=null!=ia?.wkid?{wkid:ia.wkid}:ra;ca=C.isArcGISUrl(ca)||ia.wkid&&ka.supportedSpatialReferences.includes(ia.wkid)?{wkid:ia.wkid}:{wkid:ka.defaultSpatialReference};return{spatialReference:ia,getFeatureSpatialReference:ca}}const oa=new Set(["json","application/json","geojson","application/json; subtype\x3dgeojson"]),
sa=new Set(["objectid","fid"]);b.describeFeatureType=V;b.findFeatureType=H;b.getCapabilities=async function(ca,ka){ka=await A(ca,{responseType:"text",query:{SERVICE:"WFS",REQUEST:"GetCapabilities",VERSION:"2.0.0",...ka?.customParameters},signal:ka?.signal});ka=q(ka.data);p.isHTTPSProtocol(ca)&&(p.hasSameOrigin(ca,ka.operations.DescribeFeatureType.url,!0)&&(ka.operations.DescribeFeatureType.url=p.toHTTPS(ka.operations.DescribeFeatureType.url)),p.hasSameOrigin(ca,ka.operations.GetFeature.url,!0)&&(ka.operations.GetFeature.url=
p.toHTTPS(ka.operations.GetFeature.url)));return ka};b.getFeature=n;b.getFeatureCount=async function(ca,ka,ia){ca=await A(ca,{responseType:"text",query:{SERVICE:"WFS",REQUEST:"GetFeature",VERSION:"2.0.0",TYPENAMES:ka,RESULTTYPE:"hits",...ia?.customParameters},signal:ia?.signal});ca=M(ca.data);Y(ca);ca=Number.parseFloat(ca.firstElementChild.getAttribute("numberMatched"));return Number.isNaN(ca)?0:ca};b.getFeatureTypeInfo=S;b.getGetFeatureSpatialReference=fa;b.getWFSLayerInfo=async function(ca,ka,ia,
ra={}){const {featureType:pa,extent:xa}=await S(ca,ka,ia,ra);({spatialReference:ka}=fa(ca.operations.GetFeature.url,pa,ra.spatialReference));const {fields:Ba,geometryType:Ka,swapXY:Fa,objectIdField:La,geometryField:Ta}=await J(ca,pa,ka,ra);return{url:ca.operations.GetCapabilities.url,name:pa.name,namespaceUri:pa.namespaceUri,fields:Ba,geometryField:Ta,geometryType:Ka,objectIdField:La,spatialReference:ra.spatialReference??new l({wkid:pa.defaultSpatialReference}),extent:xa,swapXY:Fa,wfsCapabilities:ca,
customParameters:ra.customParameters}};b.parseDescribeFeatureTypeResponse=m;b.parseGetCapabilitiesResponse=q;b.prepareWFSLayerFields=R;b.wfsOidFieldName="__esri_wfs_id__";Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/layers/ogc/xmlUtils":function(){define(["exports"],function(b){function d(u,I){if(u&&I)for(const p of u.children)p.localName in I&&(u=I[p.localName],"function"===typeof u?(u=u(p))&&d(p,u):d(p,u))}function*A(u,I){for(const p of u.children)p.localName in I&&(u=I[p.localName],
"function"===typeof u?yield u(p):yield*A(p,u))}b.iterateXML=A;b.visitXML=d;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/arcgisLayerUrl":function(){define(["exports","../../core/urlUtils","../../chunks/persistableUrlUtils"],function(b,d,A){function u(C){if(null==C)return null;C=d.urlToObject(C);C=C?.path.match(g)||C?.path.match(t);if(!C)return null;const [,B,r,l,a]=C;C=r.indexOf("/");return{title:p(-1!==C?r.slice(C+1):r),serverType:f[l.toLowerCase()],sublayer:null!=
a&&""!==a?parseInt(a,10):null,url:{path:B}}}function I(C){return(C=d.urlToObject(C).path.match(w))?{serviceUrl:C[1],sublayerId:Number(C[2])}:null}function p(C){C=C.replaceAll(/\s*[/_]+\s*/g," ");return C[0].toUpperCase()+C.slice(1)}const f={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer"},v=Object.values(f),g=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${v.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,
"i"),t=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^\\/\\n]+)\\/(${v.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),w=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;b.cleanTitle=p;b.isArcGISUrl=function(C){return!!g.test(C)};b.isHostedAgolService=function(C){if(!C)return!1;C=C.toLowerCase();const B=C.includes(".arcgis.com/");C=C.includes("//services")||C.includes("//tiles")||C.includes("//features");return B&&C};b.isServerOrServicesAGOLUrl=function(C){if(!C)return!1;C=(new d.Url(d.makeAbsolute(C))).authority?.toLowerCase();
return"server.arcgisonline.com"===C||"services.arcgisonline.com"===C};b.isWmsServer=function(C){if(!C)return!1;var B=C.toLowerCase();C=B.includes("/services/");const r=B.includes("/mapserver/wmsserver"),l=B.includes("/imageserver/wmsserver");B=B.includes("/wmsserver");return C&&(r||l||B)};b.parse=u;b.parseNonStandardSublayerUrl=I;b.sanitizeUrl=function(C,B){return C?d.removeTrailingSlash(d.removeQueryParameters(C,B)):C};b.sanitizeUrlWithLayerId=function(C){let {url:B}=C;if(!B)return{url:B};B=d.removeQueryParameters(B,
C.logger);const r=d.urlToObject(B),l=u(r.path);let a=void 0;null!=l?(null!=l.sublayer&&null==C.layer.layerId&&(a=l.sublayer),B=l.url.path):C.nonStandardUrlAllowed&&(C=I(r.path),null!=C&&(B=C.serviceUrl,a=C.sublayerId));return{url:d.removeTrailingSlash(B),layerId:a}};b.serverTypes=v;b.titleFromUrlAndName=function(C,B){const r=[];C&&(C=u(C),null!=C&&C.title&&r.push(C.title));B&&(B=p(B),r.push(B));if(2===r.length){if(r[0].toLowerCase().includes(r[1].toLowerCase()))return r[0];if(r[1].toLowerCase().includes(r[0].toLowerCase()))return r[1]}return r.join(" - ")};
b.writeUrlWithLayerId=function(C,B,r,l,a){A.write(B,l,"url",a);l.url&&null!=C.layerId&&(l.url=d.join(l.url,r,C.layerId.toString()))};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/persistableUrlUtils":function(){define(["exports","../core/urlUtils"],function(b,d){function A(r,l){var a=l?.url?.path;r&&a&&(r=d.makeAbsolute(r,a,{preserveProtocolRelative:!0}),l.portalItem&&l.readResourcePaths&&(a=d.makeRelative(r,l.portalItem.itemUrl),null!=a&&C.test(a)&&l.readResourcePaths.push(l.portalItem.resourceFromPath(a).path)));
return t(r,l?.portal)}function u(r,l,a=b.MarkKeep.YES){if(null==r)return r;!d.isAbsolute(r)&&l?.blockedRelativeUrls&&l.blockedRelativeUrls.push(r);let q=d.makeAbsolute(r);if(l){var y=l.verifyItemRelativeUrls?.rootPath||l.url?.path;if(y){y=t(y,l.portal);const F=t(q,l.portal);q=d.makeRelative(F,y,y);null!=q&&q!==F&&q!==r&&l.verifyItemRelativeUrls&&l.verifyItemRelativeUrls.writtenUrls.push(q)}}q=g(q,l?.portal);d.isAbsolute(q)&&(q=d.normalize(q));l?.resources&&l?.portalItem&&!d.isAbsolute(q)&&!d.isDataProtocol(q)&&
a===b.MarkKeep.YES&&l.resources.toKeep.push({resource:l.portalItem.resourceFromPath(q),compress:!1});return q}function I(r,l,a){return A(r,a)}function p(r,l,a,q){r=u(r,q);void 0!==r&&(l[a]=r)}function f(r){return(r?.match(w)??null)?.[1]??null}function v(r){r=r?.match(w)??null;if(null==r)return null;r=r[2];const l=r.lastIndexOf("/");if(-1===l){const {path:y,extension:F}=d.splitPathExtension(r);return{prefix:null,filename:y,extension:F}}const {path:a,extension:q}=d.splitPathExtension(r.slice(l+1));
return{prefix:r.slice(0,l),filename:a,extension:q}}function g(r,l){return l&&!l.isPortal&&l.urlKey&&l.customBaseUrl?d.changeDomain(r,`${l.urlKey}.${l.customBaseUrl}`,l.portalHostname):r}function t(r,l){if(!l||l.isPortal||!l.urlKey||!l.customBaseUrl)return r;const a=`${l.urlKey}.${l.customBaseUrl}`,q=d.getAppUrl();return d.hasSameOrigin(q,`${q.scheme}://${a}`)?d.changeDomain(r,l.portalHostname,a):d.changeDomain(r,a,l.portalHostname)}const w=/\/items\/([^\/]+)\/resources\/(.*)/,C=/^\.\/resources\//;
b.MarkKeep=void 0;(function(r){r[r.YES=0]="YES";r[r.NO=1]="NO"})(b.MarkKeep||(b.MarkKeep={}));const B=Object.freeze(Object.defineProperty({__proto__:null,get MarkKeep(){return b.MarkKeep},ensureMainOnlineDomain:g,fromJSON:A,itemIdFromResourceUrl:f,prefixAndFilenameFromResourceUrl:v,read:I,toJSON:u,write:p},Symbol.toStringTag,{value:"Module"}));b.ensureMainOnlineDomain=g;b.fromJSON=A;b.itemIdFromResourceUrl=f;b.persistableUrlUtils=B;b.prefixAndFilenameFromResourceUrl=v;b.read=I;b.toJSON=u;b.write=
p})},"esri/layers/support/Field":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ./domains ./fieldType".split(" "),function(b,d,A,u,I,p,f,v,g,t,w,C){var B;const r=new d.JSONMap({binary:"binary",coordinate:"coordinate",
countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});d=B=class extends A.JSONSupport{constructor(l){super(l);this.alias=null;this.defaultValue=void 0;this.domain=this.description=null;this.editable=!0;this.length=
void 0;this.name=null;this.nullable=!0;this.valueType=this.type=null;this.visible=!0}readDescription(l,{description:a}){l=null;try{l=a?JSON.parse(a):null}catch(q){}return l?.value??null}readValueType(l,{description:a}){l=null;try{l=a?JSON.parse(a):null}catch(q){}return l?r.fromJSON(l.fieldValueType):null}clone(){return new B({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain&&this.domain.clone()||null,editable:this.editable,length:this.length,name:this.name,
nullable:this.nullable,type:this.type,valueType:this.valueType,visible:this.visible})}};b.__decorate([u.property({type:String,json:{write:!0}})],d.prototype,"alias",void 0);b.__decorate([u.property({type:[String,Number],json:{write:{allowNull:!0}}})],d.prototype,"defaultValue",void 0);b.__decorate([u.property()],d.prototype,"description",void 0);b.__decorate([g.reader("description")],d.prototype,"readDescription",null);b.__decorate([u.property({types:w.types,json:{read:{reader:w.fromJSON},write:!0}})],
d.prototype,"domain",void 0);b.__decorate([u.property({type:Boolean,json:{write:!0}})],d.prototype,"editable",void 0);b.__decorate([u.property({type:I.Integer,json:{write:{overridePolicy(l){return{enabled:Number.isFinite(l)}}}}})],d.prototype,"length",void 0);b.__decorate([u.property({type:String,json:{write:!0}})],d.prototype,"name",void 0);b.__decorate([u.property({type:Boolean,json:{write:!0}})],d.prototype,"nullable",void 0);b.__decorate([v.enumeration(C.kebabDict)],d.prototype,"type",void 0);
b.__decorate([u.property()],d.prototype,"valueType",void 0);b.__decorate([g.reader("valueType",["description"])],d.prototype,"readValueType",null);b.__decorate([u.property({type:Boolean,json:{read:!1}})],d.prototype,"visible",void 0);return d=B=b.__decorate([t.subclass("esri.layers.support.Field")],d)})},"esri/layers/support/domains":function(){define("exports ../../core/has ./CodedValueDomain ./Domain ./InheritedDomain ./RangeDomain".split(" "),function(b,d,A,u,I,p){d={key:"type",base:u,typeMap:{range:p,
"coded-value":A,inherited:I}};b.CodedValueDomain=A;b.DomainBase=u;b.InheritedDomain=I;b.RangeDomain=p;b.fromJSON=function(f){if(!f?.type)return null;switch(f.type){case "range":return p.fromJSON(f);case "codedValue":return A.fromJSON(f);case "inherited":return I.fromJSON(f)}return null};b.types=d;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/CodedValueDomain":function(){define("../../chunks/tslib.es6 ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./CodedValue ./Domain".split(" "),
function(b,d,A,u,I,p,f,v){var g;u=g=class extends v{constructor(t){super(t);this.codedValues=null;this.type="coded-value"}getName(t){let w=null;if(this.codedValues){const C=String(t);this.codedValues.some(B=>{String(B.code)===C&&(w=B.name);return!!w})}return w}clone(){return new g({codedValues:d.clone(this.codedValues),name:this.name})}};b.__decorate([A.property({type:[f.CodedValue],json:{write:!0}})],u.prototype,"codedValues",void 0);b.__decorate([I.enumeration({codedValue:"coded-value"})],u.prototype,
"type",void 0);return u=g=b.__decorate([p.subclass("esri.layers.support.CodedValueDomain")],u)})},"esri/layers/support/CodedValue":function(){define("exports ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),function(b,d,A,u,I,p,f,v){var g;b.CodedValue=g=class extends A.JSONSupport{constructor(t){super(t);this.code=this.name=
null}clone(){return new g({name:this.name,code:this.code})}};d.__decorate([u.property({type:String,json:{write:!0}})],b.CodedValue.prototype,"name",void 0);d.__decorate([u.property({type:[String,Number],json:{write:!0}})],b.CodedValue.prototype,"code",void 0);b.CodedValue=g=d.__decorate([v.subclass("esri.layers.support.CodedValue")],b.CodedValue);Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/Domain":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,d,A,u,I,p,f,v,g){d=new d.JSONMap({inherited:"inherited",codedValue:"coded-value",range:"range"});A=class extends A.JSONSupport{constructor(t){super(t);this.type=this.name=null}};b.__decorate([u.property({type:String,json:{write:!0}})],A.prototype,"name",void 0);b.__decorate([v.enumeration(d)],A.prototype,"type",void 0);return A=b.__decorate([g.subclass("esri.layers.support.Domain")],A)})},"esri/layers/support/InheritedDomain":function(){define("../../chunks/tslib.es6 ../../core/Logger ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/Error ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./Domain".split(" "),
function(b,d,A,u,I,p,f,v,g){var t;d=t=class extends g{constructor(w){super(w);this.type="inherited"}clone(){return new t}};b.__decorate([f.enumeration({inherited:"inherited"})],d.prototype,"type",void 0);return d=t=b.__decorate([v.subclass("esri.layers.support.InheritedDomain")],d)})},"esri/layers/support/RangeDomain":function(){define("../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./Domain".split(" "),
function(b,d,A,u,I,p,f,v){var g;A=g=class extends v{constructor(t){super(t);this.minValue=this.maxValue=null;this.type="range"}clone(){return new g({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}};b.__decorate([d.property({json:{type:[Number],read:{source:"range",reader(t,w){return w.range?.[1]}},write:{enabled:!1,overridePolicy(){return{enabled:null!=this.maxValue&&null==this.minValue}},target:"range",writer(t,w,C){w[C]=[this.minValue||0,t]}}}})],A.prototype,"maxValue",void 0);b.__decorate([d.property({json:{type:[Number],
read:{source:"range",reader(t,w){return w.range?.[0]}},write:{target:"range",writer(t,w,C){w[C]=[t,this.maxValue||0]}}}})],A.prototype,"minValue",void 0);b.__decorate([p.enumeration({range:"range"})],A.prototype,"type",void 0);return A=g=b.__decorate([f.subclass("esri.layers.support.RangeDomain")],A)})},"*noref":1}});
define("../../../core/asyncUtils ../../../core/Error ../../../core/Logger ../../../core/promiseUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ../data/FeatureStore ../data/projectionSupport ../data/QueryEngine ./geojson/geojson ./support/sourceUtils ../../ogc/wfsUtils ../../support/FieldsIndex ../../../time/timeZoneUtils".split(" "),function(b,d,A,u,I,p,f,v,g,t,w,C,B,r){class l{constructor(){this._customParameters=this._queryEngine=null}destroy(){this._queryEngine?.destroy();
this._queryEngine=null}async load(a,q){const {getFeatureUrl:y,getFeatureOutputFormat:F,fields:Q,geometryType:e,featureType:H,objectIdField:S,customParameters:J}=a,{spatialReference:R,getFeatureSpatialReference:P}=C.getGetFeatureSpatialReference(y,H,a.spatialReference);this._featureType=H;this._customParameters=J;this._getFeatureUrl=y;this._getFeatureOutputFormat=F;this._getFeatureSpatialReference=P;try{await v.checkProjectionSupport(P,R)}catch{throw new d("unsupported-projection","Projection not supported",
{inSpatialReference:P,outSpatialReference:R});}u.throwIfAborted(q);a=B.fromLayerJSON({fields:Q,dateFieldsTimeReference:Q.some(V=>"esriFieldTypeDate"===V.type)?{timeZoneIANA:r.utc}:null});q=await this._snapshotFeatures({fieldsIndex:a,geometryType:e,objectIdField:S,spatialReference:R},q.signal);this._queryEngine=new g.QueryEngine({fieldsIndex:a,geometryType:e,hasM:!1,hasZ:!1,objectIdField:S,spatialReference:R,timeInfo:null,featureStore:new f({geometryType:e,hasM:!1,hasZ:!1})});this._queryEngine.featureStore.addMany(q);
return{extent:(await this._queryEngine.fetchRecomputedExtents()).fullExtent}}async applyEdits(){throw new d("wfs-source:editing-not-supported","applyEdits() is not supported on WFSLayer");}async queryFeatures(a={},q={}){await this._waitSnapshotComplete();return this._queryEngine.executeQuery(a,q.signal)}async queryFeatureCount(a={},q={}){await this._waitSnapshotComplete();return this._queryEngine.executeQueryForCount(a,q.signal)}async queryObjectIds(a={},q={}){await this._waitSnapshotComplete();return this._queryEngine.executeQueryForIds(a,
q.signal)}async queryExtent(a={},q={}){await this._waitSnapshotComplete();return this._queryEngine.executeQueryForExtent(a,q.signal)}async querySnapping(a,q={}){await this._waitSnapshotComplete();return this._queryEngine.executeQueryForSnapping(a,q.signal)}async refresh(a){this._customParameters=a;this._snapshotTask?.abort();this._snapshotTask=b.createTask(q=>this._snapshotFeatures(this._queryEngine,q));this._snapshotTask.promise.then(q=>{this._queryEngine.featureStore.clear();q&&this._queryEngine.featureStore.addMany(q)},
q=>{this._queryEngine.featureStore.clear();u.isAbortError(q)||A.getLogger("esri.layers.WFSLayer").error(new d("wfs-layer:getfeature-error","An error occurred during the GetFeature request",{error:q}))});await this._waitSnapshotComplete();return{extent:(await this._queryEngine.fetchRecomputedExtents()).fullExtent}}async _waitSnapshotComplete(){if(this._snapshotTask&&!this._snapshotTask.finished){try{await this._snapshotTask.promise}catch{}return this._waitSnapshotComplete()}}async _snapshotFeatures({objectIdField:a,
geometryType:q,spatialReference:y,fieldsIndex:F},Q){const e=await C.getFeature(this._getFeatureUrl??"",this._featureType.typeName,this._getFeatureSpatialReference,this._getFeatureOutputFormat,{customParameters:this._customParameters,signal:Q});t.validateGeoJSON(e,this._getFeatureSpatialReference.wkid);u.throwIfAborted(Q);Q=t.createOptimizedFeatures(e,{geometryType:q,hasZ:!1,objectIdField:a});if(!I.equals(y,this._getFeatureSpatialReference))for(const H of Q)null!=H.geometry&&(H.geometry=p.convertFromGeometry(v.project(p.convertToGeometry(H.geometry,
q,!1,!1),this._getFeatureSpatialReference,y)));q=1;for(const H of Q)y={},w.mixAttributes(F,y,H.attributes,!0),H.attributes=y,null==y[a]&&(H.objectId=y[a]=q++);return Q}}return l});