// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.28/esri/copyright.txt for details.
//>>built
define("exports ../../core/mathUtils ../../chunks/vec3 ../../chunks/vec3f64 ../../chunks/vec4 ../../chunks/common ../../chunks/sphere ./vector ./vectorStacks ../../views/3d/support/mathUtils".split(" "),function(e,T,f,r,x,F,G,B,n,U){function C(a=t){return[a[0],a[1],a[2],a[3]]}function H(a,b){return D(b[0],b[1],b[2],b[3],a)}function D(a,b,c,d,g=C()){g[0]=a;g[1]=b;g[2]=c;g[3]=d;return g}function I(a,b,c){var d=b[0]*b[0]+b[1]*b[1]+b[2]*b[2];d=1E-5<Math.abs(d-1)&&1E-12<d?1/Math.sqrt(d):1;c[0]=b[0]*d;
c[1]=b[1]*d;c[2]=b[2]*d;c[3]=-(c[0]*a[0]+c[1]*a[1]+c[2]*a[2]);return c}function J(a,b,c,d=C()){var g=c[0]-b[0],h=c[1]-b[1],k=c[2]-b[2];c=a[0]-b[0];const l=a[1]-b[1],v=a[2]-b[2];b=h*v-k*l;k=k*c-g*v;g=g*l-h*c;h=b*b+k*k+g*g;h=1E-5<Math.abs(h-1)&&1E-12<h?1/Math.sqrt(h):1;d[0]=b*h;d[1]=k*h;d[2]=g*h;d[3]=-(d[0]*a[0]+d[1]*a[1]+d[2]*a[2]);return d}function E(a,b,c,d=0,g=Math.floor(1/3*c),h=Math.floor(2/3*c)){if(3>c)return!1;b(w,d);let k=g,l=!1;for(;k<c-1&&!l;)b(u,k),k++,l=!f.exactEquals(w,u);if(!l)return!1;
k=Math.max(k,h);for(l=!1;k<c&&!l;)b(q,k),k++,f.subtract(y,w,u),f.normalize(y,y),f.subtract(z,u,q),f.normalize(z,z),l=!f.exactEquals(w,q)&&!f.exactEquals(u,q)&&.99619469809>Math.abs(f.dot(y,z));if(!l)return 0===d&&1===g&&2===h?!1:E(a,b,c,0,1,2);J(w,u,q,a);return!0}function K(a,b,c){a=f.scale(n.sv3d.get(),a,f.dot(a,b));f.subtract(c,b,a);return c}function p(a,b){return f.dot(a,b)+a[3]}function A(a,b,c,d,g){const h=f.dot(a,c);if(0===h)return!1;a=-(f.dot(a,b)+a[3])/h;d&m.CLAMP&&(a=T.clamp(a,0,1));if(!(d&
m.INFINITE_MIN)&&0>a||!(d&m.INFINITE_MAX)&&1<a)return!1;f.add(g,b,f.scale(g,c,a));return!0}const V=x.exactEquals;x=x.equals;const w=r.create(),u=r.create(),q=r.create(),y=r.create(),z=r.create(),W=(()=>{const a=r.create();return(b,c,d)=>{f.cross(a,b,c);if(f.squaredLength(a)<F.getEpsilon())return!1;f.normalize(a,a);const [g,h,k]=a,l=d.origin,v=Math.abs(g),L=Math.abs(h),M=Math.abs(k),[N,O,P]=b,[Q,R,S]=c;b=b[3];c=c[3];v>L&&v>M?(l[1]=(c*P-b*S)/g,l[2]=(b*R-c*O)/g):L>M?(l[0]=(b*S-c*P)/h,l[2]=(c*N-b*Q)/
h):(l[0]=(c*O-b*R)/k,l[1]=(b*Q-c*N)/k);f.copy(d.direction,a);return!0}})(),t=[0,0,1,0];var m;(function(a){a[a.NONE=0]="NONE";a[a.CLAMP=1]="CLAMP";a[a.INFINITE_MIN=4]="INFINITE_MIN";a[a.INFINITE_MAX=8]="INFINITE_MAX"})(m||(m={}));const X=m.INFINITE_MIN|m.INFINITE_MAX,Y=m.INFINITE_MAX;e.clip=function(a,b){const c=f.dot(a,b.ray.direction);a=-p(a,b.ray.origin);if(0>a&&0<=c)return!1;if(-1E-6<c&&1E-6>c)return 0<a;if((0>a||0>c)&&!(0>a&&0>c))return!0;a/=c;0<c?a<b.c1&&(b.c1=a):a>b.c0&&(b.c0=a);return b.c0<=
b.c1};e.clipInfinite=function(a,b){const c=f.dot(a,b.ray.direction);a=-p(a,b.ray.origin);if(-1E-6<c&&1E-6>c)return 0<a;a/=c;0<c?a<b.c1&&(b.c1=a):a>b.c0&&(b.c0=a);return b.c0<=b.c1};e.copy=H;e.create=C;e.distance=function(a,b){return Math.abs(p(a,b))};e.equals=x;e.exactEquals=V;e.fromArray=function(a,b,c=!0){const d=b.length/3;return E(a,(g,h)=>f.set(g,b[3*h],b[3*h+1],b[3*h+2]),c?d-1:d)};e.fromManyPoints=E;e.fromNormalAndOffset=function(a,b,c){f.copy(c,a);c[3]=b;return c};e.fromPoints=J;e.fromPositionAndNormal=
I;e.fromValues=D;e.fromVectorsAndPoint=function(a,b,c,d){f.cross(q,b,a);return I(c,q,d)};e.intersectLine=function(a,b,c,d){c=f.subtract(n.sv3d.get(),c,b);return A(a,b,c,X,d)};e.intersectLineSegment=function(a,b,c){return A(a,b.origin,b.vector,m.NONE,c)};e.intersectLineSegmentClamp=function(a,b,c){return A(a,b.origin,b.vector,m.CLAMP,c)};e.intersectPlanes=W;e.intersectRay=function(a,b,c){return null!=b?A(a,b.origin,b.direction,Y,c):!1};e.isPointInside=function(a,b){return 0<=p(a,b)};e.isPointOutside=
function(a,b){return 0>p(a,b)};e.isSphereFullyInside=function(a,b){return 0<=p(a,G.getCenter(b))-b[3]};e.isSphereFullyOutside=function(a,b){return 0>p(a,G.getCenter(b))+b[3]};e.isVertical=function(a){return Math.abs(a[2])<F.getEpsilon()};e.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=-a[3];return b};e.normal=function(a){return a};e.projectPoint=function(a,b,c){const d=f.scale(n.sv3d.get(),a,-a[3]);b=f.subtract(n.sv3d.get(),b,d);a=K(a,b,n.sv3d.get());f.add(c,a,d);return c};e.projectPointLocal=
function(a,b,c,d){var g=n.sv3d.get(),h=n.sv3d.get();U.tangentFrame(a,g,h);b=f.subtract(n.sv3d.get(),c,b);g=B.projectPointSignedLength(g,b);h=B.projectPointSignedLength(h,b);a=B.projectPointSignedLength(a,b);return f.set(d,g,h,a)};e.projectVector=K;e.setOffsetFromPoint=function(a,b,c){b!==a&&H(a,b);a[3]=-f.dot(a,c);return a};e.signedDistance=p;e.up=t;e.wrap=function(a=t[0],b=t[1],c=t[2],d=t[3]){return D(a,b,c,d,n.sv4d.get())};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});