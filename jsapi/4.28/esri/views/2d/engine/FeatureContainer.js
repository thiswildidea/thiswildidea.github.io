// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.28/esri/copyright.txt for details.
//>>built
define("exports ../../../core/promiseUtils ../../../core/Queue ./webgl/AttributeStoreView ./webgl/TileContainer ./webgl/WGLRendererInfo".split(" "),function(f,g,h,k,l,m){class n extends l{constructor(a){super(a);this._rendererInfo=new m.WGLRendererInfo;this._materialItemsRequestQueue=new h;this.attributeView=new k.AttributeStoreView(()=>this.onAttributeStoreUpdate())}destroy(){this.children.forEach(a=>a.destroy());this.removeAllChildren();this.attributeView.destroy();this._materialItemsRequestQueue.clear()}setRendererInfo(a,
b,c){this._rendererInfo.setInfo(a,b,c);this.requestRender()}async getMaterialItems(a,b){if(!a||0===a.length)return[];const c=g.createResolver();this._materialItemsRequestQueue.push({items:a,abortOptions:b,resolver:c});this.requestRender();return c.promise}doRender(a){a.context.capabilities.enable("textureFloat");a.context.capabilities.enable("vao");if(0<this._materialItemsRequestQueue.length){let b=this._materialItemsRequestQueue.pop();for(;b;)this._processMaterialItemRequest(a,b),b=this._materialItemsRequestQueue.pop()}super.doRender(a)}renderChildren(a){for(const b of this.children)b.commit(a);
this._rendererInfo.update(a.state);super.renderChildren(a)}createRenderParams(a){a=super.createRenderParams(a);a.rendererInfo=this._rendererInfo;a.attributeView=this.attributeView;return a}onAttributeStoreUpdate(){}_processMaterialItemRequest(a,{items:b,abortOptions:c,resolver:e}){const {painter:p,pixelRatio:q}=a;a=b.map(d=>p.textureManager.rasterizeItem(d.symbol,q,d.glyphIds,c));Promise.all(a).then(d=>{this.stage?(d=d.map((r,t)=>({id:b[t].id,mosaicItem:r})),e.resolve(d)):e.reject()},e.reject)}}f.FeatureContainer=
n;Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})});