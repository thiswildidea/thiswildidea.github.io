// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.28/esri/copyright.txt for details.
//>>built
define(["./materialKey/MaterialKey"],function(u){function h(a,b,d,...c){b<a.length?a.splice(b,d,...c):a.push(...c)}class p{constructor(){this.symbolLevels=[]}replay(a,b,d){for(const e of this.symbolLevels)for(const l of e.zLevels){var c=l.geometryDPInfo.unified;if(c)for(const g of c){const {geometryType:m,materialKey:q,indexFrom:v,indexCount:w}=g;c=u.MaterialKeyBase.load(q).symbologyType;c=a.painter.getBrush(m,c);var f=b.getGeometry(m);f={geometryType:m,materialKey:q,indexFrom:v,indexCount:w,target:f};
c.prepareState(a);c.drawGeometry(a,b,f,d)}}}get empty(){return!this.symbolLevels||0===this.symbolLevels.length}clear(){this.symbolLevels.length=0}addToList(a,b){if(Array.isArray(a))for(const d of a)this._addToList(d,b);else this._addToList(a,b)}removeFromList(a){Array.isArray(a)||(a=[a]);let b=null;for(const d of a)b=this._removeFromList(d);return b}clone(){const a=new p;for(const b of this.symbolLevels)a.symbolLevels.push(b.clone());return a}splitAfter(a){const b=this._getDisplayList(a.symbolLevel,
a.zOrder),d=b.length,c=a.indexFrom+a.indexCount;for(let f=0;f<d;++f){const e=b[f];if(e.geometryType===a.geometryType&&c>e.indexFrom&&c<=e.indexFrom+e.indexCount)return c<e.indexFrom+e.indexCount&&(a=new k,a.geometryType=e.geometryType,a.materialKey=e.materialKey,a.indexFrom=c,a.indexCount=e.indexFrom+e.indexCount-c,b.splice(f+1,0,a),e.indexCount=c-e.indexFrom),f}}_addToList(a,b){const d=this._getDisplayList(a.symbolLevel,a.zOrder);b=null!=b?b:d.length-1;var c=0<=b&&b<d.length?d[b]:null;null!==c&&
c.materialKey===a.materialKey&&c.indexFrom+c.indexCount===a.indexFrom&&c.geometryType===a.geometryType?c.indexCount+=a.indexCount:(c=new k,c.indexFrom=a.indexFrom,c.indexCount=a.indexCount,c.materialKey=a.materialKey,c.geometryType=a.geometryType,h(d,b+1,0,c))}_removeFromList(a){const b=this._getDisplayList(a.symbolLevel,a.zOrder);var d=b.length;let c=void 0;for(var f=0;f<d;++f){var e=b[f];if(a.indexFrom+a.indexCount>e.indexFrom&&a.indexFrom<e.indexFrom+e.indexCount&&e.geometryType===a.geometryType){c=
f;break}}if(void 0!==c){d=b[c];if(a.indexFrom===d.indexFrom)return d.indexCount-=a.indexCount,d.indexFrom+=a.indexCount,0===d.indexCount&&h(b,c,1),c-1;if(a.indexFrom+a.indexCount===d.indexFrom+d.indexCount)return d.indexCount-=a.indexCount,0===d.indexCount?(h(b,c,1),c-1):c;f=d.indexFrom;e=a.indexFrom-d.indexFrom;const l=a.indexCount;a=d.indexFrom+d.indexCount-(a.indexFrom+a.indexCount);d.indexCount=e;const g=new k;g.geometryType=d.geometryType;g.materialKey=d.materialKey;g.indexFrom=f+e+l;g.indexCount=
a;h(b,c+1,0,g);return c}return null}_getDisplayList(a,b){let d;var c=this.symbolLevels.length;for(let e=0;e<c;e++)if(this.symbolLevels[e].symbolLevel===a){d=this.symbolLevels[e];break}d||(d=new r,d.symbolLevel=a,this.symbolLevels.push(d));let f;a=d.zLevels.length;for(c=0;c<a;c++)if(d.zLevels[c].zLevel===b){f=d.zLevels[c];break}f||(f=new t,f.geometryDPInfo=new n,f.zLevel=b,d.zLevels.push(f));f.geometryDPInfo.unified||(f.geometryDPInfo.unified=[]);return f.geometryDPInfo.unified}getDPInfoType(){return"unified"}}
class k{constructor(){this.materialKey=null;this.indexCount=this.indexFrom=0}clone(){const a=new k;a.geometryType=this.geometryType;a.materialKey=this.materialKey;a.indexFrom=this.indexFrom;a.indexCount=this.indexCount;return a}}class n{constructor(){this.unified=this.label=this.text=this.marker=this.line=this.fill=null}clone(){const a=new n;a.fill=this.fill&&this.fill.map(b=>b.clone());a.line=this.line&&this.line.map(b=>b.clone());a.marker=this.marker&&this.marker.map(b=>b.clone());a.text=this.text&&
this.text.map(b=>b.clone());a.label=this.label&&this.label.map(b=>b.clone());a.unified=this.unified&&this.unified.map(b=>b.clone());return a}}class t{constructor(){this.geometryDPInfo=new n}clone(){const a=new t;a.zLevel=this.zLevel;a.geometryDPInfo=this.geometryDPInfo.clone();return a}}class r{constructor(){this.zLevels=[]}clone(){const a=new r;a.symbolLevel=this.symbolLevel;for(const b of this.zLevels)a.zLevels.push(b.clone());return a}}return p});