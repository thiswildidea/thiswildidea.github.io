// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.28/esri/copyright.txt for details.
//>>built
define("../../../../../../core/screenUtils ../../color ../../definitions ../../GeometryUtils ../../number ../../materialKey/MaterialKey ./util ./WGLBaseFillTemplate ./WGLMeshTemplate".split(" "),function(u,z,a,A,p,B,v,C,D){class w extends C(D){constructor(b,d,e,g,q,m,h,k,f,n,c,l,r,x,y,t){super();this._effects=x||void 0;b=B.FillMaterialKey.load(b);d&&(b.sdf=d.sdf,b.pattern=!0,b.textureBinding=d.textureBinding);this.fillColor=e;this.tl=g;this.br=q;this.aux21=p.i1616to32(m,h);this.aux22=p.i1616to32(k,
f);this.aux3=p.i8888to32(n,c,l,0);this._bitset=r;this._minMaxZoom=p.i1616to32(Math.round(y*a.minMaxZoomPrecisionFactor),Math.round(t*a.minMaxZoomPrecisionFactor));this._materialKey=b.data}static fromCIMFill(b,d,e){var g=b.color;g=g&&z.premultiplyAlphaRGBA(g)||0;const q=b.materialKey,[m,h]=v.getMinMaxZoom(b.scaleInfo,e);e=(b.colorLocked?a.bitsetGenericLockColor:0)|(b.applyRandomOffset?a.bitsetFillRandomPatternOffset:0)|(b.sampleAlphaOnly?a.bitsetGenericConsiderAlphaOnly:0)|(b.hasUnresolvedReplacementColor?
a.bitsetFillHasUnresolvedReplacementColor:0);if(!d)return new w(q,null,g,0,0,0,0,0,0,0,0,0,e,b.effects,m,h);const {rect:k,width:f,height:n}=d;var c=b.scaleX||1,l=k.x+a.spritePadding;const r=k.y+a.spritePadding;var x=l+f;const y=r+n;var t=u.pt2px(b.height);c*=t;"CIMHatchFill"===b.cim.type&&(c*=f/n);0>=t&&(t=y-r);t<a.maxSizeForU16Compression&&(t*=a.compressionFactorForU16,e|=a.bitsetFillHasPatternHeightPrecisionFactor);t=Math.round(t);0>=c&&(c=x-l);c<a.maxSizeForU16Compression&&(c*=a.compressionFactorForU16,
e|=a.bitsetFillHasPatternWidthPrecisionFactor);c=Math.round(c);const E=u.pt2px(b.offsetX||0),F=u.pt2px(-b.offsetY||0);l=p.i1616to32(l,r);x=p.i1616to32(x,y);return new w(q,d,g,l,x,c,t,E,F,a.compressionFactorForU16,a.compressionFactorForU16,A.degToByte(b.angle),e,b.effects,m,h)}static fromSimpleFill(b,d,e=!1){var {color:g}=b;g=g&&"esriSFSNull"!==b.style&&z.premultiplyAlphaRGBAArray(g)||0;e=e?a.bitsetGenericLockColor:0;const q=b.materialKey;if(d){const {rect:n,width:c,height:l,pixelRatio:r}=d;var m=
n.x+a.spritePadding,h=n.y+a.spritePadding,k=m+c,f=h+l;m=p.i1616to32(m,h);k=p.i1616to32(k,f);f=c/r;f<a.maxSizeForU16Compression&&(f*=a.compressionFactorForU16,e|=a.bitsetFillHasPatternWidthPrecisionFactor);f=Math.round(f);h=l/r;h<a.maxSizeForU16Compression&&(h*=a.compressionFactorForU16,e|=a.bitsetFillHasPatternHeightPrecisionFactor);h=Math.round(h);d=new w(q,d,g,m,k,f,h,0,0,a.compressionFactorForU16,a.compressionFactorForU16,0,e,null,v.defaultMinZoom,v.defaultMaxZoom)}else d=new w(q,null,g,0,0,0,
0,0,0,0,0,0,e,null,v.defaultMinZoom,v.defaultMaxZoom);d._maybeAddLineTemplate(b);return d}static fromPictureFill(b,d,e=!1){const g=a.pictureFillColor,{rect:q,width:m,height:h}=d;var k=q.x+a.spritePadding,f=q.y+a.spritePadding,n=k+m,c=f+h;k=p.i1616to32(k,f);n=p.i1616to32(n,c);e=e?a.bitsetGenericLockColor:0;c=u.pt2px(b.width);c<a.maxSizeForU16Compression&&(c*=a.compressionFactorForU16,e|=a.bitsetFillHasPatternWidthPrecisionFactor);c=Math.round(c);f=u.pt2px(b.height);f<a.maxSizeForU16Compression&&(f*=
a.compressionFactorForU16,e|=a.bitsetFillHasPatternHeightPrecisionFactor);f=Math.round(f);const l=u.pt2px(b.xoffset),r=u.pt2px(-b.yoffset);d=new w(b.materialKey,d,g,k,n,c,f,l,r,a.compressionFactorForU16*b.xscale,a.compressionFactorForU16*b.yscale,0,e,null,v.defaultMinZoom,v.defaultMaxZoom);d._maybeAddLineTemplate(b);return d}}return w});