// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.28/esri/copyright.txt for details.
//>>built
define(["exports","../enums","./core"],function(p,u,v){class w{constructor(d,b,e){this._rows=Math.ceil(b/e);this._columns=Math.ceil(d/e);this._cellSize=e;this.cells=Array(this._rows);for(d=0;d<this._rows;d++)for(this.cells[d]=Array(this._columns),b=0;b<this._columns;b++)this.cells[d][b]=[]}getCell(d,b){b=Math.min(Math.max(Math.floor(b/this._cellSize),0),this._rows-1);d=Math.min(Math.max(Math.floor(d/this._cellSize),0),this._columns-1);return this.cells[b]&&this.cells[b][d]||null}getCellSpan(d,b,e,
a){return[Math.min(Math.max(Math.floor(d/this._cellSize),0),this.columns-1),Math.min(Math.max(Math.floor(b/this._cellSize),0),this.rows-1),Math.min(Math.max(Math.floor(e/this._cellSize),0),this.columns-1),Math.min(Math.max(Math.floor(a/this._cellSize),0),this.rows-1)]}get cellSize(){return this._cellSize}get columns(){return this._columns}get rows(){return this._rows}}p.GridIndex=w;p.deserializeSymbols=function(d,b,e,a,q,k){const g=b[a++];for(let t=0;t<g;t++){const h=new v.VTLSymbol(k);h.xTile=b[a++];
h.yTile=b[a++];h.hash=b[a++];h.priority=b[a++];var c=b[a++];for(var f=0;f<c;f++){const l=b[a++],m=b[a++],n=b[a++],r=b[a++],x=!!b[a++],y=b[a++],z=e[a++],A=e[a++],B=b[a++],C=b[a++];h.colliders.push({xTile:l,yTile:m,dxPixels:n,dyPixels:r,hard:x,partIndex:y,width:B,height:C,minLod:z,maxLod:A})}c=d[a++];for(f=0;f<c;f++)h.textVertexRanges.push([d[a++],d[a++]]);c=d[a++];for(f=0;f<c;f++)h.iconVertexRanges.push([d[a++],d[a++]]);q.push(h)}return a};p.tileCoordChange=function(d,b,e,a,q,k){e-=q;if(0<=e)return(b>>
e)+(a-(k<<e))*(d>>e);e=-e;return b-(k-(a<<e))*(d>>e)<<e};p.writeOpacityToBuffers=function(d,b,e){for(const [t,h]of d.symbols){{var a=d,q=b,k=e,g=h;const l=a.layerData.get(t);if(l.type===u.BucketType.SYMBOL){for(const m of g){g=m.unique;var c=void 0;if(m.selectedForRendering){var f=g.parts[0];c=f.startOpacity;f=f.targetOpacity;a.allSymbolsFadingOut=a.allSymbolsFadingOut&&0===f;c=k?Math.floor(127*c)|f<<7:f?255:0;c|=c<<24|c<<16|c<<8}else c=0;for(const [n,r]of m.iconVertexRanges)for(f=n;f<n+r;f+=4)l.iconOpacity[f/
4]=c;m.selectedForRendering?(c=g.parts[1],g=c.startOpacity,c=c.targetOpacity,a.allSymbolsFadingOut=a.allSymbolsFadingOut&&0===c,g=k?Math.floor(127*g)|c<<7:c?255:0,c=g<<24|g<<16|g<<8|g):c=0;for(const [n,r]of m.textVertexRanges)for(g=n;g<n+r;g+=4)l.textOpacity[g/4]=c}l.lastOpacityUpdate=q;l.opacityChanged=!0}}}};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})});