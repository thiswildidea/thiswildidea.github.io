// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.28/esri/copyright.txt for details.
//>>built
require({cache:{"esri/core/support/UpdatingHandles":function(){define("exports ../../chunks/tslib.es6 ../Accessor ../handleUtils ../reactiveUtils ../scheduling ../accessorSupport/decorators/property ../accessorSupport/decorators/subclass".split(" "),function(a,c,w,v,I,n,g,z){a.UpdatingHandles=class extends w{constructor(){super(...arguments);this.updating=!1;this._scheduleHandleId=this._handleId=0;this._pendingPromises=new Set}destroy(){this.removeAll()}add(d,m,x={}){return this._installWatch(d,m,
x,I.watch)}addWhen(d,m,x={}){return this._installWatch(d,m,x,I.when)}addOnCollectionChange(d,m,{initial:x=!1,final:B=!1}={}){const E=++this._handleId;this.addHandles([I.on(d,"after-changes",this._createSyncUpdatingCallback(),I.sync),I.on(d,"change",m,{onListenerAdd:x?p=>m({added:p.toArray(),removed:[]}):void 0,onListenerRemove:B?p=>m({added:[],removed:p.toArray()}):void 0})],E);return v.makeHandle(()=>this.removeHandles(E))}addPromise(d){if(null==d)return d;const m=++this._handleId;this.addHandles(v.makeHandle(()=>
{this._pendingPromises.delete(d)&&(0!==this._pendingPromises.size||this.hasHandles(-42)||this._set("updating",!1))}),m);this._pendingPromises.add(d);this._set("updating",!0);const x=()=>this.removeHandles(m);d.then(x,x);return d}removeAll(){this._pendingPromises.clear();this.removeAllHandles();this._set("updating",!1)}_installWatch(d,m,x={},B){const E=++this._handleId;x.sync||this._installSyncUpdatingWatch(d,E);d=B(d,m,x);this.addHandles(d,E);return v.makeHandle(()=>this.removeHandles(E))}_installSyncUpdatingWatch(d,
m){const x=this._createSyncUpdatingCallback();d=I.watch(d,x,{sync:!0,equals:()=>!1});this.addHandles(d,m);return d}_createSyncUpdatingCallback(){return()=>{this.removeHandles(-42);++this._scheduleHandleId;const d=this._scheduleHandleId;this._get("updating")||this._set("updating",!0);this.addHandles(n.schedule(()=>{d===this._scheduleHandleId&&(this._set("updating",0<this._pendingPromises.size),this.removeHandles(-42))}),-42)}}};c.__decorate([g.property({readOnly:!0})],a.UpdatingHandles.prototype,"updating",
void 0);a.UpdatingHandles=c.__decorate([z.subclass("esri.core.support.UpdatingHandles")],a.UpdatingHandles);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/FeatureStore":function(){define("../../../core/arrayUtils ../../../core/Error ../../../core/Evented ../../../core/Logger ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../featureConversionUtils ./BoundsStore ./geometryUtils ./optimizedFeatureQueryEngineAdapter".split(" "),
function(a,c,w,v,I,n,g,z,d,m){const x=I.create();class B{constructor(E){this.geometryInfo=E;this._boundsStore=new z.BoundsStore;this._featuresById=new Map;this._markedIds=new Set;this.events=new w;this.featureAdapter=m.optimizedFeatureQueryEngineAdapter}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){return this._boundsStore.fullBounds}get storeStatistics(){let E=
0;this._featuresById.forEach(p=>{null!=p.geometry&&p.geometry.coords&&(E+=p.geometry.coords.length)});return{featureCount:this._featuresById.size,vertexCount:E/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}getFullExtent(E){if(null==this.fullBounds)return null;const [p,f,b,q]=this.fullBounds;return{xmin:p,ymin:f,xmax:b,ymax:q,spatialReference:d.cleanFromGeometryEngine(E)}}add(E){this._add(E);this._emitChanged()}addMany(E){for(const p of E)this._add(p);this._emitChanged()}upsertMany(E){E=E.map(p=>this._upsert(p));
this._emitChanged();return E.filter(a.isSome)}clear(){this._featuresById.clear();this._boundsStore.clear();this._emitChanged()}removeById(E){E=this._featuresById.get(E);if(!E)return null;this._remove(E);this._emitChanged();return E}removeManyById(E){this._boundsStore.invalidateIndex();for(const p of E)(E=this._featuresById.get(p))&&this._remove(E);this._emitChanged()}forEachBounds(E,p){for(const f of E)(E=this._boundsStore.get(f.objectId))&&p(I.fromRect(x,E))}getFeature(E){return this._featuresById.get(E)}has(E){return this._featuresById.has(E)}forEach(E){this._featuresById.forEach(p=>
E(p))}forEachInBounds(E,p){this._boundsStore.forEachInBounds(E,f=>{p(this._featuresById.get(f))})}startMarkingUsedFeatures(){this._boundsStore.invalidateIndex();this._markedIds.clear()}sweep(){let E=!1;this._featuresById.forEach((p,f)=>{this._markedIds.has(f)||(E=!0,this._remove(p))});this._markedIds.clear();E&&this._emitChanged()}_emitChanged(){this.events.emit("changed",void 0)}_add(E){if(E){var p=E.objectId;if(null==p)v.getLogger("esri.layers.graphics.data.FeatureStore").error(new c("featurestore:invalid-feature",
"feature id is missing",{feature:E}));else{var f=this._featuresById.get(p);this._markedIds.add(p);if(f){E.displayId=f.displayId;var b=this._boundsStore.get(p);this._boundsStore.delete(p)}else if(null!=this.onFeatureAdd)this.onFeatureAdd(E);E.geometry?.coords?.length?(b=g.getBoundsOptimizedGeometry(null!=b?b:n.create(),E.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),null!=b&&this._boundsStore.set(p,b)):this._boundsStore.set(p,null);this._featuresById.set(p,E)}}}_upsert(E){const p=E?.objectId;
if(null==p)return v.getLogger("esri.layers.graphics.data.FeatureStore").error(new c("featurestore:invalid-feature","feature id is missing",{feature:E})),null;const f=this._featuresById.get(p);if(!f)return this._add(E),E;this._markedIds.add(p);const {geometry:b,attributes:q}=E;for(const A in q)f.attributes[A]=q[A];b&&(f.geometry=b,this._boundsStore.set(p,g.getBoundsOptimizedGeometry(n.create(),b,this.geometryInfo.hasZ,this.geometryInfo.hasM)??null));return f}_remove(E){if(null!=this.onFeatureRemove)this.onFeatureRemove(E);
const p=E.objectId;this._markedIds.delete(p);this._boundsStore.delete(p);this._featuresById.delete(p);return E}}return B})},"esri/geometry/support/aaBoundingBox":function(){define(["exports","../Extent","./aaBoundingRect"],function(a,c,w){function v(f=E){return[f[0],f[1],f[2],f[3],f[4],f[5]]}function I(f,b,q,A,F,L,h=v()){h[0]=f;h[1]=b;h[2]=q;h[3]=A;h[4]=F;h[5]=L;return h}function n(f){return f[0]>=f[3]?0:f[3]-f[0]}function g(f){return f[1]>=f[4]?0:f[4]-f[1]}function z(f){return f[2]>=f[5]?0:f[5]-
f[2]}function d(f,b){return Math.max(b[0],f[0])<=Math.min(b[3],f[3])&&Math.max(b[1],f[1])<=Math.min(b[4],f[4])&&Math.max(b[2],f[2])<=Math.min(b[5],f[5])}function m(f,b){f[0]=b[0];f[1]=b[1];f[2]=b[2];f[3]=b[3];f[4]=b[4];f[5]=b[5];return f}function x(f){return 6===f.length}const B=[Infinity,Infinity,Infinity,-Infinity,-Infinity,-Infinity],E=[0,0,0,0,0,0],p=v();a.allFinite=function(f){for(let b=0;6>b;b++)if(!isFinite(f[b]))return!1;return!0};a.center=function(f,b=[0,0,0]){b[0]=f[0]+n(f)/2;b[1]=f[1]+
g(f)/2;b[2]=f[2]+z(f)/2;return b};a.contains=function(f,b){return b[0]>=f[0]&&b[1]>=f[1]&&b[2]>=f[2]&&b[3]<=f[3]&&b[4]<=f[4]&&b[5]<=f[5]};a.containsPoint=function(f,b){return b[0]>=f[0]&&b[1]>=f[1]&&b[2]>=f[2]&&b[0]<=f[3]&&b[1]<=f[4]&&b[2]<=f[5]};a.containsPointWithMargin=function(f,b,q){return b[0]>=f[0]-q&&b[1]>=f[1]-q&&b[2]>=f[2]-q&&b[0]<=f[3]+q&&b[1]<=f[4]+q&&b[2]<=f[5]+q};a.create=v;a.depth=g;a.diameter=function(f){const b=n(f),q=z(f);f=g(f);return Math.sqrt(b*b+q*q+f*f)};a.empty=function(f){return f?
m(f,B):v(B)};a.equals=function(f,b,q){if(null==f||null==b)return f===b;if(!x(f)||!x(b))return!1;if(q)for(let A=0;A<f.length;A++){if(!q(f[A],b[A]))return!1}else for(q=0;q<f.length;q++)if(f[q]!==b[q])return!1;return!0};a.expandWithAABB=function(f,b){f[0]=Math.min(f[0],b[0]);f[1]=Math.min(f[1],b[1]);f[2]=Math.min(f[2],b[2]);f[3]=Math.max(f[3],b[3]);f[4]=Math.max(f[4],b[4]);f[5]=Math.max(f[5],b[5])};a.expandWithBuffer=function(f,b,q=0,A=b.length/3){let F=f[0],L=f[1],h=f[2],H=f[3],S=f[4],C=f[5];for(let k=
0;k<A;k++)F=Math.min(F,b[q+3*k]),L=Math.min(L,b[q+3*k+1]),h=Math.min(h,b[q+3*k+2]),H=Math.max(H,b[q+3*k]),S=Math.max(S,b[q+3*k+1]),C=Math.max(C,b[q+3*k+2]);f[0]=F;f[1]=L;f[2]=h;f[3]=H;f[4]=S;f[5]=C};a.expandWithNestedArray=function(f,b,q){const A=b.length;let F=f[0],L=f[1],h=f[2],H=f[3],S=f[4],C=f[5];if(q)for(q=0;q<A;q++){var k=b[q];F=Math.min(F,k[0]);L=Math.min(L,k[1]);h=Math.min(h,k[2]);H=Math.max(H,k[0]);S=Math.max(S,k[1]);C=Math.max(C,k[2])}else for(q=0;q<A;q++)k=b[q],F=Math.min(F,k[0]),L=Math.min(L,
k[1]),H=Math.max(H,k[0]),S=Math.max(S,k[1]);f[0]=F;f[1]=L;f[2]=h;f[3]=H;f[4]=S;f[5]=C};a.expandWithOffset=function(f,b,q,A){f[0]=Math.min(f[0],f[0]+b);f[3]=Math.max(f[3],f[3]+b);f[1]=Math.min(f[1],f[1]+q);f[4]=Math.max(f[4],f[4]+q);f[2]=Math.min(f[2],f[2]+A);f[5]=Math.max(f[5],f[5]+A)};a.expandWithRect=function(f,b){f[0]=Math.min(f[0],b[0]);f[1]=Math.min(f[1],b[1]);f[3]=Math.max(f[3],b[2]);f[4]=Math.max(f[4],b[3])};a.expandWithVec3=function(f,b){f[0]=Math.min(f[0],b[0]);f[1]=Math.min(f[1],b[1]);f[2]=
Math.min(f[2],b[2]);f[3]=Math.max(f[3],b[0]);f[4]=Math.max(f[4],b[1]);f[5]=Math.max(f[5],b[2])};a.fromExtent=function(f,b=v()){b[0]=f.xmin;b[1]=f.ymin;b[2]=f.hasZ?f.zmin:-Infinity;b[3]=f.xmax;b[4]=f.ymax;b[5]=f.hasZ?f.zmax:Infinity;return b};a.fromMinMax=function(f,b,q=v()){q[0]=f[0];q[1]=f[1];q[2]=f[2];q[3]=b[0];q[4]=b[1];q[5]=b[2];return q};a.fromRect=function(f,b){f[0]=b[0];f[1]=b[1];f[2]=Number.NEGATIVE_INFINITY;f[3]=b[2];f[4]=b[3];f[5]=Number.POSITIVE_INFINITY;return f};a.fromRectValues=function(f,
b,q,A,F){f[0]=b;f[1]=q;f[2]=Number.NEGATIVE_INFINITY;f[3]=A;f[4]=F;f[5]=Number.POSITIVE_INFINITY;return f};a.fromValues=I;a.getMax=function(f,b){b[0]=f[3];b[1]=f[4];b[2]=f[5];return b};a.getMin=function(f,b){b[0]=f[0];b[1]=f[1];b[2]=f[2];return b};a.height=z;a.intersects=d;a.intersectsClippingArea=function(f,b){return null==b?!0:d(f,b)};a.is=x;a.isPoint=function(f){return 0===n(f)&&0===g(f)&&0===z(f)};a.maximumDimension=function(f){return Math.max(n(f),z(f),g(f))};a.negativeInfinity=B;a.offset=function(f,
b,q,A,F=f){F[0]=f[0]+b;F[1]=f[1]+q;F[2]=f[2]+A;F[3]=f[3]+b;F[4]=f[4]+q;F[5]=f[5]+A;return F};a.positiveInfinity=[-Infinity,-Infinity,-Infinity,Infinity,Infinity,Infinity];a.scale=function(f,b,q=f){const A=f[0]+n(f)/2,F=f[1]+g(f)/2,L=f[2]+z(f)/2;q[0]=A+(f[0]-A)*b;q[1]=F+(f[1]-F)*b;q[2]=L+(f[2]-L)*b;q[3]=A+(f[3]-A)*b;q[4]=F+(f[4]-F)*b;q[5]=L+(f[5]-L)*b;return q};a.set=m;a.setMax=function(f,b,q=f){q[3]=b[0];q[4]=b[1];q[5]=b[2];q!==f&&(q[0]=f[0],q[1]=f[1],q[2]=f[2]);return f};a.setMin=function(f,b,q=
f){q[0]=b[0];q[1]=b[1];q[2]=b[2];q!==f&&(q[3]=f[3],q[4]=f[4],q[5]=f[5]);return q};a.size=function(f,b=[0,0,0]){b[0]=n(f);b[1]=g(f);b[2]=z(f);return b};a.toExtent=function(f,b){return isFinite(f[2])||isFinite(f[5])?new c({xmin:f[0],xmax:f[3],ymin:f[1],ymax:f[4],zmin:f[2],zmax:f[5],spatialReference:b}):new c({xmin:f[0],xmax:f[3],ymin:f[1],ymax:f[4],spatialReference:b})};a.toRect=function(f,b){b||(b=w.create());b[0]=f[0];b[1]=f[1];b[2]=f[3];b[3]=f[4];return b};a.width=n;a.wrap=function(f,b,q,A,F,L){return I(f,
b,q,A,F,L,p)};a.zero=E;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/featureConversionUtils":function(){define("exports ../../core/Error ../../core/Logger ../../core/maybe ../../geometry/support/aaBoundingBox ../../geometry/support/aaBoundingRect ../../geometry/support/jsonUtils ./OptimizedFeature ./OptimizedFeatureSet ./OptimizedGeometry".split(" "),function(a,c,w,v,I,n,g,z,d,m){function x(G,M){return G?M?4:3:M?3:2}function B(G,M,P,W){if(G){if(P)return M&&
W?K:Va;if(M&&W)return r}else if(M&&W)return Va;return Sa}function E({scale:G,translate:M},P){return Math.round((P-M[0])/G[0])}function p({scale:G,translate:M},P){return Math.round((M[1]-P)/G[1])}function f({scale:G,translate:M},P,W){return P*G[W]+M[W]}function b(G){G=G.coords;return{x:G[0],y:G[1]}}function q(G,M){G.coords[0]=M.x;G.coords[1]=M.y;return G}function A(G){G=G.coords;return{x:G[0],y:G[1],z:G[2]}}function F(G,M){G.coords[0]=M.x;G.coords[1]=M.y;G.coords[2]=M.z;return G}function L(G){G=G.coords;
return{x:G[0],y:G[1],m:G[2]}}function h(G,M){G.coords[0]=M.x;G.coords[1]=M.y;G.coords[2]=M.m;return G}function H(G){G=G.coords;return{x:G[0],y:G[1],z:G[2],m:G[3]}}function S(G,M){G.coords[0]=M.x;G.coords[1]=M.y;G.coords[2]=M.z;G.coords[3]=M.m;return G}function C(G,M){return G&&M?S:G?F:M?h:q}function k(G,M,P,W,Y){P=C(P,W);for(const {geometry:ba,attributes:da}of M)M=null!=ba?P(new m,ba):null,G.push(new z.OptimizedFeature(M,da,null,Y?da[Y]:void 0));return G}function y(G,M,P,W){for(const {geometry:Y,
attributes:ba}of M)G.push({attributes:ba,geometry:null!=Y?N(Y,P,W):null});return G}function N(G,M,P){if(null==G)return null;const W=x(M,P),Y=[];for(let ba=0;ba<G.coords.length;ba+=W){const da=[];for(let ia=0;ia<W;ia++)da.push(G.coords[ba+ia]);Y.push(da)}return M?P?{points:Y,hasZ:M,hasM:P}:{points:Y,hasZ:M}:P?{points:Y,hasM:P}:{points:Y}}function l(G,M,P,W,Y){P=x(P,W);for(const {geometry:ba,attributes:da}of M)M=null!=ba?O(new m,ba,P):null,G.push(new z.OptimizedFeature(M,da,null,Y?da[Y]:void 0));return G}
function O(G,M,P=x(M.hasZ,M.hasM)){G.lengths[0]=M.points.length;const W=G.coords;let Y=0;for(const ba of M.points)for(M=0;M<P;M++)W[Y++]=ba[M];return G}function u(G,M,P){if(!G)return null;const W=x(M,P),{coords:Y,lengths:ba}=G;G=[];let da=0;for(const ia of ba){const ka=[];for(let ra=0;ra<ia;ra++){const oa=[];for(let qa=0;qa<W;qa++)oa.push(Y[da++]);ka.push(oa)}G.push(ka)}return M?P?{paths:G,hasZ:M,hasM:P}:{paths:G,hasZ:M}:P?{paths:G,hasM:P}:{paths:G}}function D(G,M,P,W,Y){P=x(P,W);for(const {geometry:ba,
attributes:da}of M)M=null!=ba?R(new m,ba,P):null,G.push(new z.OptimizedFeature(M,da,null,Y?da[Y]:void 0));return G}function R(G,M,P=x(M.hasZ,M.hasM)){const {lengths:W,coords:Y}=G;let ba=0;for(const da of M.paths){for(const ia of da)for(M=0;M<P;M++)Y[ba++]=ia[M];W.push(da.length)}return G}function Q(G,M,P){if(!G)return null;const W=x(M,P),{coords:Y,lengths:ba}=G;G=[];let da=0;for(const ia of ba){const ka=[];for(let ra=0;ra<ia;ra++){const oa=[];for(let qa=0;qa<W;qa++)oa.push(Y[da++]);ka.push(oa)}G.push(ka)}return M?
P?{rings:G,hasZ:M,hasM:P}:{rings:G,hasZ:M}:P?{rings:G,hasM:P}:{rings:G}}function U(G,M,P,W,Y){for(const {geometry:ba,centroid:da,attributes:ia}of M){M=null!=ba?Z(new m,ba,P,W):null;const ka=Y?ia[Y]:void 0;null!=da?G.push(new z.OptimizedFeature(M,ia,q(new m,da),ka)):G.push(new z.OptimizedFeature(M,ia,null,ka))}return G}function Z(G,M,P=M.hasZ,W=M.hasM){return ea(G,M.rings,P,W)}function ea(G,M,P,W){P=x(P,W);const {lengths:Y,coords:ba}=G;W=0;Da(G);for(const da of M){for(const ia of da)for(M=0;M<P;M++)ba[W++]=
ia[M];Y.push(da.length)}return G}function la(G,M,P,W,Y,ba){Ia(G);if(!P){for(const da of M)G.push(new z.OptimizedFeature(null,da.attributes,null,ba?da.attributes[ba]:void 0));return G}switch(P){case "esriGeometryPoint":return k(G,M,W,Y,ba);case "esriGeometryMultipoint":return l(G,M,W,Y,ba);case "esriGeometryPolyline":return D(G,M,W,Y,ba);case "esriGeometryPolygon":return U(G,M,W,Y,ba);default:Pa.error("convertToFeatureSet:unknown-geometry",new c(`Unable to parse unknown geometry type '${P}'`)),Ia(G)}return G}
function na(G,M,P,W){G=G&&("coords"in G?G:G.geometry);if(null==G)return null;switch(M){case "esriGeometryPoint":return M=b,P&&W?M=H:P?M=A:W&&(M=L),M(G);case "esriGeometryMultipoint":return N(G,P,W);case "esriGeometryPolyline":return u(G,P,W);case "esriGeometryPolygon":return Q(G,P,W);default:return Pa.error("convertToGeometry:unknown-geometry",new c(`Unable to parse unknown geometry type '${M}'`)),null}}function ta(G,M,P,W,Y){Ia(G);if(null==P){for(const da of M)G.push({attributes:da.attributes});
return G}switch(P){case "esriGeometryPoint":P=b;W&&Y?P=H:W?P=A:Y&&(P=L);for(var ba of M){const {geometry:da,attributes:ia}=ba;W=null!=da?P(da):null;G.push({attributes:ia,geometry:W})}break;case "esriGeometryMultipoint":return y(G,M,W,Y);case "esriGeometryPolyline":for(const {geometry:da,attributes:ia}of M)G.push({attributes:ia,geometry:null!=da?u(da,W,Y):null});break;case "esriGeometryPolygon":for(const {geometry:da,attributes:ia,centroid:ka}of M)ba=null!=da?Q(da,W,Y):null,null!=ka?(M=b(ka),G.push({attributes:ia,
centroid:M,geometry:ba})):G.push({attributes:ia,geometry:ba});break;default:Pa.error("convertToFeatureSet:unknown-geometry",new c(`Unable to parse unknown geometry type '${P}'`))}return G}function ua(G,M,P,W,Y,ba,da=P,ia=W){Da(G);if(!M?.coords.length)return null;Y=Na[Y];const {coords:ka,lengths:ra}=M;M=x(P,W);const oa=x(P&&da,W&&ia);P=B(P,W,da,ia);if(!ra.length)return P(G.coords,ka,0,0,E(ba,ka[0]),p(ba,ka[1])),Da(G,M,0),G;let qa,Ca=0,wa,Ba=0;for(const Aa of ra){if(Aa<Y)continue;let ya=0;wa=Ba;ia=
W=E(ba,ka[Ca]);qa=da=p(ba,ka[Ca+1]);P(G.coords,ka,wa,Ca,ia,qa);ya++;Ca+=M;wa+=oa;for(let Ha=1;Ha<Aa;Ha++,Ca+=M)if(ia=E(ba,ka[Ca]),qa=p(ba,ka[Ca+1]),ia!==W||qa!==da)P(G.coords,ka,wa,Ca,ia-W,qa-da),wa+=oa,ya++,W=ia,da=qa;ya>=Y&&(G.lengths.push(ya),Ba=wa)}Ia(G.coords,Ba);return G.coords.length?G:null}function sa(G,M,P,W,Y,ba,da){let ia=W,ka=0;for(let oa=ba+P;oa<da;oa+=P){var ra=M[oa];const qa=M[oa+1],Ca=M[da],wa=M[da+1];let Ba=M[ba],Aa=M[ba+1],ya=Ca-Ba,Ha=wa-Aa;if(0!==ya||0!==Ha){const Qa=((ra-Ba)*ya+
(qa-Aa)*Ha)/(ya*ya+Ha*Ha);1<Qa?(Ba=Ca,Aa=wa):0<Qa&&(Ba+=ya*Qa,Aa+=Ha*Qa)}ya=ra-Ba;Ha=qa-Aa;ra=ya*ya+Ha*Ha;ra>ia&&(ka=oa,ia=ra)}ia>W&&(ka-ba>P&&sa(G,M,P,W,Y,ba,ka),Y(G,M,G.length,ka,M[ka],M[ka+1]),da-ka>P&&sa(G,M,P,W,Y,ka,da))}function va(G,M,P,W,Y){const {coords:ba,lengths:da}=M;P=x(P,W);if(!ba.length)return G!==M&&Da(G),G;v.assertIsSome(Y);const {originPosition:ia,scale:ka,translate:ra}=Y;Y=ha;Y.originPosition=ia;W=Y.scale;W[0]=ka[0]??1;W[1]=-(ka[1]??1);W[2]=ka[2]??1;W[3]=ka[3]??1;var oa=Y.translate;
oa[0]=ra[0]??0;oa[1]=ra[1]??0;oa[2]=ra[2]??0;oa[3]=ra[3]??0;if(!da.length){for(W=0;W<P;++W)G.coords[W]=f(Y,ba[W],W);G!==M&&Da(G,P,0);return G}oa=0;for(let Ca=0;Ca<da.length;Ca++){const wa=da[Ca];G.lengths[Ca]=wa;for(var qa=0;qa<P;++qa)G.coords[oa+qa]=f(Y,ba[oa+qa],qa);qa=G.coords[oa];let Ba=G.coords[oa+1];oa+=P;for(let Aa=1;Aa<wa;Aa++,oa+=P){qa+=ba[oa]*W[0];Ba+=ba[oa+1]*W[1];G.coords[oa]=qa;G.coords[oa+1]=Ba;for(let ya=2;ya<P;++ya)G.coords[oa+ya]=f(Y,ba[oa+ya],ya)}}G!==M&&Da(G,ba.length,da.length);
return G}function xa(G,M,P,W){let Y=0,ba=G[W*M],da=G[W*(M+1)];for(let ia=1;ia<P;ia++){const ka=ba+G[W*(M+ia)],ra=da+G[W*(M+ia)+1],oa=(ka-ba)*(ra+da);ba=ka;da=ra;Y+=oa}return.5*Y}function Da(G,M=0,P=0){Ia(G.lengths,P);Ia(G.coords,M)}function Ia(G,M=0){G.length!==M&&(G.length=M)}const Pa=w.getLogger("esri.layers.graphics.featureConversionUtils"),Na={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0,esriGeometryEnvelope:0},Sa=(G,M,P,W,Y,ba)=>{G[P]=Y;G[P+1]=ba},
Va=(G,M,P,W,Y,ba)=>{G[P]=Y;G[P+1]=ba;G[P+2]=M[W+2]},r=(G,M,P,W,Y,ba)=>{G[P]=Y;G[P+1]=ba;G[P+2]=M[W+3]},K=(G,M,P,W,Y,ba)=>{G[P]=Y;G[P+1]=ba;G[P+2]=M[W+2];G[P+3]=M[W+3]},X=[],aa=[],ha={originPosition:"lowerLeft",scale:[1,1,1,1],translate:[0,0,0,0]};a.convertFromFeature=function(G,M,P,W,Y){X[0]=G;[G]=la(aa,X,M,P,W,Y);Ia(X);Ia(aa);return G};a.convertFromFeatureSet=function(G,M){const P=new d,{hasM:W,hasZ:Y,features:ba,objectIdFieldName:da,spatialReference:ia,geometryType:ka,exceededTransferLimit:ra,transform:oa,
fields:qa}=G;qa&&(P.fields=qa);P.geometryType=ka??null;P.objectIdFieldName=da??M??null;P.spatialReference=ia??null;if(!P.objectIdFieldName)return Pa.error(new c("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),P;ba&&la(P.features,ba,ka,Y,W,P.objectIdFieldName);ra&&(P.exceededTransferLimit=ra);W&&(P.hasM=W);Y&&(P.hasZ=Y);oa&&(P.transform=oa);return P};a.convertFromFeatures=la;a.convertFromGeometry=function(G,M,P){if(null==G)return null;const W=new m;"hasZ"in G&&null==
M&&(M=G.hasZ);"hasM"in G&&null==P&&(P=G.hasM);if(g.isPoint(G))return C(null!=M?M:null!=G.z,null!=P?P:null!=G.m)(W,G);if(g.isPolygon(G))return Z(W,G,M,P);if(g.isPolyline(G))return R(W,G,x(M,P));if(g.isMultipoint(G))return O(W,G,x(M,P));Pa.error("convertFromGeometry:unknown-geometry",new c(`Unable to parse unknown geometry type '${G}'`))};a.convertFromGraphics=function(G,M,P,W,Y,ba){const da=G.length;switch(P){case "esriGeometryPoint":k(G,M,W,Y,ba);break;case "esriGeometryMultipoint":l(G,M,W,Y,ba);
break;case "esriGeometryPolyline":D(G,M,W,Y,ba);break;case "esriGeometryPolygon":U(G,M,W,Y,ba);break;default:Pa.error("convertToFeatureSet:unknown-geometry",new c(`Unable to parse unknown geometry type '${P}'`))}for(W=0;W<M.length;W++)G[W+da].geometryType=P,G[W+da].insertAfter=M[W].insertAfter,G[W+da].groupId=M[W].groupId;return G};a.convertFromMultipoint=O;a.convertFromMultipointFeatures=l;a.convertFromNestedArray=ea;a.convertFromPoint=function(G,M,P=C(null!=M.z,null!=M.m)){return P(G,M)};a.convertFromPointFeatures=
k;a.convertFromPolygon=Z;a.convertFromPolyline=R;a.convertFromPolylineFeatures=D;a.convertToFeature=function(G,M,P,W){aa[0]=G;ta(X,aa,M,P,W);G=X[0];Ia(X);Ia(aa);return G};a.convertToFeatureSet=function(G){const {objectIdFieldName:M,spatialReference:P,transform:W,fields:Y,hasM:ba,hasZ:da,features:ia,geometryType:ka,exceededTransferLimit:ra,uniqueIdField:oa,queryGeometry:qa,queryGeometryType:Ca}=G;G=ta([],ia,ka,da,ba);const wa=na(qa,Ca,!1,!1);G={features:G,fields:Y,geometryType:ka,objectIdFieldName:M,
spatialReference:P,uniqueIdField:oa,queryGeometry:wa};W&&(G.transform=W);ra&&(G.exceededTransferLimit=ra);ba&&(G.hasM=ba);da&&(G.hasZ=da);return G};a.convertToFeatures=ta;a.convertToGeometry=na;a.convertToMultipoint=N;a.convertToMultipointFeatures=y;a.convertToPoint=function(G,M,P){return G?M?P?H(G):A(G):P?L(G):b(G):null};a.convertToPolygon=Q;a.convertToPolyline=u;a.deltaDecodeGeometry=function(G,M){if(null==G)return null;const P=G.clone(),W=G.coords;G=G.lengths;let Y=0;for(let ia=0;ia<G.length;ia++){const ka=
G[ia];var ba=W[M*Y],da=W[M*Y+1];for(let ra=1;ra<ka;ra++)ba+=W[M*(Y+ra)],da+=W[M*(Y+ra)+1],P.coords[M*(Y+ra)]=ba,P.coords[M*(Y+ra)+1]=da;Y+=ka}return P};a.deltaEncodeGeometry=function(G,M){const P=G.clone(),W=G.coords;G=G.lengths;let Y=0;for(let da=0;da<G.length;da++){const ia=G[da];let ka=W[M*Y];var ba=W[M*Y+1];for(let ra=1;ra<ia;ra++){const oa=W[M*(Y+ra)],qa=W[M*(Y+ra)+1];ba=qa-ba;P.coords[M*(Y+ra)]=oa-ka;P.coords[M*(Y+ra)+1]=ba;ka=oa;ba=qa}Y+=ia}return P};a.generalizeOptimizedGeometry=function(G,
M,P,W,Y,ba,da=P,ia=W){Da(G);if(!M?.coords.length)return null;Y=Na[Y];const {coords:ka,lengths:ra}=M;M=x(P,W);const oa=x(P&&da,W&&ia);P=B(P,W,da,ia);if(!ra.length)return P(G.coords,ka,0,0,ka[0],ka[1]),Da(G,M,0),G;W=0;ba*=ba;for(const qa of ra){if(qa<Y){W+=qa*M;continue}da=G.coords.length/oa;ia=W;const Ca=W+(qa-1)*M;P(G.coords,ka,G.coords.length,ia,ka[ia],ka[ia+1]);sa(G.coords,ka,M,ba,P,ia,Ca);P(G.coords,ka,G.coords.length,Ca,ka[Ca],ka[Ca+1]);ia=G.coords.length/oa-da;ia>=Y?G.lengths.push(ia):Ia(G.coords,
da*oa);W+=qa*M}return G.coords.length?G:null};a.getBoundsOptimizedGeometry=function(G,M,P,W){if(!M?.coords?.length)return null;P=x(P,W);let Y=W=Number.POSITIVE_INFINITY,ba=Number.NEGATIVE_INFINITY,da=Number.NEGATIVE_INFINITY;if(M&&M.coords){M=M.coords;for(let ia=0;ia<M.length;ia+=P){const ka=M[ia],ra=M[ia+1];W=Math.min(W,ka);ba=Math.max(ba,ka);Y=Math.min(Y,ra);da=Math.max(da,ra)}}I.is(G)?I.fromRectValues(G,W,Y,ba,da):n.fromValues(W,Y,ba,da,G);return G};a.getQuantizedArea=function(G,M){const {coords:P,
lengths:W}=G;let Y=G=0;for(let ba=0;ba<W.length;ba++){const da=W[ba];Y+=xa(P,G,da,M);G+=da}return Math.abs(Y)};a.getQuantizedBoundsOptimizedGeometry=function(G,M,P,W){P=x(P,W);const {lengths:Y,coords:ba}=M;W=M=Number.POSITIVE_INFINITY;let da=Number.NEGATIVE_INFINITY,ia=Number.NEGATIVE_INFINITY,ka=0;for(const ra of Y){let oa=ba[ka],qa=ba[ka+1];M=Math.min(oa,M);W=Math.min(qa,W);da=Math.max(oa,da);ia=Math.max(qa,ia);ka+=P;for(let Ca=1;Ca<ra;Ca++,ka+=P){const wa=ba[ka],Ba=ba[ka+1];oa+=wa;qa+=Ba;0>wa&&
(M=Math.min(M,oa));0<wa&&(da=Math.max(da,oa));0>Ba?W=Math.min(W,qa):0<Ba&&(ia=Math.max(ia,qa))}}G[0]=M;G[1]=W;G[2]=da;G[3]=ia;return G};a.getSignedQuantizedRingArea=xa;a.quantizeOptimizedFeatureSet=function(G,M){const {geometryType:P,features:W,hasM:Y,hasZ:ba}=M;if(!G)return M;for(let da=0;da<W.length;da++){const ia=W[da],ka=ia.weakClone();ka.geometry=new m;ua(ka.geometry,ia.geometry,Y,ba,P,G);ia.centroid&&(ka.centroid=new m,ua(ka.centroid,ia.centroid,Y,ba,"esriGeometryPoint",G));W[da]=ka}M.transform=
G;return M};a.quantizeOptimizedGeometry=ua;a.quantizeX=E;a.quantizeY=p;a.removeCollinearVectices=function(G,M,P,W,Y){if(!M?.coords?.length)return null;P=Na[P];const {coords:ba,lengths:da}=M;M=B(W,Y,W,Y);W=x(W,Y);let ia=Y=0,ka=0,ra=0;for(const Ca of da){ia=ra;M(G.coords,ba,ia,Y,ba[Y],ba[Y+1]);Y+=W;var oa=ba[Y];let wa=ba[Y+1],Ba=oa,Aa=wa;var qa=wa/oa;ia+=W;M(G.coords,ba,ia,Y,Ba,Aa);Y+=W;for(let ya=2;ya<Ca;ya++){oa=ba[Y];wa=ba[Y+1];const Ha=wa/oa,Qa=qa===Ha||!isFinite(qa)&&!isFinite(Ha);qa=Qa&&isFinite(Ha)?
0<=qa&&0<=Ha||0>=qa&&0>=Ha:0<=Aa&&0<=wa||0>=Aa&&0>=wa;Qa&&qa?(Ba+=oa,Aa+=wa):(Ba=oa,Aa=wa,ia+=W);M(G.coords,ba,ia,Y,Ba,Aa);Y+=W;qa=Ha}ia+=W;oa=(ia-ra)/W;oa>=P&&(G.lengths[ka]=oa,ra=ia,ka++)}G.coords.length>ra&&(G.coords.length=ra);G.lengths.length>ka&&(G.lengths.length=ka);return G.coords.length&&G.lengths.length?G:null};a.removeZMValues=function(G,M,P,W,Y,ba){Da(G);G.lengths.push(...M.lengths);if(P===Y&&W===ba)for(var da=0;da<M.coords.length;da++)G.coords.push(M.coords[da]);else for(da=x(P,W),P=
B(P,W,Y,ba),M=M.coords,W=0;W<M.length;W+=da)P(G.coords,M,G.coords.length,W,M[W],M[W+1]);return G};a.unquantizeOptimizedFeatureSet=function(G){const {transform:M,features:P,hasM:W,hasZ:Y}=G;if(!M)return G;for(const ba of P)null!=ba.geometry&&va(ba.geometry,ba.geometry,W,Y,M),null!=ba.centroid&&va(ba.centroid,ba.centroid,W,Y,M);G.transform=null;return G};a.unquantizeOptimizedGeometry=va;a.unquantizeValue=f;a.unquantizeX=function(G,M){return f(G,M,0)};a.unquantizeY=function(G,M){return f(G,-M,1)};Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/OptimizedFeature":function(){define(["exports"],function(a){class c{constructor(v=null,I={},n,g){this.geometry=v;this.attributes=I;this.centroid=n;this.objectId=g;this.geohashY=this.geohashX=this.displayId=0}weakClone(){const v=new c(this.geometry,this.attributes,this.centroid,this.objectId);v.displayId=this.displayId;v.geohashX=this.geohashX;v.geohashY=this.geohashY;return v}}class w extends c{}a.OptimizedFeature=c;a.OptimizedFeatureWithGeometry=
w;a.hasGeometry=function(v){return!!v.geometry?.coords?.length};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/OptimizedFeatureSet":function(){define(function(){class a{constructor(){this.spatialReference=this.geometryType=this.geometryProperties=this.geohashFieldName=this.globalIdFieldName=this.objectIdFieldName=null;this.hasM=this.hasZ=!1;this.features=[];this.fields=[];this.transform=null;this.exceededTransferLimit=!1;this.queryGeometry=this.queryGeometryType=
this.uniqueIdField=null}weakClone(){const c=new a;c.objectIdFieldName=this.objectIdFieldName;c.globalIdFieldName=this.globalIdFieldName;c.geohashFieldName=this.geohashFieldName;c.geometryProperties=this.geometryProperties;c.geometryType=this.geometryType;c.spatialReference=this.spatialReference;c.hasZ=this.hasZ;c.hasM=this.hasM;c.features=this.features;c.fields=this.fields;c.transform=this.transform;c.exceededTransferLimit=this.exceededTransferLimit;c.uniqueIdField=this.uniqueIdField;c.queryGeometry=
this.queryGeometry;c.queryGeometryType=this.queryGeometryType;return c}}return a})},"esri/layers/graphics/OptimizedGeometry":function(){define(function(){class a{constructor(c=[],w=[],v=!1){this.lengths=c??[];this.coords=w??[];this.hasIndeterminateRingOrder=v}static fromRect(c){const [w,v,I,n]=c;c=I-w;const g=n-v;return new a([5],[w,v,c,0,0,g,-c,0,0,-g])}get isPoint(){return 0===this.lengths.length}get maxLength(){return Math.max(...this.lengths)}get size(){return this.lengths.reduce((c,w)=>c+w)}forEachVertex(c){let w=
0;this.lengths.length||c(this.coords[0],this.coords[1]);for(let v=0;v<this.lengths.length;v++){const I=this.lengths[v];for(let n=0;n<I;n++)c(this.coords[2*(n+w)],this.coords[2*(n+w)+1]);w+=I}}clone(c){return c?(c.set(this.coords),new a(this.lengths.slice(),c,this.hasIndeterminateRingOrder)):new a(this.lengths.slice(),this.coords.slice(),this.hasIndeterminateRingOrder)}}return a})},"esri/layers/graphics/data/BoundsStore":function(){define(["exports","../../../core/has","../../../core/libs/rbush/PooledRBush",
"../../../geometry/support/aaBoundingRect"],function(a,c,w,v){function I(z,d,m){n.minX=d[0];n.minY=d[1];n.maxX=d[2];n.maxY=d[3];z.search(n,m)}const n={minX:0,minY:0,maxX:0,maxY:0};class g{constructor(){this._indexInvalid=!1;this._boundsToLoad=[];this._boundsById=new Map;this._idByBounds=new Map;this._index=new w.PooledRBush(9,c("esri-csp-restrictions")?z=>({minX:z[0],minY:z[1],maxX:z[2],maxY:z[3]}):["[0]","[1]","[2]","[3]"]);this._loadIndex=()=>{if(this._indexInvalid){const z=Array(this._idByBounds.size);
let d=0;this._idByBounds.forEach((m,x)=>{z[d++]=x});this._indexInvalid=!1;this._index.clear();this._index.load(z)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter(z=>this._idByBounds.has(z))))),this._boundsToLoad.length=0)}}get fullBounds(){if(!this._boundsById.size)return null;const z=v.empty();for(const d of this._boundsById.values())d&&(z[0]=Math.min(d[0],z[0]),z[1]=Math.min(d[1],z[1]),z[2]=Math.max(d[2],z[2]),z[3]=Math.max(d[3],z[3]));return z}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=
!1;this._boundsToLoad.length=0;this._boundsById.clear();this._idByBounds.clear();this._index.clear()}delete(z){const d=this._boundsById.get(z);this._boundsById.delete(z);d&&(this._idByBounds.delete(d),this._indexInvalid||this._index.remove(d))}forEachInBounds(z,d){this._loadIndex();I(this._index,z,m=>d(this._idByBounds.get(m)))}get(z){return this._boundsById.get(z)}has(z){return this._boundsById.has(z)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(z,
d){if(!this._indexInvalid){const m=this._boundsById.get(z);m&&(this._index.remove(m),this._idByBounds.delete(m))}this._boundsById.set(z,d);d&&(this._idByBounds.set(d,z),this._indexInvalid||(this._boundsToLoad.push(d),5E4<this._boundsToLoad.length&&this._loadIndex()))}}a.BoundsStore=g;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/rbush/PooledRBush":function(){define(["exports","../../arrayUtils","../../PooledArray","../../../chunks/quickselect"],function(a,c,w,v){function I(C,
k){n(C,0,C.children.length,k,C)}function n(C,k,y,N,l){l||(l=new H([]));l.minX=Infinity;l.minY=Infinity;l.maxX=-Infinity;l.maxY=-Infinity;for(let O=k,u;O<y;O++)u=C.children[O],g(l,C.leaf?N(u):u);return l}function g(C,k){C.minX=Math.min(C.minX,k.minX);C.minY=Math.min(C.minY,k.minY);C.maxX=Math.max(C.maxX,k.maxX);C.maxY=Math.max(C.maxY,k.maxY)}function z(C,k){return C.minX-k.minX}function d(C,k){return C.minY-k.minY}function m(C){return(C.maxX-C.minX)*(C.maxY-C.minY)}function x(C){return C.maxX-C.minX+
(C.maxY-C.minY)}function B(C,k){return C.minX<=k.minX&&C.minY<=k.minY&&k.maxX<=C.maxX&&k.maxY<=C.maxY}function E(C,k){return k.minX<=C.maxX&&k.minY<=C.maxY&&k.maxX>=C.minX&&k.maxY>=C.minY}function p(C,k,y,N,l){for(k=[k,y];k.length;){y=k.pop();const O=k.pop();if(y-O<=N)continue;const u=O+Math.ceil((y-O)/N/2)*N;v.quickselect(C,u,O,y,l);k.push(O,u,u,y)}}class f{constructor(C=9,k){this._compareMinX=z;this._compareMinY=d;this._toBBox=y=>y;this._maxEntries=Math.max(4,C||9);this._minEntries=Math.max(2,Math.ceil(.4*
this._maxEntries));k&&("function"===typeof k?this._toBBox=k:this._initFormat(k));this.clear()}destroy(){this.clear();b.prune();q.prune();A.prune();F.prune()}all(C){this._all(this._data,C)}search(C,k){let y=this._data;const N=this._toBBox;if(E(C,y))for(b.clear();y;){for(let l=0,O=y.children.length;l<O;l++){const u=y.children[l],D=y.leaf?N(u):u;E(C,D)&&(y.leaf?k(u):B(C,D)?this._all(u,k):b.push(u))}y=b.pop()}}collides(C){let k=this._data;const y=this._toBBox;if(!E(C,k))return!1;for(b.clear();k;){for(let N=
0,l=k.children.length;N<l;N++){const O=k.children[N],u=k.leaf?y(O):O;if(E(C,u)){if(k.leaf||B(C,u))return!0;b.push(O)}}k=b.pop()}return!1}load(C){if(!C.length)return this;if(C.length<this._minEntries){for(let k=0,y=C.length;k<y;k++)this.insert(C[k]);return this}C=this._build(C.slice(0,C.length),0,C.length-1,0);if(this._data.children.length)if(this._data.height===C.height)this._splitRoot(this._data,C);else{if(this._data.height<C.height){const k=this._data;this._data=C;C=k}this._insert(C,this._data.height-
C.height-1,!0)}else this._data=C;return this}insert(C){C&&this._insert(C,this._data.height-1);return this}clear(){this._data=new H([]);return this}remove(C){if(!C)return this;let k=this._data,y=null,N=0,l=!1,O;const u=this._toBBox(C);A.clear();for(F.clear();k||0<A.length;){k||(k=A.pop(),y=A.data[A.length-1],N=F.pop()??0,l=!0);if(k.leaf&&(O=c.indexOf(k.children,C,k.children.length,k.indexHint),-1!==O)){k.children.splice(O,1);A.push(k);this._condense(A);break}l||k.leaf||!B(k,u)?y?(N++,k=y.children[N],
l=!1):k=null:(A.push(k),F.push(N),N=0,y=k,k=k.children[0])}return this}toJSON(){return this._data}fromJSON(C){this._data=C;return this}_all(C,k){for(q.clear();C;){if(!0===C.leaf)for(const y of C.children)k(y);else q.pushArray(C.children);C=q.pop()??null}}_build(C,k,y,N){var l=y-k+1,O=this._maxEntries;if(l<=O)return C=new H(C.slice(k,y+1)),I(C,this._toBBox),C;N||(N=Math.ceil(Math.log(l)/Math.log(O)),O=Math.ceil(l/O**(N-1)));const u=new S([]);u.height=N;l=Math.ceil(l/O);O=l*Math.ceil(Math.sqrt(O));
for(p(C,k,y,O,this._compareMinX);k<=y;k+=O){const D=Math.min(k+O-1,y);p(C,k,D,l,this._compareMinY);for(let R=k;R<=D;R+=l)u.children.push(this._build(C,R,Math.min(R+l-1,D),N-1))}I(u,this._toBBox);return u}_chooseSubtree(C,k,y,N){for(;;){N.push(k);if(!0===k.leaf||N.length-1===y)break;let l=Infinity,O=Infinity,u=void 0;for(let D=0,R=k.children.length;D<R;D++){const Q=k.children[D],U=m(Q),Z=(Math.max(Q.maxX,C.maxX)-Math.min(Q.minX,C.minX))*(Math.max(Q.maxY,C.maxY)-Math.min(Q.minY,C.minY))-U;Z<O?(O=Z,
l=U<l?U:l,u=Q):Z===O&&U<l&&(l=U,u=Q)}k=u||k.children[0]}return k}_insert(C,k,y){var N=this._toBBox;y=y?C:N(C);A.clear();N=this._chooseSubtree(y,this._data,k,A);N.children.push(C);for(g(N,y);0<=k;)if(A.data[k].children.length>this._maxEntries)this._split(A,k),k--;else break;this._adjustParentBBoxes(y,A,k)}_split(C,k){const y=C.data[k];var N=y.children.length;const l=this._minEntries;this._chooseSplitAxis(y,l,N);(N=this._chooseSplitIndex(y,l,N))?(N=y.children.splice(N,y.children.length-N),N=y.leaf?
new H(N):new S(N),N.height=y.height,I(y,this._toBBox),I(N,this._toBBox),k?C.data[k-1].children.push(N):this._splitRoot(y,N)):console.log("  Error: assertion failed at PooledRBush._split: no valid split index")}_splitRoot(C,k){this._data=new S([C,k]);this._data.height=C.height+1;I(this._data,this._toBBox)}_chooseSplitIndex(C,k,y){let N,l,O=void 0;N=l=Infinity;for(let D=k;D<=y-k;D++){var u=n(C,0,D,this._toBBox);const R=n(C,D,y,this._toBBox),Q=Math.max(0,Math.min(u.maxX,R.maxX)-Math.max(u.minX,R.minX))*
Math.max(0,Math.min(u.maxY,R.maxY)-Math.max(u.minY,R.minY));u=m(u)+m(R);Q<N?(N=Q,O=D,l=u<l?u:l):Q===N&&u<l&&(l=u,O=D)}return O}_chooseSplitAxis(C,k,y){const N=C.leaf?this._compareMinX:z,l=C.leaf?this._compareMinY:d,O=this._allDistMargin(C,k,y,N);k=this._allDistMargin(C,k,y,l);O<k&&C.children.sort(N)}_allDistMargin(C,k,y,N){C.children.sort(N);N=this._toBBox;var l=n(C,0,k,N);const O=n(C,y-k,y,N);let u=x(l)+x(O);for(let D=k;D<y-k;D++){const R=C.children[D];g(l,C.leaf?N(R):R);u+=x(l)}for(y=y-k-1;y>=k;y--)l=
C.children[y],g(O,C.leaf?N(l):l),u+=x(O);return u}_adjustParentBBoxes(C,k,y){for(;0<=y;y--)g(k.data[y],C)}_condense(C){for(let k=C.length-1;0<=k;k--){const y=C.data[k];if(0===y.children.length)if(0<k){const N=C.data[k-1],l=N.children;l.splice(c.indexOf(l,y,l.length,N.indexHint),1)}else this.clear();else I(y,this._toBBox)}}_initFormat(C){const k=["return a"," - b",";"];this._compareMinX=new Function("a","b",k.join(C[0]));this._compareMinY=new Function("a","b",k.join(C[1]));this._toBBox=new Function("a",
"return {minX: a"+C[0]+", minY: a"+C[1]+", maxX: a"+C[2]+", maxY: a"+C[3]+"};")}}const b=new w,q=new w,A=new w,F=new w({deallocator:void 0});class L{constructor(){this.minY=this.minX=Infinity;this.maxY=this.maxX=-Infinity}}class h extends L{constructor(){super(...arguments);this.height=1;this.indexHint=new c.PositionHint}}class H extends h{constructor(C){super();this.children=C;this.leaf=!0}}class S extends h{constructor(C){super();this.children=C;this.leaf=!1}}a.BBox=L;a.PooledRBush=f;Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/chunks/quickselect":function(){define(["exports","./_commonjsHelpers"],function(a,c){var w={exports:{}};w.exports;(function(v){(function(I){I=I();void 0!==I&&(v.exports=I)})(function(){function I(z,d,m,x,B){for(;x>m;){if(600<x-m){var E=x-m+1,p=d-m+1,f=Math.log(E),b=.5*Math.exp(2*f/3);f=.5*Math.sqrt(f*b*(E-b)/E)*(0>p-E/2?-1:1);I(z,d,Math.max(m,Math.floor(d-p*b/E+f)),Math.min(x,Math.floor(d+(E-p)*b/E+f)),B)}E=z[d];p=m;b=x;n(z,m,d);for(0<B(z[x],E)&&n(z,m,
x);p<b;){n(z,p,b);p++;for(b--;0>B(z[p],E);)p++;for(;0<B(z[b],E);)b--}0===B(z[m],E)?n(z,m,b):(b++,n(z,b,x));b<=d&&(m=b+1);d<=b&&(x=b-1)}}function n(z,d,m){var x=z[d];z[d]=z[m];z[m]=x}function g(z,d){return z<d?-1:z>d?1:0}return function(z,d,m,x,B){I(z,d,m||0,x||z.length-1,B||g)}})})(w);c=c.getDefaultExportFromCjs(w.exports);a.quickselect=c})},"esri/layers/graphics/data/geometryUtils":function(){define(["exports","../featureConversionUtils","../OptimizedGeometry"],function(a,c,w){const v=new w,I=new w,
n=new w,g={esriGeometryPoint:c.convertToPoint,esriGeometryPolyline:c.convertToPolyline,esriGeometryPolygon:c.convertToPolygon,esriGeometryMultipoint:c.convertToMultipoint},z=(d,m)=>"_geVersion"!==d?m:void 0;a.cleanFromGeometryEngine=function(d){return d&&"_geVersion"in d?JSON.parse(JSON.stringify(d,z)):d};a.getGeometry=function(d,m,x,B,E,p,f=m,b=x){const q=m&&f,A=x&&b;B=null!=B?"coords"in B?B:B.geometry:null;if(null==B)return null;if(E)return m=c.generalizeOptimizedGeometry(I,B,m,x,d,E,f,b),p&&(m=
c.quantizeOptimizedGeometry(n,m,q,A,d,p)),g[d]?.(m,q,A)??null;if(p)return p=c.quantizeOptimizedGeometry(n,B,m,x,d,p,f,b),g[d]?.(p,q,A)??null;c.removeZMValues(v,B,m,x,f,b);return g[d]?.(v,q,A)??null};a.transformCentroid=function(d,m,x,B=d.hasZ,E=d.hasM){if(null==m)return null;const p=d.hasZ&&B,f=d.hasM&&E;return x?(d=c.quantizeOptimizedGeometry(n,m,d.hasZ,d.hasM,"esriGeometryPoint",x,B,E),c.convertToPoint(d,p,f)):c.convertToPoint(m,p,f)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/layers/graphics/data/optimizedFeatureQueryEngineAdapter":function(){define(["exports","../centroid","../OptimizedFeature","../OptimizedGeometry"],function(a,c,w,v){a.optimizedFeatureQueryEngineAdapter={getObjectId(I){return I.objectId},getAttributes(I){return I.attributes},getAttribute(I,n){return I.attributes[n]},cloneWithGeometry(I,n){return new w.OptimizedFeature(n,I.attributes,null,I.objectId)},getGeometry(I){return I.geometry},getCentroid(I,n){null==I.centroid&&(I.centroid=c.getCentroidOptimizedGeometry(new v,
I.geometry,n.hasZ,n.hasM));return I.centroid}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/centroid":function(){define(["exports"],function(a){function c(v,I,n,g,z,d,m=1){d=z?d?4:3:d?3:2;let x=n,B=n+d,E=0,p=0,f=n=0,b=0;for(let q=0,A=g-1;q<A;q++,x+=d,B+=d){g=I[x];const F=I[x+1],L=I[x+2],h=I[B],H=I[B+1],S=I[B+2];let C=g*H-h*F;f+=C;E+=(g+h)*C;p+=(F+H)*C;z&&(C=g*S-h*L,n+=(L+S)*C,b+=C);g<v[0]&&(v[0]=g);g>v[1]&&(v[1]=g);F<v[2]&&(v[2]=F);F>v[3]&&(v[3]=F);z&&(L<v[4]&&
(v[4]=L),L>v[5]&&(v[5]=L))}0<f*m&&(f*=-1);0<b*m&&(b*=-1);if(!f)return null;v=[E,p,.5*f];z&&(v[3]=n,v[4]=.5*b);return v}function w(v,I,n,g,z){z=g?z?4:3:z?3:2;let d=I,m=I+z,x=0,B=0,E=0,p=0;for(let A=0,F=n-1;A<F;A++,d+=z,m+=z){var f=v[d];const L=v[d+1],h=v[d+2],H=v[m],S=v[m+1],C=v[m+2];if(g){var b=H-f;var q=S-L;const k=C-h;b=Math.sqrt(b*b+q*q+k*k)}else b=H-f,q=S-L,b=Math.sqrt(b*b+q*q);b&&(x+=b,g?(f=[f+.5*(H-f),L+.5*(S-L),h+.5*(C-h)],B+=b*f[0],E+=b*f[1],p+=b*f[2]):(f=[f+.5*(H-f),L+.5*(S-L)],B+=b*f[0],
E+=b*f[1]))}return 0<x?g?[B/x,E/x,p/x]:[B/x,E/x]:0<n?g?[v[I],v[I+1],v[I+2]]:[v[I],v[I+1]]:null}a.getCentroidOptimizedGeometry=function(v,I,n,g,z){if(!I?.lengths.length)return null;const d="upperLeft"===z?.originPosition?-1:1;v.lengths.length&&(v.lengths.length=0);v.coords.length&&(v.coords.length=0);z=v.coords;const m=[],x=n?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,
Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:B,coords:E}=I,p=n?g?4:3:g?3:2;let f=0;for(var b of B){const q=c(x,E,f,b,n,g,d);q&&m.push(q);f+=b*p}m.sort((q,A)=>{let F=d*q[2]-d*A[2];0===F&&n&&(F=q[4]-A[4]);return F});m.length&&(b=6*m[0][2],z[0]=m[0][0]/b,z[1]=m[0][1]/b,n&&(b=6*m[0][4],z[2]=0!==b?m[0][3]/b:0),z[0]<x[0]||z[0]>x[1]||z[1]<x[2]||z[1]>x[3]||n&&(z[2]<x[4]||z[2]>x[5]))&&(z.length=0);if(!z.length)if(I=I.lengths[0]?w(E,0,B[0],n,g):null)z[0]=I[0],z[1]=I[1],
n&&2<I.length&&(z[2]=I[2]);else return null;return v};a.lineCentroid=w;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/QueryEngine":function(){define("exports ../../../core/arrayUtils ../../../core/Error ../../../core/JSONSupport ../../../core/lang ../../../core/maybe ../../../core/MemCache ../../../core/promiseUtils ../../../core/unitUtils ../../../geometry/projection ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./attributeSupport ./geometryUtils ./projectionSupport ./QueryEngineCapabilities ./QueryEngineResult ./queryUtils ./queryValidationUtils ./spatialQuerySupport ./timeSupport ../../support/FieldsIndex ../../../views/support/Scheduler".split(" "),
function(a,c,w,v,I,n,g,z,d,m,x,B,E,p,f,b,q,A,F,L,h,H,S,C,k,y,N,l){class O{constructor(Q,U=null,Z,ea,la){this.attributes=Q;this.geometry=Z;this.centroid=ea;this.filterFlags=la;this.groupId=-1;this.displayId=U}}const u=new g.MemCacheStorage(2E6);let D=0;class R{constructor(Q){this._changeHandle=this._geometryQueryCache=null;this.capabilities={query:h.queryCapabilities};this.geometryType=Q.geometryType;this.hasM=!!Q.hasM;this.hasZ=!!Q.hasZ;this.objectIdField=Q.objectIdField;this.spatialReference=Q.spatialReference;
this.definitionExpression=Q.definitionExpression;this.featureStore=Q.featureStore;this.aggregateAdapter=Q.aggregateAdapter;this._changeHandle=this.featureStore.events.on("changed",()=>this.clearCache());this.timeInfo=Q.timeInfo;Q.cacheSpatialQueries&&(this._geometryQueryCache=new g.MemCache(D++ +"$$",u));this.fieldsIndex=v.isSerializable(Q.fieldsIndex)?Q.fieldsIndex:N.fromJSON(Q.fieldsIndex);this.availableFields=null==Q.availableFields?new Set(this.fieldsIndex.fields.map(U=>U.name)):new Set(Q.availableFields.map(U=>
this.fieldsIndex.get(U)?.name).filter(U=>null!=U));Q.scheduler&&Q.priority&&(this._frameTask=Q.scheduler.registerTask(Q.priority))}destroy(){this._frameTask=n.removeMaybe(this._frameTask);this.clearCache();n.destroyMaybe(this._geometryQueryCache);this._changeHandle=n.removeMaybe(this._changeHandle)}get featureAdapter(){return this.featureStore.featureAdapter}clearCache(){this._geometryQueryCache?.clear();this._fullExtentPromise=this._timeExtentPromise=this._allFeaturesPromise=null}async executeQuery(Q,
U){try{return(await this._executeQuery(Q,{},U)).createQueryResponse()}catch(Z){if(Z!==S.queryEngineEmptyResult)throw Z;return(new H.QueryEngineResult([],Q,this)).createQueryResponse()}}async executeQueryForCount(Q={},U){try{return(await this._executeQuery(Q,{returnGeometry:!1,returnCentroid:!1,outSR:null},U)).createQueryResponseForCount()}catch(Z){if(Z!==S.queryEngineEmptyResult)throw Z;return 0}}async executeQueryForExtent(Q,U){const Z=Q.outSR;try{const ea=await this._executeQuery(Q,{returnGeometry:!0,
returnCentroid:!1,outSR:null},U),la=ea.size;if(!la)return{count:0,extent:null};const na=await this._getBounds(ea.items,ea.spatialReference,Z||this.spatialReference);return{count:la,extent:na}}catch(ea){if(ea===S.queryEngineEmptyResult)return{count:0,extent:null};throw ea;}}async executeQueryForIds(Q,U){return this.executeQueryForIdSet(Q,U).then(Z=>Array.from(Z))}async executeQueryForIdSet(Q,U){try{const Z=await this._executeQuery(Q,{returnGeometry:!0,returnCentroid:!1,outSR:null},U),ea=Z.items,la=
new Set;await this._reschedule(()=>{for(const na of ea)la.add(Z.featureAdapter.getObjectId(na))},U);return la}catch(Z){if(Z===S.queryEngineEmptyResult)return new Set;throw Z;}}async executeQueryForSnapping(Q,U){const {point:Z,distance:ea,returnEdge:la,vertexMode:na}=Q;if(!la&&"none"===na)return{candidates:[]};let ta=I.clone(Q.query);ta=await this._schedule(()=>S.normalizeQueryLike(ta,this.definitionExpression,this.spatialReference),U);ta=await this._reschedule(()=>C.validateQuery(ta,{availableFields:this.availableFields,
fieldsIndex:this.fieldsIndex,geometryType:this.geometryType,spatialReference:this.spatialReference}),U);const ua=!b.equals(Z.spatialReference,this.spatialReference);ua&&await L.checkProjectionSupport(Z.spatialReference,this.spatialReference);var sa="number"===typeof ea?ea:ea.x,va="number"===typeof ea?ea:ea.y;sa={xmin:Z.x-sa,xmax:Z.x+sa,ymin:Z.y-va,ymax:Z.y+va,spatialReference:Z.spatialReference};sa=ua?L.project(sa,this.spatialReference):sa;if(!sa)return{candidates:[]};va=(await f.normalizeCentralMeridian(p.fromJSON(Z),
null,{signal:U}))[0];const xa=(await f.normalizeCentralMeridian(p.fromJSON(sa),null,{signal:U}))[0];if(null==va||null==xa)return{candidates:[]};const Da=new H.QueryEngineResult(await this._reschedule(()=>this._searchFeatures(this._getQueryBBoxes(xa.toJSON())),U),ta,this);await this._reschedule(()=>this._executeObjectIdsQuery(Da),U);await this._reschedule(()=>this._executeTimeQuery(Da),U);await this._reschedule(()=>this._executeAttributesQuery(Da),U);await this._reschedule(()=>this._executeGeometryQueryForSnapping(Da,
U),U);va=va.toJSON();va=ua?L.project(va,this.spatialReference):va;return Da.createSnappingResponse({...Q,point:va,distance:ua?Math.max(sa.xmax-sa.xmin,sa.ymax-sa.ymin)/2:ea},Z.spatialReference)}async executeQueryForLatestObservations(Q,U){if(!this.timeInfo?.trackIdField)throw new w("unsupported-query","Missing timeInfo or timeInfo.trackIdField",{query:Q,timeInfo:this.timeInfo});try{const Z=await this._executeQuery(Q,{},U);await this._reschedule(()=>this._filterLatest(Z),U);return Z.createQueryResponse()}catch(Z){if(Z!==
S.queryEngineEmptyResult)throw Z;return(new H.QueryEngineResult([],Q,this)).createQueryResponse()}}async executeQueryForSummaryStatistics(Q={},U,Z){const {field:ea,normalizationField:la,valueExpression:na}=U;return(await this._executeQueryForStatistics(Q,{field:ea,normalizationField:la,valueExpression:na},Z)).createSummaryStatisticsResponse(U)}async executeQueryForUniqueValues(Q={},U,Z){const {field:ea,field2:la,field3:na,valueExpression:ta}=U;return(await this._executeQueryForStatistics(Q,{field:ea,
field2:la,field3:na,valueExpression:ta},Z)).createUniqueValuesResponse(U)}async executeQueryForClassBreaks(Q={},U,Z){const {field:ea,normalizationField:la,valueExpression:na}=U;return(await this._executeQueryForStatistics(Q,{field:ea,normalizationField:la,valueExpression:na},Z)).createClassBreaksResponse(U)}async executeQueryForHistogram(Q={},U,Z){const {field:ea,normalizationField:la,valueExpression:na}=U;return(await this._executeQueryForStatistics(Q,{field:ea,normalizationField:la,valueExpression:na},
Z)).createHistogramResponse(U)}async fetchRecomputedExtents(Q){this._timeExtentPromise||(this._timeExtentPromise=y.getTimeExtent(this.timeInfo,this.featureStore));const [U,Z]=await Promise.all([this._getFullExtent(),this._timeExtentPromise]);z.throwIfAborted(Q);return{fullExtent:U,timeExtent:Z}}async _getBounds(Q,U,Z){const ea=x.set(x.create(),x.negativeInfinity);await this.featureStore.forEachBounds(Q,la=>x.expandWithAABB(ea,la));Q={xmin:ea[0],ymin:ea[1],xmax:ea[3],ymax:ea[4],spatialReference:F.cleanFromGeometryEngine(this.spatialReference)};
this.hasZ&&isFinite(ea[2])&&isFinite(ea[5])&&(Q.zmin=ea[2],Q.zmax=ea[5]);U=L.project(Q,U,Z);U.spatialReference=F.cleanFromGeometryEngine(Z);0===U.xmax-U.xmin&&(Z=d.getMetersPerUnitForSR(U.spatialReference),U.xmin-=Z,U.xmax+=Z);0===U.ymax-U.ymin&&(Z=d.getMetersPerUnitForSR(U.spatialReference),U.ymin-=Z,U.ymax+=Z);this.hasZ&&null!=U.zmin&&null!=U.zmax&&0===U.zmax-U.zmin&&(Z=d.getMetersPerUnitForSR(U.spatialReference),U.zmin-=Z,U.zmax+=Z);return U}_getFullExtent(){this._fullExtentPromise||(this._fullExtentPromise=
"getFullExtent"in this.featureStore&&this.featureStore.getFullExtent?Promise.resolve(this.featureStore.getFullExtent(this.spatialReference)):this._getAllFeatures().then(Q=>this._getBounds(Q,this.spatialReference,this.spatialReference)));return this._fullExtentPromise}async _schedule(Q,U){return null!=this._frameTask?this._frameTask.schedule(Q,U):Q(l.noBudget)}async _reschedule(Q,U){return null!=this._frameTask?this._frameTask.reschedule(Q,U):Q(l.noBudget)}async _getAllFeaturesQueryEngineResult(Q){return new H.QueryEngineResult(await this._getAllFeatures(),
Q,this)}async _getAllFeatures(){if(null==this._allFeaturesPromise){const Z=[];this._allFeaturesPromise=(async()=>{await this.featureStore.forEach(ea=>Z.push(ea))})().then(()=>Z)}const Q=this._allFeaturesPromise,U=await Q;return Q===this._allFeaturesPromise?U.slice():this._getAllFeatures()}async _executeQuery(Q,U,Z){Q=I.clone(Q);Q=await this._schedule(()=>S.normalizeQuery(Q,this.definitionExpression,this.spatialReference),Z);Q=await this._reschedule(()=>C.validateQuery(Q,{availableFields:this.availableFields,
fieldsIndex:this.fieldsIndex,geometryType:this.geometryType,spatialReference:this.spatialReference}),Z);Q={...Q,...U};const ea=await this._reschedule(()=>this._executeSceneFilterQuery(Q,Z),Z),la=await this._reschedule(()=>this._executeGeometryQuery(Q,ea,Z),Z);await this._reschedule(()=>this._executeAggregateIdsQuery(la),Z);await this._reschedule(()=>this._executeObjectIdsQuery(la),Z);await this._reschedule(()=>this._executeTimeQuery(la),Z);await this._reschedule(()=>this._executeAttributesQuery(la),
Z);return la}async _executeSceneFilterQuery(Q,U){if(null==Q.sceneFilter)return null;const {outSR:Z,returnGeometry:ea,returnCentroid:la}=Q;var na=this.featureStore.featureSpatialReference,ta=Q.sceneFilter.geometry;const ua=null==na||b.equals(na,ta.spatialReference)?ta:L.project(ta,na);if(!ua)return null;na=ea||la;na=b.isValid(Z)&&!b.equals(this.spatialReference,Z)&&na?async Da=>this._project(Da,Z):Da=>Da;const sa=this.featureAdapter;ta=await this._reschedule(()=>this._searchFeatures(this._getQueryBBoxes(ua)),
U);if("disjoint"===Q.sceneFilter.spatialRelationship){if(!ta.length)return null;const Da=new Set;for(var va of ta)Da.add(sa.getObjectId(va));const Ia=await this._reschedule(()=>this._getAllFeatures(),U);va=await this._reschedule(async()=>{const Pa=await k.getSpatialQueryOperator("esriSpatialRelDisjoint",ua,this.geometryType,this.hasZ,this.hasM),Na=await this._runSpatialFilter(Ia,Sa=>!Da.has(sa.getObjectId(Sa))||Pa(sa.getGeometry(Sa)),U);return new H.QueryEngineResult(Na,Q,this)},U);return na(va)}if(!ta.length)return new H.QueryEngineResult([],
Q,this);if(this._canExecuteSinglePass(ua,Q))return na(new H.QueryEngineResult(ta,Q,this));const xa=await k.getSpatialQueryOperator("esriSpatialRelContains",ua,this.geometryType,this.hasZ,this.hasM);va=await this._runSpatialFilter(ta,Da=>xa(sa.getGeometry(Da)),U);return na(new H.QueryEngineResult(va,Q,this))}async _executeGeometryQuery(Q,U,Z){if(null!=U&&0===U.items.length)return U;Q=null!=U?U.query:Q;const {geometry:ea,outSR:la,spatialRel:na,returnGeometry:ta,returnCentroid:ua}=Q;var sa=this.featureStore.featureSpatialReference;
const va=!ea||null==sa||b.equals(sa,ea.spatialReference)?ea:L.project(ea,sa),xa=ta||ua,Da=b.isValid(la)&&!b.equals(this.spatialReference,la),Ia=this._geometryQueryCache&&null==U?Da&&xa?JSON.stringify({originalFilterGeometry:ea,spatialRelationship:na,outSpatialReference:la}):JSON.stringify({originalFilterGeometry:ea,spatialRelationship:na}):null;sa=Ia?this._geometryQueryCache.get(Ia):null;if(null!=sa)return new H.QueryEngineResult(sa,Q,this);sa=async r=>{Da&&xa&&await this._project(r,la);Ia&&this._geometryQueryCache.put(Ia,
r.items,r.items.length+1);return r};if(!va)return sa(null!=U?U:await this._getAllFeaturesQueryEngineResult(Q));const Pa=this.featureAdapter;let Na=await this._reschedule(()=>this._searchFeatures(this._getQueryBBoxes(ea)),Z);if("esriSpatialRelDisjoint"===na){if(!Na.length)return sa(null!=U?U:await this._getAllFeaturesQueryEngineResult(Q));const r=new Set;for(var Sa of Na)r.add(Pa.getObjectId(Sa));const K=null!=U?U.items:await this._reschedule(()=>this._getAllFeatures(),Z);Sa=await this._reschedule(async()=>
{const X=await k.getSpatialQueryOperator(na,va,this.geometryType,this.hasZ,this.hasM),aa=await this._runSpatialFilter(K,ha=>!r.has(Pa.getObjectId(ha))||X(Pa.getGeometry(ha)),Z);return new H.QueryEngineResult(aa,Q,this)},Z);return sa(Sa)}if(null!=U){const r=new c.PositionHint;Na=Na.filter(K=>0<=c.indexOf(U.items,K,U.items.length,r))}if(!Na.length)return sa=new H.QueryEngineResult([],Q,this),Ia&&this._geometryQueryCache.put(Ia,sa.items,1),sa;if(this._canExecuteSinglePass(va,Q))return sa(new H.QueryEngineResult(Na,
Q,this));const Va=await k.getSpatialQueryOperator(na,va,this.geometryType,this.hasZ,this.hasM);Sa=await this._runSpatialFilter(Na,r=>Va(Pa.getGeometry(r)),Z);return sa(new H.QueryEngineResult(Sa,Q,this))}async _executeGeometryQueryForSnapping(Q,U){const {query:Z}=Q,{spatialRel:ea}=Z;if(Q?.items?.length&&Z.geometry&&ea){var la=await k.getSpatialQueryOperator(ea,Z.geometry,this.geometryType,this.hasZ,this.hasM);U=await this._runSpatialFilter(Q.items,na=>la(na.geometry),U);Q.items=U}}_executeAggregateIdsQuery(Q){if(0!==
Q.items.length&&Q.query.aggregateIds?.length&&null!=this.aggregateAdapter){var U=new Set;for(const ea of Q.query.aggregateIds)this.aggregateAdapter.getFeatureObjectIds(ea).forEach(la=>U.add(la));var Z=this.featureAdapter.getObjectId;Q.items=Q.items.filter(ea=>U.has(Z(ea)))}}_executeObjectIdsQuery(Q){if(0!==Q.items.length&&Q.query.objectIds?.length){var U=new Set(Q.query.objectIds),Z=this.featureAdapter.getObjectId;Q.items=Q.items.filter(ea=>U.has(Z(ea)))}}_executeTimeQuery(Q){if(0!==Q.items.length){var U=
y.getTimeOperator(this.timeInfo,Q.query.timeExtent,this.featureAdapter);null!=U&&(Q.items=Q.items.filter(U))}}_executeAttributesQuery(Q){if(0!==Q.items.length){var U=A.getWhereClause(Q.query.where,this.fieldsIndex);if(U){if(!U.isStandardized)throw new TypeError("Where clause is not standardized");Q.items=Q.items.filter(Z=>U.testFeature(Z,this.featureAdapter))}}}async _runSpatialFilter(Q,U,Z){if(!U)return Q;if(null==this._frameTask)return Q.filter(ta=>U(ta));let ea=0;const la=[],na=async ta=>{for(;ea<
Q.length;){const ua=Q[ea++];U(ua)&&(la.push(ua),ta.madeProgress());ta.done&&await this._reschedule(sa=>na(sa),Z)}};return this._reschedule(ta=>na(ta),Z).then(()=>la)}_filterLatest(Q){const {trackIdField:U,startTimeField:Z,endTimeField:ea}=this.timeInfo,la=ea||Z,na=new Map,ta=this.featureAdapter.getAttribute;for(const ua of Q.items){const sa=ta(ua,U),va=ta(ua,la),xa=na.get(sa);(!xa||va>ta(xa,la))&&na.set(sa,ua)}Q.items=Array.from(na.values())}_canExecuteSinglePass(Q,U){({spatialRel:U}=U);return k.canQueryWithRBush(Q)&&
("esriSpatialRelEnvelopeIntersects"===U||"esriGeometryPoint"===this.geometryType&&("esriSpatialRelIntersects"===U||"esriSpatialRelContains"===U))}async _project(Q,U){if(!U||b.equals(this.spatialReference,U))return Q;const Z=this.featureAdapter;let ea=void 0;try{const la=await this._getFullExtent();ea=m.getTransformation(this.spatialReference,U,la)}catch{}U=await L.projectMany(Q.items.map(la=>F.getGeometry(this.geometryType,this.hasZ,this.hasM,Z.getGeometry(la))),this.spatialReference,U,ea);Q.items=
U.map((la,na)=>Z.cloneWithGeometry(Q.items[na],q.convertFromGeometry(la,this.hasZ,this.hasM)));return Q}_getQueryBBoxes(Q){if(k.canQueryWithRBush(Q)){if(p.isExtent(Q))return[B.fromValues(Math.min(Q.xmin,Q.xmax),Math.min(Q.ymin,Q.ymax),Math.max(Q.xmin,Q.xmax),Math.max(Q.ymin,Q.ymax))];if(p.isPolygon(Q))return Q.rings.map(U=>B.fromValues(Math.min(U[0][0],U[2][0]),Math.min(U[0][1],U[2][1]),Math.max(U[0][0],U[2][0]),Math.max(U[0][1],U[2][1])))}return[E.getBoundsXY(B.create(),Q)]}async _searchFeatures(Q){const U=
new Set;await Promise.all(Q.map(Z=>this.featureStore.forEachInBounds(Z,ea=>U.add(ea))));Q=Array.from(U.values());U.clear();return Q}async _executeQueryForStatistics(Q,U,Z){Q=I.clone(Q);try{Q=await this._schedule(()=>S.normalizeQuery(Q,this.definitionExpression,this.spatialReference),Z);Q=await this._reschedule(()=>C.validateStatisticsQuery(Q,U,{availableFields:this.availableFields,fieldsIndex:this.fieldsIndex,geometryType:this.geometryType,spatialReference:this.spatialReference}),Z);const ea=await this._reschedule(()=>
this._executeSceneFilterQuery(Q,Z),Z),la=await this._reschedule(()=>this._executeGeometryQuery(Q,ea,Z),Z);await this._reschedule(()=>this._executeAggregateIdsQuery(la),Z);await this._reschedule(()=>this._executeObjectIdsQuery(la),Z);await this._reschedule(()=>this._executeTimeQuery(la),Z);await this._reschedule(()=>this._executeAttributesQuery(la),Z);return la}catch(ea){if(ea!==S.queryEngineEmptyResult)throw ea;return new H.QueryEngineResult([],Q,this)}}}a.Feature=O;a.QueryEngine=R;Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/core/MemCache":function(){define(["exports","./PooledArray"],function(a,c){a.RemoveMode=void 0;(function(n){n[n.ALL=0]="ALL";n[n.SOME=1]="SOME"})(a.RemoveMode||(a.RemoveMode={}));class w{constructor(n,g,z){this.name=n;this._storage=g;this.id=`${I++}:`;this.maxSize=this.size=0;this._removeFunc=!1;this._miss=this._hit=0;this._storage.register(this);z&&(this._storage.registerRemoveFunc(this.id,z),this._removeFunc=!0)}destroy(){this._storage.clear(this);this._removeFunc&&
this._storage.deregisterRemoveFunc(this.id);this._storage.deregister(this);this._storage=null}get hitRate(){return this._hit/(this._hit+this._miss)}get sizeAll(){return this._storage.size}resetHitRate(){this._hit=this._miss=0}put(n,g,z,d=0){this._storage.put(this,n,g,z,d)}get(n){n=this._storage.get(this,n);void 0===n?++this._miss:++this._hit;return n}peek(n){return this._storage.peek(this,n)}pop(n){n=this._storage.pop(this,n);void 0===n?++this._miss:++this._hit;return n}updateSize(n,g,z){this._storage.updateSize(this,
n,g,z)}clear(){this._storage.clear(this)}clearAll(){this._storage.clearAll()}get performanceInfo(){return this._storage.performanceInfo}resetStats(){this._storage.resetStats()}}class v{get size(){return this._size}constructor(n=10485760){this._maxSize=n;this._db=new Map;this._miss=this._hit=this._size=0;this._removeFuncs=new c;this._users=new c}destroy(){this.clearAll();this._removeFuncs.clear();this._users.clear();this._db=null}register(n){this._users.push(n)}deregister(n){this._users.removeUnordered(n)}registerRemoveFunc(n,
g){this._removeFuncs.push([n,g])}deregisterRemoveFunc(n){this._removeFuncs.filterInPlace(g=>g[0]!==n)}get maxSize(){return this._maxSize}set maxSize(n){this._maxSize=Math.max(n,0);this._checkSizeLimits()}put(n,g,z,d,m){g=n.id+g;const x=this._db.get(g);x&&(this._size-=x.size,n.size-=x.size,this._db.delete(g),x.entry!==z&&this._notifyRemove(g,x.entry,a.RemoveMode.ALL));d>this._maxSize?this._notifyRemove(g,z,a.RemoveMode.ALL):void 0===z?console.warn("Refusing to cache undefined entry "):!d||0>d?(console.warn(`Refusing to cache entry with size ${d} for key ${g}`),
this._notifyRemove(g,z,a.RemoveMode.ALL)):(m=1+Math.max(m,-3)- -3,this._db.set(g,{entry:z,size:d,lifetime:m,lives:m}),this._size+=d,n.size+=d,this._checkSizeLimits())}updateSize(n,g,z,d){g=n.id+g;const m=this._db.get(g);if(m&&m.entry===z){this._size-=m.size;for(n.size-=m.size;d>this._maxSize;)if(d=this._notifyRemove(g,z,a.RemoveMode.SOME),!(null!=d&&0<d)){this._db.delete(g);return}m.size=d;this._size+=d;n.size+=d;this._checkSizeLimits()}}pop(n,g){g=n.id+g;const z=this._db.get(g);if(z)return this._size-=
z.size,n.size-=z.size,this._db.delete(g),++this._hit,z.entry;++this._miss}get(n,g){g=n.id+g;n=this._db.get(g);if(void 0===n)++this._miss;else return this._db.delete(g),n.lives=n.lifetime,this._db.set(g,n),++this._hit,n.entry}peek(n,g){(n=this._db.get(n.id+g))?++this._hit:++this._miss;return n?.entry}get performanceInfo(){const n={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},g={},z=
[];this._db.forEach((x,B)=>{const E=x.lifetime;z[E]=(z[E]||0)+x.size;this._users.forAll(p=>{const {id:f,name:b}=p;B.startsWith(f)&&(g[b]=(g[b]||0)+x.size)})});const d={};this._users.forAll(x=>{const B=x.name;"hitRate"in x&&"number"===typeof x.hitRate&&!isNaN(x.hitRate)&&0<x.hitRate?(g[B]=g[B]||0,d[B]=Math.round(100*x.hitRate)+"%"):d[B]="0%"});var m=Object.keys(g);m.sort((x,B)=>g[B]-g[x]);m.forEach(x=>n[x]=Math.round(g[x]/2**20)+"MB / "+d[x]);for(m=z.length-1;0<=m;--m){const x=z[m];x&&(n["Priority "+
(m+-3-1)]=Math.round(x/this._size*100)+"%")}return n}resetStats(){this._hit=this._miss=0;this._users.forAll(n=>n.resetHitRate())}clear(n){const g=n.id;this._db.forEach((z,d)=>{d.startsWith(g)&&(this._size-=z.size,this._db.delete(d),this._notifyRemove(d,z.entry,a.RemoveMode.ALL))});n.size=0}clearAll(){this._db.forEach((n,g)=>this._notifyRemove(g,n.entry,a.RemoveMode.ALL));this._users.forEach(n=>n.size=0);this._size=0;this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(n,
g,z){let d;this._removeFuncs.some(m=>n.startsWith(m[0])?(m=m[1](g,z),"number"===typeof m&&(d=m),!0):!1);return d}_checkSizeLimits(){if(this._size>this._maxSize)for(const [n,g]of this._db)if(this._purgeItem(n,g),this._size<=.9*this.maxSize)return;this._users.forEach(n=>{if(0<n.maxSize&&n.size>n.maxSize)for(const [g,z]of this._db)if(g.startsWith(n.id)&&(this._purgeItem(g,z,n),n.size<=.9*n.maxSize))break})}_purgeItem(n,g,z=this._users.find(d=>n.startsWith(d.id))){this._db.delete(n);if(1>=g.lives){this._size-=
g.size;z&&(z.size-=g.size);const d=this._notifyRemove(n,g.entry,a.RemoveMode.SOME);null!=d&&0<d&&(this._size+=d,z&&(z.size+=d),g.lives=g.lifetime,g.size=d,this._db.set(n,g))}else--g.lives,this._db.set(n,g)}}let I=0;a.MemCache=w;a.MemCacheStorage=v;a.minPriority=-3;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/normalizeUtils":function(){define("exports ../../config ../../core/Error ../../core/Logger ../Polygon ../Polyline ./normalizeUtilsCommon ./spatialReferenceUtils ./webMercatorUtils ../../rest/geometryService/cut ../../rest/geometryService/simplify".split(" "),
function(a,c,w,v,I,n,g,z,d,m,x){function B(F){const L=[];let h=0,H=0;for(let S=0;S<F.length;S++){const C=F[S];let k=null;for(let y=0;y<C.length;y++)k=C[y],L.push(k),0===y?H=h=k[0]:(h=Math.min(h,k[0]),H=Math.max(H,k[0]));k&&L.push([(h+H)/2,0])}return L}function E(F,L){if(!(F instanceof n||F instanceof I))throw A.error("straightLineDensify: the input geometry is neither polyline nor polygon"),new w("straightLineDensify: the input geometry is neither polyline nor polygon");var h=g.getGeometryParts(F);
const H=[];for(const C of h){h=[];H.push(h);h.push([C[0][0],C[0][1]]);for(let k=0;k<C.length-1;k++){const y=C[k][0],N=C[k][1],l=C[k+1][0],O=C[k+1][1];var S=Math.sqrt((l-y)*(l-y)+(O-N)*(O-N));const u=(O-N)/S,D=(l-y)/S,R=S/L;if(1<R){for(let Q=1;Q<=R-1;Q++){const U=Q*L;h.push([D*U+y,u*U+N])}S=(S+Math.floor(R-1)*L)/2;h.push([D*S+y,u*S+N])}h.push([l,O])}}return"polygon"===F.type?new I({rings:H,spatialReference:F.spatialReference}):new n({paths:H,spatialReference:F.spatialReference})}function p(F,L,h){L&&
(F=E(F,1E6),F=d.webMercatorToGeographic(F,!0));h&&(F=g.updatePolyGeometry(F,h));return F}function f(F,L,h){if(Array.isArray(F)){var H=F[0];H>L?(h=g.offsetMagnitude(H,L),F[0]=H+-2*h*L):H<h&&(L=g.offsetMagnitude(H,h),F[0]=H+-2*L*h)}else H=F.x,H>L?(h=g.offsetMagnitude(H,L),F=F.clone().offset(-2*h*L,0)):H<h&&(L=g.offsetMagnitude(H,h),F=F.clone().offset(-2*L*h,0));return F}function b(F,L){let h=-1;for(let H=0;H<L.cutIndexes.length;H++){const S=L.cutIndexes[H],C=L.geometries[H],k=g.getGeometryParts(C);
for(let y=0;y<k.length;y++){const N=k[y];N.some(l=>{if(180>l[0])return!0;l=0;for(var O=0;O<N.length;O++){var u=N[O][0];l=u>l?u:l}l=Number(l.toFixed(9));l=-360*g.offsetMagnitude(l,180);for(O=0;O<N.length;O++)u=C.getPoint(y,O),C.setPoint(y,O,u.clone().offset(l,0));return!0})}if(S===h)if("polygon"===F[0].type)for(const y of g.getGeometryParts(C))F[S]=F[S].addRing(y);else{if("polyline"===F[0].type)for(const y of g.getGeometryParts(C))F[S]=F[S].addPath(y)}else h=S,F[S]=C}return F}async function q(F,L,
h){if(!Array.isArray(F))return q([F],L);L&&"string"!==typeof L&&A.warn("normalizeCentralMeridian()","The url object is deprecated, use the url string instead");var H="string"===typeof L?L:L?.url??c.geometryServiceUrl;let S,C,k;let y=0;var N=[];L=[];for(var l of F)if(null==l)L.push(l);else{if(!O){var O=l.spatialReference;var u=z.getInfo(O);var D=(S=O.isWebMercator)?102100:4326;C=g.cutParams[D].maxX;k=g.cutParams[D].minX;var R=g.cutParams[D].plus180Line;D=g.cutParams[D].minus180Line}if(u)if("mesh"===
l.type)L.push(l);else if("point"===l.type)L.push(f(l.clone(),C,k));else if("multipoint"===l.type){var Q=l.clone();Q.points=Q.points.map(U=>f(U,C,k));L.push(Q)}else if("extent"===l.type)Q=l.clone()._normalize(!1,!1,u),L.push(Q.rings?new I(Q):Q);else if(l.extent){Q=l.extent;const U=2*g.offsetMagnitude(Q.xmin,k)*C;let Z=0===U?l.clone():g.updatePolyGeometry(l.clone(),U);Q.offset(U,0);Q.intersects(R)&&Q.xmax!==C?(y=Q.xmax>y?Q.xmax:y,Z=p(Z,S),N.push(Z),L.push("cut")):Q.intersects(D)&&Q.xmin!==k?(y=2*Q.xmax*
C>y?2*Q.xmax*C:y,Z=p(Z,S,360),N.push(Z),L.push("cut")):L.push(Z)}else L.push(l.clone());else L.push(l)}O=g.offsetMagnitude(y,C);u=-90;R=O;for(l=new n;0<O;)D=-180+360*O,l.addPath([[D,u],[D,-1*u]]),u*=-1,O--;if(0<N.length&&0<R){O=await m.cut(H,N,l,h);O=b(N,O);u=[];N=[];for(R=0;R<L.length;R++)l=L[R],"cut"!==l?N.push(l):(l=O.shift(),D=F[R],null!=D&&"polygon"===D.type&&D.rings&&1<D.rings.length&&l.rings.length>=D.rings.length?(u.push(l),N.push("simplify")):N.push(S?d.geographicToWebMercator(l):l));if(!u.length)return N;
L=await x.simplify(H,u,h);F=[];for(h=0;h<N.length;h++)H=N[h],"simplify"!==H?F.push(H):F.push(S?d.geographicToWebMercator(L.shift()):L.shift());return F}F=[];for(h=0;h<L.length;h++)H=L[h],"cut"!==H?F.push(H):(H=N.shift(),F.push(!0===S?d.geographicToWebMercator(H):H));return F}const A=v.getLogger("esri.geometry.support.normalizeUtils");a.getClosestDenormalizedXToReference=function(F,L,h){h=z.getInfo(h);if(null==h)return F;const [H,S]=h.valid;h=2*S;let C=0,k=0;L>S?C=Math.ceil(Math.abs(L-S)/h):L<H&&(C=
-Math.ceil(Math.abs(L-H)/h));F>S?k=Math.ceil(Math.abs(F-S)/h):F<H&&(k=-Math.ceil(Math.abs(F-H)/h));F+=(C-k)*h;L=F-L;L>S?F-=h:L<H&&(F+=h);return F};a.getDenormalizedExtent=function(F){if(!F)return null;const L=F.extent;if(!L)return null;var h=F.spatialReference&&z.getInfo(F.spatialReference);if(!h)return L;const [H,S]=h.valid;({width:h}=L);let {xmin:C,xmax:k}=L;[C,k]=[k,C];if("extent"===F.type||0===h||h<=S||h>2*S||C<H||k>S)return L;let y;switch(F.type){case "polygon":if(1<F.rings.length)y=B(F.rings);
else return L;break;case "polyline":if(1<F.paths.length)y=B(F.paths);else return L;break;case "multipoint":y=F.points}F=L.clone();for(let N=0;N<y.length;N++){let l=y[N][0];0>l?(l+=S,k=Math.max(l,k)):(l-=S,C=Math.min(l,C))}F.xmin=C;F.xmax=k;return F.width<h?(F.xmin-=S,F.xmax-=S,F):L};a.normalizeCentralMeridian=q;a.normalizeMapX=function(F,L){if(L=z.getInfo(L)){const [h,H]=L.valid;L=H-h;if(F<h)for(;F<h;)F+=L;if(F>H)for(;F>H;)F-=L}return F};a.straightLineDensify=E;Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/geometry/support/normalizeUtilsCommon":function(){define(["exports","../Polyline","../SpatialReference","./jsonUtils"],function(a,c,w,v){function I(n){return v.isPolygon(n)?n.rings:n.paths}c={102100:{maxX:2.0037508342788905E7,minX:-2.0037508342788905E7,plus180Line:new c({paths:[[[2.0037508342788905E7,-2.0037508342788905E7],[2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:w.WebMercator}),minus180Line:new c({paths:[[[-2.0037508342788905E7,-2.0037508342788905E7],
[-2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:w.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new c({paths:[[[180,-180],[180,180]]],spatialReference:w.WGS84}),minus180Line:new c({paths:[[[-180,-180],[-180,180]]],spatialReference:w.WGS84})}};a.cutParams=c;a.getGeometryParts=I;a.offsetMagnitude=function(n,g){return Math.ceil((n-g)/(2*g))};a.updatePolyGeometry=function(n,g){const z=I(n);for(const d of z)for(const m of d)m[0]+=g;return n};Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/rest/geometryService/cut":function(){define("exports ../../geometry ../../request ../../geometry/support/jsonUtils ../../geometry/support/spatialReferenceUtils ../utils".split(" "),function(a,c,w,v,I,n){a.cut=async function(g,z,d,m){g=n.parseUrl(g);const x=z[0].spatialReference;z={...m,responseType:"json",query:{...g.query,f:"json",sr:I.srToRESTValue(x),target:JSON.stringify({geometryType:v.getJsonType(z[0]),geometries:z}),cutter:JSON.stringify(d)}};z=await w(g.path+"/cut",
z);const {cutIndexes:B,geometries:E=[]}=z.data;return{cutIndexes:B,geometries:E.map(p=>{p=v.fromJSON(p);p.spatialReference=x;return p})}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/utils":function(){define("exports ../config ../kernel ../core/lang ../core/urlUtils ../support/apiKeyUtils".split(" "),function(a,c,w,v,I,n){function g(z,d,m){const x={};for(const E in z)if("declaredClass"!==E){var B=z[E];if(null!=B&&"function"!==typeof B)if(Array.isArray(B)){x[E]=[];for(let p=
0;p<B.length;p++)x[E][p]=g(B[p])}else"object"===typeof B?B.toJSON?(B=B.toJSON(m?.[E]),x[E]=d?B:JSON.stringify(B)):x[E]=d?B:JSON.stringify(B):x[E]=B}return x}a.asValidOptions=function(z,d){return d?{...d,query:{...(z??{}),...d.query}}:{query:z}};a.encode=g;a.getToken=function(z,d){return z?n.supportsApiKey(z)&&(d||c.apiKey)?d||c.apiKey:w.id?.findCredential(z)?.token:null};a.parseUrl=function(z){return"string"===typeof z?I.urlToObject(z):v.clone(z)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/rest/geometryService/simplify":function(){define("exports ../../request ../../core/urlUtils ../../geometry/support/jsonUtils ../../geometry/support/spatialReferenceUtils ./utils".split(" "),function(a,c,w,v,I,n){a.simplify=async function(g,z,d){const m="string"===typeof g?w.urlToObject(g):g;g=z[0].spatialReference;const x=v.getJsonType(z[0]);z={...d,query:{...m.query,f:"json",sr:I.srToRESTValue(g),geometries:JSON.stringify(n.encodeGeometries(z))}};({data:z}=await c(m.path+"/simplify",z));return n.decodeGeometries(z.geometries,
x,g)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/geometryService/utils":function(){define(["exports","../../geometry/support/jsonUtils"],function(a,c){a.decodeGeometries=function(w,v,I){const n=c.getGeometryType(v);return w.map(g=>{g=n.fromJSON(g);g.spatialReference=I;return g})};a.encodeGeometries=function(w){return{geometryType:c.getJsonType(w[0]),geometries:w.map(v=>v.toJSON())}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/attributeSupport":function(){define(["exports",
"../../../core/Error","../../../core/sql/WhereClauseCache","../../support/fieldType"],function(a,c,w,v){function I(E,p,f={}){const b=n(p,E);if(!b)throw f=m.getError(p,E),new c("unsupported-query","invalid SQL expression",{expression:p,error:f});E=f.expressionName||"expression";if(f.validateStandardized&&!b.isStandardized)throw new c("unsupported-query",`${E} is not standard`,{expression:p});if(f.validateAggregate&&!b.isAggregate)throw new c("unsupported-query",`${E} does not contain a valid aggregate function`,
{expression:p});return b.fieldNames}function n(E,p){return E?m.get(E,p):null}function g(E){return/\((.*?)\)/.test(E)?E:E.split(" as ")[0]}function z(E,p,f,b={}){const q=new Map;var A=b.allowedFieldTypes??B;for(const F of f)if("*"!==F)if(E.get(F))d(q,E,p,A,F);else try{const L=g(F),h=I(E,L,{validateStandardized:!0});for(const H of h)d(q,E,p,A,H)}catch(L){q.set(F,{type:"expression-error",expression:F,error:L})}if(q.size)throw new c("unsupported-query",`${b.expressionName??"expression"} contains invalid or missing fields`,
{errors:Array.from(q.values()),query:b.query});}function d(E,p,f,b,q){"*"!==q&&((p=p.get(q))?f.has(p.name)?!1===b?.has(p.type)&&E.set(q,{type:"invalid-type",fieldName:p.name,fieldType:v.kebabDict.fromJSON(p.type),allowedFieldTypes:Array.from(b,A=>v.kebabDict.fromJSON(A))}):E.set(q,{type:"missing-field",fieldName:p.name}):E.set(q,{type:"invalid-field",fieldName:q}))}const m=new w.WhereClauseCache(50,500);w=new Set("esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeBigInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong".split(" "));
const x=new Set(["esriFieldTypeDate","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]),B=new Set(["esriFieldTypeString","esriFieldTypeGUID","esriFieldTypeGlobalID",...w,...x]);a.allDateAndTimeFieldTypes=x;a.getAliasFromFieldName=function(E){return E.split(" as ")[1]};a.getExpressionFromFieldName=g;a.getWhereClause=n;a.numericFieldTypes=w;a.validateFields=z;a.validateHaving=function(E,p,f,b,q){if(!f)return!0;const A=I(E,f,{validateAggregate:!0,expressionName:"having clause"});
z(E,p,A,{expressionName:"having clause",query:q});if(!n(f,E)?.getExpressions().every(F=>{const {aggregateType:L,field:h}=F,H=E.get(h)?.name;return b.some(S=>{const {onStatisticField:C,statisticType:k}=S;return E.get(C)?.name===H&&k.toLowerCase().trim()===L})}))throw new c("unsupported-query","expressions in having clause should also exist in outStatistics",{having:f});return!0};a.validateWhere=function(E,p,f,b){if(!f)return!0;f=I(E,f,{validateStandardized:!0,expressionName:"where clause"});z(E,p,
f,{expressionName:"where clause",query:b});return!0};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/WhereClauseCache":function(){define(["exports","../LRUCache","./WhereClause"],function(a,c,w){class v{constructor(I,n){this._cache=new c.LRUCache(I);this._invalidCache=new c.LRUCache(n)}get(I,n){const g=`${n.uid}:${I}`,z=this._cache.get(g);if(z)return z;if(null!=this._invalidCache.get(g))return null;try{const d=w.WhereClause.create(I,n);this._cache.put(g,d);return d}catch(d){return this._invalidCache.put(g,
d),null}}getError(I,n){return this._invalidCache.get(`${n.uid}:${I}`)??null}}a.WhereClauseCache=v;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/LRUCache":function(){define(["exports","./MemCache"],function(a,c){class w{constructor(v,I){this._storage=new c.MemCacheStorage;this.name=this.id="";this.size=0;this._storage.maxSize=v;this._storage.register(this);I&&this._storage.registerRemoveFunc("",I)}destroy(){this._storage.deregister(this);this._storage.destroy()}put(v,I,
n=1){this._storage.put(this,v,I,n,1)}pop(v){return this._storage.pop(this,v)}get(v){return this._storage.get(this,v)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(v){this._storage.maxSize=v}resetHitRate(){}}a.LRUCache=w;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/WhereClause":function(){define("exports ../../arcade/ArcadeDate ../../arcade/featureset/support/errorsupport ../has ./AggregateFunctions ./DateOnly ./sqlArithmeticUtils ./sqlCompareUtils ./sqlDateParsingUtils ./SqlInterval ./SqlTimestampOffset ./StandardizedFunctions ./TimeOnly ./WhereGrammar ../../chunks/datetime".split(" "),
function(a,c,w,v,I,n,g,z,d,m,x,B,E,p,f){function b(l){return Array.isArray(l)?l:[l]}function q(l){return null!==l?!0!==l:null}function A(l,O){return null!=l&&null!=O?!0===l&&!0===O:!1===l||!1===O?!1:null}function F(l,O){return null!=l&&null!=O?!0===l||!0===O:!0===l||!0===O?!0:null}function L(l,O){if(null==l)return null;let u=!1;for(const D of O)if(null==D)u=null;else if(l===D){u=!0;break}return u}function h(l,O,u){if(null==l)return null;let D="",R=y.Normal;for(let Q=0;Q<O.length;Q++){const U=O.charAt(Q);
switch(R){case y.Normal:U===u?R=y.Escaped:D="-[]/{}()*+?.\\^$|".includes(U)?D+("\\"+U):"%"===U?D+".*":"_"===U?D+".":D+U;break;case y.Escaped:D="-[]/{}()*+?.\\^$|".includes(U)?D+("\\"+U):D+U,R=y.Normal}}return(new RegExp("^"+D+"$","m")).test(l)}function H(l,O,u,D){l=D.getAttribute(l,O);O=u?.get(O);return null==l||"esriFieldTypeDate"!==O?.type&&"date"!==O?.type?null==l||"esriFieldTypeDateOnly"!==O?.type&&"date-only"!==O?.type?null==l||"esriFieldTypeTimeOnly"!==O?.type&&"time-only"!==O?.type?null==l||
"esriFieldTypeTimestampOffset"!==O?.type&&"timestamp-offset"!==O?.type?l:new x.SqlTimeStampOffset(l):E.TimeOnly.fromReader(l):n.DateOnly.fromReader(l):d.convertToExecutingTimeZone(new Date(l),u?.getLuxonTimeZone(O.name)??f.FixedOffsetZone.utcInstance)}const S=new Set(["current_timestamp","current_date","current_time"]);class C{static makeBool(l){return!0===l}static featureValue(l,O,u,D){return H(l,O,u,D)}static equalsNull(l){return null===l}static applyLike(l,O,u){return h(l,O,u)}static ensureArray(l){return b(l)}static applyIn(l,
O){return L(l,O)}static currentDate(l){return n.DateOnly.fromNow(l)}static makeSqlInterval(l,O,u){return m.SqlInterval.createFromValueAndQualifer(l,O,u)}static convertInterval(l){return l instanceof m.SqlInterval?l.valueInMilliseconds():l}static currentTimestamp(l){return d.convertToExecutingTimeZone(new Date,l)}static compare(l,O,u,D){return z.sqlCompare(O,u,l)}static calculate(l,O,u,D){return g.sqlCalculateFunction(l,O,u,D)}static evaluateTime(l){return d.parseTime(l)}static evaluateTimestamp(l,
O,u){return d.parseTimestamp(l,O,u)}static evaluateDate(l,O){return d.parseDate(l,O)}static evaluateFunction(l,O,u){return B.evaluateFunction(l,O,u)}static lookup(l,O){l=O[l];return void 0===l?null:l}static between(l,O,u){return null==l||null==O[0]||null==O[1]?null:z.sqlCompare(l,O[0],"\x3e\x3d")&&z.sqlCompare(l,O[1],"\x3c\x3d")}static notbetween(l,O,u){return null==l||null==O[0]||null==O[1]?null:z.sqlCompare(l,O[0],"\x3c")||z.sqlCompare(l,O[1],"\x3e")}static ternaryNot(l){return q(l)}static ternaryAnd(l,
O){return A(l,O)}static ternaryOr(l,O){return F(l,O)}}class k{constructor(l,O,u="UTC"){this.fieldsIndex=O;this.timeZone=u;this.parameters={};this._hasDateFunctions=void 0;this.parseTree=p.WhereGrammar.parse(l);const {isStandardized:D,isAggregate:R,referencedFieldNames:Q}=this._extractExpressionInfo(O);this._referencedFieldNames=Q;this.isStandardized=D;this.isAggregate=R}static convertValueToStorageFormat(l,O=null){if(null===O)return d.isDate(l)?l.getTime():d.isDateTime(l)?l.toMillis():d.isTimestampOffset(l)?
l.toStorageFormat():d.isTimeOnly(l)?l.toStorageString():d.isDateOnly(l)?l.toStorageFormat():l;switch(O){case "date":if(d.isDate(l))return l.getTime();if(d.isDateTime(l))return l.toMillis();if(d.isTimestampOffset(l))return l.toMilliseconds();if(d.isDateOnly(l))return l.toNumber();break;case "date-only":if(d.isDate(l))return n.DateOnly.fromDateJS(l).toString();if(d.isTimestampOffset(l))return n.DateOnly.fromSqlTimeStampOffset(l).toString();if(d.isDateTime(l))return n.DateOnly.fromDateTime(l).toString();
break;case "time-only":if(d.isDate(l))return E.TimeOnly.fromDateJS(l).toStorageString();if(d.isDateTime(l))return E.TimeOnly.fromDateTime(l).toStorageString();if(d.isTimestampOffset(l))return E.TimeOnly.fromSqlTimeStampOffset(l).toStorageString();if(d.isTimeOnly(l))return l.toStorageString();break;case "timestamp-offset":if(d.isDate(l))return x.SqlTimeStampOffset.fromJSDate(l).toStorageFormat();if(d.isDateTime(l))return x.SqlTimeStampOffset.fromDateTime(l).toStorageFormat();if(d.isTimestampOffset(l))return l.toStorageFormat()}return l}static create(l,
O,u="UTC"){return new k(l,O,u)}get fieldNames(){return this._referencedFieldNames}testSet(l,O=N){return!!this._evaluateNode(this.parseTree,null,O,l)}calculateValue(l,O=N){l=this._evaluateNode(this.parseTree,l,O,null);return l instanceof m.SqlInterval?l.valueInMilliseconds()/864E5:l}calculateValueCompiled(l,O=N){if(null!=this.parseTree._compiledVersion)return this.parseTree._compiledVersion(l,this.parameters,O,this.fieldsIndex,this.timeZone);if(v("esri-csp-restrictions"))return this.calculateValue(l,
O);this._compileMe();return this.parseTree._compiledVersion(l,this.parameters,O,this.fieldsIndex,this.timeZone)}testFeature(l,O=N){return!!this._evaluateNode(this.parseTree,l,O,null)}testFeatureCompiled(l,O=N){if(null!=this.parseTree._compiledVersion)return!!this.parseTree._compiledVersion(l,this.parameters,O,this.fieldsIndex,this.timeZone);if(v("esri-csp-restrictions"))return this.testFeature(l,O);this._compileMe();return!!this.parseTree._compiledVersion(l,this.parameters,O,this.fieldsIndex,this.timeZone)}get hasDateFunctions(){if(null!=
this._hasDateFunctions)return this._hasDateFunctions;this._hasDateFunctions=!1;this._visitAll(this.parseTree,l=>{"current-time"===l.type?this._hasDateFunctions=!0:"function"===l.type&&(this._hasDateFunctions=this._hasDateFunctions||S.has(l.name.toLowerCase()))});return this._hasDateFunctions}getFunctions(){const l=new Set;this._visitAll(this.parseTree,O=>{"function"===O.type&&l.add(O.name.toLowerCase())});return Array.from(l)}getExpressions(){const l=new Map;this._visitAll(this.parseTree,O=>{if("function"===
O.type){const u=O.name.toLowerCase();O=O.args.value[0];if("column-reference"===O.type){O=O.column;const D=`${u}-${O}`;l.has(D)||l.set(D,{aggregateType:u,field:O})}}});return[...l.values()]}getVariables(){const l=new Set;this._visitAll(this.parseTree,O=>{"parameter"===O.type&&l.add(O.value.toLowerCase())});return Array.from(l)}_compileMe(){const l="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=(new Function("feature","lookups","attributeAdapter",
"fieldsIndex","timeZone",l)).bind(C)}_extractExpressionInfo(l){const O=[],u=new Set;let D=!0,R=!1;this._visitAll(this.parseTree,Q=>{switch(Q.type){case "column-reference":var U=l?.get(Q.column);let Z;U?U=Z=U.name??"":(Z=Q.column,U=Z.toLowerCase());u.has(U)||(u.add(U),O.push(Z));Q.column=Z;break;case "function":const {name:ea,args:la}=Q;Q=la.value.length;D&&(D=B.isStandardized(ea,Q));!1===R&&(R=I.isAggregate(ea,Q))}});return{referencedFieldNames:Array.from(O),isStandardized:D,isAggregate:R}}_visitAll(l,
O){if(null!=l)switch(O(l),l.type){case "when-clause":this._visitAll(l.operand,O);this._visitAll(l.value,O);break;case "case-expression":for(const u of l.clauses)this._visitAll(u,O);"simple"===l.format&&this._visitAll(l.operand,O);null!==l.else&&this._visitAll(l.else,O);break;case "expression-list":for(const u of l.value)this._visitAll(u,O);break;case "unary-expression":this._visitAll(l.expr,O);break;case "binary-expression":this._visitAll(l.left,O);this._visitAll(l.right,O);break;case "function":this._visitAll(l.args,
O)}}evaluateNodeToJavaScript(l){switch(l.type){case "interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(l.value)+", "+JSON.stringify(l.qualifier)+","+JSON.stringify(l.op)+")";case "case-expression":var O="";if("simple"===l.format){var u=this.evaluateNodeToJavaScript(l.operand);O="( ";for(let D=0;D<l.clauses.length;D++)O+=" (this.compare('\x3d',"+u+","+this.evaluateNodeToJavaScript(l.clauses[D].operand)+") ? ("+this.evaluateNodeToJavaScript(l.clauses[D].value)+") : "}else for(O=
"( ",u=0;u<l.clauses.length;u++)O+=" this.makeBool("+this.evaluateNodeToJavaScript(l.clauses[u].operand)+")\x3d\x3d\x3dtrue ? ("+this.evaluateNodeToJavaScript(l.clauses[u].value)+") : ";O=null!==l.else?O+this.evaluateNodeToJavaScript(l.else):O+"null";return O+" )";case "parameter":return"this.lookup("+JSON.stringify(l.value.toLowerCase())+",lookups)";case "expression-list":O="[";for(u of l.value)"["!==O&&(O+=","),O+=this.evaluateNodeToJavaScript(u);return O+"]";case "unary-expression":return"this.ternaryNot("+
this.evaluateNodeToJavaScript(l.expr)+")";case "binary-expression":switch(l.operator){case "AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(l.left)+","+this.evaluateNodeToJavaScript(l.right)+" )";case "OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(l.left)+","+this.evaluateNodeToJavaScript(l.right)+" )";case "IS":if("null"!==l.right.type)throw new w.SqlError(w.SqlErrorCodes.UnsupportedIsRhs);return"this.equalsNull("+this.evaluateNodeToJavaScript(l.left)+")";case "ISNOT":if("null"!==
l.right.type)throw new w.SqlError(w.SqlErrorCodes.UnsupportedIsRhs);return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(l.left)+")))";case "IN":return"this.applyIn("+this.evaluateNodeToJavaScript(l.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(l.right)+"))";case "NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(l.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(l.right)+")))";case "BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(l.left)+
","+this.evaluateNodeToJavaScript(l.right)+", timeZone)";case "NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(l.left)+","+this.evaluateNodeToJavaScript(l.right)+", timeZone)";case "LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(l.left)+","+this.evaluateNodeToJavaScript(l.right)+","+JSON.stringify(l.escape)+")";case "NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(l.left)+","+this.evaluateNodeToJavaScript(l.right)+","+JSON.stringify(l.escape)+
"))";case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return"this.compare("+JSON.stringify(l.operator)+","+this.evaluateNodeToJavaScript(l.left)+","+this.evaluateNodeToJavaScript(l.right)+", timeZone)";case "*":case "-":case "+":case "/":case "||":return"this.calculate("+JSON.stringify(l.operator)+","+this.evaluateNodeToJavaScript(l.left)+","+this.evaluateNodeToJavaScript(l.right)+", timeZone)"}throw new w.SqlError(w.SqlErrorCodes.UnsupportedOperator,{operator:l.operator});
case "null":case "boolean":case "string":case "number":return JSON.stringify(l.value);case "time":return"this.evaluateTime(JSON.stringify(node.value))";case "date":return"this.evaluateDate(JSON.stringify(node.value), 'unknown')";case "timestamp":return"this.evaluateTimestamp(JSON.stringify(node.value), 'unknown')";case "current-time":return"date"===l.mode?"this.currentDate(timeZone)":"this.currentTimestamp(timeZone)";case "column-reference":return"this.featureValue(feature,"+JSON.stringify(l.column)+
",fieldsIndex,attributeAdapter)";case "function":return"this.evaluateFunction("+JSON.stringify(l.name)+","+this.evaluateNodeToJavaScript(l.args)+", timeZone)"}throw new w.SqlError(w.SqlErrorCodes.UnsupportedSyntax,{node:l.type});}_evaluateNode(l,O,u,D){switch(l.type){case "interval":return u=this._evaluateNode(l.value,O,u,D),m.SqlInterval.createFromValueAndQualifer(u,l.qualifier,l.op);case "case-expression":if("simple"===l.format){var R=this._evaluateNode(l.operand,O,u,D);for(var Q=0;Q<l.clauses.length;Q++)if(z.sqlCompare(R,
this._evaluateNode(l.clauses[Q].operand,O,u,D),"\x3d",this.timeZone))return this._evaluateNode(l.clauses[Q].value,O,u,D)}else for(R=0;R<l.clauses.length;R++)if(!0===this._evaluateNode(l.clauses[R].operand,O,u,D))return this._evaluateNode(l.clauses[R].value,O,u,D);return null!==l.else?this._evaluateNode(l.else,O,u,D):null;case "parameter":return l=this.parameters[l.value.toLowerCase()],d.isDate(l)?f.DateTime.fromJSDate(l):l instanceof c.ArcadeDate?l.toDateTime():l;case "expression-list":R=[];for(var U of l.value)R.push(this._evaluateNode(U,
O,u,D));return R;case "unary-expression":return q(this._evaluateNode(l.expr,O,u,D));case "binary-expression":switch(l.operator){case "AND":return A(this._evaluateNode(l.left,O,u,D),this._evaluateNode(l.right,O,u,D));case "OR":return F(this._evaluateNode(l.left,O,u,D),this._evaluateNode(l.right,O,u,D));case "IS":if("null"!==l.right.type)throw new w.SqlError(w.SqlErrorCodes.UnsupportedIsRhs);return null===this._evaluateNode(l.left,O,u,D);case "ISNOT":if("null"!==l.right.type)throw new w.SqlError(w.SqlErrorCodes.UnsupportedIsRhs);
return null!==this._evaluateNode(l.left,O,u,D);case "IN":return R=b(this._evaluateNode(l.right,O,u,D)),L(this._evaluateNode(l.left,O,u,D),R);case "NOT IN":return R=b(this._evaluateNode(l.right,O,u,D)),q(L(this._evaluateNode(l.left,O,u,D),R));case "BETWEEN":return R=this._evaluateNode(l.left,O,u,D),l=this._evaluateNode(l.right,O,u,D),null==R||null==l[0]||null==l[1]?null:z.sqlCompare(R,l[0],"\x3e\x3d",this.timeZone)&&z.sqlCompare(R,l[1],"\x3c\x3d",this.timeZone);case "NOTBETWEEN":return R=this._evaluateNode(l.left,
O,u,D),l=this._evaluateNode(l.right,O,u,D),null==R||null==l[0]||null==l[1]?null:z.sqlCompare(R,l[0],"\x3c",this.timeZone)||z.sqlCompare(R,l[1],"\x3e",this.timeZone);case "LIKE":return h(this._evaluateNode(l.left,O,u,D),this._evaluateNode(l.right,O,u,D),l.escape);case "NOT LIKE":return q(h(this._evaluateNode(l.left,O,u,D),this._evaluateNode(l.right,O,u,D),l.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return z.sqlCompare(this._evaluateNode(l.left,O,u,
D),this._evaluateNode(l.right,O,u,D),l.operator,this.timeZone);case "-":case "+":case "*":case "/":case "||":return g.sqlCalculateFunction(l.operator,this._evaluateNode(l.left,O,u,D),this._evaluateNode(l.right,O,u,D),this.timeZone)}case "null":case "boolean":case "string":case "number":return l.value;case "date":return l.parsedValue??(l.parsedValue=d.parseDate(l.value,"unknown")),l.parsedValue;case "timestamp":return l.parsedValue??(l.parsedValue=d.parseTimestamp(l.value,"unknown")),l.parsedValue;
case "time":return d.parseTime(l.value);case "current-time":return"date"===l.mode?n.DateOnly.fromNow(this.timeZone):d.convertToExecutingTimeZone(new Date,this.timeZone);case "column-reference":return H(O,l.column,this.fieldsIndex,u);case "data-type":return l.value;case "function":if(this.isAggregate&&I.isAggregate(l.name,l.args.value.length)){O=[];for(R of l.args?.value||[]){U=[];for(Q of D||[])U.push(this._evaluateNode(R,Q,u,null));O.push(U)}return I.aggregateFunction(l.name,O)}u=this._evaluateNode(l.args,
O,u,D);return B.evaluateFunction(l.name,u,this.timeZone)}throw new w.SqlError(w.SqlErrorCodes.UnsupportedSyntax,{node:l.type});}}var y;(function(l){l[l.Normal=0]="Normal";l[l.Escaped=1]="Escaped"})(y||(y={}));const N={getAttribute(l,O){return(l&&"object"===typeof l.attributes?l.attributes:l)[O]}};a.WhereClause=k;a.defaultAttributeAdapter=N;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/ArcadeDate":function(){define(["exports","../core/string","../core/sql/UnknownTimeZone",
"../chunks/datetime"],function(a,c,w,v){function I(m,x,B){return m<x?m-x:m>B?m-B:0}function n(m,x=!0){if(m instanceof v.Zone)return m;if("system"===m.toLowerCase())return"system";if("utc"===m.toLowerCase())return"UTC";if("unknown"===m.toLowerCase())return w.UnknownTimeZone.instance;if(/^[\+\-]?[0-9]{1,2}([:][0-9]{2})?$/.test(m)){const B=v.FixedOffsetZone.parseSpecifier("UTC"+(m.startsWith("+")||m.startsWith("-")?"":"+")+m);if(B)return B}m=v.IANAZone.create(m);if(!m.isValid){if(x)throw new z(a.ArcadeDateErrorCodes.TimeZoneNotRecognized);
return null}return m}a.ArcadeDateErrorCodes=void 0;(a.ArcadeDateErrorCodes||(a.ArcadeDateErrorCodes={})).TimeZoneNotRecognized="TimeZoneNotRecognized";const g={[a.ArcadeDateErrorCodes.TimeZoneNotRecognized]:"Timezone identifier has not been recognized."};class z extends Error{constructor(m,x){super(c.replace(g[m],x));this.declaredRootClass="esri.arcade.arcadedate.dateerror";Error.captureStackTrace&&Error.captureStackTrace(this,z)}}class d{constructor(m){this._date=m;this.declaredRootClass="esri.arcade.arcadedate"}static fromParts(m=
0,x=1,B=1,E=0,p=0,f=0,b=0,q){if(isNaN(m)||isNaN(x)||isNaN(B)||isNaN(E)||isNaN(p)||isNaN(f)||isNaN(b))return null;const A=v.DateTime.local(m,x).daysInMonth;m=v.DateTime.fromObject({day:1>B?1:B>A?A:B,year:m,month:1>x?1:12<x?12:x,hour:0>E?0:23<E?23:E,minute:0>p?0:59<p?59:p,second:0>f?0:59<f?59:f,millisecond:0>b?0:999<b?999:b},{zone:n(q)});m=m.plus({months:I(x,1,12),days:I(B,1,A),hours:I(E,0,23),minutes:I(p,0,59),seconds:I(f,0,59),milliseconds:I(b,0,999)});return new d(m)}static get systemTimeZoneCanonicalName(){return Intl.DateTimeFormat().resolvedOptions().timeZone??
"system"}static arcadeDateAndZoneToArcadeDate(m,x){x=n(x);return m.isUnknownTimeZone||x===w.UnknownTimeZone.instance?d.fromParts(m.year,m.monthJS+1,m.day,m.hour,m.minute,m.second,m.millisecond,x):new d(m._date.setZone(x))}static dateJSToArcadeDate(m){return new d(v.DateTime.fromJSDate(m,{zone:"system"}))}static dateJSAndZoneToArcadeDate(m,x="system"){x=n(x);return new d(v.DateTime.fromJSDate(m,{zone:x}))}static unknownEpochToArcadeDate(m){return new d(v.DateTime.fromMillis(m,{zone:w.UnknownTimeZone.instance}))}static unknownDateJSToArcadeDate(m){return new d(v.DateTime.fromMillis(m.getTime(),
{zone:w.UnknownTimeZone.instance}))}static epochToArcadeDate(m,x="system"){x=n(x);return new d(v.DateTime.fromMillis(m,{zone:x}))}static dateTimeToArcadeDate(m){return new d(m)}clone(){return new d(this._date)}changeTimeZone(m){m=n(m);return d.dateTimeToArcadeDate(this._date.setZone(m))}static dateTimeAndZoneToArcadeDate(m,x){x=n(x);return m.zone===w.UnknownTimeZone.instance||x===w.UnknownTimeZone.instance?d.fromParts(m.year,m.month,m.day,m.hour,m.minute,m.second,m.millisecond,x):new d(m.setZone(x))}static nowToArcadeDate(m){m=
n(m);return new d(v.DateTime.fromJSDate(new Date,{zone:m}))}static nowUTCToArcadeDate(){return new d(v.DateTime.utc())}get isSystem(){return"system"===this.timeZone||this.timeZone===d.systemTimeZoneCanonicalName}equals(m){return this.isSystem&&m.isSystem?this.toNumber()===m.toNumber():this.isUnknownTimeZone!==m.isUnknownTimeZone?!1:this._date.equals(m._date)}get isUnknownTimeZone(){return this._date.zone===w.UnknownTimeZone.instance}get isValid(){return this._date.isValid}get hour(){return this._date.hour}get second(){return this._date.second}get day(){return this._date.day}get dayOfWeekISO(){return this._date.weekday}get dayOfWeekJS(){let m=
this._date.weekday;6<m&&(m=0);return m}get millisecond(){return this._date.millisecond}get monthISO(){return this._date.month}get weekISO(){return this._date.weekNumber}get yearISO(){return this._date.weekYear}get monthJS(){return this._date.month-1}get year(){return this._date.year}get minute(){return this._date.minute}get zone(){return this._date.zone}get timeZoneOffset(){return this.isUnknownTimeZone?0:this._date.offset}get timeZone(){if(this.isUnknownTimeZone)return"unknown";if("system"===this._date.zone.type)return"system";
const m=this.zone;return"fixed"===m.type?0===m.fixed?"UTC":m.formatOffset(0,"short"):m.name}stringify(){return JSON.stringify(this.toJSDate())}plus(m){return new d(this._date.plus(m))}diff(m,x="milliseconds"){return this._date.diff(m._date,x)[x]}toISODate(){return this._date.toISODate()}toISOString(m){return m?this._date.toISO({suppressMilliseconds:!0,includeOffset:!this.isUnknownTimeZone}):this._date.toISO({includeOffset:!this.isUnknownTimeZone})}toISOTime(m,x){return this._date.toISOTime({suppressMilliseconds:m,
includeOffset:x&&!this.isUnknownTimeZone})}toFormat(m,x){this.isUnknownTimeZone&&(m=m.replaceAll("Z",""));return this._date.toFormat(m,x)}toJSDate(){return this._date.toJSDate()}toSQLValue(){return this._date.toFormat("yyyy-LL-dd HH:mm:ss")}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}toDateTime(){return this._date}toNumber(){return this._date.toMillis()}getTime(){return this._date.toMillis()}toUTC(){return new d(this._date.toUTC())}toLocal(){return new d(this._date.toLocal())}toString(){return this.toISOString(!0)}static fromReaderAsTimeStampOffset(m){if(!m)return null;
m=v.DateTime.fromISO(m,{setZone:!0});return new d(m)}}a.ArcadeDate=d;a.ArcadeDateError=z;a.ArcadeDateErrorMessages=g;a.createDateTimeZone=n;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/UnknownTimeZone":function(){define(["exports","../../chunks/datetime"],function(a,c){function w(I){return I instanceof c.Zone?I===v.instance?!0:!1:"unknown"===I?.toString().toLowerCase()?!0:!1}class v{}v.instance=new c.IANAZone("Etc/UTC");a.UnknownTimeZone=v;a.adoptTimeZone=function(I,
n){return c.DateTime.fromObject({day:I.day,year:I.year,month:I.month,hour:I.hour,minute:I.minute,second:I.second,millisecond:I.millisecond},{zone:n})};a.isUnknownTimeZone=w;a.substituteUnknownTimezone=function(I){return w(I)?v.instance:I};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/featureset/support/errorsupport":function(){define(["exports","../../../core/string"],function(a,c){a.SqlErrorCodes=void 0;(function(g){g.InvalidFunctionParameters="InvalidFunctionParameters";
g.InvalidValueForAggregateFunction="InvalidValueForAggregateFunction";g.UnsupportedSqlFunction="UnsupportedSqlFunction";g.UnsupportedOperator="UnsupportedOperator";g.UnsupportedSyntax="UnsupportedSyntax";g.UnsupportedIsRhs="UnsupportedIsRhs";g.UnsupportedIsLhs="UnsupportedIsLhs";g.InvalidDataType="InvalidDataType";g.CannotCastValue="CannotCastValue";g.FunctionNotRecognized="FunctionNotRecognized";g.InvalidTime="InvalidTime";g.InvalidParameterCount="InvalidParameterCount";g.InvalidTimeStamp="InvalidTimeStamp";
g.InvalidDate="InvalidDate";g.InvalidOperator="InvalidOperator";g.IllegalInterval="IllegalInterval";g.YearMonthIntervals="YearMonthIntervals";g.PrimarySecondaryQualifiers="PrimarySecondaryQualifiers";g.MissingStatisticParameters="MissingStatisticParameters"})(a.SqlErrorCodes||(a.SqlErrorCodes={}));const w={[a.SqlErrorCodes.InvalidValueForAggregateFunction]:"Invalid value used in aggregate function",[a.SqlErrorCodes.MissingStatisticParameters]:"Statistic does not have 1 or 0 Parameters",[a.SqlErrorCodes.InvalidFunctionParameters]:"Invalid parameters for call to {function}",
[a.SqlErrorCodes.UnsupportedIsLhs]:"Unsupported left hand expression in is statement",[a.SqlErrorCodes.UnsupportedIsRhs]:"Unsupported right hand expression in is statement",[a.SqlErrorCodes.UnsupportedOperator]:"Unsupported operator - {operator}",[a.SqlErrorCodes.UnsupportedSyntax]:"Unsupported syntax - {node}",[a.SqlErrorCodes.UnsupportedSqlFunction]:"Sql function not found \x3d {function}",[a.SqlErrorCodes.InvalidDataType]:"Invalid sql data type",[a.SqlErrorCodes.InvalidDate]:"Invalid date encountered",
[a.SqlErrorCodes.InvalidOperator]:"Invalid operator encountered",[a.SqlErrorCodes.InvalidTime]:"Invalid time encountered",[a.SqlErrorCodes.IllegalInterval]:"Illegal interval",[a.SqlErrorCodes.FunctionNotRecognized]:"Function not recognized",[a.SqlErrorCodes.InvalidTimeStamp]:"Invalid timestamp encountered",[a.SqlErrorCodes.InvalidParameterCount]:"Invalid parameter count for call to {name}",[a.SqlErrorCodes.PrimarySecondaryQualifiers]:"Primary and Secondary SqlInterval qualifiers not supported",[a.SqlErrorCodes.YearMonthIntervals]:"Year-Month Intervals not supported",
[a.SqlErrorCodes.CannotCastValue]:"Cannot cast value to the required data type"};class v extends Error{constructor(g,z){super(c.replace(w[g],z));this.declaredRootClass="esri.arcade.featureset.support.sqlerror";Error.captureStackTrace&&Error.captureStackTrace(this,v)}}a.FeatureSetErrorCodes=void 0;(function(g){g.NeverReach="NeverReach";g.NotImplemented="NotImplemented";g.Cancelled="Cancelled";g.InvalidStatResponse="InvalidStatResponse";g.InvalidRequest="InvalidRequest";g.RequestFailed="RequestFailed";
g.MissingFeatures="MissingFeatures";g.AggregationFieldNotFound="AggregationFieldNotFound";g.DataElementsNotFound="DataElementsNotFound"})(a.FeatureSetErrorCodes||(a.FeatureSetErrorCodes={}));const I={[a.FeatureSetErrorCodes.Cancelled]:"Cancelled",[a.FeatureSetErrorCodes.InvalidStatResponse]:"Invalid statistics response from service",[a.FeatureSetErrorCodes.InvalidRequest]:"Invalid request",[a.FeatureSetErrorCodes.RequestFailed]:"Request failed - {reason}",[a.FeatureSetErrorCodes.MissingFeatures]:"Missing features",
[a.FeatureSetErrorCodes.AggregationFieldNotFound]:"Aggregation field not found",[a.FeatureSetErrorCodes.DataElementsNotFound]:"Data elements not found on service",[a.FeatureSetErrorCodes.NeverReach]:"Encountered unreachable logic",[a.FeatureSetErrorCodes.NotImplemented]:"Not implemented"};class n extends Error{constructor(g,z){super(c.replace(I[g],z));this.declaredRootClass="esri.arcade.featureset.support.featureseterror";Error.captureStackTrace&&Error.captureStackTrace(this,n)}}a.FeatureSetError=
n;a.FeatureSetErrorMessages=I;a.SqlError=v;a.SqlErrorMessages=w;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/AggregateFunctions":function(){define("exports ../../arcade/featureset/support/errorsupport ./DateOnly ./SqlTimestampOffset ./TimeOnly ../../chunks/datetime".split(" "),function(a,c,w,v,I,n){function g(x){if(null===x)return null;let B=0,E=0;for(let p=0;p<x.length;p++){const f=x[p];if(null!==f){if("number"!==typeof f)throw new c.SqlError(c.SqlErrorCodes.InvalidValueForAggregateFunction);
E++;B+=f}}return 0===E?null:B/x.length}function z(x,B){if(null===x)return null;let E=null,p=null;for(const f of x)x=f,x=f instanceof w.DateOnly?f.toNumber():f instanceof I.TimeOnly?f.toNumber():f instanceof n.DateTime?f.toMillis():f instanceof v.SqlTimeStampOffset?f.toMilliseconds():f,null===E?(E=f,p=x):"max"===B&&null!==p&&null!==x&&p<=x?(E=f,p=x):"min"===B&&null!==p&&null!==x&&p>=x&&(E=f,p=x);return E}function d(x){if(null===x)return null;x=x.filter(p=>null!==p);if(0===x.length)return null;const B=
g(x);if(null===B)return null;let E=0;for(const p of x){if("number"!==typeof p)throw new c.SqlError(c.SqlErrorCodes.InvalidValueForAggregateFunction);E+=(B-p)**2}return E/(x.length-1)}const m={min:{minParams:1,maxParams:1,evaluate:x=>z(x[0],"min")},max:{minParams:1,maxParams:1,evaluate:x=>z(x[0],"max")},avg:{minParams:1,maxParams:1,evaluate:x=>g(x[0])},sum:{minParams:1,maxParams:1,evaluate:x=>{x=x[0];if(null===x)x=null;else{var B=0;for(let E=0;E<x.length;E++){const p=x[E];if(null!==p){if("number"!==
typeof p)throw new c.SqlError(c.SqlErrorCodes.InvalidValueForAggregateFunction);B+=p}}x=B}return x}},stddev:{minParams:1,maxParams:1,evaluate:x=>{x=x[0];null===x?x=null:(x=d(x),x=null===x?null:Math.sqrt(x));return x}},count:{minParams:1,maxParams:1,evaluate:x=>null==x[0]?null:x[0].length},var:{minParams:1,maxParams:1,evaluate:x=>d(x[0])}};a.aggregateFunction=function(x,B){const E=m[x.toLowerCase()];if(null==E)throw new c.SqlError(c.SqlErrorCodes.FunctionNotRecognized);if(B.length<E.minParams||B.length>
E.maxParams)throw new c.SqlError(c.SqlErrorCodes.InvalidParameterCount,{name:x.toUpperCase()});return E.evaluate(B)};a.isAggregate=function(x,B){x=m[x.toLowerCase()];return null!=x&&B>=x.minParams&&B<=x.maxParams};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/DateOnly":function(){define(["exports","../../arcade/ArcadeDate","../../intl/locale","../../chunks/datetime"],function(a,c,w,v){function I(g){g=g.replaceAll(/LTS|LT|LL?L?L?|l{1,4}/g,"[$\x26]");let z="";const d=
/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;for(const m of g.match(d)||[])switch(m){case "D":z+="d";break;case "DD":z+="dd";break;case "DDD":z+="o";break;case "d":z+="c";break;case "ddd":z+="ccc";break;case "dddd":z+="cccc";break;case "M":z+="L";break;case "MM":z+="LL";break;case "MMM":z+="LLL";break;case "MMMM":z+="LLLL";break;case "YY":z+="yy";
break;case "Y":case "YYYY":z+="yyyy";break;case "Q":z+="q";break;case "X":case "x":z+=m;break;default:z=2<=m.length&&"["===m.slice(0,1)&&"]"===m.slice(-1)?z+`'${m.slice(1,-1)}'`:z+`'${m}'`}return z}class n{constructor(g,z,d){this._year=g;this._month=z;this._day=d;this.declaredRootClass="esri.core.sql.dateonly"}get month(){return this._month}get monthJS(){return this._month-1}get year(){return this._year}get day(){return this._day}get isValid(){return this.toDateTime("unknown").isValid}equals(g){return g instanceof
n&&g.day===this.day&&g.month===this.month&&g.year===this.year}clone(){return new n(this._year,this._month,this._day)}toDateTime(g){return v.DateTime.fromObject({day:this.day,month:this.month,year:this.year},{zone:c.createDateTimeZone(g)})}toDateTimeLuxon(g){return v.DateTime.fromObject({day:this.day,month:this.month,year:this.year},{zone:c.createDateTimeZone(g)})}toString(){return`${this.year.toString().padStart(4,"0")}-${this.month.toString().padStart(2,"0")}-${this.day.toString().padStart(2,"0")}`}toFormat(g=
null){if(null===g||""===g)return this.toString();g=I(g);if(!g)return"";const z=this.toDateTime("unknown");return c.ArcadeDate.dateTimeToArcadeDate(z).toFormat(g,{locale:w.getLocale(),numberingSystem:"latn"})}toArcadeDate(){const g=this.toDateTime("unknown");return c.ArcadeDate.dateTimeToArcadeDate(g)}toNumber(){return this.toDateTime("unknown").toMillis()}toJSDate(){return this.toDateTime("unknown").toJSDate()}toStorageFormat(){return this.toFormat("yyyy-LL-dd")}toSQLValue(){return this.toFormat("yyyy-LL-dd")}toSQLWithKeyword(){return"date '"+
this.toFormat("yyyy-LL-dd")+"'"}plus(g,z){return n.fromDateTime(this.toUTCDateTime().plus({[g]:z}))}toUTCDateTime(){return v.DateTime.utc(this.year,this.month,this.day,0,0,0,0)}difference(g,z){switch(z.toLowerCase()){case "days":case "day":case "d":return this.toUTCDateTime().diff(g.toUTCDateTime(),"days").days;case "months":case "month":return this.toUTCDateTime().diff(g.toUTCDateTime(),"months").months;case "minutes":case "minute":case "m":return"M"===z?this.toUTCDateTime().diff(g.toUTCDateTime(),
"months").months:this.toUTCDateTime().diff(g.toUTCDateTime(),"minutes").minutes;case "seconds":case "second":case "s":return this.toUTCDateTime().diff(g.toUTCDateTime(),"seconds").seconds;case "milliseconds":case "millisecond":case "ms":return this.toUTCDateTime().diff(g.toUTCDateTime(),"milliseconds").milliseconds;case "hours":case "hour":case "h":return this.toUTCDateTime().diff(g.toUTCDateTime(),"hours").hours;case "years":case "year":case "y":return this.toUTCDateTime().diff(g.toUTCDateTime(),
"years").years;default:return this.toUTCDateTime().diff(g.toUTCDateTime(),"milliseconds").milliseconds}}static fromMilliseconds(g){g=v.DateTime.fromMillis(g,{zone:v.FixedOffsetZone.utcInstance});return g.isValid?n.fromParts(g.year,g.month,g.day):null}static fromSeconds(g){g=v.DateTime.fromSeconds(g,{zone:v.FixedOffsetZone.utcInstance});return g.isValid?n.fromParts(g.year,g.month,g.day):null}static fromReader(g){if(!g)return null;g=g.split("-");return 3!==g.length?null:new n(parseInt(g[0],10),parseInt(g[1],
10),parseInt(g[2],10))}static fromParts(g,z,d){g=new n(g,z,d);return!1===g.isValid?null:g}static fromDateJS(g){return n.fromParts(g.getFullYear(),g.getMonth()+1,g.getDay())}static fromDateTime(g){return n.fromParts(g.year,g.month,g.day)}static fromSqlTimeStampOffset(g){return this.fromDateTime(g.toDateTime())}static fromString(g,z=null){if(""===g||null===g)return null;var d=[];if(z)(z=I(z))&&d.push(z);else if(null===z||""===z)return g=v.DateTime.fromISO(g,{setZone:!0}),g.isValid?n.fromParts(g.year,
g.month,g.day):null;for(const m of d)if(d=v.DateTime.fromFormat(g,z??m),d.isValid)return new n(d.year,d.month,d.day);return null}static fromNow(g="system"){g=v.DateTime.fromJSDate(new Date).setZone(c.createDateTimeZone(g));return new n(g.year,g.month,g.day)}}a.DateOnly=n;a.standardiseDateOnlyFormat=I;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/SqlTimestampOffset":function(){define(["exports","../../chunks/datetime"],function(a,c){function w(I){return Number.isNaN(I)||
0===I?I:Math.trunc(I)}class v{constructor(I){this._timeStampOffset=I;this._date=null}toDateTime(){this._date??(this._date=c.DateTime.fromISO(this._timeStampOffset,{setZone:!0}));return this._date}get isValid(){return this.toDateTime().isValid}get timezoneOffsetHour(){return w(this.toDateTime().offset/60)}get timezoneOffsetMinutes(){return w(this.toDateTime().offset%60)}toMilliseconds(){return this.toDateTime().toMillis()}get hour(){return this.toDateTime().hour}get minute(){return this.toDateTime().minute}get second(){return this.toDateTime().second}get day(){return this.toDateTime().day}get month(){return this.toDateTime().month}get year(){return this.toDateTime().year}startOfDay(){return v.fromDateTime(this.toDateTime().startOf("day"))}static fromJSDate(I){return new v(c.DateTime.fromJSDate(I).toISO({includeOffset:!0}))}static fromDateTime(I){return new v(I.toISO({includeOffset:!0}))}static fromParts(I,
n,g=0,z=0,d=0,m=0,x=0,B=!1,E=0,p=0){I=`${I.toString().padStart(4,"0")}-${n.toString().padStart(2,"0")}-${g.toString().padStart(2,"0")}`;n="";10>m&&(n="0");z=`${z.toString().padStart(2,"0")}:${d.toString().padStart(2,"0")}:${n+m.toString()}`;0!==x&&(z+="."+x.toString().padStart(3,"0"));x=`${B?"-":"+"}${E.toString().padStart(2,"0")}:${p.toString().padStart(2,"0")}`;return new v(I+"T"+z+x)}toStorageFormat(){return this._timeStampOffset}toString(){return this._timeStampOffset}toSQLValue(){let I=this.toDateTime().toSQL({includeOffset:!0,
includeOffsetSpace:!0});I&&(I=I.replace(".000",""));return I}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}addMilliseconds(I){I=this.toDateTime().plus(I);return v.fromDateTime(I)}}a.SqlTimeStampOffset=v;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/TimeOnly":function(){define(["exports","../../arcade/kernel","../../intl/locale","../../chunks/datetime"],function(a,c,w,v){function I(g){if(!g)return"";const z=/(a|A|hh?|HH?|mm?|ss?|SSS|S|.)/g;let d="";for(const m of g.match(z)||
[])switch(m){case "SSS":d+=m;break;case "A":case "a":d+="a";break;case "m":case "mm":case "h":case "hh":case "H":case "HH":case "s":case "ss":d+=m;break;default:d+=`'${m}'`}return d}class n{constructor(g,z,d,m){this._hour=g;this._minute=z;this._second=d;this._millisecond=m;this.declaredRootClass="esri.core.sql.timeonly"}get hour(){return this._hour}get minute(){return this._minute}get second(){return this._second}get millisecond(){return this._millisecond}equals(g){return g instanceof n&&g.hour===
this.hour&&g.minute===this.minute&&g.second===this.second&&g.millisecond===this.millisecond}clone(){return new n(this.hour,this.minute,this.second,this.millisecond)}isValid(){return c.isInteger(this.hour)&&c.isInteger(this.minute)&&c.isInteger(this.second)&&c.isInteger(this.millisecond)&&0<=this.hour&&24>this.hour&&0<=this.minute&&60>this.minute&&0<=this.second&&60>this.second&&0<=this.millisecond&&1E3>this.millisecond}toString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,
"0")}:${this.second.toString().padStart(2,"0")}`+(0<this.millisecond?"."+this.millisecond.toString().padStart(3,"0"):"")}toSQLValue(){return this.toString()}toSQLWithKeyword(){return`time '${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}${0<this.millisecond?"."+this.millisecond.toString().padStart(3,"0"):""}'`}toStorageString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,
"0")}`}toFormat(g=null){return null===g||""===g?this.toString():(g=I(g))?v.DateTime.local(1970,1,1,this._hour,this._minute,this._second,this._millisecond).toFormat(g,{locale:w.getLocale(),numberingSystem:"latn"}):""}toNumber(){return this.millisecond+1E3*this.second+6E4*this.minute+36E5*this.hour}static fromParts(g,z,d,m){g=new n(g,z,d,m);return g.isValid()?g:null}static fromReader(g){if(!g)return null;g=g.split(":");return 3!==g.length?null:new n(parseInt(g[0],10),parseInt(g[1],10),parseInt(g[2],
10),0)}static fromMilliseconds(g){return 864E5<g||0>g?null:new n(Math.floor(g/36E5%24),Math.floor(g/6E4%60),Math.floor(g/1E3%60),Math.floor(g%1E3))}static fromDateJS(g){return new n(g.getHours(),g.getMinutes(),g.getSeconds(),g.getMilliseconds())}static fromDateTime(g){return new n(g.hour,g.minute,g.second,g.millisecond)}static fromSqlTimeStampOffset(g){return this.fromDateTime(g.toDateTime())}static fromString(g,z=null){if(""===g||null===g)return null;const d=[];if(z)(z=I(z))&&d.push(z);else if(null===
z||""===z)d.push("HH:mm:ss"),d.push("HH:mm:ss.SSS"),d.push("hh:mm:ss a"),d.push("hh:mm:ss.SSS a"),d.push("HH:mm"),d.push("hh:mm a"),d.push("H:mm"),d.push("h:mm a"),d.push("H:mm:ss"),d.push("h:mm:ss a"),d.push("H:mm:ss.SSS"),d.push("h:mm:ss.SSS a");for(const m of d)if(z=v.DateTime.fromFormat(g,m),z.isValid)return new n(z.hour,z.minute,z.second,z.millisecond);return null}plus(g,z){switch(g){case "days":case "years":case "months":return this.clone();case "hours":case "minutes":case "seconds":case "milliseconds":return n.fromDateTime(this.toUTCDateTime().plus({[g]:z}))}return null}toUTCDateTime(){return v.DateTime.utc(1970,
1,1,this.hour,this.minute,this.second,this.millisecond)}difference(g,z){switch(z.toLowerCase()){case "days":case "day":case "d":return this.toUTCDateTime().diff(g.toUTCDateTime(),"days").days;case "months":case "month":return this.toUTCDateTime().diff(g.toUTCDateTime(),"months").months;case "minutes":case "minute":case "m":return"M"===z?this.toUTCDateTime().diff(g.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(g.toUTCDateTime(),"minutes").minutes;case "seconds":case "second":case "s":return this.toUTCDateTime().diff(g.toUTCDateTime(),
"seconds").seconds;case "milliseconds":case "millisecond":case "ms":return this.toUTCDateTime().diff(g.toUTCDateTime(),"milliseconds").milliseconds;case "hours":case "hour":case "h":return this.toUTCDateTime().diff(g.toUTCDateTime(),"hours").hours;case "years":case "year":case "y":return this.toUTCDateTime().diff(g.toUTCDateTime(),"years").years;default:return this.toUTCDateTime().diff(g.toUTCDateTime(),"milliseconds").milliseconds}}}a.TimeOnly=n;a.standardiseTimeFormat=I;Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/arcade/kernel":function(){define(["exports","../geometry/Extent"],function(a,c){a.cloneGeometry=function(w){if(null==w)return null;const v=w.clone();void 0!==w.cache._geVersion&&(v.cache._geVersion=w.cache._geVersion);return v};a.convertLinearUnitsToCode=function(w){if(null==w)return null;if("number"===typeof w)return w;w=w.toLowerCase();w=w.replaceAll(/\s/g,"");w=w.replaceAll("-","");switch(w){case "meters":case "meter":case "m":case "squaremeters":case "squaremeter":return 9001;
case "miles":case "mile":case "squaremile":case "squaremiles":return 9093;case "kilometers":case "kilometer":case "squarekilometers":case "squarekilometer":case "km":return 9036;case "yard":case "yd":case "yards":case "squareyards":case "squareyard":return 9096;case "feet":case "ft":case "foot":case "squarefeet":case "squarefoot":return 9002;case "nmi":case "nauticalmile":case "nauticalmiles":case "squarenauticalmile":case "squarenauticalmiles":return 9030}return null};a.convertSquareUnitsToCode=
function(w){if(null==w)return null;if("number"===typeof w)return w;w=w.toLowerCase();w=w.replaceAll(/\s/g,"");w=w.replaceAll("-","");switch(w){case "meters":case "meter":case "m":case "squaremeters":case "squaremeter":return 109404;case "miles":case "mile":case "squaremile":case "squaremiles":return 109439;case "kilometers":case "kilometer":case "squarekilometers":case "squarekilometer":case "km":return 109414;case "acres":case "acre":case "ac":return 109402;case "hectares":case "hectare":case "ha":return 109401;
case "yard":case "yd":case "yards":case "squareyards":case "squareyard":return 109442;case "feet":case "ft":case "foot":case "squarefeet":case "squarefoot":return 109405;case "nmi":case "nauticalmile":case "nauticalmiles":case "squarenauticalmile":case "squarenauticalmiles":return 109409}return null};a.isInteger=function(w){return"number"===typeof w&&isFinite(w)&&Math.floor(w)===w};a.sameGeomType=function(w,v){return w===v||"point"===w&&"esriGeometryPoint"===v||"polyline"===w&&"esriGeometryPolyline"===
v||"polygon"===w&&"esriGeometryPolygon"===v||"extent"===w&&"esriGeometryEnvelope"===v||"multipoint"===w&&"esriGeometryMultipoint"===v||"point"===v&&"esriGeometryPoint"===w||"polyline"===v&&"esriGeometryPolyline"===w||"polygon"===v&&"esriGeometryPolygon"===w||"extent"===v&&"esriGeometryEnvelope"===w||"multipoint"===v&&"esriGeometryMultipoint"===w?!0:!1};a.shapeExtent=function(w){if(null==w)return null;switch(w.type){case "polygon":case "multipoint":case "polyline":return w.extent;case "point":return new c({xmin:w.x,
ymin:w.y,xmax:w.x,ymax:w.y,spatialReference:w.spatialReference});case "extent":return w}return null};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/sqlArithmeticUtils":function(){define(["exports","../../arcade/featureset/support/errorsupport","./sqlDateParsingUtils","./SqlInterval","./StandardizedFunctions"],function(a,c,w,v,I){function n(G,M,P){switch(P){case "+":return G+M;case "-":return G-M;case "*":return G*M;case "/":return G/M}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);
}function g(G,M,P){switch(P){case "+":return M.plus({milliseconds:G.valueInMilliseconds()});case "-":return G.valueInMilliseconds()-M.toMillis()}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function z(G,M,P){switch(P){case "+":return M.plus("milliseconds",G.valueInMilliseconds())}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function d(G,M,P){switch(P){case "+":return M.plus("milliseconds",G.valueInMilliseconds())}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function m(G,
M,P){switch(P){case "+":return G.plus("milliseconds",M.valueInMilliseconds());case "-":return G.plus("milliseconds",-1*M.valueInMilliseconds())}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function x(G,M,P){switch(P){case "+":return M.addMilliseconds(G.valueInMilliseconds())}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function B(G,M,P){switch(P){case "+":return v.SqlInterval.createFromMilliseconds(G.valueInMilliseconds()+M.valueInMilliseconds());case "-":return v.SqlInterval.createFromMilliseconds(G.valueInMilliseconds()-
M.valueInMilliseconds());case "*":return v.SqlInterval.createFromMilliseconds(G.valueInMilliseconds()*M.valueInMilliseconds());case "/":return v.SqlInterval.createFromMilliseconds(G.valueInMilliseconds()/M.valueInMilliseconds())}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function E(G,M,P){switch(P){case "+":return v.SqlInterval.createFromMilliseconds(G.valueInMilliseconds()+M);case "-":return v.SqlInterval.createFromMilliseconds(G.valueInMilliseconds()-M);case "*":return v.SqlInterval.createFromMilliseconds(G.valueInMilliseconds()*
M);case "/":return v.SqlInterval.createFromMilliseconds(G.valueInMilliseconds()/M)}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function p(G,M,P){switch(P){case "+":return v.SqlInterval.createFromMilliseconds(G+M.valueInMilliseconds());case "-":return v.SqlInterval.createFromMilliseconds(G-M.valueInMilliseconds());case "*":return v.SqlInterval.createFromMilliseconds(G*M.valueInMilliseconds());case "/":return v.SqlInterval.createFromMilliseconds(G/M.valueInMilliseconds())}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);
}function f(G,M,P){switch(P){case "+":return G.plus("milliseconds",M.valueInMilliseconds());case "-":return G.plus("milliseconds",-1*M.valueInMilliseconds())}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function b(G,M,P){switch(P){case "+":return G.plus({milliseconds:M.valueInMilliseconds()});case "-":return G.minus({milliseconds:M.valueInMilliseconds()})}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function q(G,M,P){switch(P){case "+":return G.addMilliseconds(M.valueInMilliseconds());
case "-":return G.addMilliseconds(-1*M.valueInMilliseconds())}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function A(G,M,P){M*=864E5;switch(P){case "+":return G.plus({milliseconds:M});case "-":return G.minus({milliseconds:M})}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function F(G,M,P){M*=864E5;switch(P){case "+":return G.plus("milliseconds",M);case "-":return G.plus("milliseconds",-1*M)}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function L(G,M,P){M*=864E5;switch(P){case "+":return G.plus("milliseconds",
M);case "-":return G.plus("milliseconds",-1*M)}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function h(G,M,P){throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function H(G,M,P){M*=864E5;switch(P){case "+":return G.addMilliseconds(M);case "-":return G.addMilliseconds(-1*M)}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function S(G,M,P){throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function C(G,M,P){throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function k(G,
M,P){throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function y(G,M,P){M=parseFloat(M);if(isNaN(M))throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);return n(G,M,P)}function N(G,M,P){G=parseFloat(G);if(isNaN(G))throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);return n(G,M,P)}function l(G,M,P){switch(P){case "+":return G+M}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function O(G,M,P){throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function u(G,M,P){throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);
}function D(G,M,P){switch(P){case "-":return G.toDateTimeLuxon(M.zone).diff(M).as("days")}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function R(G,M,P){switch(P){case "-":return G.toDateTimeLuxon(M.toDateTime().zone).diff(M.toDateTime()).as("days")}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function Q(G,M,P){switch(P){case "-":return G.toDateTimeLuxon("UTC").diff(M.toDateTimeLuxon("UTC")).as("days")}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function U(G,M,P){throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);
}function Z(G,M,P){throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function ea(G,M,P){switch(P){case "-":return G.toDateTime().diff(M.toDateTimeLuxon(G.toDateTime().zone)).as("days")}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function la(G,M,P){switch(P){case "-":return G.toDateTime().diff(M).as("days")}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function na(G,M,P){switch(P){case "-":return G.toDateTime().diff(M.toDateTime()).as("days")}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);
}function ta(G,M,P){throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function ua(G,M,P){throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function sa(G,M,P){throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function va(G,M,P){throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function xa(G,M,P){switch(P){case "-":return G.diff(M).as("days")}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function Da(G,M,P){switch(P){case "-":return G.diff(M.toDateTimeLuxon(G.zone)).as("days")}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);
}function Ia(G,M,P){switch(P){case "-":return G.diff(M.toDateTime()).as("days")}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function Pa(G,M,P){throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function Na(G,M,P){throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function Sa(G,M,P){throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function Va(G,M,P){throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function r(G,M,P){throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);
}function K(G,M,P){throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function X(G,M,P){throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function aa(G,M,P){throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function ha(G,M,P){throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}a.calculateDateOnlyAndDateOnly=Q;a.calculateDateOnlyAndDateTime=D;a.calculateDateOnlyAndNumber=F;a.calculateDateOnlyAndSqlInterval=f;a.calculateDateOnlyAndString=Na;a.calculateDateOnlyAndTimeOnly=U;a.calculateDateOnlyAndTimestamp=
R;a.calculateDateTimeAndDateOnly=Da;a.calculateDateTimeAndDateTime=xa;a.calculateDateTimeAndNumber=A;a.calculateDateTimeAndSqlInterval=b;a.calculateDateTimeAndString=Va;a.calculateDateTimeAndTimeOnly=Pa;a.calculateDateTimeAndTimestamp=Ia;a.calculateNumberAndDateOnly=k;a.calculateNumberAndDateTime=h;a.calculateNumberAndNumber=n;a.calculateNumberAndSqlInterval=p;a.calculateNumberAndString=y;a.calculateNumberAndTimeOnly=C;a.calculateNumberAndTimestamp=S;a.calculateSqlIntervalAndDateOnly=d;a.calculateSqlIntervalAndDateTime=
g;a.calculateSqlIntervalAndNumber=E;a.calculateSqlIntervalAndSqlInterval=B;a.calculateSqlIntervalAndString=O;a.calculateSqlIntervalAndTimeOnly=z;a.calculateSqlIntervalAndTimestamp=x;a.calculateStringAndDateOnly=X;a.calculateStringAndDateTime=aa;a.calculateStringAndNumber=N;a.calculateStringAndSqlInterval=u;a.calculateStringAndString=l;a.calculateStringAndTimeOnly=K;a.calculateStringAndTimestamp=ha;a.calculateTimeOnlyAndDateOnly=ua;a.calculateTimeOnlyAndDateTime=ta;a.calculateTimeOnlyAndNumber=L;a.calculateTimeOnlyAndSqlInterval=
m;a.calculateTimeOnlyAndString=Sa;a.calculateTimeOnlyAndTimeOnly=va;a.calculateTimeOnlyAndTimestamp=sa;a.calculateTimestampAndDateOnly=ea;a.calculateTimestampAndDateTime=la;a.calculateTimestampAndNumber=H;a.calculateTimestampAndSqlInterval=q;a.calculateTimestampAndString=r;a.calculateTimestampAndTimeOnly=Z;a.calculateTimestampAndTimestamp=na;a.sqlCalculateFunction=function(G,M,P,W){if("||"===G)return I.evaluateFunction("concat",[M,P],W);if(null===M||null===P)return null;if(w.isNumber(M)){if(w.isNumber(P))return n(M,
P,G);if(w.isSqlInterval(P))return p(M,P,G);if(w.isTimeOnly(P))return C();if(w.isDateOnly(P))return k();if(w.isTimestampOffset(P))return S();if(w.isDateTime(P))return h();if(w.isString(P))return y(M,P,G)}else if(w.isDateOnly(M)){if(w.isNumber(P))return F(M,P,G);if(w.isSqlInterval(P))return f(M,P,G);if(w.isTimeOnly(P))return U();if(w.isDateOnly(P))return Q(M,P,G);if(w.isTimestampOffset(P))return R(M,P,G);if(w.isDateTime(P))return D(M,P,G);if(w.isString(P))return Na()}else if(w.isTimeOnly(M)){if(w.isNumber(P))return L(M,
P,G);if(w.isSqlInterval(P))return m(M,P,G);if(w.isTimeOnly(P))return va();if(w.isDateOnly(P))return ua();if(w.isTimestampOffset(P))return sa();if(w.isDateTime(P))return ta();if(w.isString(P))return Sa()}else if(w.isSqlInterval(M)){if(w.isNumber(P))return E(M,P,G);if(w.isSqlInterval(P))return B(M,P,G);if(w.isTimeOnly(P))return z(M,P,G);if(w.isDateOnly(P))return d(M,P,G);if(w.isTimestampOffset(P))return x(M,P,G);if(w.isDateTime(P))return g(M,P,G);if(w.isString(P))return O()}else if(w.isDateTime(M)){if(w.isNumber(P))return A(M,
P,G);if(w.isSqlInterval(P))return b(M,P,G);if(w.isTimeOnly(P))return Pa();if(w.isDateOnly(P))return Da(M,P,G);if(w.isTimestampOffset(P))return Ia(M,P,G);if(w.isDateTime(P))return xa(M,P,G);if(w.isString(P))return Va()}else if(w.isTimestampOffset(M)){if(w.isNumber(P))return H(M,P,G);if(w.isSqlInterval(P))return q(M,P,G);if(w.isTimeOnly(P))return Z();if(w.isDateOnly(P))return ea(M,P,G);if(w.isTimestampOffset(P))return na(M,P,G);if(w.isDateTime(P))return la(M,P,G);if(w.isString(P))return r()}else if(w.isString(M)){if(w.isNumber(P))return N(M,
P,G);if(w.isSqlInterval(P))return u();if(w.isTimeOnly(P))return K();if(w.isDateOnly(P))return X();if(w.isTimestampOffset(P))return ha();if(w.isDateTime(P))return aa();if(w.isString(P))return l(M,P,G)}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/sqlDateParsingUtils":function(){define("exports ../../arcade/featureset/support/errorsupport ./DateOnly ./SqlInterval ./SqlTimestampOffset ./TimeOnly ./UnknownTimeZone ../../chunks/datetime".split(" "),
function(a,c,w,v,I,n,g,z){function d(A,F,L){L=p.exec(A);if(null!==L){const [,h,H,S,C,k,y,N]=L;A=z.DateTime.fromObject({year:parseInt(h,10),month:parseInt(H,10),day:parseInt(S,10),hour:parseInt(C,10),minute:parseInt(k,10),second:parseInt(y,10),millisecond:N?parseInt(N.replace(".",""),10):0},{zone:g.substituteUnknownTimezone(F)});if(!1===A.isValid)throw new c.SqlError(c.SqlErrorCodes.InvalidTimeStamp);return A}L=f.exec(A);if(null!==L){const [,h,H,S,C,k,y,N,l,O,u]=L;A=I.SqlTimeStampOffset.fromParts(parseInt(h,
10),parseInt(H,10),parseInt(S,10),parseInt(C,10),parseInt(k,10),parseInt(y,10),N?parseInt(N.replace(".",""),10):0,"-"===l,parseInt(O,10),parseInt(u,10));if(!1===A.isValid)throw new c.SqlError(c.SqlErrorCodes.InvalidTimeStamp);return A}L=b.exec(A);if(null!==L){const [,h,H,S,C,k,y,N,l]=L;A=I.SqlTimeStampOffset.fromParts(parseInt(h,10),parseInt(H,10),parseInt(S,10),parseInt(C,10),parseInt(k,10),0,0,"-"===y,parseInt(N,10),parseInt(l,10));if(!1===A.isValid)throw new c.SqlError(c.SqlErrorCodes.InvalidTimeStamp);
return A}L=q.exec(A);if(null!==L){const [,h,H,S,C,k]=L;A=z.DateTime.fromObject({year:parseInt(h,10),month:parseInt(H,10),day:parseInt(S,10),hour:parseInt(C,10),minute:parseInt(k,10),second:0},{zone:g.substituteUnknownTimezone(F)});if(!1===A.isValid)throw new c.SqlError(c.SqlErrorCodes.InvalidTimeStamp);return A}L=E.exec(A);if(null!==L){const [,h,H,S]=L;A=z.DateTime.fromObject({year:parseInt(h,10),month:parseInt(H,10),day:parseInt(S,10),hour:0,minute:0,second:0},{zone:g.substituteUnknownTimezone(F)});
if(!1===A.isValid)throw new c.SqlError(c.SqlErrorCodes.InvalidTimeStamp);return A}throw new c.SqlError(c.SqlErrorCodes.InvalidTimeStamp);}const m=/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/,x=/^(\d{1,2}):(\d{1,2})$/,B=/^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/,E=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,p=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$/,f=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$/,b=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$/,
q=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/;a.convertToExecutingTimeZone=function(A,F){if(F instanceof z.Zone)return F===g.UnknownTimeZone.instance?z.DateTime.fromMillis(A.getTime(),{zone:g.UnknownTimeZone.instance}):z.DateTime.fromJSDate(A,{zone:F});switch(F){case "system":case "local":case null:return z.DateTime.fromJSDate(A);default:return"unknown"===F?.toLowerCase()?z.DateTime.fromMillis(A.getTime(),{zone:g.UnknownTimeZone.instance}):z.DateTime.fromJSDate(A,{zone:F})}};a.isDate=function(A){return A instanceof
Date};a.isDateOnly=function(A){return A instanceof w.DateOnly};a.isDateTime=function(A){return A instanceof z.DateTime};a.isNumber=function(A){return"number"===typeof A};a.isSqlInterval=function(A){return A instanceof v.SqlInterval};a.isString=function(A){return"string"===typeof A||A instanceof String};a.isTimeOnly=function(A){return A instanceof n.TimeOnly};a.isTimestampOffset=function(A){return A instanceof I.SqlTimeStampOffset};a.parseDate=function(A,F){const L=E.exec(A);if(null===L)try{return d(A,
F)}catch{throw new c.SqlError(c.SqlErrorCodes.InvalidDate);}const [,h,H,S]=L;A=w.DateOnly.fromParts(parseInt(h,10),parseInt(H,10),parseInt(S,10));if(null===A)throw new c.SqlError(c.SqlErrorCodes.InvalidDate);return A};a.parseTime=function(A){let F=m.exec(A);if(null!==F){const [,L,h,H]=F;A=n.TimeOnly.fromParts(parseInt(L,10),parseInt(h,10),parseInt(H,10),0);if(null!==A)return A;throw new c.SqlError(c.SqlErrorCodes.InvalidTime);}F=x.exec(A);if(null!==F){const [,L,h]=F;A=n.TimeOnly.fromParts(parseInt(L,
10),parseInt(h,10),0,0);if(null!==A)return A;throw new c.SqlError(c.SqlErrorCodes.InvalidTime);}F=B.exec(A);if(null!==F){const [,L,h,H,S]=F;A=n.TimeOnly.fromParts(parseInt(L,10),parseInt(h,10),parseInt(H,10),parseInt(S,10));if(null!==A)return A}throw new c.SqlError(c.SqlErrorCodes.InvalidTime);};a.parseTimestamp=d;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/SqlInterval":function(){define(["exports","../../arcade/featureset/support/errorsupport"],function(a,c){class w{constructor(){this.op=
"+";this.millis=this.minute=this.year=this.month=this.hour=this.second=this.day=0}static _fixDefaults(v){if(null!==v.precision||null!==v.secondary)throw new c.SqlError(c.SqlErrorCodes.PrimarySecondaryQualifiers);}static _parseSecondsComponent(v,I){I.includes(".")?(I=I.split("."),v.second=parseFloat(I[0]),v.millis=parseInt(I[1],10)):v.second=parseFloat(I)}static createFromMilliseconds(v){const I=new w;I.second=v/1E3;return I}static createFromValueAndQualifer(v,I,n){let g=null;const z=new w;z.op="-"===
n?"-":"+";if("interval-period"===I.type){w._fixDefaults(I);n=RegExp("^[0-9]{1,}$");if("year"===I.period||"month"===I.period)throw new c.SqlError(c.SqlErrorCodes.YearMonthIntervals);if("second"===I.period)if(/^[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/.test(v))w._parseSecondsComponent(z,v);else throw new c.SqlError(c.SqlErrorCodes.IllegalInterval);else if(n.test(v))z[I.period]=parseFloat(v);else throw new c.SqlError(c.SqlErrorCodes.IllegalInterval);}else{w._fixDefaults(I.start);w._fixDefaults(I.end);if("year"===
I.start.period||"month"===I.start.period||"year"===I.end.period||"month"===I.end.period)throw new c.SqlError(c.SqlErrorCodes.YearMonthIntervals);switch(I.start.period){case "day":switch(I.end.period){case "hour":g=RegExp("^[0-9]{1,} [0-9]{1,}$");if(g.test(v))z[I.start.period]=parseFloat(v.split(" ")[0]),z[I.end.period]=parseFloat(v.split(" ")[1]);else throw new c.SqlError(c.SqlErrorCodes.IllegalInterval);break;case "minute":g=RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$");if(g.test(v))z[I.start.period]=
parseFloat(v.split(" ")[0]),v=v.split(" ")[1].split(":"),z.hour=parseFloat(v[0]),z.minute=parseFloat(v[1]);else throw new c.SqlError(c.SqlErrorCodes.IllegalInterval);break;case "second":g=RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(g.test(v))z[I.start.period]=parseFloat(v.split(" ")[0]),v=v.split(" ")[1].split(":"),z.hour=parseFloat(v[0]),z.minute=parseFloat(v[1]),w._parseSecondsComponent(z,v[2]);else throw new c.SqlError(c.SqlErrorCodes.IllegalInterval);break;default:throw new c.SqlError(c.SqlErrorCodes.IllegalInterval);
}break;case "hour":switch(I.end.period){case "minute":g=RegExp("^[0-9]{1,}:[0-9]{1,}$");if(g.test(v))z.hour=parseFloat(v.split(":")[0]),z.minute=parseFloat(v.split(":")[1]);else throw new c.SqlError(c.SqlErrorCodes.IllegalInterval);break;case "second":g=RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(g.test(v))v=v.split(":"),z.hour=parseFloat(v[0]),z.minute=parseFloat(v[1]),w._parseSecondsComponent(z,v[2]);else throw new c.SqlError(c.SqlErrorCodes.IllegalInterval);break;default:throw new c.SqlError(c.SqlErrorCodes.IllegalInterval);
}break;case "minute":switch(I.end.period){case "second":g=RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(g.test(v))v=v.split(":"),z.minute=parseFloat(v[0]),w._parseSecondsComponent(z,v[1]);else throw new c.SqlError(c.SqlErrorCodes.IllegalInterval);break;default:throw new c.SqlError(c.SqlErrorCodes.IllegalInterval);}break;default:throw new c.SqlError(c.SqlErrorCodes.IllegalInterval);}}return z}valueInMilliseconds(){return("-"===this.op?-1:1)*(this.millis+1E3*this.second+6E4*this.minute+36E5*
this.hour+864E5*this.day+365/12*this.month*864E5+31536E6*this.year)}}a.SqlInterval=w;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/StandardizedFunctions":function(){define("exports ../../arcade/featureset/support/errorsupport ../string ./DateOnly ./sqlCompareUtils ./sqlDateParsingUtils ./TimeOnly ../../chunks/datetime".split(" "),function(a,c,w,v,I,n,g,z){function d(b){return"string"===typeof b||b instanceof String}function m(b){return n.isDate(b)||n.isDateOnly(b)||
n.isDateTime(b)||n.isTimeOnly(b)||n.isTimestampOffset(b)?!1:!0}function x(b){return n.isDateOnly(b)||n.isTimeOnly(b)?b.toString():n.isTimestampOffset(b)?b.toSQLValue():n.isDateTime(b)?0===b.millisecond?b.toFormat("yyyy-LL-dd HH:mm:ss"):b.toSQL({includeOffset:!1}):n.isDate(b)?x(z.DateTime.fromJSDate(b)):b.toString()}function B(b){if(n.isDate(b))return v.DateOnly.fromDateJS(b);if(n.isDateTime(b))return v.DateOnly.fromParts(b.year,b.month,b.day);if(n.isDateOnly(b))return b;if(n.isTimeOnly(b))throw new c.SqlError(c.SqlErrorCodes.CannotCastValue);
if(n.isTimestampOffset(b)&&null===v.DateOnly.fromParts(b.year,b.month,b.day))throw new c.SqlError(c.SqlErrorCodes.CannotCastValue);if(d(b)&&(b=v.DateOnly.fromReader(b),null!==b&&b.isValid))return b;throw new c.SqlError(c.SqlErrorCodes.CannotCastValue);}function E(b,q,A){if(n.isDate(b))return n.convertToExecutingTimeZone(b,q);if(n.isDateTime(b))return b;if(n.isDateOnly(b))return b.toDateTimeLuxon("unknown");if(n.isTimeOnly(b))throw new c.SqlError(c.SqlErrorCodes.CannotCastValue);if(n.isTimestampOffset(b))return b;
if(d(b))return n.parseTimestamp(b,"unknown",A);throw new c.SqlError(c.SqlErrorCodes.CannotCastValue);}function p(b){if(n.isDate(b))return g.TimeOnly.fromDateJS(b);if(n.isDateTime(b))return g.TimeOnly.fromDateTime(b);if(n.isDateOnly(b))throw new c.SqlError(c.SqlErrorCodes.CannotCastValue);if(n.isTimeOnly(b))return b;if(n.isTimestampOffset(b))return g.TimeOnly.fromSqlTimeStampOffset(b);if(d(b))return n.parseTime(b);throw new c.SqlError(c.SqlErrorCodes.CannotCastValue);}const f={extract:{minParams:2,
maxParams:2,evaluate:([b,q])=>{if(null==q)return null;if(n.isDate(q))switch(b.toUpperCase()){case "SECOND":return q.getSeconds();case "MINUTE":return q.getMinutes();case "HOUR":return q.getHours();case "DAY":return q.getDate();case "MONTH":return q.getMonth()+1;case "YEAR":return q.getFullYear();case "TIMEZONE_HOUR":return 0;case "TIMEZONE_MINUTE":return 0}else if(n.isDateTime(q))switch(b.toUpperCase()){case "SECOND":return q.second;case "MINUTE":return q.minute;case "HOUR":return q.hour;case "DAY":return q.day;
case "MONTH":return q.month;case "YEAR":return q.year}else if(n.isDateOnly(q))switch(b.toUpperCase()){case "DAY":return q.day;case "MONTH":return q.month;case "YEAR":return q.year}else if(n.isTimeOnly(q))switch(b.toUpperCase()){case "SECOND":return q.second;case "MINUTE":return q.minute;case "HOUR":return q.hour}else if(n.isTimestampOffset(q))switch(b.toUpperCase()){case "SECOND":return q.second;case "MINUTE":return q.minute;case "HOUR":return q.hour;case "DAY":return q.day;case "MONTH":return q.month;
case "YEAR":return q.year;case "TIMEZONE_HOUR":return q.timezoneOffsetHour;case "TIMEZONE_MINUTE":return q.timezoneOffsetMinutes}throw new c.SqlError(c.SqlErrorCodes.InvalidFunctionParameters,{function:"EXTRACT"});}},substring:{minParams:2,maxParams:3,evaluate:b=>{if(2===b.length){const [q,A]=b;return null==q||null==A?null:q.toString().substring(A-1)}if(3===b.length){const [q,A,F]=b;return null==q||null==A||null==F?null:0>=F?"":q.toString().substring(A-1,A+F-1)}}},position:{minParams:2,maxParams:2,
evaluate:([b,q])=>null==b||null==q?null:q.indexOf(b)+1},trim:{minParams:2,maxParams:3,evaluate:b=>{var q=3===b.length,A=q?b[1]:" ";q=q?b[2]:b[1];if(null==A||null==q)return null;A=`(${w.escapeRegExpString(A)})`;switch(b[0]){case "BOTH":return q.replaceAll(new RegExp(`^${A}*|${A}*$`,"g"),"");case "LEADING":return q.replaceAll(new RegExp(`^${A}*`,"g"),"");case "TRAILING":return q.replaceAll(new RegExp(`${A}*$`,"g"),"")}throw new c.SqlError(c.SqlErrorCodes.InvalidFunctionParameters,{function:"TRIM"});
}},abs:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:Math.abs(b[0])},ceiling:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:Math.ceil(b[0])},floor:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:Math.floor(b[0])},log:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:Math.log(b[0])},log10:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:Math.log(b[0])*Math.LOG10E},sin:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:Math.sin(b[0])},cos:{minParams:1,maxParams:1,evaluate:b=>
null==b[0]?null:Math.cos(b[0])},tan:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:Math.tan(b[0])},asin:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:Math.asin(b[0])},acos:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:Math.acos(b[0])},atan:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:Math.atan(b[0])},sign:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:0<b[0]?1:0>b[1]?-1:0},power:{minParams:2,maxParams:2,evaluate:b=>null==b[0]||null==b[1]?null:b[0]**b[1]},mod:{minParams:2,
maxParams:2,evaluate:b=>null==b[0]||null==b[1]?null:b[0]%b[1]},round:{minParams:1,maxParams:2,evaluate:b=>{const q=b[0];b=2===b.length?10**b[1]:1;return null==q?null:Math.round(q*b)/b}},truncate:{minParams:1,maxParams:2,evaluate:b=>null==b[0]?null:1===b.length?parseInt(b[0].toFixed(0),10):parseFloat(b[0].toFixed(b[1]))},char_length:{minParams:1,maxParams:1,evaluate:b=>d(b[0])?b[0].length:0},concat:{minParams:1,maxParams:Infinity,evaluate:b=>{let q="";for(let A=0;A<b.length;A++){if(null==b[A])return null;
q+=b[A].toString()}return q}},lower:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:b[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:b[0].toString().toUpperCase()},coalesce:{minParams:1,maxParams:Infinity,evaluate:b=>{for(const q of b)if(null!==q)return q;return null}},cosh:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:Math.cosh(b[0])},sinh:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:Math.sinh(b[0])},tanh:{minParams:1,maxParams:1,evaluate:b=>
null==b[0]?null:Math.tanh(b[0])},nullif:{minParams:2,maxParams:2,evaluate:(b,q)=>I.sqlCompare(b[0],b[1],"\x3d")?null:b[0]},cast:{minParams:2,maxParams:2,evaluate:(b,q)=>{const A=b[0];b=b[1];if(null===A)return null;switch(b.type){case "integer":if(!m(A))throw new c.SqlError(c.SqlErrorCodes.CannotCastValue);q=parseInt(A,10);if(isNaN(q))throw new c.SqlError(c.SqlErrorCodes.CannotCastValue);return q;case "smallint":if(!m(A))throw new c.SqlError(c.SqlErrorCodes.CannotCastValue);q=parseInt(A,10);if(isNaN(q))throw new c.SqlError(c.SqlErrorCodes.CannotCastValue);
if(32767<q||-32767>q)throw new c.SqlError(c.SqlErrorCodes.CannotCastValue);return q;case "float":case "real":if(!m(A))throw new c.SqlError(c.SqlErrorCodes.CannotCastValue);q=parseFloat(A);if(isNaN(q))throw new c.SqlError(c.SqlErrorCodes.CannotCastValue);return q;case "time":return p(A);case "date":return B(A);case "timestamp":return E(A,q,!0===b.withtimezone);case "varchar":q=x(A);if(q.length>b.size)throw new c.SqlError(c.SqlErrorCodes.CannotCastValue);return q;default:throw new c.SqlError(c.SqlErrorCodes.InvalidDataType);
}}}};a.evaluateFunction=function(b,q,A){const F=f[b.toLowerCase()];if(null==F)throw new c.SqlError(c.SqlErrorCodes.FunctionNotRecognized);if(q.length<F.minParams||q.length>F.maxParams)throw new c.SqlError(c.SqlErrorCodes.InvalidParameterCount,{name:b.toUpperCase()});return F.evaluate(q,A)};a.isStandardized=function(b,q){b=f[b.toLowerCase()];return null!=b&&q>=b.minParams&&q<=b.maxParams};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/sqlCompareUtils":function(){define("exports ../../arcade/featureset/support/errorsupport ./sqlDateParsingUtils ./SqlTimestampOffset ./UnknownTimeZone ../../chunks/datetime".split(" "),
function(a,c,w,v,I,n){function g(b){return w.isDateTime(b)||w.isTimestampOffset(b)?!0:!1}function z(b){return w.isDateTime(b)||w.isDateOnly(b)||w.isTimestampOffset(b)||w.isTimeOnly(b)?!0:!1}function d(b){if(w.isDateTime(b))return b.toMillis();if(w.isDateOnly(b))return b.toNumber();if(w.isTimestampOffset(b))return b.toMilliseconds();throw new c.SqlError(c.SqlErrorCodes.InvalidDataType);}function m(b,q,A){switch(A){case "\x3c\x3e":return b!==q;case "\x3d":return b===q;case "\x3e":return b>q;case "\x3c":return b<
q;case "\x3e\x3d":return b>=q;case "\x3c\x3d":return b<=q}}function x(b,q,A){const F=parseFloat(q);if(!isNaN(F))return m(b,F,A);b=b.toString();switch(A){case "\x3c\x3e":return b!==q;case "\x3d":return b===q;case "\x3e":return b>q;case "\x3c":return b<q;case "\x3e\x3d":return b>=q;case "\x3c\x3d":return b<=q}}function B(b,q,A){const F=parseFloat(b);if(!isNaN(F))return m(F,q,A);q=q.toString();switch(A){case "\x3c\x3e":return b!==q;case "\x3d":return b===q;case "\x3e":return b>q;case "\x3c":return b<
q;case "\x3e\x3d":return b>=q;case "\x3c\x3d":return b<=q}}function E(b,q,A){switch(A){case "\x3c\x3e":return b!==q;case "\x3d":return b===q;case "\x3e":return b>q;case "\x3c":return b<q;case "\x3e\x3d":return b>=q;case "\x3c\x3d":return b<=q}}function p(b,q,A){b instanceof v.SqlTimeStampOffset&&(b=b.toDateTime());q instanceof v.SqlTimeStampOffset&&(q=q.toDateTime());b=f(b);q=f(q);switch(A){case "\x3c\x3e":return b!==q;case "\x3d":return b===q;case "\x3e":return b>q;case "\x3c":return b<q;case "\x3e\x3d":return b>=
q;case "\x3c\x3d":return b<=q}}function f(b){return 321408E5*b.year+26784E5*b.month+864E5*b.day+36E5*b.hour+6E4*b.minute+1E3*b.second+b.millisecond}a.dateValueInMilliseconds=d;a.isDateOrTimeValue=z;a.isDateTimeComparableValue=g;a.sqlCompare=function(b,q,A,F){if(null==b||null==q)return null;if(w.isNumber(b)){if(w.isNumber(q))return m(b,q,A);if(w.isString(q))return x(b,q,A);if(z(q))throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);if(w.isDateOnly(q))throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);
}else if(w.isString(b)){if(w.isNumber(q))return B(b,q,A);if(w.isString(q))return E(b,q,A);if(w.isDateTime(q))throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);if(w.isDateOnly(q))throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);if(w.isTimeOnly(q))throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);if(w.isTimestampOffset(q))throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}else if(w.isDateTime(b)){if(g(q)){if(b instanceof n.DateTime&&I.isUnknownTimeZone(b.zone)){if(q instanceof n.DateTime&&
!1===I.isUnknownTimeZone(q.zone)||q instanceof v.SqlTimeStampOffset)return p(b,q,A)}else if(q instanceof n.DateTime&&I.isUnknownTimeZone(q.zone)&&(b instanceof n.DateTime&&!1===I.isUnknownTimeZone(b.zone)||b instanceof v.SqlTimeStampOffset))return p(b,q,A);return m(d(b),d(q),A)}if(w.isString(q))throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);if(w.isDateOnly(q))return q=q.toDateTimeLuxon(b.zone),b=b.startOf("day"),m(b.toMillis(),q.toMillis(),A);if(w.isTimeOnly(q))throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);
if(w.isNumber(q))throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}else if(w.isDateOnly(b)){if(w.isTimestampOffset(q))return b=b.toDateTimeLuxon(q.toDateTime().zone),q=q.startOfDay(),m(b.toMillis(),q.toMilliseconds(),A);if(w.isDateTime(q))return b=b.toDateTimeLuxon(q.zone),q=q.startOf("day"),m(b.toMillis(),q.toMillis(),A);if(w.isString(q))throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);if(w.isDateOnly(q))return m(b.toNumber(),q.toNumber(),A);if(w.isTimeOnly(q))throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);
if(w.isNumber(q))throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}else if(w.isTimeOnly(b)){if(w.isTimeOnly(q))return m(b.toNumber(),q.toNumber(),A);if(w.isString(q))throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);if(w.isNumber(q))throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);if(w.isDateOnly(q))throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);if(g(q))throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}else if(w.isTimestampOffset(b)){if(g(q))return q instanceof n.DateTime&&
I.isUnknownTimeZone(q.zone)?p(b,q,A):m(d(b),d(q),A);if(w.isString(q))throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);if(w.isDateOnly(q))return q=q.toDateTimeLuxon(b.toDateTime().zone),b=b.startOfDay(),m(b.toMilliseconds(),q.toMillis(),A);if(w.isTimeOnly(q))throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);if(w.isNumber(q))throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}switch(A){case "\x3c\x3e":return b!==q;case "\x3d":return b===q;case "\x3e":return b>q;case "\x3c":return b<q;case "\x3e\x3d":return b>=
q;case "\x3c\x3d":return b<=q}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/WhereGrammar":function(){define(["exports","../../chunks/_commonjsHelpers"],function(a,c){var w={exports:{}};w.exports;(function(n){(function(g,z){n.exports&&(n.exports=z())})(c.commonjsGlobal,function(){function g(d,m,x,B){d=Error.call(this,d);Object.setPrototypeOf&&Object.setPrototypeOf(d,g.prototype);d.expected=m;d.found=x;d.location=B;d.name="SyntaxError";return d}function z(d,m,x){x=
x||" ";if(d.length>m)return d;m-=d.length;x+=x.repeat(m);return d+x.slice(0,m)}(function(d,m){function x(){this.constructor=d}x.prototype=m.prototype;d.prototype=new x})(g,Error);g.prototype.format=function(d){var m="Error: "+this.message;if(this.location){var x=null,B;for(B=0;B<d.length;B++)if(d[B].source===this.location.source){x=d[B].text.split(/\r\n|\n|\r/g);break}d=this.location.start;B=this.location.source&&"function"===typeof this.location.source.offset?this.location.source.offset(d):d;var E=
this.location.source+":"+B.line+":"+B.column;if(x){var p=this.location.end,f=z("",B.line.toString().length," ");x=x[d.line-1];p=(d.line===p.line?p.column:x.length+1)-d.column||1;m+="\n --\x3e "+E+"\n"+f+" |\n"+B.line+" | "+x+"\n"+f+" | "+z("",d.column-1," ")+z("",p,"^")}else m+="\n at "+E}return m};g.buildMessage=function(d,m){function x(b){return b.charCodeAt(0).toString(16).toUpperCase()}function B(b){return b.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,
"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(q){return"\\x0"+x(q)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(q){return"\\x"+x(q)})}function E(b){return b.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(q){return"\\x0"+x(q)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(q){return"\\x"+x(q)})}function p(b){return f[b.type](b)}var f={literal:function(b){return'"'+
B(b.text)+'"'},class:function(b){var q=b.parts.map(function(A){return Array.isArray(A)?E(A[0])+"-"+E(A[1]):E(A)});return"["+(b.inverted?"^":"")+q.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(b){return b.description}};return"Expected "+function(b){b=b.map(p);var q,A;b.sort();if(0<b.length){for(A=q=1;q<b.length;q++)b[q-1]!==b[q]&&(b[A]=b[q],A++);b.length=A}switch(b.length){case 1:return b[0];case 2:return b[0]+" or "+b[1];default:return b.slice(0,
-1).join(", ")+", or "+b[b.length-1]}}(d)+" but "+(m?'"'+B(m)+'"':"end of input")+" found."};return{SyntaxError:g,parse:function(d,m){function x(J,T){T=void 0!==T?T:f(ma,t);throw new g(J,null,null,T);}function B(J,T){return{type:"literal",text:J,ignoreCase:T}}function E(J,T,V){return{type:"class",parts:J,inverted:T,ignoreCase:V}}function p(J){var T=Zb[J],V;if(!T){for(V=J-1;!Zb[V];)V--;T=Zb[V];for(T={line:T.line,column:T.column};V<J;)10===d.charCodeAt(V)?(T.line++,T.column=1):T.column++,V++;Zb[J]=
T}return T}function f(J,T,V){var ca=p(J),pa=p(T);J={source:Mb,start:{offset:J,line:ca.line,column:ca.column},end:{offset:T,line:pa.line,column:pa.column}};V&&Mb&&"function"===typeof Mb.offset&&(J.start=Mb.offset(J.start),J.end=Mb.offset(J.end));return J}function b(J){t<eb||(t>eb&&(eb=t,zc=[]),zc.push(J))}function q(){var J=t;ja();var T=F();T!==e?(ja(),ma=J,J=T):(t=J,J=e);return J}function A(){var J=t;var T=F();if(T!==e){var V=[];var ca=t;var pa=ja();var za=Wa();if(za!==e){var Ea=ja();var Fa=F();Fa!==
e?ca=pa=[pa,za,Ea,Fa]:(t=ca,ca=e)}else t=ca,ca=e;for(;ca!==e;)V.push(ca),ca=t,pa=ja(),za=Wa(),za!==e?(Ea=ja(),Fa=F(),Fa!==e?ca=pa=[pa,za,Ea,Fa]:(t=ca,ca=e)):(t=ca,ca=e);ma=J;J={type:"expression-list"};T=[T];for(ca=0;ca<V.length;ca++)T.push(V[ca][3]);J.value=T}else t=J,J=e;return J}function F(){var J=t;var T=L();if(T!==e){var V=[];var ca=t;var pa=ja();var za=P();if(za!==e){var Ea=ja();var Fa=L();Fa!==e?ca=pa=[pa,za,Ea,Fa]:(t=ca,ca=e)}else t=ca,ca=e;for(;ca!==e;)V.push(ca),ca=t,pa=ja(),za=P(),za!==
e?(Ea=ja(),Fa=L(),Fa!==e?ca=pa=[pa,za,Ea,Fa]:(t=ca,ca=e)):(t=ca,ca=e);ma=J;J=nb(T,V)}else t=J,J=e;return J}function L(){var J=t;var T=h();if(T!==e){var V=[];var ca=t;var pa=ja();var za=M();if(za!==e){var Ea=ja();var Fa=h();Fa!==e?ca=pa=[pa,za,Ea,Fa]:(t=ca,ca=e)}else t=ca,ca=e;for(;ca!==e;)V.push(ca),ca=t,pa=ja(),za=M(),za!==e?(Ea=ja(),Fa=h(),Fa!==e?ca=pa=[pa,za,Ea,Fa]:(t=ca,ca=e)):(t=ca,ca=e);ma=J;J=nb(T,V)}else t=J,J=e;return J}function h(){var J=t;var T=G();if(T===e){T=t;if(33===d.charCodeAt(t)){var V=
Nd;t++}else V=e,0===fa&&b(Od);if(V!==e){var ca=t;fa++;if(61===d.charCodeAt(t)){var pa=Sc;t++}else pa=e,0===fa&&b(Tc);fa--;pa===e?ca=void 0:(t=ca,ca=e);ca!==e?T=V=[V,ca]:(t=T,T=e)}else t=T,T=e}T!==e?(V=ja(),ca=h(),ca!==e?(ma=J,J={type:"unary-expression",operator:"NOT",expr:ca}):(t=J,J=e)):(t=J,J=e);if(J===e){T=t;J=k();if(J!==e){ja();V=t;ca=[];pa=t;var za=ja();var Ea=H();if(Ea!==e){var Fa=ja();var ob=k();ob!==e?pa=za=[za,Ea,Fa,ob]:(t=pa,pa=e)}else t=pa,pa=e;if(pa!==e)for(;pa!==e;)ca.push(pa),pa=t,za=
ja(),Ea=H(),Ea!==e?(Fa=ja(),ob=k(),ob!==e?pa=za=[za,Ea,Fa,ob]:(t=pa,pa=e)):(t=pa,pa=e);else ca=e;ca!==e&&(ma=V,ca={type:"arithmetic",tail:ca});V=ca;V===e&&(V=t,ca=C(),ca!==e?(ja(),pa=Ja(),pa!==e?(ja(),pa=A(),pa!==e?(ja(),za=Ka(),za!==e?(ma=V,V={op:ca,right:pa}):(t=V,V=e)):(t=V,V=e)):(t=V,V=e)):(t=V,V=e),V===e&&(V=t,ca=C(),ca!==e?(ja(),pa=Ja(),pa!==e?(ja(),pa=Ka(),pa!==e?(ma=V,V={op:ca,right:{type:"expression-list",value:[]}}):(t=V,V=e)):(t=V,V=e)):(t=V,V=e),V===e&&(V=t,ca=C(),ca!==e?(ja(),pa=ea(),
pa!==e?(ma=V,V={op:ca,right:pa}):(t=V,V=e)):(t=V,V=e))),V===e&&(V=t,za=G(),za!==e?(ja(),ca=W(),ca!==e?(ja(),pa=k(),pa!==e?(ja(),Ea=M(),Ea!==e?(ja(),za=k(),za!==e?(ma=V,V={op:"NOT"+ca,right:{type:"expression-list",value:[pa,za]}}):(t=V,V=e)):(t=V,V=e)):(t=V,V=e)):(t=V,V=e)):(t=V,V=e),V===e&&(V=t,za=W(),za!==e?(ja(),ca=k(),ca!==e?(ja(),pa=M(),pa!==e?(ja(),Ea=k(),Ea!==e?(ma=V,V={op:za,right:{type:"expression-list",value:[ca,Ea]}}):(t=V,V=e)):(t=V,V=e)):(t=V,V=e)):(t=V,V=e)),V===e&&(V=t,ca=aa(),ca!==
e?(ja(),pa=G(),pa!==e?(ja(),pa=k(),pa!==e?(ma=V,V={op:ca+"NOT",right:pa}):(t=V,V=e)):(t=V,V=e)):(t=V,V=e),V===e&&(V=t,ca=aa(),ca!==e?(ja(),pa=k(),pa!==e?(ma=V,V={op:ca,right:pa}):(t=V,V=e)):(t=V,V=e)),V===e&&(V=t,ca=S(),ca!==e?(ja(),pa=va(),pa!==e?(ja(),za=t,d.substr(t,6).toLowerCase()===Pd?(Ea=d.substr(t,6),t+=6):(Ea=e,0===fa&&b(Qd)),Ea!==e?(Ea=t,fa++,Fa=R(),fa--,Fa===e?Ea=void 0:(t=Ea,Ea=e),Ea!==e?(ma=za,za="ESCAPE"):(t=za,za=e)):(t=za,za=e),za!==e?(ja(),za=xa(),za!==e?(ma=V,V={op:ca,right:pa,escape:za.value}):
(t=V,V=e)):(t=V,V=e)):(t=V,V=e)):(t=V,V=e),V===e&&(V=t,ca=S(),ca!==e?(ja(),pa=va(),pa!==e?(ma=V,V={op:ca,right:pa,escape:""}):(t=V,V=e)):(t=V,V=e))))));V===e&&(V=null);ma=T;T=V;""==T||void 0==T||null==T?T=J:(V=null,T=V="arithmetic"==T.type?nb(J,T.tail):Nb(T.op,J,T.right,T.escape))}else t=T,T=e;J=T}return J}function H(){if(d.substr(t,2)===Uc){var J=Uc;t+=2}else J=e,0===fa&&b(Rd);J===e&&(62===d.charCodeAt(t)?(J=Sd,t++):(J=e,0===fa&&b(Td)),J===e&&(d.substr(t,2)===Vc?(J=Vc,t+=2):(J=e,0===fa&&b(Ud)),J===
e&&(d.substr(t,2)===Wc?(J=Wc,t+=2):(J=e,0===fa&&b(Vd)),J===e&&(60===d.charCodeAt(t)?(J=Wd,t++):(J=e,0===fa&&b(Xd)),J===e&&(61===d.charCodeAt(t)?(J=Sc,t++):(J=e,0===fa&&b(Tc)),J===e&&(d.substr(t,2)===Xc?(J=Xc,t+=2):(J=e,0===fa&&b(Yd))))))));return J}function S(){var J;var T=J=t;var V=G();if(V!==e){var ca=ja();var pa=ha();pa!==e?T=V=[V,ca,pa]:(t=T,T=e)}else t=T,T=e;T!==e&&(ma=J,T=T[0]+" "+T[2]);J=T;J===e&&(J=ha());return J}function C(){var J;var T=J=t;var V=G();if(V!==e){var ca=ja();var pa=X();pa!==
e?T=V=[V,ca,pa]:(t=T,T=e)}else t=T,T=e;T!==e&&(ma=J,T=T[0]+" "+T[2]);J=T;J===e&&(J=X());return J}function k(){var J=t;var T=N();if(T!==e){var V=[];var ca=t;var pa=ja();var za=y();if(za!==e){var Ea=ja();var Fa=N();Fa!==e?ca=pa=[pa,za,Ea,Fa]:(t=ca,ca=e)}else t=ca,ca=e;for(;ca!==e;)V.push(ca),ca=t,pa=ja(),za=y(),za!==e?(Ea=ja(),Fa=N(),Fa!==e?ca=pa=[pa,za,Ea,Fa]:(t=ca,ca=e)):(t=ca,ca=e);ma=J;J=nb(T,V)}else t=J,J=e;return J}function y(){if(43===d.charCodeAt(t)){var J=Ac;t++}else J=e,0===fa&&b(Bc);J===
e&&(45===d.charCodeAt(t)?(J=Cc,t++):(J=e,0===fa&&b(Dc)),J===e&&(d.substr(t,2)===Yc?(J=Yc,t+=2):(J=e,0===fa&&b(Zd))));return J}function N(){var J=t;var T=O();if(T!==e){var V=[];var ca=t;var pa=ja();var za=l();if(za!==e){var Ea=ja();var Fa=O();Fa!==e?ca=pa=[pa,za,Ea,Fa]:(t=ca,ca=e)}else t=ca,ca=e;for(;ca!==e;)V.push(ca),ca=t,pa=ja(),za=l(),za!==e?(Ea=ja(),Fa=O(),Fa!==e?ca=pa=[pa,za,Ea,Fa]:(t=ca,ca=e)):(t=ca,ca=e);ma=J;J=nb(T,V)}else t=J,J=e;return J}function l(){if(42===d.charCodeAt(t)){var J=$d;t++}else J=
e,0===fa&&b(ae);J===e&&(47===d.charCodeAt(t)?(J=be,t++):(J=e,0===fa&&b(ce)));return J}function O(){var J=xa();if(J===e){var T=t;var V=t;var ca=Na();if(ca!==e){var pa=Sa();if(pa!==e){var za=Va();za!==e?(ma=V,V=parseFloat(ca+pa+za)):(t=V,V=e)}else t=V,V=e}else t=V,V=e;V===e&&(V=t,ca=Na(),ca!==e?(pa=Sa(),pa!==e?(ma=V,V=parseFloat(ca+pa)):(t=V,V=e)):(t=V,V=e),V===e&&(V=t,ca=Na(),ca!==e?(pa=Va(),pa!==e?(ma=V,V=parseFloat(ca+pa)):(t=V,V=e)):(t=V,V=e),V===e&&(V=t,ca=Na(),ca!==e&&(ma=V,ca=parseFloat(ca)),
V=ca)));var Ea=V;if(Ea!==e){var Fa=t;fa++;var ob=D();fa--;ob===e?Fa=void 0:(t=Fa,Fa=e);Fa!==e?(ma=T,T={type:"number",value:Ea}):(t=T,T=e)}else t=T,T=e;J=T;if(J===e){var pb=t;var Jb=t;if(d.substr(t,4).toLowerCase()===de){var $b=d.substr(t,4);t+=4}else $b=e,0===fa&&b(ee);if($b!==e){var Ob=t;fa++;var fe=R();fa--;fe===e?Ob=void 0:(t=Ob,Ob=e);Ob!==e?Jb=$b=[$b,Ob]:(t=Jb,Jb=e)}else t=Jb,Jb=e;var qb=Jb;qb!==e&&(ma=pb,qb={type:"boolean",value:!0});pb=qb;if(pb===e){pb=t;var Kb=t;if(d.substr(t,5).toLowerCase()===
ge){var ac=d.substr(t,5);t+=5}else ac=e,0===fa&&b(he);if(ac!==e){var Pb=t;fa++;var ie=R();fa--;ie===e?Pb=void 0:(t=Pb,Pb=e);Pb!==e?Kb=ac=[ac,Pb]:(t=Kb,Kb=e)}else t=Kb,Kb=e;qb=Kb;qb!==e&&(ma=pb,qb={type:"boolean",value:!1});pb=qb}J=pb;if(J===e){var je=t;var Lb=t;if(d.substr(t,4).toLowerCase()===ke){var bc=d.substr(t,4);t+=4}else bc=e,0===fa&&b(le);if(bc!==e){var Qb=t;fa++;var me=R();fa--;me===e?Qb=void 0:(t=Qb,Qb=e);Qb!==e?Lb=bc=[bc,Qb]:(t=Lb,Lb=e)}else t=Lb,Lb=e;var Ec=Lb;Ec!==e&&(ma=je,Ec={type:"null",
value:null});J=Ec;if(J===e){var rb=t;if(ia()!==e){ja();var cc=va();cc!==e?(ma=rb,"string"===cc.type&&!0!==/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(cc.value)&&x("Date literal is invalid"),rb={type:"date",
value:cc.value}):(t=rb,rb=e)}else t=rb,rb=e;J=rb;if(J===e){var sb=t;if(da()!==e){ja();var dc=va();dc!==e?(ma=sb,"string"===dc.type&&!0!==/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(dc.value)&&x("Timestamp literal is invalid"),
sb={type:"timestamp",value:dc.value}):(t=sb,sb=e)}else t=sb,sb=e;J=sb;if(J===e){var Ta=t;var Fc=ra();if(Fc!==e){ja();if(45===d.charCodeAt(t)){var hb=Cc;t++}else hb=e,0===fa&&b(Dc);hb===e&&(43===d.charCodeAt(t)?(hb=Ac,t++):(hb=e,0===fa&&b(Bc)));if(hb!==e){ja();var Rb=va();if(Rb!==e){ja();var Zc=na();Zc!==e?(ma=Ta,Ta={type:"interval",value:Rb,qualifier:Zc,op:hb}):(t=Ta,Ta=e)}else t=Ta,Ta=e}else t=Ta,Ta=e}else t=Ta,Ta=e;Ta===e&&(Ta=t,Fc=ra(),Fc!==e?(ja(),hb=va(),hb!==e?(ja(),Rb=na(),Rb!==e?(ma=Ta,Ta=
{type:"interval",value:hb,qualifier:Rb,op:""}):(t=Ta,Ta=e)):(t=Ta,Ta=e)):(t=Ta,Ta=e));J=Ta;if(J===e){var tb=t;if(ka()!==e){ja();var ec=va();ec!==e?(ma=tb,"string"===ec.type&&!0!==/^(\d{1,2}):(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/.test(ec.value)&&x("Time literal is invalid"),tb={type:"time",value:ec.value}):(t=tb,tb=e)}else t=tb,tb=e;J=tb}}}}}}}var La=J;if(La===e){var Za=t;var ub=t;if(d.substr(t,7).toLowerCase()===ne){var $c=d.substr(t,7);t+=7}else $c=
e,0===fa&&b(oe);if($c!==e){var fc=t;fa++;var pe=R();fa--;pe===e?fc=void 0:(t=fc,fc=e);fc!==e?(ma=ub,ub="EXTRACT"):(t=ub,ub=e)}else t=ub,ub=e;if(ub!==e){ja();var qe=Ja();if(qe!==e){ja();var $a=oa();if($a===e&&($a=qa(),$a===e&&($a=Ca(),$a===e&&($a=wa(),$a===e&&($a=Ba(),$a===e&&($a=Aa(),$a===e)))))){var vb=t;if(d.substr(t,13).toLowerCase()===re){var ad=d.substr(t,13);t+=13}else ad=e,0===fa&&b(se);if(ad!==e){var gc=t;fa++;var te=R();fa--;te===e?gc=void 0:(t=gc,gc=e);gc!==e?(ma=vb,vb="TIMEZONE_HOUR"):
(t=vb,vb=e)}else t=vb,vb=e;$a=vb;if($a===e){var wb=t;if(d.substr(t,15).toLowerCase()===ue){var bd=d.substr(t,15);t+=15}else bd=e,0===fa&&b(ve);if(bd!==e){var hc=t;fa++;var we=R();fa--;we===e?hc=void 0:(t=hc,hc=e);hc!==e?(ma=wb,wb="TIMEZONE_MINUTE"):(t=wb,wb=e)}else t=wb,wb=e;$a=wb}}var cd=$a;if(cd!==e){ja();var xe=Y();if(xe!==e){ja();var dd=F();if(dd!==e){ja();var ye=Ka();ye!==e?(ma=Za,Za={type:"function",name:"extract",args:{type:"expression-list",value:[{type:"string",value:cd},dd]}}):(t=Za,Za=
e)}else t=Za,Za=e}else t=Za,Za=e}else t=Za,Za=e}else t=Za,Za=e}else t=Za,Za=e;La=Za;if(La===e){var ab=t;var xb=t;if(d.substr(t,9).toLowerCase()===ze){var ed=d.substr(t,9);t+=9}else ed=e,0===fa&&b(Ae);if(ed!==e){var ic=t;fa++;var Be=R();fa--;Be===e?ic=void 0:(t=ic,ic=e);ic!==e?(ma=xb,xb="SUBSTRING"):(t=xb,xb=e)}else t=xb,xb=e;if(xb!==e){ja();var Ce=Ja();if(Ce!==e){ja();var Gc=F();if(Gc!==e){ja();var De=Y();if(De!==e){ja();var Hc=F();if(Hc!==e){ja();var ib=t;var yb=t;if(d.substr(t,3).toLowerCase()===
Ee){var fd=d.substr(t,3);t+=3}else fd=e,0===fa&&b(Fe);if(fd!==e){var jc=t;fa++;var Ge=R();fa--;Ge===e?jc=void 0:(t=jc,jc=e);jc!==e?(ma=yb,yb="FOR"):(t=yb,yb=e)}else t=yb,yb=e;var Sb=yb;if(Sb!==e){var He=ja();var gd=F();if(gd!==e){var Ie=ja();ib=Sb=[Sb,He,gd,Ie]}else t=ib,ib=e}else t=ib,ib=e;ib===e&&(ib=null);Sb=Ka();Sb!==e?(ma=ab,ab={type:"function",name:"substring",args:{type:"expression-list",value:ib?[Gc,Hc,ib[2]]:[Gc,Hc]}}):(t=ab,ab=e)}else t=ab,ab=e}else t=ab,ab=e}else t=ab,ab=e}else t=ab,ab=
e}else t=ab,ab=e;La=ab;if(La===e){var Oa=t;var Ic=ba();if(Ic!==e){ja();var Jc=Ja();if(Jc!==e){ja();var jb=la();jb===e&&(jb=null);ja();var Tb=F();if(Tb!==e){ja();var Kc=Y();if(Kc!==e){ja();var hd=F();if(hd!==e){ja();var Je=Ka();Je!==e?(ma=Oa,Oa={type:"function",name:"trim",args:{type:"expression-list",value:[{type:"string",value:null==jb?"BOTH":jb},Tb,hd]}}):(t=Oa,Oa=e)}else t=Oa,Oa=e}else t=Oa,Oa=e}else t=Oa,Oa=e}else t=Oa,Oa=e}else t=Oa,Oa=e;Oa===e&&(Oa=t,Ic=ba(),Ic!==e?(ja(),Jc=Ja(),Jc!==e?(ja(),
jb=la(),jb===e&&(jb=null),ja(),Tb=F(),Tb!==e?(ja(),Kc=Ka(),Kc!==e?(ma=Oa,Oa={type:"function",name:"trim",args:{type:"expression-list",value:[{type:"string",value:null==jb?"BOTH":jb},Tb]}}):(t=Oa,Oa=e)):(t=Oa,Oa=e)):(t=Oa,Oa=e)):(t=Oa,Oa=e));La=Oa;if(La===e){var bb=t;var zb=t;if(d.substr(t,8).toLowerCase()===Ke){var id=d.substr(t,8);t+=8}else id=e,0===fa&&b(Le);if(id!==e){var kc=t;fa++;var Me=R();fa--;Me===e?kc=void 0:(t=kc,kc=e);kc!==e?(ma=zb,zb="POSITION"):(t=zb,zb=e)}else t=zb,zb=e;if(zb!==e){ja();
var Ne=Ja();if(Ne!==e){ja();var jd=F();if(jd!==e){ja();var Oe=X();if(Oe!==e){ja();var kd=F();if(kd!==e){ja();var Pe=Ka();Pe!==e?(ma=bb,bb={type:"function",name:"position",args:{type:"expression-list",value:[jd,kd]}}):(t=bb,bb=e)}else t=bb,bb=e}else t=bb,bb=e}else t=bb,bb=e}else t=bb,bb=e}else t=bb,bb=e;La=bb;if(La===e){var cb=t;var Ab=t;if(d.substr(t,4).toLowerCase()===Qe){var ld=d.substr(t,4);t+=4}else ld=e,0===fa&&b(Re);if(ld!==e){var lc=t;fa++;var Se=R();fa--;Se===e?lc=void 0:(t=lc,lc=e);lc!==
e?(ma=Ab,Ab="CAST"):(t=Ab,Ab=e)}else t=Ab,Ab=e;if(Ab!==e){ja();var Te=Ja();if(Te!==e){ja();var md=F();if(md!==e){ja();var Bb=t;if(d.substr(t,2).toLowerCase()===Ue){var nd=d.substr(t,2);t+=2}else nd=e,0===fa&&b(Ve);if(nd!==e){var mc=t;fa++;var We=R();fa--;We===e?mc=void 0:(t=mc,mc=e);mc!==e?(ma=Bb,Bb="AS"):(t=Bb,Bb=e)}else t=Bb,Bb=e;var Xe=Bb;if(Xe!==e){ja();var Ga=t;var Cb=t;if(d.substr(t,7).toLowerCase()===Ye){var od=d.substr(t,7);t+=7}else od=e,0===fa&&b(Ze);if(od!==e){var nc=t;fa++;var $e=R();
fa--;$e===e?nc=void 0:(t=nc,nc=e);nc!==e?(ma=Cb,Cb="INTEGER"):(t=Cb,Cb=e)}else t=Cb,Cb=e;var Ma=Cb;Ma!==e&&(ma=Ga,Ma={type:"data-type",value:{type:"integer"}});Ga=Ma;if(Ga===e){Ga=t;var Db=t;if(d.substr(t,8).toLowerCase()===af){var pd=d.substr(t,8);t+=8}else pd=e,0===fa&&b(bf);if(pd!==e){var oc=t;fa++;var cf=R();fa--;cf===e?oc=void 0:(t=oc,oc=e);oc!==e?(ma=Db,Db="SMALLINT"):(t=Db,Db=e)}else t=Db,Db=e;Ma=Db;Ma!==e&&(ma=Ga,Ma={type:"data-type",value:{type:"smallint"}});Ga=Ma;if(Ga===e){Ga=t;var Eb=
t;if(d.substr(t,5).toLowerCase()===df){var qd=d.substr(t,5);t+=5}else qd=e,0===fa&&b(ef);if(qd!==e){var pc=t;fa++;var ff=R();fa--;ff===e?pc=void 0:(t=pc,pc=e);pc!==e?(ma=Eb,Eb="FLOAT"):(t=Eb,Eb=e)}else t=Eb,Eb=e;Ma=Eb;Ma!==e&&(ma=Ga,Ma={type:"data-type",value:{type:"float"}});Ga=Ma;if(Ga===e){Ga=t;var Fb=t;if(d.substr(t,4).toLowerCase()===gf){var rd=d.substr(t,4);t+=4}else rd=e,0===fa&&b(hf);if(rd!==e){var qc=t;fa++;var jf=R();fa--;jf===e?qc=void 0:(t=qc,qc=e);qc!==e?(ma=Fb,Fb="REAL"):(t=Fb,Fb=e)}else t=
Fb,Fb=e;Ma=Fb;Ma!==e&&(ma=Ga,Ma={type:"data-type",value:{type:"real"}});Ga=Ma;if(Ga===e&&(Ga=t,Ma=ia(),Ma!==e&&(ma=Ga,Ma={type:"data-type",value:{type:"date"}}),Ga=Ma,Ga===e&&(Ga=t,Ma=da(),Ma!==e&&(ma=Ga,Ma={type:"data-type",value:{type:"timestamp"}}),Ga=Ma,Ga===e&&(Ga=t,Ma=ka(),Ma!==e&&(ma=Ga,Ma={type:"data-type",value:{type:"time"}}),Ga=Ma,Ga===e)))){Ga=t;var Gb=t;if(d.substr(t,7).toLowerCase()===kf){var sd=d.substr(t,7);t+=7}else sd=e,0===fa&&b(lf);if(sd!==e){var rc=t;fa++;var mf=R();fa--;mf===
e?rc=void 0:(t=rc,rc=e);rc!==e?(ma=Gb,Gb="VARCHAR"):(t=Gb,Gb=e)}else t=Gb,Gb=e;Ma=Gb;if(Ma!==e){ja();var nf=Ja();if(nf!==e){ja();var td=r();if(td!==e){ja();var of=Ka();of!==e?(ma=Ga,Ga={type:"data-type",value:{type:"varchar",size:parseInt(td)}}):(t=Ga,Ga=e)}else t=Ga,Ga=e}else t=Ga,Ga=e}else t=Ga,Ga=e}}}}var ud=Ga;if(ud!==e){ja();var pf=Ka();pf!==e?(ma=cb,cb={type:"function",name:"cast",args:{type:"expression-list",value:[md,ud]}}):(t=cb,cb=e)}else t=cb,cb=e}else t=cb,cb=e}else t=cb,cb=e}else t=cb,
cb=e}else t=cb,cb=e;La=cb;if(La===e){var kb=t;var db=t;var Ub=u();Ub!==e&&(ma=db);db=Ub;if(db===e)if(db=t,96===d.charCodeAt(t)?(Ub=vd,t++):(Ub=e,0===fa&&b(wd)),Ub!==e){var sc=[];if(xd.test(d.charAt(t))){var lb=d.charAt(t);t++}else lb=e,0===fa&&b(yd);if(lb!==e)for(;lb!==e;)sc.push(lb),xd.test(d.charAt(t))?(lb=d.charAt(t),t++):(lb=e,0===fa&&b(yd));else sc=e;sc!==e?(96===d.charCodeAt(t)?(lb=vd,t++):(lb=e,0===fa&&b(wd)),lb!==e?(ma=db,db=sc.join("")):(t=db,db=e)):(t=db,db=e)}else t=db,db=e;var zd=db;if(zd!==
e){ja();var qf=Ja();if(qf!==e){ja();var tc=A();tc===e&&(tc=null);ja();var rf=Ka();rf!==e?(ma=kb,kb={type:"function",name:zd,args:tc?tc:{type:"expression-list",value:[]}}):(t=kb,kb=e)}else t=kb,kb=e}else t=kb,kb=e;La=kb;if(La===e){var fb;var Ua=t;var Lc=ya();if(Lc!==e){ja();var Vb=F();if(Vb!==e){ja();var Wb=[];for(fb=Ia();fb!==e;)Wb.push(fb),fb=Ia();fb=ja();var uc=Ha();uc!==e?(ma=Ua,Ua={type:"case-expression",format:"simple",operand:Vb,clauses:Wb,else:null}):(t=Ua,Ua=e)}else t=Ua,Ua=e}else t=Ua,Ua=
e;if(Ua===e)if(Ua=t,Lc=ya(),Lc!==e)if(ja(),Vb=F(),Vb!==e){ja();Wb=[];for(fb=Ia();fb!==e;)Wb.push(fb),fb=Ia();fb=ja();uc=Pa();if(uc!==e){ja();var sf=Ha();sf!==e?(ma=Ua,Ua={type:"case-expression",format:"simple",operand:Vb,clauses:Wb,else:uc.value}):(t=Ua,Ua=e)}else t=Ua,Ua=e}else t=Ua,Ua=e;else t=Ua,Ua=e;var Mc=Ua;if(Mc===e){var gb;var Xa=t;var Nc=ya();if(Nc!==e){ja();var Xb=[];for(gb=Da();gb!==e;)Xb.push(gb),gb=Da();gb=ja();var vc=Ha();vc!==e?(ma=Xa,Xa={type:"case-expression",format:"searched",clauses:Xb,
else:null}):(t=Xa,Xa=e)}else t=Xa,Xa=e;if(Xa===e)if(Xa=t,Nc=ya(),Nc!==e){ja();Xb=[];for(gb=Da();gb!==e;)Xb.push(gb),gb=Da();gb=ja();vc=Pa();if(vc!==e){ja();var tf=Ha();tf!==e?(ma=Xa,Xa={type:"case-expression",format:"searched",clauses:Xb,else:vc.value}):(t=Xa,Xa=e)}else t=Xa,Xa=e}else t=Xa,Xa=e;Mc=Xa}La=Mc;if(La===e){var Hb=t;var uf=t;var wc;var Yb=t;var Ad=D();if(Ad!==e){var Bd=[];for(wc=Q();wc!==e;)Bd.push(wc),wc=Q();ma=Yb;Yb=Ad+Bd.join("")}else t=Yb,Yb=e;var Cd=Yb;Cd!==e&&(ma=uf);var mb=Cd;if(mb!==
e){ma=Hb;var Oc=mb;mb=/^CURRENT_DATE$/i.test(Oc)?{type:"current-time",mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(Oc)?{type:"current-time",mode:"timestamp"}:{type:"column-reference",table:"",column:Oc}}Hb=mb;if(Hb===e){Hb=t;var Ib=t;if(Z()!==e){var xc;var vf=t;var Pc=[];for(xc=U();xc!==e;)Pc.push(xc),xc=U();ma=vf;var wf=Pc=Pc.join("");var xf=Z();xf!==e?(ma=Ib,Ib=wf):(t=Ib,Ib=e)}else t=Ib,Ib=e;mb=Ib;mb!==e&&(ma=Hb,mb={type:"column-reference",table:"",column:mb,delimited:!0});Hb=mb}La=Hb;if(La===e&&(La=
ea(),La===e)){La=t;var yf=Ja();if(yf!==e){ja();var Qc=F();if(Qc!==e){ja();var zf=Ka();zf!==e?(ma=La,Qc.paren=!0,La=Qc):(t=La,La=e)}else t=La,La=e}else t=La,La=e}}}}}}}}}return La}function u(){var J;var T=t;var V=D();if(V!==e){var ca=[];for(J=R();J!==e;)ca.push(J),J=R();ma=T;T=V+ca.join("")}else t=T,T=e;return T}function D(){if(Af.test(d.charAt(t))){var J=d.charAt(t);t++}else J=e,0===fa&&b(Bf);return J}function R(){if(Cf.test(d.charAt(t))){var J=d.charAt(t);t++}else J=e,0===fa&&b(Df);return J}function Q(){if(Dd.test(d.charAt(t))){var J=
d.charAt(t);t++}else J=e,0===fa&&b(Ed);return J}function U(){if(Dd.test(d.charAt(t))){var J=d.charAt(t);t++}else J=e,0===fa&&b(Ed);if(J===e)if(J=t,Z()!==e){var T=Z();T!==e?(ma=J,J='"'):(t=J,J=e)}else t=J,J=e;return J}function Z(){if(Ef.test(d.charAt(t))){var J=d.charAt(t);t++}else J=e,0===fa&&b(Ff);return J}function ea(){var J;var T=J=t;if(64===d.charCodeAt(t)){var V=Gf;t++}else V=e,0===fa&&b(Hf);if(V!==e){var ca=u();ca!==e?T=V=[V,ca]:(t=T,T=e)}else t=T,T=e;T!==e&&(ma=J,T={type:"parameter",value:T[1]});
return T}function la(){var J=t;if(d.substr(t,7).toLowerCase()===If){var T=d.substr(t,7);t+=7}else T=e,0===fa&&b(Jf);if(T!==e){T=t;fa++;var V=R();fa--;V===e?T=void 0:(t=T,T=e);T!==e?(ma=J,J="LEADING"):(t=J,J=e)}else t=J,J=e;J===e&&(J=t,d.substr(t,8).toLowerCase()===Kf?(T=d.substr(t,8),t+=8):(T=e,0===fa&&b(Lf)),T!==e?(T=t,fa++,V=R(),fa--,V===e?T=void 0:(t=T,T=e),T!==e?(ma=J,J="TRAILING"):(t=J,J=e)):(t=J,J=e),J===e&&(J=t,d.substr(t,4).toLowerCase()===Mf?(T=d.substr(t,4),t+=4):(T=e,0===fa&&b(Nf)),T!==
e?(T=t,fa++,V=R(),fa--,V===e?T=void 0:(t=T,T=e),T!==e?(ma=J,J="BOTH"):(t=J,J=e)):(t=J,J=e)));return J}function na(){var J=t;var T=t;var V=ta();if(V!==e){ja();var ca=Ja();if(ca!==e)if(ja(),ca=sa(),ca!==e){ja();var pa=Ka();pa!==e?(ma=T,T={type:"interval-period",period:V.value,precision:ca,secondary:null}):(t=T,T=e)}else t=T,T=e;else t=T,T=e}else t=T,T=e;T===e&&(T=t,V=ta(),V!==e&&(ma=T,V={type:"interval-period",period:V.value,precision:null,secondary:null}),T=V);if(T!==e)if(ja(),V=t,d.substr(t,2).toLowerCase()===
Of?(ca=d.substr(t,2),t+=2):(ca=e,0===fa&&b(Pf)),ca!==e?(ca=t,fa++,pa=R(),fa--,pa===e?ca=void 0:(t=ca,ca=e),ca!==e?(ma=V,V="TO"):(t=V,V=e)):(t=V,V=e),V!==e){ja();V=t;ca=ta();ca!==e&&(ma=V,ca={type:"interval-period",period:ca.value,precision:null,secondary:null});V=ca;if(V===e){V=t;ca=Aa();if(ca!==e)if(ja(),ca=Ja(),ca!==e)if(ja(),ca=sa(),ca!==e)if(ja(),pa=Wa(),pa!==e)if(ja(),pa=ua(),pa!==e){ja();var za=Ka();za!==e?(ma=V,V={type:"interval-period",period:"second",precision:ca,secondary:pa}):(t=V,V=e)}else t=
V,V=e;else t=V,V=e;else t=V,V=e;else t=V,V=e;else t=V,V=e;V===e&&(V=t,ca=Aa(),ca!==e?(ja(),ca=Ja(),ca!==e?(ja(),ca=sa(),ca!==e?(ja(),pa=Ka(),pa!==e?(ma=V,V={type:"interval-period",period:"second",precision:ca,secondary:null}):(t=V,V=e)):(t=V,V=e)):(t=V,V=e)):(t=V,V=e),V===e&&(V=t,ca=Aa(),ca!==e&&(ma=V,ca={type:"interval-period",period:"second",precision:null,secondary:null}),V=ca))}V!==e?(ma=J,J={type:"interval-qualifier",start:T,end:V}):(t=J,J=e)}else t=J,J=e;else t=J,J=e;J===e&&(J=t,V=ta(),V!==
e?(ja(),T=Ja(),T!==e?(ja(),T=ua(),T!==e?(ja(),ca=Ka(),ca!==e?(ma=J,J={type:"interval-period",period:V.value,precision:T,secondary:null}):(t=J,J=e)):(t=J,J=e)):(t=J,J=e)):(t=J,J=e),J===e&&(J=t,V=ta(),V!==e&&(ma=J,V={type:"interval-period",period:V.value,precision:null,secondary:null}),J=V,J===e&&(J=t,V=Aa(),V!==e?(ja(),T=Ja(),T!==e?(ja(),T=sa(),T!==e?(ja(),ca=Wa(),ca!==e?(ja(),V=ua(),V!==e?(ja(),ca=Ka(),ca!==e?(ma=J,J={type:"interval-period",period:"second",precision:T,secondary:V}):(t=J,J=e)):(t=
J,J=e)):(t=J,J=e)):(t=J,J=e)):(t=J,J=e)):(t=J,J=e),J===e&&(J=t,V=Aa(),V!==e?(ja(),T=Ja(),T!==e?(ja(),T=ua(),T!==e?(ja(),ca=Ka(),ca!==e?(ma=J,J={type:"interval-period",period:"second",precision:T,secondary:null}):(t=J,J=e)):(t=J,J=e)):(t=J,J=e)):(t=J,J=e),J===e&&(J=t,V=Aa(),V!==e&&(ma=J,V={type:"interval-period",period:"second",precision:null,secondary:null}),J=V)))));return J}function ta(){var J=t;var T=Ca();T!==e&&(ma=J,T={type:"string",value:"day"});J=T;J===e&&(J=t,T=wa(),T!==e&&(ma=J,T={type:"string",
value:"hour"}),J=T,J===e&&(J=t,T=Ba(),T!==e&&(ma=J,T={type:"string",value:"minute"}),J=T,J===e&&(J=t,T=qa(),T!==e&&(ma=J,T={type:"string",value:"month"}),J=T,J===e&&(J=t,T=oa(),T!==e&&(ma=J,T={type:"string",value:"year"}),J=T))));return J}function ua(){var J=t;var T=r();T!==e&&(ma=J,T=parseFloat(T));return T}function sa(){var J=t;var T=r();T!==e&&(ma=J,T=parseFloat(T));return T}function va(){var J=xa();J===e&&(J=ea());return J}function xa(){var J=t;if(39===d.charCodeAt(t)){var T=Fd;t++}else T=e,0===
fa&&b(Gd);T===e&&(d.substr(t,2)===Hd?(T=Hd,t+=2):(T=e,0===fa&&b(Qf)));if(T!==e){T=[];var V=t;if(d.substr(t,2)===yc){var ca=yc;t+=2}else ca=e,0===fa&&b(Id);ca!==e&&(ma=V,ca="'");V=ca;V===e&&(Jd.test(d.charAt(t))?(V=d.charAt(t),t++):(V=e,0===fa&&b(Kd)));for(;V!==e;)T.push(V),V=t,d.substr(t,2)===yc?(ca=yc,t+=2):(ca=e,0===fa&&b(Id)),ca!==e&&(ma=V,ca="'"),V=ca,V===e&&(Jd.test(d.charAt(t))?(V=d.charAt(t),t++):(V=e,0===fa&&b(Kd)));39===d.charCodeAt(t)?(V=Fd,t++):(V=e,0===fa&&b(Gd));V!==e?(ma=J,J={type:"string",
value:T.join("")}):(t=J,J=e)}else t=J,J=e;return J}function Da(){var J=t;if(Qa()!==e){ja();var T=F();if(T!==e){ja();var V=Ya();V!==e?(ja(),V=F(),V!==e?(ma=J,J={type:"when-clause",operand:T,value:V}):(t=J,J=e)):(t=J,J=e)}else t=J,J=e}else t=J,J=e;return J}function Ia(){var J=t;if(Qa()!==e){ja();var T=F();if(T!==e){ja();var V=Ya();V!==e?(ja(),V=F(),V!==e?(ma=J,J={type:"when-clause",operand:T,value:V}):(t=J,J=e)):(t=J,J=e)}else t=J,J=e}else t=J,J=e;return J}function Pa(){var J=t;var T=t;if(d.substr(t,
4).toLowerCase()===Rf){var V=d.substr(t,4);t+=4}else V=e,0===fa&&b(Sf);if(V!==e){V=t;fa++;var ca=R();fa--;ca===e?V=void 0:(t=V,V=e);V!==e?(ma=T,T="ELSE"):(t=T,T=e)}else t=T,T=e;T!==e?(ja(),T=F(),T!==e?(ma=J,J={type:"else-clause",value:T}):(t=J,J=e)):(t=J,J=e);return J}function Na(){var J=r();if(J===e){J=t;if(45===d.charCodeAt(t)){var T=Cc;t++}else T=e,0===fa&&b(Dc);T===e&&(43===d.charCodeAt(t)?(T=Ac,t++):(T=e,0===fa&&b(Bc)));if(T!==e){var V=r();V!==e?(ma=J,J=T[0]+V):(t=J,J=e)}else t=J,J=e}return J}
function Sa(){var J=t;if(46===d.charCodeAt(t)){var T=Tf;t++}else T=e,0===fa&&b(Uf);T!==e?(T=r(),T===e&&(T=null),ma=J,J="."+(null!=T?T:"")):(t=J,J=e);return J}function Va(){var J;var T=J=t;if(Vf.test(d.charAt(t))){var V=d.charAt(t);t++}else V=e,0===fa&&b(Wf);V!==e?(Xf.test(d.charAt(t))?(V=d.charAt(t),t++):(V=e,0===fa&&b(Yf)),V===e&&(V=null),ma=T,T="e"+(null===V?"":V)):(t=T,T=e);T!==e?(V=r(),V!==e?(ma=J,J=T+V):(t=J,J=e)):(t=J,J=e);return J}function r(){var J=t;var T=[];var V=K();if(V!==e)for(;V!==e;)T.push(V),
V=K();else T=e;T!==e&&(ma=J,T=T.join(""));return T}function K(){if(Zf.test(d.charAt(t))){var J=d.charAt(t);t++}else J=e,0===fa&&b($f);return J}function X(){var J=t;if(d.substr(t,2).toLowerCase()===ag){var T=d.substr(t,2);t+=2}else T=e,0===fa&&b(bg);if(T!==e){T=t;fa++;var V=R();fa--;V===e?T=void 0:(t=T,T=e);T!==e?(ma=J,J="IN"):(t=J,J=e)}else t=J,J=e;return J}function aa(){var J=t;if(d.substr(t,2).toLowerCase()===cg){var T=d.substr(t,2);t+=2}else T=e,0===fa&&b(dg);if(T!==e){T=t;fa++;var V=R();fa--;
V===e?T=void 0:(t=T,T=e);T!==e?(ma=J,J="IS"):(t=J,J=e)}else t=J,J=e;return J}function ha(){var J=t;if(d.substr(t,4).toLowerCase()===eg){var T=d.substr(t,4);t+=4}else T=e,0===fa&&b(fg);if(T!==e){T=t;fa++;var V=R();fa--;V===e?T=void 0:(t=T,T=e);T!==e?(ma=J,J="LIKE"):(t=J,J=e)}else t=J,J=e;return J}function G(){var J=t;if(d.substr(t,3).toLowerCase()===gg){var T=d.substr(t,3);t+=3}else T=e,0===fa&&b(hg);if(T!==e){T=t;fa++;var V=R();fa--;V===e?T=void 0:(t=T,T=e);T!==e?(ma=J,J="NOT"):(t=J,J=e)}else t=J,
J=e;return J}function M(){var J=t;if(d.substr(t,3).toLowerCase()===ig){var T=d.substr(t,3);t+=3}else T=e,0===fa&&b(jg);if(T!==e){T=t;fa++;var V=R();fa--;V===e?T=void 0:(t=T,T=e);T!==e?(ma=J,J="AND"):(t=J,J=e)}else t=J,J=e;return J}function P(){var J=t;if(d.substr(t,2).toLowerCase()===kg){var T=d.substr(t,2);t+=2}else T=e,0===fa&&b(lg);if(T!==e){T=t;fa++;var V=R();fa--;V===e?T=void 0:(t=T,T=e);T!==e?(ma=J,J="OR"):(t=J,J=e)}else t=J,J=e;return J}function W(){var J=t;if(d.substr(t,7).toLowerCase()===
mg){var T=d.substr(t,7);t+=7}else T=e,0===fa&&b(ng);if(T!==e){T=t;fa++;var V=R();fa--;V===e?T=void 0:(t=T,T=e);T!==e?(ma=J,J="BETWEEN"):(t=J,J=e)}else t=J,J=e;return J}function Y(){var J=t;if(d.substr(t,4).toLowerCase()===og){var T=d.substr(t,4);t+=4}else T=e,0===fa&&b(pg);if(T!==e){T=t;fa++;var V=R();fa--;V===e?T=void 0:(t=T,T=e);T!==e?(ma=J,J="FROM"):(t=J,J=e)}else t=J,J=e;return J}function ba(){var J=t;if(d.substr(t,4).toLowerCase()===qg){var T=d.substr(t,4);t+=4}else T=e,0===fa&&b(rg);if(T!==
e){T=t;fa++;var V=R();fa--;V===e?T=void 0:(t=T,T=e);T!==e?(ma=J,J="TRIM"):(t=J,J=e)}else t=J,J=e;return J}function da(){var J=t;if(d.substr(t,9).toLowerCase()===sg){var T=d.substr(t,9);t+=9}else T=e,0===fa&&b(tg);if(T!==e){T=t;fa++;var V=R();fa--;V===e?T=void 0:(t=T,T=e);T!==e?(ma=J,J="TIMESTAMP"):(t=J,J=e)}else t=J,J=e;return J}function ia(){var J=t;if(d.substr(t,4).toLowerCase()===ug){var T=d.substr(t,4);t+=4}else T=e,0===fa&&b(vg);if(T!==e){T=t;fa++;var V=R();fa--;V===e?T=void 0:(t=T,T=e);T!==
e?(ma=J,J="DATE"):(t=J,J=e)}else t=J,J=e;return J}function ka(){var J=t;if(d.substr(t,4).toLowerCase()===wg){var T=d.substr(t,4);t+=4}else T=e,0===fa&&b(xg);if(T!==e){T=t;fa++;var V=R();fa--;V===e?T=void 0:(t=T,T=e);T!==e?(ma=J,J="TIME"):(t=J,J=e)}else t=J,J=e;return J}function ra(){var J=t;if(d.substr(t,8).toLowerCase()===yg){var T=d.substr(t,8);t+=8}else T=e,0===fa&&b(zg);if(T!==e){T=t;fa++;var V=R();fa--;V===e?T=void 0:(t=T,T=e);T!==e?(ma=J,J="INTERVAL"):(t=J,J=e)}else t=J,J=e;return J}function oa(){var J=
t;if(d.substr(t,4).toLowerCase()===Ag){var T=d.substr(t,4);t+=4}else T=e,0===fa&&b(Bg);if(T!==e){T=t;fa++;var V=R();fa--;V===e?T=void 0:(t=T,T=e);T!==e?(ma=J,J="YEAR"):(t=J,J=e)}else t=J,J=e;return J}function qa(){var J=t;if(d.substr(t,5).toLowerCase()===Cg){var T=d.substr(t,5);t+=5}else T=e,0===fa&&b(Dg);if(T!==e){T=t;fa++;var V=R();fa--;V===e?T=void 0:(t=T,T=e);T!==e?(ma=J,J="MONTH"):(t=J,J=e)}else t=J,J=e;return J}function Ca(){var J=t;if(d.substr(t,3).toLowerCase()===Eg){var T=d.substr(t,3);t+=
3}else T=e,0===fa&&b(Fg);if(T!==e){T=t;fa++;var V=R();fa--;V===e?T=void 0:(t=T,T=e);T!==e?(ma=J,J="DAY"):(t=J,J=e)}else t=J,J=e;return J}function wa(){var J=t;if(d.substr(t,4).toLowerCase()===Gg){var T=d.substr(t,4);t+=4}else T=e,0===fa&&b(Hg);if(T!==e){T=t;fa++;var V=R();fa--;V===e?T=void 0:(t=T,T=e);T!==e?(ma=J,J="HOUR"):(t=J,J=e)}else t=J,J=e;return J}function Ba(){var J=t;if(d.substr(t,6).toLowerCase()===Ig){var T=d.substr(t,6);t+=6}else T=e,0===fa&&b(Jg);if(T!==e){T=t;fa++;var V=R();fa--;V===
e?T=void 0:(t=T,T=e);T!==e?(ma=J,J="MINUTE"):(t=J,J=e)}else t=J,J=e;return J}function Aa(){var J=t;if(d.substr(t,6).toLowerCase()===Kg){var T=d.substr(t,6);t+=6}else T=e,0===fa&&b(Lg);if(T!==e){T=t;fa++;var V=R();fa--;V===e?T=void 0:(t=T,T=e);T!==e?(ma=J,J="SECOND"):(t=J,J=e)}else t=J,J=e;return J}function ya(){var J=t;if(d.substr(t,4).toLowerCase()===Mg){var T=d.substr(t,4);t+=4}else T=e,0===fa&&b(Ng);if(T!==e){T=t;fa++;var V=R();fa--;V===e?T=void 0:(t=T,T=e);T!==e?(ma=J,J="CASE"):(t=J,J=e)}else t=
J,J=e;return J}function Ha(){var J=t;if(d.substr(t,3).toLowerCase()===Og){var T=d.substr(t,3);t+=3}else T=e,0===fa&&b(Pg);if(T!==e){T=t;fa++;var V=R();fa--;V===e?T=void 0:(t=T,T=e);T!==e?(ma=J,J="END"):(t=J,J=e)}else t=J,J=e;return J}function Qa(){var J=t;if(d.substr(t,4).toLowerCase()===Qg){var T=d.substr(t,4);t+=4}else T=e,0===fa&&b(Rg);if(T!==e){T=t;fa++;var V=R();fa--;V===e?T=void 0:(t=T,T=e);T!==e?(ma=J,J="WHEN"):(t=J,J=e)}else t=J,J=e;return J}function Ya(){var J=t;if(d.substr(t,4).toLowerCase()===
Sg){var T=d.substr(t,4);t+=4}else T=e,0===fa&&b(Tg);if(T!==e){T=t;fa++;var V=R();fa--;V===e?T=void 0:(t=T,T=e);T!==e?(ma=J,J="THEN"):(t=J,J=e)}else t=J,J=e;return J}function Wa(){if(44===d.charCodeAt(t)){var J=Ug;t++}else J=e,0===fa&&b(Vg);return J}function Ja(){if(40===d.charCodeAt(t)){var J=Wg;t++}else J=e,0===fa&&b(Xg);return J}function Ka(){if(41===d.charCodeAt(t)){var J=Yg;t++}else J=e,0===fa&&b(Zg);return J}function ja(){var J;var T=[];for(J=Ra();J!==e;)T.push(J),J=Ra();return T}function Ra(){if($g.test(d.charAt(t))){var J=
d.charAt(t);t++}else J=e,0===fa&&b(ah);return J}function Nb(J,T,V,ca){J={type:"binary-expression",operator:J,left:T,right:V};void 0!==ca&&(J.escape=ca);return J}function nb(J,T){for(var V=0;V<T.length;V++)J=Nb(T[V][1],J,T[V][3]);return J}m=void 0!==m?m:{};var e={},Mb=m.grammarSource,Ld={start:q},Md=q,Nd="!",Sc="\x3d",Uc="\x3e\x3d",Sd="\x3e",Vc="\x3c\x3d",Wc="\x3c\x3e",Wd="\x3c",Xc="!\x3d",Ac="+",Cc="-",Yc="||",$d="*",be="/",Gf="@",Fd="'",Hd="N'",yc="''",Tf=".",ke="null",de="true",ge="false",ag="in",
cg="is",eg="like",Pd="escape",gg="not",ig="and",kg="or",mg="between",og="from",Ee="for",ze="substring",ne="extract",qg="trim",Ke="position",sg="timestamp",ug="date",wg="time",If="leading",Kf="trailing",Mf="both",Qe="cast",Ue="as",Ye="integer",af="smallint",df="float",gf="real",kf="varchar",Of="to",yg="interval",Ag="year",re="timezone_hour",ue="timezone_minute",Cg="month",Eg="day",Gg="hour",Ig="minute",Kg="second",Mg="case",Og="end",Qg="when",Sg="then",Rf="else",Ug=",",Wg="(",Yg=")",vd="`",Af=/^[A-Za-z_\x80-\uFFFF]/,
Cf=/^[A-Za-z0-9_]/,Dd=/^[A-Za-z0-9_.\x80-\uFFFF]/,Ef=/^["]/,Jd=/^[^']/,Zf=/^[0-9]/,Vf=/^[eE]/,Xf=/^[+\-]/,$g=/^[ \t\n\r]/,xd=/^[^`]/,Od=B("!",!1),Tc=B("\x3d",!1),Rd=B("\x3e\x3d",!1),Td=B("\x3e",!1),Ud=B("\x3c\x3d",!1),Vd=B("\x3c\x3e",!1),Xd=B("\x3c",!1),Yd=B("!\x3d",!1),Bc=B("+",!1),Dc=B("-",!1),Zd=B("||",!1),ae=B("*",!1),ce=B("/",!1),Bf=E([["A","Z"],["a","z"],"_",["\u0080","\uffff"]],!1,!1),Df=E([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),Ed=E([["A","Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],
!1,!1),Ff=E(['"'],!1,!1),Hf=B("@",!1),Gd=B("'",!1),Qf=B("N'",!1),Id=B("''",!1),Kd=E(["'"],!0,!1),Uf=B(".",!1),$f=E([["0","9"]],!1,!1),Wf=E(["e","E"],!1,!1),Yf=E(["+","-"],!1,!1),le=B("NULL",!0),ee=B("TRUE",!0),he=B("FALSE",!0),bg=B("IN",!0),dg=B("IS",!0),fg=B("LIKE",!0),Qd=B("ESCAPE",!0),hg=B("NOT",!0),jg=B("AND",!0),lg=B("OR",!0),ng=B("BETWEEN",!0),pg=B("FROM",!0),Fe=B("FOR",!0),Ae=B("SUBSTRING",!0),oe=B("EXTRACT",!0),rg=B("TRIM",!0),Le=B("POSITION",!0),tg=B("TIMESTAMP",!0),vg=B("DATE",!0),xg=B("TIME",
!0),Jf=B("LEADING",!0),Lf=B("TRAILING",!0),Nf=B("BOTH",!0),Re=B("CAST",!0),Ve=B("AS",!0),Ze=B("INTEGER",!0),bf=B("SMALLINT",!0),ef=B("FLOAT",!0),hf=B("REAL",!0),lf=B("VARCHAR",!0),Pf=B("TO",!0),zg=B("INTERVAL",!0),Bg=B("YEAR",!0),se=B("TIMEZONE_HOUR",!0),ve=B("TIMEZONE_MINUTE",!0),Dg=B("MONTH",!0),Fg=B("DAY",!0),Hg=B("HOUR",!0),Jg=B("MINUTE",!0),Lg=B("SECOND",!0),Ng=B("CASE",!0),Pg=B("END",!0),Rg=B("WHEN",!0),Tg=B("THEN",!0),Sf=B("ELSE",!0),Vg=B(",",!1),Xg=B("(",!1),Zg=B(")",!1),ah=E([" ","\t","\n",
"\r"],!1,!1),wd=B("`",!1),yd=E(["`"],!0,!1),t=0,ma=0,Zb=[{line:1,column:1}],eb=0,zc=[],fa=0;if("startRule"in m){if(!(m.startRule in Ld))throw Error("Can't start parsing from rule \""+m.startRule+'".');Md=Ld[m.startRule]}var Rc=Md();if(Rc!==e&&t===d.length)return Rc;Rc!==e&&t<d.length&&b({type:"end"});throw function(J,T,V){return new g(g.buildMessage(J,T),J,T,V)}(zc,eb<d.length?d.charAt(eb):null,eb<d.length?f(eb,eb+1):f(eb,eb));}}})})(w);var v=w.exports;class I{static parse(n){return v.parse(n)}}a.WhereGrammar=
I;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/fieldType":function(){define(["exports","../../core/jsonMap"],function(a,c){c=new c.JSONMap({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",
esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml",esriFieldTypeBigInteger:"big-integer",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimeOnly:"time-only",esriFieldTypeTimestampOffset:"timestamp-offset"});a.kebabDict=c;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/projectionSupport":function(){define("exports ../../../core/arrayUtils ../../../core/promiseUtils ../../../geometry/projection ../../../geometry/geometryAdapters/json ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),
function(a,c,w,v,I,n,g){function z(b,q){if(!q)return null;if("x"in q){var A={x:0,y:0};[A.x,A.y]=b(q.x,q.y,x);null!=q.z&&(A.z=q.z);null!=q.m&&(A.m=q.m);return A}return"xmin"in q?(A={xmin:0,ymin:0,xmax:0,ymax:0},[A.xmin,A.ymin]=b(q.xmin,q.ymin,x),[A.xmax,A.ymax]=b(q.xmax,q.ymax,x),q.hasZ&&(A.zmin=q.zmin,A.zmax=q.zmax,A.hasZ=!0),q.hasM&&(A.mmin=q.mmin,A.mmax=q.mmax,A.hasM=!0),A):"rings"in q?{rings:d(q.rings,b),hasM:q.hasM,hasZ:q.hasZ}:"paths"in q?{paths:d(q.paths,b),hasM:q.hasM,hasZ:q.hasZ}:"points"in
q?{points:m(q.points,b),hasM:q.hasM,hasZ:q.hasZ}:null}function d(b,q){const A=[];for(const F of b)A.push(m(F,q));return A}function m(b,q){const A=[];for(const F of b)b=q(F[0],F[1],[0,0]),A.push(b),2<F.length&&b.push(F[2]),3<F.length&&b.push(F[3]);return A}const x=[0,0],B=z.bind(null,g.lngLatToXY),E=z.bind(null,g.xyToLngLat);class p{constructor(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}async push(b,q,A,F){if(!b?.length||!q||!A||n.equals(q,A))return b;b={geometries:b,inSpatialReference:q,
outSpatialReference:A,geographicTransformation:F,resolve:w.createResolver()};this._jobs.push(b);this._timer??(this._timer=setTimeout(this._process,10));return b.resolve.promise}_process(){this._timer=null;const b=this._jobs.shift();if(b){var {geometries:q,inSpatialReference:A,outSpatialReference:F,resolve:L,geographicTransformation:h}=b;g.canProject(A,F)?n.isWebMercator(F)?L(q.map(B)):L(q.map(E)):L(v.projectMany(I.jsonAdapter,q,A,F,h,null));0<this._jobs.length&&(this._timer=setTimeout(this._process,
10))}}}const f=new p;a.checkProjectionSupport=async function(b,q){b&&q&&(b=Array.isArray(b)?b.map(A=>null!=A.geometry?A.geometry.spatialReference:null).filter(c.isSome):[b],await v.initializeProjection(b.map(A=>({source:A,dest:q}))))};a.project=function(b,q,A,F){if(!b)return b;A||(A=q,q=b.spatialReference);return n.isValid(q)&&n.isValid(A)&&!n.equals(q,A)?g.canProject(q,A)?(b=n.isWebMercator(A)?B(b):E(b),b.spatialReference=A,b):v.projectMany(I.jsonAdapter,[b],q,A,null,F)[0]:b};a.projectMany=function(b,
q,A,F){return f.push(b,q,A,F)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/geometryAdapters/json":function(){define(["exports"],function(a){class c{constructor(g,z,d){this.x=g;this.y=z;this.spatialReference=d;this.m=this.z=void 0}}class w{constructor(g,z,d,m){this.rings=g;this.spatialReference=z;this.hasM=this.hasZ=void 0;d&&(this.hasZ=d);m&&(this.hasM=m)}}class v{constructor(g,z,d,m){this.paths=g;this.spatialReference=z;this.hasM=this.hasZ=void 0;d&&(this.hasZ=
d);m&&(this.hasM=m)}}class I{constructor(g,z,d,m){this.points=g;this.spatialReference=z;this.hasM=this.hasZ=void 0;d&&(this.hasZ=d);m&&(this.hasM=m)}}class n{constructor(g,z,d,m,x){this.xmin=g;this.ymin=z;this.xmax=d;this.ymax=m;this.spatialReference=x;this.mmax=this.mmin=this.zmax=this.zmin=void 0}}a.jsonAdapter={convertToGEGeometry:function(g,z){return null==z?null:g.convertJSONToGeometry(z)},exportPoint:function(g,z,d){d=new c(g.getPointX(z),g.getPointY(z),d);const m=g.hasZ(z),x=g.hasM(z);m&&(d.z=
g.getPointZ(z));x&&(d.m=g.getPointM(z));return d},exportPolygon:function(g,z,d){return new w(g.exportPaths(z),d,g.hasZ(z),g.hasM(z))},exportPolyline:function(g,z,d){return new v(g.exportPaths(z),d,g.hasZ(z),g.hasM(z))},exportMultipoint:function(g,z,d){return new I(g.exportPoints(z),d,g.hasZ(z),g.hasM(z))},exportExtent:function(g,z,d){var m=g.hasZ(z);const x=g.hasM(z);d=new n(g.getXMin(z),g.getYMin(z),g.getXMax(z),g.getYMax(z),d);m&&(m=g.getZExtent(z),d.zmin=m.vmin,d.zmax=m.vmax);x&&(g=g.getMExtent(z),
d.mmin=g.vmin,d.mmax=g.vmax);return d}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/QueryEngineCapabilities":function(){define(["exports"],function(a){a.queryCapabilities={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,
supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByAnonymous:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsCompactGeometry:!1,
maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/QueryEngineResult":function(){define("require exports ../../../core/lang ../../../geometry/support/centroid ../../../geometry/support/extentUtils ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ./AttributesBuilder ./geometryUtils ./projectionSupport ./SnappingCandidate ../../support/fieldUtils ../../../statistics/utils".split(" "),
function(a,c,w,v,I,n,g,z,d,m,x,B,E){function p(A,F,L,h){const H=h.x-L.x;h=h.y-L.y;F=Math.min(1,Math.max(0,((F.x-L.x)*H+(F.y-L.y)*h)/(H*H+h*h)));A.x=L.x+H*F;A.y=L.y+h*F}function f(A,F){return A?F?4:3:F?3:2}class b{constructor(A,F,L){this.items=A;this.query=F;this.geometryType=L.geometryType;this.hasM=L.hasM;this.hasZ=L.hasZ;this.fieldsIndex=L.fieldsIndex;this.objectIdField=L.objectIdField;this.spatialReference=L.spatialReference;this.featureAdapter=L.featureAdapter}get size(){return this.items.length}createQueryResponseForCount(){const A=
new z(this.query,this.featureAdapter,this.fieldsIndex);if(!this.query.outStatistics)return A.countDistinctValues(this.items);const {groupByFieldsForStatistics:F,having:L,outStatistics:h}=this.query;if(!F?.length)return 1;const H=new Map,S=new Map,C=new Set;for(const N of h){var {statisticType:k}=N;k="exceedslimit"!==k?N.onStatisticField:void 0;if(!S.has(k)){var y=[];for(const l of F){const O=this._getAttributeValues(A,l,H);y.push(O)}S.set(k,this._calculateUniqueValues(y,A.returnDistinctValues))}k=
S.get(k);for(const l in k){const {data:O,items:u}=k[l];y=O.join(",");L&&!A.validateItems(u,L)||C.add(y)}}return C.size}async createQueryResponse(){let A;A=this.query.outStatistics?this.query.outStatistics.some(F=>"exceedslimit"===F.statisticType)?this._createExceedsLimitQueryResponse(this.query):await this._createStatisticsQueryResponse(this.query):this._createFeatureQueryResponse(this.query);if(this.query.returnQueryGeometry){const F=this.query.geometry;g.isValid(this.query.outSR)&&!g.equals(F.spatialReference,
this.query.outSR)?A.queryGeometry=d.cleanFromGeometryEngine({spatialReference:this.query.outSR,...m.project(F,F.spatialReference,this.query.outSR)}):A.queryGeometry=d.cleanFromGeometryEngine({spatialReference:this.query.outSR,...F})}return A}createSnappingResponse(A,F){const L=this.featureAdapter,h=f(this.hasZ,this.hasM),{point:H,mode:S}=A,C="number"===typeof A.distance?A.distance:A.distance.x,k="number"===typeof A.distance?A.distance:A.distance.y,y={candidates:[]},N="esriGeometryPolygon"===this.geometryType;
F=this._getPointCreator(S,this.spatialReference,F);const l=new q(null,0),O=new q(null,0),u={x:0,y:0,z:0};for(const la of this.items){var D=L.getGeometry(la);if(null==D)continue;const {coords:na,lengths:ta}=D;l.coords=na;O.coords=na;if(A.returnEdge){D=0;for(var R=0;R<ta.length;R++){var Q=ta[R];for(var U=0;U<Q;U++,D+=h){var Z=l;Z.coordsIndex=D;if(U!==Q-1){const ua=O;ua.coordsIndex=D+h;const sa=u;p(u,H,Z,ua);var ea=(H.x-sa.x)/C;const va=(H.y-sa.y)/k;ea=ea*ea+va*va;1>=ea&&y.candidates.push(x.makeEdgeCandidate(L.getObjectId(la),
F(sa),Math.sqrt(ea),F(Z),F(ua)))}}}}if("none"!==A.vertexMode)if(D=N?na.length-h:na.length,"all"===A.vertexMode)for(R=0;R<D;R+=h)Q=l,Q.coordsIndex=R,U=(H.x-Q.x)/C,Z=(H.y-Q.y)/k,U=U*U+Z*Z,1>=U&&y.candidates.push(x.makeVertexCandidate(L.getObjectId(la),F(Q),Math.sqrt(U)));else if("ends"===A.vertexMode){D=[0];N||D.push(na.length-h);for(const ua of D)D=l,D.coordsIndex=ua,R=(H.x-D.x)/C,Q=(H.y-D.y)/k,R=R*R+Q*Q,1>=R&&y.candidates.push(x.makeVertexCandidate(L.getObjectId(la),F(D),Math.sqrt(R)))}}y.candidates.sort((la,
na)=>la.distance-na.distance);return y}_getPointCreator(A,F,L){const h=null==L||g.equals(F,L)?S=>S:S=>m.project(S,F,L),{hasZ:H}=this;return"3d"===A?H?({x:S,y:C,z:k})=>h({x:S,y:C,z:k}):({x:S,y:C})=>h({x:S,y:C,z:0}):({x:S,y:C})=>h({x:S,y:C})}async createSummaryStatisticsResponse(A){const {field:F,valueExpression:L,normalizationField:h,normalizationType:H,normalizationTotal:S,minValue:C,maxValue:k,scale:y,timeZone:N}=A;var l=this.fieldsIndex.get(F);A=B.isDateField(l)||B.isDateOnlyField(l)||B.isTimestampOffsetField(l);
const O=await this._getDataValues({field:F,valueExpression:L,normalizationField:h,normalizationType:H,normalizationTotal:S,scale:y,timeZone:N}),u=E.isNullCountSupported({normalizationType:H,normalizationField:h,minValue:C,maxValue:k}),D={value:.5,fieldType:l?.type};l=B.isStringField(l)?E.calculateStringStatistics({values:O,supportsNullCount:u,percentileParams:D}):E.calculateStatistics({values:O,minValue:C,maxValue:k,useSampleStdDev:!H,supportsNullCount:u,percentileParams:D});return E.processSummaryStatisticsResult(l,
A)}async createUniqueValuesResponse(A){const {field:F,valueExpression:L,domains:h,returnAllCodedValues:H,scale:S,timeZone:C}=A;var k=await this._getDataValues({field:F,field2:A.field2,field3:A.field3,fieldDelimiter:A.fieldDelimiter,valueExpression:L,scale:S,timeZone:C},!1);k=E.calculateUniqueValuesCount(k);return E.createUVResult(k,h,H,A.fieldDelimiter)}async createClassBreaksResponse(A){const {field:F,valueExpression:L,normalizationField:h,normalizationType:H,normalizationTotal:S,classificationMethod:C,
standardDeviationInterval:k,minValue:y,maxValue:N,numClasses:l,scale:O,timeZone:u}=A;A=await this._getDataValues({field:F,valueExpression:L,normalizationField:h,normalizationType:H,normalizationTotal:S,scale:O,timeZone:u});A=E.calculateClassBreaks(A,{field:F,normalizationField:h,normalizationType:H,normalizationTotal:S,classificationMethod:C,standardDeviationInterval:k,minValue:y,maxValue:N,numClasses:l});return E.resolveCBResult(A,C)}async createHistogramResponse(A){const {field:F,valueExpression:L,
normalizationField:h,normalizationType:H,normalizationTotal:S,classificationMethod:C,standardDeviationInterval:k,minValue:y,maxValue:N,numBins:l,scale:O,timeZone:u}=A;A=await this._getDataValues({field:F,valueExpression:L,normalizationField:h,normalizationType:H,normalizationTotal:S,scale:O,timeZone:u});return E.calculateHistogram(A,{field:F,normalizationField:h,normalizationType:H,normalizationTotal:S,classificationMethod:C,standardDeviationInterval:k,minValue:y,maxValue:N,numBins:l})}_sortFeatures(A,
F,L){if(1<A.length&&F?.length)for(const h of F.reverse()){F=h.split(" ");const H=F[0],S=this.fieldsIndex.get(H);F=F[1]?"desc"===F[1].toLowerCase():!1;const C=E.getAttributeComparator(S?.type,F);A.sort((k,y)=>{k=L(k,H,S);y=L(y,H,S);return C(k,y)})}}_createFeatureQueryResponse(A){const F=this.items,{geometryType:L,hasM:h,hasZ:H,objectIdField:S,spatialReference:C}=this,{outFields:k,outSR:y,quantizationParameters:N,resultRecordCount:l,resultOffset:O,returnZ:u,returnM:D}=A,R=null!=l?F.length>(O||0)+l:
!1,Q=k&&(k.includes("*")?[...this.fieldsIndex.fields]:k.map(U=>this.fieldsIndex.get(U)));return{exceededTransferLimit:R,features:this._createFeatures(A,F),fields:Q,geometryType:L,hasM:h&&D,hasZ:H&&u,objectIdFieldName:S,spatialReference:d.cleanFromGeometryEngine(y||C),transform:N&&n.toQuantizationTransform(N)||null}}_createFeatures(A,F){const L=new z(A,this.featureAdapter,this.fieldsIndex),{hasM:h,hasZ:H}=this,{orderByFields:S,quantizationParameters:C,returnGeometry:k,returnCentroid:y,maxAllowableOffset:N,
resultOffset:l,resultRecordCount:O,returnZ:u=!1,returnM:D=!1}=A,R=H&&u,Q=h&&D;A=[];var U=0;F=[...F];this._sortFeatures(F,S,(la,na,ta)=>L.getFieldValue(la,na,ta));if(this.geometryType&&(k||y)){var Z=n.toQuantizationTransform(C)??void 0;if(k&&!y)for(var ea of F)A[U++]={attributes:L.getAttributes(ea),geometry:d.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(ea),N,Z,R,Q)};else if(!k&&y)for(const la of F)A[U++]={attributes:L.getAttributes(la),centroid:d.transformCentroid(this,
this.featureAdapter.getCentroid(la,this),Z)};else for(const la of F)A[U++]={attributes:L.getAttributes(la),centroid:d.transformCentroid(this,this.featureAdapter.getCentroid(la,this),Z),geometry:d.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(la),N,Z,R,Q)}}else for(Z of F)(ea=L.getAttributes(Z))&&(A[U++]={attributes:ea});U=l||0;null!=O&&(A=A.slice(U,Math.min(A.length,U+O)));return A}_createExceedsLimitQueryResponse(A){var F=!1;let L=Number.POSITIVE_INFINITY,h=Number.POSITIVE_INFINITY;
F=Number.POSITIVE_INFINITY;for(const H of A.outStatistics??[])if("exceedslimit"===H.statisticType){L=null!=H.maxPointCount?H.maxPointCount:Number.POSITIVE_INFINITY;h=null!=H.maxRecordCount?H.maxRecordCount:Number.POSITIVE_INFINITY;F=null!=H.maxVertexCount?H.maxVertexCount:Number.POSITIVE_INFINITY;break}if("esriGeometryPoint"===this.geometryType)F=this.items.length>L;else if(this.items.length>h)F=!0;else{A=f(this.hasZ,this.hasM);const H=this.featureAdapter;F=this.items.reduce((S,C)=>{C=H.getGeometry(C);
return S+(null!=C&&C.coords.length||0)},0)/A>F}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(F)}}]}}async _createStatisticsQueryResponse(A){var F={attributes:{}};const L=[],h=new Map,H=new Map,S=new Map,C=new Map,k=new z(A,this.featureAdapter,this.fieldsIndex);var y=A.outStatistics;const {groupByFieldsForStatistics:N,having:l,orderByFields:O,resultRecordCount:u}=
A;A=N?.length;const D=!!A,R=D?N[0]:null,Q=D&&!this.fieldsIndex.get(R);for(const na of y??[]){const {outStatisticFieldName:ta,statisticType:ua}=na;y=na;const sa="exceedslimit"!==ua?na.onStatisticField:void 0,va="percentile_disc"===ua||"percentile_cont"===ua;var U="EnvelopeAggregate"===ua||"CentroidAggregate"===ua||"ConvexHullAggregate"===ua;const xa=D&&1===A&&(sa===R||Q)&&"count"===ua;if(D){if(!S.has(sa)){var Z=[];for(const Da of N){var ea=this._getAttributeValues(k,Da,h);Z.push(ea)}S.set(sa,this._calculateUniqueValues(Z,
U?!1:k.returnDistinctValues))}Z=S.get(sa);if(!Z)continue;ea=Object.keys(Z);for(const Da of ea){const {count:Ia,data:Pa,items:Na,itemPositions:Sa}=Z[Da];ea=Pa.join(",");if(!l||k.validateItems(Na,l)){const Va=C.get(ea)||{attributes:{}};if(U){Va.aggregateGeometries||(Va.aggregateGeometries={});const {aggregateGeometries:K,outStatisticFieldName:X}=await this._getAggregateGeometry(y,Na);Va.aggregateGeometries[X]=K}else{var la=null;if(xa)la=Ia;else{const K=this._getAttributeValues(k,sa,h);la=Sa.map(X=>
K[X]);la=va&&"statisticParameters"in y?this._getPercentileValue(y,la):this._getStatisticValue(y,la,null,k.returnDistinctValues)}Va.attributes[ta]=la}let r=0;N.forEach((K,X)=>Va.attributes[this.fieldsIndex.get(K)?K:`EXPR_${++r}`]=Pa[X]);C.set(ea,Va)}}}else if(U){F.aggregateGeometries||(F.aggregateGeometries={});const {aggregateGeometries:Da,outStatisticFieldName:Ia}=await this._getAggregateGeometry(y,this.items);F.aggregateGeometries[Ia]=Da}else U=this._getAttributeValues(k,sa,h),F.attributes[ta]=
va&&"statisticParameters"in y?this._getPercentileValue(y,U):this._getStatisticValue(y,U,H,k.returnDistinctValues);y="min"!==ua&&"max"!==ua||!B.isStringField(this.fieldsIndex.get(sa))&&!this._isAnyDateField(sa)?null:this.fieldsIndex.get(sa)?.type;L.push({name:ta,alias:ta,type:y||"esriFieldTypeDouble"})}F=D?Array.from(C.values()):[F];this._sortFeatures(F,O,(na,ta)=>na.attributes[ta]);u&&(F.length=Math.min(u,F.length));return{fields:L,features:F}}_isAnyDateField(A){A=this.fieldsIndex.get(A);return B.isDateField(A)||
B.isDateOnlyField(A)||B.isTimestampOffsetField(A)||B.isTimeOnlyField(A)}async _getAggregateGeometry(A,F){const {convexHull:L,union:h}=await new Promise((u,D)=>a(["../../../geometry/geometryEngineJSON"],u,D)),{statisticType:H,outStatisticFieldName:S}=A,{featureAdapter:C,spatialReference:k,geometryType:y,hasZ:N,hasM:l}=this;F=F.map(u=>d.getGeometry(y,N,l,C.getGeometry(u)));const O=L(k,F,!0)[0];A={aggregateGeometries:null,outStatisticFieldName:null};"EnvelopeAggregate"===H?(F=O?I.getPolygonExtent(O):
I.getGeometryExtent(h(k,F)),A.aggregateGeometries={...F,spatialReference:k},A.outStatisticFieldName=S||"extent"):"CentroidAggregate"===H?(F=O?v.polygonCentroid(O):v.extentCentroid(I.getGeometryExtent(h(k,F))),A.aggregateGeometries={x:F[0],y:F[1],spatialReference:k},A.outStatisticFieldName=S||"centroid"):"ConvexHullAggregate"===H&&(A.aggregateGeometries=O,A.outStatisticFieldName=S||"convexHull");return A}_getStatisticValue(A,F,L,h){const {onStatisticField:H,statisticType:S}=A;A=null;A=L?.has(H)?L.get(H):
B.isStringField(this.fieldsIndex.get(H))||this._isAnyDateField(H)?E.calculateStringStatistics({values:F,returnDistinct:h}):E.calculateStatistics({values:h?[...(new Set(F))]:F,minValue:null,maxValue:null,useSampleStdDev:!0});L&&L.set(H,A);return A["var"===S?"variance":S]}_getPercentileValue(A,F){const {onStatisticField:L,statisticParameters:h,statisticType:H}=A,{value:S,orderBy:C}=h;A=this.fieldsIndex.get(L);return E.calculatePercentile(F,{value:S,orderBy:C,fieldType:A?.type,isDiscrete:"percentile_disc"===
H})}_getAttributeValues(A,F,L){if(L.has(F))return L.get(F);const h=this.fieldsIndex.get(F),H=this.items.map(S=>A.getFieldValue(S,F,h));L.set(F,H);return H}_calculateUniqueValues(A,F){const L={},h=this.items,H=h.length;for(let S=0;S<H;S++){const C=h[S],k=[];for(const N of A)k.push(N[S]);const y=k.join(",");null==L[y]?L[y]={count:1,data:k,items:[C],itemPositions:[S]}:(F||L[y].count++,L[y].items.push(C),L[y].itemPositions.push(S))}return L}async _getDataValues(A,F=!0){const L=new z(this.query,this.featureAdapter,
this.fieldsIndex),{valueExpression:h,scale:H,timeZone:S}=A;return h?L.getExpressionValues(this.items,h,{viewingMode:"map",scale:H,spatialReference:this.query.outSR||this.spatialReference},{geometryType:this.geometryType,hasZ:this.hasZ,hasM:this.hasM},S):L.getDataValues(this.items,w.clone(A),F)}}class q{constructor(A,F){this.coords=A;this.coordsIndex=F}get x(){return this.coords[this.coordsIndex]}get y(){return this.coords[this.coordsIndex+1]}get z(){return this.coords[this.coordsIndex+2]}}c.QueryEngineResult=
b;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/quantizationUtils":function(){define(["exports","./jsonUtils"],function(a,c){function w({scale:y,translate:N},l){return Math.round((l-N[0])/y[0])}function v({scale:y,translate:N},l){return Math.round((N[1]-l)/y[1])}function I(y,N,l){const O=[];let u,D,R,Q;for(let U=0;U<l.length;U++){const Z=l[U];if(0<U){if(R=w(y,Z[0]),Q=v(y,Z[1]),R!==u||Q!==D)O.push(N(Z,R-u,Q-D)),u=R,D=Q}else u=w(y,Z[0]),D=v(y,Z[1]),O.push(N(Z,
u,D))}return 0<O.length?O:null}function n(y,N,l,O){return I(y,l?O?k:C:O?C:S,N)}function g(y,N,l,O){const u=[];l=l?O?k:C:O?C:S;for(O=0;O<N.length;O++){const D=I(y,l,N[O]);D&&3<=D.length&&u.push(D)}return u.length?u:null}function z(y,N,l,O){const u=[];l=l?O?k:C:O?C:S;for(O=0;O<N.length;O++){const D=I(y,l,N[O]);D&&2<=D.length&&u.push(D)}return u.length?u:null}function d({scale:y,translate:N},l){return l*y[0]+N[0]}function m({scale:y,translate:N},l){return N[1]-l*y[1]}function x(y,N,l){const O=Array(l.length);
if(!l.length)return O;const [u,D]=y.scale;let R=d(y,l[0][0]);y=m(y,l[0][1]);O[0]=N(l[0],R,y);for(let Q=1;Q<l.length;Q++){const U=l[Q];R+=U[0]*u;y-=U[1]*D;O[Q]=N(U,R,y)}return O}function B(y,N,l){const O=Array(l.length);for(let u=0;u<l.length;u++)O[u]=x(y,N,l[u]);return O}function E(y,N,l,O){return x(y,l?O?k:C:O?C:S,N)}function p(y,N,l,O){return B(y,l?O?k:C:O?C:S,N)}function f(y,N,l,O){return B(y,l?O?k:C:O?C:S,N)}function b(y,N,l){let [O,u]=l[0],D=Math.min(O,N[0]),R=Math.min(u,N[1]),Q=Math.max(O,N[2]);
N=Math.max(u,N[3]);for(let U=1;U<l.length;U++){const [Z,ea]=l[U];O+=Z;u+=ea;0>Z&&(D=Math.min(D,O));0<Z&&(Q=Math.max(Q,O));0>ea?R=Math.min(R,u):0<ea&&(N=Math.max(N,u))}y[0]=D;y[1]=R;y[2]=Q;y[3]=N;return y}function q(y,N){if(!N.length)return null;y[0]=y[1]=Number.POSITIVE_INFINITY;y[2]=y[3]=Number.NEGATIVE_INFINITY;for(let l=0;l<N.length;l++)b(y,y,N[l]);return y}function A(y,N,l,O,u){N.xmin=w(y,l.xmin);N.ymin=v(y,l.ymin);N.xmax=w(y,l.xmax);N.ymax=v(y,l.ymax);N!==l&&(O&&(N.zmin=l.zmin,N.zmax=l.zmax),
u&&(N.mmin=l.mmin,N.mmax=l.mmax));return N}function F(y,N,l,O,u){N.points=n(y,l.points,O,u)??[];return N}function L(y,N,l,O,u){N.x=w(y,l.x);N.y=v(y,l.y);N!==l&&(O&&(N.z=l.z),u&&(N.m=l.m));return N}function h(y,N,l,O,u){y=g(y,l.rings,O,u);if(!y)return null;N.rings=y;return N}function H(y,N,l,O,u){y=z(y,l.paths,O,u);if(!y)return null;N.paths=y;return N}const S=(y,N,l)=>[N,l],C=(y,N,l)=>[N,l,y[2]],k=(y,N,l)=>[N,l,y[2],y[3]];a.equals=function(y,N){if(y===N||null==y&&null==N)return!0;if(null==y||null==
N)return!1;let l,O,u,D;y&&"upperLeft"===y.originPosition?(l=y.translate[0],O=y.translate[1],y=y.scale[0]):(l=null!=y.extent?y.extent.xmin:0,O=null!=y.extent?y.extent.ymax:0,y=y.tolerance);N&&"upperLeft"===N.originPosition?(u=N.translate[0],D=N.translate[1],N=N.scale[0]):(u=null!=N.extent?N.extent.xmin:0,D=null!=N.extent?N.extent.ymax:0,N=N.tolerance);return l===u&&O===D&&y===N};a.getQuantizedBoundsCoordsArray=b;a.getQuantizedBoundsCoordsArrayArray=q;a.getQuantizedBoundsPaths=function(y){return q([0,
0,0,0],y)};a.getQuantizedBoundsPoints=function(y){const N=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return b(N,N,y)};a.getQuantizedBoundsRings=function(y){return q([0,0,0,0],y)};a.quantizeBounds=function(y,N,l){N[0]=w(y,l[0]);N[3]=v(y,l[1]);N[2]=w(y,l[2]);N[1]=v(y,l[3]);return N};a.quantizeExtent=A;a.quantizeGeometry=function(y,N){return y&&N?c.isPoint(N)?L(y,{},N,!1,!1):c.isPolyline(N)?H(y,{},N,!1,!1):c.isPolygon(N)?h(y,{},N,!1,!1):c.isMultipoint(N)?
F(y,{},N,!1,!1):c.isExtent(N)?A(y,{},N,!1,!1):null:null};a.quantizeMultipoint=F;a.quantizePaths=z;a.quantizePoint=L;a.quantizePoints=n;a.quantizePolygon=h;a.quantizePolyline=H;a.quantizeRings=g;a.quantizeX=w;a.quantizeY=v;a.toQuantizationTransform=function(y){return y?{originPosition:"upper-left"===y.originPosition?"upperLeft":"lower-left"===y.originPosition?"lowerLeft":y.originPosition,scale:y.tolerance?[y.tolerance,y.tolerance]:[1,1],translate:null!=y.extent?[y.extent.xmin,y.extent.ymax]:[0,0]}:
null};a.unquantizeBounds=function(y,N,l){return l?(N[0]=d(y,l[0]),N[1]=m(y,l[3]),N[2]=d(y,l[2]),N[3]=m(y,l[1]),N):[d(y,N[0]),m(y,N[3]),d(y,N[2]),m(y,N[1])]};a.unquantizeCoordsArray=x;a.unquantizeCoordsArrayArray=B;a.unquantizeExtent=function(y,N,l,O,u){N.xmin=d(y,l.xmin);N.ymin=m(y,l.ymin);N.xmax=d(y,l.xmax);N.ymax=m(y,l.ymax);N!==l&&(O&&(N.zmin=l.zmin,N.zmax=l.zmax),u&&(N.mmin=l.mmin,N.mmax=l.mmax));return N};a.unquantizeMultipoint=function(y,N,l,O,u){null!=l&&(N.points=E(y,l.points,O,u));return N};
a.unquantizePaths=p;a.unquantizePoint=function(y,N,l,O,u){if(null==l)return N;N.x=d(y,l.x);N.y=m(y,l.y);N!==l&&(O&&(N.z=l.z),u&&(N.m=l.m));return N};a.unquantizePoints=E;a.unquantizePolygon=function(y,N,l,O,u){null!=l&&(N.rings=f(y,l.rings,O,u));return N};a.unquantizePolyline=function(y,N,l,O,u){null!=l&&(N.paths=p(y,l.paths,O,u));return N};a.unquantizeRings=f;a.unquantizeX=d;a.unquantizeY=m;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/AttributesBuilder":function(){define("./attributeSupport ./geometryUtils ../../support/fieldUtils ../../../smartMapping/statistics/support/utils ../../../statistics/utils ../../../support/arcadeOnDemand".split(" "),
function(a,c,w,v,I,n){class g{constructor(z,d,m){this._fieldDataCache=new Map;this._returnDistinctMap=new Map;this.returnDistinctValues=z.returnDistinctValues??!1;this.fieldsIndex=m;this.featureAdapter=d;if((d=z.outFields)&&!d.includes("*")){this.outFields=d;z=0;for(const B of d){var x=a.getExpressionFromFieldName(B);x=(d=this.fieldsIndex.get(x))?null:a.getWhereClause(x,m);d=d?d.name:a.getAliasFromFieldName(B)||`FIELD_EXP_${z++}`;this._fieldDataCache.set(B,{alias:d,clause:x})}}}countDistinctValues(z){if(!this.returnDistinctValues)return z.length;
z.forEach(d=>this.getAttributes(d));return this._returnDistinctMap.size}getAttributes(z){z=this._processAttributesForOutFields(z);return this._processAttributesForDistinctValues(z)}getFieldValue(z,d,m){const x=m?m.name:d;let B=null;this._fieldDataCache.has(x)?B=this._fieldDataCache.get(x)?.clause:m||(B=a.getWhereClause(d,this.fieldsIndex),this._fieldDataCache.set(x,{alias:x,clause:B}));return m?this.featureAdapter.getAttribute(z,x):B?.calculateValue(z,this.featureAdapter)}getDataValues(z,d,m=!0){const x=
d.normalizationType,B=d.normalizationTotal,E=this.fieldsIndex.get(d.field),p=w.isDateOnlyField(E)||w.isTimestampOffsetField(E),f=w.isTimeOnlyField(E);return z.map(b=>{let q=d.field&&this.getFieldValue(b,d.field,this.fieldsIndex.get(d.field));d.field2?(q=`${I.processNullValue(q)}${d.fieldDelimiter}${I.processNullValue(this.getFieldValue(b,d.field2,this.fieldsIndex.get(d.field2)))}`,d.field3&&(q=`${q}${d.fieldDelimiter}${I.processNullValue(this.getFieldValue(b,d.field3,this.fieldsIndex.get(d.field3)))}`)):
"string"===typeof q&&m&&(p?q=q?(new Date(q)).getTime():null:f&&(q=q?v.timeOnlyToMilliseconds(q):null));x&&Number.isFinite(q)&&(b="field"===x&&d.normalizationField?this.getFieldValue(b,d.normalizationField,this.fieldsIndex.get(d.normalizationField)):null,q=I.getNormalizedValue(q,x,b,B));return q})}async getExpressionValues(z,d,m,x,B){const {arcadeUtils:E}=await n.loadArcade(),p=E.hasGeometryOperations(d);p&&await E.enableGeometryOperations();const f=E.createFunction(d),b=E.getViewInfo(m),q={fields:this.fieldsIndex.fields};
return z.map(A=>{A={attributes:this.featureAdapter.getAttributes(A),layer:q,geometry:p?{...c.getGeometry(x.geometryType,x.hasZ,x.hasM,this.featureAdapter.getGeometry(A)),spatialReference:m?.spatialReference}:null};A=E.createExecContext(A,b,B);return E.executeFunction(f,A)})}validateItem(z,d){this._fieldDataCache.has(d)||this._fieldDataCache.set(d,{alias:d,clause:a.getWhereClause(d,this.fieldsIndex)});return this._fieldDataCache.get(d)?.clause?.testFeature(z,this.featureAdapter)??!1}validateItems(z,
d){this._fieldDataCache.has(d)||this._fieldDataCache.set(d,{alias:d,clause:a.getWhereClause(d,this.fieldsIndex)});return this._fieldDataCache.get(d)?.clause?.testSet(z,this.featureAdapter)??!1}_processAttributesForOutFields(z){const d=this.outFields;if(!d?.length)return this.featureAdapter.getAttributes(z);const m={};for(const x of d){const {alias:B,clause:E}=this._fieldDataCache.get(x);m[B]=E?E.calculateValue(z,this.featureAdapter):this.featureAdapter.getAttribute(z,B)}return m}_processAttributesForDistinctValues(z){if(null==
z||!this.returnDistinctValues)return z;var d=this.outFields,m=[];if(d)for(const B of d){var {alias:x}=this._fieldDataCache.get(B);m.push(z[x])}else for(x in z)m.push(z[x]);d=`${(d||["*"]).join(",")}=${m.join(",")}`;m=this._returnDistinctMap.get(d)||0;this._returnDistinctMap.set(d,++m);return 1<m?null:z}}return g})},"esri/smartMapping/statistics/support/utils":function(){define("exports ../../../geometry ../../../core/Error ../../../core/screenUtils ../../../core/timeUtils ../../../geometry/SpatialReference ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ../../../layers/support/fieldUtils ../../../renderers/support/heatmapUtils ../../support/utils ../../../statistics/utils ../../../support/arcadeOnDemand ../../../geometry/Point".split(" "),
function(a,c,w,v,I,n,g,z,d,m,x,B,E,p){function f(h){h=L.exec(h);if(!h)return null;const {hh:H,mm:S,ss:C,ms:k}=h.groups;return Number(H)*I.millisecondsPerTimeUnit.hours+Number(S)*I.millisecondsPerTimeUnit.minutes+Number(C)*I.millisecondsPerTimeUnit.seconds+Number(k||0)}function b(h,H){h=null!=h?h:"";null!=H&&H&&(h=h?"("+h+") AND ("+H+")":H);return h}function q(h){const H=h.layer;return h.fields.filter(S=>!H.getField(S))}function A(h){const H=h.layer;return h.fields.filter(S=>{S=H.getFieldUsageInfo(S);
return!S||!S.supportsStatistics})}let F=null;const L=/^(?<hh>([0-1][0-9])|([2][0-3])):(?<mm>[0-5][0-9])(:(?<ss>[0-5][0-9]))?([.](?<ms>\d+))?$/;a.calculateHeatmapStats=function(h,H=18,S,C,k,y){const N=new Float64Array(k*y);H=Math.round(v.pt2px(H));let l=Number.POSITIVE_INFINITY,O=Number.NEGATIVE_INFINITY;var u=0;let D=0,R=0,Q=0;S=m.createValueFunction(C,S);for(const {geometry:Z,attributes:ea}of h){const {x:la,y:na}=Z;h=Math.max(0,la-H);u=Math.max(0,na-H);C=Math.min(y,na+H);const ta=Math.min(k,la+H),
ua=+S(ea);for(let sa=u;sa<C;sa++)for(let va=h;va<ta;va++){u=sa*k+va;const xa=m.evaluateDensityKernel(va-la,sa-na,H);var U=N[u];u=N[u]+=xa*ua;U=u-U;D+=U;R+=U*U;u<l&&(l=u);u>O&&(O=u);Q++}}return Q?{mean:D/Q,stdDev:Math.sqrt((R-D*D/Q)/Q),min:l,max:O,mid:(O-l)/2,count:Q}:{mean:0,stddev:0,min:0,max:0,mid:0,count:0}};a.getDataValues=async function(h,H,S=!0){if(!H)return[];const {field:C,field2:k,field3:y,fieldDelimiter:N,fieldInfos:l,timeZone:O}=h;var u=C&&l?.find(sa=>sa.name.toLowerCase()===C.toLowerCase());
const D=u?d.isTimeOnlyField(u):!1,R=u?x.isAnyDateField(u):!1,Q=h.valueExpression,U=h.normalizationType,Z=h.normalizationField,ea=h.normalizationTotal,la=[];u=h.viewInfoParams;let na=null,ta=null;if(Q){if(!F){const {arcadeUtils:sa}=await E.loadArcade();F=sa}F.hasGeometryOperations(Q)&&await F.enableGeometryOperations();na=F.createFunction(Q);ta=u?F.getViewInfo({viewingMode:u.viewingMode,scale:u.scale,spatialReference:new n(u.spatialReference)}):null}h=h.fieldInfos;const ua=H[0]&&"declaredClass"in H[0]&&
"esri.Graphic"===H[0].declaredClass||!h?null:{fields:h};H.forEach(sa=>{var va=sa.attributes;if(Q){var xa=F.createExecContext(ua?{...sa,layer:ua}:sa,ta,O);xa=F.executeFunction(na,xa)}else va&&(xa=va[C],k?(xa=`${B.processNullValue(xa)}${N}${B.processNullValue(va[k])}`,y&&(xa=`${xa}${N}${B.processNullValue(va[y])}`)):"string"===typeof xa&&S&&(R?xa=xa?(new Date(xa)).getTime():null:D&&(xa=xa?f(xa):null)));U&&"number"===typeof xa&&isFinite(xa)&&(va=va&&parseFloat(va[Z]),xa=B.getNormalizedValue(xa,U,va,
ea));la.push(xa)});return la};a.getRangeExpr=function(h,H,S){H=null!=H?h+" \x3e\x3d "+H:"";h=null!=S?h+" \x3c\x3d "+S:"";S="";return(S=H&&h?b(H,h):H||h)?"("+S+")":""};a.getSQLFilterForNormalization=function(h){const H=h.field,S=h.normalizationType;h=h.normalizationField;let C;if("field"===S)C="(NOT "+h+" \x3d 0)";else if("log"===S||"natural-log"===S||"square-root"===S)C=`(${H} > 0)`;return C};a.getSumOfAttributesExpr=function(h,H,S){const C=[],k=[],y=[],N=[],l=[];h.forEach((D,R)=>{const Q=D.field?
"field":"expression",U=D.field||D.valueExpression;D.field?(l.push(U),k.push(`var ${Q}${R} = Number($feature["${U}"]);`)):(C.push(`function getValueForExpr${R}() {\n  ${U} \n}`),k.push(`var ${Q}${R} = Number(getValueForExpr${R}());`));S||y.push(`${Q}${R} = IIf(${Q}${R} < 0, 0, ${Q}${R});`);N.push(`${Q}${R}`)});h="return sum;";const O=C.length?null:l.reduce((D,R)=>`${D} + ${R}`);let u=null;H||S?H?S||(h="return IIf(sum \x3e\x3d 0, sum, null);",O&&(u=`(( ${O} ) >= 0)`)):(h="return IIf(sum !\x3d 0, sum, null);",
O&&(u=`(( ${O} ) <> 0)`)):(h="return IIf(sum \x3e 0, sum, null);",O&&(u=`(( ${O} ) > 0)`));return{valueExpression:[C.length?C.join("\n"):"",k.join("\n"),y.join("\n"),`var sum = ${N.join(" + ")};`,h].filter(Boolean).join("\n\n"),sqlExpression:O,sqlWhere:u}};a.mergeWhereClauses=b;a.quantizeFeatures=function(h,H,S,C){const k=z.isWrappable(S)?z.getInfo(S):null,y=k?Math.round((k.valid[1]-k.valid[0])/H.scale[0]):null;return h.map(N=>{const l=new p(N.geometry);g.quantizePoint(H,l,l,l.hasZ,l.hasM);if(k){var O=
y??0,u=C[0];0>l.x?l.x+=O:l.x>u&&(l.x-=O)}N.geometry=l;return N})};a.timeOnlyToMilliseconds=f;a.verifyBasicFieldValidity=function(h,H,S){const C=q({layer:h,fields:H});if(C.length)return new w(S,"Unknown fields: "+C.join(", ")+". You can only use fields defined in the layer schema");h=A({layer:h,fields:H});if(h.length)return new w(S,"Unsupported fields: "+h.join(", ")+". You can only use fields that can be fetched i.e. AdapterFieldUsageInfo.supportsStatistics must be true")};a.verifyFieldType=function(h,
H,S,C){let k;H?H.name!==h.objectIdField&&C.includes(H.type)||(k=new w(S,"'field' should be one of these types: "+C.join(","))):k=new w(S,"'field' is not defined in the layer schema");return k};a.verifyFilterValidty=function(h,H){if(h&&"intersects"!==h.spatialRelationship)return new w(H,"Only 'intersects' spatialRelationship is supported for featureFilter")};a.verifyNumericField=function(h,H,S){let C;H?H.name!==h.objectIdField&&d.isNumericField(H)||(C=new w(S,"'field' should be one of these numeric types: "+
d.numericTypes.join(","))):C=new w(S,"'field' is not defined in the layer schema");return C};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/screenUtils":function(){define(["exports"],function(a){function c(v){return v?72*v/96:0}const w=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i;a.castRenderScreenPointArray=function(v){return v};a.castRenderScreenPointArray3=function(v){return v};a.castScreenPointArray=function(v){return v};a.createRenderScreenPoint=function(v=0,I=0){return{x:v,
y:I}};a.createRenderScreenPointArray=function(v=0,I=0){return[v,I]};a.createRenderScreenPointArray3=function(v=0,I=0,n=0){return[v,I,n]};a.createScreenPoint=function(v=0,I=0){return{x:v,y:I}};a.createScreenPointArray=function(v=0,I=0){return[v,I]};a.pt2px=function(v){return v?v/72*96:0};a.px2pt=c;a.screenPointArrayToObject=function(v,I){return I?(I.x=v[0],I.y=v[1],I):{x:v[0],y:v[1]}};a.screenPointObjectToArray=function(v,I){return I?(I[0]=v.x,I[1]=v.y,2<I.length&&(I[2]=0),I):[v.x,v.y]};a.toPt=function(v){if("string"===
typeof v){var I=v.match(w);if(I){var n=Number(I[1]);I=I[3]&&I[3].toLowerCase();v="-"===v.charAt(0);n="px"===I?c(n):n;return v?-n:n}console.warn("screenUtils.toPt: input not recognized!");return null}return v};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/timeUtils":function(){define(["exports","../intl/date","../time/timeZoneUtils","../chunks/datetime"],function(a,c,w,v){function I(z,d,m){return 0===z?0:z*g[d]/g[m]}function n(z){switch(z){case "milliseconds":return"millisecond";
case "seconds":return"second";case "minutes":return"minute";case "hours":return"hour";case "days":return"day";case "weeks":return"week";case "months":return"month";case "years":return"year"}}const g={milliseconds:1,seconds:1E3,minutes:6E4,hours:36E5,days:864E5,weeks:6048E5,months:26784E5,years:31536E6,decades:31536E7,centuries:31536E8};a.convertTime=I;a.isValidDate=function(z){return z instanceof Date&&!isNaN(z.getTime())};a.makeUTCTime=function(z,d,m="milliseconds"){d=new Date(I(d,m,"milliseconds"));
d.setUTCFullYear(z.getUTCFullYear(),z.getUTCMonth(),z.getUTCDate());return d};a.mergeTimeExtents=function(z,d){return z&&d?z.intersection(d):z||d};a.millisecondsPerTimeUnit=g;a.offsetDate=function(z,d,m,x=w.system){x=new v.IANAZone(c.resolveTimeZone(x));z=v.DateTime.fromJSDate(z,{zone:x});x="decades"===m||"centuries"===m?"year":n(m);"decades"===m&&(d*=10);"centuries"===m&&(d*=100);return z.plus({[x]:d}).toJSDate()};a.offsetDateUTC=function(z,d,m="milliseconds"){z=z.getTime();d=I(d,m,"milliseconds");
return new Date(z+d)};a.resetUTCDate=function(z,d){z=new Date(z.getTime());z.setUTCFullYear(d.getFullYear(),d.getMonth(),d.getDate());return z};a.timeSinceUTCMidnight=function(z,d="milliseconds"){const m=I(z.getUTCHours(),"hours","milliseconds"),x=I(z.getUTCMinutes(),"minutes","milliseconds"),B=I(z.getUTCSeconds(),"seconds","milliseconds");z=z.getUTCMilliseconds();return I(m+x+B+z,"milliseconds",d)};a.truncateDate=function(z,d,m=w.system){m=new v.IANAZone(c.resolveTimeZone(m));z=v.DateTime.fromJSDate(z,
{zone:m});if("decades"===d||"centuries"===d)return z=z.startOf("year"),{year:m}=z,z.set({year:m-m%("decades"===d?10:100)}).toJSDate();d=n(d);return z.startOf(d).toJSDate()};a.truncateLocalTime=function(z){const d=new Date(0);d.setHours(0);d.setMinutes(0);d.setSeconds(0);d.setMilliseconds(0);d.setFullYear(z.getUTCFullYear(),z.getUTCMonth(),z.getUTCDate());return d};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/heatmapUtils":function(){define(["exports","../../core/mathUtils",
"../../core/screenUtils","../../chunks/vec4","../../chunks/vec4f64"],function(a,c,w,v,I){function n(m,x,B,E){let {color:p,ratio:f}=x,{color:b,ratio:q}=B;q===f&&(1===q?f-=1E-6:q+=1E-6);x=c.clamp((E-f)/(q-f),0,1);v.lerp(m,p.toArray(),b.toArray(),x)}function g(m,x,B,E,p){m=new Uint32Array(m*m);x="buffer"in x?x:new Float64Array(x);B="buffer"in B?new Uint32Array(B.buffer):new Uint32Array((new Uint8Array(B)).buffer);p=B.length/(p-E);for(let f=0;f<x.length;f++)m[f]=B[c.clamp(Math.floor((x[f]-E)*p),0,B.length-
1)];return m.buffer}function z(m,x,B){m=Math.sqrt(m**2+x**2)/B;return 1<m?0:3/(Math.PI*B**2)*(1-m**2)**2}function d(m,x){return null!=m?"string"===typeof x?B=>-1*+B.readAttribute(m):B=>+B.readAttribute(m)+x:B=>1}a.calculateHeatmapIntensityInfoReaders=function(m,x,B,E){const {radius:p,fieldOffset:f,field:b}=x;x=Math.round(w.pt2px(p));const q=new Float64Array(B*E);let A=Number.NEGATIVE_INFINITY;const F=d(b,f),L=new Set;for(const C of m)for(m=C.getCursor();m.next();){var h=m.getObjectId();if(L.has(h))continue;
L.add(h);h=m.readLegacyPointGeometry();if(-128>h.x||h.x>=B+128||-128>h.y||h.y>E+128)continue;const k=+F(m),y=Math.max(0,Math.round(h.x)-x);var H=Math.max(0,Math.round(h.y)-x);const N=Math.min(E,Math.round(h.y)+x),l=Math.min(B,Math.round(h.x)+x);for(;H<N;H++)for(let O=y;O<l;O++){var S=H*B+O;const u=z(h.x-O,h.y-H,x);S=q[S]+=u*k;S>A&&(A=S)}}return{matrix:q.buffer,max:A}};a.createHeatmapImageData=g;a.createValueFunction=function(m,x){return"function"===typeof m?m:m?"string"===typeof x?B=>-1*+B[m]:B=>
+B[m]+x:()=>1};a.createValueFunctionCursor=d;a.drawHeatmap=function(m,x,B,E,p,f){m.canvas.width=m.canvas.height=x;m.clearRect(0,0,x,x);const b=m.getImageData(0,0,x,x);B&&E&&b.data.set(new Uint8ClampedArray(g(x,B,E,p,f)));m.putImageData(b,0,0)};a.evaluateDensityKernel=z;a.gaussianBlurRadiusPxToKernelDensityRadiusPt=function(m){return w.px2pt(2.4*m)};a.generateGradient=function(m){const x=new Uint8ClampedArray(2048);m=m.filter(({ratio:b})=>0<=b&&1>=b).sort((b,q)=>b.ratio-q.ratio).map(({color:b,ratio:q})=>
({color:b,ratio:Math.max(q,.001)}));if(1>m.length)return x;let B=m[0],E=m[0],p=1;const f=I.create();for(let b=0;512>b;b++){const q=(b+.5)/512;for(;q>E.ratio&&p<m.length;)B=E,E=m[p++];n(f,B,E,q);x.set(f,4*b)}return x};a.kernelDensityRadiusPtToGaussianBlurRadiusPx=function(m){return w.pt2px(m)/2.4};a.magicKernelDensityRadiusInflationFactor=2.4;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/smartMapping/support/utils":function(){define("exports ../../intl/date ../../layers/support/fieldUtils ../../support/arcadeOnDemand ../../support/basemapUtils ../../time/timeZoneUtils".split(" "),
function(a,c,w,v,I,n){function g(p){return String(p).padStart(2,"0")}function z(p,f,b){if("date"===f||"number"===f){"number"===f&&(p=new Date(p));f=b?p.getFullYear():p.getUTCFullYear();const q=g((b?p.getMonth():p.getUTCMonth())+1),A=g(b?p.getDate():p.getUTCDate()),F=g(b?p.getHours():p.getUTCHours()),L=g(b?p.getMinutes():p.getUTCMinutes());p=g(b?p.getSeconds():p.getUTCSeconds());p=`TIMESTAMP'${f}-${q}-${A} ${F}:${L}:${p}'`}return p}function d(p,f){if(f instanceof Date)return"date";if("number"===typeof f)return"number";
if("string"===typeof f&&(p=p.getField(f),"\x3cnow\x3e"!==f.toLowerCase()&&w.isDateField(p)))return"field"}const m={light:"streets gray topo terrain oceans osm gray-vector streets-vector topo-vector streets-relief-vector streets-navigation-vector topo-3d navigation-3d arcgis-light-gray arcgis-navigation arcgis-streets arcgis-streets-relief arcgis-topographic arcgis-oceans osm-standard osm-standard-relief osm-streets osm-streets-relief osm-light-gray arcgis-terrain arcgis-charted-territory arcgis-community arcgis-colored-pencil arcgis-modern-antique arcgis-midcentury arcgis-newspaper arcgis-hillshade-light".split(" "),
dark:"satellite hybrid dark-gray dark-gray-vector streets-night-vector navigation-dark-3d arcgis-imagery arcgis-imagery-standard arcgis-dark-gray arcgis-navigation-night arcgis-streets-night osm-dark-gray arcgis-nova arcgis-hillshade-dark".split(" ")},x={years:365,months:30,days:1,hours:1/24,minutes:1/1440,seconds:1/86400,milliseconds:1/864E5},B=new Set(["integer","small-integer"]);let E=null;a.castIntegerFieldToFloat=function(p){return`cast(${p} as float)`};a.dateTypes=["date","date-only","timestamp-offset"];
a.defaultBasemapGroups=m;a.fieldDelimiter=",";a.formatAnyDate=function(p,f){const {format:b,timeZoneOptions:q,fieldType:A}=f??{};let F;q&&({timeZone:L,timeZoneName:F}=n.getTimeZoneFormattingOptions(q.layerTimeZone,q.datesInUnknownTimezone,q.viewTimeZone,c.convertDateFormatToIntlOptions(b||"short-date-short-time"),A));if("string"===typeof p&&isNaN(Date.parse("time-only"===A?`1970-01-01T${p}Z`:p)))return p;switch(A){case "date-only":var L=c.convertDateFormatToIntlOptions(b||"short-date");return"string"===
typeof p?c.formatDateOnly(p,{...L}):c.formatDate(p,{...L,timeZone:n.utc});case "time-only":return L=c.convertDateFormatToIntlOptions(b||"short-time"),"string"===typeof p?c.formatTimeOnly(p,L):c.formatDate(p,{...L,timeZone:n.utc});case "timestamp-offset":if(!L&&"string"===typeof p&&(new Date(p)).toISOString()!==p)return p;L=(f=b||q?c.convertDateFormatToIntlOptions(b||"short-date-short-time"):void 0)?{...f,timeZone:L,timeZoneName:F}:void 0;return"string"===typeof p?c.formatTimestamp(p,L):c.formatDate(p,
L);default:return f=b||q?c.convertDateFormatToIntlOptions(b||"short-date-short-time"):void 0,c.formatDate("string"===typeof p?new Date(p):p,f?{...f,timeZone:L,timeZoneName:F}:void 0)}};a.getBasemapGroup=function(p,f=m){for(const b in f)if(f[b].includes(p))return b};a.getBasemapId=function(p,f,b=!0){let q=null;p&&("string"===typeof p?f.includes(p)&&(q=p):q=I.getWellKnownBasemapId(p));return b?q||"gray":q};a.getDateDiffSQL=function(p,f,b,q){const {hasQueryEngine:A}=p;b=z(b,d(p,b),A);p=z(f,d(p,f),A);
p=`(${b} - ${p})`;q=x[q];f="/";1>q&&(q=1/q,f="*");return{sqlExpression:1===q?p:`(${p} ${f} ${q})`,sqlWhere:null}};a.getDateType=d;a.getFieldsList=async function(p){const {field:f,field2:b,field3:q,normalizationField:A,valueExpression:F}=p;p=[];F&&(E||({arcadeUtils:p}=await v.loadArcade(),E=p),p=E.extractFieldNames(F));f&&p.push(f);b&&p.push(b);q&&p.push(q);A&&p.push(A);return p};a.getNormalizationType=function(p){let f=p.normalizationType;f||(p.normalizationField?f="field":null!=p.normalizationTotal&&
(f="percent-of-total"));return f??void 0};a.isAnyDateField=function(p){return w.isDateField(p)||w.isDateOnlyField(p)||w.isTimestampOffsetField(p)};a.isIntegerField=function(p,f){p=f&&p.getField(f);return!!p&&B.has(p.type)};a.unitValueInDays=x;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/support/basemapUtils":function(){define("exports ../Basemap ../config ../core/Collection ../core/Logger ../core/maybe ../core/urlUtils ../core/accessorSupport/ensureType ../layers/effects/utils ./basemapDefinitions".split(" "),
function(a,c,w,v,I,n,g,z,d,m){function x(u,D){let R;if("string"===typeof u){const Q=u in m.esriBasemapDefinitions,U=!Q&&u.includes("/");if(!Q&&!U)return D=Object.entries(m.esriBasemapDefinitions).filter(([,Z])=>w.apiKey&&!Z.classic||!w.apiKey&&(Z.classic||Z.is3d)).map(([Z])=>`"${Z}"`).sort().join(", "),N.warn(`Unable to find basemap definition for: ${u}. Try one of these: ${D}`),null;D&&(R=D[u]);R||(R=Q?c.fromId(u):new c({style:{id:u}}),D&&(D[u]=R))}else R=z.ensureType(c,u);R?.destroyed&&(N.warn("The provided basemap is already destroyed",
{basemap:R}),R=null);return R}function B(u){if(l)return l(u);let D=null;u=b(u);const R=!u?.baseLayers.length;for(const U in m.esriBasemapDefinitions){var Q=L(m.esriBasemapDefinitions[U]);Q=H(u,Q,{mustMatchReferences:R});if("equal"===Q){D=U;break}"base-layers-equal"===Q&&(D=U)}return D}function E(u,D){const R=new v;u.forEach(Q=>{const U=D.find(Z=>"scene"!==Z.type&&C(A(Q),A(Z)))||Q;R.includes(U)?R.push(Q):R.push(U)});return R}function p(u){if(f(u.url))return!0;if("vector-tile"===u.type)for(const D in u.sourceNameToSource)if(f(u.sourceNameToSource[D]?.sourceUrl))return!0;
return!1}function f(u){if(!u)return!1;u=new g.Url(g.makeAbsolute(u));return!!u.authority&&O.test(u.authority)}function b(u){return u?!u.loaded&&u.resourceInfo?L(u.resourceInfo.data):{baseLayers:q(u.baseLayers),referenceLayers:q(u.referenceLayers)}:null}function q(u){return(v.isCollection(u)?u.toArray():u).map(A)}function A(u){return{type:u.type,effect:"effect"in u?u.effect:void 0,url:k("urlTemplate"in u&&u.urlTemplate||u.url||"styleUrl"in u&&u.styleUrl||""),minScale:"minScale"in u&&null!=u.minScale?
u.minScale:0,maxScale:"maxScale"in u&&null!=u.maxScale?u.maxScale:0,opacity:null!=u.opacity?u.opacity:1,visible:null!=u.visible?!!u.visible:!0,sublayers:"map-image"!==u.type&&"wms"!==u.type||null==u.sublayers?void 0:u.sublayers?.map(D=>({id:D.id,visible:D.visible})),activeLayerId:"wmts"===u.type?u.activeLayer?.id:void 0}}function F(u){return u.isReference||"ArcGISSceneServiceLayer"===u.layerType}function L(u){return u?{baseLayers:h((u.baseMapLayers??[]).filter(D=>!F(D))),referenceLayers:h((u.baseMapLayers??
[]).filter(D=>F(D)))}:null}function h(u){return u.map(D=>{let R;switch(D.layerType){case "VectorTileLayer":R="vector-tile";break;case "ArcGISTiledMapServiceLayer":R="tile";break;case "ArcGISSceneServiceLayer":R="scene";break;default:R="unknown"}return{type:R,effect:D.effect,url:k(D.templateUrl||D.urlTemplate||D.styleUrl||D.url),minScale:D.minScale??0,maxScale:D.maxScale??0,opacity:D.opacity??1,visible:null!=D.visibility?!!D.visibility:!0,sublayers:void 0,activeLayerId:void 0}})}function H(u,D,R){return null!=
u!==(null!=D)?"not-equal":u&&D?S(u.baseLayers,D.baseLayers)?S(u.referenceLayers,D.referenceLayers)?"equal":R.mustMatchReferences?"not-equal":"base-layers-equal":"not-equal":"equal"}function S(u,D){if(u.length!==D.length)return!1;for(let R=0;R<u.length;R++)if(!C(u[R],D[R]))return!1;return!0}function C(u,D){if(u.type!==D.type||u.url!==D.url||u.minScale!==D.minScale||u.maxScale!==D.maxScale||u.visible!==D.visible||u.opacity!==D.opacity||!d.effectEquals(u.effect,D.effect))return!1;if(null!=u.activeLayerId||
null!=D.activeLayerId)return u.activeLayerId===D.activeLayerId;if(null!=u.sublayers||null!=D.sublayers){if(null==u.sublayers||null==D.sublayers||u.sublayers.length!==D.sublayers.length)return!1;for(let R=0;R<u.sublayers.length;R++){const Q=u.sublayers.at(R),U=D.sublayers.at(R);if(Q?.id!==U?.id||Q?.visible!==U?.visible)return!1}}return!0}function k(u){return u?g.normalize(u).replace(/^\s*https?:/i,"").toLowerCase():""}function y(u){return"portalItem"in u?u.portalItem?.thumbnailUrl:void 0}const N=I.getLogger("esri.support.basemapUtils");
let l;const O=/^(basemaps|ibasemaps).*-api\.arcgis\.com$/i;a.clonePreservingTiledLayers=function(u,D=null){u=x(u);if(!u)return null;u=u.clone();D&&(u.baseLayers=E(u.baseLayers,D.baseLayers),u.referenceLayers=E(u.referenceLayers,D.referenceLayers));return u};a.contentEquals=function(u,D){if(u===D||null!=u?.portalItem?.id&&u.portalItem.id===D?.portalItem?.id)return!0;u=b(u);D=b(D);return"equal"===H(u,D,{mustMatchReferences:!0})};a.createCache=function(){return{}};a.destroyCache=function(u){for(const D in u)n.destroyMaybe(u[D]),
delete u[D]};a.ensureType=x;a.findSpatialReference=function(u,D){if(null==D||null==u)return{spatialReference:null,updating:!1};if("not-loaded"===D.loadStatus)return D.load(),{spatialReference:null,updating:!0};if(D.spatialReference)return{spatialReference:D.spatialReference,updating:!1};if(0===D.baseLayers.length)return{spatialReference:null,updating:!1};D=D.baseLayers.at(0);switch(D.loadStatus){case "not-loaded":D.load();case "loading":return{spatialReference:null,updating:!0};case "failed":return{spatialReference:null,
updating:!1}}D=(("supportedSpatialReferences"in D?D.supportedSpatialReferences:null)||["tileInfo"in D?D.tileInfo?.spatialReference:D.spatialReference]).filter(Boolean);const R=u.spatialReference;return R?{spatialReference:D.find(Q=>R.equals(Q))??D[0]??null,updating:!1}:{spatialReference:D[0],updating:!1}};a.getBasemapThumbnailUrl=function(u){if(!u)return null;var {thumbnailUrl:D}=u;return D?D:(D=B(u))?m.esriBasemapDefinitions[D].thumbnailUrl:n.mappedFind(u.baseLayers,y)};a.getWellKnownBasemapId=B;
a.hasDeveloperBasemapLayer=function(u){return!!u?.baseLayers.concat(u.referenceLayers).some(p)};a.isBasemap3D=function(u){return"Web Scene"===u.portalItem?.type};a.isBasemapInBeta=function(u){return!!u?.portalItem?.tags?.some(D=>"beta"===D.toLowerCase())};a.isBasemapLayer=function(u,D){return u.basemap?.referenceLayers?.some(R=>R.uid===D)||u.basemap?.baseLayers?.some(R=>R.uid===D)};a.isDeveloperBasemapLayer=p;a.overrideGetWellKnownBasemapId=function(u){l=u};Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/Basemap":function(){define("require ./chunks/tslib.es6 ./request ./core/Collection ./core/collectionUtils ./core/JSONSupport ./core/lang ./core/Loadable ./core/loadAll ./core/Logger ./core/maybe ./core/promiseUtils ./core/urlUtils ./core/accessorSupport/decorators/property ./core/accessorSupport/ensureType ./core/accessorSupport/decorators/subclass ./core/accessorSupport/decorators/writer ./geometry/SpatialReference ./portal/Portal ./portal/PortalItem ./support/basemapDefinitions ./support/BasemapStyle ./webdoc/support/writeUtils".split(" "),
function(a,c,w,v,I,n,g,z,d,m,x,B,E,p,f,b,q,A,F,L,h,H,S){var C;let k=0;n=C=class extends n.JSONSupportMixin(z){constructor(l){super(l);this.thumbnailUrl=this.style=this.spatialReference=this.portalItem=this.id=null;this.title="Basemap";this.id=Date.now().toString(16)+"-basemap-"+k++;this.baseLayers=new v;this.referenceLayers=new v;const O=u=>{u.parent&&u.parent!==this&&"remove"in u.parent&&u.parent.remove(u);u.parent=this;"elevation"===u.type&&m.getLogger(this).error(`Layer '${u.title}, id:${u.id}' of type '${u.type}' is not supported as a basemap layer and will therefore be ignored.`)};
this.addHandles([this.baseLayers.on("after-add",u=>O(u.item)),this.referenceLayers.on("after-add",u=>O(u.item)),this.baseLayers.on("after-remove",u=>{u.item.parent=null}),this.referenceLayers.on("after-remove",u=>{u.item.parent=null})])}initialize(){this.when().catch(l=>{m.getLogger(this).error("#load()",`Failed to load basemap (title: '${this.title}', id: '${this.id}')`,l)});this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){var l=this.baseLayers.toArray();for(const O of l)O.destroy();
l=this.referenceLayers.toArray();for(const O of l)O.destroy();this.baseLayers.destroy();this.referenceLayers.destroy();this.portalItem=x.destroyMaybe(this.portalItem)}normalizeCtorArgs(l){l&&"resourceInfo"in l&&(this._set("resourceInfo",l.resourceInfo),l={...l},delete l.resourceInfo);return l}set baseLayers(l){this._set("baseLayers",I.referenceSetter(l,this._get("baseLayers")))}_writeBaseLayers(l,O,u){const D=[];l&&(u={...u,layerContainerType:"basemap"},this.baseLayers.forEach(R=>{R=S.getLayerJSON(R,
u.webmap?u.webmap.getLayerJSONFromResourceInfo(R):null,u);null!=R&&D.push(R)}),this.referenceLayers.forEach(R=>{const Q=S.getLayerJSON(R,u.webmap?u.webmap.getLayerJSONFromResourceInfo(R):null,u);null!=Q&&("scene"!==R.type&&(Q.isReference=!0),D.push(Q))}));O.baseMapLayers=D}set referenceLayers(l){this._set("referenceLayers",I.referenceSetter(l,this._get("referenceLayers")))}writeTitle(l,O){O.title=l||"Basemap"}load(l){this.addResolvingPromise(this._loadFromSource(l));return Promise.resolve(this)}loadAll(){return d.loadAll(this,
l=>{l(this.baseLayers,this.referenceLayers)})}clone(){const l={id:this.id,title:this.title,portalItem:this.portalItem,baseLayers:this.baseLayers.map(O=>g.isClonable(O)?O.clone():O),referenceLayers:this.referenceLayers.map(O=>g.isClonable(O)?O.clone():O)};this.loaded&&(l.loadStatus="loaded");return(new C({resourceInfo:this.resourceInfo})).set(l)}read(l,O){this.resourceInfo||this._set("resourceInfo",{data:l,context:O});super.read(l,O)}write(l,O){l=l||{};O?.origin||(O={origin:"web-map",...O});super.write(l,
O);!this.loaded&&this.resourceInfo?.data.baseMapLayers&&(l.baseMapLayers=this.resourceInfo.data.baseMapLayers.map(u=>{u=g.clone(u);u.url&&E.isProtocolRelative(u.url)&&(u.url=`https:${u.url}`);u.templateUrl&&E.isProtocolRelative(u.templateUrl)&&(u.templateUrl=`https:${u.templateUrl}`);return u}));return l}async _loadFromSource(l){const {resourceInfo:O,portalItem:u,style:D}=this;B.throwIfAborted(l);const R=[];O?(R.push(this._loadLayersFromJSON(O.data,O.context?O.context.url:null,l)),O.data.id&&!O.data.title&&
R.push(h.getBasemapTitle(O.data.id).then(Q=>{Q&&this.read({title:Q},O.context)}))):u?R.push(this._loadFromItem(u,l)):D&&R.push(this._loadFromStylesService(D,l));await Promise.all(R)}async _loadLayersFromJSON(l,O,u){const D=this.resourceInfo?.context,R=this.portalItem?.portal||D?.portal||null,Q=N[D?.origin||""]??"web-map",{populateOperationalLayers:U}=await new Promise((ea,la)=>a(["./layers/support/layersCreator"],ea,la)),Z=[];B.throwIfAborted(u);if(l.baseMapLayers&&Array.isArray(l.baseMapLayers)){O=
{context:{...D,origin:Q,url:O,portal:R,layerContainerType:"basemap"},defaultLayerType:"DefaultTileLayer"};const ea=la=>"web-scene"===Q&&"ArcGISSceneServiceLayer"===la.layerType||la.isReference;u=U(this.baseLayers,l.baseMapLayers.filter(la=>!ea(la)),O);Z.push(u);l=U(this.referenceLayers,l.baseMapLayers.filter(ea),O);Z.push(l)}await Promise.allSettled(Z)}async _loadFromItem(l,O){const u=await (await l.load(O)).fetchData("json",O),D=E.urlToObject(l.itemUrl??"");this._set("resourceInfo",{data:u.baseMap??
{},context:{origin:y[l.type||""]??"web-map",portal:l.portal||F.getDefault(),url:D}});this.read(this.resourceInfo.data,this.resourceInfo.context);this.read({spatialReference:u.spatialReference},this.resourceInfo.context);this.read({title:l.title,thumbnailUrl:l.thumbnailUrl},{origin:"portal-item",portal:l.portal||F.getDefault(),url:D});return this._loadLayersFromJSON(this.resourceInfo.data,D,O)}async _loadFromStylesService(l,O){var u=`${l.serviceUrl}/${l.id}`;l=(await w(u,{query:{language:l.getLanguageParamValue()},
signal:O?.signal})).data;if(l.baseMap&&Array.isArray(l.baseMap.baseMapLayers))for(const D of l.baseMap.baseMapLayers)if(!D.customParameters&&D.styleUrl?.includes("?")){const R=E.urlToObject(D.styleUrl);R.query&&(D.styleUrl=R.path,D.customParameters=R.query)}u=E.urlToObject(u);this._set("resourceInfo",{data:l.baseMap??{},context:{origin:"web-map",url:u}});this.read(this.resourceInfo.data,this.resourceInfo.context);this.read({spatialReference:l.spatialReference},this.resourceInfo.context);return this._loadLayersFromJSON(this.resourceInfo.data,
u,O)}static fromId(l){return(l=h.esriBasemapDefinitions[l])?l.itemId?new C({portalItem:{id:l.itemId,portal:{url:"https://www.arcgis.com"}}}):C.fromJSON(l,{origin:l.is3d?"web-scene":"web-map"}):null}};c.__decorate([p.property({json:{write:{ignoreOrigin:!0,target:"baseMapLayers",writer(l,O,u,D){this._writeBaseLayers(l,O,D)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{baseMapLayers:{type:v}},writer(l,O,u,D){this._writeBaseLayers(l,O,D)}}}}}})],n.prototype,"baseLayers",null);c.__decorate([p.property({type:String,
json:{origins:{"web-scene":{write:!0}}}})],n.prototype,"id",void 0);c.__decorate([p.property({type:L})],n.prototype,"portalItem",void 0);c.__decorate([p.property()],n.prototype,"referenceLayers",null);c.__decorate([p.property({readOnly:!0})],n.prototype,"resourceInfo",void 0);c.__decorate([p.property({type:A})],n.prototype,"spatialReference",void 0);c.__decorate([p.property({type:H})],n.prototype,"style",void 0);c.__decorate([p.property()],n.prototype,"thumbnailUrl",void 0);c.__decorate([p.property({type:String,
json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],n.prototype,"title",void 0);c.__decorate([q.writer("title")],n.prototype,"writeTitle",null);n=C=c.__decorate([b.subclass("esri.Basemap")],n);const y={"Web Scene":"web-scene","Web Map":"web-map","Link Chart":"link-chart"},N={"web-scene":"web-scene","web-map":"web-map","link-chart":"link-chart"};return n})},"esri/core/collectionUtils":function(){define(["exports","./Collection"],function(a,c){a.castForReferenceSetter=function(w){return w};a.referenceSetter=
function(w,v,I=c){v||(v=new I);if(v===w)return v;v.removeAll();w&&(Array.isArray(w)||"items"in w&&Array.isArray(w.items))?v.addMany(w):w&&v.add(w);return v};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/Loadable":function(){define("../chunks/tslib.es6 ./Error ./maybe ./Promise ./promiseUtils ./Warning ./accessorSupport/decorators/property ./accessorSupport/decorators/subclass".split(" "),function(a,c,w,v,I,n,g,z){const d=m=>{m=class extends m{constructor(...x){super(...x);
this.loadError=this._loadController=null;this.loadStatus="not-loaded";this._set("loadWarnings",[]);this.addResolvingPromise(new Promise(B=>{const E=this.load.bind(this);this.load=p=>{const f=new Promise((b,q)=>{const A=I.onAbortOrThrow(p,q);this.destroyed&&q(new c("load:instance-destroyed",`Instance of '${this.declaredClass||this.constructor.name}' is already destroyed`,{instance:this}));this.when(b,q).finally(()=>{A&&A.remove()})});if("not-loaded"===this.loadStatus){this._set("loadStatus","loading");
const b=this._loadController=new AbortController;E({signal:b.signal})}B();return f}}));this.when(()=>{this._set("loadStatus","loaded");this._loadController=null},B=>{this._set("loadStatus","failed");this._set("loadError",B);this._loadController=null})}destroy(){this._loadController&&(this._loadController=w.abortMaybe(this._loadController),this._promiseProps.abort());this._set("loadError",null);this._set("loadWarnings",[])}get loaded(){return"loaded"===this.loadStatus}get loadWarnings(){return this._get("loadWarnings")}load(){return null}cancelLoad(){if(this.isFulfilled())return this;
this._set("loadError",new c("load:cancelled","Cancelled"));this._loadController?.abort();this._promiseProps.abort();return this}};a.__decorate([g.property({readOnly:!0})],m.prototype,"loaded",null);a.__decorate([g.property({readOnly:!0})],m.prototype,"loadError",void 0);a.__decorate([g.property({clonable:!1})],m.prototype,"loadStatus",void 0);a.__decorate([g.property({type:[n],readOnly:!0})],m.prototype,"loadWarnings",null);return m=a.__decorate([z.subclass("esri.core.Loadable")],m)};v=class extends d(v.EsriPromise){};
v=a.__decorate([z.subclass("esri.core.Loadable")],v);(function(m){m.LoadableMixin=d;m.isLoadable=function(x){return!(!x||!x.load)}})(v||(v={}));return v})},"esri/core/Promise":function(){define(["exports","../chunks/tslib.es6","./Accessor","./promiseUtils","./accessorSupport/decorators/subclass"],function(a,c,w,v,I){var n;(function(d){d[d.PENDING=0]="PENDING";d[d.RESOLVED=1]="RESOLVED";d[d.REJECTED=2]="REJECTED"})(n||(n={}));class g{constructor(){this._resolver=v.createResolver();this._status=n.PENDING;
this._resolvingPromises=[];this._resolver.promise.then(()=>{this._status=n.RESOLVED;this._cleanUp()},()=>{this._status=n.REJECTED;this._cleanUp()});this.promise=this._resolver.promise}destroy(){this._cleanUp()}addResolvingPromise(d){this._resolvingPromises.push(d);this._tryResolve()}isResolved(){return this._status===n.RESOLVED}isRejected(){return this._status===n.REJECTED}isFulfilled(){return this._status!==n.PENDING}abort(){this._resolver.reject(v.createAbortError())}_cleanUp(){this._resolvingPromises=
this._allPromise=null}_tryResolve(){if(!this.isFulfilled()){var d=v.createResolver(),m=[...this._resolvingPromises,d.promise],x=this._allPromise=Promise.all(m);x.then(()=>{this.isFulfilled()||this._allPromise!==x||this._resolver.resolve()},B=>{this.isFulfilled()||this._allPromise!==x||v.isAbortError(B)||this._resolver.reject(B)});d.resolve()}}}const z=d=>{d=class extends d{constructor(...m){super(...m);this._promiseProps=new g;this.addResolvingPromise(Promise.resolve())}destroy(){this._promiseProps.destroy()}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(m,
x){return this._promiseProps.promise.then(()=>this).then(m,x)}catch(m){return this.when(null,m)}addResolvingPromise(m){m&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in m?m.when():m)}};return d=c.__decorate([I.subclass("esri.core.Promise")],d)};a.EsriPromise=class extends z(w){};a.EsriPromise=c.__decorate([I.subclass("esri.core.Promise")],a.EsriPromise);a.EsriPromiseMixin=z;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/loadAll":function(){define(["exports",
"./asyncUtils","./Collection","./Loadable"],function(a,c,w,v){async function I(n,g){const z=[],d=(...x)=>{for(const B of x)null!=B&&(Array.isArray(B)?d(...B):w.isCollection(B)?B.forEach(E=>d(E)):v.isLoadable(B)&&z.push(B))};g(d);let m=null;await c.map(z,async x=>{x=await c.result("loadAll"in x&&"function"===typeof x.loadAll?x.loadAll():x.load());!1!==x.ok||m||(m=x)});if(m)throw m.error;return n}a.loadAll=async function(n,g){await n.load();return I(n,g)};a.loadAllChildren=I;Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/portal/Portal":function(){define("require ../chunks/tslib.es6 ../config ../kernel ../request ../core/Error ../core/JSONSupport ../core/Loadable ../core/maybe ../core/promiseUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../geometry/Extent ../intl/locale ./portalDefault ./PortalGroup ./PortalQueryParams ./PortalQueryResult ./PortalUser ../support/apiKeyUtils".split(" "),
function(a,c,w,v,I,n,g,z,d,m,x,B,E,p,f,b,q,A,F,L,h,H,S,C){function k(D){const R=v.id;return()=>{const Q=D.deref();Q&&R.findCredential(Q.restUrl)&&Q.signIn().catch(()=>{})}}const y=D=>Object.freeze(Object.defineProperty({__proto__:null,default:D},Symbol.toStringTag,{value:"Module"}));var N;let l;const O={PortalGroup:()=>Promise.resolve({default:L}),PortalItem:()=>new Promise((D,R)=>a(["./PortalItem"],Q=>D(y(Q)),R)),PortalUser:()=>Promise.resolve({default:S})};g=N=class extends g.JSONSupportMixin(z){constructor(D){super(D);
this.access=this._esriIdCredentialCreateHandle=null;this.allSSL=!1;this.authMode="auto";this.bingKey=this.basemapGalleryGroupQuery3D=this.basemapGalleryGroupQuery=this.authorizedCrossOriginDomains=null;this.canProvisionDirectPurchase=this.canListPreProvisionedItems=this.canListData=this.canListApps=!1;this.canSearchPublic=!0;this.canSignInIDP=this.canSignInArcGIS=this.canSharePublic=this.canShareBingPublic=!1;this.colorSetsGroupQuery=null;this.commentsEnabled=!1;this.livingAtlasGroupQuery=this.galleryTemplatesGroupQuery=
this.featuredItemsGroupQuery=this.featuredGroups=this.eueiEnabled=this.devBasemapGalleryGroupQuery=this.description=this.defaultVectorBasemap=this.defaultExtent=this.defaultDevBasemap=this.defaultBasemap=this.customBaseUrl=this.culture=this.created=null;this.hasCategorySchema=!1;this.ipCntryCode=this.id=this.httpsPort=this.httpPort=this.homePageFeaturedContentCount=this.homePageFeaturedContent=this.helperServices=null;this.isReadOnly=this.isPortal=!1;this.rotatorPanels=this.region=this.portalProperties=
this.portalMode=this.portalHostname=this.name=this.modified=this.maxTokenExpirationMinutes=this.layerTemplatesGroupQuery=null;this.showHomePageDescription=!1;this.sourceJSON=null;this.supportsHostedServices=!1;this.units=this.templatesGroupQuery=this.symbolSetsGroupQuery=null;this.url=w.portalUrl;this.user=this.urlKey=null;this.use3dBasemaps=!0;this.useVectorBasemaps=this.useStandardizedQuery=!1;this.vectorBasemapGalleryGroupQuery=null}normalizeCtorArgs(D){return"string"===typeof D?{url:D}:D}destroy(){u.unregister(this);
this.defaultBasemap=d.destroyMaybe(this.defaultBasemap);this.defaultDevBasemap=d.destroyMaybe(this.defaultDevBasemap);this.defaultVectorBasemap=d.destroyMaybe(this.defaultVectorBasemap);this._esriIdCredentialCreateHandle=d.removeMaybe(this._esriIdCredentialCreateHandle)}readAuthorizedCrossOriginDomains(D){if(D)for(const R of D)w.request.trustedServers.includes(R)||w.request.trustedServers.push(R);return D}readDefaultBasemap(D){return this._readBasemap(D)}readDefaultDevBasemap(D){return this._readBasemap(D)}readDefaultVectorBasemap(D){return this._readBasemap(D)}get extraQuery(){const D=
!this.user?.orgId||this.canSearchPublic;return this.id&&!D?` AND orgid:${this.id}`:null}get isOrganization(){return!!this.access}get itemPageUrl(){return this.url?`${this.url}/home/item.html`:null}get restUrl(){let D=this.url;if(D){const R=D.indexOf("/sharing");D=0<R?D.substring(0,R):this.url.replace(/\/+$/,"");D+="/sharing/rest"}return D}get thumbnailUrl(){const D=this.restUrl,R=this.thumbnail;return D&&R?this._normalizeSSL(D+"/portals/self/resources/"+R):null}readUrlKey(D){return D?D.toLowerCase():
D}readUser(D){let R=null;D&&(R=S.fromJSON(D),R.portal=this);return R}load(D){const R=(new Promise((Q,U)=>a(["../Basemap"],Z=>Q(y(Z)),U))).then(({default:Q})=>{m.throwIfAborted(D);l=Q}).then(()=>this.sourceJSON?this.sourceJSON:this.fetchSelf(this.authMode,!1,D)).then(Q=>{if(v.id){const U=v.id;this.credential=U.findCredential(this.restUrl);this.credential||this.authMode!==N.AUTH_MODE_AUTO||(this._esriIdCredentialCreateHandle?.remove(),this._esriIdCredentialCreateHandle=U.on("credential-create",k(new WeakRef(this))),
u.register(this,this._esriIdCredentialCreateHandle,this))}this.sourceJSON=Q;this.read(Q)});this.addResolvingPromise(R);return Promise.resolve(this)}async createElevationLayers(){await this.load();const D=this._getHelperService("defaultElevationLayers"),R=(await new Promise((Q,U)=>a(["../layers/ElevationLayer"],Z=>Q(y(Z)),U))).default;return D?D.map(Q=>new R({id:Q.id,url:Q.url})):[]}async fetchBasemaps(D,R){const Q=await this._fetchBasemaps(D,R);!0===R?.include3d&&!1!==this.use3dBasemaps&&(D=await this._fetchBasemaps3D(D,
R),Q.unshift(...D));return Q}fetchCategorySchema(D){return this.hasCategorySchema?this.request(this.restUrl+"/portals/self/categorySchema",D).then(R=>R.categorySchema):m.isAborted(D)?Promise.reject(m.createAbortError()):Promise.resolve([])}fetchFeaturedGroups(D){const R=this.featuredGroups,Q=new h;Q.num=100;Q.sortField="title";if(R&&R.length){const U=[];for(const Z of R)U.push(`(title:"${Z.title}" AND owner:${Z.owner})`);Q.query=U.join(" OR ");return this.queryGroups(Q,D).then(Z=>Z.results)}return m.isAborted(D)?
Promise.reject(m.createAbortError()):Promise.resolve([])}fetchRegions(D){const R=this.user?.culture||this.culture||A.getLocale();return this.request(this.restUrl+"/portals/regions",{...D,query:{culture:R}})}fetchSettings(D){const R=this.user?.culture||this.culture||A.getLocale();return this.request(this.restUrl+"/portals/self/settings",{...D,query:{culture:R}})}static getDefault(){return F.ensureDefaultPortalInstance(()=>new N)}queryGroups(D,R){return this.queryPortal("/community/groups",D,"PortalGroup",
R)}queryItems(D,R){return this.queryPortal("/search",D,"PortalItem",R)}queryUsers(D,R){D.sortField||(D.sortField="username");return this.queryPortal("/community/users",D,"PortalUser",R)}fetchSelf(D=this.authMode,R=!1,Q){const U=this.restUrl+"/portals/self";D={authMode:D,query:{culture:A.getLocale().toLowerCase()},...Q};"auto"===D.authMode&&(D.authMode="no-prompt");R&&(D.query.default=!0);return this.request(U,D)}queryPortal(D,R,Q,U){const Z=B.ensureType(h,R),ea=la=>this.request(this.restUrl+D,{...Z.toRequestOptions(this),
...U}).then(na=>{const ta=Z.clone();ta.start=na.nextStart;return new H({nextQueryParams:ta,queryParams:Z,total:na.total,results:N._resultsToTypedArray(la,{portal:this},na,U)})}).then(na=>Promise.all(na.results.map(ta=>"function"===typeof ta.when?ta.when():na)).then(()=>na,ta=>{m.throwIfAbortError(ta);return na}));return Q&&O[Q]?O[Q]().then(({default:la})=>{m.throwIfAborted(U);return ea(la)}):ea()}signIn(){if(this.authMode===N.AUTH_MODE_ANONYMOUS)return Promise.reject(new n("portal:invalid-auth-mode",
`Current "authMode"' is "${this.authMode}"`));if("failed"===this.loadStatus)return Promise.reject(this.loadError);const D=R=>Promise.resolve().then(()=>{if("not-loaded"===this.loadStatus)return R||(this.authMode="immediate"),this.load().then(()=>null);if("loading"===this.loadStatus)return this.load().then(()=>{if(this.credential)return null;this.credential=R;return this.fetchSelf("immediate")});if(this.user&&this.credential===R)return null;this.credential=R;return this.fetchSelf("immediate")}).then(Q=>
{Q&&(this.sourceJSON=Q,this.read(Q))});return v.id?v.id.getCredential(this.restUrl).then(R=>D(R)):D(this.credential)}normalizeUrl(D){const R=this.credential?.token;return this._normalizeSSL(R?D+(D.includes("?")?"\x26":"?")+"token\x3d"+R:D)}requestToTypedArray(D,R,Q){return this.request(D,R).then(U=>{const Z=N._resultsToTypedArray(Q,{portal:this},U);return Promise.all(Z.map(ea=>"function"===typeof ea.when?ea.when():U)).then(()=>Z,()=>Z)})}request(D,R={}){const Q={f:"json",...R.query},{authMode:U=this.authMode===
N.AUTH_MODE_ANONYMOUS?"anonymous":"auto",body:Z=null,cacheBust:ea=!1,method:la="auto",responseType:na="json",signal:ta}=R;R={authMode:U,body:Z,cacheBust:ea,method:la,query:Q,responseType:na,timeout:0,signal:ta};return I(this._normalizeSSL(D),R).then(ua=>ua.data)}toJSON(){throw new n("internal:not-yet-implemented","Portal.toJSON is not yet implemented");}static fromJSON(D){if(!D)return null;if(D.declaredClass)throw Error("JSON object is already hydrated");return new N({sourceJSON:D})}_getHelperService(D){const R=
this.helperServices&&this.helperServices[D];if(!R)throw new n("portal:service-not-found",`The \`helperServices\` do not include an entry named "${D}"`);return R}async _fetchBasemaps(D,R){const Q=new h;Q.query=D||(w.apiKey&&C.supportsApiKey(this.url)?this.devBasemapGalleryGroupQuery:this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery);Q.disableExtraQuery=!0;D=await this.queryGroups(Q,R);if(!D.total)return[];D=D.results[0];Q.num=100;Q.query='type:"Web Map" -type:"Web Application"';
Q.sortField=D.sortField||"name";Q.sortOrder=D.sortOrder||"desc";R=await D.queryItems(Q,R);return R.total?R.results.filter(U=>"Web Map"===U.type).map(U=>new l({portalItem:U})):[]}async _fetchBasemaps3D(D,R){D=D||this.basemapGalleryGroupQuery3D;if(!D)return[];D=new h({query:D,disableExtraQuery:!0});var Q=await this.queryGroups(D,R);if(!Q.total)return[];Q=Q.results[0];D.num=100;D.query='type:"Web Scene"';D.sortField=Q.sortField||"name";D.sortOrder=Q.sortOrder||"desc";R=await Q.queryItems(D,R);return R.total?
R.results.filter(U=>"Web Scene"===U.type).map(U=>new l({portalItem:U})):[]}_normalizeSSL(D){return D.replace(/^http:/i,"https:").replace(":7080",":7443")}_readBasemap(D){return D?(D=l.fromJSON(D),D.portalItem={portal:this},D):null}static _resultsToTypedArray(D,R,Q,U){let Z=[];if(Q){const ea=null!=U?U.signal:null;Z=Q.listings||Q.notifications||Q.userInvitations||Q.tags||Q.items||Q.groups||Q.comments||Q.provisions||Q.results||Q.relatedItems||Q;if(D||R)Z=Z.map(la=>{la=Object.assign(D?D.fromJSON(la):
la,R);"function"===typeof la.load&&la.load(ea);return la})}else Z=[];return Z}};g.AUTH_MODE_ANONYMOUS="anonymous";g.AUTH_MODE_AUTO="auto";g.AUTH_MODE_IMMEDIATE="immediate";c.__decorate([x.property()],g.prototype,"access",void 0);c.__decorate([x.property()],g.prototype,"allSSL",void 0);c.__decorate([x.property()],g.prototype,"authMode",void 0);c.__decorate([x.property()],g.prototype,"authorizedCrossOriginDomains",void 0);c.__decorate([f.reader("authorizedCrossOriginDomains")],g.prototype,"readAuthorizedCrossOriginDomains",
null);c.__decorate([x.property()],g.prototype,"basemapGalleryGroupQuery",void 0);c.__decorate([x.property({json:{name:"3DBasemapGalleryGroupQuery"}})],g.prototype,"basemapGalleryGroupQuery3D",void 0);c.__decorate([x.property()],g.prototype,"bingKey",void 0);c.__decorate([x.property()],g.prototype,"canListApps",void 0);c.__decorate([x.property()],g.prototype,"canListData",void 0);c.__decorate([x.property()],g.prototype,"canListPreProvisionedItems",void 0);c.__decorate([x.property()],g.prototype,"canProvisionDirectPurchase",
void 0);c.__decorate([x.property()],g.prototype,"canSearchPublic",void 0);c.__decorate([x.property()],g.prototype,"canShareBingPublic",void 0);c.__decorate([x.property()],g.prototype,"canSharePublic",void 0);c.__decorate([x.property()],g.prototype,"canSignInArcGIS",void 0);c.__decorate([x.property()],g.prototype,"canSignInIDP",void 0);c.__decorate([x.property()],g.prototype,"colorSetsGroupQuery",void 0);c.__decorate([x.property()],g.prototype,"commentsEnabled",void 0);c.__decorate([x.property({type:Date})],
g.prototype,"created",void 0);c.__decorate([x.property()],g.prototype,"credential",void 0);c.__decorate([x.property()],g.prototype,"culture",void 0);c.__decorate([x.property()],g.prototype,"currentVersion",void 0);c.__decorate([x.property()],g.prototype,"customBaseUrl",void 0);c.__decorate([x.property()],g.prototype,"defaultBasemap",void 0);c.__decorate([f.reader("defaultBasemap")],g.prototype,"readDefaultBasemap",null);c.__decorate([x.property()],g.prototype,"defaultDevBasemap",void 0);c.__decorate([f.reader("defaultDevBasemap")],
g.prototype,"readDefaultDevBasemap",null);c.__decorate([x.property({type:q})],g.prototype,"defaultExtent",void 0);c.__decorate([x.property()],g.prototype,"defaultVectorBasemap",void 0);c.__decorate([f.reader("defaultVectorBasemap")],g.prototype,"readDefaultVectorBasemap",null);c.__decorate([x.property()],g.prototype,"description",void 0);c.__decorate([x.property()],g.prototype,"devBasemapGalleryGroupQuery",void 0);c.__decorate([x.property()],g.prototype,"eueiEnabled",void 0);c.__decorate([x.property({readOnly:!0})],
g.prototype,"extraQuery",null);c.__decorate([x.property()],g.prototype,"featuredGroups",void 0);c.__decorate([x.property()],g.prototype,"featuredItemsGroupQuery",void 0);c.__decorate([x.property()],g.prototype,"galleryTemplatesGroupQuery",void 0);c.__decorate([x.property()],g.prototype,"livingAtlasGroupQuery",void 0);c.__decorate([x.property()],g.prototype,"hasCategorySchema",void 0);c.__decorate([x.property()],g.prototype,"helpBase",void 0);c.__decorate([x.property()],g.prototype,"helperServices",
void 0);c.__decorate([x.property()],g.prototype,"helpMap",void 0);c.__decorate([x.property()],g.prototype,"homePageFeaturedContent",void 0);c.__decorate([x.property()],g.prototype,"homePageFeaturedContentCount",void 0);c.__decorate([x.property()],g.prototype,"httpPort",void 0);c.__decorate([x.property()],g.prototype,"httpsPort",void 0);c.__decorate([x.property()],g.prototype,"id",void 0);c.__decorate([x.property()],g.prototype,"ipCntryCode",void 0);c.__decorate([x.property({readOnly:!0})],g.prototype,
"isOrganization",null);c.__decorate([x.property()],g.prototype,"isPortal",void 0);c.__decorate([x.property()],g.prototype,"isReadOnly",void 0);c.__decorate([x.property({readOnly:!0})],g.prototype,"itemPageUrl",null);c.__decorate([x.property()],g.prototype,"layerTemplatesGroupQuery",void 0);c.__decorate([x.property()],g.prototype,"maxTokenExpirationMinutes",void 0);c.__decorate([x.property({type:Date})],g.prototype,"modified",void 0);c.__decorate([x.property()],g.prototype,"name",void 0);c.__decorate([x.property()],
g.prototype,"portalHostname",void 0);c.__decorate([x.property()],g.prototype,"portalMode",void 0);c.__decorate([x.property()],g.prototype,"portalProperties",void 0);c.__decorate([x.property()],g.prototype,"region",void 0);c.__decorate([x.property({readOnly:!0})],g.prototype,"restUrl",null);c.__decorate([x.property()],g.prototype,"rotatorPanels",void 0);c.__decorate([x.property()],g.prototype,"showHomePageDescription",void 0);c.__decorate([x.property()],g.prototype,"sourceJSON",void 0);c.__decorate([x.property()],
g.prototype,"staticImagesUrl",void 0);c.__decorate([x.property({json:{name:"2DStylesGroupQuery"}})],g.prototype,"stylesGroupQuery2d",void 0);c.__decorate([x.property({json:{name:"stylesGroupQuery"}})],g.prototype,"stylesGroupQuery3d",void 0);c.__decorate([x.property()],g.prototype,"supportsHostedServices",void 0);c.__decorate([x.property()],g.prototype,"symbolSetsGroupQuery",void 0);c.__decorate([x.property()],g.prototype,"templatesGroupQuery",void 0);c.__decorate([x.property()],g.prototype,"thumbnail",
void 0);c.__decorate([x.property({readOnly:!0})],g.prototype,"thumbnailUrl",null);c.__decorate([x.property()],g.prototype,"units",void 0);c.__decorate([x.property()],g.prototype,"url",void 0);c.__decorate([x.property()],g.prototype,"urlKey",void 0);c.__decorate([f.reader("urlKey")],g.prototype,"readUrlKey",null);c.__decorate([x.property()],g.prototype,"user",void 0);c.__decorate([f.reader("user")],g.prototype,"readUser",null);c.__decorate([x.property()],g.prototype,"use3dBasemaps",void 0);c.__decorate([x.property()],
g.prototype,"useStandardizedQuery",void 0);c.__decorate([x.property()],g.prototype,"useVectorBasemaps",void 0);c.__decorate([x.property()],g.prototype,"vectorBasemapGalleryGroupQuery",void 0);c=g=N=c.__decorate([b.subclass("esri.portal.Portal")],g);const u=new FinalizationRegistry(D=>{D.remove()});return c})},"esri/portal/portalDefault":function(){define(["exports"],function(a){let c;a.clearDefaultPortalInstance=function(){c=void 0};a.ensureDefaultPortalInstance=function(w){if(!c||c.destroyed)c=w();
return c};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/portal/PortalGroup":function(){define("../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./PortalQueryParams".split(" "),function(a,c,w,v,I,n,g,z,d){var m;w=m=class extends w.JSONSupport{constructor(x){super(x);this.id=this.description=this.created=this.access=null;
this.isInvitationOnly=!1;this.title=this.tags=this.sourceJSON=this.sortOrder=this.sortField=this.snippet=this.portal=this.owner=this.modified=null}get thumbnailUrl(){const x=this.url,B=this.thumbnail;return x&&B&&this.portal?this.portal?.normalizeUrl(`${x}/info/${B}?f=json`):null}get url(){const x=this.portal?.restUrl;return x?x+"/community/groups/"+this.id:null}fetchCategorySchema(x){return this.portal.request(this.url+"/categorySchema",x).then(B=>{B=B.categorySchema||[];return B.some(E=>"contentCategorySetsGroupQuery.LivingAtlas"===
E.source)?this._fetchCategorySchemaSet("LivingAtlas",x):B})}fetchMembers(x){return this.portal.request(this.url+"/users",x)}getThumbnailUrl(x){let B=this.thumbnailUrl;B&&x&&(B+=`&w=${x}`);return B}toJSON(){throw new c("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented");}static fromJSON(x){if(!x)return null;if(x.declaredClass)throw Error("JSON object is already hydrated");const B=new m;B.sourceJSON=x;B.read(x);return B}queryItems(x,B){x=I.ensureType(d,x);const E=this.portal;
if(5<parseFloat(E.currentVersion))return x=x||new d,E.queryPortal(`/content/groups/${this.id}/search`,x,"PortalItem",B);x=x?x.clone():new d;x.query="group:"+this.id+(x.query?" "+x.query:"");return E.queryItems(x,B)}_fetchCategorySchemaSet(x,B){const E=this.portal;return E.fetchSelf(E.authMode,!0,B).then(p=>{if(p=p.contentCategorySetsGroupQuery){const f=new d;f.disableExtraQuery=!0;f.num=1;f.query=p;return E.queryGroups(f,B)}throw new c("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found");
}).then(p=>{if(p.total){p=p.results[0];const f=new d;f.num=1;f.query=`typekeywords:"${x}"`;return p.queryItems(f,B)}throw new c("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found");}).then(p=>p.total?p.results[0].fetchData("json",B).then(f=>{f=f?.categorySchema;return f?.length?f:[]}):[])}};a.__decorate([v.property()],w.prototype,"access",void 0);a.__decorate([v.property({type:Date})],w.prototype,"created",void 0);a.__decorate([v.property()],w.prototype,"description",
void 0);a.__decorate([v.property()],w.prototype,"id",void 0);a.__decorate([v.property()],w.prototype,"isInvitationOnly",void 0);a.__decorate([v.property({type:Date})],w.prototype,"modified",void 0);a.__decorate([v.property()],w.prototype,"owner",void 0);a.__decorate([v.property()],w.prototype,"portal",void 0);a.__decorate([v.property()],w.prototype,"snippet",void 0);a.__decorate([v.property()],w.prototype,"sortField",void 0);a.__decorate([v.property()],w.prototype,"sortOrder",void 0);a.__decorate([v.property()],
w.prototype,"sourceJSON",void 0);a.__decorate([v.property()],w.prototype,"tags",void 0);a.__decorate([v.property()],w.prototype,"thumbnail",void 0);a.__decorate([v.property({readOnly:!0})],w.prototype,"thumbnailUrl",null);a.__decorate([v.property()],w.prototype,"title",void 0);a.__decorate([v.property({readOnly:!0})],w.prototype,"url",null);return w=m=a.__decorate([z.subclass("esri.portal.PortalGroup")],w)})},"esri/portal/PortalQueryParams":function(){define("../chunks/tslib.es6 ../core/Accessor ../core/jsonMap ../core/lang ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ../geometry/Extent ../geometry/SpatialReference ../geometry/support/webMercatorUtils".split(" "),
function(a,c,w,v,I,n,g,z,d,m){var x;const B=new w.JSONMap({avgRating:"avg-rating",numRatings:"num-ratings",numComments:"num-comments",numViews:"num-views"});c=x=class extends c{constructor(E){super(E);this.categories=null;this.disableExtraQuery=!1;this.filter=this.extent=null;this.num=10;this.sortField=this.query=null;this.start=1}get sortOrder(){return this._get("sortOrder")||"asc"}set sortOrder(E){"asc"!==E&&"desc"!==E||this._set("sortOrder",E)}clone(){return new x({categories:this.categories?v.clone(this.categories):
null,disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():null,filter:this.filter,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})}toRequestOptions(E,p){let f=[];this.categories&&(f=this.categories.map(A=>Array.isArray(A)?JSON.stringify(A):A));let b="";if(this.extent){var q=m.project(this.extent,d.WGS84);null!=q&&(b=`${q.xmin},${q.ymin},${q.xmax},${q.ymax}`)}q=this.query;!this.disableExtraQuery&&E.extraQuery&&(q="("+q+")"+
E.extraQuery);E={categories:f,bbox:b,q,filter:this.filter,num:this.num,sortField:null,sortOrder:null,start:this.start};this.sortField&&(E.sortField=this.sortField.split(",").map(A=>B.toJSON(A.trim())).join(","),E.sortOrder=this.sortOrder);return{query:{...p,...E}}}};a.__decorate([I.property()],c.prototype,"categories",void 0);a.__decorate([I.property()],c.prototype,"disableExtraQuery",void 0);a.__decorate([I.property({type:z})],c.prototype,"extent",void 0);a.__decorate([I.property()],c.prototype,
"filter",void 0);a.__decorate([I.property()],c.prototype,"num",void 0);a.__decorate([I.property()],c.prototype,"query",void 0);a.__decorate([I.property()],c.prototype,"sortField",void 0);a.__decorate([I.property()],c.prototype,"sortOrder",null);a.__decorate([I.property()],c.prototype,"start",void 0);return c=x=a.__decorate([g.subclass("esri.portal.PortalQueryParams")],c)})},"esri/portal/PortalQueryResult":function(){define("../chunks/tslib.es6 ../core/Accessor ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass".split(" "),
function(a,c,w,v,I,n,g){c=class extends c{constructor(z){super(z);this.total=this.results=this.queryParams=this.nextQueryParams=null}};a.__decorate([w.property()],c.prototype,"nextQueryParams",void 0);a.__decorate([w.property()],c.prototype,"queryParams",void 0);a.__decorate([w.property()],c.prototype,"results",void 0);a.__decorate([w.property()],c.prototype,"total",void 0);return c=a.__decorate([g.subclass("esri.portal.PortalQueryResult")],c)})},"esri/portal/PortalUser":function(){define("require ../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./PortalFolder ./PortalGroup".split(" "),
function(a,c,w,v,I,n,g,z,d,m,x){var B;v=B=class extends v.JSONSupport{constructor(...E){super(...E);this.userType=this.username=this.units=this.sourceJSON=this.roleId=this.role=this.region=this.privileges=this.preferredView=this.portal=this.orgId=this.modified=this.fullName=this.email=this.description=this.culture=this.created=this.access=null}get thumbnailUrl(){const E=this.url,p=this.thumbnail;return E&&p?this.portal.normalizeUrl(`${E}/info/${p}?f=json`):null}get userContentUrl(){const E=this.portal?.restUrl;
return E?`${E}/content/users/${this.username}`:null}get url(){const E=this.portal?.restUrl;return E?`${E}/community/users/${this.username}`:null}addItem(E){const p=E&&E.item;var f=E?.data;E=E?.folder;const b={method:"post"};p&&(b.query=p.createPostQuery(),null!=f&&("string"===typeof f?b.query.text=f:"object"===typeof f&&(b.query.text=JSON.stringify(f))));f=this.userContentUrl;E&&(f+="/"+("string"===typeof E?E:E.id));return this.portal.request(f+"/addItem",b).then(q=>{p.id=q.id;p.portal=this.portal;
return p.loaded?p.reload():p.load()})}deleteItem(E){let p=this.userContentUrl;E.ownerFolder&&(p+="/"+E.ownerFolder);return this.portal.request(p+`/items/${E.id}/delete`,{method:"post"}).then(()=>{E.id=null;E.portal=null})}deleteItems(E){const p=this.userContentUrl+"/deleteItems";var f=E.map(b=>b.id);return f.length?(f={method:"post",query:{items:f.join(",")}},this.portal.request(p,f).then(()=>{E.forEach(b=>{b.id=null;b.portal=null})})):Promise.resolve(void 0)}fetchFolders(){return this.portal.request(this.userContentUrl??
"",{query:{num:1}}).then(E=>E&&E.folders?E.folders.map(p=>{p=m.fromJSON(p);p.portal=this.portal;return p}):[])}fetchGroups(){return this.portal.request(this.url??"").then(E=>E&&E.groups?E.groups.map(p=>{p=x.fromJSON(p);p.portal=this.portal;return p}):[])}fetchItems(E){const p=E??{};let f=this.userContentUrl??"";p.folder&&(f+="/"+p.folder.id);let b;return(new Promise((q,A)=>a(["./PortalItem"],F=>q(Object.freeze(Object.defineProperty({__proto__:null,default:F},Symbol.toStringTag,{value:"Module"}))),
A))).then(({default:q})=>{b=q;return this.portal.request(f,{query:{folders:!1,num:p.num||10,start:p.start||1,sortField:p.sortField||"created",sortOrder:p.sortOrder||"asc"}})}).then(q=>{let A;return q?.items?(A=q.items.map(F=>{F=b.fromJSON(F);F.portal=this.portal;return F}),Promise.all(A.map(F=>F.load())).catch(F=>F).then(()=>({items:A,nextStart:q.nextStart,total:q.total}))):{items:[],nextStart:-1,total:0}})}fetchTags(){return this.portal.request(this.url+"/tags").then(E=>E.tags)}getThumbnailUrl(E){let p=
this.thumbnailUrl;p&&E&&(p+=`&w=${E}`);return p}queryFavorites(E){return this.favGroupId?(this._favGroup||(this._favGroup=new x({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(E)):Promise.reject(new w("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))}toJSON(){throw new w("internal:not-yet-implemented","PortalUser.toJSON is not yet implemented");}static fromJSON(E){if(!E)return null;if(E.declaredClass)throw Error("JSON object is already hydrated");
const p=new B;p.sourceJSON=E;p.read(E);return p}};c.__decorate([I.property()],v.prototype,"access",void 0);c.__decorate([I.property({type:Date})],v.prototype,"created",void 0);c.__decorate([I.property()],v.prototype,"culture",void 0);c.__decorate([I.property()],v.prototype,"description",void 0);c.__decorate([I.property()],v.prototype,"email",void 0);c.__decorate([I.property()],v.prototype,"favGroupId",void 0);c.__decorate([I.property()],v.prototype,"fullName",void 0);c.__decorate([I.property({type:Date})],
v.prototype,"modified",void 0);c.__decorate([I.property()],v.prototype,"orgId",void 0);c.__decorate([I.property()],v.prototype,"portal",void 0);c.__decorate([I.property()],v.prototype,"preferredView",void 0);c.__decorate([I.property()],v.prototype,"privileges",void 0);c.__decorate([I.property()],v.prototype,"region",void 0);c.__decorate([I.property()],v.prototype,"role",void 0);c.__decorate([I.property()],v.prototype,"roleId",void 0);c.__decorate([I.property()],v.prototype,"sourceJSON",void 0);c.__decorate([I.property()],
v.prototype,"thumbnail",void 0);c.__decorate([I.property({readOnly:!0})],v.prototype,"thumbnailUrl",null);c.__decorate([I.property()],v.prototype,"units",void 0);c.__decorate([I.property({readOnly:!0})],v.prototype,"userContentUrl",null);c.__decorate([I.property({readOnly:!0})],v.prototype,"url",null);c.__decorate([I.property()],v.prototype,"username",void 0);c.__decorate([I.property()],v.prototype,"userType",void 0);return v=B=c.__decorate([d.subclass("esri.portal.PortalUser")],v)})},"esri/portal/PortalFolder":function(){define("../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass".split(" "),
function(a,c,w,v,I,n,g,z){w=class extends w.JSONSupport{constructor(d){super(d);this.username=this.title=this.portal=this.id=this.created=null}get url(){const d=this.portal?.restUrl;return d?`${d}/content/users/${this.username}/${this.id}`:null}toJSON(){throw new c("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented");}};a.__decorate([v.property({type:Date})],w.prototype,"created",void 0);a.__decorate([v.property()],w.prototype,"id",void 0);a.__decorate([v.property()],w.prototype,
"portal",void 0);a.__decorate([v.property()],w.prototype,"title",void 0);a.__decorate([v.property({readOnly:!0})],w.prototype,"url",null);a.__decorate([v.property()],w.prototype,"username",void 0);return w=a.__decorate([z.subclass("esri.portal.PortalFolder")],w)})},"esri/portal/PortalItem":function(){define("require ../chunks/tslib.es6 ../assets ../kernel ../core/Error ../core/JSONSupport ../core/lang ../core/Loadable ../core/urlUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../geometry/Extent ./Portal ./PortalItemResource ./PortalRating".split(" "),
function(a,c,w,v,I,n,g,z,d,m,x,B,E,p,f,b,q){var A;const F=new Set("Map Service;Feature Service;Feature Collection;Scene Service;Image Service;Stream Service;Vector Tile Service;GeoJson;CSV;KML;WFS;WMTS;WMS;Feed".split(";")),L=new Set(["KML","GeoJson","CSV"]);n=A=class extends n.JSONSupportMixin(z){static from(h){return x.ensureClass(A,h)}constructor(h){super(h);this.id=this.groupCategories=this.extent=this.description=this.culture=this.created=this.categories=this.avgRating=this.applicationProxies=
this.apiKey=this.accessInformation=this.access=null;this.isOrgItem=!1;this.url=this.typeKeywords=this.type=this.title=this.tags=this.spatialReference=this.sourceUrl=this.sourceJSON=this.snippet=this.size=this.screenshots=this.portal=this.ownerFolder=this.owner=this.numViews=this.numRatings=this.numComments=this.name=this.modified=this.licenseInfo=this.itemControl=null}destroy(){this.portal=null}get displayName(){const h=this.type,H=this.typeKeywords||[];let S=h;"Feature Service"===h||"Feature Collection"===
h?S=H.includes("Table")?"Table":H.includes("Route Layer")?"Route Layer":H.includes("Markup")?"Markup":"Feature Layer":"Image Service"===h?S=H.includes("Elevation 3D Layer")?"Elevation Layer":H.includes("Tiled Imagery")?"Tiled Imagery Layer":"Imagery Layer":"Scene Service"===h?S="Scene Layer":"Video Service"===h?S="Video Layer":"Scene Package"===h?S="Scene Layer Package":"Stream Service"===h?S="Feature Layer":"Geoprocessing Service"===h?S=H.includes("Web Tool")?"Tool":"Geoprocessing Service":"Geocoding Service"===
h?S="Locator":"Geoenrichment Service"===h?S="GeoEnrichment Service":"Microsoft Powerpoint"===h?S="Microsoft PowerPoint":"GeoJson"===h?S="GeoJSON":"Globe Service"===h?S="Globe Layer":"Vector Tile Service"===h?S="Tile Layer":"netCDF"===h?S="NetCDF":"Map Service"===h?S=H.includes("Spatiotemporal")||!H.includes("Hosted Service")&&!H.includes("Tiled")||H.includes("Relational")?"Map Image Layer":"Tile Layer":h&&h.toLowerCase().includes("add in")?S=h.replaceAll(/(add in)/gi,"Add-In"):"datastore catalog service"===
h?S="Big Data File Share":"Compact Tile Package"===h?S="Tile Package (tpkx)":"OGCFeatureServer"===h?S="OGC Feature Layer":"web mapping application"===h&&H.includes("configurableApp")?S="Instant App":"Insights Page"===h?S="Insights Report":"Excalibur Imagery Project"===h&&(S="Excalibur Project");return S}readExtent(h){return h&&h.length?new p(h[0][0],h[0][1],h[1][0],h[1][1]):null}get iconUrl(){var h=this.type?.toLowerCase()||"";const H=this.typeKeywords||[];var S=!1;let C=!1,k=!1,y=!1,N=!1,l=!1;S=
!1;0<h.indexOf("service")||"feature collection"===h||"kml"===h||"wms"===h||"wmts"===h||"wfs"===h?(S=H.includes("Hosted Service"),"feature service"===h||"feature collection"===h||"kml"===h||"wfs"===h?(C=H.includes("Table"),k=H.includes("Route Layer"),y=H.includes("Markup"),N=H.includes("Spatiotemporal"),l=H.includes("UtilityNetwork"),h=N&&C?"spatiotemporaltable":C?"table":k?"routelayer":y?"markup":N?"spatiotemporal":S?"featureshosted":l?"utilitynetwork":"features"):h="map service"===h||"wms"===h||
"wmts"===h?S||H.includes("Tiled")||"wmts"===h?"maptiles":"mapimages":"scene service"===h?H.includes("Line")?"sceneweblayerline":H.includes("3DObject")?"sceneweblayermultipatch":H.includes("Point")?"sceneweblayerpoint":H.includes("IntegratedMesh")?"sceneweblayermesh":H.includes("PointCloud")?"sceneweblayerpointcloud":H.includes("Polygon")?"sceneweblayerpolygon":H.includes("Building")?"sceneweblayerbuilding":H.includes("Voxel")?"sceneweblayervoxel":"sceneweblayer":"image service"===h?H.includes("Elevation 3D Layer")?
"elevationlayer":H.includes("Tiled Imagery")?"tiledimagerylayer":"imagery":"stream service"===h?"streamlayer":"video service"===h?H.includes("Live Stream")?"livestreamvideolayer":"videolayer":"vector tile service"===h?"vectortile":"datastore catalog service"===h?"datastorecollection":"geocoding service"===h?"geocodeservice":"geoprocessing service"===h?H.includes("Web Tool")?"tool":"layers":"geodata service"===h?"geodataservice":"3dtiles service"===h?"3dtileslayer":"layers"):h="web map"===h||"cityengine web scene"===
h?"maps":"web scene"===h?H.includes("ViewingMode-Local")?"webscenelocal":"websceneglobal":"web mapping application"===h&&H.includes("configurableApp")?"instantapps":"web mapping application"===h||"mobile application"===h||"application"===h||"operation view"===h||"desktop application"===h?"apps":"map document"===h||"map package"===h||"published map"===h||"scene document"===h||"globe document"===h||"basemap package"===h||"mobile basemap package"===h||"mobile map package"===h||"project package"===h||
"project template"===h||"pro map"===h||"layout"===h||"layer"===h&&H.includes("ArcGIS Pro")||"explorer map"===h&&H.indexOf("Explorer Document")?"mapsgray":"service definition"===h||"csv"===h||"shapefile"===h||"cad drawing"===h||"geojson"===h||"netcdf"===h||"administrative report"===h?"datafiles":"explorer add in"===h||"desktop add in"===h||"windows viewer add in"===h||"windows viewer configuration"===h?"appsgray":"360 vr experience"===h?"360vr":"arcgis pro add in"===h||"arcgis pro configuration"===
h?"addindesktop":"rule package"===h||"file geodatabase"===h||"sqlite geodatabase"===h||"csv collection"===h||"kml collection"===h||"windows mobile package"===h||"map template"===h||"desktop application template"===h||"gml"===h||"arcpad package"===h||"code sample"===h||"document link"===h||"earth configuration"===h||"operations dashboard add in"===h||"rules package"===h||"image"===h||"workflow manager package"===h||"explorer map"===h&&H.includes("Explorer Mapping Application")||H.includes("Document")?
"datafilesgray":"network analysis service"===h||"geoprocessing service"===h||"geodata service"===h||"geometry service"===h||"geoprocessing package"===h||"locator package"===h||"geoprocessing sample"===h||"workflow manager service"===h?"toolsgray":"layer"===h||"layer package"===h||"explorer layer"===h?"layersgray":"scene package"===h?"scenepackage":"3dtiles package"===h?"3dtileslayerpackage":"mobile scene package"===h?"mobilescenepackage":"tile package"===h||"compact tile package"===h?"tilepackage":
"task file"===h?"taskfile":"report template"===h?"report-template":"statistical data collection"===h?"statisticaldatacollection":"insights workbook"===h?"workbook":"insights model"===h?"insightsmodel":"insights page"===h?"insightspage":"insights theme"===h?"insightstheme":"hub initiative"===h?"hubinitiative":"hubpage"===h?"hubpage":"hub event"===h?"hubevent":"hub site application"===h?"hubsite":"hub project"===h?"hubproject":"relational database connection"===h?"relationaldatabaseconnection":"big data file share"===
h?"datastorecollection":"image collection"===h?"imagecollection":"style"===h?"style":"desktop style"===h?"desktopstyle":"dashboard"===h?"dashboard":"raster function template"===h?"rasterprocessingtemplate":"vector tile package"===h?"vectortilepackage":"ortho mapping project"===h?"orthomappingproject":"ortho mapping template"===h?"orthomappingtemplate":"solution"===h?"solutions":"geopackage"===h?"geopackage":"deep learning package"===h?"deeplearningpackage":"real time analytic"===h?"realtimeanalytics":
"big data analytic"===h?"bigdataanalytics":"feed"===h?"feed":"excalibur imagery project"===h?"excaliburimageryproject":"notebook"===h?"notebook":"storymap"===h?"storymap":"survey123 add in"===h?"survey123addin":"mission"===h?"mission":"mission report"===h?"missionreport":"mission template"===h?"missiontemplate":"quickcapture project"===h?"quickcaptureproject":"pro report"===h?"proreport":"pro report template"===h?"proreporttemplate":"urban model"===h?"urbanmodel":"web experience"===h?"experiencebuilder":
"web experience template"===h?"webexperiencetemplate":"experience builder widget"===h?"experiencebuilderwidget":"experience builder widget package"===h?"experiencebuilderwidgetpackage":"workflow"===h?"workflow":"insights script"===h?"insightsscript":"kernel gateway connection"===h?"kernelgatewayconnection":"hub initiative template"===h?"hubinitiativetemplate":"storymap theme"===h?"storymaptheme":"knowledge graph"===h?"knowledgegraph":"knowledge studio project"===h?"knowledgestudio":"native application"===
h?"nativeapp":"native application installer"===h?"nativeappinstaller":"link chart"===h?"linkchart":"investigation"===h?"investigation":"ogcfeatureserver"===h?"features":"pro project"===h?"proproject":"insights workbook package"===h?"insightsworkbookpackage":"apache parquet"===h?"apacheparquet":"notebook code snippets"===h||"notebook code snippet library"===h?"notebookcodesnippets":"suitability model"===h?"suitabilitymodel":"esri classifier definition"===h?"classifierdefinition":"esri classification schema"===
h?"classificationschema":"insights data engineering workbook"===h?"dataengineeringworkbook":"insights data engineering model"===h?"dataengineeringmodel":"deep learning studio project"===h?"deeplearningproject":"discussion"===h?"discussion":"allsource project"===h?"allsourceproject":"api key"===h?"apikey":"data pipeline"===h?"datapipelines":"group layer"===h?(S=H.includes("Map"))?"layergroup2d":"layergroup":"media layer"===h?"onlinemedialayer":"form"===h?H.includes("Survey123")?"survey":"datafilesgray":
"maps";return h?w.getAssetUrl("esri/images/portal/"+h+"16.png"):null}get isLayer(){return null!=this.type&&F.has(this.type)}get itemCdnUrl(){let h=this.itemUrl;h&&v.id&&!v.id.findCredential(h)&&(h=v.id._normalizeAGOLorgDomain(h),h=h.replace(/^https?:\/\/www\.arcgis\.com/,"https://cdn.arcgis.com"),h=h.replace(/^https?:\/\/devext\.arcgis\.com/,"https://cdndev.arcgis.com"),h=h.replace(/^https?:\/\/qaext\.arcgis\.com/,"https://cdnqa.arcgis.com"));return h}get itemPageUrl(){const h=this.portal?.itemPageUrl;
return h&&this.id?`${h}?id=${this.id}`:null}get itemUrl(){const h=this.portal?.restUrl;return h&&this.id?`${h}/content/items/${this.id}`:null}get thumbnailUrl(){const h=this.itemUrl,H=this.thumbnail;return h&&H?this.portal?.normalizeUrl(`${h}/info/${H}?f=json`)??null:null}get userItemUrl(){const h=this.portal?.restUrl;if(!h)return null;const H=this.owner||this.portal?.user?.username;return H?`${h}/content/users/${this.ownerFolder?`${H}/${this.ownerFolder}`:H}/items/${this.id}`:null}load(h){const H=
this.portal??(this.portal=f.getDefault()),S=H.load(h).then(()=>this.sourceJSON?this.sourceJSON:this.id&&this.itemUrl?H.request(this.itemUrl,{signal:null!=h?h.signal:null,query:{token:this.apiKey}}):{}).then(C=>{this.sourceJSON=C;this.read(C)});this.addResolvingPromise(S);return Promise.resolve(this)}async addRating(h){const H={method:"post",query:{}};h instanceof q&&(h=h.rating);null==h||isNaN(h)||"number"!==typeof h||(H.query.rating=h);if(!this.portal)return null;await this.portal.request(this.itemUrl+
"/addRating",H);return new q({rating:h,created:new Date})}clone(){var h={access:this.access,accessInformation:this.accessInformation,applicationProxies:g.clone(this.applicationProxies),avgRating:this.avgRating,categories:g.clone(this.categories),created:g.clone(this.created),culture:this.culture,description:this.description,extent:g.clone(this.extent),groupCategories:g.clone(this.groupCategories),id:this.id,itemControl:this.itemControl,licenseInfo:this.licenseInfo,modified:g.clone(this.modified),
name:this.name,numComments:this.numComments,numRatings:this.numRatings,numViews:this.numViews,owner:this.owner,ownerFolder:this.ownerFolder,portal:this.portal,screenshots:g.clone(this.screenshots),size:this.size,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:g.clone(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:g.clone(this.typeKeywords),url:this.url};this.loaded&&(h.loadStatus="loaded");h=(new A({sourceJSON:this.sourceJSON})).set(h);
h._set("isOrgItem",this.isOrgItem);return h}createPostQuery(){const h=this.toJSON();for(var H of["tags","typeKeywords","categories"])h[H]=h[H]?.join(", ");({extent:H}=h);H&&(h.extent=JSON.stringify(H));return h}async deleteRating(){await this.portal.request(this.itemUrl+"/deleteRating",{method:"post"})}fetchData(h="json",H){return this.portal.request(this.itemUrl+"/data",{responseType:h,...H,query:{token:this.apiKey}})}async fetchRating(h){h=await this.portal.request(this.itemUrl+"/rating",{query:{token:this.apiKey},
...h});return null!=h.rating?(h.created=new Date(h.created),new q(h)):null}fetchRelatedItems(h,H){return this.portal.requestToTypedArray(this.itemUrl+"/relatedItems",{query:{...h,token:this.apiKey},...H},A)}getThumbnailUrl(h){let H=this.thumbnailUrl;H&&h&&(H+=`&w=${h}`);return H}reload(){return this.portal.request(this.itemUrl??"",{cacheBust:!0,query:{token:this.apiKey}}).then(h=>{this.sourceJSON=h;this.read(h);return this})}update(h){return this.id?this.load().then(()=>this.portal.signIn()).then(()=>
{const H=h?.data,S={method:"post"};S.query=this.createPostQuery();for(const C in S.query)null===S.query[C]&&(S.query[C]="");S.query.clearEmptyFields=!0;null!=H&&("string"===typeof H?S.query.text=H:"object"===typeof H&&(S.query.text=JSON.stringify(H)));return this.portal.request(`${this.userItemUrl}/update`,S).then(()=>this.reload())}):Promise.reject(new I("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async copy(h){if(!this.id)throw new I("portal:item-does-not-exist",
"The item does not exist yet");await this.load();const {portal:H,itemUrl:S}=this;await H.signIn();const {copyResources:C,folder:k,tags:y,title:N}=h||{};h={method:"post",query:{copyPrivateResources:"all"===C,folder:"string"===typeof k?k:k?.id,includeResources:!!C,tags:y?.join(","),title:N}};({itemId:h}=await H.request(`${S}/copy`,h));return new A({id:h,portal:H})}updateThumbnail(h){return this.id?this.load().then(()=>this.portal.signIn()).then(()=>{const H=h.thumbnail,S=h.filename,C={method:"post"};
if("string"===typeof H)d.isDataProtocol(H)?C.query={data:H}:C.query={url:d.makeAbsolute(H)},null!=S&&(C.query.filename=S);else{const k=new FormData;null!=S?k.append("file",H,S):k.append("file",H);C.body=k}return this.portal.request(`${this.userItemUrl}/updateThumbnail`,C).then(()=>this.reload())}):Promise.reject(new I("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async fetchResources(h={},H){const {fetchResources:S}=await new Promise((C,k)=>a(["./support/resourceUtils"],
C,k));return S(this,h,H)}async addResource(h,H,S){const {addOrUpdateResource:C}=await new Promise((k,y)=>a(["./support/resourceUtils"],k,y));h.portalItem=this;return C(h,"add",H,S)}async removeResource(h,H){const {removeResource:S}=await new Promise((C,k)=>a(["./support/resourceUtils"],C,k));if(h.portalItem&&h.portalItem.itemUrl!==this.itemUrl)throw new I("removeresource:portal-item-mismatch","The portal item associated with the provided resource does not match the item");return S(this,h,H)}async removeAllResources(h){const {removeAllResources:H}=
await new Promise((S,C)=>a(["./support/resourceUtils"],S,C));return H(this,h)}resourceFromPath(h){return new b({portalItem:this,path:h})}toJSON(){var h=this.extent;h={accessInformation:this.accessInformation,categories:g.clone(this.categories),created:this.created?.getTime(),description:this.description,extent:h&&[[h.xmin,h.ymin],[h.xmax,h.ymax]],id:this.id,isOrgItem:this.isOrgItem,licenseInfo:this.licenseInfo,modified:this.modified?.getTime(),name:this.name,owner:this.owner,ownerFolder:this.ownerFolder,
snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:g.clone(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:g.clone(this.typeKeywords),url:this.url};return g.fixJson(h)}static fromJSON(h){if(!h)return null;if(h.declaredClass)throw Error("JSON object is already hydrated");return new A({sourceJSON:h})}_getPostQuery(){const h=this.toJSON();for(const H in h)"tags"===H&&null!==h[H]&&(h[H]=h[H].join(", ")),"typeKeywords"===H&&null!==
h[H]&&(h[H]=h[H].join(", ")),"extent"===H&&h[H]&&(h[H]=JSON.stringify(h[H]));return h}};c.__decorate([m.property({type:["private","shared","org","public"]})],n.prototype,"access",void 0);c.__decorate([m.property()],n.prototype,"accessInformation",void 0);c.__decorate([m.property({type:String})],n.prototype,"apiKey",void 0);c.__decorate([m.property({json:{read:{source:"appProxies"}}})],n.prototype,"applicationProxies",void 0);c.__decorate([m.property()],n.prototype,"avgRating",void 0);c.__decorate([m.property()],
n.prototype,"categories",void 0);c.__decorate([m.property({type:Date})],n.prototype,"created",void 0);c.__decorate([m.property()],n.prototype,"culture",void 0);c.__decorate([m.property()],n.prototype,"description",void 0);c.__decorate([m.property({readOnly:!0})],n.prototype,"displayName",null);c.__decorate([m.property({type:p})],n.prototype,"extent",void 0);c.__decorate([B.reader("extent")],n.prototype,"readExtent",null);c.__decorate([m.property()],n.prototype,"groupCategories",void 0);c.__decorate([m.property({readOnly:!0})],
n.prototype,"iconUrl",null);c.__decorate([m.property()],n.prototype,"id",void 0);c.__decorate([m.property({readOnly:!0})],n.prototype,"isLayer",null);c.__decorate([m.property({type:Boolean,readOnly:!0})],n.prototype,"isOrgItem",void 0);c.__decorate([m.property()],n.prototype,"itemControl",void 0);c.__decorate([m.property({readOnly:!0})],n.prototype,"itemPageUrl",null);c.__decorate([m.property({readOnly:!0})],n.prototype,"itemUrl",null);c.__decorate([m.property()],n.prototype,"licenseInfo",void 0);
c.__decorate([m.property({type:Date})],n.prototype,"modified",void 0);c.__decorate([m.property()],n.prototype,"name",void 0);c.__decorate([m.property()],n.prototype,"numComments",void 0);c.__decorate([m.property()],n.prototype,"numRatings",void 0);c.__decorate([m.property()],n.prototype,"numViews",void 0);c.__decorate([m.property()],n.prototype,"owner",void 0);c.__decorate([m.property()],n.prototype,"ownerFolder",void 0);c.__decorate([m.property({type:f})],n.prototype,"portal",void 0);c.__decorate([m.property()],
n.prototype,"screenshots",void 0);c.__decorate([m.property()],n.prototype,"size",void 0);c.__decorate([m.property()],n.prototype,"snippet",void 0);c.__decorate([m.property()],n.prototype,"sourceJSON",void 0);c.__decorate([m.property({type:String})],n.prototype,"sourceUrl",void 0);c.__decorate([m.property({type:String})],n.prototype,"spatialReference",void 0);c.__decorate([m.property()],n.prototype,"tags",void 0);c.__decorate([m.property()],n.prototype,"thumbnail",void 0);c.__decorate([m.property({readOnly:!0})],
n.prototype,"thumbnailUrl",null);c.__decorate([m.property()],n.prototype,"title",void 0);c.__decorate([m.property()],n.prototype,"type",void 0);c.__decorate([m.property()],n.prototype,"typeKeywords",void 0);c.__decorate([m.property({type:String,json:{read(h,H){L.has(H.type)&&(H=this.portal?.restUrl,h||(h=H&&this.id?`${H}/content/items/${this.id}/data`:null));return h}}})],n.prototype,"url",void 0);c.__decorate([m.property({readOnly:!0})],n.prototype,"userItemUrl",null);return n=A=c.__decorate([E.subclass("esri.portal.PortalItem")],
n)})},"esri/portal/PortalItemResource":function(){define("require ../chunks/tslib.es6 ../core/Accessor ../core/Error ../core/Logger ../core/urlUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass".split(" "),function(a,c,w,v,I,n,g,z,d,m,x){w=class extends w{constructor(B){super(B);this.portalItem=null}normalizeCtorArgs(B){return B?.portalItem&&B.path?{...B,path:this._normalizePath(B.path,
B.portalItem)}:B}set path(B){null!=B&&n.isAbsolute(B)?I.getLogger(this).error("portalitemresource:invalid-path","A portal item resource path must be relative"):this._set("path",B)}_castPath(B){return this._normalizePath(B,this.portalItem)}get url(){return this.portalItem&&this.path?`${this.portalItem.itemUrl}/resources/${this.path}`:null}get cdnUrl(){return this.portalItem&&this.path?`${this.portalItem.itemCdnUrl}/resources/${this.path}`:null}get itemRelativeUrl(){return this.portalItem&&this.path?
`./resources/${this.path}`:null}fetch(B="json",E){const p=this.cdnUrl;if(null==p)throw new v("portal-item-resource:fetch","Portal item resource does not refer to a valid item or path");return this.portalItem.portal.request(p,{responseType:B,query:{token:this.portalItem.apiKey},signal:E?.signal})}async update(B,E){const {addOrUpdateResource:p}=await new Promise((f,b)=>a(["./support/resourceUtils"],f,b));return p(this,"update",B,E)}hasPath(){return null!=this.path}_normalizePath(B,E){if(null==B)return B;
B=B.replace(/^\/+/,"");null!=E&&n.isAbsolute(B)&&(B=n.makeRelative(B,E.itemUrl));return B?.replace(/^\/+/,"").replace(/^(\.\/)?resources\//,"")}};c.__decorate([g.property()],w.prototype,"portalItem",void 0);c.__decorate([g.property({type:String,value:null})],w.prototype,"path",null);c.__decorate([z.cast("path")],w.prototype,"_castPath",null);c.__decorate([g.property({type:String,readOnly:!0})],w.prototype,"url",null);c.__decorate([g.property({type:String,readOnly:!0})],w.prototype,"cdnUrl",null);
c.__decorate([g.property({type:String,readOnly:!0})],w.prototype,"itemRelativeUrl",null);return w=c.__decorate([x.subclass("esri.portal.PortalItemResource")],w)})},"esri/portal/PortalRating":function(){define("../chunks/tslib.es6 ../core/Accessor ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass".split(" "),function(a,c,w,v,I,n,g){c=class extends c{constructor(z){super(z);this.rating=this.created=
null}};a.__decorate([w.property()],c.prototype,"created",void 0);a.__decorate([w.property()],c.prototype,"rating",void 0);return c=a.__decorate([g.subclass("esri.portal.PortalRating")],c)})},"esri/support/basemapDefinitions":function(){define(["exports","../assets","../intl/messages"],function(a,c,w){a.esriBasemapDefinitions={satellite:{id:"satellite",classic:!0,get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/satellite.jpg")},baseMapLayers:[{id:"satellite-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",
layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1}]},hybrid:{id:"hybrid",classic:!0,get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/hybrid.jpg")},baseMapLayers:[{id:"hybrid-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1},{id:"hybrid-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/30d6b8271e1849cd9c3042060001f425/resources/styles/root.json",
layerType:"VectorTileLayer",title:"Hybrid Reference Layer",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},terrain:{id:"terrain",classic:!0,get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/terrain.jpg")},baseMapLayers:[{id:"terrain-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Terrain Base",showLegend:!1,visibility:!0,opacity:1},{id:"terrain-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer",
layerType:"ArcGISTiledMapServiceLayer",title:"World Reference Overlay",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},oceans:{id:"oceans",classic:!0,get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/oceans.jpg")},baseMapLayers:[{id:"oceans-base-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Base",showLegend:!1,visibility:!0,opacity:1},{id:"oceans-reference-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer",
layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},osm:{id:"osm",classic:!0,get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/osm.jpg")},baseMapLayers:[{id:"osm-base-layer",layerType:"OpenStreetMap",title:"Open Street Map",showLegend:!1,visibility:!0,opacity:1}]},"dark-gray-vector":{id:"dark-gray-vector",classic:!0,get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/dark-gray-vector.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",
styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/5e9b3685f4c24d8781073dd928ebda50/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Base",visibility:!0,opacity:1},{id:"dark-gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/747cb7a5329c478cbe6981076cc879c5/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get "dark-gray"(){return{...this["dark-gray-vector"],
id:"dark-gray"}},"gray-vector":{id:"gray-vector",classic:!0,get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/gray-vector.jpg")},baseMapLayers:[{id:"gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/291da5eab3a0412593b66d384379f89f/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Base",visibility:!0,opacity:1},{id:"gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/1768e8369a214dfab4e2167d5c5f2454/resources/styles/root.json",
layerType:"VectorTileLayer",title:"Light Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get gray(){return{...this["gray-vector"],id:"gray"}},"streets-vector":{id:"streets-vector",classic:!0,get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/streets-vector.jpg")},baseMapLayers:[{id:"streets-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/de26a3cf4cc9451298ea173c4b324736/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets",visibility:!0,
opacity:1}]},get streets(){return{...this["streets-vector"],id:"streets"}},"topo-vector":{id:"topo-vector",classic:!0,get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/topo-vector.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"topo-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/7dc6cea0b1764a1f9af2e679f642f0f5/resources/styles/root.json",
layerType:"VectorTileLayer",title:"World Topo",visibility:!0,opacity:1}]},get topo(){return{...this["topo-vector"],id:"topo"}},"streets-night-vector":{id:"streets-night-vector",classic:!0,get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/streets-night.jpg")},baseMapLayers:[{id:"streets-night-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/86f556a2d1fd468181855a35e344567f/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Night",visibility:!0,
opacity:1}]},"streets-relief-vector":{id:"streets-relief-vector",classic:!0,get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/streets-relief.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"streets-relief-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/b266e6d17fc345b498345613930fbd76/resources/styles/root.json",
title:"World Streets Relief",layerType:"VectorTileLayer",visibility:!0,opacity:1}]},"streets-navigation-vector":{id:"streets-navigation-vector",classic:!0,get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/streets-navigation.jpg")},baseMapLayers:[{id:"streets-navigation-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Navigation",visibility:!0,opacity:1}]},
"topo-3d":{id:"topo-3d",is3d:!0,get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/topo-3d.png")},baseMapLayers:[{id:"topo-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/1e7d1784d1ef4b79ba6764d0bd6c3150/resources/styles/root.json",layerType:"VectorTileLayer",title:"Topographic",visibility:!0,opacity:1},{id:"topo-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Trees_Thematic_v1/SceneServer",itemId:"f75fef56b2d944fe92ef9f7737b4f953",
layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-3d":{id:"navigation-3d",
is3d:!0,get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/navigation-3d.jpg")},baseMapLayers:[{id:"navigation-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/ccc904ff872b4144b94934e55e32784b/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation",visibility:!0,opacity:1},{id:"navigation-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",
layerType:"ArcGISSceneServiceLayer"},{id:"navigation-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-dark-3d":{id:"navigation-dark-3d",itemId:"5a1365328b4943f09a54cf5fd1205707",is3d:!0,baseMapLayers:[{id:"navigation-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/451a1777ab3f4bf095fae24a117439d9/resources/styles/root.json",
layerType:"VectorTileLayer",title:"Navigation Dark"},{id:"navigation-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",
layerType:"ArcGISSceneServiceLayer"}]},"arcgis-imagery":{get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/hybrid.jpg")},title:"Imagery Hybrid",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},
"arcgis-imagery-standard":{get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/satellite.jpg")},title:"Imagery",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"}]},"arcgis-imagery-labels":{title:"Hybrid [Reference]",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",
isReference:!0}]},"arcgis-light-gray":{get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/gray-vector.jpg")},title:"Light Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Base",title:"Light Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Labels",title:"Light Gray Canvas Labels",isReference:!0}]},"arcgis-dark-gray":{get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/dark-gray.jpg")},
title:"Dark Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Base",title:"Dark Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Labels",title:"Dark Gray Canvas Labels",isReference:!0}]},"arcgis-navigation":{get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/streets-navigation.jpg")},title:"Navigation",baseMapLayers:[{layerType:"VectorTileLayer",
styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Navigation",title:"World Navigation Map"}]},"arcgis-navigation-night":{title:"Navigation (Dark Mode)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:NavigationNight",title:"World Navigation Map (Dark Mode)"}]},"arcgis-streets":{get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/streets-vector.jpg")},title:"Streets",baseMapLayers:[{layerType:"VectorTileLayer",
styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Streets",title:"World Street Map"}]},"arcgis-streets-night":{get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/streets-night.jpg")},title:"Streets (Night)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsNight",title:"World Street Map (Night)"}]},"arcgis-streets-relief":{get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/streets-relief.jpg")},
title:"Streets (with Relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsRelief:Base",title:"World Street Map (with Relief)"}]},"arcgis-topographic":{get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/topo.jpg")},title:"Topographic",
baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Topographic:Base",title:"World Topographic Map"}]},"arcgis-oceans":{get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/oceans.jpg")},title:"Oceans",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",
showLegend:!1,title:"World Ocean Base",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Oceans:Labels",title:"World Ocean Reference",isReference:!0}]},"osm-standard":{title:"OpenStreetMap",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Standard",title:"OpenStreetMap"}]},"osm-standard-relief":{title:"OpenStreetMap (with relief)",
baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StandardRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-streets":{title:"OpenStreetMap (Streets)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Streets",
title:"OpenStreetMap (Streets)"}]},"osm-streets-relief":{title:"OpenStreetMap (Streets with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StreetsRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-light-gray":{title:"OpenStreetMap (Light Gray Canvas)",
baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Base",title:"OSM (Light Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Labels",title:"OSM (Light Gray Reference)",isReference:!0}]},"osm-dark-gray":{title:"OpenStreetMap (Dark Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Base",
title:"OSM (Dark Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Labels",title:"OSM (Dark Gray Reference)",isReference:!0}]},"arcgis-terrain":{title:"Terrain with Labels",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Base",
title:"World Terrain Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Detail",title:"World Terrain Reference",isReference:!0}]},"arcgis-community":{title:"Community",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Community",title:"Community"}]},"arcgis-charted-territory":{title:"Charted Territory",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,
title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ChartedTerritory:Base",title:"Charted Territory"}]},"arcgis-colored-pencil":{title:"Colored Pencil",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ColoredPencil",title:"Colored Pencil"}]},"arcgis-nova":{title:"Nova",
baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Nova",title:"Nova"}]},"arcgis-modern-antique":{title:"Modern Antique",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ModernAntique:Base",
title:"Modern Antique"}]},"arcgis-midcentury":{title:"Mid-Century",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Midcentury",title:"Mid-Century"}]},"arcgis-newspaper":{title:"Newspaper",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Newspaper",title:"Newspaper"}]},"arcgis-hillshade-light":{title:"Hillshade",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",
showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"}]},"arcgis-hillshade-dark":{title:"Hillshade (Dark)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade (Dark)",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade_Dark/MapServer"}]},"arcgis-human-geography":{title:"Human Geography",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Base",
title:"Human Geography Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Detail",title:"Human Geography Detail",isReference:!0},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Label",title:"Human Geography Label",isReference:!0}]},"arcgis-human-geography-dark":{title:"Human Geography (Dark)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Base",
title:"Human Geography Dark Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Detail",title:"Human Geography Dark Detail",isReference:!0},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Label",title:"Human Geography Dark Label",isReference:!0}]}};a.getBasemapTitle=async function(v){if(v){var I=v.includes("-vector")?v.slice(0,v.indexOf("-vector")):
v.includes("-3d")?v.slice(0,v.indexOf("-3d")):v,n=await w.fetchMessageBundle("esri/t9n/basemaps");return n[v]||n[I]}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/support/BasemapStyle":function(){define("../chunks/tslib.es6 ../core/Accessor ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ../intl/locale".split(" "),function(a,c,w,v,I,n,g,z){const d=new Set("ar bs ca hr cs da nl en et fi fr de el he hu id it ja ko lv lt nb pl ro ru sr es sv th tr uk vi".split(" "));
c=class extends c{constructor(m){super(m);this.language=this.id=null;this.serviceUrl="https://basemapstyles-api.arcgis.com/arcgis/rest/services/styles/v2/webmaps"}getLanguageParamValue(){if(this.language)return this.language;var m=z.getLocale().toLowerCase();switch(m){case "pt-br":return"pt-BR";case "pt-pt":return"pt-PT";case "zh-cn":return"zh-CN";case "zh-hk":return"zh-HK";case "zh-tw":return"zh-TW"}m=z.getLanguage(m);return"pt"===m?"pt-BR":m&&d.has(m)?m:"global"}};a.__decorate([w.property()],c.prototype,
"id",void 0);a.__decorate([w.property()],c.prototype,"language",void 0);a.__decorate([w.property()],c.prototype,"serviceUrl",void 0);return c=a.__decorate([g.subclass("esri.support.BasemapStyle")],c)})},"esri/webdoc/support/writeUtils":function(){define("exports ../../core/Error ../../core/lang ../../core/object ../../core/accessorSupport/extensions/serializableProperty/writer ../../layers/support/layerUtils".split(" "),function(a,c,w,v,I,n){function g(m,x){"maxScale"in m&&(x.maxScale=I.numberToJSON(m.maxScale)??
void 0);"minScale"in m&&(x.minScale=I.numberToJSON(m.minScale)??void 0)}const z=new Set("bing-maps imagery imagery-tile map-image open-street-map tile unknown unsupported vector-tile web-tile wms wmts".split(" ")),d=new Set("csv feature geo-rss geojson group imagery imagery-tile kml map-image map-notes media ogc-feature oriented-imagery route stream subtype-group tile unknown unsupported vector-tile web-tile wfs wms wmts".split(" "));a.disableRestrictedWriting=function(m){z.add(m);d.add(m)};a.enableRestrictedWriting=
function(m){z.delete(m);d.delete(m)};a.getLayerJSON=function(m,x,B){if(!m.persistenceEnabled)return null;if(!("write"in m&&m.write))return B?.messages&&B.messages.push(new c("layer:unsupported",`Layers (${m.title}, ${m.id}) of type '${m.declaredClass}' cannot be persisted`,{layer:m})),null;if(n.isFeatureCollectionLayer(m)&&!m.isTable)x=m.resourceInfo;else{if(B.restrictedWebMapWriting){var E="basemap"===B.layerContainerType?z:"operational-layers"===B.layerContainerType?d:null;E=null!=E?E.has(m.type)&&
!n.isFeatureCollectionLayer(m):!0}else E=!0;if(E)return x={},m.write(x,B)?x:null}if(null!=x){x=w.clone(x);if(B=x)n.isFeatureCollectionLayer(m)?(E=v.getDeepValue("featureCollection.layers",B)?.[0]?.layerDefinition)&&g(m,E):"group"!==m.type&&g(m,B);if(B&&(B.id=m.id,"blendMode"in m&&(B.blendMode=m.blendMode,"normal"===B.blendMode&&delete B.blendMode),B.opacity=I.numberToJSON(m.opacity)??void 0,B.title=m.title||"Layer",B.visibility=m.visible,"legendEnabled"in m&&"wmts"!==m.type))if(n.isFeatureCollectionLayer(m)){if(B=
B.featureCollection)B.showLegend=m.legendEnabled}else B.showLegend=m.legendEnabled}return x};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/layerUtils":function(){define(["exports","../../kernel","../../request"],function(a,c,w){function v(n){return"scene"===n?.type}function I(n){n=n?.type;return"imagery-tile"===n||"tile"===n||"open-street-map"===n||"vector-tile"===n||"web-tile"===n||"wmts"===n}a.getEffectiveEditingEnabled=function(n){a:if("editingEnabled"in n)switch(n.type){case "csv":case "feature":case "geojson":case "oriented-imagery":case "scene":case "subtype-group":case "subtype-sublayer":var g=
!0;break a;default:g=!1}else g=!1;return g?"effectiveEditingEnabled"in n?n.effectiveEditingEnabled:n.editingEnabled:!1};a.getEffectiveLayerCapabilities=function(n){a:if("capabilities"in n)switch(n.type){case "csv":case "feature":case "geojson":case "imagery":case "knowledge-graph-sublayer":case "ogc-feature":case "oriented-imagery":case "scene":case "subtype-group":case "subtype-sublayer":case "wfs":var g=!0;break a;default:g=!1}else g=!1;return g?"effectiveCapabilities"in n?n.effectiveCapabilities:
n.capabilities:null};a.getOwningPortalUrl=async function(n,g){var z=c.id?.findServerInfo(n);if(null!=z?.currentVersion)return z.owningSystemUrl||null;z=n.toLowerCase().indexOf("/rest/services");if(-1===z)return null;n=`${n.substring(0,z)}/rest/info`;({data:g}=await w(n,{query:{f:"json"},responseType:"json",signal:null!=g?g.signal:null}));return g?.owningSystemUrl||null};a.getTileMaxtrixSetFromActiveLayer=function(n){if(n.activeLayer){const g=n.activeLayer.tileMatrixSet;if(g)return g;if(n=n.activeLayer.tileMatrixSets)return n}return null};
a.isBaseLayer=function(n){return null!=n?.parent&&"declaredClass"in n.parent&&"esri.Basemap"===n.parent.declaredClass&&n.parent.baseLayers.includes(n)};a.isBasemap3DSupportedLayer=function(n){return I(n)||v(n)};a.isBasemapSupportedTiledLayer=I;a.isFeatureCollectionLayer=function(n){return"feature"===n?.type&&!n.url&&"memory"===n.source?.type};a.isFeatureLayer=function(n){return null!=n&&"object"===typeof n&&"type"in n&&"feature"===n.type};a.isFeatureServiceLayer=function(n){return"feature"===n?.type&&
"feature-layer"===n.source?.type};a.isGraphicsLayer=function(n){return null!=n&&"object"===typeof n&&"type"in n&&"graphics"===n.type};a.isGroupLayer=function(n){return null!=n&&"type"in n&&"group"===n.type};a.isImageryTileLayer=function(n){return"imagery-tile"===n?.type};a.isKnowledgeGraphLayer=function(n){return null!=n&&"object"===typeof n&&"type"in n&&"knowledge-graph"===n.type&&"layers"in n};a.isLayerWithFeatureLayerSource=function(n){return("feature"===n?.type||"subtype-group"===n?.type)&&"feature-layer"===
n.source?.type};a.isMapNotesLayer=function(n){return null!=n&&"object"===typeof n&&"type"in n&&"map-notes"===n.type&&"sublayers"in n};a.isSceneLayer=v;a.isSceneServiceLayer=function(n){n=n?.type;return"building-scene"===n||"integrated-mesh"===n||"point-cloud"===n||"scene"===n};a.isSubtypeGroupLayer=function(n){return null!=n&&"object"===typeof n&&"type"in n&&"subtype-group"===n.type&&"sublayers"in n};a.isTable=function(n){return null!=n&&"object"===typeof n&&"isTable"in n&&!!n.isTable};a.isTiledLayer=
function(n){n=n?.type;return"base-tile"===n||"tile"===n||"elevation"===n||"imagery-tile"===n||"base-elevation"===n||"open-street-map"===n||"wcs"===n||"web-tile"===n||"wmts"===n||"vector-tile"===n};a.isVoxelLayer=function(n){return"voxel"===n?.type};a.sceneServiceLayerTypeToClassName={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};a.serializeLayerDefinitions=function(n){const g=/[:;]/,z=[];let d=!1;if(n&&(n.forEach((m,
x)=>{z.push([x,m]);!d&&g.test(m)&&(d=!0)}),0<z.length)){if(d){const m={};z.forEach(x=>{m[x[0]]=x[1]});n=JSON.stringify(m)}else{const m=[];z.forEach(x=>{m.push(x[0]+":"+x[1])});n=m.join(";")}return n}return null};a.serializeTimeOptions=function(n){if(n){var g=[];n.forEach((z,d)=>{g.push('"'+d+'":'+JSON.stringify(z))});if(g.length)return"{"+g.join(",")+"}"}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/effects/utils":function(){define(["exports","./effects"],function(a,
c){a.canInterpolateEffects=function(w,v){const I=w.length>v.length?w:v;return(w.length>v.length?v:w).every((n,g)=>n.type===I[g].type)};a.effectEquals=function(w,v){w=JSON.stringify(w??null);v=JSON.stringify(v??null);return w===v};a.isEffectFunctions=function(w){return(w=w[0])?"type"in w:!1};a.normalizeEffects=function(w,v){const I=w.length>v.length?w:v;w=w.length>v.length?v:w;for(v=w.length;v<I.length;v++)w.push(c.createEffectWithInitialValues(I[v]))};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/layers/effects/effects":function(){define(["exports","../../colorUtils","../../core/screenUtils","../../chunks/mat4f32","./colorMatrixFunctions"],function(a,c,w,v,I){function n(p,f,b){return p+(f-p)*b}function g(p){return Math.round(1E3*w.px2pt(p))/1E3}class z{constructor(p,f,b){this.strength=p;this.radius=f;this.threshold=b;this.type="bloom"}interpolate(p,f,b){this.strength=n(p.strength,f.strength,b);this.radius=n(p.radius,f.radius,b);this.threshold=n(p.threshold,f.threshold,b)}clone(){return new z(this.strength,
this.radius,this.threshold)}toJSON(){return{type:"bloom",radius:g(this.radius),strength:this.strength,threshold:this.threshold}}}class d{constructor(p){this.radius=p;this.type="blur"}interpolate(p,f,b){this.radius=Math.round(n(p.radius,f.radius,b))}clone(){return new d(this.radius)}toJSON(){return{type:"blur",radius:g(this.radius)}}}class m{constructor(p,f){this.type=p;this.amount=f;if("invert"===this.type||"grayscale"===this.type||"sepia"===this.type)this.amount=Math.min(this.amount,1)}get colorMatrix(){this._colorMatrix||
this._updateMatrix();return this._colorMatrix}interpolate(p,f,b){this.amount=n(p.amount,f.amount,b);this._updateMatrix()}clone(){return new m(this.type,this.amount)}toJSON(){return{type:this.type,amount:this.amount}}_updateMatrix(){const p=this._colorMatrix||v.create();switch(this.type){case "brightness":this._colorMatrix=I.brightness(p,this.amount);break;case "contrast":this._colorMatrix=I.contrast(p,this.amount);break;case "grayscale":this._colorMatrix=I.grayscale(p,this.amount);break;case "invert":this._colorMatrix=
I.invert(p,this.amount);break;case "saturate":this._colorMatrix=I.saturate(p,this.amount);break;case "sepia":this._colorMatrix=I.sepia(p,this.amount)}}}class x{constructor(p,f,b,q){this.offsetX=p;this.offsetY=f;this.blurRadius=b;this.color=q;this.type="drop-shadow"}interpolate(p,f,b){this.offsetX=n(p.offsetX,f.offsetX,b);this.offsetY=n(p.offsetY,f.offsetY,b);this.blurRadius=n(p.blurRadius,f.blurRadius,b);this.color[0]=Math.round(n(p.color[0],f.color[0],b));this.color[1]=Math.round(n(p.color[1],f.color[1],
b));this.color[2]=Math.round(n(p.color[2],f.color[2],b));this.color[3]=n(p.color[3],f.color[3],b)}clone(){return new x(this.offsetX,this.offsetY,this.blurRadius,[...this.color])}toJSON(){const p=[...this.color];p[3]*=255;return{type:"drop-shadow",xoffset:g(this.offsetX),yoffset:g(this.offsetY),blurRadius:g(this.blurRadius),color:p}}}class B{constructor(p){this.angle=p;this.type="hue-rotate"}get colorMatrix(){this._colorMatrix||this._updateMatrix();return this._colorMatrix}interpolate(p,f,b){this.angle=
n(p.angle,f.angle,b);this._updateMatrix()}clone(){return new B(this.angle)}toJSON(){return{type:"hue-rotate",angle:this.angle}}_updateMatrix(){const p=this._colorMatrix||v.create();this._colorMatrix=I.rotateHue(p,this.angle)}}class E{constructor(p){this.amount=p;this.type="opacity";this.amount=Math.min(this.amount,1)}interpolate(p,f,b){this.amount=n(p.amount,f.amount,b)}clone(){return new E(this.amount)}toJSON(){return{type:"opacity",amount:this.amount}}}a.BloomEffect=z;a.BlurEffect=d;a.ColorMatrixEffect=
m;a.DropShadowEffect=x;a.HueRotateEffect=B;a.OpacityEffect=E;a.createEffectWithInitialValues=function(p){switch(p.type){case "grayscale":case "sepia":case "invert":return new m(p.type,0);case "saturate":case "brightness":case "contrast":return new m(p.type,1);case "opacity":return new E(1);case "hue-rotate":return new B(0);case "blur":return new d(0);case "drop-shadow":return new x(0,0,0,[...c.getNamedColor("transparent")]);case "bloom":return new z(0,0,1)}};Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/chunks/mat4f32":function(){define(["exports"],function(a){function c(){const z=new Float32Array(16);z[0]=1;z[5]=1;z[10]=1;z[15]=1;return z}function w(z){const d=new Float32Array(16);d[0]=z[0];d[1]=z[1];d[2]=z[2];d[3]=z[3];d[4]=z[4];d[5]=z[5];d[6]=z[6];d[7]=z[7];d[8]=z[8];d[9]=z[9];d[10]=z[10];d[11]=z[11];d[12]=z[12];d[13]=z[13];d[14]=z[14];d[15]=z[15];return d}function v(z,d,m,x,B,E,p,f,b,q,A,F,L,h,H,S){const C=new Float32Array(16);C[0]=z;C[1]=d;C[2]=m;C[3]=x;C[4]=B;C[5]=
E;C[6]=p;C[7]=f;C[8]=b;C[9]=q;C[10]=A;C[11]=F;C[12]=L;C[13]=h;C[14]=H;C[15]=S;return C}function I(z,d){return new Float32Array(z,d,16)}const n=c(),g=Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:n,clone:w,create:c,createView:I,fromValues:v},Symbol.toStringTag,{value:"Module"}));a.IDENTITY=n;a.clone=w;a.create=c;a.createView=I;a.fromValues=v;a.mat4f32=g})},"esri/layers/effects/colorMatrixFunctions":function(){define(["exports","../../chunks/mat4"],function(a,c){a.brightness=(w,v)=>{w=
c.set(w,v,0,0,0,0,v,0,0,0,0,v,0,0,0,0,1);return c.transpose(w,w)};a.contrast=(w,v)=>{w=c.set(w,v,0,0,.5-.5*v,0,v,0,.5-.5*v,0,0,v,.5-.5*v,0,0,0,1);return c.transpose(w,w)};a.grayscale=(w,v)=>{v=1-v;w=c.set(w,.2126+.7874*v,.7152-.7152*v,.0722-.0722*v,0,.2126-.2126*v,.7152+.2848*v,.0722-.0722*v,0,.2126-.2126*v,.7152-.7152*v,.0722+.9278*v,0,0,0,0,1);return c.transpose(w,w)};a.invert=(w,v)=>{const I=1-2*v;w=c.set(w,I,0,0,v,0,I,0,v,0,0,I,v,0,0,0,1);return c.transpose(w,w)};a.rotateHue=(w,v)=>{const I=Math.sin(v*
Math.PI/180);v=Math.cos(v*Math.PI/180);w=c.set(w,.213+.787*v-.213*I,.715-.715*v-.715*I,.072-.072*v+.928*I,0,.213-.213*v+.143*I,.715+.285*v+.14*I,.072-.072*v-.283*I,0,.213-.213*v-.787*I,.715-.715*v+.715*I,.072+.928*v+.072*I,0,0,0,0,1);return c.transpose(w,w)};a.saturate=(w,v)=>{w=c.set(w,.213+.787*v,.715-.715*v,.072-.072*v,0,.213-.213*v,.715+.285*v,.072-.072*v,0,.213-.213*v,.715-.715*v,.072+.928*v,0,0,0,0,1);return c.transpose(w,w)};a.sepia=(w,v)=>{v=1-v;w=c.set(w,.393+.607*v,.769-.769*v,.189-.189*
v,0,.349-.349*v,.686+.314*v,.168-.168*v,0,.272-.272*v,.534-.534*v,.131+.869*v,0,0,0,0,1);return c.transpose(w,w)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/mat4":function(){define(["exports","./vec3f64","./common"],function(a,c,w){function v(r,K){r[0]=K[0];r[1]=K[1];r[2]=K[2];r[3]=K[3];r[4]=K[4];r[5]=K[5];r[6]=K[6];r[7]=K[7];r[8]=K[8];r[9]=K[9];r[10]=K[10];r[11]=K[11];r[12]=K[12];r[13]=K[13];r[14]=K[14];r[15]=K[15];return r}function I(r,K,X,aa,ha,G,M,P,W,Y,ba,da,
ia,ka,ra,oa,qa){r[0]=K;r[1]=X;r[2]=aa;r[3]=ha;r[4]=G;r[5]=M;r[6]=P;r[7]=W;r[8]=Y;r[9]=ba;r[10]=da;r[11]=ia;r[12]=ka;r[13]=ra;r[14]=oa;r[15]=qa;return r}function n(r){r[0]=1;r[1]=0;r[2]=0;r[3]=0;r[4]=0;r[5]=1;r[6]=0;r[7]=0;r[8]=0;r[9]=0;r[10]=1;r[11]=0;r[12]=0;r[13]=0;r[14]=0;r[15]=1;return r}function g(r,K){if(r===K){const X=K[1],aa=K[2],ha=K[3],G=K[6],M=K[7],P=K[11];r[1]=K[4];r[2]=K[8];r[3]=K[12];r[4]=X;r[6]=K[9];r[7]=K[13];r[8]=aa;r[9]=G;r[11]=K[14];r[12]=ha;r[13]=M;r[14]=P}else r[0]=K[0],r[1]=
K[4],r[2]=K[8],r[3]=K[12],r[4]=K[1],r[5]=K[5],r[6]=K[9],r[7]=K[13],r[8]=K[2],r[9]=K[6],r[10]=K[10],r[11]=K[14],r[12]=K[3],r[13]=K[7],r[14]=K[11],r[15]=K[15];return r}function z(r,K){d(r,K)||n(r);return r}function d(r,K){const X=K[0],aa=K[1],ha=K[2],G=K[3],M=K[4],P=K[5],W=K[6],Y=K[7],ba=K[8],da=K[9],ia=K[10],ka=K[11],ra=K[12],oa=K[13],qa=K[14];K=K[15];const Ca=X*P-aa*M,wa=X*W-ha*M,Ba=X*Y-G*M,Aa=aa*W-ha*P,ya=aa*Y-G*P,Ha=ha*Y-G*W,Qa=ba*oa-da*ra,Ya=ba*qa-ia*ra,Wa=ba*K-ka*ra,Ja=da*qa-ia*oa,Ka=da*K-ka*
oa,ja=ia*K-ka*qa;let Ra=Ca*ja-wa*Ka+Ba*Ja+Aa*Wa-ya*Ya+Ha*Qa;if(!Ra)return null;Ra=1/Ra;r[0]=(P*ja-W*Ka+Y*Ja)*Ra;r[1]=(ha*Ka-aa*ja-G*Ja)*Ra;r[2]=(oa*Ha-qa*ya+K*Aa)*Ra;r[3]=(ia*ya-da*Ha-ka*Aa)*Ra;r[4]=(W*Wa-M*ja-Y*Ya)*Ra;r[5]=(X*ja-ha*Wa+G*Ya)*Ra;r[6]=(qa*Ba-ra*Ha-K*wa)*Ra;r[7]=(ba*Ha-ia*Ba+ka*wa)*Ra;r[8]=(M*Ka-P*Wa+Y*Qa)*Ra;r[9]=(aa*Wa-X*Ka-G*Qa)*Ra;r[10]=(ra*ya-oa*Ba+K*Ca)*Ra;r[11]=(da*Ba-ba*ya-ka*Ca)*Ra;r[12]=(P*Ya-M*Ja-W*Qa)*Ra;r[13]=(X*Ja-aa*Ya+ha*Qa)*Ra;r[14]=(oa*wa-ra*Aa-qa*Ca)*Ra;r[15]=(ba*
Aa-da*wa+ia*Ca)*Ra;return r}function m(r,K){const X=K[0],aa=K[1],ha=K[2],G=K[3],M=K[4],P=K[5],W=K[6],Y=K[7],ba=K[8],da=K[9],ia=K[10],ka=K[11],ra=K[12],oa=K[13],qa=K[14];K=K[15];r[0]=P*(ia*K-ka*qa)-da*(W*K-Y*qa)+oa*(W*ka-Y*ia);r[1]=-(aa*(ia*K-ka*qa)-da*(ha*K-G*qa)+oa*(ha*ka-G*ia));r[2]=aa*(W*K-Y*qa)-P*(ha*K-G*qa)+oa*(ha*Y-G*W);r[3]=-(aa*(W*ka-Y*ia)-P*(ha*ka-G*ia)+da*(ha*Y-G*W));r[4]=-(M*(ia*K-ka*qa)-ba*(W*K-Y*qa)+ra*(W*ka-Y*ia));r[5]=X*(ia*K-ka*qa)-ba*(ha*K-G*qa)+ra*(ha*ka-G*ia);r[6]=-(X*(W*K-Y*qa)-
M*(ha*K-G*qa)+ra*(ha*Y-G*W));r[7]=X*(W*ka-Y*ia)-M*(ha*ka-G*ia)+ba*(ha*Y-G*W);r[8]=M*(da*K-ka*oa)-ba*(P*K-Y*oa)+ra*(P*ka-Y*da);r[9]=-(X*(da*K-ka*oa)-ba*(aa*K-G*oa)+ra*(aa*ka-G*da));r[10]=X*(P*K-Y*oa)-M*(aa*K-G*oa)+ra*(aa*Y-G*P);r[11]=-(X*(P*ka-Y*da)-M*(aa*ka-G*da)+ba*(aa*Y-G*P));r[12]=-(M*(da*qa-ia*oa)-ba*(P*qa-W*oa)+ra*(P*ia-W*da));r[13]=X*(da*qa-ia*oa)-ba*(aa*qa-ha*oa)+ra*(aa*ia-ha*da);r[14]=-(X*(P*qa-W*oa)-M*(aa*qa-ha*oa)+ra*(aa*W-ha*P));r[15]=X*(P*ia-W*da)-M*(aa*ia-ha*da)+ba*(aa*W-ha*P);return r}
function x(r){const K=r[0],X=r[1],aa=r[2],ha=r[3],G=r[4],M=r[5],P=r[6],W=r[7],Y=r[8],ba=r[9],da=r[10],ia=r[11],ka=r[12],ra=r[13],oa=r[14];r=r[15];return(K*M-X*G)*(da*r-ia*oa)-(K*P-aa*G)*(ba*r-ia*ra)+(K*W-ha*G)*(ba*oa-da*ra)+(X*P-aa*M)*(Y*r-ia*ka)-(X*W-ha*M)*(Y*oa-da*ka)+(aa*W-ha*P)*(Y*ra-ba*ka)}function B(r,K,X){const aa=K[0],ha=K[1],G=K[2],M=K[3],P=K[4],W=K[5],Y=K[6],ba=K[7],da=K[8],ia=K[9],ka=K[10],ra=K[11],oa=K[12],qa=K[13],Ca=K[14];K=K[15];let wa=X[0],Ba=X[1],Aa=X[2],ya=X[3];r[0]=wa*aa+Ba*P+Aa*
da+ya*oa;r[1]=wa*ha+Ba*W+Aa*ia+ya*qa;r[2]=wa*G+Ba*Y+Aa*ka+ya*Ca;r[3]=wa*M+Ba*ba+Aa*ra+ya*K;wa=X[4];Ba=X[5];Aa=X[6];ya=X[7];r[4]=wa*aa+Ba*P+Aa*da+ya*oa;r[5]=wa*ha+Ba*W+Aa*ia+ya*qa;r[6]=wa*G+Ba*Y+Aa*ka+ya*Ca;r[7]=wa*M+Ba*ba+Aa*ra+ya*K;wa=X[8];Ba=X[9];Aa=X[10];ya=X[11];r[8]=wa*aa+Ba*P+Aa*da+ya*oa;r[9]=wa*ha+Ba*W+Aa*ia+ya*qa;r[10]=wa*G+Ba*Y+Aa*ka+ya*Ca;r[11]=wa*M+Ba*ba+Aa*ra+ya*K;wa=X[12];Ba=X[13];Aa=X[14];ya=X[15];r[12]=wa*aa+Ba*P+Aa*da+ya*oa;r[13]=wa*ha+Ba*W+Aa*ia+ya*qa;r[14]=wa*G+Ba*Y+Aa*ka+ya*Ca;
r[15]=wa*M+Ba*ba+Aa*ra+ya*K;return r}function E(r,K,X){const aa=X[0],ha=X[1];X=X[2];if(K===r)r[12]=K[0]*aa+K[4]*ha+K[8]*X+K[12],r[13]=K[1]*aa+K[5]*ha+K[9]*X+K[13],r[14]=K[2]*aa+K[6]*ha+K[10]*X+K[14],r[15]=K[3]*aa+K[7]*ha+K[11]*X+K[15];else{const G=K[0],M=K[1],P=K[2],W=K[3],Y=K[4],ba=K[5],da=K[6],ia=K[7],ka=K[8],ra=K[9],oa=K[10],qa=K[11];r[0]=G;r[1]=M;r[2]=P;r[3]=W;r[4]=Y;r[5]=ba;r[6]=da;r[7]=ia;r[8]=ka;r[9]=ra;r[10]=oa;r[11]=qa;r[12]=G*aa+Y*ha+ka*X+K[12];r[13]=M*aa+ba*ha+ra*X+K[13];r[14]=P*aa+da*
ha+oa*X+K[14];r[15]=W*aa+ia*ha+qa*X+K[15]}return r}function p(r,K,X){const aa=X[0],ha=X[1];X=X[2];r[0]=K[0]*aa;r[1]=K[1]*aa;r[2]=K[2]*aa;r[3]=K[3]*aa;r[4]=K[4]*ha;r[5]=K[5]*ha;r[6]=K[6]*ha;r[7]=K[7]*ha;r[8]=K[8]*X;r[9]=K[9]*X;r[10]=K[10]*X;r[11]=K[11]*X;r[12]=K[12];r[13]=K[13];r[14]=K[14];r[15]=K[15];return r}function f(r,K,X,aa){let ha=aa[0],G=aa[1];aa=aa[2];let M=Math.sqrt(ha*ha+G*G+aa*aa);var P=void 0,W=void 0;let Y=void 0,ba=void 0,da=void 0,ia=void 0,ka=void 0,ra=void 0,oa=void 0,qa=void 0,Ca=
void 0,wa=void 0,Ba=void 0,Aa=void 0,ya=void 0,Ha=void 0,Qa=void 0,Ya=void 0,Wa=void 0,Ja=void 0,Ka=void 0,ja=void 0;W=P=void 0;if(M<w.getEpsilon())return null;M=1/M;ha*=M;G*=M;aa*=M;P=Math.sin(X);W=Math.cos(X);Y=1-W;ba=K[0];da=K[1];ia=K[2];ka=K[3];ra=K[4];oa=K[5];qa=K[6];Ca=K[7];wa=K[8];Ba=K[9];Aa=K[10];ya=K[11];Ha=ha*ha*Y+W;Qa=G*ha*Y+aa*P;Ya=aa*ha*Y-G*P;Wa=ha*G*Y-aa*P;Ja=G*G*Y+W;Ka=aa*G*Y+ha*P;ja=ha*aa*Y+G*P;P=G*aa*Y-ha*P;W=aa*aa*Y+W;r[0]=ba*Ha+ra*Qa+wa*Ya;r[1]=da*Ha+oa*Qa+Ba*Ya;r[2]=ia*Ha+qa*Qa+
Aa*Ya;r[3]=ka*Ha+Ca*Qa+ya*Ya;r[4]=ba*Wa+ra*Ja+wa*Ka;r[5]=da*Wa+oa*Ja+Ba*Ka;r[6]=ia*Wa+qa*Ja+Aa*Ka;r[7]=ka*Wa+Ca*Ja+ya*Ka;r[8]=ba*ja+ra*P+wa*W;r[9]=da*ja+oa*P+Ba*W;r[10]=ia*ja+qa*P+Aa*W;r[11]=ka*ja+Ca*P+ya*W;K!==r&&(r[12]=K[12],r[13]=K[13],r[14]=K[14],r[15]=K[15]);return r}function b(r,K,X){const aa=Math.sin(X);X=Math.cos(X);const ha=K[4],G=K[5],M=K[6],P=K[7],W=K[8],Y=K[9],ba=K[10],da=K[11];K!==r&&(r[0]=K[0],r[1]=K[1],r[2]=K[2],r[3]=K[3],r[12]=K[12],r[13]=K[13],r[14]=K[14],r[15]=K[15]);r[4]=ha*X+W*
aa;r[5]=G*X+Y*aa;r[6]=M*X+ba*aa;r[7]=P*X+da*aa;r[8]=W*X-ha*aa;r[9]=Y*X-G*aa;r[10]=ba*X-M*aa;r[11]=da*X-P*aa;return r}function q(r,K,X){const aa=Math.sin(X);X=Math.cos(X);const ha=K[0],G=K[1],M=K[2],P=K[3],W=K[8],Y=K[9],ba=K[10],da=K[11];K!==r&&(r[4]=K[4],r[5]=K[5],r[6]=K[6],r[7]=K[7],r[12]=K[12],r[13]=K[13],r[14]=K[14],r[15]=K[15]);r[0]=ha*X-W*aa;r[1]=G*X-Y*aa;r[2]=M*X-ba*aa;r[3]=P*X-da*aa;r[8]=ha*aa+W*X;r[9]=G*aa+Y*X;r[10]=M*aa+ba*X;r[11]=P*aa+da*X;return r}function A(r,K,X){const aa=Math.sin(X);
X=Math.cos(X);const ha=K[0],G=K[1],M=K[2],P=K[3],W=K[4],Y=K[5],ba=K[6],da=K[7];K!==r&&(r[8]=K[8],r[9]=K[9],r[10]=K[10],r[11]=K[11],r[12]=K[12],r[13]=K[13],r[14]=K[14],r[15]=K[15]);r[0]=ha*X+W*aa;r[1]=G*X+Y*aa;r[2]=M*X+ba*aa;r[3]=P*X+da*aa;r[4]=W*X-ha*aa;r[5]=Y*X-G*aa;r[6]=ba*X-M*aa;r[7]=da*X-P*aa;return r}function F(r,K){r[0]=1;r[1]=0;r[2]=0;r[3]=0;r[4]=0;r[5]=1;r[6]=0;r[7]=0;r[8]=0;r[9]=0;r[10]=1;r[11]=0;r[12]=K[0];r[13]=K[1];r[14]=K[2];r[15]=1;return r}function L(r,K){r[0]=K[0];r[1]=0;r[2]=0;r[3]=
0;r[4]=0;r[5]=K[1];r[6]=0;r[7]=0;r[8]=0;r[9]=0;r[10]=K[2];r[11]=0;r[12]=0;r[13]=0;r[14]=0;r[15]=1;return r}function h(r,K,X){if(0===K)return n(r);let aa=X[0],ha=X[1];X=X[2];let G=Math.sqrt(aa*aa+ha*ha+X*X),M=void 0,P=void 0,W=void 0;if(G<w.getEpsilon())return null;G=1/G;aa*=G;ha*=G;X*=G;M=Math.sin(K);P=Math.cos(K);W=1-P;r[0]=aa*aa*W+P;r[1]=ha*aa*W+X*M;r[2]=X*aa*W-ha*M;r[3]=0;r[4]=aa*ha*W-X*M;r[5]=ha*ha*W+P;r[6]=X*ha*W+aa*M;r[7]=0;r[8]=aa*X*W+ha*M;r[9]=ha*X*W-aa*M;r[10]=X*X*W+P;r[11]=0;r[12]=0;r[13]=
0;r[14]=0;r[15]=1;return r}function H(r,K){const X=Math.sin(K);K=Math.cos(K);r[0]=1;r[1]=0;r[2]=0;r[3]=0;r[4]=0;r[5]=K;r[6]=X;r[7]=0;r[8]=0;r[9]=-X;r[10]=K;r[11]=0;r[12]=0;r[13]=0;r[14]=0;r[15]=1;return r}function S(r,K){const X=Math.sin(K);K=Math.cos(K);r[0]=K;r[1]=0;r[2]=-X;r[3]=0;r[4]=0;r[5]=1;r[6]=0;r[7]=0;r[8]=X;r[9]=0;r[10]=K;r[11]=0;r[12]=0;r[13]=0;r[14]=0;r[15]=1;return r}function C(r,K){const X=Math.sin(K);K=Math.cos(K);r[0]=K;r[1]=X;r[2]=0;r[3]=0;r[4]=-X;r[5]=K;r[6]=0;r[7]=0;r[8]=0;r[9]=
0;r[10]=1;r[11]=0;r[12]=0;r[13]=0;r[14]=0;r[15]=1;return r}function k(r,K,X){var aa=K[0],ha=K[1],G=K[2],M=K[3],P=aa+aa,W=ha+ha;const Y=G+G;K=aa*P;const ba=aa*W;aa*=Y;const da=ha*W;ha*=Y;G*=Y;P*=M;W*=M;M*=Y;r[0]=1-(da+G);r[1]=ba+M;r[2]=aa-W;r[3]=0;r[4]=ba-M;r[5]=1-(K+G);r[6]=ha+P;r[7]=0;r[8]=aa+W;r[9]=ha-P;r[10]=1-(K+da);r[11]=0;r[12]=X[0];r[13]=X[1];r[14]=X[2];r[15]=1;return r}function y(r,K){const X=Va,aa=-K[0],ha=-K[1],G=-K[2],M=K[3],P=K[4],W=K[5],Y=K[6],ba=K[7],da=aa*aa+ha*ha+G*G+M*M;0<da?(X[0]=
2*(P*M+ba*aa+W*G-Y*ha)/da,X[1]=2*(W*M+ba*ha+Y*aa-P*G)/da,X[2]=2*(Y*M+ba*G+P*ha-W*aa)/da):(X[0]=2*(P*M+ba*aa+W*G-Y*ha),X[1]=2*(W*M+ba*ha+Y*aa-P*G),X[2]=2*(Y*M+ba*G+P*ha-W*aa));k(r,K,X);return r}function N(r,K){r[0]=K[12];r[1]=K[13];r[2]=K[14];return r}function l(r,K){const X=K[0],aa=K[1],ha=K[2],G=K[4],M=K[5],P=K[6],W=K[8],Y=K[9];K=K[10];r[0]=Math.sqrt(X*X+aa*aa+ha*ha);r[1]=Math.sqrt(G*G+M*M+P*P);r[2]=Math.sqrt(W*W+Y*Y+K*K);return r}function O(r,K){const X=K[0]+K[5]+K[10];let aa=0;0<X?(aa=2*Math.sqrt(X+
1),r[3]=.25*aa,r[0]=(K[6]-K[9])/aa,r[1]=(K[8]-K[2])/aa,r[2]=(K[1]-K[4])/aa):K[0]>K[5]&&K[0]>K[10]?(aa=2*Math.sqrt(1+K[0]-K[5]-K[10]),r[3]=(K[6]-K[9])/aa,r[0]=.25*aa,r[1]=(K[1]+K[4])/aa,r[2]=(K[8]+K[2])/aa):K[5]>K[10]?(aa=2*Math.sqrt(1+K[5]-K[0]-K[10]),r[3]=(K[8]-K[2])/aa,r[0]=(K[1]+K[4])/aa,r[1]=.25*aa,r[2]=(K[6]+K[9])/aa):(aa=2*Math.sqrt(1+K[10]-K[0]-K[5]),r[3]=(K[1]-K[4])/aa,r[0]=(K[8]+K[2])/aa,r[1]=(K[6]+K[9])/aa,r[2]=.25*aa);return r}function u(r,K,X,aa){var ha=K[0],G=K[1],M=K[2],P=K[3],W=ha+
ha,Y=G+G,ba=M+M;K=ha*W;const da=ha*Y;ha*=ba;const ia=G*Y;G*=ba;M*=ba;W*=P;Y*=P;P*=ba;ba=aa[0];const ka=aa[1];aa=aa[2];r[0]=(1-(ia+M))*ba;r[1]=(da+P)*ba;r[2]=(ha-Y)*ba;r[3]=0;r[4]=(da-P)*ka;r[5]=(1-(K+M))*ka;r[6]=(G+W)*ka;r[7]=0;r[8]=(ha+Y)*aa;r[9]=(G-W)*aa;r[10]=(1-(K+ia))*aa;r[11]=0;r[12]=X[0];r[13]=X[1];r[14]=X[2];r[15]=1;return r}function D(r,K,X,aa,ha){var G=K[0],M=K[1],P=K[2],W=K[3],Y=G+G,ba=M+M,da=P+P;K=G*Y;var ia=G*ba,ka=G*da;G=M*ba;M*=da;var ra=P*da;P=W*Y;ba*=W;const oa=W*da;var qa=aa[0],
Ca=aa[1];da=aa[2];aa=ha[0];W=ha[1];ha=ha[2];Y=(1-(G+ra))*qa;const wa=(ia+oa)*qa;qa*=ka-ba;ia=(ia-oa)*Ca;ra=(1-(K+ra))*Ca;Ca*=M+P;ka=(ka+ba)*da;M=(M-P)*da;K=(1-(K+G))*da;r[0]=Y;r[1]=wa;r[2]=qa;r[3]=0;r[4]=ia;r[5]=ra;r[6]=Ca;r[7]=0;r[8]=ka;r[9]=M;r[10]=K;r[11]=0;r[12]=X[0]+aa-(Y*aa+ia*W+ka*ha);r[13]=X[1]+W-(wa*aa+ra*W+M*ha);r[14]=X[2]+ha-(qa*aa+Ca*W+K*ha);r[15]=1;return r}function R(r,K){var X=K[0],aa=K[1],ha=K[2];K=K[3];var G=X+X,M=aa+aa;const P=ha+ha;X*=G;const W=aa*G;aa*=M;const Y=ha*G,ba=ha*M;ha*=
P;G*=K;M*=K;K*=P;r[0]=1-aa-ha;r[1]=W+K;r[2]=Y-M;r[3]=0;r[4]=W-K;r[5]=1-X-ha;r[6]=ba+G;r[7]=0;r[8]=Y+M;r[9]=ba-G;r[10]=1-X-aa;r[11]=0;r[12]=0;r[13]=0;r[14]=0;r[15]=1;return r}function Q(r,K,X,aa,ha,G,M){const P=1/(X-K),W=1/(ha-aa),Y=1/(G-M);r[0]=2*G*P;r[1]=0;r[2]=0;r[3]=0;r[4]=0;r[5]=2*G*W;r[6]=0;r[7]=0;r[8]=(X+K)*P;r[9]=(ha+aa)*W;r[10]=(M+G)*Y;r[11]=-1;r[12]=0;r[13]=0;r[14]=M*G*2*Y;r[15]=0;return r}function U(r,K,X,aa,ha){K=1/Math.tan(K/2);let G=void 0;r[0]=K/X;r[1]=0;r[2]=0;r[3]=0;r[4]=0;r[5]=K;
r[6]=0;r[7]=0;r[8]=0;r[9]=0;r[11]=-1;r[12]=0;r[13]=0;r[15]=0;null!=ha&&Infinity!==ha?(G=1/(aa-ha),r[10]=(ha+aa)*G,r[14]=2*ha*aa*G):(r[10]=-1,r[14]=-2*aa);return r}function Z(r,K,X,aa){const ha=Math.tan(K.upDegrees*Math.PI/180),G=Math.tan(K.downDegrees*Math.PI/180),M=Math.tan(K.leftDegrees*Math.PI/180);K=Math.tan(K.rightDegrees*Math.PI/180);const P=2/(M+K),W=2/(ha+G);r[0]=P;r[1]=0;r[2]=0;r[3]=0;r[4]=0;r[5]=W;r[6]=0;r[7]=0;r[8]=-((M-K)*P*.5);r[9]=(ha-G)*W*.5;r[10]=aa/(X-aa);r[11]=-1;r[12]=0;r[13]=0;
r[14]=aa*X/(X-aa);r[15]=0;return r}function ea(r,K,X,aa,ha,G,M){const P=1/(K-X),W=1/(aa-ha),Y=1/(G-M);r[0]=-2*P;r[1]=0;r[2]=0;r[3]=0;r[4]=0;r[5]=-2*W;r[6]=0;r[7]=0;r[8]=0;r[9]=0;r[10]=2*Y;r[11]=0;r[12]=(K+X)*P;r[13]=(ha+aa)*W;r[14]=(M+G)*Y;r[15]=1;return r}function la(r,K,X,aa){const ha=K[0],G=K[1];K=K[2];let M=ha-X[0],P=G-X[1];X=K-X[2];var W=w.getEpsilon();if(Math.abs(M)<W&&Math.abs(P)<W&&Math.abs(X)<W)n(r);else{var Y=1/Math.sqrt(M*M+P*P+X*X);M*=Y;P*=Y;X*=Y;Y=aa[0];var ba=aa[1];W=aa[2];aa=ba*X-W*
P;W=W*M-Y*X;ba=Y*P-ba*M;(Y=Math.sqrt(aa*aa+W*W+ba*ba))?(Y=1/Y,aa*=Y,W*=Y,ba*=Y):ba=W=aa=0;var da=P*ba-X*W,ia=X*aa-M*ba,ka=M*W-P*aa;(Y=Math.sqrt(da*da+ia*ia+ka*ka))?(Y=1/Y,da*=Y,ia*=Y,ka*=Y):ka=ia=da=0;r[0]=aa;r[1]=da;r[2]=M;r[3]=0;r[4]=W;r[5]=ia;r[6]=P;r[7]=0;r[8]=ba;r[9]=ka;r[10]=X;r[11]=0;r[12]=-(aa*ha+W*G+ba*K);r[13]=-(da*ha+ia*G+ka*K);r[14]=-(M*ha+P*G+X*K);r[15]=1}}function na(r,K,X,aa){const ha=K[0],G=K[1];K=K[2];var M=aa[0];const P=aa[1];var W=aa[2];aa=ha-X[0];let Y=G-X[1];X=K-X[2];let ba=aa*
aa+Y*Y+X*X;0<ba&&(ba=1/Math.sqrt(ba),aa*=ba,Y*=ba,X*=ba);let da=P*X-W*Y;W=W*aa-M*X;M=M*Y-P*aa;ba=da*da+W*W+M*M;0<ba&&(ba=1/Math.sqrt(ba),da*=ba,W*=ba,M*=ba);r[0]=da;r[1]=W;r[2]=M;r[3]=0;r[4]=Y*M-X*W;r[5]=X*da-aa*M;r[6]=aa*W-Y*da;r[7]=0;r[8]=aa;r[9]=Y;r[10]=X;r[11]=0;r[12]=ha;r[13]=G;r[14]=K;r[15]=1;return r}function ta(r){return"mat4("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+", "+r[6]+", "+r[7]+", "+r[8]+", "+r[9]+", "+r[10]+", "+r[11]+", "+r[12]+", "+r[13]+", "+r[14]+", "+r[15]+")"}
function ua(r){return Math.sqrt(r[0]**2+r[1]**2+r[2]**2+r[3]**2+r[4]**2+r[5]**2+r[6]**2+r[7]**2+r[8]**2+r[9]**2+r[10]**2+r[11]**2+r[12]**2+r[13]**2+r[14]**2+r[15]**2)}function sa(r,K,X){r[0]=K[0]+X[0];r[1]=K[1]+X[1];r[2]=K[2]+X[2];r[3]=K[3]+X[3];r[4]=K[4]+X[4];r[5]=K[5]+X[5];r[6]=K[6]+X[6];r[7]=K[7]+X[7];r[8]=K[8]+X[8];r[9]=K[9]+X[9];r[10]=K[10]+X[10];r[11]=K[11]+X[11];r[12]=K[12]+X[12];r[13]=K[13]+X[13];r[14]=K[14]+X[14];r[15]=K[15]+X[15];return r}function va(r,K,X){r[0]=K[0]-X[0];r[1]=K[1]-X[1];
r[2]=K[2]-X[2];r[3]=K[3]-X[3];r[4]=K[4]-X[4];r[5]=K[5]-X[5];r[6]=K[6]-X[6];r[7]=K[7]-X[7];r[8]=K[8]-X[8];r[9]=K[9]-X[9];r[10]=K[10]-X[10];r[11]=K[11]-X[11];r[12]=K[12]-X[12];r[13]=K[13]-X[13];r[14]=K[14]-X[14];r[15]=K[15]-X[15];return r}function xa(r,K,X){r[0]=K[0]*X;r[1]=K[1]*X;r[2]=K[2]*X;r[3]=K[3]*X;r[4]=K[4]*X;r[5]=K[5]*X;r[6]=K[6]*X;r[7]=K[7]*X;r[8]=K[8]*X;r[9]=K[9]*X;r[10]=K[10]*X;r[11]=K[11]*X;r[12]=K[12]*X;r[13]=K[13]*X;r[14]=K[14]*X;r[15]=K[15]*X;return r}function Da(r,K,X,aa){r[0]=K[0]+
X[0]*aa;r[1]=K[1]+X[1]*aa;r[2]=K[2]+X[2]*aa;r[3]=K[3]+X[3]*aa;r[4]=K[4]+X[4]*aa;r[5]=K[5]+X[5]*aa;r[6]=K[6]+X[6]*aa;r[7]=K[7]+X[7]*aa;r[8]=K[8]+X[8]*aa;r[9]=K[9]+X[9]*aa;r[10]=K[10]+X[10]*aa;r[11]=K[11]+X[11]*aa;r[12]=K[12]+X[12]*aa;r[13]=K[13]+X[13]*aa;r[14]=K[14]+X[14]*aa;r[15]=K[15]+X[15]*aa;return r}function Ia(r,K){return r[0]===K[0]&&r[1]===K[1]&&r[2]===K[2]&&r[3]===K[3]&&r[4]===K[4]&&r[5]===K[5]&&r[6]===K[6]&&r[7]===K[7]&&r[8]===K[8]&&r[9]===K[9]&&r[10]===K[10]&&r[11]===K[11]&&r[12]===K[12]&&
r[13]===K[13]&&r[14]===K[14]&&r[15]===K[15]}function Pa(r,K){if(r===K)return!0;const X=r[0],aa=r[1],ha=r[2],G=r[3],M=r[4],P=r[5],W=r[6],Y=r[7],ba=r[8],da=r[9],ia=r[10],ka=r[11],ra=r[12],oa=r[13],qa=r[14];r=r[15];const Ca=K[0],wa=K[1],Ba=K[2],Aa=K[3],ya=K[4],Ha=K[5],Qa=K[6],Ya=K[7],Wa=K[8],Ja=K[9],Ka=K[10],ja=K[11],Ra=K[12],Nb=K[13],nb=K[14];K=K[15];const e=w.getEpsilon();return Math.abs(X-Ca)<=e*Math.max(1,Math.abs(X),Math.abs(Ca))&&Math.abs(aa-wa)<=e*Math.max(1,Math.abs(aa),Math.abs(wa))&&Math.abs(ha-
Ba)<=e*Math.max(1,Math.abs(ha),Math.abs(Ba))&&Math.abs(G-Aa)<=e*Math.max(1,Math.abs(G),Math.abs(Aa))&&Math.abs(M-ya)<=e*Math.max(1,Math.abs(M),Math.abs(ya))&&Math.abs(P-Ha)<=e*Math.max(1,Math.abs(P),Math.abs(Ha))&&Math.abs(W-Qa)<=e*Math.max(1,Math.abs(W),Math.abs(Qa))&&Math.abs(Y-Ya)<=e*Math.max(1,Math.abs(Y),Math.abs(Ya))&&Math.abs(ba-Wa)<=e*Math.max(1,Math.abs(ba),Math.abs(Wa))&&Math.abs(da-Ja)<=e*Math.max(1,Math.abs(da),Math.abs(Ja))&&Math.abs(ia-Ka)<=e*Math.max(1,Math.abs(ia),Math.abs(Ka))&&Math.abs(ka-
ja)<=e*Math.max(1,Math.abs(ka),Math.abs(ja))&&Math.abs(ra-Ra)<=e*Math.max(1,Math.abs(ra),Math.abs(Ra))&&Math.abs(oa-Nb)<=e*Math.max(1,Math.abs(oa),Math.abs(Nb))&&Math.abs(qa-nb)<=e*Math.max(1,Math.abs(qa),Math.abs(nb))&&Math.abs(r-K)<=e*Math.max(1,Math.abs(r),Math.abs(K))}function Na(r){const K=w.getEpsilon(),X=r[0],aa=r[1],ha=r[2],G=r[4],M=r[5],P=r[6],W=r[8],Y=r[9];r=r[10];return Math.abs(1-(X*X+G*G+W*W))<=K&&Math.abs(1-(aa*aa+M*M+Y*Y))<=K&&Math.abs(1-(ha*ha+P*P+r*r))<=K}function Sa(r){return 1===
r[0]&&0===r[1]&&0===r[2]&&0===r[4]&&1===r[5]&&0===r[6]&&0===r[8]&&0===r[9]&&1===r[10]}const Va=c.create();c=Object.freeze(Object.defineProperty({__proto__:null,add:sa,adjoint:m,copy:v,determinant:x,equals:Pa,exactEquals:Ia,frob:ua,fromQuat:R,fromQuat2:y,fromRotation:h,fromRotationTranslation:k,fromRotationTranslationScale:u,fromRotationTranslationScaleOrigin:D,fromScaling:L,fromTranslation:F,fromXRotation:H,fromYRotation:S,fromZRotation:C,frustum:Q,getRotation:O,getScaling:l,getTranslation:N,hasIdentityRotation:Sa,
identity:n,invert:d,invertOrIdentity:z,isOrthoNormal:Na,lookAt:la,mul:B,multiply:B,multiplyScalar:xa,multiplyScalarAndAdd:Da,ortho:ea,perspective:U,perspectiveFromFieldOfView:Z,rotate:f,rotateX:b,rotateY:q,rotateZ:A,scale:p,set:I,str:ta,sub:va,subtract:va,targetTo:na,translate:E,transpose:g},Symbol.toStringTag,{value:"Module"}));a.add=sa;a.adjoint=m;a.copy=v;a.determinant=x;a.equals=Pa;a.exactEquals=Ia;a.frob=ua;a.fromQuat=R;a.fromQuat2=y;a.fromRotation=h;a.fromRotationTranslation=k;a.fromRotationTranslationScale=
u;a.fromRotationTranslationScaleOrigin=D;a.fromScaling=L;a.fromTranslation=F;a.fromXRotation=H;a.fromYRotation=S;a.fromZRotation=C;a.frustum=Q;a.getRotation=O;a.getScaling=l;a.getTranslation=N;a.hasIdentityRotation=Sa;a.identity=n;a.invert=d;a.invertOrIdentity=z;a.isOrthoNormal=Na;a.lookAt=la;a.mat4=c;a.mul=B;a.multiply=B;a.multiplyScalar=xa;a.multiplyScalarAndAdd=Da;a.ortho=ea;a.perspective=U;a.perspectiveFromFieldOfView=Z;a.rotate=f;a.rotateX=b;a.rotateY=q;a.rotateZ=A;a.scale=p;a.set=I;a.str=ta;
a.sub=va;a.subtract=va;a.targetTo=na;a.translate=E;a.transpose=g})},"esri/statistics/utils":function(){define(["exports","../rest/support/ClassBreaksDefinition","../rest/support/generateRendererUtils"],function(a,c,w){function v(u){return null==u||"string"===typeof u&&!u?"\x3cNull\x3e":u}function I(u){const D=null!=u.minValue||null!=u.maxValue,R=!!u.sqlExpression&&u.supportsSQLExpression;return!(null!=u.normalizationField||null!=u.normalizationType)&&!D&&!R}function n(u){const {values:D,useSampleStdDev:R,
supportsNullCount:Q}=u;var U=Number.POSITIVE_INFINITY;let Z=Number.NEGATIVE_INFINITY,ea=null,la=null;var na=null;let ta=null,ua=0;const sa=null==u.minValue?-Infinity:u.minValue,va=null==u.maxValue?Infinity:u.maxValue;for(const xa of D)Number.isFinite(xa)?xa>=sa&&xa<=va&&(ea=null===ea?xa:ea+xa,U=Math.min(U,xa),Z=Math.max(Z,xa),ua++):"string"===typeof xa&&ua++;if(ua&&null!=ea){la=ea/ua;na=0;for(const xa of D)Number.isFinite(xa)&&xa>=sa&&xa<=va&&(na+=(xa-la)**2);ta=R?1<ua?na/(ua-1):0:0<ua?na/ua:0;na=
Math.sqrt(ta)}else Z=U=null;U={avg:la,count:ua,max:Z,min:U,stddev:na,sum:ea,variance:ta};Q&&(U.nullcount=D.length-ua);u.percentileParams&&(U.median=g(D,u.percentileParams));return U}function g(u,D){const {fieldType:R,value:Q,orderBy:U,isDiscrete:Z}=D,ea=z(R,"desc"===U);u=[...u].filter(ua=>null!=ua).sort((ua,sa)=>ea(ua,sa));if(0===u.length)return null;if(0>=Q)return u[0];if(1<=Q)return u[u.length-1];var la=(u.length-1)*Q,na=Math.floor(la);D=na+1;la%=1;na=u[na];const ta=u[D];return D>=u.length||Z||
"string"===typeof na||"string"===typeof ta?na:na*(1-la)+ta*la}function z(u,D){if(u){if(F.has(u))return D?l:O;if(L.has(u))return d(D,!1);if("esriFieldTypeTimestampOffset"===u)return D?k:C;const Z=d(D,!0);if("esriFieldTypeString"===u)return Z;if("esriFieldTypeGUID"===u||"esriFieldTypeGlobalID"===u)return(ea,la)=>Z(m(ea),m(la))}const R=D?1:-1,Q=D?l:O,U=d(D,!0);return(Z,ea)=>"number"===typeof Z&&"number"===typeof ea?Q(Z,ea):"string"===typeof Z&&"string"===typeof ea?U(Z,ea):R}function d(u,D){if(!D)return u?
N:y;const R=u?H:S;return u?(Q,U)=>{const Z=R(Q,U);if(null!=Z)return Z;Q=Q.toUpperCase();U=U.toUpperCase();return Q>U?-1:Q<U?1:0}:(Q,U)=>{const Z=R(Q,U);if(null!=Z)return Z;Q=Q.toUpperCase();U=U.toUpperCase();return Q<U?-1:Q>U?1:0}}function m(u){return u.substr(24,12)+u.substr(19,4)+u.substr(16,2)+u.substr(14,2)+u.substr(11,2)+u.substr(9,2)+u.substr(6,2)+u.substr(4,2)+u.substr(2,2)+u.substr(0,2)}function x(u){return"coded-value"!==u?.type?[]:u.codedValues.map(D=>D.code)}function B(u,D){const R=p({field:D.field,
normalizationType:D.normalizationType,normalizationField:D.normalizationField,classificationMethod:D.classificationMethod,standardDeviationInterval:D.standardDeviationInterval,breakCount:D.numClasses||5});u=E(u,D.minValue,D.maxValue);return w.createGenerateRendererClassBreaks({definition:R,values:u,normalizationTotal:D.normalizationTotal})}function E(u,D,R){const Q=null==D?-Infinity:D,U=null==R?Infinity:R;return u.filter(Z=>Number.isFinite(Z)&&Z>=Q&&Z<=U)}function p(u){const {breakCount:D,field:R,
normalizationField:Q,normalizationType:U}=u,Z=u.classificationMethod||"equal-interval";return new c({breakCount:D,classificationField:R,classificationMethod:Z,normalizationField:"field"===U?Q:void 0,normalizationType:U,standardDeviationInterval:"standard-deviation"===Z?u.standardDeviationInterval||1:void 0})}function f(u,D){const {field:R,classificationMethod:Q,standardDeviationInterval:U,normalizationType:Z,normalizationField:ea,normalizationTotal:la,minValue:na,maxValue:ta}=D,ua=D.numBins||10;let sa=
D=null,va=null;Q&&"equal-interval"!==Q||Z?({classBreaks:u}=B(u,{field:R,normalizationType:Z,normalizationField:ea,normalizationTotal:la,classificationMethod:Q,standardDeviationInterval:U,minValue:na,maxValue:ta,numClasses:ua}),D=u[0].minValue,sa=u[u.length-1].maxValue,va=u.map(xa=>[xa.minValue,xa.maxValue])):(null!=na&&null!=ta?(D=na,sa=ta):(u=n({values:u,minValue:na,maxValue:ta,useSampleStdDev:!Z,supportsNullCount:I({normalizationType:Z,normalizationField:ea,minValue:na,maxValue:ta})}),D=u.min??
null,sa=u.max??null),va=q(D??0,sa??0,ua));return{min:D,max:sa,intervals:va}}function b(u,D){let R=-1;for(let Q=u.length-1;0<=Q;Q--)if(D>=u[Q][0]){R=Q;break}return R}function q(u,D,R){const Q=(D-u)/R,U=[];let Z;for(let ea=1;ea<=R;ea++)Z=u+Q,Z=Number(Z.toFixed(16)),U.push([u,ea===R?D:Z]),u=Z;return U}const A=/\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*/gi,F=new Set("esriFieldTypeDate esriFieldTypeInteger esriFieldTypeSmallInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong esriFieldTypeOID esriFieldTypeBigInteger".split(" ")),
L=new Set(["esriFieldTypeTimeOnly","esriFieldTypeDateOnly"]),h="min max avg stddev count sum variance nullcount median".split(" "),H=(u,D)=>null==u?null==D?0:1:null==D?-1:null,S=(u,D)=>null==u?null==D?0:-1:null==D?1:null,C=(u,D)=>S(u,D)??(u===D?0:(new Date(u)).getTime()-(new Date(D)).getTime()),k=(u,D)=>H(u,D)??(u===D?0:(new Date(D)).getTime()-(new Date(u)).getTime()),y=(u,D)=>S(u,D)??(u===D?0:u<D?-1:1),N=(u,D)=>H(u,D)??(u===D?0:u<D?1:-1),l=(u,D)=>H(u,D)??D-u,O=(u,D)=>S(u,D)??u-D;a.calculateClassBreaks=
B;a.calculateHistogram=function(u,D){var R=f(u,D);if(null==R.min&&null==R.max)return{bins:[],minValue:R.min,maxValue:R.max,normalizationTotal:D.normalizationTotal};const Q=R.intervals,U=R.min??0;R=R.max??0;const Z=Q.map((ea,la)=>({minValue:Q[la][0],maxValue:Q[la][1],count:0}));for(const ea of u)null!=ea&&ea>=U&&ea<=R&&(u=b(Q,ea),-1<u&&Z[u].count++);return{bins:Z,minValue:U,maxValue:R,normalizationTotal:D.normalizationTotal}};a.calculatePercentile=g;a.calculateStatistics=n;a.calculateStringStatistics=
function(u){const D=u.returnDistinct?[...(new Set(u.values))]:u.values;var R=D.filter(U=>null!=U).sort();const Q=R.length;R={count:Q,min:R[0],max:R[Q-1]};u.supportsNullCount&&(R.nullcount=D.length-Q);u.percentileParams&&(R.median=g(D,u.percentileParams));return R};a.calculateUniqueValuesCount=function(u){const D={};for(let R of u){if(null==R||"string"===typeof R&&""===R.trim())R=null;null==D[R]?D[R]={count:1,data:R}:D[R].count++}return{count:D}};a.createClassBreaksDefinition=p;a.createUVResult=function(u,
D,R,Q){u=u.count;const U=[];if(R&&D){R=[];var Z=x(D[0]);for(const ea of Z)if(D[1]){Z=x(D[1]);for(const la of Z)if(D[2]){Z=x(D[2]);for(const na of Z)R.push(`${v(ea)}${Q}${v(la)}${Q}${v(na)}`)}else R.push(`${v(ea)}${Q}${v(la)}`)}else R.push(ea);for(const ea of R)u.hasOwnProperty(ea)||(u[ea]={data:ea,count:0})}for(const ea in u)D=u[ea],U.push({value:D.data,count:D.count,label:D.label});return{uniqueValueInfos:U}};a.getAttributeComparator=z;a.getEqualIntervalBins=q;a.getNormalizedValue=function(u,D,R,
Q){let U=null;switch(D){case "log":0!==u&&(U=Math.log(u)*Math.LOG10E);break;case "percent-of-total":Number.isFinite(Q)&&0!==Q&&(U=u/Q*100);break;case "field":Number.isFinite(R)&&0!==R&&(U=u/R);break;case "natural-log":0<u&&(U=Math.log(u));break;case "square-root":0<u&&(U=u**.5)}return U};a.isNullCountSupported=I;a.processNullValue=v;a.processSummaryStatisticsResult=function(u,D){let R;for(R in u)h.includes(R)&&(Number.isFinite(u[R])||(u[R]=null));if(!D)return u;["avg","stddev","variance"].forEach(Q=>
{null!=u[Q]&&(u[Q]=Math.ceil(u[Q]??0))});return u};a.resolveCBResult=function(u,D){let R=u.classBreaks;const Q=R[0]?.minValue,U=R[R.length-1]?.maxValue,Z="standard-deviation"===D;R=R.map(ea=>{const la=ea.label;ea={minValue:ea.minValue,maxValue:ea.maxValue,label:la};if(Z&&la){const na=la.match(A)?.map(ta=>+ta.trim())??[];2===na.length?(ea.minStdDev=na[0],ea.maxStdDev=na[1],0>na[0]&&0<na[1]&&(ea.hasAvg=!0)):1===na.length&&(la.includes("\x3c")?(ea.minStdDev=null,ea.maxStdDev=na[0]):la.includes("\x3e")&&
(ea.minStdDev=na[0],ea.maxStdDev=null))}return ea});return{minValue:Q,maxValue:U,classBreakInfos:R,normalizationTotal:u.normalizationTotal}};a.statisticTypes=h;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/ClassBreaksDefinition":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),
function(a,c,w,v,I,n,g,z,d){I=new c.JSONMap({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"});c=new c.JSONMap({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});w=class extends w.JSONSupport{constructor(m){super(m);this.type="class-breaks-definition";
this.normalizationType=this.normalizationField=this.classificationMethod=this.classificationField=this.breakCount=null}set standardDeviationInterval(m){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",m)}set definedInterval(m){"defined-interval"===this.classificationMethod&&this._set("definedInterval",m)}};a.__decorate([z.enumeration({classBreaksDef:"class-breaks-definition"})],w.prototype,"type",void 0);a.__decorate([v.property({json:{write:!0}})],w.prototype,
"breakCount",void 0);a.__decorate([v.property({json:{write:!0}})],w.prototype,"classificationField",void 0);a.__decorate([v.property({type:String,json:{read:I.read,write:I.write}})],w.prototype,"classificationMethod",void 0);a.__decorate([v.property({json:{write:!0}})],w.prototype,"normalizationField",void 0);a.__decorate([v.property({json:{read:c.read,write:c.write}})],w.prototype,"normalizationType",void 0);a.__decorate([v.property({value:null,json:{write:!0}})],w.prototype,"standardDeviationInterval",
null);a.__decorate([v.property({value:null,json:{write:!0}})],w.prototype,"definedInterval",null);return w=a.__decorate([d.subclass("esri.rest.support.ClassBreaksDefinition")],w)})},"esri/core/accessorSupport/decorators/enumeration":function(){define(["exports","../../jsonMap","./property"],function(a,c,w){a.enumeration=function(v,I={}){v=v instanceof c.JSONMap?v:new c.JSONMap(v,I);v={type:I?.ignoreUnknown??!0?v.apiValues:String,json:{type:v.jsonValues,read:I?.readOnly?!1:{reader:v.read},write:{writer:v.write}}};
void 0!==I?.readOnly&&(v.readOnly=!!I.readOnly);void 0!==I?.default&&(v.json.default=I.default);void 0!==I?.name&&(v.json.name=I.name);void 0!==I?.nonNullable&&(v.nonNullable=I.nonNullable);return w.property(v)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/generateRendererUtils":function(){define(["exports","../../core/Logger"],function(a,c){function w(E){var p=E.definition;const {classificationMethod:f,normalizationType:b,definedInterval:q}=p;p=p.breakCount??
1;const A=[];var F=E.values;if(0===F.length)return[];F=F.sort((k,y)=>k-y);var L=F[0],h=F[F.length-1];if("equal-interval"===f)if(F.length>=p){F=(h-L)/p;E=L;for(var H=1;H<p;H++){var S=Number((L+H*F).toFixed(6));A.push({minValue:E,maxValue:S,label:v(E,S,b)});E=S}A.push({minValue:E,maxValue:h,label:v(E,h,b)})}else F.forEach(k=>{A.push({minValue:k,maxValue:k,label:v(k,k,b)})});else if("natural-breaks"===f){F=I(F);E=n(F.uniqueValues,E.valueFrequency||F.valueFrequency,p);for(H=1;H<p;H++)F.uniqueValues.length>
H&&(S=Number(F.uniqueValues[E[H]].toFixed(6)),A.push({minValue:L,maxValue:S,label:v(L,S,b)}),L=S);A.push({minValue:L,maxValue:h,label:v(L,h,b)})}else if("quantile"===f)if(F.length>=p&&L!==h){E=Math.ceil(F.length/p);H=0;for(S=1;S<p;S++){var C=E+H-1;C>F.length&&(C=F.length-1);0>C&&(C=0);A.push({minValue:L,maxValue:F[C],label:v(L,F[C],b)});L=F[C];H+=E;E=Math.ceil((F.length-H)/(p-S))}A.push({minValue:L,maxValue:h,label:v(L,h,b)})}else for(p=-1,h=0;h<F.length;h++)L=F[h],L!==p&&(p=L,A.push({minValue:p,
maxValue:L,label:v(p,L,b)}),p=L);else if("standard-deviation"===f)if(E=d(F),H=m(F,E),0===H)A.push({minValue:F[0],maxValue:F[0],label:v(F[0],F[0],b)});else{F=z(L,h,p,E,H)*H;H=0;for(S=p;1<=S;S--)C=Number((E-(S-.5)*F).toFixed(6)),A.push({minValue:L,maxValue:C,label:v(L,C,b)}),L=C,H++;S=Number((E+.5*F).toFixed(6));A.push({minValue:L,maxValue:S,label:v(L,S,b)});L=S;H++;for(C=1;C<=p;C++)S=H===2*p?h:Number((E+(C+.5)*F).toFixed(6)),A.push({minValue:L,maxValue:S,label:v(L,S,b)}),L=S,H++}else if("defined-interval"===
f){if(!q)return A;p=F[0];h=F[F.length-1];F=Math.ceil((h-p)/q);L=p;for(E=1;E<F;E++)H=Number((p+E*q).toFixed(6)),A.push({minValue:L,maxValue:H,label:v(L,H,b)}),L=H;A.push({minValue:L,maxValue:h,label:v(L,h,b)})}return A}function v(E,p,f){let b=null;return b=E===p?f&&"percent-of-total"===f?E+"%":E.toString():f&&"percent-of-total"===f?E+"% - "+p+"%":E+" - "+p}function I(E){const p=[],f=[];let b=Number.MIN_VALUE,q=1,A=-1;for(let F=0;F<E.length;F++){const L=E[F];L===b?(q++,f[A]=q):null!==L&&(p.push(L),
b=L,q=1,f.push(q),A++)}return{uniqueValues:p,valueFrequency:f}}function n(E,p,f){var b=E.length;const q=[];f>b&&(f=b);for(var A=0;A<f;A++)q.push(Math.round(A*b/f-1));q.push(b-1);A=g(q,E,p,f);b=A.mean;A=A.sdcm;var F=f,L=0,h=0;let H=0,S=0,C=!0;for(let y=0;2>y&&C;y++){0===y&&(C=!1);for(var k=0;k<F-1;k++)for(;q[k+1]+1!==q[k+2];)if(q[k+1]+=1,L=x(k,q,E,p),H=L.sbMean,L=L.sbSdcm,h=x(k+1,q,E,p),S=h.sbMean,h=h.sbSdcm,L+h<A[k]+A[k+1])A[k]=L,A[k+1]=h,b[k]=H,b[k+1]=S,C=!0;else{--q[k+1];break}for(k=F-1;0<k;k--)for(;q[k]!==
q[k-1]+1;)if(--q[k],L=x(k-1,q,E,p),H=L.sbMean,L=L.sbSdcm,h=x(k,q,E,p),S=h.sbMean,h=h.sbSdcm,L+h<A[k-1]+A[k])A[k-1]=L,A[k]=h,b[k-1]=H,b[k]=S,C=!0;else{q[k]+=1;break}}C&&(A=g(q,E,p,f));return q}function g(E,p,f,b){let q=[];var A=[],F=[];let L=0;const h=[],H=[];for(var S=0;S<b;S++){var C=x(S,E,p,f);h.push(C.sbMean);H.push(C.sbSdcm);L+=H[S]}C=L;for(S=!0;S||L<C;){S=!1;q=[];for(A=0;A<b;A++)q.push(E[A]);for(F=0;F<b;F++)for(C=E[F]+1;C<=E[F+1];C++)if(A=p[C],0<F&&C!==E[F+1]&&Math.abs(A-h[F])>Math.abs(A-h[F-
1]))E[F]=C;else if(F<b-1&&E[F]!==C-1&&Math.abs(A-h[F])>Math.abs(A-h[F+1])){E[F+1]=C-1;break}C=L;L=0;A=[];F=[];for(let k=0;k<b;k++){A.push(h[k]);F.push(H[k]);const y=x(k,E,p,f);h[k]=y.sbMean;H[k]=y.sbSdcm;L+=H[k]}}if(L>C){for(p=0;p<b;p++)E[p]=q[p],h[p]=A[p],H[p]=F[p];L=C}return{mean:h,sdcm:H}}function z(E,p,f,b,q){E=Math.max(b-E,p-b)/q/f;return 1<=E?1:.5<=E?.5:.25}function d(E){let p=0;for(let f=0;f<E.length;f++)p+=E[f];return p/=E.length}function m(E,p){let f=0;for(let b=0;b<E.length;b++){const q=
E[b];f+=(q-p)*(q-p)}f/=E.length;return Math.sqrt(f)}function x(E,p,f,b){var q=0,A=0;for(var F=p[E]+1;F<=p[E+1];F++){const L=b[F];q+=f[F]*L;A+=L}0>=A&&B.warn("Exception in Natural Breaks calculation");q/=A;A=0;for(F=p[E]+1;F<=p[E+1];F++)A+=b[F]*(f[F]-q)**2;return{sbMean:q,sbSdcm:A}}const B=c.getLogger("esri.rest.support.generateRendererUtils");a.createGenerateRendererClassBreaks=function(E){const {normalizationTotal:p}=E;return{classBreaks:w(E),normalizationTotal:p}};a.createGenerateRendererUniqueValues=
function(E){E=I(E);const p=[],f=E.uniqueValues.length;for(let b=0;b<f;b++){const q=E.uniqueValues[b];p.push({value:q,count:E.valueFrequency[b],label:q.toString()})}return{uniqueValues:p}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/SnappingCandidate":function(){define(["exports"],function(a){a.makeEdgeCandidate=function(c,w,v,I,n,g=!1){return{objectId:c,target:w,distance:v,type:"edge",start:I,end:n,draped:g}};a.makeVertexCandidate=function(c,w,v){return{objectId:c,
target:w,distance:v,type:"vertex"}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/queryUtils":function(){define("require exports ../../../core/jsonMap ../../../core/unitUtils ../../../geometry/projection ../../../geometry/support/extentUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ./projectionSupport".split(" "),function(a,c,w,v,I,n,g,z,d,m){async function x(q,A,F){if(!q)return null;
var {where:L}=q;q.where=L=L?.trim();if(!L||/^1 *= *1$/.test(L)||A&&A===L)q.where=null;if(!q.geometry)return q;A=await E(q);q.distance=0;q.units=null;"esriSpatialRelEnvelopeIntersects"===q.spatialRel&&({spatialReference:L}=q.geometry,A=n.getGeometryExtent(A),A.spatialReference=L);if(A){await m.checkProjectionSupport(A.spatialReference,F);L=A.spatialReference;A=B(A,F)&&g.isExtent(A)?{spatialReference:L,rings:[[[A.xmin,A.ymin],[A.xmin,A.ymax],[A.xmax,A.ymax],[A.xmax,A.ymin],[A.xmin,A.ymin]]]}:A;L=(await z.normalizeCentralMeridian(g.fromJSON(A)))[0];
if(null==L)throw b;const h="quantizationParameters"in q&&q.quantizationParameters?.tolerance||"maxAllowableOffset"in q&&q.maxAllowableOffset||0;A=h&&B(A,F)?{densificationStep:8*h}:void 0;L=L.toJSON();A=m.project(L,L.spatialReference,F,A);if(!A)throw b;A.spatialReference=F;q.geometry=A}return q}function B(q,A){if(!q)return!1;const F=q.spatialReference;return(g.isExtent(q)||g.isPolygon(q)||g.isPolyline(q))&&!d.equals(F,A)&&!I.canProjectWithoutEngine(F,A)}async function E(q){const {distance:A,units:F}=
q,L=q.geometry;if(null==A||"vertexAttributes"in L)return L;var h=L.spatialReference;q=F?f.fromJSON(F):v.getUnitString(h);h=h&&(d.isGeographic(h)||d.isWebMercator(h))?L:await m.checkProjectionSupport(h,d.WGS84).then(()=>m.project(L,d.WGS84));return(await p())(h.spatialReference,h,A,q)}async function p(){return(await new Promise((q,A)=>a(["../../../geometry/geometryEngineJSON"],q,A))).geodesicBuffer}const f=new w.JSONMap({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",
esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),b=Object.freeze({});c.normalizeQuery=async function(q,A,F){const {outFields:L,orderByFields:h,groupByFieldsForStatistics:H,outStatistics:S}=q;if(L)for(var C=0;C<L.length;C++)L[C]=L[C].trim();if(h)for(C=0;C<h.length;C++)h[C]=h[C].trim();if(H)for(C=0;C<H.length;C++)H[C]=H[C].trim();if(S)for(C=0;C<S.length;C++)S[C].onStatisticField&&(S[C].onStatisticField=S[C].onStatisticField.trim());
q.geometry&&!q.outSR&&(q.outSR=q.geometry.spatialReference);return x(q,A,F)};c.normalizeQueryLike=x;c.queryEngineEmptyResult=b;c.unitsKebabDict=f;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/queryValidationUtils":function(){define("exports ../../../core/Error ./attributeSupport ./projectionSupport ./spatialQuerySupport ../../../support/arcadeOnDemand".split(" "),function(a,c,w,v,I,n){function g(B,E,p){const {outFields:f,orderByFields:b,returnDistinctValues:q,
outStatistics:A}=p,F=A?A.map(L=>L.outStatisticFieldName&&L.outStatisticFieldName.toLowerCase()).filter(Boolean):[];if(b&&0<b.length){const L=b.map(h=>{const H=h.toLowerCase();return H.includes(" asc")?H.split(" asc")[0]:H.includes(" desc")?H.split(" desc")[0]:h}).filter(h=>!F.includes(h));w.validateFields(B,E,L,{expressionName:"orderByFields",query:p})}if(f&&0<f.length)w.validateFields(B,E,f,{expressionName:"outFields",query:p});else if(q)throw new c("unsupported-query","outFields should be specified for returnDistinctValues",
{query:p});w.validateWhere(B,E,p.where,p)}function z(B,E,p){const {outStatistics:f,groupByFieldsForStatistics:b,having:q}=p;var A=b?.length,F=f?.length;if(q){if(!A||!F)throw new c("unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:p});w.validateHaving(B,E,q,f,p)}if(F&&m(f)){F=f.map(L=>L.onStatisticField).filter(Boolean);w.validateFields(B,E,F,{expressionName:"onStatisticFields",query:p});A&&w.validateFields(B,E,b,{expressionName:"groupByFieldsForStatistics",
query:p});for(const L of f){const {onStatisticField:h,statisticType:H}=L;if(("percentile_disc"===H||"percentile_cont"===H)&&"statisticParameters"in L){if({statisticParameters:A}=L,!A)throw new c("unsupported-query","statisticParameters should be set for percentile type",{definition:L,query:p});}else B.get(h)&&"count"!==H&&"min"!==H&&"max"!==H&&w.validateFields(B,E,[h],{expressionName:`outStatistics with '${H}' statistic type`,allowedFieldTypes:x,query:p})}}}async function d(B,E,p,f){var b=[];p.valueExpression&&
({arcadeUtils:b}=await n.loadArcade(),b=b.extractFieldNames(p.valueExpression));p.field&&b.push(p.field);p.field2&&b.push(p.field2);p.field3&&b.push(p.field3);p.normalizationField&&b.push(p.normalizationField);if(!b.length&&!p.valueExpression)throw new c("unsupported-query","field or valueExpression is required",{params:p});w.validateFields(B,E,b,{expressionName:"statistics",query:f})}function m(B){return null!=B&&B.every(E=>"exceedslimit"!==E.statisticType)}const x=new Set([...w.numericFieldTypes,
...w.allDateAndTimeFieldTypes]);a.validateQuery=async function(B,{fieldsIndex:E,geometryType:p,spatialReference:f,availableFields:b}){if(0>(B.distance??0)||null!=B.geometryPrecision||B.multipatchOption&&"xyFootprint"!==B.multipatchOption||B.pixelSize||B.relationParam||B.text)throw new c("unsupported-query","Unsupported query options",{query:B});g(E,b,B);z(E,b,B);return Promise.all([I.checkSpatialQuerySupport(B,p,f),v.checkProjectionSupport(f,B.outSR)]).then(()=>B)};a.validateStatisticsQuery=async function(B,
E,{fieldsIndex:p,geometryType:f,spatialReference:b,availableFields:q}){if(0>(B.distance??0)||null!=B.geometryPrecision||B.multipatchOption||B.pixelSize||B.relationParam||B.text||B.outStatistics||B.groupByFieldsForStatistics||B.having||B.orderByFields)throw new c("unsupported-query","Unsupported query options",{query:B});g(p,q,B);return Promise.all([d(p,q,E,B),I.checkSpatialQuerySupport(B,f,b),v.checkProjectionSupport(b,B.outSR)]).then(()=>B)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/layers/graphics/data/spatialQuerySupport":function(){define("require exports ../../../core/Error ../../../geometry/support/contains ../../../geometry/support/intersects ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ../contains ../featureConversionUtils ../OptimizedGeometry ./geometryUtils ./projectionSupport".split(" "),function(a,c,w,v,I,n,g,z,d,m,x,B){function E(){return new Promise((A,F)=>a(["../../../geometry/geometryEngineJSON"],A,F))}const p={esriSpatialRelIntersects:"intersects",
esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null};var f={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,
esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},b={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},q={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};c.canQueryWithRBush=function(A){if(n.isExtent(A))return!0;if(n.isPolygon(A)){for(const F of A.rings)if(5!==F.length||F[0][0]!==F[1][0]||F[0][0]!==F[4][0]||F[2][0]!==F[3][0]||F[0][1]!==F[3][1]||F[0][1]!==
F[4][1]||F[1][1]!==F[2][1])return!1;return!0}return!1};c.checkSpatialQuerySupport=async function(A,F,L){const {spatialRel:h,geometry:H}=A;if(H){if(null==h||!0!==f[h])throw new w("unsupported-query","Unsupported query spatial relationship",{query:A});if(g.isValid(H.spatialReference)&&g.isValid(L)){if(null==H||!0!==b[n.getJsonType(H)])throw new w("unsupported-query","Unsupported query geometry type",{query:A});if(null==F||!0!==q[F])throw new w("unsupported-query","Unsupported layer geometry type",{query:A});
if(A.outSR)return B.checkProjectionSupport(A.geometry?.spatialReference,A.outSR)}}};c.getSpatialQueryOperator=function(A,F,L,h,H){if(n.isPolygon(F)&&"esriGeometryPoint"===L&&("esriSpatialRelIntersects"===A||"esriSpatialRelContains"===A)){const S=d.convertFromPolygon(new m,F,!1,!1);return Promise.resolve(C=>z.polygonContainsPoint(S,!1,!1,C))}if(n.isPolygon(F)&&"esriGeometryMultipoint"===L){const S=d.convertFromPolygon(new m,F,!1,!1);if("esriSpatialRelContains"===A)return Promise.resolve(C=>z.polygonContainsMultipoint(S,
!1,!1,C,h,H))}if(n.isExtent(F)&&"esriGeometryPoint"===L&&("esriSpatialRelIntersects"===A||"esriSpatialRelContains"===A))return Promise.resolve(S=>v.extentContainsPoint(F,x.getGeometry(L,h,H,S)));if(n.isExtent(F)&&"esriGeometryMultipoint"===L&&"esriSpatialRelContains"===A)return Promise.resolve(S=>v.extentContainsMultipoint(F,x.getGeometry(L,h,H,S)));if(n.isExtent(F)&&"esriSpatialRelIntersects"===A){const S=I.getExtentIntersector(L);return Promise.resolve(C=>S(F,x.getGeometry(L,h,H,C)))}return E().then(S=>
{const C=S[p[A]].bind(null,F.spatialReference,F);return k=>C(x.getGeometry(L,h,H,k))})};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/intersects":function(){define(["exports","./intersectsBase"],function(a,c){a.extentIntersectsExtent=c.extentIntersectsExtent;a.extentIntersectsMultipoint=c.extentIntersectsMultipoint;a.extentIntersectsPoint=c.extentIntersectsPoint;a.extentIntersectsPolygon=c.extentIntersectsPolygon;a.extentIntersectsPolyline=c.extentIntersectsPolyline;
a.extentIntersectsRings=c.extentIntersectsRings;a.getFeatureExtentIntersector=c.getFeatureExtentIntersector;a.isSelfIntersecting=c.isSelfIntersecting;a.segmentIntersects=c.segmentIntersects;a.getExtentIntersector=function(w){return"mesh"===w?c.extentIntersectsExtent:c.getFeatureExtentIntersector(w)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/contains":function(){define(["exports"],function(a){function c(w,v,I,n,g){if(!w)return!1;v=v?I?4:3:I?3:2;const {coords:z,
lengths:d}=w;I=!1;w=0;for(const x of d){var m=w;for(let B=w,E=w+x*v;B<E;B+=v){m=B+v;m===E&&(m=w);const p=z[B],f=z[B+1],b=z[m];m=z[m+1];(f<g&&m>=g||m<g&&f>=g)&&p+(g-f)/(m-f)*(b-p)<n&&(I=!I)}w+=x*v}return I}a.polygonContainsCoords=c;a.polygonContainsMultipoint=function(w,v,I,n,g,z){g=g?z?4:3:z?3:2;const {coords:d,lengths:m}=n;if(!m)return!1;for(let x=0,B=0;x<m.length;x++,B+=g)if(!c(w,v,I,d[B],d[B+1]))return!1;return!0};a.polygonContainsPoint=function(w,v,I,n){return c(w,v,I,n.coords[0],n.coords[1])};
Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/timeSupport":function(){define(["exports"],function(a){function c(I,n,g,z,d){if(null!=z&&null!=d)return m=>{const x=I(m,n);m=I(m,g);return(null==x||x<=d)&&(null==m||m>=z)};if(null!=z)return m=>{m=I(m,g);return null==m||m>=z};if(null!=d)return m=>{m=I(m,n);return null==m||m<=d}}function w(I,n,g,z){if(null!=g&&null!=z&&g===z)return d=>I(d,n)===g;if(null!=g&&null!=z)return d=>{d=I(d,n);return null!=d&&d>=g&&d<=
z};if(null!=g)return d=>{d=I(d,n);return null!=d&&d>=g};if(null!=z)return d=>{d=I(d,n);return null!=d&&d<=z}}function v(){return()=>!1}a.getTimeExtent=async function(I,n){if(!I)return null;const g=n.featureAdapter,{startTimeField:z,endTimeField:d}=I;let m=Number.POSITIVE_INFINITY,x=Number.NEGATIVE_INFINITY;if(z&&d)await n.forEach(B=>{const E=g.getAttribute(B,z);B=g.getAttribute(B,d);null==E||isNaN(E)||(m=Math.min(m,E));null==B||isNaN(B)||(x=Math.max(x,B))});else{const B=z||d;await n.forEach(E=>{E=
g.getAttribute(E,B);null==E||isNaN(E)||(m=Math.min(m,E),x=Math.max(x,E))})}return{start:m,end:x}};a.getTimeOperator=function(I,n,g){if(!n||!I)return null;const {startTimeField:z,endTimeField:d}=I;if(!z&&!d)return null;const {start:m,end:x}=n;if(null===m&&null===x)return null;if(void 0===m&&void 0===x)return v();I=g.getAttributeAsTimestamp?.bind(g)??g.getAttribute.bind(g);return z&&d?c(I,z,d,m,x):w(I,z||d,m,x)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/FieldsIndex":function(){define("../../core/Error ../../core/JSONSupport ../../core/Logger ../../core/MapUtils ../../core/sql/UnknownTimeZone ./fieldUtils ../../time/timeZoneUtils ../../chunks/datetime".split(" "),
function(a,c,w,v,I,n,g,z){function d(p){return p.trim().toLowerCase()}function m(p){const f=new Map;if(!p.fields)return f;const b=!0===p.datesInUnknownTimezone,{timeInfo:q,editFieldsInfo:A}=p;var F=(q?"startField"in q?q.startField:q.startTimeField:"")??"";const L=(q?"endField"in q?q.endField:q.endTimeField:"")??"",h="dateFieldsTimeZone"in p?p.dateFieldsTimeZone??null:p.dateFieldsTimeReference?g.fromTimeReference(p.dateFieldsTimeReference):null,H=A?"timeZone"in A?A.timeZone??h:A.dateFieldsTimeReference?
g.fromTimeReference(A.dateFieldsTimeReference):h??g.utc:null,S=q?"timeZone"in q?q.timeZone??h:q.timeReference?g.fromTimeReference(q.timeReference):h:null;F=new Map([[d(A?.creationDateField??""),H],[d(A?.editDateField??""),H],[d(F),S],[d(L),S]]);for(const {name:C,type:k}of p.fields)E.has(k)?f.set(C,g.unknown):"date"!==k&&"esriFieldTypeDate"!==k?f.set(C,null):b?f.set(C,g.unknown):(p=F.get(d(C??""))??h,f.set(C,p));return f}const x=new Map;class B{static fromJSON(p){return new B(p.fields,p.timeZoneByFieldName)}static fromLayer(p){return new B(p.fields??
[],m(p))}static fromLayerJSON(p){return new B(p.fields??[],m(p))}constructor(p=[],f){this._fieldsMap=new Map;this._normalizedFieldsMap=new Map;this._dateFieldsSet=new Set;this._numericFieldsSet=new Set;this._requiredFields=null;this.dateFields=[];this.numericFields=[];this.fields=p||[];this._timeZoneByFieldName=f?new Map(f):null;p=[];for(const b of this.fields){f=b?.name;const q=n.normalizeFieldName(f)?.toLowerCase()??"";if(f&&q){const A=d(f);this._fieldsMap.set(f,b);this._fieldsMap.set(A,b);this._normalizedFieldsMap.set(q,
b);p.push(`${A}:${b.type}:${this._timeZoneByFieldName?.get(f)}`);n.isDateField(b)?(this.dateFields.push(b),this._dateFieldsSet.add(b)):n.isNumericField(b)&&(this._numericFieldsSet.add(b),this.numericFields.push(b));n.isObjectIDField(b)||n.isGlobalIDField(b)||(b.editable=null==b.editable||!!b.editable,b.nullable=null==b.nullable||!!b.nullable)}}p.sort();this.uid=p.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const p of this.fields)n.isObjectIDField(p)||n.isGlobalIDField(p)||
p.nullable||void 0!==n.getFieldDefaultValue(p)||this._requiredFields.push(p)}return this._requiredFields}equals(p){return this.uid===p?.uid}has(p){return null!=this.get(p)}get(p){if(p){var f=this._fieldsMap.get(p);if(f)return f;(f=this._fieldsMap.get(d(p))??this._normalizedFieldsMap.get(n.normalizeFieldName(p)?.toLowerCase()??""))&&this._fieldsMap.set(p,f);return f}}getTimeZone(p){p=this.get(p&&"string"!==typeof p?p.name:p);return p?this._timeZoneByFieldName?this._timeZoneByFieldName.get(p.name):
"date"===p.type||"esriFieldTypeDate"===p.type?(w.getLogger("esri.layers.support.FieldsIndex").error(new a("getTimeZone:no-timezone-information",`no time zone information for field '${p.name}'`)),g.utc):E.has(p.type)?g.unknown:null:null}getLuxonTimeZone(p){const f=this.getTimeZone(p);return f?f===g.unknown?I.UnknownTimeZone.instance:f===g.utc?z.FixedOffsetZone.utcInstance:v.getOrCreateMapValue(x,f,()=>z.IANAZone.create(f)):null}isDateField(p){return this._dateFieldsSet.has(this.get(p))}isTimeOnlyField(p){return n.isTimeOnlyField(this.get(p))}isNumericField(p){return this._numericFieldsSet.has(this.get(p))}normalizeFieldName(p){return this.get(p)?.name??
void 0}toJSON(){return{fields:this.fields.map(p=>c.isSerializable(p)?p.toJSON():p),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}}const E=new Set("time-only date-only timestamp-offset esriFieldTypeDateOnly esriFieldTypeTimeOnly esriFieldTypeTimestampOffset".split(" "));return B})},"esri/views/support/Scheduler":function(){define("exports ../../core/Handles ../../core/has ../../core/Logger ../../core/maybe ../../core/PerformanceSampler ../../core/PooledArray ../../core/promiseUtils ../../core/reactiveUtils ../../core/signal ../../core/time ../../layers/support/PromiseQueue ./debugFlags ./RenderState".split(" "),
function(a,c,w,v,I,n,g,z,d,m,x,B,E,p){function f(y){return b.has(y)?b.get(y):"number"===typeof y?y:1}a.Task=void 0;(function(y){y[y.YIELD=1]="YIELD"})(a.Task||(a.Task={}));a.TaskPriority=void 0;(function(y){y.RESOURCE_CONTROLLER_IMMEDIATE="immediate";y.RESOURCE_CONTROLLER="schedule";y.SLIDE="slide";y.STREAM_DATA_LOADER="stream loader";y.ELEVATION_QUERY="elevation query";y.TERRAIN_SURFACE="terrain";y.SURFACE_GEOMETRY_UPDATES="surface geometry updates";y.LOD_RENDERER="LoD renderer";y.GRAPHICS_CORE=
"Graphics3D";y.I3S_CONTROLLER="I3S";y.POINT_CLOUD_LAYER="point cloud";y.FEATURE_TILE_FETCHER="feature fetcher";y.OVERLAY="overlay";y.STAGE="stage";y.GRAPHICS_DECONFLICTOR="graphics deconflictor";y.FILTER_VISIBILITY="Graphics3D filter visibility";y.SCALE_VISIBILITY="Graphics3D scale visibility";y.FRUSTUM_VISIBILITY="Graphics3D frustum visibility";y.POINT_OF_INTEREST_FREQUENT="POI frequent";y.POINT_OF_INTEREST_INFREQUENT="POI infrequent";y.LABELER="labeler";y.FEATURE_QUERY_ENGINE="feature query";y.FEATURE_TILE_TREE=
"feature tile tree";y.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree";y.ELEVATION_ALIGNMENT="elevation alignment";y.TEXT_TEXTURE_ATLAS="text texture atlas";y.TEXTURE_UNLOAD="texture unload";y.LINE_OF_SIGHT_TOOL="line of sight tool";y.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool";y.ELEVATION_PROFILE="elevation profile";y.SNAPPING="snapping";y.SHADOW_ACCUMULATOR="shadow accumulator";y.CLOUDS_GENERATOR="clouds generator";y[y.NONE=0]="NONE";y[y.TEST_PRIO=1]="TEST_PRIO"})(a.TaskPriority||
(a.TaskPriority={}));const b=new Map([[a.TaskPriority.RESOURCE_CONTROLLER_IMMEDIATE,0],[a.TaskPriority.RESOURCE_CONTROLLER,4],[a.TaskPriority.SLIDE,0],[a.TaskPriority.STREAM_DATA_LOADER,0],[a.TaskPriority.ELEVATION_QUERY,0],[a.TaskPriority.TERRAIN_SURFACE,1],[a.TaskPriority.SURFACE_GEOMETRY_UPDATES,1],[a.TaskPriority.LOD_RENDERER,2],[a.TaskPriority.GRAPHICS_CORE,2],[a.TaskPriority.I3S_CONTROLLER,2],[a.TaskPriority.POINT_CLOUD_LAYER,2],[a.TaskPriority.FEATURE_TILE_FETCHER,2],[a.TaskPriority.OVERLAY,
4],[a.TaskPriority.STAGE,4],[a.TaskPriority.GRAPHICS_DECONFLICTOR,4],[a.TaskPriority.FILTER_VISIBILITY,4],[a.TaskPriority.SCALE_VISIBILITY,4],[a.TaskPriority.FRUSTUM_VISIBILITY,4],[a.TaskPriority.CLOUDS_GENERATOR,4],[a.TaskPriority.POINT_OF_INTEREST_FREQUENT,6],[a.TaskPriority.POINT_OF_INTEREST_INFREQUENT,30],[a.TaskPriority.LABELER,8],[a.TaskPriority.FEATURE_QUERY_ENGINE,8],[a.TaskPriority.FEATURE_TILE_TREE,16],[a.TaskPriority.FEATURE_TILE_TREE_ACTIVE,0],[a.TaskPriority.ELEVATION_ALIGNMENT,12],[a.TaskPriority.TEXT_TEXTURE_ATLAS,
12],[a.TaskPriority.TEXTURE_UNLOAD,12],[a.TaskPriority.LINE_OF_SIGHT_TOOL,16],[a.TaskPriority.LINE_OF_SIGHT_TOOL_INTERACTIVE,0],[a.TaskPriority.SNAPPING,0],[a.TaskPriority.SHADOW_ACCUMULATOR,30]]),q=x.Milliseconds(6.5),A=x.Milliseconds(1),F=x.Milliseconds(30),L=x.Milliseconds(1E3/30),h=x.Milliseconds(100);var H;(function(y){class N{get updating(){return this._updating.value}_updatingChanged(){this._updating.value=this._tasks.some(u=>u.needsUpdate)}constructor(){this._updating=m.signal(!0);this._microTaskQueued=
!1;this._frameNumber=0;this.performanceInfo={total:new n("total"),tasks:new Map};this._frameTaskTimes=new Map;this._budget=new O;this._state=p.RenderState.INTERACTING;this._tasks=new g;this._runQueue=new g;this._load=0;this._idleStateCallbacks=new g;this._debug=this._forceTask=this._idleUpdatesStartFired=!1;this._debugHandle=d.watch(()=>E.SCHEDULER_LOG_SLOW_TASKS,D=>this._debug=D,d.initial);for(const D of Object.keys(a.TaskPriority))this.performanceInfo.tasks.set(a.TaskPriority[D],new n(a.TaskPriority[D]));
const u=this;this._test={FRAME_SAFETY_BUDGET:q,INTERACTING_BUDGET:L,IDLE_BUDGET:h,get availableBudget(){return u._budget.budget},usedBudget:0,getBudget:()=>u._budget,setBudget:D=>u._budget=D,updateTask:D=>this._updateTask(D),getState:D=>this._getState(D),getRuntime:D=>this._getRuntime(D),frameTaskTimes:this._frameTaskTimes,resetRuntimes:()=>this._resetRuntimes(),getRunning:()=>this._getRunning()}}destroy(){this._tasks.toArray().forEach(u=>u.remove());this._tasks.clear();I.removeMaybe(this._debugHandle);
this._microTaskQueued=!1;this._updatingChanged()}taskRunningChanged(u){this._updatingChanged();u&&0<this._budget.remaining&&!this._microTaskQueued&&(this._microTaskQueued=!0,queueMicrotask(()=>{this._microTaskQueued&&(this._microTaskQueued=!1,0<this._budget.remaining&&this._schedule()&&this.frame())}))}registerTask(u,D){const R=f(u);D=new l(this,u,D,R);this._tasks.push(D);this._updatingChanged();this.performanceInfo.tasks.has(u)||this.performanceInfo.tasks.set(u,new n(u));return D}registerIdleStateCallbacks(u,
D){const R={idleBegin:u,idleEnd:D};this._idleStateCallbacks.push(R);this.state===p.RenderState.IDLE&&this._idleUpdatesStartFired&&R.idleBegin();const Q=this;return{remove:()=>this._removeIdleStateCallbacks(R),set idleBegin(U){Q._idleUpdatesStartFired&&(R.idleEnd(),Q._state===p.RenderState.IDLE&&U());R.idleBegin=U},set idleEnd(U){R.idleEnd=U}}}get load(){return this._load}set state(u){this._state!==u&&(this._state=u,this.state!==p.RenderState.IDLE&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=
!1,this._idleStateCallbacks.forAll(D=>D.idleEnd())))}get state(){return this._state}updateBudget(u){this._test.usedBudget=0;++this._frameNumber;let D=q,R=u.frameDuration,Q=A;switch(this.state){case p.RenderState.IDLE:D=x.Milliseconds(0);R=x.Milliseconds(Math.max(h,u.frameDuration));Q=F;break;case p.RenderState.INTERACTING:R=x.Milliseconds(Math.max(L,u.frameDuration))}R=x.Milliseconds(R-u.elapsedFrameTime-D);if(this.state!==p.RenderState.IDLE&&R<A&&!this._forceTask)return this._forceTask=!0,!1;R=x.Milliseconds(Math.max(R,
Q));this._budget.reset(R,this.state);this._updateLoad();return this._schedule()}frame(){this._microTaskQueued=this._forceTask=!1;switch(this.state){case p.RenderState.IDLE:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll(u=>u.idleBegin()));this._runIdle();break;case p.RenderState.INTERACTING:this._runInteracting();break;default:this._runAnimating()}this._test.usedBudget=this._budget.elapsed}stopFrame(){this._budget.reset(x.Milliseconds(0),this._state);this._budget.madeProgress()}_removeIdleStateCallbacks(u){this._idleUpdatesStartFired&&
u.idleEnd();this._idleStateCallbacks.removeUnordered(u)}removeTask(u){this._tasks.removeUnordered(u);this._runQueue.removeUnordered(u);this._updatingChanged()}_updateTask(u){this._tasks.forAll(D=>{D.name===u&&D.setPriority(u)})}_getState(u){if(this._runQueue.some(R=>R.name===u))return a.TaskState.SCHEDULED;let D=a.TaskState.IDLE;this._tasks.forAll(R=>{R.name===u&&R.needsUpdate&&(1>=R.schedulePriority?D=a.TaskState.READY:D!==a.TaskState.READY&&(D=a.TaskState.WAITING))});return D}_getRuntime(u){let D=
0;this._tasks.forAll(R=>{R.name===u&&(D+=R.runtime)});return D}_resetRuntimes(){this._tasks.forAll(u=>u.runtime=0)}_getRunning(){const u=new Map;this._tasks.forAll(R=>{R.needsUpdate&&u.set(R.name,(u.get(R.name)||0)+1)});if(0===u.size)return null;let D="";u.forEach((R,Q)=>{D=1<R?D+` ${R}x ${Q}`:D+` ${Q}`});return D}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){const u=this._tasks.reduce((D,R)=>R.needsUpdate?++D:D,0);this._load=.9*this._load+u*(1-.9)}_schedule(){this._runQueue.filterInPlace(u=>
{if(u.needsUpdate)return!0;u.schedulePriority=u.basePriority;return!1});for(this._tasks.forAll(u=>{0===u.basePriority&&u.needsUpdate&&!this._runQueue.includes(u)&&u.blockFrame!==this._frameNumber&&this._runQueue.unshift(u)});0===this._runQueue.length;){let u=!1;this._tasks.forAll(D=>{if(D.needsUpdate&&0!==D.schedulePriority&&0!==D.basePriority&&D.blockFrame!==this._frameNumber)switch(u=!0,D.schedulePriority){case 1:D.schedulePriority=0;this._runQueue.push(D);break;default:--D.schedulePriority}});
if(!u)return this._updatingChanged(),!1}this._updatingChanged();return!0}_run(){const u=this._budget.now();this._startFrameTaskTimes();do for(;0<this._runQueue.length;){var D=this._budget.now();const R=this._runQueue.pop();this._budget.resetProgress();try{R.task.runTask(this._budget)===a.Task.YIELD&&(R.blockFrame=this._frameNumber)}catch(Q){v.getLogger("esri.views.support.Scheduler").error(`Exception in task "${R.name}"`,Q),R.blockFrame=this._frameNumber}!this._budget.hasProgressed&&R.blockFrame!==
this._frameNumber&&R.needsUpdate&&(R.blockFrame=this._frameNumber);R.schedulePriority=R.basePriority;D=this._budget.now()-D;R.runtime+=D;this._frameTaskTimes.set(R.priority,this._frameTaskTimes.get(R.priority)+D);this._debug&&D>2*this._budget.budget&&console.log("Task",R.name,"used",D,"of max",this._budget.budget,"ms");if(0>=this._budget.remaining){this._updatingChanged();this._recordFrameTaskTimes(this._budget.now()-u);return}}while(this._schedule());this._updatingChanged();this._recordFrameTaskTimes(this._budget.now()-
u)}_startFrameTaskTimes(){for(const u of Object.keys(a.TaskPriority))this._frameTaskTimes.set(a.TaskPriority[u],0)}_recordFrameTaskTimes(u){this._frameTaskTimes.forEach((D,R)=>this.performanceInfo.tasks.get(R).record(D));this.performanceInfo.total.record(u)}get test(){return this._test}}y.Scheduler=N;class l{get task(){return this._task.value}get updating(){return this._queue.running}constructor(u,D,R,Q){this._scheduler=u;this.name=D;this._basePriority=Q;this.runtime=this.blockFrame=0;this._queue=
new B.PromiseQueue;this._handles=new c;this.schedulePriority=this._basePriority;this._task=m.signal(null!=R?R:this._queue);this._handles.add(d.when(()=>this.task.running,U=>u.taskRunningChanged(U)))}remove(){this.processQueue(S);this._scheduler.removeTask(this);this.schedule=k.schedule;this.reschedule=k.reschedule;this._handles.destroy()}get basePriority(){return this._basePriority}setPriority(u){this.name=u;u=f(u);if(0===this._basePriority||0!==this.schedulePriority)this.schedulePriority=u;this._basePriority=
u}get priority(){return this.name}set priority(u){this.setPriority(u)}get needsUpdate(){return this.updating||this.task.running}schedule(u,D,R){return this._queue.push(u,D,R)}reschedule(u,D,R){return this._queue.unshift(u,D,R)}processQueue(u){this._queue.runTask(u)}}class O{constructor(){this._begin="undefined"!==typeof performance?performance.now():0;this._budget=0;this._state=p.RenderState.IDLE;this._progressed=this._done=!1;this._enabled=!0}run(u){if(this.done)return!1;!0===u()&&this.madeProgress();
return!0}get done(){return this._done}get budget(){return this._budget}madeProgress(){this._progressed=!0;return this._done=this.elapsed>=this._budget&&this._enabled}get state(){return this._state}get enabled(){return this._enabled}set enabled(u){this._enabled=u}reset(u,D){this._begin=this.now();this._budget=u;this._state=D;this.resetProgress()}get remaining(){return Math.max(this._budget-this.elapsed,0)}now(){return performance.now()}get elapsed(){return performance.now()-this._begin}resetProgress(){this._done=
this._progressed=!1}get hasProgressed(){return this._progressed}}y.Budget=O})(H||(H={}));a.TaskState=void 0;(function(y){y.SCHEDULED="s";y.READY="r";y.WAITING="w";y.IDLE="i"})(a.TaskState||(a.TaskState={}));const S=(()=>{const y=new H.Budget;y.enabled=!1;return y})();class C{remove(){}processQueue(){}schedule(y,N,l){try{if(z.isAborted(N)){const O=z.createAbortError();return l?Promise.resolve(l(O)):Promise.reject(O)}return z.when(y(S))}catch(O){return Promise.reject(O)}}reschedule(y,N,l){return this.schedule(y,
N,l)}}const k=new C;a.ImmediateTask=k;a.getTaskPriority=f;a.newScheduler=function(){return new H.Scheduler};a.noBudget=S;a.taskPriorities=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/signal":function(){define(["exports","./lang","./accessorSupport/tracking","./accessorSupport/tracking/SimpleObservable"],function(a,c,w,v){class I{constructor(n,g){this._observable=new v.SimpleObservable;this._value=n;this._equalityFunction=g}get value(){w.trackAccess(this._observable);
return this._value}set value(n){this._equalityFunction(n,this._value)||(this._value=n,this._observable.notify())}mutate(n){n(this._value);this._observable.notify()}}a.signal=function(n,g=c.equalsShallow){return new I(n,g)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/PromiseQueue":function(){define(["exports","../../core/promiseUtils","../../core/signal"],function(a,c,w){class v{constructor(){this._tasks=[];this._running=w.signal(!1)}get length(){return this._tasks.length}get running(){return this._running.value}destroy(){this.cancelAll()}runTask(n){for(;!n.done&&
this._process(n);)n.madeProgress()}push(n,g,z){this._running.value=!0;return new Promise((d,m)=>this._tasks.push(new I(d,m,n,g,z)))}unshift(n,g,z){this._running.value=!0;return new Promise((d,m)=>this._tasks.unshift(new I(d,m,n,g,z)))}_process(n){if(0===this._tasks.length)return!1;const g=this._tasks.shift();try{const z=c.isAborted(g.signal);if(z&&!g.abortCallback)g.reject(c.createAbortError());else{const d=z?g.abortCallback?.(c.createAbortError()):g.callback(n);c.isPromiseLike(d)?d.then(g.resolve,
g.reject):g.resolve(d)}}catch(z){g.reject(z)}this._running.value=0<this._tasks.length;return!0}cancelAll(){const n=c.createAbortError();for(const g of this._tasks)if(g.abortCallback){const z=g.abortCallback(n);g.resolve(z)}else g.reject(n);this._tasks.length=0;this._running.value=!1}}class I{constructor(n,g,z,d,m){this.resolve=n;this.reject=g;this.callback=z;this.signal=d;this.abortCallback=m}}a.PromiseQueue=v;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/debugFlags":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(a,c,w,v,I,n,g){c=class extends c{constructor(){super(...arguments);this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=this.SCHEDULER_LOG_SLOW_TASKS=!1}};a.__decorate([w.property()],c.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0);a.__decorate([w.property()],c.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0);c=a.__decorate([g.subclass("esri.views.support.DebugFlags")],c);return new c})},"esri/views/support/RenderState":function(){define(["exports"],function(a){a.RenderState=
void 0;var c=a.RenderState||(a.RenderState={});c[c.ANIMATING=0]="ANIMATING";c[c.INTERACTING=1]="INTERACTING";c[c.IDLE=2]="IDLE";Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/TileInfo":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/unitUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../geometry/Point ../../geometry/SpatialReference ../../geometry/support/aaBoundingRect ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ./LOD ./TileKey".split(" "),
function(a,c,w,v,I,n,g,z,d,m,x,B,E,p,f,b,q,A){var F;c=new c.JSONMap({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});w=F=class extends w.JSONSupport{static create(L={}){const {resolutionFactor:h=1,scales:H,size:S=256,spatialReference:C=E.WebMercator,numLODs:k=24}=L;if(!f.isValid(C)){L=[];if(H)for(var y=0;y<H.length;y++){var N=
H[y];L.push(new q({level:y,scale:N,resolution:N}))}else for(y=5E-4,N=k-1;0<=N;N--)L.unshift(new q({level:N,scale:y,resolution:y})),y*=2;return new F({dpi:96,lods:L,origin:new B(0,0,C),size:[S,S],spatialReference:C})}y=f.getInfo(C);L=L.origin?new B({x:L.origin.x,y:L.origin.y,spatialReference:C}):y?new B({x:y.origin[0],y:y.origin[1],spatialReference:C}):new B({x:0,y:0,spatialReference:C});y=1/(39.37*v.getMetersPerUnitForSR(C)*96);N=[];if(H)for(var l=0;l<H.length;l++){var O=H[l];N.push(new q({level:l,
scale:O,resolution:O*y}))}else{var u=f.isGeographic(C)?512/S*5.916575275917094E8:256/S*5.91657527591555E8;l=Math.ceil(k/h);N.push(new q({level:0,scale:u,resolution:u*y}));for(O=1;O<l;O++)u/=2**h,N.push(new q({level:O,scale:u,resolution:u*y}))}return new F({dpi:96,lods:N,origin:L,size:[S,S],spatialReference:C})}constructor(L){super(L);this.dpi=96;this.spatialReference=this.size=this.origin=this.format=null}get isWrappable(){const {spatialReference:L,origin:h}=this;if(L&&h){const H=f.getInfo(L);return L.isWrappable&&
!!H&&Math.abs(H.origin[0]-h.x)<=H.dx}return!1}readOrigin(L,h){return B.fromJSON({spatialReference:h.spatialReference,...L})}set lods(L){const h=[],H=this._levelToLOD={};L&&L.forEach(S=>{h.push(S.scale);H[S.level]=S});this._set("scales",h);this._set("lods",L);this._initializeUpsampleLevels()}readSize(L,h){return[h.cols,h.rows]}writeSize(L,h){h.cols=L[0];h.rows=L[1]}zoomToScale(L){const h=this.scales;if(0>=L)return h[0];if(L>=h.length-1)return h[h.length-1];const H=Math.floor(L);return h[H]/(h[H]/h[H+
1])**(L-H)}scaleToZoom(L){const h=this.scales,H=h.length-1;let S=0;for(;S<H;S++){const C=h[S],k=h[S+1];if(C<=L)break;if(k===L)return S+1;if(C>L&&k<L)return S+Math.log(C/L)/Math.log(C/k)}return S}snapScale(L,h=.95){L=this.scaleToZoom(L);return L%Math.floor(L)>=h?this.zoomToScale(Math.ceil(L)):this.zoomToScale(Math.floor(L))}tileAt(L,h,H,S){var C=this.lodAt(L);if(!C)return null;let k;if("number"===typeof h)k=h,h=H;else{if(f.equals(h.spatialReference,this.spatialReference))k=h.x,h=h.y;else{S=b.project(h,
this.spatialReference);if(null==S)return null;k=S.x;h=S.y}S=H}H=C.resolution*this.size[0];C=C.resolution*this.size[1];S||(S=new A.TileKey(null,0,0,0,p.create()));S.level=L;S.row=Math.floor((this.origin.y-h)/C+.001);S.col=Math.floor((k-this.origin.x)/H+.001);this.updateTileInfo(S);return S}updateTileInfo(L,h=F.ExtrapolateOptions.NONE){var H=this.lodAt(L.level);H||h!==F.ExtrapolateOptions.POWER_OF_TWO||(h=this.lods[this.lods.length-1],h.level<L.level&&(H=h));if(H){var S=L.level-H.level;h=H.resolution*
this.size[0]/2**S;H=H.resolution*this.size[1]/2**S;L.id=`${L.level}/${L.row}/${L.col}`;L.extent||(L.extent=p.create());L.extent[0]=this.origin.x+L.col*h;L.extent[1]=this.origin.y-(L.row+1)*H;L.extent[2]=L.extent[0]+h;L.extent[3]=L.extent[1]+H}}upsampleTile(L){const h=this._upsampleLevels[L.level];if(!h||-1===h.parentLevel)return!1;L.level=h.parentLevel;L.row=Math.floor(L.row/h.factor+.001);L.col=Math.floor(L.col/h.factor+.001);this.updateTileInfo(L);return!0}getTileBounds(L,h){var H=this.lodAt(h.level);
if(null==H)return null;var {resolution:S}=H;H=S*this.size[0];S*=this.size[1];L[0]=this.origin.x+h.col*H;L[1]=this.origin.y-(h.row+1)*S;L[2]=L[0]+H;L[3]=L[1]+S;return L}lodAt(L){return this._levelToLOD?.[L]??null}clone(){return F.fromJSON(this.write({}))}getOrCreateCompatible(L,h){if(256===this.size[0]&&256===this.size[1])return 256===L?this:null;const H=[],S=this.lods.length;for(let C=0;C<S;C++){const k=this.lods[C];H.push(new q({level:k.level,scale:k.scale,resolution:k.resolution*h}))}return new F({size:[L,
L],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin,spatialReference:this.spatialReference,lods:H})}_initializeUpsampleLevels(){const L=this.lods;this._upsampleLevels=[];let h=null;for(let H=0;H<L.length;H++){const S=L[H];this._upsampleLevels[S.level]={parentLevel:h?h.level:-1,factor:h?h.resolution/S.resolution:0};h=S}}};a.__decorate([I.property({type:Number,json:{write:!0}})],w.prototype,"compressionQuality",void 0);a.__decorate([I.property({type:Number,
json:{write:!0}})],w.prototype,"dpi",void 0);a.__decorate([I.property({type:String,json:{read:c.read,write:c.write,origins:{"web-scene":{read:!1,write:!1}}}})],w.prototype,"format",void 0);a.__decorate([I.property({readOnly:!0})],w.prototype,"isWrappable",null);a.__decorate([I.property({type:B,json:{write:!0}})],w.prototype,"origin",void 0);a.__decorate([d.reader("origin")],w.prototype,"readOrigin",null);a.__decorate([I.property({type:[q],value:null,json:{write:!0}})],w.prototype,"lods",null);a.__decorate([I.property({readOnly:!0})],
w.prototype,"scales",void 0);a.__decorate([I.property({cast:L=>Array.isArray(L)?L:"number"===typeof L?[L,L]:[256,256]})],w.prototype,"size",void 0);a.__decorate([d.reader("size",["rows","cols"])],w.prototype,"readSize",null);a.__decorate([x.writer("size",{cols:{type:n.Integer},rows:{type:n.Integer}})],w.prototype,"writeSize",null);a.__decorate([I.property({type:E,json:{write:!0}})],w.prototype,"spatialReference",void 0);w=F=a.__decorate([m.subclass("esri.layers.support.TileInfo")],w);(function(L){L=
L.ExtrapolateOptions||(L.ExtrapolateOptions={});L[L.NONE=0]="NONE";L[L.POWER_OF_TWO=1]="POWER_OF_TWO"})(w||(w={}));return w})},"esri/layers/support/LOD":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),function(a,c,w,v,I,n,g){var z;c=z=class extends c.JSONSupport{constructor(d){super(d);this.cols=null;this.level=
0;this.origin=this.levelValue=null;this.resolution=0;this.rows=null;this.scale=0}clone(){return new z({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})}};a.__decorate([w.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],c.prototype,"cols",void 0);a.__decorate([w.property({type:v.Integer,json:{write:!0}})],c.prototype,"level",void 0);a.__decorate([w.property({type:String,json:{write:!0}})],
c.prototype,"levelValue",void 0);a.__decorate([w.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],c.prototype,"origin",void 0);a.__decorate([w.property({type:Number,json:{write:!0}})],c.prototype,"resolution",void 0);a.__decorate([w.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],c.prototype,"rows",void 0);a.__decorate([w.property({type:Number,json:{write:!0}})],c.prototype,"scale",void 0);
return c=z=a.__decorate([g.subclass("esri.layers.support.LOD")],c)})},"esri/layers/support/TileKey":function(){define(["exports"],function(a){class c{constructor(w,v,I,n,g){this.id=w;this.level=v;this.row=I;this.col=n;this.extent=g}}a.TileKey=c;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/Query":function(){define("../../chunks/tslib.es6 ../../geometry ../../TimeExtent ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../core/accessorSupport/ensureType ../../geometry/support/jsonUtils ../../layers/support/source/DataLayerSource ./FullTextSearch ./QuantizationParameters ./StatisticDefinition ../../geometry/SpatialReference ../../geometry/Point".split(" "),
function(a,c,w,v,I,n,g,z,d,m,x,B,E,p,f,b,q,A,F){var L;const h=new v.JSONMap({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"});v=new v.JSONMap({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",
esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let H=L=class extends I.JSONSupport{static from(S){return B.ensureClass(L,S)}constructor(S){super(S);this.aggregateIds=null;this.cacheHint=void 0;this.compactGeometryEnabled=!1;this.datumTransformation=null;this.defaultSpatialReferenceEnabled=!1;this.dynamicDataSource=this.distance=void 0;this.geometry=this.gdbVersion=this.fullText=this.formatOf3DObjects=null;
this.geometryPrecision=void 0;this.historicMoment=this.having=this.groupByFieldsForStatistics=null;this.maxAllowableOffset=void 0;this.maxRecordCountFactor=1;this.multipatchOption=null;this.num=void 0;this.resultType=this.relationParameter=this.rangeValues=this.quantizationParameters=this.pixelSize=this.parameterValues=this.outStatistics=this.outSpatialReference=this.outFields=this.orderByFields=this.objectIds=null;this.returnDistinctValues=this.returnCentroid=!1;this.returnExceededLimitFeatures=
!0;this.returnQueryGeometry=this.returnGeometry=!1;this.returnZ=this.returnM=void 0;this.sourceSpatialReference=null;this.spatialRelationship="intersects";this.start=void 0;this.timeExtent=this.text=this.sqlFormat=null;this.timeReferenceUnknownClient=!1;this.where=this.units=null}castDatumTransformation(S){return"number"===typeof S||"object"===typeof S?S:null}writeHistoricMoment(S,C){C.historicMoment=S&&S.getTime()}writeParameterValues(S,C){if(S){const k={};for(const y in S){const N=S[y];Array.isArray(N)?
k[y]=N.map(l=>l instanceof Date?l.getTime():l):k[y]=N instanceof Date?N.getTime():N}C.parameterValues=k}}writeStart(S,C){C.resultOffset=this.start;C.resultRecordCount=this.num||10;C.where="1\x3d1"}writeWhere(S,C){C.where=S||"1\x3d1"}clone(){return new L(n.clone({aggregateIds:this.aggregateIds,cacheHint:this.cacheHint,compactGeometryEnabled:this.compactGeometryEnabled,datumTransformation:this.datumTransformation,defaultSpatialReferenceEnabled:this.defaultSpatialReferenceEnabled,distance:this.distance,
fullText:this.fullText,formatOf3DObjects:this.formatOf3DObjects,gdbVersion:this.gdbVersion,geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,having:this.having,historicMoment:null!=this.historicMoment?new Date(this.historicMoment.getTime()):null,maxAllowableOffset:this.maxAllowableOffset,maxRecordCountFactor:this.maxRecordCountFactor,multipatchOption:this.multipatchOption,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,
outFields:this.outFields,outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,parameterValues:this.parameterValues,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,rangeValues:this.rangeValues,relationParameter:this.relationParameter,resultType:this.resultType,returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnQueryGeometry:this.returnQueryGeometry,
returnM:this.returnM,returnZ:this.returnZ,dynamicDataSource:this.dynamicDataSource,sourceSpatialReference:this.sourceSpatialReference,spatialRelationship:this.spatialRelationship,start:this.start,sqlFormat:this.sqlFormat,text:this.text,timeExtent:this.timeExtent,timeReferenceUnknownClient:this.timeReferenceUnknownClient,units:this.units,where:this.where}))}};H.MAX_MAX_RECORD_COUNT_FACTOR=5;a.__decorate([g.property({json:{write:!0}})],H.prototype,"aggregateIds",void 0);a.__decorate([g.property({type:Boolean,
json:{write:!0}})],H.prototype,"cacheHint",void 0);a.__decorate([g.property({type:Boolean,json:{default:!1,write:!0}})],H.prototype,"compactGeometryEnabled",void 0);a.__decorate([g.property({json:{write:!0}})],H.prototype,"datumTransformation",void 0);a.__decorate([z.cast("datumTransformation")],H.prototype,"castDatumTransformation",null);a.__decorate([g.property({type:Boolean,json:{default:!1,write:!0}})],H.prototype,"defaultSpatialReferenceEnabled",void 0);a.__decorate([g.property({type:Number,
json:{write:{overridePolicy(S){return{enabled:0<S}}}}})],H.prototype,"distance",void 0);a.__decorate([g.property({type:p.DataLayerSource,json:{write:!0}})],H.prototype,"dynamicDataSource",void 0);a.__decorate([g.property({type:String,json:{write:!0}})],H.prototype,"formatOf3DObjects",void 0);a.__decorate([g.property({type:[f],json:{write:{enabled:!0,overridePolicy(){return{enabled:null!=this.fullText&&0<this.fullText.length}}}}})],H.prototype,"fullText",void 0);a.__decorate([g.property({type:String,
json:{write:!0}})],H.prototype,"gdbVersion",void 0);a.__decorate([g.property({types:c.geometryTypes,json:{read:E.fromJSON,write:!0}})],H.prototype,"geometry",void 0);a.__decorate([g.property({type:Number,json:{write:!0}})],H.prototype,"geometryPrecision",void 0);a.__decorate([g.property({type:[String],json:{write:!0}})],H.prototype,"groupByFieldsForStatistics",void 0);a.__decorate([g.property({type:String,json:{write:!0}})],H.prototype,"having",void 0);a.__decorate([g.property({type:Date})],H.prototype,
"historicMoment",void 0);a.__decorate([x.writer("historicMoment")],H.prototype,"writeHistoricMoment",null);a.__decorate([g.property({type:Number,json:{write:!0}})],H.prototype,"maxAllowableOffset",void 0);a.__decorate([g.property({type:Number,cast(S){return 1>S?1:S>H.MAX_MAX_RECORD_COUNT_FACTOR?H.MAX_MAX_RECORD_COUNT_FACTOR:S},json:{write:{overridePolicy(S){return{enabled:1<S}}}}})],H.prototype,"maxRecordCountFactor",void 0);a.__decorate([g.property({type:["xyFootprint"],json:{write:!0}})],H.prototype,
"multipatchOption",void 0);a.__decorate([g.property({type:Number,json:{read:{source:"resultRecordCount"}}})],H.prototype,"num",void 0);a.__decorate([g.property({json:{write:!0}})],H.prototype,"objectIds",void 0);a.__decorate([g.property({type:[String],json:{write:!0}})],H.prototype,"orderByFields",void 0);a.__decorate([g.property({type:[String],json:{write:!0}})],H.prototype,"outFields",void 0);a.__decorate([g.property({type:A,json:{name:"outSR",write:!0}})],H.prototype,"outSpatialReference",void 0);
a.__decorate([g.property({type:[q],json:{write:{enabled:!0,overridePolicy(){return{enabled:null!=this.outStatistics&&0<this.outStatistics.length}}}}})],H.prototype,"outStatistics",void 0);a.__decorate([g.property({json:{write:!0}})],H.prototype,"parameterValues",void 0);a.__decorate([x.writer("parameterValues")],H.prototype,"writeParameterValues",null);a.__decorate([g.property({type:F,json:{write:!0}})],H.prototype,"pixelSize",void 0);a.__decorate([g.property({type:b,json:{write:!0}})],H.prototype,
"quantizationParameters",void 0);a.__decorate([g.property({type:[Object],json:{write:!0}})],H.prototype,"rangeValues",void 0);a.__decorate([g.property({type:String,json:{read:{source:"relationParam"},write:{target:"relationParam",overridePolicy(){return{enabled:"relation"===this.spatialRelationship}}}}})],H.prototype,"relationParameter",void 0);a.__decorate([g.property({type:String,json:{write:!0}})],H.prototype,"resultType",void 0);a.__decorate([g.property({type:Boolean,json:{default:!1,write:!0}})],
H.prototype,"returnCentroid",void 0);a.__decorate([g.property({type:Boolean,json:{default:!1,write:!0}})],H.prototype,"returnDistinctValues",void 0);a.__decorate([g.property({type:Boolean,json:{default:!0,write:!0}})],H.prototype,"returnExceededLimitFeatures",void 0);a.__decorate([g.property({type:Boolean,json:{write:!0}})],H.prototype,"returnGeometry",void 0);a.__decorate([g.property({type:Boolean,json:{default:!1,write:!0}})],H.prototype,"returnQueryGeometry",void 0);a.__decorate([g.property({type:Boolean,
json:{default:!1,write:!0}})],H.prototype,"returnM",void 0);a.__decorate([g.property({type:Boolean,json:{write:{overridePolicy(S){return{enabled:S}}}}})],H.prototype,"returnZ",void 0);a.__decorate([g.property({type:A,json:{write:!0}})],H.prototype,"sourceSpatialReference",void 0);a.__decorate([d.enumeration(h,{ignoreUnknown:!1,name:"spatialRel"})],H.prototype,"spatialRelationship",void 0);a.__decorate([g.property({type:Number,json:{read:{source:"resultOffset"}}})],H.prototype,"start",void 0);a.__decorate([x.writer("start"),
x.writer("num")],H.prototype,"writeStart",null);a.__decorate([g.property({type:String,json:{write:!0}})],H.prototype,"sqlFormat",void 0);a.__decorate([g.property({type:String,json:{write:!0}})],H.prototype,"text",void 0);a.__decorate([g.property({type:w,json:{write:!0}})],H.prototype,"timeExtent",void 0);a.__decorate([g.property({type:Boolean,json:{default:!1,write:!0}})],H.prototype,"timeReferenceUnknownClient",void 0);a.__decorate([d.enumeration(v,{ignoreUnknown:!1}),g.property({json:{write:{overridePolicy(S){return{enabled:!!S&&
null!=this.distance&&0<this.distance}}}}})],H.prototype,"units",void 0);a.__decorate([g.property({type:String,json:{write:{overridePolicy(S){return{enabled:null!=S||null!=this.start&&0<this.start}}}}})],H.prototype,"where",void 0);a.__decorate([x.writer("where")],H.prototype,"writeWhere",null);return H=L=a.__decorate([m.subclass("esri.rest.support.Query")],H)})},"esri/TimeExtent":function(){define("./chunks/tslib.es6 ./core/JSONSupport ./core/timeUtils ./core/accessorSupport/decorators/property ./core/accessorSupport/ensureType ./core/arrayUtils ./core/has ./core/accessorSupport/decorators/reader ./core/accessorSupport/decorators/subclass ./core/accessorSupport/decorators/writer ./time/timeZoneUtils".split(" "),
function(a,c,w,v,I,n,g,z,d,m,x){var B;c=B=class extends c.JSONSupport{static get allTime(){return E}static get empty(){return p}constructor(f){super(f);this.start=this.end=null}readEnd(f,b){return null!=b.end?new Date(b.end):null}writeEnd(f,b){b.end=f?.getTime()??null}get isAllTime(){return this.equals(B.allTime)}get isEmpty(){return this.equals(B.empty)}readStart(f,b){return null!=b.start?new Date(b.start):null}writeStart(f,b){b.start=f?.getTime()??null}clone(){return new B({end:this.end,start:this.start})}equals(f){if(!f)return!1;
const b=this.start?.getTime()??this.start,q=this.end?.getTime()??this.end,A=f.start?.getTime()??f.start;f=f.end?.getTime()??f.end;return b===A&&q===f}expandTo(f,b=x.system){if(this.isEmpty||this.isAllTime)return this.clone();let q=this.start;q&&(q=w.truncateDate(q,f,b));let A=this.end;if(A){const F=w.truncateDate(A,f,b);A=A.getTime()===F.getTime()?F:w.offsetDate(F,1,f,b)}return new B({start:q,end:A})}intersection(f){if(!f)return this.clone();if(this.isEmpty||f.isEmpty)return B.empty;if(this.isAllTime)return f.clone();
if(f.isAllTime)return this.clone();var b=this.start?.getTime()??-Infinity;const q=this.end?.getTime()??Infinity,A=f.start?.getTime()??-Infinity;f=f.end?.getTime()??Infinity;let F,L;A>=b&&A<=q?F=A:b>=A&&b<=f&&(F=b);q>=A&&q<=f?L=q:f>=b&&f<=q&&(L=f);return null==F||null==L||isNaN(F)||isNaN(L)?B.empty:(b=new B,b.start=-Infinity===F?null:new Date(F),b.end=Infinity===L?null:new Date(L),b)}offset(f,b,q=x.system){if(this.isEmpty||this.isAllTime)return this.clone();const A=new B,{start:F,end:L}=this;null!=
F&&(A.start=w.offsetDate(F,f,b,q));null!=L&&(A.end=w.offsetDate(L,f,b,q));return A}union(f){if(!f||f.isEmpty)return this.clone();if(this.isEmpty)return f.clone();if(this.isAllTime||f.isAllTime)return E.clone();const b=null!=this.start&&null!=f.start?new Date(Math.min(this.start.getTime(),f.start.getTime())):null;f=null!=this.end&&null!=f.end?new Date(Math.max(this.end.getTime(),f.end.getTime())):null;return new B({start:b,end:f})}};a.__decorate([v.property({type:Date,json:{write:{allowNull:!0}}})],
c.prototype,"end",void 0);a.__decorate([z.reader("end")],c.prototype,"readEnd",null);a.__decorate([m.writer("end")],c.prototype,"writeEnd",null);a.__decorate([v.property({readOnly:!0,json:{read:!1}})],c.prototype,"isAllTime",null);a.__decorate([v.property({readOnly:!0,json:{read:!1}})],c.prototype,"isEmpty",null);a.__decorate([v.property({type:Date,json:{write:{allowNull:!0}}})],c.prototype,"start",void 0);a.__decorate([z.reader("start")],c.prototype,"readStart",null);a.__decorate([m.writer("start")],
c.prototype,"writeStart",null);c=B=a.__decorate([d.subclass("esri.TimeExtent")],c);const E=new c,p=new c({start:void 0,end:void 0});return c})},"esri/layers/support/source/DataLayerSource":function(){define("exports ../../../chunks/tslib.es6 ../../../core/jsonMap ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/cast ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/extensions/serializableProperty/reader ../Field ./MapLayerSource ./QueryTableDataSource ./RasterDataSource ./TableDataSource".split(" "),
function(a,c,w,v,I,n,g,z,d,m,x,B,E,p,f,b){function q(){h||(h=x.createTypeReader({types:A()}));return h}function A(){H||(H={key:"type",base:null,typeMap:{"data-layer":a.DataLayerSource,"map-layer":E.MapLayerSource}});return H}var F,L;w=w.strict()({esriLeftInnerJoin:"left-inner-join",esriLeftOuterJoin:"left-outer-join"});a.JoinTableDataSource=F=class extends v.JSONSupport{constructor(S){super(S);this.type="join-table"}readLeftTableSource(S,C,k){return q()(S,C,k)}castLeftTableSource(S){return m.ensureOneOfType(A(),
S)}readRightTableSource(S,C,k){return q()(S,C,k)}castRightTableSource(S){return m.ensureOneOfType(A(),S)}clone(){const {leftTableKey:S,rightTableKey:C,leftTableSource:k,rightTableSource:y,joinType:N}=this,l={leftTableKey:S,rightTableKey:C,leftTableSource:k?.clone()??void 0,rightTableSource:y?.clone()??void 0,joinType:N};return new F(l)}};c.__decorate([g.enumeration({joinTable:"join-table"})],a.JoinTableDataSource.prototype,"type",void 0);c.__decorate([I.property({type:String,json:{write:!0}})],a.JoinTableDataSource.prototype,
"leftTableKey",void 0);c.__decorate([I.property({type:String,json:{write:!0}})],a.JoinTableDataSource.prototype,"rightTableKey",void 0);c.__decorate([I.property({json:{write:!0}})],a.JoinTableDataSource.prototype,"leftTableSource",void 0);c.__decorate([z.reader("leftTableSource")],a.JoinTableDataSource.prototype,"readLeftTableSource",null);c.__decorate([n.cast("leftTableSource")],a.JoinTableDataSource.prototype,"castLeftTableSource",null);c.__decorate([I.property({json:{write:!0}})],a.JoinTableDataSource.prototype,
"rightTableSource",void 0);c.__decorate([z.reader("rightTableSource")],a.JoinTableDataSource.prototype,"readRightTableSource",null);c.__decorate([n.cast("rightTableSource")],a.JoinTableDataSource.prototype,"castRightTableSource",null);c.__decorate([g.enumeration(w)],a.JoinTableDataSource.prototype,"joinType",void 0);a.JoinTableDataSource=F=c.__decorate([d.subclass("esri.layers.support.source.JoinTableDataSource")],a.JoinTableDataSource);let h=null,H=null;n={key:"type",base:null,typeMap:{"join-table":a.JoinTableDataSource,
"query-table":p.QueryTableDataSource,raster:f.RasterDataSource,table:b.TableDataSource}};a.DataLayerSource=L=class extends v.JSONSupport{constructor(S){super(S);this.type="data-layer"}clone(){const {fields:S,dataSource:C}=this;return new L({fields:S,dataSource:C})}};c.__decorate([g.enumeration({dataLayer:"data-layer"})],a.DataLayerSource.prototype,"type",void 0);c.__decorate([I.property({type:[B],json:{write:!0}})],a.DataLayerSource.prototype,"fields",void 0);c.__decorate([I.property({types:n,json:{write:!0}})],
a.DataLayerSource.prototype,"dataSource",void 0);a.DataLayerSource=L=c.__decorate([d.subclass("esri.layers.support.source.DataLayerSource")],a.DataLayerSource);a.DataLayerSource.from=m.ensureType(a.DataLayerSource);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/Field":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ./domains ./fieldType".split(" "),
function(a,c,w,v,I,n,g,z,d,m,x,B){var E;const p=new c.JSONMap({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});c=E=class extends w.JSONSupport{constructor(f){super(f);
this.alias=null;this.defaultValue=void 0;this.domain=this.description=null;this.editable=!0;this.length=void 0;this.name=null;this.nullable=!0;this.valueType=this.type=null;this.visible=!0}readDescription(f,{description:b}){f=null;try{f=b?JSON.parse(b):null}catch(q){}return f?.value??null}readValueType(f,{description:b}){f=null;try{f=b?JSON.parse(b):null}catch(q){}return f?p.fromJSON(f.fieldValueType):null}clone(){return new E({alias:this.alias,defaultValue:this.defaultValue,description:this.description,
domain:this.domain&&this.domain.clone()||null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType,visible:this.visible})}};a.__decorate([v.property({type:String,json:{write:!0}})],c.prototype,"alias",void 0);a.__decorate([v.property({type:[String,Number],json:{write:{allowNull:!0}}})],c.prototype,"defaultValue",void 0);a.__decorate([v.property()],c.prototype,"description",void 0);a.__decorate([d.reader("description")],c.prototype,
"readDescription",null);a.__decorate([v.property({types:x.types,json:{read:{reader:x.fromJSON},write:!0}})],c.prototype,"domain",void 0);a.__decorate([v.property({type:Boolean,json:{write:!0}})],c.prototype,"editable",void 0);a.__decorate([v.property({type:I.Integer,json:{write:{overridePolicy(f){return{enabled:Number.isFinite(f)}}}}})],c.prototype,"length",void 0);a.__decorate([v.property({type:String,json:{write:!0}})],c.prototype,"name",void 0);a.__decorate([v.property({type:Boolean,json:{write:!0}})],
c.prototype,"nullable",void 0);a.__decorate([z.enumeration(B.kebabDict)],c.prototype,"type",void 0);a.__decorate([v.property()],c.prototype,"valueType",void 0);a.__decorate([d.reader("valueType",["description"])],c.prototype,"readValueType",null);a.__decorate([v.property({type:Boolean,json:{read:!1}})],c.prototype,"visible",void 0);return c=E=a.__decorate([m.subclass("esri.layers.support.Field")],c)})},"esri/layers/support/domains":function(){define("exports ../../core/has ./CodedValueDomain ./Domain ./InheritedDomain ./RangeDomain".split(" "),
function(a,c,w,v,I,n){c={key:"type",base:v,typeMap:{range:n,"coded-value":w,inherited:I}};a.CodedValueDomain=w;a.DomainBase=v;a.InheritedDomain=I;a.RangeDomain=n;a.fromJSON=function(g){if(!g?.type)return null;switch(g.type){case "range":return n.fromJSON(g);case "codedValue":return w.fromJSON(g);case "inherited":return I.fromJSON(g)}return null};a.types=c;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/CodedValueDomain":function(){define("../../chunks/tslib.es6 ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./CodedValue ./Domain".split(" "),
function(a,c,w,v,I,n,g,z){var d;v=d=class extends z{constructor(m){super(m);this.codedValues=null;this.type="coded-value"}getName(m){let x=null;if(this.codedValues){const B=String(m);this.codedValues.some(E=>{String(E.code)===B&&(x=E.name);return!!x})}return x}clone(){return new d({codedValues:c.clone(this.codedValues),name:this.name})}};a.__decorate([w.property({type:[g.CodedValue],json:{write:!0}})],v.prototype,"codedValues",void 0);a.__decorate([I.enumeration({codedValue:"coded-value"})],v.prototype,
"type",void 0);return v=d=a.__decorate([n.subclass("esri.layers.support.CodedValueDomain")],v)})},"esri/layers/support/CodedValue":function(){define("exports ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),function(a,c,w,v,I,n,g,z){var d;a.CodedValue=d=class extends w.JSONSupport{constructor(m){super(m);this.code=this.name=
null}clone(){return new d({name:this.name,code:this.code})}};c.__decorate([v.property({type:String,json:{write:!0}})],a.CodedValue.prototype,"name",void 0);c.__decorate([v.property({type:[String,Number],json:{write:!0}})],a.CodedValue.prototype,"code",void 0);a.CodedValue=d=c.__decorate([z.subclass("esri.layers.support.CodedValue")],a.CodedValue);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/Domain":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),
function(a,c,w,v,I,n,g,z,d){c=new c.JSONMap({inherited:"inherited",codedValue:"coded-value",range:"range"});w=class extends w.JSONSupport{constructor(m){super(m);this.type=this.name=null}};a.__decorate([v.property({type:String,json:{write:!0}})],w.prototype,"name",void 0);a.__decorate([z.enumeration(c)],w.prototype,"type",void 0);return w=a.__decorate([d.subclass("esri.layers.support.Domain")],w)})},"esri/layers/support/InheritedDomain":function(){define("../../chunks/tslib.es6 ../../core/Logger ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/Error ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./Domain".split(" "),
function(a,c,w,v,I,n,g,z,d){var m;c=m=class extends d{constructor(x){super(x);this.type="inherited"}clone(){return new m}};a.__decorate([g.enumeration({inherited:"inherited"})],c.prototype,"type",void 0);return c=m=a.__decorate([z.subclass("esri.layers.support.InheritedDomain")],c)})},"esri/layers/support/RangeDomain":function(){define("../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./Domain".split(" "),
function(a,c,w,v,I,n,g,z){var d;w=d=class extends z{constructor(m){super(m);this.minValue=this.maxValue=null;this.type="range"}clone(){return new d({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}};a.__decorate([c.property({json:{type:[Number],read:{source:"range",reader(m,x){return x.range?.[1]}},write:{enabled:!1,overridePolicy(){return{enabled:null!=this.maxValue&&null==this.minValue}},target:"range",writer(m,x,B){x[B]=[this.minValue||0,m]}}}})],w.prototype,"maxValue",void 0);a.__decorate([c.property({json:{type:[Number],
read:{source:"range",reader(m,x){return x.range?.[0]}},write:{target:"range",writer(m,x,B){x[B]=[m,this.maxValue||0]}}}})],w.prototype,"minValue",void 0);a.__decorate([n.enumeration({range:"range"})],w.prototype,"type",void 0);return w=d=a.__decorate([g.subclass("esri.layers.support.RangeDomain")],w)})},"esri/layers/support/source/MapLayerSource":function(){define("exports ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,c,w,v,I,n,g,z,d){var m;a.MapLayerSource=m=class extends w.JSONSupport{constructor(x){super(x);this.type="map-layer"}clone(){const {mapLayerId:x,gdbVersion:B}=this;return new m({mapLayerId:x,gdbVersion:B})}};c.__decorate([z.enumeration({mapLayer:"map-layer"})],a.MapLayerSource.prototype,"type",void 0);c.__decorate([v.property({type:I.Integer,json:{write:!0}})],a.MapLayerSource.prototype,"mapLayerId",void 0);c.__decorate([v.property({type:String,json:{write:!0}})],a.MapLayerSource.prototype,
"gdbVersion",void 0);a.MapLayerSource=m=c.__decorate([d.subclass("esri.layers.support.source.MapLayerSource")],a.MapLayerSource);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/source/QueryTableDataSource":function(){define("exports ../../../chunks/tslib.es6 ../../../geometry ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ../../../geometry/SpatialReference ../../../geometry/support/typeUtils".split(" "),
function(a,c,w,v,I,n,g,z,d,m,x,B){var E;a.QueryTableDataSource=E=class extends v.JSONSupport{constructor(p){super(p);this.type="query-table"}clone(){const {workspaceId:p,query:f,oidFields:b,spatialReference:q,geometryType:A}=this,F={workspaceId:p,query:f,oidFields:b,spatialReference:q?.clone()??void 0,geometryType:A};return new E(F)}};c.__decorate([d.enumeration({queryTable:"query-table"})],a.QueryTableDataSource.prototype,"type",void 0);c.__decorate([I.property({type:String,json:{write:!0}})],a.QueryTableDataSource.prototype,
"workspaceId",void 0);c.__decorate([I.property({type:String,json:{write:!0}})],a.QueryTableDataSource.prototype,"query",void 0);c.__decorate([I.property({type:String,json:{write:!0}})],a.QueryTableDataSource.prototype,"oidFields",void 0);c.__decorate([I.property({type:x,json:{write:!0}})],a.QueryTableDataSource.prototype,"spatialReference",void 0);c.__decorate([d.enumeration(B.featureGeometryTypeKebabDictionary)],a.QueryTableDataSource.prototype,"geometryType",void 0);a.QueryTableDataSource=E=c.__decorate([m.subclass("esri.layers.support.source.QueryTableDataSource")],
a.QueryTableDataSource);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/source/RasterDataSource":function(){define("exports ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass".split(" "),function(a,c,w,v,I,n,g,z,d){var m;a.RasterDataSource=
m=class extends w.JSONSupport{constructor(x){super(x);this.type="raster"}clone(){const {workspaceId:x,dataSourceName:B}=this;return new m({workspaceId:x,dataSourceName:B})}};c.__decorate([z.enumeration({raster:"raster"})],a.RasterDataSource.prototype,"type",void 0);c.__decorate([v.property({type:String,json:{write:!0}})],a.RasterDataSource.prototype,"dataSourceName",void 0);c.__decorate([v.property({type:String,json:{write:!0}})],a.RasterDataSource.prototype,"workspaceId",void 0);a.RasterDataSource=
m=c.__decorate([d.subclass("esri.layers.support.source.RasterDataSource")],a.RasterDataSource);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/source/TableDataSource":function(){define("exports ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,c,w,v,I,n,g,z,d){var m;a.TableDataSource=m=class extends w.JSONSupport{constructor(x){super(x);this.type="table"}clone(){const {workspaceId:x,gdbVersion:B,dataSourceName:E}=this;return new m({workspaceId:x,gdbVersion:B,dataSourceName:E})}};c.__decorate([z.enumeration({table:"table"})],a.TableDataSource.prototype,"type",void 0);c.__decorate([v.property({type:String,json:{write:!0}})],a.TableDataSource.prototype,"workspaceId",void 0);c.__decorate([v.property({type:String,json:{write:!0}})],
a.TableDataSource.prototype,"gdbVersion",void 0);c.__decorate([v.property({type:String,json:{write:!0}})],a.TableDataSource.prototype,"dataSourceName",void 0);a.TableDataSource=m=c.__decorate([d.subclass("esri.layers.support.source.TableDataSource")],a.TableDataSource);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/FullTextSearch":function(){define("../../chunks/tslib.es6 ../../core/Clonable ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(a,c,w,v,I,n,g,z){c=class extends c.ClonableMixin(w.JSONSupport){constructor(d){super(d);this.searchType=this.searchTerm=this.operator=this.onFields=null}};a.__decorate([v.property({type:[String],json:{write:{enabled:!0,overridePolicy(){return{enabled:null!=this.onFields&&0<this.onFields.length}}}}})],c.prototype,"onFields",void 0);a.__decorate([v.property({type:String,json:{write:!0}})],c.prototype,"operator",void 0);a.__decorate([v.property({type:String,json:{write:!0}})],c.prototype,"searchTerm",
void 0);a.__decorate([v.property({type:String,json:{write:!0}})],c.prototype,"searchType",void 0);return c=a.__decorate([z.subclass("esri.rest.support.FullTextSearch")],c)})},"esri/core/Clonable":function(){define("exports ../chunks/tslib.es6 ./Accessor ./has ./lang ./Logger ./maybe ./accessorSupport/PropertyOrigin ./accessorSupport/utils ./accessorSupport/decorators/subclass".split(" "),function(a,c,w,v,I,n,g,z,d,m){v=x=>{x=class extends x{clone(){var B=d.getProperties(this);g.assertIsSome(B,"unable to clone instance of non-accessor class");
var E=B.metadatas;const p=B.store,f={};B=new Map;for(var b in E){var q=E[b];const A=p?.originOf(b),F=q.clonable;if(q.readOnly||!1===F||A!==z.OriginId.USER&&A!==z.OriginId.DEFAULTS&&A!==z.OriginId.WEB_MAP&&A!==z.OriginId.WEB_SCENE)continue;q=this[b];let L=null;L="function"===typeof F?F(q):"reference"===F?q:I.tryClone(q);if(null==q||null!=L)A===z.OriginId.DEFAULTS?B.set(b,L):f[b]=L}E=new (Object.getPrototypeOf(this).constructor)(f);if(B.size&&(b=d.getProperties(E)?.store))for(const [A,F]of B)b.set(A,
F,z.OriginId.DEFAULTS);return E}};return x=c.__decorate([m.subclass("esri.core.Clonable")],x)};a.Clonable=class extends v(w){};a.Clonable=c.__decorate([m.subclass("esri.core.Clonable")],a.Clonable);a.ClonableMixin=v;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/QuantizationParameters":function(){define("../../chunks/tslib.es6 ../../geometry ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../geometry/Extent".split(" "),
function(a,c,w,v,I,n,g,z,d){var m;c=new w.JSONMap({upperLeft:"upper-left",lowerLeft:"lower-left"});v=m=class extends v.JSONSupport{constructor(x){super(x);this.extent=null;this.mode="view";this.originPosition="upper-left";this.tolerance=1}clone(){return new m(I.clone({extent:this.extent,mode:this.mode,originPosition:this.originPosition,tolerance:this.tolerance}))}};a.__decorate([n.property({type:d,json:{write:{overridePolicy(){return{enabled:"view"===this.mode}}}}})],v.prototype,"extent",void 0);
a.__decorate([n.property({type:["view","edit"],json:{write:!0}})],v.prototype,"mode",void 0);a.__decorate([n.property({type:String,json:{read:c.read,write:c.write}})],v.prototype,"originPosition",void 0);a.__decorate([n.property({type:Number,json:{write:{overridePolicy(){return{enabled:"view"===this.mode}}}}})],v.prototype,"tolerance",void 0);return v=m=a.__decorate([z.subclass("esri.rest.support.QuantizationParameters")],v)})},"esri/rest/support/StatisticDefinition":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer".split(" "),
function(a,c,w,v,I,n,g,z){var d;c=new c.JSONMap({count:"count",sum:"sum",min:"min",max:"max",avg:"avg",stddev:"stddev",var:"var",exceedslimit:"exceedslimit",percentile_cont:"percentile-continuous",percentile_disc:"percentile-discrete",EnvelopeAggregate:"envelope-aggregate",CentroidAggregate:"centroid-aggregate",ConvexHullAggregate:"convex-hull-aggregate"});w=d=class extends w.JSONSupport{constructor(m){super(m);this.maxVertexCount=this.maxRecordCount=this.maxPointCount=void 0;this.statisticParameters=
this.statisticType=this.outStatisticFieldName=this.onStatisticField=null}writeStatisticParameters(m,x){if("percentile-continuous"===this.statisticType||"percentile-discrete"===this.statisticType)x.statisticParameters=v.clone(m)}clone(){return new d({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,statisticType:this.statisticType,statisticParameters:v.clone(this.statisticParameters)})}};
a.__decorate([I.property({type:Number,json:{write:!0}})],w.prototype,"maxPointCount",void 0);a.__decorate([I.property({type:Number,json:{write:!0}})],w.prototype,"maxRecordCount",void 0);a.__decorate([I.property({type:Number,json:{write:!0}})],w.prototype,"maxVertexCount",void 0);a.__decorate([I.property({type:String,json:{write:!0}})],w.prototype,"onStatisticField",void 0);a.__decorate([I.property({type:String,json:{write:!0}})],w.prototype,"outStatisticFieldName",void 0);a.__decorate([I.property({type:String,
json:{read:{source:"statisticType",reader:c.read},write:{target:"statisticType",writer:c.write}}})],w.prototype,"statisticType",void 0);a.__decorate([I.property({type:Object})],w.prototype,"statisticParameters",void 0);a.__decorate([z.writer("statisticParameters")],w.prototype,"writeStatisticParameters",null);return w=d=a.__decorate([g.subclass("esri.rest.support.StatisticDefinition")],w)})},"esri/symbols/support/ElevationInfo":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ./FeatureExpressionInfo ./unitConversionUtils".split(" "),
function(a,c,w,v,I,n,g,z,d,m,x,B,E){var p;n=c.strict()({onTheGround:"on-the-ground",relativeToGround:"relative-to-ground",relativeToScene:"relative-to-scene",absoluteHeight:"absolute-height"});c=new c.JSONMap({foot:"feet",kilometer:"kilometers",meter:"meters",mile:"miles","us-foot":"us-feet",yard:"yards"});w=p=class extends w.JSONSupport{constructor(f){super(f);this.offset=null}readFeatureExpressionInfo(f,b){if(null!=f)return f;if(b.featureExpression&&0===b.featureExpression.value)return{expression:"0"}}writeFeatureExpressionInfo(f,
b,q,A){b[q]=f.write({},A);"0"===f.expression&&(b.featureExpression={value:0})}get mode(){const {offset:f,featureExpressionInfo:b}=this;return this._isOverridden("mode")?this._get("mode"):null!=f||b?"relative-to-ground":"on-the-ground"}set mode(f){this._override("mode",f)}set unit(f){this._set("unit",f)}write(f,b){return this.offset||this.mode||this.featureExpressionInfo||this.unit?super.write(f,b):null}clone(){return new p({mode:this.mode,offset:this.offset,featureExpressionInfo:this.featureExpressionInfo?
this.featureExpressionInfo.clone():void 0,unit:this.unit})}equals(f){return this.mode===f.mode&&this.offset===f.offset&&this.unit===f.unit&&v.equalsMaybe(this.featureExpressionInfo,f.featureExpressionInfo)}};a.__decorate([I.property({type:B,json:{write:!0}})],w.prototype,"featureExpressionInfo",void 0);a.__decorate([d.reader("featureExpressionInfo",["featureExpressionInfo","featureExpression"])],w.prototype,"readFeatureExpressionInfo",null);a.__decorate([x.writer("featureExpressionInfo",{featureExpressionInfo:{type:B},
"featureExpression.value":{type:[0]}})],w.prototype,"writeFeatureExpressionInfo",null);a.__decorate([I.property({type:n.apiValues,nonNullable:!0,json:{type:n.jsonValues,read:n.read,write:{writer:n.write,isRequired:!0}}})],w.prototype,"mode",null);a.__decorate([I.property({type:Number,json:{write:!0}})],w.prototype,"offset",void 0);a.__decorate([I.property({type:E.supportedUnits,json:{type:String,read:c.read,write:c.write}})],w.prototype,"unit",null);return w=p=a.__decorate([m.subclass("esri.layers.support.ElevationInfo")],
w)})},"esri/symbols/support/FeatureExpressionInfo":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../layers/support/fieldUtils".split(" "),function(a,c,w,v,I,n,g,z){var d;c=d=class extends c.JSONSupport{constructor(m){super(m)}async collectRequiredFields(m,x){return z.collectArcadeFieldNames(m,x,this.expression)}clone(){return new d({expression:this.expression,
title:this.title})}equals(m){return this.expression===m.expression&&this.title===m.title}};a.__decorate([w.property({type:String,json:{write:!0}})],c.prototype,"expression",void 0);a.__decorate([w.property({type:String,json:{write:!0}})],c.prototype,"title",void 0);return c=d=a.__decorate([g.subclass("esri.layers.support.FeatureExpressionInfo")],c)})},"esri/symbols/support/unitConversionUtils":function(){define(["exports","../../renderers/support/lengthUtils"],function(a,c){const w=function(){const v=
Object.keys(c.meterIn);v.sort();return v}();a.getMetersPerUnit=function(v){return 1/(c.meterIn[v]||1)};a.supportedUnits=w;a.supportsUnit=function(v){return!!v&&null!=c.meterIn[v]};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/lengthUtils":function(){define(["exports","../../core/unitUtils","../../geometry/support/Ellipsoid"],function(a,c,w){c={unknown:1,inches:c.convertUnit(1,"meters","inches"),feet:c.convertUnit(1,"meters","feet"),"us-feet":c.convertUnit(1,
"meters","us-feet"),yards:c.convertUnit(1,"meters","yards"),miles:c.convertUnit(1,"meters","miles"),"nautical-miles":c.convertUnit(1,"meters","nautical-miles"),millimeters:c.convertUnit(1,"meters","millimeters"),centimeters:c.convertUnit(1,"meters","centimeters"),decimeters:c.convertUnit(1,"meters","decimeters"),meters:c.convertUnit(1,"meters","meters"),kilometers:c.convertUnit(1,"meters","kilometers"),"decimal-degrees":1/c.lengthToDegrees(1,"meters",w.earth.radius)};a.meterIn=c;Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/featureSources/snappingCandidateElevationAlignment":function(){define("exports ../../../../core/has ../../../../core/LRUCache ../../../../core/MapUtils ../../../../core/promiseUtils ../../../../core/unitUtils ../../../../symbols/support/unitConversionUtils".split(" "),function(a,c,w,v,I,n,g){function z(E,{x:p,y:f,z:b,spatialReference:q}){return`${E}-${p}-${f}-${b??0}}-wkid:${q?.wkid}`}function d(){return[]}class m{async alignCandidates(E,
p,f){return E}notifyElevationSourceChange(){}}class x{constructor(E,p){this._elevationInfo=E;this._alignPointsInFeatures=p;this._alignmentsCache=new w.LRUCache(1024);this._cacheVersion=0}async alignCandidates(E,p,f){const b=this._elevationInfo;return null==b||"absolute-height"!==b.mode||b.featureExpressionInfo?this._alignComputedElevationCandidates(E,p,f):(this._alignAbsoluteElevationCandidates(E,p,b),E)}notifyElevationSourceChange(){this._alignmentsCache.clear();this._cacheVersion++}_alignAbsoluteElevationCandidates(E,
p,f){const {offset:b,unit:q}=f;if(null!=b){p=n.getMetersPerVerticalUnitForSR(p);f=g.getMetersPerUnit(q??"meters");p=f/p*b;for(const A of E)switch(A.type){case "edge":A.start.z+=p;A.end.z+=p;continue;case "vertex":A.target.z+=p}}}async _alignComputedElevationCandidates(E,p,f){var b=new Map;for(const H of E)v.getOrCreateMapValue(b,H.objectId,d).push(H);const [q,A,F]=this._prepareQuery(b,p);b=await this._alignPointsInFeatures(q,f);I.throwIfAborted(f);if(F!==this._cacheVersion)return this._alignComputedElevationCandidates(E,
p,f);this._applyCacheAndResponse(q,b,A);const {drapedObjectIds:L,failedObjectIds:h}=b;p=[];for(const H of E)({objectId:E}=H),L.has(E)&&"edge"===H.type&&(H.draped=!0),h.has(E)||p.push(H);return p}_prepareQuery(E,p){const f=[],b=[];for(const [q,A]of E){E=[];for(const F of A)this._addToQueriesOrCachedResult(q,F.target,E,b),"edge"===F.type&&(this._addToQueriesOrCachedResult(q,F.start,E,b),this._addToQueriesOrCachedResult(q,F.end,E,b));0!==E.length&&f.push({objectId:q,points:E})}return[{spatialReference:p.toJSON(),
pointsInFeatures:f},b,this._cacheVersion]}_addToQueriesOrCachedResult(E,p,f,b){E=z(E,p);E=this._alignmentsCache.get(E);null!=E?b.push(new B(p,E)):f.push(p)}_applyCacheAndResponse(E,{elevations:p,drapedObjectIds:f,failedObjectIds:b},q){for(var A of q)A.apply();q=0;A=this._alignmentsCache;for(const {objectId:F,points:L}of E.pointsInFeatures)if(b.has(F))q+=L.length;else{E=!f.has(F);for(const h of L){const H=z(F,h),S=p[q++];h.z=S;E&&A.put(H,S,1)}}}}class B{constructor(E,p){this.point=E;this.z=p}apply(){this.point.z=
this.z}}a.getSnappingCandidateElevationAligner=function(E=!1,p){if(E){const {elevationInfo:f,alignPointsInFeatures:b}=p;return new x(f,b)}return new m};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/featureSources/snappingCandidateElevationFilter":function(){define(["exports","../../../../core/has"],function(a,c){function w(d){return 1>=d.distance}function v(d,m,{x,y:B,z:E}){const {start:p,end:f,target:b}=d;if(!d.draped){const F=f.x-p.x;var q=f.y-
p.y,A=f.z-p.z;const L=Math.min(1,Math.max(0,((m.x-p.x)*F+(m.y-p.y)*q+A*(m.z-p.z))/(F*F+q*q+A*A)));q=p.y+q*L;A=p.z+A*L;b.x=p.x+F*L;b.y=q;b.z=A}x=(m.x-b.x)/x;B=(m.y-b.y)/B;m=(m.z-b.z)/E;d.distance=Math.sqrt(x*x+B*B+m*m)}function I(d,m,{x,y:B,z:E}){const {target:p}=d;x=(m.x-p.x)/x;B=(m.y-p.y)/B;m=(m.z-p.z)/E;d.distance=Math.sqrt(x*x+B*B+m*m)}function n(d,m){return d.distance-m.distance}class g{filter(d,m){return m}notifyElevationSourceChange(){}}class z{filter(d,m){const {point:x,distance:B}=d;({z:d}=
x);if(null==d||0===m.length)return m;d="number"===typeof B?{x:B,y:B,z:B}:B;m=this._updateCandidatesTo3D(m,x,d).filter(w);m.sort(n);return m}_updateCandidatesTo3D(d,m,x){for(const B of d)switch(B.type){case "edge":v(B,m,x);continue;case "vertex":I(B,m,x)}return d}}a.getSnappingCandidateElevationFilter=function(d=!1){return d?new z:new g};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/featureSources/symbologySnappingCandidates":function(){define("exports ../../../../core/has ../../../../core/lang ../../../../core/LRUCache ../../../../core/promiseUtils ../../../../core/string".split(" "),
function(a,c,w,v,I,n){function g(m){switch(m.type){case "vertex":const {objectId:x,target:B}=m;return n.numericHash(`${x}-vertex-${B.x}-${B.y}-${B.z??0}`).toString();case "edge":const {objectId:E,start:p,end:f}=m;return n.numericHash(`${E}-edge-${p.x}-${p.y}-${p.z??0}-to-${f.x}-${f.y}-${f.z??0}`).toString();default:return""}}class z{async fetch(){return[]}notifySymbologyChange(){}}class d{constructor(m){this._getSymbologyCandidates=m;this._candidatesCache=new v.LRUCache(1024);this._cacheVersion=0}async fetch(m,
x){if(0===m.length)return[];const B=[],E=[],p=this._candidatesCache;for(var f of m){var b=g(f),q=p.get(b);if(q)for(var A of q)E.push(w.clone(A));else B.push(f),p.put(b,[],1)}if(0===B.length)return E;f=this._cacheVersion;const {candidates:F,sourceCandidateIndices:L}=await this._getSymbologyCandidates(B,x);I.throwIfAborted(x);if(f!==this._cacheVersion)return this.fetch(m,x);m=[];({length:x}=F);for(f=0;f<x;++f)b=F[f],q=g(B[L[f]]),A=p.get(q),A.push(b),p.put(q,A,A.length),m.push(w.clone(b));return E.concat(m)}notifySymbologyChange(){this._candidatesCache.clear();
this._cacheVersion++}}a.getSymbologySnappingCandidatesFetcher=function(m=!1,x){return m?new d(x):new z};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/featureSources/featureServiceSource/FeatureServiceTiledFetcher":function(){define("exports ../../../../../chunks/tslib.es6 ../../../../../core/Accessor ../../../../../core/arrayUtils ../../../../../core/AsyncSequence ../../../../../core/asyncUtils ../../../../../core/handleUtils ../../../../../core/Logger ../../../../../core/promiseUtils ../../../../../core/reactiveUtils ../../../../../core/SetUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/accessorSupport/ensureType ../../../../../core/has ../../../../../core/accessorSupport/decorators/subclass ../../../../../core/support/UpdatingHandles ../../../../../geometry/Extent ../../../../../geometry/support/aaBoundingRect ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/support/arcgisLayerUrl ../../../../../rest/query/operations/pbfOptimizedFeatureSet ../../../../../rest/query/operations/query ../../../../../rest/support/Query ./PendingFeatureTile".split(" "),
function(a,c,w,v,I,n,g,z,d,m,x,B,E,p,f,b,q,A,F,L,h,H,S,C){a.FeatureServiceTiledFetcher=class extends w{get _minimumVerticesPerFeature(){switch(this.store?.featureStore.geometryType){case "esriGeometryPoint":case "esriGeometryMultipoint":return 1;case "esriGeometryPolygon":return 4;case "esriGeometryPolyline":return 2}}get _mandatoryOutFields(){const k=new Set;this.objectIdField&&k.add(this.objectIdField);this.globalIdField&&k.add(this.globalIdField);return k}set outFields(k){const y=this._get("outFields");
k=x.union(k,this._mandatoryOutFields);x.equals(k,y)||(this._set("outFields",k),x.isSubsetOf(k,y)||this.refresh())}get outFields(){return this._get("outFields")??this._mandatoryOutFields}set filter(k){const y=this._get("filter");k=this._filterProperties(k);JSON.stringify(y)!==JSON.stringify(k)&&this._set("filter",k)}set customParameters(k){const y=this._get("customParameters");JSON.stringify(y)!==JSON.stringify(k)&&this._set("customParameters",k)}get _configuration(){return{filter:this.filter,customParameters:this.customParameters,
tileInfo:this.tileInfo,tileSize:this.tileSize}}set tileInfo(k){const y=this._get("tileInfo");y===k||null!=k&&null!=y&&JSON.stringify(k)===JSON.stringify(y)||(this._set("tileInfo",k),this.store.tileInfo=k)}set tileSize(k){this._get("tileSize")!==k&&this._set("tileSize",k)}get updating(){return this.updatingExcludingEdits||this._pendingEdits.updating}get updatingExcludingEdits(){return this._updatingHandles.updating}get hasZ(){return this.store.featureStore.hasZ}constructor(k){super(k);this.suspended=
!0;this.tilesOfInterest=[];this.availability=0;this._pendingTiles=new Map;this._updatingHandles=new b.UpdatingHandles;this._pendingEdits=new I.AsyncSequence;this._pendingEditsAbortController=new AbortController}initialize(){this._initializeFetchExtent();this._updatingHandles.add(()=>this._configuration,()=>this.refresh());this._updatingHandles.add(()=>this.tilesOfInterest,(k,y)=>{v.equals(k,y,({id:N},{id:l})=>N===l)||this._process()},m.sync);this.addHandles(m.when(()=>!this.suspended,()=>this._process()))}destroy(){this._pendingTiles.forEach(k=>
this._deletePendingTile(k));this._pendingTiles.clear();this.store.destroy();this.tilesOfInterest.length=0;this._pendingEditsAbortController.abort();this._pendingEditsAbortController=null;this._updatingHandles.destroy()}refresh(){this.store.refresh();this._pendingTiles.forEach(k=>this._deletePendingTile(k));this._process()}applyEdits(k){this._pendingEdits.push(k,async y=>{if(0!==y.addedFeatures.length||0!==y.updatedFeatures.length||0!==y.deletedFeatures.length){for(const [,N]of this._pendingTiles)N.reset();
y={...y,deletedFeatures:y.deletedFeatures.map(({objectId:N,globalId:l})=>N&&-1!==N?N:this._lookupObjectIdByGlobalId(l))};await this._updatingHandles.addPromise(this.store.processEdits(y,(N,l)=>this._queryFeaturesById(N,l),this._pendingEditsAbortController.signal));this._processPendingTiles()}})}_initializeFetchExtent(){if(this.capabilities.query.supportsExtent&&L.isHostedAgolService(this.url)){var k=n.createTask(async y=>{try{const N=await H.executeQueryForExtent(this.url,new S({where:"1\x3d1",outSpatialReference:this.spatialReference,
cacheHint:this.capabilities.query.supportsCacheHint??void 0}),{query:this._configuration.customParameters,signal:y});this.store.extent=q.fromJSON(N.data?.extent)}catch(N){d.throwIfAbortError(N),z.getLogger(this).warn("Failed to fetch data extent",N)}});this._updatingHandles.addPromise(k.promise.then(()=>this._process()));this.addHandles(g.makeHandle(()=>k.abort()))}}get debugInfo(){return{numberOfFeatures:this.store.featureStore.numFeatures,tilesOfInterest:this.tilesOfInterest,pendingTiles:Array.from(this._pendingTiles.values()).map(k=>
k.debugInfo),storedTiles:this.store.debugInfo}}_process(){this._markTilesNotAlive();this._createPendingTiles();this._deletePendingTiles();this._processPendingTiles()}_markTilesNotAlive(){for(const [,k]of this._pendingTiles)k.alive=!1}_createPendingTiles(){if(!this.suspended){var k=this._collectMissingTilesInfo();this._setAvailability(null==k?1:k.coveredArea/k.fullArea);if(null!=k)for(const {data:y,resolution:N}of k.missingTiles)(k=this._pendingTiles.get(y.id))?(k.resolution=N,k.alive=!0):this._createPendingTile(y,
N)}}_collectMissingTilesInfo(){let k=null;for(let y=this.tilesOfInterest.length-1;0<=y;y--){const N=this.store.process(this.tilesOfInterest[y],(l,O)=>this._verifyTileComplexity(l,O),this.outFields);null==k?k=N:k.prepend(N)}return k}_deletePendingTiles(){for(const [,k]of this._pendingTiles)k.alive||this._deletePendingTile(k)}_processPendingTiles(){const k={fetchCount:(y,N)=>this._fetchCount(y,N),fetchFeatures:(y,N,l)=>this._fetchFeatures(y,N,l),finish:(y,N)=>this._finishPendingTile(y,N),resume:()=>
this._processPendingTiles()};if(this._ensureFetchAllCounts(k))for(const [,y]of this._pendingTiles)this._verifyTileComplexity(this.store.getFeatureCount(y.data),y.resolution)&&this._updatingHandles.addPromise(y.process(k))}_verifyTileComplexity(k,y){return this._verifyVertexComplexity(k)&&this._verifyFeatureDensity(k,y)}_verifyVertexComplexity(k){return 1E6>k*this._minimumVerticesPerFeature}_verifyFeatureDensity(k,y){if(null==this.tileInfo)return!1;y*=this.tileSize;return 1>25/(y*y)*k}_ensureFetchAllCounts(k){let y=
!0;for(const [,N]of this._pendingTiles)N.state.type<C.StateType.FETCHED_COUNT&&this._updatingHandles.addPromise(N.process(k)),N.state.type<=C.StateType.FETCH_COUNT&&(y=!1);return y}_finishPendingTile(k,y){this.store.add(k.data,y);this._deletePendingTile(k);this._updateAvailability()}_updateAvailability(){const k=this._collectMissingTilesInfo();this._setAvailability(null==k?1:k.coveredArea/k.fullArea)}_setAvailability(k){this._set("availability",k)}_createPendingTile(k,y){y=new C.PendingFeatureTile(k,
y);this._pendingTiles.set(k.id,y);return y}_deletePendingTile(k){k.reset();this._pendingTiles.delete(k.data.id)}async _fetchCount(k,y){return this.store.fetchCount(k.data,this.url,this._createCountQuery(k),{query:this.customParameters,timeout:6E5,signal:y})}async _fetchFeatures(k,y,N){let l=0;const O=[];let u=0,D=y;for(;;){const R=this._createFeaturesQuery(k),Q=this._setPagingParameters(R,l,D),{features:U,exceededTransferLimit:Z}=await this._queryFeatures(R,N);Q&&(l+=R.num);u+=U.length;for(const ea of U)O.push(ea);
D=y-u;if(!Q||!Z||0>=D)return O}}_filterProperties(k){return null==k?{where:"1\x3d1",gdbVersion:void 0,timeExtent:void 0}:{where:k.where||"1\x3d1",timeExtent:k.timeExtent,gdbVersion:k.gdbVersion}}_lookupObjectIdByGlobalId(k){const y=this.globalIdField,N=this.objectIdField;if(null==y)throw Error("Expected globalIdField to be defined");let l=null;this.store.featureStore.forEach(O=>{k===O.attributes[y]&&(l=O.objectId??O.attributes[N])});if(null==l)throw Error(`Expected to find a feature with globalId ${k}`);
return l}_queryFeaturesById(k,y){const N=this._createFeaturesQuery();N.objectIds=k;return this._queryFeatures(N,y)}_queryFeatures(k,y){return this.capabilities.query.supportsFormatPBF?this._queryFeaturesPBF(k,y):this._queryFeaturesJSON(k,y)}async _queryFeaturesPBF(k,y){const {sourceSpatialReference:N}=this;({data:k}=await H.executeQueryPBF(this.url,k,new h.OptimizedFeatureSetParserContext({sourceSpatialReference:N}),{query:this._configuration.customParameters,timeout:6E5,signal:y}));return F.unquantizeOptimizedFeatureSet(k)}async _queryFeaturesJSON(k,
y){const {sourceSpatialReference:N}=this;({data:k}=await H.executeQuery(this.url,k,N,{query:this._configuration.customParameters,timeout:6E5,signal:y}));return F.convertFromFeatureSet(k,this.objectIdField)}_createCountQuery(k){k=this._createBaseQuery(k);this.capabilities.query.supportsCacheHint&&(k.cacheHint=!0);return k}_createFeaturesQuery(k=null){const y=this._createBaseQuery(k);var N=null!=k?.data?this.store.getAttributesForTile(k?.data?.id):null;N=x.union(x.difference(this.outFields,N??new Set),
this._mandatoryOutFields);y.outFields=Array.from(N);y.returnGeometry=!0;null!=k&&(this.capabilities.query.supportsResultType?y.resultType="tile":this.capabilities.query.supportsCacheHint&&(y.cacheHint=!0));return y}_createBaseQuery(k){k=new S({returnZ:this.hasZ,returnM:!1,geometry:null!=this.tileInfo&&null!=k?A.toExtent(k.data.extent,this.tileInfo.spatialReference):void 0});const y=this._configuration.filter;null!=y&&(k.where=y.where,k.gdbVersion=y.gdbVersion,k.timeExtent=y.timeExtent);k.outSpatialReference=
this.spatialReference;return k}_setPagingParameters(k,y,N){if(!this.capabilities.query.supportsPagination)return!1;const {supportsMaxRecordCountFactor:l,supportsCacheHint:O,tileMaxRecordCount:u,maxRecordCount:D,supportsResultType:R}=this.capabilities.query,Q=l?S.MAX_MAX_RECORD_COUNT_FACTOR:1,U=Q*((R||O)&&u?u:D||2E3);k.start=y;l?(k.maxRecordCountFactor=Math.min(Q,Math.ceil(N/U)),k.num=Math.min(N,k.maxRecordCountFactor*U)):k.num=Math.min(N,U);return!0}};c.__decorate([B.property({constructOnly:!0})],
a.FeatureServiceTiledFetcher.prototype,"url",void 0);c.__decorate([B.property({constructOnly:!0})],a.FeatureServiceTiledFetcher.prototype,"objectIdField",void 0);c.__decorate([B.property({constructOnly:!0})],a.FeatureServiceTiledFetcher.prototype,"globalIdField",void 0);c.__decorate([B.property({constructOnly:!0})],a.FeatureServiceTiledFetcher.prototype,"capabilities",void 0);c.__decorate([B.property({constructOnly:!0})],a.FeatureServiceTiledFetcher.prototype,"sourceSpatialReference",void 0);c.__decorate([B.property({constructOnly:!0})],
a.FeatureServiceTiledFetcher.prototype,"spatialReference",void 0);c.__decorate([B.property({constructOnly:!0})],a.FeatureServiceTiledFetcher.prototype,"store",void 0);c.__decorate([B.property({readOnly:!0})],a.FeatureServiceTiledFetcher.prototype,"_minimumVerticesPerFeature",null);c.__decorate([B.property()],a.FeatureServiceTiledFetcher.prototype,"_mandatoryOutFields",null);c.__decorate([B.property()],a.FeatureServiceTiledFetcher.prototype,"outFields",null);c.__decorate([B.property()],a.FeatureServiceTiledFetcher.prototype,
"suspended",void 0);c.__decorate([B.property()],a.FeatureServiceTiledFetcher.prototype,"filter",null);c.__decorate([B.property()],a.FeatureServiceTiledFetcher.prototype,"customParameters",null);c.__decorate([B.property({readOnly:!0})],a.FeatureServiceTiledFetcher.prototype,"_configuration",null);c.__decorate([B.property()],a.FeatureServiceTiledFetcher.prototype,"tileInfo",null);c.__decorate([B.property()],a.FeatureServiceTiledFetcher.prototype,"tileSize",null);c.__decorate([B.property()],a.FeatureServiceTiledFetcher.prototype,
"tilesOfInterest",void 0);c.__decorate([B.property({readOnly:!0})],a.FeatureServiceTiledFetcher.prototype,"updating",null);c.__decorate([B.property({readOnly:!0})],a.FeatureServiceTiledFetcher.prototype,"updatingExcludingEdits",null);c.__decorate([B.property({readOnly:!0})],a.FeatureServiceTiledFetcher.prototype,"availability",void 0);c.__decorate([B.property()],a.FeatureServiceTiledFetcher.prototype,"hasZ",null);a.FeatureServiceTiledFetcher=c.__decorate([f.subclass("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTiledFetcher")],
a.FeatureServiceTiledFetcher);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/AsyncSequence":function(){define(["exports","../chunks/tslib.es6","./Accessor","./accessorSupport/decorators/property","./accessorSupport/decorators/subclass"],function(a,c,w,v,I){a.AsyncSequence=class extends w{constructor(){super(...arguments);this.updating=!1;this._pending=[]}push(n,g){this._pending.push({promise:n,callback:g});1===this._pending.length&&this._process()}_process(){if(this._pending.length){this.updating=
!0;var n=this._pending[0];n.promise.then(g=>n.callback(g)).catch(()=>{}).then(()=>{this._pending.shift();this._process()})}else this.updating=!1}};c.__decorate([v.property()],a.AsyncSequence.prototype,"updating",void 0);a.AsyncSequence=c.__decorate([I.subclass("esri.core.AsyncSequence")],a.AsyncSequence);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/arcgisLayerUrl":function(){define(["exports","../../core/urlUtils","../../chunks/persistableUrlUtils"],function(a,
c,w){function v(B){if(null==B)return null;B=c.urlToObject(B);B=B?.path.match(d)||B?.path.match(m);if(!B)return null;const [,E,p,f,b]=B;B=p.indexOf("/");return{title:n(-1!==B?p.slice(B+1):p),serverType:g[f.toLowerCase()],sublayer:null!=b&&""!==b?parseInt(b,10):null,url:{path:E}}}function I(B){return(B=c.urlToObject(B).path.match(x))?{serviceUrl:B[1],sublayerId:Number(B[2])}:null}function n(B){B=B.replaceAll(/\s*[/_]+\s*/g," ");return B[0].toUpperCase()+B.slice(1)}const g={mapserver:"MapServer",imageserver:"ImageServer",
featureserver:"FeatureServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer"},z=Object.values(g),d=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${z.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),m=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^\\/\\n]+)\\/(${z.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),x=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;a.cleanTitle=n;a.isArcGISUrl=function(B){return!!d.test(B)};a.isHostedAgolService=function(B){if(!B)return!1;
B=B.toLowerCase();const E=B.includes(".arcgis.com/");B=B.includes("//services")||B.includes("//tiles")||B.includes("//features");return E&&B};a.isServerOrServicesAGOLUrl=function(B){if(!B)return!1;B=(new c.Url(c.makeAbsolute(B))).authority?.toLowerCase();return"server.arcgisonline.com"===B||"services.arcgisonline.com"===B};a.isWmsServer=function(B){if(!B)return!1;var E=B.toLowerCase();B=E.includes("/services/");const p=E.includes("/mapserver/wmsserver"),f=E.includes("/imageserver/wmsserver");E=E.includes("/wmsserver");
return B&&(p||f||E)};a.parse=v;a.parseNonStandardSublayerUrl=I;a.sanitizeUrl=function(B,E){return B?c.removeTrailingSlash(c.removeQueryParameters(B,E)):B};a.sanitizeUrlWithLayerId=function(B){let {url:E}=B;if(!E)return{url:E};E=c.removeQueryParameters(E,B.logger);const p=c.urlToObject(E),f=v(p.path);let b=void 0;null!=f?(null!=f.sublayer&&null==B.layer.layerId&&(b=f.sublayer),E=f.url.path):B.nonStandardUrlAllowed&&(B=I(p.path),null!=B&&(E=B.serviceUrl,b=B.sublayerId));return{url:c.removeTrailingSlash(E),
layerId:b}};a.serverTypes=z;a.titleFromUrlAndName=function(B,E){const p=[];B&&(B=v(B),null!=B&&B.title&&p.push(B.title));E&&(E=n(E),p.push(E));if(2===p.length){if(p[0].toLowerCase().includes(p[1].toLowerCase()))return p[0];if(p[1].toLowerCase().includes(p[0].toLowerCase()))return p[1]}return p.join(" - ")};a.writeUrlWithLayerId=function(B,E,p,f,b){w.write(E,f,"url",b);f.url&&null!=B.layerId&&(f.url=c.join(f.url,p,B.layerId.toString()))};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/chunks/persistableUrlUtils":function(){define(["exports","../core/urlUtils"],function(a,c){function w(p,f){var b=f?.url?.path;p&&b&&(p=c.makeAbsolute(p,b,{preserveProtocolRelative:!0}),f.portalItem&&f.readResourcePaths&&(b=c.makeRelative(p,f.portalItem.itemUrl),null!=b&&B.test(b)&&f.readResourcePaths.push(f.portalItem.resourceFromPath(b).path)));return m(p,f?.portal)}function v(p,f,b=a.MarkKeep.YES){if(null==p)return p;!c.isAbsolute(p)&&f?.blockedRelativeUrls&&f.blockedRelativeUrls.push(p);
let q=c.makeAbsolute(p);if(f){var A=f.verifyItemRelativeUrls?.rootPath||f.url?.path;if(A){A=m(A,f.portal);const F=m(q,f.portal);q=c.makeRelative(F,A,A);null!=q&&q!==F&&q!==p&&f.verifyItemRelativeUrls&&f.verifyItemRelativeUrls.writtenUrls.push(q)}}q=d(q,f?.portal);c.isAbsolute(q)&&(q=c.normalize(q));f?.resources&&f?.portalItem&&!c.isAbsolute(q)&&!c.isDataProtocol(q)&&b===a.MarkKeep.YES&&f.resources.toKeep.push({resource:f.portalItem.resourceFromPath(q),compress:!1});return q}function I(p,f,b){return w(p,
b)}function n(p,f,b,q){p=v(p,q);void 0!==p&&(f[b]=p)}function g(p){return(p?.match(x)??null)?.[1]??null}function z(p){p=p?.match(x)??null;if(null==p)return null;p=p[2];const f=p.lastIndexOf("/");if(-1===f){const {path:A,extension:F}=c.splitPathExtension(p);return{prefix:null,filename:A,extension:F}}const {path:b,extension:q}=c.splitPathExtension(p.slice(f+1));return{prefix:p.slice(0,f),filename:b,extension:q}}function d(p,f){return f&&!f.isPortal&&f.urlKey&&f.customBaseUrl?c.changeDomain(p,`${f.urlKey}.${f.customBaseUrl}`,
f.portalHostname):p}function m(p,f){if(!f||f.isPortal||!f.urlKey||!f.customBaseUrl)return p;const b=`${f.urlKey}.${f.customBaseUrl}`,q=c.getAppUrl();return c.hasSameOrigin(q,`${q.scheme}://${b}`)?c.changeDomain(p,f.portalHostname,b):c.changeDomain(p,b,f.portalHostname)}const x=/\/items\/([^\/]+)\/resources\/(.*)/,B=/^\.\/resources\//;a.MarkKeep=void 0;(function(p){p[p.YES=0]="YES";p[p.NO=1]="NO"})(a.MarkKeep||(a.MarkKeep={}));const E=Object.freeze(Object.defineProperty({__proto__:null,get MarkKeep(){return a.MarkKeep},
ensureMainOnlineDomain:d,fromJSON:w,itemIdFromResourceUrl:g,prefixAndFilenameFromResourceUrl:z,read:I,toJSON:v,write:n},Symbol.toStringTag,{value:"Module"}));a.ensureMainOnlineDomain=d;a.fromJSON=w;a.itemIdFromResourceUrl=g;a.persistableUrlUtils=E;a.prefixAndFilenameFromResourceUrl=z;a.read=I;a.toJSON=v;a.write=n})},"esri/rest/query/operations/pbfOptimizedFeatureSet":function(){define("exports ../../../core/unitUtils ../../../geometry/support/spatialReferenceUtils ../../../layers/graphics/OptimizedFeature ../../../layers/graphics/OptimizedFeatureSet ../../../layers/graphics/OptimizedGeometry".split(" "),
function(a,c,w,v,I,n){const g=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"];class z{constructor(d){this._options=d;this.geometryTypes=g;this._vertexDimension=this._coordinatePtr=0}createFeatureResult(){return new I}prepareFeatures(d){this._vertexDimension=2;d.hasZ&&this._vertexDimension++;d.hasM&&this._vertexDimension++}finishFeatureResult(d){if(d?.features&&d.hasZ&&this._options.sourceSpatialReference&&d.spatialReference&&!w.equals(d.spatialReference,
this._options.sourceSpatialReference)&&!d.spatialReference.vcsWkid){var m=c.getMetersPerVerticalUnitForSR(this._options.sourceSpatialReference),x=c.getMetersPerVerticalUnitForSR(d.spatialReference);m/=x;if(1!==m)for(const B of d.features)if(v.hasGeometry(B))for(d=B.geometry.coords,x=2;x<d.length;x+=3)d[x]*=m}}addFeature(d,m){d.features.push(m)}createFeature(){return new v.OptimizedFeature}createSpatialReference(){return{wkid:0}}createGeometry(){return new n}addField(d,m){d.fields.push(m)}allocateCoordinates(d){d.coords.length=
d.lengths.reduce((m,x)=>m+x,0)*this._vertexDimension;this._coordinatePtr=0}addCoordinate(d,m){d.coords[this._coordinatePtr++]=m}addCoordinatePoint(d,m){d.coords.push(m)}addLength(d,m){d.lengths.push(m)}addQueryGeometry(d,m){d.queryGeometry=m.queryGeometry;d.queryGeometryType=m.queryGeometryType}createPointGeometry(){return new n}}a.OptimizedFeatureSetParserContext=z;a.optimizedGeometryTypes=g;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/query/operations/query":function(){define("exports ../../../request ../../../core/urlUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../../operations/urlUtils ./pbfQueryUtils ./queryZScale".split(" "),
function(a,c,w,v,I,n,g,z,d){function m(p,f){if(f&&"extent"===p.type)return`${p.xmin},${p.ymin},${p.xmax},${p.ymax}`;if(f&&"point"===p.type)return`${p.x},${p.y}`;p=p.toJSON();delete p.spatialReference;return JSON.stringify(p)}function x(p,f){const b=p.geometry,q=p.toJSON();delete q.compactGeometryEnabled;delete q.defaultSpatialReferenceEnabled;let A,F,L;null!=b&&(F=b.spatialReference,L=n.srToRESTValue(F),q.geometryType=v.getJsonType(b),q.geometry=m(b,p.compactGeometryEnabled),q.inSR=L);q.groupByFieldsForStatistics&&
(q.groupByFieldsForStatistics=q.groupByFieldsForStatistics.join(","));q.objectIds&&(q.objectIds=q.objectIds.join(","));q.orderByFields&&(q.orderByFields=q.orderByFields.join(","));!q.outFields||!q.returnDistinctValues&&(f?.returnCountOnly||f?.returnExtentOnly||f?.returnIdsOnly)?delete q.outFields:q.outFields.includes("*")?q.outFields="*":q.outFields=q.outFields.join(",");q.outSR?(q.outSR=n.srToRESTValue(q.outSR),A=p.outSpatialReference):b&&(q.returnGeometry||q.returnCentroid)&&(q.outSR=q.inSR,A=F);
q.returnGeometry&&delete q.returnGeometry;q.outStatistics&&(q.outStatistics=JSON.stringify(q.outStatistics));q.fullText&&(q.fullText=JSON.stringify(q.fullText));q.pixelSize&&(q.pixelSize=JSON.stringify(q.pixelSize));q.quantizationParameters&&(p.defaultSpatialReferenceEnabled&&null!=F&&null!=p.quantizationParameters?.extent&&F.equals(p.quantizationParameters.extent.spatialReference)&&delete q.quantizationParameters.extent.spatialReference,q.quantizationParameters=JSON.stringify(q.quantizationParameters));
q.parameterValues&&(q.parameterValues=JSON.stringify(q.parameterValues));q.rangeValues&&(q.rangeValues=JSON.stringify(q.rangeValues));q.dynamicDataSource&&(q.layer=JSON.stringify({source:q.dynamicDataSource}),delete q.dynamicDataSource);if(q.timeExtent){const {start:h,end:H}=q.timeExtent;if(null!=h||null!=H)q.time=h===H?h:`${null==h?"null":h},${null==H?"null":H}`;delete q.timeExtent}p.defaultSpatialReferenceEnabled&&null!=F&&null!=A&&F.equals(A)&&(q.defaultSR=q.inSR,delete q.inSR,delete q.outSR);
return q}function B(p,f,b){return E(p,f,"pbf",b)}async function E(p,f,b,q={},A={}){p="string"===typeof p?w.urlToObject(p):p;var F=(await I.normalizeCentralMeridian(f.geometry?[f.geometry]:[],null,{signal:q.signal}))?.[0];null!=F&&(f=f.clone(),f.geometry=F);F=g.mapParameters({...p.query,f:b,...A,...x(f,A)});return c(w.join(p.path,null==f.formatOf3DObjects||A.returnCountOnly||A.returnExtentOnly||A.returnIdsOnly?"query":"query3d"),{...q,responseType:"pbf"===b?"array-buffer":"json",query:{...F,...q.query}})}
a.encodeGeometry=m;a.executeQuery=async function(p,f,b,q){p=null!=f.timeExtent&&f.timeExtent.isEmpty?{data:{features:[]}}:await E(p,f,"json",q);d.applyFeatureSetZUnitScaling(f,b,p.data);return p};a.executeQueryForCount=function(p,f,b){return null!=f.timeExtent&&f.timeExtent.isEmpty?Promise.resolve({data:{count:0}}):E(p,f,"json",b,{returnIdsOnly:!0,returnCountOnly:!0})};a.executeQueryForExtent=async function(p,f,b){if(null!=f.timeExtent&&f.timeExtent.isEmpty)return{data:{count:0,extent:null}};p=await E(p,
f,"json",b,{returnExtentOnly:!0,returnCountOnly:!0});f=p.data;if(f.hasOwnProperty("extent"))return p;if(f.features)throw Error("Layer does not support extent calculation.");if(f.hasOwnProperty("count"))throw Error("Layer does not support extent calculation.");return p};a.executeQueryForIds=function(p,f,b){return null!=f.timeExtent&&f.timeExtent.isEmpty?Promise.resolve({data:{objectIds:[]}}):E(p,f,"json",b,{returnIdsOnly:!0})};a.executeQueryPBF=async function(p,f,b,q){if(null!=f.timeExtent&&f.timeExtent.isEmpty)return{data:b.createFeatureResult()};
p=await B(p,f,q);p.data=z.parsePBFFeatureQuery(p.data,b);return p};a.executeQueryPBFBuffer=B;a.queryToQueryStringParameters=x;a.runQuery=E;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/operations/urlUtils":function(){define(["exports"],function(a){function c(w){const v={};for(const I in w){if("declaredClass"===I)continue;const n=w[I];if(null!=n&&"function"!==typeof n)if(Array.isArray(n)){v[I]=[];for(let g=0;g<n.length;g++)v[I][g]=c(n[g])}else"object"===typeof n?n.toJSON&&
(v[I]=JSON.stringify(n)):v[I]=n}return v}a.mapParameters=c;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/query/operations/pbfQueryUtils":function(){define(["exports","./pbfFeatureServiceParser"],function(a,c){a.parsePBFFeatureQuery=function(w,v){var I=c.parseFeatureQuery(w,v);w=I.queryResult.featureResult;v=I.queryResult.queryGeometry;I=I.queryResult.queryGeometryType;if(w&&w.features&&w.features.length&&w.objectIdFieldName){const n=w.objectIdFieldName;for(const g of w.features)g.attributes&&
(g.objectId=g.attributes[n])}w&&(w.queryGeometry=v,w.queryGeometryType=I);return w};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/query/operations/pbfFeatureServiceParser":function(){define(["exports","../../../core/Error","../../../core/pbf","../../../layers/graphics/OptimizedGeometry","./pbfOptimizedFeatureSet"],function(a,c,w,v,I){function n(C){return C>=h.length?null:h[C]}function g(C,k,y){C=C.asUnsafe();for(y=k.createPointGeometry(y);C.next();)switch(C.tag()){case 3:var N=
C.getUInt32();N=C.pos()+N;let l=0;for(;C.pos()<N;)k.addCoordinatePoint(y,C.getSInt64(),l++);break;default:C.skip()}return y}function z(C,k,y){C=C.asUnsafe();const N=k.createGeometry(y);for(y=2+(y.hasZ?1:0)+(y.hasM?1:0);C.next();)switch(C.tag()){case 2:var l=C.getUInt32();l=C.pos()+l;for(var O=0;C.pos()<l;)k.addLength(N,C.getUInt32(),O++);break;case 3:l=C.getUInt32();l=C.pos()+l;O=0;for(k.allocateCoordinates(N);C.pos()<l;)k.addCoordinate(N,C.getSInt64(),O),O++,O===y&&(O=0);break;default:C.skip()}return N}
function d(C){C=C.asUnsafe();const k=new v;let y="esriGeometryPoint";for(;C.next();)switch(C.tag()){case 2:var N=C.getUInt32();for(N=C.pos()+N;C.pos()<N;)k.lengths.push(C.getUInt32());break;case 3:N=C.getUInt32();for(N=C.pos()+N;C.pos()<N;)k.coords.push(C.getSInt64());break;case 1:y=I.optimizedGeometryTypes[C.getEnum()];break;default:C.skip()}return{queryGeometry:k,queryGeometryType:y}}function m(C){for(C=C.asUnsafe();C.next();)switch(C.tag()){case 1:return C.getString();case 2:return C.getFloat();
case 3:return C.getDouble();case 4:return C.getSInt32();case 5:return C.getUInt32();case 6:return C.getInt64();case 7:return C.getUInt64();case 8:return C.getSInt64();case 9:return C.getBool();default:return C.skip(),null}return null}function x(C){C=C.asUnsafe();const k={type:n(0)};for(;C.next();)switch(C.tag()){case 1:k.name=C.getString();break;case 2:k.type=n(C.getEnum());break;case 3:k.alias=C.getString();break;case 4:var y=C.getEnum();y=y>=H.length?null:H[y];k.sqlType=y;break;case 5:C.skip();
break;case 6:k.defaultValue=C.getString();break;default:C.skip()}return k}function B(C){const k={};for(C=C.asUnsafe();C.next();)switch(C.tag()){case 1:k.name=C.getString();break;case 2:k.isSystemMaintained=C.getBool();break;default:C.skip()}return k}function E(C,k,y,N){const l=k.createFeature(y);let O=0;for(;C.next();)switch(C.tag()){case 1:const u=N[O++].name;l.attributes[u]=C.processMessage(m);break;case 2:l.geometry=C.processMessageWithArgs(z,k,y);break;case 4:l.centroid=C.processMessageWithArgs(g,
k,y);break;default:C.skip()}return l}function p(C){const k=[1,1,1,1];for(C=C.asUnsafe();C.next();)switch(C.tag()){case 1:k[0]=C.getDouble();break;case 2:k[1]=C.getDouble();break;case 4:k[2]=C.getDouble();break;case 3:k[3]=C.getDouble();break;default:C.skip()}return k}function f(C){const k=[0,0,0,0];for(C=C.asUnsafe();C.next();)switch(C.tag()){case 1:k[0]=C.getDouble();break;case 2:k[1]=C.getDouble();break;case 4:k[2]=C.getDouble();break;case 3:k[3]=C.getDouble();break;default:C.skip()}return k}function b(C){const k=
{originPosition:0>=S.length?null:S[0]};for(C=C.asUnsafe();C.next();)switch(C.tag()){case 1:var y=C.getEnum();k.originPosition=y>=S.length?null:S[y];break;case 2:k.scale=C.processMessage(p);break;case 3:k.translate=C.processMessage(f);break;default:C.skip()}return k}function q(C){const k={};for(C=C.asUnsafe();C.next();)switch(C.tag()){case 1:k.shapeAreaFieldName=C.getString();break;case 2:k.shapeLengthFieldName=C.getString();break;case 3:k.units=C.getString();break;default:C.skip()}return k}function A(C,
k){for(k=k.createSpatialReference();C.next();)switch(C.tag()){case 1:k.wkid=C.getUInt32();break;case 5:k.wkt=C.getString();break;case 2:k.latestWkid=C.getUInt32();break;case 3:k.vcsWkid=C.getUInt32();break;case 4:k.latestVcsWkid=C.getUInt32();break;default:C.skip()}return k}function F(C,k){const y=k.createFeatureResult();C=C.asUnsafe();y.geometryType=0>=k.geometryTypes.length?null:k.geometryTypes[0];let N=!1;for(;C.next();)switch(C.tag()){case 1:y.objectIdFieldName=C.getString();break;case 3:y.globalIdFieldName=
C.getString();break;case 4:y.geohashFieldName=C.getString();break;case 5:y.geometryProperties=C.processMessage(q);break;case 7:var l=C.getEnum();y.geometryType=l>=k.geometryTypes.length?null:k.geometryTypes[l];break;case 8:y.spatialReference=C.processMessageWithArgs(A,k);break;case 10:y.hasZ=C.getBool();break;case 11:y.hasM=C.getBool();break;case 12:y.transform=C.processMessage(b);break;case 9:y.exceededTransferLimit=C.getBool();break;case 13:k.addField(y,C.processMessage(x));break;case 15:N||(k.prepareFeatures(y),
N=!0);k.addFeature(y,C.processMessageWithArgs(E,k,y,y.fields));break;case 2:y.uniqueIdField=C.processMessage(B);break;default:C.skip()}k.finishFeatureResult(y);return y}function L(C,k){const y={};let N=null;for(;C.next();)switch(C.tag()){case 4:N=C.processMessageWithArgs(d);break;case 1:y.featureResult=C.processMessageWithArgs(F,k);break;default:C.skip()}null!=N&&y.featureResult&&k.addQueryGeometry(y,N);return y}const h="esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeString esriFieldTypeDate esriFieldTypeOID esriFieldTypeGeometry esriFieldTypeBlob esriFieldTypeRaster esriFieldTypeGUID esriFieldTypeGlobalID esriFieldTypeXML esriFieldTypeBigInteger esriFieldTypeDateOnly esriFieldTypeTimeOnly esriFieldTypeTimestampOffset".split(" "),
H="sqlTypeBigInt sqlTypeBinary sqlTypeBit sqlTypeChar sqlTypeDate sqlTypeDecimal sqlTypeDouble sqlTypeFloat sqlTypeGeometry sqlTypeGUID sqlTypeInteger sqlTypeLongNVarchar sqlTypeLongVarbinary sqlTypeLongVarchar sqlTypeNChar sqlTypeNVarchar sqlTypeOther sqlTypeReal sqlTypeSmallInt sqlTypeSqlXml sqlTypeTime sqlTypeTimestamp sqlTypeTimestamp2 sqlTypeTinyInt sqlTypeVarbinary sqlTypeVarchar".split(" "),S=["upperLeft","lowerLeft"];a.parseFeatureQuery=function(C,k){try{const y=new w(new Uint8Array(C),new DataView(C));
for(C={};y.next();)switch(y.tag()){case 2:C.queryResult=y.processMessageWithArgs(L,k);break;default:y.skip()}return C}catch(y){throw new c("query:parsing-pbf","Error while parsing FeatureSet PBF payload",{error:y});}};a.parseField=x;a.parseFieldType=n;a.parseTransform=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/query/operations/queryZScale":function(){define(["exports","../../../geometry/support/zscale"],function(a,c){a.applyFeatureSetZUnitScaling=function(w,v,I){if(I?.features&&
I.hasZ&&(w=c.getGeometryZScaler(I.geometryType,v,w.outSpatialReference),null!=w))for(const n of I.features)w(n.geometry)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/featureSources/featureServiceSource/PendingFeatureTile":function(){define(["exports","../../../../../core/asyncUtils","../../../../../geometry/support/aaBoundingRect"],function(a,c,w){class v{constructor(n,g){this.data=n;this.resolution=g;this.state={type:a.StateType.CREATED};this.alive=
!0}process(n){switch(this.state.type){case a.StateType.CREATED:return this.state=this._gotoFetchCount(this.state,n),this.state.task.promise.then(n.resume,n.resume);case a.StateType.FETCHED_COUNT:return this.state=this._gotoFetchFeatures(this.state,n),this.state.task.promise.then(n.resume,n.resume);case a.StateType.FETCHED_FEATURES:this.state=this._goToDone(this.state,n)}return null}get debugInfo(){return{data:this.data,featureCount:this._featureCount,state:this._stateToString}}get _featureCount(){switch(this.state.type){case a.StateType.CREATED:case a.StateType.FETCH_COUNT:return 0;
case a.StateType.FETCHED_COUNT:return this.state.featureCount;case a.StateType.FETCH_FEATURES:return this.state.previous.featureCount;case a.StateType.FETCHED_FEATURES:return this.state.features.length;case a.StateType.DONE:return this.state.previous.features.length}}get _stateToString(){switch(this.state.type){case a.StateType.CREATED:return"created";case a.StateType.FETCH_COUNT:return"fetch-count";case a.StateType.FETCHED_COUNT:return"fetched-count";case a.StateType.FETCH_FEATURES:return"fetch-features";
case a.StateType.FETCHED_FEATURES:return"fetched-features";case a.StateType.DONE:return"done"}}_gotoFetchCount(n,g){return{type:a.StateType.FETCH_COUNT,previous:n,task:c.createTask(async z=>{z=await c.resultOrAbort(g.fetchCount(this,z));this.state.type===a.StateType.FETCH_COUNT&&(this.state=this._gotoFetchedCount(this.state,z.ok?z.value:Infinity))})}}_gotoFetchedCount(n,g){return{type:a.StateType.FETCHED_COUNT,featureCount:g,previous:n}}_gotoFetchFeatures(n,g){return{type:a.StateType.FETCH_FEATURES,
previous:n,task:c.createTask(async z=>{z=await c.resultOrAbort(g.fetchFeatures(this,n.featureCount,z));this.state.type===a.StateType.FETCH_FEATURES&&(this.state=this._gotoFetchedFeatures(this.state,z.ok?z.value:[]))})}}_gotoFetchedFeatures(n,g){return{type:a.StateType.FETCHED_FEATURES,previous:n,features:g}}_goToDone(n,g){g.finish(this,n.features);return{type:a.StateType.DONE,previous:n}}reset(){const n=this.state;this.state={type:a.StateType.CREATED};switch(n.type){case a.StateType.FETCH_COUNT:case a.StateType.FETCH_FEATURES:n.task.abort()}}intersects(n){if(null==
n||!this.data.extent)return!0;w.fromExtent(n,I);return w.intersects(this.data.extent,I)}}a.StateType=void 0;(function(n){n[n.CREATED=0]="CREATED";n[n.FETCH_COUNT=1]="FETCH_COUNT";n[n.FETCHED_COUNT=2]="FETCHED_COUNT";n[n.FETCH_FEATURES=3]="FETCH_FEATURES";n[n.FETCHED_FEATURES=4]="FETCHED_FEATURES";n[n.DONE=5]="DONE"})(a.StateType||(a.StateType={}));const I=w.create();a.PendingFeatureTile=v;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/featureSources/featureServiceSource/FeatureServiceTileStore":function(){define("exports ../../../../../chunks/tslib.es6 ../../../../../core/Accessor ../../../../../core/byteSizeEstimations ../../../../../core/ByteSizeUnit ../../../../../core/SetUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/accessorSupport/ensureType ../../../../../core/arrayUtils ../../../../../core/has ../../../../../core/accessorSupport/decorators/subclass ../../../../../geometry/support/aaBoundingRect ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/data/BoundsStore ../../../../../layers/support/TileInfo ../../../../../layers/support/TileKey ../../../../../rest/query/operations/query ./FeatureServiceTileCache".split(" "),
function(a,c,w,v,I,n,g,z,d,m,x,B,E,p,f,b,q,A){function F(k){return k.reduce((y,N)=>{var l=N.geometry;if(null==l)l=0;else{var O=v.estimateFixedArraySize(l.lengths,4);l=32+v.estimateFixedArraySize(l.coords,8)+O}N=32+l+v.estimateAttributesObjectSize(N.attributes);return y+N},0)}a.FeatureServiceTileStore=class extends w{constructor(k){super(k);this.extent=this.tileInfo=null;this.maximumByteSize=10*I.ByteSizeUnit.MEGABYTES;this._tileBounds=new p.BoundsStore;this._tiles=new A.FeatureServiceTileCache;this._refCounts=
new Map;this._tileFeatureCounts=new Map;this._tmpBoundingRect=B.create()}add(k,y){for(var N of y)this._referenceFeature(N.objectId);y=this.featureStore.upsertMany(y);N=y.map(l=>new Set(Object.keys(l.attributes))).reduce((l,O)=>n.intersection(l,O),new Set(Object.keys(y[0]?.attributes??[])));this._addTileStorage(k,new Set(y.map(l=>l.objectId)),F(y),N);this._tiles.applyByteSizeLimit(this.maximumByteSize,l=>this._removeTileStorage(l))}getAttributesForTile(k){return k?this._tiles.get(k)?.attributeKeys:
null}destroy(){this.clear();this._tileFeatureCounts.clear()}clear(){this.featureStore.clear();this._tileBounds.clear();this._tiles.clear();this._refCounts.clear()}refresh(){this.clear();this._tileFeatureCounts.clear()}processEdits(k,y,N){this._processEditsDelete(k.deletedFeatures.concat(k.updatedFeatures));return this._processEditsRefetch(k.addedFeatures.concat(k.updatedFeatures),y,N)}_addTileStorage(k,y,N,l){const O=k.id;this._tiles.set(O,new L(k,y,N,l));this._tileBounds.set(O,k.extent);this._tileFeatureCounts.set(O,
y.size)}_remove({id:k}){(k=this._tiles.get(k))&&this._removeTileStorage(k)}_removeTileStorage(k){const y=[];for(const N of k.objectIds)this._unreferenceFeature(N)===C.REMOVED&&y.push(N);this.featureStore.removeManyById(y);k=k.data.id;this._tiles.delete(k);this._tileBounds.delete(k)}_processEditsDelete(k){this.featureStore.removeManyById(k);for(const [,y]of this._tiles){for(const N of k)y.objectIds.delete(N);this._tileFeatureCounts.set(y.data.id,y.objectIds.size)}for(const y of k)this._refCounts.delete(y)}async _processEditsRefetch(k,
y,N){k=(await y(k,N)).features;const {hasZ:l,hasM:O}=this.featureStore;for(const u of k)k=E.getBoundsOptimizedGeometry(this._tmpBoundingRect,u.geometry,l,O),null!=k&&this._tileBounds.forEachInBounds(k,D=>{D=this._tiles.get(D);this.featureStore.add(u);const R=u.objectId;D.objectIds.has(R)||(D.objectIds.add(R),this._referenceFeature(R),this._tileFeatureCounts.set(D.data.id,D.objectIds.size))})}process(k,y=()=>!0,N){if(null==this.tileInfo||!k.extent||null!=this.extent&&!B.intersects(B.fromExtent(this.extent,
this._tmpBoundingRect),k.extent))return new H(k);var l=this.getAttributesForTile(k.id);if(n.isSubsetOf(N,l))return new H(k);l=this._createTileTree(k,this.tileInfo);this._simplify(l,y,null,0,1);return this._collectMissingTiles(k,l,this.tileInfo,N)}get debugInfo(){return Array.from(this._tiles.values()).map(({data:k})=>({data:k,featureCount:this._tileFeatureCounts.get(k.id)||0}))}getFeatureCount(k){return this._tileFeatureCounts.get(k.id)??0}async fetchCount(k,y,N,l){const O=this._tileFeatureCounts.get(k.id);
if(null!=O)return O;y=await q.executeQueryForCount(y,N,l);this._tileFeatureCounts.set(k.id,y.data.count);return y.data.count}_createTileTree(k,y){const N=new h(k.level,k.row,k.col);y.updateTileInfo(N,f.ExtrapolateOptions.POWER_OF_TWO);this._tileBounds.forEachInBounds(k.extent,l=>{(l=this._tiles.get(l)?.data)&&this._tilesAreRelated(k,l)&&this._populateChildren(N,l,y,this._tileFeatureCounts.get(l.id)||0)});return N}_tilesAreRelated(k,y){if(!k||!y)return!1;if(k.level===y.level)return k.row===y.row&&
k.col===y.col;const N=k.level<y.level,l=N?k:y;k=N?y:k;y=1<<k.level-l.level;return Math.floor(k.row/y)===l.row&&Math.floor(k.col/y)===l.col}_populateChildren(k,y,N,l){var O=y.level-k.level-1;if(0>O)k.isLeaf=!0;else{var u=y.row>>O,D=y.col>>O;O=(u-(k.row<<1)<<1)+(D-(k.col<<1));var R=k.children[O];null!=R?this._populateChildren(R,y,N,l):(u=new h(k.level+1,u,D),N.updateTileInfo(u,f.ExtrapolateOptions.POWER_OF_TWO),k.children[O]=u,this._populateChildren(u,y,N,l))}}_simplify(k,y,N,l,O){const u=O*O;if(k.isLeaf)return y(this.getFeatureCount(k),
O)?0:(this._remove(k),null!=N&&(N.children[l]=null),u);O/=2;const D=O*O;let R=0;for(let Q=0;Q<k.children.length;Q++){const U=k.children[Q];R+=null!=U?this._simplify(U,y,k,Q,O):D}0===R?this._mergeChildren(k):.18751>1-R/u&&(this._purge(k),null!=N&&(N.children[l]=null),R=u);return R}_mergeChildren(k){const y=new Set;let N=0,l;this._forEachLeaf(k,O=>{const u=this._tiles.get(O.id);if(u){l=l?n.intersection(l,u.attributeKeys):new Set(u.attributeKeys);N+=u.byteSize;for(const D of u.objectIds)y.has(D)||(y.add(D),
this._referenceFeature(D));this._remove(O)}});this._addTileStorage(k,y,N,l??new Set);k.isLeaf=!0;k.children[0]=k.children[1]=k.children[2]=k.children[3]=null;this._tileFeatureCounts.set(k.id,y.size)}_forEachLeaf(k,y){for(const N of k.children)null!=N&&(N.isLeaf?y(N):this._forEachLeaf(N,y))}_purge(k){if(null!=k)if(k.isLeaf)this._remove(k);else for(let y=0;y<k.children.length;y++)this._purge(k.children[y]),k.children[y]=null}_collectMissingTiles(k,y,N,l){k=new S(N,k,this.extent);this._collectMissingTilesRecurse(y,
k,1,l);return k.info}_collectMissingTilesRecurse(k,y,N,l){var O=this.getAttributesForTile(k.id);(O=O&&!n.isSubsetOf(l,O))&&y.addMissing(k.level,k.row,k.col,N);if(!k.isLeaf)if(k.hasChildren)for(N/=2,O=0;O<k.children.length;O++){const u=k.children[O];null==u?y.addMissing(k.level+1,(k.row<<1)+((O&2)>>1),(k.col<<1)+(O&1),N):this._collectMissingTilesRecurse(u,y,N,l)}else O||y.addMissing(k.level,k.row,k.col,N)}_referenceFeature(k){const y=(this._refCounts.get(k)||0)+1;this._refCounts.set(k,y);return 1===
y?C.ADDED:C.UNCHANGED}_unreferenceFeature(k){const y=(this._refCounts.get(k)||0)-1;if(0===y)return this._refCounts.delete(k),C.REMOVED;0<y&&this._refCounts.set(k,y);return C.UNCHANGED}get test(){return{tiles:Array.from(this._tiles.values()).map(k=>`${k.data.id}:[${Array.from(k.objectIds)}]`),featureReferences:Array.from(this._refCounts.keys()).map(k=>`${k}:${this._refCounts.get(k)}`)}}};c.__decorate([g.property({constructOnly:!0})],a.FeatureServiceTileStore.prototype,"featureStore",void 0);c.__decorate([g.property()],
a.FeatureServiceTileStore.prototype,"tileInfo",void 0);c.__decorate([g.property()],a.FeatureServiceTileStore.prototype,"extent",void 0);c.__decorate([g.property()],a.FeatureServiceTileStore.prototype,"maximumByteSize",void 0);a.FeatureServiceTileStore=c.__decorate([x.subclass("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTileStore")],a.FeatureServiceTileStore);class L{constructor(k,y,N,l){this.data=k;this.objectIds=y;this.byteSize=N;this.attributeKeys=l}}class h{constructor(k,
y,N){this.level=k;this.row=y;this.col=N;this.isLeaf=!1;this.extent=null;this.children=[null,null,null,null]}get hasChildren(){return!this.isLeaf&&(null!=this.children[0]||null!=this.children[1]||null!=this.children[2]||null!=this.children[3])}}class H{constructor(k,y=[]){this.missingTiles=y;this.coveredArea=this.fullArea=0;this.coveredArea=this.fullArea=B.area(k.extent)}prepend(k){this.missingTiles=k.missingTiles.concat(this.missingTiles);this.coveredArea+=k.coveredArea;this.fullArea+=k.fullArea}}
class S{constructor(k,y,N){this._tileInfo=k;this._extent=null;this.info=new H(y);null!=N&&(this._extent=B.fromExtent(N))}addMissing(k,y,N,l){k=new b.TileKey(null,k,y,N);this._tileInfo.updateTileInfo(k,f.ExtrapolateOptions.POWER_OF_TWO);null==k.extent||null!=this._extent&&!B.intersects(this._extent,k.extent)||(this.info.missingTiles.push({data:k,resolution:l}),this.info.coveredArea-=B.area(k.extent))}}var C;(function(k){k[k.ADDED=0]="ADDED";k[k.REMOVED=1]="REMOVED";k[k.UNCHANGED=2]="UNCHANGED"})(C||
(C={}));a.ProcessResult=H;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/ByteSizeUnit":function(){define(["exports"],function(a){a.ByteSizeUnit=void 0;var c=a.ByteSizeUnit||(a.ByteSizeUnit={});c[c.KILOBYTES=1024]="KILOBYTES";c[c.MEGABYTES=1048576]="MEGABYTES";c[c.GIGABYTES=1073741824]="GIGABYTES";Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/featureSources/featureServiceSource/FeatureServiceTileCache":function(){define(["exports"],
function(a){class c{constructor(){this._store=new Map;this._byteSize=0}set(w,v){this.delete(w);this._store.set(w,v);this._byteSize+=v.byteSize}delete(w){const v=this._store.get(w);return this._store.delete(w)?(null!=v&&(this._byteSize-=v.byteSize),!0):!1}get(w){this._used(w);return this._store.get(w)}has(w){this._used(w);return this._store.has(w)}clear(){this._store.clear()}applyByteSizeLimit(w,v){for(const [I,n]of this._store){if(this._byteSize<=w)break;this.delete(I);v(n)}}values(){return this._store.values()}[Symbol.iterator](){return this._store[Symbol.iterator]()}_used(w){const v=
this._store.get(w);v&&(this._store.delete(w),this._store.set(w,v))}}a.FeatureServiceTileCache=c;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define("../../../../../chunks/tslib.es6 ../../../../../geometry ../../../../../core/Evented ../../../../../core/promiseUtils ../../../../../core/reactiveUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/accessorSupport/ensureType ../../../../../core/arrayUtils ../../../../../core/has ../../../../../core/accessorSupport/decorators/subclass ../../../../../core/support/UpdatingHandles ../../../../../geometry/SpatialReference ../../../../../layers/graphics/data/FeatureStore ../../../../../layers/graphics/data/QueryEngine ../../../../../layers/support/TileInfo ../../../../../rest/support/Query ../../../../../symbols/support/ElevationInfo ../snappingCandidateElevationAlignment ../snappingCandidateElevationFilter ../symbologySnappingCandidates ./FeatureServiceTiledFetcher ./FeatureServiceTileStore ../../../../../geometry/support/jsonUtils".split(" "),function(a,
c,w,v,I,n,g,z,d,m,x,B,E,p,f,b,q,A,F,L,h,H,S){c=class extends w.EventedAccessor{constructor(){super(...arguments);this._isInitializing=!0;this.remoteClient=null;this._whenSetup=v.createResolver();this._elevationAligner=A.getSnappingCandidateElevationAligner();this._elevationFilter=F.getSnappingCandidateElevationFilter();this._symbologyCandidatesFetcher=L.getSymbologySnappingCandidatesFetcher();this._updatingHandles=new x.UpdatingHandles;this._editsUpdatingHandles=new x.UpdatingHandles;this._pendingApplyEdits=
new Map;this._alignPointsInFeatures=async(k,y)=>{k=await this.remoteClient.invoke("alignElevation",{query:k},{signal:y});v.throwIfAborted(y);return k};this._getSymbologyCandidates=async(k,y)=>{k={candidates:k,spatialReference:this._spatialReference.toJSON()};k=await this.remoteClient.invoke("getSymbologyCandidates",k,{signal:y});v.throwIfAborted(y);return k}}get updating(){return this.updatingExcludingEdits||this._editsUpdatingHandles.updating||this._featureFetcher.updating}get updatingExcludingEdits(){return this._featureFetcher.updatingExcludingEdits||
this._isInitializing||this._updatingHandles.updating}destroy(){this._featureFetcher?.destroy();this._queryEngine?.destroy();this._featureStore?.clear()}async setup(k){if(this.destroyed)return{result:{}};const {geometryType:y,objectIdField:N,timeInfo:l,fieldsIndex:O}=k.serviceInfo;var {hasZ:u}=k;const D=B.fromJSON(k.spatialReference);this._spatialReference=D;this._featureStore=new E({...k.serviceInfo,hasZ:u,hasM:!1});this._queryEngine=new p.QueryEngine({spatialReference:k.spatialReference,featureStore:this._featureStore,
geometryType:y,fieldsIndex:O,hasZ:u,hasM:!1,objectIdField:N,timeInfo:l});this._featureFetcher=new h.FeatureServiceTiledFetcher({store:new H.FeatureServiceTileStore({featureStore:this._featureStore}),url:k.serviceInfo.url,objectIdField:k.serviceInfo.objectIdField,globalIdField:k.serviceInfo.globalIdField,capabilities:k.serviceInfo.capabilities,spatialReference:D,sourceSpatialReference:B.fromJSON(k.serviceInfo.spatialReference)});u="3d"===k.configuration.viewType;this._elevationAligner=A.getSnappingCandidateElevationAligner(u,
{elevationInfo:null!=k.elevationInfo?q.fromJSON(k.elevationInfo):null,alignPointsInFeatures:this._alignPointsInFeatures});this._elevationFilter=F.getSnappingCandidateElevationFilter(u);this.addHandles([I.watch(()=>this._featureFetcher.availability,R=>this.emit("notify-availability",{availability:R}),I.sync),I.watch(()=>this.updating,()=>this._notifyUpdating())]);this._whenSetup.resolve();this._isInitializing=!1;return this.configure(k.configuration)}async configure(k){await this._updatingHandles.addPromise(this._whenSetup.promise);
this._updateFeatureFetcherConfiguration(k);return C}async setSuspended(k,y){await this._updatingHandles.addPromise(this._whenSetup.promise);v.throwIfAborted(y);this._featureFetcher.suspended=k;return C}async updateOutFields(k,y){await this._updatingHandles.addPromise(this._whenSetup.promise);v.throwIfAborted(y);this._featureFetcher.outFields=new Set(k??[]);return C}async fetchCandidates(k,y){await this._whenSetup.promise;v.throwIfAborted(y);if(k.filter){var {distance:N,units:l,spatialRel:O,where:u,
timeExtent:D,objectIds:R}=k.filter;var Q={geometry:k.filter.geometry?S.fromJSON(k.filter.geometry):void 0,distance:N,units:l,spatialRel:O,timeExtent:D,objectIds:R,where:u??"1\x3d1"};Q={...k,query:Q}}else Q={...k,query:{where:"1\x3d1"}};y=y?.signal;var U=await this._queryEngine.executeQueryForSnapping(Q,y);v.throwIfAborted(y);k=await this._elevationAligner.alignCandidates(U.candidates,B.fromJSON(k.point.spatialReference)??B.WGS84,y);v.throwIfAborted(y);U=await this._symbologyCandidatesFetcher.fetch(k,
y);v.throwIfAborted(y);k=0===U.length?k:k.concat(U);return{result:{candidates:this._elevationFilter.filter(Q,k)}}}async updateTiles(k,y){await this._updatingHandles.addPromise(this._whenSetup.promise);v.throwIfAborted(y);this._featureFetcher.tileSize=k.tileSize;this._featureFetcher.tilesOfInterest=k.tiles;this._featureFetcher.tileInfo=null!=k.tileInfo?f.fromJSON(k.tileInfo):null;return C}async refresh(k,y){await this._updatingHandles.addPromise(this._whenSetup.promise);v.throwIfAborted(y);this._featureFetcher.refresh();
return C}async whenNotUpdating(k,y){await this._updatingHandles.addPromise(this._whenSetup.promise);v.throwIfAborted(y);await I.whenOnce(()=>!this.updatingExcludingEdits,y);v.throwIfAborted(y);return C}async getDebugInfo(k,y){v.throwIfAborted(y);return{result:this._featureFetcher.debugInfo}}async beginApplyEdits(k,y){this._updatingHandles.addPromise(this._whenSetup.promise);v.throwIfAborted(y);y=v.createResolver();this._pendingApplyEdits.set(k.id,y);this._featureFetcher.applyEdits(y.promise);this._editsUpdatingHandles.addPromise(y.promise);
return C}async endApplyEdits(k,y){const N=this._pendingApplyEdits.get(k.id);N&&N.resolve(k.edits);v.throwIfAborted(y);return C}async notifyElevationSourceChange(k,y){this._elevationAligner.notifyElevationSourceChange();return C}async notifySymbologyChange(k,y){this._symbologyCandidatesFetcher.notifySymbologyChange();return C}async setSymbologySnappingSupported(k){this._symbologyCandidatesFetcher=L.getSymbologySnappingCandidatesFetcher(k,this._getSymbologyCandidates);return C}_updateFeatureFetcherConfiguration(k){this._featureFetcher.filter=
null!=k.filter?b.fromJSON(k.filter):null;this._featureFetcher.customParameters=k.customParameters}_notifyUpdating(){this.emit("notify-updating",{updating:this.updating})}};a.__decorate([n.property({readOnly:!0})],c.prototype,"updating",null);a.__decorate([n.property({readOnly:!0})],c.prototype,"updatingExcludingEdits",null);a.__decorate([n.property()],c.prototype,"_isInitializing",void 0);c=a.__decorate([m.subclass("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceSnappingSourceWorker")],
c);const C={result:{}};return c});