// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.28/esri/copyright.txt for details.
//>>built
define("exports ../../../support/elevationInfoUtils ../sketch/normalizedPoint ./SnappingAlgorithm ./snappingUtils ./candidates/LineSnappingCandidate ../support/viewUtils ../../support/geometry3dUtils ../../support/geometry2dUtils".split(" "),function(q,l,m,r,n,t,p,u,v){class w extends r.SnappingAlgorithm{snapNewVertex(g,a){var d=a.editGeometryOperations.data.components[0],b=d.edges.length;const e=[];if(1>b)return e;var {spatialReference:f}=a;f=p.vectorToScreenPoint(g,f,l.absoluteHeightElevationInfo,
this.view);const {view:h}=this;b=d=d.edges[b-1];do{if(this.edgeExceedsShortLineThreshold(b,a)){const c=n.editEdgeToSnappingEdge(b,h,a);this._processCandidateProposal(c.left,c.right,g,f,a,e)}b=b.leftVertex.leftEdge}while(b&&b!==d);return e}snapExistingVertex(g,a){const d=[],b=a.vertexHandle;var e=b.component;if(2>e.edges.length)return d;const {view:f}=this;var {spatialReference:h}=a;h=p.vectorToScreenPoint(g,h,l.absoluteHeightElevationInfo,f);var c=b.leftEdge,k=b.rightEdge;c&&k&&this.edgeExceedsShortLineThreshold(c,
a)&&this.edgeExceedsShortLineThreshold(k,a)&&this._processCandidateProposal(m.fromAnyMapPoint(c.leftVertex.pos,f,a),m.fromAnyMapPoint(k.rightVertex.pos,f,a),g,h,a,d);c=e=e.edges[0];do c!==b.leftEdge&&c!==b.rightEdge&&this.edgeExceedsShortLineThreshold(c,a)&&(k=n.editEdgeToSnappingEdge(c,f,a),this._processCandidateProposal(k.left,k.right,g,h,a,d)),c=c.rightVertex.rightEdge;while(c&&c!==e);return d}_processCandidateProposal(g,a,d,b,e,f){const {spatialReference:h,pointer:c}=e;d=m.fromVec3(u.projectPointToLineLike(d,
{start:g,end:a,type:v.LineType.LINE}));n.squaredScreenDistance(b,p.vectorToScreenPoint(d,h,l.absoluteHeightElevationInfo,this.view))<this.squaredProximityThreshold(c)&&f.push(new t.LineSnappingCandidate({lineStart:g,lineEnd:a,targetPoint:d,isDraped:"on-the-ground"===e.elevationInfo?.mode}))}}q.LineSnapper=w;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})});