// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.28/esri/copyright.txt for details.
//>>built
require({cache:{"esri/views/3d/interactive/editingTools/draw/DrawGraphicTool3D":function(){define("exports ../../../../../chunks/tslib.es6 ../../../../../core/colorUtils ../../../../../core/handleUtils ../../../../../core/maybe ../../../../../core/reactiveUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/accessorSupport/ensureType ../../../../../core/arrayUtils ../../../../../core/has ../../../../../core/accessorSupport/decorators/subclass ../../../../../chunks/vec3 ../../../../../chunks/vec3f64 ../../../../../support/elevationInfoUtils ../../../../../symbols/support/ElevationInfo ../../SegmentLabels3D ../../SnappingVisualizer3D ../meshFastUpdateUtils ../settings ../../visualElements/ExtendedLineVisualElement ../../visualElements/OutlineVisualElement ../../visualElements/VerticesVisualElement ../../../layers/graphics/elevationAlignmentUtils ../../../layers/graphics/ElevationContext ../../../layers/graphics/GraphicState ../../../webgl-engine/lib/Material ../../../../draw/DrawGraphicTool ../../../../draw/DrawOperation ../../../../draw/drawSurfaces ../../../../draw/support/helpMessageUtils3d".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m,n,h,q,z,r,D,v,I,p,w,C,F,G,J,L){a.DrawGraphicTool3D=class extends F.DrawGraphicTool{constructor(K){super(K);this._verticalLineVisualElement=this._verticesVisualElement=this._outlineVisualElement=this._createGraphicState=this._activeVertexVisualElement=null;this._settings=new z.Settings({getTheme:()=>this.view.effectiveTheme});this.geometryType=null;this.type="draw-3d"}initialize(){const {mode:K,offset:E}=this.elevationInfo;this.internalGraphicsLayer.elevationInfo=
new m({mode:K,offset:E})}normalizeCtorArgs(K){return K.elevationInfo?K:{...K,elevationInfo:g.getEffectiveElevationInfo(K.hasZ??!0)}}initializeGraphic(K){const {view:E}=this,M=this._createGraphicState=new w.GraphicState({graphic:K});return e.handlesGroup([E.maskOccludee(K),E.trackGraphicState(M),k.watch(()=>({element:this._outlineVisualElement,isDraped:M.isDraped}),({element:O,isDraped:T})=>{O&&(O.isDraped=T)},k.syncAndInitial),this._setupLoadingIndicator(M),...q.meshTransformFastUpdateHandles(M)])}updateDrawMeshTooltipInfo(K){const {graphic:E,
tooltipOptions:M,view:O}=this;K.tooltipOptions=M;K.viewType=O.type;K.helpMessage=L.getDrawMeshHelpMessage(E,this.view);this.updateElevation(K.elevation)}makeDrawOperation(){const {geometryType:K}=this,E="circle"!==K&&"rectangle"!==K;return new G.DrawOperation({view:this.view,manipulators:this.manipulators,geometryType:F.geometryTypeToDrawOperationGeometryType(K),drawingMode:this.mode,hasZ:this.hasZ,defaultZ:this.defaultZ,snapToSceneEnabled:this.snapToScene,drawSurface:new J.SceneDrawSurface(this.view,
this.elevationInfo,[this.internalGraphicsLayer]),elevationDrawSurface:new J.ElevationDrawSurface(this.elevationInfo,this.defaultZ,this.view,this.internalGraphicsLayer),hasM:!1,elevationInfo:this.elevationInfo,snappingManager:this.snappingManager,snappingVisualizer:new h.SnappingVisualizer3D,segmentLabels:E?new n.SegmentLabels3D:null,labelOptions:this.labelOptions,tooltipOptions:this.tooltipOptions,isDraped:this._createGraphicState?this._createGraphicState.isDraped:"on-the-ground"===g.getEffectiveElevationMode(this.hasZ,
this.elevationInfo),cursor:this.cursor})}onActiveVertexChanged(K){const {view:E}=this;if(this._activeVertexVisualElement)return this._activeVertexVisualElement.vertices=[K],this._updateVerticalLineVisualElement(K),e.makeHandle();const M=this._settings,O=M.manipulators.vertex,T=new v.VerticesVisualElement({view:E,spatialReference:E.spatialReference,vertices:[K],elevationInfo:this.internalGraphicsLayer.elevationInfo,size:O.size,outlineSize:O.outlineSize,renderOccluded:O.renderOccluded,attached:!1,isDecoration:!0});
this._activeVertexVisualElement=T;const U=new r.ExtendedLineVisualElement({view:E,extensionType:M.visualElements.zVerticalLine.extensionType,innerWidth:1,attached:!1,writeDepthEnabled:!1,renderOccluded:C.RenderOccludedFlag.OccludeAndTransparent,isDecoration:!0});this._verticalLineVisualElement=U;K=e.handlesGroup([k.watch(()=>M.visualElements.zVerticalLine,ba=>ba.apply(U),k.initial),k.watch(()=>({selectedColor:l.unitRGBAFromColor(M.colors.selected),outlineColor:l.unitRGBAFromColor(M.manipulators.vertex.outlineColor)}),
({selectedColor:ba,outlineColor:la})=>{T.color=ba;T.outlineColor=la},k.initial),e.makeHandle(()=>{this._activeVertexVisualElement=d.destroyMaybe(this._activeVertexVisualElement);this._verticalLineVisualElement=d.destroyMaybe(this._verticalLineVisualElement)})]);T.attached=!0;return K}_updateVerticalLineVisualElement(K){const E=this._verticalLineVisualElement;if(E){var {renderCoordsHelper:M,elevationProvider:O}=this.view;A.set(H,K[0],K[1],K[2]);x.setFromElevationInfo(this.elevationInfo);H[2]=I.evaluateElevationAlignmentAtPoint(H,
O,x,M);M.toRenderCoords(H,this.view.spatialReference,H)?(E.setStartEndFromWorldDownAtLocation(H),E.attached=!0):E.attached=!1}}onOutlineChanged(K){if(this._outlineVisualElement)return this._outlineVisualElement.geometry=K,e.makeHandle();const E=this.internalGraphicsLayer.elevationInfo,{view:M}=this,O=this._settings,T=new D.OutlineVisualElement({view:M,geometry:K,elevationInfo:E,isDraped:this._createGraphicState?this._createGraphicState.isDraped:"on-the-ground"===g.getEffectiveElevationMode(this.hasZ,
E),attached:!1,isDecoration:!0});this._outlineVisualElement=T;K=e.handlesGroup([k.watch(()=>O.visualElements.lineGraphics.outline,U=>U.apply(T),k.initial),k.watch(()=>O.visualElements.lineGraphics.shadowStyle,U=>U.apply(T),k.initial),e.makeHandle(()=>{this._outlineVisualElement=d.destroyMaybe(this._outlineVisualElement)})]);T.attached=!0;T.laserlineEnabled=!0;return K}onRegularVerticesChanged(K){if(this._verticesVisualElement)return this._verticesVisualElement.vertices=K,e.makeHandle();const {view:E}=
this,M=this._settings,O=M.manipulators.vertex,T=new v.VerticesVisualElement({view:E,spatialReference:E.spatialReference,vertices:K,elevationInfo:this.internalGraphicsLayer.elevationInfo,size:O.size,outlineSize:O.outlineSize,renderOccluded:O.renderOccluded,attached:!1,isDecoration:!0});K=e.handlesGroup([k.watch(()=>({color:l.unitRGBAFromColor(M.manipulators.vertex.color),outlineColor:l.unitRGBAFromColor(M.manipulators.vertex.outlineColor)}),({color:U,outlineColor:ba})=>{T.color=U;T.outlineColor=ba},
k.initial),e.makeHandle(()=>{this._verticesVisualElement=d.destroyMaybe(this._verticesVisualElement)})]);T.attached=!0;this._verticesVisualElement=T;return K}updateGraphicGeometry(K,E){if("mesh"===this.geometryType&&"point"===E?.type){const M=this.geometryToPlace;M&&M.centerAt(E);M&&K.geometry===M?M.vertexSpace.isGeoreferenced?K.notifyGeometryChanged():K.notifyMeshTransformChanged():K.geometry=M}else super.updateGraphicGeometry(K,E)}_setupLoadingIndicator(K){const {drawOperation:E}=this;if(!this.geometryToPlace)return E.loading=
!1,null;E.loading=!0;const M=e.makeHandle(()=>{E.loading=!1});let O=void 0;return e.handlesGroup([k.when(()=>K.displaying,()=>{O&&cancelAnimationFrame(O);O=requestAnimationFrame(()=>M.remove())},{...k.syncAndInitial,once:!0}),e.makeHandle(()=>O&&cancelAnimationFrame(O)),M])}};c.__decorate([t.property({constructOnly:!0})],a.DrawGraphicTool3D.prototype,"elevationInfo",void 0);c.__decorate([t.property({constructOnly:!0})],a.DrawGraphicTool3D.prototype,"geometryType",void 0);c.__decorate([t.property()],
a.DrawGraphicTool3D.prototype,"type",void 0);c.__decorate([t.property({constructOnly:!0})],a.DrawGraphicTool3D.prototype,"view",void 0);a.DrawGraphicTool3D=c.__decorate([B.subclass("esri.views.3d.interactive.editingTools.draw.DrawGraphicTool3D")],a.DrawGraphicTool3D);const x=new p.ElevationContext,H=b.create();Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/SegmentLabels3D":function(){define("exports ../../../chunks/tslib.es6 ../../../core/screenUtils ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/Error ../../../core/accessorSupport/decorators/subclass ../../../chunks/vec3f64 ../../interactive/SegmentLabels ../../interactive/support/viewUtils".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A){a.SegmentLabels3D=class extends B.SegmentLabels{getCameraOrExtent({view:g}){return g.state.camera}toScreenPointArray({view:g,elevationInfo:m,editGeometryOperations:n},h,q=l.createScreenPointArray()){({spatialReference:n}=n.data.coordinateHelper);A.vectorToRender(h,n,m,g,b);g.state.camera.projectToScreen(b,q);return q}};a.SegmentLabels3D=c.__decorate([f.subclass("esri.views.3d.interactive.SegmentLabels3D")],a.SegmentLabels3D);const b=y.create();Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/SegmentLabels":function(){define("exports ../../chunks/tslib.es6 ../../Color ../../core/Accessor ../../core/asyncUtils ../../core/colorUtils ../../core/handleUtils ../../core/promiseUtils ../../core/quantityFormatUtils ../../core/reactiveUtils ../../core/screenUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../chunks/vec2 ../../chunks/vec2f64 ../../chunks/vec3 ../../geometry/support/coordsUtils ../../intl/messages ../../support/elevationInfoUtils ../../support/getDefaultUnitForView ../overlay/TextOverlayItem ../support/automaticLengthMeasurementUtils".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m,n,h,q,z,r,D,v,I,p,w){const C={default:15,far:25};a.SegmentLabels=class extends e{constructor(x){super(x);this.stagedVertex=this.context=null;this.visible=!0;this.edgeDistance="default";this._messagesUnits=null;this._labelInfos=[];this._nextLabelIndex=0}initialize(){const x=d.createTask(async H=>{const K=await D.fetchMessageBundle("esri/core/t9n/Units");u.throwIfAborted(H);this._messagesUnits=K});this.addHandles([y.watch(()=>[null!=this.context&&this.getCameraOrExtent(this.context),
this.visible,this._edgeDistancePixels,this.stagedVertex,this._messagesUnits],()=>this._update()),...["vertex-add","vertex-update","vertex-remove"].map(H=>y.on(()=>this.context?.editGeometryOperations,H,()=>this._update())),t.makeHandle(()=>x.abort()),y.watch(()=>this._colors,H=>this._updateStyle(H))])}destroy(){for(this._nextLabelIndex=0;this._labelInfos.length;)this._destroyLabel(this._labelInfos.pop())}get updating(){return null==this._messagesUnits}get test(){return{labelContents:this._labelInfos.slice(0,
this._nextLabelIndex).map(x=>x.label.text)}}get _edgeDistancePixels(){return C[this.edgeDistance]}get _colors(){const x=this.context?.view.effectiveTheme.textColor??l.fromArray([255,255,255]),H=k.multiplyOpacity(k.getContrast(x,k.BrightnessThreshold.Low),.6);return{textColor:x,backgroundColor:H}}_update(){if(!this.destroyed){this._nextLabelIndex=0;var x=this.context;if(null!=x){var {components:H,geometry:K,coordinateHelper:E}=x.editGeometryOperations.data;if(K){var M=H.length;for(let U=0;U<M;++U){const ba=
[];H[U].iterateVertices(P=>{ba.push(E.toXYZ(P.pos))});0===U&&null!=this.stagedVertex&&ba.push(E.toXYZ(this.stagedVertex));if(2>ba.length)continue;var O=ba[0],T=ba[ba.length-1];"polygon"===K.type&&2<ba.length&&!z.equals(O,T)&&ba.push(O);T=1===M?!r.isClockwise(ba):!1;let la=J,fa=L;this.toScreenPointArray(x,O,la);for(O=1;O<ba.length;++O){const P=ba[O-1],X=ba[O];this.toScreenPointArray(x,X,fa);this._addLabel(x,P,la,X,fa,T);[la,fa]=[fa,la]}}}}this._destroyUnusedLabels()}}_updateStyle({textColor:x,backgroundColor:H}){const K=
this._nextLabelIndex,E=this._labelInfos;for(let M=0;M<K;++M){const {label:O}=E[M];O.textColor=x;O.backgroundColor=H}}_addLabel(x,H,K,E,M,O){const {label:T}=this._getOrCreateLabel(x);if(!this.visible||3025>h.squaredDistance(K,M))T.visible=!1;else{var U=null!=x.graphicState?x.graphicState.isDraped?"on-the-ground":"absolute-height":v.getGeometryEffectiveElevationMode(x.editGeometryOperations.data.geometry,x.elevationInfo),{spatialReference:ba}=x.editGeometryOperations.data;H=w.autoDirectDistanceByElevationMode(H,
E,ba,U);E=this._messagesUnits;x=I.getDefaultUnitForView(x.view);T.text=null!=E&&null!=H?f.formatLength(E,H,x):"";T.visible=!0;x=M[0]-K[0];H=M[1]-K[1];O?h.set(F,-H,x):h.set(F,H,-x);h.normalize(F,F);h.scale(F,F,this._edgeDistancePixels);h.lerp(G,K,M,.5);h.add(G,G,F);T.position=[G[0],G[1]];T.anchor=Math.abs(F[0])>Math.abs(F[1])?0<F[0]?"left":"right":0>-F[1]?"top":"bottom"}}_getOrCreateLabel(x){var H=this._labelInfos.length>this._nextLabelIndex;const {textColor:K,backgroundColor:E}=this._colors;if(H)return x=
this._labelInfos[this._nextLabelIndex++],{label:H}=x,H.textColor=K,H.backgroundColor=E,x;H=new p({anchor:"center",fontSize:10,textColor:K,backgroundColor:E});x.view.overlay?.items.add(H);x={label:H};this._labelInfos.push(x);this._nextLabelIndex=this._labelInfos.length;return x}_destroyUnusedLabels(){for(;this._labelInfos.length>this._nextLabelIndex;)this._destroyLabel(this._labelInfos.pop())}_destroyLabel({label:x}){this.context?.view.overlay?.items.remove(x);x.destroy()}};c.__decorate([A.property()],
a.SegmentLabels.prototype,"context",void 0);c.__decorate([A.property()],a.SegmentLabels.prototype,"stagedVertex",void 0);c.__decorate([A.property()],a.SegmentLabels.prototype,"visible",void 0);c.__decorate([A.property()],a.SegmentLabels.prototype,"edgeDistance",void 0);c.__decorate([A.property()],a.SegmentLabels.prototype,"updating",null);c.__decorate([A.property()],a.SegmentLabels.prototype,"_messagesUnits",void 0);c.__decorate([A.property()],a.SegmentLabels.prototype,"_edgeDistancePixels",null);
c.__decorate([A.property()],a.SegmentLabels.prototype,"_colors",null);a.SegmentLabels=c.__decorate([n.subclass("esri.views.interactive")],a.SegmentLabels);const F=q.create(),G=q.create(),J=B.createScreenPointArray(),L=B.createScreenPointArray();Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/quantityFormatUtils":function(){define(["exports","./quantityUtils","./unitFormatUtils"],function(a,c,l){function e(n,h,q,z=2,r="abbr"){return l.formatDecimal(n,c.toUnit(h,q).value,
q,z,r)}function d(n,h,q,z=2,r="abbr"){return l.formatRelativeDecimal(n,c.toUnit(h,q).value,q,z,r)}function k(n,h,q=2,z="abbr"){return l.formatMetricLength(n,h.value,h.unit,q,z)}function t(n,h,q=2,z="abbr"){return l.formatMetricRelativeLength(n,h.value,h.unit,q,z)}function u(n,h,q=2,z="abbr"){return l.formatMetricVerticalLength(n,h.value,h.unit,q,z)}function f(n,h,q=2,z="abbr"){return l.formatMetricRelativeVerticalLength(n,h.value,h.unit,q,z)}function y(n,h,q=2,z="abbr"){return l.formatMetricArea(n,
h.value,h.unit,q,z)}function B(n,h,q=2,z="abbr"){return l.formatImperialLength(n,h.value,h.unit,q,z)}function A(n,h,q=2,z="abbr"){return l.formatImperialRelativeLength(n,h.value,h.unit,q,z)}function b(n,h,q=2,z="abbr"){return l.formatImperialVerticalLength(n,h.value,h.unit,q,z)}function g(n,h,q=2,z="abbr"){return l.formatImperialRelativeVerticalLength(n,h.value,h.unit,q,z)}function m(n,h,q=2,z="abbr"){return l.formatImperialArea(n,h.value,h.unit,q,z)}a.formatAngle=function(n,h,q){return l.formatAngleDegrees(n.value,
n.unit,n.rotationType,h,q)};a.formatArea=function(n,h,q,z=2,r="abbr"){switch(q){case "imperial":return m(n,h,z,r);case "metric":return y(n,h,z,r);default:return e(n,h,q,z,r)}};a.formatDMS=function(n){return l.formatDMS(n.value,n.unit)};a.formatDecimal=e;a.formatImperialArea=m;a.formatImperialLength=B;a.formatImperialRelativeLength=A;a.formatImperialRelativeVerticalLength=g;a.formatImperialVerticalLength=b;a.formatLength=function(n,h,q,z,r="abbr"){z=z??2;switch(q){case "imperial":return B(n,h,z,r);
case "metric":return k(n,h,z,r);default:return e(n,h,q,z,r)}};a.formatMetricArea=y;a.formatMetricLength=k;a.formatMetricRelativeLength=t;a.formatMetricRelativeVerticalLength=f;a.formatMetricVerticalLength=u;a.formatRelativeAngle=function(n,h,q){return l.formatRelativeAngleDegrees(n.value,n.unit,n.rotationType,h,q)};a.formatRelativeDecimal=d;a.formatRelativeLength=function(n,h,q,z=2,r="abbr"){switch(q){case "imperial":return A(n,h,z,r);case "metric":return t(n,h,z,r);default:return d(n,h,q,z,r)}};
a.formatRelativeVerticalLength=function(n,h,q,z=2,r="abbr"){switch(q){case "imperial":return g(n,h,z,r);case "metric":return f(n,h,z,r);default:return d(n,h,q,z,r)}};a.formatVerticalLength=function(n,h,q,z=2,r="abbr"){switch(q){case "imperial":return b(n,h,z,r);case "metric":return u(n,h,z,r);default:return e(n,h,q,z,r)}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/quantityUtils":function(){define(["exports","./unitUtils"],function(a,c){function l(b,g){return{type:c.unitType(g),
value:b,unit:g}}function e(b,g){return{type:c.unitType(g),value:b,unit:g}}function d(b,g){return{type:c.unitType(g),value:b,unit:g}}function k(b,g,m="arithmetic"){return{type:c.unitType(g),value:b,unit:g,rotationType:m}}function t(b,g){const m=u(b,g);return"angle"===b.type?k(m,g,b.rotationType):l(m,g)}function u(b,g){return c.convertUnit(b.value,b.unit,g)}const f=e(0,"meters"),y=d(0,"square-meters"),B=k(0,"radians"),A=k(0,"degrees");a.convertRotationType=function(b,g,m){if(g===m)return b;switch(m){case "arithmetic":case "geographic":return-b+
90}};a.createAngle=k;a.createArea=d;a.createLength=e;a.createQuantity=l;a.createVolume=function(b,g){return{type:c.unitType(g),value:b,unit:g}};a.isBaseUnit=function(b){return c.isBaseUnit(b.unit)};a.max=function(b,g){return null==b?g:null==g?b:b.value>c.convertUnit(g.value,g.unit,b.unit)?b:g};a.min=function(b,g){return null==b?g:null==g?b:b.value<c.convertUnit(g.value,g.unit,b.unit)?b:g};a.scale=function(b,g){return null==b?null:{...b,value:b.value*g}};a.toBaseUnit=function(b){return t(b,c.baseUnitForUnit(b.unit))};
a.toUnit=t;a.valueInUnit=u;a.zeroDegrees=A;a.zeroMeters=f;a.zeroRadians=B;a.zeroSquareMeters=y;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/unitFormatUtils":function(){define("exports ./ByteSizeUnit ./Cyclical ./mathUtils ./quantityUtils ./string ./unitUtils ../intl/number".split(" "),function(a,c,l,e,d,k,t,u){function f(m,n,h){return m.units[n][h]}function y(m,n,h,q=2,z="abbr"){return`${u.formatNumber(n,{minimumFractionDigits:q,maximumFractionDigits:q,signDisplay:0<
n?"never":"exceptZero"})} ${f(m,h,z)}`}function B(m,n,h,q=2,z="abbr"){return`${u.formatNumber(n,{minimumFractionDigits:q,maximumFractionDigits:q,signDisplay:"exceptZero"})} ${f(m,h,z)}`}function A(m,n){const h=JSON.stringify(n);let q=b.get(h);q||(q=new Intl.NumberFormat("en-US",n),b.set(h,q));return/\-?\+?360/.test(q.format(m))?0:m}const b=new Map,g=["B","kB","MB","GB","TB"];a.formatAngleDegrees=function(m,n,h,q,z){z=z??2;m=l.cyclicalDegrees.normalize(d.convertRotationType(t.convertUnit(m,n,"degrees"),
h,q),0,!0);z={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:z,minimumFractionDigits:z,signDisplay:0<m?"never":"exceptZero"};m=A(m,z);return u.formatNumber(m,z)};a.formatDMS=function(m,n,h=2){m=t.convertUnit(m,n,"degrees");n=m-Math.floor(m);m-=n;n*=60;let q=n-Math.floor(n);n-=q;q*=60;return`${m.toFixed()}\u00b0 ${n.toFixed()}' ${q.toFixed(h)}"`};a.formatDecimal=y;a.formatFileSize=function(m,n){n=Math.round(n);let h=0===n?0:Math.floor(Math.log(n)/Math.log(c.ByteSizeUnit.KILOBYTES));
h=e.clamp(h,0,g.length-1);n=u.formatNumber(n/c.ByteSizeUnit.KILOBYTES**h,{maximumFractionDigits:2});return k.replace(m.units.bytes[g[h]],{fileSize:n})};a.formatImperialArea=function(m,n,h,q=2,z="abbr"){const r=t.adaptiveImperialAreaUnit(n,h);return y(m,t.convertUnit(n,h,r),r,q,z)};a.formatImperialLength=function(m,n,h,q=2,z="abbr"){const r=t.adaptiveImperialLengthUnit(n,h);return y(m,t.convertUnit(n,h,r),r,q,z)};a.formatImperialRelativeLength=function(m,n,h,q=2,z="abbr"){const r=t.adaptiveImperialLengthUnit(n,
h);return B(m,t.convertUnit(n,h,r),r,q,z)};a.formatImperialRelativeVerticalLength=function(m,n,h,q=2,z="abbr"){const r=t.adaptiveImperialVerticalLengthUnit(n,h);return B(m,t.convertUnit(n,h,r),r,q,z)};a.formatImperialVerticalLength=function(m,n,h,q=2,z="abbr"){const r=t.adaptiveImperialVerticalLengthUnit(n,h);return y(m,t.convertUnit(n,h,r),r,q,z)};a.formatMetricArea=function(m,n,h,q=2,z="abbr"){const r=t.adaptiveMetricAreaUnit(n,h);return y(m,t.convertUnit(n,h,r),r,q,z)};a.formatMetricLength=function(m,
n,h,q=2,z="abbr"){const r=t.adaptiveMetricLengthUnit(n,h);return y(m,t.convertUnit(n,h,r),r,q,z)};a.formatMetricRelativeLength=function(m,n,h,q=2,z="abbr"){const r=t.adaptiveMetricLengthUnit(n,h);return B(m,t.convertUnit(n,h,r),r,q,z)};a.formatMetricRelativeVerticalLength=function(m,n,h,q=2,z="abbr"){const r=t.adaptiveMetricVerticalLengthUnit(n,h);return B(m,t.convertUnit(n,h,r),r,q,z)};a.formatMetricVerticalLength=function(m,n,h,q=2,z="abbr"){const r=t.adaptiveMetricVerticalLengthUnit(n,h);return y(m,
t.convertUnit(n,h,r),r,q,z)};a.formatRelativeAngleDegrees=function(m,n,h,q,z){h!==q&&(m=-m);z=z??2;h={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:z,minimumFractionDigits:z,signDisplay:"exceptZero"};m=t.convertUnit(m,n,"degrees")%360;m=A(m,h);return u.formatNumber(m,h)};a.formatRelativeDecimal=B;a.unitName=f;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/support/getDefaultUnitForView":function(){define(["exports","../core/unitUtils","../portal/Portal"],
function(a,c,l){a.getDefaultUnitForView=function(e){if(null==e)return"metric";var d=e.map;d=(d&&"portalItem"in d?d.portalItem?.portal:null)??l.getDefault();switch(d.user?.units??d.units){case "metric":return"metric";case "english":return"imperial"}return c.getDefaultUnitSystem(e.spatialReference)??"metric"};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/overlay/TextOverlayItem":function(){define("../../chunks/tslib.es6 ../../Color ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../libs/maquette/projection ../../libs/maquette/h ../../libs/maquette/projector".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B){const A={bottom:"esri-text-overlay-item-anchor-bottom","bottom-right":"esri-text-overlay-item-anchor-bottom-right","bottom-left":"esri-text-overlay-item-anchor-bottom-left",top:"esri-text-overlay-item-anchor-top","top-right":"esri-text-overlay-item-anchor-top-right","top-left":"esri-text-overlay-item-anchor-top-left",center:"esri-text-overlay-item-anchor-center",right:"esri-text-overlay-item-anchor-right",left:"esri-text-overlay-item-anchor-left"};l=class extends l{get position(){return[this.x,
this.y]}set position(m){this._set("x",m[0]);this._set("y",m[1])}get _textShadowColor(){const {textColor:m,backgroundColor:n}=this,h=n.clone();h.a*=m.a;return h}get _textShadow(){const m=this._textShadowColor.toCss(!0);return`0 0 ${this._textShadowSize}px ${m}`}get _padding(){return.5*this.fontSize}get _borderRadius(){return this._padding}constructor(m){super(m);this.y=this.x=0;this.text="-";this.fontSize=14;this.anchor="center";this.isDecoration=this.visible=!0;this.backgroundColor=new c([0,0,0,.6]);
this.textColor=new c([255,255,255]);this._textShadowSize=1}render(){return y.h("div",{classes:this._cssClasses(),styles:{left:Math.floor(this.x)+"px",top:Math.floor(this.y)+"px",visibility:this.visible?"visible":"hidden",fontSize:this.fontSize+"px",lineHeight:this.fontSize+"px",backgroundColor:this.backgroundColor.toCss(!0),color:this.textColor.toCss(!0),padding:this._padding+"px",borderRadius:this._borderRadius+"px",textShadow:this._textShadow}},[this.text])}renderCanvas(m){if(this.visible){var n=
m.font.replace(/^(.*?)px/,"");m.font=`${this.fontSize}px ${n}`;var h=this._padding,q=this._borderRadius,z=m.measureText(this.text).width,r=this.fontSize;n=b[this.anchor];m.textAlign="center";m.textBaseline="middle";z+=2*h;h=r+2*h;this._roundedRect(m,this.x+n.x*z,this.y+n.y*h,z,h,q);m.fillStyle=this.backgroundColor.toCss(!0);m.fill();q=this.x+(n.x+.5)*z;n=this.y+(n.y+.5)*h;this._renderTextShadow(m,this.text,q,n);m.fillStyle=this.textColor.toCss(!0);m.fillText(this.text,q,n)}}_renderTextShadow(m,n,
h,q){m.lineJoin="miter";m.fillStyle=`rgba(${this._textShadowColor.r}, ${this._textShadowColor.g}, ${this._textShadowColor.b}, ${1/g.length})`;const z=this._textShadowSize;for(const [r,D]of g)m.fillText(n,h+z*r,q+z*D)}_roundedRect(m,n,h,q,z,r){m.beginPath();m.moveTo(n,h+r);m.arcTo(n,h,n+r,h,r);m.lineTo(n+q-r,h);m.arcTo(n+q,h,n+q,h+r,r);m.lineTo(n+q,h+z-r);m.arcTo(n+q,h+z,n+q-r,h+z,r);m.lineTo(n+r,h+z);m.arcTo(n,h+z,n,h+z-r,r);m.closePath()}_cssClasses(){const m={"esri-text-overlay-item":!0};let n;
for(n in A)m[A[n]]=this.anchor===n;return m}};a.__decorate([e.property()],l.prototype,"x",void 0);a.__decorate([e.property()],l.prototype,"y",void 0);a.__decorate([e.property()],l.prototype,"position",null);a.__decorate([e.property()],l.prototype,"text",void 0);a.__decorate([e.property()],l.prototype,"fontSize",void 0);a.__decorate([e.property()],l.prototype,"anchor",void 0);a.__decorate([e.property()],l.prototype,"visible",void 0);a.__decorate([e.property()],l.prototype,"isDecoration",void 0);a.__decorate([e.property()],
l.prototype,"backgroundColor",void 0);a.__decorate([e.property()],l.prototype,"textColor",void 0);a.__decorate([e.property()],l.prototype,"_textShadowSize",void 0);a.__decorate([e.property()],l.prototype,"_textShadowColor",null);a.__decorate([e.property()],l.prototype,"_textShadow",null);a.__decorate([e.property()],l.prototype,"_padding",null);a.__decorate([e.property()],l.prototype,"_borderRadius",null);l=a.__decorate([u.subclass("esri.views.overlay.TextOverlayItem")],l);const b={bottom:{x:-.5,y:-1,
textAlign:"center",textBaseline:"bottom"},"bottom-left":{x:0,y:-1,textAlign:"left",textBaseline:"bottom"},"bottom-right":{x:-1,y:-1,textAlign:"right",textBaseline:"bottom"},center:{x:-.5,y:-.5,textAlign:"center",textBaseline:"middle"},left:{x:0,y:-.5,textAlign:"left",textBaseline:"middle"},right:{x:-1,y:-.5,textAlign:"right",textBaseline:"middle"},top:{x:-.5,y:0,textAlign:"center",textBaseline:"top"},"top-left":{x:0,y:0,textAlign:"left",textBaseline:"top"},"top-right":{x:-1,y:0,textAlign:"right",
textBaseline:"top"}},g=[];for(a=0;360>a;a+=22.5)g.push([Math.cos(Math.PI*a/180),Math.sin(Math.PI*a/180)]);return l})},"esri/libs/maquette/h":function(){define(["exports"],function(a){let c=(l,e,d)=>{for(let k=0,t=e.length;k<t;k++){let u=e[k];Array.isArray(u)?c(l,u,d):null!==u&&void 0!==u&&!1!==u&&("string"===typeof u&&(u={vnodeSelector:"",properties:void 0,children:void 0,text:u.toString(),domNode:null}),d.push(u))}};a.h=function(l,e,d){if(Array.isArray(e))d=e,e=void 0;else if(e&&("string"===typeof e||
e.hasOwnProperty("vnodeSelector"))||d&&("string"===typeof d||d.hasOwnProperty("vnodeSelector")))throw Error("h called with invalid arguments");let k,t;d&&1===d.length&&"string"===typeof d[0]?k=d[0]:d&&(t=[],c(l,d,t),0===t.length&&(t=void 0));return{vnodeSelector:l,properties:e,children:t,text:""===k?void 0:k,domNode:null}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/automaticLengthMeasurementUtils":function(){define(["exports","./euclideanLengthMeasurementUtils",
"./geodesicLengthMeasurementUtils"],function(a,c,l){function e(d,k,t,u,...f){return"on-the-ground"===u?(d=k.apply(void 0,f),null!=d?d:t.apply(void 0,f)):d.apply(void 0,f)}a.autoDirectDistanceByElevationMode=function(d,k,t,u){return e(c.euclideanDirectDistance,l.geodesicDistance,c.euclideanHorizontalDistance,u,d,k,t)};a.autoDirectDistanceByElevationModeBetweenPoints=function(d,k,t){return e(c.euclideanDirectDistanceBetweenPoints,l.geodesicDistanceBetweenPoints,c.euclideanHorizontalDistanceBetweenPoints,
t,d,k)};a.autoDistanceBetweenPoints2D=function(d,k){return e(c.euclideanHorizontalDistanceBetweenPoints,l.geodesicDistanceBetweenPoints,c.euclideanHorizontalDistanceBetweenPoints,"on-the-ground",d,k)};a.autoHorizontalDistanceByElevationMode=function(d,k,t,u){return e(c.euclideanHorizontalDistance,l.geodesicDistance,c.euclideanHorizontalDistance,u,d,k,t)};a.autoHorizontalDistanceByElevationModeBetweenPoints=function(d,k,t){return e(c.euclideanHorizontalDistanceBetweenPoints,l.geodesicDistanceBetweenPoints,
c.euclideanHorizontalDistanceBetweenPoints,t,d,k)};a.autoLength2D=function(d){return e(c.euclideanLength,l.geodesicLength,c.euclideanHorizontalLength,"on-the-ground",d)};a.autoLengthByElevationMode=function(d,k){return e(c.euclideanLength,l.geodesicLength,c.euclideanHorizontalLength,k,d)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/euclideanLengthMeasurementUtils":function(){define("exports ../../core/quantityUtils ../../core/unitUtils ../../chunks/vec3 ../../chunks/vec3f64 ../../geometry/projection/projectVectorToVector ../../geometry/support/spatialReferenceUtils ./measurementUtils".split(" "),
function(a,c,l,e,d,k,t,u){function f(v,I){const {hasZ:p,spatialReference:w}=v;var C=u.computeEuclideanMeasurementSR(w);let F=0;C=l.lengthUnitFromSpatialReference(C);if(null==C)return null;I=I===n.Direct?B:A;for(const J of v.paths)if(!(2>J.length)){v=J.length-1;for(let L=0;L<v;++L){var G=J[L];h[0]=G[0];h[1]=G[1];h[2]=p?G[2]:0;G=J[L+1];q[0]=G[0];q[1]=G[1];q[2]=p?G[2]:0;G=I(h,q,w);if(null==G)return null;F+=G.value}}return c.createLength(F,C)}function y(v,I,p){v=m(v,I,p);return null!=v?{direct:c.createLength(v.direct,
v.unit),horizontal:c.createLength(v.horizontal,v.unit),vertical:c.createLength(v.vertical,v.unit)}:null}function B(v,I,p){v=m(v,I,p,n.Direct);return null!=v?c.createLength(v.direct,v.unit):null}function A(v,I,p){v=m(v,I,p,n.Horizontal);return null!=v?c.createLength(v.horizontal,v.unit):null}function b(v,I,p){v=m(v,I,p,n.Vertical);return null!=v?c.createLength(v.verticalSigned,v.unit):null}function g(v,I){I=l.verticalLengthUnitFromSpatialReference(I);return null!=I?c.createLength(v[2],I):null}function m(v,
I,p,w){const C=u.computeEuclideanMeasurementSR(p),F=l.lengthUnitFromSpatialReference(C);if(null==F)return null;const G=I[2]-v[2];if(w===n.Vertical)return{verticalSigned:G,unit:F};if(!k.projectVectorToVector(v,p,z,C)||!k.projectVectorToVector(I,p,r,C))return null;if(w===n.Direct)return{direct:e.distance(r,z),unit:F};e.set(D,v[0],v[1],I[2]);if(!k.projectVectorToVector(D,p,D,C))return null;v=e.distance(D,r);return w===n.Horizontal?{horizontal:v,unit:F}:{direct:e.distance(r,z),horizontal:v,vertical:Math.abs(G),
unit:F}}var n;(function(v){v[v.Direct=0]="Direct";v[v.Horizontal=1]="Horizontal";v[v.Vertical=2]="Vertical"})(n||(n={}));const h=d.create(),q=d.create(),z=d.create(),r=d.create(),D=d.create();a.elevation=g;a.elevationOfPoint=function(v){h[0]=v.x;h[1]=v.y;h[2]=v.hasZ?v.z:0;return g(h,v.spatialReference)};a.euclideanDirectDistance=B;a.euclideanDirectDistanceBetweenPoints=function(v,I){const {spatialReference:p}=v;if(!t.equals(p,I.spatialReference))return null;h[0]=v.x;h[1]=v.y;h[2]=v.hasZ?v.z:0;q[0]=
I.x;q[1]=I.y;q[2]=I.hasZ?I.z:0;return B(h,q,p)};a.euclideanDistance=y;a.euclideanDistanceBetweenPoints=function(v,I){const {spatialReference:p}=v;if(!t.equals(p,I.spatialReference))return null;h[0]=v.x;h[1]=v.y;h[2]=v.hasZ?v.z:0;q[0]=I.x;q[1]=I.y;q[2]=I.hasZ?I.z:0;return y(h,q,p)};a.euclideanHorizontalDistance=A;a.euclideanHorizontalDistanceBetweenPoints=function(v,I){const {spatialReference:p}=v;if(!t.equals(p,I.spatialReference))return null;h[0]=v.x;h[1]=v.y;h[2]=v.hasZ?v.z:0;q[0]=I.x;q[1]=I.y;
q[2]=I.hasZ?I.z:0;return A(h,q,p)};a.euclideanHorizontalLength=function(v){return f(v,n.Horizontal)};a.euclideanLength=function(v){return f(v,n.Direct)};a.verticalDistance=function(v,I,p){v=m(v,I,p,n.Vertical);return null!=v?c.createLength(Math.abs(v.verticalSigned),v.unit):null};a.verticalSignedDistance=b;a.verticalSignedDistanceBetweenPoints=function(v,I){const {spatialReference:p}=v;if(!t.equals(p,I.spatialReference))return null;h[0]=v.x;h[1]=v.y;h[2]=v.hasZ?v.z:0;q[0]=I.x;q[1]=I.y;q[2]=I.hasZ?
I.z:0;return b(h,q,p)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/measurementUtils":function(){define(["exports","../../geometry/projection","../../geometry/spatialReferenceEllipsoidUtils"],function(a,c,l){a.computeEuclideanMeasurementSR=function(e){var d=l.getSphericalPCPF(e);d=d===l.SphericalECEFSpatialReference?l.WGS84ECEFSpatialReference:d;return c.canProjectWithoutEngine(e,d)?d:e};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/geodesicLengthMeasurementUtils":function(){define("exports ../../core/quantityUtils ../../chunks/vec3f64 ../../geometry/geometryEngine ../../geometry/projection/projectPolylineToWGS84ComparableLonLat ../../geometry/projection/projectVectorToWGS84ComparableLonLat ../../geometry/support/geodesicUtils ../../geometry/support/spatialReferenceUtils ./geodesicMeasurementUtils".split(" "),
function(a,c,l,e,d,k,t,u,f){function y(v,I,p){return f.geodesicMeasure(p,B,A,b,v,I,p)}function B(v,I,p){return c.createLength(t.inverseGeodeticSolver(h,v,I,p).distance,"meters")}function A(v,I,p){return c.createLength(e.geodesicLength({type:"polyline",spatialReference:p,paths:[[[...v],[...I]]]},"meters"),"meters")}function b(v,I,p){return k.projectVectorToWGS84ComparableLonLat(v,p,r)&&k.projectVectorToWGS84ComparableLonLat(I,p,D)?c.createLength(t.inverseGeodeticSolver(h,r,D).distance,"meters"):null}
function g(v){return c.createLength(t.geodesicLengths([v],"meters")[0],"meters")}function m(v){return c.createLength(e.geodesicLength(v,"meters"),"meters")}function n(v){var I=[];if(!d.projectPolylineToWGS84ComparableLonLat(v,I))return null;v=0;for(const p of I){I=0;for(let w=1;w<p.length;++w)I+=t.inverseGeodeticSolver(h,p[w-1],p[w]).distance;v+=I}return c.createLength(v,"meters")}const h=new t.InverseGeodeticSolverResult,q=l.create(),z=l.create(),r=l.create(),D=l.create();a.geodesicDistance=y;a.geodesicDistanceBetweenPoints=
function(v,I){if(!u.equals(v.spatialReference,I.spatialReference))return null;const {spatialReference:p}=v;q[0]=v.x;q[1]=v.y;q[2]=v.hasZ?v.z:0;z[0]=I.x;z[1]=I.y;z[2]=I.hasZ?I.z:0;return y(q,z,p)};a.geodesicLength=function(v){const {spatialReference:I}=v;return f.geodesicMeasure(I,g,m,n,v)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/projection/projectPolylineToWGS84ComparableLonLat":function(){define(["exports","../../chunks/vec3","../../chunks/vec3f64","./projectors"],
function(a,c,l,e){const d=l.create();a.projectPolylineToWGS84ComparableLonLat=function({hasZ:k,spatialReference:t,paths:u},f,y=0){t=e.getWGS84ComparableLonLatProjector(t);if(null==t)return!1;k=k?B=>B:B=>c.set(d,B[0],B[1],y);for(const B of u){u=[];for(const A of B){const b=[0,0,y];t(k(A),0,b,0);u.push(b)}f.push(u)}return!0};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/geodesicUtils":function(){define("exports ../../geometry ../../core/Error ../../core/unitUtils ./geodesicConstants ./spatialReferenceUtils ../Polyline ../Polygon ../Point ../SpatialReference".split(" "),
function(a,c,l,e,d,k,t,u,f,y){function B(r){if(!r)return null;if(k.isGeographic(r)&&r.wkid){var D=d.spheroids[r.wkid];if(D)return D}if(r=r.wkt2||r.wkt)if((r=d.wktSpheroidRegex.exec(r))&&2===r.length?(D=r[1].split(","),!D||3>D.length?r=null:(r=parseFloat(D[1]),D=parseFloat(D[2]),r=isNaN(r)||isNaN(D)?null:{a:r,f:0===D?0:1/D})):r=null,r)return r;return null}function A(r){r=B(r??y.WGS84);if(null!=r&&"b"in r&&"eSq"in r&&"radius"in r)return r;const D=r.a*(1-r.f);return Object.assign(r,{b:D,eSq:1-(D/r.a)**
2,radius:(2*r.a+D)/3,densificationRatio:1E4/((2*r.a+D)/3)})}function b(r){return null!=r&&0>r?r+360:r}function g(r,D,v){const {a:I,eSq:p}=A(v);v=Math.sqrt(p);const w=Math.sin(D[1]*d.toRadians);D=I*D[0]*d.toRadians;v=0<p?I*(1-p)*(w/(1-p*w*w)-1/(2*v)*Math.log((1-v*w)/(1+v*w)))*.5:I*w;r[0]=D;r[1]=v;return r}function m(r){return null!==B(r)}function n(r,D){if("polyline"!==r.type&&"polygon"!==r.type)throw new l("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");const {spatialReference:v}=
r;if(!m(v))throw new l("geodesic-densify:invalid-spatial-reference","the input geometry spatial reference is not supported");var I="polyline"===r.type?r.paths:r.rings;const p=[],w=[0,0],C=new z;for(const J of I){I=[];p.push(I);I.push([J[0][0],J[0][1]]);var F=J[0][0],G=J[0][1];let L,x;for(let H=0;H<J.length-1;H++){L=J[H+1][0];x=J[H+1][1];if(F===L&&G===x)continue;const K=[F,G];q(C,[F,G],[L,x],v);const {azimuth:E,distance:M}=C;F=M/D;if(1<F){for(G=1;G<=F-1;G++)h(w,K,E,G*D,v),I.push(w.slice(0));h(w,K,
E,(M+Math.floor(F-1)*D)/2,v);I.push(w.slice(0))}h(w,K,E,M,v);I.push(w.slice(0));F=w[0];G=w[1]}}return"polyline"===r.type?new t({paths:p,spatialReference:v}):new u({rings:p,spatialReference:v})}function h(r,D,v,I,p){const w=D[0]*d.toRadians;D=D[1]*d.toRadians;v=(v??0)*d.toRadians;const {a:C,b:F,f:G}=A(p);p=Math.sin(v);v=Math.cos(v);var J=(1-G)*Math.tan(D);D=1/Math.sqrt(1+J*J);const L=J*D,x=Math.atan2(J,v);J=D*p;const H=J*J;var K=1-H,E=K*(C*C-F*F)/(F*F);const M=1+E/16384*(4096+E*(-768+E*(320-175*E))),
O=E/1024*(256+E*(-128+E*(74-47*E)));E=I/(F*M);let T=2*Math.PI,U,ba,la,fa;for(;1E-12<Math.abs(E-T);)la=Math.cos(2*x+E),U=Math.sin(E),ba=Math.cos(E),fa=O*U*(la+O/4*(ba*(-1+2*la*la)-O/6*la*(-3+4*U*U)*(-3+4*la*la))),T=E,E=I/(F*M)+fa;I=L*U-D*ba*v;K=G/16*K*(4+G*(4-3*K));I=Math.atan2(L*ba+D*U*v,(1-G)*Math.sqrt(H+I*I))/d.toRadians;r[0]=(w+(Math.atan2(U*p,D*ba-L*U*v)-(1-K)*G*J*(E+K*U*(la+K*ba*(-1+2*la*la)))))/d.toRadians;r[1]=I;return r}function q(r,D,v,I){var p=D[0]*d.toRadians;D=D[1]*d.toRadians;var w=v[0]*
d.toRadians;v=v[1]*d.toRadians;const {a:C,b:F,f:G,radius:J}=A(I),L=w-p;var x=Math.atan((1-G)*Math.tan(D)),H=Math.atan((1-G)*Math.tan(v));I=Math.sin(x);x=Math.cos(x);const K=Math.sin(H);H=Math.cos(H);let E=1E3,M=L,O,T,U;let ba,la,fa;do{var P=Math.sin(M);var X=Math.cos(M);U=Math.sqrt(H*P*H*P+(x*K-I*H*X)*(x*K-I*H*X));if(0===U)return r.distance=0,r.azimuth=void 0,r.reverseAzimuth=void 0,r;X=I*K+x*H*X;ba=Math.atan2(U,X);la=x*H*P/U;T=1-la*la;P=X-2*I*K/T;isNaN(P)&&(P=0);fa=G/16*T*(4+G*(4-3*T));O=M;M=L+(1-
fa)*G*la*(ba+fa*U*(P+fa*X*(-1+2*P*P)))}while(1E-12<Math.abs(M-O)&&0<--E);if(0===E)return I=Math.acos(Math.sin(D)*Math.sin(v)+Math.cos(D)*Math.cos(v)*Math.cos(w-p))*J,p=w-p,r.azimuth=Math.atan2(Math.sin(p)*Math.cos(v),Math.cos(D)*Math.sin(v)-Math.sin(D)*Math.cos(v)*Math.cos(p))/d.toRadians,r.distance=I,r.reverseAzimuth=void 0,r;p=T*(C*C-F*F)/(F*F);D=p/1024*(256+p*(-128+p*(74-47*p)));w=Math.atan2(x*Math.sin(M),x*K*Math.cos(M)-I*H);r.azimuth=Math.atan2(H*Math.sin(M),x*K-I*H*Math.cos(M))/d.toRadians;
r.distance=F*(1+p/16384*(4096+p*(-768+p*(320-175*p))))*(ba-D*U*(P+D/4*(X*(-1+2*P*P)-D/6*P*(-3+4*U*U)*(-3+4*P*P))));r.reverseAzimuth=w/d.toRadians;return r}class z{constructor(r=0,D,v){this.distance=r;this.azimuth=D;this.reverseAzimuth=v}}a.InverseGeodeticSolverResult=z;a.directGeodeticSolver=h;a.geodesicAreas=function(r,D="square-meters"){if(r.some(w=>!m(w.spatialReference)))throw new l("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");const v=[];
for(var I=0;I<r.length;I++){var p=r[I];const {radius:w,densificationRatio:C}=A(p.spatialReference);v.push(n(p,w*C))}r=[];I=[0,0];p=[0,0];for(let w=0;w<v.length;w++){const {rings:C,spatialReference:F}=v[w];let G=0;for(let J=0;J<C.length;J++){const L=C[J];g(I,L[0],F);g(p,L[L.length-1],F);let x=p[0]*I[1]-I[0]*p[1];for(let H=0;H<L.length-1;H++)g(I,L[H+1],F),g(p,L[H],F),x+=p[0]*I[1]-I[0]*p[1];G+=x}G=e.convertUnit(G,"square-meters",D);r.push(G/-2)}return r};a.geodesicDensify=n;a.geodesicDistance=function(r,
D,v="meters"){if(!r||!D)throw new l("geodesic-distance:missing-parameters","one or both input parameters are missing");if(!r.spatialReference||!D.spatialReference)throw new l("geodesic-distance:invalid-parameters","one or both input points do not have a spatial reference");if(!k.equals(r.spatialReference,D.spatialReference))throw new l("geodesic-distance:invalid-parameters","spatial references of input parameters do not match");const {spatialReference:I}=r;if(!m(I))throw new l("geodesic-distance:not-supported",
"input geometry spatial reference is not supported");if(r.x===D.x&&r.y===D.y)return new z(0,0,0);const p=new z;q(p,[r.x,r.y],[D.x,D.y],I);p.distance=e.convertUnit(p.distance,"meters",v);p.azimuth=b(p.azimuth);p.reverseAzimuth=b(p.reverseAzimuth);return p};a.geodesicLengths=function(r,D="meters"){if(!r)throw new l("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(r.some(p=>!m(p.spatialReference)))throw new l("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");
const v=[];for(let p=0;p<r.length;p++){var I=r[p];const {spatialReference:w}=I;I="polyline"===I.type?I.paths:I.rings;let C=0;for(let F=0;F<I.length;F++){const G=I[F];let J=0;for(let L=1;L<G.length;L++){const x=G[L-1][0],H=G[L][0],K=G[L-1][1],E=G[L][1];if(K!==E||x!==H){const M=new z;q(M,[x,K],[H,E],w);J+=M.distance}}C+=J}C=e.convertUnit(C,"meters",D);v.push(C)}return v};a.inverseGeodeticSolver=q;a.isSupported=m;a.pointFromDistance=function(r,D,v){if(!r||null==D||null==v)throw new l("point-from-distance:missing-parameters",
"one or more input parameters are missing or undefined");if(0>v||360<v)throw new l("point-from-distance:-of-bounds","azimuth is restricted to angles between, and including, 0\u00b0 to 360\u00b0 degrees");if(!r.spatialReference)throw new l("point-from-distance:missing-spatial-reference","the input point must have a spatial reference");const {spatialReference:I}=r;if(!m(I))throw new l("geodesic-distance:not-supported","input geometry spatial reference is not supported");const p=[0,0];h(p,[r.x,r.y],
v,D,I);return new f({x:p[0],y:p[1],spatialReference:I})};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/geodesicMeasurementUtils":function(){define(["exports","../../geometry/support/geodesicUtils","../../geometry/support/spatialReferenceUtils"],function(a,c,l){a.geodesicMeasure=function(e,d,k,t,...u){return l.isGeographic(e)&&c.isSupported(e)?d.apply(void 0,u):l.isWebMercator(e)?k.apply(void 0,u):t.apply(void 0,u)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/views/interactive/support/viewUtils":function(){define("exports ../../../core/screenUtils ../../../chunks/vec2 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../layers/graphics/dehydratedPoint ../../../support/elevationInfoUtils".split(" "),function(a,c,l,e,d,k,t){function u(n,h,q,z,r=d.create()){n=h.toXYZ(n);n[2]=t.getConvertedElevationFromVector(z,n,h.spatialReference,q)||0;z.renderCoordsHelper.toRenderCoords(n,h.spatialReference,r);return r}function f(n,h,q,z,r=d.create()){n=e.copy(A,
n);n[2]=t.getConvertedElevationFromVector(z,n,h,q)||0;z.renderCoordsHelper.toRenderCoords(n,h,r);return r}function y(n,h,q,z){if("2d"===z.type)return B.x=n[0],B.y=n[1],B.spatialReference=h,z.toScreen(B);f(n,h,q,z,A);z.state.camera.projectToScreen(A,m);return c.createScreenPoint(m[0],m[1])}const B=k.makeDehydratedPoint(0,0,0,null),A=d.create(),b=c.createRenderScreenPointArray3(),g=c.createRenderScreenPointArray3(),m=c.createScreenPointArray();a.anyMapPointToRender=u;a.anyMapPointToScreenPoint=function(n,
h,q,z){return y(h.toXYZ(n),h.spatialReference,q,z)};a.anyMapPointsToRenderWithEqualRelativeZ=function(n,h,q,z,r,D,v){if("absolute-height"===z.mode)u(n,q,z,r,D),u(h,q,z,r,v);else{n=q.toXYZ(n);h=q.toXYZ(h);var I=t.getConvertedElevationFromVector(r,n,q.spatialReference,z);z=t.getConvertedElevationFromVector(r,h,q.spatialReference,z);z=(null==I?z:null==z?I:Math.min(I,z))||0;n[2]=z;h[2]=z;r.renderCoordsHelper.toRenderCoords(n,q.spatialReference,D);r.renderCoordsHelper.toRenderCoords(h,q.spatialReference,
v)}};a.renderScreenSpaceTangent=function(n,h,q,z){q.projectToRenderScreen(n,b);q.projectToRenderScreen(h,g);l.subtract(z,g,b);l.normalize(z,z)};a.vectorToRender=f;a.vectorToScreenPoint=y;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/SnappingVisualizer3D":function(){define("exports ../../../Color ../../../core/colorUtils ../../../core/has ../../../core/handleUtils ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../geometry/projection/projectVectorToVector ../../../support/elevationInfoUtils ./visualElements/ExtendedLineVisualElement ./visualElements/ParallelLineVisualElement ./visualElements/PointVisualElement ./visualElements/RightAngleQuadVisualElement ../layers/interfaces ../webgl-engine/lib/Material ../../interactive/sketch/normalizedPoint ../../interactive/snapping/Settings ../../interactive/snapping/SnappingDomain ../../interactive/snapping/snappingUtils ../../interactive/snapping/SnappingVisualizer ../../interactive/snapping/hints/LineSnappingHint ../../interactive/support/viewUtils".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m,n,h,q,z,r,D,v){function I(J){({effectiveTheme:J}=J.view);const L=c.toUnitRGBA(J.accentColor),x=[0,0,0,0];return{intersectionPointColor:x,intersectionPointOutlineColor:L,pointColor:x,pointOutlineColor:L,lineColor:L,lineOutlineColor:void 0,parallelSignColor:L,rightAngleColor:L,rightAngleColorDraped:c.toUnitRGBA(l.multiplyOpacity(J.accentColor,.5)),rightAngleOutlineColor:L}}function p(J,L,x){L=C(L,x);return null==L?J:n.create(J[0],J[1],L)}function w(J,L){return null!=
C(J.domain,L)?L.selfSnappingZ.elevationInfo:J.isDraped?f.onTheGroundElevationInfo:f.absoluteHeightElevationInfo}function C(J,{selfSnappingZ:L}){return J===q.SnappingDomain.SELF&&null!=L?L.value:null}function F(J,L,x,H,K,E=t.create()){K?u.projectVectorToVector(J,L,E,H.basemapTerrain.overlayManager.renderer.spatialReference):v.vectorToRender(J,L,x,H,E);return E}class G extends r.SnappingVisualizer{sortUniqueHints(J){return J.sort((L,x)=>(x instanceof D.LineSnappingHint?x.length:0)-(L instanceof D.LineSnappingHint?
L.length:0))}visualizeIntersectionPoint(J,L){const {spatialReference:x,view:H}=L;L=I(L);return d.destroyHandle(new A.PointVisualElement({view:H,primitive:"circle",geometry:n.toDehydratedPoint(J.intersectionPoint,x),elevationInfo:J.isDraped?f.onTheGroundElevationInfo:f.absoluteHeightElevationInfo,size:20,outlineSize:2,color:L.intersectionPointColor,outlineColor:L.intersectionPointOutlineColor,pixelSnappingEnabled:!1,isDecoration:!0,attached:!0}))}visualizePoint(J,L){const {view:x,spatialReference:H}=
L,K=I(L),E=p(J.point,J.domain,L);return d.destroyHandle(new A.PointVisualElement({view:x,primitive:"circle",geometry:n.toDehydratedPoint(E,H),elevationInfo:w(J,L),size:20,outlineSize:2,color:K.pointColor,outlineColor:K.pointOutlineColor,pixelSnappingEnabled:!1,isDecoration:!0,attached:!0}))}visualizeLine(J,L){const {view:x,spatialReference:H}=L,K=I(L),E=p(J.lineStart,J.domain,L),M=p(J.lineEnd,J.domain,L);return d.destroyHandle(this._createLineSegmentHint(J.type,E,M,H,w(J,L),x,K,J.isDraped,J.fadeLeft,
J.fadeRight))}visualizeParallelSign(J,L){const {view:x,spatialReference:H}=L;var K=I(L);const {isDraped:E}=J;var M=w(J,L),O=p(J.lineStart,J.domain,L);J=p(J.lineEnd,J.domain,L);O=F(O,H,M,x,E);M=F(J,H,M,x,E);M=k.lerp(M,O,M,.5);K=new B.ParallelLineVisualElement({view:x,attached:!1,offset:h.defaults.parallelLineHintOffset,length:h.defaults.parallelLineHintLength,width:h.defaults.parallelLineHintWidth,color:K.parallelSignColor,location:M,renderOccluded:E?m.RenderOccludedFlag.OccludeAndTransparent:m.RenderOccludedFlag.Opaque,
isDraped:E,renderGroup:g.DrapedRenderGroup.SnappingHint,isDecoration:!0});K.setDirectionFromPoints(O,M);K.attached=!0;return d.destroyHandle(K)}visualizeRightAngleQuad(J,L){const {view:x,spatialReference:H}=L,K=I(L);var E=w(J,L);const {isDraped:M}=J;var O=p(J.previousVertex,J.domain,L),T=p(J.centerVertex,J.domain,L);J=p(J.nextVertex,J.domain,L);O=F(O,H,E,x,M);T=F(T,H,E,x,M);E=F(J,H,E,x,M);return d.destroyHandle(new b.RightAngleQuadVisualElement({view:x,attached:!0,color:M?K.rightAngleColorDraped:
K.rightAngleColor,renderOccluded:M?m.RenderOccludedFlag.OccludeAndTransparent:m.RenderOccludedFlag.Transparent,outlineRenderOccluded:M?m.RenderOccludedFlag.OccludeAndTransparent:m.RenderOccludedFlag.Opaque,outlineColor:K.rightAngleOutlineColor,outlineSize:h.defaults.rightAngleHintOutlineSize,size:h.defaults.rightAngleHintSize,isDraped:M,geometry:{previous:O,center:T,next:E},renderGroup:g.DrapedRenderGroup.SnappingHint,isDecoration:!0}))}_createLineSegmentHint(J,L,x,H,K,E,M,O=!1,T=!0,U=!0){L=F(L,H,
K,E,O);x=F(x,H,K,E,O);E=new y.ExtendedLineVisualElement({view:E,extensionType:y.ExtensionType.FADED,start:L,end:x,isDraped:O,color:M.lineColor,renderOccluded:O?m.RenderOccludedFlag.OccludeAndTransparent:m.RenderOccludedFlag.Opaque,renderGroup:g.DrapedRenderGroup.SnappingHint,isDecoration:!0});switch(J){case z.LineSegmentHintType.TARGET:E.width=h.defaults.lineHintWidthTarget;E.fadedExtensions={start:0,end:h.defaults.lineHintFadedExtensions};break;case z.LineSegmentHintType.REFERENCE_EXTENSION:E.width=
h.defaults.lineHintWidthReference;E.fadedExtensions={start:0,end:0};break;case z.LineSegmentHintType.REFERENCE:E.width=h.defaults.lineHintWidthReference,E.fadedExtensions={start:T?h.defaults.lineHintFadedExtensions:0,end:U?h.defaults.lineHintFadedExtensions:0}}E.attached=!0;return E}}a.SnappingVisualizer3D=G;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/visualElements/ExtendedLineVisualElement":function(){define("exports ../../../../core/has ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../chunks/vec4 ../../../../chunks/vec4f32 ../../../../geometry/support/clipRay ../../../../geometry/support/frustum ../../../../geometry/support/lineSegment ../../../../geometry/support/ray ./EngineVisualElement ./LaserlineVisualElement ../../terrain/OverlayRenderer ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/Material ../../webgl-engine/lib/RenderGeometry ../../webgl-engine/lib/VertexAttribute ../../webgl-engine/materials/RibbonLineMaterial".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m,n,h,q){class z extends B.EngineVisualElement{constructor(w){super(w);this._ray=y.create();this._isWorldDown=!1;this._start=e.create();this._end=e.fromValues(1,0,0);this._width=1;this._color=k.fromValues(1,0,1,1);this._polygonOffset=!1;this._writeDepthEnabled=!0;this._innerWidth=0;this._innerColor=k.fromValues(1,1,1,1);this._stippleOffColor=this._stipplePattern=null;this._stipplePreferContinuous=!0;this._falloff=0;this._extensionType=a.ExtensionType.LINE;this._laserlineStyle=
null;this._laserlineEnabled=!1;this._renderOccluded=m.RenderOccludedFlag.OccludeAndTransparent;this._fadedExtensions=p;this._laserline=new A.LaserlineVisualElement({view:this.view,isDecoration:w.isDecoration});this.applyProperties(w)}destroy(){this._laserline.destroy();super.destroy()}createObject3DResourceFactory(w){return{view:w,createResources:C=>this._createObject3DResources(C),destroyResources:C=>this._destroyExternalResources(C),recreateGeometry:(C,F)=>this._recreateObject3DGeometry(C,F),cameraChanged:()=>
this._updateGeometry()}}createDrapedResourceFactory(w){return{view:w,createResources:()=>this._createDrapedResources(),destroyResources:C=>this._destroyExternalResources(C),recreateGeometry:C=>this._recreateDrapedGeometry(C)}}updateVisibility(w){super.updateVisibility(w);this._laserline.visible=w}onAttachedChange(){this._laserline.attached=this._laserlineAttached}setStartEndFromWorldDownAtLocation(w){this._isWorldDown=!0;l.copy(this._start,w);this.view.renderCoordsHelper.worldUpAtPosition(w,this._end);
l.subtract(this._end,w,this._end);y.fromPoints(this._start,this._end,this._ray);this._updateGeometry()}get start(){return this._start}set start(w){this._isWorldDown=!1;l.exactEquals(this._start,w)||(l.copy(this._start,w),y.fromPoints(this._start,this._end,this._ray),this._updateGeometry())}get end(){return this._end}set end(w){this._isWorldDown=!1;l.exactEquals(this._end,w)||(l.copy(this._end,w),y.fromPoints(this._start,this._end,this._ray),this._updateGeometry())}get width(){return this._width}set width(w){w!==
this._width&&(this._width=w,this._updateMaterial())}get color(){return this._color}set color(w){d.exactEquals(w,this._color)||(d.copy(this._color,w),this._updateMaterial())}get polygonOffset(){return this._polygonOffset}set polygonOffset(w){w!==this._polygonOffset&&(this._polygonOffset=w,this._updateMaterial())}get writeDepthEnabled(){return this._writeDepthEnabled}set writeDepthEnabled(w){this._writeDepthEnabled!==w&&(this._writeDepthEnabled=w,this._updateMaterial())}get innerWidth(){return this._innerWidth}set innerWidth(w){w!==
this._innerWidth&&(this._innerWidth=w,this._updateMaterial())}get innerColor(){return this._innerColor}set innerColor(w){d.exactEquals(w,this._innerColor)||(d.copy(this._innerColor,w),this._updateMaterial())}get stipplePattern(){return this._stipplePattern}set stipplePattern(w){const C=null!=w!==(null!=this._stipplePattern);this._stipplePattern=w;C?this.recreate():this._updateMaterial()}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(w){null!=w&&null!=this._stippleOffColor&&
d.exactEquals(w,this._stippleOffColor)||(this._stippleOffColor=null!=w?k.clone(w):null,this._updateMaterial())}get stipplePreferContinuous(){return this._stipplePreferContinuous}set stipplePreferContinuous(w){w!==this._stipplePreferContinuous&&(this._stipplePreferContinuous=w,this._updateMaterial())}get falloff(){return this._falloff}set falloff(w){w!==this._falloff&&(this._falloff=w,this._updateMaterial())}get extensionType(){return this._extensionType}set extensionType(w){w!==this._extensionType&&
(this._extensionType=w,this.recreateGeometry())}get _laserlineAttached(){return this._laserlineEnabled&&null!=this._laserlineStyle&&this.attached&&!this.isDraped}get laserlineStyle(){return this._laserlineStyle}set laserlineStyle(w){this._laserlineStyle=w;this._laserline.attached=this._laserlineAttached;null!=w&&(this._laserline.style=w)}get laserlineEnabled(){return this._laserlineEnabled}set laserlineEnabled(w){this._laserlineEnabled!==w&&(this._laserlineEnabled=w,this._laserline.attached=this._laserlineAttached)}get renderOccluded(){return this._renderOccluded}set renderOccluded(w){w!==
this._renderOccluded&&(this._renderOccluded=w,this._updateMaterial())}get _normalizedRenderOccluded(){return this.isDraped&&this._renderOccluded===m.RenderOccludedFlag.OccludeAndTransparentStencil?m.RenderOccludedFlag.OccludeAndTransparent:this._renderOccluded}get fadedExtensions(){return this._fadedExtensions}set fadedExtensions(w){this._fadedExtensions=w??p;this.recreateGeometry()}_updateMaterial(){const {materialParameters:w}=this;this.object3dResources.resources?.material.setParameters(w);this.drapedResources.resources?.material.setParameters(w)}get materialParameters(){return{width:this._width,
color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stipplePreferContinuous:this._stipplePreferContinuous,innerWidth:this._innerWidth,innerColor:this._innerColor,falloff:this._falloff,hasPolygonOffset:this._polygonOffset,renderOccluded:this._normalizedRenderOccluded,isDecoration:this.isDecoration,writeDepth:this._writeDepthEnabled}}_createObject3DResources(w){const C=new q.RibbonLineMaterial(this.materialParameters),F=[];this._createObject3DGeometry(C,w,F);
return{material:C,geometries:F,forEach:G=>{G(C);F.forEach(G)}}}_destroyExternalResources(w){w.geometries=[]}_recreateObject3DGeometry(w,C){w.geometries.length=0;this._createObject3DGeometry(w.material,C,w.geometries)}_createObject3DGeometry(w,C,F){w=this._createGeometry(w);F.push(w);C.addGeometry(w);this._updateVerticesObject3D(C)}_createDrapedResources(){const w=new q.RibbonLineMaterial(this.materialParameters),C=this._createDrapedGeometry(w);return{material:w,geometries:[C]}}_recreateDrapedGeometry(w){w.geometries=
[this._createDrapedGeometry(w.material)]}_createDrapedGeometry(w){w=this._createGeometry(w);this._updateVerticesDraped(w);return new n.RenderGeometry(w)}_createGeometry(w){const C=this.extensionType===a.ExtensionType.FADED,F=C?[e.create(),e.create(),e.create(),e.create()]:[e.create(),e.create()];return g.createPolylineGeometry(w,F,null,C?[1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0]:null)}_updateGeometry(){if(this.isDraped)this.drapedResources.recreateGeometry();else{const w=this.object3dResources.object;w&&
this._updateVerticesObject3D(w)}}_updateVerticesObject3D(w){const C=this._lineSegment;this._updateVertexAttributesObject3D(w,C);this._laserline.intersectsLine=C}_updateVerticesDraped(w){this._updateVertexAttributesDraped(w,this._lineSegment)}get _lineSegment(){return this._extensionType===a.ExtensionType.FADED?this._updateLineSegmentFinite(I):this._updateLineSegmentInfinite(this._extensionType,I)}_updateLineSegmentFinite(w){return f.fromPoints(this._start,this._end,w)}_updateLineSegmentInfinite(w,
C){var F=this.view.state.camera;t.fromRay(this._ray,r);switch(w){case a.ExtensionType.LINE:r.c0=-Number.MAX_VALUE;break;case a.ExtensionType.RAY:case a.ExtensionType.GROUND_RAY:var G=this._ray.origin;w=this.view.elevationProvider.getElevation(G[0],G[1],G[2],this.view.renderCoordsHelper.spatialReference,"ground")??0;G=this.view.renderCoordsHelper.getAltitude(G);this._isWorldDown&&G<w&&l.negate(r.ray.direction,r.ray.direction);this._extensionType===a.ExtensionType.GROUND_RAY&&null!=w&&(r.c1=Math.abs(G-
w))}if(!u.intersectClipRay(F.frustum,r))return this._updateLineSegmentFinite(C);F=t.getStart(r,D);w=t.getEnd(r,v);return f.fromPoints(F,w,C)}_updateVertexAttributesObject3D(w,C){const F=w.geometries[0].getMutableAttribute(h.VertexAttribute.POSITION)?.data;if(F){var G=0;for(const J of this._lineVertices(C))F[G++]=J[0],F[G++]=J[1],F[G++]=J[2];w.geometryVertexAttributeUpdated(w.geometries[0],h.VertexAttribute.POSITION)}}_updateVertexAttributesDraped(w,C){const F=w.getMutableAttribute(h.VertexAttribute.POSITION)?.data;
if(F){var G=0;for(const J of this._lineVertices(C))F[G++]=J[0],F[G++]=J[1],F[G++]=b.drapedZ;w.invalidateBoundingInfo()}}*_lineVertices(w){this.extensionType===a.ExtensionType.FADED?(yield f.pointAt(w,-this.fadedExtensions.start,D),yield f.pointAt(w,0,D),yield f.pointAt(w,1,D),yield f.pointAt(w,1+this.fadedExtensions.end,D)):(yield f.pointAt(w,0,D),yield f.pointAt(w,1,D))}}const r=t.create(),D=e.create(),v=e.create(),I=f.create();a.ExtensionType=void 0;(function(w){w[w.LINE=0]="LINE";w[w.RAY=1]="RAY";
w[w.GROUND_RAY=2]="GROUND_RAY";w[w.FADED=3]="FADED"})(a.ExtensionType||(a.ExtensionType={}));c=1/3;const p={start:c,end:c};a.ExtendedLineVisualElement=z;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/vec4f32":function(){define(["exports"],function(a){function c(){return new Float32Array(4)}function l(z){const r=new Float32Array(4);r[0]=z[0];r[1]=z[1];r[2]=z[2];r[3]=z[3];return r}function e(z,r,D,v){const I=new Float32Array(4);I[0]=z;I[1]=r;I[2]=D;I[3]=v;return I}function d(z,
r){return new Float32Array(z,r,4)}function k(){return c()}function t(){return e(1,1,1,1)}function u(){return e(1,0,0,0)}function f(){return e(0,1,0,0)}function y(){return e(0,0,1,0)}function B(){return e(0,0,0,1)}const A=c(),b=t(),g=u(),m=f(),n=y(),h=B(),q=Object.freeze(Object.defineProperty({__proto__:null,ONES:b,UNIT_W:h,UNIT_X:g,UNIT_Y:m,UNIT_Z:n,ZEROS:A,clone:l,create:c,createView:d,fromValues:e,ones:t,unitW:B,unitX:u,unitY:f,unitZ:y,zeros:k},Symbol.toStringTag,{value:"Module"}));a.ONES=b;a.UNIT_W=
h;a.UNIT_X=g;a.UNIT_Y=m;a.UNIT_Z=n;a.ZEROS=A;a.clone=l;a.create=c;a.createView=d;a.fromValues=e;a.ones=t;a.unitW=B;a.unitX=u;a.unitY=f;a.unitZ=y;a.vec4f32=q;a.zeros=k})},"esri/views/3d/interactive/visualElements/EngineVisualElement":function(){define(["exports","./DrapedVisualElementResources","./VisualElement","./VisualElementResources"],function(a,c,l,e){class d extends l.VisualElement{constructor(k){super(k);this._isDraped=!1;this.object3dResources=new e.VisualElementResources(this.createObject3DResourceFactory(k.view));
this.drapedResources=new c.DrapedVisualElementResources(this.createDrapedResourceFactory(k.view));this.isDraped=k.isDraped??!1}get isDraped(){return this._isDraped}set isDraped(k){k!==this._isDraped&&(this._isDraped=k,this.object3dResources.attached=this.attached&&!k,this.drapedResources.attached=this.attached&&k)}get renderGroup(){return this.drapedResources.renderGroup}set renderGroup(k){this.drapedResources.renderGroup=k}createResources(){this.object3dResources.attached=!this._isDraped;this.drapedResources.attached=
this._isDraped}destroyResources(){this.object3dResources.attached=!1;this.drapedResources.attached=!1}recreate(){this.object3dResources.recreate();this.drapedResources.recreate()}recreateGeometry(){this.object3dResources.recreateGeometry();this.drapedResources.recreateGeometry()}destroy(){this.object3dResources.destroy();this.drapedResources.destroy();super.destroy()}updateVisibility(k){this.object3dResources.visible=k;this.drapedResources.visible=k}}a.EngineVisualElement=d;Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/visualElements/DrapedVisualElementResources":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Accessor ../../../../core/Identifiable ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/decorators/subclass ../../layers/interfaces ../../webgl-engine/lib/ModelDirtyTypes ../../webgl-engine/lib/UpdatePolicy".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A){class b{constructor(m){this._resourceFactory=m;this._resources=null;this._visible=!0;this._attached=!1;this._renderGroup=y.DrapedRenderGroup.Outline}destroy(){this._destroyResources()}get resources(){return null!=this._resources?this._resources.external:null}get visible(){return this._visible}set visible(m){m!==this._visible&&(this._visible=m,this._syncGeometriesToRenderer())}get attached(){return this._attached}set attached(m){m!==this._attached&&(this._attached=
m,this._createOrDestroyResources())}get renderGroup(){return this._renderGroup}set renderGroup(m){this._renderGroup=m;const n=this._resources?.layerView;n&&(n.renderGroup=m)}recreate(){this.attached&&this._createResources()}recreateGeometry(){this._resourceFactory.recreateGeometry?null!=this._resources&&(this._ensureRenderGeometriesRemoved(),this._resourceFactory.recreateGeometry(this._resources.external),this._syncGeometriesToRenderer()):this.recreate()}_createOrDestroyResources(){this._attached?
null==this._resources&&this._createResources():this._destroyResources()}_createResources(){this._destroyResources();const m=this._resourceFactory.createResources(),n=new g({view:this._resourceFactory.view,renderGroup:this._renderGroup}),h=this._resourceFactory.view.basemapTerrain?.overlayManager;this._resources={layerView:new g({view:this._resourceFactory.view,renderGroup:this._renderGroup}),external:m,geometriesAdded:!1};h&&(this._resources.drapeSourceRenderer=h.registerGeometryDrapeSource(n));this._syncGeometriesToRenderer()}_destroyResources(){if(null!=
this._resources){this._ensureRenderGeometriesRemoved();var m=this._resourceFactory.view.basemapTerrain?.overlayManager;m&&m.unregisterDrapeSource(this._resources.layerView);this._resourceFactory.destroyResources(this._resources.external);this._resources=null}}_syncGeometriesToRenderer(){this._visible?this._ensureRenderGeometriesAdded():this._ensureRenderGeometriesRemoved()}_ensureRenderGeometriesRemoved(){null!=this._resources?.drapeSourceRenderer&&this._resources.geometriesAdded&&(this._resources.drapeSourceRenderer.removeGeometries(this._resources.external.geometries,
B.DirtyOperation.UPDATE),this._resources.geometriesAdded=!1)}_ensureRenderGeometriesAdded(){null==this._resources?.drapeSourceRenderer||this._resources.geometriesAdded||(this._resources.drapeSourceRenderer.addGeometries(this._resources.external.geometries,B.DirtyOperation.UPDATE),this._resources.geometriesAdded=!0)}}let g=class extends e.IdentifiableMixin(l){constructor(m){super(m);this.drapeSourceType=y.DrapeSourceType.Features;this.updatePolicy=A.UpdatePolicy.SYNC;this.renderGroup=y.DrapedRenderGroup.Outline}};
c.__decorate([d.property({constructOnly:!0})],g.prototype,"view",void 0);c.__decorate([d.property({readOnly:!0})],g.prototype,"drapeSourceType",void 0);c.__decorate([d.property()],g.prototype,"renderGroup",void 0);g=c.__decorate([f.subclass("DrapedVisualElementLayerView")],g);a.DrapedVisualElementResources=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/visualElements/VisualElement":function(){define(["exports","../../../../core/reactiveUtils"],function(a,
c){class l{get isDecoration(){return this._isDecoration}set isDecoration(e){this._isDecoration=e}constructor(e){this._resourcesCreated=this._attached=this._isDecoration=!1;this._visible=!0;this.view=e.view;this._handle=c.watch(()=>e.view.ready,d=>{this._resourcesCreated&&(d?this._createResources():this._destroyResources())})}applyProperties(e){let d=!1;for(const k in e)k in this?"attached"===k?d=e[k]:this[k]=e[k]:console.error("Cannot set unknown property",k);this.attached=d}destroy(){this.attached=
!1;this._handle.remove()}get attached(){return this._attached}set attached(e){e!==this._attached&&this.view._stage&&((this._attached=e)&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources(),this.onAttachedChange(e))}onAttachedChange(e){}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this.attached&&this.updateVisibility(e))}_createResources(){this.createResources();this._resourcesCreated=!0;this.updateVisibility(this.visible)}_destroyResources(){this.destroyResources();
this._resourcesCreated=!1}}a.VisualElement=l;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/visualElements/VisualElementResources":function(){define("exports ../../../../core/reactiveUtils ../../webgl-engine/lib/ContentObjectType ../../webgl-engine/lib/Object3D ../../webgl-engine/lib/UpdatePolicy ../../webgl-engine/lib/WebGLLayer".split(" "),function(a,c,l,e,d,k){class t{constructor(u){this._resourceFactory=u;this._resources=null;this._visible=!0;this._attached=
!1}destroy(){this._destroyResources()}get object(){return null!=this._resources?this._resources.object:null}get resources(){return null!=this._resources?this._resources.external:null}get visible(){return this._visible}set visible(u){u!==this._visible&&(this._visible=u,this._syncVisible())}get attached(){return this._attached}set attached(u){u!==this._attached&&(this._attached=u,this._createOrDestroyResources())}recreate(){this.attached&&this._createResources()}recreateGeometry(){if(this._resourceFactory.recreateGeometry){var u=
this._resourceFactory.view._stage;if(null!=this._resources&&u){var f=this._resources.object;this._resources.external.forEach(y=>{y.type!==l.ContentObjectType.Mesh&&y.type!==l.ContentObjectType.Line&&y.type!==l.ContentObjectType.Point||u.remove(y)});f.removeAllGeometries();this._resourceFactory.recreateGeometry(this._resources.external,f,this._resources.layer);this._resources.external.forEach(y=>{y.type!==l.ContentObjectType.Mesh&&y.type!==l.ContentObjectType.Line&&y.type!==l.ContentObjectType.Point||
u.add(y)})}}else this.recreate()}_createOrDestroyResources(){this._attached?this._resources||this._createResources():this._destroyResources()}_createResources(){this._destroyResources();var u=this._resourceFactory;const f=u.view,y=f._stage;if(y){var B=new k.WebGLLayer(y,{pickable:!1,updatePolicy:d.UpdatePolicy.SYNC}),A=new e.Object3D({castShadow:!1}),b=u.createResources(A,B);b.forEach(m=>{y.add(m);m.type===l.ContentObjectType.Texture&&m.load(y.renderView.renderingContext)});y.add(A);B.add(A);var g=
u.cameraChanged;u=g?c.watch(()=>f.state.camera,m=>g(m),c.initial):null;this._resources={layer:B,object:A,external:b,cameraHandle:u};this._syncVisible()}}_destroyResources(){if(null!=this._resources){var u=this._resourceFactory.view._stage;u&&(u.remove(this._resources.object),this._resources.layer.destroy(),this._resources.external.forEach(f=>{u.remove(f);f.type===l.ContentObjectType.Texture&&f.unload()}));this._resources.object.dispose();this._resources.cameraHandle?.remove();this._resourceFactory.destroyResources(this._resources.external);
this._resources=null}}_syncVisible(){null!=this._resources&&(this._resources.object.visible=this._visible)}}a.VisualElementResources=t;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/visualElements/LaserlineVisualElement":function(){define("exports ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../geometry/support/lineSegment ./VisualElement ../../support/LaserLineRenderer ../../../../chunks/Laserlines.glsl".split(" "),function(a,c,l,e,d,k,t){class u extends d.VisualElement{constructor(y){super(y);
this._angleCutoff=t.defaultAngleCutoff;this._style={};this._heightManifoldTarget=l.create();this._heightManifoldEnabled=!1;this._intersectsLine=e.create();this._intersectsLineInfinite=this._intersectsLineEnabled=!1;this._pointDistanceLine=this._pathVerticalPlaneBuffers=this._lineVerticalPlaneSegment=null;this.applyProperties(y)}get testData(){return this._renderer}createResources(){this._ensureRenderer()}destroyResources(){this._disposeRenderer()}updateVisibility(){this._syncRenderer();this._syncHeightManifold();
this._syncIntersectsLine();this._syncPathVerticalPlane();this._syncLineVerticalPlane();this._syncPointDistance()}get angleCutoff(){return this._angleCutoff}set angleCutoff(y){this._angleCutoff!==y&&(this._angleCutoff=y,this._syncAngleCutoff())}get style(){return this._style}set style(y){this._style=y;this._syncStyle()}get heightManifoldTarget(){return this._heightManifoldEnabled?this._heightManifoldTarget:null}set heightManifoldTarget(y){null!=y?(c.copy(this._heightManifoldTarget,y),this._heightManifoldEnabled=
!0):this._heightManifoldEnabled=!1;this._syncRenderer();this._syncHeightManifold()}set intersectsWorldUpAtLocation(y){if(null==y)this.intersectsLine=null;else{var B=this.view.renderCoordsHelper.worldUpAtPosition(y,f);this.intersectsLine=e.fromValues(y,B);this.intersectsLineInfinite=!0}}get intersectsLine(){return this._intersectsLineEnabled?this._intersectsLine:null}set intersectsLine(y){null!=y?(e.copy(y,this._intersectsLine),this._intersectsLineEnabled=!0):this._intersectsLineEnabled=!1;this._syncIntersectsLine();
this._syncRenderer()}get intersectsLineInfinite(){return this._intersectsLineInfinite}set intersectsLineInfinite(y){this._intersectsLineInfinite=y;this._syncIntersectsLineInfinite()}get lineVerticalPlaneSegment(){return this._lineVerticalPlaneSegment}set lineVerticalPlaneSegment(y){this._lineVerticalPlaneSegment=null!=y?e.copy(y):null;this._syncLineVerticalPlane();this._syncRenderer()}get pathVerticalPlane(){return this._pathVerticalPlaneBuffers}set pathVerticalPlane(y){this._pathVerticalPlaneBuffers=
y;this._syncPathVerticalPlane();this._syncLineVerticalPlane();this._syncPointDistance();this._syncRenderer()}get pointDistanceLine(){return this._pointDistanceLine}set pointDistanceLine(y){this._pointDistanceLine=null!=y?{origin:l.clone(y.origin),target:y.target?l.clone(y.target):null}:null;this._syncPointDistance();this._syncRenderer()}_syncRenderer(){this.attached&&this.visible&&(this._intersectsLineEnabled||this._heightManifoldEnabled||null!=this._pointDistanceLine||null!=this._pathVerticalPlaneBuffers)?
this._ensureRenderer():this._disposeRenderer()}_ensureRenderer(){null==this._renderer&&(this._renderer=new k.LaserLineRenderer({renderCoordsHelper:this.view.renderCoordsHelper,contrastControlEnabled:!0,_isDecoration:this.isDecoration}),this._renderer.viewingMode=this.view.state.viewingMode,this._syncStyle(),this._syncHeightManifold(),this._syncIntersectsLine(),this._syncIntersectsLineInfinite(),this._syncPathVerticalPlane(),this._syncLineVerticalPlane(),this._syncPointDistance(),this._syncAngleCutoff(),
this.view._stage&&this.view._stage.addRenderPlugin(this._renderer))}_syncStyle(){null!=this._renderer&&(this._renderer.setParameters(this._style),null!=this._style.intersectsLineRadius&&(this._renderer.intersectsLineRadius=this._style.intersectsLineRadius))}_syncAngleCutoff(){null!=this._renderer&&this._renderer.setParameters({angleCutoff:this._angleCutoff})}_syncHeightManifold(){null!=this._renderer&&(this._renderer.heightManifoldEnabled=this._heightManifoldEnabled&&this.visible,this._heightManifoldEnabled&&
(this._renderer.heightManifoldTarget=this._heightManifoldTarget))}_syncIntersectsLine(){null!=this._renderer&&(this._renderer.intersectsLineEnabled=this._intersectsLineEnabled&&this.visible,this._intersectsLineEnabled&&(this._renderer.intersectsLineSegment=this._intersectsLine))}_syncIntersectsLineInfinite(){null!=this._renderer&&(this._renderer.intersectsLineInfinite=this._intersectsLineInfinite)}_syncPathVerticalPlane(){null!=this._renderer&&(this._renderer.pathVerticalPlaneEnabled=null!=this._pathVerticalPlaneBuffers&&
this.visible,null!=this._pathVerticalPlaneBuffers&&(this._renderer.pathVerticalPlaneBuffers=this._pathVerticalPlaneBuffers))}_syncLineVerticalPlane(){null!=this._renderer&&(this._renderer.lineVerticalPlaneEnabled=null!=this._lineVerticalPlaneSegment&&this.visible,null!=this._lineVerticalPlaneSegment&&(this._renderer.lineVerticalPlaneSegment=this._lineVerticalPlaneSegment))}_syncPointDistance(){if(null!=this._renderer){var y=this._pointDistanceLine,B=null!=y;this._renderer.pointDistanceEnabled=B&&
null!=y.target&&this.visible;B&&(this._renderer.pointDistanceOrigin=y.origin,null!=y.target&&(this._renderer.pointDistanceTarget=y.target))}}_disposeRenderer(){null!=this._renderer&&this.view._stage&&(this.view._stage.removeRenderPlugin(this._renderer),this._renderer=null)}}const f=l.create();a.LaserlineVisualElement=u;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/support/LaserLineRenderer":function(){define("exports ../../../chunks/tslib.es6 ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../chunks/vec3 ../../../geometry/support/clipRay ../../../geometry/support/frustum ../../../geometry/support/lineSegment ../../../geometry/support/ray ../../ViewingMode ./LaserlinePathData ../webgl-engine/effects/RenderPlugin ../webgl-engine/lib/RenderSlot ../webgl-engine/materials/internal/MaterialUtil ../webgl-engine/shaders/LaserlinePathTechnique ../webgl-engine/shaders/LaserlinePathTechniqueConfiguration ../webgl-engine/shaders/LaserlineTechnique ../webgl-engine/shaders/LaserlineTechniqueConfiguration".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m,n,h,q,z,r,D,v){a.LaserLineRenderer=class extends n.SyncPrepareRenderPlugin{constructor(p){super(p);this._technique=null;this._intersectsLineInfinite=this._intersectsLineEnabled=this._lineVerticalPlaneEnabled=this._pointDistanceEnabled=this._heightManifoldEnabled=!1;this._viewingMode=g.ViewingMode.Local;this._pathVerticalPlaneEnabled=!1;this._pathTechnique=this._pathVerticalPlaneData=null;this._passParameters=new D.LaserlinePassParameters;this.produces=new Map([[h.RenderSlot.LASERLINES,
()=>!this.contrastControlEnabled],[h.RenderSlot.LASERLINES_CONTRAST_CONTROL,()=>this.contrastControlEnabled]])}initialize(){this._passParameters.renderCoordsHelper=this.renderCoordsHelper}consumes(){return n.ConsumesDepth}get isDecoration(){return this._isDecoration}get heightManifoldEnabled(){return this._heightManifoldEnabled}set heightManifoldEnabled(p){this._heightManifoldEnabled!==p&&(this._heightManifoldEnabled=p,this._requestRender())}get heightManifoldTarget(){return this._passParameters.heightManifoldTarget}set heightManifoldTarget(p){f.copy(this._passParameters.heightManifoldTarget,
p);this._requestRender()}get pointDistanceEnabled(){return this._pointDistanceEnabled}set pointDistanceEnabled(p){p!==this._pointDistanceEnabled&&(this._pointDistanceEnabled=p,this._requestRender())}get pointDistanceTarget(){return this._passParameters.pointDistanceTarget}set pointDistanceTarget(p){f.copy(this._passParameters.pointDistanceTarget,p);this._requestRender()}get pointDistanceOrigin(){return this._passParameters.pointDistanceOrigin}set pointDistanceOrigin(p){f.copy(this._passParameters.pointDistanceOrigin,
p);this._requestRender()}get lineVerticalPlaneEnabled(){return this._lineVerticalPlaneEnabled}set lineVerticalPlaneEnabled(p){p!==this._lineVerticalPlaneEnabled&&(this._lineVerticalPlaneEnabled=p,this._requestRender())}get lineVerticalPlaneSegment(){return this._passParameters.lineVerticalPlaneSegment}set lineVerticalPlaneSegment(p){A.copy(p,this._passParameters.lineVerticalPlaneSegment);this._requestRender()}get intersectsLineEnabled(){return this._intersectsLineEnabled}set intersectsLineEnabled(p){p!==
this._intersectsLineEnabled&&(this._intersectsLineEnabled=p,this._requestRender())}get intersectsLineSegment(){return this._passParameters.intersectsLineSegment}set intersectsLineSegment(p){A.copy(p,this._passParameters.intersectsLineSegment);this._requestRender()}get intersectsLineRadius(){return this._passParameters.intersectsLineRadius}set intersectsLineRadius(p){p!==this._passParameters.intersectsLineRadius&&(this._passParameters.intersectsLineRadius=p,this._requestRender())}get intersectsLineInfinite(){return this._intersectsLineInfinite}set intersectsLineInfinite(p){p!==
this._intersectsLineInfinite&&(this._intersectsLineInfinite=p,this._requestRender())}get viewingMode(){return this._viewingMode}set viewingMode(p){p!==this._viewingMode&&(this._viewingMode=p,this._requestRender())}get pathVerticalPlaneEnabled(){return this._pathVerticalPlaneEnabled}set pathVerticalPlaneEnabled(p){p!==this._pathVerticalPlaneEnabled&&(this._pathVerticalPlaneEnabled=p,null!=this._pathVerticalPlaneData&&this._requestRender())}set pathVerticalPlaneVertices(p){null==this._pathVerticalPlaneData&&
(this._pathVerticalPlaneData=new m.LaserlinePathData(this._passParameters.renderCoordsHelper));this._pathVerticalPlaneData.vertices=p;this.pathVerticalPlaneEnabled&&this._requestRender()}set pathVerticalPlaneBuffers(p){null==this._pathVerticalPlaneData&&(this._pathVerticalPlaneData=new m.LaserlinePathData(this._passParameters.renderCoordsHelper));this._pathVerticalPlaneData.buffers=p;this.pathVerticalPlaneEnabled&&this._requestRender()}setParameters(p){q.updateParameters(this._passParameters,p)&&
this._requestRender()}initializeRenderContext(p){this._context=p;this._techniqueRepository=p.techniqueRepository;this._techniqueConfig=new v.LaserlineTechniqueConfiguration;p=new r.LaserlinePathTechniqueConfiguration;p.contrastControlEnabled=this.contrastControlEnabled;this._pathTechnique=this._techniqueRepository.acquire(z.LaserlinePathTechnique,p)}uninitializeRenderContext(){this._technique=l.releaseMaybe(this._technique);this._pathVerticalPlaneData=l.disposeMaybe(this._pathVerticalPlaneData);this._pathTechnique=
l.releaseMaybe(this._pathTechnique)}prepareTechnique(){return this.heightManifoldEnabled||this.pointDistanceEnabled||this.lineVerticalPlaneSegment||this.intersectsLineEnabled?(this._techniqueConfig.heightManifoldEnabled=this.heightManifoldEnabled,this._techniqueConfig.lineVerticalPlaneEnabled=this.lineVerticalPlaneEnabled,this._techniqueConfig.pointDistanceEnabled=this.pointDistanceEnabled,this._techniqueConfig.intersectsLineEnabled=this.intersectsLineEnabled,this._techniqueConfig.contrastControlEnabled=
this.contrastControlEnabled,this._techniqueConfig.spherical=this._viewingMode===g.ViewingMode.Global,this._technique=this._techniqueRepository.releaseAndAcquire(D.LaserlineTechnique,this._techniqueConfig,this._technique)):this._pathTechnique}renderNode(p,w){(this.heightManifoldEnabled||this.pointDistanceEnabled||this.lineVerticalPlaneSegment||this.intersectsLineEnabled)&&this._renderUnified(p,w);this.pathVerticalPlaneEnabled&&this._renderPath(p)}_renderUnified(p,w){const C=p.rctx;this._updatePassParameters(p);
C.bindTechnique(w,this._passParameters,p.bindParameters);C.screen.draw()}_renderPath(p){null!=this._pathVerticalPlaneData&&null!=this._pathTechnique&&(p.rctx.bindTechnique(this._pathTechnique,{...this._passParameters,origin:this._pathVerticalPlaneData.origin},p.bindParameters),this._pathVerticalPlaneData.draw(p.rctx))}_updatePassParameters(p){this._intersectsLineEnabled&&(p=p.bindParameters.camera,this._intersectsLineInfinite?(y.fromRay(b.wrap(this._passParameters.intersectsLineSegment.origin,this._passParameters.intersectsLineSegment.vector),
I),I.c0=-Number.MAX_VALUE,B.intersectClipRay(p.frustum,I)&&(y.getStart(I,this._passParameters.lineStartWorld),y.getEnd(I,this._passParameters.lineEndWorld))):(f.copy(this._passParameters.lineStartWorld,this._passParameters.intersectsLineSegment.origin),f.add(this._passParameters.lineEndWorld,this._passParameters.intersectsLineSegment.origin,this._passParameters.intersectsLineSegment.vector)))}_requestRender(){this._context&&this._context.requestRender()}get test(){return{passParameters:this._passParameters}}};
c.__decorate([e.property({constructOnly:!0})],a.LaserLineRenderer.prototype,"contrastControlEnabled",void 0);c.__decorate([e.property({constructOnly:!0})],a.LaserLineRenderer.prototype,"_isDecoration",void 0);c.__decorate([e.property({constructOnly:!0})],a.LaserLineRenderer.prototype,"renderCoordsHelper",void 0);a.LaserLineRenderer=c.__decorate([u.subclass("esri.views.3d.support.LaserLineRenderer")],a.LaserLineRenderer);const I=y.create();Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/views/3d/support/LaserlinePathData":function(){define("exports ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../geometry/support/DoubleArray ./buffer/glUtil ./buffer/InterleavedLayout ../webgl-engine/lib/VertexArrayObject ../webgl-engine/lib/VertexAttribute ../webgl-engine/shaders/LaserlinePathTechnique ../../webgl/BufferObject ../../webgl/enums".split(" "),function(a,c,l,e,d,k,t,u,f,y,B){class A{constructor(n){this._renderCoordsHelper=n;this._buffers=null;this._origin=l.create();this._dirty=
!1;this._count=0;this._vao=null}set vertices(n){const h=e.newDoubleArray(3*n.length);let q=0;for(const z of n)h[q++]=z[0],h[q++]=z[1],h[q++]=z[2];this.buffers=[h]}set buffers(n){this._buffers=n;if(0<this._buffers.length){n=this._buffers[0];const h=3*Math.floor(n.length/3/2);c.set(this._origin,n[h],n[h+1],n[h+2])}else c.set(this._origin,0,0,0);this._dirty=!0}get origin(){return this._origin}draw(n){const h=this._ensureVAO(n);null!=h&&(n.bindVAO(h),n.drawArrays(B.PrimitiveType.TRIANGLES,0,this._count))}dispose(){null!=
this._vao&&this._vao.dispose()}_ensureVAO(n){if(null==this._buffers)return null;null==this._vao&&(this._vao=this._createVAO(n,this._buffers));this._ensureVertexData(this._vao,this._buffers);return this._vao}_createVAO(n,h){h=this._createDataBuffer(h);this._dirty=!1;return new t.VertexArrayObject(n,f.attributeLocations,{data:d.glLayout(m)},{data:y.BufferObject.createVertex(n,B.Usage.STATIC_DRAW,h)})}_ensureVertexData(n,h){this._dirty&&(h=this._createDataBuffer(h),n.vertexBuffers.data?.setData(h),this._dirty=
!1)}_numberOfRenderVertices(n){return 6*(n.length/3-1)}_createDataBuffer(n){var h=n.reduce((I,p)=>I+this._numberOfRenderVertices(p),0);this._count=h;h=m.createBuffer(h);const q=this._origin;let z=0,r=0;for(const I of n){for(n=0;n<I.length;n+=3){var D=c.set(g,I[n],I[n+1],I[n+2]);0===n?r=this._renderCoordsHelper.getAltitude(D):this._renderCoordsHelper.setAltitude(D,r);var v=this._renderCoordsHelper.worldUpAtPosition(D,b);const p=z+2*n;D=c.subtract(g,D,q);if(n<I.length-3){h.up.setVec(p,v);h.up.setVec(p+
3,v);h.up.setVec(p+5,v);for(let w=0;6>w;w++)h.start.setVec(p+w,D);h.extrude.setValues(p,0,-1);h.extrude.setValues(p+1,1,-1);h.extrude.setValues(p+2,1,1);h.extrude.setValues(p+3,0,-1);h.extrude.setValues(p+4,1,1);h.extrude.setValues(p+5,0,1)}if(0<n)for(h.up.setVec(p-2,v),h.up.setVec(p-4,v),h.up.setVec(p-5,v),v=-6;0>v;v++)h.end.setVec(p+v,D)}z+=this._numberOfRenderVertices(I)}return h.buffer}}const b=l.create(),g=l.create(),m=k.newLayout().vec3f(u.VertexAttribute.START).vec3f(u.VertexAttribute.END).vec3f(u.VertexAttribute.UP).vec2f(u.VertexAttribute.EXTRUDE);
a.LaserlinePathData=A;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/webgl-engine/shaders/LaserlinePathTechnique":function(){define("require exports ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../lib/Program ../lib/VertexAttribute ../../../../chunks/LaserlinePath.glsl ../../../webgl/enums ../../../webgl/renderState".split(" "),function(a,c,l,e,d,k,t,u,f){class y extends e.ShaderTechnique{initializeProgram(A){return new d.Program(A.rctx,
y.shader.get().build(this.configuration),B)}initializePipeline(){return f.makePipelineState({blending:f.simpleBlendingParams(u.BlendFactor.ONE,u.BlendFactor.ONE_MINUS_SRC_ALPHA),colorWrite:f.defaultColorWriteParams})}}y.shader=new l.ReloadableShaderModule(t.LaserlinePath,()=>new Promise((A,b)=>a(["./LaserlinePath.glsl"],A,b)));const B=new Map([[k.VertexAttribute.START,0],[k.VertexAttribute.END,1],[k.VertexAttribute.UP,2],[k.VertexAttribute.EXTRUDE,3]]);c.LaserlinePathTechnique=y;c.attributeLocations=
B;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/LaserlinePath.glsl":function(){define("exports ./mat4 ./mat4f64 ./vec2 ./vec2f64 ../views/3d/webgl-engine/core/shaderLibrary/Laserline.glsl ../views/3d/webgl-engine/core/shaderModules/Float2PassUniform ../views/3d/webgl-engine/core/shaderModules/FloatPassUniform ../views/3d/webgl-engine/core/shaderModules/interfaces ../views/3d/webgl-engine/core/shaderModules/Matrix4PassUniform ../views/3d/webgl-engine/core/shaderModules/ShaderBuilder ../views/3d/webgl-engine/lib/VertexAttribute".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A){function b(n){const h=new B.ShaderBuilder;h.include(k.Laserline,n);const {vertex:q,fragment:z}=h;q.uniforms.add(new y.Matrix4PassUniform("modelView",(r,D)=>c.translate(m,D.camera.viewMatrix,r.origin)),new y.Matrix4PassUniform("proj",(r,D)=>D.camera.projectionMatrix),new u.FloatPassUniform("glowWidth",(r,D)=>r.glowWidth*D.camera.pixelRatio),new t.Float2PassUniform("pixelToNDC",(r,D)=>e.set(g,2/D.camera.fullViewport[2],2/D.camera.fullViewport[3])));h.attributes.add(A.VertexAttribute.START,
"vec3");h.attributes.add(A.VertexAttribute.END,"vec3");h.attributes.add(A.VertexAttribute.UP,"vec3");h.attributes.add(A.VertexAttribute.EXTRUDE,"vec2");h.varyings.add("uv","vec2");h.varyings.add("vViewStart","vec3");h.varyings.add("vViewEnd","vec3");h.varyings.add("vViewPlane","vec4");q.code.add(f.glsl`void main() {
vec3 pos = mix(start, end, extrude.x);
vec4 viewPos = modelView * vec4(pos, 1);
vec4 projPos = proj * viewPos;
vec2 ndcPos = projPos.xy / projPos.w;
vec3 viewUp = (modelView * vec4(extrude.y * up, 0)).xyz;
vec4 projPosUp = proj * vec4(viewPos.xyz + viewUp, 1);
vec2 projExtrudeDir = normalize(projPosUp.xy / projPosUp.w - ndcPos);
vec2 lxy = abs(sign(projExtrudeDir) - ndcPos);
ndcPos += length(lxy) * projExtrudeDir;
vec3 worldPlaneNormal = normalize(cross(up, normalize(end - start)));
vec3 viewPlaneNormal = (modelView * vec4(worldPlaneNormal, 0)).xyz;
vViewStart = (modelView * vec4(start, 1)).xyz;
vViewEnd = (modelView * vec4(end, 1)).xyz;
vViewPlane = vec4(viewPlaneNormal, -dot(viewPlaneNormal, vViewStart));
float xPaddingPixels = sign(dot(viewPlaneNormal, viewPos.xyz)) * (extrude.x * 2.0 - 1.0) * glowWidth;
ndcPos.x += xPaddingPixels * pixelToNDC.x;
uv = ndcPos * 0.5 + 0.5;
gl_Position = vec4(ndcPos, 0, 1);
}`);z.uniforms.add(new u.FloatPassUniform("perScreenPixelRatio",(r,D)=>D.camera.perScreenPixelRatio));z.code.add(f.glsl`float planeDistancePixels(vec4 plane, vec3 pos, vec3 start, vec3 end) {
vec3 origin = mix(start, end, 0.5);
vec3 basis = end - origin;
vec3 posAtOrigin = pos - origin;
float x = dot(normalize(basis), posAtOrigin);
float y = dot(plane.xyz, posAtOrigin);
float dx = max(abs(x) - length(basis), 0.0);
float dy = y;
float dist = length(vec2(dx, dy));
float width = fwidth(y);
float maxPixelDistance = length(pos) * perScreenPixelRatio * 2.0;
float pixelDist = dist / min(width, maxPixelDistance);
return abs(pixelDist);
}
void main() {
vec3 pos;
vec3 normal;
float depthDiscontinuityAlpha;
vec3 dEndStart = vViewEnd - vViewStart;
if (dot(dEndStart, dEndStart) < 1e-5) {
discard;
}
if (!laserlineReconstructFromDepth(pos, normal, depthDiscontinuityAlpha)) {
discard;
}
float distance = planeDistancePixels(vViewPlane, pos, vViewStart, vViewEnd);
vec4 color = laserlineProfile(distance);
float alpha = 1.0 - smoothstep(0.995, 0.999, abs(dot(normal, vViewPlane.xyz)));
fragColor = laserlineOutput(color * alpha * depthDiscontinuityAlpha);
}`);return h}const g=d.create(),m=l.create();l=Object.freeze(Object.defineProperty({__proto__:null,build:b},Symbol.toStringTag,{value:"Module"}));a.LaserlinePath=l;a.build=b})},"esri/views/3d/webgl-engine/core/shaderLibrary/Laserline.glsl":function(){define("exports ./output/ReadLinearDepth.glsl ./util/CameraSpace.glsl ../shaderModules/Float2PassUniform ../shaderModules/Float3PassUniform ../shaderModules/FloatPassUniform ../shaderModules/interfaces ../shaderModules/Texture2DPassUniform".split(" "),
function(a,c,l,e,d,k,t,u){a.Laserline=function(f,y){const B=f.fragment;B.include(c.ReadLinearDepth);f.include(l.CameraSpace);B.uniforms.add(new k.FloatPassUniform("globalAlpha",A=>A.globalAlpha),new d.Float3PassUniform("glowColor",A=>A.glowColor),new k.FloatPassUniform("glowWidth",(A,b)=>A.glowWidth*b.camera.pixelRatio),new k.FloatPassUniform("glowFalloff",A=>A.glowFalloff),new d.Float3PassUniform("innerColor",A=>A.innerColor),new k.FloatPassUniform("innerWidth",(A,b)=>A.innerWidth*b.camera.pixelRatio),
new u.Texture2DPassUniform("depthMap",(A,b)=>b.linearDepth?.colorTexture),new e.Float2PassUniform("nearFar",(A,b)=>b.camera.nearFar),new u.Texture2DPassUniform("frameColor",(A,b)=>b.mainColor));B.code.add(t.glsl`vec4 blendPremultiplied(vec4 source, vec4 dest) {
float oneMinusSourceAlpha = 1.0 - source.a;
return vec4(
source.rgb + dest.rgb * oneMinusSourceAlpha,
source.a + dest.a * oneMinusSourceAlpha
);
}`);B.code.add(t.glsl`vec4 premultipliedColor(vec3 rgb, float alpha) {
return vec4(rgb * alpha, alpha);
}`);B.code.add(t.glsl`vec4 laserlineProfile(float dist) {
if (dist > glowWidth) {
return vec4(0.0);
}
float innerAlpha = (1.0 - smoothstep(0.0, innerWidth, dist));
float glowAlpha = pow(max(0.0, 1.0 - dist / glowWidth), glowFalloff);
return blendPremultiplied(
premultipliedColor(innerColor, innerAlpha),
premultipliedColor(glowColor, glowAlpha)
);
}`);B.code.add(t.glsl`bool laserlineReconstructFromDepth(out vec3 pos, out vec3 normal, out float depthDiscontinuityAlpha) {
float depth = linearDepthFromTexture(depthMap, uv, nearFar);
if (-depth == nearFar[0]) {
return false;
}
pos = reconstructPosition(gl_FragCoord.xy, depth);
normal = normalize(cross(dFdx(pos), dFdy(pos)));
float ddepth = fwidth(depth);
depthDiscontinuityAlpha = 1.0 - smoothstep(0.0, 0.01, -ddepth / depth);
return true;
}`);y.contrastControlEnabled?(B.uniforms.add(new k.FloatPassUniform("globalAlphaContrastBoost",A=>null!=A.globalAlphaContrastBoost?A.globalAlphaContrastBoost:1)),B.code.add(t.glsl`float rgbToLuminance(vec3 color) {
return dot(vec3(0.2126, 0.7152, 0.0722), color);
}
vec4 laserlineOutput(vec4 color) {
float backgroundLuminance = rgbToLuminance(texture(frameColor, uv).rgb);
float alpha = clamp(globalAlpha * max(backgroundLuminance * globalAlphaContrastBoost, 1.0), 0.0, 1.0);
return color * alpha;
}`)):B.code.add(t.glsl`vec4 laserlineOutput(vec4 color) {
return color * globalAlpha;
}`)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/webgl-engine/shaders/LaserlinePathTechniqueConfiguration":function(){define(["exports","../../../../chunks/tslib.es6","../core/shaderTechnique/ShaderTechniqueConfiguration"],function(a,c,l){class e extends l.ShaderTechniqueConfiguration{constructor(){super(...arguments);this.contrastControlEnabled=!1}}c.__decorate([l.parameter()],e.prototype,"contrastControlEnabled",void 0);a.LaserlinePathTechniqueConfiguration=e;
Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/webgl-engine/shaders/LaserlineTechnique":function(){define("require exports ../../../../core/mathUtils ../../../../chunks/vec3f64 ../../../../geometry/support/lineSegment ../core/shaderModules/interfaces ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../lib/DefaultVertexAttributeLocations ../lib/Program ../../../../chunks/Laserlines.glsl ../../../webgl/enums ../../../webgl/renderState".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b){class g extends k.NoParameters{constructor(){super(...arguments);this.innerColor=e.fromValues(1,1,1);this.innerWidth=1;this.glowColor=e.fromValues(1,.5,0);this.glowFalloff=this.glowWidth=8;this.globalAlpha=.75;this.globalAlphaContrastBoost=2;this.angleCutoff=l.deg2rad(6);this.pointDistanceOrigin=e.create();this.pointDistanceTarget=e.create();this.lineVerticalPlaneSegment=d.create();this.intersectsLineSegment=d.create();this.intersectsLineRadius=3;this.heightManifoldTarget=
e.create();this.lineStartWorld=e.create();this.lineEndWorld=e.create()}}class m extends u.ShaderTechnique{initializeProgram(n){return new y.Program(n.rctx,m.shader.get().build(this.configuration),f.Default3D)}initializePipeline(){return b.makePipelineState({blending:b.simpleBlendingParams(A.BlendFactor.ONE,A.BlendFactor.ONE_MINUS_SRC_ALPHA),colorWrite:b.defaultColorWriteParams})}}m.shader=new t.ReloadableShaderModule(B.LaserlinesShader,()=>new Promise((n,h)=>a(["./Laserlines.glsl"],n,h)));c.LaserlinePassParameters=
g;c.LaserlineTechnique=m;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/Laserlines.glsl":function(){define("exports ../core/mathUtils ./vec2 ./vec2f64 ./vec3 ./vec3f64 ./vec4 ./vec4f64 ../geometry/support/lineSegment ../geometry/support/plane ./sphere ../views/3d/webgl-engine/core/shaderLibrary/Laserline.glsl ../views/3d/webgl-engine/core/shaderLibrary/ScreenSpacePass.glsl ../views/3d/webgl-engine/core/shaderModules/Float2PassUniform ../views/3d/webgl-engine/core/shaderModules/Float3PassUniform ../views/3d/webgl-engine/core/shaderModules/Float4PassUniform ../views/3d/webgl-engine/core/shaderModules/FloatPassUniform ../views/3d/webgl-engine/core/shaderModules/interfaces ../views/3d/webgl-engine/core/shaderModules/ShaderBuilder".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m,n,h,q,z){function r(H){const K=new z.ShaderBuilder;K.include(b.ScreenSpacePass);K.include(A.Laserline,H);const E=K.fragment;if(H.lineVerticalPlaneEnabled||H.heightManifoldEnabled)E.uniforms.add(new h.FloatPassUniform("maxPixelDistance",(M,O)=>H.heightManifoldEnabled?2*O.camera.computeScreenPixelSizeAt(M.heightManifoldTarget):2*O.camera.computeScreenPixelSizeAt(M.lineVerticalPlaneSegment.origin))),E.code.add(q.glsl`float planeDistancePixels(vec4 plane, vec3 pos) {
float dist = dot(plane.xyz, pos) + plane.w;
float width = fwidth(dist);
dist /= min(width, maxPixelDistance);
return abs(dist);
}`),H.spherical?(E.uniforms.add(new n.Float4PassUniform("heightManifoldOrigin",(M,O)=>{d.transformMat4(w,M.heightManifoldTarget,O.camera.viewMatrix);d.transformMat4(G,[0,0,0],O.camera.viewMatrix);d.subtract(G,G,w);d.normalize(C,G);C[3]=d.length(G);return C}),new m.Float3PassUniform("globalOrigin",(M,O)=>d.transformMat4(w,[0,0,0],O.camera.viewMatrix)),new h.FloatPassUniform("cosSphericalAngleThreshold",(M,O)=>1-Math.max(2,d.distance(O.camera.eye,M.heightManifoldTarget)*O.camera.perRenderPixelRatio)/
d.length(M.heightManifoldTarget))),E.code.add(q.glsl`float globeDistancePixels(float posInGlobalOriginLength) {
float dist = abs(posInGlobalOriginLength - heightManifoldOrigin.w);
float width = fwidth(dist);
dist /= min(width, maxPixelDistance);
return abs(dist);
}
float heightManifoldDistancePixels(vec4 heightPlane, vec3 pos) {
vec3 posInGlobalOriginNorm = normalize(globalOrigin - pos);
float cosAngle = dot(posInGlobalOriginNorm, heightManifoldOrigin.xyz);
vec3 posInGlobalOrigin = globalOrigin - pos;
float posInGlobalOriginLength = length(posInGlobalOrigin);
float sphericalDistance = globeDistancePixels(posInGlobalOriginLength);
float planarDistance = planeDistancePixels(heightPlane, pos);
return cosAngle < cosSphericalAngleThreshold ? sphericalDistance : planarDistance;
}`)):E.code.add(q.glsl`float heightManifoldDistancePixels(vec4 heightPlane, vec3 pos) {
return planeDistancePixels(heightPlane, pos);
}`);H.pointDistanceEnabled&&(E.uniforms.add(new h.FloatPassUniform("maxPixelDistance",(M,O)=>2*O.camera.computeScreenPixelSizeAt(M.pointDistanceTarget))),E.code.add(q.glsl`float sphereDistancePixels(vec4 sphere, vec3 pos) {
float dist = distance(sphere.xyz, pos) - sphere.w;
float width = fwidth(dist);
dist /= min(width, maxPixelDistance);
return abs(dist);
}`));H.intersectsLineEnabled&&(E.uniforms.add(new h.FloatPassUniform("perScreenPixelRatio",(M,O)=>O.camera.perScreenPixelRatio)),E.code.add(q.glsl`float lineDistancePixels(vec3 start, vec3 dir, float radius, vec3 pos) {
float dist = length(cross(dir, pos - start)) / (length(pos) * perScreenPixelRatio);
return abs(dist) - radius;
}`));(H.lineVerticalPlaneEnabled||H.intersectsLineEnabled)&&E.code.add(q.glsl`bool pointIsWithinLine(vec3 pos, vec3 start, vec3 end) {
vec3 dir = end - start;
float t2 = dot(dir, pos - start);
float l2 = dot(dir, dir);
return t2 >= 0.0 && t2 <= l2;
}`);E.code.add(q.glsl`void main() {
vec3 pos;
vec3 normal;
float depthDiscontinuityAlpha;
if (!laserlineReconstructFromDepth(pos, normal, depthDiscontinuityAlpha)) {
discard;
}
vec4 color = vec4(0, 0, 0, 0);`);if(H.heightManifoldEnabled){E.uniforms.add(new g.Float2PassUniform("angleCutoff",O=>D(O)),new n.Float4PassUniform("heightPlane",(O,T)=>v(O.heightManifoldTarget,O.renderCoordsHelper.worldUpAtPosition(O.heightManifoldTarget,w),T.camera.viewMatrix)));const M=H.spherical?q.glsl`normalize(globalOrigin - pos)`:q.glsl`heightPlane.xyz`;E.code.add(q.glsl`
    {
      float heightManifoldAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, ${M})));
      vec4 heightManifoldColor = laserlineProfile(heightManifoldDistancePixels(heightPlane, pos));
      color = max(color, heightManifoldColor * heightManifoldAlpha);
    }
    `)}H.pointDistanceEnabled&&(E.uniforms.add(new g.Float2PassUniform("angleCutoff",M=>D(M)),new n.Float4PassUniform("pointDistanceSphere",(M,O)=>{d.transformMat4(x,M.pointDistanceOrigin,O.camera.viewMatrix);x[3]=d.distance(M.pointDistanceOrigin,M.pointDistanceTarget);return x})),E.code.add(q.glsl`{
float pointDistanceSphereDistance = sphereDistancePixels(pointDistanceSphere, pos);
vec4 pointDistanceSphereColor = laserlineProfile(pointDistanceSphereDistance);
float pointDistanceSphereAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, normalize(pos - pointDistanceSphere.xyz))));
color = max(color, pointDistanceSphereColor * pointDistanceSphereAlpha);
}`));H.lineVerticalPlaneEnabled&&(E.uniforms.add(new g.Float2PassUniform("angleCutoff",M=>D(M)),new n.Float4PassUniform("lineVerticalPlane",(M,O)=>{var T=f.pointAt(M.lineVerticalPlaneSegment,.5,w);T=M.renderCoordsHelper.worldUpAtPosition(T,F);const U=d.normalize(G,M.lineVerticalPlaneSegment.vector);T=d.cross(C,T,U);d.normalize(T,T);return v(M.lineVerticalPlaneSegment.origin,T,O.camera.viewMatrix)}),new m.Float3PassUniform("lineVerticalStart",(M,O)=>{const T=d.copy(w,M.lineVerticalPlaneSegment.origin);
M.renderCoordsHelper.setAltitude(T,0);return d.transformMat4(T,T,O.camera.viewMatrix)}),new m.Float3PassUniform("lineVerticalEnd",(M,O)=>{const T=d.add(w,M.lineVerticalPlaneSegment.origin,M.lineVerticalPlaneSegment.vector);M.renderCoordsHelper.setAltitude(T,0);return d.transformMat4(T,T,O.camera.viewMatrix)})),E.code.add(q.glsl`{
if (pointIsWithinLine(pos, lineVerticalStart, lineVerticalEnd)) {
float lineVerticalDistance = planeDistancePixels(lineVerticalPlane, pos);
vec4 lineVerticalColor = laserlineProfile(lineVerticalDistance);
float lineVerticalAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, lineVerticalPlane.xyz)));
color = max(color, lineVerticalColor * lineVerticalAlpha);
}
}`));H.intersectsLineEnabled&&(E.uniforms.add(new g.Float2PassUniform("angleCutoff",M=>D(M)),new m.Float3PassUniform("intersectsLineStart",(M,O)=>d.transformMat4(w,M.lineStartWorld,O.camera.viewMatrix)),new m.Float3PassUniform("intersectsLineEnd",(M,O)=>d.transformMat4(w,M.lineEndWorld,O.camera.viewMatrix)),new m.Float3PassUniform("intersectsLineDirection",(M,O)=>{d.copy(C,M.intersectsLineSegment.vector);C[3]=0;return d.normalize(w,t.transformMat4(C,C,O.camera.viewMatrix))}),new h.FloatPassUniform("intersectsLineRadius",
M=>M.intersectsLineRadius)),E.code.add(q.glsl`{
if (pointIsWithinLine(pos, intersectsLineStart, intersectsLineEnd)) {
float intersectsLineDistance = lineDistancePixels(intersectsLineStart, intersectsLineDirection, intersectsLineRadius, pos);
vec4 intersectsLineColor = laserlineProfile(intersectsLineDistance);
float intersectsLineAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, 1.0 - abs(dot(normal, intersectsLineDirection)));
color = max(color, intersectsLineColor * intersectsLineAlpha);
}
}`));E.code.add(q.glsl`fragColor = laserlineOutput(color * depthDiscontinuityAlpha);
}`);return K}function D(H){return l.set(p,Math.cos(H.angleCutoff),Math.cos(Math.max(0,H.angleCutoff-c.deg2rad(2))))}function v(H,K,E){d.transformMat4(J,H,E);d.copy(C,K);C[3]=0;t.transformMat4(C,C,E);return y.fromPositionAndNormal(J,C,L)}const I=c.deg2rad(6),p=e.create(),w=k.create(),C=u.create(),F=k.create(),G=k.create(),J=k.create(),L=y.create(),x=B.create();e=Object.freeze(Object.defineProperty({__proto__:null,build:r,defaultAngleCutoff:I},Symbol.toStringTag,{value:"Module"}));a.LaserlinesShader=
e;a.build=r;a.defaultAngleCutoff=I})},"esri/views/3d/webgl-engine/shaders/LaserlineTechniqueConfiguration":function(){define(["exports","../../../../chunks/tslib.es6","../core/shaderTechnique/ShaderTechniqueConfiguration","./LaserlinePathTechniqueConfiguration"],function(a,c,l,e){class d extends e.LaserlinePathTechniqueConfiguration{constructor(){super(...arguments);this.spherical=this.intersectsLineEnabled=this.lineVerticalPlaneEnabled=this.pointDistanceEnabled=this.heightManifoldEnabled=!1}}c.__decorate([l.parameter()],
d.prototype,"heightManifoldEnabled",void 0);c.__decorate([l.parameter()],d.prototype,"pointDistanceEnabled",void 0);c.__decorate([l.parameter()],d.prototype,"lineVerticalPlaneEnabled",void 0);c.__decorate([l.parameter()],d.prototype,"intersectsLineEnabled",void 0);c.__decorate([l.parameter()],d.prototype,"spherical",void 0);a.LaserlineTechniqueConfiguration=d;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/visualElements/ParallelLineVisualElement":function(){define("exports ../../../../core/reactiveUtils ../../../../core/screenUtils ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../chunks/vec4 ../../../../chunks/vec4f32 ../../../../layers/graphics/dehydratedPoint ./EngineVisualElement ../../terrain/OverlayRenderer ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/Material ../../webgl-engine/lib/RenderGeometry ../../webgl-engine/lib/VertexAttribute ../../webgl-engine/materials/RibbonLineMaterial".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m,n,h){class q extends B.EngineVisualElement{constructor(C){super(C);this._location=t.create();this._direction=t.fromValues(1,0,0);this._offset=this._width=1;this._length=18;this._color=f.fromValues(1,0,1,1);this._renderOccluded=g.RenderOccludedFlag.OccludeAndTransparent;this.applyProperties(C)}createObject3DResourceFactory(C){return{view:C,createResources:F=>this._createObject3DResources(F),destroyResources:F=>this._destroyObject3DResources(F),recreateGeometry:(F,
G)=>this._recreateObject3DGeometry(F,G),cameraChanged:()=>this._updateGeometry()}}createDrapedResourceFactory(C){return{view:C,createResources:()=>this._createDrapedResources(),destroyResources:F=>this._destroyDrapedResources(F),recreateGeometry:F=>this._recreateDrapedGeometry(F)}}get location(){return this._location}set location(C){k.exactEquals(this._location,C)||(k.copy(this._location,C),this._updateGeometry())}get direction(){return this._direction}set direction(C){k.exactEquals(this._direction,
C)||(k.copy(this._direction,C),this._updateGeometry())}setDirectionFromPoints(C,F){k.normalize(this._direction,k.subtract(this._direction,F,C));this._updateGeometry()}get width(){return this._width}set width(C){C!==this._width&&(this._width=C,this._updateMaterial())}get offset(){return this._offset}set offset(C){C!==this._offset&&(this._offset=C,this._updateGeometry())}get length(){return this._length}set length(C){C!==this._length&&(this._length=C,this._updateGeometry())}get color(){return this._color}set color(C){u.exactEquals(C,
this._color)||(u.copy(this._color,C),this._updateMaterial())}get renderOccluded(){return this._renderOccluded}set renderOccluded(C){C!==this._renderOccluded&&(this._renderOccluded=C,this._updateMaterial())}_createObject3DResources(C){const F=new h.RibbonLineMaterial(this.materialParameters),G=[];this._createObject3DGeometry(F,C,G);return{material:F,geometries:G,forEach:J=>{J(F);G.forEach(J)}}}_destroyObject3DResources(C){C.geometries.length=0}_recreateObject3DGeometry(C,F){C.geometries.length=0;this._createObject3DGeometry(C.material,
F,C.geometries)}_createObject3DGeometry(C,F,G){const [J,L]=this._createGeometries(C);F.addGeometry(J);F.addGeometry(L);G.push(J);G.push(L);this._updateVerticesObject3D(F)}_createDrapedResources(){const C=new h.RibbonLineMaterial(this.materialParameters),F=c.watch(()=>this.view.state.contentPixelRatio,()=>{this.drapedResources.recreateGeometry()});return{material:C,geometries:this._createDrapedGeometry(C),pixelRatioHandle:F}}_destroyDrapedResources(C){C.pixelRatioHandle.remove();C.geometries=[]}_recreateDrapedGeometry(C){C.geometries=
this._createDrapedGeometry(C.material)}_createDrapedGeometry(C){C=this._createGeometries(C);this._updateVerticesDraped(C);return C.map(F=>new m.RenderGeometry(F))}_createGeometries(C){return[b.createPolylineGeometry(C,[t.create(),t.create()]),b.createPolylineGeometry(C,[t.create(),t.create()])]}_updateMaterial(){const {materialParameters:C}=this;this.object3dResources.resources?.material.setParameters(C);this.drapedResources.resources?.material.setParameters(C)}get materialParameters(){return{width:this._width,
color:this._color,renderOccluded:this._renderOccluded,isDecoration:this.isDecoration}}_updateGeometry(){if(this.isDraped)this.drapedResources.recreateGeometry();else{const C=this.object3dResources.object;C&&this._updateVerticesObject3D(C)}}_updateVerticesObject3D(C){const F=this.view.state.camera;F.projectToScreen(this.location,I);k.add(z,this.location,this.direction);F.projectToScreen(z,p);e.normalize(p,e.subtract(p,p,I));this._updateVertexAttributesObject3D(F,C,0,I,p,1);this._updateVertexAttributesObject3D(F,
C,1,I,p,-1)}_updateVertexAttributesObject3D(C,F,G,J,L,x){G=F.geometries[G];const H=G.getMutableAttribute(n.VertexAttribute.POSITION)?.data;if(H){var {start:K,end:E}=this._computeStartEnd(L,J,x,this.offset,this.width,this.length);C.unprojectFromScreen(l.castScreenPointArray(K),z);H[0]=z[0];H[1]=z[1];H[2]=z[2];C.unprojectFromScreen(l.castScreenPointArray(E),z);H[3]=z[0];H[4]=z[1];H[5]=z[2];F.geometryVertexAttributeUpdated(G,n.VertexAttribute.POSITION)}}_updateVerticesDraped(C){const {view:{basemapTerrain:{overlayManager:F},
state:{contentPixelRatio:G}}}=this,{location:J,width:L,length:x,offset:H}=this;var K=w;K.spatialReference=F.renderer.spatialReference;K.x=J[0];K.y=J[1];var E=this.view.overlayPixelSizeInMapUnits(K)*G;K=L*E;const M=x*E;E*=H;this._updateVertexAttributesDraped(C[0],K,M,E,-1);this._updateVertexAttributesDraped(C[1],K,M,E,1)}_updateVertexAttributesDraped(C,F,G,J,L){const x=C.getMutableAttribute(n.VertexAttribute.POSITION)?.data;if(x){var {location:H,direction:K}=this,{start:E,end:M}=this._computeStartEnd(K,
H,L,J,F,G);x[0]=E[0];x[1]=E[1];x[2]=A.drapedZ;x[3]=M[0];x[4]=M[1];x[5]=A.drapedZ;C.invalidateBoundingInfo()}}_computeStartEnd(C,F,G,J,L,x){G=e.scale(r,e.set(r,C[1]*G,C[0]*-G),J+L/2);F=e.add(D,e.add(D,e.add(D,F,e.scale(D,C,x/2)),G),G);C=e.add(v,F,e.scale(v,C,-x));return{start:F,end:C}}}const z=t.create(),r=d.create(),D=d.create(),v=d.create(),I=l.createScreenPointArray(),p=l.createScreenPointArray(),w=y.makeDehydratedPoint(0,0,void 0,null);a.ParallelLineVisualElement=q;Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/views/3d/interactive/visualElements/PointVisualElement":function(){define("exports ../../../../core/mathUtils ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../chunks/vec4 ../../../../chunks/vec4f64 ../../../../geometry/projection/projectVectorToVector ../../../../geometry/support/aaBoundingBox ../../../../geometry/support/vectorStacks ./Object3DVisualElement ../../layers/graphics/elevationAlignmentUtils ../../layers/graphics/ElevationContext ../../support/engineContent/sdfPrimitives ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/VertexAttribute ../../webgl-engine/materials/HUDMaterial".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m,n){class h extends y.Object3DVisualElement{constructor(D){super(D);this._geometry=this._texture=this._material=null;this._size=3;this._color=k.fromValues(1,0,1,1);this._pixelSnappingEnabled=!0;this._primitive="square";this._outlineSize=1;this._outlineColor=k.fromValues(1,1,1,1);this._elevationInfo=null;this.applyProperties(D)}get geometry(){return this._geometry}set geometry(D){this._geometry=D;this.recreateGeometry()}get size(){return this._size}set size(D){if(D!==
this._size){const v=this._preferredTextureSize;this._size=D;v<this._preferredTextureSize?this.recreate():this._updateSizeAttribute()}}get color(){return this._color}set color(D){d.exactEquals(D,this._color)||(d.copy(this._color,D),this._updateMaterial())}get pixelSnappingEnabled(){return this._pixelSnappingEnabled}set pixelSnappingEnabled(D){this._pixelSnappingEnabled!==D&&(this._pixelSnappingEnabled=D,this._updateMaterial())}get primitive(){return this._primitive}set primitive(D){this._primitive!==
D&&(this._primitive=D,this.recreate())}get outlineSize(){return this._outlineSize}set outlineSize(D){D!==this._outlineSize&&(this._outlineSize=D,this._updateMaterial())}get outlineColor(){return this._outlineColor}set outlineColor(D){d.exactEquals(D,this._outlineColor)||(d.copy(this._outlineColor,D),this._updateMaterial())}get elevationInfo(){return this._elevationInfo}set elevationInfo(D){this._elevationInfo=D;this.recreateGeometry()}_updateMaterial(){this._material&&this._material.setParameters(this._materialParameters)}_updateSizeAttribute(){const D=
this.object;if(null!=D){var v=D.geometries[0];if(null!=v){v=v.getMutableAttribute(m.VertexAttribute.SIZE).data;var I=this._geometrySize;v[0]=I;v[1]=I;D.geometryVertexAttributeUpdated(D.geometries[0],m.VertexAttribute.SIZE)}}}get _materialParameters(){return{color:this._color,textureIsSignedDistanceField:!0,sampleSignedDistanceFieldTexelCenter:b.requiresHalfTexelOffset(this._primitive),distanceFieldBoundingBox:z,occlusionTest:!1,outlineColor:this._outlineColor,outlineSize:this._outlineSize,textureId:this._texture?.id,
polygonOffset:!1,shaderPolygonOffset:0,drawInSecondSlot:!0,depthEnabled:!1,pixelSnappingEnabled:this.pixelSnappingEnabled,isDecoration:this.isDecoration}}get _geometrySize(){return this._size/q}createExternalResources(){this._texture=b.createTexture(this._primitive,this._preferredTextureSize);this._material=new n.HUDMaterial(this._materialParameters);const D=this.view._stage;this._texture.load(D.renderView.renderingContext);D.add(this._texture)}destroyExternalResources(){this._texture&&(this.view._stage.remove(this._texture),
this._texture.dispose(),this._texture=null);this._material=null}createGeometries(D){const v=this._createRenderGeometry();null!=v&&D.addGeometry(v)}forEachExternalMaterial(D){this._material&&D(this._material)}get _preferredTextureSize(){return c.clamp(2*this._geometrySize,16,128)}calculateMapBounds(D){var v=this.object?.geometries[0];if(!v)return!1;v=v.attributes.get(m.VertexAttribute.POSITION);t.projectVectorToVector(v.data,this.view.renderCoordsHelper.spatialReference,r,this.view.spatialReference);
u.expandWithBuffer(D,r);return!0}_createRenderGeometry(){const {geometry:D,_material:v}=this;if(null==D||null==v)return null;const {renderCoordsHelper:I,elevationProvider:p}=this.view;var w=B.evaluateElevationAlignmentAtPoint(D,p,A.ElevationContext.fromElevationInfo(this.elevationInfo),I),C=l.set(f.sv3d.get(),D.x,D.y,w);w=f.sv3d.get();t.projectVectorToVector(C,D.spatialReference,w,I.spatialReference);C=this._geometrySize;return g.createPointGeometry(v,null,w,null,[C,C],[0,0,0,1])}}const q=b.defaultSymbolSizeRatio,
z=[q/2,q/2,1-q/2,1-q/2],r=e.create();a.PointVisualElement=h;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/visualElements/Object3DVisualElement":function(){define("exports ../../../../chunks/mat4 ../../../../chunks/mat4f64 ./VisualElement ../../webgl-engine/lib/Object3D ../../webgl-engine/lib/UpdatePolicy ../../webgl-engine/lib/WebGLLayer".split(" "),function(a,c,l,e,d,k,t){class u extends e.VisualElement{constructor(f){super(f);this._resources=null;this._transform=
l.create()}get object(){return null!=this._resources?this._resources.object:null}get transform(){return this._transform}set transform(f){c.copy(this._transform,f);null!=this._resources&&(this._resources.object.transformation=this._transform)}recreate(){this.attached&&this.createResources()}recreateGeometry(){if(null!=this._resources){var f=this._resources.object,y=this.view._stage;y.removeMany(f.geometries);f.removeAllGeometries();this.createGeometries(f);f.visible=this.visible;y.addMany(f.geometries)}}createResources(){this.destroyResources();
const f=this.view._stage;if(f){var y=new t.WebGLLayer(f,{pickable:!1,updatePolicy:k.UpdatePolicy.SYNC}),B=new d.Object3D({castShadow:!1});B.transformation=this._transform;this.createExternalResources();this.createGeometries(B);f.addMany(B.geometries);this.forEachExternalMaterial(A=>f.add(A));f.add(B);y.add(B);B.visible=this.visible;this._resources={layer:y,object:B}}}destroyResources(){const f=this.view._stage;null!=this._resources&&f&&(f.remove(this._resources.object),this._resources.layer.destroy(),
this.forEachExternalMaterial(y=>{f.remove(y)}),f.removeMany(this._resources.object.geometries),this._resources.object.dispose(),this.destroyExternalResources(),this._resources=null)}updateVisibility(f){null!=this._resources&&(this._resources.object.visible=f)}}a.Object3DVisualElement=u;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/visualElements/RightAngleQuadVisualElement":function(){define("exports ../../../../core/reactiveUtils ../../../../chunks/mat4 ../../../../chunks/mat4f64 ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../chunks/vec4 ../../../../chunks/vec4f64 ../../../../geometry/support/vectorStacks ../../../../layers/graphics/dehydratedPoint ./EngineVisualElement ../../terrain/OverlayRenderer ../../webgl-engine/lib/Attribute ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/Material ../../webgl-engine/lib/RenderGeometry ../../webgl-engine/lib/VertexAttribute ../../webgl-engine/materials/ColorMaterial ../../webgl-engine/materials/RibbonLineMaterial".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m,n,h,q,z,r){class D extends B.EngineVisualElement{constructor(p){super(p);this._maxSize=0;this._position=k.create();this._up=k.create();this._right=k.create();this._renderOccluded=n.RenderOccludedFlag.OccludeAndTransparent;this._color=u.fromValues(1,0,0,1);this._outlineColor=u.fromValues(0,0,0,1);this._outlineSize=0;this._size=32;this._outlineRenderOccluded=n.RenderOccludedFlag.Opaque;this.applyProperties(p)}createObject3DResourceFactory(p){return{view:p,createResources:w=>
this._createObject3DResources(w),destroyResources:()=>{},cameraChanged:()=>this._updateTransformObject3D()}}createDrapedResourceFactory(p){return{view:p,createResources:()=>this._createDrapedResources(),destroyResources:w=>this._destroyDrapedResources(w)}}get renderOccluded(){return this._renderOccluded}set renderOccluded(p){p!==this._renderOccluded&&(this._renderOccluded=p,this._updateQuadMaterial())}get color(){return this._color}set color(p){t.copy(this._color,p);this._updateQuadMaterial()}get outlineColor(){return this._outlineColor}set outlineColor(p){t.copy(this._outlineColor,
p);this._updateOutlineMaterial()}get outlineSize(){return this._outlineSize}set outlineSize(p){const w=0===this._outlineSize!==(0===p);this._outlineSize=p;w?this.recreateGeometry():this._updateOutlineMaterial()}get size(){return this._size}set size(p){p!==this._size&&(this._size=p,this._updateTransform())}get outlineRenderOccluded(){return this._outlineRenderOccluded}set outlineRenderOccluded(p){this._outlineRenderOccluded=p;this._updateOutlineMaterial()}set geometry({previous:p,center:w,next:C}){this._maxSize=
Math.min(d.distance(w,p),d.distance(w,C))/3;d.normalize(this._up,d.subtract(this._up,p,w));d.normalize(this._right,d.subtract(this._right,C,w));d.copy(this._position,w);this.recreateGeometry()}_createObject3DResources(p){const w=new z.ColorMaterial(this._quadMaterialParameters),C=0===this._outlineSize?void 0:new r.RibbonLineMaterial(this._outlineMaterialParameters);this._createObject3DGeometries(p,w,C);return{quadMaterial:w,outlineMaterial:C,forEach:F=>{F(w);C&&F(C)}}}_createObject3DGeometries(p,
w,C){if(!d.exactEquals(this._up,k.ZEROS)||!d.exactEquals(this._right,k.ZEROS)){w=this._createGeometries(w,C);for(const F of w)p.addGeometry(F);this._updateTransformObject3D(p)}}_createDrapedResources(){const p=new z.ColorMaterial(this._quadMaterialParameters),w=0===this._outlineSize?void 0:new r.RibbonLineMaterial(this._outlineMaterialParameters),C=this._createGeometries(p,w).map(G=>new h.RenderGeometry(G));this._setTransformDraped(C);const F=c.watch(()=>this.view.state.contentPixelRatio,()=>{this.drapedResources.recreateGeometry()});
return{quadMaterial:p,outlineMaterial:w,geometries:C,pixelRatioHandle:F}}_destroyDrapedResources(p){p.pixelRatioHandle.remove();p.geometries=[]}_createGeometries(p,w){const {up:C,right:F,corner:G}=this._getVertices();p=this._quadGeometryData(C,F,G,p);if(!w)return[p];w=m.createPolylineGeometry(w,[C,G,F]);return[p,w]}_getVertices(){let p=this._up,w=this._right;const C=d.add(f.sv3d.get(),p,w);this.isDraped&&(p=d.copy(f.sv3d.get(),p),w=d.copy(f.sv3d.get(),w),p[2]=0,w[2]=0,C[2]=0);return{up:p,right:w,
corner:C}}_updateTransform(){this.isDraped?this.drapedResources.recreateGeometry():this._updateTransformObject3D()}_updateTransformObject3D(p=this.object3dResources.object){if(p){var w=this._size*this.view.state.camera.computeScreenPixelSizeAt(this._position);w=Math.min(this._maxSize,w);l.fromTranslation(v,this._position);l.scale(v,v,[w,w,w]);p.transformation=v}}_setTransformDraped(p){if(0!==p.length){var {view:{basemapTerrain:{overlayManager:w},state:{contentPixelRatio:C}}}=this,{_position:F,_size:G}=
this,J=d.copy(f.sv3d.get(),F);J[2]=A.drapedZ;var L=I;L.spatialReference=w.renderer.spatialReference;L.x=J[0];L.y=J[1];L=this.view.overlayPixelSizeInMapUnits(L)*C;L=Math.min(this._maxSize,G*L);l.fromTranslation(v,J);l.scale(v,v,[L,L,1]);for(const x of p)x.transformation=v}}_quadGeometryData(p,w,C,F){return new g.Geometry(F,[[q.VertexAttribute.POSITION,new b.Attribute([0,0,0,...w,...p,...C],[0,1,2,1,2,3],3,!0)]])}get _quadMaterialParameters(){return{color:this._color,forceTransparentMode:!0,writeDepth:!1,
polygonOffset:!0,renderOccluded:this._renderOccluded,isDecoration:this.isDecoration}}_updateQuadMaterial(){this.object3dResources.resources?.quadMaterial.setParameters(this._quadMaterialParameters);this.drapedResources.resources?.quadMaterial.setParameters(this._quadMaterialParameters)}get _outlineMaterialParameters(){return{color:this._outlineColor,width:this._outlineSize,renderOccluded:this._outlineRenderOccluded,isDecoration:this.isDecoration}}_updateOutlineMaterial(){this.object3dResources.resources?.outlineMaterial?.setParameters(this._outlineMaterialParameters);
this.drapedResources.resources?.outlineMaterial?.setParameters(this._outlineMaterialParameters)}}const v=e.create(),I=y.makeDehydratedPoint(0,0,void 0,null);a.RightAngleQuadVisualElement=D;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/sketch/normalizedPoint":function(){define(["exports","../../../chunks/vec3f64","../../../layers/graphics/dehydratedPoint","../../../support/elevationInfoUtils"],function(a,c,l,e){function d(t,u,f){if(null==t)return null;if(null==
u)return c.fromValues(t.x,t.y,t.z??0);if("2d"===u.type)return c.fromValues(t.x,t.y,0);u=e.getConvertedElevation(u,t,f,e.absoluteHeightElevationInfo)??0;return c.fromValues(t.x,t.y,u)}const k=l.makeDehydratedPoint(0,0,0,null);a.clone=function(t){return c.clone(t)};a.create=function(t,u,f){return c.fromValues(t,u,f)};a.fromAnyMapPoint=function(t,u,{coordinateHelper:f,elevationInfo:y}){return t?d(f.vectorToDehydratedPoint(t,k),u,y):null};a.fromPoint=d;a.fromValues=function(t,u,f){return c.fromValues(t,
u,f)};a.fromVec3=function(t){return t};a.toDehydratedPoint=function(t,u){return l.makeDehydratedPoint(t[0],t[1],t[2],u)};a.toWritableVec3=function(t){return c.clone(t)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/Settings":function(){define("exports ../../../chunks/tslib.es6 ../../../Color ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/subclass".split(" "),function(a,c,l,e,d,
k){let t=class extends e.JSONSupport{constructor(){super(...arguments);this.enabled=!0}};c.__decorate([d.property({type:Boolean})],t.prototype,"enabled",void 0);t=c.__decorate([k.subclass("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],t);e=class extends e.JSONSupport{constructor(u){super(u);this.lineSnapper=new t;this.parallelLineSnapper=new t;this.rightAngleSnapper=new t;this.rightAngleTriangleSnapper=new t;this.shortLineThreshold=15;this.distance=5;this.parallelLineThreshold=
this.intersectionParallelLineThreshold=this.pointThreshold=1E-6;this.verticalLineThreshold=.1;this.touchSensitivityMultiplier=1.5;this.pointOnLineThreshold=1E-6;this.orange=new l([255,127,0]);this.orangeTransparent=new l([255,127,0,.5]);this.lineHintWidthTarget=this.lineHintWidthReference=3;this.lineHintFadedExtensions=.3;this.parallelLineHintWidth=2;this.parallelLineHintLength=24;this.parallelLineHintOffset=1.5;this.rightAngleHintSize=24;this.rightAngleHintOutlineSize=1.5;this.satisfiesConstraintScreenThreshold=
1}};c.__decorate([d.property({type:t,constructOnly:!0,nonNullable:!0,json:{write:!0}})],e.prototype,"lineSnapper",void 0);c.__decorate([d.property({type:t,constructOnly:!0,nonNullable:!0,json:{write:!0}})],e.prototype,"parallelLineSnapper",void 0);c.__decorate([d.property({type:t,constructOnly:!0,nonNullable:!0,json:{write:!0}})],e.prototype,"rightAngleSnapper",void 0);c.__decorate([d.property({type:t,constructOnly:!0,nonNullable:!0,json:{write:!0}})],e.prototype,"rightAngleTriangleSnapper",void 0);
c.__decorate([d.property({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],e.prototype,"shortLineThreshold",void 0);c.__decorate([d.property({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],e.prototype,"distance",void 0);c.__decorate([d.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],e.prototype,"pointThreshold",void 0);c.__decorate([d.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],
e.prototype,"intersectionParallelLineThreshold",void 0);c.__decorate([d.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],e.prototype,"parallelLineThreshold",void 0);c.__decorate([d.property({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],e.prototype,"verticalLineThreshold",void 0);c.__decorate([d.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],e.prototype,"touchSensitivityMultiplier",void 0);c.__decorate([d.property({type:Number,
nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],e.prototype,"pointOnLineThreshold",void 0);c.__decorate([d.property({type:l,nonNullable:!0})],e.prototype,"orange",void 0);c.__decorate([d.property({type:l,nonNullable:!0})],e.prototype,"orangeTransparent",void 0);c.__decorate([d.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],e.prototype,"lineHintWidthReference",void 0);c.__decorate([d.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],
e.prototype,"lineHintWidthTarget",void 0);c.__decorate([d.property({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],e.prototype,"lineHintFadedExtensions",void 0);c.__decorate([d.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],e.prototype,"parallelLineHintWidth",void 0);c.__decorate([d.property({type:Number,nonNullable:!0,range:{min:0,max:50},json:{write:!0}})],e.prototype,"parallelLineHintLength",void 0);c.__decorate([d.property({type:Number,nonNullable:!0,
range:{min:0,max:5},json:{write:!0}})],e.prototype,"parallelLineHintOffset",void 0);c.__decorate([d.property({type:Number,nonNullable:!0,range:{min:0,max:46},json:{write:!0}})],e.prototype,"rightAngleHintSize",void 0);c.__decorate([d.property({type:Number,nonNullable:!0,range:{min:0,max:6},json:{write:!0}})],e.prototype,"rightAngleHintOutlineSize",void 0);c.__decorate([d.property({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],e.prototype,"satisfiesConstraintScreenThreshold",void 0);
e=c.__decorate([k.subclass("esri.views.interactive.snapping.Settings.Defaults")],e);c=new e;a.defaults=c;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingDomain":function(){define(["exports"],function(a){a.SnappingDomain=void 0;var c=a.SnappingDomain||(a.SnappingDomain={});c[c.FEATURE=1]="FEATURE";c[c.SELF=2]="SELF";c[c.ALL=3]="ALL";Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/snappingUtils":function(){define("exports ../../../core/reactiveUtils ../../../core/SetUtils ../../../core/sql ../../../core/timeUtils ../../../chunks/vec3 ../../../layers/graphics/dehydratedPoint ../../../rest/support/Query ../../input/InputManager ../keybindings ../sketch/normalizedPoint".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B){function A(b,g){const m=b.x-g.x;b=b.y-g.y;return m*m+b*b}a.LineSegmentHintType=void 0;(function(b){b[b.TARGET=0]="TARGET";b[b.REFERENCE=1]="REFERENCE";b[b.REFERENCE_EXTENSION=2]="REFERENCE_EXTENSION"})(a.LineSegmentHintType||(a.LineSegmentHintType={}));a.editEdgeToSnappingEdge=function(b,g,m){return{left:B.fromAnyMapPoint(b.leftVertex.pos,g,m),right:B.fromAnyMapPoint(b.rightVertex.pos,g,m)}};a.isUtilityNetworkWebMap=function(b){return null!=b&&"object"===typeof b&&
"declaredClass"in b&&"esri.WebMap"===b.declaredClass&&"utilityNetworks"in b&&!!b?.utilityNetworks?.length};a.makeFilter=function(b){return b.createQuery()};a.makeSnappingQuery=function({point:b,distance:g,returnEdge:m,vertexMode:n,coordinateHelper:{spatialReference:h},filter:q},z,r){r=null!=r?r.clone():new u({where:"1\x3d1"});if(q){r.geometry=q.geometry;r.distance=q.distance;r.spatialRelationship=q.spatialRelationship;r.where=e.sqlAnd(r.where,q.where);r.timeExtent=d.mergeTimeExtents(r.timeExtent,
q.timeExtent);var D=r;var v=r.objectIds;q=q.objectIds;v=v||q?q?v?Array.from(l.intersection(new Set(v),new Set(q))):q:v:null;D.objectIds=v}return{point:t.makeDehydratedPoint(b[0],b[1],b[2],h.toJSON()),mode:z,distance:g,returnEdge:m,vertexMode:n,query:r.toJSON()}};a.objectEqual=function(b,g){const m=b.length===g.length&&b[0]===g[0]&&b[1]===g[1];switch(b.length){case 2:return m;case 3:return m&&b[2]===g[2];case 4:return m&&b[2]===g[2]&&b[3]===g[3]}return!1};a.screenDistance=function(b,g){return Math.sqrt(A(b,
g))};a.setupSnappingToggleHandles=function(b,g=()=>{}){const m=c.watch(()=>({view:b.view,snappingOptions:b.snappingOptions}),({view:n,snappingOptions:h})=>{const q=f.ViewEventPriorities.TOOL;b.removeHandles("snapping-toggle");n&&null!=h&&(n=[n.on("key-down",z=>{z.key!==y.snappingKeys.toggle||z.repeat||(h.enabledToggled=!0,g())},q),n.on("key-up",z=>{z.key===y.snappingKeys.toggle&&(h.enabledToggled=!1,g())},q),n.on("pointer-move",z=>{z=z.native.ctrlKey;h.enabledToggled!==z&&(h.enabledToggled=z,g())},
q)],b.addHandles(n,"snapping-toggle"))},c.syncAndInitial);b.addHandles(m)};a.sortCandidatesInPlace=function(b,g){g.sort((m,n)=>{m=k.squaredDistance(m.targetPoint,b);n=k.squaredDistance(n.targetPoint,b);return m-n})};a.squaredScreenDistance=A;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/keybindings":function(){define(["exports"],function(a){a.sketchKeys={redo:"r",undo:"z",center:"Alt",constraint:"Shift",cancel:"Escape",delete:["Backspace","Delete"],complete:"Enter",
vertexAdd:"f",pan:" "};a.snappingKeys={toggle:"Control"};a.tooltipKeys={enterInputMode:"Tab",commit:"Enter",discard:"Escape",next:"Tab"};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingVisualizer":function(){define("exports ../../../core/handleUtils ./hints/IntersectionSnappingHint ./hints/LineSnappingHint ./hints/ParallelSnappingHint ./hints/PointSnappingHint ./hints/RightAngleSnappingHint".split(" "),function(a,c,l,e,d,k,t){class u{draw(f,
y){f=this._getUniqueHints(f);f=this.sortUniqueHints(f);const B=[];for(const A of f)A instanceof l.IntersectionSnappingHint&&B.push(this.visualizeIntersectionPoint(A,y)),A instanceof e.LineSnappingHint&&B.push(this.visualizeLine(A,y)),A instanceof d.ParallelSnappingHint&&B.push(this.visualizeParallelSign(A,y)),A instanceof t.RightAngleSnappingHint&&B.push(this.visualizeRightAngleQuad(A,y)),A instanceof k.PointSnappingHint&&B.push(this.visualizePoint(A,y));return c.handlesGroup(B)}sortUniqueHints(f){return f}_getUniqueHints(f){const y=
[];for(const B of f){f=!0;for(const A of y)if(B.equals(A)){f=!1;break}f&&y.push(B)}return y}}a.SnappingVisualizer=u;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/IntersectionSnappingHint":function(){define(["exports","../../../../chunks/vec3","../SnappingDomain","./SnappingHint"],function(a,c,l,e){class d extends e.SnappingHint{constructor(k,t,u=l.SnappingDomain.ALL){super(t,u);this.intersectionPoint=k}equals(k){return k instanceof d?c.exactEquals(this.intersectionPoint,
k.intersectionPoint):!1}}a.IntersectionSnappingHint=d;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/SnappingHint":function(){define(["exports"],function(a){class c{constructor(l,e){this.isDraped=l;this.domain=e}}a.SnappingHint=c;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/LineSnappingHint":function(){define("exports ../../../../core/has ../../../../core/Logger ../../../../chunks/vec3 ../SnappingDomain ./SnappingHint".split(" "),
function(a,c,l,e,d,k){class t extends k.SnappingHint{constructor(u,f,y,B,A=d.SnappingDomain.ALL,b=!0,g=!0){super(B,A);this.type=u;this.lineStart=f;this.lineEnd=y;this.fadeLeft=b;this.fadeRight=g}equals(u){return u instanceof t?this.type===u.type&&e.exactEquals(this.lineStart,u.lineStart)&&e.exactEquals(this.lineEnd,u.lineEnd)&&this.fadeLeft===u.fadeLeft&&this.fadeRight===u.fadeRight:!1}get length(){return e.distance(this.lineStart,this.lineEnd)}}a.LineSnappingHint=t;Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/views/interactive/snapping/hints/ParallelSnappingHint":function(){define("exports ../../../../core/has ../../../../core/Logger ../../../../chunks/vec3 ../SnappingDomain ./SnappingHint".split(" "),function(a,c,l,e,d,k){class t extends k.SnappingHint{constructor(u,f,y,B=d.SnappingDomain.ALL){super(y,B);this.lineStart=u;this.lineEnd=f}equals(u){return u instanceof t?e.exactEquals(this.lineStart,u.lineStart)&&e.exactEquals(this.lineEnd,u.lineEnd):!1}}a.ParallelSnappingHint=
t;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/PointSnappingHint":function(){define(["exports","../../../../chunks/vec3","./SnappingHint"],function(a,c,l){class e extends l.SnappingHint{constructor(d,k,t){super(k,t);this.point=d}equals(d){return d instanceof e?c.exactEquals(this.point,d.point):!1}}a.PointSnappingHint=e;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/RightAngleSnappingHint":function(){define("exports ../../../../core/has ../../../../core/Logger ../../../../chunks/vec3 ../SnappingDomain ./SnappingHint".split(" "),
function(a,c,l,e,d,k){class t extends k.SnappingHint{constructor(u,f,y,B,A=d.SnappingDomain.ALL){super(B,A);this.previousVertex=u;this.centerVertex=f;this.nextVertex=y}equals(u){return u instanceof t?e.exactEquals(this.previousVertex,u.previousVertex)&&e.exactEquals(this.centerVertex,u.centerVertex)&&e.exactEquals(this.nextVertex,u.nextVertex):!1}}a.RightAngleSnappingHint=t;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/meshFastUpdateUtils":function(){define(["exports",
"../../../../core/handleUtils","../../../../core/reactiveUtils","../../../../layers/graphics/sources/interfaces"],function(a,c,l,e){function d(t){const {geometry:u}=t;"mesh"!==u?.type||u.vertexSpace.isGeoreferenced||t.notifyMeshTransformChanged({action:e.MeshTransformUpdateAction.EnableFastUpdates})}function k(t){const {geometry:u}=t;"mesh"!==u?.type||u.vertexSpace.isGeoreferenced||t.notifyMeshTransformChanged({action:e.MeshTransformUpdateAction.DisableFastUpdates})}a.meshTransformFastUpdateHandles=
function(t){const {graphic:u}=t;return[l.watch(()=>t.displaying,f=>{f?d(u):k(u)},{...l.syncAndInitial}),c.makeHandle(()=>k(u))]};a.tryDisableMeshTransformFastUpdates=k;a.tryEnableMeshTransformFastUpdates=d;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/settings":function(){define("exports ../../../../chunks/tslib.es6 ../../../../Color ../../../../core/Accessor ../../../../core/colorUtils ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/decorators/subclass ../visualElements/ExtendedLineVisualElement ../../webgl-engine/lib/Material ../../webgl-engine/materials/lineStippleUtils".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b){function g(C,F){F&&Object.assign(C,F)}class m{constructor(C){this.height=90;this.coneHeight=40;this.coneWidth=23;this.width=3;this.renderOccluded=A.RenderOccludedFlag.Opaque;this.color=C.accent}}class n{constructor({colors:C,...F}){this.size=11;this.outlineSize=1;this.collisionPadding=9;this.color=C.accent;this.outlineColor=C.outline;this.renderOccluded=A.RenderOccludedFlag.Opaque;this.hoverOutlineColor=C.selectedOutline;g(this,F)}applyColor(C){this._apply(this.color,
C)}applyOutline(C){this._apply(this.outlineColor,C)}applyHoverOutline(C){this._apply(this.hoverOutlineColor,C)}_apply(C,F){F.setParameters({color:d.unitRGBAFromColor(C),renderOccluded:this.renderOccluded})}}class h{constructor({colors:C,...F}){this.size=40;this.height=.2;this.offset=.25;this.collisionPadding=2;this.renderOccluded=A.RenderOccludedFlag.Transparent;this.minSquaredEdgeLength=900;this.color=d.multiplyOpacity(C.accent,.5);this.hoverColor=C.accent;g(this,F)}applyColor(C){this._apply(this.color,
C)}applyHover(C){this._apply(this.hoverColor,C)}_apply(C,F){F.setParameters({color:d.unitRGBAFromColor(C),renderOccluded:this.renderOccluded})}}class q{constructor(C){this.vertex=new n({colors:C,color:C.accent,outlineColor:C.outline});this.edge=new n({colors:C,color:d.desaturate(d.multiplyOpacity(C.accent,2/3),.5),outlineColor:d.multiplyOpacity(C.outline,.5),size:8,collisionPadding:8});this.selected=new n({colors:C,color:C.selected,outlineColor:C.outline});this.edgeOffset=new h({colors:C})}}class z{constructor({colors:C,
...F}){this.width=1.5;this.stipplePattern=b.createStipplePatternSimple(3.3);this.falloff=0;this.innerWidth=1.5;this.renderOccluded=A.RenderOccludedFlag.OccludeAndTransparent;this.color=C.selected;this.stippleOffColor=C.outline;this.innerColor=C.selected;g(this,F)}apply(C){C.color=d.unitRGBAFromColor(this.color);C.width=this.width;C.stipplePattern=this.stipplePattern;C.stippleOffColor=d.unitRGBAFromColor(this.stippleOffColor);C.falloff=this.falloff;C.innerWidth=this.innerWidth;C.innerColor=d.unitRGBAFromColor(this.innerColor);
C.renderOccluded=this.renderOccluded}}class r{constructor({colors:C,...F}){this.size=4;this.outlineSize=1;this.shape="square";this.color=C.selected;this.outlineColor=C.outline;g(this,F)}apply(C){C.color=d.unitRGBAFromColor(this.color);C.size=this.size;C.outlineSize=this.outlineSize;C.outlineColor=d.unitRGBAFromColor(this.outlineColor);C.primitive=this.shape}}class D{constructor({colors:C,...F}){this.innerWidth=1;this.glowFalloff=this.glowWidth=8;this.globalAlpha=.3;this.globalAlphaContrastBoost=1.5;
this.radius=3;this.innerColor=C.selected;this.heightFillColor=this.glowColor=C.accent;g(this,F)}apply(C,F=1){F={glowColor:l.toUnitRGB(this.glowColor),glowFalloff:this.glowFalloff,glowWidth:this.glowWidth,innerColor:l.toUnitRGB(this.innerColor),innerWidth:this.innerWidth,globalAlpha:this.globalAlpha*F*this.glowColor.a,globalAlphaContrastBoost:this.globalAlphaContrastBoost,intersectsLineRadius:this.radius};"style"in C?C.style=F:C.laserlineStyle=F}}class v{constructor(C){this.outline=new z({colors:C,
color:C.stippleOff,renderOccluded:A.RenderOccludedFlag.OccludeAndTransparentStencil,stippleOffColor:C.stippleOn,innerWidth:0});this.staged=new z({colors:C,color:C.stippleOn,renderOccluded:A.RenderOccludedFlag.OccludeAndTransparentStencil,innerColor:C.stagedSolid,stippleOffColor:C.stippleOff});this.shadowStyle=new D({colors:C,globalAlpha:.3,glowColor:C.accent,glowFalloff:8,glowWidth:8,innerColor:C.selected,innerWidth:1})}}class I{constructor(C){this.outline=new r({colors:C,color:C.selected,outlineColor:C.outline,
outlineSize:1,shape:"circle",size:4});this.shadowStyle=new D({colors:C,globalAlpha:.3,glowColor:C.accent,glowFalloff:1.5,glowWidth:6,innerColor:C.selected,innerWidth:1,radius:2})}}class p extends z{constructor({colors:C,...F}){super({colors:C});this.extensionType=B.ExtensionType.GROUND_RAY;g(this,F)}}class w{constructor(C){this.laserlineAlphaMultiplier=1.5;this.heightPlaneAngleCutoff=20;this.lineGraphics=new v(C);this.pointGraphics=new I(C);this.heightPlane=new D({colors:C,globalAlpha:.3,glowColor:C.accent,
glowFalloff:8,glowWidth:8,innerColor:C.selected,innerWidth:1});this.heightBox=new D({colors:C,globalAlpha:.3,glowColor:C.accent,glowFalloff:8,glowWidth:8,innerColor:C.selected,innerWidth:0,heightFillColor:C.accent});this.zVerticalLine=new p({colors:C,color:d.multiplyOpacity(C.accent,.5),falloff:2,innerColor:d.multiplyOpacity(C.selected,0),renderOccluded:A.RenderOccludedFlag.OccludeAndTransparent,stipplePattern:null,width:5,extensionType:B.ExtensionType.GROUND_RAY})}}a.Settings=class extends e{constructor(C){super(C)}get colors(){const C=
this.getTheme().accentColor,F=C.a;return{accent:C,contrast:d.getContrast(C),selected:l.fromArray([255,255,255,F]),selectedOutline:l.fromArray([255,255,255,F]),staged:l.fromArray([12,207,255,F]),stagedSolid:l.fromArray([12,207,255,1]),outline:l.fromArray([0,0,0,.5*F]),stippleOn:l.fromArray([255,255,255,1]),stippleOff:l.fromArray([0,0,0,.5])}}get visualElements(){return new w(this.colors)}get manipulators(){return new q(this.colors)}get zManipulator(){return new m(this.colors)}};c.__decorate([k.property()],
a.Settings.prototype,"colors",null);c.__decorate([k.property()],a.Settings.prototype,"visualElements",null);c.__decorate([k.property()],a.Settings.prototype,"manipulators",null);c.__decorate([k.property()],a.Settings.prototype,"zManipulator",null);c.__decorate([k.property()],a.Settings.prototype,"getTheme",void 0);a.Settings=c.__decorate([y.subclass("esri.views.3d.interactive.editingTools.settings.Settings")],a.Settings);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/visualElements/OutlineVisualElement":function(){define("exports ../../../../core/Evented ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../chunks/vec4 ../../../../chunks/vec4f32 ../../../../geometry/projection/projectBuffer ../../../../geometry/support/aaBoundingBox ../../../../geometry/support/DoubleArray ../../../../layers/graphics/dehydratedPoint ../../../../support/elevationInfoUtils ../../../../symbols/support/ElevationInfo ./EngineVisualElement ./LaserlineVisualElement ../../layers/graphics/ElevationContext ../../support/engineContent/line ../../support/renderInfoUtils/line ../../webgl-engine/lib/Material ../../webgl-engine/lib/RenderGeometry ../../webgl-engine/lib/VertexAttribute ../../webgl-engine/materials/RibbonLineMaterial".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m,n,h,q,z,r,D){class v extends b.EngineVisualElement{constructor(w){super(w);this._attachmentOrigin=y.makeDehydratedPoint(0,0,0,null);this._attachmentOriginDirty=!0;this.events=new c;this._geometry=null;this._width=1;this._color=k.fromValues(1,0,1,1);this._innerWidth=0;this._innerColor=k.fromValues(1,1,1,1);this._stippleOffColor=this._stipplePattern=null;this._falloff=0;this._laserlineStyle=this._elevationInfo=null;this._laserlineEnabled=!1;this._renderOccluded=
q.RenderOccludedFlag.OccludeAndTransparentStencil;this._attachmentOrigin.spatialReference=w.view.spatialReference;this._laserline=new g.LaserlineVisualElement({view:w.view,isDecoration:w.isDecoration});this.applyProperties(w);this.attached=w.attached??!0}destroy(){this._laserline.destroy();super.destroy()}createObject3DResourceFactory(w){return{view:w,createResources:C=>this._createObject3DResources(C),destroyResources:C=>this._destroyExternalResources(C),recreateGeometry:(C,F)=>{C.geometries.length=
0;this._recreateGeometry(F,C.material,C.geometries)}}}createDrapedResourceFactory(w){return{view:w,createResources:()=>this._createDrapedResources(),destroyResources:C=>this._destroyExternalResources(C),recreateGeometry:C=>{C.geometries=this._createRenderGeometriesDraped(C.material);this._attachmentOriginChanged()}}}get _laserlineAttached(){return this.attached&&this.visible&&null!=this._laserlineStyle&&!this.isDraped&&this.laserlineEnabled}onAttachedChange(w){this._laserline.attached=this._laserlineAttached;
w&&this._attachmentOriginChanged()}get geometry(){return this._geometry}set geometry(w){this._geometry=w;this.recreateGeometry()}get width(){return this._width}set width(w){w!==this._width&&(this._width=w,this._updateMaterial())}get color(){return this._color}set color(w){d.exactEquals(w,this._color)||(d.copy(this._color,w),this._updateMaterial())}get innerWidth(){return this._innerWidth}set innerWidth(w){w!==this._innerWidth&&(this._innerWidth=w,this._updateMaterial())}get innerColor(){return this._innerColor}set innerColor(w){d.exactEquals(w,
this._innerColor)||(d.copy(this._innerColor,w),this._updateMaterial())}get stipplePattern(){return this._stipplePattern}set stipplePattern(w){const C=null!=w!==(null!=this._stipplePattern);this._stipplePattern=w;C?this.recreate():this._updateMaterial()}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(w){w&&this._stippleOffColor&&d.exactEquals(w,this._stippleOffColor)||(this._stippleOffColor=w?k.clone(w):null,this._updateMaterial())}get falloff(){return this._falloff}set falloff(w){w!==
this._falloff&&(this._falloff=w,this._updateMaterial())}get elevationInfo(){return this._elevationInfo}set elevationInfo(w){this._elevationInfo=w;this.recreateGeometry()}get laserlineStyle(){return this._laserlineStyle}set laserlineStyle(w){this._laserlineStyle=w;this._laserline.attached=this._laserlineAttached;null!=w&&(this._laserline.style=w)}get laserlineEnabled(){return this._laserlineEnabled}set laserlineEnabled(w){this._laserlineEnabled!==w&&(this._laserlineEnabled=w,this._laserline.attached=
this._laserlineAttached)}get renderOccluded(){return this._renderOccluded}set renderOccluded(w){w!==this._renderOccluded&&(this._renderOccluded=w,this._updateMaterial())}get attachmentOrigin(){if(!this._attachmentOriginDirty)return this._attachmentOrigin;const w=this.object3dResources.resources?.geometries;if(!w||0===w.length)return null;l.set(p,0,0,0);let C=0;for(const F of w)F.computeAttachmentOrigin(I)&&(l.add(p,p,I),C++);if(0===C)return null;l.scale(p,p,1/C);this.view.renderCoordsHelper.fromRenderCoords(p,
this._attachmentOrigin);this._attachmentOriginDirty=!1;return this._attachmentOrigin}_updateMaterial(){null!=this.object3dResources.resources&&this.object3dResources.resources.material.setParameters(this._materialParameters);null!=this.drapedResources.resources&&this.drapedResources.resources.material.setParameters(this._materialParameters)}get _isClosed(){return null!=this.geometry&&"polygon"===this.geometry.type}get _materialParameters(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,
stipplePattern:this._stipplePattern,stipplePreferContinuous:!1,isClosed:this._isClosed,falloff:this._falloff,innerColor:this._innerColor,innerWidth:this._innerWidth,join:"round",hasPolygonOffset:!0,renderOccluded:this._normalizedRenderOccluded,isDecoration:this.isDecoration}}get _normalizedRenderOccluded(){return this.isDraped&&this._renderOccluded===q.RenderOccludedFlag.OccludeAndTransparentStencil?q.RenderOccludedFlag.OccludeAndTransparent:this._renderOccluded}_recreateGeometry(w,C,F){this._createRenderGeometries(C,
F);for(const G of F)w.addGeometry(G);this._attachmentOriginChanged()}_attachmentOriginChanged(){this._attachmentOriginDirty=!0;this.events.emit("attachment-origin-changed")}_destroyExternalResources(w){w.geometries=[]}_createObject3DResources(w){const C=new D.RibbonLineMaterial(this._materialParameters),F=[];this._recreateGeometry(w,C,F);return{material:C,geometries:F,forEach:G=>{G(C);F.forEach(G)}}}_createDrapedResources(){const w=new D.RibbonLineMaterial(this._materialParameters),C=this._createRenderGeometriesDraped(w);
return{material:w,geometries:C}}_createRenderGeometriesDraped(w){const {geometry:C,view:F}=this,G=F.basemapTerrain.spatialReference;return null==C||null==G?[]:h.geometryToRenderInfoDraped(C,G).lines.map(({position:J})=>new z.RenderGeometry(n.createGeometry(w,{overlayInfo:{spatialReference:G,renderCoordsHelper:F.renderCoordsHelper},attributeData:{position:J},removeDuplicateStartEnd:this._isClosed})))}calculateMapBounds(w){if(null==this.object3dResources.resources)return!1;const C=this.view.renderCoordsHelper;
for(const F of this.object3dResources.resources.geometries){const G=F.attributes.get(r.VertexAttribute.POSITION),J=f.newDoubleArray(G.data.length);t.projectBuffer(G.data,C.spatialReference,0,J,this.view.spatialReference,0,G.data.length/3);u.expandWithBuffer(w,J)}return!0}_createRenderGeometries(w,C){var F=this.geometry;if(null!=F){F=h.geometryToRenderInfo(F,this.view.elevationProvider,this.view.renderCoordsHelper,m.ElevationContext.fromElevationInfo(this.elevationInfo??new A({mode:B.getGeometryEffectiveElevationMode(F,
null)})));var G=[];for(const {position:J,mapPositions:L}of F.lines)C.push(n.createGeometry(w,{mapPositions:L,attributeData:{position:J},removeDuplicateStartEnd:this._isClosed})),G.push(J);this._laserline.pathVerticalPlane=G}}}const I=e.create(),p=e.create();a.OutlineVisualElement=v;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/visualElements/VerticesVisualElement":function(){define("exports ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../chunks/vec4 ../../../../chunks/vec4f64 ./Object3DVisualElement ../../layers/graphics/ElevationContext ../../support/renderInfoUtils/point ../../webgl-engine/lib/basicInterfaces ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/Material ../../webgl-engine/materials/ShadedColorMaterial".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A){class b extends k.Object3DVisualElement{constructor(m){super(m);this.view=null;this._renderOccluded=B.RenderOccludedFlag.OccludeAndTransparent;this._spatialReference=this._vertices=null;this._color=d.fromArray([1,127/255,0,1]);this._size=11;this._outlineColor=d.fromArray([0,0,0,.5]);this._outlineSize=1;this._elevationInfo=null;this.applyProperties(m)}get renderOccluded(){return this._renderOccluded}set renderOccluded(m){m!==this._renderOccluded&&(this._renderOccluded=
m,this._updateMaterial(),this._updateOutlineMaterial())}get vertices(){return this._vertices}set vertices(m){this._vertices=m;this.recreateGeometry()}get spatialReference(){return this._spatialReference}set spatialReference(m){this._spatialReference=m;this.recreateGeometry()}get color(){return this._color}set color(m){e.exactEquals(m,this._color)||(e.copy(this._color,m),this._updateMaterial())}get size(){return this._size}set size(m){m!==this._size&&(this._size=m,this._updateMaterial())}get outlineColor(){return this._outlineColor}set outlineColor(m){e.exactEquals(m,
this._outlineColor)||(e.copy(this._outlineColor,m),this._updateOutlineMaterial())}get outlineSize(){return this._outlineSize}set outlineSize(m){m!==this._outlineSize&&(this._outlineSize=m,this._updateOutlineMaterial())}get elevationInfo(){return this._elevationInfo}set elevationInfo(m){this._elevationInfo=m;this.recreateGeometry()}get _vertexMaterialParameters(){return{color:this._color,screenSizeScale:this.size,renderOccluded:this._renderOccluded,isDecoration:this.isDecoration}}get _vertexOutlineMaterialParameters(){return{color:this._outlineColor,
screenSizeScale:this.size+2*this.outlineSize,renderOccluded:this._renderOccluded,isDecoration:this.isDecoration}}_updateMaterial(){this.attached&&this._vertexMaterial.setParameters(this._vertexMaterialParameters)}_updateOutlineMaterial(){this.attached&&this._vertexOutlineMaterial.setParameters(this._vertexOutlineMaterialParameters)}_createRenderGeometries(){var m=this.vertices;if(null==m||0===m.length)return[];var n=u.geometryToRenderInfo(m,this.spatialReference,this.view.elevationProvider,this.view.renderCoordsHelper,
t.ElevationContext.fromElevationInfo(this.elevationInfo));m=[];const h=n.numVertices;n=n.position;for(let z=0;z<h;++z){var q=c.set(g,n[3*z],n[3*z+1],n[3*z+2]);const r=y.createSphereGeometry(this._vertexMaterial,.5,16,16,{offset:q});q=y.createSphereGeometry(this._vertexOutlineMaterial,.5,16,16,{offset:q});m.push({vertexGeometry:r,vertexOutlineGeometry:q})}return m}createGeometries(m){const n=this._createRenderGeometries();for(const {vertexGeometry:h,vertexOutlineGeometry:q}of n)m.addGeometry(h),m.addGeometry(q)}createExternalResources(){this._vertexMaterial=
new A.ShadedColorMaterial({...this._vertexMaterialParameters,writeDepth:!0,cullFace:f.CullFaceOptions.Back,screenSizeEnabled:!0});this._vertexOutlineMaterial=new A.ShadedColorMaterial({...this._vertexOutlineMaterialParameters,forceTransparentMode:!0,writeDepth:!0,cullFace:f.CullFaceOptions.Front,screenSizeEnabled:!0,shadingEnabled:!1})}destroyExternalResources(){this._vertexOutlineMaterial=this._vertexMaterial=null}forEachExternalMaterial(m){m(this._vertexMaterial);m(this._vertexOutlineMaterial)}}
const g=l.create();a.VerticesVisualElement=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/support/renderInfoUtils/point":function(){define(["exports","../../../../geometry/support/DoubleArray","../../layers/graphics/elevationAlignmentUtils"],function(a,c,l){a.geometryToRenderInfo=function(e,d,k,t,u){const f=c.newDoubleArray(3*e.length),y=c.newDoubleArray(f.length);e.forEach((B,A)=>{f[3*A]=B[0];f[3*A+1]=B[1];f[3*A+2]=2<B.length?B[2]:0});d=l.applyPerVertexElevationAlignment(f,
d,0,y,0,f,0,f.length/3,k,t,u);return{numVertices:e.length,position:f,mapPositions:y,projectionSuccess:null!=d,sampledElevation:d}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/webgl-engine/materials/ShadedColorMaterial":function(){define("exports ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../chunks/vec4f64 ../../../../geometry/support/aaBoundingBox ../../../../geometry/support/buffer/BufferView ../../support/buffer/InterleavedLayout ../core/shaderLibrary/ShaderOutput ../lib/basicInterfaces ../lib/GLMaterial ../lib/Material ../lib/RenderSlot ../lib/Util ../lib/VertexAttribute ./internal/bufferWriterUtils ./internal/MaterialUtil ../shaders/ShadedColorMaterialTechnique".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m,n,h){class q extends B.Material{constructor(p){super(p,new r);this.supportsEdges=!0;this._configuration=new h.ShadedColorMaterialTechniqueConfiguration;this._vertexAttributeLocations=h.vertexAttributeLocations}getConfiguration(p,w){this._configuration.output=p;this._configuration.cullFace=this.parameters.cullFace;this._configuration.hasSlicePlane=this.parameters.hasSlicePlane;this._configuration.transparent=this._isTransparent;this._configuration.writeDepth=
this.parameters.writeDepth;this._configuration.screenSizeEnabled=this.parameters.screenSizeEnabled;this._configuration.shadingEnabled=this.parameters.shadingEnabled;this._configuration.transparencyPassType=w.transparencyPassType;this._configuration.multipassEnabled=w.multipassEnabled;this._configuration.cullAboveGround=w.multipassTerrain.cullAboveGround;return this._configuration}intersect(p,w,C,F,G,J){if(this.parameters.screenSizeEnabled){const L=p.attributes.get(g.VertexAttribute.OFFSET);n.intersectTriangleGeometry(p,
C,F,G,{applyToVertex:(x,H,K,E)=>{E=c.set(v,L.data[3*E],L.data[3*E+1],L.data[3*E+2]);x=c.set(I,x,H,K);c.scale(E,E,this.parameters.screenSizeScale*C.camera.computeScreenPixelSizeAt(E));c.add(x,x,E);return[x[0],x[1],x[2]]},applyToAabb:x=>{const H=d.center(x,v);return d.scale(x,this.parameters.screenSizeScale*C.camera.computeScreenPixelSizeAt(H))}},J)}else n.intersectTriangleGeometry(p,C,F,G,void 0,J)}produces(p,w){return w===u.ShaderOutput.Highlight?p===A.RenderSlot.OPAQUE_MATERIAL:w===u.ShaderOutput.Color||
w===u.ShaderOutput.Alpha||w===u.ShaderOutput.ObjectAndLayerIdColor?(w=A.RenderSlot.OPAQUE_MATERIAL,this._isTransparent&&(w=this.parameters.writeDepth?A.RenderSlot.TRANSPARENT_MATERIAL:A.RenderSlot.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL),p===w||p===A.RenderSlot.DRAPED_MATERIAL):!1}createGLMaterial(p){return new z(p)}createBufferWriter(){return new D(this.parameters.screenSizeEnabled)}get _isTransparent(){return 1>this.parameters.color[3]||this.parameters.forceTransparentMode}}class z extends y{beginSlot(p){return this.ensureTechnique(h.ShadedColorMaterialTechnique,
p)}}class r extends B.MaterialParameters{constructor(){super(...arguments);this.color=e.fromValues(1,1,1,1);this.shadingTint=e.fromValues(0,0,0,.25);this.shadingDirection=c.normalize(l.create(),[.5,-.5,-.5]);this.screenSizeScale=14;this.forceTransparentMode=!1;this.writeDepth=!0;this.hasSlicePlane=!1;this.cullFace=f.CullFaceOptions.None;this.screenSizeEnabled=!1;this.shadingEnabled=!0}}class D{constructor(p){this.screenSizeEnabled=p;p=t.newLayout().vec3f(g.VertexAttribute.POSITION).vec3f(g.VertexAttribute.NORMAL);
this.screenSizeEnabled&&p.vec3f(g.VertexAttribute.OFFSET);this.vertexBufferLayout=p}elementCount(p){return p.attributes.get(g.VertexAttribute.POSITION).indices.length}write(p,w,C,F,G){m.writeDefaultAttributes(C,this.vertexBufferLayout,p,w,F,G);if(this.screenSizeEnabled)if(C.attributes.has(g.VertexAttribute.OFFSET))if(p=C.attributes.get(g.VertexAttribute.OFFSET),b.assert(3===p.size),F=F.getField(g.VertexAttribute.OFFSET,k.BufferViewVec3f))m.writePosition(p,w,F,G);else throw Error("unable to acquire view for "+
g.VertexAttribute.OFFSET);else throw Error(`${g.VertexAttribute.OFFSET} vertex attribute required for screenSizeEnabled ShadedColorMaterial`);}}const v=l.create(),I=l.create();a.ShadedColorMaterial=q;a.ShadedColorMaterialParameters=r;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/webgl-engine/shaders/ShadedColorMaterialTechnique":function(){define("require exports ../../../../chunks/tslib.es6 ../core/shaderLibrary/ShaderOutput ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../core/shaderTechnique/ShaderTechniqueConfiguration ../lib/basicInterfaces ../lib/OrderIndependentTransparency ../lib/Program ../lib/TransparencyPassType ../lib/VertexAttribute ../materials/DefaultTechniqueConfiguration ../../../../chunks/ShadedColorMaterial.glsl ../../../webgl/enums ../../../webgl/renderState".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m,n){class h extends k.ShaderTechnique{initializeProgram(r){return new y.Program(r.rctx,h.shader.get().build(this.configuration),z)}_setPipelineState(r){const D=this.configuration,v=r===B.TransparencyPassType.NONE,I=r===B.TransparencyPassType.FrontFace;return n.makePipelineState({blending:D.output!==e.ShaderOutput.Color&&D.output!==e.ShaderOutput.Alpha||!D.transparent?null:v?f.blendingDefault:f.oitBlending(r),culling:n.cullingParams(D.cullFace),depthTest:{func:I?
m.CompareFunction.LESS:D.shadingEnabled?m.CompareFunction.LEQUAL:m.CompareFunction.LESS},depthWrite:v?D.writeDepth?n.defaultDepthWriteParams:null:f.oitDepthWrite(r),colorWrite:n.defaultColorWriteParams,polygonOffset:v||I?null:f.OITPolygonOffset})}initializePipeline(){return this._setPipelineState(this.configuration.transparencyPassType)}}h.shader=new d.ReloadableShaderModule(g.ShadedColorMaterialShader,()=>new Promise((r,D)=>a(["./ShadedColorMaterial.glsl"],r,D)));class q extends b.DefaultTechniqueConfiguration{constructor(){super(...arguments);
this.output=e.ShaderOutput.Color;this.cullFace=u.CullFaceOptions.None;this.transparencyPassType=B.TransparencyPassType.NONE;this.transparent=this.hasSlicePlane=!1;this.shadingEnabled=this.screenSizeEnabled=this.writeDepth=!0;this.cullAboveGround=this.multipassEnabled=!1}}l.__decorate([t.parameter({count:e.ShaderOutput.COUNT})],q.prototype,"output",void 0);l.__decorate([t.parameter({count:u.CullFaceOptions.COUNT})],q.prototype,"cullFace",void 0);l.__decorate([t.parameter({count:B.TransparencyPassType.COUNT})],
q.prototype,"transparencyPassType",void 0);l.__decorate([t.parameter()],q.prototype,"hasSlicePlane",void 0);l.__decorate([t.parameter()],q.prototype,"transparent",void 0);l.__decorate([t.parameter()],q.prototype,"writeDepth",void 0);l.__decorate([t.parameter()],q.prototype,"screenSizeEnabled",void 0);l.__decorate([t.parameter()],q.prototype,"shadingEnabled",void 0);l.__decorate([t.parameter()],q.prototype,"multipassEnabled",void 0);l.__decorate([t.parameter()],q.prototype,"cullAboveGround",void 0);
l.__decorate([t.parameter({constValue:!1})],q.prototype,"occlusionPass",void 0);const z=new Map([[A.VertexAttribute.POSITION,0],[A.VertexAttribute.NORMAL,1],[A.VertexAttribute.OFFSET,2]]);c.ShadedColorMaterialTechnique=h;c.ShadedColorMaterialTechniqueConfiguration=q;c.vertexAttributeLocations=z;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/ShadedColorMaterial.glsl":function(){define("exports ./vec4f64 ../views/3d/webgl-engine/core/shaderLibrary/ScreenSizeScaling.glsl ../views/3d/webgl-engine/core/shaderLibrary/ShaderOutput ../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl ../views/3d/webgl-engine/core/shaderLibrary/Transform.glsl ../views/3d/webgl-engine/core/shaderLibrary/shading/MultipassTerrainTest.glsl ../views/3d/webgl-engine/core/shaderLibrary/util/AlphaCutoff ../views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl ../views/3d/webgl-engine/core/shaderLibrary/util/View.glsl ../views/3d/webgl-engine/core/shaderModules/Float3PassUniform ../views/3d/webgl-engine/core/shaderModules/Float4PassUniform ../views/3d/webgl-engine/core/shaderModules/interfaces ../views/3d/webgl-engine/core/shaderModules/ShaderBuilder ../views/3d/webgl-engine/lib/TransparencyPassType ../views/3d/webgl-engine/lib/VertexAttribute".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m,n){function h(z){const r=new g.ShaderBuilder,D=z.multipassEnabled&&(z.output===e.ShaderOutput.Color||z.output===e.ShaderOutput.Alpha);r.include(k.Transform,z);r.include(l.ScreenSizeScaling,z);r.include(d.SliceDraw,z);const {vertex:v,fragment:I}=r;I.include(f.ColorConversion);y.addProjViewLocalOrigin(v,z);I.uniforms.add(new A.Float4PassUniform("uColor",p=>p.color));r.attributes.add(n.VertexAttribute.POSITION,"vec3");r.varyings.add("vWorldPosition","vec3");D&&
r.varyings.add("depth","float");z.screenSizeEnabled&&r.attributes.add(n.VertexAttribute.OFFSET,"vec3");z.shadingEnabled&&(y.addViewNormal(v),r.attributes.add(n.VertexAttribute.NORMAL,"vec3"),r.varyings.add("vViewNormal","vec3"));v.code.add(b.glsl`
    void main(void) {
      vWorldPosition = ${z.screenSizeEnabled?"screenSizeScaling(offset, position)":"position"};
  `);z.shadingEnabled&&v.code.add(b.glsl`vec3 worldNormal = normal;
vViewNormal = (viewNormal * vec4(worldNormal, 1)).xyz;`);v.code.add(b.glsl`
    ${D?"depth \x3d (view * vec4(vWorldPosition, 1.0)).z;":""}
    gl_Position = transformPosition(proj, view, vWorldPosition);
  }
  `);D&&r.include(t.multipassTerrainTest,z);I.code.add(b.glsl`
    void main() {
      discardBySlice(vWorldPosition);
      ${D?"terrainDepthTest(depth);":""}
    `);z.shadingEnabled?(I.uniforms.add(new B.Float3PassUniform("shadingDirection",p=>p.shadingDirection)),I.uniforms.add(new A.Float4PassUniform("shadedColor",p=>{{var w=p.shadingTint;p=p.color;const C=1-w[3],F=w[3]+p[3]*C;0===F?q[3]=F:(q[0]=(w[0]*w[3]+p[0]*p[3]*C)/F,q[1]=(w[1]*w[3]+p[1]*p[3]*C)/F,q[2]=(w[2]*w[3]+p[2]*p[3]*C)/F,q[3]=p[3]);w=q}return w})),I.code.add(b.glsl`vec3 viewNormalNorm = normalize(vViewNormal);
float shadingFactor = 1.0 - clamp(-dot(viewNormalNorm, shadingDirection), 0.0, 1.0);
vec4 finalColor = mix(uColor, shadedColor, shadingFactor);`)):I.code.add(b.glsl`vec4 finalColor = uColor;`);I.code.add(b.glsl`
      ${z.output===e.ShaderOutput.ObjectAndLayerIdColor?b.glsl`finalColor.a = 1.0;`:""}
      if (finalColor.a < ${b.glsl.float(u.symbolAlphaCutoff)}) {
        discard;
      }
      ${z.output===e.ShaderOutput.Alpha?b.glsl`fragColor = vec4(finalColor.a);`:""}

      ${z.output===e.ShaderOutput.Color?b.glsl`fragColor = highlightSlice(finalColor, vWorldPosition); ${z.transparencyPassType===m.TransparencyPassType.Color?"fragColor \x3d premultiplyAlpha(fragColor);":""}`:""}
    }
    `);return r}const q=c.create();c=Object.freeze(Object.defineProperty({__proto__:null,build:h},Symbol.toStringTag,{value:"Module"}));a.ShadedColorMaterialShader=c;a.build=h})},"esri/views/3d/webgl-engine/core/shaderLibrary/ScreenSizeScaling.glsl":function(){define(["exports","./util/View.glsl","../shaderModules/FloatPassUniform","../shaderModules/interfaces"],function(a,c,l,e){a.ScreenSizeScaling=function(d,k){k.screenSizeEnabled&&(d=d.vertex,c.addCameraPosition(d,k),d.uniforms.add(new l.FloatPassUniform("perScreenPixelRatio",
(t,u)=>u.camera.perScreenPixelRatio),new l.FloatPassUniform("screenSizeScale",t=>t.screenSizeScale)),d.code.add(e.glsl`float computeRenderPixelSizeAt( vec3 pWorld ){
vec3 viewForward = - vec3(view[0][2], view[1][2], view[2][2]);
float viewDirectionDistance = abs(dot(viewForward, pWorld - cameraPosition));
return viewDirectionDistance * perScreenPixelRatio;
}
vec3 screenSizeScaling(vec3 position, vec3 anchor){
return position * screenSizeScale * computeRenderPixelSizeAt(anchor) + anchor;
}`))};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/layers/graphics/GraphicState":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Evented ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/decorators/subclass".split(" "),function(a,c,l,e,d,k,t,u){a.GraphicState=class extends l.EventedAccessor{constructor(f){super(f);
this.isDraped=this.displaying=this.tracking=!1}};c.__decorate([e.property({constructOnly:!0})],a.GraphicState.prototype,"graphic",void 0);c.__decorate([e.property()],a.GraphicState.prototype,"tracking",void 0);c.__decorate([e.property()],a.GraphicState.prototype,"displaying",void 0);c.__decorate([e.property()],a.GraphicState.prototype,"isDraped",void 0);a.GraphicState=c.__decorate([u.subclass("esri.views.3d.layers.graphics.GraphicState")],a.GraphicState);Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/views/draw/DrawGraphicTool":function(){define("exports ../../chunks/tslib.es6 ../../Graphic ../../core/Evented ../../core/handleUtils ../../core/maybe ../../core/memoize ../../core/quantityUtils ../../core/reactiveUtils ../../core/unitUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../layers/GraphicsLayer ../../support/elevationInfoUtils ./support/createUtils ./support/helpMessageUtils ./support/surfaceCoordinateSystems ../interactive/InteractiveToolBase ../interactive/keybindings ../interactive/sketch/SketchLabelOptions ../interactive/sketch/SketchTooltipOptions ../interactive/tooltip/constraintUtils ../interactive/tooltip/DrawTooltipInfos ../interactive/tooltip/Tooltip ../support/angularMeasurementUtils ../support/automaticAreaMeasurementUtils ../support/automaticLengthMeasurementUtils ../../core/accessorSupport/trackingUtils".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m,n,h,q,z,r,D,v,I,p,w,C,F,G,J,L,x){class H{constructor(){this.rectangle=this.circle=this.outline=this.full=this.activeVertex=this.regularVertices=null}}a.DrawGraphicTool=class extends e.EventedMixin(D.InteractiveToolBase){constructor(E){super(E);this._createOperationGeometry=this._graphic=null;this.defaultZ=0;this.geometryType=null;this.hasZ=!0;this.labelOptions=new I;this.snappingManager=this.mode=this.geometryToPlace=null;this.snapToScene=!1;this.tooltip=null;
this.tooltipOptions=new p;this._getPointConstraint=t.memoize(M=>M);this._getPolylineOrPolygonConstraint=t.memoize((M,O,T)=>w.intersectAll([M,O,T]));this._getDistanceConstraint=t.memoize(w.getDistanceConstraint);this._getOrientationConstraint=t.memoize(w.getOrientationConstraint);this._getElevationConstraint=t.memoize(w.getElevationConstraint)}initialize(){this.internalGraphicsLayer=new n({listMode:"hide",internal:!0});this.view.map.layers.add(this.internalGraphicsLayer);this.drawOperation=this.makeDrawOperation();
const E=this.tooltipOptions,M=this.view.type;this.tooltipInfos={point:new C.DrawPointTooltipInfo({tooltipOptions:E,viewType:M}),polyline:new C.DrawPolylineTooltipInfo({tooltipOptions:E,viewType:M}),polygon:new C.DrawPolygonTooltipInfo({tooltipOptions:E,viewType:M}),mesh:new C.DrawMeshTooltipInfo({tooltipOptions:E,viewType:M}),rectangle:new C.DrawRectangleTooltipInfo({tooltipOptions:E}),circle:new C.DrawCircleTooltipInfo({tooltipOptions:E})};this.addHandles([this.drawOperation.on("vertex-add",O=>this.onVertexAdd(O)),
this.drawOperation.on("vertex-remove",O=>this.onVertexRemove(O)),this.drawOperation.on("vertex-update",O=>this.onVertexUpdate(O)),this.drawOperation.on("cursor-update",O=>this.onCursorUpdate(O)),this.drawOperation.on("complete",O=>this.onComplete(O)),f.watch(()=>this.cursor,O=>{this.drawOperation.cursor=O},f.syncAndInitial),f.watch(()=>this.tooltipOptions.enabled,O=>{this.tooltip=O?new F.Tooltip({view:this.view,info:this._tooltipInfo}):k.destroyMaybe(this.tooltip)},f.syncAndInitial),x.autorun(()=>
this._updateTooltipInfo())]);this.finishToolCreation()}destroy(){this.drawOperation=k.destroyMaybe(this.drawOperation);this.tooltip=k.destroyMaybe(this.tooltip);this._destroyAllVisualisations();this.view.map.remove(this.internalGraphicsLayer);this.internalGraphicsLayer=k.destroyMaybe(this.internalGraphicsLayer);this._set("view",null)}get _defaultElevation(){return u.createLength(this.defaultZ,"meters")}get canRedo(){return this.drawOperation.canRedo}get canUndo(){return this.drawOperation.canUndo}set centered(E){this._set("centered",
E);this._updateGraphic()}get cursor(){return this._get("cursor")}set cursor(E){this._set("cursor",E)}set enabled(E){this.drawOperation.interactive=E;this._set("enabled",E)}set forceUniformSize(E){this._set("forceUniformSize",E);this._updateGraphic()}get graphic(){return this._graphic}set graphicSymbol(E){this._set("graphicSymbol",E);null!=this._graphic&&(this._graphic.symbol=E)}get updating(){return this.drawOperation?.updating??!1}completeCreateOperation(){this.drawOperation.complete()}onInputEvent(E){const M=
this._tooltipInfo;if("key-down"===E.type&&E.key===v.tooltipKeys.enterInputMode&&null!=M&&0<M.editableFields.length&&this.tooltipOptions.inputEnabled)M.enterInputMode(),E.stopPropagation();else this.drawOperation.onInputEvent(E)}redo(){this.drawOperation.redo()}reset(){}undo(){this.drawOperation.undo()}_destroyAllVisualisations(){this.removeHandles(K.outline);this.removeHandles(K.regularVertices);this.removeHandles(K.activeVertex);this.removeHandles("create-operation-graphic")}_createOrUpdateGraphic(E){if(null!=
this._graphic)return this.updateGraphicGeometry(this._graphic,E),this._graphic;const M=this._graphic=new l({...this.graphicProperties,symbol:this.graphicSymbol});this.updateGraphicGeometry(M,E);this.internalGraphicsLayer.add(M);this.addHandles(this.initializeGraphic(M));this.notifyChange("graphic");this.addHandles(d.makeHandle(()=>{this.internalGraphicsLayer.remove(M);k.destroyMaybe(M);this._graphic===M&&(this._graphic=null)}),"create-operation-graphic");return M}updateGraphicGeometry(E,M){E.geometry=
M}_getCreateOperationGeometry(E={operationComplete:!1}){var {drawOperation:M}=this;if(null==M||0===M.numVertices)return null;const {coordinateHelper:O,view:T}=M;var U=M.stagedVertex,ba=M.committedVertices;M=ba.slice();var la=null!=U;la&&M.push(O.pointToArray(U));var fa=la?O.pointToArray(U):ba.splice(-1)[0];U=M.length;la=T.spatialReference;const P="3d"===T.type&&"global"===T.viewingMode,X=new H;switch(this.geometryType){case "point":case "mesh":X.regularVertices=ba;X.activeVertex=fa;X.full=O.arrayToPoint(M[0]);
break;case "multipoint":X.regularVertices=ba;X.activeVertex=fa;0<U&&(X.full=q.createMultipoint(M,la));break;case "polyline":X.regularVertices=ba;X.activeVertex=fa;0<U&&(X.full=q.createPolyline([M],la,P));break;case "polygon":X.regularVertices=ba;X.activeVertex=fa;0<U&&(X.full=q.createPolygon([M],la,P,!0));break;case "circle":0<U&&(ba=r.createViewAlignedCoordinateSystem(T,M[0]),1===U&&E.operationComplete?(E=M[0],fa=ba.makeMapPoint(E[0]+48*T.resolution,E[1]),X.circle=q.createCircle([E,fa],ba,!0),X.full=
null!=X.circle?X.circle.geometry:null):2===U&&(this.forceUniformSize?(X.circle=q.createCircle(M,ba,this.centered),X.full=null!=X.circle?X.circle.geometry:null):(X.rectangle=q.createEllipse(M,ba,this.centered),X.full=X.rectangle.geometry)));break;case "rectangle":0<U&&(ba=r.createViewAlignedCoordinateSystem(T,M[0]),1===U&&E.operationComplete?(E=M[0],fa=ba.makeMapPoint(E[0]+48*T.resolution,E[1]),X.rectangle=q.createSquare([E,fa],ba,!0),X.full=X.rectangle.geometry):2===U&&(X.rectangle=this.forceUniformSize?
q.createSquare(M,ba,this.centered):q.createRectangle(M,ba,this.centered),X.full=X.rectangle.geometry));break;default:return null}switch(this.geometryType){case "polyline":X.outline=1<U?q.createPolyline([M],la,P):null;break;case "polygon":X.outline=1<U?q.createPolygon([M],la,P):null;break;case "circle":case "rectangle":X.outline="polygon"===X.full?.type?q.createPolygon(X.full.rings,la,P):null}return X}initializeGraphic(E){return d.makeHandle()}onComplete(E){this._updateGraphic();let M=null;if(this.drawOperation.isCompleted){const O=
this._getCreateOperationGeometry({operationComplete:!0});null!=O&&(M=this._createOrUpdateGraphic(O.full).clone())}this._createOperationGeometry=null;this.emit("complete",{graphic:M,...E})}onCursorUpdate(E){this._updateGraphic();this.emit("cursor-update",E)}onDeactivate(){this.drawOperation.isCompleted||this.drawOperation.cancel()}onVertexAdd(E){this._updateGraphic();this._clearConstraints();this.emit("vertex-add",E)}onVertexRemove(E){this._updateGraphic();this._clearConstraints();this.emit("vertex-remove",
E)}onVertexUpdate(E){this._updateGraphic();this.emit("vertex-update",E)}_updateGraphic(){const E=this._getCreateOperationGeometry();this._createOperationGeometry=E;null==E?this._destroyAllVisualisations():(null!=E.outline?this.addHandles(this.onOutlineChanged(E.outline),K.outline):this.removeHandles(K.outline),null!=E.regularVertices?this.addHandles(this.onRegularVerticesChanged(E.regularVertices),K.regularVertices):this.removeHandles(K.regularVertices),null!=E.activeVertex?this.addHandles(this.onActiveVertexChanged(E.activeVertex),
K.activeVertex):this.removeHandles(K.activeVertex),null!=E.full?this._createOrUpdateGraphic(E.full):this.removeHandles("create-operation-graphic"))}get _tooltipInfo(){const {drawOperation:E,graphic:M,view:O}=this;if(!E)return null;const T=this.tooltipInfos,U=M?.geometry?.type;switch(this.geometryType){case "point":return"2d"===O.type&&0===this.defaultZ?null:"point"===U?T.point:null;case "polyline":return"polyline"===U?T.polyline:null;case "polygon":return"polygon"===U?T.polygon:null;case "rectangle":return"polygon"===
U?T.rectangle:null;case "circle":return"polygon"===U?T.circle:null;case "mesh":return"mesh"===U?T.mesh:null;default:return null}}_updateTooltipInfo(){const {_tooltipInfo:E,tooltip:M}=this;if(E&&M){switch(E.type){case "draw-point":this._updateDrawPointTooltipInfo(E);break;case "draw-polyline":this._updateDrawPolylineTooltipInfo(E);break;case "draw-polygon":this._updateDrawPolygonTooltipInfo(E);break;case "draw-rectangle":this._updateDrawRectangleTooltipInfo(E);break;case "draw-circle":this._updateDrawCircleTooltipInfo(E);
break;case "draw-mesh":this.updateDrawMeshTooltipInfo(E)}M.info=E}}_updateDrawPointTooltipInfo(E){const {drawOperation:M,graphic:O,view:T,tooltipOptions:U}=this,{elevationInfo:ba,stagedVertex:la}=M;E.tooltipOptions=U;E.viewType=T.type;E.helpMessage=z.getDrawHelpMessage("point",O?.geometry);this.updateElevation(E.elevation);M.constraint=la?this._getPointConstraint(this._getElevationConstraint(E.elevation.committed,M.coordinateHelper.spatialReference,T,ba)):void 0}_updateDrawPolylineTooltipInfo(E){var M=
this._createOperationGeometry;M=null!=M?M.full:null;if("polyline"===M?.type){var {drawOperation:O,tooltipOptions:T,view:U}=this,{lastVertex:ba,stagedVertex:la}=O;this._updatePolylineOrPolygonCommon(E,la);var fa=L.autoLengthByElevationMode(M,this._elevationMode);E.totalLength.actual=fa??u.zeroMeters;E.totalLength.hidden=null==length||!ba;E.tooltipOptions=T;E.viewType=U.type;E.helpMessage=z.getDrawHelpMessage("polyline",M);this.updateElevation(E.elevation)}}_updateDrawPolygonTooltipInfo(E){var M=this._createOperationGeometry;
M=null!=M?M.full:null;if("polygon"===M?.type){var {drawOperation:O,tooltipOptions:T,view:U}=this,{lastVertex:ba}=O,la=O.stagedVertex;"polygon"===M?.type&&ba&&!la&&(la=M.getPoint(0,M.rings[0].length-1));this._updatePolylineOrPolygonCommon(E,la);la=J.autoAreaByElevationMode(M,this._elevationMode);E.area.actual=la??u.zeroSquareMeters;E.area.hidden=null==la&&!ba;E.tooltipOptions=T;E.viewType=U.type;E.helpMessage=z.getDrawHelpMessage("polygon",M);this.updateElevation(E.elevation)}}_updatePolylineOrPolygonCommon(E,
M){const {view:O,drawOperation:T}=this,{elevationInfo:U,lastVertex:ba}=T;if(ba&&M){var la=L.autoDirectDistanceByElevationModeBetweenPoints(ba,M,this._elevationMode);E.distance.actual=la??u.zeroMeters;E.distance.hidden=!1;M=G.orientationBetweenPoints(ba,M);E.orientation.actual=M??u.zeroDegrees;E.orientation.hidden=!1;M=T.coordinateHelper.spatialReference;T.constraint=this._getPolylineOrPolygonConstraint(this._getDistanceConstraint(ba,E.distance.committed,O,U),this._getOrientationConstraint(ba,E.orientation.committed,
O,U),this._getElevationConstraint(E.elevation.committed,M,O,U))}else E.distance.hidden=!0,E.orientation.hidden=!0,T.constraint=void 0}updateDrawMeshTooltipInfo(E){}_updateDrawRectangleTooltipInfo(E){E.tooltipOptions=this.tooltipOptions;E.xSize=this._xSize??u.zeroMeters;E.ySize=this._ySize??u.zeroMeters;E.area=this._fullGeometryArea??u.zeroSquareMeters}_updateDrawCircleTooltipInfo(E){const {forceUniformSize:M}=this;E.tooltipOptions=this.tooltipOptions;E.radius=M?this._circleRadius??u.zeroMeters:null;
E.xSize=M?null:this._xSize??u.zeroMeters;E.ySize=M?null:this._ySize??u.zeroMeters;E.area=this._fullGeometryArea??u.zeroSquareMeters}get _circleRadius(){const E=this._createOperationGeometry;return null!=E?.circle?.center&&null!=E.circle.edge?L.autoHorizontalDistanceByElevationModeBetweenPoints(E.circle.center,E.circle.edge,this._elevationMode):null}get _xSize(){const E=this._createOperationGeometry?.rectangle?.midpoints;return null!=E?L.autoHorizontalDistanceByElevationModeBetweenPoints(E.left,E.right,
this._elevationMode):null}get _ySize(){const E=this._createOperationGeometry?.rectangle?.midpoints;return null!=E?L.autoHorizontalDistanceByElevationModeBetweenPoints(E.top,E.bottom,this._elevationMode):null}get _fullGeometryArea(){const E=this._createOperationGeometry?.full;return"polygon"!==E?.type?null:J.autoAreaByElevationMode(E,this._elevationMode)}updateElevation(E){E.actual=this._vertexTooltipElevation}get _vertexTooltipElevation(){const {tooltipOptions:E,view:M,drawOperation:O}=this;if(null==
O)return this._defaultElevation;var T=O.stagedVertex??O.lastVertex;if(null==T||"2d"===M.type)return this._defaultElevation;T=(h.getConvertedElevation(M,T,O.elevationInfo,{mode:E.elevation.mode,offset:0})??0)*y.getMetersPerVerticalUnitForSR(T.spatialReference);return u.createLength(T,"meters")}get _elevationMode(){return this.drawOperation.isDraped?"on-the-ground":"absolute-height"}_clearConstraints(){for(const [,E]of Object.entries(this.tooltipInfos))E.unlockAllFields()}};c.__decorate([B.property()],
a.DrawGraphicTool.prototype,"_createOperationGeometry",void 0);c.__decorate([B.property()],a.DrawGraphicTool.prototype,"_defaultElevation",null);c.__decorate([B.property({value:!0})],a.DrawGraphicTool.prototype,"centered",null);c.__decorate([B.property()],a.DrawGraphicTool.prototype,"cursor",null);c.__decorate([B.property({nonNullable:!0})],a.DrawGraphicTool.prototype,"defaultZ",void 0);c.__decorate([B.property()],a.DrawGraphicTool.prototype,"drawOperation",void 0);c.__decorate([B.property({value:!0})],
a.DrawGraphicTool.prototype,"enabled",null);c.__decorate([B.property({value:!0})],a.DrawGraphicTool.prototype,"forceUniformSize",null);c.__decorate([B.property({constructOnly:!0})],a.DrawGraphicTool.prototype,"geometryType",void 0);c.__decorate([B.property()],a.DrawGraphicTool.prototype,"graphic",null);c.__decorate([B.property({constructOnly:!0})],a.DrawGraphicTool.prototype,"graphicProperties",void 0);c.__decorate([B.property()],a.DrawGraphicTool.prototype,"graphicSymbol",null);c.__decorate([B.property({constructOnly:!0})],
a.DrawGraphicTool.prototype,"hasZ",void 0);c.__decorate([B.property({constructOnly:!0,type:I})],a.DrawGraphicTool.prototype,"labelOptions",void 0);c.__decorate([B.property({constructOnly:!0})],a.DrawGraphicTool.prototype,"geometryToPlace",void 0);c.__decorate([B.property({constructOnly:!0})],a.DrawGraphicTool.prototype,"mode",void 0);c.__decorate([B.property()],a.DrawGraphicTool.prototype,"snappingManager",void 0);c.__decorate([B.property()],a.DrawGraphicTool.prototype,"snapToScene",void 0);c.__decorate([B.property()],
a.DrawGraphicTool.prototype,"tooltip",void 0);c.__decorate([B.property()],a.DrawGraphicTool.prototype,"tooltipInfos",void 0);c.__decorate([B.property({constructOnly:!0,type:p})],a.DrawGraphicTool.prototype,"tooltipOptions",void 0);c.__decorate([B.property({readOnly:!0})],a.DrawGraphicTool.prototype,"type",void 0);c.__decorate([B.property({readOnly:!0})],a.DrawGraphicTool.prototype,"updating",null);c.__decorate([B.property({constructOnly:!0,nonNullable:!0})],a.DrawGraphicTool.prototype,"view",void 0);
c.__decorate([B.property()],a.DrawGraphicTool.prototype,"_tooltipInfo",null);c.__decorate([B.property()],a.DrawGraphicTool.prototype,"_circleRadius",null);c.__decorate([B.property()],a.DrawGraphicTool.prototype,"_xSize",null);c.__decorate([B.property()],a.DrawGraphicTool.prototype,"_ySize",null);c.__decorate([B.property()],a.DrawGraphicTool.prototype,"_fullGeometryArea",null);c.__decorate([B.property()],a.DrawGraphicTool.prototype,"_vertexTooltipElevation",null);c.__decorate([B.property()],a.DrawGraphicTool.prototype,
"_elevationMode",null);a.DrawGraphicTool=c.__decorate([m.subclass("esri.views.draw.DrawGraphicTool")],a.DrawGraphicTool);const K={outline:"outline-visual",regularVertices:"regular-vertices-visual",activeVertex:"active-vertex-visual"};a.CreateOperationGeometry=H;a.geometryTypeToDrawOperationGeometryType=function(E){switch(E){case "point":case "polyline":case "polygon":case "multipoint":return E;case "circle":case "rectangle":return"segment";case "mesh":return"point"}};Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/core/memoize":function(){define(["exports"],function(a){a.memoize=function(c){let l,e=[],d,k=!1;return function(...t){var u;if(u=k&&l===this)a:if(t.length!==e.length)u=!1;else{for(u=0;u<t.length;++u)if(t[u]!==e[u]){u=!1;break a}u=!0}if(u)return d;d=c.apply(this,t);l=this;e=t;k=!0;return d}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/GraphicsLayer":function(){define("../chunks/tslib.es6 ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ../core/support/OwningCollection ./Layer ./mixins/BlendLayer ./mixins/ScaleRangeLayer ../support/GraphicsCollection ../symbols/support/ElevationInfo".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A){l=class extends f.BlendLayer(y.ScaleRangeLayer(u)){constructor(b){super(b);this.elevationInfo=null;this.graphics=new B.GraphicsCollection;this.screenSizePerspectiveEnabled=!0;this.type="graphics";this.internal=!1}destroy(){this.removeAll();this.graphics.destroy()}add(b){this.graphics.add(b);return this}addMany(b){this.graphics.addMany(b);return this}removeAll(){this.graphics.removeAll();return this}remove(b){this.graphics.remove(b)}removeMany(b){this.graphics.removeMany(b)}on(b,
g){return super.on(b,g)}graphicChanged(b){this.emit("graphic-update",b)}};a.__decorate([c.property({type:A})],l.prototype,"elevationInfo",void 0);a.__decorate([c.property(t.owningCollectionProperty(B.GraphicsCollection,"graphics"))],l.prototype,"graphics",void 0);a.__decorate([c.property({type:["show","hide"]})],l.prototype,"listMode",void 0);a.__decorate([c.property()],l.prototype,"screenSizePerspectiveEnabled",void 0);a.__decorate([c.property({readOnly:!0})],l.prototype,"type",void 0);a.__decorate([c.property({constructOnly:!0})],
l.prototype,"internal",void 0);return l=a.__decorate([k.subclass("esri.layers.GraphicsLayer")],l)})},"esri/views/draw/support/createUtils":function(){define("exports ../../../geometry ../../../core/arrayUtils ../../../core/lang ../../../core/unitUtils ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../geometry/Circle ../../../geometry/geometryEngine ../../../geometry/support/coordsUtils ../../../geometry/support/spatialReferenceUtils ./surfaceCoordinateSystems ../../../geometry/Point ../../../geometry/Multipoint ../../../geometry/Polyline ../../../geometry/Polygon".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m,n){function h(p,w){w=new b({x:p[0],y:p[1],spatialReference:w});2<p.length&&(w.z=p[2]);return w}function q(p,w,C,F=!0){p=e.clone(p);p.forEach(G=>{l.equals(G[0],G[G.length-1])&&1!==G.length||G.push(G[0])});p=new n({rings:p,spatialReference:w});p.rings.forEach(G=>{y.isClockwise(G)||G.reverse()});C&&y.unnormalizeGeometryOnDatelineCrossing(p);F&&p.isSelfIntersecting&&B.isValid(w)&&(p=f.simplify(p));return p}function z(p,w,C){const F=r(w[3],w[2],C),G=r(w[1],w[2],C),
J=r(w[0],w[1],C);w=r(w[0],w[3],C);return{geometry:p,midpoints:null!=F&&null!=G&&null!=J&&null!=w?{top:F,right:G,bottom:J,left:w}:null}}function r(p,w,C){v[0]=p.x;v[1]=p.y;v[2]=0;I[0]=w.x;I[1]=w.y;I[2]=0;k.lerp(v,v,I,.5);D.x=v[0];D.y=I[1];D.z=I[2];p=C.localToMap(D);return null!=p?h(p,C.spatialReference):null}const D=A.makeSurfacePoint(0,0,0),v=t.create(),I=t.create();a.createCircle=function(p,w,C,F){var G=w.mapToLocalMultiple(p),J=p=null;C?(p=G[0],J=G[1]):(p=G[0],C=G[1],J=Math.round(C.x-p.x),C=Math.round(C.y-
p.y),G=Math.max(Math.abs(J),Math.abs(C)),p=A.makeSurfacePoint(0<J?p.x+G/2:p.x-G/2,0<C?p.y+G/2:p.y-G/2),J=A.makeSurfacePoint(Math.abs(J)>Math.abs(C)?p.x-G/2:p.x,Math.abs(J)>Math.abs(C)?p.y:p.y-G/2));C=w.localToMap(p);G=w.localToMap(J);if(null==C||null==G)return null;w.doUnnormalization&&y.unnormalizeVerticesOnDatelineCrossing([[C,G]],w.spatialReference);C=h(C,w.spatialReference);G=h(G,w.spatialReference);const L=d.getMetersPerUnitForSR(w.spatialReference);var x=0;B.isValid(w.spatialReference)?x=L*
f.distance(C,G,null):(x=p.x-J.x,p=p.y-J.y,x=L*Math.sqrt(x*x+p*p)*(F||1));w=new u({center:C,radius:x,radiusUnit:"meters",spatialReference:w.spatialReference});return{geometry:q(w.rings,w.spatialReference,!1),center:C,edge:G}};a.createEllipse=function(p,w,C){function F(O){return A.makeSurfacePoint(x*Math.cos(O)+L.x,H*Math.sin(O)+L.y)}var G=w.mapToLocalMultiple(p);p=G[0];var J=G[1];G=Math.round(J.x-p.x);J=Math.round(J.y-p.y);const L=A.makeSurfacePoint(C?p.x:p.x+G/2,C?p.y:p.y+J/2),x=C?G:G/2,H=C?J:J/2;
C=[];p=2*Math.PI/60;for(G=0;60>G;G++)C.push(F(G*p));C.push(C[0]);const {spatialReference:K,doUnnormalization:E}=w;C=q([C.map(O=>w.localToMap(O)).filter(l.isSome)],K,E,!1);p=w.localToMap(F(Math.PI/2));G=w.localToMap(F(0));J=w.localToMap(F(-Math.PI/2));const M=w.localToMap(F(Math.PI));return{geometry:C,midpoints:null!=p&&null!=G&&null!=J&&null!=M?{top:h(p,K),right:h(G,K),bottom:h(J,K),left:h(M,K)}:null}};a.createMultipoint=function(p,w){return new g({points:p,spatialReference:w})};a.createPoint=h;a.createPolygon=
q;a.createPolyline=function(p,w,C){p=new m({paths:p,spatialReference:w});C&&y.unnormalizeGeometryOnDatelineCrossing(p);return p};a.createRectangle=function(p,w,C){var F=w.mapToLocalMultiple(p);1===F.length&&(p=F[0],F=[A.makeSurfacePoint(p.x-48,p.y+48),A.makeSurfacePoint(p.x+48,p.y-48),A.makeSurfacePoint(p.x+48,p.y-48),A.makeSurfacePoint(p.x-48,p.y+48)]);p=[];var G=F[0].x,J=F[0].y,L=F[1].x;F=F[1].y;if(C){C=Math.round(L-G);const x=Math.round(F-J);p.push(A.makeSurfacePoint(G-C,J-x),A.makeSurfacePoint(L,
J-x),A.makeSurfacePoint(L,F),A.makeSurfacePoint(G-C,F))}else p.push(A.makeSurfacePoint(G,J),A.makeSurfacePoint(L,J),A.makeSurfacePoint(L,F),A.makeSurfacePoint(G,F));C=q([p.map(x=>w.localToMap(x)).filter(l.isSome)],w.spatialReference,w.doUnnormalization,!0);return z(C,p,w)};a.createSquare=function(p,w,C){var F=w.mapToLocalMultiple(p);p=[];var G=F[0].x,J=F[0].y,L=Math.round(F[1].x-G);const x=Math.round(F[1].y-J);F=Math.max(Math.abs(L),Math.abs(x));C?(C=G+F,L=J+F,G-=F,J-=F,p.push(A.makeSurfacePoint(C,
J),A.makeSurfacePoint(G,J),A.makeSurfacePoint(G,L),A.makeSurfacePoint(C,L))):(C=0<L?G+F:G-F,F=0<x?J+F:J-F,p.push(A.makeSurfacePoint(G,J),A.makeSurfacePoint(C,J),A.makeSurfacePoint(C,F),A.makeSurfacePoint(G,F)));J=q([p.map(H=>w.localToMap(H)).filter(l.isSome)],w.spatialReference,w.doUnnormalization,!0);return z(J,p,w)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/Circle":function(){define("../chunks/tslib.es6 ../core/unitUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./ellipsoidUtils ./Point ./Polygon ./support/geodesicUtils ./support/webMercatorUtils ./support/WKIDUnitConversion".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b){var g;e=g=class extends y{constructor(...m){super(...m);this.center=null;this.geodesic=!1;this.numberOfPoints=60;this.radius=1E3;this.radiusUnit="meters"}normalizeCtorArgs(m,n){if(!m?.center){if(m?.rings)return super.normalizeCtorArgs(m,n);m={center:m}}return{...super.normalizeCtorArgs(),...m,...n}}initialize(){var m=this.center;const n=this.numberOfPoints;this.hasZ=m?.hasZ??!1;if(0===this.rings.length&&m){var h=c.convertUnit(this.radius,this.radiusUnit,"meters"),
q=m.spatialReference,z="geographic";if(q.isWebMercator)z="webMercator";else if(null!=(q.wkid&&b[q.wkid])||(q.wkt2||q.wkt)&&c.isProjectedWKT(q.wkt2||q.wkt))z="projected";if(this.geodesic){let r;switch(z){case "webMercator":r=A.webMercatorToGeographic(m);break;case "projected":console.error("Creating a geodesic circle requires the center to be specified in web mercator or geographic coordinate system");break;case "geographic":r=m}m=this._createGeodesicCircle(r,h,n);"webMercator"===z&&(m=A.geographicToWebMercator(m))}else{let r;
"webMercator"===z||"projected"===z?r=h/c.getMetersPerUnit(m.spatialReference):"geographic"===z&&(r=c.lengthToDegrees(h,"meters",u.getReferenceEllipsoid(m.spatialReference).radius));m=this._createPlanarCircle(m,r,n)}this.spatialReference=m.spatialReference;this.addRing(m.rings[0])}}clone(){const {center:m,numberOfPoints:n,radius:h,radiusUnit:q,geodesic:z}=this;return new g({center:m?.clone(),numberOfPoints:n,radius:h,radiusUnit:q,geodesic:z})}_createGeodesicCircle(m,n,h){let q=0;const z=[];for(;360>
q;){const r=[0,0];B.directGeodeticSolver(r,[m.x,m.y],q,n);this.hasZ&&r.push(m.z);z.push(r);q+=360/h}z.push(z[0]);return new y(z)}_createPlanarCircle(m,n,h){const q=[],z=2*Math.PI/h;for(let D=0;D<h;++D){var r=z*D;r=[m.x+Math.cos(-r)*n,m.y+Math.sin(-r)*n];this.hasZ&&r.push(m.z);q.push(r)}q.push(q[0]);return new y({spatialReference:m.spatialReference,rings:[q]})}};a.__decorate([l.property({type:f})],e.prototype,"center",void 0);a.__decorate([l.property()],e.prototype,"geodesic",void 0);a.__decorate([l.property()],
e.prototype,"numberOfPoints",void 0);a.__decorate([l.property()],e.prototype,"radius",void 0);a.__decorate([l.property()],e.prototype,"radiusUnit",void 0);return e=g=a.__decorate([t.subclass("esri.geometry.Circle")],e)})},"esri/views/draw/support/surfaceCoordinateSystems":function(){define("exports ../../../geometry ../../../core/arrayUtils ../../../chunks/mat2d ../../../chunks/mat2df64 ../../../chunks/quat ../../../chunks/quatf64 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../geometry/support/Axis ../../../geometry/Point".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B){function A(h,q,z=null){return null!=z?[h,q,z]:[h,q]}function b(h,q,z=null){return null!=z?{x:h,y:q,z}:{x:h,y:q}}class g{constructor(h){this.spatialReference=h}mapToLocalMultiple(h){return h.map(q=>this.mapToLocal(q)).filter(l.isSome)}get doUnnormalization(){return!1}}class m extends g{constructor(h,q,z=null){super(q);this._defaultZ=z;this.transform=d.create();this.transformInv=d.create();this.transform=d.clone(h);e.invert(this.transformInv,this.transform)}makeMapPoint(h,
q){return A(h,q,this._defaultZ)}mapToLocal(h){return b(this.transform[0]*h[0]+this.transform[2]*h[1]+this.transform[4],this.transform[1]*h[0]+this.transform[3]*h[1]+this.transform[5])}localToMap(h){return A(this.transformInv[0]*h.x+this.transformInv[2]*h.y+this.transformInv[4],this.transformInv[1]*h.x+this.transformInv[3]*h.y+this.transformInv[5],this._defaultZ)}}class n extends g{constructor(h,q){super(h.spatialReference);this.view=h;this.defaultZ=null;this.pWS=f.create();this.tangentFrameUpWS=f.create();
this.tangentFrameRightWS=f.create();this.tangentFrameForwardWS=f.create();this.localFrameRightWS=f.create();this.localFrameUpWS=f.create();this.worldToLocalTransform=t.create();this.localToWorldTransform=t.create();this.scale=1;this.scale=h.resolution;this.referenceMapPoint=q;this.defaultZ=q.hasZ?q.z:null;h=h.state.camera.viewRight;this.view.renderCoordsHelper.toRenderCoords(this.referenceMapPoint,this.pWS);this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,y.Axis.X,this.tangentFrameRightWS);
this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,y.Axis.Y,this.tangentFrameUpWS);this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,y.Axis.Z,this.tangentFrameForwardWS);q=f.create();u.scale(q,this.tangentFrameForwardWS,u.dot(h,this.tangentFrameForwardWS));u.subtract(this.localFrameRightWS,h,q);u.normalize(this.localFrameRightWS,this.localFrameRightWS);u.cross(this.localFrameUpWS,this.tangentFrameForwardWS,this.localFrameRightWS);k.rotationTo(this.worldToLocalTransform,this.localFrameRightWS,
this.tangentFrameRightWS);k.invert(this.localToWorldTransform,this.worldToLocalTransform)}get doUnnormalization(){return"global"===this.view.viewingMode}makeMapPoint(h,q){return A(h,q,this.defaultZ)}mapToLocal(h){const q=f.create();this.view.renderCoordsHelper.toRenderCoords(new B({x:h[0],y:h[1],spatialReference:this.spatialReference}),q);u.transformQuat(q,q,this.worldToLocalTransform);h=this.view.renderCoordsHelper.fromRenderCoords(q,this.view.spatialReference);return null!=h?b(h.x/this.scale,h.y/
this.scale):null}localToMap(h){const q=f.create();this.view.renderCoordsHelper.toRenderCoords(new B({x:h.x*this.scale,y:h.y*this.scale,spatialReference:this.spatialReference}),q);u.transformQuat(q,q,this.localToWorldTransform);h=this.view.renderCoordsHelper.fromRenderCoords(q,this.view.spatialReference);return null!=h?A(h.x,h.y,this.defaultZ):null}}a.AffineCoordinateSystem=m;a.SceneViewCoordinateSystem=n;a.SurfaceCoordinateSystem=g;a.createViewAlignedCoordinateSystem=function(h,q){return"2d"===h.type?
new m(h.state.transform,h.spatialReference,2<q.length?q[2]:null):"3d"===h.type?(q=2<q.length?new B({x:q[0],y:q[1],z:q[2],spatialReference:h.spatialReference}):new B({x:q[0],y:q[1],spatialReference:h.spatialReference}),new n(h,q)):null};a.makeMapPoint=A;a.makeSurfacePoint=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/draw/support/helpMessageUtils":function(){define(["exports"],function(a){a.getDrawHelpMessage=function(c,l){switch(c){case "point":case "multipoint":return"point";
case "polyline":return 2>(null!=l&&"polyline"===l.type&&l.paths.length?l.paths[0].length:0)?"polylineZeroVertices":"polylineOneVertex";case "polygon":return c=null!=l&&"polygon"===l.type&&l.rings.length?l.rings[0].length:0,c=3>c?"polylineZeroVertices":4>c?"polygonOneVertex":"polygonTwoVertices",c}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/InteractiveToolBase":function(){define("exports ../../chunks/tslib.es6 ../../core/Accessor ../../core/Logger ../../core/promiseUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ./interfaces ./ManipulatorCollection".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A){a.InteractiveToolBase=class extends l{constructor(b){super(b);this.manipulators=new A.ManipulatorCollection;this.automaticManipulatorSelection=!0;this.hasHoveredManipulators=this.hasGrabbedManipulators=!1;this.firstGrabbedManipulator=null;this.created=!1;this.removeIncompleteOnCancel=!0;this._editableFlags=new Map([[B.EditableFlag.MANAGER,!0],[B.EditableFlag.USER,!0]]);this._creationFinishedResolver=d.createResolver()}get active(){return null!=this.view&&this.view.activeTool===
this}set visible(b){this._get("visible")!==b&&(this._set("visible",b),this._syncVisible())}get editable(){return this.getEditableFlag(B.EditableFlag.USER)}set editable(b){this.setEditableFlag(B.EditableFlag.USER,b)}get updating(){return!1}get cursor(){return null}get hasFocusedManipulators(){return this.hasGrabbedManipulators||this.hasHoveredManipulators}destroy(){this.manipulators.destroy();this._set("view",null)}onAdd(){this._syncVisible()}activate(){null==this.view?e.getLogger(this).error("Can't activate tool if view is not defined."):
(this.view.focus(),this.onActivate())}deactivate(){this.onDeactivate()}handleInputEvent(b){this.onInputEvent(b)}handleInputEventAfter(b){this.onInputEventAfter(b)}setEditableFlag(b,g){this._editableFlags.set(b,g);this.manipulators.isToolEditable=this.internallyEditable;this._updateManipulatorAttachment();b===B.EditableFlag.USER&&this.notifyChange("editable");this.onEditableChange();this.onManipulatorSelectionChanged()}getEditableFlag(b){return this._editableFlags.get(b)??!1}whenCreated(){return this._creationFinishedResolver.promise}onManipulatorSelectionChanged(){}onActivate(){}onDeactivate(){}onShow(){}onHide(){}onEditableChange(){}onInputEvent(b){}onInputEventAfter(b){}get internallyEditable(){return this.getEditableFlag(B.EditableFlag.USER)&&
this.getEditableFlag(B.EditableFlag.MANAGER)}finishToolCreation(){this.created||this._creationFinishedResolver.resolve(this);this._set("created",!0)}_syncVisible(){this.initialized&&(this.visible?this._show():(this._hide(),this.active&&(this.view.activeTool=null)))}_show(){this._updateManipulatorAttachment();this.onShow()}_hide(){this._updateManipulatorAttachment();this.onHide()}_updateManipulatorAttachment(){this.visible?this.manipulators.attach():this.manipulators.detach()}};c.__decorate([k.property({constructOnly:!0})],
a.InteractiveToolBase.prototype,"view",void 0);c.__decorate([k.property({readOnly:!0})],a.InteractiveToolBase.prototype,"active",null);c.__decorate([k.property({value:!0})],a.InteractiveToolBase.prototype,"visible",null);c.__decorate([k.property({value:!0})],a.InteractiveToolBase.prototype,"editable",null);c.__decorate([k.property({readOnly:!0})],a.InteractiveToolBase.prototype,"manipulators",void 0);c.__decorate([k.property({readOnly:!0})],a.InteractiveToolBase.prototype,"updating",null);c.__decorate([k.property()],
a.InteractiveToolBase.prototype,"cursor",null);c.__decorate([k.property({readOnly:!0})],a.InteractiveToolBase.prototype,"automaticManipulatorSelection",void 0);c.__decorate([k.property()],a.InteractiveToolBase.prototype,"hasFocusedManipulators",null);c.__decorate([k.property()],a.InteractiveToolBase.prototype,"hasGrabbedManipulators",void 0);c.__decorate([k.property()],a.InteractiveToolBase.prototype,"hasHoveredManipulators",void 0);c.__decorate([k.property()],a.InteractiveToolBase.prototype,"firstGrabbedManipulator",
void 0);c.__decorate([k.property({readOnly:!0})],a.InteractiveToolBase.prototype,"created",void 0);c.__decorate([k.property({readOnly:!0})],a.InteractiveToolBase.prototype,"removeIncompleteOnCancel",void 0);a.InteractiveToolBase=c.__decorate([y.subclass("esri.views.interactive.InteractiveToolBase")],a.InteractiveToolBase);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/ManipulatorCollection":function(){define(["exports","../../core/Collection"],function(a,c){a.ManipulatorVisibilityPredicate=
void 0;(function(e){e[e.WhenToolEditable=0]="WhenToolEditable";e[e.WhenToolNotEditable=1]="WhenToolNotEditable";e[e.Always=2]="Always"})(a.ManipulatorVisibilityPredicate||(a.ManipulatorVisibilityPredicate={}));class l{constructor(){this._isToolEditable=!0;this._manipulators=new c;this._resourceContexts={manipulator3D:{}};this._attached=!1}set isToolEditable(e){this._isToolEditable=e}get length(){return this._manipulators.length}add(e,d=a.ManipulatorVisibilityPredicate.WhenToolEditable){this.addMany([e],
d)}addMany(e,d=a.ManipulatorVisibilityPredicate.WhenToolEditable){for(const k of e)e={manipulator:k,visibilityPredicate:d,attached:!1},this._manipulators.add(e),this._attached&&this._updateManipulatorAttachment(e)}remove(e){for(let d=0;d<this._manipulators.length;d++)if(this._manipulators.at(d).manipulator===e){e=this._manipulators.splice(d,1)[0];this._detachManipulator(e);break}}removeAll(){this._manipulators.forEach(e=>{this._detachManipulator(e)});this._manipulators.removeAll()}attach(){this._manipulators.forEach(e=>
{this._updateManipulatorAttachment(e)});this._attached=!0}detach(){this._manipulators.forEach(e=>{this._detachManipulator(e)});this._attached=!1}destroy(){this.detach();this._manipulators.forEach(({manipulator:e})=>e.destroy());this._manipulators.destroy();this._resourceContexts=null}on(e,d){return this._manipulators.on(e,k=>{d(k)})}forEach(e){for(const d of this._manipulators.items)e(d)}some(e){return this._manipulators.items.some(e)}toArray(){const e=[];this.forEach(d=>e.push(d.manipulator));return e}intersect(e,
d){let k=null,t=Number.MAX_VALUE;this._manipulators.forEach(({manipulator:u,attached:f})=>{f&&u.interactive&&(f=u.intersectionDistance(e,d),null!=f&&f<t&&(t=f,k=u))});return k}_updateManipulatorAttachment(e){this._isManipulatorItemVisible(e)?this._attachManipulator(e):this._detachManipulator(e)}_attachManipulator(e){e.attached||(e.manipulator.attach&&e.manipulator.attach(this._resourceContexts),e.attached=!0)}_detachManipulator(e){if(e.attached){var d=e.manipulator;d.grabbing=!1;d.dragging=!1;d.hovering=
!1;d.selected=!1;d.detach&&d.detach(this._resourceContexts);e.attached=!1}}_isManipulatorItemVisible(e){return e.visibilityPredicate===a.ManipulatorVisibilityPredicate.Always?!0:this._isToolEditable?e.visibilityPredicate===a.ManipulatorVisibilityPredicate.WhenToolEditable:e.visibilityPredicate===a.ManipulatorVisibilityPredicate.WhenToolNotEditable}}a.ManipulatorCollection=l;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/sketch/SketchLabelOptions":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,c,l,e,d,k,t){c=class extends c{constructor(u){super(u);this.enabled=!1}};a.__decorate([l.property({type:Boolean,nonNullable:!0})],c.prototype,"enabled",void 0);return c=a.__decorate([t.subclass("esri.views.interactive.sketch.SketchLabelOptions")],c)})},"esri/views/interactive/sketch/SketchTooltipOptions":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./SketchTooltipElevationOptions ./SketchTooltipVisibleElements".split(" "),
function(a,c,l,e,d,k,t,u,f){c=class extends c{constructor(y){super(y);this.inputEnabled=this.enabled=!1;this.elevation=new u.SketchTooltipElevationOptions;this.visibleElements=new f.SketchTooltipVisibleElements;this.visualVariables=null}toJSON(){return{enabled:this.enabled,elevation:this.elevation,visibleElements:this.visibleElements}}};a.__decorate([l.property({type:Boolean,nonNullable:!0})],c.prototype,"enabled",void 0);a.__decorate([l.property({type:Boolean,nonNullable:!0})],c.prototype,"inputEnabled",
void 0);a.__decorate([l.property({type:u.SketchTooltipElevationOptions,nonNullable:!0})],c.prototype,"elevation",void 0);a.__decorate([l.property({type:f.SketchTooltipVisibleElements,nonNullable:!0})],c.prototype,"visibleElements",void 0);a.__decorate([l.property()],c.prototype,"visualVariables",void 0);return c=a.__decorate([t.subclass("esri.widgets.Sketch.SketchTooltipOptions")],c)})},"esri/views/interactive/sketch/SketchTooltipElevationOptions":function(){define("exports ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,c,l,e,d,k,t,u){a.SketchTooltipElevationOptions=class extends l{constructor(f){super(f);this.mode="absolute-height"}toJSON(){return{mode:this.mode}}};c.__decorate([e.property({type:String,nonNullable:!0})],a.SketchTooltipElevationOptions.prototype,"mode",void 0);a.SketchTooltipElevationOptions=c.__decorate([u.subclass("esri.widgets.Sketch.SketchTooltipOptions.ElevationOptions")],a.SketchTooltipElevationOptions);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/sketch/SketchTooltipVisibleElements":function(){define("exports ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,c,l,e,d,k,t,u){a.SketchTooltipVisibleElements=class extends l{constructor(f){super(f);this.elevation=this.distance=this.area=!0;this.helpMessage=!1;this.totalLength=this.size=this.scale=this.rotation=this.radius=this.orientation=!0}toJSON(){return{area:this.area,distance:this.distance,elevation:this.elevation,helpMessage:this.helpMessage,orientation:this.orientation,radius:this.radius,rotation:this.rotation,scale:this.scale,size:this.size,totalLength:this.totalLength}}};c.__decorate([e.property({type:Boolean,
nonNullable:!0})],a.SketchTooltipVisibleElements.prototype,"area",void 0);c.__decorate([e.property({type:Boolean,nonNullable:!0})],a.SketchTooltipVisibleElements.prototype,"distance",void 0);c.__decorate([e.property({type:Boolean,nonNullable:!0})],a.SketchTooltipVisibleElements.prototype,"elevation",void 0);c.__decorate([e.property({type:Boolean,nonNullable:!0})],a.SketchTooltipVisibleElements.prototype,"helpMessage",void 0);c.__decorate([e.property({type:Boolean,nonNullable:!0})],a.SketchTooltipVisibleElements.prototype,
"orientation",void 0);c.__decorate([e.property({type:Boolean,nonNullable:!0})],a.SketchTooltipVisibleElements.prototype,"radius",void 0);c.__decorate([e.property({type:Boolean,nonNullable:!0})],a.SketchTooltipVisibleElements.prototype,"rotation",void 0);c.__decorate([e.property({type:Boolean,nonNullable:!0})],a.SketchTooltipVisibleElements.prototype,"scale",void 0);c.__decorate([e.property({type:Boolean,nonNullable:!0})],a.SketchTooltipVisibleElements.prototype,"size",void 0);c.__decorate([e.property({type:Boolean,
nonNullable:!0})],a.SketchTooltipVisibleElements.prototype,"totalLength",void 0);a.SketchTooltipVisibleElements=c.__decorate([u.subclass("esri.widgets.Sketch.SketchTooltipOptions.VisibleElements")],a.SketchTooltipVisibleElements);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/constraintUtils":function(){define("exports ../../../core/quantityUtils ../../../core/unitUtils ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../geometry/projection/projectVectorToVector ../../../geometry/support/Axis ../../../geometry/support/coordinateSystem ../sketch/constraints ../sketch/normalizedPoint ../../support/angularMeasurementUtils ../../support/measurementUtils".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A){const b=d.create(),g=d.create();a.getDistanceConstraint=function(m,n,h,q){if(n){var {spatialReference:z}=m;if(l.lengthUnitFromSpatialReference(z)){var r=A.computeEuclideanMeasurementSR(z),D=l.lengthUnitFromSpatialReference(r);if(D&&(m=y.fromPoint(m,h,q),k.projectVectorToVector(m,z,b,r)&&(n=c.valueInUnit(n,D),"3d"===h?.type&&"local"===h.viewingMode?b[0]+=n:(h=u.createGlobal(r),h=u.axisAt(h,b,t.Axis.X,g),e.scaleAndAdd(b,b,h,n)),k.projectVectorToVector(b,r,b,z))))return z=
e.distance(m,b),new f.SphereConstraint(m,z)}}};a.getElevationConstraint=function(m,n,h,q){if(null!=m&&(n=A.computeEuclideanMeasurementSR(n),n=l.verticalLengthUnitFromSpatialReference(n)))return new f.HorizontalPlaneConstraint(c.valueInUnit(m,n))};a.getOrientationConstraint=function(m,n,h,q){if(n){var z=y.fromPoint(m,h,q);if(m=B.pointFromDistanceAlongAzimuth(m,1,n))return h=y.fromPoint(m,h,q),new f.VerticalHalfPlaneConstraint(z,h)}};a.intersectAll=function(m){let n;for(const h of m)h&&(n=n?.intersect(h)??
h);return n};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/sketch/constraints":function(){define("exports ../../../core/arrayUtils ../../../chunks/vec2 ../../../chunks/vec2f64 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../geometry/support/plane ../../../geometry/support/ray ../../../chunks/sphere ./normalizedPoint ../../support/geometry3dUtils ../../support/geometry2dUtils".split(" "),function(a,c,l,e,d,k,t,u,f,y,B,A){function b(N,R){if(N instanceof
O){var pa=[];for(const sa of N.constraints)(N=sa.intersect(R))&&pa.push(N);return v(pa)}if(R instanceof O)return b(R,N);if(N instanceof Z)return q(N,R);if(R instanceof Z)return q(R,N);if(I(N))return{point:pa}=N,R=R.closestTo(pa),d.equals(R,pa)?N:void 0;if(p(N)){if(I(R))return b(R,N);if(p(R))return r(B.intersectLineLikes(N.lineLike,R.lineLike));if(w(R))return na(N,R);if(C(R))return r(B.intersectVerticalPlaneAndLineLike(R.planeLike,N.lineLike));if(F(R))return r(B.intersectLineLikeAndVerticalCylinder(N.lineLike,
R.center,R.radius));if(J(R))return r(B.intersectLineLikeAndCircle(N.lineLike,R));if(G(R))return g(N,R);if(L(R))return m(N,R)}else if(w(N)){if(I(R)||p(R))return b(R,N);if(w(R))return B.isClose(N.z,R.z)?N:void 0;if(C(R))return n(N,R);if(F(R)){const [sa,ua]=R.center;return new U(y.fromValues(sa,ua,N.z),R.radius)}if(J(R))return ra(N,R);if(G(R))return B.isClose(R.center[2],N.z)?R:void 0;if(L(R))return h(N,R)}else if(C(N)){if(I(R)||p(R)||w(R))return b(R,N);if(C(R))return z(B.intersectVerticalPlanes(N.planeLike,
R.planeLike));if(F(R))return z(B.intersectVerticalPlaneAndVerticalCylinder(N.planeLike,R.center,R.radius));if(J(R))return ta(N,R);if(G(R))return oa(N,R);if(L(R))return za(N,R)}else if(F(N)){if(I(R)||p(R)||w(R)||C(R))return b(R,N);if(F(R))return z(B.intersectVerticalCylinders(N.center,N.radius,R.center,R.radius));if(!J(R)){if(G(R))return pa=l.squaredDistance(N.center,R.center),B.isClose(pa,0)&&B.isClose(N.radius,R.radius)||(N=B.intersectVerticalCylinders(N.center,N.radius,R.center,R.radius),R=D(N,
R.center[2])),R;L(R)}}else if(J(N)){if(I(R)||p(R)||w(R)||C(R)||F(R))return b(R,N);J(R)||(G(R)?R.asCircle():L(R))}else if(G(N)){if(I(R)||p(R)||w(R)||C(R)||F(R)||J(R))return b(R,N);if(G(R))return B.vectorsHaveCloseZ(R.center,N.center)?(pa=l.squaredDistance(R.center,N.center),B.isClose(pa,0)&&B.isClose(R.radius,N.radius)||(N=B.intersectVerticalCylinders(R.center,R.radius,N.center,N.radius),R=D(N,R.center[2]))):R=void 0,R;L(R)}else if(L(N)){if(I(R)||p(R)||w(R)||C(R)||F(R)||G(R))return b(R,N);L(R)}}function g({lineLike:N},
{center:R,radius:pa}){const sa=R[2];N=B.intersectLineLikeAndVerticalCylinder(N,R,pa).filter(ua=>B.isClose(ua[2],sa));return r(N)}function m({lineLike:N},{sphere:R}){return r(f.intersectLine(R,N.start,N.end))}function n({z:N},{planeLike:R}){const [pa,sa]=R.start,[ua,xa]=R.end,Aa=y.fromValues(pa,sa,N);N=y.fromValues(ua,xa,N);return R.type===B.VerticalPlaneType.PLANE?new E(Aa,N):new M(Aa,N)}function h(N,{center:R,radius:pa}){const sa=Math.abs(R[2]-N.z);if(!(sa>pa)||B.isClose(sa,pa))if(N=y.fromValues(R[0],
R[1],N.z),pa=Math.sqrt(pa**2-sa**2),!B.isClose(pa,0))return new U(N,pa)}function q(N,R){const {planeLike:pa,getZ:sa}=N,ua=[];if(I(R))N.addIfOnTheGround(ua,B.intersectVerticalPlaneAndPoint(pa,R.point));else if(p(R))N.addIfOnTheGround(ua,B.intersectVerticalPlaneAndLineLike(pa,R.lineLike));else if(F(R))for(const [xa,Aa]of B.intersectVerticalPlaneAndVerticalCylinder(pa,R.center,R.radius))N=sa(xa,Aa),null!=N&&ua.push(k.fromValues(xa,Aa,N));else if(C(R)||R instanceof Z)for(const [xa,Aa]of B.intersectVerticalPlanes(pa,
R.planeLike))N=sa(xa,Aa)??0,ua.push(k.fromValues(xa,Aa,N));return r(ua)}function z(N){return v(N.map(([R,pa])=>{const sa=y.fromValues(R,pa,0);R=y.fromValues(R,pa,1);return new E(sa,R)}))}function r(N){return v(N.map(R=>R?new H(y.fromVec3(R)):void 0))}function D(N,R){return r(N.map(([pa,sa])=>[pa,sa,R]))}function v(N){if(0!==N.length)return 1===N.length?N[0]??void 0:new O(N.filter(c.isSome))}function I(N){return N instanceof H}function p(N){return N instanceof K}function w(N){return N instanceof P}
function C(N){return N instanceof ma}function F(N){return N instanceof T}function G(N){return N instanceof U}function J(N){return N instanceof ba}function L(N){return N instanceof Q}class x{intersect(N){return b(this,N)}closestPoints(N){return[this.closestTo(N)]}}class H extends x{constructor(N){super();this.point=N}equals(N){return this===N||I(N)&&d.exactEquals(this.point,N.point)}closestTo(){return y.clone(this.point)}}class K extends x{constructor(N,R,pa){super();this.start=N;this.end=R;this.lineLike=
{start:N,end:R,type:pa}}equals(N){return this===N||p(N)&&this.lineLike.type===N.lineLike.type&&d.exactEquals(this.start,N.start)&&d.exactEquals(this.end,N.end)}closestTo(N){N=B.projectPointToLineLike(N,this.lineLike);return y.fromVec3(N)}}class E extends K{constructor(N,R){super(N,R,A.LineType.LINE)}}class M extends K{constructor(N,R){super(N,R,A.LineType.RAY)}}class O extends x{constructor(N){super();this.constraints=N}equals(N){return this===N||N instanceof O&&c.equals(this.constraints,N.constraints,
(R,pa)=>R.equals(pa))}closestTo(N){let R=Infinity,pa;for(const sa of this.constraints){const ua=sa.closestTo(N),xa=d.squaredDistance(N,ua);xa<R&&(R=xa,pa=ua)}return pa?y.clone(pa):N}closestPoints(N){return this.constraints.flatMap(R=>R===this?[]:R.closestPoints(N))}}class T extends x{constructor(N,R){super();this.center=N;this.radius=R}equals(N){return this===N||F(N)&&this.center[0]===N.center[0]&&this.center[1]===N.center[1]&&this.radius===N.radius}closestTo(N){N=B.projectPointToVerticalCylinder(N,
this.center,this.radius);return y.fromVec3(N)}}class U extends x{constructor(N,R){super();this.center=N;this.radius=R}equals(N){return this===N||G(N)&&d.exactEquals(this.center,N.center)&&this.radius===N.radius}closestTo(N){N=B.projectPointToVerticalCylinder(N,this.center,this.radius);N[2]=this.center[2];return y.fromVec3(N)}asCircle(){return new ba(y.clone(this.center),this.radius,y.fromValues(0,0,1))}}class ba extends x{constructor(N,R,pa,sa){super();this.center=N;this.radius=R;this.normal=pa;this.slicePlane=
sa}equals(N){return this===N||J(N)&&d.exactEquals(this.center,N.center)&&d.exactEquals(this.normal,N.normal)&&this.radius===N.radius}closestTo(N){const {center:R,radius:pa}=this;t.projectPoint(this.getPlane(fa),N,la);var sa=d.sub(la,la,R),ua=d.squaredLength(sa);if(B.isClose(ua,0))return y.clone(N);ua=pa/Math.sqrt(ua);sa=d.scaleAndAdd(k.create(),R,sa,ua);({slicePlane:ua}=this);return ua&&!B.isPointInsidePlane(ua,sa)?va(ua,this)?.closestTo(N)??y.clone(N):y.fromVec3(sa)}getPlane(N=t.create()){return t.fromPositionAndNormal(this.center,
this.normal,N)}}const la=k.create(),fa=t.create();class P extends x{constructor(N){super();this.z=N}equals(N){return this===N||w(N)&&this.z===N.z}closestTo(N){return y.fromVec3(k.fromValues(N[0],N[1],this.z))}getPlane(N=t.create()){d.set(X,0,0,this.z);return t.fromPositionAndNormal(X,k.UNIT_Z,N)}}const X=k.create();class ma extends x{constructor(N,R,pa){super();this.start=N;this.end=R;this.planeLike={start:N,end:R,type:pa}}equals(N){return this===N||C(N)&&this.planeLike.type===N.planeLike.type&&d.exactEquals(this.start,
N.start)&&d.exactEquals(this.end,N.end)}closestTo(N){return y.fromVec3(B.projectPointToVerticalPlane(N,this.planeLike))}closestEndTo(N){const {start:R,end:pa}=this;return 0<Math.sign(l.dot(l.subtract(aa,pa,R),l.subtract(W,N,R)))?pa:R}getPlane(N=t.create()){const R=d.copy(ia,this.end);R[2]+=1;return t.fromPoints(this.start,this.end,R,N)}getSlicePlane(N=t.create()){const {start:R,end:pa,type:sa}=this.planeLike;if(sa!==B.VerticalPlaneType.PLANE){var ua=d.set(ia,R[0],R[1],0),xa=d.set(ha,pa[0],pa[1],0);
xa=d.subtract(ha,xa,ua);t.fromPositionAndNormal(ua,xa,N);return N}}}const aa=e.create(),W=e.create(),ia=k.create(),ha=k.create();class V extends ma{constructor(N,R){super(N,R,B.VerticalPlaneType.HALF_PLANE)}}class ea extends ma{constructor(N,R){super(N,R,B.VerticalPlaneType.PLANE)}}class Q extends x{constructor(N,R){super();this.sphere=f.fromCenterAndRadius(N,R)}equals(N){return this===N||L(N)&&f.exactEquals(this.sphere,N.sphere)}closestTo(N){N=f.projectPoint(this.sphere,N,k.create());return y.fromVec3(N)}get center(){return this.sphere}get radius(){return this.sphere[3]}}
class Z extends x{constructor(N,R,pa){super();this.start=N;this.end=R;this.getZ=pa;this.planeLike={start:N,end:R,type:B.VerticalPlaneType.PLANE}}equals(N){return this===N||N instanceof Z&&d.exactEquals(this.start,N.start)&&d.exactEquals(this.end,N.end)&&this.getZ===N.getZ}closestTo(N){N=B.projectPointToVerticalPlane(N,this.planeLike);N[2]=this.getZ(N[0],N[1])??0;return y.fromVec3(N)}addIfOnTheGround(N,R){for(const pa of R)R=this.getZ(pa[0],pa[1])??0,B.isClose(pa[2],R)&&(pa[2]=R,N.push(pa))}}const na=
(()=>{const N=t.create();return(R,pa)=>{const {start:sa,end:ua}=R;if(B.vectorsHaveCloseZ(sa,ua)&&B.isClose(sa[2],pa.z))return R;R=k.create();if(t.intersectLine(pa.getPlane(N),sa,ua,R))return new H(y.fromVec3(R))}})(),va=(()=>{const N=u.create(),R=t.create(),pa={start:k.create(),end:k.create(),type:A.LineType.LINE};return(sa,ua,xa)=>{const {normal:Aa,center:Da,radius:Ba}=ua;var Ga=d.dot(Aa,t.normal(sa));const S=B.isClose(t.distance(sa,Da),0);if(B.isClose(Ga,1)){if(S)return ua}else{ua.getPlane(R);if(S&&
B.isClose(Ga,0)&&t.isVertical(sa)&&t.isVertical(R)){if(B.isClose(Ba,0))return!xa||B.isPointInsidePlane(xa,Da)?new H(y.clone(Da)):void 0;sa=k.clone(Da);sa[2]+=Ba;ua=k.clone(Da);ua[2]-=Ba;Ga=[];xa&&!B.isPointInsidePlane(xa,sa)||Ga.push(sa);xa&&!B.isPointInsidePlane(xa,ua)||Ga.push(ua);return r(Ga)}if(t.intersectPlanes(sa,R,N))return d.copy(pa.start,N.origin),d.add(pa.end,N.origin,N.direction),sa=B.intersectLineLikeAndCircle(pa,ua),r(xa?B.pointsInsidePlane(xa,sa):sa)}}})(),ra=(()=>{const N=t.create();
return(R,pa)=>va(R.getPlane(N),pa)})(),oa=(()=>{const N=t.create();return(R,{center:pa,radius:sa})=>{sa=B.intersectVerticalPlaneAndVerticalCylinder(R.planeLike,pa,sa);pa=pa[2];R.getSlicePlane(N);R=[];for(const [ua,xa]of sa)sa=[ua,xa,pa],B.isPointInsidePlane(N,sa)&&R.push(sa);return r(R)}})(),ta=(()=>{const N=t.create(),R=t.create();return(pa,sa)=>va(pa.getPlane(N),sa,pa.getSlicePlane(R))})(),za=(()=>{const N=t.create();return(R,{center:pa,radius:sa})=>{const ua=R.getPlane(N),xa=t.signedDistance(ua,
pa);var Aa=Math.abs(xa);if(!(Aa>sa)||B.isClose(Aa,sa)){Aa=k.clone(t.normal(ua));var Da=d.scaleAndAdd(k.create(),pa,Aa,xa);sa=Math.sqrt(sa**2-xa**2);return B.isClose(sa,0)?new H(y.fromVec3(t.projectPoint(ua,pa,k.create()))):new ba(y.fromVec3(Da),sa,Aa,R.getSlicePlane())}}})();a.CircleConstraint=ba;a.Constraint=x;a.DrapedLineConstraint=Z;a.HorizontalCircleConstraint=U;a.HorizontalPlaneConstraint=P;a.LineConstraint=E;a.LineLikeConstraint=K;a.PointConstraint=H;a.RayConstraint=M;a.SetConstraint=O;a.SphereConstraint=
Q;a.VerticalCylinderConstraint=T;a.VerticalHalfPlaneConstraint=V;a.VerticalPlaneConstraint=ea;a.VerticalPlaneLikeConstraint=ma;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/geometry3dUtils":function(){define("exports ../../core/mathUtils ../../chunks/vec2 ../../chunks/vec2f64 ../../chunks/vec3 ../../chunks/vec3f64 ../../geometry/support/plane ../3d/support/mathUtils ./geometry2dUtils".split(" "),function(a,c,l,e,d,k,t,u,f){function y(x,{start:H,end:K,type:E}){x=
d.sub(D,x,H);K=d.sub(v,K,H);x=d.dot(x,K)/d.dot(K,K);return d.scaleAndAdd(k.create(),H,K,E===f.LineType.RAY?Math.max(x,0):x)}function B({start:x,end:H,type:K},E){const M=d.sub(D,E,x);H=d.sub(v,H,x);if(K===f.LineType.RAY&&-1E-6>d.dot(H,M))return d.distance(x,E);x=d.cross(I,H,M);return d.len(x)/d.len(H)}function A(x,H){const K=x.start,E=H.start;var M=H.end;const O=d.sub(D,x.end,K);M=d.sub(v,M,E);var T=d.sub(I,E,K),U=d.cross(p,O,M),ba=d.dot(T,U);if(!c.floatEqualAbsolute(ba,0,1E-6))return[];ba=d.sqrLen(U);
if(c.floatEqualAbsolute(ba,0,1E-6))return[];T=d.cross(w,T,M);U=d.dot(T,U)/ba;U=d.scaleAndAdd(C,K,O,U);return x.type===f.LineType.RAY&&(x=d.sub(F,U,K),-1E-6>d.dot(O,x))||H.type===f.LineType.RAY&&(H=d.sub(F,U,E),-1E-6>d.dot(M,H))?[]:[k.clone(U)]}function b({start:x,end:H,type:K},E){const M=d.sub(D,E,x);x=d.sub(v,H,x);H=d.cross(I,x,M);if(1E-6>d.sqrLen(H)/d.sqrLen(x))switch(K){case f.LineType.LINE:return[k.clone(E)];case f.LineType.RAY:return-1E-6>d.dot(x,M)?[]:[k.clone(E)]}return[]}function g(x,H,{start:K,
end:E,type:M}){d.set(x.start,K[0],K[1],H);d.set(x.end,E[0],E[1],H);x.type=q[M];return x}function m(x,H){return 1E-6>Math.abs(x-H)}function n(x,H){return t.isPointInside(x,H)}const h=(()=>{const x=k.create(),H=k.create(),K=k.create();return({start:E,end:M},{center:O,radius:T,normal:U,slicePlane:ba})=>{const la=k.create(),fa=t.fromPositionAndNormal(O,U,G);if(m(t.distance(fa,E),0)&&m(t.distance(fa,M),0)){u.tangentFrame(U,x,H);U=(P,X)=>{d.subtract(K,X,O);l.set(P,d.dot(K,x),d.dot(K,H));return P};M=f.intersectLineLikeAndCircle({start:U(z,
E),end:U(r,M),type:f.LineType.LINE},e.ZEROS,T);E=[];for(const [P,X]of M)M=d.copy(k.create(),O),d.scaleAndAdd(M,M,x,P),d.scaleAndAdd(M,M,H,X),ba&&!n(ba,M)||E.push(M);return E}return t.intersectLine(fa,E,M,la)?!m(d.distance(la,O),T)||ba&&!n(ba,la)?[]:[la]:[]}})();a.VerticalPlaneType=void 0;(function(x){x[x.PLANE=0]="PLANE";x[x.HALF_PLANE=1]="HALF_PLANE"})(a.VerticalPlaneType||(a.VerticalPlaneType={}));const q={[a.VerticalPlaneType.PLANE]:f.LineType.LINE,[a.VerticalPlaneType.HALF_PLANE]:f.LineType.RAY},
z=e.create(),r=e.create(),D=k.create(),v=k.create(),I=k.create(),p=k.create(),w=k.create(),C=k.create(),F=k.create(),G=t.create(),J={start:k.create(),end:k.create(),type:f.LineType.LINE},L={start:k.create(),end:k.create(),type:f.LineType.LINE};Object.defineProperty(a,"LineType",{enumerable:!0,get:()=>f.LineType});a.epsilon=1E-6;a.intersectLineAndPoint=b;a.intersectLineLikeAndCircle=h;a.intersectLineLikeAndVerticalCylinder=function({start:x,end:H,type:K},E,M){const O=[];H=d.subtract(D,H,x);var T=l.subtract(v,
x,E);E=l.squaredLength(H);const U=2*l.dot(H,T);M=l.squaredLength(T)-M*M;M=U*U-4*E*M;0===M?(E=-U/(2*E),(K===f.LineType.LINE||0<=E)&&O.push(d.scaleAndAdd(k.create(),x,H,E))):0<M&&(M=Math.sqrt(M),T=(-U+M)/(2*E),(K===f.LineType.LINE||0<=T)&&O.push(d.scaleAndAdd(k.create(),x,H,T)),E=(-U-M)/(2*E),(K===f.LineType.LINE||0<=E)&&O.push(d.scaleAndAdd(k.create(),x,H,E)));return O};a.intersectLineLikes=A;a.intersectVerticalCylinderAndPoint=function(x,H,K){return c.floatEqualAbsolute(l.squaredDistance(K,x),H*H,
1E-6)?[k.clone(K)]:[]};a.intersectVerticalCylinders=function(x,H,K,E){const [M,O]=x,[T,U]=K;var ba=T-M,la=U-O;const fa=ba*ba+la*la,P=Math.sqrt(fa);if(P>H+E||P<Math.abs(H-E)||m(P,0)&&m(H,E))return[];E=(H*H-E*E+fa)/(2*P);H=Math.sqrt(H*H-E*E);la=H*la/P;ba=H*ba/P;const [X,ma]=l.lerp(z,x,K,E/P);return m(la,ba)?[e.fromValues(X,ma)]:[e.fromValues(X+la,ma-ba),e.fromValues(X-la,ma+ba)]};a.intersectVerticalPlaneAndLineLike=function(x,H){const K=x.start,E=l.subtract(D,x.end,K);var M=d.set(v,-E[1],E[0],0);const O=
H.start,T=d.sub(I,H.end,O);var U=d.dot(T,M),ba=d.set(p,K[0],K[1],0);ba=d.sub(w,ba,O);M=d.dot(ba,M);if(1E-6>Math.abs(U))return[];U=d.scaleAndAdd(C,O,T,M/U);return H.type===f.LineType.RAY&&(H=d.sub(F,U,O),-1E-6>d.dot(H,T))||x.type===a.VerticalPlaneType.HALF_PLANE&&(x=l.sub(F,U,K),-1E-6>l.dot(x,E))?[]:[k.clone(U)]};a.intersectVerticalPlaneAndPoint=function(x,H){return b(g(J,H[2],x),H)};a.intersectVerticalPlaneAndVerticalCylinder=function({start:x,end:H,type:K},E,M){const O=[];H=l.subtract(D,H,x);var T=
l.subtract(v,x,E);E=l.squaredLength(H);const U=2*l.dot(H,T);M=l.squaredLength(T)-M*M;M=U*U-4*E*M;0===M?(E=-U/(2*E),(K===a.VerticalPlaneType.PLANE||0<=E)&&O.push(l.scaleAndAdd(e.create(),x,H,E))):0<M&&(M=Math.sqrt(M),T=(-U+M)/(2*E),(K===a.VerticalPlaneType.PLANE||0<=T)&&O.push(l.scaleAndAdd(e.create(),x,H,T)),E=(-U-M)/(2*E),(K===a.VerticalPlaneType.PLANE||0<=E)&&O.push(l.scaleAndAdd(e.create(),x,H,E)));return O};a.intersectVerticalPlanes=function(x,H){x=g(J,0,x);H=g(L,0,H);H=A(x,H);x=[];for(const K of H)x.push(e.clone(K));
return x};a.isClose=m;a.isPointInsidePlane=n;a.pointToLineLikeDistance=B;a.pointToVerticalCylinderDistance=function(x,H,K){return l.distance(x,H)-K};a.pointToVerticalPlaneDistance=function(x,H){return B(g(J,x[2],H),x)};a.pointsInsidePlane=function(x,H){return H.filter(K=>n(x,K))};a.projectPointToLineLike=y;a.projectPointToVerticalCylinder=function(x,H,K){const E=l.subtract(D,x,H);K/=l.length(E);H=l.scaleAndAdd(k.create(),H,E,K);H[2]=x[2];return H};a.projectPointToVerticalPlane=function(x,H){return y(x,
g(J,x[2],H))};a.vectorsHaveCloseZ=function(x,H){return m(x[2],H[2])};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/geometry2dUtils":function(){define(["exports","../../core/mathUtils","../../chunks/vec2","../../chunks/vec2f64"],function(a,c,l,e){function d(b,g){return b[0]*g[1]-b[1]*g[0]}function k(b,g,m){g=l.dot(m,g)/l.squaredLength(m);return l.scale(b,m,g)}function t(b,g,m,n,h=m){l.subtract(f,n,m);l.subtract(B,g,h);k(A,B,f);return l.add(b,h,A)}function u(b,
g,m,n){l.subtract(f,g,m);g=n/l.length(f);return l.scaleAndAdd(b,m,f,g)}a.LineType=void 0;(function(b){b[b.RAY=0]="RAY";b[b.LINE=1]="LINE"})(a.LineType||(a.LineType={}));const f=e.create(),y=e.create(),B=e.create(),A=e.create();a.cross=d;a.intersectCircleAndPoint=function(b,g,m){u(B,m,b,g);return c.floatEqualAbsolute(B[0],m[0])&&c.floatEqualAbsolute(B[1],m[1])?[e.clone(m)]:[]};a.intersectLineAndPoint=function(b,g){t(B,g,b.start,b.end);return c.floatEqualAbsolute(B[0],g[0])&&c.floatEqualAbsolute(B[1],
g[1])?[e.clone(g)]:[]};a.intersectLineAndRay=function(b,g){const m=b.start;var n=g.start,h=g.end;const q=l.subtract(f,b.end,m);var z=l.subtract(y,h,n);h=d(q,z);if(1E-6>=Math.abs(h))return[];n=l.subtract(B,m,n);z=d(z,n)/h;h=d(q,n)/h;if(0<=z){if(0<=h||g.type===a.LineType.LINE)return[l.scaleAndAdd(A,m,q,z)]}else if(b.type===a.LineType.LINE&&(0<=h||g.type===a.LineType.LINE))return[l.scaleAndAdd(A,m,q,z)];return[]};a.intersectLineLikeAndCircle=function(b,g,m){const n=[],h=l.subtract(f,b.end,b.start);var q=
l.subtract(y,b.start,g);g=l.squaredLength(h);const z=2*l.dot(h,q);m=l.squaredLength(q)-m*m;m=z*z-4*g*m;0===m?(g=-z/(2*g),(b.type===a.LineType.LINE||0<=g)&&n.push(l.scaleAndAdd(A,b.start,h,g))):0<m&&(m=Math.sqrt(m),q=(-z+m)/(2*g),(b.type===a.LineType.LINE||0<=q)&&n.push(l.scaleAndAdd(A,b.start,h,q)),g=(-z-m)/(2*g),(b.type===a.LineType.LINE||0<=g)&&n.push(l.scaleAndAdd(B,b.start,h,g)));return n};a.pointToLineDistance=function(b,g,m){return Math.abs((g[0]-b[0])*(m[1]-b[1])-(g[1]-b[1])*(m[0]-b[0]))/l.distance(g,
m)};a.projectPoint=k;a.projectPointToCircle=u;a.projectPointToLine=t;a.projectPointToRay=function(b,g,m,n){l.subtract(f,n,m);l.subtract(B,g,m);g=l.dot(f,B)/l.squaredLength(f);return 0<g?l.scaleAndAdd(b,m,f,g):l.copy(b,m)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/angularMeasurementUtils":function(){define("exports ../../core/quantityUtils ../../core/unitUtils ../../chunks/vec2 ../../chunks/vec2f64 ../../chunks/vec3 ../../chunks/vec3f64 ../../geometry/Point ../../geometry/SpatialReference ../../geometry/projection/projectVectorToPoint ../../geometry/projection/projectVectorToVector ../../geometry/projection/projectVectorToWGS84ComparableLonLat ../../geometry/support/geodesicUtils".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b){const g=(()=>{const h=t.create(),q=t.create(),z=t.create();return(r,D)=>{k.set(q,r.x,r.y,r.z??0);k.set(z,D.x,D.y,D.z??0);if(k.exactEquals(q,z))return null;if(!A.projectVectorToWGS84ComparableLonLat(q,r.spatialReference,q)||!A.projectVectorToWGS84ComparableLonLat(z,D.spatialReference,z))return k.subtract(h,z,q),h[2]=0,k.normalize(h,h),r=e.angle(d.UNIT_Y,h),0>h[0]&&(r=2*Math.PI-r),c.createAngle(r,"radians","geographic");({azimuth:r}=b.inverseGeodeticSolver(n,q,z));
return null!=r?c.createAngle(r,"degrees","geographic"):void 0}})(),m=(()=>{const h=t.create(),q=t.create();return({x:z,y:r,z:D,spatialReference:v},I,p)=>{D=D??0;k.set(h,z,r,D);p=c.convertRotationType(l.convertUnit(p.value,p.unit,"degrees"),p.rotationType,"geographic");if(!B.projectVectorToVector(h,v,h,f.WGS84))return p=c.convertRotationType(p,"geographic","arithmetic"),p=l.convertUnit(p,"degrees","radians"),new u({x:z+I*Math.cos(p),y:r+I*Math.sin(p),z:D,spatialReference:v});b.directGeodeticSolver(q,
h,p,I);q[2]=D;return y.projectVectorToPoint(q,f.WGS84,v)}})(),n=new b.InverseGeodeticSolverResult;a.orientationBetweenPoints=g;a.pointFromDistanceAlongAzimuth=m;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/DrawTooltipInfos":function(){define("exports ../../../chunks/tslib.es6 ../../../core/quantityUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/subclass ./SketchTooltipInfo ./fields/fields".split(" "),
function(a,c,l,e,d,k,t){a.DrawPointTooltipInfo=class extends k.SketchTooltipInfo{constructor(u){super(u);this.type="draw-point";this.elevation=t.makeElevationField()}get allFields(){return[this.elevation]}};c.__decorate([e.property()],a.DrawPointTooltipInfo.prototype,"type",void 0);c.__decorate([e.property()],a.DrawPointTooltipInfo.prototype,"elevation",void 0);c.__decorate([e.property()],a.DrawPointTooltipInfo.prototype,"allFields",null);c.__decorate([e.property()],a.DrawPointTooltipInfo.prototype,
"helpMessage",void 0);a.DrawPointTooltipInfo=c.__decorate([d.subclass("esri.views.interactive.tooltip.DrawPointTooltipInfo")],a.DrawPointTooltipInfo);a.DrawPolylineTooltipInfo=class extends k.SketchTooltipInfo{constructor(u){super(u);this.type="draw-polyline";this.orientation=t.makeOrientationField();this.distance=t.makeLengthField({title:f=>f.messages.sketch.distance});this.elevation=t.makeElevationField();this.totalLength=t.makeLengthField({format:(f,y)=>y.formatters.totalLength(f),title:f=>f.messages.sketch.totalLength,
readOnly:!0})}get allFields(){return[this.orientation,this.distance,this.elevation,this.totalLength]}};c.__decorate([e.property()],a.DrawPolylineTooltipInfo.prototype,"type",void 0);c.__decorate([e.property()],a.DrawPolylineTooltipInfo.prototype,"orientation",void 0);c.__decorate([e.property()],a.DrawPolylineTooltipInfo.prototype,"distance",void 0);c.__decorate([e.property()],a.DrawPolylineTooltipInfo.prototype,"elevation",void 0);c.__decorate([e.property()],a.DrawPolylineTooltipInfo.prototype,"totalLength",
void 0);c.__decorate([e.property()],a.DrawPolylineTooltipInfo.prototype,"allFields",null);c.__decorate([e.property()],a.DrawPolylineTooltipInfo.prototype,"helpMessage",void 0);a.DrawPolylineTooltipInfo=c.__decorate([d.subclass("esri.views.interactive.tooltip.DrawPolylineTooltipInfo")],a.DrawPolylineTooltipInfo);a.DrawPolygonTooltipInfo=class extends k.SketchTooltipInfo{constructor(u){super(u);this.type="draw-polygon";this.orientation=t.makeOrientationField();this.distance=t.makeLengthField({title:f=>
f.messages.sketch.distance});this.elevation=t.makeElevationField();this.area=t.makeAreaField({readOnly:!0})}get allFields(){return[this.orientation,this.distance,this.elevation,this.area]}};c.__decorate([e.property()],a.DrawPolygonTooltipInfo.prototype,"type",void 0);c.__decorate([e.property()],a.DrawPolygonTooltipInfo.prototype,"distance",void 0);c.__decorate([e.property()],a.DrawPolygonTooltipInfo.prototype,"elevation",void 0);c.__decorate([e.property()],a.DrawPolygonTooltipInfo.prototype,"area",
void 0);c.__decorate([e.property()],a.DrawPolygonTooltipInfo.prototype,"allFields",null);c.__decorate([e.property()],a.DrawPolygonTooltipInfo.prototype,"helpMessage",void 0);a.DrawPolygonTooltipInfo=c.__decorate([d.subclass("esri.views.interactive.tooltip.DrawPolygonTooltipInfo")],a.DrawPolygonTooltipInfo);a.DrawMeshTooltipInfo=class extends k.SketchTooltipInfo{constructor(u){super(u);this.type="draw-mesh";this.elevation=t.makeElevationField()}get allFields(){return[this.elevation]}};c.__decorate([e.property()],
a.DrawMeshTooltipInfo.prototype,"type",void 0);c.__decorate([e.property()],a.DrawMeshTooltipInfo.prototype,"elevation",void 0);c.__decorate([e.property()],a.DrawMeshTooltipInfo.prototype,"allFields",null);c.__decorate([e.property()],a.DrawMeshTooltipInfo.prototype,"helpMessage",void 0);a.DrawMeshTooltipInfo=c.__decorate([d.subclass("esri.views.interactive.tooltip.DrawMeshTooltipInfo")],a.DrawMeshTooltipInfo);a.DrawRectangleTooltipInfo=class extends k.SketchTooltipInfo{constructor(u){super(u);this.type=
"draw-rectangle";this.ySize=this.xSize=l.zeroMeters;this.area=l.zeroSquareMeters}get allFields(){return[]}};c.__decorate([e.property()],a.DrawRectangleTooltipInfo.prototype,"type",void 0);c.__decorate([e.property()],a.DrawRectangleTooltipInfo.prototype,"xSize",void 0);c.__decorate([e.property()],a.DrawRectangleTooltipInfo.prototype,"ySize",void 0);c.__decorate([e.property()],a.DrawRectangleTooltipInfo.prototype,"area",void 0);c.__decorate([e.property()],a.DrawRectangleTooltipInfo.prototype,"allFields",
null);a.DrawRectangleTooltipInfo=c.__decorate([d.subclass("esri.views.interactive.tooltip.DrawRectangleTooltipInfo")],a.DrawRectangleTooltipInfo);a.DrawCircleTooltipInfo=class extends k.SketchTooltipInfo{constructor(u){super(u);this.type="draw-circle";this.ySize=this.xSize=this.radius=null;this.area=l.zeroSquareMeters}get allFields(){return[]}};c.__decorate([e.property()],a.DrawCircleTooltipInfo.prototype,"type",void 0);c.__decorate([e.property()],a.DrawCircleTooltipInfo.prototype,"radius",void 0);
c.__decorate([e.property()],a.DrawCircleTooltipInfo.prototype,"xSize",void 0);c.__decorate([e.property()],a.DrawCircleTooltipInfo.prototype,"ySize",void 0);c.__decorate([e.property()],a.DrawCircleTooltipInfo.prototype,"area",void 0);c.__decorate([e.property()],a.DrawCircleTooltipInfo.prototype,"allFields",null);a.DrawCircleTooltipInfo=c.__decorate([d.subclass("esri.views.interactive.tooltip.DrawCircleTooltipInfo")],a.DrawCircleTooltipInfo);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/views/interactive/tooltip/SketchTooltipInfo":function(){define("exports ../../../chunks/tslib.es6 ../../../core/Evented ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass".split(" "),function(a,c,l,e,d,k,t,u){a.SketchTooltipInfo=class extends l.EventedAccessor{constructor(f){super(f);this._mode="feedback";this.viewType=this.helpMessage=void 0}get mode(){return this._mode}get allFields(){return[]}get editableFields(){return this.allFields.filter(f=>
!f.readOnly)}enterInputMode(){this._mode="input";this.emit("focus")}exitInputMode(){this._mode="feedback"}unlockAllFields(){this.allFields.forEach(f=>f.unlock())}};c.__decorate([e.property()],a.SketchTooltipInfo.prototype,"tooltipOptions",void 0);c.__decorate([e.property()],a.SketchTooltipInfo.prototype,"_mode",void 0);c.__decorate([e.property()],a.SketchTooltipInfo.prototype,"mode",null);c.__decorate([e.property()],a.SketchTooltipInfo.prototype,"helpMessage",void 0);c.__decorate([e.property()],a.SketchTooltipInfo.prototype,
"viewType",void 0);c.__decorate([e.property()],a.SketchTooltipInfo.prototype,"allFields",null);c.__decorate([e.property()],a.SketchTooltipInfo.prototype,"editableFields",null);a.SketchTooltipInfo=c.__decorate([u.subclass("esri.views.interactive.tooltip.SketchTooltipInfo")],a.SketchTooltipInfo);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/fields/fields":function(){define("exports ../../../../core/Cyclical ../../../../core/quantityUtils ../../../../core/unitUtils ./TooltipField ./TooltipFieldElevation".split(" "),
function(a,c,l,e,d,k){a.makeAreaField=t=>new d.TooltipField({actual:l.zeroSquareMeters,createQuantity:(u,f)=>l.createArea(u,f.inputUnitInfos.area.unit),toInputUnits:(u,f)=>l.toUnit(u,f.inputUnitInfos.area.unit),format:(u,f)=>f.formatters.area(u),suffix:u=>u.inputUnitInfos.area.abbreviation,title:u=>u.messages.sketch.area,...t});a.makeElevationField=t=>new k.TooltipFieldElevation(t);a.makeLengthField=t=>new d.TooltipField({actual:l.zeroMeters,createQuantity:(u,f)=>l.createLength(u,f.inputUnitInfos.length.unit),
toInputUnits:(u,f)=>l.toUnit(u,f.inputUnitInfos.length.unit),format:(u,f)=>f.formatters.length(u),suffix:u=>u.inputUnitInfos.length.abbreviation,title:u=>u.messages.sketch.distance,...t});a.makeOrientationField=t=>new d.TooltipField({actual:l.zeroDegrees,createQuantity:(u,f)=>l.createAngle(u,f.inputUnitInfos.orientation.unit,"geographic"),toInputUnits:({value:u,unit:f,rotationType:y},B)=>{u=l.convertRotationType(e.convertUnit(u,f,"degrees"),y,"geographic");u=c.cyclicalDegrees.normalize(u,0,!0);B=
B.inputUnitInfos.orientation.unit;u=e.convertUnit(u,"degrees",B);return l.createAngle(u,B,"geographic")},format:(u,f)=>f.formatters.angle(u),suffix:u=>u.inputUnitInfos.orientation.abbreviation,title:u=>u.messages.sketch.orientation,...t});Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/fields/TooltipField":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Accessor ../../../../core/uuid ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,c,l,e,d,k,t,u,f){a.TooltipField=class extends l{constructor(y){super(y);this.committed=null;this.hidden=this.disabled=!1;this.id=e.generateUUID();this.inputValue=null;this.readOnly=!1}get dirty(){return null!=this.inputValue}get locked(){return null!=this.committed}lock(y){this.inputValue=null;this.committed=y??this.actual}unlock(){this.inputValue=this.committed=null}};c.__decorate([d.property()],a.TooltipField.prototype,"actual",void 0);c.__decorate([d.property()],a.TooltipField.prototype,
"committed",void 0);c.__decorate([d.property()],a.TooltipField.prototype,"createQuantity",void 0);c.__decorate([d.property()],a.TooltipField.prototype,"disabled",void 0);c.__decorate([d.property()],a.TooltipField.prototype,"hidden",void 0);c.__decorate([d.property()],a.TooltipField.prototype,"format",void 0);c.__decorate([d.property()],a.TooltipField.prototype,"id",void 0);c.__decorate([d.property()],a.TooltipField.prototype,"inputValue",void 0);c.__decorate([d.property()],a.TooltipField.prototype,
"readOnly",void 0);c.__decorate([d.property()],a.TooltipField.prototype,"suffix",void 0);c.__decorate([d.property()],a.TooltipField.prototype,"title",void 0);c.__decorate([d.property()],a.TooltipField.prototype,"toInputUnits",void 0);c.__decorate([d.property()],a.TooltipField.prototype,"dirty",null);c.__decorate([d.property()],a.TooltipField.prototype,"locked",null);a.TooltipField=c.__decorate([f.subclass("esri.views.interactive.tooltip.fields.TooltipField")],a.TooltipField);Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/fields/TooltipFieldElevation":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/quantityUtils ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/decorators/subclass ./TooltipField".split(" "),function(a,c,l,e,d,k,t,u,f){a.TooltipFieldElevation=class extends f.TooltipField{constructor(y){super(y);
this.mode="absolute-height"}normalizeCtorArgs(y){return{actual:l.zeroMeters,createQuantity:(B,A)=>l.createLength(B,A.inputUnitInfos.verticalLength.unit),toInputUnits:(B,A)=>l.toUnit(B,A.inputUnitInfos.verticalLength.unit),format:(B,A)=>A.formatters.verticalLength(B),suffix:B=>B.inputUnitInfos.verticalLength.abbreviation,title:B=>B.messages.sketch.elevation,...y}}};c.__decorate([e.property()],a.TooltipFieldElevation.prototype,"mode",void 0);a.TooltipFieldElevation=c.__decorate([u.subclass("esri.views.interactive.tooltip.fields.TooltipFieldElevation")],
a.TooltipFieldElevation);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/Tooltip":function(){define("exports ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/maybe ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../support/themeUtils ./css ./content/tooltipContentFactory ../../../widgets/support/widgetUtils".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g){function m({container:q,contentWidget:z,screenPoint:r,positionMode:D}){const {style:v}=q;"docked"===D?(v.display="block",v.transform="none"):"fixed"!==D&&(null!=r&&null!=z?(v.display="block",q=g.isRTL(q),r=`translate(${Math.round(r.x)+h[0]*(q?-1:1)}px, ${Math.round(r.y)+h[1]}px)`,v.transform=q?`translate(-100%, 0) ${r}`:r):v.display="none")}var n=`${A.base}`;a.Tooltip=class extends l{constructor(q){super(q);this.info=null;this.positionMode="follow-cursor";q=document.createElement("div");
q.classList.add(n);B.setCalciteThemeClass(q);this._contentContainer=q;this._contentWidget=null}initialize(){const q=this._contentContainer;this.addHandles([d.watch(()=>this.view.overlay?.surface,z=>{q.remove();z?.appendChild(q)},d.syncAndInitial),d.watch(()=>this.info,(z,r)=>{if(null!=this._contentWidget&&null!=z&&null!=r&&z.type===r.type)this._contentWidget.info=z;else if(this._contentWidget=e.destroyMaybe(this._contentWidget),z=b.tooltipContentFactory(this,z))this._contentWidget=z,z.container&&
q.appendChild(z.container)},d.syncAndInitial),d.watch(()=>({container:this._contentContainer,contentWidget:this._contentWidget,screenPoint:this._screenPoint,positionMode:this.positionMode}),m,d.syncAndInitial)])}destroy(){this._contentWidget=e.destroyMaybe(this._contentWidget);this._contentContainer.remove()}clear(){this.info=null}get _screenPoint(){const q=this.view.inputManager;return q?.multiTouchActive?null:q?.latestPointerLocation}get test(){return{contentContainer:this._contentContainer,visible:"none"!==
this._contentContainer?.style.display}}};c.__decorate([k.property({nonNullable:!0})],a.Tooltip.prototype,"view",void 0);c.__decorate([k.property()],a.Tooltip.prototype,"info",void 0);c.__decorate([k.property()],a.Tooltip.prototype,"positionMode",void 0);c.__decorate([k.property()],a.Tooltip.prototype,"_contentContainer",void 0);c.__decorate([k.property()],a.Tooltip.prototype,"_contentWidget",void 0);c.__decorate([k.property()],a.Tooltip.prototype,"_screenPoint",null);a.Tooltip=c.__decorate([y.subclass("esri.views.interactive.tooltip.Tooltip")],
a.Tooltip);const h=[20,20];Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/css":function(){define(["exports"],function(a){a.base="esri-tooltip";a.content="esri-tooltip-content";a.contentHeader="esri-tooltip-content__header";a.contentInputMode="esri-tooltip-content--input";a.helpMessage="esri-tooltip-help-message";a.table="esri-tooltip-table";Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/tooltipContentFactory":function(){define("exports ./TooltipContentDrawCircle ./TooltipContentDrawMesh ./TooltipContentDrawPoint ./TooltipContentDrawPolygon ./TooltipContentDrawPolyline ./TooltipContentDrawRectangle ./TooltipContentExtentRotate ./TooltipContentExtentScale ./TooltipContentReshapeEdgeOffset ./TooltipContentTransformAbsolute ./TooltipContentTransformRotate ./TooltipContentTransformScale ./TooltipContentTranslateGraphic ./TooltipContentTranslateGraphicXY ./TooltipContentTranslateGraphicZ ./TooltipContentTranslateVertex ./TooltipContentTranslateVertexXY ./TooltipContentTranslateVertexZ".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m,n,h,q,z){a.tooltipContentFactory=function(r,D){if(null==D)return null;const v=document.createElement("div");switch(D.type){case "draw-point":return new e.TooltipContentDrawPoint({tooltip:r,info:D,container:v});case "draw-polygon":return new d.TooltipContentDrawPolygon({tooltip:r,info:D,container:v});case "draw-polyline":return new k.TooltipContentDrawPolyline({tooltip:r,info:D,container:v});case "draw-mesh":return new l.TooltipContentDrawMesh({tooltip:r,info:D,
container:v});case "draw-rectangle":return new t.TooltipContentDrawRectangle({tooltip:r,info:D,container:v});case "draw-circle":return new c.TooltipContentDrawCircle({tooltip:r,info:D,container:v});case "extent-rotate":return new u.TooltipContentExtentRotate({tooltip:r,info:D,container:v});case "extent-scale":return new f.TooltipContentExtentScale({tooltip:r,info:D,container:v});case "transform-absolute":return new B.TooltipContentTransformAbsolute({tooltip:r,info:D,container:v});case "transform-rotate":return new A.TooltipContentTransformRotate({tooltip:r,
info:D,container:v});case "transform-scale":return new b.TooltipContentTransformScale({tooltip:r,info:D,container:v});case "translate-graphic":return new g.TooltipContentTranslateGraphic({tooltip:r,info:D,container:v});case "translate-graphic-z":return new n.TooltipContentTranslateGraphicZ({tooltip:r,info:D,container:v});case "translate-graphic-xy":return new m.TooltipContentTranslateGraphicXY({tooltip:r,info:D,container:v});case "translate-vertex":return new h.TooltipContentTranslateVertex({tooltip:r,
info:D,container:v});case "translate-vertex-z":return new z.TooltipContentTranslateVertexZ({tooltip:r,info:D,container:v});case "translate-vertex-xy":return new q.TooltipContentTranslateVertexXY({tooltip:r,info:D,container:v});case "reshape-edge-offset":return new y.TooltipContentReshapeEdgeOffset({tooltip:r,info:D,container:v})}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentDrawCircle":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../css ../TooltipContentWithHelpMessage ../TooltipField ../ValueByValue ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m){var n=`${f.content} ${`${f.content}--draw-rectangle`}`;a.TooltipContentDrawCircle=class extends b.TooltipContent{render(){const {area:h,radius:q,xSize:z,ySize:r,tooltipOptions:D}=this.info,{visibleElements:v}=D,I=this._messagesTooltip.sketch;return m.tsx(y.TooltipContentWithHelpMessage,{className:n,helpMessage:this._getHelpMessage()},v.radius&&null!=q?m.tsx(B.TooltipField,{title:I.radius,value:this._formatLength(q)}):null,v.size&&null!=z&&null!=r?m.tsx(B.TooltipField,
{title:I.size,value:m.tsx(A.ValueByValue,{left:this._formatLength(z),right:this._formatLength(r)})}):null,v.area?m.tsx(B.TooltipField,{title:I.area,value:this._formatArea(h)}):null)}};a.TooltipContentDrawCircle=c.__decorate([u.subclass("esri.views.interactive.tooltip.content.TooltipContentDrawCircle")],a.TooltipContentDrawCircle);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/TooltipContentWithHelpMessage":function(){define(["exports","./css","../../../widgets/support/widgetUtils",
"../../../widgets/support/jsxFactory"],function(a,c,l,e){a.TooltipContentWithHelpMessage=function({className:d,helpMessage:k,mode:t,onDiscard:u,onkeydown:f},...y){y=y.flat(10).filter(B=>!!B);return e.tsx("div",{class:l.classes(d,c.content,"input"===t&&c.contentInputMode),onkeydown:f},"input"===t?e.tsx("div",{class:c.contentHeader,key:"tooltip-content-header"},e.tsx("calcite-button",{appearance:"transparent",iconFlipRtl:"both",iconStart:"chevron-left",kind:"neutral",onclick:u,scale:"s",tabIndex:-1})):
null,0<y.length?e.tsx("div",{class:c.table},...y):null,k?e.tsx("div",{class:c.helpMessage,key:"help-message"},k):null)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/TooltipField":function(){define("exports ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./css ../../../widgets/Widget ../../../widgets/support/widgetUtils ../../../widgets/support/jsxFactory".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B){const A=`${u.base}-field`;var b=`${A}--input`,g=`${A}__title`,m=`${A}__value`;a.TooltipField=class extends f{constructor(){super(...arguments);this.hidden=!1;this.mode="feedback"}render(){return B.tsx("div",{class:this.classes({[A]:!0,[b]:"input"===this.mode})},B.tsx("div",{class:g},this.title),B.tsx("div",{class:m},this.value))}};c.__decorate([l.property()],a.TooltipField.prototype,"hidden",void 0);c.__decorate([l.property()],a.TooltipField.prototype,"mode",void 0);
c.__decorate([l.property()],a.TooltipField.prototype,"title",void 0);c.__decorate([l.property()],a.TooltipField.prototype,"value",void 0);a.TooltipField=c.__decorate([t.subclass("esri.views.interactive.tooltip.TooltipField")],a.TooltipField);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/ValueByValue":function(){define("exports ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./css ../../../widgets/Widget ../../../widgets/support/widgetUtils ../../../widgets/support/jsxFactory".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B){var A=`${u.base}-value-by-value`;a.ValueByValue=class extends f{constructor(){super(...arguments);this.divider="\u00d7"}render(){return B.tsx("div",{class:A},B.tsx("span",null,this.left),B.tsx("span",null,this.divider),B.tsx("span",null,this.right))}};c.__decorate([l.property()],a.ValueByValue.prototype,"left",void 0);c.__decorate([l.property()],a.ValueByValue.prototype,"divider",void 0);c.__decorate([l.property()],a.ValueByValue.prototype,"right",void 0);a.ValueByValue=
c.__decorate([t.subclass("esri.views.interactive.tooltip.ValueByValue")],a.ValueByValue);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContent":function(){define("require exports ../../../../chunks/tslib.es6 ../../../../intl ../../../../core/memoize ../../../../core/quantityFormatUtils ../../../../core/reactiveUtils ../../../../core/unitFormatUtils ../../../../core/unitUtils ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/decorators/subclass ../../../../support/getDefaultUnitForView ../../keybindings ../../../../widgets/Widget ../../../../widgets/support/componentsUtils ../../../../widgets/support/widgetUtils ../../../../widgets/support/decorators/messageBundle ../../../../intl/number".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m,n,h,q,z,r,D){c.TooltipContent=class extends h{constructor(){super(...arguments);this._getFormatters=d.memoize((v,I)=>({angle:p=>k.formatAngle(p,p.rotationType),area:(p,w)=>k.formatArea(v,p,w??I.area),length:(p,w,C)=>k.formatLength(v,p,w??I.length,C),relativeLength:(p,w)=>k.formatRelativeLength(v,p,w??I.length),totalLength:(p,w)=>k.formatLength(v,p,w??I.length),verticalLength:(p,w)=>k.formatVerticalLength(v,p,w??I.length),relativeVerticalLength:(p,w)=>k.formatRelativeVerticalLength(v,
p,w??I.verticalLength),relativeOrientation:p=>D.formatNumber(p,{maximumFractionDigits:2,minimumFractionDigits:2,signDisplay:"exceptZero"}),percentage:p=>D.formatNumber(p.value,{style:"percent"}),scale:p=>D.formatNumber(p,{style:"percent",maximumFractionDigits:0})}));this._formatScale=v=>this._formatters.scale(v);this._formatRelativeOrientation=v=>this._formatters.relativeOrientation(v);this._formatLength=(v,I,p)=>this._formatters.length(v,I,p);this._formatRelativeLength=(v,I)=>this._formatters.relativeLength(v,
I);this._formatVerticalLength=(v,I)=>this._formatters.verticalLength(v,I);this._formatRelativeVerticalLength=(v,I)=>this._formatters.relativeVerticalLength(v,I);this._formatArea=(v,I)=>this._formatters.area(v,I);this._formatPercentage=v=>this._formatters.percentage(v);this._onDiscard=()=>{this._exitInputMode()};this._onCommit=(v,I)=>{if("commit-and-exit"===I)return this._exitInputMode();const p=this._getFocusableInputs(),w=p.length;v=p.indexOf(v);if(-1===v)return this._exitInputMode();p.at(((v+("commit-and-next"===
I?1:-1))%w+w)%w)?.focus()};this._handleTab=v=>{if(v.code===n.tooltipKeys.next){var I=this._getFocusableInputs();if(0!==I.length){var p=I.at(0);I=I.at(-1);p&&I&&(v.shiftKey?document.activeElement===p&&(v.preventDefault(),I.focus()):document.activeElement===I&&(v.preventDefault(),p.focus()))}}}}get _displayUnits(){const v=m.getDefaultUnitForView(this.tooltip.view);return{length:v,verticalLength:v,area:v,angle:"degrees"}}get _inputUnitInfos(){const v=this._messagesUnits,I=F=>({unit:F,abbreviation:u.unitName(v,
F,"abbr")});var p=m.getDefaultUnitForView(this.tooltip.view);const w=f.defaultLengthUnit(p),C=f.defaultVerticalLengthUnit(p);p=f.defaultAreaUnit(p);return{length:I(w),relativeLength:I(w),verticalLength:I(C),relativeVerticalLength:I(C),area:I(p),orientation:I("degrees"),rotation:I("degrees")}}get _formatters(){return this._getFormatters(this._messagesUnits,this._displayUnits)}get fieldContext(){return{formatters:this._formatters,inputUnitInfos:this._inputUnitInfos,messages:this._messagesTooltip,onCommit:this._onCommit,
onDiscard:this._onDiscard}}initialize(){let v=new AbortController;this.addHandles([t.watch(()=>this.info.mode,I=>{this.tooltip.positionMode="input"===I?"fixed":"follow-cursor"}),t.on(()=>this.info,"focus",()=>{v?.abort();const {signal:I}=v=new AbortController;requestAnimationFrame(()=>{I.aborted||this._getFocusableInputs().at(0)?.focus()})})])}loadDependencies(){return q.loadCalciteComponents({button:()=>new Promise((v,I)=>a(["../../../../chunks/calcite-button"],v,I)),icon:()=>new Promise((v,I)=>
a(["../../../../chunks/calcite-icon"],v,I)),input:()=>new Promise((v,I)=>a(["../../../../chunks/calcite-input"],v,I))})}_getHelpMessage(v){const {info:I}=this,{tooltipOptions:p,helpMessage:w,viewType:C}=I;v=v??w;return p?.visibleElements?.helpMessage&&v?this._messagesTooltip?.sketch?.["3d"===C?"helpMessages3d":"helpMessages2d"]?.[v]:void 0}_exitInputMode(){this.info.exitInputMode();document.querySelector(".esri-view-surface").focus()}_getFocusableInputs(){return Array.from(this.domNode?.querySelectorAll("input:not([disabled])")??
[])}};l.__decorate([r.messageBundle("esri/core/t9n/Units"),y.property()],c.TooltipContent.prototype,"_messagesUnits",void 0);l.__decorate([r.messageBundle("esri/views/interactive/tooltip/t9n/Tooltip"),y.property()],c.TooltipContent.prototype,"_messagesTooltip",void 0);l.__decorate([y.property()],c.TooltipContent.prototype,"info",void 0);l.__decorate([y.property()],c.TooltipContent.prototype,"tooltip",void 0);l.__decorate([y.property()],c.TooltipContent.prototype,"_displayUnits",null);l.__decorate([y.property()],
c.TooltipContent.prototype,"_inputUnitInfos",null);l.__decorate([y.property()],c.TooltipContent.prototype,"_formatters",null);l.__decorate([y.property()],c.TooltipContent.prototype,"fieldContext",null);c.TooltipContent=l.__decorate([g.subclass("esri.views.interactive.tooltip.content.TooltipContent")],c.TooltipContent);Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentDrawMesh":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../css ../TooltipContentWithHelpMessage ../TooltipField ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g){var m=`${f.content}--draw-mesh`;a.TooltipContentDrawMesh=class extends A.TooltipContent{render(){const {elevation:n,tooltipOptions:h}=this.info,{visibleElements:q}=h,z=this._messagesTooltip.sketch;return g.tsx(y.TooltipContentWithHelpMessage,{className:m,helpMessage:this._getHelpMessage()},q.elevation?g.tsx(B.TooltipField,{title:z.elevation,value:this._formatVerticalLength(n.actual)}):null)}};a.TooltipContentDrawMesh=c.__decorate([u.subclass("esri.views.interactive.tooltip.content.TooltipContentDrawMesh")],
a.TooltipContentDrawMesh);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentDrawPoint":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../css ../TooltipContentWithHelpMessage ./Fields ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g){var m=`${f.content}--draw-point`;a.TooltipContentDrawPoint=class extends A.TooltipContent{render(){const {fieldContext:n,info:h}=this,{mode:q,elevation:z,tooltipOptions:r}=h,{visibleElements:D}=r;return g.tsx(y.TooltipContentWithHelpMessage,{className:m,helpMessage:this._getHelpMessage(),mode:q,onkeydown:this._handleTab,onDiscard:this._onDiscard},g.tsx(B.Fields,{context:n,fields:[D.elevation?z:void 0],mode:q}))}};a.TooltipContentDrawPoint=c.__decorate([u.subclass("esri.views.interactive.tooltip.content.TooltipContentDrawPoint")],
a.TooltipContentDrawPoint);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/Fields":function(){define(["exports","../TooltipEditableField","../../../../widgets/support/jsxFactory"],function(a,c,l){a.Fields=function(e){const d=e.fields.filter(k=>null!=k&&!k.hidden);return 0===d.length?null:l.tsx(l.tsxFragment,null,d.map(k=>l.tsx(c.TooltipEditableField,{context:e.context,field:k,key:k.id,mode:e.mode})))};Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/views/interactive/tooltip/TooltipEditableField":function(){define("require exports ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../keybindings ./css ../../../widgets/Widget ../../../widgets/support/componentsUtils ../../../widgets/support/widgetUtils ../../../widgets/support/jsxFactory".split(" "),function(a,
c,l,e,d,k,t,u,f,y,B,A,b,g){const m=`${y.base}-editable-field`;var n=`${m}--input`,h=`${m}--locked`,q=`${m}__title`,z=`${m}__title__content`,r=`${m}__value`,D=`${m}__value__content`,v=`${m}__input`,I=`${m}__input--disabled`,p=`${m}__input--read-only`,w=`${m}__input-suffix`,C=`${m}__button`;c.TooltipEditableField=class extends B{constructor(){super(...arguments);this._input=null;this._afterInputCreate=F=>{this._input=F};this._selectText=()=>{requestAnimationFrame(()=>{this._input?.select()})};this._onKeyDown=
F=>{F.key===f.tooltipKeys.discard&&this._discard()};this._onInputKeyDown=F=>{switch(F.key){case f.tooltipKeys.commit:return this._commit({type:"commit-and-exit",allowLockingCurrentValue:!0});case f.tooltipKeys.next:return F.stopPropagation(),this._commit({type:F.shiftKey?"commit-and-previous":"commit-and-next",allowLockingCurrentValue:!1})}};this._onInput=F=>{this.field.inputValue=F.target.value};this._onLockClick=()=>{const {field:F}=this;F.locked?F.unlock():this._lock()}}loadDependencies(){return A.loadCalciteComponents({button:()=>
new Promise((F,G)=>a(["../../../chunks/calcite-button"],F,G)),icon:()=>new Promise((F,G)=>a(["../../../chunks/calcite-icon"],F,G))})}render(){const {mode:F,field:G}=this,J="input"===F,{locked:L}=G;return g.tsx("div",{class:this.classes({[m]:!0,[n]:"input"===F,[h]:L})},g.tsx("div",{class:q,key:"title"},g.tsx("div",{class:z,key:"title-content"},this._title,L&&!J?g.tsx("calcite-icon",{icon:"lock",key:"icon",scale:"s"}):null)),g.tsx("div",{class:r,key:"value"},J?this._renderInput():g.tsx("span",{key:"formatted-value"},
this._feedbackValue)))}get _initialValue(){const {field:F}=this;return null!=F.actual?F.toInputUnits(F.actual,this.context).value:null}get _feedbackValue(){const {context:F,field:G}=this,{actual:J,committed:L,format:x}=G;return null!=L?x(L,F):null!=J?x(J,F):""}get _displayValue(){const {field:F}=this,{inputValue:G,committed:J}=F;return null!=G?G:null!=J?this._toString(F.toInputUnits(J,this.context).value):this._toString(this._initialValue)}get _suffix(){const {suffix:F}=this.field;return"string"===
typeof F?F:F(this.context)}get _title(){const {title:F}=this.field;return"string"===typeof F?F:F(this.context)}_renderInput(){const {disabled:F,locked:G,readOnly:J}=this.field;return g.tsx("div",{class:D,key:"input-container",onkeydown:this._onKeyDown},g.tsx("input",{afterCreate:this._afterInputCreate,class:this.classes({[v]:!0,[I]:F,[p]:J}),disabled:F||J,onfocus:this._selectText,oninput:this._onInput,onkeydown:this._onInputKeyDown,readOnly:J,type:"text",value:this._displayValue}),g.tsx("div",{class:w,
key:"suffix"},this._suffix),J?void 0:g.tsx("calcite-button",{appearance:"transparent",class:C,disabled:F,iconStart:G?"lock":"unlock",kind:"neutral",onclick:this._onLockClick,scale:"s",tabIndex:-1}))}_commit({type:F,allowLockingCurrentValue:G}){const {_input:J,field:L}=this;J&&(L.locked&&""===L.inputValue?L.unlock():(G||null!=L.inputValue)&&this._lock(),this.context.onCommit(J,F))}_discard(){this._input&&(this.field.inputValue=null,this.context.onDiscard(this._input))}_lock(){const {field:F}=this;
var G=this._parseNumber(F.inputValue);G=null!=G?F.createQuantity(G,this.context):null;F.lock(G)}_parseNumber(F){if(null==F)return null;F=parseFloat(F);return isNaN(F)||!isFinite(F)?null:F}_toString(F){return null!=F?F.toFixed(3):"0"}};l.__decorate([e.property()],c.TooltipEditableField.prototype,"field",void 0);l.__decorate([e.property()],c.TooltipEditableField.prototype,"context",void 0);l.__decorate([e.property()],c.TooltipEditableField.prototype,"mode",void 0);l.__decorate([e.property()],c.TooltipEditableField.prototype,
"_initialValue",null);l.__decorate([e.property()],c.TooltipEditableField.prototype,"_feedbackValue",null);l.__decorate([e.property()],c.TooltipEditableField.prototype,"_input",void 0);l.__decorate([e.property()],c.TooltipEditableField.prototype,"_displayValue",null);l.__decorate([e.property()],c.TooltipEditableField.prototype,"_suffix",null);l.__decorate([e.property()],c.TooltipEditableField.prototype,"_title",null);c.TooltipEditableField=l.__decorate([u.subclass("esri.views.interactive.tooltip.TooltipEditableField")],
c.TooltipEditableField);Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentDrawPolygon":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../css ../TooltipContentWithHelpMessage ./Fields ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g){var m=`${f.content} ${`${f.content}--draw-polygon`}`;a.TooltipContentDrawPolygon=class extends A.TooltipContent{render(){const {fieldContext:n,info:h}=this,{area:q,distance:z,elevation:r,mode:D,orientation:v,tooltipOptions:I,viewType:p}=h,{inputEnabled:w,visibleElements:C}=I;return g.tsx(y.TooltipContentWithHelpMessage,{className:m,helpMessage:this._getHelpMessage(),mode:D,onkeydown:this._handleTab,onDiscard:this._onDiscard},g.tsx(B.Fields,{context:n,fields:[w&&
C.orientation?v:void 0,w&&C.distance?z:void 0,C.elevation&&"2d"!==p?r:void 0,C.area?q:void 0],mode:D}))}};a.TooltipContentDrawPolygon=c.__decorate([u.subclass("esri.views.interactive.tooltip.content.TooltipContentDrawPolygon")],a.TooltipContentDrawPolygon);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentDrawPolyline":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../css ../TooltipContentWithHelpMessage ./Fields ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g){var m=`${f.content} ${`${f.content}--draw-polyline`}`;a.TooltipContentDrawPolyline=class extends A.TooltipContent{render(){const {fieldContext:n,info:h}=this,{distance:q,elevation:z,mode:r,orientation:D,tooltipOptions:v,totalLength:I,viewType:p}=h,{inputEnabled:w,visibleElements:C}=v;return g.tsx(y.TooltipContentWithHelpMessage,{className:m,helpMessage:this._getHelpMessage(),mode:r,onkeydown:this._handleTab,onDiscard:this._onDiscard},g.tsx(B.Fields,{context:n,
fields:[w&&C.orientation?D:void 0,w&&C.distance?q:void 0,C.elevation&&"2d"!==p?z:void 0,C.totalLength?I:void 0],mode:r}))}};a.TooltipContentDrawPolyline=c.__decorate([u.subclass("esri.views.interactive.tooltip.content.TooltipContentDrawPolyline")],a.TooltipContentDrawPolyline);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentDrawRectangle":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../css ../TooltipContentWithHelpMessage ../TooltipField ../ValueByValue ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m){var n=`${f.content} ${`${f.content}--draw-rectangle`}`;a.TooltipContentDrawRectangle=class extends b.TooltipContent{render(){const {area:h,xSize:q,ySize:z,tooltipOptions:r}=this.info,{visibleElements:D}=r,v=this._messagesTooltip.sketch;return m.tsx(y.TooltipContentWithHelpMessage,{className:n,helpMessage:this._getHelpMessage()},D.size&&null!=q&&null!=z?m.tsx(B.TooltipField,{title:v.size,value:m.tsx(A.ValueByValue,{left:this._formatLength(q),right:this._formatLength(z)})}):
null,D.area?m.tsx(B.TooltipField,{title:v.area,value:this._formatArea(h)}):null)}};a.TooltipContentDrawRectangle=c.__decorate([u.subclass("esri.views.interactive.tooltip.content.TooltipContentDrawRectangle")],a.TooltipContentDrawRectangle);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentExtentRotate":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../css ../TooltipContentWithHelpMessage ../TooltipField ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g){var m=`${f.content} ${`${f.content}--extent-rotate`}`;a.TooltipContentExtentRotate=class extends A.TooltipContent{render(){const {angle:n,tooltipOptions:h}=this.info,{visibleElements:q}=h,z=this._messagesTooltip.sketch;return g.tsx(y.TooltipContentWithHelpMessage,{className:m,helpMessage:this._getHelpMessage()},q.rotation?g.tsx(B.TooltipField,{title:z.rotation,value:this._formatRelativeOrientation(n)}):null)}};a.TooltipContentExtentRotate=c.__decorate([u.subclass("esri.views.interactive.tooltip.content.TooltipContentExtentRotate")],
a.TooltipContentExtentRotate);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentExtentScale":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../css ../TooltipContentWithHelpMessage ../TooltipField ../ValueByValue ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m){var n=`${f.content} ${`${f.content}--extent-scale`}`;a.TooltipContentExtentScale=class extends b.TooltipContent{render(){const h=this.info,{visibleElements:q}=h.tooltipOptions,z=this._messagesTooltip.sketch;return m.tsx(y.TooltipContentWithHelpMessage,{className:n,helpMessage:this._getHelpMessage()},q.size?m.tsx(B.TooltipField,{title:z.size,value:m.tsx(A.ValueByValue,{left:this._formatLength(h.xSize),right:this._formatLength(h.ySize)})}):null,q.scale?m.tsx(B.TooltipField,
{title:z.scale,value:m.tsx(A.ValueByValue,{left:this._formatScale(h.xScale),right:this._formatScale(h.yScale)})}):null)}};a.TooltipContentExtentScale=c.__decorate([u.subclass("esri.views.interactive.tooltip.content.TooltipContentExtentScale")],a.TooltipContentExtentScale);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentReshapeEdgeOffset":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../css ../TooltipContentWithHelpMessage ../TooltipField ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g){var m=`${f.content} ${`${f.content}--reshape-edge-offset`}`;a.TooltipContentReshapeEdgeOffset=class extends A.TooltipContent{render(){const {area:n,distance:h,totalLength:q,tooltipOptions:z}=this.info,{visibleElements:r}=z,D=this._messagesTooltip.sketch;return g.tsx(y.TooltipContentWithHelpMessage,{className:m,helpMessage:this._getHelpMessage()},r.distance?g.tsx(B.TooltipField,{title:D.distance,value:this._formatRelativeLength(h)}):null,r.area&&null!=n?g.tsx(B.TooltipField,
{title:D.area,value:this._formatArea(n)}):null,r.totalLength&&null!=q?g.tsx(B.TooltipField,{title:D.totalLength,value:this._formatLength(q)}):null)}};a.TooltipContentReshapeEdgeOffset=c.__decorate([u.subclass("esri.views.interactive.tooltip.content.TooltipContentReshapeEdgeOffset")],a.TooltipContentReshapeEdgeOffset);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentTransformAbsolute":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/quantityFormatUtils ../../../../core/Logger ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../css ../TooltipContentWithHelpMessage ../TooltipField ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m){var n=`${y.content} ${`${y.content}--transform-absolute`}`;a.TooltipContentTransformAbsolute=class extends b.TooltipContent{render(){const {info:h}=this,{visibleElements:q}=h.tooltipOptions,z=this._messagesTooltip.sketch;return m.tsx(B.TooltipContentWithHelpMessage,{className:n,helpMessage:this._getHelpMessage()},q.orientation&&null!=h.orientation?m.tsx(A.TooltipField,{key:"orientation",title:z.orientation,value:l.formatAngle(h.orientation,h.rotationType,h.orientationPrecision)}):
null,q.size&&null!=h.size?m.tsx(A.TooltipField,{key:"size",title:z.size,value:this._formatLength(h.size,h.sizeUnit,h.sizePrecision)}):null)}};a.TooltipContentTransformAbsolute=c.__decorate([f.subclass("esri.views.interactive.tooltip.content.TooltipContentTransformAbsolute")],a.TooltipContentTransformAbsolute);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentTransformRotate":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/quantityFormatUtils ../../../../core/Logger ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../css ../TooltipContentWithHelpMessage ../TooltipField ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m){var n=`${y.content} ${`${y.content}--transform-rotate`}`;a.TooltipContentTransformRotate=class extends b.TooltipContent{render(){const {info:h}=this,{visibleElements:q}=h.tooltipOptions,z=this._messagesTooltip.sketch;return m.tsx(B.TooltipContentWithHelpMessage,{className:n,helpMessage:this._getHelpMessage()},q.rotation&&null!=h.rotation?m.tsx(A.TooltipField,{key:"rotation",title:z.rotation,value:l.formatRelativeAngle(h.rotation,h.rotationType,h.rotationPrecision)}):
null,q.orientation&&null!=h.orientation?m.tsx(A.TooltipField,{key:"orientation",title:z.orientation,value:l.formatAngle(h.orientation,h.rotationType,h.orientationPrecision)}):null)}};a.TooltipContentTransformRotate=c.__decorate([f.subclass("esri.views.interactive.tooltip.content.TooltipContentTransformRotate")],a.TooltipContentTransformRotate);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentTransformScale":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../css ../TooltipContentWithHelpMessage ../TooltipField ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g){var m=`${f.content} ${`${f.content}--transform-scale`}`;a.TooltipContentTransformScale=class extends A.TooltipContent{render(){const {info:n}=this,{visibleElements:h}=n.tooltipOptions,q=this._messagesTooltip.sketch;return g.tsx(y.TooltipContentWithHelpMessage,{className:m,helpMessage:this._getHelpMessage()},h.scale&&null!=n.scale?g.tsx(B.TooltipField,{key:"scale",title:q.scale,value:this._formatPercentage(n.scale)}):null,h.size&&null!=n.size?g.tsx(B.TooltipField,
{key:"size",title:q.size,value:this._formatLength(n.size,n.sizeUnit,n.sizePrecision)}):null)}};a.TooltipContentTransformScale=c.__decorate([u.subclass("esri.views.interactive.tooltip.content.TooltipContentTransformScale")],a.TooltipContentTransformScale);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentTranslateGraphic":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../css ../TooltipContentWithHelpMessage ../TooltipField ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g){var m=`${f.content} ${`${f.content}--translate-graphic`}`;a.TooltipContentTranslateGraphic=class extends A.TooltipContent{render(){const {info:n}=this,{visibleElements:h}=n.tooltipOptions,q=this._messagesTooltip.sketch;return g.tsx(y.TooltipContentWithHelpMessage,{className:m,helpMessage:this._getHelpMessage()},h.distance?g.tsx(B.TooltipField,{title:q.distance,value:this._formatLength(n.distance)}):null)}};a.TooltipContentTranslateGraphic=c.__decorate([u.subclass("esri.views.interactive.tooltip.content.TooltipContentTranslateGraphic")],
a.TooltipContentTranslateGraphic);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentTranslateGraphicXY":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../css ../TooltipContentWithHelpMessage ../TooltipField ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g){var m=`${f.content} ${`${f.content}--translate-graphic-xy`}`;a.TooltipContentTranslateGraphicXY=class extends A.TooltipContent{render(){const {info:n}=this,{visibleElements:h}=n.tooltipOptions,q=this._messagesTooltip.sketch;return g.tsx(y.TooltipContentWithHelpMessage,{className:m,helpMessage:this._getHelpMessage()},h.distance?g.tsx(B.TooltipField,{title:q.distance,value:this._formatRelativeLength(n.distance)}):null)}};a.TooltipContentTranslateGraphicXY=c.__decorate([u.subclass("esri.views.interactive.tooltip.content.TooltipContentTranslateGraphicXY")],
a.TooltipContentTranslateGraphicXY);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentTranslateGraphicZ":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../css ../TooltipContentWithHelpMessage ../TooltipField ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g){var m=`${f.content} ${`${f.content}--translate-graphic-z`}`;a.TooltipContentTranslateGraphicZ=class extends A.TooltipContent{render(){const {info:n}=this,{visibleElements:h}=n.tooltipOptions,q=this._messagesTooltip.sketch;return g.tsx(y.TooltipContentWithHelpMessage,{className:m,helpMessage:this._getHelpMessage()},h.distance?g.tsx(B.TooltipField,{title:q.distance,value:this._formatRelativeVerticalLength(n.distance)}):null)}};a.TooltipContentTranslateGraphicZ=
c.__decorate([u.subclass("esri.views.interactive.tooltip.content.TooltipContentTranslateGraphicZ")],a.TooltipContentTranslateGraphicZ);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentTranslateVertex":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../css ../TooltipContentWithHelpMessage ../TooltipField ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g){var m=`${f.content} ${`${f.content}--translate-vertex`}`;a.TooltipContentTranslateVertex=class extends A.TooltipContent{render(){const {distance:n,elevation:h,area:q,totalLength:z,tooltipOptions:r}=this.info,{visibleElements:D}=r,v=this._messagesTooltip.sketch;return g.tsx(y.TooltipContentWithHelpMessage,{className:m,helpMessage:this._getHelpMessage()},D.distance?g.tsx(B.TooltipField,{title:v.distance,value:this._formatLength(n)}):null,D.elevation&&null!=h?g.tsx(B.TooltipField,
{title:v.elevation,value:this._formatVerticalLength(h.actual)}):null,D.area&&null!=q?g.tsx(B.TooltipField,{title:v.area,value:this._formatArea(q)}):null,D.totalLength&&null!=z?g.tsx(B.TooltipField,{title:v.totalLength,value:this._formatLength(z)}):null)}};a.TooltipContentTranslateVertex=c.__decorate([u.subclass("esri.views.interactive.tooltip.content.TooltipContentTranslateVertex")],a.TooltipContentTranslateVertex);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentTranslateVertexXY":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../css ../TooltipContentWithHelpMessage ../TooltipField ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g){var m=`${f.content} ${`${f.content}--translate-vertex`}`;a.TooltipContentTranslateVertexXY=class extends A.TooltipContent{render(){const {area:n,distance:h,elevation:q,totalLength:z,tooltipOptions:r}=this.info,{visibleElements:D}=r,v=this._messagesTooltip.sketch;return g.tsx(y.TooltipContentWithHelpMessage,{className:m,helpMessage:this._getHelpMessage()},D.distance?g.tsx(B.TooltipField,{title:v.distance,value:this._formatRelativeLength(h)}):null,D.elevation&&
null!=q?g.tsx(B.TooltipField,{title:v.elevation,value:this._formatVerticalLength(q.actual)}):null,D.area&&null!=n?g.tsx(B.TooltipField,{title:v.area,value:this._formatArea(n)}):null,D.totalLength&&null!=z?g.tsx(B.TooltipField,{title:v.totalLength,value:this._formatLength(z)}):null)}};a.TooltipContentTranslateVertexXY=c.__decorate([u.subclass("esri.views.interactive.tooltip.content.TooltipContentTranslateVertexXY")],a.TooltipContentTranslateVertexXY);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/views/interactive/tooltip/content/TooltipContentTranslateVertexZ":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../css ../TooltipContentWithHelpMessage ../TooltipField ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),function(a,c,l,e,
d,k,t,u,f,y,B,A,b,g){var m=`${f.content} ${`${f.content}--translate-vertex`}`;a.TooltipContentTranslateVertexZ=class extends A.TooltipContent{render(){const {distance:n,elevation:h,tooltipOptions:q}=this.info,{visibleElements:z}=q,r=this._messagesTooltip.sketch;return g.tsx(y.TooltipContentWithHelpMessage,{className:m,helpMessage:this._getHelpMessage()},z.distance?g.tsx(B.TooltipField,{title:r.distance,value:this._formatRelativeVerticalLength(n)}):null,z.elevation&&null!=h?g.tsx(B.TooltipField,{title:r.elevation,
value:this._formatVerticalLength(h.actual)}):null)}};a.TooltipContentTranslateVertexZ=c.__decorate([u.subclass("esri.views.interactive.tooltip.content.TooltipContentTranslateVertexZ")],a.TooltipContentTranslateVertexZ);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/automaticAreaMeasurementUtils":function(){define(["exports","./euclideanAreaMeasurementUtils","./geodesicAreaMeasurementUtils"],function(a,c,l){function e(d,k,t=c.createEuclideanPlanarAreaCache()){return"on-the-ground"===
k?(k=l.geodesicArea(d),null!=k?k:c.euclideanHorizontalPlanarArea(d,t)):c.euclideanPlanarArea(d,t)}a.autoArea2D=function(d,k=c.createEuclideanPlanarAreaCache()){return e(d,"on-the-ground",k)};a.autoAreaByElevationMode=e;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/euclideanAreaMeasurementUtils":function(){define("exports ../../core/quantityUtils ../../core/unitUtils ../../chunks/earcut ../../chunks/vec3 ../../chunks/vec3f64 ../../geometry/projection/projectVectorToVector ../../geometry/support/plane ../../geometry/support/triangle ./measurementUtils".split(" "),
function(a,c,l,e,d,k,t,u,f,y){function B(n,h,q=n.hasZ){const z=y.computeEuclideanMeasurementSR(n.spatialReference),r=l.areaUnitFromSpatialReference(z);if(null==r)return null;let D=0;for(const F of n.rings){var v=F.length;if(3>v)continue;const {positionsWorldCoords:G}=h;for(;G.length<v;)G.push(k.create());var I=g,p=d.set(m,0,0,0),w=1/v;for(let J=0;J<v;J++){var C=F[J];2>C.length?C=!1:(d.set(I,C[0],C[1],q?C[2]||0:0),C=!0);if(!C||!t.projectVectorToVector(I,n.spatialReference,G[J],z))return null;d.scaleAndAdd(p,
p,G[J],w)}I=u.fromPoints(G[0],G[1],p,u.wrap());if(0!==d.squaredLength(u.normal(I))){for(w=0;w<v;w++)u.projectPointLocal(I,p,G[w],G[w]);v=b(G);for(p=0;p<v.length;p+=3)D+=f.areaPoints2d(G[v[p]],G[v[p+1]],G[v[p+2]])}}return c.createArea(D,r)}function A(){return{positionsWorldCoords:[]}}function b(n){var h=e.earcut;const q=new Float64Array(2*n.length);for(let z=0;z<n.length;++z){const r=n[z],D=2*z;q[D]=r[0];q[D+1]=r[1]}return h.call(e,q,[],2)}const g=k.create(),m=k.create();a.computeEuclideanPlanarArea=
B;a.createEuclideanPlanarAreaCache=A;a.euclideanHorizontalPlanarArea=function(n,h=A()){return B(n,h,!1)};a.euclideanPlanarArea=function(n,h=A()){return B(n,h)};a.triangulate=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/geodesicAreaMeasurementUtils":function(){define("exports ../../geometry ../../core/quantityUtils ../../geometry/geometryEngine ../../geometry/projection/projectPolygonToWGS84ComparableLonLat ../../geometry/support/geodesicUtils ./geodesicMeasurementUtils ../../geometry/SpatialReference".split(" "),
function(a,c,l,e,d,k,t,u){function f(A){return l.createArea(Math.abs(k.geodesicAreas([A],"square-meters")[0]),"square-meters")}function y(A){try{return l.createArea(Math.abs(e.geodesicArea(A,"square-meters")),"square-meters")}catch(b){return null}}function B(A){const b=[];return d.projectPolygonToWGS84ComparableLonLat(A,b)?l.createArea(Math.abs(k.geodesicAreas([{type:"polygon",rings:b,spatialReference:u.WGS84}],"square-meters")[0]),"square-meters"):null}a.geodesicArea=function(A){const {spatialReference:b}=
A;return t.geodesicMeasure(b,f,y,B,A)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/projection/projectPolygonToWGS84ComparableLonLat":function(){define(["exports","../../chunks/vec3","../../chunks/vec3f64","./projectors"],function(a,c,l,e){const d=l.create();a.projectPolygonToWGS84ComparableLonLat=function({hasZ:k,spatialReference:t,rings:u},f,y=0){t=e.getWGS84ComparableLonLatProjector(t);if(null==t)return!1;k=k?B=>B:B=>c.set(d,B[0],B[1],y);for(const B of u){u=[];
for(const A of B){const b=[0,0,y];t(k(A),0,b,0);u.push(b)}f.push(u)}return!0};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/draw/DrawOperation":function(){define("exports ../../chunks/tslib.es6 ../../core/Accessor ../../core/Evented ../../core/lang ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/screenUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/diffUtils ../../core/support/UpdatingHandles ../../layers/graphics/dehydratedFeatureComparison ../../support/elevationInfoUtils ../ViewingMode ./DrawingMode ./DrawManipulator ../interactive/coordinateHelper ../interactive/dragEventPipeline ../interactive/editGeometry/EditGeometry ../interactive/editGeometry/EditGeometryOperations ../interactive/sketch/normalizedPoint ../interactive/sketch/SketchLabelOptions ../interactive/sketch/SketchTooltipOptions ../interactive/snapping/SnappingContext ../interactive/snapping/SnappingDragPipelineStep ../interactive/snapping/SnappingOperation ../interactive/snapping/snappingUtils".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m,n,h,q,z,r,D,v,I,p,w,C,F,G,J,L){a.DrawOperation=class extends e.EventedMixin(l){constructor(x){super(x);this._hideDefaultCursor=this._createOperationCompleted=!1;this._pointerDownStates=new Set;this._stagedPointerId=this._stagedPointerType=this._stagedScreenPoint=null;this._updatingHandles=new g.UpdatingHandles;this.constraint=void 0;this.isDraped=!0;this.labelOptions=new w;this.tooltipOptions=new C;this.cursor=null;this.loading=!1;this.lastVertex=this.snapToSceneEnabled=
null;null==x.elevationInfo&&(this.elevationInfo=n.getEffectiveElevationInfo(!!x.hasZ))}initialize(){const {geometryType:x,view:H}=this,K=H.spatialReference,E="viewingMode"in H.state?H.state.viewingMode:h.ViewingMode.Local,M="segment"===x||"multipoint"===x?"polyline":x;this.coordinateHelper=r.createCoordinateHelper(this.hasZ,this.hasM,K);this._editGeometryOperations=new I.EditGeometryOperations(new v.EditGeometry(M,this.coordinateHelper));this._snappingOperation=new J.SnappingOperation({view:H,constrainResult:U=>
U?this._getEffectiveDrawSurface()?.constrainZ(U):void 0});this.addHandles([u.watch(()=>this.stagedVertex,U=>{null!=U&&this.emit("cursor-update",{updated:null,vertices:[{componentIndex:0,vertexIndex:this._activeComponent.vertices.length,coordinates:this.coordinateHelper.pointToArray(U)}],operation:"apply",type:"vertex-update"})},{sync:!0,equals:(U,ba)=>k.equalsMaybe(U,ba,m.pointEquals)}),u.watch(()=>this.view.viewpoint,(U,ba)=>{U&&ba&&b.diff(U,ba)&&this._onViewpointChange()})]);this._activeComponent=
new v.Component(K,E);this._editGeometryOperations.data.components.push(this._activeComponent);const O=this.segmentLabels;null!=O&&(O.context={view:H,editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,labelOptions:this.labelOptions},this.addHandles([u.watch(()=>this.labelOptions.enabled,U=>{O.visible=U},u.syncAndInitial),this.on("cursor-update",()=>{const U=this.stagedVertex;O.stagedVertex=null!=U?this.coordinateHelper.pointToVector(U):null})]));this.addHandles(this._editGeometryOperations.on(["vertex-add",
"vertex-update","vertex-remove"],U=>{const ba=U.vertices.map(fa=>({componentIndex:0,vertexIndex:fa.index,coordinates:this.coordinateHelper.vectorToArray(fa.pos)})),la=ba.map(fa=>fa.coordinates);switch(U.type){case "vertex-add":this.emit(U.type,{...U,added:la,vertices:ba});break;case "vertex-update":this.emit(U.type,{...U,updated:la,vertices:ba});break;case "vertex-remove":this.emit(U.type,{...U,removed:la,vertices:ba})}U=this._activeComponent.getLastVertex();U=null!=U?this.coordinateHelper.vectorToDehydratedPoint(U.pos):
null;null!=U&&null!=this.lastVertex&&m.pointEquals(this.lastVertex,U)||(this.lastVertex=U)}));const T=this._manipulator=new z.DrawManipulator({grabbableForEvent:U=>"click"!==this.drawingMode?!0:"touch"===U.pointerType&&this._snappingEnabled&&1===this._pointerDownStates.size});this.manipulators.add(T);T.grabbable="point"!==x;this.addHandles([this._createManipulatorDragPipeline(T),T.events.on("immediate-click",U=>this._onImmediateClick(U)),T.events.on("immediate-double-click",U=>this._onImmediateDoubleClick(U)),
u.watch(()=>({effectiveCursor:this.effectiveCursor}),({effectiveCursor:U})=>{T.cursor=U},u.syncAndInitial)]);L.setupSnappingToggleHandles(this,()=>{const U=this._getSnappingContext(this.view.inputManager.latestPointerType??"mouse");null!=this.snappingManager&&this._updatingHandles.addPromise(t.ignoreAbortErrors(this._snappingOperation.resnap(this.snappingManager,U)))})}destroy(){k.destroyMaybe(this.segmentLabels);k.destroyMaybe(this._snappingOperation);this._editGeometryOperations=k.destroyMaybe(this._editGeometryOperations);
this._updatingHandles.destroy()}get _snappingEnabled(){return null!=this.snappingManager&&this.snappingManager.options.effectiveEnabled}get _requiresScenePoint(){const x=this._getEffectiveDrawSurface();return"3d"===this.view.type&&this.drawSurface!==x}get canRedo(){return this._editGeometryOperations.canRedo}get canUndo(){return this._editGeometryOperations.canUndo}get committedVertices(){return this._activeComponent.vertices.map(x=>this.coordinateHelper.vectorToArray(x.pos))}set drawingMode(x){this._set("drawingMode",
x??q.defaultDrawingMode)}get effectiveCursor(){return this.loading?"progress":this._hideDefaultCursor?null:this.cursor||"crosshair"}get interactive(){return this._manipulator.interactive}set interactive(x){this._manipulator.interactive=x}get isCompleted(){return this._createOperationCompleted}get numCommittedVertices(){return this._activeComponent.vertices.length}get numVertices(){return null!=this.stagedVertex?this._activeComponent.vertices.length+1:this._activeComponent.vertices.length}get snappingOptions(){return null!=
this.snappingManager?this.snappingManager.options:null}get stagedVertex(){const x=this._snappingOperation.stagedPoint,{constraint:H,elevationInfo:K,view:E}=this;if(!x||!H)return x;var M=p.fromPoint(x,E,K);return(M=M?H.closestTo(M):void 0)?p.toDehydratedPoint(M,x.spatialReference):x}set stagedVertex(x){this._snappingOperation.stagedPoint=d.clone(x)}get updating(){return this._updatingHandles.updating}get vertices(){const x=this.committedVertices;null!=this.stagedVertex&&x.push(this.coordinateHelper.pointToArray(this.stagedVertex));
return x}cancel(){this.complete({aborted:!0})}commitStagedVertex(){this._snappingOperation.abort();if(null!=this.stagedVertex){const {stagedVertex:x}=this;this.stagedVertex=null;this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(x))}}complete(x){x=x&&x.aborted||!1;this._snappingOperation.abort();null!=this.snappingManager&&this.snappingManager.doneSnapping();"segment"===this.geometryType||"point"===this.geometryType?this.commitStagedVertex():this.stagedVertex=null;this._createOperationCompleted=
!("multipoint"===this.geometryType&&0===this.numVertices||"polyline"===this.geometryType&&2>this.numVertices||"polygon"===this.geometryType&&3>this.numVertices);(this.isCompleted||x)&&this.emit("complete",{vertices:this.vertices.map((H,K)=>({componentIndex:0,vertexIndex:K,coordinates:H})),aborted:x,type:"complete"})}onInputEvent(x){switch(x.type){case "pointer-down":this._pointerDownStates.add(x.pointerId);break;case "pointer-up":this._pointerDownStates.delete(x.pointerId)}switch(x.type){case "pointer-move":return this._onPointerMove(x);
case "hold":return this._onHold(x)}}redo(){this._editGeometryOperations.redo()}undo(){null!=this.snappingManager&&this.snappingManager.doneSnapping();this._editGeometryOperations.undo()}_closeOnClickVertexIndex(x){const H=this._activeComponent;if("polygon"===this.geometryType&&2<H.vertices.length){if(this._vertexWithinPointerDistance(H.vertices[0].pos,x))return 0;if(this._vertexWithinPointerDistance(H.vertices[H.vertices.length-1].pos,x))return H.vertices.length-1}return null}_createManipulatorDragPipeline(x){switch(this.drawingMode){case "click":return this._createManipulatorDragPipelineClick(x);
case "freehand":return this._createManipulatorDragPipelineFreehand(x);case "hybrid":return this._createManipulatorDragPipelineHybrid(x)}}_createManipulatorDragPipelineClick(x){return D.createManipulatorDragEventPipeline(x,(H,K,E,M)=>{const O="touch"===M&&this._snappingEnabled;if(!this.isCompleted&&O){var {snappingStep:T,cancelSnapping:U}=G.createSnapDragEventPipelineStep({predicate:()=>O,snappingManager:this.snappingManager,snappingContext:new F.SnappingContext({editGeometryOperations:this._editGeometryOperations,
elevationInfo:this.elevationInfo,feature:this.graphic,pointer:M,visualizer:this.snappingVisualizer}),updatingHandles:this._updatingHandles,useZ:!this._requiresScenePoint});E=E.next(ba=>{O&&null!=this.snappingManager&&this.snappingManager.doneSnapping();return ba}).next(U);K.next(this._screenToMapDragEventStep()).next(ba=>{"start"===ba.action&&(this.stagedVertex=ba.mapStart,("segment"===this.geometryType||O&&0===this.numVertices)&&this.commitStagedVertex());return ba}).next(D.sceneSnappingAtLocation(this.view,
this.elevationInfo)).next(...T).next(ba=>{O&&(this.stagedVertex=ba.mapEnd,"end"===ba.action&&this.commitStagedVertex());return ba}).next(ba=>{"end"!==ba.action||"segment"!==this.geometryType&&"point"!==this.geometryType||this.complete();return ba})}})}_createManipulatorDragPipelineFreehand(x){return D.createManipulatorDragEventPipeline(x,(H,K)=>{this.isCompleted||K.next(this._screenToMapDragEventStep()).next(E=>{"start"===E.action&&(null==this.stagedVertex&&(this.stagedVertex=E.mapStart),"segment"===
this.geometryType&&this.commitStagedVertex());return E}).next(E=>{switch(E.action){case "start":case "update":this.stagedVertex=E.mapEnd;"polygon"!==this.geometryType&&"polyline"!==this.geometryType||this.commitStagedVertex();break;case "end":this.complete()}return E})})}_createManipulatorDragPipelineHybrid(x){return D.createManipulatorDragEventPipeline(x,(H,K)=>{this.isCompleted||K.next(this._screenToMapDragEventStep()).next(E=>{"start"===E.action&&(null==this.stagedVertex&&(this.stagedVertex=E.mapStart),
this.commitStagedVertex());return E}).next(E=>{switch(E.action){case "start":case "update":this.stagedVertex=E.mapEnd;"polygon"!==this.geometryType&&"polyline"!==this.geometryType||this.commitStagedVertex();break;case "end":"segment"!==this.geometryType&&"point"!==this.geometryType||this.complete()}return E})})}get _drawAtFixedElevation(){return("segment"===this.geometryType||"polygon"===this.geometryType)&&0<this.numCommittedVertices}_getEffectiveDrawSurface(){if(null==this.elevationDrawSurface)return this.drawSurface;
if(!this.coordinateHelper.hasZ())return this.elevationDrawSurface.defaultZ=null,this.elevationDrawSurface;let x=this.defaultZ,H=!1;null!=this.elevationInfo&&"absolute-height"===this.elevationInfo.mode&&(H=!0);null!=this.snapToSceneEnabled&&(H=this.snapToSceneEnabled);null!=this.elevationInfo&&"on-the-ground"===this.elevationInfo.mode&&(H=!1);this._drawAtFixedElevation&&(x=this.coordinateHelper.getZ(this._activeComponent.vertices[0].pos),H=!1);if(H)return this.drawSurface;this.elevationDrawSurface.defaultZ=
x;return this.elevationDrawSurface}_mapToScreen(x){return this._getEffectiveDrawSurface()?.mapToScreen(x)}_onHold(x){this._snappingOperation.abort();"click"===this.drawingMode&&"touch"===x.pointerType&&this._snappingEnabled&&(this.stagedVertex=x.mapPoint);x.stopPropagation()}_onImmediateClick(x){if(!("mouse"===x.pointerType&&2===x.button||this._manipulator.dragging)){var H=this._activeComponent;if(null!=this._closeOnClickVertexIndex(x.screenPoint))x.stopPropagation(),this.complete();else{var K=this._screenToMap(x.screenPoint);
if(null!=K)switch(this.drawingMode){case "freehand":"point"===this.geometryType&&(null!=this.stagedVertex?this.commitStagedVertex():this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(K)),this.complete());break;case "click":case "hybrid":this._snappingOperation.abort(),null!=this.stagedVertex?this.commitStagedVertex():this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(K)),("point"===this.geometryType||"segment"===this.geometryType&&2===H.vertices.length||
"segment"===this.geometryType&&"hybrid"===this.drawingMode&&1===H.vertices.length)&&this.complete()}x.stopPropagation()}}}_onImmediateDoubleClick(x){this._manipulator.dragging||"point"===this.geometryType||(this.complete(),x.stopPropagation())}_onPointerMove(x){const H=f.createScreenPoint(x.x,x.y);this._stagedScreenPoint=H;this._stagedPointerType=x.pointerType;this._stagedPointerId=x.pointerId;const K=this._snappingOperation,E=this._manipulator;this._pointerDownStates.has(x.pointerId)||E.grabbing||
!E.interactive?K.abort():(x.stopPropagation(),this._updateStagedVertexOnPointerMove(H,x.pointerType))}_onViewpointChange(){const x=this._manipulator;"mouse"!==this._stagedPointerType||!this._stagedScreenPoint||null==this._stagedPointerId||this._pointerDownStates.has(this._stagedPointerId)||x.grabbing||!x.interactive?this._snappingOperation.abort():this._updateStagedVertexOnPointerMove(this._stagedScreenPoint,this._stagedPointerType??"mouse")}_updateStagedVertexOnPointerMove(x,H){const K=this._snappingOperation;
var E=this._closeOnClickVertexIndex(x);if(null!=E)this._closeOnVertex(E),K.abort();else if(E=this._screenToMap(x),x=this._requiresScenePoint?this.drawSurface?.screenToMap(x):null,null==E)this._hideDefaultCursor=!0,K.abort();else{this._hideDefaultCursor=!1;var M=this.snappingManager;null==M?(this.stagedVertex=E,K.abort()):(H=this._getSnappingContext(H),this._updatingHandles.addPromise(t.ignoreAbortErrors(K.snap({point:E,scenePoint:x},M,H))))}}_closeOnVertex(x){this.stagedVertex=null;x={componentIndex:0,
vertexIndex:x,coordinates:this.coordinateHelper.vectorToArray(this._activeComponent.vertices[x].pos)};this.emit("cursor-update",{updated:null,vertices:[x],operation:"apply",type:"vertex-update"})}_screenToMap(x){return this._getEffectiveDrawSurface()?.screenToMap(x)}_screenToMapDragEventStep(){let x=null;return H=>{"start"===H.action&&(x=this._screenToMap(H.screenStart));if(null==x)return null;const K=this._screenToMap(H.screenEnd);return null!=K?{...H,mapStart:x,mapEnd:K}:null}}_vertexWithinPointerDistance(x,
H){const K=this._mapToScreen(this.coordinateHelper.vectorToDehydratedPoint(x));null!=K?(x=K.x-H.x,H=K.y-H.y,H=25>=x*x+H*H):H=!1;return H}_getSnappingContext(x){const H=this._drawAtFixedElevation?this.elevationDrawSurface?.defaultZ:null;return new F.SnappingContext({editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,pointer:x,feature:this.graphic,visualizer:this.snappingVisualizer,selfSnappingZ:null!=H?{value:H,elevationInfo:this.elevationInfo}:null})}};c.__decorate([y.property()],
a.DrawOperation.prototype,"_hideDefaultCursor",void 0);c.__decorate([y.property()],a.DrawOperation.prototype,"_snappingOperation",void 0);c.__decorate([y.property()],a.DrawOperation.prototype,"_snappingEnabled",null);c.__decorate([y.property({constructOnly:!0})],a.DrawOperation.prototype,"graphic",void 0);c.__decorate([y.property()],a.DrawOperation.prototype,"constraint",void 0);c.__decorate([y.property()],a.DrawOperation.prototype,"defaultZ",void 0);c.__decorate([y.property()],a.DrawOperation.prototype,
"isDraped",void 0);c.__decorate([y.property({value:q.defaultDrawingMode})],a.DrawOperation.prototype,"drawingMode",null);c.__decorate([y.property({constructOnly:!0})],a.DrawOperation.prototype,"elevationDrawSurface",void 0);c.__decorate([y.property({constructOnly:!0})],a.DrawOperation.prototype,"elevationInfo",void 0);c.__decorate([y.property({constructOnly:!0,type:w})],a.DrawOperation.prototype,"labelOptions",void 0);c.__decorate([y.property({constructOnly:!0,type:C})],a.DrawOperation.prototype,
"tooltipOptions",void 0);c.__decorate([y.property({constructOnly:!0})],a.DrawOperation.prototype,"geometryType",void 0);c.__decorate([y.property({constructOnly:!0})],a.DrawOperation.prototype,"hasM",void 0);c.__decorate([y.property({constructOnly:!0})],a.DrawOperation.prototype,"hasZ",void 0);c.__decorate([y.property()],a.DrawOperation.prototype,"cursor",void 0);c.__decorate([y.property()],a.DrawOperation.prototype,"effectiveCursor",null);c.__decorate([y.property()],a.DrawOperation.prototype,"loading",
void 0);c.__decorate([y.property({constructOnly:!0})],a.DrawOperation.prototype,"manipulators",void 0);c.__decorate([y.property({constructOnly:!0})],a.DrawOperation.prototype,"drawSurface",void 0);c.__decorate([y.property({constructOnly:!0})],a.DrawOperation.prototype,"segmentLabels",void 0);c.__decorate([y.property({constructOnly:!0})],a.DrawOperation.prototype,"snappingManager",void 0);c.__decorate([y.property({constructOnly:!0})],a.DrawOperation.prototype,"snappingVisualizer",void 0);c.__decorate([y.property()],
a.DrawOperation.prototype,"snapToSceneEnabled",void 0);c.__decorate([y.property()],a.DrawOperation.prototype,"stagedVertex",null);c.__decorate([y.property()],a.DrawOperation.prototype,"lastVertex",void 0);c.__decorate([y.property()],a.DrawOperation.prototype,"updating",null);c.__decorate([y.property({constructOnly:!0})],a.DrawOperation.prototype,"view",void 0);a.DrawOperation=c.__decorate([A.subclass("esri.views.draw.DrawOperation")],a.DrawOperation);a.defaultCursor="crosshair";a.defaultLoadingCursor=
"progress";Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/draw/DrawingMode":function(){define(["exports"],function(a){a.defaultDrawingMode="click";a.drawingModes=["freehand","hybrid","click"];Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/draw/DrawManipulator":function(){define(["exports","../../core/Evented"],function(a,c){class l{constructor({grabbableForEvent:e}){this.events=new c;this.interactive=!0;this.selectable=!1;this.cursor=null;
this.consumesClicks=this.grabbable=!0;this.grabbableForEvent=e}destroy(){}intersectionDistance(e,d){return 0}attach(){}detach(){}onElevationChange(){}onViewChange(){}}a.DrawManipulator=l;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/coordinateHelper":function(){define("exports ../../chunks/vec2 ../../chunks/vec2f64 ../../chunks/vec3 ../../chunks/vec3f64 ../../chunks/vec4 ../../chunks/vec4f64 ../../geometry/Point".split(" "),function(a,c,l,e,d,k,t,u){var f;
(function(b){b[b.Z=0]="Z";b[b.M=1]="M"})(f||(f={}));class y{constructor(b){this.spatialReference=b}createVector(){return this._tag(l.create())}pointToVector(b){return this._tag(l.fromValues(b.x,b.y))}arrayToVector(b){return this._tag(l.fromValues(b[0],b[1]))}vectorToArray(b){return[b[0],b[1]]}pointToArray(b){return[b.x,b.y]}vectorToPoint(b,g=new u){g.x=b[0];g.y=b[1];g.z=void 0;g.m=void 0;g.spatialReference=this.spatialReference;return g}arrayToPoint(b,g=new u){g.x=b[0];g.y=b[1];g.z=void 0;g.m=void 0;
g.spatialReference=this.spatialReference;return g}vectorToDehydratedPoint(b,g={x:void 0,y:void 0,z:void 0,m:void 0,hasZ:void 0,hasM:void 0,spatialReference:void 0,type:"point"}){g.x=b[0];g.y=b[1];g.z=void 0;g.m=void 0;g.hasZ=!1;g.hasM=!1;g.spatialReference=this.spatialReference;return g}lerp(b,g,m,n){return c.lerp(n,b,g,m)}addDelta(b,g,m){b[0]+=g;b[1]+=m}distance(b,g){return c.distance(b,g)}getZ(b,g){return g}hasZ(){return!1}getM(b,g){return g}hasM(){return!1}clone(b){return this._tag(l.fromArray(b))}copy(b,
g){return c.copy(g,b)}fromXYZ(b){return this._tag(l.fromValues(b[0],b[1]))}toXYZ(b,g=d.create()){return e.set(g,b[0],b[1],0)}pointToXYZ(b,g=d.create()){return e.set(g,b.x,b.y,0)}equals(b,g){return c.equals(b,g)}_tag(b){return b}}class B{constructor(b,g){this._valueType=b;this.spatialReference=g}createVector(){return this._tag(d.create())}pointToVector(b){return this._tag(d.fromValues(b.x,b.y,this._valueType===f.Z?b.z:b.m))}arrayToVector(b){return this._tag(d.fromValues(b[0],b[1],b[2]||0))}vectorToArray(b){return[b[0],
b[1],b[2]]}pointToArray(b){return this._valueType===f.Z?[b.x,b.y,b.z]:[b.x,b.y,b.m]}vectorToPoint(b,g=new u){g.x=b[0];g.y=b[1];g.z=this._valueType===f.Z?b[2]:void 0;g.m=this._valueType===f.M?b[2]:void 0;g.spatialReference=this.spatialReference;return g}arrayToPoint(b,g=new u){g.x=b[0];g.y=b[1];g.z=this._valueType===f.Z?b[2]:void 0;g.m=this._valueType===f.M?b[2]:void 0;g.spatialReference=this.spatialReference;return g}vectorToDehydratedPoint(b,g={x:void 0,y:void 0,z:void 0,m:void 0,hasZ:void 0,hasM:void 0,
spatialReference:void 0,type:"point"}){const m=this._valueType===f.Z,n=this._valueType===f.M;g.x=b[0];g.y=b[1];g.z=m?b[2]:void 0;g.m=n?b[2]:void 0;g.hasZ=m;g.hasM=n;g.spatialReference=this.spatialReference;return g}lerp(b,g,m,n){return e.lerp(n,b,g,m)}addDelta(b,g,m,n){b[0]+=g;b[1]+=m;this._valueType===f.Z&&(b[2]+=n)}distance(b,g){return this._valueType===f.Z?e.distance(b,g):c.distance(b,g)}getZ(b,g){return this._valueType===f.Z?b[2]:g}hasZ(){return this._valueType===f.Z}getM(b,g){return this._valueType===
f.M?b[2]:g}hasM(){return this._valueType===f.M}clone(b){return this._tag(d.fromArray(b))}copy(b,g){return e.copy(g,b)}fromXYZ(b,g=0,m=0){return this._tag(d.fromValues(b[0],b[1],this._valueType===f.Z?2<b.length?b[2]:g:m))}toXYZ(b,g=d.create()){return e.set(g,b[0],b[1],this._valueType===f.Z?b[2]:0)}pointToXYZ(b,g=d.create()){return e.set(g,b.x,b.y,this._valueType===f.Z?b.z??0:0)}equals(b,g){return e.equals(b,g)}_tag(b){return b}}class A{constructor(b){this.spatialReference=b}createVector(){return this._tag(t.create())}pointToVector(b){return this._tag(t.fromValues(b.x,
b.y,b.z,b.m))}arrayToVector(b){return this._tag(t.fromValues(b[0],b[1],b[2]||0,b[3]||0))}vectorToArray(b){return[b[0],b[1],b[2],b[3]]}pointToArray(b){return[b.x,b.y,b.z,b.m]}vectorToPoint(b,g=new u){g.x=b[0];g.y=b[1];g.z=b[2];g.m=b[3];g.spatialReference=this.spatialReference;return g}arrayToPoint(b,g=new u){g.x=b[0];g.y=b[1];g.z=b[2];g.m=b[3];g.spatialReference=this.spatialReference;return g}vectorToDehydratedPoint(b,g={x:void 0,y:void 0,z:void 0,m:void 0,hasZ:void 0,hasM:void 0,spatialReference:void 0,
type:"point"}){g.x=b[0];g.y=b[1];g.z=b[2];g.m=b[3];g.hasZ=!0;g.hasM=!0;g.spatialReference=this.spatialReference;return g}lerp(b,g,m,n){return k.lerp(n,b,g,m)}addDelta(b,g,m,n){b[0]+=g;b[1]+=m;b[2]+=n}distance(b,g){return e.distance(b,g)}getZ(b){return b[2]}hasZ(){return!0}getM(b){return b[3]}hasM(){return!0}clone(b){return this._tag(t.fromArray(b))}copy(b,g){return k.copy(g,b)}fromXYZ(b,g=0,m=0){return this._tag(t.fromValues(b[0],b[1],2<b.length?b[2]:g,m))}toXYZ(b,g=d.create()){return e.set(g,b[0],
b[1],b[2])}pointToXYZ(b,g=d.create()){return e.set(g,b.x,b.y,b.z??0)}equals(b,g){return k.equals(b,g)}_tag(b){return b}}a.CoordinateHelper2D=y;a.CoordinateHelper3D=B;a.CoordinateHelper4D=A;a.createCoordinateHelper=function(b,g,m){return b&&g?new A(m):g?new B(f.M,m):b?new B(f.Z,m):new y(m)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/dragEventPipeline":function(){define("exports ../../geometry ../../core/arrayUtils ../../core/has ../../core/lang ../../core/mathUtils ../../core/screenUtils ../../chunks/vec3f64 ../../geometry/projection ../../layers/graphics/hydratedFeatures ../../layers/graphics/sources/interfaces ../../support/elevationInfoUtils ../ViewingMode ../draw/support/drawUtils ../../geometry/Point".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m){function n(G,J){let L=null,x=null;return H=>{if("cancel"===H.action)null!=x&&(x.execute({action:"cancel"}),x=L=null);else{var K={action:H.action,screenStart:H.start,screenEnd:H.screenPoint};"start"===H.action&&null==L&&(L=new F,x=new F,J(G,L,x,H.pointerType,K));null!=L&&L.execute(K);"end"===H.action&&null!=L&&(x=L=null)}}}function h(G,J){let L=null;return x=>{"start"===x.action&&(L=z(G,x.mapStart.spatialReference,J));if(null==L)return null;const H=x.mapEnd.x-
x.mapStart.x,K=x.mapEnd.y-x.mapStart.y,E=x.mapEnd.z-x.mapStart.z;L.move(H,K,E,x.action);return{...x,translationX:H,translationY:K,translationZ:E}}}function q(G,J){return null==G?null:G.spatialReference.equals(J)?G.clone():f.project(G,J)}function z(G,J,L){const x=G.geometry;J=y.hydratedSpatialReference(J);if(null==x)return null;if("mesh"===x.type)return r(G,x,J,L);const H=q(x,J),K=x.spatialReference;return null==H?null:{move:(E,M,O)=>{E=g.move(H.clone(),E,M,O);E.spatialReference.equals(K)?G.geometry=
E:G.geometry=f.project(E,K)}}}function r(G,J,L,x){if(J.vertexSpace.isRelative)return D(G,J,J.vertexSpace,L);if(!J.spatialReference.equals(L))return null;let H=0,K=0,E=0;return{move:(M,O,T)=>{var U=M-H;const ba=O-K,la=T-E;if(U||ba||la)U=new m(J.origin.x+U,J.origin.y+ba,(J.origin.z??0)+la,J.origin.spatialReference),J.centerAt(U,{geographic:J.vertexSpace.isRelative?void 0:x===b.ViewingMode.Global}),G.notifyGeometryChanged(),H=M,K=O,E=T}}}function D(G,J,L,x){const H=L.getOriginPoint(J.spatialReference),
K=q(H,x),E=J.spatialReference;return null==K?null:{move:(M,O,T,U)=>{M=g.move(K.clone(),M,O,T);M.spatialReference.equals(E)?L.setOriginFromPoint(M):(M=f.project(M,E),null!=M&&L.setOriginFromPoint(M));L.isGeoreferenced?G.notifyGeometryChanged():G.notifyMeshTransformChanged("end"===U?{action:B.MeshTransformUpdateAction.UpdateFastLocalOrigin}:{})}}}function v(G,J){const L=new Map;for(const x of J)L.set(x,d.clone(G[x]));return x=>{L.forEach((H,K)=>{G[K]=H});return x}}function I(G){return null!=G.geometry&&
"mesh"===G.geometry.type?p(G,G.geometry):v(G,["geometry"])}function p(G,J){const {vertexSpace:L}=J;if(L.isGeoreferenced){const K=J.vertexAttributes.clonePositional();return E=>{J.vertexAttributes=K;G.notifyGeometryChanged();return E}}const x=u.clone(L.origin),H=J.transform?.clone();return K=>{J.transform=H;J.vertexSpace.origin=x;G.notifyMeshTransformChanged();return K}}function w(G,J,L){const x=J.elevationProvider.getElevation(G.x,G.y,G.z??0,G.spatialReference,"scene")??0;G=y.clonePoint(G);G.z=x;
G.hasZ=!0;G.z=A.getZForElevationMode(G,J,L);return G}const C=()=>{};class F{constructor(){this.execute=C}next(G,J=new F){null!=G&&(this.execute=L=>{L=G(L);null!=L&&J.execute(L)});return J}}a.EventPipeline=F;a.addMapDelta=function(){let G=0,J=0,L=0;return x=>{"start"===x.action&&(G=x.mapStart.x,J=x.mapStart.y,L=x.mapStart.z);const H=x.mapEnd.x-G,K=x.mapEnd.y-J,E=x.mapEnd.z-L;G=x.mapEnd.x;J=x.mapEnd.y;L=x.mapEnd.z;return{...x,mapDeltaX:H,mapDeltaY:K,mapDeltaZ:E,mapDeltaSpatialReference:x.mapStart.spatialReference}}};
a.addScreenDelta=function(){let G=0,J=0;return L=>{"start"===L.action&&(G=L.screenStart.x,J=L.screenStart.y);const x=L.screenEnd.x-G,H=L.screenEnd.y-J;G=L.screenEnd.x;J=L.screenEnd.y;return{...L,screenDeltaX:x,screenDeltaY:H}}};a.constrainToMapAxis=function(G,J){const L=[G.x,G.y,G.z??0],x=[Math.cos(J),Math.sin(J)];G=Math.sqrt(x[0]*x[0]+x[1]*x[1]);if(0===G)return null;x[0]/=G;x[1]/=G;const H=K=>{const E=(K.x-L[0])*x[0]+(K.y-L[1])*x[1];K.x=L[0]+E*x[0];K.y=L[1]+E*x[1]};return K=>{H(K.mapStart);H(K.mapEnd);
return{...K,axis:x}}};a.createDragEventPipelineCallback=n;a.createManipulatorDragEventPipeline=function(G,J){return G.events.on("drag",n(G,J))};a.dragAtLocation=function(G,J){let L=null,x=0,H=0;return K=>{"start"===K.action&&(L=G.toScreen?.(J),null!=L&&(0>L.x||L.x>G.width||0>L.y||L.y>G.height?L=null:(x=K.screenStart.x-L.x,H=K.screenStart.y-L.y)));if(null==L)return null;var E=k.clamp(K.screenEnd.x-x,0,G.width);const M=k.clamp(K.screenEnd.y-H,0,G.height);E=t.createScreenPoint(E,M);K.screenStart=L;K.screenEnd=
E;return K}};a.dragGraphic=h;a.dragGraphicMany=function(G,J){const L=G.map(x=>h(x,J)).filter(l.isSome);return x=>{const H=x.mapEnd.x-x.mapStart.x,K=x.mapEnd.y-x.mapStart.y,E=x.mapEnd.z-x.mapStart.z;L.forEach(M=>M(x));return{...x,translationX:H,translationY:K,translationZ:E}}};a.resetGraphic=I;a.resetGraphicMany=function(G){const J=G.map(L=>I(L)).filter(L=>null!=L);return L=>{J.forEach(x=>x(L));return L}};a.resetProperties=v;a.sceneSnappingAtLocation=function(G,J,L=[]){if("2d"===G.type)return H=>H;
let x=null;return H=>{"start"===H.action&&(x=G.toMap(H.screenStart,{exclude:L}),null!=x&&(x.z=A.getZForElevationMode(x,G,J)));const K=G.toMap(H.screenEnd,{exclude:L});null!=K&&(K.z=A.getZForElevationMode(K,G,J));return{...H,scenePoints:null!=x&&null!=K?{sceneStart:x,sceneEnd:K}:null}}};a.sceneSnappingAtProjectedLocation=function(G,J){if("2d"===G.type)return x=>x;let L=null;return x=>{"start"===x.action&&(L=w(x.mapStart,G,J));const H=w(x.mapEnd,G,J);return{...x,scenePoints:null!=L&&null!=H?{sceneStart:L,
sceneEnd:H}:null}}};a.screenToMap=function(G,J=null,L){let x=null;const H=null==J||G.spatialReference?.equals(J)?E=>E:E=>null!=E?f.project(E,J):E,K={exclude:[],...L};return E=>{"start"===E.action&&(x=H(G.toMap(E.screenStart,K)));if(null==x)return null;const M=H(G.toMap(E.screenEnd,K));return null!=M?{...E,mapStart:x,mapEnd:M}:null}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/draw/support/drawUtils":function(){define(["exports","../../../core/mathUtils","../../../geometry/support/aaBoundingRect",
"../../../geometry/support/boundsUtils","../../../geometry/support/coordsUtils"],function(a,c,l,e,d){function k(f,y,B,A){null==A||f.hasZ||(A=void 0);if("point"===f.type)return f.x+=y,f.y+=B,f.hasZ&&null!=A&&(f.z+=A),f;if("multipoint"===f.type){var b=f.points;for(var g=0;g<b.length;g++)b[g]=t(b[g],y,B,A);return f}if("extent"===f.type)return f.xmin+=y,f.xmax+=y,f.ymin+=B,f.ymax+=B,null!=A&&(f.zmin??(f.zmin=0),f.zmin+=A,f.zmax??(f.zmax=0),f.zmax+=A),f;b=d.geometryToCoordinates(f);g="polyline"===f.type?
f.paths:f.rings;for(let m=0;m<b.length;m++){const n=b[m];for(let h=0;h<n.length;h++)n[h]=t(n[h],y,B,A)}"paths"in f?f.paths=g:f.rings=g;return f}function t(f,y,B,A){return u(f,f[0]+y,f[1]+B,null!=f[2]&&null!=A?f[2]+A:void 0)}function u(f,y,B,A){y=[y,B];2<f.length&&y.push(null!=A?A:f[2]);3<f.length&&y.push(f[3]);return y}a.cloneMove=function(f,y,B,A,b){f=f.clone();var g=A.resolution;if("point"===f.type)return b?k(f,y*g,-B*g):(b=A.state.transform,A=A.state.inverseTransform,g=b[0]*f.x+b[2]*f.y+b[4],b=
b[1]*f.x+b[3]*f.y+b[5],f.x=A[0]*(g+y)+A[2]*(b+B)+A[4],f.y=A[1]*(g+y)+A[3]*(b+B)+A[5]),f;if("multipoint"===f.type){if(b)k(f,y*g,-B*g);else{b=f.points;g=A.state.transform;A=A.state.inverseTransform;for(var m=0;m<b.length;m++){var n=b[m],h=g[0]*n[0]+g[2]*n[1]+g[4],q=g[1]*n[0]+g[3]*n[1]+g[5];b[m]=u(n,A[0]*(h+y)+A[2]*(q+B)+A[4],A[1]*(h+y)+A[3]*(q+B)+A[5],void 0)}}return f}if("extent"===f.type)return b?k(f,y*g,-B*g):(b=A.state.transform,A=A.state.inverseTransform,g=b[0]*f.xmin+b[2]*f.ymin+b[4],m=b[1]*f.xmin+
b[3]*f.ymin+b[5],n=b[0]*f.xmax+b[2]*f.ymax+b[4],b=b[1]*f.xmax+b[3]*f.ymax+b[5],f.xmin=A[0]*(g+y)+A[2]*(m+B)+A[4],f.ymin=A[1]*(g+y)+A[3]*(m+B)+A[5],f.xmax=A[0]*(n+y)+A[2]*(b+B)+A[4],f.ymax=A[1]*(n+y)+A[3]*(b+B)+A[5]),f;if(b)k(f,y*g,-B*g);else{b=d.geometryToCoordinates(f);g="polyline"===f.type?f.paths:f.rings;m=A.state.transform;A=A.state.inverseTransform;for(n=0;n<b.length;n++)for(h=b[n],q=0;q<h.length;q++){const z=h[q],r=m[0]*z[0]+m[2]*z[1]+m[4],D=m[1]*z[0]+m[3]*z[1]+m[5];h[q]=u(z,A[0]*(r+y)+A[2]*
(D+B)+A[4],A[1]*(r+y)+A[3]*(D+B)+A[5],void 0)}"paths"in f?f.paths=g:f.rings=g}return f};a.getRotationAngle=function(f,y,B,A=!1){f=Math.atan2(y.y-B.y,y.x-B.x)-Math.atan2(f.y-B.y,f.x-B.x);f=Math.atan2(Math.sin(f),Math.cos(f));return A?f:c.rad2deg(f)};a.getScaleRatio=function(f,y,B,A,b,g){return Math.sqrt((b-f)*(b-f)+(g-y)*(g-y))/Math.sqrt((B-f)*(B-f)+(A-y)*(A-y))};a.move=k;a.scale=function(f,y,B,A){if("point"===f.type){const {x:D,y:v}=f;var b=A?A[0]:D,g=A?A[1]:v;f=f.clone();f.x=(D-b)*y+b;f.y=(v-g)*
B+g;return f}if("multipoint"===f.type){b=d.geometryToCoordinates(f);g=l.create();const [D,v,I,p]=e.getRingsOrPathsBounds(g,[b]);b=A?A[0]:(D+I)/2;g=A?A[1]:(p+v)/2;f=f.clone();A=f.points;for(var m=0;m<A.length;m++){var n=A[m];const [w,C]=n;A[m]=u(n,(w-b)*y+b,(C-g)*B+g,void 0)}return f}if("extent"===f.type){const {xmin:D,xmax:v,ymin:I,ymax:p}=f;b=A?A[0]:(D+v)/2;g=A?A[1]:(p+I)/2;f=f.clone();f.xmin=(D-b)*y+b;f.ymax=(p-g)*B+g;f.xmax=(v-b)*y+b;f.ymin=(I-g)*B+g;f.xmin>f.xmax&&(y=f.xmin,f.xmin=f.xmax,f.xmax=
y);f.ymin>f.ymax&&(y=f.ymin,f.ymin=f.ymax,f.ymax=y);return f}b=d.geometryToCoordinates(f);g=l.create();const [h,q,z,r]=e.getRingsOrPathsBounds(g,b);g=A?A[0]:(h+z)/2;A=A?A[1]:(r+q)/2;f=f.clone();m="polyline"===f.type?f.paths:f.rings;for(n=0;n<b.length;n++){const D=b[n];for(let v=0;v<D.length;v++){const I=D[v],[p,w]=I;m[n][v]=u(I,(p-g)*y+g,(w-A)*B+A,void 0)}}"paths"in f?f.paths=m:f.rings=m;return f};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/EditGeometry":function(){define("exports ../../../core/arrayUtils ../../../core/Evented ../../../geometry/Polygon ../../../geometry/Polyline ../coordinateHelper ./unnormalizationHelper".split(" "),
function(a,c,l,e,d,k,t){class u{constructor(A){this.component=A;this.rightEdge=this.leftEdge=null;this.type="vertex";this.index=null}get pos(){return this._pos}set pos(A){this._pos=A;this.component.unnormalizeVertexPositions()}}class f{constructor(A,b,g){this.component=A;this.leftVertex=b;this.rightVertex=g;this.type="edge";b.rightEdge=this;g.leftEdge=this}}class y{constructor(A,b){this._spatialReference=A;this._viewingMode=b;this.vertices=[];this.edges=[];this.index=null}unnormalizeVertexPositions(){1>=
this.vertices.length||t.unnormalize(this.vertices,t.getUnnormalizationInfo(this._spatialReference,this._viewingMode))}updateVertexIndex(A,b){if(0!==this.vertices.length){var g=this.vertices[0],m=null;do m=A,m.index=b++,A=m.rightEdge?m.rightEdge.rightVertex:null;while(null!=A&&A!==g);m.leftEdge&&m!==this.vertices[this.vertices.length-1]&&this.swapVertices(this.vertices.indexOf(m),this.vertices.length-1)}}getFirstVertex(){return 0===this.vertices.length?null:this.vertices[0]}getLastVertex(){return 0===
this.vertices.length?null:this.vertices[this.vertices.length-1]}isClosed(){return 2<this.vertices.length&&null!==this.vertices[0].leftEdge}swapVertices(A,b){const g=this.vertices[A];this.vertices[A]=this.vertices[b];this.vertices[b]=g}iterateVertices(A){if(0!==this.vertices.length){var b=this.vertices[0],g=b;do A(g,g.index),g=null!=g.rightEdge?g.rightEdge.rightVertex:null;while(g!==b&&null!=g)}}}class B extends l{constructor(A,b){super();this.type=A;this.coordinateHelper=b;this._geometry=null;this._dirty=
!0;this.components=[]}get geometry(){if(this._dirty){switch(this.type){case "point":this._geometry=this._toPoint();break;case "polyline":this._geometry=this._toPolyline();break;case "polygon":this._geometry=this._toPolygon()}this._dirty=!1}return this._geometry}get spatialReference(){return this.coordinateHelper.spatialReference}notifyChanges(A){this._dirty=!0;this.emit("change",A)}_toPoint(){return 0===this.components.length||0===this.components[0].vertices.length?null:this.coordinateHelper.vectorToPoint(this.components[0].vertices[0].pos)}_toPolyline(){const A=
[],b=this.coordinateHelper.vectorToArray;for(const g of this.components){if(1>g.vertices.length)continue;const m=[];let n=g.vertices.find(q=>null==q.leftEdge);const h=n;do m.push(b(n.pos)),n=n.rightEdge?n.rightEdge.rightVertex:null;while(n&&n!==h);A.push(m)}return new d({paths:A,spatialReference:this.spatialReference,hasZ:this.coordinateHelper.hasZ(),hasM:this.coordinateHelper.hasM()})}_toPolygon(){const A=[],b=this.coordinateHelper.vectorToArray;for(const g of this.components){if(1>g.vertices.length)continue;
const m=[],n=g.vertices[0];let h=n;const q=h;do m.push(b(h.pos)),h=null!=h.rightEdge?h.rightEdge.rightVertex:null;while(h&&h!==q);g.isClosed()&&m.push(b(n.pos));A.push(m)}return new e({rings:A,spatialReference:this.spatialReference,hasZ:this.coordinateHelper.hasZ(),hasM:this.coordinateHelper.hasM()})}static fromGeometry(A,b){var g=A.spatialReference;const m=k.createCoordinateHelper(A.hasZ,A.hasM,g),n=new B(A.type,m);switch(A.type){case "polygon":A=A.rings;for(var h=0;h<A.length;++h){var q=A[h],z=
new y(g,b);z.index=h;var r=2<q.length&&c.equals(q[0],q[q.length-1]),D=r?q.length-1:q.length;for(var v=0;v<D;++v){var I=m.arrayToVector(q[v]);const p=new u(z);z.vertices.push(p);p.pos=I;p.index=v}q=z.vertices.length-1;for(D=0;D<q;++D)v=new f(z,z.vertices[D],z.vertices[D+1]),z.edges.push(v);r&&(r=new f(z,z.vertices[z.vertices.length-1],z.vertices[0]),z.edges.push(r));n.components.push(z)}break;case "polyline":A=A.paths;for(h=0;h<A.length;++h){r=A[h];z=new y(g,b);z.index=h;q=r.length;for(D=0;D<q;++D)v=
m.arrayToVector(r[D]),I=new u(z),z.vertices.push(I),I.pos=v,I.index=D;r=z.vertices.length-1;for(q=0;q<r;++q)D=new f(z,z.vertices[q],z.vertices[q+1]),z.edges.push(D);n.components.push(z)}break;case "point":b=new y(g,b),b.index=0,g=new u(b),g.index=0,g.pos=m.pointToVector(A),b.vertices.push(g),n.components.push(b)}return n}}a.Component=y;a.Edge=f;a.EditGeometry=B;a.Vertex=u;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/unnormalizationHelper":function(){define(["exports",
"../../../geometry/support/spatialReferenceUtils","../../ViewingMode"],function(a,c,l){a.getUnnormalizationInfo=function(e,d){e=c.getInfo(e);return d===l.ViewingMode.Global&&e?{supported:!0,lowerBoundX:e.valid[0],upperBoundX:e.valid[1]}:{supported:!1,lowerBoundX:null,upperBoundX:null}};a.unnormalize=function(e,d){if(d.supported){var k=Infinity,t=-Infinity,u=d.upperBoundX-d.lowerBoundX;e.forEach(y=>{let B=y.pos[0];for(;B<d.lowerBoundX;)B+=u;for(;B>d.upperBoundX;)B-=u;k=Math.min(k,B);t=Math.max(t,B);
y.pos[0]=B});var f=t-k;u-f<f&&e.forEach(y=>{0>y.pos[0]&&(y.pos[0]+=u)})}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/EditGeometryOperations":function(){define("exports ../../../core/Evented ../../../core/handleUtils ./EditGeometry ./interfaces ./operations/AppendVertex ./operations/UpdateVertices ./operations/RemoveVertices ./operations/SplitEdge ./operations/SetVertexPosition ./operations/CloseComponent ./operations/MoveVertex ./operations/OffsetEdgeVertex ./operations/RotateVertex ./operations/ScaleVertex ./operations/UndoGroup".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m,n){class h extends c{constructor(q){super();this.data=q;this._undoStack=[];this._redoStack=[];this._listener=this.data.on("change",z=>{z.addedVertices&&this.emit("vertex-add",{type:"vertex-add",vertices:z.addedVertices,operation:z.operation});z.removedVertices&&this.emit("vertex-remove",{type:"vertex-remove",vertices:z.removedVertices,operation:z.operation});z.updatedVertices&&this.emit("vertex-update",{type:"vertex-update",vertices:z.updatedVertices,operation:z.operation})})}destroy(){this._listener.remove()}splitEdge(q,
z){return this._apply(new f.SplitEdge(this.data,q,z))}updateVertices(q,z,r=d.AccumulationBehaviour.ACCUMULATE_STEPS){return this._apply(new t.UpdateVertices(this.data,q,z),r)}moveVertices(q,z,r,D,v=d.AccumulationBehaviour.ACCUMULATE_STEPS){return this.updateVertices(q,new A.MoveVertex(this.data.coordinateHelper,z,r,D),v)}scaleVertices(q,z,r,D,v,I=d.AccumulationBehaviour.ACCUMULATE_STEPS,p=t.AccumulationType.CUMULATIVE){return this.updateVertices(q,new m.ScaleVertex(z,r,D,v,p),I)}rotateVertices(q,
z,r,D=d.AccumulationBehaviour.ACCUMULATE_STEPS,v=t.AccumulationType.CUMULATIVE){return this.updateVertices(q,new g.RotateVertex(z,r,v),D)}removeVertices(q){return this._apply(new u.RemoveVertices(this.data,q,this._minNumVerticesPerType))}appendVertex(q){return 0===this.data.components.length?null:this._apply(new k.AppendVertex(this.data,this.data.components[0],q))}setVertexPosition(q,z){return this._apply(new y.SetVertexPosition(this.data,q,z))}offsetEdge(q,z,r,D=d.AccumulationBehaviour.ACCUMULATE_STEPS){return this.updateVertices([z.leftVertex,
z.rightVertex],new b.OffsetEdgeVertex(this.data.coordinateHelper,q,z,r),D)}closeComponent(q){return this.data.components.includes(q)?this._apply(new B.CloseComponent(this.data,q)):null}canRemoveVertex(q){return q.vertices.length>this._minNumVerticesPerType}createUndoGroup(){const q=new n.UndoGroup;this._apply(q);return l.makeHandle(()=>q.close())}undo(){if(0<this._undoStack.length){const q=this._undoStack.pop();q.undo();this._redoStack.push(q);return q}return null}redo(){if(0<this._redoStack.length){const q=
this._redoStack.pop();q.apply();this._undoStack.push(q);return q}return null}get canUndo(){return 0<this._undoStack.length}get canRedo(){return 0<this._redoStack.length}get lastOperation(){return 0<this._undoStack.length?this._undoStack[this._undoStack.length-1]:null}get _minNumVerticesPerType(){switch(this.data.type){case "point":return 1;case "polyline":return 2;case "polygon":return 3;default:return 0}}_apply(q,z=d.AccumulationBehaviour.ACCUMULATE_STEPS){z!==d.AccumulationBehaviour.NEW_STEP&&null!=
this.lastOperation&&this.lastOperation.accumulate(q)||(q.apply(),this._undoStack.push(q),this._redoStack=[]);return q}static fromGeometry(q,z){return new h(e.EditGeometry.fromGeometry(q,z))}}a.EditGeometryOperations=h;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/interfaces":function(){define(["exports"],function(a){a.AccumulationBehaviour=void 0;var c=a.AccumulationBehaviour||(a.AccumulationBehaviour={});c[c.NEW_STEP=0]="NEW_STEP";c[c.ACCUMULATE_STEPS=
1]="ACCUMULATE_STEPS";Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/AppendVertex":function(){define(["exports","../EditGeometry"],function(a,c){class l{constructor(e,d,k){this._editGeometry=e;this._component=d;this._pos=k;this._right=this._left=this._originalEdge=this._addedVertex=null}apply(){let e="redo";null==this._addedVertex&&(e="apply",this._addedVertex=new c.Vertex(this._component));const d=this._component.getLastVertex();if(null==
d)this._component.vertices.push(this._addedVertex),this._addedVertex.pos=this._pos,this._addedVertex.index=0;else{let k=null;d.rightEdge&&(this._originalEdge=d.rightEdge,k=this._originalEdge.rightVertex,this._component.edges.splice(this._component.edges.indexOf(this._originalEdge),1));this._component.vertices.push(this._addedVertex);this._addedVertex.pos=this._pos;null==this._left&&(this._left=new c.Edge(this._component,d,this._addedVertex));this._component.edges.push(this._left);d.rightEdge=this._left;
null!=this._originalEdge&&null!=k&&(null==this._right&&(this._right=new c.Edge(this._component,this._addedVertex,k)),this._component.edges.push(this._right),k.leftEdge=this._right);this._component.updateVertexIndex(this._addedVertex,d.index+1)}this._editGeometry.notifyChanges({operation:e,addedVertices:[this._addedVertex]})}undo(){null!=this._addedVertex&&(this._component.vertices.splice(this._component.vertices.indexOf(this._addedVertex),1),null!=this._left&&(this._component.edges.splice(this._component.edges.indexOf(this._left),
1),this._left.leftVertex.rightEdge=null),null!=this._right&&(this._component.edges.splice(this._component.edges.indexOf(this._right),1),this._right.rightVertex.leftEdge=null),null!=this._originalEdge&&(this._component.edges.push(this._originalEdge),this._originalEdge.leftVertex.rightEdge=this._originalEdge,this._originalEdge.rightVertex.leftEdge=this._originalEdge),null!=this._left?this._component.updateVertexIndex(this._left.leftVertex,this._left.leftVertex.index):this._component.updateVertexIndex(this._addedVertex,
0),this._editGeometry.notifyChanges({operation:"undo",removedVertices:[this._addedVertex]}))}accumulate(){return!1}}a.AppendVertex=l;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/UpdateVertices":function(){define(["exports"],function(a){class c{constructor(l,e,d){this._editGeometry=l;this._vertices=e;this.operation=d;this._undone=!1}apply(){this._vertices.forEach(l=>this.operation.apply(l));this._editGeometry.components.forEach(l=>
l.unnormalizeVertexPositions());this._editGeometry.notifyChanges({operation:this._undone?"redo":"apply",updatedVertices:this._vertices})}undo(){this._vertices.forEach(l=>this.operation.undo(l));this._editGeometry.notifyChanges({operation:"undo",updatedVertices:this._vertices});this._undone=!0}canAccumulate(l){if(this._undone||l._vertices.length!==this._vertices.length)return!1;for(let e=0;e<l._vertices.length;++e)if(l._vertices[e]!==this._vertices[e])return!1;return this.operation.canAccumulate(l.operation)}accumulate(l){return l instanceof
c&&this.canAccumulate(l)?(this._vertices.forEach(e=>this.operation.accumulate(e,l.operation)),this.operation.accumulateParams(l.operation),this._editGeometry.components.forEach(e=>e.unnormalizeVertexPositions()),this._editGeometry.notifyChanges({operation:"apply",updatedVertices:this._vertices}),!0):!1}}a.AccumulationType=void 0;(function(l){l[l.CUMULATIVE=0]="CUMULATIVE";l[l.REPLACE=1]="REPLACE"})(a.AccumulationType||(a.AccumulationType={}));a.UpdateVertices=c;Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/views/interactive/editGeometry/operations/RemoveVertices":function(){define(["exports","../EditGeometry"],function(a,c){class l{constructor(e,d,k=0){this._editGeometry=e;this._vertices=d;this._minNumberOfVertices=k;this.removedVertices=null}apply(){let e="redo";if(null==this.removedVertices){const d=this.removedVertices=[];this._vertices.forEach(k=>{k=this._removeVertex(k);null!=k&&d.push(k)});e="apply"}else this.removedVertices.forEach(d=>{this._removeVertex(d.removedVertex)});
this._editGeometry.notifyChanges({operation:e,removedVertices:this._vertices})}undo(){this.removedVertices?.forEach(e=>{this._undoRemoveVertex(e)});this._editGeometry.notifyChanges({operation:"undo",addedVertices:this._vertices})}accumulate(){return!1}_removeVertex(e){const d=e.component;if(d.vertices.length<=this._minNumberOfVertices)return null;const k={removedVertex:e,createdEdge:null},t=e.leftEdge,u=e.rightEdge;d.vertices.splice(d.vertices.indexOf(e),1);t&&(d.edges.splice(d.edges.indexOf(t),1),
t.leftVertex.rightEdge=null);u&&(d.edges.splice(d.edges.indexOf(u),1),u.rightVertex.leftEdge=null);0===e.index&&u&&0<this._vertices.length&&d.swapVertices(d.vertices.indexOf(u.rightVertex),0);t&&u&&(k.createdEdge=new c.Edge(d,t.leftVertex,u.rightVertex),d.edges.push(k.createdEdge));u&&d.updateVertexIndex(u.rightVertex,u.rightVertex.index-1);return k}_undoRemoveVertex(e){const d=e.removedVertex,k=e.removedVertex.component,t=d.leftEdge,u=d.rightEdge;e.createdEdge&&k.edges.splice(k.edges.indexOf(e.createdEdge),
1);k.vertices.push(d);t&&(k.edges.push(t),t.leftVertex.rightEdge=t);u&&(k.edges.push(u),u.rightVertex.leftEdge=u);k.updateVertexIndex(d,d.index)}}a.RemoveVertices=l;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/SplitEdge":function(){define(["exports","../EditGeometry"],function(a,c){class l{constructor(e,d,k){this._editGeometry=e;this._edge=d;this._t=k;this._right=this._left=this.createdVertex=null}apply(){let e="redo";const d=this._edge,
k=d.component,t=d.leftVertex,u=d.rightVertex;k.edges.splice(k.edges.indexOf(d),1);null==this.createdVertex&&(e="apply",this.createdVertex=new c.Vertex(d.component));k.vertices.push(this.createdVertex);this.createdVertex.pos=this._editGeometry.coordinateHelper.lerp(d.leftVertex.pos,d.rightVertex.pos,this._t,this._editGeometry.coordinateHelper.createVector());null==this._left&&(this._left=new c.Edge(k,t,this.createdVertex));this._left.leftVertex.leftEdge?k.edges.push(this._left):k.edges.unshift(this._left);
t.rightEdge=this._left;null==this._right&&(this._right=new c.Edge(k,this.createdVertex,u));k.edges.push(this._right);u.leftEdge=this._right;k.updateVertexIndex(this.createdVertex,t.index+1);this._editGeometry.notifyChanges({operation:e,addedVertices:[this.createdVertex]})}undo(){if(null==this.createdVertex||null==this._left||null==this._right)return null;const e=this._edge,d=e.component,k=this.createdVertex.leftEdge?.leftVertex,t=this.createdVertex.rightEdge?.rightVertex;d.vertices.splice(d.vertices.indexOf(this.createdVertex),
1);d.edges.splice(d.edges.indexOf(this._left),1);d.edges.splice(d.edges.indexOf(this._right),1);this._edge.leftVertex.leftEdge?d.edges.push(this._edge):d.edges.unshift(this._edge);k&&(k.rightEdge=e);t&&(t.leftEdge=e);k&&d.updateVertexIndex(k,k.index);this._editGeometry.notifyChanges({operation:"undo",removedVertices:[this.createdVertex]})}accumulate(){return!1}}a.SplitEdge=l;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/SetVertexPosition":function(){define(["exports"],
function(a){class c{constructor(l,e,d){this._editGeometry=l;this._vertex=e;this._pos=d}apply(){const l=null==this._originalPosition;l&&(this._originalPosition=this._vertex.pos);this._apply(l?"apply":"redo")}undo(){this._vertex.pos=this._originalPosition;this._editGeometry.notifyChanges({operation:"undo",updatedVertices:[this._vertex]})}accumulate(l){return l instanceof c&&l._vertex===this._vertex?(this._pos=l._pos,this._apply("apply"),!0):!1}_apply(l){this._vertex.pos=this._pos;this._editGeometry.components.forEach(e=>
e.unnormalizeVertexPositions());this._editGeometry.notifyChanges({operation:l,updatedVertices:[this._vertex]})}}a.SetVertexPosition=c;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/CloseComponent":function(){define(["exports","../../../../core/arrayUtils","../EditGeometry"],function(a,c,l){class e{constructor(d,k){this._editGeometry=d;this._component=k;this._createdEdge=null}apply(){let d="redo";if(null==this._createdEdge){d="apply";
const k=this._component.getFirstVertex(),t=this._component.getLastVertex();if(this._component.isClosed()||3>this._component.vertices.length||null==k||null==t)return;this._createdEdge=new l.Edge(this._component,t,k)}this._createdEdge.leftVertex.rightEdge=this._createdEdge;this._createdEdge.rightVertex.leftEdge=this._createdEdge;this._component.edges.push(this._createdEdge);this._editGeometry.notifyChanges({operation:d})}undo(){null!=this._createdEdge&&(c.remove(this._component.edges,this._createdEdge),
this._createdEdge.leftVertex.rightEdge=null,this._createdEdge.rightVertex.leftEdge=null,this._editGeometry.notifyChanges({operation:"undo"}))}accumulate(){return!1}}a.CloseComponent=e;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/MoveVertex":function(){define(["exports"],function(a){class c{constructor(l,e,d,k){this._helper=l;this.dx=e;this.dy=d;this.dz=k}_move(l,e,d,k){this._helper.addDelta(l.pos,e,d,k)}apply(l){this._move(l,this.dx,
this.dy,this.dz)}undo(l){this._move(l,-this.dx,-this.dy,-this.dz)}canAccumulate(l){return l instanceof c}accumulate(l,e){this._move(l,e.dx,e.dy,e.dz)}accumulateParams(l){this.dx+=l.dx;this.dy+=l.dy;this.dz+=l.dz}}a.MoveVertex=c;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/OffsetEdgeVertex":function(){define("exports ../../../../core/mathUtils ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../geometry/support/plane ../../../../geometry/support/vector ../../../support/geometry2dUtils".split(" "),
function(a,c,l,e,d,k,t,u,f){class y{get plane(){return this._plane}get requiresSplitEdgeLeft(){return!this._left.isOriginalDirection}get requiresSplitEdgeRight(){return!this._right.isOriginalDirection}get edgeDirection(){return this._edgeDirection}constructor(b,g,m,n=0,h=A.IMMEDIATE){this._helper=b;this._planeType=g;this._edge=m;this.distance=n;this._plane=t.create();this._offsetPlane=t.create();this._minDistance=-Infinity;this._maxDistance=Infinity;this._selectedArrow=1;h===A.IMMEDIATE&&this._initialize()}_initialize(){this._initializeNeighbors();
this._initializePlane();this._initializeDistanceConstraints()}_initializeNeighbors(){const b=this._toXYZ(this._edge.leftVertex.pos),g=this._toXYZ(this._edge.leftVertex.leftEdge?.leftVertex?.pos),m=this._toXYZ(this._edge.rightVertex.pos),n=this._toXYZ(this._edge.rightVertex.rightEdge?.rightVertex?.pos);this._edgeDirection=d.direction(k.create(),b,m);this._left=this._computeNeighbor(b,g,this._edgeDirection);this._right=this._computeNeighbor(m,n,this._edgeDirection)}_toXYZ(b){return null!=b?this._helper.toXYZ(b):
null}_pointToXYZ(b){return this._toXYZ(this._helper.pointToVector(b))}_computeNeighbor(b,g,m){if(null==g)return{start:b,end:g,direction:k.fromValues(-m[1],m[0],0),isOriginalDirection:!0};const n=d.direction(k.create(),b,g),h=!this._passesBisectingAngleThreshold(n,m);return{start:b,end:g,direction:h?this._bisectVectorsPerpendicular(m,n):n,isOriginalDirection:!h}}_passesBisectingAngleThreshold(b,g){b=Math.abs(u.angle(g,b));return b>=B&&b<=Math.PI-B}_bisectVectorsPerpendicular(b,g){b=0>d.dot(b,g)?b:
d.negate(k.create(),b);const m=Math.abs(d.dot(b,g));if(!(.001>m||.999<m))return this._bisectDirection(b,g);g=d.cross(k.create(),b,[0,0,1]);return d.normalize(g,g)}_bisectDirection(b,g){b=d.add(k.create(),b,g);return d.normalize(b,b)}_initializePlane(){const b=this._computeNormalDirection(this._left),g=this._computeNormalDirection(this._right);0>d.dot(b,g)&&d.negate(g,g);t.fromPositionAndNormal(this._left.start,this._bisectDirection(b,g),this._plane)}_computeNormalDirection(b){b=d.cross(k.create(),
b.direction,this._edgeDirection);d.normalize(b,b);b=d.cross(k.create(),this._edgeDirection,b);this._planeType===a.PlaneType.XY&&(b[2]=0);return d.normalize(b,b)}_initializeDistanceConstraints(){null==this._left.end||this.requiresSplitEdgeLeft||this._updateDistanceConstraint(t.signedDistance(this._plane,this._left.end));null==this._right.end||this.requiresSplitEdgeRight||this._updateDistanceConstraint(t.signedDistance(this._plane,this._right.end));this._updateIntersectDistanceConstraint(this._plane)}_updateDistanceConstraint(b){0>=
b&&(this._minDistance=Math.max(this._minDistance,b));0<=b&&(this._maxDistance=Math.min(this._maxDistance,b))}_updateIntersectDistanceConstraint(b){var g=t.normal(b);const m=this._edgeDirection;var n=d.add(k.create(),this._left.start,this._left.direction);const h=d.add(k.create(),this._right.start,this._right.direction);var q=this._pointInBasis2D(e.create(),g,m,this._left.start),z=this._pointInBasis2D(e.create(),g,m,n),r=this._pointInBasis2D(e.create(),g,m,this._right.start);g=this._pointInBasis2D(e.create(),
g,m,h);[r]=f.intersectLineAndRay({start:z,end:q,type:f.LineType.LINE},{start:g,end:r,type:f.LineType.LINE});r&&(q=l.subtract(e.create(),q,z),l.normalize(q,q),z=l.subtract(e.create(),r,z),z=l.dot(q,z),n=d.add(k.create(),n,d.scale(k.create(),this._left.direction,-z)),b=t.signedDistance(b,n),this._updateDistanceConstraint(b))}_pointInBasis2D(b,g,m,n){b[0]=u.projectPointSignedLength(g,n);b[1]=u.projectPointSignedLength(m,n);return b}_offset(b,g){Number.isFinite(this._minDistance)&&(g=Math.max(this._minDistance,
g));Number.isFinite(this._maxDistance)&&(g=Math.min(this._maxDistance,g));t.copy(this._offsetPlane,this._plane);this._offsetPlane[3]-=g;g=(n,h,q)=>null!=h&&t.intersectLine(this._offsetPlane,n,d.add(k.create(),n,h),q);const m=k.create();(b===this._edge.leftVertex?g(this._left.start,this._left.direction,m):g(this._right.start,this._right.direction,m))&&this._helper.copy(this._helper.fromXYZ(m,void 0,this._helper.getM(b.pos)),b.pos)}selectArrowFromStartPoint(b){this._selectedArrow=t.isPointInside(this.plane,
this._pointToXYZ(b))?1:-1}get selectedArrow(){return this._selectedArrow}signedDistanceToPoint(b){return t.signedDistance(this.plane,this._pointToXYZ(b))}apply(b){this._offset(b,this.distance)}undo(b){this._offset(b,0)}canAccumulate(b){return b instanceof y&&this._edge.leftVertex.index===b._edge.leftVertex.index&&this._edge.rightVertex.index===b._edge.rightVertex.index&&this._edge.component===b._edge.component&&this._maybeEqualsVec3(this._left.direction,b._left.direction)&&this._maybeEqualsVec3(this._right.direction,
b._right.direction)&&d.equals(t.normal(this._plane),t.normal(b._plane))}accumulate(b,g){this._offset(b,this._plane[3]-g._plane[3]+g.distance)}accumulateParams(b){this.distance=b.distance-b._plane[3]+this._plane[3]}clone(){const b=new y(this._helper,this._planeType,this._edge,this.distance,A.DEFERRED);t.copy(b._plane,this._plane);t.copy(b._offsetPlane,this._offsetPlane);b._maxDistance=this._maxDistance;b._minDistance=this._minDistance;b._left=this._cloneNeighbor(this._left);b._right=this._cloneNeighbor(this._right);
b._edgeDirection=d.copy(k.create(),this._edgeDirection);return b}_maybeEqualsVec3(b,g){return null==b&&null==g||null!=b&&null!=g&&d.equals(b,g)}_cloneNeighbor({start:b,end:g,direction:m,isOriginalDirection:n}){return{start:d.copy(k.create(),b),end:null!=g?d.copy(k.create(),g):null,direction:d.copy(k.create(),m),isOriginalDirection:n}}}const B=c.deg2rad(15);a.PlaneType=void 0;(function(b){b[b.XYZ=0]="XYZ";b[b.XY=1]="XY"})(a.PlaneType||(a.PlaneType={}));var A;(function(b){b[b.IMMEDIATE=0]="IMMEDIATE";
b[b.DEFERRED=1]="DEFERRED"})(A||(A={}));a.OffsetEdgeVertex=y;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/RotateVertex":function(){define(["exports","../../../../core/arrayUtils","../../../../chunks/vec2","./UpdateVertices"],function(a,c,l,e){class d{constructor(k,t,u=e.AccumulationType.CUMULATIVE){this.origin=k;this.angle=t;this._accumulationType=u}_rotate(k,t){l.rotate(k.pos,k.pos,this.origin,t)}apply(k){this._rotate(k,this.angle)}undo(k){this._rotate(k,
-this.angle)}canAccumulate(k){return k instanceof d&&c.equals(this.origin,k.origin)}accumulate(k,t){this._rotate(k,t._accumulationType===e.AccumulationType.REPLACE?t.angle-this.angle:t.angle)}accumulateParams(k){this.angle=k._accumulationType===e.AccumulationType.REPLACE?k.angle:this.angle+k.angle}}a.RotateVertex=d;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/ScaleVertex":function(){define(["exports","../../../../core/arrayUtils",
"../../../../chunks/vec2f64","../../../../chunks/vec2","./UpdateVertices"],function(a,c,l,e,d){class k{constructor(t,u,f,y,B=d.AccumulationType.CUMULATIVE){this.origin=t;this.axis1=u;this.factor1=f;this.factor2=y;this._accumulationType=B;this.axis2=l.fromValues(u[1],-u[0])}_scale(t,u,f){e.projectAndScale(t.pos,t.pos,this.origin,this.axis1,u);e.projectAndScale(t.pos,t.pos,this.origin,this.axis2,f)}apply(t){this._scale(t,this.factor1,this.factor2)}undo(t){this._scale(t,1/this.factor1,1/this.factor2)}canAccumulate(t){return t instanceof
k&&c.equals(this.origin,t.origin)&&c.equals(this.axis1,t.axis1)}accumulate(t,u){u._accumulationType===d.AccumulationType.REPLACE?this._scale(t,u.factor1/this.factor1,u.factor2/this.factor2):this._scale(t,u.factor1,u.factor2)}accumulateParams(t){const u=t._accumulationType===d.AccumulationType.REPLACE;this.factor1=u?t.factor1:this.factor1*t.factor1;this.factor2=u?t.factor2:this.factor2*t.factor2}}a.ScaleVertex=k;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/UndoGroup":function(){define(["exports"],
function(a){class c{constructor(){this._operations=[];this._closed=!1}close(){this._closed=!0}apply(){for(const l of this._operations)l.apply()}undo(){for(let l=this._operations.length-1;0<=l;l--)this._operations[l].undo()}accumulate(l){if(this._closed)return!1;const e=this._operations.length?this._operations[this._operations.length-1]:null;e&&e.accumulate(l)||(this._operations.push(l),l.apply());return!0}}a.UndoGroup=c;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingContext":function(){define(["exports"],
function(a){class c{constructor(l){this.selfSnappingZ=this.visualizer=this.excludeFeature=this.vertexHandle=null;this.editGeometryOperations=l.editGeometryOperations;this.elevationInfo=l.elevationInfo;this.pointer=l.pointer;this.vertexHandle=l.vertexHandle;this.excludeFeature=l.excludeFeature;this.feature=l.feature;this.visualizer=l.visualizer;this.selfSnappingZ=l.selfSnappingZ}get coordinateHelper(){return this.editGeometryOperations.data.coordinateHelper}get spatialReference(){return this.coordinateHelper.spatialReference}}
a.SnappingContext=c;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingDragPipelineStep":function(){define("exports ../../../core/maybe ../../../core/promiseUtils ../../../core/reactiveUtils ../../../layers/graphics/dehydratedFeatureComparison ../../../layers/graphics/hydratedFeatures ../../../support/elevationInfoUtils ../dragEventPipeline ./SnappingContext ../../support/Scheduler".split(" "),function(a,c,l,e,d,k,t,u,f,y){function B(z,r,D){return l.debounce(async({frameTask:v,
point:I,scenePoint:p,context:w,event:C,delta:F,getLastState:G},J)=>{const L=await v.schedule(()=>z.snap({point:I,scenePoint:p,context:w,signal:J}),J);L.valid&&(v=await v.schedule(()=>L.apply(),J),G=G(),null!=G.point&&I!==G.point&&(v=z.update({point:G.point,scenePoint:G.scenePoint,context:w})),null!=G.updatePoint&&d.pointEquals(v,G.updatePoint)||(n(C.mapEnd,v,F,r),D.execute(C)))})}function A(z){return"3d"===z.type?z.resourceController.scheduler.registerTask(y.TaskPriority.SNAPPING):y.ImmediateTask}
function b(z,r,D){return{context:new f.SnappingContext({editGeometryOperations:z.editGeometryOperations,elevationInfo:z.elevationInfo,pointer:z.pointer,vertexHandle:null!=r.info?r.info.handle:null,excludeFeature:z.excludeFeature,feature:z.feature,visualizer:z.visualizer}),originalPos:null!=r.snapOrigin?z.coordinateHelper.vectorToDehydratedPoint(r.snapOrigin):r.mapStart,originalScenePos:null!=r.scenePoints?r.scenePoints.sceneStart:null,frameTask:D}}function g(z,[r,D,v]){z=k.clonePoint(z);z.x+=r;z.y+=
D;z.hasZ&&(z.z+=v);return z}function m(z,r){return[z.x-r.x,z.y-r.y,z.hasZ&&r.hasZ?z.z-r.z:0]}function n(z,r,[D,v,I],p){z.x=r.x+D;z.y=r.y+v;p&&z.hasZ&&r.hasZ&&(z.z=r.z+I)}function h(z,r){if(!z.hasZ())return null;var D=r.vertices;r=null;for(const v of D){D=z.getZ(v.pos);if(null!=r&&null!=D&&1E-6<Math.abs(D-r))return null;null==r&&(r=D)}return r}function q(z){return z}a.createSnapDragEventPipelineStep=function({predicate:z=()=>!0,snappingManager:r,snappingContext:D,updatingHandles:v,useZ:I=!0}){const p=
new u.EventPipeline;if(null==r)return{snappingStep:[q,p],cancelSnapping:q};let w=null,C=null,F,G=null;const J=()=>{w=c.abortMaybe(w);r.doneSnapping();C?.frameTask.remove();C=null;F=c.removeMaybe(F);G=null},L=B(r,I,p);let x=null,H=null,K=null;return{snappingStep:[E=>{if(!z(E))return E;const {action:M}=E;if("start"===M){var {info:O}=E;const U=A(r.view);C=b(D,E,U);C.context.selfSnappingZ=null;I||null==O||(O=h(D.coordinateHelper,O.handle.component),null!=O&&(C.context.selfSnappingZ={value:O,elevationInfo:D.elevationInfo??
t.absoluteHeightElevationInfo}))}if(null!=C){const {context:U,originalScenePos:ba,originalPos:la}=C,{mapEnd:fa,mapStart:P,scenePoints:X}=E,ma=g(la,m(fa,P)),aa=m(P,la),W={...E,action:"update"},ia=C.context;var T=null==ba||null==X?null:g(ba,m(X.sceneEnd,X.sceneStart));K=O=r.update({point:ma,scenePoint:T,context:U});n(fa,O,aa,I);x=ma;H=T;if("end"!==M){const {frameTask:ha}=C;null==w&&(w=new AbortController);G=V=>{v.addPromise(l.ignoreAbortErrors(L({frameTask:ha,event:W,context:ia,point:ma,scenePoint:T,
delta:aa,getLastState:()=>({point:x,scenePoint:H,updatePoint:V.forceUpdate?null:K})},w.signal)))};G({forceUpdate:!1});null==F&&(F=e.watch(()=>r.options.effectiveEnabled,()=>G?.({forceUpdate:!0})))}}"end"===M&&J();return E},p],cancelSnapping:E=>{J();return E}}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingOperation":function(){define("exports ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/maybe ../../../core/promiseUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../support/Scheduler".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B){a.SnappingOperation=class extends l{constructor(A){super(A);this.constrainResult=b=>b;this._stagedPoint=this._abortController=this._frameTask=this._snapPoints=null;this._snap=d.debounce(async(b,g,m,n)=>{const h=this._frameTask;if(null!=h){var q=await h.schedule(()=>g.snap({...b,context:m,signal:n}),n);q.valid&&await h.schedule(()=>{this.stagedPoint=q.apply();b!==this._snapPoints&&null!=this._snapPoints&&(this.stagedPoint=g.update({...this._snapPoints,context:m}))},
n)}})}get stagedPoint(){return this._stagedPoint}set stagedPoint(A){this._stagedPoint=this.constrainResult(A)}initialize(){const A="3d"===this.view.type?this.view?.resourceController?.scheduler:null;this._frameTask=null!=A?A.registerTask(B.TaskPriority.SNAPPING):B.ImmediateTask}destroy(){this._abortController=e.abortMaybe(this._abortController);this._frameTask=e.removeMaybe(this._frameTask)}update(A,b,g){this._snapPoints=A;const {point:m,scenePoint:n}=A;return this.stagedPoint=A=b.update({point:m,
scenePoint:n,context:g})}async snap(A,b,g){const {point:m,scenePoint:n}=A;this.stagedPoint=b.update({point:m,scenePoint:n,context:g});this._snapPoints=A;null==this._abortController&&(this._abortController=new AbortController);return this._snap(A,b,g,this._abortController.signal)}async resnap(A,b){null!=this._snapPoints&&await this.snap(this._snapPoints,A,b)}abort(){this._abortController=e.abortMaybe(this._abortController);this._snapPoints=null}};c.__decorate([k.property({constructOnly:!0})],a.SnappingOperation.prototype,
"view",void 0);c.__decorate([k.property()],a.SnappingOperation.prototype,"stagedPoint",null);c.__decorate([k.property()],a.SnappingOperation.prototype,"constrainResult",void 0);c.__decorate([k.property()],a.SnappingOperation.prototype,"_stagedPoint",void 0);a.SnappingOperation=c.__decorate([y.subclass("esri.views.interactive.snapping.SnappingOperation")],a.SnappingOperation);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/draw/drawSurfaces":function(){define(["exports",
"../../core/screenUtils","../../layers/graphics/dehydratedPoint","../../layers/graphics/hydratedFeatures","../../support/elevationInfoUtils"],function(a,c,l,e,d){class k{constructor(f,y,B,A=null){this._elevationInfo=f;this.defaultZ=y;this._view=B;this._excludeGraphics=A}screenToMap(f){if(null!=this.defaultZ)return this._view.sceneIntersectionHelper.intersectElevationFromScreen(c.createScreenPointArray(f.x,f.y),this._elevationInfo,this.defaultZ,this._excludeGraphics);f=this._view.sceneIntersectionHelper.intersectElevationFromScreen(c.createScreenPointArray(f.x,
f.y),this._elevationInfo,0,this._excludeGraphics);null!=f&&(f.z=void 0);return f}mapToScreen(f){f=l.makeDehydratedPoint(f.x,f.y,d.getConvertedElevation(this._view,f,this._elevationInfo),f.spatialReference);return this._view.toScreen(f)}constrainZ(f){const {defaultZ:y}=this;null!=y&&f.z!==y&&(f=e.clonePoint(f),f.z=y);return f}}class t{constructor(f,y,B=[]){this.view=f;this.elevationInfo=y;this.exclude=B}screenToMap(f){f=this.view.toMap(f,{exclude:this.exclude});null!=f&&(f.z=d.getZForElevationMode(f,
this.view,this.elevationInfo));return f}mapToScreen(f){let y=f;null!=this.elevationInfo&&(y=l.makeDehydratedPoint(f.x,f.y,d.getConvertedElevation(this.view,f,this.elevationInfo),f.spatialReference));return this.view.toScreen(y)}constrainZ(f){return f}}class u{constructor(f,y=!1,B=0){this.view=f;this.hasZ=y;this.defaultZ=B;this.mapToScreen=A=>f.toScreen(A);this.screenToMap=y?A=>{A=f.toMap(A);A.z=B;return A}:A=>f.toMap(A)}constrainZ(f){const {defaultZ:y}=this;this.hasZ&&f.z!==y&&(f=e.clonePoint(f),
f.z=y);return f}}a.ElevationDrawSurface=k;a.MapDrawSurface=u;a.SceneDrawSurface=t;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/draw/support/helpMessageUtils3d":function(){define(["exports","../../../core/unitUtils","../../../chunks/vec3","../../../chunks/vec3f64","../../../support/elevationInfoUtils"],function(a,c,l,e,d){const k=e.create();a.getDrawMeshHelpMessage=function(t,u){var f=t?.geometry;if(t&&"mesh"===f?.type&&u){var {renderCoordsHelper:y,elevationProvider:B}=
u,{camera:A}=u.state,{extent:b}=f,{center:g,spatialReference:m}=b,n=c.getMetersPerUnitForSR(m),h=c.getMetersPerVerticalUnitForSR(m),q=c.getMetersPerUnitForSR(y.spatialReference),z=(b.zmax??0)*h;f=z-(b.zmin??0)*h;n=Math.max(b.width*n,b.height*h,f)/q;var {x:r,y:D}=g;b=g.z??0;l.set(k,r,D,b);y.toRenderCoords(k,m,k);n/=A.computeScreenPixelSizeAt(k);if(n>1*A.width)return"meshTooClose";if(20>n)return"meshTooFar";t=d.getGraphicEffectiveElevationInfo(t);({absoluteZ:u}=d.zValueInAbsoluteHeightMode(r,D,z,m,
u,t));h*=B.getElevation(r,D,b,m,"ground")??0;return u<h+.1*f?"meshUnderground":"mesh"}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/moveGraphic/GraphicMoveTool":function(){define("exports ../../../../../chunks/tslib.es6 ../../../../../core/Collection ../../../../../core/Evented ../../../../../core/handleUtils ../../../../../core/maybe ../../../../../core/quantityUtils ../../../../../core/reactiveUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/accessorSupport/ensureType ../../../../../core/arrayUtils ../../../../../core/has ../../../../../core/accessorSupport/decorators/subclass ../../../../../core/support/UpdatingHandles ../../../../../layers/graphics/dehydratedPoint ../../../../../support/elevationInfoUtils ../../manipulatorUtils ../../SnappingVisualizer3D ../geometryUtils ../isSupportedGraphicUtils ../manipulatorUtils ../meshFastUpdateUtils ../visualElementUtils ../manipulations/config ../manipulations/MoveManipulation ../manipulations/moveUtils ../manipulations/MoveXYGraphicManipulation ./isSupportedGraphic ../../visualElements/OutlineVisualElement ../../../layers/graphics/GraphicState ../../../../interactive/dragEventPipeline ../../../../interactive/InteractiveToolBase ../../../../interactive/editGeometry/EditGeometryOperations ../../../../interactive/sketch/SketchTooltipOptions ../../../../interactive/snapping/SnappingContext ../../../../interactive/snapping/SnappingDragPipelineStep ../../../../interactive/tooltip/Tooltip ../../../../interactive/tooltip/TranslateTooltipInfos ../../../../support/automaticLengthMeasurementUtils ../../../../support/euclideanLengthMeasurementUtils".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m,n,h,q,z,r,D,v,I,p,w,C,F,G,J,L,x,H,K,E,M,O,T,U,ba,la){class fa{constructor(aa){this.allGraphics=aa;this.type="graphic-move-start"}}class P{constructor(aa,W,ia){this.dx=aa;this.dy=W;this.allGraphics=ia;this.type="graphic-move"}}class X{constructor(aa){this.allGraphics=aa;this.type="graphic-move-stop"}}a.GraphicMoveTool=class extends e.EventedMixin(H.InteractiveToolBase){constructor(aa){super(aa);this._infos=new Map;this.graphics=new l;this.enableZ=!0;this.tooltipOptions=
new E;this.type="move-3d";this._updatingHandles=new g.UpdatingHandles;this._translateGraphicZTooltipInfo=this._translateGraphicXYTooltipInfo=this._translateGraphicTooltipInfo=this._tooltip=this._moveManipulation=null}initialize(){const {view:aa}=this;this.addHandles([this.graphics.on("change",ia=>{ia.removed.forEach(ha=>this.removeHandles(ha));this._updateGraphicInfos(ia);this._setupFastTransformUpdates(ia.added);this._refreshManipulators()}),u.watch(()=>this.tooltipOptions.enabled,ia=>{this._tooltip=
ia?new T.Tooltip({view:aa}):k.destroyMaybe(this._tooltip)},u.syncAndInitial)]);const W=this.graphics.toArray();this._updateGraphicInfos({added:W,removed:[]});this._setupFastTransformUpdates(W);this._refreshManipulators();this.finishToolCreation()}destroy(){this._tooltip=k.destroyMaybe(this._tooltip);this._moveManipulation=k.destroyMaybe(this._moveManipulation);this._set("view",null);this._updatingHandles.destroy()}get updating(){return this._updatingHandles.updating}reset(){}_updateGraphicInfos({added:aa,
removed:W}){for(const ia of aa){if(G.isSupportedGraphic(ia)!==r.SupportedGraphicResult.SUPPORTED)continue;aa=new ma(ia);const ha=this.view.trackGraphicState(aa.state);this._infos.set(aa.graphic,{info:aa,handle:ha})}for(const ia of W)this._infos.get(ia)?.handle.remove(),this._infos.delete(ia)}_setupFastTransformUpdates(aa){for(const W of aa)({info:aa}=this._infos.get(W)),this.addHandles(v.meshTransformFastUpdateHandles(aa.state),W)}_refreshManipulators(){this.removeHandles("manipulators");this._moveManipulation=
k.destroyMaybe(this._moveManipulation);this.manipulators.removeAll();if(0!==this._infos.size){var aa=Array.from(this._infos.values(),({info:W})=>W);this._createManipulators(aa);this._createVisualElements(aa);this._updateMoveManipulation(aa)}}_createManipulators(aa){for(const W of aa){const ia=W.state;W.manipulationXY=new F.MoveXYGraphicManipulation({tool:this,view:this.view,graphicState:ia});W.manipulationXY.forEachManipulator(ha=>this.addHandles([ha.events.on("immediate-click",V=>{this.emit("immediate-click",
{...V,graphic:ia.graphic});V.stopPropagation()}),ha.events.on("grab-changed",({action:V})=>{const {tooltipOptions:ea,_tooltip:Q}=this;null!=Q&&("start"===V?(this._translateGraphicTooltipInfo??(this._translateGraphicTooltipInfo=new U.TranslateGraphicTooltipInfo({tooltipOptions:ea})),Q.info=this._translateGraphicTooltipInfo,Q.info.tooltipOptions=ea,Q.info.distance=t.zeroMeters):Q.clear())})],"manipulators"));this.addHandles(W.manipulationXY.createDragPipeline((ha,V,ea,Q)=>this._buildDragEventPipeline(aa,
w.ManipulationType.XY,ha,V,ea,Q)),"manipulators")}this._createMoveManipulation(aa)}_createMoveManipulation(aa){const W=new w.MoveManipulation({tool:this,view:this.view,snapToScene:!1,xyAvailable:!0,xyAxisAvailable:!0,zAvailable:!0,radius:1===aa.length?w.MoveManipulation.radiusForSymbol(aa[0].graphic.symbol):p.discRadius});this._moveManipulation=W;W.elevationInfo={mode:"absolute-height",offset:0};W.forEachManipulator(V=>{this.addHandles(V.events.on("immediate-click",ea=>{W.zManipulation.hasManipulator(V)||
1!==this.graphics.length||this.emit("immediate-click",{...ea,graphic:this.graphics.at(0)});ea.stopPropagation()}),"manipulators")});var ia=V=>ea=>{this.addHandles(ea.events.on("focus-changed",({action:Q})=>{const Z=this._tooltip;null!=Z&&("focus"===Q?this._updateMoveTooltip(aa,V):Z.clear())}),"manipulators")};this._moveManipulation.xyManipulation.forEachManipulator(ia(w.ManipulationType.XY));this._moveManipulation.xyAxisManipulation.forEachManipulator(ia(w.ManipulationType.XY_AXIS));this._moveManipulation.zManipulation.forEachManipulator(ia(w.ManipulationType.Z));
ia=()=>this._updateMoveManipulation(aa);for(const V of aa)this.addHandles([V.state.on("changed",ia),u.watch(()=>V.state.displaying,ia)],"manipulators");const ha=aa[aa.length-1];this.addHandles(ha.state.on("changed",()=>this._updateMoveManipulationAngle(ha)),"manipulators");this.addHandles(W.createDragPipeline((V,ea,Q,Z,na)=>this._buildDragEventPipeline(aa,V,ea,Q,Z,na),n.getGraphicEffectiveElevationInfo(ha.graphic),ha.graphic.geometry.spatialReference,ha.graphic),"manipulators");this._updateMoveManipulationAngle(ha)}_createVisualElements(aa){for(const W of aa){const ia=
I.createVisualElements({view:this.view,graphic:W.graphic,forEachManipulator:ha=>{W.manipulationXY?.forEachManipulator(ha);this._moveManipulation?.forEachManipulator(ha)},onManipulatorsChanged:()=>d.makeHandle()});null!=ia&&(W.geometryRepresentation=ia.visualElement,W.geometryRepresentation instanceof J.OutlineVisualElement&&this.addHandles([W.geometryRepresentation.events.on("attachment-origin-changed",()=>{W.state.isDraped||this._updateMoveManipulation(aa)}),u.watch(()=>W.state.isDraped,()=>this._updateMoveManipulation(aa))],
"manipulators"),this.addHandles(ia,"manipulators"))}}_updateMoveManipulationAngle(aa){this._moveManipulation&&(this._moveManipulation.angle=z.orientation(aa.graphic.geometry))}_updateMoveManipulation(aa){const W=m.makeDehydratedPoint(0,0,0,this.view.spatialReference);let ia=0,ha=!1;const V=this._moveManipulation;if(V){for(const ea of aa)if(ea.state.displaying&&(aa=ea.state.graphic,this.enableZ&&D.canMoveZ(aa)&&(ha=!0),aa=ea.geometryRepresentation instanceof J.OutlineVisualElement&&!ea.state.isDraped?
ea.geometryRepresentation.attachmentOrigin:h.getGraphicAttachmentOrigin(this.view,aa),null!=aa)){const {x:Q,y:Z,z:na}=aa;W.x+=Q;W.y+=Z;na&&(W.z??(W.z=0),W.z+=na);ia++}0<ia?(W.x/=ia,W.y/=ia,W.z??(W.z=0),W.z/=ia,V.location=W,V.xyManipulation.available=!0,V.xyAxisManipulation.available=!0,V.zManipulation.available=ha):V.available=!1}}_buildDragEventPipeline(aa,W,ia,ha,V,ea){const Q=[],Z=[];let na=null,va=null;const ra=()=>{for(const oa of Q)oa.dragging=!1;Q.length=0;Z.length=0;va=na=null;this._moveManipulation&&
(this._moveManipulation.interactive=!0)};if(1===aa.length&&W===w.ManipulationType.XY){const oa=aa[0].graphic;({steps:ha,cancel:V}=this._buildSnappingPipelineSteps(oa,n.getGraphicEffectiveElevationInfo(oa),ha,V,ea))}V=V.next(oa=>va?.(oa)).next(()=>{this.emit("graphic-move-stop",new X(Z));this.destroyed||ra();return null});ha=ha.next(oa=>{if("start"===oa.action){Q.length=0;Z.length=0;for(const ta of aa)ta.dragging||!ta.manipulationXY?.hasManipulator(ia)&&ta.manipulationXY?.grabbing||(Q.push(ta),Z.push(ta.graphic),
ta.dragging=!0);if(0!==Z.length&&(this._moveManipulation&&(this._moveManipulation.interactive=!1),na=x.dragGraphicMany(Z,this.view.state.viewingMode),va=x.resetGraphicMany(Z),this.emit("graphic-move-start",new fa(Z)),this.destroyed))return null}return 0!==Z.length?oa:null}).next(oa=>na?.(oa)).next(oa=>{this._updateMoveTooltip(aa,W,oa);return oa}).next(oa=>{switch(oa.action){case "start":case "update":if(oa.translationX||oa.translationY||oa.translationZ){const ta=this.view.toScreen(oa.mapStart);oa=
this.view.toScreen(oa.mapEnd);this.emit("graphic-move",new P(oa.x-ta.x,oa.y-ta.y,Z))}break;case "end":this.emit("graphic-move-stop",new X(Z)),this.destroyed||ra()}return null});return{steps:ha,cancel:V}}_updateMoveTooltip(aa,W,ia){const {tooltipOptions:ha,_tooltip:V}=this;if(null!=V){V.clear();var ea=0===aa.length?"absolute-height":aa[0].state.isDraped?"on-the-ground":"absolute-height";switch(W){case w.ManipulationType.XY:V.info=this._translateGraphicTooltipInfo??(this._translateGraphicTooltipInfo=
new U.TranslateGraphicTooltipInfo({tooltipOptions:ha}));this._updateMoveTooltipDistance(V.info,ia,(Q,Z)=>ba.autoHorizontalDistanceByElevationModeBetweenPoints(Q,Z,ea));break;case w.ManipulationType.XY_AXIS:V.info=this._translateGraphicXYTooltipInfo??(this._translateGraphicXYTooltipInfo=new U.TranslateGraphicXYTooltipInfo({tooltipOptions:ha}));this._updateMoveTooltipDistance(V.info,ia,(Q,Z)=>{Q=ba.autoHorizontalDistanceByElevationModeBetweenPoints(Q,Z,ea);return t.scale(Q,C.axisConstrainedDragSign(ia))});
break;case w.ManipulationType.Z:V.info=this._translateGraphicZTooltipInfo??(this._translateGraphicZTooltipInfo=new U.TranslateGraphicZTooltipInfo({tooltipOptions:ha})),this._updateMoveTooltipDistance(V.info,ia,la.verticalSignedDistanceBetweenPoints)}V.info.tooltipOptions=ha}}_updateMoveTooltipDistance(aa,W,ia){if(null!=W&&"end"!==W.action){const {mapStart:ha,mapEnd:V}=W;W=ia(ha,V);aa.distance=null!=W?W:t.zeroMeters}else aa.distance=t.zeroMeters}_buildSnappingPipelineSteps(aa,W,ia,ha,V){const ea=aa.geometry;
if(null==ea||"point"!==ea.type&&"mesh"!==ea.type)return{steps:ia,cancel:ha};const Q=("point"===ea.type?ea:ea.anchor).clone(),Z=new M.SnappingContext({elevationInfo:W,pointer:V,editGeometryOperations:K.EditGeometryOperations.fromGeometry(Q,this.view.state.viewingMode),visualizer:new q.SnappingVisualizer3D,excludeFeature:aa}),{snappingStep:na,cancelSnapping:va}=O.createSnapDragEventPipelineStep({snappingContext:Z,snappingManager:this.snappingManager,updatingHandles:this._updatingHandles});ha=ha.next(va);
ia=ia.next(ra=>{Q.z=n.getConvertedElevation(this.view,Q,n.getGraphicEffectiveElevationInfo(aa),{mode:"absolute-height",offset:0});const oa=Z.coordinateHelper.pointToVector(Q);return{...ra,snapOrigin:oa}}).next(...na);return{steps:ia,cancel:ha}}get test(){return{tooltip:this._tooltip}}};c.__decorate([f.property({constructOnly:!0,nonNullable:!0})],a.GraphicMoveTool.prototype,"view",void 0);c.__decorate([f.property()],a.GraphicMoveTool.prototype,"graphics",void 0);c.__decorate([f.property({constructOnly:!0,
nonNullable:!0})],a.GraphicMoveTool.prototype,"enableZ",void 0);c.__decorate([f.property({constructOnly:!0,type:E})],a.GraphicMoveTool.prototype,"tooltipOptions",void 0);c.__decorate([f.property({constructOnly:!0})],a.GraphicMoveTool.prototype,"snappingManager",void 0);c.__decorate([f.property()],a.GraphicMoveTool.prototype,"type",void 0);c.__decorate([f.property()],a.GraphicMoveTool.prototype,"updating",null);a.GraphicMoveTool=c.__decorate([b.subclass("esri.views.3d.interactive.editingTools.graphicMove3D.GraphicMoveTool")],
a.GraphicMoveTool);class ma{constructor(aa){this.manipulationXY=this.geometryRepresentation=null;this.dragging=!1;this.state=new L.GraphicState({graphic:aa})}get graphic(){return this.state.graphic}}a.GraphicMoveEvent=P;a.GraphicMoveStartEvent=fa;a.GraphicMoveStopEvent=X;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/manipulatorUtils":function(){define("exports ../../../core/colorUtils ../../../chunks/mat4 ../../../chunks/vec3 ../../../geometry/support/vectorStacks ../../../layers/graphics/hydratedFeatures ./Manipulator3D ./RenderObject ../layers/graphics/graphicUtils ../webgl-engine/lib/basicInterfaces ../webgl-engine/lib/GeometryUtil ../webgl-engine/lib/Material ../webgl-engine/materials/ColorMaterial ../webgl-engine/materials/ShadedColorMaterial ../../interactive/interfaces".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m){function n(D,v=A.RenderOccludedFlag.OccludeAndTransparent,I=!0){const p=c.colorVectorToColorAndOpacity(D);D=!(1>D[3]);return I?new g.ShadedColorMaterial({color:p,writeDepth:D,cullFace:y.CullFaceOptions.Back,renderOccluded:v,isDecoration:!0}):new b.ColorMaterial({color:p,writeDepth:D,cullFace:y.CullFaceOptions.Back,renderOccluded:v,isDecoration:!0})}function h(D,v,I,p){D=e.normalize(d.sv3d.get(),D);v=e.normalize(d.sv3d.get(),v);const w=e.cross(d.sv3d.get(),D,
v);p[0]=D[0];p[1]=D[1];p[2]=D[2];p[3]=0;p[4]=v[0];p[5]=v[1];p[6]=v[2];p[7]=0;p[8]=w[0];p[9]=w[1];p[10]=w[2];p[11]=0;p[12]=I[0];p[13]=I[1];p[14]=I[2];p[15]=1;return p}function q(D,v){const I=D.getViewForGraphic(v);return null!=I&&"computeAttachmentOrigin"in I?I.computeAttachmentOrigin(v,D.spatialReference):null}const z=Object.freeze({calloutLength:40,calloutWidth:1,discRadius:27,focusMultiplier:1.1}),r=Object.freeze({autoScaleRenderObjects:!1,worldSized:!0});a.calculateInputRotationTransform=function(D,
v,I,p){D=e.subtract(d.sv3d.get(),D,I);p=e.cross(d.sv3d.get(),p,D);I=h(D,p,I,d.sm4d.get());l.invert(I,I);v=e.transformMat4(d.sv3d.get(),v,I);return Math.atan2(v[1],v[0])};a.calculateTranslateRotateFromBases=h;a.createManipulatorMaterial=n;a.createManipulatorOutlineMaterial=function(D,v=A.RenderOccludedFlag.OccludeAndTransparent){D=c.colorVectorToColorAndOpacity(D);return new b.ColorMaterial({color:D,writeDepth:!0,cullFace:y.CullFaceOptions.Front,renderOccluded:v,isDecoration:!0})};a.createSphereManipulator=
function(D,v,I=m.ManipulatorStateCustomFlags.None){v=n(v);I=[new u.RenderObject(B.createSphereGeometry(v,1,32,32),I)];return new t.Manipulator3D({view:D,renderObjects:I})};a.getGraphicAttachmentOrigin=q;a.placeAtGraphic=function(D,v,I){D=q(D,I);null!=D?v.elevationAlignedLocation=D:(I=I.geometry,null!=I&&(I="mesh"===I.type?I.anchor:f.computeCentroid(I),null!=I&&(v.location=k.hydrateGeometry(I))))};a.rotateManipulatorDefaults=z;a.worldScaledManipulatorSettings=r;Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/views/3d/interactive/Manipulator3D":function(){define("exports ../../../geometry ../../../core/compilerUtils ../../../core/Evented ../../../core/handleUtils ../../../core/mathUtils ../../../core/maybe ../../../core/screenUtils ../../../chunks/mat3 ../../../chunks/mat3f64 ../../../chunks/mat4 ../../../chunks/mat4f64 ../../../chunks/vec2 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../geometry/ellipsoidUtils ../../../geometry/projection ../../../geometry/projection/localRotationUtils ../../../geometry/projection/projectors ../../../geometry/support/aaBoundingRect ../../../geometry/support/lineSegment ../../../geometry/support/plane ../../../geometry/support/ray ../../../geometry/support/vectorStacks ../../../layers/graphics/hydratedFeatures ../support/ElevationProvider ../support/geometryUtils/ray ../webgl-engine/lib/Camera ../webgl-engine/lib/Object3D ../webgl-engine/lib/UpdatePolicy ../webgl-engine/lib/WebGLLayer ../../interactive/interfaces ../../../geometry/Point".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m,n,h,q,z,r,D,v,I,p,w,C,F,G,J,L,x,H,K){function E(Q){return 0!==Q[12]||0!==Q[13]||0!==Q[14]}class M{constructor(Q){this.metadata=void 0;this._camera=new G.Camera;this._elevation={offset:0,override:null};this.collisionType={type:"point"};this.collisionPriority=0;this._renderObjects=[];this._available=this.autoScaleRenderObjects=!0;this._noDisplayCount=0;this._radius=10;this._worldSized=!1;this.focusMultiplier=2;this.touchMultiplier=2.5;this.worldOriented=!1;this._modelTransform=
A.create();this._worldFrame=null;this._renderLocation=m.create();this._renderLocationDirty=!0;this._location=new K({x:0,y:0,z:0});this._elevationAlignedLocation=new K;this.interactive=this._elevationAlignedLocationDirty=!0;this.selectable=!1;this.consumesClicks=this.grabbable=!0;this.grabCursor=this.cursor=null;this._selected=this._hovering=this.dragging=this._grabbing=!1;this._state=H.ManipulatorStateCustomFlags.None;this._focused=!1;this.events=new e.EventEmitter;this._screenLocation={screenPointArray:u.createScreenPointArray(),
renderScreenPointArray:u.createRenderScreenPointArray3(),pixelSize:0};this._screenLocationDirty=!0;this._attached=this._engineResourcesAddedToStage=!1;this._location.spatialReference=Q.view.spatialReference;Object.assign(this,Q);(Q=this.view.state?.camera)&&this._camera.copyFrom(Q)}destroy(){this._applyObjectTransform=ea;this._removeResourcesFromStage();this._camera=this.view=this._engineResources=null}get _stage(){return this.view?._stage}get elevationInfo(){return this._elevationInfo}set elevationInfo(Q){this._elevationInfo=
Q;this._renderLocationDirty=this._elevationAlignedLocationDirty=!0;this._updateEngineObject()}get renderObjects(){return this._renderObjects}set renderObjects(Q){this._removeResourcesFromStage();this._engineResources=null;this._renderObjects=Q.slice();this._updateEngineObject()}set available(Q){Q!==this._available&&(this._available=Q,this._updateEngineObject())}get available(){return this._available}disableDisplay(){this._noDisplayCount++;1===this._noDisplayCount&&this._updateEngineObject();return d.makeHandle(()=>
{this._noDisplayCount--;0===this._noDisplayCount&&this._updateEngineObject()})}set radius(Q){Q!==this._radius&&(this._radius=Q,this._updateEngineObject())}get radius(){return this._radius}set worldSized(Q){Q!==this._worldSized&&(this._worldSized=Q,this._updateEngineObject())}get worldSized(){return this._worldSized}get modelTransform(){return this._modelTransform}set modelTransform(Q){E(Q)&&(this._screenLocationDirty=!0);B.copy(this._modelTransform,Q);this._updateEngineObject()}get renderLocation(){if(this._renderLocationDirty)if(this._renderLocationDirty=
!1,this.view.renderCoordsHelper.toRenderCoords(this.elevationAlignedLocation,this._renderLocation),this.worldOriented){this._worldFrame||(this._worldFrame=A.create());a:{var Q=this.view,Z=this._renderLocation,na=this._worldFrame;switch(Q.viewingMode){case "local":B.identity(na);break a;case "global":Q=n.getReferenceEllipsoid(Q.renderCoordsHelper.spatialReference),z.sphericalPCPFtoLonLatElevation(Z,0,X,0,Q.radius),q.computeENUToSphericalPCPFLocalRotation(k.deg2rad(X[0]),k.deg2rad(X[1]),na)}}}else this._worldFrame&&
(this._worldFrame=null);return this._renderLocation}set renderLocation(Q){this.view.renderCoordsHelper.fromRenderCoords(Q,this._location);this.elevationAlignedLocation=this._location}get location(){return this._location}set location(Q){w.clonePoint(Q,this._location);this._notifyLocationChanged()}_notifyLocationChanged(){this._elevationAlignedLocationDirty=this._screenLocationDirty=this._renderLocationDirty=!0;this._updateEngineObject();this.events.emit("location-update",{location:this._location})}get elevationAlignedLocation(){if(!this._elevationAlignedLocationDirty)return this._elevationAlignedLocation;
this._evaluateElevationAlignment();this._updateElevationAlignedLocation();return this._elevationAlignedLocation}set elevationAlignedLocation(Q){w.clonePoint(Q,this._location);this._evaluateElevationAlignment();this._location.z-=this._elevation.offset;this._updateElevationAlignedLocation();this._updateEngineObject();this.events.emit("location-update",{location:this._location})}_updateElevationAlignedLocation(){const Q=null!=this._elevation.override?this._elevation.override:this.location.z||0;this._elevationAlignedLocation.x=
this.location.x;this._elevationAlignedLocation.y=this.location.y;this._elevationAlignedLocation.z=Q+this._elevation.offset;this._elevationAlignedLocation.spatialReference=w.hydratedSpatialReference(this.location.spatialReference);this._screenLocationDirty=this._renderLocationDirty=!0;this._elevationAlignedLocationDirty=!1}grabbableForEvent(){return!0}get grabbing(){return this._grabbing}set grabbing(Q){Q!==this._grabbing&&(this._grabbing=Q,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}get hovering(){return this._hovering}set hovering(Q){Q!==
this._hovering&&(this._hovering=Q,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}get selected(){return this._selected}set selected(Q){Q!==this._selected&&(this._selected=Q,this._updateEngineObject(),this.events.emit("select-changed",{action:Q?"select":"deselect"}))}get state(){return this._state}set state(Q){Q!==this._state&&(this._state=Q,this._updateEngineObject())}updateStateEnabled(Q,Z){this.state=Z?this.state|Q:this.state&~Q}_setFocused(Q){Q!==this._focused&&(this._focused=
Q,this.events.emit("focus-changed",{action:!0===Q?"focus":"unfocus"}))}get focused(){return this._focused}get screenLocation(){this._ensureScreenLocation();return this._screenLocation}_ensureScreenLocation(){if(this._screenLocationDirty){this._screenLocation.pixelSize=this._camera.computeScreenPixelSizeAt(this.renderLocation);this._screenLocationDirty=!1;if(E(this._modelTransform)){var Q=this._calculateModelTransformOffset(ha);Q=g.add(Q,Q,this.renderLocation)}else Q=this.renderLocation;this._camera.projectToRenderScreen(Q,
this._screenLocation.renderScreenPointArray);this._camera.renderToScreen(this._screenLocation.renderScreenPointArray,this._screenLocation.screenPointArray)}}get applyObjectTransform(){return this._applyObjectTransform}set applyObjectTransform(Q){this._applyObjectTransform=Q;this._screenLocationDirty=!0;this._updateEngineObject()}get attached(){return this._attached}intersectionDistance(Q,Z){if(!this.available)return null;Q=u.screenPointObjectToArray(Q,O);var na=this._getCollisionRadius(Z);Z=-1*this.collisionPriority;
switch(this.collisionType.type){case "point":if(b.squaredDistance(this.screenLocation.screenPointArray,Q)<na*na)return this.screenLocation.renderScreenPointArray[2]+Z;break;case "line":var va=this.collisionType.paths,ra=this._getWorldToScreenObjectScale();ra=this._calculateObjectTransform(ra,fa);na*=this.screenLocation.pixelSize;Q=F.fromScreen(this._camera,Q,U);if(null==Q)break;for(var oa of va)if(0!==oa.length){va=g.transformMat4(X,oa[0],ra);for(var ta=1;ta<oa.length;ta++){var za=g.transformMat4(ma,
oa[ta],ra),N=D.closestRayDistance2(D.fromPoints(va,za,T),Q);if(null!=N&&N<na*na)return ra=g.add(p.sv3d.get(),va,za),g.scale(ra,ra,.5),Q=u.castRenderScreenPointArray(p.sv3d.get()),this._camera.projectToRenderScreen(ra,Q),Q[2]+Z;g.copy(va,za)}}break;case "disc":va=this.collisionType.direction;ra=this.collisionType.offset??m.ZEROS;oa=this._getWorldToScreenObjectScale();ta=this._calculateObjectTransform(oa,fa);oa=na*this.screenLocation.pixelSize;Q=F.fromScreen(this._camera,Q,U);if(null==Q)break;na=f.fromMat4(ba,
ta);na=g.transformMat3(W,va,na);ra=g.transformMat4(ia,ra,ta);v.fromPositionAndNormal(ra,na,P);na=aa;if(v.intersectRay(P,Q,na)&&g.squaredDistance(na,ra)<oa*oa)return this.screenLocation.renderScreenPointArray[2]+Z;break;case "ribbon":const {paths:R,direction:pa}=this.collisionType;oa=this._getWorldToScreenObjectScale();oa=this._calculateObjectTransform(oa,fa);na*=this._camera.computeScreenPixelSizeAt(this.renderLocation);va=F.fromScreen(this._camera,Q,U);if(null==va)break;Q=f.fromMat4(ba,oa);Q=g.transformMat3(W,
pa,Q);ta=this._calculateModelTransformPosition(ia);v.fromPositionAndNormal(ta,Q,P);Q=aa;if(!v.intersectRay(P,va,Q))break;for(ra of R)if(0!==ra.length)for(va=g.transformMat4(X,ra[0],oa),ta=1;ta<ra.length;ta++){za=g.transformMat4(ma,ra[ta],oa);N=D.distance2(D.fromPoints(va,za,T),Q);if(null!=N&&N<na*na)return ra=g.add(p.sv3d.get(),va,za),g.scale(ra,ra,.5),Q=u.castRenderScreenPointArray(p.sv3d.get()),this._camera.projectToRenderScreen(ra,Q),Q[2]+Z;g.copy(va,za)}break;default:l.neverReached(this.collisionType)}return null}attach(Q=
{manipulator3D:{}}){const Z=this._stage;Z&&(Q=Q.manipulator3D,null==Q.engineLayerId?(this._engineLayer=new x.WebGLLayer(Z,{pickable:!1,updatePolicy:L.UpdatePolicy.SYNC}),Q.engineLayerId=this._engineLayer.id):Z?.getObject&&(this._engineLayer=Z.getObject(Q.engineLayerId)),Q.engineLayerReferences=(Q.engineLayerReferences||0)+1,this._materialIdReferences=Q.materialIdReferences,null==this._materialIdReferences&&(this._materialIdReferences=new Map,Q.materialIdReferences=this._materialIdReferences),this._camera.copyFrom(this.view.state.camera),
this._attached=!0,this._updateEngineObject(),h.canProjectWithoutEngine(this._location.spatialReference,this.view.spatialReference)||(this.location=new K({x:0,y:0,z:0,spatialReference:this.view.spatialReference})))}detach(Q={manipulator3D:{}}){Q=Q.manipulator3D;Q.engineLayerReferences--;const Z=0===Q.engineLayerReferences;this._removeResourcesFromStage();Z&&(Q.engineLayerId=null,t.destroyMaybe(this._engineLayer));this._materialIdReferences=this._engineLayer=this._engineResources=null;this._attached=
!1}onViewChange(){this._camera.copyFrom(this.view.state.camera);this._screenLocationDirty=!0;this._updateEngineObject()}onElevationChange(Q){h.projectPoint(this.location,V,Q.spatialReference)&&r.containsPointObject(Q.extent,V)&&this._notifyLocationChanged()}_evaluateElevationAlignment(){if(null!=this.elevationInfo){var Q=null,Z=0,na=this.elevationInfo.offset??0;switch(this.elevationInfo.mode){case "on-the-ground":Q=C.getElevationAtPoint(this.view.elevationProvider,this.location,"ground")??0;break;
case "relative-to-ground":Z=(C.getElevationAtPoint(this.view.elevationProvider,this.location,"ground")??0)+na;break;case "relative-to-scene":Z=(C.getElevationAtPoint(this.view.elevationProvider,this.location,"scene")??0)+na;break;case "absolute-height":Z=na}if(Z!==this._elevation.offset||Q!==this._elevation.override)this._elevation.offset=Z,this._elevation.override=Q}}_updateEngineObject(){if(this._attached)if(this.available){var Q=this._getWorldToScreenObjectScale(),Z=fa;!0===this.autoScaleRenderObjects?
(Q*=this._getFocusedSize(this._radius,this.focused),this._calculateObjectTransform(Q,Z)):this._calculateObjectTransform(Q,Z);var {objectsByState:na}=this._ensureEngineResources();Q=(this.focused?H.ManipulatorStateFlags.Focused:H.ManipulatorStateFlags.Unfocused)|(this.selected?H.ManipulatorStateFlags.Selected:H.ManipulatorStateFlags.Unselected);var va=0<this._noDisplayCount;for(const {stateMask:ra,objects:oa}of na)if(va)for(const ta of oa)ta.visible=!1;else if(na=(ra&H.ManipulatorStateCustomFlags.All)===
H.ManipulatorStateCustomFlags.None||(this.state&ra)===(ra&H.ManipulatorStateCustomFlags.All),(ra&H.ManipulatorStateFlags.All)!==H.ManipulatorStateFlags.None&&(Q&ra)!==(ra&H.ManipulatorStateFlags.All)||!na)for(const ta of oa)ta.visible=!1;else for(const ta of oa)ta.visible=!0,ta.transformation=Z}else this._removeResourcesFromStage()}_ensureEngineResources(){if(null==this._engineResources){const Q=this._engineLayer,Z=[],na=new Set;this.renderObjects.forEach(({geometry:{material:oa}})=>{na.has(oa)||
(Z.push(oa),na.add(oa))});const va=new Map;this._renderObjects.forEach(oa=>{const ta=new J.Object3D({castShadow:!1,geometries:[oa.geometry]}),za=va.get(oa.stateMask)||[];za.push(ta);va.set(oa.stateMask,za)});const ra=[];va.forEach((oa,ta)=>ra.push({stateMask:ta,objects:oa}));this._engineResources={objectsByState:ra,layer:Q,materials:Z}}this._addResourcesToStage();return this._engineResources}_addResourcesToStage(){const Q=this._stage;if(!this._engineResourcesAddedToStage&&null!=this._engineResources&&
Q){var {objectsByState:Z,layer:na,materials:va}=this._engineResources;va.forEach(ra=>{const oa=this._materialIdReferences,ta=oa.get(ra.id)||0;0===ta&&Q.add(ra);oa.set(ra.id,ta+1)});Z.forEach(({objects:ra})=>{na.addMany(ra);Q.addMany(ra)});this._engineResourcesAddedToStage=!0}}_removeResourcesFromStage(){const Q=this._stage;if(this._engineResourcesAddedToStage&&null!=this._engineResources&&Q){var {objectsByState:Z,layer:na,materials:va}=this._engineResources;Z.forEach(({objects:ra})=>{na.removeMany(ra);
Q.removeMany(ra)});va.forEach(ra=>{const oa=this._materialIdReferences,ta=oa.get(ra.id);1===ta?(Q.remove(ra),oa.delete(ra.id)):oa.set(ra.id,ta-1)});this._engineResourcesAddedToStage=!1}}_getCollisionRadius(Q){return this._getFocusedSize(this.radius,!0)*("touch"===Q?this.touchMultiplier:1)}_getFocusedSize(Q,Z){return Q*(Z?this.focusMultiplier:1)}_getWorldToScreenObjectScale(){return this._worldSized?1:this.screenLocation.pixelSize}_calculateModelTransformPosition(Q){var Z=this._getWorldToScreenObjectScale();
Z=this._calculateObjectTransform(Z,la);return g.set(Q,Z[12],Z[13],Z[14])}_calculateModelTransformOffset(Q){const Z=this._calculateModelTransformPosition(Q);return g.subtract(Q,Z,this.renderLocation)}_calculateObjectTransform(Q,Z){B.set(Z,Q,0,0,0,0,Q,0,0,0,0,Q,0,0,0,0,1);this._worldFrame&&B.multiply(Z,Z,this._worldFrame);B.multiply(Z,Z,this._modelTransform);Z[12]+=this.renderLocation[0];Z[13]+=this.renderLocation[1];Z[14]+=this.renderLocation[2];Z[15]=1;null!=this._applyObjectTransform&&this._applyObjectTransform(Z);
return Z}get test(){let Q=!1;if(null!=this._engineResources)for(const Z of this._engineResources.objectsByState){for(const na of Z.objects)if(na.visible){Q=!0;break}if(Q)break}return{areAnyResourcesVisible:Q}}}const O=u.createScreenPointArray(),T=D.create(),U=I.create(),ba=y.create(),la=A.create(),fa=A.create(),P=v.create(),X=m.create(),ma=m.create(),aa=m.create(),W=m.create(),ia=m.create(),ha=m.create(),V=new K({x:0,y:0,z:0,spatialReference:null}),ea=()=>{};a.Manipulator3D=M;Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/RenderObject":function(){define(["exports","../../interactive/interfaces"],function(a,c){class l{constructor(e,d=c.ManipulatorStateFlags.None){this.geometry=e;this.stateMask=d}}a.RenderObject=l;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/geometryUtils":function(){define(["exports","../../../../chunks/vec2f64","../../../support/geometry3dUtils"],function(a,c,l){function e(d){if(null==
d||"polyline"!==d.type&&"polygon"!==d.type)return 0;d="polyline"===d.type?d.paths:d.rings;for(const k of d)for(d=0;d<k.length-1;d++){const t=k[d],u=k[d+1],f=t[0]-u[0],y=t[1]-u[1];if(f*f+y*y>l.epsilon)return Math.atan2(u[1]-t[1],u[0]-t[0])}return 0}a.mainAxis=function(d){d=e(d);return c.fromValues(Math.cos(d),Math.sin(d))};a.orientation=e;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/isSupportedGraphicUtils":function(){define(["exports","../../../../core/has"],
function(a,c){a.SupportedGraphicResult=void 0;(function(l){l[l.SUPPORTED=0]="SUPPORTED";l[l.GRAPHICS_LAYER_MISSING=1]="GRAPHICS_LAYER_MISSING";l[l.GEOMETRY_MISSING=2]="GEOMETRY_MISSING";l[l.GEOMETRY_TYPE_UNSUPPORTED=3]="GEOMETRY_TYPE_UNSUPPORTED";l[l.ELEVATION_MODE_UNSUPPORTED=4]="ELEVATION_MODE_UNSUPPORTED";l[l.SYMBOL_TYPE_UNSUPPORTED=5]="SYMBOL_TYPE_UNSUPPORTED"})(a.SupportedGraphicResult||(a.SupportedGraphicResult={}));a.isSupportedGraphicResultMessage=function(l){switch(l){case a.SupportedGraphicResult.GRAPHICS_LAYER_MISSING:return"not owned by a graphics layer";
case a.SupportedGraphicResult.GEOMETRY_MISSING:return"no geometry";case a.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED:return"the geometry type is not supported";case a.SupportedGraphicResult.ELEVATION_MODE_UNSUPPORTED:return"the elevation mode is not supported";case a.SupportedGraphicResult.SYMBOL_TYPE_UNSUPPORTED:return"the symbol type is not supported"}return""};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/manipulatorUtils":function(){define(["exports",
"../../../../core/handleUtils","../../../../support/elevationInfoUtils"],function(a,c,l){a.canMoveZ=function(e,d=l.getGraphicEffectiveElevationInfo(e)){return"on-the-ground"!==d.mode&&null!=e.geometry&&e.geometry.hasZ?!0:!1};a.disableDisplayOnGrab=function(e,d){let k=null;const t=e.events.on("grab-changed",u=>{null!=k&&(k.remove(),k=null);"start"===u.action&&(k=e.disableDisplay());d&&d(u)});return c.makeHandle(()=>{k?.remove();t.remove()})};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/views/3d/interactive/editingTools/visualElementUtils":function(){define(["exports","./lineGraphicVisualElementUtils","./originGraphicVisualElementUtils"],function(a,c,l){a.createVisualElements=function(e){switch(e.graphic.geometry.type){case "point":case "mesh":return l.createVisualElements(e);case "polygon":case "polyline":return c.createVisualElements(e);default:return null}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/lineGraphicVisualElementUtils":function(){define("exports ../../../../core/handleUtils ../../../../core/mathUtils ../../../../core/reactiveUtils ../../../../core/signal ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../support/elevationInfoUtils ../Manipulator3D ./GrabbingState ./ManipulatorState ./ManipulatorType ./settings ../visualElements/ExtendedLineVisualElement ../visualElements/LaserlineVisualElement ../visualElements/OutlineVisualElement ../../layers/graphics/GraphicState ../../webgl-engine/lib/Material".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m,n,h,q){function z(p,w){const {view:C,graphic:F}=p,G=new n.OutlineVisualElement({view:C,geometry:v(F)?F.geometry:null,elevationInfo:u.getGraphicEffectiveElevationInfo(F),attached:!1,isDecoration:!0}),J=new b.Settings({getTheme:()=>C.effectiveTheme}),L=c.handlesGroup([e.watch(()=>J.visualElements.lineGraphics.outline,x=>x.apply(G),e.initial),e.watch(()=>J.visualElements.lineGraphics.shadowStyle,x=>x.apply(G),e.initial),e.watch(()=>w.displaying,()=>{G.attached=
w.displaying}),e.watch(()=>w.isDraped,x=>{G.isDraped=x}),w.on("changed",()=>G.geometry=v(F)?F.geometry:null),c.destroyHandle(G)]);G.attached=w.displaying;return{visualElement:G,remove:()=>L.remove()}}function r(p,w,C){const {graphic:F,view:G}=p,J=[];var L=u.getGraphicEffectiveElevationInfo(F);const x="on-the-ground"===L.mode||!L.offset&&"absolute-height"!==L.mode,H=new B.ManipulatorState,K=new b.Settings({getTheme:()=>G.effectiveTheme}),E=K.visualElements,M=new g.ExtendedLineVisualElement({view:G,
extensionType:E.zVerticalLine.extensionType,innerWidth:1,attached:!1,writeDepthEnabled:!1,renderOccluded:q.RenderOccludedFlag.OccludeAndTransparent,isDecoration:!0});L=l.deg2rad(E.heightPlaneAngleCutoff);const O=new m.LaserlineVisualElement({view:G,attached:!1,angleCutoff:L,isDecoration:!0}),T=d.signal(1);J.push(e.watch(()=>({lineShadowStyle:K.visualElements.lineGraphics.shadowStyle,pointShadowStyle:K.visualElements.pointGraphics.shadowStyle,alpha:T.value}),({lineShadowStyle:fa,pointShadowStyle:P,
alpha:X})=>{fa.apply(w,X);P.apply(M,X)},e.initial));const U=d.signal(1);J.push(e.watch(()=>({heightPlane:K.visualElements.heightPlane,alpha:U.value}),({heightPlane:fa,alpha:P})=>fa.apply(O,P),e.initial));const ba=()=>{H.update(p);if(C.displaying&&(!x||!C.isDraped&&v(F)&&F.geometry.hasZ)){w.laserlineEnabled=!0;T.value=H.grabbingState&y.GrabbingState.XY?E.laserlineAlphaMultiplier:1;U.value=H.grabbingState&y.GrabbingState.Z?E.laserlineAlphaMultiplier:1;var fa=1===H.numSelected?H.firstSelected:1<H.numSelected&&
null!=H.firstGrabbedXY?H.firstGrabbedXY:null;null!=fa?(M.setStartEndFromWorldDownAtLocation(fa.renderLocation),M.attached=!0):M.attached=!1;D(p,w,O,H)}else w.laserlineEnabled=!1,M.attached=!1,O.attached=!1};J.push(e.watch(()=>K.visualElements.zVerticalLine,fa=>fa.apply(M),e.initial));J.push(C.on("changed",ba),e.watch(()=>C.displaying,ba),w.events.on("attachment-origin-changed",ba),c.destroyHandle(M),c.destroyHandle(O));const la=[];L=()=>{c.removeHandles(la);la.length=0;p.forEachManipulator(fa=>la.push(fa.events.on("grab-changed",
ba)));p.forEachManipulator(fa=>la.push(fa.events.on("select-changed",ba)));ba()};L();J.push(p.onManipulatorsChanged(L),c.refHandle(()=>c.handlesGroup(la)));return c.handlesGroup(J)}function D(p,w,C,F){if(0<F.numSelected){k.set(I,0,0,0);let G=0;p.forEachManipulator((J,L)=>{L===A.ManipulatorType.TRANSLATE_XY&&J.selected&&J instanceof f.Manipulator3D&&(k.add(I,I,J.renderLocation),G++)});0<G?(C.heightManifoldTarget=k.scale(I,I,1/G),C.attached=!0):C.attached=!1}else w=w.attachmentOrigin,null!=w&&p.view.renderCoordsHelper.toRenderCoords(w,
I)?(C.heightManifoldTarget=I,C.attached=!0):C.attached=!1}function v(p){return null!=p.geometry&&("polygon"===p.geometry.type||"polyline"===p.geometry.type)}const I=t.create();a.createVisualElements=function(p){const {view:w,graphic:C}=p,F=new h.GraphicState({graphic:C}),G=z(p,F);p=r(p,G.visualElement,F);const J=[G,p,w.maskOccludee(C),w.trackGraphicState(F)];return{visualElement:G.visualElement,remove:()=>c.removeHandles(J)}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/GrabbingState":function(){define(["exports"],
function(a){a.GrabbingState=void 0;var c=a.GrabbingState||(a.GrabbingState={});c[c.NONE=0]="NONE";c[c.ANY=1]="ANY";c[c.Z=2]="Z";c[c.XY=4]="XY";Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/ManipulatorState":function(){define(["exports","../Manipulator3D","./GrabbingState","./ManipulatorType"],function(a,c,l,e){class d{constructor(){this.grabbingState=l.GrabbingState.NONE;this.firstSelected=this.zManipulator=null;this.numSelected=0;this.firstGrabbedXY=
null}update(k){this.grabbingState=l.GrabbingState.NONE;this.zManipulator=null;this.numSelected=0;this.firstGrabbedXY=this.firstSelected=null;k.forEachManipulator((t,u)=>{u===e.ManipulatorType.TRANSLATE_Z&&(this.zManipulator=t);t instanceof c.Manipulator3D&&(t.selected&&(0===this.numSelected&&(this.firstSelected=t),this.numSelected++),null==this.firstGrabbedXY&&t.grabbing&&u===e.ManipulatorType.TRANSLATE_XY&&(this.firstGrabbedXY=t));if(t.grabbing)switch(this.grabbingState|=l.GrabbingState.ANY,u){case e.ManipulatorType.TRANSLATE_Z:this.grabbingState|=
l.GrabbingState.Z;break;case e.ManipulatorType.TRANSLATE_XY:this.grabbingState|=l.GrabbingState.XY}})}}a.ManipulatorState=d;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/ManipulatorType":function(){define(["exports"],function(a){a.ManipulatorType=void 0;var c=a.ManipulatorType||(a.ManipulatorType={});c[c.TRANSLATE_Z=0]="TRANSLATE_Z";c[c.TRANSLATE_XY=1]="TRANSLATE_XY";c[c.SCALE=2]="SCALE";c[c.ROTATE=3]="ROTATE";c[c.SCALE_ROTATE=4]="SCALE_ROTATE";
Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/originGraphicVisualElementUtils":function(){define("exports ../../../../core/handleUtils ../../../../core/mathUtils ../../../../core/reactiveUtils ../../../../core/signal ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../geometry/projection/projectPointToVector ../../../../geometry/projection/projectVectorToVector ../../../../geometry/support/aaBoundingBox ../../../../geometry/support/aaBoundingRect ../../../../support/elevationInfoUtils ./GrabbingState ./ManipulatorState ./settings ../visualElements/ExtendedLineVisualElement ../visualElements/LaserlineVisualElement ../visualElements/PointVisualElement ../../layers/graphics/elevationAlignmentUtils ../../layers/graphics/ElevationContext ../../layers/graphics/GraphicState ../../webgl-engine/lib/Material".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m,n,h,q,z,r,D,v){function I(x,H,K,E){const {view:M,graphic:O}=x,T=new m.Settings({getTheme:()=>M.effectiveTheme}),U=new n.ExtendedLineVisualElement({view:M,extensionType:T.visualElements.zVerticalLine.extensionType,innerWidth:1,attached:!1,writeDepthEnabled:!1,renderOccluded:v.RenderOccludedFlag.OccludeAndTransparent,isDecoration:!0});K.push(e.watch(()=>T.visualElements.zVerticalLine,ha=>ha.apply(U),e.initial));const ba=new h.LaserlineVisualElement({view:M,intersectsLineInfinite:!0,
attached:!1,isDecoration:!0});var la=l.deg2rad(T.visualElements.heightPlaneAngleCutoff);const fa=new h.LaserlineVisualElement({view:M,attached:!1,angleCutoff:la,isDecoration:!0});la=A.getGraphicEffectiveElevationInfo(x.graphic);const P=r.ElevationContext.fromElevationInfo(la),X="on-the-ground"===la.mode||!la.offset&&"absolute-height"!==la.mode,ma=new g.ManipulatorState,aa=d.signal(1);K.push(e.watch(()=>({heightPlane:T.visualElements.heightPlane,alpha:aa.value}),({heightPlane:ha,alpha:V})=>ha.apply(fa,
V),e.initial));const W=d.signal(1);K.push(e.watch(()=>({shadowStyle:T.visualElements.pointGraphics.shadowStyle,alpha:W.value}),({shadowStyle:ha,alpha:V})=>ha.apply(ba,V),e.initial));const ia=()=>{ma.update(x);var ha=w(O),V=X&&(H.isDraped||null==ha||!ha.hasZ);let ea=!0;if(V||null==ha)ea=!1;else{const Q=z.evaluateElevationAlignmentAtPoint(ha,M.elevationProvider,P,M.renderCoordsHelper);k.set(J,ha.x,ha.y,Q);f.projectVectorToVector(J,ha.spatialReference,J,M.renderCoordsHelper.spatialReference);U.setStartEndFromWorldDownAtLocation(J);
ba.intersectsWorldUpAtLocation=J}aa.value=ma.grabbingState&b.GrabbingState.Z?T.visualElements.laserlineAlphaMultiplier:1;ha=y.empty(L);!V&&H.displaying&&E.calculateMapBounds(ha)&&f.projectVectorToVector(y.getMin(ha,J),M.spatialReference,J,M.renderCoordsHelper.spatialReference)?(fa.heightManifoldTarget=J,fa.attached=!0):fa.attached=!1;W.value=ma.grabbingState&b.GrabbingState.XY?T.visualElements.laserlineAlphaMultiplier:1;V=ea&&H.displaying&&!V;ba.attached=V;U.attached=V};K.push(e.watch(()=>[H.displaying,
H.isDraped],ia),H.on("changed",ia));x.forEachManipulator(ha=>{K.push(ha.events.on("grab-changed",ia))});K.push(c.destroyHandle(ba));K.push(c.destroyHandle(U));K.push(c.destroyHandle(fa));ia()}function p(x,H,K){const {view:E,graphic:M}=x,O=new q.PointVisualElement({view:E,geometry:w(M),elevationInfo:A.getGraphicEffectiveElevationInfo(M),isDecoration:!0});C(x,O,H,K);K.push(c.destroyHandle(O));return O}function w(x){x=x.geometry;return null==x?null:"point"===x.type?x:"mesh"===x.type?x.anchor.clone():
null}function C(x,H,K,E){const M=new m.Settings({getTheme:()=>x.view.effectiveTheme});F(x,H,K,E);M.visualElements.pointGraphics.outline.apply(H);E.push(e.watch(()=>K.displaying,()=>{H.attached=K.displaying},e.initial))}function F(x,H,K,E){const {view:M,graphic:O}=x;let T=null;const U=ba=>{null!=T&&(T.remove(),T=null);K.isDraped&&null!=ba&&(T=G(M,ba,()=>{H.geometry=ba}))};x=()=>{const ba=w(O);U(ba);H.geometry=ba};E.push(K.on("changed",x),c.refHandle(()=>T));x()}function G(x,H,K){u.projectPointToVector(H,
J,x.elevationProvider.spatialReference);const E=J[0],M=J[1];return x.elevationProvider.on("elevation-change",O=>{B.containsXY(O.extent,E,M)&&K()})}const J=t.create(),L=y.create();a.createVisualElements=function(x){const {view:H,graphic:K}=x,E=new D.GraphicState({graphic:K}),M=[],O=p(x,E,M);I(x,E,M,O);M.push(H.trackGraphicState(E));return{visualElement:O,remove:()=>c.removeHandles(M)}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/manipulations/config":function(){define(["exports"],
function(a){const c=Math.ceil(70/3*2),l=5*Math.PI/12,e=1*Math.PI/3;a.alignArrowsScaleThreshold=1E6;a.discCollisionRadius=80;a.discHeight=.02;a.discRadius=70;a.discRadiusSmall=c;a.discTranslateArrowOffset=100;a.discTranslateArrowSize=54;a.dragThresholdPx=10;a.geometrySegments=128;a.indicatorThickness=9;a.innerIndicatorRadius=190;a.outerIndicatorRadius=213;a.ringHeight=.5;a.ringIndicatorDelayMs=200;a.ringRadius=160;a.ringResetAnimationSpeedFactor=3;a.ringThickness=24;a.rotateIndicatorArcLength=l;a.rotateIndicatorArrowPlacementPercentage=
.2;a.rotateIndicatorArrowTipLength=60;a.rotateIndicatorArrowTipRadius=23;a.rotateIndicatorDirectionBuffer=.3;a.scaleIndicatorArcLength=e;a.scaleIndicatorDirectionBuffer=.2;a.scaleIndicatorOffset1=30;a.scaleIndicatorOffset2=53;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/manipulations/MoveManipulation":function(){define("exports ../../../../../core/Handles ../../../../../core/handleUtils ../../../../../core/has ../../../../../core/reactiveUtils ../ManipulatorType ./config ./Manipulation ./MoveXYAxisManipulation ./MoveXYDiscManipulation ./MoveZManipulation".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B){class A extends u.Manipulation{constructor(b){super();this._handles=new c;this._interactive=!0;const {tool:g,view:m,snapToScene:n,radius:h}=b;this._view=m;this.xyManipulation=new y.MoveXYDiscManipulation({tool:g,view:m,snapToScene:n,radius:h});this.xyAxisManipulation=new f.MoveXYAxisManipulation({tool:g,view:m,radius:h});this.zManipulation=new B.MoveZManipulation({tool:g,view:m,radius:h});this.xyManipulation.available=b.xyAvailable;this.xyAxisManipulation.available=
b.xyAxisAvailable;this.zManipulation.available=b.zAvailable;this._autoHideXYAxis();this.forEachManipulator(q=>this._handles.add(q.events.on("grab-changed",()=>this._updateManipulatorInteractivity())))}destroy(){this._handles.destroy();this.xyManipulation.destroy();this.xyAxisManipulation.destroy();this.zManipulation.destroy()}createGraphicDragPipeline(b,g,m){return l.handlesGroup([this.xyManipulation.createGraphicDragPipeline((n,h,q,z,r)=>b(a.ManipulationType.XY,n,h,q,z,r),g,m),this.xyAxisManipulation.createGraphicDragPipeline((n,
h,q,z,r)=>b(a.ManipulationType.XY_AXIS,n,h,q,z,r),g,m),this.zManipulation.createGraphicDragPipeline((n,h,q,z,r)=>b(a.ManipulationType.Z,n,h,q,z,r),g,m)])}createDragPipeline(b,g,m,n){return l.handlesGroup([this.xyManipulation.createDragPipeline((h,q,z,r,D)=>b(a.ManipulationType.XY,h,q,z,r,D),g,m,n),this.xyAxisManipulation.createDragPipeline((h,q,z,r,D)=>b(a.ManipulationType.XY_AXIS,h,q,z,r,D),g,m,n),this.zManipulation.createDragPipeline((h,q,z,r,D)=>b(a.ManipulationType.Z,h,q,z,r,D),m)])}set snapToScene(b){this.xyManipulation.snapToScene=
b}set angle(b){this.xyAxisManipulation.angle=b}set interactive(b){this._interactive!==b&&(this._interactive=b,this._updateManipulatorInteractivity())}set radius(b){this.xyAxisManipulation.radius=b;this.xyManipulation.radius=b;this.zManipulation.radius=b}set displayScale(b){this.xyManipulation.displayScale=b;this.xyAxisManipulation.displayScale=b}forEachManipulator(b){this.xyManipulation.forEachManipulator(g=>b(g,k.ManipulatorType.TRANSLATE_XY));this.xyAxisManipulation.forEachManipulator(g=>b(g,k.ManipulatorType.TRANSLATE_XY));
this.zManipulation.forEachManipulator(g=>b(g,k.ManipulatorType.TRANSLATE_Z))}get _xyAxisVisible(){const b=this.xyManipulation.someManipulator(g=>g.focused)||this.xyAxisManipulation.someManipulator(g=>g.focused);return this._view.inputManager&&"touch"===this._view.inputManager.latestPointerType||b}_autoHideXYAxis(){const b=this.xyAxisManipulation;var g=this.xyManipulation;if(!e("esri-mobile")){var m=[];g.forEachManipulator(n=>m.push(n));b.forEachManipulator(n=>m.push(n));g=()=>{const n=[];this._xyAxisVisible||
b.forEachManipulator(h=>n.push(h.disableDisplay()));this._handles.remove("disable-xy-axis-display");this._handles.add(n,"disable-xy-axis-display")};for(const n of m)this._handles.add(n.events.on("focus-changed",g));this._view.inputManager&&this._handles.add(d.when(()=>this._view.inputManager?.latestPointerType,g));g()}}_updateManipulatorInteractivity(){const b=this.grabbing;this.forEachManipulator(g=>{g.interactive=!b&&this._interactive||g.grabbing})}static radiusForSymbol(b){return(b=null!=b&&"point-3d"===
b.type&&b.symbolLayers)&&b.some(g=>"icon"===g.type)?t.discRadiusSmall:t.discRadius}}a.ManipulationType=void 0;(function(b){b[b.XY=0]="XY";b[b.XY_AXIS=1]="XY_AXIS";b[b.Z=2]="Z"})(a.ManipulationType||(a.ManipulationType={}));a.MoveManipulation=A;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/manipulations/Manipulation":function(){define(["exports","../../Manipulator3D"],function(a,c){class l{constructor(){this._available=!0}set location(e){this._forEachManipulator3D(d=>
d.location=e)}set elevationAlignedLocation(e){this._forEachManipulator3D(d=>d.elevationAlignedLocation=e)}set elevationInfo(e){this._forEachManipulator3D(d=>d.elevationInfo=e)}get renderLocation(){let e;this._forEachManipulator3D(d=>{e||(e=d.renderLocation)});return e}get available(){return this._available}set available(e){this._available=e;this._forEachManipulator3D(d=>d.available=e)}get hovering(){return this.someManipulator(e=>e.hovering)}get grabbing(){return this.someManipulator(e=>e.grabbing)}get dragging(){return this.someManipulator(e=>
e.dragging)}hasManipulator(e){return this.someManipulator(d=>d===e)}someManipulator(e){let d=!1;this.forEachManipulator(k=>{!d&&e(k)&&(d=!0)});return d}_forEachManipulator3D(e){this.forEachManipulator((d,k)=>{d instanceof c.Manipulator3D&&e(d,k)})}}a.Manipulation=l;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/manipulations/MoveXYAxisManipulation":function(){define("exports ../../../../../Color ../../../../../core/Evented ../../../../../core/Handles ../../../../../core/handleUtils ../../../../../core/maybe ../../../../../core/reactiveUtils ../../../../../chunks/mat4 ../../../../../chunks/mat4f64 ../../../../../chunks/vec3 ../../../../../chunks/vec3f64 ../../../../../geometry/support/vectorStacks ../../../../../support/elevationInfoUtils ../../Manipulator3D ../../RenderObject ../dragEventPipeline3D ../ManipulatorType ./config ./Manipulation ./moveUtils ../../../webgl-engine/lib/basicInterfaces ../../../webgl-engine/lib/GeometryUtil ../../../webgl-engine/lib/Material ../../../webgl-engine/materials/ColorMaterial ../../../../interactive/dragEventPipeline ../../../../interactive/interfaces".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m,n,h,q,z,r,D,v,I,p,w,C){class F extends z.Manipulation{constructor(G){super();this._handles=new e;this._arrowManipulatorInfos=[];this._angle=0;this._scale=1;this._radius=q.discRadius;this._updateAfterDrag=!1;this.events=new l;this._tool=G.tool;this._view=G.view;this._opaqueMaterial=this._createMaterial();this._transparentMaterial=this._createMaterial(.5);null!=G.radius&&(this._radius=G.radius);this._createManipulators();this.forEachManipulator(J=>this._tool.manipulators.add(J))}set orthogonalAvailable(G){3<=
this._arrowManipulatorInfos.length&&(this._arrowManipulatorInfos[1].manipulator.available=G,this._arrowManipulatorInfos[3].manipulator.available=G)}destroy(){this._handles=k.destroyMaybe(this._handles);this.forEachManipulator(G=>{this._tool.manipulators.remove(G);G.destroy()});this._view=this._tool=null;this._arrowManipulatorInfos.length=0}forEachManipulator(G){for(const {manipulator:J}of this._arrowManipulatorInfos)G(J,h.ManipulatorType.TRANSLATE_XY)}createGraphicDragPipeline(G,J,L){const x=J.graphic,
H=b.getGraphicEffectiveElevationInfo(x),K=x.geometry.spatialReference;return r.createGraphicMoveDragPipeline(x,L,E=>this.createDragPipeline((M,O,T,U,ba)=>{({steps:O,cancel:T}=G(M,O,T,U,ba));return E(M,O,T)},H,K,x),this._view.state.viewingMode)}createDragPipeline(G,J,L,x){return d.handlesGroup(this._arrowManipulatorInfos.map(({manipulator:H},K)=>w.createManipulatorDragEventPipeline(H,(E,M,O,T,U)=>{M=M.next(ba=>({...ba,manipulatorType:h.ManipulatorType.TRANSLATE_XY})).next(w.dragAtLocation(this._view,
E.elevationAlignedLocation)).next(n.screenToMapXYAtLocation(this._view,E.elevationAlignedLocation,J,L,x)).next(w.constrainToMapAxis(E.location,this.angle+(K+1)*Math.PI*.5)).next(w.addScreenDelta());G(E,M,O,T,U)})))}get angle(){return this._angle}set angle(G){this._angle=G;this.dragging?this._updateAfterDrag=!0:this._updateManipulatorTransform()}get displayScale(){return this._scale}set displayScale(G){this._scale=G;this._updateManipulatorTransform()}get radius(){return this._radius}set radius(G){this._radius!==
G&&(this._radius=G,this._updateManipulators())}_updateManipulators(){for(let G=0;G<this._arrowManipulatorInfos.length;G++)this._updateArrowManipulator(this._arrowManipulatorInfos[G],G);this._updateManipulatorTransform()}_updateArrowManipulator({manipulator:G,transform:J},L){var x=this._radius/q.discRadius,H=q.discTranslateArrowSize*x;const K=H*Math.sqrt(3)/2;H=v.createExtrudedTriangle(this._opaqueMaterial,K,H/2,H/2,q.discHeight);v.transformInPlace(H,u.fromTranslation(A.sm4d.get(),y.set(A.sv3d.get(),
0,-K/3,0)));G.renderObjects=[new m.RenderObject(H,C.ManipulatorStateFlags.Focused),new m.RenderObject(H.instantiate({material:this._transparentMaterial}),C.ManipulatorStateFlags.Unfocused)];G.radius=K/3*2.4;G=u.fromZRotation(A.sm4d.get(),L*Math.PI/2);x=u.fromTranslation(A.sm4d.get(),y.set(A.sv3d.get(),0,q.discTranslateArrowOffset*x,0));u.multiply(J,G,x)}_createManipulators(){for(let G=0;4>G;G++){const J=this._createArrowManipulator(G);this._arrowManipulatorInfos.push(J)}this._updateManipulatorTransform()}_updateManipulatorTransform(){var G=
this.angle;G=u.fromRotation(A.sm4d.get(),G,B.fromValues(0,0,1));if(null!=G){var J=u.fromScaling(A.sm4d.get(),y.set(A.sv3d.get(),this.displayScale,this.displayScale,this.displayScale));G=u.multiply(A.sm4d.get(),J,G);for(const L of this._arrowManipulatorInfos)J=u.multiply(A.sm4d.get(),G,L.transform),L.manipulator.modelTransform=J}}_createArrowManipulator(G){const J=new g.Manipulator3D({view:this._view,autoScaleRenderObjects:!1,worldOriented:!0,focusMultiplier:1,touchMultiplier:1,collisionType:{type:"disc",
direction:B.fromValues(0,0,1)}}),L={manipulator:J,transform:f.create()};this._updateArrowManipulator(L,G);this._handles.add(J.events.on("drag",x=>{this._updateAfterDrag&&"end"===x.action&&!this.dragging&&(this._updateManipulatorTransform(),this._updateAfterDrag=!1)}));return L}_createMaterial(G=1){const J=new p.ColorMaterial({cullFace:D.CullFaceOptions.Back,renderOccluded:I.RenderOccludedFlag.Transparent,isDecoration:!0});this._handles.add(t.watch(()=>c.toUnitRGBA(this._view.effectiveTheme.accentColor),
L=>{L[3]*=G;J.setParameters({color:L})},t.initial));return J}get test(){return{arrowManipulators:this._arrowManipulatorInfos.map(({manipulator:G})=>G)}}}a.MoveXYAxisManipulation=F;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/dragEventPipeline3D":function(){define("exports ../../../../core/screenUtils ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../geometry/projection ../../../../geometry/support/plane ../../../../geometry/support/ray ../../../../geometry/support/vector ../../../../geometry/support/vectorStacks ../../../../support/elevationInfoUtils ../../support/geometryUtils/ray ../../webgl-engine/lib/Intersector ../../webgl-engine/lib/IntersectorInterfaces ../../webgl-engine/lib/verticalOffsetUtils ../../../interactive/dragEventPipeline".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m){function n(F,G){return h(F,()=>G)}function h(F,G){const J=e.create(),L=e.create();let x=!1;return H=>{const K=G(H);if("start"===H.action){var E=c.screenPointObjectToArray(H.screenStart,c.castScreenPointArray(f.sv2d.get()));E=B.fromScreen(F.state.camera,E,C);null!=E&&(x=k.intersectRay(K,E,J))}if(!x)return null;E=c.screenPointObjectToArray(H.screenEnd,c.castScreenPointArray(f.sv2d.get()));E=B.fromScreen(F.state.camera,E,C);return null==E?null:k.intersectRay(K,
E,L)?{...H,renderStart:J,renderEnd:L,plane:K,ray:E}:null}}function q(F,G,J=0,L=null,x=null){let H=null;return K=>{if("start"===K.action&&(H=F.sceneIntersectionHelper.intersectElevationFromScreen(c.createScreenPointArray(K.screenStart.x,K.screenStart.y),G,J,x),null!=H&&null!=L&&!d.projectPoint(H,H,L))||null==H)return null;const E=F.sceneIntersectionHelper.intersectElevationFromScreen(c.createScreenPointArray(K.screenEnd.x,K.screenEnd.y),G,J,x);return null!=E?null==L||d.projectPoint(E,E,L)?{...K,mapStart:H,
mapEnd:E}:null:null}}function z(F,G,J,L=null,x=null){G=y.getZForElevationMode(G,F,J);return q(F,J,G,L,x)}function r(F,G,J,L=null,x=null){return z(F,J,y.getGraphicEffectiveElevationInfo(G),L,x)}function D(F,G){const J=p,L=w,x=k.create();F.renderCoordsHelper.worldUpAtPosition(G,J);F=l.cross(x,J,l.subtract(L,G,F.state.camera.eye));l.cross(F,F,J);return k.fromPositionAndNormal(G,F,x)}function v(F,G){const J=e.create(),L=l.length(G);F.renderCoordsHelper.worldUpAtPosition(G,J);const x=e.create(),H=e.create(),
K=E=>{l.subtract(E,E,G);u.projectPoint(J,E,E);"global"===F.viewingMode&&l.length(E)*Math.sign(l.dot(J,E))<-L+.001&&l.subtract(E,l.scale(E,J,.001),G);l.add(E,E,G);return E};return E=>{E.renderStart=K(l.copy(x,E.renderStart));E.renderEnd=K(l.copy(H,E.renderEnd));return E}}function I(F,G){const J=F.renderCoordsHelper;return L=>{const x=J.fromRenderCoords(L.renderStart,G),H=J.fromRenderCoords(L.renderEnd,G);return null!=x&&null!=H?{...L,mapStart:x,mapEnd:H}:null}}a.SurfaceType=void 0;(function(F){F[F.GROUND=
0]="GROUND";F[F.OTHER=1]="OTHER"})(a.SurfaceType||(a.SurfaceType={}));const p=e.create(),w=e.create(),C=t.create();a.convertToMapCoordinates=I;a.hideManipulatorWhileDragging=function(F){let G=null;return J=>{switch(J.action){case "start":G=F.disableDisplay();break;case "end":case "cancel":null!=G&&(G.remove(),G=null)}return J}};a.projectToWorldUp=v;a.screenToMap3D=function(F,G=null){const J=A.newIntersector(F.state.viewingMode);J.options.selectionMode=!0;J.options.store=b.StoreResults.MIN;J.options.hud=
!1;const L=c.createScreenPointArray(),x={requiresGroundFeedback:!0,enableDraped:!0,exclude:new Set},H=e.create(),K=G??F.spatialReference,E=O=>{F.map.ground&&1>F.map.ground.opacity?x.exclude.add(g.terrainId):x.exclude.delete(g.terrainId);F.sceneIntersectionHelper.intersectIntersectorScreen(c.screenPointObjectToArray(O,L),J,x);O=J.results.min;if(O.getIntersectionPoint(H))O=O.intersector===b.IntersectorType.TERRAIN?a.SurfaceType.GROUND:a.SurfaceType.OTHER;else if(J.results.ground.getIntersectionPoint(H))O=
a.SurfaceType.GROUND;else return null;return{location:F.renderCoordsHelper.fromRenderCoords(H,K),surfaceType:O}};let M;return O=>{if("start"===O.action){var T=E(O.screenStart);M=null!=T?T.location:null}if(null==M)return null;T=E(O.screenEnd);return null!=T?.location?{...O,mapStart:M,mapEnd:T.location,surfaceType:T.surfaceType}:null}};a.screenToMapXYAtLocation=z;a.screenToMapXYForGraphic=function(F,G,J,L){F=G.toMap(F.screenStart,{include:[J]});return null!=F?r(G,J,F,L):null};a.screenToMapXYForGraphicAtLocation=
r;a.screenToRenderPlane=n;a.screenToRenderPlaneFromEvent=function(F){return h(F,G=>G.plane)};a.screenToZConstrained=function(F,G,J){let L=null;const x=new m.EventPipeline;x.next(n(F,D(F,G))).next(v(F,G)).next(I(F,J)).next(H=>{H.mapEnd.x=H.mapStart.x;H.mapEnd.y=H.mapStart.y;L=H});return H=>{L=null;x.execute(H);return L}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/manipulations/moveUtils":function(){define(["exports","../../../../interactive/dragEventPipeline"],
function(a,c){a.axisConstrainedDragSign=function(l){if(null==l?.axis)return 1;const {mapStart:e,mapEnd:d,axis:k}=l;l=[d.x-e.x,d.y-e.y];return 0<l[0]*k[0]+l[1]*k[1]?1:-1};a.createGraphicMoveDragPipeline=function(l,e,d,k){const t=(u,f)=>e({action:u,graphic:l,dxScreen:f.screenDeltaX,dyScreen:f.screenDeltaY});return d((u,f,y)=>{f.next(B=>{"start"===B.action&&t("start",B);return B}).next(c.dragGraphic(l,k)).next(B=>{switch(B.action){case "start":case "update":(B.translationX||B.translationY||B.translationZ)&&
t("update",B);break;case "end":t("end",B)}return B});y=y.next(c.resetGraphic(l)).next(B=>{t("end",{screenDeltaX:0,screenDeltaY:0});return B});return{steps:f,cancel:y}})};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/manipulations/MoveXYDiscManipulation":function(){define("exports ../../../../../Color ../../../../../core/Handles ../../../../../core/maybe ../../../../../core/reactiveUtils ../../../../../chunks/mat4 ../../../../../chunks/mat4f64 ../../../../../chunks/vec3 ../../../../../chunks/vec3f64 ../../../../../geometry/support/vectorStacks ../../../../../support/elevationInfoUtils ../../Manipulator3D ../../RenderObject ../dragEventPipeline3D ../ManipulatorType ./config ./Manipulation ./moveUtils ../snapping/SnapToScene ../../../webgl-engine/lib/basicInterfaces ../../../webgl-engine/lib/GeometryUtil ../../../webgl-engine/lib/Material ../../../webgl-engine/materials/ColorMaterial ../../../../interactive/dragEventPipeline ../../../../interactive/interfaces".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m,n,h,q,z,r,D,v,I,p,w){class C extends h.Manipulation{constructor(F){super();this._handles=new l;this._snapToScene=new z.SnapToScene;this._scale=1;this._radius=n.discRadius;this._view=F.view;this._tool=F.tool;this._discMaterial=this._createMaterial();this._discMaterialTransparent=this._createMaterial(.5);null!=F.snapToScene&&(this.snapToScene=F.snapToScene);null!=F.radius&&(this._radius=F.radius);this._createManipulator();this.forEachManipulator(G=>this._tool.manipulators.add(G))}destroy(){this._handles=
e.destroyMaybe(this._handles);this.forEachManipulator(F=>{this._tool.manipulators.remove(F);F.destroy()});this._manipulator=this._view=this._tool=null}forEachManipulator(F){F(this._manipulator,m.ManipulatorType.TRANSLATE_XY)}get displayScale(){return this._scale}set displayScale(F){this._scale=F;this._updateManipulatorTransform()}get snapToScene(){return this._snapToScene.enabled}set snapToScene(F){this._snapToScene.enabled=F}get radius(){return this._radius}set radius(F){F!==this._radius&&(this._radius=
F,this._updateManipulator())}createGraphicDragPipeline(F,G,J){const L=G.graphic,x=B.getGraphicEffectiveElevationInfo(L),H=L.geometry.spatialReference;return q.createGraphicMoveDragPipeline(L,J,K=>this.createDragPipeline((E,M,O,T,U)=>{({steps:M,cancel:O}=F(E,M,O,T,U));return K(E,M,O)},x,H,L),this._view.state.viewingMode)}createDragPipeline(F,G,J,L){const x=this._view;return p.createManipulatorDragEventPipeline(this._manipulator,(H,K,E,M,O)=>{K=K.next(p.dragAtLocation(x,H.elevationAlignedLocation)).next(g.screenToMapXYAtLocation(x,
H.elevationAlignedLocation,G,J,L)).next(...this._snapToScene.createDragEventPipelineStep(x,G)).next(T=>({...T,manipulatorType:m.ManipulatorType.TRANSLATE_XY})).next(p.addScreenDelta());F(H,K,E,M,O)})}_updateManipulatorTransform(){const F=k.fromScaling(y.sm4d.get(),u.set(y.sv3d.get(),this.displayScale,this.displayScale,this.displayScale));this._manipulator.modelTransform=F}_createManipulator(){this._manipulator=new A.Manipulator3D({view:this._view,worldSized:!1,autoScaleRenderObjects:!1,focusMultiplier:1,
touchMultiplier:1,collisionType:{type:"disc",direction:f.fromValues(0,0,1)},worldOriented:!0});this._updateManipulator()}_updateManipulator(){const F=D.createCylinderGeometry(this._discMaterial,n.discHeight,1,n.geometrySegments,f.fromValues(0,0,1),f.fromValues(0,0,0));F.transformation=k.fromScaling(t.create(),f.fromValues(this._radius,this._radius,this._radius));this._manipulator.renderObjects=[new b.RenderObject(F,w.ManipulatorStateFlags.Focused),new b.RenderObject(F.instantiate({material:this._discMaterialTransparent}),
w.ManipulatorStateFlags.Unfocused)];this._manipulator.radius=this._radius/n.discRadius*n.discCollisionRadius}_createMaterial(F=1){const G=new I.ColorMaterial({cullFace:r.CullFaceOptions.Back,renderOccluded:v.RenderOccludedFlag.Transparent,isDecoration:!0});this._handles.add(d.watch(()=>c.toUnitRGBA(this._view.effectiveTheme.accentColor),J=>{J[3]*=F;G.setParameters({color:J})},d.initial));return G}get test(){return{discManipulator:this._manipulator}}}a.MoveXYDiscManipulation=C;Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/snapping/SnapToScene":function(){define(["exports","../../../../../support/elevationInfoUtils","../../../../interactive/dragEventPipeline"],function(a,c,l){class e{constructor(){this._next=this._lastDragEvent=this._elevationInfo=this._view=null;this._enabled=!1}get enabled(){return this._enabled}set enabled(d){if(this._enabled!==d&&null!=this._lastDragEvent&&null!=this._next){const k=this._lastDragEvent.mapEnd,t=this._snap(this._lastDragEvent.screenEnd);
null!=t&&this._next.execute({action:"update",mapStart:this._lastDragEvent.mapStart,mapEnd:!0===d?t:k,screenStart:this._lastDragEvent.screenEnd,screenEnd:this._lastDragEvent.screenEnd})}this._enabled=d}_snap(d){d=null!=this._view?this._view.toMap(d,{exclude:[]}):null;null!=d&&null!=this._view&&(d.z=c.getZForElevationMode(d,this._view,this._elevationInfo));return d}createDragEventPipelineStep(d,k){this._view=d;this._elevationInfo=k;this._lastDragEvent=null;this._next=d=new l.EventPipeline;return[t=>
{this._lastDragEvent="end"!==t.action?{...t}:null;if(this._enabled){const u=this._snap(t.screenEnd);return null!=u?{action:t.action,mapStart:t.mapStart,mapEnd:u,screenStart:t.screenStart,screenEnd:t.screenEnd}:null}return{action:t.action,mapStart:t.mapStart,mapEnd:t.mapEnd,screenStart:t.screenStart,screenEnd:t.screenEnd}},d]}}a.SnapToScene=e;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/manipulations/MoveZManipulation":function(){define("exports ../../../../../Color ../../../../../core/colorUtils ../../../../../core/Evented ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../core/reactiveUtils ../../../../../chunks/mat4 ../../../../../chunks/mat4f64 ../../../../../chunks/vec3 ../../../../../chunks/vec3f64 ../../Manipulator3D ../../manipulatorUtils ../../RenderObject ../dragEventPipeline3D ../ManipulatorType ../settings ./config ./Manipulation ./moveUtils ../../../webgl-engine/lib/GeometryUtil ../../../webgl-engine/lib/Material ../../../../interactive/dragEventPipeline ../../../../interactive/interfaces".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m,n,h,q,z,r,D,v,I,p){class w extends z.Manipulation{constructor(L){super();this._radius=q.discRadius;this.events=new e;this._tool=L.tool;this._view=L.view;const x=new h.Settings({getTheme:()=>this._view.effectiveTheme});this._settings=x;null!=L.radius&&(this._radius=L.radius);L=this._view.effectiveTheme.accentColor;this._materials={materialUnfocused:b.createManipulatorMaterial(this._createDarkenedColor(L,1,.25),v.RenderOccludedFlag.Occlude),materialFocused:b.createManipulatorMaterial(this._createDarkenedColor(L,
1,0),v.RenderOccludedFlag.Occlude),materialOccludedUnfocused:b.createManipulatorMaterial(this._createDarkenedColor(L,.7,0),x.zManipulator.renderOccluded),materialOccludedFocused:b.createManipulatorMaterial(this._createDarkenedColor(L,.85,0),x.zManipulator.renderOccluded)};this._themeHandle=t.watch(()=>this._view.effectiveTheme.accentColor,H=>{const K=this._createDarkenedColor(H,1,.25),E=this._createDarkenedColor(H,1,0),M=this._createDarkenedColor(H,.7,0);H=this._createDarkenedColor(H,.85,0);const {materialUnfocused:O,
materialFocused:T,materialOccludedUnfocused:U,materialOccludedFocused:ba}=this._materials;O.setParameters({color:K});T.setParameters({color:E});U.setParameters({color:M});ba.setParameters({color:H})});this._createManipulator();this.forEachManipulator(H=>this._tool.manipulators.add(H))}destroy(){this._themeHandle=k.removeMaybe(this._themeHandle);this._manipulator.applyObjectTransform=J;this.forEachManipulator(L=>{this._tool.manipulators.remove(L);L.destroy()})}forEachManipulator(L){L(this._manipulator,
n.ManipulatorType.TRANSLATE_Z)}createGraphicDragPipeline(L,x,H){const K=x.graphic.geometry.spatialReference;return r.createGraphicMoveDragPipeline(x.graphic,H,E=>this.createDragPipeline((M,O,T,U,ba)=>{({steps:O,cancel:T}=L(M,O,T,U,ba));return E(M,O,T)},K),this._view.state.viewingMode)}createDragPipeline(L,x){const H=this._view;return I.createManipulatorDragEventPipeline(this._manipulator,(K,E,M,O,T)=>{E=E.next(U=>({...U,manipulatorType:n.ManipulatorType.TRANSLATE_Z})).next(m.screenToZConstrained(H,
K.renderLocation,x)).next(I.addScreenDelta());L(K,E,M,O,T)})}get radius(){return this._radius}set radius(L){L!==this._radius&&(this._radius=L,this._updateManipulator())}_updateManipulator(){var L=this._settings,x=this._radius/q.discRadius,H=L.zManipulator.height*x,K=L.zManipulator.coneHeight*x;const E=L.zManipulator.coneWidth*x;L=L.zManipulator.width*x;const M=[B.fromValues(0,0,0),B.fromValues(0,0,H)];x=[B.fromValues(0,0,0),B.fromValues(0,0,H+K)];const O=f.create();u.translate(O,O,[0,0,H]);u.rotateX(O,
O,Math.PI/2);const {materialUnfocused:T,materialFocused:U,materialOccludedUnfocused:ba,materialOccludedFocused:la}=this._materials;H=D.createTubeGeometry(T,M,L/2,16,!1);K=D.createConeGeometry(T,K,E/2,16,!1);K.transformation=O;this._manipulator.renderObjects=[new g.RenderObject(K,p.ManipulatorStateFlags.Unfocused),new g.RenderObject(H,p.ManipulatorStateFlags.Unfocused),new g.RenderObject(K.instantiate({material:U}),p.ManipulatorStateFlags.Focused),new g.RenderObject(H.instantiate({material:U}),p.ManipulatorStateFlags.Focused),
new g.RenderObject(K.instantiate({material:ba}),p.ManipulatorStateFlags.Unfocused),new g.RenderObject(H.instantiate({material:ba}),p.ManipulatorStateFlags.Unfocused),new g.RenderObject(K.instantiate({material:la}),p.ManipulatorStateFlags.Focused),new g.RenderObject(H.instantiate({material:la}),p.ManipulatorStateFlags.Focused)];this._manipulator.radius=L/2+2;this._manipulator.collisionType={type:"line",paths:[x]}}_createManipulator(){const L=this._view,x=new A.Manipulator3D({view:L,autoScaleRenderObjects:!1,
worldSized:!1,selectable:!1,cursor:"ns-resize",elevationInfo:this.elevationInfo,worldOriented:!0,collisionPriority:1.6});x.applyObjectTransform=H=>{var K=L.state.camera,E=C;L.renderCoordsHelper.toRenderCoords(this._manipulator.elevationAlignedLocation,E);const M=y.dist(K.eye,E),O=K.computeRenderPixelSizeAtDist(M);var T=y.subtract(F,E,K.eye);y.normalize(T,T);var U=G;L.renderCoordsHelper.worldUpAtPosition(C,U);E=Math.abs(y.dot(T,U));T=y.cross(F,T,U);U=y.cross(F,T,U);E=d.clamp(E,.01,1);K=1-Math.sqrt(1-
E*E)/E/K.fullWidth;E=this._radius/q.discRadius*this._settings.zManipulator.width;y.scale(U,y.normalize(U,U),(1/K-1)*M+O*E);H[12]-=F[0];H[13]-=F[1];H[14]-=F[2]};this._manipulator=x;this._updateManipulator()}_createDarkenedColor(L,x,H){L=l.darken(L,H);L.a*=x;return c.toUnitRGBA(L)}get test(){return{manipulator:this._manipulator}}}const C=B.create(),F=B.create(),G=B.create(),J=()=>{};a.MoveZManipulation=w;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/manipulations/MoveXYGraphicManipulation":function(){define("exports ../dragEventPipeline3D ../ManipulatorType ./Manipulation ./moveUtils ../../../../interactive/dragEventPipeline ../../../../interactive/GraphicManipulator".split(" "),
function(a,c,l,e,d,k,t){class u extends e.Manipulation{constructor(f){super();this._view=f.view;this._tool=f.tool;this._graphicState=f.graphicState;this._createManipulator();this.forEachManipulator(y=>this._tool.manipulators.add(y))}destroy(){this.forEachManipulator(f=>{this._tool.manipulators.remove(f);f.destroy()});this._graphicState=this._manipulator=this._view=this._tool=null}forEachManipulator(f){f(this._manipulator,l.ManipulatorType.TRANSLATE_XY)}createGraphicDragPipeline(f){return d.createGraphicMoveDragPipeline(this._graphicState.graphic,
f,y=>this.createDragPipeline(y),this._view.state.viewingMode)}createDragPipeline(f){const y=this._view,B=this._graphicState.graphic,A=null!=B.geometry?B.geometry.spatialReference:null;return k.createManipulatorDragEventPipeline(this._manipulator,(b,g,m,n,h)=>{g=g.next(c.screenToMapXYForGraphic(h,y,B,A)).next(k.addMapDelta()).next(k.addScreenDelta());f(b,g,m,n,h)})}_createManipulator(){this._manipulator=new t.GraphicManipulator({graphic:this._graphicState.graphic,view:this._view,selectable:!0,cursor:"move"})}}
a.MoveXYGraphicManipulation=u;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/GraphicManipulator":function(){define("exports ../../chunks/tslib.es6 ../../core/Accessor ../../core/Evented ../../core/reactiveUtils ../../core/screenUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../chunks/vec2 ../../chunks/vec3 ../../chunks/vec3f64 ../../geometry/projection ../../geometry/projection/projectPointToVector ../../support/elevationInfoUtils ../../symbols/support/defaults ../../symbols/support/ElevationInfo ./support/utils ../support/drapedUtils".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m,n,h,q,z,r,D){a.GraphicManipulator=class extends l{set graphic(p){this._circleCollisionCache=null;this._originalSymbol=p.symbol;this._set("graphic",p);this.attachSymbolChanged()}get elevationInfo(){var {layer:p}=this.graphic;p=p&&"elevationInfo"in p?p.elevationInfo:null;const w=h.getGraphicEffectiveElevationMode(this.graphic);return new z({mode:w,offset:p?p.offset:0})}set focusedSymbol(p){p!==this._get("focusedSymbol")&&(this._set("focusedSymbol",p),this._updateGraphicSymbol(),
this._circleCollisionCache=null)}grabbableForEvent(){return!0}set grabbing(p){p!==this._get("grabbing")&&(this._set("grabbing",p),this._updateGraphicSymbol())}set hovering(p){p!==this._get("hovering")&&(this._set("hovering",p),this._updateGraphicSymbol())}set selected(p){p!==this._get("selected")&&(this._set("selected",p),this._updateGraphicSymbol(),this.events.emit("select-changed",{action:p?"select":"deselect"}))}get _focused(){return this._get("hovering")||this._get("grabbing")}constructor(p){super(p);
this.layer=null;this.interactive=!0;this.selectable=!1;this.grabbable=!0;this.dragging=!1;this.cursor=null;this.consumesClicks=!0;this.events=new e.EventEmitter;this._originalSymbol=this._graphicSymbolChangedHandle=this._circleCollisionCache=null}destroy(){this.detachSymbolChanged();this._resetGraphicSymbol();this._set("view",null)}intersectionDistance(p){const w=this.graphic;if(!1===w.visible)return null;const C=w.geometry;if(null==C)return null;var F=this._get("focusedSymbol");F=null!=F?F:w.symbol;
return"2d"===this.view.type?this._intersectDistance2D(this.view,p,C,F):this._intersectDistance3D(this.view,p,w)}attach(){this.attachSymbolChanged();null!=this.layer&&this.layer.add(this.graphic)}detach(){this.detachSymbolChanged();this._resetGraphicSymbol();null!=this.layer&&this.layer.remove(this.graphic)}attachSymbolChanged(){this.detachSymbolChanged();this._graphicSymbolChangedHandle=d.watch(()=>this.graphic?.symbol,p=>{null!=p&&p!==this.focusedSymbol&&p!==this._originalSymbol&&(this._originalSymbol=
p,this._focused&&null!=this.focusedSymbol&&(this.graphic.symbol=this.focusedSymbol))},d.sync)}detachSymbolChanged(){null!=this._graphicSymbolChangedHandle&&(this._graphicSymbolChangedHandle.remove(),this._graphicSymbolChangedHandle=null)}onElevationChange(){}onViewChange(){}_updateGraphicSymbol(){this.graphic.symbol=this._focused&&null!=this.focusedSymbol?this.focusedSymbol:this._originalSymbol}_resetGraphicSymbol(){this.graphic.symbol=this._originalSymbol}_intersectDistance2D(p,w,C,F){F=F||q.getDefaultSymbol2D(C);
if(null==F)return null;var G=this._circleCollisionCache;if("point"===C.type&&"cim"===F.type&&"CIMPointSymbol"===F.data.symbol?.type&&F.data.symbol.symbolLayers){const {offsetX:J,offsetY:L,size:x}=r.getSymbolInfo(F);F=k.screenPointObjectToArray(w,I);G=x/2;p=p.toScreen(C);return A.squaredDistance(F,[p.x+J,p.y+L])<G*G?1:null}if("point"!==C.type||"simple-marker"!==F.type)return D.intersectsDrapedGeometry(w,C,p)?1:null;if(null==G||!G.originalPoint.equals(C)){const J=p.spatialReference;m.canProjectWithoutEngine(C.spatialReference,
J)&&(G=m.project(C,J),this._circleCollisionCache=G={originalPoint:C.clone(),mapPoint:G,radiusPx:k.pt2px(F.size)})}if(null!=G){C=k.screenPointObjectToArray(w,I);p=p.toScreen?.(G.mapPoint);if(!p)return null;G=G.radiusPx;w=p.x+k.pt2px(F.xoffset);F=p.y-k.pt2px(F.yoffset);return A.squaredDistance(C,[w,F])<G*G?1:null}return null}_intersectDistance3D(p,w,C){return(w=p.toMap(w,{include:[C]}))&&n.projectPointToVector(w,v,p.renderSpatialReference)?b.distance(v,p.state.camera.eye):null}};c.__decorate([t.property({constructOnly:!0,
nonNullable:!0})],a.GraphicManipulator.prototype,"graphic",null);c.__decorate([t.property()],a.GraphicManipulator.prototype,"elevationInfo",null);c.__decorate([t.property({constructOnly:!0,nonNullable:!0})],a.GraphicManipulator.prototype,"view",void 0);c.__decorate([t.property({value:null})],a.GraphicManipulator.prototype,"focusedSymbol",null);c.__decorate([t.property({constructOnly:!0})],a.GraphicManipulator.prototype,"layer",void 0);c.__decorate([t.property()],a.GraphicManipulator.prototype,"interactive",
void 0);c.__decorate([t.property()],a.GraphicManipulator.prototype,"selectable",void 0);c.__decorate([t.property()],a.GraphicManipulator.prototype,"grabbable",void 0);c.__decorate([t.property({value:!1})],a.GraphicManipulator.prototype,"grabbing",null);c.__decorate([t.property()],a.GraphicManipulator.prototype,"dragging",void 0);c.__decorate([t.property()],a.GraphicManipulator.prototype,"hovering",null);c.__decorate([t.property({value:!1})],a.GraphicManipulator.prototype,"selected",null);c.__decorate([t.property()],
a.GraphicManipulator.prototype,"cursor",void 0);a.GraphicManipulator=c.__decorate([B.subclass("esri.views.interactive.GraphicManipulator")],a.GraphicManipulator);const v=g.create(),I=k.createScreenPointArray();Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/support/utils":function(){define(["exports","../../../core/screenUtils"],function(a,c){a.getSymbolInfo=function(l){let e=0,d=0,k=0;if(!l)return{offsetX:e,offsetY:d,size:k};"cim"===l.type&&l.data.symbol&&
"symbolLayers"in l.data.symbol&&l.data.symbol.symbolLayers&&l.data.symbol.symbolLayers.map(t=>{"CIMVectorMarker"===t.type&&t.anchorPoint&&(Math.abs(t.anchorPoint.x)>e&&(e=t.anchorPoint.x),Math.abs(t.anchorPoint.y)>d&&(d=t.anchorPoint.y),null!=t.size&&t.size>k&&(k=t.size))});e=c.pt2px(e);d=c.pt2px(d);k=c.pt2px(k);return{offsetX:e,offsetY:d,size:k}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/drapedUtils":function(){define(["exports","../../geometry","../../core/unitUtils",
"../../renderers/support/clickToleranceUtils","../../geometry/Extent"],function(a,c,l,e,d){function k(u,f,y,B=new d){let A=0;if("2d"===y.type)A=f*(y.resolution??0);else if("3d"===y.type){var b=y.overlayPixelSizeInMapUnits(u),g=y.basemapSpatialReference;A=null==g||g.equals(y.spatialReference)?f*b:l.getMetersPerUnitForSR(g)/l.getMetersPerUnitForSR(y.spatialReference)}f=u.x-A;b=u.y-A;g=u.x+A;u=u.y+A;({spatialReference:y}=y);B.xmin=Math.min(f,g);B.ymin=Math.min(b,u);B.xmax=Math.max(f,g);B.ymax=Math.max(b,
u);B.spatialReference=y;return B}const t=new d;a.createQueryGeometry=k;a.intersectsDrapedGeometry=function(u,f,y){u=y.toMap(u);if(null==u)return!1;const B=e.calculateTolerance();return k(u,B,y,t).intersects(f)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/clickToleranceUtils":function(){define(["exports"],function(a){function c(d,k){return k?"xoffset"in k&&k.xoffset?Math.max(d,Math.abs(k.xoffset)):"yoffset"in k&&k.yoffset?Math.max(d,Math.abs(k.yoffset||0)):
d:d}function l(d,k){if("number"===typeof d)return d;if(d?.stops?.length){d=d.stops;let t=k=0;for(let u=0;u<d.length;u++){const f=d[u].size;"number"===typeof f&&(k+=f,t++)}return k/t}return k}function e(d,k){if(!k)return d;k=k.filter(f=>"size"===f.type).map(f=>{const {maxSize:y,minSize:B}=f;return(l(y,d)+l(B,d))/2});let t=0;const u=k.length;if(0===u)return d;for(let f=0;f<u;f++)t+=k[f];return Math.max(Math.floor(t/u),d)}a.calculateTolerance=function(d){const k=d?.renderer;d="touch"===d?.event?.pointerType?
9:6;if(!k)return d;d="visualVariables"in k?e(d,k.visualVariables):d;if("simple"===k.type)return c(d,k.symbol);if("unique-value"===k.type){let t=d;k.uniqueValueInfos?.forEach(u=>{t=c(t,u.symbol)});return t}if("class-breaks"===k.type){let t=d;k.classBreakInfos.forEach(u=>{t=c(t,u.symbol)});return t}return d};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/moveGraphic/isSupportedGraphic":function(){define(["exports","../../../../../core/has","../../../../../support/elevationInfoUtils",
"../isSupportedGraphicUtils"],function(a,c,l,e){a.isSupportedGraphic=function(d){if("graphics"!==d.layer?.type)return e.SupportedGraphicResult.GRAPHICS_LAYER_MISSING;if(null==d.geometry)return e.SupportedGraphicResult.GEOMETRY_MISSING;switch(d.geometry.type){case "polygon":case "point":case "polyline":case "mesh":break;case "multipoint":case "extent":return e.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED;default:return e.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED}return"on-the-ground"!==
l.getGraphicEffectiveElevationMode(d)&&l.hasGraphicFeatureExpressionInfo(d)?e.SupportedGraphicResult.ELEVATION_MODE_UNSUPPORTED:e.SupportedGraphicResult.SUPPORTED};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/TranslateTooltipInfos":function(){define("exports ../../../chunks/tslib.es6 ../../../core/quantityUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/subclass ./SketchTooltipInfo".split(" "),function(a,
c,l,e,d,k){a.TranslateGraphicTooltipInfo=class extends k.SketchTooltipInfo{constructor(t){super(t);this.type="translate-graphic";this.distance=l.zeroMeters}clear(){this.distance=l.zeroMeters}};c.__decorate([e.property()],a.TranslateGraphicTooltipInfo.prototype,"type",void 0);c.__decorate([e.property()],a.TranslateGraphicTooltipInfo.prototype,"distance",void 0);a.TranslateGraphicTooltipInfo=c.__decorate([d.subclass("esri.views.interactive.tooltip.TranslateGraphicTooltipInfo")],a.TranslateGraphicTooltipInfo);
a.TranslateGraphicZTooltipInfo=class extends k.SketchTooltipInfo{constructor(t){super(t);this.type="translate-graphic-z";this.distance=l.zeroMeters}clear(){this.distance=l.zeroMeters}};c.__decorate([e.property()],a.TranslateGraphicZTooltipInfo.prototype,"type",void 0);c.__decorate([e.property()],a.TranslateGraphicZTooltipInfo.prototype,"distance",void 0);a.TranslateGraphicZTooltipInfo=c.__decorate([d.subclass("esri.views.interactive.tooltip.TranslateGraphicZTooltipInfo")],a.TranslateGraphicZTooltipInfo);
a.TranslateGraphicXYTooltipInfo=class extends k.SketchTooltipInfo{constructor(t){super(t);this.type="translate-graphic-xy";this.distance=l.zeroMeters}};c.__decorate([e.property()],a.TranslateGraphicXYTooltipInfo.prototype,"type",void 0);c.__decorate([e.property()],a.TranslateGraphicXYTooltipInfo.prototype,"distance",void 0);a.TranslateGraphicXYTooltipInfo=c.__decorate([d.subclass("esri.views.interactive.tooltip.TranslateGraphicXYTooltipInfo")],a.TranslateGraphicXYTooltipInfo);a.TranslateVertexTooltipInfo=
class extends k.SketchTooltipInfo{constructor(t){super(t);this.type="translate-vertex";this.distance=l.zeroMeters;this.totalLength=this.area=this.elevation=null}clear(){this.distance=l.zeroMeters;this.totalLength=this.area=this.elevation=null}};c.__decorate([e.property()],a.TranslateVertexTooltipInfo.prototype,"type",void 0);c.__decorate([e.property()],a.TranslateVertexTooltipInfo.prototype,"distance",void 0);c.__decorate([e.property()],a.TranslateVertexTooltipInfo.prototype,"elevation",void 0);c.__decorate([e.property()],
a.TranslateVertexTooltipInfo.prototype,"area",void 0);c.__decorate([e.property()],a.TranslateVertexTooltipInfo.prototype,"totalLength",void 0);a.TranslateVertexTooltipInfo=c.__decorate([d.subclass("esri.views.interactive.tooltip.TranslateVertexTooltipInfo")],a.TranslateVertexTooltipInfo);a.TranslateVertexZTooltipInfo=class extends k.SketchTooltipInfo{constructor(t){super(t);this.type="translate-vertex-z";this.distance=l.zeroMeters;this.elevation=null}clear(){this.distance=l.zeroMeters;this.elevation=
null}};c.__decorate([e.property()],a.TranslateVertexZTooltipInfo.prototype,"type",void 0);c.__decorate([e.property()],a.TranslateVertexZTooltipInfo.prototype,"distance",void 0);c.__decorate([e.property()],a.TranslateVertexZTooltipInfo.prototype,"elevation",void 0);a.TranslateVertexZTooltipInfo=c.__decorate([d.subclass("esri.views.interactive.tooltip.TranslateVertexZTooltipInfo")],a.TranslateVertexZTooltipInfo);a.TranslateVertexXYTooltipInfo=class extends k.SketchTooltipInfo{constructor(t){super(t);
this.type="translate-vertex-xy";this.distance=l.zeroMeters;this.totalLength=this.area=this.elevation=null}clear(){this.distance=l.zeroMeters;this.totalLength=this.area=this.elevation=null}};c.__decorate([e.property()],a.TranslateVertexXYTooltipInfo.prototype,"type",void 0);c.__decorate([e.property()],a.TranslateVertexXYTooltipInfo.prototype,"distance",void 0);c.__decorate([e.property()],a.TranslateVertexXYTooltipInfo.prototype,"elevation",void 0);c.__decorate([e.property()],a.TranslateVertexXYTooltipInfo.prototype,
"area",void 0);c.__decorate([e.property()],a.TranslateVertexXYTooltipInfo.prototype,"totalLength",void 0);a.TranslateVertexXYTooltipInfo=c.__decorate([d.subclass("esri.views.interactive.tooltip.TranslateVertexXYTooltipInfo")],a.TranslateVertexXYTooltipInfo);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/reshapeGraphic/GraphicReshapeTool":function(){define("exports ../../../../../chunks/tslib.es6 ../../../../../core/Evented ../../../../../core/maybe ../../../../../core/reactiveUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/accessorSupport/ensureType ../../../../../core/arrayUtils ../../../../../core/has ../../../../../core/accessorSupport/decorators/subclass ../isSupportedGraphicUtils ./isSupportedGraphic ./ReshapeOperation ../../../../interactive/InteractiveToolBase ../../../../interactive/sketch/SketchLabelOptions ../../../../interactive/sketch/SketchTooltipOptions".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m,n){a.GraphicReshapeTool=class extends l.EventedMixin(g.InteractiveToolBase){constructor(h){super(h);this._internalGeometryUpdate=!1;this.enableMidpoints=this.enableMoveGraphic=this.enableZVertex=this.enableZShape=!0;this.enableEdgeOffset=!1;this.type="reshape-3d";this.labelOptions=new m;this.tooltipOptions=new n;this.snappingManager=null;this.automaticManipulatorSelection=!1}initialize(){const h=this._reshapeOperation=new b.ReshapeOperation({tool:this});this.addHandles([h.on("reshape",
q=>{"reshape"===q.type&&this._onReshapeGeometryChanged();this.emit("reshape",q)}),h.on("move",q=>{"move"===q.type&&this._onReshapeGeometryChanged();this.emit("move",q)}),h.on("vertex-add",q=>{this._onReshapeGeometryChanged();this.emit("vertex-add",q)}),h.on("vertex-remove",q=>{this._onReshapeGeometryChanged();this.emit("vertex-remove",q)}),h.on("immediate-click",q=>this.emit("immediate-click",q)),this.view.on("pointer-down",["Shift"],q=>q.stopPropagation()),d.watch(()=>this.graphic,()=>this._updateGraphic(),
d.syncAndInitial)]);this.finishToolCreation()}destroy(){this._reshapeOperation=e.destroyMaybe(this._reshapeOperation)}get updating(){return this._reshapeOperation?.updating??!1}_updateGeometry(){const h=A.geometryOfSupportedGraphic(this.graphic);this._reshapeOperation.inputGeometry=null!=h?h.clone():null}_updateGraphic(){this.removeHandles("onGraphicGeometryChange");this._updateGeometry();if(A.isSupportedGraphic(this.graphic)===B.SupportedGraphicResult.SUPPORTED){var h=d.watch(()=>this.graphic?.geometry,
()=>{!1===this._internalGeometryUpdate&&this._updateGeometry()},d.sync);this.addHandles(h,"onGraphicGeometryChange")}}onManipulatorSelectionChanged(){if(this._reshapeOperation)this._reshapeOperation.onManipulatorSelectionChanged()}_updateGeometryInternally(h){this._internalGeometryUpdate=!0;const {graphic:q}=this,{geometry:z}=q;"mesh"===z?.type&&"point"===h.type?(q.geometry=z.centerAt(h),q.notifyGeometryChanged()):q.geometry=h;this._internalGeometryUpdate=!1}_onReshapeGeometryChanged(){const {outputGeometry:h}=
this._reshapeOperation;null!=this.graphic&&h&&this._updateGeometryInternally(h.clone())}get canUndo(){return this._reshapeOperation.canUndo??!1}undo(){null!=this.snappingManager&&this.snappingManager.doneSnapping();const h=this._reshapeOperation.undo(),{outputGeometry:q}=this._reshapeOperation;h&&q&&this._updateGeometryInternally(q.clone())}get canRedo(){return this._reshapeOperation.canRedo??!1}redo(){null!=this.snappingManager&&this.snappingManager.doneSnapping();const h=this._reshapeOperation.redo(),
{outputGeometry:q}=this._reshapeOperation;h&&q&&this._updateGeometryInternally(q.clone())}onInputEvent(h){"key-down"!==h.type||"Delete"!==h.key&&"Backspace"!==h.key||this._reshapeOperation.removeSelectedVertices()}reset(){}get test(){return{snappingManager:this.snappingManager,reshapeOperation:this._reshapeOperation}}};c.__decorate([k.property()],a.GraphicReshapeTool.prototype,"_reshapeOperation",void 0);c.__decorate([k.property({constructOnly:!0,nonNullable:!0})],a.GraphicReshapeTool.prototype,"view",
void 0);c.__decorate([k.property({constructOnly:!0})],a.GraphicReshapeTool.prototype,"graphic",void 0);c.__decorate([k.property({constructOnly:!0,nonNullable:!0})],a.GraphicReshapeTool.prototype,"enableZShape",void 0);c.__decorate([k.property({constructOnly:!0,nonNullable:!0})],a.GraphicReshapeTool.prototype,"enableZVertex",void 0);c.__decorate([k.property({constructOnly:!0,nonNullable:!0})],a.GraphicReshapeTool.prototype,"enableMoveGraphic",void 0);c.__decorate([k.property({constructOnly:!0,nonNullable:!0})],
a.GraphicReshapeTool.prototype,"enableMidpoints",void 0);c.__decorate([k.property({constructOnly:!0,nonNullable:!0})],a.GraphicReshapeTool.prototype,"enableEdgeOffset",void 0);c.__decorate([k.property()],a.GraphicReshapeTool.prototype,"type",void 0);c.__decorate([k.property({constructOnly:!0,type:m})],a.GraphicReshapeTool.prototype,"labelOptions",void 0);c.__decorate([k.property({constructOnly:!0,type:n})],a.GraphicReshapeTool.prototype,"tooltipOptions",void 0);c.__decorate([k.property({constructOnly:!0})],
a.GraphicReshapeTool.prototype,"snappingManager",void 0);c.__decorate([k.property()],a.GraphicReshapeTool.prototype,"updating",null);c.__decorate([k.property()],a.GraphicReshapeTool.prototype,"automaticManipulatorSelection",void 0);a.GraphicReshapeTool=c.__decorate([y.subclass("esri.views.3d.interactive.editingTools.graphicReshape3D.GraphicReshapeTool")],a.GraphicReshapeTool);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/reshapeGraphic/isSupportedGraphic":function(){define(["exports",
"../../../../../geometry/Circle","../../../../../support/elevationInfoUtils","../isSupportedGraphicUtils"],function(a,c,l,e){function d(k){if("graphics"!==k.layer?.type)return{result:e.SupportedGraphicResult.GRAPHICS_LAYER_MISSING,geometry:null};const {geometry:t}=k;if(null==t)return{result:e.SupportedGraphicResult.GEOMETRY_MISSING,geometry:null};if("on-the-ground"!==l.getGraphicEffectiveElevationMode(k)&&l.hasGraphicFeatureExpressionInfo(k))return{result:e.SupportedGraphicResult.ELEVATION_MODE_UNSUPPORTED,
geometry:null};const u=t.type;return"point"!==u&&"mesh"!==u&&"polyline"!==u&&("polygon"!==u||k.geometry instanceof c)?{result:e.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED,geometry:null}:{result:e.SupportedGraphicResult.SUPPORTED,geometry:t}}a.geometryOfSupportedGraphic=function(k){return d(k).geometry};a.isSupportedGraphic=function(k){return d(k).result};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/reshapeGraphic/ReshapeOperation":function(){define("exports ../../../../../chunks/tslib.es6 ../../../../../geometry ../../../../../core/Accessor ../../../../../core/arrayUtils ../../../../../core/colorUtils ../../../../../core/has ../../../../../core/Evented ../../../../../core/Handles ../../../../../core/handleUtils ../../../../../core/maybe ../../../../../core/quantityUtils ../../../../../core/reactiveUtils ../../../../../core/unitUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/accessorSupport/ensureType ../../../../../core/accessorSupport/decorators/subclass ../../../../../chunks/mat4f64 ../../../../../chunks/vec3 ../../../../../chunks/vec3f64 ../../../../../core/support/UpdatingHandles ../../../../../geometry/Polyline ../../../../../geometry/support/coordsUtils ../../../../../geometry/support/plane ../../../../../geometry/support/vectorStacks ../../../../../layers/graphics/dehydratedPoint ../../../../../support/elevationInfoUtils ../../../../../symbols/support/utils ../../Manipulator3D ../../manipulatorUtils ../../RenderObject ../../SegmentLabels3D ../../SnappingVisualizer3D ../dragEventPipeline3D ../geometryUtils ../ManipulatorType ../manipulatorUtils ../settings ../visualElementUtils ../manipulations/config ../manipulations/MoveManipulation ../manipulations/moveUtils ../manipulations/MoveXYGraphicManipulation ./edgeOffsetUtils ../../visualElements/OutlineVisualElement ../../../layers/graphics/GraphicState ../../../webgl-engine/lib/GeometryUtil ../../../../input/IViewEvents ../../../../interactive/dragEventPipeline ../../../../interactive/interfaces ../../../../interactive/editGeometry/EditGeometryOperations ../../../../interactive/editGeometry/interfaces ../../../../interactive/snapping/SnappingContext ../../../../interactive/snapping/SnappingDragPipelineStep ../../../../interactive/tooltip/ReshapeTooltipInfos ../../../../interactive/tooltip/Tooltip ../../../../interactive/tooltip/TranslateTooltipInfos ../../../../interactive/tooltip/fields/fields ../../../../support/automaticAreaMeasurementUtils ../../../../support/automaticLengthMeasurementUtils ../../../../support/euclideanLengthMeasurementUtils ../../../../support/geodesicLengthMeasurementUtils ../../../../../geometry/SpatialReference".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m,n,h,q,z,r,D,v,I,p,w,C,F,G,J,L,x,H,K,E,M,O,T,U,ba,la,fa,P,X,ma,aa,W,ia,ha,V,ea,Q,Z,na,va,ra,oa,ta,za,N,R,pa,sa,ua){a.ReshapeOperation=class extends u.EventedMixin(e){constructor(S){super(S);this._selectedIndex=0;this._manipulatorHandles=new f;this._manipulatorInfos=[];this._numDragging=this._numGrabbing=0;this._reshapeEventState=Ba.NONE;this._updatingHandles=new D.UpdatingHandles;this._recreatingManipulators=!1;this._settings=new U.Settings({getTheme:()=>this.view.effectiveTheme});
this._vertexLaserLineVisualElement=this.outputGeometry=this._edgeOffsetTooltipInfo=this._translateVertexZTooltipInfo=this._translateVertexXYTooltipInfo=this._translateVertexTooltipInfo=this._translateGraphicZTooltipInfo=this._translateGraphicXYTooltipInfo=this._translateGraphicTooltipInfo=null}initialize(){const {graphic:S,view:Y}=this;var da=this._settings.manipulators,ca=da.vertex;this._vertexManipulatorMaterial=L.createManipulatorMaterial(k.unitRGBAFromColor(ca.color),ca.renderOccluded);this._vertexManipulatorOutlineMaterial=
L.createManipulatorOutlineMaterial(k.unitRGBAFromColor(ca.outlineColor),ca.renderOccluded);this._vertexManipulatorHoverOutlineMaterial=L.createManipulatorOutlineMaterial(k.unitRGBAFromColor(ca.hoverOutlineColor),ca.renderOccluded);ca=da.edge;this._edgeManipulatorMaterial=L.createManipulatorMaterial(k.unitRGBAFromColor(ca.color),ca.renderOccluded);this._edgeManipulatorOutlineMaterial=L.createManipulatorOutlineMaterial(k.unitRGBAFromColor(ca.outlineColor),ca.renderOccluded);ca=da.edgeOffset;this._edgeOffsetManipulatorMaterial=
L.createManipulatorMaterial(k.unitRGBAFromColor(ca.color),ca.renderOccluded,!1);this._edgeOffsetManipulatorHoverMaterial=L.createManipulatorMaterial(k.unitRGBAFromColor(ca.hoverColor),ca.renderOccluded,!1);da=da.selected;this._selectedManipulatorMaterial=L.createManipulatorMaterial(k.unitRGBAFromColor(da.color),da.renderOccluded);this._selectedManipulatorOutlineMaterial=L.createManipulatorOutlineMaterial(k.unitRGBAFromColor(da.outlineColor),da.renderOccluded);this._selectedManipulatorHoverOutlineMaterial=
L.createManipulatorOutlineMaterial(k.unitRGBAFromColor(da.hoverOutlineColor),da.renderOccluded);const ja=this._graphicState=new W.GraphicState({graphic:S});this._tooltip=new oa.Tooltip({view:Y});this.addHandles([b.watch(()=>{const ka=this._settings.manipulators;return{vertexSettings:ka.vertex,edgeSettings:ka.edge,edgeOffsetSettings:ka.edgeOffset,selectedSettings:ka.selected}},({vertexSettings:ka,edgeSettings:qa,edgeOffsetSettings:ya,selectedSettings:wa})=>{ka.applyColor(this._vertexManipulatorMaterial);
ka.applyOutline(this._vertexManipulatorOutlineMaterial);ka.applyHoverOutline(this._vertexManipulatorHoverOutlineMaterial);qa.applyColor(this._edgeManipulatorMaterial);qa.applyOutline(this._edgeManipulatorOutlineMaterial);ya.applyColor(this._edgeOffsetManipulatorMaterial);ya.applyHover(this._edgeOffsetManipulatorHoverMaterial);wa.applyColor(this._selectedManipulatorMaterial);wa.applyOutline(this._selectedManipulatorOutlineMaterial);wa.applyHoverOutline(this._selectedManipulatorHoverOutlineMaterial)}),
b.watch(()=>ja.displaying,ka=>{for(const qa of this._manipulatorInfos)qa.manipulator.available=ka}),b.watch(()=>({labels:this._segmentLabels,enabled:this._labelOptions.enabled,edgeOffsetEnabled:this.enableEdgeOffset}),({labels:ka,enabled:qa,edgeOffsetEnabled:ya})=>{null!=ka&&(ka.visible=qa,ka.edgeDistance=ya?"far":"default")},b.initial),b.when(()=>!this._tooltipOptions.enabled,()=>this._tooltip.clear(),b.initial),this.view.trackGraphicState(ja)])}destroy(){this._segmentLabels=B.destroyMaybe(this._segmentLabels);
this._tooltip=B.destroyMaybe(this._tooltip);this._removeManipulators();this._updatingHandles.destroy()}get inputGeometry(){return null!=this._editGeometryOperations?this._editGeometryOperations.data.geometry:null}set inputGeometry(S){this._recreateEditGeometryAndManipulators(S)}get updating(){return this._updatingHandles.updating}get manipulators(){return this.tool.manipulators}get view(){return this.tool.view}get graphic(){return this.tool.graphic}get enableZShape(){return this.tool.enableZShape}get enableZVertex(){return this.tool.enableZVertex}get enableMoveGraphic(){return this.tool.enableMoveGraphic}get enableMidpoints(){return this.tool.enableMidpoints}get enableEdgeOffset(){return this.tool.enableEdgeOffset}get _labelOptions(){return this.tool.labelOptions}get _tooltipOptions(){return this.tool.tooltipOptions}get _accentColor(){return this.view.effectiveTheme.accentColor}removeSelectedVertices(){const S=
this._manipulatorInfos.filter(Y=>Y.manipulator.selected&&"vertex"===Y.type);this._removeVertices(S)}onManipulatorSelectionChanged(){this.emit("manipulators-changed")}_removeManipulators(){this._manipulatorHandles.removeAll();this._moveManipulation=B.destroyMaybe(this._moveManipulation);this._graphicMoveManipulation=B.destroyMaybe(this._graphicMoveManipulation);this.manipulators.removeAll();this._manipulatorInfos=[];this._numDragging=this._numGrabbing=0}_createManipulators(S){if(null!=this._editGeometryOperations){var Y=
F.getGraphicEffectiveElevationInfo(this.graphic);for(const da of this._editGeometryOperations.data.components){const ca=S?.byComponentIndex.get(da.index);for(const ja of da.vertices){const ka=ca?.has(ja.index);this._createVertexOrEdgeManipulator(ja,Y,ka)}for(const ja of da.edges)this._createVertexOrEdgeManipulator(ja,Y)}this._createGraphicMoveManipulation();this._createMoveManipulation(Y);this._createVisualElements()}}get canRedo(){return null!=this._editGeometryOperations&&this._editGeometryOperations.canRedo}get canUndo(){return null!=
this._editGeometryOperations&&this._editGeometryOperations.canUndo}redo(){if(null==this._editGeometryOperations)return null;const S=this._editGeometryOperations.redo();null!=S&&(this.outputGeometry=this._editGeometryOperations.data.geometry,this._recreateManipulators());return S}undo(){if(null==this._editGeometryOperations)return null;this.emit("undo");const S=this._editGeometryOperations.undo();null!=S&&(this.outputGeometry=this._editGeometryOperations.data.geometry,this._recreateManipulators());
return S}_recreateManipulators(){this._recreatingManipulators||(this._recreatingManipulators=!0,this._removeManipulators(),this._tooltip.clear(),this._createManipulators(),this._recreatingManipulators=!1)}_recreateEditGeometryAndManipulators(S){const Y={byComponentIndex:new Map};if(null!=S&&null!=this.inputGeometry&&I.hasCompatibleTopology(S,this.inputGeometry))for(const da of this._manipulatorInfos)if("vertex"===da.type&&da.manipulator.selected){const {index:ca,component:{index:ja}}=da.handle,{byComponentIndex:ka}=
Y,qa=ka.get(ja)||new Set;qa.add(ca);ka.set(ja,qa)}this._recreatingManipulators=!0;this._removeManipulators();this._tooltip.clear();this._editGeometryOperations=B.destroyMaybe(this._editGeometryOperations);this._segmentLabels=B.destroyMaybe(this._segmentLabels);null!=S&&(this._editGeometryOperations=Q.EditGeometryOperations.fromGeometry("mesh"===S.type?S.anchor:S,this.view.state.viewingMode),this._createManipulators(Y),this._segmentLabels=new H.SegmentLabels3D({context:{view:this.view,editGeometryOperations:this._editGeometryOperations,
elevationInfo:F.getGraphicEffectiveElevationInfo(this.graphic),labelOptions:this._labelOptions,graphic:this.graphic,graphicState:this._graphicState},visible:this._labelOptions.enabled}));this._recreatingManipulators=!1}_perGraphicManipulatorDragAction(S,Y){if("end"===Y.action)return Y;let da=0;const ca=[],ja=this._manipulatorInfos.some(ka=>"vertex"===ka.type&&ka.manipulator.selected);S=S===Ga.SELECTED_OR_ALL&&ja;for(const ka of this._manipulatorInfos)"vertex"===ka.type&&(ka.manipulator.grabbing||
S&&!ka.manipulator.selected||ca.push(ka),da++);if(0===ca.length)return Y;this._moveVertices(ca,Y);if(ca.length===da){this._updateEventState(Ba.MOVING);if(this.destroyed)return Y;this.emit("move",{type:"move",dx:Y.screenDeltaX,dy:Y.screenDeltaY,mover:this.graphic})}else{this._updateEventState(Ba.RESHAPING);if(this.destroyed)return Y;this.emit("reshape",{type:"reshape",mover:this.graphic})}return Y}_isMultiVertexSelection(){return 1<this._manipulatorInfos.reduce((S,Y)=>"vertex"===Y.type&&Y.manipulator.selected?
S+1:S,0)}_perVertexManipulatorDragAction(S){this._updateEventState(Ba.RESHAPING);if(!this.destroyed){var {mapDeltaX:Y,mapDeltaY:da,mapDeltaZ:ca}=S;if(Y||da||ca){var ja=[];for(const ka of this._manipulatorInfos)"vertex"===ka.type&&(ka.manipulator.selected&&!ka.manipulator.grabbing||ka===S.info)&&ja.push(ka);this._moveVertices(ja,S,Z.AccumulationBehaviour.ACCUMULATE_STEPS);this.emit("reshape",{type:"reshape",mover:this.graphic})}}}_updateEventState(S){if(S===this._reshapeEventState)return!1;switch(S){case Ba.NONE:if(0!==
this._numGrabbing||0!==this._numDragging)return!1;switch(this._reshapeEventState){case Ba.MOVING:this.emit("move",{type:"move-stop",dx:0,dy:0,mover:this.graphic});break;case Ba.RESHAPING:this.emit("reshape",{type:"reshape-stop",mover:this.graphic})}break;case Ba.MOVING:switch(this._reshapeEventState){case Ba.NONE:this.emit("move",{type:"move-start",dx:0,dy:0,mover:this.graphic});break;case Ba.RESHAPING:this.emit("reshape",{type:"reshape-stop",mover:this.graphic}),this.destroyed||this.emit("move",
{type:"move-start",dx:0,dy:0,mover:this.graphic})}break;case Ba.RESHAPING:switch(this._reshapeEventState){case Ba.NONE:this.emit("reshape",{type:"reshape-start",mover:this.graphic});break;case Ba.MOVING:this.emit("move",{type:"move-stop",dx:0,dy:0,mover:this.graphic}),this.destroyed||this.emit("reshape",{type:"reshape-start",mover:this.graphic})}}if(this.destroyed)return!1;const Y=this._reshapeEventState!==S;this._reshapeEventState=S;return Y}_createGraphicMoveManipulation(){const {tool:S,view:Y}=
this;this._graphicMoveManipulation=new X.MoveXYGraphicManipulation({tool:S,view:Y,graphicState:this._graphicState});if(this.enableMoveGraphic){let da=null;this._manipulatorHandles.add(this._graphicMoveManipulation.createDragPipeline((ca,ja,ka)=>{ja.next(qa=>this._trackNumDragging(qa)).next(qa=>{"start"===qa.action&&(da=this._editGeometryOperations.createUndoGroup());return qa}).next(qa=>this._perGraphicManipulatorDragAction(Ga.ALL,qa)).next(qa=>{this._updateTranslateGraphicTooltip(fa.ManipulationType.XY,
qa);return qa}).next(qa=>{"end"===qa.action&&(this._tooltip.clear(),da=B.removeMaybe(da))});ka.next(()=>this._onDragCancel(!0,()=>da=B.removeMaybe(da)))}));this._graphicMoveManipulation.forEachManipulator(ca=>this._manipulatorHandles.add(this._watchAndUpdateGrabState(ca,!1)))}else this._graphicMoveManipulation.forEachManipulator(da=>{da.grabbable=!1;da.cursor=null});this._graphicMoveManipulation.forEachManipulator(da=>this._manipulatorHandles.add(da.events.on("immediate-click",ca=>{this._manipulatorInfos.some(ja=>
ja.manipulator.selected)?this._clearSelection():this.emit("immediate-click",{...ca,graphic:this.graphic});ca.stopPropagation()})))}_createMoveManipulation(S){const {graphic:Y,tool:da,view:ca}=this,ja=this._graphicState;this._moveManipulation=new fa.MoveManipulation({tool:da,view:ca,xyAvailable:!0,xyAxisAvailable:!0,zAvailable:this.enableZShape&&T.canMoveZ(Y),snapToScene:!1,radius:fa.MoveManipulation.radiusForSymbol(Y.symbol)});this._moveManipulation.forEachManipulator(qa=>this.addHandles([qa.events.on("immediate-click",
ya=>{this._moveManipulation.zManipulation.hasManipulator(qa)||this._manipulatorInfos.some(wa=>wa.manipulator.selected)||this.emit("immediate-click",{...ya,graphic:Y});ya.stopPropagation()}),this._watchAndUpdateGrabState(qa,!1)]));const ka=qa=>ya=>{this.addHandles(ya.events.on("focus-changed",({action:wa})=>{"focus"===wa&&this._tooltipOptions.enabled?this._updateTranslateTooltip(qa):this._tooltip.clear()}))};this._moveManipulation.xyManipulation.forEachManipulator(ka(fa.ManipulationType.XY));this._moveManipulation.xyAxisManipulation.forEachManipulator(ka(fa.ManipulationType.XY_AXIS));
this._moveManipulation.zManipulation.forEachManipulator(ka(fa.ManipulationType.Z));this._moveManipulation.elevationInfo={mode:"absolute-height",offset:0};this.addHandles([this._moveManipulation.createDragPipeline((qa,ya,wa,Ca,Fa)=>{const {snappingStep:Ha,cancelSnapping:Ja}=va.createSnapDragEventPipelineStep({predicate:Ea=>!!Ea.info,snappingManager:da.snappingManager,snappingContext:new na.SnappingContext({editGeometryOperations:this._editGeometryOperations,elevationInfo:S,pointer:Fa,excludeFeature:Y,
visualizer:new K.SnappingVisualizer3D}),updatingHandles:this._updatingHandles,useZ:!1});Ca=Ca.next(Ea=>{this._onDragCancel();return Ea}).next(Ja);wa=wa.next(Ea=>this._trackNumDragging(Ea)).next(Ea=>{const Ka=this._manipulatorInfos.filter(Ia=>"vertex"===Ia.type&&Ia.manipulator.selected);return Ea.manipulatorType===O.ManipulatorType.TRANSLATE_XY&&1===Ka.length?{...Ea,info:Ka[0],snapOrigin:Ka[0].handle.pos}:Ea}).next(V.sceneSnappingAtLocation(this.view,S,Y)).next(...Ha).next(V.addMapDelta()).next(Ea=>
this._perGraphicManipulatorDragAction(Ga.SELECTED_OR_ALL,Ea)).next(Ea=>{this._updateTranslateTooltip(qa,Ea);return Ea});return{steps:wa,cancel:Ca}},S,Y.geometry.spatialReference,Y),b.watch(()=>ja.displaying,()=>this._updateMoveManipulationPosition(),b.initial),ja.on("changed",()=>{this._recreatingManipulators||this._updateMoveManipulationPosition()}),b.watch(()=>ja.isDraped,qa=>{this._updateMoveManipulationPosition();qa?this.addHandles(this.view.elevationProvider.on("elevation-change",()=>this._updateMoveManipulationPosition()),
"align-move-manipulation"):this.removeHandles("align-move-manipulation")},b.initial)])}_createVisualElements(){const {graphic:S,view:Y}=this,da=ba.createVisualElements({view:Y,graphic:S,forEachManipulator:ca=>{if(!this.destroyed&&!this._recreatingManipulators){this._graphicMoveManipulation.forEachManipulator(ca);this._moveManipulation.forEachManipulator(ca);for(const ja of this._manipulatorInfos)ca(ja.manipulator,O.ManipulatorType.TRANSLATE_XY)}},onManipulatorsChanged:ca=>this.on("manipulators-changed",
ca)});null!=da&&(this._outlineVisualElement=da.visualElement instanceof aa.OutlineVisualElement?da.visualElement:null);null!=this._outlineVisualElement&&this._manipulatorHandles.add(this._outlineVisualElement.events.on("attachment-origin-changed",()=>{this._graphicState.isDraped||this._updateMoveManipulationPosition()}));this._manipulatorHandles.add(da)}_createEdgeOffsetManipulator(S,Y=F.getGraphicEffectiveElevationInfo(this.graphic)){var da=this._settings.manipulators.edgeOffset,ca=da.size/2,ja=
ca+da.collisionPadding;ca/=ja;const ka=ca*Math.sqrt(3)/2;null==this._edgeOffsetManipulatorGeometryInside&&(this._edgeOffsetManipulatorGeometryInside=ia.createExtrudedTriangle(this._edgeOffsetManipulatorMaterial,ka,ca/2,ca/2,da.height,da.offset));null==this._edgeOffsetManipulatorGeometryOutside&&(this._edgeOffsetManipulatorGeometryOutside=ia.createExtrudedTriangle(this._edgeOffsetManipulatorMaterial,-ka,ca/2,ca/2,da.height,-da.offset));ca=[new x.RenderObject(this._edgeOffsetManipulatorGeometryInside.instantiate(),
ea.ManipulatorStateFlags.Unfocused),new x.RenderObject(this._edgeOffsetManipulatorGeometryInside.instantiate({material:this._edgeOffsetManipulatorHoverMaterial}),ea.ManipulatorStateFlags.Focused),new x.RenderObject(this._edgeOffsetManipulatorGeometryOutside.instantiate(),ea.ManipulatorStateFlags.Unfocused),new x.RenderObject(this._edgeOffsetManipulatorGeometryOutside.instantiate({material:this._edgeOffsetManipulatorHoverMaterial}),ea.ManipulatorStateFlags.Focused)];ja=new J.Manipulator3D({view:this.view,
renderObjects:ca,elevationInfo:"on-the-ground"!==Y.mode||G.isVolumetricSymbol(this.graphic.symbol)?{mode:"absolute-height",offset:0}:Y,worldOriented:!1,focusMultiplier:1,radius:ja,available:!(!this.graphic.visible||!this.graphic.layer?.visible),collisionType:{type:"disc",direction:r.fromValues(0,0,1)},collisionPriority:1,metadata:{deleting:!1}});ca=new J.Manipulator3D({view:this.view,worldSized:!0,worldOriented:!1,available:!(!this.graphic.visible||!this.graphic.layer?.visible),collisionPriority:-10,
cursor:this.enableMoveGraphic?"move":"default",metadata:{deleting:!1}});const qa={manipulator:ja,handle:S,locationUpdateHandle:null,type:"edge",selectedIndex:0,edgeManipulator:ca,elevationInfo:Y,visibilityHandle:null};this._autoHideEdgeOffsetManipulator(qa,da.minSquaredEdgeLength);this._updateEdgeOffsetManipulator(qa);S=[];for(var ya of[qa.handle.leftVertex,qa.handle.rightVertex])da=this._getManipulatorInfoFromHandle(ya),null!=da&&S.push(da.manipulator.events.on("location-update",()=>this._updateEdgeOffsetManipulator(qa)));
qa.locationUpdateHandle=y.handlesGroup(S);this._manipulatorHandles.add(qa.locationUpdateHandle,ja);this._manipulatorHandles.add([this._watchAndUpdateGrabState(ja,!0),this._watchAndUpdateGrabState(ca,!0)],ja);this._manipulatorHandles.add(V.createManipulatorDragEventPipeline(ja,this._createEdgeOffsetPipeline(qa,Y)),ja);this._manipulatorHandles.add(V.createManipulatorDragEventPipeline(ca,(wa,Ca,Fa,Ha)=>{if("touch"===Ha)this._createEdgeOffsetPipeline(qa,Y)(wa,Ca,Fa);else if(this.enableMoveGraphic){Ha=
this.graphic;const Ja=null!=Ha.geometry?Ha.geometry.spatialReference:null;Ca.next(Ea=>this._trackNumDragging(Ea)).next(V.dragAtLocation(this.view,wa.elevationAlignedLocation)).next(E.screenToMapXYAtLocation(this.view,wa.elevationAlignedLocation,Y,Ja,Ha)).next(V.addScreenDelta()).next(V.addMapDelta()).next(Ea=>this._perGraphicManipulatorDragAction(Ga.ALL,Ea)).next(Ea=>{this._updateTranslateGraphicTooltip(fa.ManipulationType.XY,Ea);return Ea}).next(Ea=>{"end"===Ea.action&&this._tooltip.clear()});Fa.next(()=>
this._onDragCancel(!wa.metadata.deleting))}}),ja);ya=wa=>{this._manipulatorInfos.some(Ca=>Ca.manipulator.selected)?this._clearSelection():this.emit("immediate-click",{...wa,graphic:this.graphic});wa.stopPropagation()};this._manipulatorHandles.add([ja.events.on("immediate-click",ya),ca.events.on("immediate-click",ya),ja.events.on("focus-changed",({action:wa})=>{const {_tooltipOptions:Ca,_tooltip:Fa}=this;"focus"===wa&&Ca.enabled?(Fa.info=this._edgeOffsetTooltipInfo??(this._edgeOffsetTooltipInfo=new ra.ReshapeEdgeOffsetTooltipInfo({tooltipOptions:Ca})),
Fa.info.distance=A.zeroMeters,Fa.info.tooltipOptions=Ca,this._updateTooltipAreaOrTotalLength(Fa.info)):Fa.clear()})],ja);this._manipulatorInfos.push(qa);this.manipulators.add(ja);this.manipulators.add(ca);this.emit("manipulators-changed");return qa}_autoHideEdgeOffsetManipulator(S,Y){const da=S.manipulator,ca=S.edgeManipulator,ja=()=>{S.visibilityHandle=B.removeMaybe(S.visibilityHandle);var ka=this._getManipulatorInfoFromHandle(S.handle.leftVertex);const qa=this._getManipulatorInfoFromHandle(S.handle.rightVertex);
ka=null!=ka&&null!=qa&&ma.screenEdgeLengthSquared(ka.manipulator.renderLocation,qa.manipulator.renderLocation,this.view.state.camera)<Y;if(!da.focused&&!ca.focused||ka)da.grabbable=!ka,ca.grabbable=!ka,S.visibilityHandle=y.handlesGroup([da.disableDisplay(),y.makeHandle(()=>{da.grabbable=!0;ca.grabbable=this.enableMoveGraphic})])};this._manipulatorHandles.add([da.events.on("focus-changed",ja),ca.events.on("focus-changed",ja),y.makeHandle(()=>{B.removeMaybe(S.visibilityHandle);ca.metadata.deleting=
!0;this.manipulators.remove(ca)})],da);ja()}_updateEdgeOffsetManipulator(S){this._updateManipulatorPosition(S);var {coordinateHelper:Y}=this._editGeometryOperations.data;Y=ma.createEdgeOffsetIntersectionPlane(this.view,S.manipulator.elevationAlignedLocation,ma.createEdgeOffsetOperation(Y,S.handle,S.manipulator.elevationInfo));var da=this._getManipulatorInfoFromHandle(S.handle.leftVertex),ca=this._getManipulatorInfoFromHandle(S.handle.rightVertex);null!=da&&null!=ca&&(da=da.manipulator.renderLocation,
ca=ca.manipulator.renderLocation,Y=null!=Y?ma.edgeOffsetRotationMatrix(Y,da,ca):q.IDENTITY,S.manipulator.modelTransform=Y,S.edgeManipulator.elevationAlignedLocation=S.manipulator.elevationAlignedLocation,S.edgeManipulator.modelTransform=Y,Y=z.length(z.subtract(Aa,da,ca))/2,S.edgeManipulator.collisionType={type:"line",paths:[[[-Y,0,0],[Y,0,0]]]})}_createEdgeOffsetPipeline(S,Y){return(da,ca,ja)=>{this._clearSelection();const {step:ka,cleanup:qa}=this._initializeEdgeOffset(S,Y);ca.next(ya=>this._trackNumDragging(ya)).next(V.dragAtLocation(this.view,
da.elevationAlignedLocation)).next(ka).next(E.screenToRenderPlaneFromEvent(this.view)).next(E.convertToMapCoordinates(this.view,this._editGeometryOperations.data.spatialReference)).next(V.addMapDelta()).next(this._applyComputeEdgeOffsetDistanceStep()).next(this._applyEdgeOffsetStep(S)).next(this._showEdgeOffsetTooltip()).next(ya=>{"end"===ya.action&&qa()});ja.next(()=>{da.metadata.deleting||(qa(),this._onDragCancel())})}}_initializeEdgeOffset(S,Y){var {view:da}=this;const ca=this._editGeometryOperations,
ja=ma.createEdgeOffsetOperation(ca.data.coordinateHelper,S.handle,Y);Y=ca.createUndoGroup();const ka=ma.createEdgeOffsetIntersectionPlane(da,S.manipulator.elevationAlignedLocation,ja);if(ja.requiresSplitEdgeLeft){var qa=this._getManipulatorInfoFromHandle(S.handle.leftVertex.leftEdge);null!=qa&&this._splitEdgeManipulator(qa,1)}ja.requiresSplitEdgeRight&&(qa=this._getManipulatorInfoFromHandle(S.handle.rightVertex.rightEdge),null!=qa&&this._splitEdgeManipulator(qa,0));const ya=()=>new v({paths:[[S.handle.leftVertex.pos,
S.handle.rightVertex.pos]],spatialReference:ca.data.spatialReference});qa=this._settings;const wa=new aa.OutlineVisualElement({view:da,isDraped:this._graphicState.isDraped,geometry:ya(),elevationInfo:S.elevationInfo,width:qa.visualElements.lineGraphics.outline.width,attached:!1,isDecoration:!0});let Ca;const Fa=()=>{this._cleanEdgeOffsetCollapsedEdges(S);Ca=B.removeMaybe(Ca)};da=this.on("undo",Fa);Ca=y.handlesGroup([b.watch(()=>k.unitRGBAFromColor(this._accentColor),Ha=>wa.color=Ha,b.initial),y.destroyHandle(wa),
b.watch(()=>this._graphicState.isDraped,Ha=>wa.isDraped=Ha),this._graphicState.on("changed",()=>wa.geometry=ya()),Y,da]);wa.attached=!0;return{step:Ha=>null==ja||null==ka?(Fa(),null):{...Ha,operation:ja,plane:ka},cleanup:Fa}}_applyEdgeOffsetStep(S){return Y=>{if(this.destroyed||null==Y.operation)return Y;this._updateEventState(Ba.RESHAPING);const {mapDeltaX:da,mapDeltaY:ca,mapDeltaZ:ja}=Y;if(da||ca||ja)this._offsetEdge(S,Y),this.emit("reshape",{type:"reshape",mover:this.graphic});return Y}}_applyComputeEdgeOffsetDistanceStep(){return S=>
{const {operation:Y,mapEnd:da}=S;if(null==Y||null==da)return S;"start"===S.action&&Y.selectArrowFromStartPoint(da);return{...S,signedDistance:Y.signedDistanceToPoint(da)}}}_showEdgeOffsetTooltip(){return S=>{const {mapEnd:Y,signedDistance:da,operation:ca}=S,{_tooltip:ja,_tooltipOptions:ka}=this;if(!ka.enabled||null==da)return ja.clear(),S;ja.info=this._edgeOffsetTooltipInfo??(this._edgeOffsetTooltipInfo=new ra.ReshapeEdgeOffsetTooltipInfo({tooltipOptions:ka}));ja.info.tooltipOptions=ka;var qa=ja.info;
if("end"===S.action)var ya=A.zeroMeters;else a:{ya=da*ca.selectedArrow;var wa=ca.plane,Ca=this._editGeometryOperations.data.coordinateHelper;if(this._graphicState.isDraped){const Fa=Ca.toXYZ(Ca.pointToVector(Y));wa=p.projectPoint(wa,Fa,w.sv3d.get());Ca=sa.geodesicDistance(wa,Fa,Ca.spatialReference);if(null!=Ca){ya=A.createLength(Ca.value*Math.sign(ya),Ca.unit);break a}}ya=A.createLength(ya*g.getMetersPerUnitForSR(Y.spatialReference),"meters")}qa.distance=ya;this._updateTooltipAreaOrTotalLength(ja.info);
return S}}_cleanEdgeOffsetCollapsedEdges(S){var Y=S.handle.leftVertex.leftEdge?.leftVertex,da=S.handle.leftVertex;const ca=S.handle.rightVertex.rightEdge?.rightVertex,ja=S.handle.rightVertex,ka=this._editGeometryOperations.data.coordinateHelper;S=[];Y&&1E-6>ka.distance(Y.pos,da.pos)&&(Y=this._getManipulatorInfoFromHandle(da),null!=Y&&S.push(Y));if(1E-6>ka.distance(da.pos,ja.pos)||ca&&1E-6>ka.distance(ca.pos,ja.pos))da=this._getManipulatorInfoFromHandle(ja),null!=da&&S.push(da);S.length&&this._removeVertices(S)}_computeVertexManipulatorSizeAndOutline(S){const Y=
S.size/2,da=Y+S.collisionPadding;return{size:Y/da,outlineSize:(Y+S.outlineSize)/da}}_createVertexOrEdgeManipulator(S,Y=F.getGraphicEffectiveElevationInfo(this.graphic),da=!1){const {view:ca}=this;var ja=this._settings;if("edge"===S.type){if(this.enableEdgeOffset)return this._createEdgeOffsetManipulator(S,Y);if(!this.enableMidpoints)return null}if(null==this._vertexManipulatorGeometry||null==this._vertexManipulatorOutlineGeometry){const {size:wa,outlineSize:Ca}=this._computeVertexManipulatorSizeAndOutline(ja.manipulators.vertex);
this._vertexManipulatorGeometry=ia.createSphereGeometry(this._vertexManipulatorMaterial,wa,16,16);this._vertexManipulatorOutlineGeometry=ia.createSphereGeometry(this._vertexManipulatorOutlineMaterial,Ca,16,16)}if(null==this._edgeManipulatorGeometry||null==this._edgeManipulatorOutlineGeometry){const {size:wa,outlineSize:Ca}=this._computeVertexManipulatorSizeAndOutline(ja.manipulators.edge);this._edgeManipulatorGeometry=ia.createSphereGeometry(this._edgeManipulatorMaterial,wa,16,16);this._edgeManipulatorOutlineGeometry=
ia.createSphereGeometry(this._edgeManipulatorOutlineMaterial,Ca,16,16)}({geometry:ja}=this.graphic);ja=ja?.type;ja="point"===ja||"mesh"===ja?[]:[new x.RenderObject(this._vertexManipulatorGeometry.instantiate(),Da.Vertex|ea.ManipulatorStateFlags.Unselected),new x.RenderObject(this._vertexManipulatorOutlineGeometry.instantiate(),Da.Vertex|ea.ManipulatorStateFlags.Unfocused|ea.ManipulatorStateFlags.Unselected),new x.RenderObject(this._vertexManipulatorOutlineGeometry.instantiate({material:this._vertexManipulatorHoverOutlineMaterial}),
Da.Vertex|ea.ManipulatorStateFlags.Focused|ea.ManipulatorStateFlags.Unselected),new x.RenderObject(this._vertexManipulatorGeometry.instantiate({material:this._selectedManipulatorMaterial}),ea.ManipulatorStateFlags.Selected),new x.RenderObject(this._vertexManipulatorOutlineGeometry.instantiate({material:this._selectedManipulatorOutlineMaterial}),ea.ManipulatorStateFlags.Selected|ea.ManipulatorStateFlags.Unfocused),new x.RenderObject(this._vertexManipulatorOutlineGeometry.instantiate({material:this._selectedManipulatorHoverOutlineMaterial}),
ea.ManipulatorStateFlags.Selected|ea.ManipulatorStateFlags.Focused)];this.enableMidpoints&&ja.push(new x.RenderObject(this._edgeManipulatorGeometry.instantiate({material:this._vertexManipulatorMaterial}),Da.Edge|ea.ManipulatorStateFlags.Focused|ea.ManipulatorStateFlags.Unselected),new x.RenderObject(this._edgeManipulatorOutlineGeometry.instantiate({material:this._vertexManipulatorHoverOutlineMaterial}),Da.Edge|ea.ManipulatorStateFlags.Focused|ea.ManipulatorStateFlags.Unselected),new x.RenderObject(this._edgeManipulatorGeometry.instantiate(),
Da.Edge|ea.ManipulatorStateFlags.Unfocused|ea.ManipulatorStateFlags.Unselected),new x.RenderObject(this._edgeManipulatorOutlineGeometry.instantiate(),Da.Edge|ea.ManipulatorStateFlags.Unfocused|ea.ManipulatorStateFlags.Unselected));const ka=new J.Manipulator3D({view:ca,renderObjects:ja,elevationInfo:Y,focusMultiplier:1,touchMultiplier:1,available:!(!this.graphic.visible||!this.graphic.layer?.visible),metadata:{deleting:!1}});ka.selected=da;this._setTypeSpecificManipulatorSettings(ka,S,Y);const qa=
"edge"===S.type?{manipulator:ka,handle:S,locationUpdateHandle:null,type:"edge",selectedIndex:0}:{manipulator:ka,handle:S,type:"vertex",selectedIndex:0};this._manipulatorInfos.push(qa);this.manipulators.add(ka);this._updateManipulatorPosition(qa);if("edge"===qa.type){S=[];for(var ya of[qa.handle.leftVertex,qa.handle.rightVertex])da=this._getManipulatorInfoFromHandle(ya),null!=da&&S.push(da.manipulator.events.on("location-update",()=>this._updateManipulatorPosition(qa)));qa.locationUpdateHandle=y.handlesGroup(S);
this._manipulatorHandles.add(qa.locationUpdateHandle,ka)}this._manipulatorHandles.add(this._watchAndUpdateGrabState(ka,!0),ka);ya=V.createManipulatorDragEventPipeline(ka,(wa,Ca,Fa,Ha)=>{let Ja=null;const {snappingStep:Ea,cancelSnapping:Ka}=va.createSnapDragEventPipelineStep({predicate:()=>!this._isMultiVertexSelection(),snappingManager:this.tool.snappingManager,snappingContext:new na.SnappingContext({editGeometryOperations:this._editGeometryOperations,elevationInfo:Y,pointer:Ha,excludeFeature:this.graphic,
visualizer:new K.SnappingVisualizer3D}),updatingHandles:this._updatingHandles,useZ:!1});Fa=Fa.next(Ia=>{this._onDragCancel(!wa.metadata.deleting,()=>Ja=B.removeMaybe(Ja));return Ia}).next(Ka);Ca.next(Ia=>this._trackNumDragging(Ia)).next(Ia=>{"start"===Ia.action&&(Ja=this._editGeometryOperations.createUndoGroup());if("edge"===qa.type){const La=this._splitEdgeManipulator(qa);return{...Ia,info:La,snapOrigin:La.handle.pos}}return{...Ia,info:qa,snapOrigin:qa.handle.pos}}).next(V.dragAtLocation(this.view,
wa.elevationAlignedLocation)).next(E.screenToMapXYForGraphicAtLocation(this.view,this.graphic,wa.elevationAlignedLocation,wa.location.spatialReference,this.graphic)).next(V.sceneSnappingAtLocation(this.view,Y,this.graphic)).next(...Ea).next(V.addMapDelta()).next(Ia=>{this._perVertexManipulatorDragAction(Ia);"end"===Ia.action&&(Ja=B.removeMaybe(Ja));this._updateTranslateVertexTooltip(wa,fa.ManipulationType.XY,Ia)})});this._manipulatorHandles.add([ya,ka.events.on("immediate-click",wa=>this._manipulatorClickCallback(wa,
qa)),ka.events.on("select-changed",()=>{qa.selectedIndex=++this._selectedIndex;this._updateMoveManipulationPosition()}),ka.events.on("focus-changed",({action:wa})=>{"focus"===wa&&"edge"!==qa.type?this._updateTranslateVertexTooltip(ka,fa.ManipulationType.XY):this._tooltip.clear()})],ka);this.emit("manipulators-changed");return qa}_trackNumDragging(S){switch(S.action){case "start":this._numDragging++;break;case "end":this._numDragging--}return S}_onDragCancel(S=!0,Y){this._numDragging--;S&&(this.undo(),
this.outputGeometry=null!=this._editGeometryOperations?this._editGeometryOperations.data.geometry:null);null!=this.tool.snappingManager&&this.tool.snappingManager.doneSnapping();this._tooltip.clear();switch(this._reshapeEventState){case Ba.MOVING:this.emit("move",{type:"move",dx:0,dy:0,mover:this.graphic});break;case Ba.RESHAPING:this.emit("reshape",{type:"reshape",mover:this.graphic})}Y&&Y();this.destroyed||this._updateEventState(Ba.NONE)}_setTypeSpecificManipulatorSettings(S,Y,da){const {graphic:ca}=
this,ja=this._settings;switch(Y.type){case "vertex":S.state=Da.Vertex;S.selectable=!0;S.cursor="move";S.collisionPriority=2;const {size:ka,collisionPadding:qa}=ja.manipulators.vertex;S.radius=ka/2+qa;S.elevationInfo=da;({geometry:Y}=ca);Y=Y?.type;S.interactive=null!=Y&&"point"!==Y&&"mesh"!==Y;break;case "edge":S.state=Da.Edge;S.selectable=!1;S.cursor="copy";S.collisionPriority=-1;const {size:ya,collisionPadding:wa}=ja.manipulators.edge;S.radius=ya/2+wa;S.elevationInfo="on-the-ground"!==da.mode||G.isVolumetricSymbol(ca.symbol)?
{mode:"absolute-height",offset:0}:da}}_watchAndUpdateGrabState(S,Y){return S.events.on("grab-changed",da=>this._onGrabStateChanged(S,Y,da.action,da.pointerType))}_onGrabStateChanged(S,Y,da,ca="mouse"){if(!this._recreatingManipulators){if("start"===da)Y&&this._updateSelection(S),this._numGrabbing++;else if(this._numGrabbing--,this._updateEventState(Ba.NONE),this.destroyed)return;this._moveManipulation.interactive=!this._numGrabbing;if("touch"!==ca||this.enableEdgeOffset)this._manipulatorInfos.forEach(ja=>
{const {manipulator:ka}=ja;var {geometry:qa}=this.graphic;qa=qa?.type;ka.interactive=ka.grabbing||!this._numGrabbing&&null!=qa&&"point"!==qa&&"mesh"!==qa;"edgeManipulator"in ja&&(ja.edgeManipulator.interactive=ja.edgeManipulator.grabbing||!this._numGrabbing)}),this._graphicMoveManipulation.forEachManipulator(ja=>{ja.interactive=ja.grabbing||!this._numGrabbing})}}_clearSelection(){for(const S of this._manipulatorInfos)S.manipulator.grabbing||(S.manipulator.selected=!1)}_updateSelection(S){S.grabbing&&
!S.selected&&S.selectable&&(this._clearSelection(),S.selected=!0,this.emit("manipulators-changed"))}_removeManipulator(S){null!=S&&(S.manipulator.metadata.deleting=!0,this.manipulators.remove(S.manipulator),this._manipulatorHandles.remove(S.manipulator),d.removeUnordered(this._manipulatorInfos,S),this.emit("manipulators-changed"))}_getManipulatorInfoFromHandle(S){if(S)for(const Y of this._manipulatorInfos)if(S===Y.handle)return Y;return null}_updateManipulatorPosition(S){if(null!=S){var Y=this._editGeometryOperations;
if("vertex"===S.type)S.manipulator.location=Y.data.coordinateHelper.vectorToDehydratedPoint(S.handle.pos,xa),S.manipulator.grabbing&&null!=this._vertexLaserLineVisualElement&&(this._vertexLaserLineVisualElement.visualElement.intersectsWorldUpAtLocation=S.manipulator.renderLocation);else if("edge"===S.type){var da=this._getManipulatorInfoFromHandle(S.handle.leftVertex),ca=this._getManipulatorInfoFromHandle(S.handle.rightVertex);null!=da&&null!=ca&&(da=da.manipulator,ca=ca.manipulator,null!=S.manipulator.elevationInfo&&
"on-the-ground"===S.manipulator.elevationInfo.mode?(da=da.location,ca=ca.location,S.manipulator.location=C.makeDehydratedPoint(da.x+.5*(ca.x-da.x),da.y+.5*(ca.y-da.y),da.hasZ&&ca.hasZ?0:void 0,Y.data.spatialReference)):(z.lerp(Aa,da.renderLocation,ca.renderLocation,.5),S.manipulator.renderLocation=Aa))}}}_splitEdgeManipulator(S,Y=.5){var da=this._editGeometryOperations;Y=da.splitEdge(S.handle,Y).createdVertex;S.locationUpdateHandle=B.removeMaybe(S.locationUpdateHandle);var ca=F.getGraphicEffectiveElevationInfo(this.graphic);
let ja;this.enableEdgeOffset?(this._removeManipulator(S),ja=this._createVertexOrEdgeManipulator(Y)):(ja=S,ja.handle=Y,ja.type="vertex",this._setTypeSpecificManipulatorSettings(S.manipulator,S.handle,ca));Y.leftEdge&&this._createVertexOrEdgeManipulator(Y.leftEdge);Y.rightEdge&&this._createVertexOrEdgeManipulator(Y.rightEdge);this.outputGeometry=da.data.geometry;this._updateManipulatorPosition(ja);this.enableEdgeOffset||this._updateTranslateVertexTooltip(ja.manipulator,fa.ManipulationType.XY);this._updateSelection(S.manipulator);
S=this._updateEventState(Ba.RESHAPING);ca=da.data.coordinateHelper.vectorToArray(ja.handle.pos);da=da.data.components.indexOf(Y.component);this.emit("vertex-add",{type:"vertex-add",vertices:[{coordinates:ca,componentIndex:da,vertexIndex:Y.index}],added:ca});S&&this._updateEventState(Ba.NONE);return ja}_updateMoveManipulationPosition(){const S=z.set(Aa,0,0,0);let Y=0,da=!1;var ca=null;let ja=null;for(var ka of this._manipulatorInfos)if("vertex"===ka.type)if(ka.manipulator.selected)if(Y++,z.add(S,S,
ka.manipulator.renderLocation),null==ca||ka.selectedIndex>ca.selectedIndex)ja=ca,ca=ka;else{if(null==ja||ka.selectedIndex>ja.selectedIndex)ja=ka}else da=!0;if(0===Y)ca=this._graphicState.displaying&&this.enableMoveGraphic,this._moveManipulation.xyManipulation.available=ca,this._moveManipulation.xyAxisManipulation.available=ca,this._moveManipulation.xyAxisManipulation.orthogonalAvailable=ca,this._moveManipulation.zManipulation.available=ca&&this.enableZShape&&T.canMoveZ(this.graphic),this._moveManipulation.angle=
M.orientation(this.graphic.geometry),this._moveManipulation.radius=fa.MoveManipulation.radiusForSymbol(this.graphic.symbol);else{ka=this._graphicState.displaying;this._moveManipulation.xyManipulation.available=ka;this._moveManipulation.xyAxisManipulation.available=ka;this._moveManipulation.zManipulation.available=ka&&this.enableZVertex&&T.canMoveZ(this.graphic);this._moveManipulation.xyAxisManipulation.orthogonalAvailable=ka&&1!==Y;ka=0;if(null!=ca){const qa=ca.handle.pos,ya=null!=ja?ja.handle.pos:
ca.handle.leftEdge&&ca.handle.leftEdge.leftVertex?ca.handle.leftEdge.leftVertex.pos:null;ca=null==ja&&ca.handle.rightEdge&&ca.handle.rightEdge.rightVertex?ca.handle.rightEdge.rightVertex.pos:null;ya&&ca?this._moveManipulation.xyAxisManipulation.available=!1:ya?ka=Math.atan2(qa[1]-ya[1],qa[0]-ya[0])+Math.PI/2:ca&&(ka=Math.atan2(ca[1]-qa[1],ca[0]-qa[0])+Math.PI/2)}this._moveManipulation.angle=ka;this._moveManipulation.radius=la.discRadiusSmall}0!==Y&&da?(z.scale(S,S,1/Y),xa.spatialReference=this._editGeometryOperations.data.spatialReference,
xa.hasZ=!0,this.view.renderCoordsHelper.fromRenderCoords(S,xa),this._moveManipulation.elevationAlignedLocation=xa):null==this._outlineVisualElement||this._graphicState.isDraped||null==this._outlineVisualElement.attachmentOrigin?L.placeAtGraphic(this.view,this._moveManipulation,this.graphic):this._moveManipulation.elevationAlignedLocation=this._outlineVisualElement.attachmentOrigin}_removeVertices(S){var Y=[];const da=this._editGeometryOperations;for(var ca of S)"vertex"===ca.type&&da.canRemoveVertex(ca.handle.component)&&
(Y.push(ca.handle),this._removeManipulator(ca),this._removeManipulator(this._getManipulatorInfoFromHandle(ca.handle.leftEdge)),this._removeManipulator(this._getManipulatorInfoFromHandle(ca.handle.rightEdge)),(S=da.removeVertices([ca.handle]).removedVertices?.[0].createdEdge)&&this._createVertexOrEdgeManipulator(S));if(0<Y.length&&(Y=Y.map(ja=>{const ka=da.data.components.indexOf(ja.component);return{coordinates:da.data.coordinateHelper.vectorToArray(ja.pos),componentIndex:ka,vertexIndex:ja.index}}),
this.outputGeometry=da.data.geometry,ca=this._updateEventState(Ba.RESHAPING),!this.destroyed&&(this.emit("vertex-remove",{type:"vertex-remove",removed:Y.map(ja=>ja.coordinates),vertices:Y}),!this.destroyed))){if(ca&&(this._updateEventState(Ba.NONE),this.destroyed))return;this._updateMoveManipulationPosition()}}_moveVertices(S,Y,da="start"===Y.action?Z.AccumulationBehaviour.NEW_STEP:Z.AccumulationBehaviour.ACCUMULATE_STEPS){const ca=this._editGeometryOperations;ca.moveVertices(S.map(ja=>ja.handle),
Y.mapDeltaX,Y.mapDeltaY,Y.mapDeltaZ,da);this.outputGeometry=ca.data.geometry;for(const ja of S)this._updateManipulatorPosition(ja)}_offsetEdge(S,Y){if(null!=Y.operation&&null!=Y.signedDistance){var da=this._editGeometryOperations,ca=Y.operation.clone();ca.distance=Y.signedDistance;da.updateVertices([S.handle.leftVertex,S.handle.rightVertex],ca);this.outputGeometry=da.data.geometry;this._updateManipulatorPosition(this._getManipulatorInfoFromHandle(S.handle.leftVertex));this._updateManipulatorPosition(this._getManipulatorInfoFromHandle(S.handle.rightVertex))}}_manipulatorClickCallback(S,
Y){S.shiftKey||this._clearSelection();"vertex"===Y.type&&(Y.manipulator.selected=!Y.manipulator.selected,S.button===ha.MouseButton.Right&&this._removeVertices([Y]));"edge"===Y.type&&S.button===ha.MouseButton.Left&&this._splitEdgeManipulator(Y);S.stopPropagation()}_updateTranslateTooltip(S,Y){const da=this._manipulatorInfos.filter(ca=>"vertex"===ca.type&&ca.manipulator.selected);1===da.length?this._updateTranslateVertexTooltip(da[0].manipulator,S,Y):this._updateTranslateGraphicTooltip(S,Y)}_updateTranslateGraphicTooltip(S,
Y){const {_tooltipOptions:da,_tooltip:ca}=this;if(da.enabled){var ja=this._graphicState.isDraped?"on-the-ground":"absolute-height";switch(S){case fa.ManipulationType.XY:ca.info=this._translateGraphicTooltipInfo??(this._translateGraphicTooltipInfo=new ta.TranslateGraphicTooltipInfo({tooltipOptions:da}));this._updateTranslateTooltipDistance(ca.info,Y,(ka,qa)=>R.autoHorizontalDistanceByElevationModeBetweenPoints(ka,qa,ja));break;case fa.ManipulationType.XY_AXIS:ca.info=this._translateGraphicXYTooltipInfo??
(this._translateGraphicXYTooltipInfo=new ta.TranslateGraphicXYTooltipInfo({tooltipOptions:da}));this._updateTranslateTooltipDistance(ca.info,Y,(ka,qa)=>{ka=R.autoHorizontalDistanceByElevationModeBetweenPoints(ka,qa,ja);return A.scale(ka,P.axisConstrainedDragSign(Y))});break;case fa.ManipulationType.Z:ca.info=this._translateGraphicZTooltipInfo??(this._translateGraphicZTooltipInfo=new ta.TranslateGraphicZTooltipInfo({tooltipOptions:da})),this._updateTranslateTooltipDistance(ca.info,Y,pa.verticalSignedDistanceBetweenPoints)}ca.info.tooltipOptions=
da}}_updateTranslateVertexTooltip(S,Y,da){const {_tooltipOptions:ca,_tooltip:ja}=this;if(ca.enabled){var ka=this._graphicState.isDraped?"on-the-ground":"absolute-height";switch(Y){case fa.ManipulationType.XY:ja.info=this._translateVertexTooltipInfo??(this._translateVertexTooltipInfo=new ta.TranslateVertexTooltipInfo({tooltipOptions:ca}));this._updateTranslateTooltipDistance(ja.info,da,(qa,ya)=>R.autoHorizontalDistanceByElevationModeBetweenPoints(qa,ya,ka));this._updateTooltipAreaOrTotalLength(ja.info);
break;case fa.ManipulationType.XY_AXIS:ja.info=this._translateVertexXYTooltipInfo??(this._translateVertexXYTooltipInfo=new ta.TranslateVertexXYTooltipInfo({tooltipOptions:ca}));this._updateTranslateTooltipDistance(ja.info,da,(qa,ya)=>{qa=R.autoHorizontalDistanceByElevationModeBetweenPoints(qa,ya,ka);return A.scale(qa,P.axisConstrainedDragSign(da))});this._updateTooltipAreaOrTotalLength(ja.info);break;case fa.ManipulationType.Z:ja.info=this._translateVertexZTooltipInfo??(this._translateVertexZTooltipInfo=
new ta.TranslateVertexZTooltipInfo({tooltipOptions:ca})),this._updateTranslateTooltipDistance(ja.info,da,pa.verticalSignedDistanceBetweenPoints)}S=pa.elevationOfPoint(S.elevationAlignedLocation);null!=S&&(ja.info.elevation=za.makeElevationField({actual:S}));ja.info.tooltipOptions=ca}}_updateTranslateTooltipDistance(S,Y,da){if(null!=Y&&"end"!==Y.action){const {mapStart:ca,mapEnd:ja}=Y;Y=da(ca,ja);S.distance=null!=Y?Y:A.zeroMeters}else S.distance=A.zeroMeters}_updateTooltipAreaOrTotalLength(S){const {geometry:Y}=
this.graphic;if(null==Y)S.area=null,S.totalLength=null;else{var da=this._graphicState.isDraped?"on-the-ground":"absolute-height";S.area="polygon"===Y.type?N.autoAreaByElevationMode(Y,da):null;S.totalLength="polyline"===Y.type?R.autoLengthByElevationMode(Y,da):null}}get test(){return{segmentLabels:this._segmentLabels,tooltip:this._tooltip}}};c.__decorate([m.property()],a.ReshapeOperation.prototype,"_editGeometryOperations",void 0);c.__decorate([m.property()],a.ReshapeOperation.prototype,"_segmentLabels",
void 0);c.__decorate([m.property({constructOnly:!0})],a.ReshapeOperation.prototype,"tool",void 0);c.__decorate([m.property()],a.ReshapeOperation.prototype,"_tooltip",void 0);c.__decorate([m.property()],a.ReshapeOperation.prototype,"inputGeometry",null);c.__decorate([m.property()],a.ReshapeOperation.prototype,"outputGeometry",void 0);c.__decorate([m.property({readOnly:!0})],a.ReshapeOperation.prototype,"updating",null);c.__decorate([m.property()],a.ReshapeOperation.prototype,"manipulators",null);c.__decorate([m.property()],
a.ReshapeOperation.prototype,"view",null);c.__decorate([m.property()],a.ReshapeOperation.prototype,"graphic",null);c.__decorate([m.property()],a.ReshapeOperation.prototype,"enableZShape",null);c.__decorate([m.property()],a.ReshapeOperation.prototype,"enableZVertex",null);c.__decorate([m.property()],a.ReshapeOperation.prototype,"enableMoveGraphic",null);c.__decorate([m.property()],a.ReshapeOperation.prototype,"enableMidpoints",null);c.__decorate([m.property()],a.ReshapeOperation.prototype,"enableEdgeOffset",
null);c.__decorate([m.property()],a.ReshapeOperation.prototype,"_labelOptions",null);c.__decorate([m.property()],a.ReshapeOperation.prototype,"_tooltipOptions",null);c.__decorate([m.property()],a.ReshapeOperation.prototype,"_accentColor",null);a.ReshapeOperation=c.__decorate([h.subclass("esri.views.3d.interactive.editingTools.reshapeGraphic.ReshapeOperation")],a.ReshapeOperation);const xa=C.makeDehydratedPoint(0,0,void 0,ua.WGS84),Aa=r.create();var Da;(function(S){S.Vertex=ea.ManipulatorStateCustomFlags.Custom1;
S.Edge=ea.ManipulatorStateCustomFlags.Custom2})(Da||(Da={}));var Ba;(function(S){S[S.NONE=0]="NONE";S[S.MOVING=1]="MOVING";S[S.RESHAPING=2]="RESHAPING"})(Ba||(Ba={}));var Ga;(function(S){S[S.ALL=0]="ALL";S[S.SELECTED_OR_ALL=1]="SELECTED_OR_ALL"})(Ga||(Ga={}));Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/reshapeGraphic/edgeOffsetUtils":function(){define("exports ../../../../../core/screenUtils ../../../../../chunks/mat4f64 ../../../../../chunks/vec3 ../../../../../chunks/vec3f64 ../../../../../geometry/support/plane ../../../../../layers/graphics/dehydratedPoint ../../../../interactive/editGeometry/operations/OffsetEdgeVertex".split(" "),
function(a,c,l,e,d,k,t,u){function f(y,B,A){A=t.makeDehydratedPoint(B.x+A[0],B.y+A[1],B.z+A[2],B.spatialReference);const b=d.create(),g=d.create();return y.renderCoordsHelper.toRenderCoords(B,b)&&y.renderCoordsHelper.toRenderCoords(A,g)?e.direction(g,b,g):null}a.createEdgeOffsetIntersectionPlane=function(y,B,A){const b=d.create();if(!y.renderCoordsHelper.toRenderCoords(B,b))return null;var g=f(y,B,k.normal(A.plane));y=f(y,B,A.edgeDirection);if(null==g||null==y)return null;g=e.cross(d.create(),g,y);
return k.fromPositionAndNormal(b,g,k.create())};a.createEdgeOffsetOperation=function(y,B,A){return new u.OffsetEdgeVertex(y,"on-the-ground"===A.mode?u.PlaneType.XY:u.PlaneType.XYZ,B,0)};a.edgeOffsetRotationMatrix=function(y,B,A){y=k.normal(y);B=e.direction(d.create(),B,A);A=e.cross(d.create(),B,y);y=e.cross(d.create(),B,A);return l.fromValues(B[0],B[1],B[2],0,A[0],A[1],A[2],0,y[0],y[1],y[2],0,0,0,0,1)};a.screenEdgeLengthSquared=function(y,B,A){y=A.projectToRenderScreen(y,c.createRenderScreenPointArray3());
B=A.projectToRenderScreen(B,c.createRenderScreenPointArray3());return null!=y&&null!=B?e.squaredLength(e.subtract(y,y,B)):0};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/ReshapeTooltipInfos":function(){define("exports ../../../chunks/tslib.es6 ../../../core/quantityUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./SketchTooltipInfo".split(" "),
function(a,c,l,e,d,k,t,u,f){a.ReshapeEdgeOffsetTooltipInfo=class extends f.SketchTooltipInfo{constructor(y){super(y);this.type="reshape-edge-offset";this.distance=l.zeroMeters;this.totalLength=this.area=null}};c.__decorate([e.property()],a.ReshapeEdgeOffsetTooltipInfo.prototype,"type",void 0);c.__decorate([e.property()],a.ReshapeEdgeOffsetTooltipInfo.prototype,"distance",void 0);c.__decorate([e.property()],a.ReshapeEdgeOffsetTooltipInfo.prototype,"area",void 0);c.__decorate([e.property()],a.ReshapeEdgeOffsetTooltipInfo.prototype,
"totalLength",void 0);a.ReshapeEdgeOffsetTooltipInfo=c.__decorate([u.subclass("esri.views.interactive.tooltip.ReshapeEdgeOffsetTooltipInfo")],a.ReshapeEdgeOffsetTooltipInfo);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/transformGraphic/GraphicTransformTool":function(){define("exports ../../../../../chunks/tslib.es6 ../../../../../core/arrayUtils ../../../../../core/Evented ../../../../../core/handleUtils ../../../../../core/maybe ../../../../../core/quantityUtils ../../../../../core/reactiveUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/accessorSupport/ensureType ../../../../../core/has ../../../../../core/accessorSupport/decorators/subclass ../../../../../core/support/UpdatingHandles ../../../../../geometry/Point ../../../../../support/elevationInfoUtils ../../../../ViewingMode ../../Manipulator3D ../../manipulatorUtils ../../SnappingVisualizer3D ../manipulatorUtils ../meshFastUpdateUtils ../visualElementUtils ../manipulations/config ../manipulations/MoveManipulation ../manipulations/moveUtils ./GraphicScaleRotateTransform ./ScaleRotateMeshAdapter ./ScaleRotateObjectSymbol3DAdapter ./undoRecords ../../../layers/graphics/GraphicState ../../../../interactive/dragEventPipeline ../../../../interactive/InteractiveToolBase ../../../../interactive/editGeometry/EditGeometryOperations ../../../../interactive/sketch/SketchTooltipOptions ../../../../interactive/snapping/SnappingContext ../../../../interactive/snapping/SnappingDragPipelineStep ../../../../interactive/tooltip/Tooltip ../../../../interactive/tooltip/TranslateTooltipInfos ../../../../support/automaticLengthMeasurementUtils ../../../../support/euclideanLengthMeasurementUtils".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m,n,h,q,z,r,D,v,I,p,w,C,F,G,J,L,x,H,K,E,M,O,T,U,ba,la){a.GraphicTransformTool=class extends e.EventedMixin(H.InteractiveToolBase){constructor(fa){super(fa);this.enableScaling=this.enableRotation=this.enableZ=!0;this.tooltipOptions=new E;this.type="transform-3d";this._updatingHandles=new b.UpdatingHandles;this._translateGraphicZTooltipInfo=this._translateGraphicXYTooltipInfo=this._translateGraphicTooltipInfo=this._tooltip=this._scaleRotate=null}initialize(){const {graphic:fa,
view:P}=this;this.graphicState=new L.GraphicState({graphic:fa});this.addHandles(u.watch(()=>this.tooltipOptions.enabled,W=>{this._tooltip=W?new T.Tooltip({view:P}):k.destroyMaybe(this._tooltip)},u.syncAndInitial));this._moveManipulation=new p.MoveManipulation({tool:this,view:P,snapToScene:this.snapToScene,xyAvailable:!0,xyAxisAvailable:!0,zAvailable:this.enableZ&&r.canMoveZ(fa),radius:p.MoveManipulation.radiusForSymbol(fa.symbol)});this._moveManipulation.forEachManipulator(W=>this.addHandles(W.events.on("immediate-click",
ia=>{this.emit("immediate-click",{...ia,graphic:fa});ia.stopPropagation()})));const X=W=>ia=>{this.addHandles(ia.events.on("focus-changed",({action:ha})=>{const V=this._tooltip;null!=V&&("focus"===ha?this._updateMoveTooltip(W):V.clear())}))};this._moveManipulation.xyManipulation.forEachManipulator(X(p.ManipulationType.XY));this._moveManipulation.xyAxisManipulation.forEachManipulator(X(p.ManipulationType.XY_AXIS));this._moveManipulation.zManipulation.forEachManipulator(X(p.ManipulationType.Z));const ma=
m.getGraphicEffectiveElevationInfo(fa);this._moveManipulation.elevationInfo=ma;this.addHandles(D.meshTransformFastUpdateHandles(this.graphicState));const {geometry:aa}=fa;this._moveManipulation.createGraphicDragPipeline((W,ia,ha,V,ea)=>{if(null!=aa&&W===p.ManipulationType.XY){const {snappingStep:Q,cancelSnapping:Z}=O.createSnapDragEventPipelineStep({snappingContext:new M.SnappingContext({elevationInfo:ma,pointer:ea,editGeometryOperations:K.EditGeometryOperations.fromGeometry(new g({spatialReference:aa.spatialReference}),
P.state.viewingMode),visualizer:new z.SnappingVisualizer3D,excludeFeature:fa}),snappingManager:this.snappingManager,updatingHandles:this._updatingHandles,useZ:!1});V=V.next(Z);ha=ha.next(x.sceneSnappingAtProjectedLocation(this.view,ma)).next(...Q)}ha=ha.next(Q=>{this._updateMoveTooltip(W,Q);return Q});return{steps:ha,cancel:V}},this.graphicState,W=>{const {action:ia,graphic:ha,dxScreen:V,dyScreen:ea}=W;W={graphic:ha,dxScreen:V,dyScreen:ea};switch(ia){case "start":this.emit("graphic-translate-start",
W);this.emit("record-undo",{record:this._createGeometryUndoRecord()});break;case "update":this.emit("graphic-translate",W);break;case "end":this.emit("graphic-translate-stop",W)}});this._moveManipulation.angle=null!=this._scaleRotate?this._scaleRotate.angle:0;this._scaleRotateAdapter=this._createScaleRotateAdapter();this.addHandles(u.watch(()=>this._scaleRotateAdapter.angle,()=>this._updateMoveAngle()));if(this.enableScaling||this.enableRotation)this._scaleRotate=new C.GraphicScaleRotateTransform({tool:this,
mode:this.enableScaling&&this.enableRotation?null:this.enableScaling?"scale":"rotate",adapter:this._scaleRotateAdapter,tooltipOptions:this.tooltipOptions}),this.addHandles(this._scaleRotate.events.on("scale-changed",()=>this._onScaleChanged()));this.addHandles([v.createVisualElements({view:this.view,graphic:this.graphic,forEachManipulator:W=>this._forEachManipulator(W),onManipulatorsChanged:()=>d.makeHandle()}),this.graphicState.on("changed",()=>this._onGeometryChanged()),this._hideManipulatorsForGraphicState(),
u.watch(()=>P.scale,()=>this._updateMoveAngle())].filter(l.isSome));this.addHandles(this.view.trackGraphicState(this.graphicState));this._onGeometryChanged();this._updateMoveAngle();this._forEachManipulator(W=>{W instanceof h.Manipulator3D&&this.addHandles(W.events.on("grab-changed",()=>this._updateManipulatorsInteractive()))});this.finishToolCreation()}destroy(){this._tooltip=k.destroyMaybe(this._tooltip);this._moveManipulation.destroy();this._scaleRotate=k.destroyMaybe(this._scaleRotate);this._scaleRotateAdapter=
k.destroyMaybe(this._scaleRotateAdapter);this._updatingHandles.destroy();this._set("view",null);this._set("graphic",null)}_updateManipulatorsInteractive(){null!=this._scaleRotate&&(this._scaleRotate.interactive=!this._moveManipulation.grabbing,this._moveManipulation.interactive=!this._scaleRotate.grabbing)}_createScaleRotateAdapter(){return null!=this.graphic.geometry&&"mesh"===this.graphic.geometry.type?new F.ScaleRotateMeshAdapter({graphic:this.graphic,geometry:this.graphic.geometry,viewingMode:this.view.state.viewingMode}):
new G.ScaleRotateObjectSymbol3DAdapter({graphic:this.graphic,sizeFilter:fa=>this._enforceNonZeroSize(fa),findLayerView:()=>this.view.allLayerViews.find(fa=>fa.layer===this.graphic.layer),sizeAxis:this.tooltipOptions?.visualVariables?.size?.axis??null})}_forEachManipulator(fa){this._moveManipulation?.forEachManipulator(fa);this._scaleRotate?.forEachManipulator(fa)}_hideManipulatorsForGraphicState(){return u.watch(()=>this.graphicState.displaying,fa=>{this._forEachManipulator(P=>P.available=fa);this._moveManipulation.zManipulation.available=
fa&&this.enableZ&&r.canMoveZ(this.graphic)})}_createGeometryUndoRecord(){return J.createGraphicGeometryUndoRecord(this.graphic)}set snapToScene(fa){this._moveManipulation&&(this._moveManipulation.snapToScene=fa);this._set("snapToScene",fa)}get updating(){return this._updatingHandles.updating||!!this._scaleRotate?.updating}set location(fa){this._moveManipulation.location=fa;this._scaleRotate&&(this._scaleRotate.location=fa)}set elevationAlignedLocation(fa){this._moveManipulation.elevationAlignedLocation=
fa;this._scaleRotate&&(this._scaleRotate.elevationAlignedLocation=fa)}reset(){}onHide(){this._scaleRotate?.cancelActiveAnimation()}_onScaleChanged(){null!=this._scaleRotate&&(this._moveManipulation.displayScale=this._scaleRotate.getScale())}_updateMoveAngle(){this._moveManipulation.angle=this.view.state.viewingMode===n.ViewingMode.Local||this.view.scale<I.alignArrowsScaleThreshold?this._scaleRotateAdapter.angle:0}_onGeometryChanged(){q.placeAtGraphic(this.view,this,this.graphic)}_enforceNonZeroSize(fa){return fa||
this.view.state.camera.computeRenderPixelSizeAt(this._moveManipulation.renderLocation)}_updateMoveTooltip(fa,P){const {tooltipOptions:X,_tooltip:ma}=this;if(null!=ma){ma.clear();var aa=this.graphicState.isDraped?"on-the-ground":"absolute-height";switch(fa){case p.ManipulationType.XY:ma.info=this._translateGraphicTooltipInfo??(this._translateGraphicTooltipInfo=new U.TranslateGraphicTooltipInfo({tooltipOptions:X}));this._updateMoveTooltipDistance(ma.info,P,(W,ia)=>ba.autoHorizontalDistanceByElevationModeBetweenPoints(W,
ia,aa));break;case p.ManipulationType.XY_AXIS:ma.info=this._translateGraphicXYTooltipInfo??(this._translateGraphicXYTooltipInfo=new U.TranslateGraphicXYTooltipInfo({tooltipOptions:X}));this._updateMoveTooltipDistance(ma.info,P,(W,ia)=>{W=ba.autoHorizontalDistanceByElevationModeBetweenPoints(W,ia,aa);return t.scale(W,w.axisConstrainedDragSign(P))});break;case p.ManipulationType.Z:ma.info=this._translateGraphicZTooltipInfo??(this._translateGraphicZTooltipInfo=new U.TranslateGraphicZTooltipInfo({tooltipOptions:X})),
this._updateMoveTooltipDistance(ma.info,P,la.verticalSignedDistanceBetweenPoints)}ma.info.tooltipOptions=X}}_updateMoveTooltipDistance(fa,P,X){if(null!=P&&"end"!==P.action){const {mapStart:ma,mapEnd:aa}=P;P=X(ma,aa);fa.distance=null!=P?P:t.zeroMeters}else fa.distance=t.zeroMeters}get test(){return{discManipulator:this._moveManipulation.xyManipulation.test.discManipulator,zManipulator:this._moveManipulation.zManipulation.test.manipulator,ringManipulator:null!=this._scaleRotate?this._scaleRotate.test.ringManipulator:
null,arrowManipulators:this._moveManipulation.xyAxisManipulation.test.arrowManipulators,setRingIndicatorDelayMs:fa=>null!=this._scaleRotate?this._scaleRotate.test.setRingIndicatorDelayMs(fa):null,scaleRotateAdapter:this._scaleRotateAdapter,scaleRotateTransform:this._scaleRotate,tooltip:this._tooltip}}};c.__decorate([f.property({constructOnly:!0,nonNullable:!0})],a.GraphicTransformTool.prototype,"view",void 0);c.__decorate([f.property({constructOnly:!0,nonNullable:!0})],a.GraphicTransformTool.prototype,
"graphic",void 0);c.__decorate([f.property({constructOnly:!0,nonNullable:!0})],a.GraphicTransformTool.prototype,"enableZ",void 0);c.__decorate([f.property()],a.GraphicTransformTool.prototype,"enableRotation",void 0);c.__decorate([f.property()],a.GraphicTransformTool.prototype,"enableScaling",void 0);c.__decorate([f.property({constructOnly:!0,type:E})],a.GraphicTransformTool.prototype,"tooltipOptions",void 0);c.__decorate([f.property()],a.GraphicTransformTool.prototype,"graphicState",void 0);c.__decorate([f.property({value:!1})],
a.GraphicTransformTool.prototype,"snapToScene",null);c.__decorate([f.property({constructOnly:!0})],a.GraphicTransformTool.prototype,"snappingManager",void 0);c.__decorate([f.property({readOnly:!0})],a.GraphicTransformTool.prototype,"type",void 0);c.__decorate([f.property({readOnly:!0})],a.GraphicTransformTool.prototype,"updating",null);a.GraphicTransformTool=c.__decorate([A.subclass("esri.views.3d.interactive.editingTools.graphicTransform3D.GraphicTransformTool")],a.GraphicTransformTool);Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/transformGraphic/GraphicScaleRotateTransform":function(){define("exports ../../../../../chunks/tslib.es6 ../../../../../core/Accessor ../../../../../core/colorUtils ../../../../../core/Cyclical ../../../../../core/Evented ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../core/quantityUtils ../../../../../core/reactiveUtils ../../../../../core/scheduling ../../../../../core/screenUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/accessorSupport/ensureType ../../../../../core/arrayUtils ../../../../../core/has ../../../../../core/accessorSupport/decorators/subclass ../../../../../chunks/mat4 ../../../../../chunks/mat4f64 ../../../../../chunks/vec3 ../../../../../chunks/vec3f64 ../../../../../geometry/support/plane ../../../../../geometry/support/ray ../../../../../geometry/support/vectorStacks ../../../../../support/elevationInfoUtils ../../Manipulator3D ../../manipulatorUtils ../../RenderObject ../dragEventPipeline3D ../ManipulatorType ../manipulations/config ../../../webgl-engine/lib/basicInterfaces ../../../webgl-engine/lib/GeometryUtil ../../../webgl-engine/lib/Material ../../../webgl-engine/materials/ColorMaterial ../../../../interactive/dragEventPipeline ../../../../interactive/interfaces ../../../../interactive/tooltip/Tooltip ../../../../interactive/tooltip/TransformTooltipInfos".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m,n,h,q,z,r,D,v,I,p,w,C,F,G,J,L,x,H,K,E,M,O,T,U,ba){function la(V,ea){var Q=r.subtract(p.sv3d.get(),ea.renderStart,V.origin);V=r.subtract(p.sv3d.get(),ea.renderEnd,V.origin);Q=r.length(Q);V=r.length(V);return 0===Q?0:V/Q}function fa(V,ea,Q,Z){const {renderStart:na,renderEnd:va}=V;var ra=P(na,Z,p.sv3d.get());V=P(va,Z,p.sv3d.get());if(r.squaredDistance(ra,V)<x.dragThresholdPx*x.dragThresholdPx)return null;const oa=r.subtract(p.sv3d.get(),na,Q);ea=r.cross(p.sv3d.get(),
oa,v.normal(ea));ea=r.add(p.sv3d.get(),na,ea);Q=P(Q,Z,p.sv3d.get());Z=P(ea,Z,p.sv3d.get());ea=r.subtract(p.sv3d.get(),Z,ra);Z=r.subtract(p.sv3d.get(),ra,Q);ra=I.wrap(ra,ea);Z=I.wrap(Q,Z);return I.distance2(ra,V)<I.distance2(Z,V)?"rotate":"scale"}function P(V,ea,Q){ea.projectToScreen(V,ha);return r.set(Q,ha[0],ha[1],0)}function X(V,ea){let Q=null,Z=1;const na=()=>Z;return{start:()=>{Z=V.getScale();Q=V.getScale;V.getScale=na;ea()},update:va=>{Z+=((Z+1)/2-Z)*Math.min(va*x.ringResetAnimationSpeedFactor,
1);ea();return.01>Math.abs(Z-1)?ia.STOP:ia.CONTINUE},destroy:()=>{Q&&(V.getScale=Q);ea()}}}function ma(V,ea,Q){let Z=0,na=null;const va=()=>!1;return{start:()=>{na=V.getFocused;V.getFocused=va;Z=0;ea()},update:ra=>{Z+=ra;return!na?.()||Z>=Q.delayMs?ia.STOP:ia.CONTINUE},destroy:()=>{na&&(V.getFocused=na);ea()}}}function aa(V){switch(V){case "integer":case "long":return 0;default:return null}}var W;(function(V){V.ScaleIn=T.ManipulatorStateCustomFlags.Custom2;V.ScaleOut=T.ManipulatorStateCustomFlags.Custom3;
V.RotateLeft=T.ManipulatorStateCustomFlags.Custom4;V.RotateRight=T.ManipulatorStateCustomFlags.Custom5;V.Unlocked=T.ManipulatorStateCustomFlags.Custom7;V.DelayedFocused=T.ManipulatorStateCustomFlags.Custom8;V.TouchInput=T.ManipulatorStateCustomFlags.Custom12})(W||(W={}));a.GraphicScaleRotateTransform=class extends l{get angle(){return this.adapter.angle}get scale(){return this.adapter.scale}set location(V){this._ringManipulator.location=V}set elevationAlignedLocation(V){this._ringManipulator.elevationAlignedLocation=
V}get grabbing(){return this._ringManipulator.grabbing}set interactive(V){this._ringManipulator.interactive=V}get updating(){return!!this._activeAnimation}constructor(V){super(V);this._activeAnimation=this._scaleRotateDragData=this.mode=null;this._ringIndicatorDelayMs=x.ringIndicatorDelayMs;this._rotateTooltipInfo=this._scaleTooltipInfo=this._absoluteTooltipInfo=null;this.events=new k;this.getFocused=()=>this._ringManipulator.focused;this.getScale=()=>"scale"===this._scaleRotateDragData?.mode?this.adapter.scale:
1}initialize(){this._tooltip=new U.Tooltip({view:this.tool.view});this._createManipulator();this._updateDragState();this._updateManipulatorTransform();this.addHandles([y.when(()=>!this.tooltipOptions.enabled,()=>this._tooltip.clear(),y.initial),y.watch(()=>{const {adapter:V}=this,{info:ea}=this._tooltip;return ea===this._absoluteTooltipInfo&&this.getFocused()?[ea,V.size,V.orientationClockwise]:[null]},([V])=>{V&&this._updateFocusTooltip()})])}destroy(){this._activeAnimation?.frameTask.remove();this._activeAnimation=
null;this.tool.manipulators.remove(this._ringManipulator);this._ringManipulator=null;this._tooltip=u.destroyMaybe(this._tooltip)}startAnimation(V){this.cancelActiveAnimation();V.start();const ea=B.addFrameTask({update:({deltaTime:Q})=>{V.update(Q)&&this.cancelActiveAnimation()}});this._activeAnimation={...V,frameTask:ea}}cancelActiveAnimation(){this._activeAnimation?.frameTask.remove();this._activeAnimation=u.destroyMaybe(this._activeAnimation)}forEachManipulator(V){V(this._ringManipulator,L.ManipulatorType.SCALE_ROTATE)}_createManipulator(){const V=
this._createRingManipulator();this._ringManipulator=V;this.tool.manipulators.add(V);const ea=this.tool.graphicState.graphic,Q=O.createManipulatorDragEventPipeline(V,(Z,na,va)=>{this._scaleRotateDragData=null;const ra=this.adapter.startInteraction(),oa={mode:"none",origin:D.clone(Z.renderLocation),initialAngle:this.adapter.angle,angle:0,angleDir:0,scaleDir:0};this._scaleRotateDragData=oa;this._updateDragState();const ta=p.sv3d.get();this.tool.view.renderCoordsHelper.worldUpAtPosition(Z.renderLocation,
ta);na.next(J.screenToRenderPlane(this.tool.view,v.fromPositionAndNormal(Z.renderLocation,ta,v.create()))).next(za=>{var N=v.normal(za.plane);N=F.calculateInputRotationTransform(za.renderStart,za.renderEnd,oa.origin,N);var R=d.cyclicalPI.shortestSignedDiff(oa.angle,N);oa.angleDir=t.clamp(oa.angleDir+R,-x.rotateIndicatorDirectionBuffer,x.rotateIndicatorDirectionBuffer);oa.angle=N;R=la(oa,za);oa.scaleDir=t.clamp(oa.scaleDir+(R-this.adapter.scale),-x.scaleIndicatorDirectionBuffer,x.scaleIndicatorDirectionBuffer);
this._onScaleChanged();if("none"===oa.mode){const pa=this.mode||fa(za,za.plane,oa.origin,this.tool.view.state.camera);if(null!=pa){switch(pa){case "rotate":this.tool.emit("graphic-rotate-start",{graphic:ea,angle:0});this.tool.emit("record-undo",{record:this.adapter.createUndoRecord()});break;case "scale":this.tool.emit("graphic-scale-start",{graphic:ea,xScale:1,yScale:1}),this.tool.emit("record-undo",{record:this.adapter.createUndoRecord()})}oa.mode=pa}}switch(oa.mode){case "rotate":ra.state.angle=
oa.initialAngle+N;break;case "scale":ra.state.scale=R,this._onScaleChanged()}this._updateDragState();this._updateManipulatorTransform();switch(za.action){case "start":case "update":switch(oa.mode){case "rotate":this.tool.emit("graphic-rotate",{graphic:ea,angle:t.rad2deg(oa.angle)});break;case "scale":this.tool.emit("graphic-scale",{graphic:ea,xScale:R,yScale:R})}break;case "end":switch(oa.mode){case "rotate":this.tool.emit("graphic-rotate-stop",{graphic:ea,angle:t.rad2deg(oa.angle)});break;case "scale":this.tool.emit("graphic-scale-stop",
{graphic:ea,xScale:R,yScale:R})}}"end"===za.action&&(this.startAnimation(X(this,()=>this._onScaleChanged())),this._scaleRotateDragData=null,this._updateDragState(),ra.done());return za}).next(this._updateTooltipPipelineStep(oa));va.next(()=>{ra.cancel();if(null!=this._scaleRotateDragData){switch(this._scaleRotateDragData.mode){case "rotate":this.tool.emit("graphic-rotate-stop",{graphic:ea,angle:0});break;case "scale":this.tool.emit("graphic-scale-stop",{graphic:ea,xScale:1,yScale:1})}this.startAnimation(X(this,
()=>this._onScaleChanged()));this._scaleRotateDragData=null;this._updateDragState()}this._updateFocusTooltip()})});this.addHandles([Q,V.events.on("focus-changed",Z=>{"focus"===Z.action?this.startAnimation(ma(this,()=>this._updateDelayedFocusedState(),{delayMs:this._ringIndicatorDelayMs})):this._updateDelayedFocusedState()}),V.events.on("immediate-click",Z=>{Z.stopPropagation()}),y.watch(()=>this.tool.graphicState?.displaying,Z=>this._ringManipulator.available=Z,y.initial)])}_updateTooltipPipelineStep(V){return ea=>
{const Q=this.tooltipOptions;if(!Q.enabled)return ea;if("end"===ea.action)return this._updateFocusTooltip(),ea;var Z=this._tooltip,na=this.tooltipOptions.visualVariables;switch(V.mode){case "scale":Z.info=this._scaleTooltipInfo??(this._scaleTooltipInfo=new ba.TransformScaleTooltipInfo({tooltipOptions:Q}));const {size:va,scale:ra}=this.adapter;na=na?.size;Z=Z.info;Z.tooltipOptions=Q;Z.scale={value:ra};Z.size=null!=va?f.createLength(va,"meters"):void 0;Z.sizePrecision=aa(na?.valueType);Z.sizeUnit=na?.unit;
break;case "rotate":Z.info=this._rotateTooltipInfo??(this._rotateTooltipInfo=new ba.TransformRotateTooltipInfo({tooltipOptions:Q}));const {orientationClockwise:oa,relativeAngleClockwise:ta}=this.adapter;na=na?.rotation;const za=aa(na?.valueType);Z=Z.info;Z.tooltipOptions=Q;Z.rotation=null!=ta?f.createAngle(ta,"radians","geographic"):void 0;Z.rotationPrecision=za;Z.rotationType=na?.rotationType??"geographic";Z.orientation=null!=oa?f.createAngle(oa,"radians","geographic"):void 0;Z.orientationPrecision=
za}return ea}}_updateFocusTooltip(){const {tooltipOptions:V,_tooltip:ea}=this;if(V.enabled)if(this.getFocused()){var Q=V.visualVariables;const na=Q?.rotation;Q=Q?.size;var Z=this.mode;const {size:va,orientationClockwise:ra}=this.adapter,oa=null!=ra&&(null==Z||"rotate"===Z);Z=null!=va&&(null==Z||"scale"===Z);ea.info=this._absoluteTooltipInfo??(this._absoluteTooltipInfo=new ba.TransformAbsoluteTooltipInfo({tooltipOptions:V}));const ta=ea.info;ta.tooltipOptions=V;ta.orientation=oa?f.createAngle(ra,"radians",
"geographic"):void 0;ta.orientationPrecision=aa(na?.valueType);ta.rotationType=na?.rotationType??"geographic";ta.size=Z?f.createLength(va,"meters"):void 0;ta.sizeUnit=Q?.unit;ta.sizePrecision=aa(Q?.valueType)}else ea.clear()}_onScaleChanged(){this.events.emit("scale-changed");this._updateManipulatorTransform()}_updateDelayedFocusedState(){this._ringManipulator.updateStateEnabled(W.DelayedFocused,this.getFocused());this._updateFocusTooltip()}_updateDragState(){this._ringManipulator.updateStateEnabled(W.Unlocked,
!(null!=this._scaleRotateDragData&&"none"!==this._scaleRotateDragData?.mode));if(null!=this._scaleRotateDragData)switch(this._scaleRotateDragData.mode){case "rotate":this._ringManipulator.updateStateEnabled(W.ScaleIn|W.ScaleOut,!1);this._ringManipulator.updateStateEnabled(W.RotateLeft,0>this._scaleRotateDragData.angleDir);this._ringManipulator.updateStateEnabled(W.RotateRight,0<=this._scaleRotateDragData.angleDir);break;case "scale":this._ringManipulator.updateStateEnabled(W.RotateLeft|W.RotateRight,
!1),this._ringManipulator.updateStateEnabled(W.ScaleIn,0>this._scaleRotateDragData.scaleDir),this._ringManipulator.updateStateEnabled(W.ScaleOut,0<=this._scaleRotateDragData.scaleDir)}else this._ringManipulator.updateStateEnabled(W.ScaleIn|W.ScaleOut|W.RotateLeft|W.RotateRight,!1)}_updateManipulatorTransform(){const V=q.fromRotation(p.sm4d.get(),this.adapter.angle,D.fromValues(0,0,1));if(null!=V){var ea=this.getScale();ea=q.fromScaling(p.sm4d.get(),r.set(p.sv3d.get(),ea,ea,ea));this._ringManipulator.modelTransform=
q.multiply(p.sm4d.get(),ea,V)}}_createRingManipulator(){var V=(Aa,Da,Ba)=>{const Ga=[],S=Math.ceil(x.geometrySegments*(Da-Aa)/(2*Math.PI));for(let Y=0;Y<S+1;Y++){const da=Aa+Y*(Da-Aa)/S;Ga.push(D.fromValues(Ba*Math.cos(da),Ba*Math.sin(da),0))}return Ga};const ea=this._createMaterial(1);var Q=(Aa,Da,Ba=ea)=>K.createPathExtrusionGeometry(Ba,[[-Da/2,0],[Da/2,0],[Da/2,x.ringHeight/2],[-Da/2,x.ringHeight/2]],Aa,[],[],!1),Z=V(0,2*Math.PI,x.ringRadius),na=Q(Z,x.ringThickness),va=[],ra=[];const oa=[];for(var ta=
0;2>ta;ta++){var za=ta*Math.PI-Math.PI/4,N=Math.PI/2-x.rotateIndicatorArcLength,R=za+N;za=za+Math.PI/2-N;N=V(R,za,x.innerIndicatorRadius);var pa=Q(N,x.indicatorThickness);oa.push(N);oa.push(V(R,za,x.outerIndicatorRadius-x.ringThickness/2));va.push(pa);ra.push(pa.instantiate());for(pa=0;2>pa;pa++){var sa=0===pa,ua=z.create();if(sa){q.scale(ua,ua,[1,-1,1]);q.rotate(ua,ua,-R,[0,0,1]);var xa=Math.round(x.rotateIndicatorArrowPlacementPercentage*(N.length-1));ua[12]=N[xa][0];ua[13]=N[xa][1];ua[14]=N[xa][2]}else q.rotate(ua,
ua,za,[0,0,1]),xa=Math.round((1-x.rotateIndicatorArrowPlacementPercentage)*(N.length-1)),ua[12]=N[xa][0],ua[13]=N[xa][1],ua[14]=N[xa][2];xa=K.createExtrudedTriangle(ea,x.rotateIndicatorArrowTipLength,0,x.rotateIndicatorArrowTipRadius,x.ringHeight);K.transformInPlace(xa,ua);(sa?va:ra).push(xa)}}ta=[];for(R=0;2>R;R++)za=R*Math.PI-Math.PI/4,N=Math.PI/2-x.scaleIndicatorArcLength,za=V(za+N,za+Math.PI/2-N,x.outerIndicatorRadius),ta.push(Q(za,x.indicatorThickness));sa=this._createMaterial(.66);R=this._createMaterial(.5);
N=this._createMaterial(.33);za=V(0,2*Math.PI,x.ringRadius+x.scaleIndicatorOffset1);pa=V(0,2*Math.PI,x.ringRadius+x.scaleIndicatorOffset2);za=Q(za,x.indicatorThickness,sa);pa=Q(pa,x.indicatorThickness,N);ua=V(0,2*Math.PI,x.ringRadius-x.scaleIndicatorOffset1);V=V(0,2*Math.PI,x.ringRadius-x.scaleIndicatorOffset2);sa=Q(ua,x.indicatorThickness,sa);Q=Q(V,x.indicatorThickness,N);na=[new G.RenderObject(na,W.DelayedFocused),new G.RenderObject(na.instantiate({material:R}),T.ManipulatorStateFlags.None)];this.mode&&
"scale"!==this.mode||(na=na.concat([...ta.map(Aa=>new G.RenderObject(Aa,W.DelayedFocused|W.Unlocked)),new G.RenderObject(za,W.DelayedFocused|W.ScaleIn),new G.RenderObject(pa,W.DelayedFocused|W.ScaleIn),new G.RenderObject(sa,W.DelayedFocused|W.ScaleOut),new G.RenderObject(Q,W.DelayedFocused|W.ScaleOut)]));this.mode&&"rotate"!==this.mode||(na=na.concat([...ra.map(Aa=>new G.RenderObject(Aa.instantiate(),W.DelayedFocused|W.Unlocked)),...va.map(Aa=>new G.RenderObject(Aa,W.DelayedFocused|W.RotateLeft)),
...ra.map(Aa=>new G.RenderObject(Aa,W.DelayedFocused|W.RotateRight))]));Z=[Z,...oa];return new C.Manipulator3D({view:this.tool.view,renderObjects:na,autoScaleRenderObjects:!1,worldOriented:!0,radius:x.ringThickness,focusMultiplier:1,touchMultiplier:1.5,elevationInfo:w.getGraphicEffectiveElevationInfo(this.tool.graphicState.graphic),collisionType:{type:"ribbon",paths:Z,direction:D.fromValues(0,0,1)}})}_createMaterial(V){const ea=new M.ColorMaterial({cullFace:H.CullFaceOptions.Back,renderOccluded:E.RenderOccludedFlag.Transparent,
isDecoration:!0});this.addHandles(y.watch(()=>({color:e.multiplyOpacityToUnitRGBA(this.tool.view.effectiveTheme.accentColor,V)}),Q=>ea.setParameters(Q),y.initial));return ea}get test(){return{ringManipulator:this._ringManipulator,setRingIndicatorDelayMs:V=>this._ringIndicatorDelayMs=V,tooltip:this._tooltip}}};c.__decorate([b.property({constructOnly:!0})],a.GraphicScaleRotateTransform.prototype,"tool",void 0);c.__decorate([b.property({constructOnly:!0})],a.GraphicScaleRotateTransform.prototype,"adapter",
void 0);c.__decorate([b.property({constructOnly:!0})],a.GraphicScaleRotateTransform.prototype,"tooltipOptions",void 0);c.__decorate([b.property()],a.GraphicScaleRotateTransform.prototype,"mode",void 0);c.__decorate([b.property()],a.GraphicScaleRotateTransform.prototype,"_activeAnimation",void 0);c.__decorate([b.property()],a.GraphicScaleRotateTransform.prototype,"updating",null);a.GraphicScaleRotateTransform=c.__decorate([h.subclass("esri.views.3d.interactive.editingTools.transformGraphic.GraphicScaleRotateTransform")],
a.GraphicScaleRotateTransform);var ia;(function(V){V[V.CONTINUE=0]="CONTINUE";V[V.STOP=1]="STOP"})(ia||(ia={}));const ha=A.createScreenPointArray();Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/TransformTooltipInfos":function(){define("exports ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./SketchTooltipInfo".split(" "),
function(a,c,l,e,d,k,t,u){a.TransformRotateTooltipInfo=class extends u.SketchTooltipInfo{constructor(f){super(f);this.type="transform-rotate";this.orientationPrecision=this.orientation=this.rotationPrecision=this.rotation=null;this.rotationType="geographic"}};c.__decorate([l.property()],a.TransformRotateTooltipInfo.prototype,"type",void 0);c.__decorate([l.property()],a.TransformRotateTooltipInfo.prototype,"rotation",void 0);c.__decorate([l.property()],a.TransformRotateTooltipInfo.prototype,"rotationPrecision",
void 0);c.__decorate([l.property()],a.TransformRotateTooltipInfo.prototype,"orientation",void 0);c.__decorate([l.property()],a.TransformRotateTooltipInfo.prototype,"orientationPrecision",void 0);c.__decorate([l.property()],a.TransformRotateTooltipInfo.prototype,"rotationType",void 0);a.TransformRotateTooltipInfo=c.__decorate([t.subclass("esri.views.interactive.tooltip.TransformRotateTooltipInfo")],a.TransformRotateTooltipInfo);a.TransformScaleTooltipInfo=class extends u.SketchTooltipInfo{constructor(f){super(f);
this.type="transform-scale";this.sizePrecision=this.sizeUnit=this.size=null}};c.__decorate([l.property()],a.TransformScaleTooltipInfo.prototype,"type",void 0);c.__decorate([l.property()],a.TransformScaleTooltipInfo.prototype,"scale",void 0);c.__decorate([l.property()],a.TransformScaleTooltipInfo.prototype,"size",void 0);c.__decorate([l.property()],a.TransformScaleTooltipInfo.prototype,"sizeUnit",void 0);c.__decorate([l.property()],a.TransformScaleTooltipInfo.prototype,"sizePrecision",void 0);a.TransformScaleTooltipInfo=
c.__decorate([t.subclass("esri.views.interactive.tooltip.TransformScaleTooltipInfo")],a.TransformScaleTooltipInfo);a.TransformAbsoluteTooltipInfo=class extends u.SketchTooltipInfo{constructor(f){super(f);this.type="transform-absolute";this.orientationPrecision=this.orientation=null;this.rotationType="geographic";this.sizeUnit=this.sizePrecision=this.size=null}};c.__decorate([l.property()],a.TransformAbsoluteTooltipInfo.prototype,"type",void 0);c.__decorate([l.property()],a.TransformAbsoluteTooltipInfo.prototype,
"orientation",void 0);c.__decorate([l.property()],a.TransformAbsoluteTooltipInfo.prototype,"orientationPrecision",void 0);c.__decorate([l.property()],a.TransformAbsoluteTooltipInfo.prototype,"rotationType",void 0);c.__decorate([l.property()],a.TransformAbsoluteTooltipInfo.prototype,"size",void 0);c.__decorate([l.property()],a.TransformAbsoluteTooltipInfo.prototype,"sizePrecision",void 0);c.__decorate([l.property()],a.TransformAbsoluteTooltipInfo.prototype,"sizeUnit",void 0);a.TransformAbsoluteTooltipInfo=
c.__decorate([t.subclass("esri.views.interactive.tooltip.TransformAbsoluteTooltipInfo")],a.TransformAbsoluteTooltipInfo);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/transformGraphic/ScaleRotateMeshAdapter":function(){define("exports ../../../../../chunks/tslib.es6 ../../../../../core/Accessor ../../../../../core/mathUtils ../../../../../core/reactiveUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/accessorSupport/ensureType ../../../../../core/arrayUtils ../../../../../core/has ../../../../../core/accessorSupport/decorators/subclass ../../../../../chunks/vec3 ../../../../../geometry/support/axisAngleDegrees ../../../../../geometry/support/MeshTransform ../../../../ViewingMode ./undoRecords".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m){a.ScaleRotateMeshAdapter=class extends l{constructor(q){super(q);this._interactionState=null}initialize(){this.addHandles([d.when(()=>{const q=this._interactionState;return q&&q.angle!==q.previousAngle?{interactionState:q,angle:q.state.angle}:null},({interactionState:q})=>{this._updateMeshRotation(q)},d.sync),d.when(()=>{const q=this._interactionState;return q&&q.scale!==q.previousScale?{interactionState:q,scale:q.state.scale}:null},({interactionState:q})=>
{this._updateMeshSize(q)},d.sync)])}get initialAngle(){return this._interactionState?.initialAngle??0}get angle(){const q=this.geometry.transform;if(null==q)return this._interactionState?.angle??0;const z=A.axis(q.rotation)[2];return.999999<Math.abs(z)?e.deg2rad(A.angle(q.rotation))*Math.sign(z):0}get angleClockwise(){return-this.angle}get relativeAngle(){return this.angle-this.initialAngle}get relativeAngleClockwise(){return-this.relativeAngle}get scale(){return this._interactionState?.scale??1}startInteraction(){const q=
new n({angle:this.angle});this._interactionState=q;const z=()=>{this._interactionState=null};return{state:q,done:z,cancel:()=>{q.cancel();z()}}}createUndoRecord(){return m.createGraphicGeometryUndoRecord(this.graphic)}_updateMeshRotation(q){const {angle:z,previousAngle:r}=q;q.previousAngle=z;var {geometry:D}=this;const {vertexSpace:v}=D;q=e.rad2deg(z-r);v.isGeoreferenced?(this.geometry.rotate(0,0,q,{origin:this.geometry.anchor,geographic:!v.isRelative&&this.viewingMode===g.ViewingMode.Global}),this.graphic.notifyGeometryChanged()):
(D.transform??(D.transform=new b),{transform:D}=D,q=A.composeAxes(0,0,q,h),D.rotation=A.compose(D.rotation,q,D.rotation),this.graphic.notifyMeshTransformChanged())}_updateMeshSize(q){const {scale:z,previousScale:r}=q;q.previousScale=z;var {geometry:D}=this;const {vertexSpace:v}=D;q=z/r;v.isGeoreferenced?(this.geometry.scale(q,{origin:this.geometry.anchor,geographic:!v.isRelative&&this.viewingMode===g.ViewingMode.Global}),this.graphic.notifyGeometryChanged()):(D.transform??(D.transform=new b),{transform:D}=
D,D.scale=B.scale(D.scale,D.scale,q),this.graphic.notifyMeshTransformChanged())}};c.__decorate([k.property({constructOnly:!0})],a.ScaleRotateMeshAdapter.prototype,"graphic",void 0);c.__decorate([k.property({constructOnly:!0})],a.ScaleRotateMeshAdapter.prototype,"geometry",void 0);c.__decorate([k.property({constructOnly:!0})],a.ScaleRotateMeshAdapter.prototype,"viewingMode",void 0);c.__decorate([k.property()],a.ScaleRotateMeshAdapter.prototype,"initialAngle",null);c.__decorate([k.property()],a.ScaleRotateMeshAdapter.prototype,
"angle",null);c.__decorate([k.property()],a.ScaleRotateMeshAdapter.prototype,"angleClockwise",null);c.__decorate([k.property()],a.ScaleRotateMeshAdapter.prototype,"relativeAngle",null);c.__decorate([k.property()],a.ScaleRotateMeshAdapter.prototype,"relativeAngleClockwise",null);c.__decorate([k.property()],a.ScaleRotateMeshAdapter.prototype,"scale",null);c.__decorate([k.property()],a.ScaleRotateMeshAdapter.prototype,"_interactionState",void 0);a.ScaleRotateMeshAdapter=c.__decorate([y.subclass("esri.views.3d.interactive.editingTools.transformGraphic.ScaleRotateMeshAdapter")],
a.ScaleRotateMeshAdapter);let n=class extends l{get state(){const {angle:q,scale:z}=this;return{angle:q,scale:z}}constructor(q){super(q);this.previousAngle=this.initialAngle=this.angle=0;this.scale=this.previousScale=1;this.previousAngle=this.initialAngle=q.angle}cancel(){this.angle=this.initialAngle;this.scale=1}};c.__decorate([k.property()],n.prototype,"angle",void 0);c.__decorate([k.property()],n.prototype,"initialAngle",void 0);c.__decorate([k.property()],n.prototype,"previousAngle",void 0);c.__decorate([k.property()],
n.prototype,"previousScale",void 0);c.__decorate([k.property()],n.prototype,"scale",void 0);c.__decorate([k.property()],n.prototype,"state",null);n=c.__decorate([y.subclass("InteractionState")],n);const h=A.create();Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/transformGraphic/undoRecords":function(){define(["exports","../../../../../chunks/vec3f64"],function(a,c){function l(k){let t=k.geometry,u=null;return{undo(f){u=f.geometry;f.geometry=
t},redo(f){t=f.geometry;f.geometry=u}}}function e(k,t,u){let f=t?.clone(),y=c.clone(u.origin),B=null,A=null;return{undo:b=>{B=k.transform?.clone();A=c.clone(u.origin);k.transform=f;k.vertexSpace.origin=y;b.notifyMeshTransformChanged()},redo:b=>{f=k.transform?.clone();y=c.clone(u.origin);k.transform=B;k.vertexSpace.origin=A;b.notifyMeshTransformChanged()}}}function d(k){let t=k.vertexAttributes.clonePositional(),u;return{undo:f=>{u=k.vertexAttributes.clonePositional();k.vertexAttributes=t;f.notifyGeometryChanged()},
redo:f=>{t=k.vertexAttributes.clonePositional();k.vertexAttributes=u;f.notifyGeometryChanged()}}}a.createGraphicGeometryUndoRecord=function(k){null!=k.geometry&&"mesh"===k.geometry.type?(k=k.geometry,k=k.vertexSpace.isRelative?e(k,k.transform,k.vertexSpace):d(k)):k=l(k);return k};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/transformGraphic/ScaleRotateObjectSymbol3DAdapter":function(){define("exports ../../../../../chunks/tslib.es6 ../../../../../core/Accessor ../../../../../core/mathUtils ../../../../../core/reactiveUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/accessorSupport/ensureType ../../../../../core/arrayUtils ../../../../../core/has ../../../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,c,l,e,d,k,t,u,f,y){function B(g){return-e.deg2rad(g)}a.ScaleRotateObjectSymbol3DAdapter=class extends l{constructor(g){super(g);this._interactionState=this.sizeAxis=null}initialize(){this.addHandles(d.when(()=>null!=this._interactionState?this._interactionState.state:null,g=>{this._updateSymbol(g)},d.sync))}get initialAngle(){return this._interactionState?.initialAngle??0}get angle(){return null!=this._interactionState?this._interactionState.angle:null!=this._orientationReferenceSymbolLayer?
B(this._orientationReferenceSymbolLayer.heading??0):0}get angleClockwise(){return-this.angle}get orientation(){return this.angle}get orientationClockwise(){return this.angleClockwise}get relativeAngle(){return this.angle-this.initialAngle}get relativeAngleClockwise(){return-this.relativeAngle}get scale(){return this._interactionState?.scale??1}get size(){const g=this._sizeReferenceSymbolLayer;if(null==g)return null;var m=this.findLayerView(),n=this._graphicSymbol;if(null==m||null==n||"point-3d"!==
n.type)return null;m=m.getSymbolLayerSize(n,g);if("size"in m&&null!=m.size)return m.size;n=this.sizeAxis;return"width"in m&&null!=m.width&&(null==n||"width"===n||"all"===n||"width-and-depth"===n)?m.width:"depth"in m&&null!=g.depth&&(null==n||"depth"===n||"all"===n||"width-and-depth"===n)?m.depth:"height"in m&&null!=g.height&&(null==n||"height"===n||"all"===n)?m.height:null}get _sizeReferenceSymbolLayer(){const g=this._graphicSymbol;return null==g||0===g.symbolLayers.length?null:g.symbolLayers.find(m=>
"object"===m.type)}get _orientationReferenceSymbolLayer(){const g=this._graphicSymbol;return null==g||0===g.symbolLayers.length?null:g.symbolLayers.find(m=>"object"===m.type&&null!=m.heading)}get _graphicSymbol(){return null!=this.graphic?.symbol&&"point-3d"===this.graphic.symbol.type?this.graphic.symbol:null}set _graphicSymbol(g){this.graphic.symbol=g}startInteraction(){const g=this._graphicSymbol,m=this.findLayerView();if(null!=this._interactionState||null==g||null==m)return A;var n=g.symbolLayers.map(z=>
"object"===z.type?m.getSymbolLayerSize(g,z):null).toArray();const h=g.clone();this._interactionState=n=new b({originalSymbol:h,angle:this.angle,initialSizes:n});const q=()=>{this._interactionState=null};return{state:n,done:q,cancel:()=>{this._graphicSymbol=h;q()}}}createUndoRecord(){let g=this.graphic.symbol,m=null;return{undo:n=>{m=n.symbol;n.symbol=g},redo:n=>{g=n.symbol;n.symbol=m}}}_updateSymbol({scale:g,angle:m,originalSymbol:n,initialSizes:h}){var q=this._graphicSymbol;if(null!=q&&"point-3d"===
q.type){q=q.clone();var z=-e.rad2deg(m-this.initialAngle),r=!1;this._forEachObjectSymbolLayerPair(n,q,(D,v,I)=>{D=(D.heading??0)+z;v.heading!==D&&(v.heading=D,r=!0);I=h[I];null!=I&&"width"in I&&(I.width=this.sizeFilter(I.width),I.height=this.sizeFilter(I.height),I.depth=this.sizeFilter(I.depth),D=I.width*g,v.width!==D&&(v.width=D,r=!0),D=I.depth*g,v.depth!==D&&(v.depth=D,r=!0),I=I.height*g,v.height!==I&&(v.height=I,r=!0))});r&&(this._graphicSymbol=q)}}_forEachObjectSymbolLayerPair(g,m,n){g.symbolLayers.forEach((h,
q)=>{const z=m.symbolLayers.at(q);"object"===h.type&&"object"===z.type&&n(h,z,q)})}};c.__decorate([k.property()],a.ScaleRotateObjectSymbol3DAdapter.prototype,"initialAngle",null);c.__decorate([k.property()],a.ScaleRotateObjectSymbol3DAdapter.prototype,"angle",null);c.__decorate([k.property()],a.ScaleRotateObjectSymbol3DAdapter.prototype,"angleClockwise",null);c.__decorate([k.property()],a.ScaleRotateObjectSymbol3DAdapter.prototype,"orientation",null);c.__decorate([k.property()],a.ScaleRotateObjectSymbol3DAdapter.prototype,
"orientationClockwise",null);c.__decorate([k.property()],a.ScaleRotateObjectSymbol3DAdapter.prototype,"relativeAngle",null);c.__decorate([k.property()],a.ScaleRotateObjectSymbol3DAdapter.prototype,"relativeAngleClockwise",null);c.__decorate([k.property()],a.ScaleRotateObjectSymbol3DAdapter.prototype,"scale",null);c.__decorate([k.property()],a.ScaleRotateObjectSymbol3DAdapter.prototype,"size",null);c.__decorate([k.property()],a.ScaleRotateObjectSymbol3DAdapter.prototype,"sizeAxis",void 0);c.__decorate([k.property({constructOnly:!0})],
a.ScaleRotateObjectSymbol3DAdapter.prototype,"graphic",void 0);c.__decorate([k.property()],a.ScaleRotateObjectSymbol3DAdapter.prototype,"_interactionState",void 0);c.__decorate([k.property({constructOnly:!0})],a.ScaleRotateObjectSymbol3DAdapter.prototype,"findLayerView",void 0);c.__decorate([k.property({constructOnly:!0})],a.ScaleRotateObjectSymbol3DAdapter.prototype,"sizeFilter",void 0);c.__decorate([k.property()],a.ScaleRotateObjectSymbol3DAdapter.prototype,"_sizeReferenceSymbolLayer",null);c.__decorate([k.property()],
a.ScaleRotateObjectSymbol3DAdapter.prototype,"_orientationReferenceSymbolLayer",null);c.__decorate([k.property()],a.ScaleRotateObjectSymbol3DAdapter.prototype,"_graphicSymbol",null);a.ScaleRotateObjectSymbol3DAdapter=c.__decorate([y.subclass("esri.views.3d.interactive.editingTools.transformGraphic.ScaleRotateObjectSymbol3DAdapter")],a.ScaleRotateObjectSymbol3DAdapter);const A={state:{angle:0,scale:0},done:()=>{},cancel:()=>{}};let b=class extends l{get state(){const {originalSymbol:g,angle:m,initialAngle:n,
scale:h,initialSizes:q}=this;return{originalSymbol:g,angle:m,initialAngle:n,scale:h,initialSizes:q}}constructor(g){super(g);this.initialAngle=this.angle=0;this.scale=1;this.initialAngle=g.angle}};c.__decorate([k.property()],b.prototype,"originalSymbol",void 0);c.__decorate([k.property()],b.prototype,"angle",void 0);c.__decorate([k.property()],b.prototype,"initialAngle",void 0);c.__decorate([k.property()],b.prototype,"initialSizes",void 0);c.__decorate([k.property()],b.prototype,"scale",void 0);c.__decorate([k.property()],
b.prototype,"state",null);b=c.__decorate([y.subclass("InteractionState")],b);a.headingToAngle=B;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/transformGraphic/ExtentTransformTool":function(){define("exports ../../../../../chunks/tslib.es6 ../../../../../core/Evented ../../../../../core/handleUtils ../../../../../core/reactiveUtils ../../../../../core/unitUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/accessorSupport/ensureType ../../../../../core/arrayUtils ../../../../../core/has ../../../../../core/accessorSupport/decorators/subclass ../../../../../geometry/support/aaBoundingRect ../../../../../geometry/support/vectorStacks ../../../analysis/Slice/sliceToolUtils ../../Manipulator3D ../../manipulatorUtils ../ManipulatorType ../manipulatorUtils ../visualElementUtils ./ExtentMove ./ExtentRotate ./ExtentScale ./extentUtils ./PreserveAspectRatio ../../visualElements/OutlineVisualElement ../../../layers/graphics/GraphicState ../../../../interactive/InteractiveToolBase ../../../../interactive/editGeometry/EditGeometryOperations ../../../../interactive/editGeometry/support/editPlaneUtils ../../../../interactive/sketch/SketchTooltipOptions ../../../../interactive/tooltip/Tooltip".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m,n,h,q,z,r,D,v,I,p,w,C,F,G,J,L,x){a.ExtentTransformTool=class extends l.EventedMixin(F.InteractiveToolBase){constructor(H){super(H);this.enableRotation=this.enableScaling=this.enableZ=!0;this.tooltipOptions=new L;this._preserveAspectRatio=new p.PreserveAspectRatio;this.grabbing=!1;this._attachmentOrigin=this.inputState=null;this.type="transform-3d";this._outlineVisualElement=null}initialize(){const {view:H,graphic:K}=this,E=this._graphicState=new C.GraphicState({graphic:K});
var M=this._editGeometryOperations=G.EditGeometryOperations.fromGeometry(K.geometry,H.state.viewingMode);const O=this._bounds=new I.TransformBounds(this,()=>this._updateManipulators(),M.data);this._extentMove=new r.ExtentMove(this,E,M,O);this._extentScale=new v.ExtentScale(this,E,M,O,()=>this._preserveAspectRatio.createDragEventPipelineStep());this._extentRotate=new D.ExtentRotate(this,M,O);this.addHandles([d.watch(()=>this.enableZ,()=>this._updateManipulatorAvailability(this._extentMove.moveZManipulator,
h.ManipulatorType.TRANSLATE_Z)),d.watch(()=>this.enableScaling,()=>this._extentScale.forEachManipulator(T=>this._updateManipulatorAvailability(T,h.ManipulatorType.SCALE))),d.watch(()=>this.enableRotation,()=>this._updateManipulatorAvailability(this._extentRotate.rotateManipulator,h.ManipulatorType.ROTATE))]);this._updateAllManipulatorAvailability();M=z.createVisualElements({view:H,graphic:K,forEachManipulator:T=>this._forEachManipulator(T),onManipulatorsChanged:()=>e.makeHandle()});if(null!=M){const {visualElement:T}=
M;T instanceof w.OutlineVisualElement&&(this._outlineVisualElement=T,this.addHandles(T.events.on("attachment-origin-changed",()=>this._bounds.updateDisplayBounds())));this.addHandles(M)}this.addHandles([E.on("changed",()=>this._onGeometryChanged()),d.watch(()=>E.displaying,()=>this._updateAllManipulatorAvailability()),d.watch(()=>E.isDraped,()=>this._graphicDrapedChanged(),d.initial),d.watch(()=>H.pointsOfInterest?.centerOnSurfaceFrequent.location,()=>O.updateDisplayBounds()),H.trackGraphicState(E)]);
this._forEachManipulator(T=>{this.addHandles(T.events.on("grab-changed",()=>{this.grabbing=T.grabbing;this._updateAllManipulatorAvailability()}))});this._forEachManipulator((T,U)=>{this.addHandles(T.events.on("immediate-click",ba=>{U===h.ManipulatorType.TRANSLATE_XY&&this.emit("immediate-click",{...ba,graphic:K});ba.stopPropagation()}))});this._initializeTooltip();this.finishToolCreation()}destroy(){this._extentMove.destroy();this._extentScale.destroy();this._extentRotate.destroy();this._editGeometryOperations.destroy();
this._tooltip.destroy();this._set("view",null);this._set("graphic",null)}_initializeTooltip(){const {view:H}=this,K=this._tooltip=new x.Tooltip({view:H}),E=()=>{K.info=this._getUpdatedTooltipInfo()};this.addHandles([this.on("graphic-translate-start",E),this.on("graphic-translate",E),this.on("graphic-translate-stop",()=>{this._tooltip.clear()}),this.on("graphic-rotate-start",E),this.on("graphic-rotate",E),this.on("graphic-rotate-stop",E),this.on("graphic-scale-start",E),this.on("graphic-scale",E),
this.on("graphic-scale-stop",E)]);this._forEachManipulator(M=>{this.addHandles([M.events.on("focus-changed",E),M.events.on("grab-changed",E),M.events.on("drag",O=>{"cancel"===O.action?this._tooltip.clear():E()})])})}_getUpdatedTooltipInfo(){return this.tooltipOptions.enabled?this._extentMove.getUpdatedTooltipInfo()??this._extentScale.getUpdatedTooltipInfo()??this._extentRotate.getUpdatedTooltipInfo():null}_onGeometryChanged(){this._bounds.updateDisplayBounds()}_graphicDrapedChanged(){this.removeHandles("draped-elevation-changes");
this._bounds.updateDisplayBounds();this._graphicState.isDraped&&this.addHandles(this.view.elevationProvider.on("elevation-change",H=>{null!=this._attachmentOrigin&&A.containsXY(H.extent,this._attachmentOrigin.x,this._attachmentOrigin.y)&&this._bounds.updateDisplayBounds()}),"draped-elevation-changes")}_updateManipulators(){if(this.visible){var H=this._bounds.displayBounds,K=g.calculateBoundedPlaneTranslateRotate(H,b.sm4d.get());this._extentMove.updateManipulators(K,H);this._extentScale.updateManipulators(K,
H);this._extentRotate.updateManipulators(K,H)}}_updateAllManipulatorAvailability(){this._forEachManipulator((H,K)=>this._updateManipulatorAvailability(H,K))}_updateManipulatorAvailability(H,K){const E=this.grabbing&&!H.grabbing;H.interactive=!E;if(H instanceof m.Manipulator3D){const M=this._graphicState.displaying,O=this.enableZ&&q.canMoveZ(this.graphic);switch(K){case h.ManipulatorType.ROTATE:H.available=M&&this.enableRotation;break;case h.ManipulatorType.SCALE:H.available=M&&(this.enableScaling||
this.enableRotation||O);H.interactive=!E&&this.enableScaling;H.state=this.enableScaling?g.resizeNormal:g.resizeOutlineOnly;break;case h.ManipulatorType.TRANSLATE_Z:H.available=M&&O;break;default:H.available=M}}}_forEachManipulator(H){this._extentMove.forEachManipulator(H);this._extentScale.forEachManipulator(H);this._extentRotate.forEachManipulator(H)}get preserveAspectRatio(){return this._preserveAspectRatio.enabled}set preserveAspectRatio(H){this._preserveAspectRatio.enabled=H;this._set("preserveAspectRatio",
H)}get moveUnit(){return k.lengthUnitFromSpatialReference(this.view.spatialReference)??"meters"}get attachmentOrigin(){const H=this.graphic.geometry;return this._attachmentOrigin=(this._graphicState.isDraped?null:this._outlineVisualElement?.attachmentOrigin)??n.getGraphicAttachmentOrigin(this.view,this.graphic)??H?.extent?.center}reset(){}cancel(){if(this.canUndo){const H=this._editGeometryOperations.undo();J.unapply(H,this._bounds.mapBounds);this.graphic.geometry=this._editGeometryOperations.data.geometry}this.inputState=
null}get canUndo(){return this._editGeometryOperations.canUndo}undo(){if(null!=this.inputState)this.view.activeTool=null;else if(this.canUndo){const H=this._editGeometryOperations.undo();J.unapply(H,this._bounds.mapBounds);this.graphic.geometry=this._editGeometryOperations.data.geometry}}get canRedo(){return this._editGeometryOperations.canRedo}redo(){if(this.canRedo){const H=this._editGeometryOperations.redo();J.apply(H,this._bounds.mapBounds);this.graphic.geometry=this._editGeometryOperations.data.geometry}}get test(){return{moveZManipulator:this._extentMove.moveZManipulator,
resizeManipulators:this._extentScale.resizeManipulators,rotateManipulator:this._extentRotate.rotateManipulator,tooltip:this._tooltip}}};c.__decorate([t.property({constructOnly:!0,nonNullable:!0})],a.ExtentTransformTool.prototype,"view",void 0);c.__decorate([t.property({constructOnly:!0,nonNullable:!0})],a.ExtentTransformTool.prototype,"graphic",void 0);c.__decorate([t.property()],a.ExtentTransformTool.prototype,"enableZ",void 0);c.__decorate([t.property()],a.ExtentTransformTool.prototype,"enableScaling",
void 0);c.__decorate([t.property()],a.ExtentTransformTool.prototype,"enableRotation",void 0);c.__decorate([t.property({constructOnly:!0,type:L})],a.ExtentTransformTool.prototype,"tooltipOptions",void 0);c.__decorate([t.property()],a.ExtentTransformTool.prototype,"preserveAspectRatio",null);c.__decorate([t.property()],a.ExtentTransformTool.prototype,"moveUnit",null);c.__decorate([t.property()],a.ExtentTransformTool.prototype,"grabbing",void 0);c.__decorate([t.property()],a.ExtentTransformTool.prototype,
"inputState",void 0);c.__decorate([t.property({readOnly:!0})],a.ExtentTransformTool.prototype,"type",void 0);a.ExtentTransformTool=c.__decorate([B.subclass("esri.views.3d.interactive.editingTools.transformGraphic.ExtentTransformTool")],a.ExtentTransformTool);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/analysis/Slice/sliceToolUtils":function(){define("exports ../../../../geometry ../../../../analysis/SlicePlane ../../../../core/has ../../../../core/Logger ../../../../core/mathUtils ../../../../core/screenUtils ../../../../chunks/mat4 ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../geometry/projection ../../../../geometry/support/Axis ../../../../chunks/boundedPlane ../../../../geometry/support/plane ../../../../geometry/support/ray ../../../../geometry/support/vector ../../../../geometry/support/vectorStacks ./settings ./sliceToolConfig ../support/projectionUtils ../../interactive/manipulatorUtils ../../interactive/visualElements/LineVisualElement ../../interactive/visualElements/SlicePlaneVisualElement ../../support/RenderCoordsHelper ../../support/geometryUtils/ray ../../webgl-engine/lib/Material ../../../interactive/interfaces ../../../../geometry/Extent".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m,n,h,q,z,r,D,v,I,p,w,C,F,G){function J(P,X,ma,aa,W,ia){const ha=f.dot(P,X),V=h.sv3d.get(),ea=h.sv3d.get();switch(aa===a.SliceOrientation.HORIZONTAL_OR_VERTICAL?Math.abs(ha)>z.verticalDotThreshold?a.SliceOrientation.HORIZONTAL:a.SliceOrientation.VERTICAL:aa){case a.SliceOrientation.VERTICAL:f.cross(V,Math.abs(ha)<=z.smallAngleDotThreshold?P:ma.viewUp,X);f.copy(ea,X);break;case a.SliceOrientation.HORIZONTAL:f.cross(V,ma.viewUp,X);f.cross(ea,X,V);break;case a.SliceOrientation.TILTED:f.cross(V,
Math.abs(ha)<=z.smallAngleDotThreshold?X:ma.viewUp,P),f.cross(ea,P,V)}P=f.cross(h.sv3d.get(),V,ea);0<f.dot(P,ma.viewForward)&&f.scale(ea,ea,-1);f.normalize(W,V);f.normalize(ia,ea)}function L(P,X,ma){var aa=X.worldUpAtPosition(P.origin,h.sv3d.get());X=P.basis1;aa=n.angleAroundAxis(aa,P.basis2,P.basis1)+fa;return b.rotate(P,Math.round(aa/fa)*fa-aa,X,ma)}function x(P,X){switch(X){case U.POSITIVE_X:return{basis:P.basis1,direction:1,position:f.add(h.sv3d.get(),P.origin,P.basis1),edge:X};case U.POSITIVE_Y:return{basis:P.basis2,
direction:1,position:f.add(h.sv3d.get(),P.origin,P.basis2),edge:X};case U.NEGATIVE_X:return{basis:P.basis1,direction:-1,position:f.subtract(h.sv3d.get(),P.origin,P.basis1),edge:X};case U.NEGATIVE_Y:return{basis:P.basis2,direction:-1,position:f.subtract(h.sv3d.get(),P.origin,P.basis2),edge:X}}}function H(P,X,ma){const aa=ma.projectToRenderScreen(f.add(h.sv3d.get(),P,X),t.castRenderScreenPointArray3(h.sv3d.get()));P=ma.projectToRenderScreen(f.subtract(h.sv3d.get(),P,X),t.castRenderScreenPointArray3(h.sv3d.get()));
return f.squaredLength(f.subtract(aa,aa,P))}function K(P){const X=f.length(P.basis1);P=f.length(P.basis2);return z.resizeHandleEdgePaddingFrac*Math.min(X,P)}function E(P){return 0!==P.direction[0]&&0!==P.direction[1]}function M(P,X,ma,aa,W,ia,ha=b.create()){if(!ia.toRenderCoords(P,ha.origin))return d.getLogger("esri.views.3d.analysis.Slice.sliceToolUtils").error(`Failed to project slice plane position, projection from ${P.spatialReference.wkid} is not supported`),null;ia.worldBasisAtPosition(ha.origin,
A.Axis.X,ha.basis1);ia.worldBasisAtPosition(ha.origin,A.Axis.Y,ha.basis2);g.fromVectorsAndPoint(ha.basis2,ha.basis1,ha.origin,ha.plane);b.rotate(ha,-k.deg2rad(X),b.normal(ha),ha);b.rotate(ha,k.deg2rad(ma),ha.basis1,ha);f.scale(ha.basis1,ha.basis1,aa/2);f.scale(ha.basis2,ha.basis2,W/2);b.updateUnboundedPlane(ha);return ha}function O(P,X){if(null==P?.position)return null;const ma=r.applyProjectionAndElevationAlignment(P.position,X.spatialReference,X.elevationProvider);if(null==ma)return null;X=p.RenderCoordsHelper.renderUnitScaleFactor(P.position.spatialReference,
X.spatialReference);return{position:ma,heading:P.heading,tilt:P.tilt,renderWidth:P.width*X,renderHeight:P.height*X}}function T(P,X,ma,aa=b.create()){if(null==P)return null;P=M(P.position,P.heading,P.tilt,P.renderWidth,P.renderHeight,X.renderCoordsHelper,aa);ma.tiltEnabled||null==P||L(P,X.renderCoordsHelper,P);return P}var U;(function(P){P[P.POSITIVE_X=0]="POSITIVE_X";P[P.POSITIVE_Y=1]="POSITIVE_Y";P[P.NEGATIVE_X=2]="NEGATIVE_X";P[P.NEGATIVE_Y=3]="NEGATIVE_Y"})(U||(U={}));c=F.ManipulatorStateCustomFlags.Custom1;
a.RotationAxis=void 0;(function(P){P[P.HEADING=1]="HEADING";P[P.TILT=2]="TILT"})(a.RotationAxis||(a.RotationAxis={}));a.SliceOrientation=void 0;(function(P){P[P.HORIZONTAL_OR_VERTICAL=0]="HORIZONTAL_OR_VERTICAL";P[P.HORIZONTAL=1]="HORIZONTAL";P[P.VERTICAL=2]="VERTICAL";P[P.TILTED=3]="TILTED"})(a.SliceOrientation||(a.SliceOrientation={}));const ba=F.ManipulatorStateCustomFlags.Custom2,la=m.create(),fa=Math.PI/2;m=F.ManipulatorStateCustomFlags.Custom1;F=F.ManipulatorStateCustomFlags.Custom2;a.DidPointerMoveRecentlyFlag=
c;a.IsShiftEdgeOnScreenFlag=ba;a.calculateBoundedPlaneTranslateRotate=function(P,X){return D.calculateTranslateRotateFromBases(P.basis1,P.basis2,P.origin,X)};a.calculateDiagonalResizeHandleScale=function(P){return K(P)};a.calculatePlaneHalfSize=function(P,X){return z.initialPlaneHalfSizeViewProportion*Math.min(X.width,X.height)*X.computeRenderPixelSizeAt(P)};a.createGridVisualElement=function(P){return new I.SlicePlaneVisualElement({view:P,attached:!1,backgroundColor:q.planeColor,gridColor:q.getGridColor(P.effectiveTheme),
gridWidth:4,renderOccluded:C.RenderOccludedFlag.OccludeAndTransparent,isDecoration:!0})};a.createOutlineVisualElement=function(P){return new v.LineVisualElement({view:P,attached:!1,color:q.getOutlineColor(P.effectiveTheme),width:z.planeOutlineWidth,renderOccluded:C.RenderOccludedFlag.OccludeAndTransparent,geometry:[[[-1,-1,0],[1,-1,0],[1,1,0],[-1,1,0],[-1,-1,0]]],isDecoration:!0})};a.createPlane=function(P,X,ma,aa,W,ia,ha,V){ha=ha.worldUpAtPosition(P,h.sv3d.get());J(X,ha,W,ia,V.basis1,V.basis2);f.scale(V.basis1,
V.basis1,ma);f.scale(V.basis2,V.basis2,aa);f.copy(V.origin,P);g.fromVectorsAndPoint(V.basis2,V.basis1,V.origin,V.plane);return V};a.createRotatePlane=function(P,X,ma,aa){X=X.worldUpAtPosition(P.origin,h.sv3d.get());const W=h.sv3d.get();switch(ma){case a.RotationAxis.HEADING:f.copy(W,X);break;case a.RotationAxis.TILT:f.copy(W,P.basis1)}return g.fromPositionAndNormal(P.origin,W,aa)};a.createShiftPlane=function(P,X,ma,aa){ma=f.cross(h.sv3d.get(),X,ma);f.cross(ma,ma,X);return g.fromPositionAndNormal(P,
ma,aa)};a.forceHorizontalOrVertical=L;a.isDiagonalResizeHandle=E;a.isIBuildingSceneLayerView3D=function(P){return null!=("building-scene-3d"===P.type?P:null)};a.normalToBases=J;a.planeToExtent=function(P,X,ma){if(null==P)return null;const aa=P.origin,W=h.sv3d.get(),ia=h.sv3d.get(),ha=h.sv3d.get(),V=h.sv3d.get();f.add(W,aa,P.basis1);f.add(W,W,P.basis2);f.add(ia,aa,P.basis1);f.sub(ia,ia,P.basis2);f.sub(ha,aa,P.basis1);f.sub(ha,ha,P.basis2);f.sub(V,aa,P.basis1);f.add(V,V,P.basis2);let ea,Q,Z,na,va,ra;
for(const oa of[W,ia,ha,V]){P=X.fromRenderCoords(oa,oa,ma);if(null==P)return null;ea=null==ea?P[0]:Math.min(ea,P[0]);Q=null==Q?P[0]:Math.max(Q,P[0]);Z=null==Z?P[1]:Math.min(Z,P[1]);na=null==na?P[1]:Math.max(na,P[1]);va=null==va?P[2]:Math.min(va,P[2]);ra=null==ra?P[2]:Math.max(ra,P[2])}return new G({xmin:ea,xmax:Q,ymin:Z,ymax:na,zmin:va,zmax:ra,spatialReference:ma})};a.planeToShape=function(P,X,ma,aa=new l){if(null==P)return null;const {renderCoordsHelper:W}=X;var ia=W.fromRenderCoords(P.origin,X.spatialReference);
if(null==ia)return null;ia=B.tryProjectWithZConversion(ia,ma);if(null==ia)return null;aa.position=ia;ia=2*f.length(P.basis1);const ha=2*f.length(P.basis2);X=p.RenderCoordsHelper.renderUnitScaleFactor(X.spatialReference,ma);aa.width=ia*X;aa.height=ha*X;X=W.worldUpAtPosition(P.origin,h.sv3d.get());aa.tilt=k.rad2deg(n.angleAroundAxis(X,P.basis2,P.basis1)+fa);aa.heading=W.headingAtPosition(P.origin,P.basis1)-90;return aa};a.projectAndElevationAlignShape=O;a.projectedShapeToPlane=T;a.resizeNormal=m;a.resizeOutlineOnly=
F;a.resizePlane=function(P,X,ma,aa,W,ia){const ha=f.copy(h.sv3d.get(),W.origin);f.add(ha,ha,f.scale(h.sv3d.get(),W.basis1,0>P.direction[0]?1:-1));f.add(ha,ha,f.scale(h.sv3d.get(),W.basis2,0>P.direction[1]?1:-1));var V=f.length(W.basis1);const ea=f.length(W.basis2);ma=f.subtract(h.sv3d.get(),ma,ha);var Q=f.subtract(h.sv3d.get(),X,ha);let Z=0;X=0;if(E(P)){var na=K(W);const va=K(ia);Z=V-.5*P.direction[0]*f.dot(W.basis1,Q)/V;X=ea-.5*P.direction[1]*f.dot(W.basis2,Q)/ea;Q=va/na;Z*=Q;X*=Q}Q=.5*P.direction[0]*
f.dot(W.basis1,ma)/V;na=.5*P.direction[1]*f.dot(W.basis2,ma)/ea;ma=Z+Q;X+=na;V=f.scale(h.sv3d.get(),W.basis1,ma/V);W=f.scale(h.sv3d.get(),W.basis2,X/ea);(0>=ma||H(ia.origin,V,aa)<=z.planeMinBasisScreenLen2)&&f.copy(V,ia.basis1);(0>=X||H(ia.origin,W,aa)<=z.planeMinBasisScreenLen2)&&f.copy(W,ia.basis2);aa=f.copy(h.sv3d.get(),ha);f.add(aa,aa,f.scale(h.sv3d.get(),V,0>P.direction[0]?-1:1));f.add(aa,aa,f.scale(h.sv3d.get(),W,0>P.direction[1]?-1:1));return b.fromValues(aa,V,W,ia)};a.shapeToPlane=function(P,
X,ma,aa=b.create()){P=O(P,X);return null==P?null:T(P,X,ma,aa)};a.updateResizeHandle=function(P,X,ma,aa){var W=f.length(aa.basis1);const ia=f.length(aa.basis2),ha=K(aa),V=K(aa),ea=f.set(h.sv3d.get(),0,0,0);f.add(ea,f.scale(h.sv3d.get(),aa.basis1,X.direction[0]),f.scale(h.sv3d.get(),aa.basis2,X.direction[1]));f.add(ea,aa.origin,ea);aa=0;let Q=1;E(X)?(1===X.direction[0]&&-1===X.direction[1]?aa=fa:1===X.direction[0]&&1===X.direction[1]?aa=Math.PI:-1===X.direction[0]&&1===X.direction[1]&&(aa=3*Math.PI/
2),Q=V):(X=0!==X.direction[0]?1:2,aa=1===X?fa:0,Q=(1===X?ia:W)-ha);W=u.fromZRotation(h.sm4d.get(),aa);u.scale(W,W,f.set(h.sv3d.get(),Q,Q,Q));u.multiply(W,ma,W);W[12]=0;W[13]=0;W[14]=0;P.modelTransform=W;P.renderLocation=ea};a.updateRotateHeadingHandle=function(P,X,ma,aa){aa=aa.worldUpAtPosition(ma.origin,h.sv3d.get());const W=x(ma,U.POSITIVE_X),ia=u.fromZRotation(h.sm4d.get(),W.edge*Math.PI/2);u.rotateX(ia,ia,-(n.angleAroundAxis(aa,ma.basis2,ma.basis1)+fa));u.multiply(ia,X,ia);ia[12]=0;ia[13]=0;ia[14]=
0;P.modelTransform=ia;P.renderLocation=W.position};a.updateRotateTiltHandle=function(P,X,ma){ma=x(ma,U.POSITIVE_Y);const aa=u.fromZRotation(h.sm4d.get(),ma.edge*Math.PI/2);u.rotateX(aa,aa,fa);u.multiply(aa,X,aa);aa[12]=0;aa[13]=0;aa[14]=0;P.modelTransform=aa;P.renderLocation=ma.position};a.updateShiftRestartHandle=function(P,X,ma,aa){var W=x(ma,U.NEGATIVE_X);const ia=h.sm4d.get();u.rotateZ(ia,X,W.edge*Math.PI/2);X=f.normalize(h.sv3d.get(),W.basis);X=f.scale(h.sv3d.get(),X,W.direction*aa.computeScreenPixelSizeAt(W.position)*
z.shiftRestartOffsetDistance);f.add(X,X,W.position);W=aa.projectToRenderScreen(X,t.castRenderScreenPointArray3(h.sv3d.get()));const [ha,V,ea,Q]=aa.viewport;var Z=Math.min(ea,Q)/16;let na=!0;W[0]<ha+Z?(W[0]=ha+Z,na=!1):W[0]>ha+ea-Z&&(W[0]=ha+ea-Z,na=!1);W[1]<V+Z?(W[1]=V+Z,na=!1):W[1]>V+Q-Z&&(W[1]=V+Q-Z,na=!1);Z=na;w.fromRender(aa,W,la);f.normalize(la.direction,la.direction);aa=h.sv3d.get();!Z&&b.intersectRay(ma,la,aa)&&(X=aa);ia[12]=0;ia[13]=0;ia[14]=0;P.modelTransform=ia;P.renderLocation=y.clone(X);
P.state=Z?P.state|ba:P.state&~ba};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/analysis/SlicePlane":function(){define("../chunks/tslib.es6 ../geometry ../core/Clonable ../core/Cyclical ../core/JSONSupport ../core/maybe ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/persistable ../geometry/Point".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g){c=class extends l.ClonableMixin(d.JSONSupport){constructor(m){super(m);this.type="plane";this.position=null;this.tilt=this.heading=0;this.height=this.width=10}equals(m){return this.heading===m.heading&&this.tilt===m.tilt&&k.equalsMaybe(this.position,m.position)&&this.width===m.width&&this.height===m.height}};a.__decorate([t.property({readOnly:!0,json:{read:!1,write:!0}})],c.prototype,"type",void 0);a.__decorate([t.property({type:g}),b.persistable()],c.prototype,
"position",void 0);a.__decorate([t.property({type:Number,nonNullable:!0,range:{min:0,max:360}}),b.persistable(),u.cast(m=>e.cyclicalDegrees.normalize(A.ensureNumber(m),0,!0))],c.prototype,"heading",void 0);a.__decorate([t.property({type:Number,nonNullable:!0,range:{min:0,max:360}}),b.persistable(),u.cast(m=>e.cyclicalDegrees.normalize(A.ensureNumber(m),0,!0))],c.prototype,"tilt",void 0);a.__decorate([t.property({type:Number,nonNullable:!0}),b.persistable()],c.prototype,"width",void 0);a.__decorate([t.property({type:Number,
nonNullable:!0}),b.persistable()],c.prototype,"height",void 0);return c=a.__decorate([B.subclass("esri.analysis.SlicePlane")],c)})},"esri/views/3d/analysis/Slice/settings":function(){define(["exports","../../../../core/colorUtils","../../../../chunks/vec4f64"],function(a,c,l){l=l.fromValues(0,0,0,.04);a.getGridColor=function({accentColor:e}){return c.multiplyOpacityToUnitRGBA(e,.5)};a.getOutlineColor=function({accentColor:e}){return c.multiplyOpacityToUnitRGBA(e,.7)};a.planeColor=l;Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/analysis/Slice/sliceToolConfig":function(){define(["exports","../../../../core/has","../../../../core/mathUtils"],function(a,c,l){c=c("mac")?"Meta":"Control";const e=Math.cos(l.deg2rad(45));l=Math.cos(l.deg2rad(5));a.displayFocusMultiplier=2;a.forceHorizontalModifier=c;a.forceVerticalModifier="Shift";a.initialDepthOffsetFrac=.02;a.initialPlaneHalfSizeViewProportion=.4;a.planeMinBasisScreenLen2=1600;a.planeOutlineWidth=1;a.planePreviewOutlineWidth=
2;a.pointerMoveTimerMs=2500;a.previewFadeDotThreshold=.95;a.previewFadeDurationSeconds=.3;a.resizeHandleCornerInputRadius=6;a.resizeHandleCornerWidth=4;a.resizeHandleEdgeInputRadius=4;a.resizeHandleEdgePaddingFrac=.3;a.resizeHandleEdgeWidth=1;a.shiftRestartArrowLength=48;a.shiftRestartArrowOutlineWidth=2.25;a.shiftRestartOffsetDistance=40;a.shiftRestartTipFocusMultiplier=1.15;a.shiftRestartTipLength=22.5;a.shiftRestartTipRadius=11;a.shiftRestartTubeFocusMultiplier=1.15;a.shiftRestartTubeRadius=3;
a.smallAngleDotThreshold=l;a.verticalDotThreshold=e;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/analysis/support/projectionUtils":function(){define(["exports","../../../../geometry/projection","../../support/ElevationProvider"],function(a,c,l){a.applyProjectionAndElevationAlignment=function(e,d,k,t=!1){e=c.tryProjectWithZConversion(e,d);if(null==e)return null;e.hasZ&&!t||null==k||(e.z=l.getElevationAtPoint(k,e)??0);return e};a.logFailedGeometryProjectionError=function(e,
d,k){k.warnOnce(`Failed to project analysis geometry (id: '${e.id}'), projection from spatial reference `+`(wkid: '${d.wkid}') to view spatial reference is not supported. `+"Projection may be possible after calling projection.load().")};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/visualElements/LineVisualElement":function(){define("exports ../../../../chunks/mat4 ../../../../chunks/mat4f64 ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../chunks/vec4f64 ./Object3DVisualElement ../../support/engineContent/line ../../webgl-engine/lib/Material ../../webgl-engine/materials/RibbonLineMaterial".split(" "),
function(a,c,l,e,d,k,t,u,f,y){class B extends t.Object3DVisualElement{constructor(b,g){super(b);this._hasExternalMaterial=!1;this._hasExternalMaterial=null!=g;this._material=null!=g?g:new y.RibbonLineMaterial({width:1,color:k.fromValues(1,0,1,1),stippleOffColor:null,stipplePattern:null,stipplePreferContinuous:!0,isClosed:!1,falloff:0,innerColor:null,innerWidth:1,hasPolygonOffset:!1,renderOccluded:f.RenderOccludedFlag.OccludeAndTransparent,isDecoration:!!b.isDecoration,writeDepth:!0});this.applyProperties(b)}setGeometryFromRenderSpacePoint(b,
g=1E3){this.geometry=[[[b[0]-g,b[1],b[2]],[b[0]+g,b[1],b[2]]],[[b[0],b[1]-g,b[2]],[b[0],b[1]+g,b[2]]],[[b[0],b[1],b[2]-g],[b[0],b[1],b[2]+g]]]}setGeometryFromExtent(b){const g=this.view.spatialReference,m=d.create(),n=d.create(),h=[];e.set(m,b[0],b[1],100);this.view.renderCoordsHelper.toRenderCoords(m,g,n);h.push([n[0],n[1],n[2]]);e.set(m,b[2],b[1],100);this.view.renderCoordsHelper.toRenderCoords(m,g,n);h.push([n[0],n[1],n[2]]);e.set(m,b[2],b[3],100);this.view.renderCoordsHelper.toRenderCoords(m,
g,n);h.push([n[0],n[1],n[2]]);e.set(m,b[0],b[3],100);this.view.renderCoordsHelper.toRenderCoords(m,g,n);h.push([n[0],n[1],n[2]]);e.set(m,b[0],b[1],100);this.view.renderCoordsHelper.toRenderCoords(m,g,n);h.push([n[0],n[1],n[2]]);e.set(m,b[0],b[1],100);this.view.renderCoordsHelper.toRenderCoords(m,g,n);h.push([n[0],n[1],n[2]]);this.geometry=[h]}setGeometryFromFrustum(b){const g=[];b.lines.forEach(m=>{g.push([m.origin[0],m.origin[1],m.origin[2]]);g.push([m.endpoint[0],m.endpoint[1],m.endpoint[2]])});
this.geometry=[g]}setGeometryFromBoundedPlane(b){const g=[],m=b.origin,n=b.basis1;b=b.basis2;const h=d.create(),q=d.create(),z=d.create(),r=d.create();h[0]=m[0]-.5*n[0]-.5*b[0];h[1]=m[1]-.5*n[1]-.5*b[1];h[2]=m[2]-.5*n[2]-.5*b[2];q[0]=m[0]-.5*n[0]+.5*b[0];q[1]=m[1]-.5*n[1]+.5*b[1];q[2]=m[2]-.5*n[2]+.5*b[2];z[0]=m[0]+.5*n[0]+.5*b[0];z[1]=m[1]+.5*n[1]+.5*b[1];z[2]=m[2]+.5*n[2]+.5*b[2];r[0]=m[0]+.5*n[0]-.5*b[0];r[1]=m[1]+.5*n[1]-.5*b[1];r[2]=m[2]+.5*n[2]-.5*b[2];g.push([h[0],h[1],h[2]]);g.push([q[0],
q[1],q[2]]);g.push([z[0],z[1],z[2]]);g.push([r[0],r[1],r[2]]);g.push([h[0],h[1],h[2]]);this.geometry=[g]}setGeometryFromSegment(b){const g=b.endRenderSpace;this.transform=c.fromTranslation(A,g);({points:b}=b.createRenderGeometry(g,this.view.renderCoordsHelper));this.geometry=[b]}setGeometryFromSegments(b,g=d.ZEROS){this.transform=c.fromTranslation(A,g);this.geometry=b.map(m=>m.createRenderGeometry(g,this.view.renderCoordsHelper).points)}getTransformedGeometry(){return null==this._geometry?null:this._geometry.map(b=>
b.map(g=>e.transformMat4(d.create(),g,this.transform)))}get renderOccluded(){return this._material.parameters.renderOccluded}set renderOccluded(b){this._material.setParameters({renderOccluded:b})}get geometry(){return this._geometry}set geometry(b){this._geometry=b;this.recreateGeometry()}get width(){return this._material.parameters.width}set width(b){this._material.setParameters({width:b})}get color(){return this._material.parameters.color}set color(b){const g=1===b[3];this._material.setParameters({color:k.clone(b),
writeDepth:g})}get innerWidth(){return this._material.parameters.innerWidth}set innerWidth(b){this._material.setParameters({innerWidth:b})}get innerColor(){return this._material.parameters.innerColor}set innerColor(b){this._material.setParameters({innerColor:null!=b?k.clone(b):null})}get stipplePattern(){return this._material.parameters.stipplePattern}set stipplePattern(b){null!=this._material&&this._material.setParameters({stipplePattern:b})}get stippleOffColor(){return this._material.parameters.stippleOffColor}set stippleOffColor(b){this._material.setParameters({stippleOffColor:null!=
b?k.clone(b):null})}get stipplePreferContinuous(){return this._material.parameters.stipplePreferContinuous}set stipplePreferContinuous(b){this._material.setParameters({stipplePreferContinuous:b})}get falloff(){return this._material.parameters.falloff}set falloff(b){this._material.setParameters({falloff:b})}get polygonOffset(){return this._material.parameters.hasPolygonOffset}set polygonOffset(b){this._material.setParameters({hasPolygonOffset:b})}createExternalResources(){}destroyExternalResources(){}createGeometries(b){for(const g of u.lineStripsToParameters(this.geometry)){const m=
u.createGeometry(this._material,g);b.addGeometry(m)}}forEachExternalMaterial(b){this._hasExternalMaterial||b(this._material)}}const A=l.create();a.LineVisualElement=B;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/visualElements/SlicePlaneVisualElement":function(){define("exports ../../../../chunks/vec4 ../../../../chunks/vec4f64 ./Object3DVisualElement ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/Material ../../webgl-engine/materials/SlicePlaneMaterial".split(" "),
function(a,c,l,e,d,k,t){class u extends e.Object3DVisualElement{constructor(f){super(f);this._material=null;this._renderOccluded=k.RenderOccludedFlag.OccludeAndTransparent;this._gridWidth=1;this._gridColor=l.fromValues(1,0,0,1);this._backgroundColor=l.fromValues(1,0,0,1);this.applyProperties(f)}get renderOccluded(){return this._renderOccluded}set renderOccluded(f){f!==this._renderOccluded&&(this._renderOccluded=f,this._updateMaterial())}get gridWidth(){return this._gridWidth}set gridWidth(f){this._gridWidth!==
f&&(this._gridWidth=f,this._updateMaterial())}get gridColor(){return this._gridColor}set gridColor(f){c.copy(this._gridColor,f);this._updateMaterial()}get backgroundColor(){return this._backgroundColor}set backgroundColor(f){c.copy(this._backgroundColor,f);this._updateMaterial()}createExternalResources(){this._material=new t.SlicePlaneMaterial(this._materialParameters)}destroyExternalResources(){this._material=null}forEachExternalMaterial(f){null!=this._material&&f(this._material)}createGeometries(f){if(null!=
this._material){const y=d.createSquareGeometry(this._material);f.addGeometry(y)}}get _materialParameters(){return{backgroundColor:this._backgroundColor,gridWidth:this._gridWidth,gridColor:this._gridColor,renderOccluded:this._renderOccluded,isDecoration:this.isDecoration}}_updateMaterial(){null!=this._material&&this._material.setParameters(this._materialParameters)}}a.SlicePlaneVisualElement=u;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/webgl-engine/materials/SlicePlaneMaterial":function(){define("exports ../core/shaderLibrary/ShaderOutput ../core/shaderTechnique/ShaderTechniqueConfiguration ../lib/GLMaterial ../lib/Material ../lib/RenderSlot ./DefaultBufferWriter ./DefaultLayouts ./TriangleMaterial ../shaders/SlicePlaneMaterialTechnique".split(" "),
function(a,c,l,e,d,k,t,u,f,y){class B extends f.TriangleMaterial{constructor(g){super(g,new b);this._configuration=new l.ShaderTechniqueConfiguration}createBufferWriter(){return new t.DefaultBufferWriter(u.PositionUVLayout)}produces(g,m){return m===c.ShaderOutput.Color&&g===k.RenderSlot.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL}createGLMaterial(g){return new A(g)}getConfiguration(){return this._configuration}}class A extends e{constructor(g){super(g);this.ensureTechnique(y.SlicePlaneMaterialTechnique,
null)}beginSlot(){return this.technique}}class b extends y.SlicePlaneMaterialPassParameters{constructor(){super(...arguments);this.renderOccluded=d.RenderOccludedFlag.Occlude;this.isDecoration=!1}}a.Parameters=b;a.SlicePlaneMaterial=B;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/webgl-engine/shaders/SlicePlaneMaterialTechnique":function(){define("require exports ../../../../chunks/vec4f64 ../core/shaderModules/interfaces ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../lib/DefaultVertexAttributeLocations ../lib/Program ../../../../chunks/SlicePlaneMaterial.glsl ../../../webgl/enums ../../../webgl/renderState".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B){class A extends e.NoParameters{constructor(){super(...arguments);this.backgroundColor=l.fromValues(1,0,0,.5);this.gridColor=l.fromValues(0,1,0,.5);this.gridWidth=4}}class b extends k.ShaderTechnique{initializeProgram(g){return new u.Program(g.rctx,b.shader.get().build(this.configuration),t.Default3D)}initializePipeline(){return B.makePipelineState({blending:B.separateBlendingParams(y.BlendFactor.ONE,y.BlendFactor.ONE,y.BlendFactor.ONE_MINUS_SRC_ALPHA,y.BlendFactor.ONE_MINUS_SRC_ALPHA),
depthTest:{func:y.CompareFunction.LESS},colorWrite:B.defaultColorWriteParams})}}b.shader=new d.ReloadableShaderModule(f.SlicePlaneMaterial,()=>new Promise((g,m)=>a(["./SlicePlaneMaterial.glsl"],g,m)));c.SlicePlaneMaterialPassParameters=A;c.SlicePlaneMaterialTechnique=b;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/SlicePlaneMaterial.glsl":function(){define("exports ../views/3d/webgl-engine/core/shaderLibrary/util/View.glsl ../views/3d/webgl-engine/core/shaderModules/Float4PassUniform ../views/3d/webgl-engine/core/shaderModules/FloatPassUniform ../views/3d/webgl-engine/core/shaderModules/interfaces ../views/3d/webgl-engine/core/shaderModules/ShaderBuilder ../views/3d/webgl-engine/lib/VertexAttribute".split(" "),
function(a,c,l,e,d,k,t){function u(y){const B=new k.ShaderBuilder,{vertex:A,fragment:b,attributes:g,varyings:m}=B;c.addProjViewLocalOrigin(A,y);g.add(t.VertexAttribute.POSITION,"vec3");g.add(t.VertexAttribute.UV0,"vec2");m.add("vUV","vec2");A.code.add(d.glsl`void main(void) {
vUV = uv0;
gl_Position = proj * view * vec4(position, 1.0);
}`);b.uniforms.add(new l.Float4PassUniform("backgroundColor",n=>n.backgroundColor),new l.Float4PassUniform("gridColor",n=>n.gridColor),new e.FloatPassUniform("gridWidth",n=>n.gridWidth));b.code.add(d.glsl`void main() {
const float LINE_WIDTH = 1.0;
vec2 uvScaled = vUV * gridWidth;
vec2 gridUV = (fract(uvScaled + 0.5) - 0.5) / (LINE_WIDTH * fwidth(uvScaled));
vec2 grid = (1.0 - step(0.5, gridUV)) * step(-0.5, gridUV);
grid.x *= step(0.5, uvScaled.x) * step(uvScaled.x, gridWidth - 0.5);
grid.y *= step(0.5, uvScaled.y) * step(uvScaled.y, gridWidth - 0.5);
float gridFade = max(grid.x, grid.y);
float gridAlpha = gridColor.a * gridFade;
fragColor =
vec4(backgroundColor.rgb * backgroundColor.a, backgroundColor.a) * (1.0 - gridAlpha) +
vec4(gridColor.rgb, 1.0) * gridAlpha;
}`);return B}const f=Object.freeze(Object.defineProperty({__proto__:null,build:u},Symbol.toStringTag,{value:"Module"}));a.SlicePlaneMaterial=f;a.build=u})},"esri/views/3d/interactive/editingTools/transformGraphic/ExtentMove":function(){define("exports ../../../../../core/quantityUtils ../../../../../chunks/mat4 ../../../../../chunks/vec3 ../../../../../chunks/vec3f64 ../../../../../geometry/support/vectorStacks ../../../analysis/Slice/ShiftManipulator ../../../analysis/Slice/sliceToolUtils ../dragEventPipeline3D ../ManipulatorType ../manipulations/MoveManipulation ../manipulations/MoveXYGraphicManipulation ../../../../interactive/dragEventPipeline ../../../../interactive/editGeometry/interfaces ../../../../interactive/editGeometry/support/editPlaneUtils ../../../../interactive/tooltip/TranslateTooltipInfos ../../../../support/automaticLengthMeasurementUtils ../../../../support/euclideanLengthMeasurementUtils".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m,n,h,q){class z{constructor(r,D,v,I){this._tool=r;this._graphicState=D;this._editGeometryOperations=v;this._bounds=I;this._moveZTooltipInfo=this._moveXYTooltipInfo=null;r=this._tool;D=r.view;this.moveXYGraphicManipulation=new A.MoveXYGraphicManipulation({view:D,tool:r,graphicState:this._graphicState});r.addHandles(this._createMoveXYGraphicDragPipeline());this.moveZManipulator=new t.ShiftManipulator(D,t.OffsetMode.CENTER_ON_CALLOUT);this.moveZManipulator.state|=
u.IsShiftEdgeOnScreenFlag;r.manipulators.add(this.moveZManipulator);r.addHandles([this._createMoveZDragPipeline()]);r.addHandles([r.on("graphic-translate-stop",()=>{this._moveZTooltipInfo=this._moveXYTooltipInfo=null})])}destroy(){this.moveXYGraphicManipulation.destroy();this._tool.manipulators.remove(this.moveZManipulator);this.moveZManipulator.destroy()}forEachManipulator(r){this.moveXYGraphicManipulation.forEachManipulator(r);r(this.moveZManipulator,y.ManipulatorType.TRANSLATE_Z)}updateManipulators(r,
D){const v=this.moveZManipulator;r=l.rotateZ(k.sm4d.get(),r,Math.PI);r[12]=0;r[13]=0;r[14]=0;v.modelTransform=r;v.renderLocation=e.subtract(k.sv3d.get(),D.origin,D.basis1)}getUpdatedTooltipInfo(){return this.moveXYGraphicManipulation.grabbing||this.moveXYGraphicManipulation.dragging?this._computeMoveXYTooltipInfo():this.moveZManipulator.focused?this._computeMoveZTooltipInfo():null}_computeMoveXYTooltipInfo(){const r=this._tool.tooltipOptions;return this._moveXYTooltipInfo??(this._moveXYTooltipInfo=
new n.TranslateGraphicTooltipInfo({tooltipOptions:r}))}_computeMoveZTooltipInfo(){var r=this._tool,D=r.tooltipOptions;D=this._moveZTooltipInfo??(this._moveZTooltipInfo=new n.TranslateGraphicZTooltipInfo({tooltipOptions:D}));if(this.moveZManipulator.dragging){r=this._bounds;r=q.verticalSignedDistance(r.mapBoundsStart.origin,r.mapBounds.origin,this._tool.view.spatialReference);if(null==r)return null;D.distance=r}else D.distance=c.createLength(0,r.moveUnit);return D}_updateMoveTooltip(r,D){if(D===B.ManipulationType.XY||
D===B.ManipulationType.XY_AXIS)D=h.autoHorizontalDistanceByElevationModeBetweenPoints(r.mapStart,r.mapEnd,this._graphicState.isDraped?"on-the-ground":"absolute-height"),null!=D&&null!=this._moveXYTooltipInfo&&(this._moveXYTooltipInfo.distance=D);return r}_createMoveXYGraphicDragPipeline(){return this.moveXYGraphicManipulation.createDragPipeline((r,D,v)=>this._applyGraphicMoveSteps(D,v,B.ManipulationType.XY))}_createMoveZDragPipeline(){const r=this._editGeometryOperations.data.spatialReference;return b.createManipulatorDragEventPipeline(this.moveZManipulator,
(D,v,I)=>{D=d.clone(D.renderLocation);v=v.next(f.screenToZConstrained(this._tool.view,D,r)).next(b.addScreenDelta());this._applyGraphicMoveSteps(v,I,B.ManipulationType.Z)})}_applyGraphicMoveSteps(r,D,v){const I=this._tool,p=I.graphic;r=r.next(w=>{"start"===w.action&&(I.inputState={type:"move"},this._bounds.backupMapBounds(),I.emit("graphic-translate-start",{graphic:p,dxScreen:w.screenDeltaX,dyScreen:w.screenDeltaY}));return w}).next(b.addMapDelta()).next(this._moveDragUpdateGeometry()).next(w=>{const C=
{graphic:p,dxScreen:w.screenDeltaX,dyScreen:w.screenDeltaY};switch(w.action){case "start":case "update":(w.mapEnd.x-w.mapStart.x||w.mapEnd.y-w.mapStart.y||(w.mapEnd.z??0)-(w.mapStart.z??0))&&I.emit("graphic-translate",C);break;case "end":I.inputState=null,I.emit("graphic-translate-stop",C)}return w}).next(w=>this._updateMoveTooltip(w,v));D.next(()=>{null!=I.inputState&&I.emit("graphic-translate-stop",{graphic:p,dxScreen:0,dyScreen:0});I.cancel()});return r}_moveDragUpdateGeometry(){const r=this._tool;
return D=>{if(null==r.inputState||"move"!==r.inputState.type)return D;var v=[];for(const I of this._editGeometryOperations.data.components)v.push(...I.vertices);v=this._editGeometryOperations.moveVertices(v,D.mapDeltaX,D.mapDeltaY,D.mapDeltaZ,"start"===D.action?g.AccumulationBehaviour.NEW_STEP:g.AccumulationBehaviour.ACCUMULATE_STEPS);m.apply(v,this._bounds.mapBounds);r.graphic.geometry=this._editGeometryOperations.data.geometry;return D}}}a.ExtentMove=z;Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/views/3d/analysis/Slice/ShiftManipulator":function(){define("exports ../../../../Color ../../../../core/colorUtils ../../../../core/reactiveUtils ../../../../chunks/mat4 ../../../../chunks/mat4f64 ../../../../chunks/quat ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../geometry/support/vectorStacks ./sliceToolConfig ./sliceToolUtils ../../interactive/Manipulator3D ../../interactive/RenderObject ../../webgl-engine/lib/basicInterfaces ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/Material ../../webgl-engine/materials/ColorMaterial ../../webgl-engine/materials/RibbonLineMaterial ../../../interactive/interfaces".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m,n,h,q,z,r){function D({offsetMode:w,tubeMaterial:C,tipMaterial:F,capMaterial:G,outlineMaterial:J,calloutMaterial:L}){const x=w===a.OffsetMode.CENTER_ON_CALLOUT?B.shiftRestartOffsetDistance:0,H=[f.fromValues(x,0,-B.shiftRestartArrowLength/2),f.fromValues(x,0,B.shiftRestartArrowLength/2)];w=I(H,!0);C=v({vertices:H,padding:0,materials:{tube:C,tip:F,cap:G}});J=v({vertices:H,padding:B.shiftRestartArrowOutlineWidth,materials:{tube:J,tip:J,cap:J}});F=n.createPolylineGeometry(L,
[[x,0,0],[x-B.shiftRestartOffsetDistance,0,0]]);L=n.createPolylineGeometry(L,[[x,0,0],[x-B.shiftRestartOffsetDistance,0,0]]);return{renderObjects:[...C.normal.map(K=>new g.RenderObject(K,r.ManipulatorStateFlags.Unfocused|A.DidPointerMoveRecentlyFlag)),...J.normal.map(K=>new g.RenderObject(K,r.ManipulatorStateFlags.Unfocused|A.DidPointerMoveRecentlyFlag)),new g.RenderObject(F,r.ManipulatorStateFlags.Unfocused|A.DidPointerMoveRecentlyFlag|A.IsShiftEdgeOnScreenFlag),...C.focused.map(K=>new g.RenderObject(K,
r.ManipulatorStateFlags.Focused|A.DidPointerMoveRecentlyFlag)),...J.focused.map(K=>new g.RenderObject(K,r.ManipulatorStateFlags.Focused|A.DidPointerMoveRecentlyFlag)),new g.RenderObject(L,r.ManipulatorStateFlags.Focused|A.DidPointerMoveRecentlyFlag|A.IsShiftEdgeOnScreenFlag)],autoScaleRenderObjects:!1,collisionType:{type:"line",paths:[w]},collisionPriority:1,radius:B.shiftRestartTipRadius,state:A.DidPointerMoveRecentlyFlag}}function v({vertices:w,padding:C,materials:F}){const G=J=>{const L=w.slice(0);
var x=u.subtract(y.sv3d.get(),L[0],L[1]);u.normalize(x,x);var H=u.subtract(y.sv3d.get(),L[L.length-1],L[L.length-2]);u.normalize(H,H);if(0<C){var K=u.scale(f.create(),H,-C);L[L.length-1]=u.add(K,K,L[L.length-1]);K=u.scale(f.create(),x,-C);L[0]=u.add(K,K,L[0])}K=J?B.shiftRestartTipFocusMultiplier:1;var E=B.shiftRestartTipLength*K;const M=B.shiftRestartTipRadius*K;K=d.identity(y.sm4d.get());if(0<C){var O=E/4,T=u.set(y.sv3d.get(),0,O,0);O=1+C/O;d.translate(K,K,T);d.scale(K,K,u.set(y.sv3d.get(),O,O,O));
d.translate(K,K,u.scale(T,T,-1/O))}O=d.identity(k.create());T=f.fromValues(0,1,0);H=d.fromQuat(k.create(),t.rotationTo(y.sq4d.get(),T,H));H[12]=L[L.length-1][0];H[13]=L[L.length-1][1];H[14]=L[L.length-1][2];d.multiply(H,H,K);J=B.shiftRestartTubeRadius*(J?B.shiftRestartTubeFocusMultiplier:1)+C;var U=F.tube;const ba=[];for(let la=0;12>la;la++){const fa=la/12*2*Math.PI;ba.push([Math.cos(fa)*J,Math.sin(fa)*J])}J=n.createPathExtrusionGeometry(U,ba,L,[],[],!1);J.transformation=O;J=[J];O=n.createConeGeometry(F.tip,
E,M,24,!1,!1,!0);O.transformation=H;J.push(O);E=n.createConeGeometry(F.cap,E,M,24,!1,!0,!1);E.transformation=H;J.push(E);x=d.fromQuat(k.create(),t.rotationTo(y.sq4d.get(),T,x));x[12]=L[0][0];x[13]=L[0][1];x[14]=L[0][2];d.multiply(x,x,K);J.push(O.instantiate({transformation:x}));J.push(E.instantiate({transformation:x}));return J};return{normal:G(!1),focused:G(!0)}}function I(w,C){const F=u.subtract(f.create(),w[w.length-1],w[w.length-2]);u.normalize(F,F);u.scale(F,F,B.shiftRestartTipLength);u.add(F,
F,w[w.length-1]);return C?(C=u.subtract(f.create(),w[0],w[1]),u.normalize(C,C),u.scale(C,C,B.shiftRestartTipLength),u.add(C,C,w[0]),[C,...w,F]):[...w,F]}a.OffsetMode=void 0;(function(w){w[w.CENTER_ON_CALLOUT=0]="CENTER_ON_CALLOUT";w[w.CENTER_ON_ARROW=1]="CENTER_ON_ARROW"})(a.OffsetMode||(a.OffsetMode={}));class p extends b.Manipulator3D{constructor(w,C){const F=new z.RibbonLineMaterial({width:1,renderOccluded:h.RenderOccludedFlag.OccludeAndTransparent,isDecoration:!0}),G=new q.ColorMaterial({cullFace:m.CullFaceOptions.Back,
renderOccluded:h.RenderOccludedFlag.Opaque,isDecoration:!0}),J=new q.ColorMaterial({cullFace:m.CullFaceOptions.Back,renderOccluded:h.RenderOccludedFlag.Opaque,isDecoration:!0}),L=new q.ColorMaterial({cullFace:m.CullFaceOptions.Back,renderOccluded:h.RenderOccludedFlag.Opaque,isDecoration:!0}),x=new q.ColorMaterial({writeDepth:!1,cullFace:m.CullFaceOptions.Front,renderOccluded:h.RenderOccludedFlag.Transparent,isDecoration:!0});super({view:w,...D({offsetMode:C,tubeMaterial:G,tipMaterial:J,capMaterial:L,
outlineMaterial:x,calloutMaterial:F})});this._themeHandle=e.watch(()=>w.effectiveTheme.accentColor,H=>{const K=l.getContrast(H),E=c.toUnitRGBA(H),M=c.toUnitRGBA(K),O=c.toUnitRGBA(c.blendColors(K,H,.4));H=c.toUnitRGBA(c.blendColors(K,H,.14));F.setParameters({color:E});G.setParameters({color:H});J.setParameters({color:M});L.setParameters({color:O});x.setParameters({color:E})},e.initial)}destroy(){this._themeHandle.remove();super.destroy()}}a.ShiftManipulator=p;Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/views/interactive/editGeometry/support/editPlaneUtils":function(){define("exports ../../../../chunks/vec2 ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../chunks/boundedPlane ../../../../geometry/support/vectorStacks ../operations/MoveVertex ../operations/RotateVertex ../operations/ScaleVertex ../operations/UpdateVertices".split(" "),function(a,c,l,e,d,k,t,u,f,y){function B(m,n,h){if(m instanceof y.UpdateVertices){if(m.operation instanceof t.MoveVertex)return A(m.operation,
n,h),!0;if(m.operation instanceof u.RotateVertex)return b(m.operation,n,h),!0;if(m.operation instanceof f.ScaleVertex)return g(m.operation,n,h),!0}return!1}function A(m,n,h=!1){h=h?-1:1;m=e.fromValues(h*m.dx,h*m.dy,h*m.dz);l.add(n.origin,n.origin,m);d.updateUnboundedPlane(n)}function b(m,n,h=!1){m=h?-m.angle:m.angle;l.rotateZ(n.basis1,n.basis1,e.ZEROS,m);l.rotateZ(n.basis2,n.basis2,e.ZEROS,m);d.updateUnboundedPlane(n)}function g(m,n,h=!1){const q=h?1/m.factor1:m.factor1;h=h?1/m.factor2:m.factor2;
l.scale(n.basis1,n.basis1,q);l.scale(n.basis2,n.basis2,h);c.projectAndScale(n.origin,n.origin,m.origin,m.axis1,q);c.projectAndScale(n.origin,n.origin,m.origin,m.axis2,h);d.updateUnboundedPlane(n)}a.apply=function(m,n){return B(m,n,!1)};a.calculateOrientedBounds=function(m,n,h,q){q||(q=d.create());const z=c.set(k.sv2d.get(),m[1],-m[0]),r=c.set(k.sv2d.get(),Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),D=c.set(k.sv2d.get(),Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),v=k.sv2d.get();n.components.forEach(I=>
I.vertices.forEach(p=>{p=p.pos;c.set(v,c.dot(m,p),c.dot(z,p));c.min(r,r,v);c.max(D,D,v)}));n=c.set(k.sv2d.get(),1E-6>D[0]-r[0]?h/2:0,1E-6>D[1]-r[1]?h/2:0);c.subtract(r,r,n);c.add(D,D,n);c.scale(q.basis1,m,(D[0]-r[0])/2);c.scale(q.basis2,z,(D[1]-r[1])/2);c.set(q.origin,r[0]*m[0]+r[1]*z[0],r[0]*m[1]+r[1]*z[1]);c.add(q.origin,q.origin,q.basis1);c.add(q.origin,q.origin,q.basis2);d.updateUnboundedPlane(q);return q};a.unapply=function(m,n){return B(m,n,!0)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/views/3d/interactive/editingTools/transformGraphic/ExtentRotate":function(){define("exports ../../../../../core/mathUtils ../../../../../chunks/mat4 ../../../../../chunks/vec3 ../../../../../chunks/vec3f64 ../../../../../chunks/boundedPlane ../../../../../geometry/support/plane ../../../../../geometry/support/vectorStacks ../../../analysis/images/Factory ../../../analysis/Slice/RotateManipulator ../../../analysis/Slice/sliceToolUtils ../../manipulatorUtils ../dragEventPipeline3D ../ManipulatorType ../../../support/geometryUtils/ray ../../../../interactive/dragEventPipeline ../../../../interactive/editGeometry/interfaces ../../../../interactive/editGeometry/operations/UpdateVertices ../../../../interactive/editGeometry/support/editPlaneUtils ../../../../interactive/tooltip/ExtentTooltipInfos".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m,n,h,q,z,r){class D{constructor(v,I,p){this._tool=v;this._editGeometryOperations=I;this._bounds=p;this._rotateTooltipInfo=null;this._endAngle=this._startAngle=0;v=this._tool;const w=v.view,C=!w._stage?.renderView.renderingContext.driverTest.svgPremultipliesAlpha.result;this.rotateManipulator=new y.RotateManipulator(w,(F,G)=>f.getRotateHeadingTexture(w.textures,{accentColor:F,contrastColor:G,preMultiplyAlpha:C}));v.addHandles([this.rotateManipulator.events.on("grab-changed",
F=>this._onRotateGrab(F)),this._createRotateDragPipeline(this.rotateManipulator)]);v.manipulators.add(this.rotateManipulator);v.addHandles([v.on("graphic-rotate-start",F=>{this._startAngle=F.angle}),v.on("graphic-rotate",F=>{this._endAngle=F.angle}),v.on("graphic-rotate-stop",()=>{this._endAngle=this._startAngle=0})])}destroy(){this._tool.manipulators.remove(this.rotateManipulator);this.rotateManipulator.destroy()}forEachManipulator(v){v(this.rotateManipulator,g.ManipulatorType.ROTATE)}updateManipulators(v,
I){const p=0>this._bounds.mapBounds.plane[2]?Math.PI:0;v=l.rotateX(u.sm4d.get(),v,p);v[12]=0;v[13]=0;v[14]=0;this.rotateManipulator.modelTransform=v;this.rotateManipulator.renderLocation=e.add(u.sv3d.get(),I.origin,I.basis1)}getUpdatedTooltipInfo(){return this.rotateManipulator.focused?this._computeRotateTooltipInfo():null}_computeRotateTooltipInfo(){var v=this._tool.tooltipOptions;v=this._rotateTooltipInfo??(this._rotateTooltipInfo=new r.ExtentRotateTooltipInfo({tooltipOptions:v}));v.angle=this._startAngle-
this._endAngle;return v}_onRotateGrab({action:v,screenPoint:I}){const p=this._tool,w=this._bounds;"start"===v&&I&&(v=B.createRotatePlane(w.displayBounds,p.view.renderCoordsHelper,B.RotationAxis.HEADING,t.create()),I=m.fromScreenNormalized(p.view.state.camera,I),t.intersectRay(v,I,u.sv3d.get())&&(w.backupMapBounds(),p.inputState={type:"rotate",rotatePlane:v}))}_createRotateDragPipeline(v){const I=this._tool,p=I.graphic;return n.createManipulatorDragEventPipeline(v,(w,C,F)=>{w=I.inputState;null!=w&&
(C.next(G=>{"start"===G.action&&I.emit("graphic-rotate-start",{graphic:p,angle:0});return G}).next(b.screenToRenderPlane(I.view,w.rotatePlane)).next(this._rotateDragRenderPlaneToRotate(w)).next(this._rotateDragUpdateGeometry()).next(G=>{const J={graphic:p,angle:c.rad2deg(G.rotateAngle)};switch(G.action){case "start":case "update":I.emit("graphic-rotate",J);break;case "end":I.inputState=null,I.emit("graphic-rotate-stop",J)}return G}),F.next(()=>{null!=I.inputState&&I.emit("graphic-rotate-stop",{graphic:p,
angle:0});I.cancel()}))})}_rotateDragRenderPlaneToRotate(v){return I=>{const p=t.normal(v.rotatePlane),w=A.calculateInputRotationTransform(I.renderStart,I.renderEnd,this._bounds.displayBounds.origin,p);return{...I,rotateAxis:p,rotateAngle:w}}}_rotateDragUpdateGeometry(){const v=this._tool,I=this._bounds;return p=>{var w=e.copy(d.create(),I.mapBoundsStart.origin);const C=[];for(const F of this._editGeometryOperations.data.components)C.push(...F.vertices);w=this._editGeometryOperations.rotateVertices(C,
w,p.rotateAngle,"start"===p.action?h.AccumulationBehaviour.NEW_STEP:h.AccumulationBehaviour.ACCUMULATE_STEPS,q.AccumulationType.REPLACE);k.copy(I.mapBoundsStart,I.mapBounds);z.apply(w,I.mapBounds);v.graphic.geometry=this._editGeometryOperations.data.geometry;return p}}}a.ExtentRotate=D;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/analysis/images/Factory":function(){define(["exports","./generateTextures","./heading-rotate-svg","./tilt-rotate-svg","../../webgl-engine/lib/Texture"],
function(a,c,l,e,d){a.getRotateHeadingTexture=function(k,t){const {accentColor:u,contrastColor:f,preMultiplyAlpha:y}=t;return k.fromData(`heading-rotate:[accent:${u},contrast:${f},size:${64}]`,()=>new d.Texture(c.generateStyledTexture(l,{accentColor:u,contrastColor:f,size:64}),{mipmap:!0,reloadable:!0,preMultiplyAlpha:y}))};a.getTiltRotateTexture=function(k,t){const {accentColor:u,contrastColor:f,preMultiplyAlpha:y}=t;return k.fromData(`tilt-rotate:[accent:${u},contrast:${f},size:${64}]`,()=>new d.Texture(c.generateStyledTexture(e,
{accentColor:u,contrastColor:f,size:64}),{mipmap:!0,reloadable:!0,preMultiplyAlpha:y}))};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/analysis/images/generateTextures":function(){define(["exports"],function(a){function c(l,{accentColor:e,contrastColor:d}){const k=e.toHex();e=e.a;const t=d.toHex();d=d.a;const u=l.getElementsByTagNameNS("http://www.w3.org/2000/svg","style").namedItem("theme-style");u&&(u.innerHTML=`\n      .contrast-fill { fill: ${t}; fill-opacity: ${d}; }\n      .contrast-stroke { stroke: ${t}; stroke-opacity: ${d};  }\n      .accent-fill { fill: ${k}; fill-opacity: ${e}; }\n      .accent-stroke { stroke: ${k}; stroke-opacity:  ${e}; }`);
return l}a.generateStyledTexture=function(l,e){l=l.split(",")[1];l=atob(l);l=(new DOMParser).parseFromString(l,"image/svg+xml");l=c(l,e);l=(new XMLSerializer).serializeToString(l);l=`data:image/svg+xml;base64,${btoa(l)}`;e=e.size;e=new Image(e,e);e.src=l;return e};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/analysis/images/heading-rotate-svg":function(){define(function(){return"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NiIgaGVpZ2h0PSI1NiIgZmlsbD0ibm9uZSIgdmVyc2lvbj0iMi4wIj48c3R5bGUgaWQ9InRoZW1lLXN0eWxlIj4uY29udHJhc3QtZmlsbHtmaWxsOiNmZmZ9LmNvbnRyYXN0LXN0cm9rZXtzdHJva2U6I2ZmZn0uYWNjZW50LWZpbGx7ZmlsbDojZmY3ZjAwO2ZpbGwtb3BhY2l0eTouNX08L3N0eWxlPjxwYXRoIGQ9Ik0yOCAwYTI4IDI4IDAgMSAxIDAgNTYgMjggMjggMCAwIDEgMC01NnoiIGNsYXNzPSJhY2NlbnQtZmlsbCIvPjxwYXRoIHN0cm9rZS13aWR0aD0iNC45OSIgZD0iTTIwLjA1IDQwLjg2YTE1LjA1IDE1LjA1IDAgMCAwIDE3LjE0LTEuNSAxNS4wNSAxNS4wNSAwIDAgMCA0LjQ3LTE2LjY1IDE1LjA1IDE1LjA1IDAgMCAwLTIyLjcyLTcuMTUgMTUuMDUgMTUuMDUgMCAwIDAtNS41IDcuMTUiIGNsYXNzPSJjb250cmFzdC1zdHJva2UiLz48cGF0aCBkPSJtMTAuOTcgMzUuNTcgNS4zOCAxMi4wNyA3Ljc5LTEzLjQ3LTEzLjE3IDEuNHoiIGNsYXNzPSJjb250cmFzdC1maWxsIi8+PC9zdmc+"})},
"esri/views/3d/analysis/images/tilt-rotate-svg":function(){define(function(){return"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NiIgaGVpZ2h0PSI1NiIgZmlsbD0ibm9uZSIgdmVyc2lvbj0iMi4wIj48c3R5bGUgaWQ9InRoZW1lLXN0eWxlIj4uY29udHJhc3QtZmlsbHtmaWxsOiNmZmZ9LmNvbnRyYXN0LXN0cm9rZXtzdHJva2U6I2ZmZn0uYWNjZW50LWZpbGx7ZmlsbDojZmY3ZjAwO2ZpbGwtb3BhY2l0eTouNX08L3N0eWxlPjxjaXJjbGUgY3g9IjM5LjQ3OCIgY3k9IjMuMDc4IiByPSIyOCIgY2xhc3M9ImFjY2VudC1maWxsIiB0cmFuc2Zvcm09InJvdGF0ZSg0MC41NDIpIi8+PHBhdGggc3Ryb2tlLXdpZHRoPSI1IiBkPSJtNy4wNzQgMzAuMDUzIDI5LjM5NyAxMS45ODUtMy42NzMtMzMuNDkzIiBjbGFzcz0iY29udHJhc3Qtc3Ryb2tlIi8+PHBhdGggc3Ryb2tlLXdpZHRoPSIyLjk5NiIgZD0iTTI0LjUwNCAyMy4yMDdhMTEuOTgyIDExLjk4MiAwIDAgMC05LjggNy41MDciIGNsYXNzPSJjb250cmFzdC1zdHJva2UgY29udHJhc3QtZmlsbCIvPjxwYXRoIGQ9Im0yOS44MTggMjIuODA4LTYuMTg0IDQuNi0uNTQxLTguMzY0eiIgY2xhc3M9ImNvbnRyYXN0LWZpbGwiLz48L3N2Zz4\x3d"})},
"esri/views/3d/analysis/Slice/RotateManipulator":function(){define("exports ../../../../Color ../../../../core/colorUtils ../../../../core/reactiveUtils ./sliceToolUtils ../../interactive/Manipulator3D ../../interactive/manipulatorUtils ../../interactive/RenderObject ../../webgl-engine/lib/Attribute ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/Material ../../webgl-engine/lib/VertexAttribute ../../webgl-engine/materials/ImageMaterial ../../webgl-engine/materials/RibbonLineMaterial ../../../interactive/interfaces".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m,n){function h({imageMaterial:z,calloutMaterial:r}){const {focusMultiplier:D,calloutLength:v,discRadius:I}=t.rotateManipulatorDefaults,p=I*D,w=(G,J)=>{const L=[0,1,2,2,3,0];return new y.Geometry(J,[[b.VertexAttribute.POSITION,new f.Attribute([v-G,-G,0,v+G,-G,0,v+G,G,0,v-G,G,0],L,3,!0)],[b.VertexAttribute.UV0,new f.Attribute([0,0,1,0,1,1,0,1],L,2,!0)]])},C=B.createPolylineGeometry(r,[[0,0,0],[v-I,0,0]]);r=B.createPolylineGeometry(r,[[0,0,0],[v-p,0,0]]);const F=
d.DidPointerMoveRecentlyFlag;return{autoScaleRenderObjects:!1,collisionPriority:1,collisionType:{type:"disc",direction:[0,0,1],offset:[v,0,0]},focusMultiplier:D,radius:I,renderObjects:[new u.RenderObject(w(I,z),n.ManipulatorStateFlags.Unfocused|F),new u.RenderObject(C,n.ManipulatorStateFlags.Unfocused|F),new u.RenderObject(w(p,z),n.ManipulatorStateFlags.Focused|F),new u.RenderObject(r,n.ManipulatorStateFlags.Focused|F)],state:F}}class q extends k.Manipulator3D{constructor(z,r){const D=new g.ImageMaterial({transparent:!0,
writeDepth:!1,renderOccluded:A.RenderOccludedFlag.Opaque,isDecoration:!0}),v=new m.RibbonLineMaterial({width:t.rotateManipulatorDefaults.calloutWidth,renderOccluded:A.RenderOccludedFlag.OccludeAndTransparent,isDecoration:!0});super({view:z,...h({imageMaterial:D,calloutMaterial:v})});this._currentTexture=null;this._themeHandle=e.watch(()=>z.effectiveTheme.accentColor,I=>{var p=l.multiplyOpacity(I,.5);const w=l.getContrast(I),C=this._currentTexture;p=r(p,w);D.setParameters({textureId:p.texture.id});
v.setParameters({color:c.toUnitRGBA(I)});this._currentTexture=p;C?.release()},e.initial)}destroy(){this._themeHandle.remove();this._currentTexture?.release();super.destroy()}}a.RotateManipulator=q;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/webgl-engine/materials/ImageMaterial":function(){define("exports ../../../../geometry/support/buffer/BufferView ../core/shaderLibrary/ShaderOutput ../lib/basicInterfaces ../lib/GLTextureMaterial ../lib/Material ../lib/OrderIndependentTransparency ../lib/RenderSlot ../lib/Util ../lib/VertexAttribute ./DefaultBufferWriter ./DefaultLayouts ./TriangleMaterial ./internal/bufferWriterUtils ../shaders/ImageMaterialTechnique".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m){class n extends b.TriangleMaterial{constructor(r){super(r,new z);this.supportsEdges=!0;this._vertexAttributeLocations=m.vertexAttributeLocations;this._configuration=new m.ImageMaterialTechniqueConfiguration}getConfiguration(r,D){this._configuration.output=r;this._configuration.cullFace=this.parameters.cullFace;this._configuration.hasSlicePlane=this.parameters.hasSlicePlane;this._configuration.transparent=this.parameters.transparent;this._configuration.writeDepth=
this.parameters.writeDepth;this._configuration.hasOccludees=this.parameters.hasOccludees;this._configuration.transparencyPassType=D.transparencyPassType;this._configuration.enableOffset=D.camera.relativeElevation<t.OITPolygonOffsetLimit;this._configuration.multipassEnabled=D.multipassEnabled;this._configuration.cullAboveGround=D.multipassTerrain.cullAboveGround;this._configuration.perspectiveInterpolation=this.parameters.perspectiveInterpolation;return this._configuration}produces(r,D){return D===
l.ShaderOutput.Color||D===l.ShaderOutput.Alpha||D===l.ShaderOutput.Highlight?r===u.RenderSlot.DRAPED_MATERIAL?!0:D===l.ShaderOutput.Highlight?r===u.RenderSlot.OPAQUE_MATERIAL:r===(this.parameters.transparent?this.parameters.writeDepth?u.RenderSlot.TRANSPARENT_MATERIAL:u.RenderSlot.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL:u.RenderSlot.OPAQUE_MATERIAL):!1}createGLMaterial(r){return new h(r)}createBufferWriter(){const r=A.PositionUVLayout.clone();this.parameters.perspectiveInterpolation&&r.f32(y.VertexAttribute.PERSPECTIVEDIVIDE);
return new q(r)}}class h extends d.GLTextureMaterial{constructor(r){super({...r,...r.material.parameters})}_updateParameters(r){this.updateTexture(this._material.parameters.textureId);this._material.setParameters(this.textureBindParameters);return this.ensureTechnique(m.ImageMaterialTechnique,r)}_updateOccludeeState(r){r.hasOccludees!==this._material.parameters.hasOccludees&&(this._material.setParameters({hasOccludees:r.hasOccludees}),this._updateParameters(r))}beginSlot(r){this._output!==l.ShaderOutput.Color&&
this._output!==l.ShaderOutput.Alpha||this._updateOccludeeState(r);return this._updateParameters(r)}}class q extends B.DefaultBufferWriter{write(r,D,v,I,p){for(const w of this.vertexBufferLayout.fields.keys()){const C=v.attributes.get(w);if(C)if(w===y.VertexAttribute.PERSPECTIVEDIVIDE){f.assert(1===C.size);const F=I.getField(w,c.BufferViewFloat);F&&g.writeBufferFloat(C,F,p)}else g.writeDefaultAttribute(w,C,r,D,I,p)}}}class z extends k.MaterialParameters{constructor(){super(...arguments);this.transparent=
!1;this.writeDepth=!0;this.hasSlicePlane=!1;this.cullFace=e.CullFaceOptions.None;this.hasOccludees=!1;this.opacity=1;this.textureId=null;this.initTextureTransparent=!0;this.perspectiveInterpolation=!1}}a.ImageMaterial=n;a.Parameters=z;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/webgl-engine/shaders/ImageMaterialTechnique":function(){define("require exports ../../../../chunks/tslib.es6 ../core/shaderLibrary/ShaderOutput ../core/shaderModules/interfaces ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../core/shaderTechnique/ShaderTechniqueConfiguration ../lib/basicInterfaces ../lib/OrderIndependentTransparency ../lib/Program ../lib/StencilUtils ../lib/TransparencyPassType ../lib/VertexAttribute ../materials/DefaultTechniqueConfiguration ../../../../chunks/ImageMaterial.glsl ../../../webgl/enums ../../../webgl/renderState".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m,n,h,q){class z extends d.NoParameters{}class r extends t.ShaderTechnique{initializeProgram(p){return new B.Program(p.rctx,r.shader.get().build(this.configuration),I)}_setPipelineState(p,w){const C=this.configuration,F=p===b.TransparencyPassType.NONE,G=p===b.TransparencyPassType.FrontFace;return q.makePipelineState({blending:C.output!==e.ShaderOutput.Color&&C.output!==e.ShaderOutput.Alpha||!C.transparent?null:F?D:y.oitBlending(p),culling:q.cullingParams(C.cullFace),
depthTest:{func:y.oitDepthTest(p)},depthWrite:F?C.writeDepth?q.defaultDepthWriteParams:null:y.oitDepthWrite(p),colorWrite:q.defaultColorWriteParams,stencilWrite:C.hasOccludees?A.stencilWriteMaskOn:null,stencilTest:C.hasOccludees?w?A.stencilToolMaskBaseParams:A.stencilBaseAllZerosParams:null,polygonOffset:F||G?null:y.getOITPolygonOffset(C.enableOffset)})}initializePipeline(){this._occludeePipelineState=this._setPipelineState(this.configuration.transparencyPassType,!0);return this._setPipelineState(this.configuration.transparencyPassType,
!1)}getPipeline(p){return p?this._occludeePipelineState:super.getPipeline()}}r.shader=new k.ReloadableShaderModule(n.ImageMaterial,()=>new Promise((p,w)=>a(["./ImageMaterial.glsl"],p,w)));const D=q.simpleBlendingParams(h.BlendFactor.ONE,h.BlendFactor.ONE_MINUS_SRC_ALPHA);class v extends m.DefaultTechniqueConfiguration{constructor(){super(...arguments);this.output=e.ShaderOutput.Color;this.cullFace=f.CullFaceOptions.None;this.transparent=this.hasSlicePlane=!1;this.writeDepth=this.enableOffset=!0;this.hasOccludees=
!1;this.transparencyPassType=b.TransparencyPassType.NONE;this.cullAboveGround=this.multipassEnabled=!1;this.perspectiveInterpolation=!0}}l.__decorate([u.parameter({count:e.ShaderOutput.COUNT})],v.prototype,"output",void 0);l.__decorate([u.parameter({count:f.CullFaceOptions.COUNT})],v.prototype,"cullFace",void 0);l.__decorate([u.parameter()],v.prototype,"hasSlicePlane",void 0);l.__decorate([u.parameter()],v.prototype,"transparent",void 0);l.__decorate([u.parameter()],v.prototype,"enableOffset",void 0);
l.__decorate([u.parameter()],v.prototype,"writeDepth",void 0);l.__decorate([u.parameter()],v.prototype,"hasOccludees",void 0);l.__decorate([u.parameter({count:b.TransparencyPassType.COUNT})],v.prototype,"transparencyPassType",void 0);l.__decorate([u.parameter()],v.prototype,"multipassEnabled",void 0);l.__decorate([u.parameter()],v.prototype,"cullAboveGround",void 0);l.__decorate([u.parameter()],v.prototype,"perspectiveInterpolation",void 0);l.__decorate([u.parameter({constValue:!1})],v.prototype,
"occlusionPass",void 0);const I=new Map([[g.VertexAttribute.POSITION,0],[g.VertexAttribute.UV0,2],[g.VertexAttribute.PERSPECTIVEDIVIDE,3]]);c.ImageMaterialPassParameters=z;c.ImageMaterialTechnique=r;c.ImageMaterialTechniqueConfiguration=v;c.vertexAttributeLocations=I;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/ImageMaterial.glsl":function(){define("exports ../views/3d/webgl-engine/core/shaderLibrary/ShaderOutput ../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl ../views/3d/webgl-engine/core/shaderLibrary/Transform.glsl ../views/3d/webgl-engine/core/shaderLibrary/shading/MultipassTerrainTest.glsl ../views/3d/webgl-engine/core/shaderLibrary/util/AlphaCutoff ../views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl ../views/3d/webgl-engine/core/shaderLibrary/util/View.glsl ../views/3d/webgl-engine/core/shaderModules/FloatPassUniform ../views/3d/webgl-engine/core/shaderModules/interfaces ../views/3d/webgl-engine/core/shaderModules/ShaderBuilder ../views/3d/webgl-engine/core/shaderModules/Texture2DPassUniform ../views/3d/webgl-engine/lib/TransparencyPassType ../views/3d/webgl-engine/lib/VertexAttribute".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g){function m(h){const q=new B.ShaderBuilder,{vertex:z,fragment:r}=q;u.addProjViewLocalOrigin(z,h);q.include(e.Transform,h);q.attributes.add(g.VertexAttribute.POSITION,"vec3");q.attributes.add(g.VertexAttribute.UV0,"vec2");h.perspectiveInterpolation&&q.attributes.add(g.VertexAttribute.PERSPECTIVEDIVIDE,"float");q.varyings.add("vpos","vec3");h.multipassEnabled&&q.varyings.add("depth","float");z.code.add(y.glsl`
    void main(void) {
      vpos = position;
      ${h.multipassEnabled?"depth \x3d (view * vec4(vpos, 1.0)).z;":""}
      vTexCoord = uv0;
      gl_Position = transformPosition(proj, view, vpos);

      ${h.perspectiveInterpolation?"gl_Position *\x3d perspectiveDivide;":""}
    }
  `);q.include(l.SliceDraw,h);q.include(d.multipassTerrainTest,h);r.uniforms.add(new A.Texture2DPassUniform("tex",D=>D.texture),new f.FloatPassUniform("opacity",D=>D.opacity));q.varyings.add("vTexCoord","vec2");h.output===c.ShaderOutput.Alpha?r.code.add(y.glsl`
    void main() {
      discardBySlice(vpos);
      ${h.multipassEnabled?"terrainDepthTest(depth);":""}

      float alpha = texture(tex, vTexCoord).a * opacity;
      if (alpha  < ${y.glsl.float(k.defaultMaskAlphaCutoff)}) {
        discard;
      }

      fragColor = vec4(alpha);
    }
    `):(r.include(t.ColorConversion),r.code.add(y.glsl`
    void main() {
      discardBySlice(vpos);
      ${h.multipassEnabled?"terrainDepthTest(depth);":""}
      fragColor = texture(tex, vTexCoord) * opacity;

      if (fragColor.a < ${y.glsl.float(k.defaultMaskAlphaCutoff)}) {
        discard;
      }

      fragColor = highlightSlice(fragColor, vpos);
      ${h.transparencyPassType===b.TransparencyPassType.Color?"fragColor \x3d premultiplyAlpha(fragColor);":""}
    }
    `));return q}const n=Object.freeze(Object.defineProperty({__proto__:null,build:m},Symbol.toStringTag,{value:"Module"}));a.ImageMaterial=n;a.build=m})},"esri/views/interactive/tooltip/ExtentTooltipInfos":function(){define("exports ../../../chunks/tslib.es6 ../../../core/quantityUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/subclass ./SketchTooltipInfo".split(" "),function(a,c,l,e,d,k){a.ExtentRotateTooltipInfo=class extends k.SketchTooltipInfo{constructor(t){super(t);
this.type="extent-rotate";this.angle=0}};c.__decorate([e.property()],a.ExtentRotateTooltipInfo.prototype,"type",void 0);c.__decorate([e.property()],a.ExtentRotateTooltipInfo.prototype,"angle",void 0);a.ExtentRotateTooltipInfo=c.__decorate([d.subclass("esri.views.interactive.tooltip.ExtentRotateTooltipInfo")],a.ExtentRotateTooltipInfo);a.ExtentScaleTooltipInfo=class extends k.SketchTooltipInfo{constructor(t){super(t);this.type="extent-scale";this.yScale=this.xScale=0;this.ySize=this.xSize=l.zeroMeters}};
c.__decorate([e.property()],a.ExtentScaleTooltipInfo.prototype,"type",void 0);c.__decorate([e.property()],a.ExtentScaleTooltipInfo.prototype,"xScale",void 0);c.__decorate([e.property()],a.ExtentScaleTooltipInfo.prototype,"yScale",void 0);c.__decorate([e.property()],a.ExtentScaleTooltipInfo.prototype,"xSize",void 0);c.__decorate([e.property()],a.ExtentScaleTooltipInfo.prototype,"ySize",void 0);a.ExtentScaleTooltipInfo=c.__decorate([d.subclass("esri.views.interactive.tooltip.ExtentScaleTooltipInfo")],
a.ExtentScaleTooltipInfo);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/transformGraphic/ExtentScale":function(){define("exports ../../../../../chunks/vec2 ../../../../../chunks/vec2f64 ../../../../../chunks/vec3 ../../../../../chunks/vec3f64 ../../../../../chunks/boundedPlane ../../../../../geometry/support/plane ../../../../../geometry/support/vectorStacks ../../../analysis/Slice/ResizeManipulator ../../../analysis/Slice/sliceToolUtils ../dragEventPipeline3D ../ManipulatorType ./extentUtils ../../../support/geometryUtils/ray ../../../../interactive/dragEventPipeline ../../../../interactive/editGeometry/interfaces ../../../../interactive/editGeometry/operations/UpdateVertices ../../../../interactive/editGeometry/support/editPlaneUtils ../../../../interactive/tooltip/ExtentTooltipInfos".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b,g,m,n,h,q,z){class r{get zMax(){if(!this._zMaxDirty)return this._zMax;var D=this._editGeometryOperations.data;if(D.geometry.hasZ){const v=D.coordinateHelper;this._zMax=Number.NEGATIVE_INFINITY;for(const I of D.components)for(const p of I.vertices)D=v.getZ(p.pos)??0,this._zMax=Math.max(D,this._zMax)}else this._zMax=0;this._zMaxDirty=!1;return this._zMax}constructor(D,v,I,p,w){this._tool=D;this._graphicState=v;this._editGeometryOperations=I;this._bounds=p;this._preserveAspectRatioStep=
w;this._resizeHandles=[{direction:[1,0]},{direction:[1,1]},{direction:[0,1]},{direction:[-1,1]},{direction:[-1,0]},{direction:[-1,-1]},{direction:[0,-1]},{direction:[1,-1]}];this._scaleTooltipInfo=null;this._displayBoundsStart=k.create();this._displayBoundsMarginStart=0;this._startScale=l.create();this._endScale=l.create();this._sizeStart=null;this._zMax=0;this._zMaxDirty=!0;const C=this._tool,F=C.view;this.resizeManipulators=this._resizeHandles.map(G=>{const J=new f.ResizeManipulator(F,G);C.addHandles([J.events.on("grab-changed",
L=>this._onResizeGrab(L)),this._createResizeDragPipeline(J,G)]);return J});C.manipulators.addMany(this.resizeManipulators);C.addHandles([C.on("graphic-scale-start",G=>{c.set(this._startScale,G.xScale,G.yScale);c.set(this._endScale,G.xScale,G.yScale)}),C.on("graphic-scale",G=>{c.set(this._endScale,G.xScale,G.yScale)}),C.on("graphic-scale-stop",()=>{c.set(this._startScale,0,0);c.set(this._endScale,0,0)}),this._graphicState.on("changed",()=>{"resize"!==C.inputState?.type&&(this._zMaxDirty=!0)})])}destroy(){this.forEachManipulator(D=>
{this._tool.manipulators.remove(D);D.destroy()})}forEachManipulator(D){this.resizeManipulators.forEach(v=>D(v,A.ManipulatorType.SCALE))}updateManipulators(D,v){this.resizeManipulators.forEach((I,p)=>{y.updateResizeHandle(I,this._resizeHandles[p],D,v)})}getUpdatedTooltipInfo(){return this.resizeManipulators.some(D=>D.focused)?this._computeScaleTooltipInfo():null}_computeScaleTooltipInfo(){var D=this._tool,v=D.tooltipOptions;v=this._scaleTooltipInfo??(this._scaleTooltipInfo=new z.ExtentScaleTooltipInfo({tooltipOptions:v}));
D=D.graphic.geometry;if(null==D)return null;D=b.mapPlaneAutoHorizontalSizeByElevationMode(this._bounds.mapBounds,this.zMax,D.spatialReference,this._graphicState.isDraped);if(null==D)return null;v.xSize=D[0];v.ySize=D[1];null!=this._sizeStart&&this.resizeManipulators.some(I=>I.dragging)?(v.xScale=D[0].value/this._sizeStart[0].value,v.yScale=D[1].value/this._sizeStart[1].value):(v.xScale=1,v.yScale=1);return v}_onResizeGrab({action:D,screenPoint:v}){const I=this._tool,p=this._bounds;"start"===D&&v&&
I.graphic.geometry&&(D=g.fromScreenNormalized(I.view.state.camera,v),t.intersectRay(p.displayBounds.plane,D,u.sv3d.get())&&(p.backupMapBounds(),k.copy(p.displayBounds,this._displayBoundsStart),this._displayBoundsMarginStart=p.displayBoundsMargin,this._sizeStart=b.mapPlaneAutoHorizontalSizeByElevationMode(p.mapBoundsStart,this.zMax,I.graphic.geometry.spatialReference,this._graphicState.isDraped),I.inputState={type:"resize"}))}_createResizeDragPipeline(D,v){const I=this._tool,p=I.graphic;return m.createManipulatorDragEventPipeline(D,
(w,C,F)=>{null!=I.inputState&&(C.next(G=>{"start"===G.action&&I.emit("graphic-scale-start",{graphic:p,xScale:1,yScale:1});return G}).next(B.screenToRenderPlane(I.view,this._displayBoundsStart.plane)).next(G=>({...G,handle:v})).next(this._resizeDragRenderPlaneToFactors()).next(...this._preserveAspectRatioStep()).next(this._resizeDragUpdateGeometry()).next(G=>{const J={graphic:p,xScale:G.factor1,yScale:G.factor2};switch(G.action){case "start":case "update":I.emit("graphic-scale",J);break;case "end":I.inputState=
null,I.emit("graphic-scale-stop",J)}return G}),F.next(()=>{null!=I.inputState&&I.emit("graphic-scale-stop",{graphic:p,xScale:1,yScale:1});I.cancel()}))})}_resizeDragRenderPlaneToFactors(){const D=this._bounds;return v=>{const I=this._displayBoundsStart,p=v.handle.direction,w=D.displayBoundsMargin,C=this._displayBoundsMarginStart;var F=e.copy(u.sv3d.get(),I.origin);e.scaleAndAdd(F,F,I.basis1,-p[0]);e.scaleAndAdd(F,F,I.basis2,-p[1]);const G=e.subtract(u.sv3d.get(),v.renderEnd,F),J=e.subtract(u.sv3d.get(),
v.renderStart,F),L=y.isDiagonalResizeHandle(v.handle);F=y.calculateDiagonalResizeHandleScale(I);const x=y.calculateDiagonalResizeHandleScale(D.displayBounds)/F;F=(H,K)=>{if(0===H)return 1;let E=e.length(K),M=.5*H*e.dot(K,G)/E;const O=0>M?-1:1;L&&(H=E-.5*H*e.dot(K,J)/E,M+=H*O*x);H=E<1.5*C?1:1E-6;E=Math.max(E-C,1E-6);0<O&&(M-=w);return O*Math.max(M/E*O,H)};return{...v,factor1:F(p[0],I.basis1),factor2:F(p[1],I.basis2)}}}_resizeDragUpdateGeometry(){const D=this._tool,v=this._bounds;return I=>{var p=e.copy(d.create(),
v.mapBoundsStart.origin);e.scaleAndAdd(p,p,v.mapBoundsStart.basis1,-I.handle.direction[0]);e.scaleAndAdd(p,p,v.mapBoundsStart.basis2,-I.handle.direction[1]);const w=c.set(l.create(),v.mapBoundsStart.basis1[0],v.mapBoundsStart.basis1[1]);c.normalize(w,w);const C=[];for(const F of this._editGeometryOperations.data.components)C.push(...F.vertices);p=this._editGeometryOperations.scaleVertices(C,p,w,I.factor1,I.factor2,"start"===I.action?n.AccumulationBehaviour.NEW_STEP:n.AccumulationBehaviour.ACCUMULATE_STEPS,
h.AccumulationType.REPLACE);k.copy(v.mapBoundsStart,v.mapBounds);q.apply(p,v.mapBounds);D.graphic.geometry=this._editGeometryOperations.data.geometry;return I}}}a.ExtentScale=r;a.scaleEpsilon=1E-6;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/analysis/Slice/ResizeManipulator":function(){define("exports ../../../../Color ../../../../core/reactiveUtils ../../../../chunks/vec3f64 ./sliceToolConfig ./sliceToolUtils ../../interactive/Manipulator3D ../../interactive/manipulatorUtils ../../interactive/RenderObject ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/Material ../../webgl-engine/materials/RibbonLineMaterial ../../../interactive/interfaces".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b){function g({isCorner:n,unfocusedMaterial:h,focusedMaterial:q,outlineMaterial:z}){const r=n?[e.fromValues(1,0,0),e.fromValues(0,0,0),e.fromValues(0,1,0)]:[e.fromValues(1,0,0),e.fromValues(-1,0,0)];return{renderObjects:[new f.RenderObject(y.createPolylineGeometry(h,r),b.ManipulatorStateFlags.Unfocused|k.resizeNormal),new f.RenderObject(y.createPolylineGeometry(q,r),b.ManipulatorStateFlags.Focused|k.resizeNormal),new f.RenderObject(y.createPolylineGeometry(z,r),k.resizeOutlineOnly)],
collisionType:{type:"line",paths:[r]},radius:n?d.resizeHandleCornerInputRadius:d.resizeHandleEdgeInputRadius,state:k.resizeNormal}}class m extends t.Manipulator3D{constructor(n,h){const q=(h=k.isDiagonalResizeHandle(h))?d.resizeHandleCornerWidth:d.resizeHandleEdgeWidth,z=q*d.displayFocusMultiplier,r=d.resizeHandleEdgeWidth,D={renderOccluded:B.RenderOccludedFlag.OccludeAndTransparent,isDecoration:!0},v=new A.RibbonLineMaterial({...D,width:q}),I=new A.RibbonLineMaterial({...D,width:z}),p=new A.RibbonLineMaterial({...D,
width:r});super({view:n,...u.worldScaledManipulatorSettings,...g({isCorner:h,unfocusedMaterial:v,focusedMaterial:I,outlineMaterial:p})});this._themeHandle=l.watch(()=>n.effectiveTheme.accentColor,w=>{w=c.toUnitRGBA(w);v.setParameters({color:w});I.setParameters({color:w});p.setParameters({color:w})},l.initial)}destroy(){this._themeHandle.remove();super.destroy()}}a.ResizeManipulator=m;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/transformGraphic/extentUtils":function(){define("exports ../../../../../core/quantityUtils ../../../../../core/unitUtils ../../../../../chunks/vec2 ../../../../../chunks/vec3 ../../../../../chunks/boundedPlane ../../../../../geometry/support/vectorStacks ../../../../../support/elevationInfoUtils ../geometryUtils ../../../layers/graphics/elevationAlignmentUtils ../../../layers/graphics/ElevationContext ../../../../interactive/editGeometry/support/editPlaneUtils ../../../../support/automaticLengthMeasurementUtils".split(" "),
function(a,c,l,e,d,k,t,u,f,y,B,A,b){function g(n,h,q,z=0,r){r||(r=k.create());h.toRenderCoords(n.origin,q,r.origin);var D=t.sv3d.get();d.add(D,n.origin,n.basis1);d.add(D,D,n.basis2);h.toRenderCoords(D,q,D);var v=t.sv3d.get();d.add(v,n.origin,n.basis1);d.subtract(v,v,n.basis2);h.toRenderCoords(v,q,v);const I=t.sv3d.get();d.subtract(I,n.origin,n.basis1);d.subtract(I,I,n.basis2);h.toRenderCoords(I,q,I);const p=t.sv3d.get();d.subtract(p,n.origin,n.basis1);d.add(p,p,n.basis2);h.toRenderCoords(p,q,p);n=
d.lerp(t.sv3d.get(),D,v,.5);d.subtract(n,n,r.origin);h=d.lerp(t.sv3d.get(),I,p,.5);d.subtract(h,r.origin,h);d.lerp(r.basis1,n,h,.5);D=d.lerp(t.sv3d.get(),p,D,.5);d.subtract(D,D,r.origin);v=d.lerp(t.sv3d.get(),v,I,.5);d.subtract(v,r.origin,v);d.lerp(r.basis2,D,v,.5);v=d.cross(t.sv3d.get(),r.basis1,r.basis2);v=d.cross(v,v,r.basis1);d.normalize(v,v);d.scale(r.basis2,v,d.dot(r.basis2,v));d.scale(r.basis1,r.basis1,1+z/d.length(r.basis1));d.scale(r.basis2,r.basis2,1+z/d.length(r.basis2));k.updateUnboundedPlane(r);
return r}class m{constructor(n,h,q){this._tool=n;this._onDisplayBoundsChanged=h;this.mapBounds=k.create();this.mapBoundsStart=k.create();this.displayBounds=k.create();this._calculateMapBounds(q)}get displayBoundsMargin(){const {view:n,graphic:h}=this._tool,q=n.pointsOfInterest?.centerOnSurfaceFrequent.location??h.geometry?.extent?.center;return q?10*n.pixelSizeAt(q):0}backupMapBounds(){k.copy(this.mapBounds,this.mapBoundsStart)}updateDisplayBounds(){this._calculateDisplayBounds();this._onDisplayBoundsChanged()}_calculateMapBounds(n){const {view:h,
attachmentOrigin:q}=this._tool;var z=n.geometry;const r=f.mainAxis(z);e.scale(r,r,-1);var D=h.spatialReference;z=z.spatialReference;D=q?h.pixelSizeAt(q)*l.getMetersPerCartesianUnitForSR(D)/l.getMetersPerUnitForSR(z):0;A.calculateOrientedBounds(r,n,80*D,this.mapBounds)}_calculateDisplayBounds(){const {view:n,attachmentOrigin:h,graphic:q}=this._tool;if(q.geometry){var z=h?.z??y.evaluateElevationAlignmentAtPoint(this.mapBounds.origin,n.elevationProvider,B.ElevationContext.fromElevationInfo(u.getGraphicEffectiveElevationInfo(q)),
n.renderCoordsHelper),r=k.copy(this.mapBounds);r.origin[2]=z??0;g(r,n.renderCoordsHelper,q.geometry.spatialReference,this.displayBoundsMargin,this.displayBounds)}}}a.TransformBounds=m;a.mapPlaneAutoHorizontalSizeByElevationMode=function(n,h,q,z){const r=t.sv3d.get();d.subtract(r,d.subtract(r,n.origin,n.basis1),n.basis2);const D=t.sv3d.get();d.scaleAndAdd(D,r,n.basis1,2);const v=t.sv3d.get();d.scaleAndAdd(v,D,n.basis2,2);const I=t.sv3d.get();d.scaleAndAdd(I,r,n.basis2,2);r[2]=D[2]=v[2]=I[2]=h;h=z?
"on-the-ground":"absolute-height";n=c.max(b.autoHorizontalDistanceByElevationMode(r,D,q,h),b.autoHorizontalDistanceByElevationMode(I,v,q,h));q=c.max(b.autoHorizontalDistanceByElevationMode(D,v,q,h),b.autoHorizontalDistanceByElevationMode(r,I,q,h));return null==q||null==n?null:[n,q]};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/transformGraphic/PreserveAspectRatio":function(){define(["exports","../../../analysis/Slice/sliceToolUtils","../../../../interactive/dragEventPipeline"],
function(a,c,l){class e{constructor(){this._next=this._lastDragEvent=null;this._enabled=!1}get enabled(){return this._enabled}set enabled(d){if(this._enabled!==d&&null!=this._lastDragEvent&&null!=this._next){const k={...this._lastDragEvent,action:"update"};d&&this._adjustScaleFactors(k);this._next.execute(k)}this._enabled=d}createDragEventPipelineStep(){this._lastDragEvent=null;const d=new l.EventPipeline;this._next=d;return[k=>{this._lastDragEvent="end"!==k.action?{...k}:null;this._enabled&&this._adjustScaleFactors(k);
return k},d]}_adjustScaleFactors(d){const k=c.isDiagonalResizeHandle(d.handle)?Math.max(Math.abs(d.factor1),Math.abs(d.factor2)):0===d.handle.direction[0]?Math.abs(d.factor2):Math.abs(d.factor1);d.factor1=0>d.factor1?-k:k;d.factor2=0>d.factor2?-k:k}get test(){return{_adjustScaleFactors:d=>this._adjustScaleFactors(d)}}}a.PreserveAspectRatio=e;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define("exports ./editingTools/draw/DrawGraphicTool3D ./editingTools/moveGraphic/GraphicMoveTool ./editingTools/reshapeGraphic/GraphicReshapeTool ./editingTools/transformGraphic/GraphicTransformTool ./editingTools/transformGraphic/ExtentTransformTool".split(" "),function(a,c,l,e,d,k){Object.defineProperty(a,"DrawGraphicTool3D",{enumerable:!0,get:()=>c.DrawGraphicTool3D});Object.defineProperty(a,"GraphicMoveTool",{enumerable:!0,get:()=>l.GraphicMoveTool});Object.defineProperty(a,"GraphicReshapeTool",
{enumerable:!0,get:()=>e.GraphicReshapeTool});Object.defineProperty(a,"GraphicTransformTool",{enumerable:!0,get:()=>d.GraphicTransformTool});Object.defineProperty(a,"ExtentTransformTool",{enumerable:!0,get:()=>k.ExtentTransformTool});Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})});