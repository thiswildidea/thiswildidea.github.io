// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.28/esri/copyright.txt for details.
//>>built
define("exports ../../../../geometry ../../../../core/promiseUtils ../../../../geometry/projection/projectPointToVectorWithEngine ../../../../layers/graphics/dehydratedPoint ../../../../support/elevationInfoUtils ./elevationAlignmentUtils ./ElevationContext ./featureExpressionInfoUtils ../../../../geometry/SpatialReference".split(" "),function(l,K,y,z,A,B,m,C,n,p){const e=new C.ElevationContext,b=A.makeDehydratedPoint(0,0,0,p.WGS84),q=new m.SampleElevationInfo,r=[0,0,0];l.elevationAlignPointsInFeatures=
async function(c,t,D,d,f){const {elevationProvider:E,renderCoordsHelper:F}=c,{elevationInfo:u}=t,{pointsInFeatures:G,spatialReference:H}=d;var a=p.fromJSON(H);d=n.extractExpressionInfo(u,!0);d=await n.createContext(d,a,f);y.throwIfAborted(f);const g=[],v=new Set,w=new Set;b.spatialReference=a;c=c.elevationProvider.spatialReference??c.spatialReference;for(const {objectId:h,points:x}of G)if(a=D(h),null==a){for(const k of x)g.push(k.z??0);v.add(h)}else{a.isDraped&&w.add(h);e.setFromElevationInfo(B.getGeometryEffectiveElevationInfo(a.graphic.geometry,
u));e.updateFeatureExpressionInfoContext(d,a.graphic,t);for(const {x:k,y:I,z:J}of x)b.x=k,b.y=I,b.z=J??0,await z.projectPointToVectorWithEngine(b,r,c,0,{signal:f}),m.evaluateElevationInfoAtPoint(r,E,e,F,q),g.push(q.z)}return{elevations:g,drapedObjectIds:w,failedObjectIds:v}};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})});