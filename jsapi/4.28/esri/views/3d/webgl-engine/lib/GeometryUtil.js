// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.28/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/vec3 ../../../../chunks/vec3f32 ../../../../chunks/vec3f64 ../../../../geometry/support/DoubleArray ../../../../geometry/support/FloatArray ../../../../geometry/support/Indices ../../../../geometry/support/plane ../../../../geometry/support/ray ./Attribute ./BufferVectorMath ./ContentObjectType ./Geometry ./Util ./VertexAttribute".split(" "),function(F,l,p,qa,ra,G,aa,ba,sa,y,D,ja,H,X,w){function ka(m,b,a){function c(g,e){g>e&&([g,e]=[e,g]);const h=g.toString()+"."+
e.toString();if(k[h])return k[h];let q=d.length;d.length+=3;Q.add(d,3*g,d,3*e,d,q);Q.scale(d,q,m/Q.length(d,q));q/=3;return k[h]=q}let d;a?(d=[0,-1,0,1,0,0,0,0,1,-1,0,0,0,0,-1,0,1,0],a=[0,1,2,0,2,3,0,3,4,0,4,1,1,5,2,2,5,3,3,5,4,4,5,1]):(a=m*(1+Math.sqrt(5))/2,d=[-m,a,0,m,a,0,-m,-a,0,m,-a,0,0,-m,a,0,m,a,0,-m,-a,0,m,-a,a,0,-m,a,0,m,-a,0,-m,-a,0,m],a=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1]);for(var f=0;f<d.length;f+=
3)Q.scale(d,f,m/Q.length(d,f));let k={};for(f=0;f<b;f++){const g=a.length,e=Array(4*g);for(let h=0;h<g;h+=3){const q=a[h],z=a[h+1],u=a[h+2],n=c(q,z),A=c(z,u),x=c(u,q),v=4*h;e[v]=q;e[v+1]=n;e[v+2]=x;e[v+3]=z;e[v+4]=A;e[v+5]=n;e[v+6]=u;e[v+7]=x;e[v+8]=A;e[v+9]=n;e[v+10]=A;e[v+11]=x}a=e;k={}}b=G.floatArrayFrom(d);for(f=0;f<b.length;f+=3)Q.normalize(b,f);return[[w.VertexAttribute.POSITION,new y.Attribute(G.floatArrayFrom(d),a,3,!0)],[w.VertexAttribute.NORMAL,new y.Attribute(b,a,3,!0)]]}function la(m,
b,a,c,d,f,k=p.fromValues(0,0,0)){var g=b.length;const e=G.newFloatArray(a.length*g*3+(6*c.length||0)),h=G.newFloatArray(a.length*g*3+(c?6:0)),q=[],z=[];let u=0;var n=0;const A=p.create(),x=p.create(),v=p.create(),J=p.create(),C=p.create(),r=p.create(),E=p.create(),t=qa.create(),N=p.create(),K=p.create(),ma=p.create(),ca=p.create(),ta=p.create(),na=ba.create();l.set(N,0,1,0);l.subtract(x,a[1],a[0]);l.normalize(x,x);f?(l.add(t,a[0],k),l.normalize(v,t)):l.set(v,0,0,1);da(x,v,N,N,C,v,.99619469809);l.copy(J,
v);l.copy(ca,C);for(var B=0;B<c.length;B++)l.scale(r,C,c[B][0]),l.scale(t,v,c[B][2]),l.add(r,r,t),l.add(r,r,a[0]),e[u++]=r[0],e[u++]=r[1],e[u++]=r[2];h[n++]=-x[0];h[n++]=-x[1];h[n++]=-x[2];for(B=0;B<d.length;B++)q.push(0<d[B][0]?d[B][0]:-d[B][0]-1+c.length),q.push(0<d[B][1]?d[B][1]:-d[B][1]-1+c.length),q.push(0<d[B][2]?d[B][2]:-d[B][2]-1+c.length),z.push(0),z.push(0),z.push(0);B=c.length;const ua=c.length-1;for(let I=0;I<a.length;I++){let oa=!1;0<I&&(l.copy(A,x),I<a.length-1?(l.subtract(x,a[I+1],
a[I]),l.normalize(x,x)):oa=!0,l.add(K,A,x),l.normalize(K,K),l.add(ma,a[I-1],J),ba.fromPositionAndNormal(a[I],K,na),ba.intersectRay(na,sa.wrap(ma,A),t)?(l.subtract(t,t,a[I]),l.normalize(v,t),l.cross(C,K,v),l.normalize(C,C)):da(K,J,ca,N,C,v,.99619469809),l.copy(J,v),l.copy(ca,C));f&&(l.add(t,a[I],k),l.normalize(ta,t));for(let L=0;L<g;L++)if(l.scale(r,C,b[L][0]),l.scale(t,v,b[L][1]),l.add(r,r,t),l.normalize(E,r),h[n++]=E[0],h[n++]=E[1],h[n++]=E[2],l.add(r,r,a[I]),e[u++]=r[0],e[u++]=r[1],e[u++]=r[2],
!oa){var O=(L+1)%g;q.push(B+L);q.push(B+g+L);q.push(B+O);q.push(B+O);q.push(B+g+L);q.push(B+g+O);for(O=0;6>O;O++)z.push(q[q.length-6+O]-ua)}B+=g}b=a[a.length-1];for(a=0;a<c.length;a++)l.scale(r,C,c[a][0]),l.scale(t,v,c[a][1]),l.add(r,r,t),l.add(r,r,b),e[u++]=r[0],e[u++]=r[1],e[u++]=r[2];c=n/3;h[n++]=x[0];h[n++]=x[1];h[n++]=x[2];g=B-g;for(n=0;n<d.length;n++)q.push(0<=d[n][0]?B+d[n][0]:-d[n][0]-1+g),q.push(0<=d[n][2]?B+d[n][2]:-d[n][2]-1+g),q.push(0<=d[n][1]?B+d[n][1]:-d[n][1]-1+g),z.push(c),z.push(c),
z.push(c);d=[[w.VertexAttribute.POSITION,new y.Attribute(e,q,3,!0)],[w.VertexAttribute.NORMAL,new y.Attribute(h,z,3,!0)]];return new H.Geometry(m,d)}function ea(m,b,a,c,d){if(Math.abs(l.dot(b,m))>d)return!1;l.cross(a,m,b);l.normalize(a,a);l.cross(c,a,m);l.normalize(c,c);return!0}function da(m,b,a,c,d,f,k){return ea(m,b,d,f,k)||ea(m,a,d,f,k)||ea(m,c,d,f,k)}const Q=D.Vec3Compact,fa=[[-.5,-.5,.5],[.5,-.5,.5],[.5,.5,.5],[-.5,.5,.5],[-.5,-.5,-.5],[.5,-.5,-.5],[.5,.5,-.5],[-.5,.5,-.5]],va=[0,0,1,-1,0,0,
1,0,0,0,-1,0,0,1,0,0,0,-1],wa=[0,0,1,0,1,1,0,1],xa=[0,1,2,2,3,0,4,0,3,3,7,4,1,5,6,6,2,1,1,0,4,4,5,1,3,2,6,6,7,3,5,4,7,7,6,5],pa=Array(36);for(D=0;6>D;D++)for(var M=0;6>M;M++)pa[6*D+M]=D;const P=Array(36);for(D=0;6>D;D++)P[6*D]=0,P[6*D+1]=1,P[6*D+2]=2,P[6*D+3]=2,P[6*D+4]=3,P[6*D+5]=0;const ha=[[-.5,0,-.5],[.5,0,-.5],[.5,0,.5],[-.5,0,.5],[0,-.5,0],[0,.5,0]],ya=[0,1,-1,1,1,0,0,1,1,-1,1,0,0,-1,-1,1,-1,0,0,-1,1,-1,-1,0],za=[5,1,0,5,2,1,5,3,2,5,0,3,4,0,1,4,1,2,4,2,3,4,3,0],Aa=[0,0,0,1,1,1,2,2,2,3,3,3,4,
4,4,5,5,5,6,6,6,7,7,7];D=p.fromValues(-.5,0,-.5);M=p.fromValues(.5,0,-.5);const Y=p.fromValues(0,0,.5),Z=p.fromValues(0,.5,0),R=p.create(),S=p.create(),T=p.create(),U=p.create(),V=p.create();l.subtract(R,D,Z);l.subtract(S,D,M);l.cross(T,R,S);l.normalize(T,T);l.subtract(R,M,Z);l.subtract(S,M,Y);l.cross(U,R,S);l.normalize(U,U);l.subtract(R,Y,Z);l.subtract(S,Y,D);l.cross(V,R,S);l.normalize(V,V);const ia=[D,M,Y,Z],Ba=[0,-1,0,T[0],T[1],T[2],U[0],U[1],U[2],V[0],V[1],V[2]],Ca=[0,1,2,3,1,0,3,2,1,3,0,2],Da=
[0,0,0,1,1,1,2,2,2,3,3,3],Ea=[[-1,-1,0],[1,-1,0],[1,1,0],[-1,1,0]],W=p.create();F.cgToGIS=function(m,b=m){var a=m.attributes;m=a.get(w.VertexAttribute.POSITION).data;if(a=a.get(w.VertexAttribute.NORMAL).data){var c=b.getMutableAttribute(w.VertexAttribute.NORMAL).data;for(let d=0;d<a.length;d+=3){const f=a[d+1];c[d+1]=-a[d+2];c[d+2]=f}}if(m)for(b=b.getMutableAttribute(w.VertexAttribute.POSITION).data,a=0;a<m.length;a+=3)c=m[a+1],b[a+1]=-m[a+2],b[a+2]=c};F.createBoxGeometry=function(m,b){Array.isArray(b)||
(b=[b,b,b]);const a=Array(24);for(let c=0;8>c;c++)a[3*c]=fa[c][0]*b[0],a[3*c+1]=fa[c][1]*b[1],a[3*c+2]=fa[c][2]*b[2];return new H.Geometry(m,[[w.VertexAttribute.POSITION,new y.Attribute(a,xa,3,!0)],[w.VertexAttribute.NORMAL,new y.Attribute(va,pa,3)],[w.VertexAttribute.UV0,new y.Attribute(wa,P,2)]])};F.createConeGeometry=function(m,b,a,c,d,f=!0,k=!0){let g=0;var e=p.fromValues(0,g,0),h=p.fromValues(0,g+b,0),q=p.fromValues(0,-1,0),z=p.fromValues(0,1,0);d&&(g=b,h=p.fromValues(0,0,0),e=p.fromValues(0,
g,0),q=p.fromValues(0,1,0),z=p.fromValues(0,-1,0));e=[h,e];q=[q,z];z=c+2;h=Math.sqrt(b*b+a*a);if(d)for(d=c-1;0<=d;d--){var u=2*Math.PI/c*d,n=p.fromValues(Math.cos(u)*a,g,Math.sin(u)*a);e.push(n);u=p.fromValues(b*Math.cos(u)/h,-a/h,b*Math.sin(u)/h);q.push(u)}else for(d=0;d<c;d++)u=2*Math.PI/c*d,n=p.fromValues(Math.cos(u)*a,g,Math.sin(u)*a),e.push(n),u=p.fromValues(b*Math.cos(u)/h,a/h,b*Math.sin(u)/h),q.push(u);b=[];a=[];if(f){for(f=3;f<e.length;f++)b.push(1),b.push(f-1),b.push(f),a.push(0),a.push(0),
a.push(0);b.push(e.length-1);b.push(2);b.push(1);a.push(0);a.push(0);a.push(0)}if(k){for(k=3;k<e.length;k++)b.push(k),b.push(k-1),b.push(0),a.push(k),a.push(k-1),a.push(1);b.push(0);b.push(2);b.push(e.length-1);a.push(1);a.push(2);a.push(q.length-1)}k=G.newFloatArray(3*z);for(f=0;f<z;f++)k[3*f]=e[f][0],k[3*f+1]=e[f][1],k[3*f+2]=e[f][2];e=G.newFloatArray(3*z);for(f=0;f<z;f++)e[3*f]=q[f][0],e[3*f+1]=q[f][1],e[3*f+2]=q[f][2];e=[[w.VertexAttribute.POSITION,new y.Attribute(k,b,3,!0)],[w.VertexAttribute.NORMAL,
new y.Attribute(e,a,3,!0)]];return new H.Geometry(m,e)};F.createCylinderGeometry=function(m,b,a,c,d,f,k){d=d?p.clone(d):p.fromValues(1,0,0);f=f?p.clone(f):p.fromValues(0,0,0);k??(k=!0);var g=p.create();l.normalize(g,d);var e=p.create();l.scale(e,g,Math.abs(b));var h=p.create();l.scale(h,e,-.5);l.add(h,h,f);const q=p.fromValues(0,1,0);.2>Math.abs(1-l.dot(g,q))&&l.set(q,0,0,1);const z=p.create();l.cross(z,g,q);l.normalize(z,z);l.cross(q,z,g);b=2*c+(k?2:0);f=c+(k?2:0);d=G.newFloatArray(3*b);const u=
G.newFloatArray(3*f),n=G.newFloatArray(2*b),A=Array(3*c*(k?4:2)),x=Array(3*c*(k?4:2));k&&(d[3*(b-2)]=h[0],d[3*(b-2)+1]=h[1],d[3*(b-2)+2]=h[2],n[2*(b-2)]=0,n[2*(b-2)+1]=0,d[3*(b-1)]=d[3*(b-2)]+e[0],d[3*(b-1)+1]=d[3*(b-2)+1]+e[1],d[3*(b-1)+2]=d[3*(b-2)+2]+e[2],n[2*(b-1)]=1,n[2*(b-1)+1]=1,u[3*(f-2)]=-g[0],u[3*(f-2)+1]=-g[1],u[3*(f-2)+2]=-g[2],u[3*(f-1)]=g[0],u[3*(f-1)+1]=g[1],u[3*(f-1)+2]=g[2]);g=0;const v=p.create(),J=p.create();for(let t=0;t<c;t++){var C=2*Math.PI/c*t;l.scale(v,q,Math.sin(C));l.scale(J,
z,Math.cos(C));l.add(v,v,J);u[3*t]=v[0];u[3*t+1]=v[1];u[3*t+2]=v[2];l.scale(v,v,a);l.add(v,v,h);d[3*t]=v[0];d[3*t+1]=v[1];d[3*t+2]=v[2];n[2*t]=t/c;n[2*t+1]=0;d[3*(t+c)]=d[3*t]+e[0];d[3*(t+c)+1]=d[3*t+1]+e[1];d[3*(t+c)+2]=d[3*t+2]+e[2];n[2*(t+c)]=t/c;n[2*t+1]=1;C=(t+1)%c;var r=g++,E=t;A[r]=t;x[r]=E;r=g++;E=t;A[r]=t+c;x[r]=E;r=g++;E=C;A[r]=C;x[r]=E;r=g++;E=C;A[r]=C;x[r]=E;r=g++;E=t;A[r]=t+c;x[r]=E;r=g++;E=C;A[r]=C+c;x[r]=E}if(k){for(a=0;a<c;a++)k=(a+1)%c,e=g++,h=f-2,A[e]=b-2,x[e]=h,e=g++,h=f-2,A[e]=
a,x[e]=h,e=g++,h=f-2,A[e]=k,x[e]=h;for(a=0;a<c;a++)k=(a+1)%c,e=g++,h=f-1,A[e]=a+c,x[e]=h,e=g++,h=f-1,A[e]=b-1,x[e]=h,e=g++,h=f-1,A[e]=k+c,x[e]=h}c=[[w.VertexAttribute.POSITION,new y.Attribute(d,A,3,!0)],[w.VertexAttribute.NORMAL,new y.Attribute(u,x,3,!0)],[w.VertexAttribute.UV0,new y.Attribute(n,A,2,!0)]];return new H.Geometry(m,c)};F.createDiamondGeometry=function(m,b){Array.isArray(b)||(b=[b,b,b]);const a=Array(18);for(let c=0;6>c;c++)a[3*c]=ha[c][0]*b[0],a[3*c+1]=ha[c][1]*b[1],a[3*c+2]=ha[c][2]*
b[2];return new H.Geometry(m,[[w.VertexAttribute.POSITION,new y.Attribute(a,za,3,!0)],[w.VertexAttribute.NORMAL,new y.Attribute(ya,Aa,3)]])};F.createExtrudedTriangle=function(m,b,a,c,d,f=0){const k=Array(18);b=[[-a,f,d/2],[c,f,d/2],[0,b+f,d/2],[-a,f,-d/2],[c,f,-d/2],[0,b+f,-d/2]];for(a=0;6>a;a++)k[3*a]=b[a][0],k[3*a+1]=b[a][1],k[3*a+2]=b[a][2];return new H.Geometry(m,[[w.VertexAttribute.POSITION,new y.Attribute(k,[0,1,2,3,0,2,2,5,3,1,4,5,5,2,1,1,0,3,3,4,1,4,3,5],3,!0)]])};F.createPathExtrusionGeometry=
la;F.createPointGeometry=function(m,b,a,c,d,f,k,g,e=null){a=a?[a[0],a[1],a[2]]:[0,0,0];b=b?[b[0],b[1],b[2]]:[0,0,1];k=k||[0,0];c=c?[255*c[0],255*c[1],255*c[2],3<c.length?255*c[3]:255]:[255,255,255,255];const h=null!=d&&2===d.length?d:[1,1];d=aa.getZeroIndexArray(1);k=[[w.VertexAttribute.POSITION,new y.Attribute(a,d,3,!0)],[w.VertexAttribute.NORMAL,new y.Attribute(b,d,3,!0)],[w.VertexAttribute.UV0,new y.Attribute(k,d,k.length)],[w.VertexAttribute.COLOR,new y.Attribute(c,d,4,!0)],[w.VertexAttribute.SIZE,
new y.Attribute(h,d,2)]];null!=f&&k.push([w.VertexAttribute.AUXPOS1,new y.Attribute([f[0],f[1],f[2],f[3]],d,4)]);null!=g&&k.push([w.VertexAttribute.FEATUREATTRIBUTE,new y.Attribute([g[0],g[1],g[2],g[3]],d,4)]);return new H.Geometry(m,k,null,ja.ContentObjectType.Point,e)};F.createPolySphereData=ka;F.createPolySphereGeometry=function(m,b,a,c){b=ka(b,a,c);return new H.Geometry(m,b)};F.createPolylineGeometry=function(m,b,a,c){X.assert(1<b.length,"createPolylineGeometry(): polyline needs at least 2 points");
X.assert(3===b[0].length,"createPolylineGeometry(): malformed vertex");X.assert(null==a||a.length===b.length,"createPolylineGeometry: need same number of points and normals");X.assert(null==a||3===a[0].length,"createPolylineGeometry(): malformed normal");var d=ra.newDoubleArray(3*b.length);const f=Array(2*(b.length-1));var k=0,g=0;for(var e=0;e<b.length;e++){for(var h=0;3>h;h++)d[k++]=b[e][h];0<e&&(f[g++]=e-1,f[g++]=e)}d=[[w.VertexAttribute.POSITION,new y.Attribute(d,f,3,!0)]];if(a){k=G.newFloatArray(3*
a.length);g=0;for(e=0;e<b.length;e++)for(h=0;3>h;h++)k[g++]=a[e][h];d.push([w.VertexAttribute.NORMAL,new y.Attribute(k,f,3,!0)])}c&&d.push([w.VertexAttribute.COLOR,new y.Attribute(c,aa.getContinuousIndexArray(c.length/4),4)]);return new H.Geometry(m,d,null,ja.ContentObjectType.Line)};F.createSphereGeometry=function(m,b,a,c,d={uv:!0}){var f=-Math.PI,k=2*Math.PI,g=-Math.PI/2,e=Math.PI;a=Math.max(3,Math.floor(a));c=Math.max(2,Math.floor(c));var h=(a+1)*(c+1);const q=G.newFloatArray(3*h),z=G.newFloatArray(3*
h);h=G.newFloatArray(2*h);const u=[];var n=0;for(var A=0;A<=c;A++){const v=[],J=A/c,C=g+J*e,r=Math.cos(C);for(let E=0;E<=a;E++){const t=E/a;var x=f+t*k;const N=Math.cos(x)*r,K=Math.sin(C);x=-Math.sin(x)*r;q[3*n]=N*b;q[3*n+1]=K*b;q[3*n+2]=x*b;z[3*n]=N;z[3*n+1]=K;z[3*n+2]=x;h[2*n]=t;h[2*n+1]=J;v.push(n);++n}u.push(v)}b=[];for(f=0;f<c;f++)for(k=0;k<a;k++)g=u[f][k],e=u[f][k+1],n=u[f+1][k+1],A=u[f+1][k],0===f?(b.push(g),b.push(n),b.push(A)):f===c-1?(b.push(g),b.push(e),b.push(n)):(b.push(g),b.push(e),
b.push(n),b.push(n),b.push(A),b.push(g));a=[[w.VertexAttribute.POSITION,new y.Attribute(q,b,3,!0)],[w.VertexAttribute.NORMAL,new y.Attribute(z,b,3,!0)]];d.uv&&a.push([w.VertexAttribute.UV0,new y.Attribute(h,b,2,!0)]);d.offset&&(a[0][0]=w.VertexAttribute.OFFSET,a.push([w.VertexAttribute.POSITION,new y.Attribute(Float64Array.from(d.offset),aa.getZeroIndexArray(b.length),3,!0)]));return new H.Geometry(m,a)};F.createSquareGeometry=function(m,b=Ea){var a=Array(12);for(var c=0;4>c;c++)for(let d=0;3>d;d++)a[3*
c+d]=b[c][d];b=[0,1,2,2,3,0];c=[0,0,0,0,0,0];a=[[w.VertexAttribute.POSITION,new y.Attribute(a,b,3,!0)],[w.VertexAttribute.NORMAL,new y.Attribute([0,0,1],c,3,!0)],[w.VertexAttribute.UV0,new y.Attribute([0,0,1,0,1,1,0,1],b,2,!0)],[w.VertexAttribute.COLOR,new y.Attribute([255,255,255,255],c,4,!0)]];return new H.Geometry(m,a)};F.createTetrahedronGeometry=function(m,b){Array.isArray(b)||(b=[b,b,b]);const a=Array(12);for(let c=0;4>c;c++)a[3*c]=ia[c][0]*b[0],a[3*c+1]=ia[c][1]*b[1],a[3*c+2]=ia[c][2]*b[2];
return new H.Geometry(m,[[w.VertexAttribute.POSITION,new y.Attribute(a,Ca,3,!0)],[w.VertexAttribute.NORMAL,new y.Attribute(Ba,Da,3)]])};F.createTubeGeometry=function(m,b,a,c,d,f){c=c||10;d=null!=d?d:!0;X.assert(1<b.length);const k=[],g=[];for(let e=0;e<c;e++){k.push([0,-e-1,-((e+1)%c)-1]);const h=e/c*2*Math.PI;g.push([Math.cos(h)*a,Math.sin(h)*a])}return la(m,g,b,[[0,0,0]],k,d,f)};F.makeOrthoBasisDirUpFallback=da;F.transformInPlace=function(m,b){m=m.getMutableAttribute(w.VertexAttribute.POSITION).data;
for(let a=0;a<m.length;a+=3)l.set(W,m[a],m[a+1],m[a+2]),l.transformMat4(W,W,b),m[a]=W[0],m[a+1]=W[1],m[a+2]=W[2]};Object.defineProperty(F,Symbol.toStringTag,{value:"Module"})});