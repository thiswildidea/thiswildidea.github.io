// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.28/esri/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Search/css":function(){define(["exports","../support/legacyIcon"],function(a,c){a.css={base:"esri-search",widgetIcon:c.legacyIcon.search,hasMultipleSources:"esri-search--multiple-sources",isLoading:"esri-search--loading",isSearching:"esri-search--searching",showSuggestions:"esri-search--show-suggestions",showSources:"esri-search--sources",showWarning:"esri-search--warning",container:"esri-search__container",input:"esri-search__input",inputContainer:"esri-search__input-container",
form:"esri-search__form",submitButton:"esri-search__submit-button",sourcesButton:"esri-search__sources-button",sourcesButtonDown:"esri-search__sources-button--down",sourcesButtonUp:"esri-search__sources-button--up",clearButton:"esri-search__clear-button",sourceName:"esri-search__source-name",suggestionsMenu:"esri-search__suggestions-menu",suggestionList:"esri-search__suggestions-list",suggestionListCurrentLocation:"esri-search__suggestions-list--current-location",sourcesMenu:"esri-search__sources-menu",
source:"esri-search__source",warningMenu:"esri-search__warning-menu",warningMenuBody:"esri-search__warning-body",warningMenuHeader:"esri-search__warning-header",warningMenuText:"esri-search__warning-text",noValueText:"esri-search__no-value-text"};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Search/SearchResultRenderer":function(){define("../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../Widget ./searchResultRendererCSS ./SearchViewModel ../support/globalCss ../support/decorators/accessibleHandler ../support/decorators/messageBundle ../support/jsxFactory ../support/widgetUtils".split(" "),
function(a,c,k,h,D,q,l,y,g,w,H,K,p,P){k=class extends l{constructor(t,I){super(t,I);this.messages=null;this.showMoreResultsOpen=!1;this.viewModel=null}destroy(){this.viewModel=null}render(){const t={[y.css.showMoreResults]:this.showMoreResultsOpen};return p.tsx("div",{class:this.classes(y.css.base,w.globalCss.widget)},p.tsx("div",{class:this.classes(y.css.moreResults,t),key:"esri-search-renderer__container"},this._renderSearchResultName(),this._renderMoreResults()))}_renderMoreResults(){return p.tsx("div",
{key:"esri-search-renderer__more-results"},this._renderMoreResultsButton(),this._renderMoreResultsLists())}_renderSearchResultName(){return p.tsx("div",{class:y.css.moreResultsItem,key:"esri-search-renderer__result-name"},this.viewModel?.selectedResult?.name||"")}_renderMoreResultsLists(){var {viewModel:t}=this;if(!t)return[];if(2>(t.resultCount??0))return null;t=t.results?.map(I=>this._renderMoreResultsList(I));return p.tsx("div",{class:y.css.moreResultsList,key:"esri-search-renderer__more-results-container"},
t)}_renderMoreResultsButton(){const {messages:t,viewModel:I}=this;return!I||2>(I.resultCount??0)?null:p.tsx("div",{class:y.css.moreResultsItem,key:"esri-search-renderer__more-results-button"},p.tsx("a",{bind:this,class:w.globalCss.anchor,href:"#",onclick:this._showMoreResultsClick,onkeydown:this._showMoreResultsClick},this.showMoreResultsOpen?t.hideMoreResults:t.showMoreResults))}_renderMoreResultsHeader(t,I){return p.tsx("div",{class:y.css.moreResultsListHeader,key:`esri-search-result-renderer__header-${I}`},
t)}_renderMoreResultsList(t){var {results:I}=t,n=I?.length??0;const J=0<n;var A=this.viewModel?.selectedResult;n=1===n&&I[0]===A;A=this._getSourceName(t.source,t.sourceIndex);A=1<(this.viewModel?.results?.length??0)&&!n?this._renderMoreResultsHeader(A,t.sourceIndex):null;I=J&&I.map((S,G)=>this._renderMoreResultsListItem(S,G));I=J&&!n?p.tsx("ul",{key:`esri-search-result-renderer__list-${t.sourceIndex}`},I):null;return J?p.tsx("div",{key:`esri-search-result-renderer__results-${t.sourceIndex}`},A,I):
null}_renderMoreResultsListItem(t,I){return t!==this.viewModel?.selectedResult?p.tsx("li",{key:`esri-search-result-renderer__list-item-${I}`},p.tsx("a",{bind:this,class:w.globalCss.anchor,"data-result":t,href:"#",onclick:this._selectResultClick,onkeydown:this._selectResultClick,tabIndex:0},t.name)):null}_showMoreResultsClick(t){t.preventDefault();this.showMoreResultsOpen=!this.showMoreResultsOpen;(t=this.viewModel?.view?.popup)&&"reposition"in t&&t.reposition()}_selectResultClick(t){t.preventDefault();
t=t.currentTarget["data-result"];this.viewModel?.select(t)}_getSourceName(t,I){return I===g.ALL_INDEX?this.messages.all:t.name}};a.__decorate([c.property(),K.messageBundle("esri/widgets/Search/t9n/Search")],k.prototype,"messages",void 0);a.__decorate([c.property()],k.prototype,"showMoreResultsOpen",void 0);a.__decorate([c.property()],k.prototype,"viewModel",void 0);a.__decorate([H.accessibleHandler()],k.prototype,"_showMoreResultsClick",null);a.__decorate([H.accessibleHandler()],k.prototype,"_selectResultClick",
null);return k=a.__decorate([q.subclass("esri.widgets.Search.SearchResultRenderer")],k)})},"esri/widgets/Search/searchResultRendererCSS":function(){define(["exports"],function(a){a.css={base:"esri-search-result-renderer",showMoreResults:"esri-search-result-renderer__more-results--show-more-results",moreResults:"esri-search-result-renderer__more-results",moreResultsList:"esri-search-result-renderer__more-results-list",moreResultsHeader:"esri-search-result-renderer__more-results-header",moreResultsItem:"esri-search-result-renderer__more-results-item",
moreResultsListHeader:"esri-search-result-renderer__more-results-list-header"};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Search/SearchViewModel":function(){define("../../chunks/tslib.es6 ../../assets ../../config ../../Graphic ../../PopupTemplate ../../symbols ../../core/Accessor ../../core/arrayUtils ../../core/Collection ../../core/Error ../../core/Evented ../../core/Logger ../../core/promiseUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/has ../../core/accessorSupport/decorators/subclass ../../geometry/Point ../../geometry/SpatialReference ../../intl/locale ../../intl/messages ../../portal/Portal ../../views/support/layerViewUtils ./LayerSearchSource ./LocatorSearchSource ./SearchSource ./support/geometryUtils ./support/locatorUtils ../support/geolocationUtils ../support/GoTo ../../symbols/PictureMarkerSymbol ../../symbols/SimpleLineSymbol ../../symbols/SimpleFillSymbol ../../symbols/TextSymbol".split(" "),
function(a,c,k,h,D,q,l,y,g,w,H,K,p,P,t,I,n,J,A,S,G,X,Y,ba,d,f,v,F,Q,u,z,B,M,O,T){function E(b,e){return b.hasOwnProperty(e)&&null!=b[e]&&""!==b[e]}const U=K.getLogger("esri.widgets.Search.SearchViewModel"),R=g.ofType({key:b=>b.layer?"layer":"locator",base:v,typeMap:{layer:d,locator:f}}),V=S.WGS84,L=/<[\s\S]*?>/g;q=class extends z.GoToMixin(H.EventedMixin(l)){constructor(b){super(b);this._updatingPromise=this._searching=this._gotoController=null;this._createdFeatureLayers=[];this.autoSelect=this.autoNavigate=
!0;this.defaultPopupTemplate=null;this.defaultSources=new R;this.defaultSymbols={point:new B({url:c.getAssetUrl("esri/images/search/search-symbol-32.png"),size:24,width:24,height:24}),polyline:new M({color:[130,130,130,1],width:2}),polygon:new O({color:[235,235,235,.4],outline:{color:[130,130,130,1],width:2}})};this.includeDefaultSources=!0;this.maxInputLength=128;this.maxSuggestions=this.maxResults=6;this.messages=null;this.minSuggestCharacters=3;this.popupEnabled=!0;this.popupTemplate=null;this.portal=
Y.getDefault();this.resultCount=null;this.resultGraphicEnabled=!0;this.selectedSuggestion=this.results=this.resultGraphic=null;this.searchAllEnabled=!0;this.selectedResult=null;this.sources=new R;this.suggestionDelay=350;this.suggestions=this.suggestionCount=null;this.suggestionsEnabled=!0;this.view=null}initialize(){const b=async()=>{const e=await X.fetchMessageBundle("esri/widgets/Search/t9n/Search");this.messages=e;this.defaultPopupTemplate=new D({title:e.searchResult,content:"{Match_addr}"})};
b();this.addHandles([P.watch(()=>[this.includeDefaultSources,this.view,this.portal],()=>this._update(),P.initial),G.onLocaleChange(b)])}destroy(){this._destroyFeatureLayers();this._abortGoTo();this.clearGraphics()}get activeSource(){return this.allSources.at(this.activeSourceIndex)??null}get activeSourceIndex(){return 1!==this.allSources.length&&this.searchAllEnabled?-1:0}set activeSourceIndex(b){this._overrideIfSome("activeSourceIndex",b)}get allPlaceholder(){return this.messages?.allPlaceholder}set allPlaceholder(b){this._overrideIfSome("allPlaceholder",
b)}get allSources(){const {sources:b,defaultSources:e,includeDefaultSources:m}=this,r="function"===typeof m?m.call(null,{sources:b,defaultSources:e}):m?e.concat(b):b,C=this._get("allSources")||new R;C.removeAll();C.addMany(r.filter(Boolean));return C}get locationEnabled(){return this._get("locationEnabled")||u.supported()}set locationEnabled(b){if(void 0===b)this._clearOverride("locationEnabled");else{var e=u.supported();if(b&&!e){const m=new w("locationEnabled:geolocation-unsupported","Geolocation API is unsupported.",
{geolocation:navigator.geolocation});U.error(m)}this._override("locationEnabled",!!b&&e)}}get placeholder(){const {allSources:b,activeSourceIndex:e,allPlaceholder:m}=this;return-1===e?m??"":b.at(e)?.placeholder??""}set searchTerm(b){this._set("searchTerm",b||"");this.clearGraphics();this.selectedSuggestion&&this.selectedSuggestion.text!==b&&this._set("selectedSuggestion",null);""===b&&this._clear()}get searchTerm(){return this._get("searchTerm")||""}get state(){return this._searching?"searching":
this.updating?"loading":0===this.allSources.length?"disabled":"ready"}get updating(){return null!=this._updatingPromise}clear(){this.searchTerm=""}clearGraphics(){this._removeHighlight();this._closePopup();const {view:b,resultGraphic:e}=this;b&&e&&b.graphics.remove(e);this._set("resultGraphic",null)}search(b,e){this.emit("search-start");this.clearGraphics();const m=this._createSuggestionForSearch(b);return this._searching=b=(async()=>{try{await this.when();const r=await this._getResultsFromSources(m,
e);if(e?.signal?.aborted)return null;const C={activeSourceIndex:this.activeSourceIndex,searchTerm:m.text??"",numResults:0,numErrors:0,errors:[],results:[]};this._formatResponse(C,r,m);const x=this._getFirstResult(C.results),N=(m.location&&x?x.name:m.text)?.replace(L,"");this._set("searchTerm",N);(m.key&&"number"===typeof m.sourceIndex||m.location)&&this._set("selectedSuggestion",m);this._set("results",C.results);this._set("resultCount",C.results.reduce((Z,ca)=>Z+(ca.results?.length??0),0));this.emit("search-complete",
C);await this._selectFirstResult(x);return C}finally{this._clearSearching()}})()}async searchNearby(b){if(!this.locationEnabled){var e=new w("searchNearby:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});U.error(e);throw e;}return this._searching=e=(async()=>{try{const m=await u.getCurrentPosition(),r=await u.positionToPoint({position:m,view:this.view},b);return await this.search(r,b)}finally{this._clearSearching()}})()}async select(b){this.clearGraphics();
if(!b)throw b=new w("select:missing-parameter","Cannot select without a searchResult.",{searchResult:b}),U.error(b),b;const {view:e}=this,m=E(b,"sourceIndex")?b.sourceIndex:this._getSourceIndexOfResult(b),r=null!=m?this.allSources.at(m):null;if(!r)throw b=new w("select:missing-source","Cannot select without a source.",{source:r}),U.error(b),b;var C=r instanceof d?this._getLayerSourcePopupTemplate(r):r.popupTemplate,x=r.resultSymbol||this._getDefaultSymbol(b);const N=E(r,"resultGraphicEnabled")?r.resultGraphicEnabled:
this.resultGraphicEnabled;var Z=E(r,"autoNavigate")?r.autoNavigate:this.autoNavigate;const ca=(E(r,"popupEnabled")?r.popupEnabled:this.popupEnabled)?C||this.popupTemplate||this.defaultPopupTemplate:null,{feature:W}=b;if(!W)throw b=new w("select:missing-feature","Cannot select without a feature.",{feature:W}),U.error(b),b;const {attributes:aa,geometry:da,layer:ha,sourceLayer:ia}=W,ea=F.getPointFromGeometry(da);C={layerViewQuery:this._getLayerView(W),elevationQuery:e&&null!=ea?F.getPointWithElevation(ea,
e).catch(()=>ea):Promise.resolve(ea)};var fa=await p.eachAlways(C);C=fa.layerViewQuery.value;fa=fa.elevationQuery.value;x instanceof T&&(x.text=b.name);Z=e&&Z?b.target||b.extent:null;await (null!=Z?this._goToSearchResult(Z):Promise.resolve());x=C?W:new h({geometry:da,symbol:x,attributes:aa,layer:ha,sourceLayer:ia,popupTemplate:ca});(Z=(Z=e?.popup)&&x.getEffectivePopupTemplate(Z.defaultPopupTemplateEnabled))&&await e.openPopup({features:[x],location:fa});C&&ba.highlightsSupported(C)&&!Z&&this._highlightFeature({graphic:x,
layerView:C});!C&&N&&e&&e.graphics.push(x);this._setResultFloor(b);this._set("selectedResult",b);this._set("resultGraphic",x);this.emit("select-result",{result:b,source:r,sourceIndex:m});return b}async suggest(b,e,m){b=b||this.searchTerm;this.emit("suggest-start",{searchTerm:b});await this._suggestTimer(e,m);e=await this._suggestImmediate(b,m);this._set("suggestions",e?.results);this._set("suggestionCount",e?.results.reduce((r,C)=>r+(C.results?.length??0),0)??null);this.emit("suggest-complete",e);
return e}async when(){await P.whenOnce(()=>!this.updating)}async _update(){const {portal:b,view:e}=this;if(this.includeDefaultSources){const m=this._updatingPromise=p.eachAlways([b?.load(),e?.when()]);if(this.destroyed)return;await m;if(m!==this._updatingPromise)return}await P.whenOnce(()=>this.messages);this.destroyed||this._updateDefaultSources();this._updatingPromise=null}_clearSearching(){this._searching=null}_convertHelperServices(){const b=this.portal?.helperServices?.geocode;return b?b.map(e=>
{if(!1!==e.placefinding){var m=k.apiKey&&Q.isArcGISWorldGeocoder(e.url)?{url:Q.meteredArcGISLocatorUrl}:null;e=f.fromJSON({...e,...m});m=e.url;if(Q.isArcGISWorldGeocoder(m)||Q.isProxiedArcGISWorldGeocoder(m)||Q.isMeteredArcGISWorldGeocoder(m)){m=e.outFields??["Addr_type","Match_addr","StAddr","City"];const r=(e.placeholder||this.messages?.placeholder)??"",C="number"===typeof e.defaultZoomScale?e.defaultZoomScale:2500;e.singleLineFieldName="SingleLine";e.outFields=m;e.placeholder=r;e.defaultZoomScale=
C}if(e.singleLineFieldName)return e}}).filter(y.isSome):[]}_destroyFeatureLayers(){this._createdFeatureLayers.forEach(b=>b?.destroy());this._createdFeatureLayers=[]}_getLayerSources(b,e){const m=this.view?.map;return b.map(r=>{const C=m.findLayerById(r.id);if(C){r=this._getLayerJSON(r);var x=d.fromJSON(r);x.placeholder=e;this._getLayer(C,r).then(N=>{x.layer=N});return x}}).filter(y.isSome).toArray()}_getTableSources(b,e){const m=this.view?.map;return b.map(r=>{if(r.id){var C=m.findTableById(r.id);
if(C){r=this._getLayerJSON(r);var x=d.fromJSON(r);x.placeholder=e;this._getLayer(C,r).then(N=>{x.layer=N});return x}}}).filter(y.isSome).toArray()}_convertApplicationProperties(){var b=this.view?.map?.applicationProperties?.viewing?.search;if(!b)return[];const {enabled:e,hintText:m,layers:r,tables:C}=b;if(!e)return[];b=this._getLayerSources(r,m);const x=this._getTableSources(C,m);return[...b,...x]}async _getSubLayer(b,e){await b.load();if(!b.allSublayers)throw Error();b=b.allSublayers.find(m=>m.id===
e.subLayer);if(!b)throw Error();b=await b.createFeatureLayer?.();if(!b)throw Error();this._createdFeatureLayers.push(b);return b}async _getBuildingSubLayer(b,e){await b.load();b=b.allSublayers.find(m=>m.id===e.subLayer);if("building-component"!==b?.type)throw Error();await b.load();if(null==b.associatedLayer)throw Error();await b.associatedLayer.load();return b}async _getLayer(b,e){if("feature"===b.type||"scene"===b.type||"csv"===b.type||"geojson"===b.type||"ogc-feature"===b.type)return b;if("map-image"===
b.type)try{return await this._getSubLayer(b,e)}catch(m){return b=new w("search:create-featurelayer","Could not create a FeatureLayer from the MapImageLayer",{layer:b}),U.error(b),null}return"building-scene"===b.type?this._getBuildingSubLayer(b,e):null}_getLayerJSON(b){return"function"===typeof b.toJSON?b.toJSON():b}_updateDefaultSources(){const {defaultSources:b,includeDefaultSources:e}=this;this._destroyFeatureLayers();b.removeAll();e&&b.addMany([...this._convertApplicationProperties(),...this._convertHelperServices()])}_abortGoTo(){this._gotoController&&
this._gotoController.abort();this._gotoController=null}_clear(){this._abortGoTo();this._set("resultCount",null);this._set("results",null);this._set("suggestions",null);this._set("suggestionCount",null);this._set("selectedResult",null);this._set("selectedSuggestion",null);this.emit("search-clear")}_closePopup(){const b=this.view?.popup,{resultGraphic:e}=this;if(b&&e){var m="selectedFeature"in b,r=m?b.selectedFeature:null;m&&r&&r===e&&b.close()}}_suggestTimer(b,e){return p.after(null!=b?b:this.suggestionDelay,
null,e?.signal)}_createLocationForSearch(b){return b instanceof h?F.getPointFromGeometry(b.geometry):b instanceof A?b:Array.isArray(b)&&2===b.length?new A({longitude:b[0],latitude:b[1]}):null}_createSuggestionForSearch(b){if(b&&E(b,"key")&&E(b,"text")&&E(b,"sourceIndex"))return b;const e=this._createLocationForSearch(b),m="string"===typeof b?b:this.searchTerm,{selectedSuggestion:r,selectedResult:C}=this,x=(b=!b&&r&&C)&&r.location;return b&&r.key===C.key&&r.sourceIndex===C.sourceIndex||x?r:{location:e,
text:e?"":m,sourceIndex:null,key:null}}_getFirstResult(b){let e=null;b&&b.some(m=>{({results:m}=m);m=m?.[0];const r=!!m;r&&(e=m);return r});return e}async _selectFirstResult(b){return this.autoSelect&&b?this.select(b):null}async _suggestImmediate(b,e){await this.when();const m=await this._getSuggestionsFromSources(b,e);if(e?.signal?.aborted)return null;b={activeSourceIndex:this.activeSourceIndex,searchTerm:b??"",numResults:0,numErrors:0,errors:[],results:[]};this._formatResponse(b,m);return b}_formatSourceResponse(b,
e,m){const r=e?.value||[];e=e?.error;const C=this.allSources.at(m);e?(b.errors.push({sourceIndex:m,source:C,error:e}),U.error(e),b.numErrors++):(b.results.push({sourceIndex:m,source:C,results:r}),b.numResults+=r.length)}_formatResponse(b,e,m){if(e)if(-1===b.activeSourceIndex){const r=m&&E(m,"sourceIndex")&&-1!==m.sourceIndex?m.sourceIndex:void 0;e.forEach((C,x)=>{this._formatSourceResponse(b,C,void 0!==r?r:x)})}else this._formatSourceResponse(b,e[0],b.activeSourceIndex)}async _getResultsFromSources(b,
e){var {allSources:m}=this;const r=!b.location&&E(b,"sourceIndex")?b.sourceIndex:this.activeSourceIndex,C=[];if(!m.length)throw m=new w("search:no-sources-defined","At least one source is required.",{allSources:m}),U.error(m),m;-1===r?m.forEach((x,N)=>{C.push(this._getResultsFromSource(b,N,e))}):C.push(this._getResultsFromSource(b,r,e));return p.eachAlways(C)}async _getSuggestionsFromSources(b,e){const {allSources:m,activeSourceIndex:r}=this,C=[];if(!m.length){const x=new w("suggest:no-sources-defined",
"At least one source is required.",{allSources:m});U.error(x);throw x;}-1===r?m.forEach((x,N)=>{C.push(this._getSuggestionsFromSource(b,N,e))}):C.push(this._getSuggestionsFromSource(b,r,e));return p.eachAlways(C)}async _getResultsFromSource(b,e,m){const r=null!=e?this.allSources.at(e):null;if(!r)return null;const {location:C=null}=b,x=this.view?.spatialReference||V,N=E(r,"maxResults")?r.maxResults:this.maxResults,Z=r instanceof d&&E(r,"exactMatch")?r.exactMatch:!1,{view:ca}=this;return r.getResults?.({view:ca,
sourceIndex:e,location:C,suggestResult:b,spatialReference:x,exactMatch:Z,maxResults:N},m)}async _getSuggestionsFromSource(b,e,m){const r=this.allSources.at(e);if(!r)return null;b??(b="");var C=E(r,"suggestionsEnabled")?r.suggestionsEnabled:this.suggestionsEnabled,x=b?.length,N=E(r,"minSuggestCharacters")?r.minSuggestCharacters:this.minSuggestCharacters;if(C&&b.trim()&&x>=N){C=this.view?.spatialReference||V;x=E(r,"maxSuggestions")?r.maxSuggestions:this.maxSuggestions;({view:N}=this);const Z=r instanceof
d&&E(r,"exactMatch")?r.exactMatch:!1;return r.getSuggestions?.({view:N,sourceIndex:e,suggestTerm:b,spatialReference:C,maxSuggestions:x,exactMatch:Z},m)}return null}_getLayerSourcePopupTemplate(b){const {layer:e}=b;if(e)return E(b,"popupTemplate")?b.popupTemplate:e.popupTemplate}_getSourceIndexOfResult(b){const e=this.results;if(!e)return null;let m=null;e.some(r=>r.results.some(C=>C===b?(m=r.sourceIndex,!0):!1));return m}async _goToSearchResult(b){this._abortGoTo();var e=new AbortController;this._gotoController=
e;e={target:{target:b},options:{signal:e.signal}};b||(e.options.animate=!1);await this.callGoTo(e);this._gotoController=null}_getDefaultSymbol(b){const {defaultSymbols:e}=this;b=b.feature?.geometry;if(null==b)return null;switch(b.type){case "point":case "multipoint":return e.point;case "polyline":return e.polyline;case "extent":case "polygon":return e.polygon;default:return null}}_removeHighlight(){this.removeHandles("highlight")}async _getLayerView(b){const {view:e}=this;if(!b||!e||"building-component"===
b.layer?.type||"subtype-sublayer"===b.layer?.type)return null;({layer:b}=b);if(!b)return null;await e.when();return e.whenLayerView(b)}_highlightFeature(b){const {graphic:e,layerView:m}=b,{attributes:r,layer:C}=e;({objectIdField:b}=C);b=m.highlight((b&&r?.[b])??null??e);this.addHandles(b,"highlight")}_setResultFloor(b){const {view:e}=this;var m=b.feature?.attributes;(b=b.feature?.sourceLayer)&&"floorInfo"in b&&b?.floorInfo?.floorField&&m&&(m=m[b.floorInfo.floorField],e?.emit("select-result-floor",
m))}};q.ALL_INDEX=-1;a.__decorate([t.property()],q.prototype,"_searching",void 0);a.__decorate([t.property()],q.prototype,"_updatingPromise",void 0);a.__decorate([t.property({readOnly:!0,value:null})],q.prototype,"activeSource",null);a.__decorate([t.property()],q.prototype,"activeSourceIndex",null);a.__decorate([t.property()],q.prototype,"allPlaceholder",null);a.__decorate([t.property({readOnly:!0})],q.prototype,"allSources",null);a.__decorate([t.property()],q.prototype,"autoNavigate",void 0);a.__decorate([t.property()],
q.prototype,"autoSelect",void 0);a.__decorate([t.property()],q.prototype,"defaultPopupTemplate",void 0);a.__decorate([t.property({readOnly:!0})],q.prototype,"defaultSources",void 0);a.__decorate([t.property()],q.prototype,"defaultSymbols",void 0);a.__decorate([t.property()],q.prototype,"includeDefaultSources",void 0);a.__decorate([t.property()],q.prototype,"locationEnabled",null);a.__decorate([t.property()],q.prototype,"maxInputLength",void 0);a.__decorate([t.property()],q.prototype,"maxResults",
void 0);a.__decorate([t.property()],q.prototype,"maxSuggestions",void 0);a.__decorate([t.property()],q.prototype,"messages",void 0);a.__decorate([t.property()],q.prototype,"minSuggestCharacters",void 0);a.__decorate([t.property({readOnly:!0})],q.prototype,"placeholder",null);a.__decorate([t.property()],q.prototype,"popupEnabled",void 0);a.__decorate([t.property({type:D})],q.prototype,"popupTemplate",void 0);a.__decorate([t.property({type:Y})],q.prototype,"portal",void 0);a.__decorate([t.property()],
q.prototype,"resultCount",void 0);a.__decorate([t.property()],q.prototype,"resultGraphicEnabled",void 0);a.__decorate([t.property({readOnly:!0})],q.prototype,"resultGraphic",void 0);a.__decorate([t.property({readOnly:!0})],q.prototype,"results",void 0);a.__decorate([t.property({readOnly:!0})],q.prototype,"selectedSuggestion",void 0);a.__decorate([t.property()],q.prototype,"searchAllEnabled",void 0);a.__decorate([t.property({readOnly:!0})],q.prototype,"selectedResult",void 0);a.__decorate([t.property()],
q.prototype,"searchTerm",null);a.__decorate([t.property({type:R})],q.prototype,"sources",void 0);a.__decorate([t.property({readOnly:!0})],q.prototype,"state",null);a.__decorate([t.property()],q.prototype,"suggestionDelay",void 0);a.__decorate([t.property()],q.prototype,"suggestionCount",void 0);a.__decorate([t.property({readOnly:!0})],q.prototype,"suggestions",void 0);a.__decorate([t.property()],q.prototype,"suggestionsEnabled",void 0);a.__decorate([t.property({readOnly:!0})],q.prototype,"updating",
null);a.__decorate([t.property()],q.prototype,"view",void 0);a.__decorate([t.property()],q.prototype,"clear",null);return q=a.__decorate([J.subclass("esri.widgets.Search.SearchViewModel")],q)})},"esri/views/support/layerViewUtils":function(){define(["exports"],function(a){a.extractSafeScaleBounds=function(c){c=c.effectiveScaleRange;return{minScale:c?.minScale??0,maxScale:c?.maxScale??0}};a.highlightsSupported=function(c){return c&&"function"===typeof c.highlight};a.isScaleRangeActive=function(c,k){return null!=
c&&0<c||null!=k&&0<k};a.isSelectableLayerView2D=function(c){return null!=c&&"object"===typeof c&&"createQuery"in c&&"queryFeatures"in c&&"layer"in c&&"view"in c};a.occludeesSupported=function(c){return c&&"function"===typeof c.maskOccludee};a.scaleBoundsPredicate=function(c,k,h){return null==c||c>h&&(0===k||c<k)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Search/LayerSearchSource":function(){define("../../chunks/tslib.es6 ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./SearchSource ./support/layerSearchUtils".split(" "),
function(a,c,k,h,D,q,l){var y;h=y=class extends q{constructor(g){super(g);this.suggestionTemplate=this.searchTemplate=this.searchFields=this.orderByFields=this.exactMatch=this.displayField=null;this.getResults=(w,H)=>l.getResults({source:this,...w},H);this.getSuggestions=(w,H)=>l.getSuggestions({source:this,...w},H)}set layer(g){this._set("layer",g);g&&g.load().catch(()=>{})}get name(){return this._getLayerTitle()??""}set name(g){this._overrideIfSome("name",g)}clone(){return new y({autoNavigate:this.autoNavigate,
filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?c.clone(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,displayField:this.displayField,
exactMatch:this.exactMatch,layer:this.layer,searchFields:this.searchFields?c.clone(this.searchFields):null,suggestionTemplate:this.suggestionTemplate,zoomScale:this.zoomScale})}_getFirstStringField(){return this.layer.fieldsIndex?.fields.find(g=>"string"===g.type)?.name??""}_getDisplayField(){return this.displayField||this.layer.displayField||this._getFirstStringField()}_getSearchFieldsString(){const {layer:g,searchFields:w}=this;return g.loaded?`: ${(w||[this._getDisplayField()]).map(H=>g.getField(H)?.alias||
H).join(", ")}`:""}_getLayerTitle(){var {layer:g}=this;if(g&&({title:g}=g,g))return`${g}${this._getSearchFieldsString()}`}};a.__decorate([k.property({json:{read:{source:"field.name"},write:{target:"field.name"}}})],h.prototype,"displayField",void 0);a.__decorate([k.property({json:{read:{source:"field.exactMatch"},write:{target:"field.exactMatch"}}})],h.prototype,"exactMatch",void 0);a.__decorate([k.property({value:null})],h.prototype,"layer",null);a.__decorate([k.property()],h.prototype,"name",null);
a.__decorate([k.property({type:[String],json:{write:!0}})],h.prototype,"orderByFields",void 0);a.__decorate([k.property()],h.prototype,"searchFields",void 0);a.__decorate([k.property()],h.prototype,"searchTemplate",void 0);a.__decorate([k.property()],h.prototype,"suggestionTemplate",void 0);return h=y=a.__decorate([D.subclass("esri.widgets.Search.LayerSearchSource")],h)})},"esri/widgets/Search/SearchSource":function(){define("../../chunks/tslib.es6 ../../core/Identifiable ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(a,c,k,h,D,q,l,y){c=class extends c.IdentifiableMixin(k.JSONSupport){constructor(g){super(g);this.outFields=this.minSuggestCharacters=this.maxSuggestions=this.maxResults=this.getSuggestions=this.getResults=this.filter=this.autoNavigate=null;this.placeholder="";this.popupTemplate=this.popupEnabled=null;this.prefix="";this.suggestionsEnabled=this.resultSymbol=this.resultGraphicEnabled=null;this.suffix="";this.withinViewEnabled=!1;this.zoomScale=null}};a.__decorate([h.property()],c.prototype,
"autoNavigate",void 0);a.__decorate([h.property()],c.prototype,"filter",void 0);a.__decorate([h.property()],c.prototype,"getResults",void 0);a.__decorate([h.property()],c.prototype,"getSuggestions",void 0);a.__decorate([h.property()],c.prototype,"maxResults",void 0);a.__decorate([h.property()],c.prototype,"maxSuggestions",void 0);a.__decorate([h.property()],c.prototype,"minSuggestCharacters",void 0);a.__decorate([h.property()],c.prototype,"outFields",void 0);a.__decorate([h.property()],c.prototype,
"placeholder",void 0);a.__decorate([h.property()],c.prototype,"popupEnabled",void 0);a.__decorate([h.property()],c.prototype,"popupTemplate",void 0);a.__decorate([h.property()],c.prototype,"prefix",void 0);a.__decorate([h.property()],c.prototype,"resultGraphicEnabled",void 0);a.__decorate([h.property()],c.prototype,"resultSymbol",void 0);a.__decorate([h.property()],c.prototype,"suggestionsEnabled",void 0);a.__decorate([h.property()],c.prototype,"suffix",void 0);a.__decorate([h.property()],c.prototype,
"withinViewEnabled",void 0);a.__decorate([h.property()],c.prototype,"zoomScale",void 0);return c=a.__decorate([y.subclass("esri.widgets.Search.SearchSource")],c)})},"esri/widgets/Search/support/layerSearchUtils":function(){define("exports ../../../intl ../../../core/Error ../../../core/lang ../../../core/Logger ../../../core/unitUtils ../../../geometry/Polygon ../../../rest/support/FullTextSearch ./geometryUtils ../../../intl/substitute ../../../intl/date".split(" "),function(a,c,k,h,D,q,l,y,g,w,
H){function K(u,z){const {filter:B,withinViewEnabled:M}=u;u=z?.extent;return B?.geometry??(M&&u?u:void 0)}async function p(u){u&&await u.load()}function P(u,z){return(u=u?.indexes)&&z?.length?u.filter(B=>"FullText"===B.indexType).some(B=>{const M=B.fields?.split(",").map(O=>O.trim().toLowerCase())||[];return z.every(O=>M.includes(O.toLowerCase()))}):!1}function t({text:u,searchFields:z}){return u.trim().split(" ").filter(B=>!!B.trim()).map(B=>new y({onFields:z,searchTerm:B,searchType:"prefix"}))}
function I(u){return u?.fieldsIndex?.fields?.find(z=>"string"===z.type)?.name??""}function n(u,z){return u&&z?.length?z.every(B=>!!u.getField(B)):!1}function J(u,z,B){let M=null;({codedValues:u}=u);u&&u.some(O=>{var T=O.name;T=B?T:T.toLowerCase();return(B?z:z.toLowerCase())===T?(M=O.code.toString(),!0):!1});return M}function A(u,z){return(z=z?.where)?`(${u}) AND (${z})`:u}function S({currentTerm:u,field:z,filter:B,exactMatch:M,url:O,type:T}){var E=z?.type;z=z?.name;if("string"===E||"date"===E||"global-id"===
E){if(E=O=v.test(O??""))a:{for(E=0;E<u.length;E++)if(255<u.charCodeAt(E)){E=!0;break a}E=!1}E=E?"N":"";if(M&&"search"===T)return A(`${z} = ${E}'${u}'`,B);if(O)return A(`${z} LIKE ${E}${`'${u}%'`}`,B);M=`LOWER(${z})`;u=u.toLowerCase();return A(`${M} LIKE ${E}${`'${u}%'`}`,B)}return"oid"===E||"small-integer"===E||"integer"===E||"single"===E||"double"===E?(u=Number(u),isNaN(u)?null:A(`${z} = ${u}`,B)):A(`${z} = ${u}`,B)}function G({searchTerm:u,layer:z,searchFields:B,filter:M,exactMatch:O,query:T,type:E}){const {definitionExpression:U,
url:R}=z;let V="";!T.fullText&&u&&B&&B.forEach(L=>{var b=z.getField(L);L=((L="function"===typeof z.getFieldDomain&&z.getFieldDomain(L))&&"coded-value"===L.type?J(L,u,O):null)||u||null;null!==L&&(b=S({currentTerm:L,field:b,filter:M,exactMatch:O,url:R,type:E}))&&(V+=V?` OR (${b})`:`(${b})`)});return U&&V?`(${U}) AND (${V})`:U||V}function X(u,z){let B=null;({codedValues:u}=u);u&&u.length&&u.some(M=>M.code===z?(B=M.name,!0):!1);return B}function Y(u,z){return u[Object.keys(u).find(B=>B.toLowerCase()===
z.toLowerCase())]}function ba(u,z,B){const M=u.sourceLayer,{attributes:O}=u;u="function"===typeof M.getFieldDomain&&M.getFieldDomain(B);return z?w.substitute(z,O):B&&O?(z=M.getField(B),B=Y(O,B),null==B?"":u&&"coded-value"===u.type?X(u,B)??"":"date"===z?.type?H.formatDate(new Date(B)):"number"===typeof B?B.toString():"string"!==typeof B?"":B.trim()):""}function d(u,z,B,M){return u.features.map(O=>{var T=O.sourceLayer,{attributes:E}=O;({objectIdField:T}=T);E=T?E[T]:null;return{text:ba(O,z.suggestionTemplate,
M),key:E,sourceIndex:B}})}function f(u,z,B,M,O,T,E){return u.features.map(U=>{var R=T;const V=U.clone(),L=U.sourceLayer;var b=L?.objectIdField;b=b?U.attributes[b]:null;const e=ba(U,B.searchTemplate,O);null!=R&&null!=L&&null!=L.minScale&&null!=L.maxScale&&(L.minScale&&L.minScale<R?R=L.minScale:L.maxScale&&L.maxScale>R&&(R=L.maxScale));R=g.createExtentFromGeometry(V.geometry,z,R);R="number"===typeof E?g.scaleExtent(h.clone(R),z,E):R;U=U.clone();null!=R&&(U.geometry=l.fromExtent(R));return{extent:R,
target:U,feature:V,key:b,name:e,sourceIndex:M}})}const v=/https?:\/\/services.*\.arcgis\.com/i,F=/(?:\{([^}]+)\})/g,Q=D.getLogger("esri.widgets.Search.support.layerSearchUtils");a.createFullTextSearchInfos=t;a.getResults=function(u,z){const {exactMatch:B=!1,location:M,maxResults:O,spatialReference:T,source:E,sourceIndex:U,suggestResult:R,view:V}=u,{layer:L,filter:b,zoomScale:e}=E,m=V?.scale,r=K(E,V),C=z?.signal;return p(L).then(()=>{const x=L.popupTemplate;return x?x.getRequiredFields(L.fieldsIndex):
null}).then(x=>{const {objectIdField:N,returnZ:Z}=L,ca=E.displayField||E.layer.displayField||I(E.layer);if(!L.getField(ca))throw Q.error("invalid-field: displayField is invalid."),new k("getResults():invalid-field","displayField is invalid.");x=x&&x.length?x:[ca];var W=E.outFields||x;x=W&&W.includes("*");W.includes(N)||x||W.push(N);L.floorInfo?.floorField&&W.push(L.floorInfo.floorField);if(!x&&!n(L,W))throw Q.error("invalid-field: outField is invalid."),new k("getResults():invalid-field","outField is invalid.");
x=L.createQuery();var {orderByFields:aa}=E;aa&&(x.orderByFields=aa);T&&(x.outSpatialReference=T,aa=1/q.getMetersPerUnitForSR(T))&&(x.maxAllowableOffset=aa);aa="mesh"===L.geometryType||"multipatch"===L.geometryType;x.returnZ=L.capabilities?.data?.supportsZ&&!aa&&!1!==Z;x.returnGeometry=!0;x.multipatchOption=aa?"xyFootprint":null;W&&(x.outFields=W);if(M)x.geometry=M;else if(R.key)x.objectIds=[R.key];else{W=E.searchFields||[ca];if(!n(L,W))throw Q.error("invalid-field: search field is invalid."),new k("getResults():invalid-field",
"search field is invalid.");(L?.capabilities?.query?.supportsPagination??!1)&&(x.num=O);r&&(x.geometry=r);if(!R.text?.trim())return[];aa=R.text;const {prefix:da="",suffix:ha=""}=E,ia=`${da}${aa}${ha}`.replaceAll("'","''");(L?.capabilities?.query?.supportsFullTextSearch??!1)&&P(L,W)&&!B&&aa&&(x.fullText=t({text:aa,searchFields:W}));W=G({searchTerm:ia,layer:L,searchFields:W,filter:b,exactMatch:B,query:x,type:"search"});x.where=W;if(!x.fullText&&!x.where)return[]}return L.queryFeatures(x,{signal:C}).then(da=>
f(da,V,E,U,ca,m,e))})};a.getSuggestions=function(u,z){const {source:B,spatialReference:M,view:O,suggestTerm:T,maxSuggestions:E,sourceIndex:U,exactMatch:R}=u,{layer:V,filter:L}=B,b=z?.signal,e=K(B,O);return p(V).then(()=>{if(!(V?.capabilities?.query?.supportsPagination??!1))return[];const m=B.displayField||B.layer.displayField||I(B.layer);var r=B.searchFields||[m];const C=[];B.suggestionTemplate?B.suggestionTemplate.replaceAll(F,(aa,da)=>{C.push(da);return aa}):C.push(m);var x=C&&C.includes("*");C.includes(V.objectIdField)||
x||C.push(V.objectIdField);var N=!!V.getField(m);x=x||n(V,C);const Z=n(V,r);if(!N)throw Q.error("invalid-field: displayField is invalid."),new k("getSuggestions():invalid-field","displayField is invalid.");if(!x)throw Q.error("invalid-field: outField is invalid."),new k("getSuggestions():invalid-field","outField is invalid.");if(!Z)throw Q.error("invalid-field: search field is invalid."),new k("getSuggestions():invalid-field","search field is invalid.");N=V.createQuery();({orderByFields:x}=B);x&&
(N.orderByFields=x);N.outSpatialReference=M;N.returnGeometry=!1;N.num=E;N.outFields=C;e&&(N.geometry=e);if(!T.trim())return[];const {prefix:ca="",suffix:W=""}=B;x=`${ca}${T}${W}`.replaceAll("'","''");(V?.capabilities?.query?.supportsFullTextSearch??!1)&&P(V,r)&&!R&&T&&(N.fullText=t({text:T,searchFields:r}));r=G({searchTerm:x,layer:V,searchFields:r,filter:L,exactMatch:R,query:N,type:"suggest"});N.where=r;return N.fullText||N.where?V.queryFeatures(N,{signal:b}).then(aa=>d(aa,B,U,m)):[]})};Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Search/support/geometryUtils":function(){define("exports ../../../geometry ../../../core/Error ../../../core/Logger ../../../geometry/support/scaleUtils ../../../geometry/Extent".split(" "),function(a,c,k,h,D,q){function l(g,w,H){const K=g.hasZ?g.z:void 0;return w?.map?(null!=H?D.getExtentForScale(w,H):w.extent).clone().centerAt(g).set({zmax:K,zmin:K}):new q({xmin:g.x-.25,ymin:g.y-.25,xmax:g.x+.25,ymax:g.y+.25,spatialReference:g.spatialReference,
zmin:K,zmax:K})}const y=h.getLogger("esri.widgets.Search.support.geometryUtils");a.createExtentFromGeometry=function(g,w,H){if(null==g)return null;if("extent"===g.type)return g;if("multipoint"===g.type||"polygon"===g.type||"polyline"===g.type)return g.extent;if("point"===g.type)return l(g,w,H)};a.getPointFromGeometry=function(g){if(null==g)return null;switch(g.type){case "point":return g;case "extent":return g.center;case "polygon":return g.centroid;case "multipoint":return g.getPoint(0);case "polyline":return g.getPoint(0,
0)}return null};a.getPointWithElevation=function(g,w){if(!w)return y.error("missing-parameter: view is missing."),Promise.reject(new k("searchgeometryutils:missing-parameter","view is missing."));if(!g)return y.error("missing-parameter: point is missing."),Promise.reject(new k("searchgeometryutils:missing-parameter","point is missing."));if(g.hasZ||"2d"===w.type)return Promise.resolve(g);const H=w?.map?.ground;return H?.layers.length?H.queryElevation(g,{cache:w.basemapTerrain?.elevationQueryCache}).then(K=>
K.geometry):Promise.resolve(g)};a.scaleExtent=function(g,w,H){return null==g||null==w?null:l(g.center,w,H)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/scaleUtils":function(){define(["exports","../../core/mathUtils","../../core/unitUtils"],function(a,c,k){function h(D,q){q=k.getMetersPerUnitForSR(q);return D/(q*k.inchesPerMeter*96)}a.getExtentForScale=function(D,q){const l=D.extent;D=D.width-(D.padding?D.padding.left+D.padding.right:0);q=h(q,l.spatialReference);
return l.clone().expand(q*D/l.width)};a.getResolutionForScale=h;a.getResolutionInMetersForScale=function(D){return D/(96*k.inchesPerMeter)};a.getScale=function(D,q){q=q||D.extent;D=D.width;const l=k.getMetersPerUnitForSR(q?.spatialReference);return q&&D?q.width/D*l*k.inchesPerMeter*96:0};a.getScaleForResolution=function(D,q){q=k.getMetersPerUnitForSR(q);return D*q*k.inchesPerMeter*96};a.isInScaleRange=function(D,q,l){if(q=0===q||c.floatEqualAbsolute(D,q)||D<q)q=0===l||c.floatEqualAbsolute(D,l)||D>
l;return q};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Search/LocatorSearchSource":function(){define("../../chunks/tslib.es6 ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./SearchSource ./support/locatorUtils".split(" "),function(a,c,k,h,D,q,l){var y;h=y=class extends q{constructor(g){super(g);this.defaultZoomScale=this.countryCode=this.categories=this.apiKey=null;
this.localSearchDisabled=!1;this.locationType=null;this.searchTemplate=this.placeholder=this.name="";this.zoomScale=this.url=this.suggestionsEnabled=this.singleLineFieldName=null;this.getResults=(w,H)=>l.getResults({source:this,...w},H);this.getSuggestions=(w,H)=>l.getSuggestions({source:this,...w},H)}clone(){return new y({apiKey:this.apiKey,autoNavigate:this.autoNavigate,filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,
outFields:this.outFields?c.clone(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,categories:this.categories?c.clone(this.categories):null,countryCode:this.countryCode,locationType:this.locationType,searchTemplate:this.searchTemplate,singleLineFieldName:this.singleLineFieldName,
zoomScale:this.zoomScale})}};a.__decorate([k.property()],h.prototype,"apiKey",void 0);a.__decorate([k.property()],h.prototype,"categories",void 0);a.__decorate([k.property()],h.prototype,"countryCode",void 0);a.__decorate([k.property({json:{write:!0}})],h.prototype,"defaultZoomScale",void 0);a.__decorate([k.property()],h.prototype,"localSearchDisabled",void 0);a.__decorate([k.property()],h.prototype,"locationType",void 0);a.__decorate([k.property({json:{write:!0}})],h.prototype,"name",void 0);a.__decorate([k.property({json:{write:!0}})],
h.prototype,"placeholder",void 0);a.__decorate([k.property()],h.prototype,"searchTemplate",void 0);a.__decorate([k.property({json:{write:!0}})],h.prototype,"singleLineFieldName",void 0);a.__decorate([k.property({json:{read:{source:"suggest"},write:{target:"suggest"}}})],h.prototype,"suggestionsEnabled",void 0);a.__decorate([k.property({json:{write:!0}})],h.prototype,"url",void 0);a.__decorate([k.property({json:{write:!0}})],h.prototype,"zoomScale",void 0);return h=y=a.__decorate([D.subclass("esri.widgets.Search.LocatorSearchSource")],
h)})},"esri/widgets/Search/support/locatorUtils":function(){define("exports ../../../Graphic ../../../geometry/Polygon ../../../rest/locator/addressToLocations ../../../rest/locator/locationToAddress ../../../rest/locator/suggestLocations ../../../rest/support/AddressToLocationsParameters ../../../rest/support/LocationToAddressParameters ../../../rest/support/SuggestLocationsParameters ./geometryUtils".split(" "),function(a,c,k,h,D,q,l,y,g,w){function H(n,J){if(J.localSearchDisabled)return null;J=
n?.scale;return"number"===typeof J&&3E5>=J?n?.extent?.center:null}async function K(n,J){const {source:A,spatialReference:S,location:G,sourceIndex:X,view:Y}=n,{apiKey:ba,url:d,zoomScale:f,defaultZoomScale:v}=A;if(null==d)return[];n=Y?.scale;J=J?.signal;const F=new y;F.location=G;ba&&(F.apiKey=ba);S&&(F.outSpatialReference=S);try{const Q=await D.locationToAddress(d,F,{signal:J});return I([Q],{sourceIndex:X,scale:n,view:Y,zoomScale:f,defaultZoomScale:v})}catch(Q){return[]}}function p(n,J){const {filter:A,
withinViewEnabled:S}=n;n=J?.extent;return(J=w.createExtentFromGeometry(A?.geometry,J,J?.scale))||(S&&n?n:void 0)}async function P(n,J){const {source:A,suggestResult:S,spatialReference:G,view:X,maxResults:Y,sourceIndex:ba}=n,d=A?.zoomScale,f=A?.defaultZoomScale;if(!S.text?.trim())return null;n=`${!S.key&&A.prefix?A.prefix:""}${S.text}${!S.key&&A.suffix?A.suffix:""}`;const v=new l,{apiKey:F,url:Q}=A,u=X?.scale;var z=p(A,X);J=J?.signal;F&&(v.apiKey=F);if(!Q)return null;A.categories&&(v.categories=A.categories);
A.locationType&&(v.locationType=A.locationType);G&&(v.outSpatialReference=G);const B=H(X,A);B&&(v.location=B);v.maxLocations=Y;z&&(v.searchExtent=z);A.countryCode&&(v.countryCode=A.countryCode);({key:z}=S);const M=`${z}`;z&&(v.magicKey=M);v.address={};v.address[A.singleLineFieldName||"Single Line Input"]=n;A.outFields&&(v.outFields=A.outFields);return h.addressToLocations(Q,v,{signal:J}).then(O=>I(O,{key:M,scale:u,sourceIndex:ba,view:X,zoomScale:d,defaultZoomScale:f}))}function t(n,J){return n.map(A=>
({text:A.text,key:A.magicKey,sourceIndex:J}))}function I(n,J){return n.filter(Boolean).map(A=>{const {key:S,scale:G,sourceIndex:X,view:Y,zoomScale:ba,defaultZoomScale:d}=J,{attributes:f,extent:v,location:F,address:Q}=A;A=new c({geometry:F,attributes:f});var u=v||F,z=w.createExtentFromGeometry(u,Y,G);u="number"===typeof ba?w.scaleExtent(z,Y,ba):"number"===typeof d&&"point"===u?.type?w.scaleExtent(z,Y,d):z;z=F?`${F.x},${F.y}`:"";z=Q||z;const B=A.clone();null!=u&&(B.geometry=k.fromExtent(u));return{extent:u,
feature:A,target:B,key:S,name:z,sourceIndex:X}})}a.getLocation=H;a.getResults=function(n,J){return n.location?K(n,J):P(n,J)};a.getSuggestions=async function(n,J){const {source:A,spatialReference:S,view:G,suggestTerm:X,maxSuggestions:Y,sourceIndex:ba}=n;n=new g;const {apiKey:d,url:f}=A,v=p(A,G);J=J?.signal;if(!f)return null;d&&(n.apiKey=d);A.categories&&(n.categories=A.categories);S&&(n.outSpatialReference=S);const F=H(G,A);F&&(n.location=F);if(!X.trim())return null;const {prefix:Q="",suffix:u=""}=
A;n.text=`${Q}${X}${u}`;v&&(n.searchExtent=v);n.maxSuggestions=Y;A.countryCode&&(n.countryCode=A.countryCode);return q.suggestLocations(f,n,{signal:J}).then(z=>t(z,ba))};a.isArcGISWorldGeocoder=function(n){return n?/(?:arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/i.test(n):!1};a.isMeteredArcGISWorldGeocoder=function(n){return n?/(?:geocode\-api\.arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/i.test(n):!1};a.isProxiedArcGISWorldGeocoder=function(n){return n?/(?:\/servers\/[\da-z\.-]+\/rest\/services\/world\/geocodeserver).*/i.test(n):
!1};a.meteredArcGISLocatorUrl="https://geocode-api.arcgis.com/arcgis/rest/services/World/GeocodeServer";Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/locator/addressToLocations":function(){define("exports ../../request ../utils ./utils ../support/AddressCandidate ../support/AddressToLocationsParameters".split(" "),function(a,c,k,h,D,q){function l({data:y}){if(!y)return[];const {candidates:g,spatialReference:w}=y;return g?g.map(H=>{if(H){var {extent:K,location:p}=H,P=K?
h.isValidExtent(K):!0;if(h.isValidLocation(p)&&P)return K&&(K.spatialReference=w),p&&(p.spatialReference=w),D.fromJSON(H)}}):[]}a.addressToLocations=async function(y,g,w){g=q.from(g);y=k.parseUrl(y);const {address:H,...K}=g.toJSON();g=k.encode({...y.query,...H,...K,f:"json"});w=k.asValidOptions(g,w);return c(`${y.path}/findAddressCandidates`,w).then(l)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/locator/utils":function(){define(["exports"],function(a){a.isValidExtent=
function(c){return c&&"number"===typeof c.xmin&&"number"===typeof c.ymin&&"number"===typeof c.xmax&&"number"===typeof c.ymax};a.isValidLocation=function(c){return!!c&&"number"===typeof c.x&&"number"===typeof c.y};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/AddressCandidate":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../geometry/Extent ../../geometry/Point".split(" "),
function(a,c,k,h,D,q,l,y,g){c=class extends c.JSONSupport{constructor(w){super(w);this.score=this.location=this.extent=this.attributes=this.address=null}};a.__decorate([k.property({type:String,json:{write:!0}})],c.prototype,"address",void 0);a.__decorate([k.property({type:Object,json:{write:!0}})],c.prototype,"attributes",void 0);a.__decorate([k.property({type:y,json:{write:!0}})],c.prototype,"extent",void 0);a.__decorate([k.property({type:g,json:{write:!0}})],c.prototype,"location",void 0);a.__decorate([k.property({type:Number,
json:{write:!0}})],c.prototype,"score",void 0);return c=a.__decorate([l.subclass("esri.rest.support.AddressCandidate")],c)})},"esri/rest/support/AddressToLocationsParameters":function(){define("../../chunks/tslib.es6 ../../geometry ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ./commonProperties ../../geometry/Point ../../geometry/SpatialReference ../../geometry/Extent".split(" "),
function(a,c,k,h,D,q,l,y,g,w,H,K){c=class extends k.JSONSupport{constructor(p){super(p);this.searchExtent=this.outSpatialReference=this.outFields=this.maxLocations=this.magicKey=this.locationType=this.location=this.forStorage=this.countryCode=this.categories=this.apiKey=this.address=null}};a.__decorate([h.property({type:Object,json:{write:!0}})],c.prototype,"address",void 0);a.__decorate([h.property(g.apiKey)],c.prototype,"apiKey",void 0);a.__decorate([h.property({type:[String],json:{read:{source:"category",
reader:p=>p?p.split(","):null},write:{target:"category",writer:(p,P)=>{P.category=p?p.join(","):null}}}})],c.prototype,"categories",void 0);a.__decorate([h.property({type:String,json:{write:!0}})],c.prototype,"countryCode",void 0);a.__decorate([h.property({type:Boolean,json:{write:!0}})],c.prototype,"forStorage",void 0);a.__decorate([h.property({type:w,json:{write:{writer:(p,P)=>{P.location=p?p.clone().normalize():null}}}})],c.prototype,"location",void 0);a.__decorate([h.property({type:String,json:{write:!0}})],
c.prototype,"locationType",void 0);a.__decorate([h.property({type:String,json:{write:!0}})],c.prototype,"magicKey",void 0);a.__decorate([h.property({type:Number,json:{write:!0}})],c.prototype,"maxLocations",void 0);a.__decorate([h.property({type:[String],json:{write:{writer:(p,P)=>{P.outFields=p?p.join(","):null}}}})],c.prototype,"outFields",void 0);a.__decorate([h.property({type:H,json:{read:{source:"outSR"},write:{target:"outSR"}}})],c.prototype,"outSpatialReference",void 0);a.__decorate([h.property({type:K,
json:{write:{writer:(p,P)=>{p=p?p.shiftCentralMeridian():null;P.searchExtent=p}}}})],c.prototype,"searchExtent",void 0);c=a.__decorate([y.subclass("esri.rest.support.AddressToLocationsParameters")],c);c.from=D.ensureType(c);return c})},"esri/rest/support/commonProperties":function(){define(["exports"],function(a){a.apiKey={type:String,json:{read:{source:"token"},write:{target:"token"}}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/locator/locationToAddress":function(){define(["exports",
"../../request","../utils","../support/AddressCandidate","../support/LocationToAddressParameters"],function(a,c,k,h,D){function q({data:l}){if(l){var {address:y,location:g}=l;return h.fromJSON({address:y?.Match_addr||"",attributes:y||{},location:g,score:100})}}a.locationToAddress=async function(l,y,g){y=D.from(y);l=k.parseUrl(l);y={...y.toJSON(),f:"json"};y=k.encode({...l.query,...y});g=k.asValidOptions(y,g);return c(`${l.path}/reverseGeocode`,g).then(q)};Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/rest/support/LocationToAddressParameters":function(){define("../../chunks/tslib.es6 ../../geometry ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ./commonProperties ../../geometry/Point ../../geometry/SpatialReference".split(" "),function(a,c,k,h,D,q,l,y,g,w,H){c=class extends k.JSONSupport{constructor(K){super(K);this.outSpatialReference=
this.locationType=this.location=this.apiKey=null}};a.__decorate([h.property(g.apiKey)],c.prototype,"apiKey",void 0);a.__decorate([h.property({type:w,json:{write:{writer:(K,p)=>{K=K?K.clone().normalize():null;p.location=void 0!==K?K:null}}}})],c.prototype,"location",void 0);a.__decorate([h.property({type:String,json:{write:!0}})],c.prototype,"locationType",void 0);a.__decorate([h.property({type:H,json:{read:{source:"outSR"},write:{target:"outSR"}}})],c.prototype,"outSpatialReference",void 0);c=a.__decorate([y.subclass("esri.rest.support.LocationToAddressParameters")],
c);c.from=D.ensureType(c);return c})},"esri/rest/locator/suggestLocations":function(){define(["exports","../../request","../utils","../support/SuggestionCandidate","../support/SuggestLocationsParameters"],function(a,c,k,h,D){function q(l){({data:l}=l);if(!l)return[];({suggestions:l}=l);return l?l.map(y=>new h(y)):[]}a.suggestLocations=async function(l,y,g){l=k.parseUrl(l);y=D.from(y);y={...y.toJSON(),f:"json"};y=k.encode({...l.query,...y});g=k.asValidOptions(y,g);return c(`${l.path}/suggest`,g).then(q)};
Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/SuggestionCandidate":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),function(a,c,k,h,D,q,l){c=class extends c.JSONSupport{constructor(y){super(y);this.text=this.magicKey=this.isCollection=null}};a.__decorate([k.property({type:Boolean,
json:{write:!0}})],c.prototype,"isCollection",void 0);a.__decorate([k.property({type:String,json:{write:!0}})],c.prototype,"magicKey",void 0);a.__decorate([k.property({type:String,json:{write:!0}})],c.prototype,"text",void 0);return c=a.__decorate([l.subclass("esri.rest.support.SuggestionCandidate")],c)})},"esri/rest/support/SuggestLocationsParameters":function(){define("../../chunks/tslib.es6 ../../geometry ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ./commonProperties ../../geometry/Point ../../geometry/SpatialReference ../../geometry/Extent".split(" "),
function(a,c,k,h,D,q,l,y,g,w,H,K){c=class extends k.JSONSupport{constructor(p){super(p);this.text=this.searchExtent=this.outSpatialReference=this.maxSuggestions=this.location=this.countryCode=this.categories=this.apiKey=null}};a.__decorate([h.property(g.apiKey)],c.prototype,"apiKey",void 0);a.__decorate([h.property({type:[String],json:{read:{source:"category",reader:p=>p?p.split(","):null},write:{target:"category",writer:(p,P)=>{P.category=p?p.join(","):null}}}})],c.prototype,"categories",void 0);
a.__decorate([h.property({type:String,json:{write:!0}})],c.prototype,"countryCode",void 0);a.__decorate([h.property({type:w,json:{write:{writer:(p,P)=>{P.location=p?p.clone().normalize():null}}}})],c.prototype,"location",void 0);a.__decorate([h.property({type:Number,json:{write:!0}})],c.prototype,"maxSuggestions",void 0);a.__decorate([h.property({type:H,json:{read:{source:"outSR"},write:{target:"outSR"}}})],c.prototype,"outSpatialReference",void 0);a.__decorate([h.property({type:K,json:{write:{writer:(p,
P)=>{p=p?p.shiftCentralMeridian():null;P.searchExtent=JSON.stringify(p)}}}})],c.prototype,"searchExtent",void 0);a.__decorate([h.property({type:String,json:{write:!0}})],c.prototype,"text",void 0);c=a.__decorate([y.subclass("esri.rest.support.SuggestLocationsParameters")],c);c.from=D.ensureType(c);return c})},"esri/widgets/support/geolocationUtils":function(){define("exports ../../config ../../core/Error ../../core/has ../../core/Logger ../../geometry/Point ../../geometry/support/webMercatorUtils ../../portal/Portal ../../rest/geometryService/project ../../rest/support/ProjectParameters".split(" "),
function(a,c,k,h,D,q,l,y,g,w){function H({longitude:n,latitude:J,altitude:A}){return new q({longitude:n,latitude:J,z:A||void 0,spatialReference:{wkid:4326}})}function K(n,J,A){if(!J)return Promise.resolve(n);const S=J.spatialReference;return S.isWGS84?Promise.resolve(n):S.isWebMercator?Promise.resolve(l.geographicToWebMercator(n)):p(A).then(G=>{if(!G)throw new k("geometry-service:missing-url","Geometry service URL is missing");const X=new w({geometries:[n],outSpatialReference:S});return g.project(G,
X,A).then(Y=>Y[0])})}function p(n){if(c.geometryServiceUrl)return Promise.resolve(c.geometryServiceUrl);const J=y.getDefault();return J.load(n).catch(()=>{}).then(()=>J.helperServices?.geometry?.url)}const P=D.getLogger("esri.widgets.support.geolocationUtils"),t={maximumAge:0,timeout:15E3,enableHighAccuracy:!0};let I;a.getCurrentPosition=function(n){n||(n=t);return new Promise((J,A)=>{setTimeout(()=>A(new k("geolocation:timeout","getting the current geolocation position timed out")),15E3);navigator.geolocation.getCurrentPosition(J,
A,n??void 0)})};a.overridePositionToPoint=function(n){I=n};a.positionToPoint=function(n,J){if(I)return I(n,J);const {position:A,view:S}=n;n=A&&A.coords||{};n={accuracy:n.accuracy,altitude:n.altitude,altitudeAccuracy:n.altitudeAccuracy,heading:n.heading,latitude:n.latitude,longitude:n.longitude,speed:n.speed};n=(A?{coords:n,timestamp:A.timestamp}:A)?.coords;if(!n)throw new k("geometry-service:no-coords","Geolocation has no coordinates");n=H(n);return K(n,S,J)};a.supported=function(){var n=h("esri-geolocation");
n||P.warn("geolocation-unsupported","Geolocation unsupported.");n&&((n=window.isSecureContext)||P.warn("insecure-context","Geolocation requires a secure origin."));return n};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/geometryService/project":function(){define("exports ../../request ../../core/accessorSupport/ensureType ../../geometry/support/jsonUtils ../utils ./utils ../support/ProjectParameters".split(" "),function(a,c,k,h,D,q,l){const y=k.ensureType(l);a.project=
async function(g,w,H){w=y(w);g=D.parseUrl(g);const K={...g.query,f:"json",...w.toJSON()},p=w.outSpatialReference,P=h.getJsonType(w.geometries[0]);w=D.asValidOptions(K,H);return c(g.path+"/project",w).then(({data:{geometries:t}})=>q.decodeGeometries(t,P,p))};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/ProjectParameters":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../geometry/support/jsonUtils ../../geometry/support/spatialReferenceUtils".split(" "),
function(a,c,k,h,D,q,l,y,g){c=class extends c.JSONSupport{constructor(w){super(w);this.geometries=[];this.transformForward=this.transformation=this.outSpatialReference=null}toJSON(){const w=this.geometries.map(p=>p.toJSON()),H=this.geometries[0],K={};K.outSR=g.srToRESTValue(this.outSpatialReference);K.inSR=g.srToRESTValue(H.spatialReference);K.geometries=JSON.stringify({geometryType:y.getJsonType(H),geometries:w});this.transformation&&(K.transformation=this.transformation.wkid||JSON.stringify(this.transformation));
null!=this.transformForward&&(K.transformForward=this.transformForward);return K}};a.__decorate([k.property()],c.prototype,"geometries",void 0);a.__decorate([k.property({json:{read:{source:"outSR"}}})],c.prototype,"outSpatialReference",void 0);a.__decorate([k.property()],c.prototype,"transformation",void 0);a.__decorate([k.property()],c.prototype,"transformForward",void 0);return c=a.__decorate([l.subclass("esri.rest.support.ProjectParameters")],c)})},"esri/widgets/support/GoTo":function(){define("exports ../../chunks/tslib.es6 ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(a,c,k,h,D,q,l,y){a.GoToMixin=g=>{g=class extends g{constructor(...w){super(...w);this.view=this.goToOverride=null}callGoTo(w){const {view:H}=this;k.assertIsSome(H);return this.goToOverride?this.goToOverride(H,w):H.goTo(w.target,w.options)}};c.__decorate([h.property()],g.prototype,"goToOverride",void 0);c.__decorate([h.property()],g.prototype,"view",void 0);return g=c.__decorate([y.subclass("esri.widgets.support.GoTo")],g)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/globalCss":function(){define(["exports"],
function(a){a.globalCss={anchor:"esri-widget__anchor",anchorDisabled:"esri-widget__anchor--disabled",button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",disabled:"esri-disabled",disabledElement:"esri-disabled-element",empty:"esri-widget__content--empty",emptyIllustration:"esri-widget__content-illustration--empty",heading:"esri-widget__heading",
hidden:"esri-hidden",input:"esri-input",interactive:"esri-interactive",loader:"esri-widget__loader",loaderAnimation:"esri-widget__loader-animation",loaderText:"esri-widget__loader-text",menu:"esri-menu",menuHeader:"esri-menu__header",menuItem:"esri-menu__list-item",menuItemActive:"esri-menu__list-item--active",menuItemFocus:"esri-menu__list-item--focus",menuList:"esri-menu__list",noBookmarksIcon:"esri-widget__no-bookmark-icon",panel:"esri-widget--panel",panelHeightOnly:"esri-widget--panel-height-only",
primaryTick:"primary-tick",primaryTickAmPm:"primary-tick__ampm",primaryTickLabel:"primary-tick__label",rotating:"esri-rotating",secondaryTick:"secondary-tick",select:"esri-select",table:"esri-widget__table",widget:"esri-widget",widgetButton:"esri-widget--button",widgetButtonActive:"esri-widget--button-active",widgetDisabled:"esri-widget--disabled"};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define("../chunks/tslib.es6 ../intl ../core/events ../core/maybe ../core/reactiveUtils ../core/string ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./Widget ./Search/css ./Search/SearchResultRenderer ./Search/SearchViewModel ./support/globalCss ./support/legacyIcon ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory ../intl/substitute".split(" "),function(a,
c,k,h,D,q,l,y,g,w,H,K,p,P,t,I,n,J,A,S,G,X){const Y=/<[a-z/][\s\S]*>/i,ba=(d,f)=>{f=q.escapeRegExpString(f).split(/\s/);f=new RegExp(`(${f.join("|")})`,"gi");return d.replace(f,v=>`<strong>${v}</strong>`)};c=class extends K{constructor(d,f){super(d,f);this._activeMenuItemIndex=-1;this._inputNode=null;this._menuItemCount=0;this._suggestionListNode=this._sourceListNode=this._sourceMenuButtonNode=null;this._searchResultRenderer=new P;this._searchController=this._suggestController=null;this._locateFailed=
!1;this._container=null;this.activeMenu="none";this.disabled=!1;this.iconClass=p.css.widgetIcon;this.messagesCommon=this.messages=this.icon=null;this.viewModel=new t;this._clearActiveMenu=()=>{this.activeMenu="none"};this._removeActiveMenu=v=>{(v=v.relatedTarget)&&this._container?.contains(v)||this._clearActiveMenu()};this.addHandles([D.watch(()=>this.searchTerm,v=>{(v&&"warning"===this.activeMenu||!v&&!this.viewModel?.selectedSuggestion?.location)&&this._clearActiveMenu()}),D.on(()=>this.viewModel?.allSources,
"change",()=>this._watchSourceChanges()),D.watch(()=>this.activeMenu,()=>this._resetActiveMenuItemIndex(),D.initial),D.watch(()=>this.viewModel?.defaultPopupTemplate,v=>{v&&(v.content=this._renderSearchResultsContent.bind(this))},D.initial)])}destroy(){this._cancelSuggest();this._cancelSearch();this._searchResultRenderer=h.destroyMaybe(this._searchResultRenderer)}get displayedSearchTerm(){return`${this.viewModel.searchTerm}`.trim()}get inputId(){return this._buildId("input")}get suggestionsMenuId(){return this._buildId("suggest-menu")}get sourceMenuId(){return this._buildId("source-menu")}get sourceMenuButtonId(){return this._buildId("source-menu-button")}get activeSource(){return this.viewModel?.activeSource}get activeSourceIndex(){return this.viewModel.activeSourceIndex}set activeSourceIndex(d){this.viewModel.activeSourceIndex=
d}get allPlaceholder(){return this.viewModel.allPlaceholder}set allPlaceholder(d){this.viewModel.allPlaceholder=d}get allSources(){return this.viewModel.allSources}get autoNavigate(){return this.viewModel.autoNavigate}set autoNavigate(d){this.viewModel.autoNavigate=d}get autoSelect(){return this.viewModel.autoSelect}set autoSelect(d){this.viewModel.autoSelect=d}get defaultSources(){return this.viewModel.defaultSources}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(d){this.viewModel.goToOverride=
d}get includeDefaultSources(){return this.viewModel.includeDefaultSources}set includeDefaultSources(d){this.viewModel.includeDefaultSources=d}get label(){return this.messages?.widgetLabel??""}set label(d){this._overrideIfSome("label",d)}get locationEnabled(){return this.viewModel.locationEnabled}set locationEnabled(d){this.viewModel.locationEnabled=d}get maxResults(){return this.viewModel.maxResults}set maxResults(d){this.viewModel.maxResults=d}get maxSuggestions(){return this.viewModel.maxSuggestions}set maxSuggestions(d){this.viewModel.maxSuggestions=
d}get minSuggestCharacters(){return this.viewModel.minSuggestCharacters}set minSuggestCharacters(d){this.viewModel.minSuggestCharacters=d}get popupEnabled(){return this.viewModel.popupEnabled}set popupEnabled(d){this.viewModel.popupEnabled=d}get popupTemplate(){return this.viewModel.popupTemplate}set popupTemplate(d){this.viewModel.popupTemplate=d}get portal(){return this.viewModel?.portal}set portal(d){this.viewModel&&(this.viewModel.portal=d)}get resultGraphic(){return this.viewModel.resultGraphic}set resultGraphic(d){this.viewModel.resultGraphic=
d}get resultGraphicEnabled(){return this.viewModel.resultGraphicEnabled}set resultGraphicEnabled(d){this.viewModel.resultGraphicEnabled=d}get results(){return this.viewModel.results}get searchAllEnabled(){return this.viewModel.searchAllEnabled}set searchAllEnabled(d){this.viewModel.searchAllEnabled=d}get searchTerm(){return this.viewModel.searchTerm}set searchTerm(d){this.viewModel.searchTerm=d}get selectedResult(){return this.viewModel.selectedResult}get sources(){return this.viewModel.sources}set sources(d){this.viewModel.sources=
d}get suggestions(){return this.viewModel.suggestions}get suggestionsEnabled(){return this.viewModel.suggestionsEnabled}set suggestionsEnabled(d){this.viewModel.suggestionsEnabled=d}get view(){return this.viewModel.view}set view(d){this.viewModel.view=d}clear(){this.viewModel.clear()}focus(){this._inputNode?.focus();this.emit("search-focus")}blur(){this._inputNode?.blur();this.emit("search-blur")}async search(d){this._clearActiveMenu();this._cancelSuggest();this._cancelSearch();const f=new AbortController,
{signal:v}=f;this._searchController=f;try{const F=await this.viewModel.search(d,{signal:v});if(this._searchController===f)return this.activeMenu=F?.numResults?"none":"warning",this._searchController=null,F}catch(F){this._searchController===f&&(this._clearActiveMenu(),this._searchController=null)}}async suggest(d){this._cancelSuggest();const f=new AbortController,{signal:v}=f;this._suggestController=f;try{const F=await this.viewModel.suggest(d,null,{signal:v});if(this._suggestController===f)return this._suggestController=
null,F?.numResults&&this._openSuggestionMenu(),this._scrollToTopSuggestion(),F}catch(F){return this._suggestController!==f?null:this._suggestController=null}}render(){const {state:d}=this.viewModel;return G.tsx("div",{class:this.classes(p.css.base,I.globalCss.widget,{[I.globalCss.disabled]:"disabled"===d,[I.globalCss.widgetDisabled]:this.disabled})},"loading"===d?this._renderLoader():this._renderContainer())}_renderSubmitButton(){const {messages:d,disabled:f}=this;return G.tsx("button",{"aria-label":d.searchButtonTitle,
bind:this,class:this.classes(p.css.submitButton,I.globalCss.widgetButton),disabled:f,key:"esri-search__submit-button",onclick:this._handleSearchButtonClick,title:d.searchButtonTitle,type:"button"},G.tsx("span",{"aria-hidden":"true",class:n.legacyIcon.search}))}_renderWarningMenu(){return G.tsx("div",{class:this.classes(I.globalCss.menu,p.css.warningMenu),key:"esri-search__error-menu"},G.tsx("div",{class:p.css.warningMenuBody},this._renderWarning()))}_renderSourceMenuButton(){const {messages:d,activeMenu:f,
sourceMenuId:v,sourceMenuButtonId:F,disabled:Q}=this,{activeSourceIndex:u,allSources:z}=this.viewModel;return 1<z.length?G.tsx("button",{afterCreate:J.storeNode,"aria-controls":v,"aria-expanded":("source"===f).toString(),"aria-haspopup":"true","aria-label":d.searchIn,bind:this,class:this.classes(p.css.sourcesButton,I.globalCss.widgetButton),"data-node-ref":"_sourceMenuButtonNode",disabled:Q,id:F,key:"esri-search__source-menu-button",onclick:this._handleSourcesMenuToggleClick,onfocus:this._handleSourcesMenuToggleFocus,
title:d.searchIn,type:"button"},G.tsx("span",{"aria-hidden":"true",class:this.classes(n.legacyIcon.downArrow,p.css.sourcesButtonDown)}),G.tsx("span",{"aria-hidden":"true",class:this.classes(n.legacyIcon.upArrow,p.css.sourcesButtonUp)}),G.tsx("span",{class:p.css.sourceName},this._getSourceName(u))):null}_renderSourcesList(){const {allSources:d,searchAllEnabled:f}=this.viewModel,{_activeMenuItemIndex:v,activeMenu:F,sourceMenuId:Q,sourceMenuButtonId:u}=this,z="source"===F&&-1<v?this._buildId("source-item",
v):null;return 1<d.length?G.tsx("ul",{afterCreate:J.storeNode,"aria-activedescendant":z,"aria-labelledby":u,bind:this,class:I.globalCss.menuList,"data-node-ref":"_sourceListNode",id:Q,onkeydown:this._handleSourceMenuKeydown,onkeyup:this._handleSourceMenuKeyup,role:"menu",tabIndex:-1},f?this._renderSource(t.ALL_INDEX):null,d.map((B,M)=>this._renderSource(M)).toArray()):null}_renderSourcesMenu(){const {allSources:d}=this.viewModel;return 1<d.length?G.tsx("div",{class:this.classes(I.globalCss.menu,p.css.sourcesMenu),
key:"esri-search__source-menu"},this._renderSourcesList()):null}_renderLoader(){const {messages:d,messagesCommon:f,disabled:v}=this;return G.tsx("div",{class:I.globalCss.loader,key:"base-loader",tabIndex:v?-1:void 0},G.tsx("span",{"aria-hidden":"true",class:I.globalCss.loaderAnimation}),G.tsx("span",{class:n.legacyIcon.fontFallbackText},d.searchButtonTitle),G.tsx("span",{class:I.globalCss.loaderText},f.loading))}_renderContainer(){const {allSources:d,state:f}=this.viewModel,{activeMenu:v}=this;return G.tsx("div",
{afterCreate:F=>{this._container=F;F.addEventListener("focusout",this._removeActiveMenu)},afterRemoved:F=>{F.removeEventListener("focusout",this._removeActiveMenu)},class:this.classes({[p.css.hasMultipleSources]:1<d.length,[p.css.isLoading]:"loading"===f,[p.css.isSearching]:"searching"===f,[p.css.showWarning]:"warning"===v,[p.css.showSources]:"source"===v,[p.css.showSuggestions]:"suggestion"===v},p.css.container),key:"base-container",tabIndex:-1},this._renderSourceMenuButton(),this._renderSourcesMenu(),
this._renderInputContainer(),this._renderSubmitButton(),this._renderWarningMenu())}_renderClearButton(){return this.searchTerm?G.tsx("button",{bind:this,class:this.classes(p.css.clearButton,I.globalCss.widgetButton),disabled:this.disabled,key:"esri-search__clear-button",onclick:this._handleClearButtonClick,onfocus:this._clearActiveMenu,title:this.messages.clearButtonTitle,type:"button"},G.tsx("span",{"aria-hidden":"true",class:n.legacyIcon.close})):null}_renderLocationGroup(){const {messages:d,locationEnabled:f,
displayedSearchTerm:v}=this,F="suggestion"===this.activeMenu&&0===this._activeMenuItemIndex;return f&&!v?G.tsx("ul",{class:this.classes(I.globalCss.menuList,p.css.suggestionList,p.css.suggestionListCurrentLocation),key:"esri-search__suggestion-list-current-location",role:"group"},G.tsx("li",{"aria-selected":("suggestion"===this.activeMenu&&0===this._activeMenuItemIndex).toString(),bind:this,class:this.classes(I.globalCss.menuItem,F?I.globalCss.menuItemFocus:null),"data-current-location-item":!0,id:this._buildId("suggestion-item",
0),onclick:this._handleUseCurrentLocationClick,role:"option"},G.tsx("span",{"aria-hidden":"true",class:n.legacyIcon.locateCircled})," ",d.useCurrentLocation)):null}_renderInput(){const {activeMenu:d,locationEnabled:f,displayedSearchTerm:v,messages:F,suggestionsMenuId:Q,inputId:u,_activeMenuItemIndex:z,disabled:B}=this,{maxInputLength:M,placeholder:O,searchTerm:T,suggestionCount:E}=this.viewModel,U=!!(f&&!v||E),R="suggestion"===d&&-1<z?this._buildId("suggestion-item",z):null;return G.tsx("input",{afterCreate:J.storeNode,
"aria-activedescendant":R,"aria-autocomplete":"list","aria-controls":U?Q:null,"aria-expanded":(U&&"suggestion"===d).toString(),"aria-haspopup":"listbox","aria-label":F.searchButtonTitle,autocomplete:"off",bind:this,class:this.classes(I.globalCss.input,p.css.input),"data-node-ref":"_inputNode",disabled:B,id:u,maxlength:M,onblur:this.blur,onclick:this._openSuggestionMenu,onfocus:this.focus,oninput:this._handleInputPaste,onkeyup:this._handleInputKeyup,onpaste:this._handleInputPaste,placeholder:O,role:"combobox",
title:T?"":O,type:"text",value:T})}_renderForm(){return G.tsx("form",{bind:this,class:p.css.form,disabled:this.disabled,key:"esri-search__form",onsubmit:this._formSubmit,role:"search"},this._renderInput())}_renderSuggestList(d){const {sourceIndex:f}=d;({results:d}=d);return d?.length?G.tsx("ul",{class:this.classes(I.globalCss.menuList,p.css.suggestionList),key:`esri-search__suggestion-list-${f}`,role:"group"},d?.map(v=>this._renderSuggestion(v,this._menuItemCount++))):null}_renderSuggestionsGroup(){const {suggestions:d}=
this.viewModel;return d?d.map(f=>[this._renderSuggestionHeader(f),this._renderSuggestList(f)]):[]}_renderSuggestionsMenu(){const {displayedSearchTerm:d,locationEnabled:f,suggestionsMenuId:v,inputId:F}=this,{suggestionCount:Q}=this.viewModel;this._menuItemCount=0;return f&&!d||Q?G.tsx("div",{afterCreate:J.storeNode,"aria-labelledby":F,bind:this,class:this.classes(I.globalCss.menu,p.css.suggestionsMenu),"data-node-ref":"_suggestionListNode",id:v,key:"esri-search__suggestions-menu",role:"listbox"},this._renderLocationGroup(),
this._renderSuggestionsGroup()):null}_renderInputContainer(){return G.tsx("div",{class:p.css.inputContainer,key:"esri-search__input-container"},this._renderForm(),this._renderSuggestionsMenu(),this._renderClearButton())}_renderSuggestionHeader(d){const {allSources:f,activeSourceIndex:v}=this.viewModel,{sourceIndex:F}=d,Q=1<f.length&&v===t.ALL_INDEX;return d.results?.length&&Q?G.tsx("div",{class:I.globalCss.menuHeader,key:`esri-search__suggestion-header-${F}`},this._getSourceName(F)):null}_renderSuggestion(d,
f){const {_activeMenuItemIndex:v,viewModel:{searchTerm:F}}=this;if(F)return G.tsx("li",{"aria-selected":("suggestion"===this.activeMenu&&this._activeMenuItemIndex===f).toString(),bind:this,class:this.classes(I.globalCss.menuItem,"suggestion"===this.activeMenu&&v===f?I.globalCss.menuItemFocus:null),"data-suggestion":d,id:this._buildId("suggestion-item",f),innerHTML:this._getSuggestResultHTML(d.text,F),key:`esri-search__suggestion_${f}`,onclick:this._handleSuggestionClick,role:"option"})}_renderSource(d){const {activeSourceIndex:f,
searchAllEnabled:v}=this.viewModel,F=v?d+1:d;return G.tsx("li",{"aria-checked":(d===f).toString(),bind:this,class:this.classes(p.css.source,I.globalCss.menuItem,{[I.globalCss.menuItemActive]:d===f,[I.globalCss.menuItemFocus]:"source"===this.activeMenu&&d===(v?this._activeMenuItemIndex-1:this._activeMenuItemIndex)}),"data-source-index":d,id:this._buildId("source-item",F),key:`esri-search__source-${d}`,onclick:this._handleSourceClick,role:"menuitemradio"},this._getSourceName(d))}_renderNoResultsWarning(d){const {messages:f}=
this;d=d?X.substitute(f.noResultsFoundForValue,{value:`"${d}"`}):f.noResultsFound;return G.tsx("div",{key:"esri-search__no_results"},G.tsx("div",{class:p.css.warningMenuHeader},f.noResults),G.tsx("div",{class:p.css.warningMenuText},d))}_renderEmptySearchWarning(){const {messages:d}=this;return G.tsx("div",{key:"esri-search__empty-search"},G.tsx("span",{"aria-hidden":"true",class:n.legacyIcon.noticeTriangle}),G.tsx("span",{class:p.css.noValueText},d.emptyValue))}_renderLocateWarning(){const {messages:d}=
this;return G.tsx("div",{key:"esri-search__locate-error"},G.tsx("span",{"aria-hidden":"true",class:n.legacyIcon.noticeTriangle}),G.tsx("span",{class:p.css.noValueText},d.locateError))}_renderWarning(){const {displayedSearchTerm:d,_locateFailed:f}=this,{viewModel:v}=this;return f?this._renderLocateWarning():v.selectedSuggestion?.location||d?this._renderNoResultsWarning(d):this._renderEmptySearchWarning()}_resetActiveMenuItemIndex(){this._activeMenuItemIndex=-1}_buildId(d,f){return`${this.id}-${d}${void 0===
f?"":`-${f}`}`}_watchSourceChanges(){const {viewModel:{allSources:d}}=this;this.removeHandles("sources");d.forEach(f=>this.addHandles(D.watch(()=>f.name,()=>this.scheduleRender()),"sources"))}_handleSourcesMenuToggleFocus(){"source"!==this.activeMenu&&this._clearActiveMenu()}_handleSourcesMenuToggleClick(){this.activeMenu="source"===this.activeMenu?"none":"source";this.renderNow();"source"===this.activeMenu&&this._sourceListNode?.focus()}_handleClearButtonClick(){this.viewModel.clear();this._focus()}_handleSearchButtonClick(){this.search()}_handleSuggestionClick(d){if(d=
d.currentTarget?.["data-suggestion"])this._focus(),this.search(d)}_handleUseCurrentLocationClick(){this._useCurrentLocation()}_useCurrentLocation(){this._focus("none");this._cancelSuggest();this._cancelSearch();const d=new AbortController,{signal:f}=d;this._searchController=d;(async()=>{try{this.activeMenu=(await this.viewModel.searchNearby({signal:f}))?.numResults?"none":"warning"}catch(v){this._locateFailed=!0,this.activeMenu="warning"}finally{this._searchController=null}})()}_handleSourceClick(d){this._setSourceFromMenuItem(d.currentTarget)}_setSourceFromMenuItem(d){d&&
(d=d?.["data-source-index"],null!=d&&(this.viewModel.activeSourceIndex=d,this._clearActiveMenu(),this._sourceMenuButtonNode?.focus()))}_cancelSuggest(){this._suggestController=h.abortMaybe(this._suggestController)}_cancelSearch(){this._searchController=h.abortMaybe(this._searchController);this._locateFailed=!1}_handleInputKeyup(d){var f=k.eventKey(d);if(!d.ctrlKey&&!d.metaKey&&"Copy"!==f&&"ArrowLeft"!==f&&"ArrowRight"!==f&&"Shift"!==f)if("Tab"===f||"Escape"===f||d.shiftKey&&"Tab"===f)this._cancelSuggest(),
"Escape"===f&&this._clearActiveMenu();else{var v="Home"===f||"End"===f||"ArrowUp"===f||"ArrowDown"===f;if("Enter"===f&&0>this._activeMenuItemIndex)this._cancelSuggest();else{var F=this._suggestionListNode?.getElementsByTagName("li");if(F?.length){"suggestion"!==this.activeMenu&&this._openSuggestionMenu();if(v){d.preventDefault();this._cancelSuggest();this._handleItemNavigation(f,F,this._suggestionListNode);return}d=F[this._activeMenuItemIndex];if("Enter"===f&&d){(f=d?.["data-suggestion"])?(this._focus(),
this.search(f)):d?.["data-current-location-item"]&&this._useCurrentLocation();return}}this.viewModel.searchTerm&&this.suggest()}}}_handleItemNavigation(d,f,v){const F=this._activeMenuItemIndex;"Home"===d&&(this._activeMenuItemIndex=0);"End"===d&&(this._activeMenuItemIndex=f.length-1);"ArrowUp"===d&&(this._activeMenuItemIndex=0>=this._activeMenuItemIndex?f.length-1:this._activeMenuItemIndex-1);"ArrowDown"===d&&(this._activeMenuItemIndex=this._activeMenuItemIndex===f.length-1?0:this._activeMenuItemIndex+
1);F!==this._activeMenuItemIndex&&v&&J.keepMenuItemWithinView(f[this._activeMenuItemIndex],v)}_scrollToTopSuggestion(){this._suggestionListNode&&(this._suggestionListNode.scrollTop=0)}_openSuggestionMenu(){this.activeMenu="suggestion"}_handleInputPaste(d){d=d.target;this.viewModel.searchTerm!==d.value&&(this.viewModel.searchTerm=d.value);this.viewModel.searchTerm&&this.suggest()}_handleSourceMenuKeydown(d){const f=k.eventKey(d);J.isActivationKey(f)?(d.preventDefault(),d=this._sourceListNode?.getElementsByTagName("li")?.[this._activeMenuItemIndex],
this._setSourceFromMenuItem(d)):"ArrowUp"!==f&&"ArrowDown"!==f&&"End"!==f&&"Home"!==f||d.preventDefault()}_handleSourceMenuKeyup(d){const f=k.eventKey(d),v="ArrowUp"===f||"ArrowDown"===f||"End"===f||"Home"===f;v&&d.preventDefault();"Escape"===f?(this._clearActiveMenu(),this._sourceMenuButtonNode?.focus()):(d=this._sourceListNode?.getElementsByTagName("li"))&&0!==d.length&&v&&("source"!==this.activeMenu&&(this.activeMenu="source"),this._handleItemNavigation(f,d,this._sourceListNode?.parentElement))}_focus(d){this.focus();
d&&(this.activeMenu=d)}_formSubmit(d){d.preventDefault();-1===this._activeMenuItemIndex&&this.search()}_getSourceName(d){const {messages:f}=this;var {allSources:v}=this.viewModel;v=v.at(d);return d===t.ALL_INDEX?f.all:v?v.name||f.untitledSource:f.untitledSource}_getSuggestResultHTML(d,f){return d?Y.test(d)?d:ba(d,f):this.messages.untitledResult}_renderSearchResultsContent(){this._searchResultRenderer.showMoreResultsOpen=!1;this._searchResultRenderer.viewModel=this.viewModel;return this._searchResultRenderer}};
a.__decorate([l.property()],c.prototype,"_activeMenuItemIndex",void 0);a.__decorate([l.property()],c.prototype,"displayedSearchTerm",null);a.__decorate([l.property({readOnly:!0})],c.prototype,"inputId",null);a.__decorate([l.property({readOnly:!0})],c.prototype,"suggestionsMenuId",null);a.__decorate([l.property({readOnly:!0})],c.prototype,"sourceMenuId",null);a.__decorate([l.property({readOnly:!0})],c.prototype,"sourceMenuButtonId",null);a.__decorate([l.property()],c.prototype,"activeMenu",void 0);
a.__decorate([l.property({readOnly:!0})],c.prototype,"activeSource",null);a.__decorate([l.property()],c.prototype,"activeSourceIndex",null);a.__decorate([l.property()],c.prototype,"allPlaceholder",null);a.__decorate([l.property({readOnly:!0})],c.prototype,"allSources",null);a.__decorate([l.property()],c.prototype,"autoNavigate",null);a.__decorate([l.property()],c.prototype,"autoSelect",null);a.__decorate([l.property({readOnly:!0})],c.prototype,"defaultSources",null);a.__decorate([l.property()],c.prototype,
"disabled",void 0);a.__decorate([l.property()],c.prototype,"goToOverride",null);a.__decorate([l.property()],c.prototype,"iconClass",void 0);a.__decorate([l.property()],c.prototype,"icon",void 0);a.__decorate([l.property()],c.prototype,"includeDefaultSources",null);a.__decorate([l.property()],c.prototype,"label",null);a.__decorate([l.property()],c.prototype,"locationEnabled",null);a.__decorate([l.property()],c.prototype,"maxResults",null);a.__decorate([l.property()],c.prototype,"maxSuggestions",null);
a.__decorate([l.property(),A.messageBundle("esri/widgets/Search/t9n/Search")],c.prototype,"messages",void 0);a.__decorate([l.property(),A.messageBundle("esri/t9n/common")],c.prototype,"messagesCommon",void 0);a.__decorate([l.property()],c.prototype,"minSuggestCharacters",null);a.__decorate([l.property()],c.prototype,"popupEnabled",null);a.__decorate([l.property()],c.prototype,"popupTemplate",null);a.__decorate([l.property()],c.prototype,"portal",null);a.__decorate([l.property()],c.prototype,"resultGraphic",
null);a.__decorate([l.property()],c.prototype,"resultGraphicEnabled",null);a.__decorate([l.property({readOnly:!0})],c.prototype,"results",null);a.__decorate([l.property()],c.prototype,"searchAllEnabled",null);a.__decorate([l.property()],c.prototype,"searchTerm",null);a.__decorate([l.property({readOnly:!0})],c.prototype,"selectedResult",null);a.__decorate([l.property()],c.prototype,"sources",null);a.__decorate([l.property({readOnly:!0})],c.prototype,"suggestions",null);a.__decorate([l.property()],
c.prototype,"suggestionsEnabled",null);a.__decorate([l.property()],c.prototype,"view",null);a.__decorate([S.vmEvent("search-complete search-clear search-start select-result suggest-start suggest-complete".split(" ")),l.property({type:t})],c.prototype,"viewModel",void 0);return c=a.__decorate([H.subclass("esri.widgets.Search")],c)});