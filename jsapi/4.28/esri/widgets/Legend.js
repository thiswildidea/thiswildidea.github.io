// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.28/esri/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Legend/LegendViewModel":function(){define("../../chunks/tslib.es6 ../../intl ../../core/Accessor ../../core/Collection ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/get ./support/ActiveLayerInfo ../../intl/locale".split(" "),function(q,E,P,C,u,I,D,z,Q,F,v,b,k){const l=C.ofType(b),h=new Set("esri.layers.BuildingSceneLayer esri.layers.CSVLayer esri.layers.FeatureLayer esri.layers.GeoJSONLayer esri.layers.GeoRSSLayer esri.layers.GroupLayer esri.layers.HeatmapLayer esri.layers.ImageryLayer esri.layers.ImageryTileLayer esri.layers.MapImageLayer esri.layers.OGCFeatureLayer esri.layers.PointCloudLayer esri.layers.StreamLayer esri.layers.SceneLayer esri.layers.SubtypeGroupLayer esri.layers.TileLayer esri.layers.VoxelLayer esri.layers.WFSLayer esri.layers.WMSLayer esri.layers.WMTSLayer esri.layers.WCSLayer esri.layers.LinkChartLayer esri.layers.knowledgeGraph.KnowledgeGraphSublayer".split(" ")),
e=["view.basemapView.baseLayerViews","view.groundView.layerViews","view.layerViews","view.basemapView.referenceLayerViews"];E=class extends P{constructor(c){super(c);this._layerViewByLayerId={};this._layerInfosByLayerViewId={};this._activeLayerInfosByLayerViewId={};this._activeLayerInfosWithNoParent=new C;this.activeLayerInfos=new l;this.keepCacheOnDestroy=this.hideLayersNotInCurrentView=this.groundLegendVisible=this.basemapLegendVisible=!1;this.respectLayerVisibility=!0;this.layerInfos=[];this.view=
null}initialize(){this.addHandles(u.watch(()=>this.view,()=>this._viewHandles(),u.initial),"view");this.addHandles(k.onLocaleChange(()=>this._refresh()))}destroy(){this._destroyViewActiveLayerInfos();this.view=null}get state(){return this.view?.ready?"ready":"disabled"}_viewHandles(){this.removeHandles("state");this.view&&this.addHandles(u.watch(()=>this.state,()=>this._stateHandles(),u.initial),"state")}_stateHandles(){this._resetAll();"ready"===this.state&&this._watchPropertiesAndAllLayerViews()}_resetAll(){this.removeHandles(["all-layer-views",
"legend-properties"]);this._destroyViewActiveLayerInfos();this.activeLayerInfos.removeAll()}_destroyViewActiveLayerInfos(){Object.keys(this._activeLayerInfosByLayerViewId).forEach(this._destroyViewActiveLayerInfo,this)}_destroyViewActiveLayerInfo(c){this.removeHandles(c);const g=this._activeLayerInfosByLayerViewId[c];delete this._activeLayerInfosByLayerViewId[c];g?.parent&&g.parent.children.remove(g)}_watchPropertiesAndAllLayerViews(){var {view:c}=this;c&&({allLayerViews:c}=c,c.length&&this._refresh(),
this.addHandles(c.on("change",g=>this._allLayerViewsChangeHandle(g)),"all-layer-views"),this.addHandles(u.watch(()=>[this.layerInfos,this.basemapLegendVisible,this.groundLegendVisible],()=>this._propertiesChangeHandle()),"legend-properties"))}_allLayerViewsChangeHandle(c){c.removed.forEach(g=>this._destroyViewActiveLayerInfo(g.uid));this._refresh()}_propertiesChangeHandle(){this._destroyViewActiveLayerInfos();this._refresh()}_refresh(){this._layerInfosByLayerViewId={};this.activeLayerInfos.removeAll();
this._generateLayerViews().filter(this._filterLayerViewsByLayerInfos,this).filter(this._isLayerViewSupported,this).forEach(this._generateActiveLayerInfo,this);this._sortActiveLayerInfos(this.activeLayerInfos)}_sortActiveLayerInfos(c){const g=this.view;if(!(2>c.length)&&g){var r=[];c.forEach(A=>{if(!A.parent){var H=A.layer.parent;(H=(H=H&&"uid"in H&&this._layerViewByLayerId[H.uid])&&this._activeLayerInfosByLayerViewId[H.uid])&&c.includes(H)&&(r.push(A),A.parent=H,H.children.add(A),this._sortActiveLayerInfos(H.children))}});
c.removeMany(r);var m={};g.allLayerViews.forEach((A,H)=>m[A.layer.uid]=H);c.sort((A,H)=>(m[H.layer.uid]||0)-(m[A.layer.uid]||0))}}_generateLayerViews(){const c=[];e.filter(this._filterLayerViews,this).map(g=>v.get(this,g)).filter(g=>null!=g).forEach(this._collectLayerViews("layerViews",c));return c}_filterLayerViews(c){const g=!this.groundLegendVisible&&"view.groundView.layerViews"===c;return!(!this.basemapLegendVisible&&("view.basemapView.baseLayerViews"===c||"view.basemapView.referenceLayerViews"===
c))&&!g}_collectLayerViews(c,g){const r=m=>{m&&m.forEach(A=>{g.push(A);r(A[c])});return g};return r}_filterLayerViewsByLayerInfos(c){const g=this.layerInfos;return g&&g.length?g.some(r=>this._hasLayerInfo(r,c)):!0}_hasLayerInfo(c,g){const r=this._isLayerUIDMatching(c.layer,g.layer.uid);r&&(this._layerInfosByLayerViewId[g.uid]=c);return r}_isLayerUIDMatching(c,g){return c&&(c.uid===g||this._hasLayerUID(c.layers,g))}_hasLayerUID(c,g){return c&&c.some(r=>this._isLayerUIDMatching(r,g))}_isLayerViewSupported(c){return h.has(c.layer.declaredClass)?
(this._layerViewByLayerId[c.layer.uid]=c,!0):!1}_generateActiveLayerInfo(c){this._isLayerActive(c)?this._buildActiveLayerInfo(c):(this.removeHandles(c.uid),this.addHandles(u.watch(()=>[c.legendEnabled,c.layer?.legendEnabled],()=>this._layerActiveHandle(c)),c.uid))}_layerActiveHandle(c){this._isLayerActive(c)&&(this.removeHandles(c.uid),this._buildActiveLayerInfo(c))}_isLayerActive(c){return this.respectLayerVisibility?c.legendEnabled&&c.layer?.legendEnabled:!0}_buildActiveLayerInfo(c){const g=c.layer,
r=c.uid;var m=this._layerInfosByLayerViewId[r];let A=this._activeLayerInfosByLayerViewId[r];A||(A=new b({layer:g,layerView:c,title:void 0!==m?.title&&m.layer.uid===g.uid?m.title:g.title,view:this.view,respectLayerVisibility:this.respectLayerVisibility,hideLayersNotInCurrentView:this.hideLayersNotInCurrentView,keepCacheOnDestroy:this.keepCacheOnDestroy,sublayerIds:m?.sublayerIds||[]}),this._activeLayerInfosByLayerViewId[r]=A);A.parent=this._activeLayerInfosByLayerViewId[(g.parent&&"uid"in g.parent?
this._layerViewByLayerId[g.parent?.uid]:null)?.uid];if(!this.hasHandles(r)){m=u.watch(()=>g.title,G=>this._titleHandle(G,A));var H=u.watch(()=>[g.opacity,"renderer"in g&&g.renderer,"pointSymbol"in g&&g.pointSymbol,"lineSymbol"in g&&g.lineSymbol,"polygonSymbol"in g&&g.polygonSymbol],()=>this._constructLegendElements(A)),J=u.when(()=>!0===this.view?.stationary,()=>this._scaleHandle(A),u.initial);const f=u.watch(()=>c._effectiveRenderer,()=>this._constructLegendElements(A)),d=u.watch(()=>"effect"in g&&
g.effect,()=>this._constructLegendElements(A)),x=u.when(()=>this.view?.timeZone,()=>this._constructLegendElements(A),u.initial);m=[m,H,J,f,d,x];this.respectLayerVisibility&&(H=u.watch(()=>c.legendEnabled,G=>this._legendEnabledHandle(G,A)),J=u.watch(()=>g.legendEnabled,G=>this._legendEnabledHandle(G,A)),m.push(H,J));this.addHandles(m,r)}A.isScaleDriven||this._constructLegendElements(A);this._addActiveLayerInfo(A)}_titleHandle(c,g){g.title=c;this._constructLegendElements(g)}_legendEnabledHandle(c,g){c?
this._addActiveLayerInfo(g):this._removeActiveLayerInfo(g)}_scaleHandle(c){(c.isScaleDriven||c.hideLayersNotInCurrentView)&&this._constructLegendElements(c)}_addActiveLayerInfo(c){const {layerView:g,layer:r}=c;if(this._isLayerActive(g)&&!this.activeLayerInfos.includes(c)){var m=c.parent;m?(m.children.includes(c)||m.children.push(c),this._sortActiveLayerInfos(m.children)):(m=this.layerInfos?.some(A=>A.layer.uid===r.uid),r.parent&&"uid"in r.parent&&!m?this._activeLayerInfosWithNoParent.add(c):(this.activeLayerInfos.add(c),
this._sortActiveLayerInfos(this.activeLayerInfos)));if(this._activeLayerInfosWithNoParent.length){const A=[];this._activeLayerInfosWithNoParent.forEach(H=>{var J=H.layer.parent;if(J=this._activeLayerInfosByLayerViewId[(J&&"uid"in J?this._layerViewByLayerId[J?.uid]:null)?.uid])A.push(H),H.parent=J});A.length&&(this._activeLayerInfosWithNoParent.removeMany(A),A.forEach(H=>this._addActiveLayerInfo(H)))}}}_removeActiveLayerInfo(c){const g=c.parent;g?g.children.remove(c):this.activeLayerInfos.remove(c)}_constructLegendElements(c){const g=
c.layer;"featureCollections"in g&&g.featureCollections?c.buildLegendElementsForFeatureCollections(g.featureCollections):"featureReduction"in g&&g.featureReduction&&"renderer"in g.featureReduction&&("binning"===g.featureReduction.type||"cluster"===g.featureReduction.type)?c.buildLegendElementsForFeatureReduction(g.featureReduction):"renderer"in g&&g.renderer&&!("sublayers"in g)?c.buildLegendElementsForRenderer(g.renderer):"url"in g&&g.url?c.buildLegendElementsForTools():c.children.forEach(r=>this._constructLegendElements(r))}};
q.__decorate([I.property({type:l})],E.prototype,"activeLayerInfos",void 0);q.__decorate([I.property()],E.prototype,"basemapLegendVisible",void 0);q.__decorate([I.property()],E.prototype,"groundLegendVisible",void 0);q.__decorate([I.property()],E.prototype,"hideLayersNotInCurrentView",void 0);q.__decorate([I.property()],E.prototype,"keepCacheOnDestroy",void 0);q.__decorate([I.property()],E.prototype,"respectLayerVisibility",void 0);q.__decorate([I.property()],E.prototype,"layerInfos",void 0);q.__decorate([I.property({readOnly:!0})],
E.prototype,"state",null);q.__decorate([I.property()],E.prototype,"view",void 0);return E=q.__decorate([F.subclass("esri.widgets.Legend.LegendViewModel")],E)})},"esri/widgets/Legend/support/ActiveLayerInfo":function(){define("require ../../../chunks/tslib.es6 ../../../Color ../../../intl ../../../kernel ../../../request ../../../symbols ../../../core/Accessor ../../../core/arrayUtils ../../../core/Collection ../../../core/jsonMap ../../../core/Logger ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/screenUtils ../../../core/timeUtils ../../../core/urlUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/PropertyOrigin ../../../layers/effects/EffectView ../../../layers/effects/jsonUtils ../../../layers/support/ExportImageParameters ../../../layers/support/fieldUtils ../../../layers/support/layerUtils ../../../layers/support/rasterFormats/pixelRangeUtils ../../../renderers/support/jsonUtils ../../../renderers/support/rendererConversion ../../../renderers/visualVariables/support/SizeVariableLegendOptions ../../../smartMapping/support/utils ../../../symbols/support/cimSymbolUtils ../../../symbols/support/previewUtils ../../../symbols/support/renderUtils ../../../symbols/support/symbolUtils ../../../symbols/support/utils ./clusterUtils ./colorRampUtils ./heatmapRampUtils ./relationshipRampUtils ./sizeRampUtils ./utils ../../smartMapping/support/utils ../../../symbols/SimpleMarkerSymbol ../../../symbols/SimpleFillSymbol ../../../intl/messages ../../../intl/substitute".split(" "),
function(q,E,P,C,u,I,D,z,Q,F,v,b,k,l,h,e,c,g,r,m,A,H,J,f,d,x,G,y,M,L,N,T,Z,W,w,n,t,R,U,aa,fa,ja,X,la,V,ba,da,ca){function ma(a){return"esri.renderers.SimpleRenderer"===a.declaredClass}function oa(a){return"esri.renderers.ClassBreaksRenderer"===a.declaredClass}function sa(a){return"esri.renderers.UniqueValueRenderer"===a.declaredClass}function ua(a){return"esri.renderers.HeatmapRenderer"===a.declaredClass}function xa(a){return"esri.renderers.PointCloudClassBreaksRenderer"===a.declaredClass}function wa(a){return"esri.renderers.PointCloudStretchRenderer"===
a.declaredClass}function Ea(a){return"esri.renderers.PointCloudUniqueValueRenderer"===a.declaredClass}function Aa(a){return"esri.renderers.DotDensityRenderer"===a.declaredClass}function Ka(a){return"esri.renderers.PieChartRenderer"===a.declaredClass}function Fa(a){return"esri.layers.SubtypeGroupLayer"===a.declaredClass}function Pa(a){return"esri.layers.MapImageLayer"===a.declaredClass}function Ya(a){a="authoringInfo"in a?a?.authoringInfo:null;return"univariate-color-size"===a?.type&&"above-and-below"===
a?.univariateTheme}async function ya(a,p){const B=await da.fetchMessageBundle("esri/widgets/Legend/t9n/Legend");"previewTemplateAriaLabel"!==a||p||(a="previewAriaLabel");return ca.substitute(B[a],{label:p})}const La=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,Za=new v.JSONMap({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),Ma=new V({size:6,outline:{color:[128,128,128,.5],width:.5}}),
$a=new ba({style:"solid"}),ab=new V({style:"path",path:"M10,5 L5,0 0,5 M5,0 L5,15",size:15,outline:{width:1,color:[85,85,85,1]}});let Ba={};C=class extends z{constructor(a){super(a);this._hasSizeRamp=this._hasOpacityRamp=this._hasColorRamp=!1;this._webStyleSymbolCache=new Map;this._dotDensityUrlCache=new Map;this._scaleDrivenSizeVariable=null;this._hasClusterSizeVariable=!1;this.children=new F;this.layer=this.layerView=null;this.legendElements=[];this.parent=null;this.keepCacheOnDestroy=this.hideLayersNotInCurrentView=
!1;this.respectLayerVisibility=!0;this.sublayerIds=[];this.view=this.title=null}initialize(){const a=()=>this.notifyChange("ready");this.addHandles([l.on(()=>this.children,"change",p=>{const {added:B,removed:K}=p;B.forEach(O=>{const S=`activeLayerInfo-ready-watcher-${O.layer.uid}`;this.addHandles(l.watch(()=>O.ready,a,l.initial),S)});K.forEach(O=>this.removeHandles(O.layer.uid));a()})]);this.keepCacheOnDestroy||(Ba={})}destroy(){this._scaleDrivenSizeVariable=this._dotDensityUrlCache=this._webStyleSymbolCache=
null;this.keepCacheOnDestroy||(Ba=null)}get effectList(){const a=this.layer;let p=null;"effect"in a&&a.effect&&(p=new J.EffectView,p.effect=a.effect,p.endTransitions(),p.scale=this.scale);return p}get opacity(){const a=this.layer.opacity,p=this.parent?.opacity;var B=this.layer.parent;B=B&&"uid"in B?this._getParentLayerOpacity(B):null;return null!=p?p*a:null!=B?B*a:a}get ready(){return null===this.layer?!0:0<this.children.length?this._isGroupActive():0<this.legendElements.length}get scale(){return this.view?.scale??
0}get isScaleDriven(){const a=this.layer;if(null===a)return!1;if("effect"in a&&a.effect&&Array.isArray(a.effect))return!0;if("featureReduction"in a&&a.featureReduction){if("cluster"===a.featureReduction.type)return!0;if("binning"===a.featureReduction.type&&"renderer"in a.featureReduction&&a.featureReduction.renderer)return this._isRendererScaleDriven(a.featureReduction.renderer)}return"renderer"in a&&a.renderer?this._isRendererScaleDriven(a.renderer):this._isLayerScaleDriven(this.layer)}get version(){return this._get("version")+
1}async buildLegendElementsForFeatureCollections(a){if(this.hideLayersNotInCurrentView&&!await this._isLayerInCurrentView())this.legendElements=[],this.notifyChange("ready");else{a=Array.from(a,p=>{if(G.isFeatureLayer(p))return this._getRendererLegendElements(p.renderer,{title:p.title});if(p.featureSet?.features.length){var B=p.layerDefinition,K=B?.drawingInfo;K=K&&M.fromJSON(K.renderer);B=Za.read(B.geometryType);return K?this._getRendererLegendElements(K,{title:p.name,geometryType:B}):(b.getLogger(this).warn("drawingInfo not available!"),
null)}return null});try{const p=[],B=await Promise.allSettled(a);for(const K of B)if("fulfilled"===K.status)for(const O of K.value??[])p.push(O);this.legendElements=p;this.notifyChange("ready")}catch(p){b.getLogger(this).warn("error while building legend for layer!",p)}}}async buildLegendElementsForRenderer(a){try{this.legendElements=(this.hideLayersNotInCurrentView?await this._isLayerInCurrentView():1)?await this._getRendererLegendElements(a):[],this.notifyChange("ready")}catch(p){b.getLogger(this).warn("error while building legend for layer!",
p)}}async buildLegendElementsForFeatureReduction(a){try{this.legendElements=(this.hideLayersNotInCurrentView?await this._isLayerInCurrentView():1)?await this._getLegendElementsForFeatureReduction(a):[],this.notifyChange("ready")}catch(p){b.getLogger(this).warn("error while building legend for layer!",p)}}async buildLegendElementsForTools(){const a=this.layer;if("esri.layers.VoxelLayer"===a.declaredClass)this._constructLegendElementsForVoxellayer();else if("esri.layers.WMTSLayer"===a.declaredClass)this._constructLegendElementsForWMTSlayer();
else if("esri.layers.WMSLayer"===a.declaredClass)await this._constructLegendElementsForWMSSublayers();else if("esri.layers.BuildingSceneLayer"===a.declaredClass)await this._constructLegendElementsForBuildingSceneLayer();else if(Pa(a)||"esri.layers.TileLayer"===a.declaredClass||Fa(a))await this._constructLegendElementsForSublayers();else{this.removeHandles("imageryLayers-watcher");var p="default";if("esri.layers.ImageryLayer"===a.declaredClass){p=a?.rasterFunction?.functionName||"default";const B=
a.bandIds?.length?a.bandIds.join(""):"###";p=p+"_"+B}await this._getLegendLayers(`${a.uid}-${p}`).then(async B=>{this.legendElements=[];this.notifyChange("ready");B=B.map(async K=>{if("esri.layers.ImageryLayer"===a.declaredClass||"esri.layers.ImageryTileLayer"===a.declaredClass){const O=l.watch(()=>["renderingRule"in a&&a.rasterFunction,a.bandIds],()=>k.debounce(async()=>{Ba["default"]=null;a.renderer?await this.buildLegendElementsForRenderer(a.renderer):await this.buildLegendElementsForTools()})());
this.addHandles(O,"imageryLayers-watcher")}(K=this._generateSymbolTableElementForLegendLayer(K))&&K.infos.length&&("esri.layers.ImageryLayer"===a.declaredClass&&(K.title=a.title),this.legendElements.push(K));this.notifyChange("ready")});await Promise.allSettled(B)}).catch(B=>{b.getLogger(this).warn("Request to server for legend has failed!",B)})}}async _isLayerInCurrentView(){const a=this.layer,p=this.layerView,B=p&&"createQuery"in p&&"queryFeatureCount"in p;if(!(B||p&&"createQuery"in a&&"queryFeatureCount"in
a))return!0;await l.whenOnce(()=>!p.updating);const K=B?"createQuery"in p&&p.createQuery():"createQuery"in a&&a.createQuery();if(!K)return!0;K.geometry=this.view.extent;return 0!==(B?"queryFeatureCount"in p&&await p.queryFeatureCount(K):"queryFeatureCount"in a&&await a.queryFeatureCount(K))}_getParentLayerOpacity(a){let p=1;const B=a.parent;B&&"uid"in B&&(p=this._getParentLayerOpacity(B));return a.opacity*p}_isGroupActive(){const a=this.children;return a.length?a.some(p=>p.ready):!1}_isRendererScaleDriven(a){return"dot-density"===
a.type||La.test("valueExpression"in a?a.valueExpression:null)||("visualVariables"in a?a.visualVariables:null)?.some(p=>this._isScaleDrivenSizeVariable(p))?!0:this._hasScaleDrivenSymbols(a)}_hasScaleDrivenSymbols(a){switch(a.type){case "simple":return this._isScaleDrivenSymbol(a.symbol);case "class-breaks":return this._isScaleDrivenSymbol(a.defaultSymbol)||a.classBreakInfos.some(p=>this._isScaleDrivenSymbol(p.symbol));case "unique-value":return this._isScaleDrivenSymbol(a.defaultSymbol)||!!a.uniqueValueInfos?.some(p=>
this._isScaleDrivenSymbol(p.symbol))}return!1}_isScaleDrivenSymbol(a){if("cim"===a?.type){const {primitiveOverrides:p,minScale:B,maxScale:K}=a.data;a=p?.some(O=>/\$view\.scale/.test(O.valueExpressionInfo?.expression||""))??!1;return null!=B||null!=K||a}return!1}_isScaleDrivenSizeVariable(a){if(a&&"size"!==a.type)return!1;const p=a.minSize,B=a.maxSize;return"object"===typeof p&&p&&this._isScaleDrivenSizeVariable(p)||"object"===typeof B&&B&&this._isScaleDrivenSizeVariable(B)?!0:!!a.expression||La.test(a.valueExpression)}_isLayerScaleDriven(a){if("minScale"in
a&&0<a.minScale||"maxScale"in a&&0<a.maxScale)return!0;if("sublayers"in a&&a.sublayers)return a.sublayers.some(B=>this._isLayerScaleDriven(B));const p=a.parent;if(!1===a.loaded&&p&&Pa(p)&&"source"in a&&a.source&&"map-layer"===a.source.type)for(const B of p.sourceJSON.layers??[])if(B.id===a.source.mapLayerId&&(0<B.minScale||0<B.maxScale))return!0;return!1}async _constructLegendElementsForVoxellayer(){this.legendElements=[];this.removeHandles("voxel-style-watcher");this.removeHandles("voxel-current-variable");
const a=this.layer;this.addHandles(l.watch(()=>a.currentVariableId,()=>this._constructLegendElementsForVoxellayer()),"voxel-current-variable");this.addHandles(l.watch(()=>a.getVariableStyles(),()=>this._constructLegendElementsForVoxellayer()),"voxel-style-watcher");var p=a.getVariableStyle(null);const B=[];if(p)if(p.uniqueValues?.length){const O=[];p.uniqueValues.forEach(S=>{S.enabled&&O.push({label:S.label||`${S.value}`,value:S.value,symbol:new ba({color:S.color,outline:null})})});O.length&&B.push({type:"symbol-table",
title:p.label,infos:O})}else if(p.transferFunction){const {colorStops:O,stretchRange:S}=p.transferFunction,Y=O.toArray().reverse(),ea=S.map((ka,ha)=>`${0===ha?X.specialCharsLessThan:X.specialCharsGreaterThan} ${la.formatNumberLabel(ka)}`).reverse(),qa=Y.map(ka=>({color:ka.color,value:null,label:null}));qa[0].label=ea[0];qa[qa.length-1].label=ea[1];B.push({type:"color-ramp",title:p.label,infos:qa,preview:n.renderColorRampPreviewHTML(Y.map(ka=>ka.color),{ariaLabel:await ya("previewColorRampAriaLabel")})})}const K=
a.opacity;p=B.reduce((O,S)=>[...O,...this._getAllInfos(S)],[]).filter(O=>!!O?.symbol).map(O=>this._getSymbolPreview(O,K));await Promise.allSettled(p);this.legendElements=B;this.notifyChange("ready")}_constructLegendElementsForWMTSlayer(){this.legendElements=[];this.removeHandles("wmts-activeLayer-watcher");const a=this.layer.activeLayer;this.addHandles(l.watch(()=>{const {layer:p}=this;return p&&"activeLayer"in p&&p.activeLayer},()=>this._constructLegendElementsForWMTSlayer()),"wmts-activeLayer-watcher");
if(a.styleId&&a.styles){let p=null;a.styles.some(B=>a.styleId===B.id?(p=B.legendUrl,!0):!1);p&&(this.legendElements=[{type:"symbol-table",title:a.title,infos:[{src:p,opacity:this.opacity}]}])}this.notifyChange("ready")}async _constructLegendElementsForWMSSublayers(){this.legendElements=[];this.removeHandles("wms-sublayers-watcher");const a=this.layer;let p=null;if(a.customParameters||a.customLayerParameters)p={...a.customParameters,...a.customLayerParameters};this.addHandles(l.watch(()=>{const {layer:B}=
this;return B&&"sublayers"in B&&B.sublayers},()=>this._constructLegendElementsForWMSSublayers()),"wms-sublayers-watcher");this.legendElements=await this._generateLegendElementsForWMSSublayers(a.sublayers,p);this.notifyChange("ready")}async _generateLegendElementsForWMSSublayers(a,p){const B=[];this.addHandles(a.on("change",()=>this._constructLegendElementsForWMSSublayers()),"wms-sublayers-watcher");a=a.toArray();for(const K of a)if(a=l.watch(()=>[K.title,K.visible,K.legendEnabled],()=>this._constructLegendElementsForWMSSublayers()),
this.addHandles(a,"wms-sublayers-watcher"),!this.respectLayerVisibility||K.visible&&K.legendEnabled)a=await this._generateSymbolTableElementForWMSSublayer(K,p),a?.infos.length&&B.unshift(a);return B}async _generateSymbolTableElementForWMSSublayer(a,p){return!a.legendUrl&&a.sublayers?(p=(await this._generateLegendElementsForWMSSublayers(a.sublayers,p)).filter(B=>B),{type:"symbol-table",title:a.title,infos:p}):this._generateSymbolTableElementForLegendUrl(a,p)}async _generateSymbolTableElementForLegendUrl(a,
p){let B=a.legendUrl;if(B){var K={type:"symbol-table",title:a.title||a.name||String(a.id??""),infos:[]};p&&(B=c.addQueryParameters(B,p));p=null;a=a.layer?.opacity;try{if(p=(await I(B,{responseType:"image"})).data)p.style.opacity=a}catch{}K.infos.push({src:B,preview:p,opacity:a});return K}}_getLegendLayers(a,p){const B=Ba&&Ba[a];return B?Promise.resolve(B):this._legendRequest(p).then(K=>{K=K.layers;return Ba[a]=K})}_legendRequest(a){var p=this.layer;a={f:"json",dynamicLayers:a};if("esri.layers.ImageryLayer"===
p.declaredClass){var B=p.exportImageServiceParameters.rasterFunction;B&&(a.renderingRule=JSON.stringify(B.functionDefinition?.toJSON()||B.toJSON()));p.bandIds&&(a.bandIds=p.bandIds.join());if(p.raster||p.viewId||p.customParameters){const {raster:K,viewId:O,customParameters:S}=p;a={raster:K,viewId:O,...a,...S}}}B=p.url.replace(/(\/)+$/,"");"version"in p&&10.01<=+p.version?(p=B.indexOf("?"),B=-1<p?B.substring(0,p)+"/legend"+B.substring(p):B+"/legend"):(p=B.toLowerCase().indexOf("/rest/"),p=B.substring(0,
p)+B.substring(p+5,B.length),B="https://utility.arcgis.com/sharing/tools/legend?soapUrl\x3d"+encodeURI(p)+"\x26returnbytes\x3dtrue");return I(B,{query:a}).then(K=>K.data)}async _constructLegendElementsForBuildingSceneLayer(){this.legendElements=[];this.removeHandles("sublayers-watcher");const a=this.layer;this.addHandles(l.watch(()=>a.sublayers,()=>this._constructLegendElementsForBuildingSceneLayer()),"sublayers-watcher");try{this.legendElements=await this._generateLegendElementsForBuildingSublayers(a.sublayers,
this.opacity),this.notifyChange("ready")}catch(p){b.getLogger(this).warn("Request to server for legend has failed!",p)}}async _generateLegendElementsForBuildingSublayers(a,p){let B=[];this.addHandles(a.on("change",()=>this._constructLegendElementsForBuildingSceneLayer()),"sublayers-watcher");a=a.toArray();for(const O of a)if(a=l.watch(()=>["renderer"in O&&O.renderer,O.opacity,O.title,O.visible],()=>this._constructLegendElementsForBuildingSceneLayer()),this.addHandles(a,"sublayers-watcher"),!this.respectLayerVisibility||
O.visible){a=null!=O?.opacity?O.opacity:null;var K=null!=a?a*p:p;"building-group"===O.type?(a={type:"symbol-table",title:O.title,infos:[]},K=await this._generateLegendElementsForBuildingSublayers(O.sublayers,K),a.infos.push(...K),B=[a,...B]):O.renderer&&(B=[...(await this._getRendererLegendElements(O.renderer,{title:O.title,opacity:K,sublayer:O})),...B])}return B.filter(O=>!!O&&("infos"in O&&O.infos?0<O.infos.length:!0))}async _constructLegendElementsForSublayers(){this.legendElements=[];this.removeHandles("sublayers-watcher");
const a=this.layer;if(Pa(a)||"esri.layers.TileLayer"===a.declaredClass||Fa(a)){this.addHandles(l.watch(()=>a.sublayers,()=>this._constructLegendElementsForSublayers),"sublayers-watcher");try{this.legendElements=await this._generateLegendElementsForSublayers(a.sublayers,this.opacity),this.notifyChange("ready")}catch(p){b.getLogger(this).warn("Request to server for legend has failed!",p)}}}async _generateLegendElementsForSublayers(a,p,B){const K=this.layer;let O=[];this.addHandles(a.on("change",()=>
this._constructLegendElementsForSublayers()),"sublayers-watcher");a=a.toArray();!B&&this.sublayerIds&&this.sublayerIds.length&&(a=Fa(K)?this.sublayerIds.map(S=>K.findSublayerForSubtypeCode(S)).filter(Q.isSome):this.sublayerIds.map(S=>K.findSublayerById(S)).filter(Q.isSome));for(const S of a)if(a=l.watch(()=>[S.renderer,S.opacity,S.title,S.visible,S.legendEnabled],()=>this._constructLegendElementsForSublayers()),this.addHandles(a,"sublayers-watcher"),!this.respectLayerVisibility||S.visible&&S.legendEnabled&&
this._isSublayerInScale(S)){a=null!=S?.opacity?S.opacity:null;a=null!=a?a*p:p;const Y="sublayers"in S?S.originIdOf("renderer")>H.OriginId.SERVICE&&!S.sublayers:!0;S.renderer&&Y?(await S.load(),O=[...(await this._getRendererLegendElements(S.renderer,{title:S.title,opacity:a,sublayer:S})),...O]):"sublayers"in S&&(a=await this._generateSymbolTableElementForSublayer(S,a,B))&&O.unshift(a)}return O.filter(S=>!!S&&("infos"in S&&S.infos?0<S.infos.length:!0))}async _generateSymbolTableElementForSublayer(a,
p,B){if(!B){B=new Map;var K=this.layer,O=a.source;let S=null;if(O&&("map-layer"!==O.type||O.mapLayerId!==a.id||O.gdbVersion&&O.gdbVersion!==("gdbVersion"in K&&K.gdbVersion))||a.originIdOf("renderer")>H.OriginId.SERVICE||a.originIdOf("labelingInfo")>H.OriginId.SERVICE||a.originIdOf("labelsVisible")>H.OriginId.SERVICE)O=new d.ExportImageParameters({layer:this.layer}),S=O.hasDynamicLayers?O.dynamicLayers:null,O.destroy();(await this._getLegendLayers(S||`${K.uid}-default`,S)).forEach(Y=>B.set(Y.layerId,
Y))}K=B.get(a.id);return(!K||K?.subLayerIds&&K.defaultVisibility)&&a.sublayers?(p=await this._generateLegendElementsForSublayers(a.sublayers,p,B),{type:"symbol-table",title:a.title,infos:p}):this._generateSymbolTableElementForLegendLayer(K,a,p)}_generateSymbolTableElementForLegendLayer(a,p,B){if(!a?.legend||this.respectLayerVisibility&&!this._isLegendLayerInScale(a,p))return null;var K=p?.renderer;let O=p?.title||a.layerName;K&&(!p||p?.originIdOf("renderer")>H.OriginId.SERVICE)&&(K=p?.title||this._getRendererTitle(K,
p))&&(O&&"string"!==typeof K&&"title"in K&&(K.title=O),O=K);const S={type:"symbol-table",title:O,legendType:a.legendType||null,infos:[]},Y=p?this._sanitizeLegendForSublayer(a.legend.slice(),p):a.legend;a.legendGroups&&0<a.legendGroups.length?a.legendGroups.forEach(ea=>{const qa={type:"symbol-table",title:ea.heading,legendType:a.legendType||null,infos:this._generateSymbolTableElementInfosForLegendLayer(Y.filter(ka=>ka.groupId===ea.id),a.layerId,B)};0<qa.infos?.length&&S.infos.push(qa)}):S.infos=this._generateSymbolTableElementInfosForLegendLayer(Y,
a.layerId,B);return 0<S.infos.length?S:null}_generateSymbolTableElementInfosForLegendLayer(a,p,B){return a.map(K=>{let O=K.url;if(K.imageData&&0<K.imageData.length)O=`data:image/png;base64,${K.imageData}`;else if(0!==O.indexOf("http"))O=u.addTokenParameter(`${this.layer.url}/${p}/images/${O}`);else return null;return{label:K.label,src:O,opacity:null==B?this.opacity:B,width:K.width,height:K.height}}).filter(Q.isSome)}_isSublayerInScale(a){const p=a.minScale||0;a=a.maxScale||0;return 0<p&&p<this.scale||
a>this.scale?!1:!0}_isLegendLayerInScale(a,p){p=p||this.layer;let B=null,K=null,O=!0;!p.minScale&&0!==p.minScale||!p.maxScale&&0!==p.maxScale?(0===a.minScale&&p.tileInfo&&(B=p.tileInfo.lods[0].scale),0===a.maxScale&&p.tileInfo&&(K=p.tileInfo.lods[p.tileInfo.lods.length-1].scale)):(B=Math.min(p.minScale,a.minScale)||p.minScale||a.minScale,K=Math.max(p.maxScale,a.maxScale));if(0<B&&B<this.scale||K>this.scale)O=!1;return O}_sanitizeLegendForSublayer(a,p){if("version"in this.layer&&10.1>+this.layer.version||
0===a.length)return a;p=p.renderer;let B=0,K=null;a.some(O=>O.values)&&a.some((O,S)=>{O.values||(B=S,K=O,K.label||(K.label="others"));return null!=K});p?"unique-value"===p.type?K&&(a.splice(B,1),a.push(K)):"class-breaks"===p.type&&(K&&a.splice(B,1),a.reverse(),K&&a.push(K)):K&&(a.splice(B,1),a.push(K));return a}async _getRendererLegendElements(a,p={}){var B=this.view;B=ma(a)||oa(a)||sa(a)||ua(a)||Aa(a)||Ka(a)?"2d"===B.type||L.isSupportedRenderer3D(a):"raster-stretch"===a.type||"raster-colormap"===
a.type||"raster-shaded-relief"===a.type||xa(a)||wa(a)||Ea(a)||"vector-field"===a.type||"flow"===a.type;if(!B)return b.getLogger(this).warn(`Renderer of type '${a.type}' not supported!`),[];if(xa(a)||wa(a)||Ea(a)||"esri.renderers.PointCloudRGBRenderer"===a.declaredClass)return this._constructPointCloudRendererLegendElements(a,p);if(Aa(a))return this._constructDotDensityRendererLegendElements(a);a=await this._loadRenderer(a);return Ka(a)?this._constructPieChartRendererLegendElements(a):this._constructRendererLegendElements(a,
p)}async _getLegendElementsForFeatureReduction(a){let p=null;"binning"===a.type?p=a.renderer:"cluster"===a.type&&(p=this._getClusterRenderer(a));return p?this._getRendererLegendElements(p):[]}_getPointCloudRendererTitle(a){return(a.legendOptions?.title||a.field)??""}async _constructPointCloudRendererLegendElements(a,p={}){var B=p.title;p=[];let K=null;var O=null;if(xa(a))K={type:"symbol-table",title:B||this._getPointCloudRendererTitle(a),infos:[]},a.colorClassBreakInfos.forEach(S=>{K.infos.unshift({label:S.label||
S.minValue+" - "+S.maxValue,value:[S.minValue,S.maxValue],symbol:this._getAppliedCloneSymbol(Ma,S.color)})});else if(wa(a)){O=a.stops;let S=null;if(O?.length&&(1===O.length&&(S=O[0].color),!S)){const Y=O[0].value,ea=O[O.length-1].value;null!=Y&&null!=ea&&(S=U.getColorFromPointCloudStops(Y+(ea-Y)/2,O))}K={type:"symbol-table",title:null,infos:[{label:null,value:null,symbol:this._getAppliedCloneSymbol(Ma,S||Ma.color)}]};O=U.getRampStopsForPointCloud(a.stops??[])??[];O={type:"color-ramp",title:B||this._getPointCloudRendererTitle(a),
infos:O,preview:n.renderColorRampPreviewHTML(O.map(Y=>Y.color),{ariaLabel:await ya("previewColorRampAriaLabel")})}}else Ea(a)&&(K={type:"symbol-table",title:B||this._getPointCloudRendererTitle(a),infos:[]},a.colorUniqueValueInfos?.forEach(S=>{K.infos.push({label:S.label||S.values.join(", "),value:S.values.join(", "),symbol:this._getAppliedCloneSymbol(Ma,S.color)})}));K&&K.infos.length&&p.push(K);O&&O.infos.length&&p.push(O);B=p.reduce((S,Y)=>[...S,...(Y.infos??[])],[]).filter(S=>!!S.symbol).map(S=>
this._getSymbolPreview(S,this.opacity,{symbolConfig:{applyColorModulation:!!a.colorModulation}}));await Promise.allSettled(B);return p}async _getElementInfoForDotDensity(a,p){const {color:B,label:K,valueExpressionTitle:O}=p,{backgroundColor:S,outline:Y,dotSize:ea}=a;p=this.effectList?.effects.map(ha=>ha.toJSON());var qa=f.effectFunctionsFromJSON(p);p=await ya("previewTemplateAriaLabel",K||O);qa=ea+"-"+B+"-"+S+"-"+(Y&&JSON.stringify(Y.toJSON()))+"-"+qa;const ka=this._dotDensityUrlCache;a=ka.has(qa)?
ka.get(qa):n.renderDotDensityPreviewHTML(a,B,{ariaLabel:p});ka.set(qa,a);p=w.renderSymbol([[{shape:{type:"image",x:0,y:0,width:a.width,height:a.height,src:a.src},fill:null,stroke:null,offset:[0,0]}]],[a.width,a.height],{effectView:this.effectList,ariaLabel:p});return{opacity:1,src:a.src,preview:p,width:a.width,height:a.height}}async _constructDotDensityRendererLegendElements(a){var p=a.calculateDotValue(this.view.scale);p={type:"symbol-table",title:{value:p&&Math.round(p),unit:a.legendOptions?.unit||
""},infos:[]};for(const B of a.attributes){const K=await this._getElementInfoForDotDensity(a,B);K.label=B.label||B.valueExpressionTitle||B.field;p.infos.push(K)}return[p]}async _constructPieChartRendererLegendElements(a){const p=this.layer.opacity,B=[];let K=null;const O=a.outline;a.attributes.forEach(ea=>{const qa=new V({color:ea.color,outline:O});B.push({label:ea.label||ea.valueExpressionTitle||ea.field,symbol:qa})});var S=B.length?[...B]:[];if(a.othersCategory?.color&&0!==a.othersCategory?.threshold){var Y=
new V({color:a.othersCategory.color,outline:O});K=a.othersCategory.label||"Other";B.push({label:K,symbol:Y})}a.defaultColor?.a&&(Y=new V({color:a.defaultColor,outline:O}),B.push({label:a.defaultLabel,symbol:Y}));Y=await this._getVisualVariableLegendElements(a,this.layer)||[];B.length&&(Y.unshift({type:"symbol-table",title:null,infos:B}),S=S.filter(ea=>ea.label!==K).map(ea=>ea.symbol.color).filter(Boolean),S=n.renderPieChartPreviewHTML(S,{holePercentage:a.holePercentage,backgroundColor:a.backgroundFillSymbol?.color,
effectList:this.effectList,outline:O,ariaLabel:await ya("previewPieChartAriaLabel")}),Y.unshift({type:"pie-chart-ramp",title:this._getRendererTitle(a,this.layer),infos:B,preview:S}));a=Y.reduce((ea,qa)=>[...ea,...this._getAllInfos(qa)],[]).filter(ea=>!!ea?.symbol&&!ea?.preview).map(ea=>this._getSymbolPreview(ea,p,{effectList:this.effectList}));await Promise.allSettled(a);return Y}async _constructRendererLegendElements(a,p={}){const {title:B,sublayer:K}=p,O=K||this.layer;this._hasSizeRamp=this._hasOpacityRamp=
this._hasColorRamp=!1;this._scaleDrivenSizeVariable=null;const S=await this._getVisualVariableLegendElements(a,O)||[],Y={type:"symbol-table",title:B||this._getRendererTitle(a,O),infos:[]};let ea=null,qa=!1;const ka=new Set;if("flow"!==a.type||this._hasSizeRamp)if("univariate-color-size"===("authoringInfo"in a?a?.authoringInfo:null)?.type){var ha=B,pa=Ya(a)?"univariate-above-and-below-ramp":"univariate-color-size-ramp",ra=S.findIndex(ia=>"color-ramp"===ia.type);ra=-1!==ra?S.splice(ra,1)[0]:null;var na=
S.findIndex(ia=>"size-ramp"===ia.type);na=-1!==na?S.splice(na,1)[0]:null;var va=[];ra&&(ha=ra.title,va.push(ra));na&&(ha=na.title,va.push(na));0<va.length&&S.push({type:pa,title:ha,infos:va})}else if(ua(a))ha=aa.getHeatmapRampStops(a),S.push({type:"heatmap-ramp",title:B||this._getRendererTitle(a,O),infos:ha,preview:n.renderColorRampPreviewHTML(ha.map(ia=>ia.color),{effectList:this.effectList,ariaLabel:await ya("previewColorRampAriaLabel")})});else if(sa(a)){if((pa=a&&a.authoringInfo)&&"relationship"===
pa.type){const {numClasses:ia,field1:ta,field2:za}=pa;pa=pa.focus;if(ia&&ta&&za){na=[ta,za];ra=fa.getRotationAngleForFocus(pa)||0;for(ha of na){const {field:Qa,normalizationField:Ga,label:Na}=ha;na=Na||{field:this._getFieldAlias(Qa,O),normField:Ga&&this._getFieldAlias(Ga,O)};va=ab.clone();va.angle=ra;Y.infos.push({label:na,symbol:va});ka.add(va);ra+=90}ha=fa.getRelationshipRampElement({focus:pa,numClasses:ia,infos:a.uniqueValueInfos??[]});S.unshift(ha)}}else if("esri.layers.ImageryLayer"===this.layer.declaredClass||
"esri.layers.ImageryTileLayer"===this.layer.declaredClass)a.uniqueValueInfos?.forEach(ia=>{ia.symbol&&Y.infos.push({label:ia.label||ia.value,value:ia.value,symbol:ia.symbol})});else{const {field:ia,field2:ta,field3:za,fieldDelimiter:Qa,valueExpression:Ga,defaultSymbol:Na}=a,bb=!(!ia&&!Ga||!ta&&!za),Ca=[];a.uniqueValueGroups?.forEach(Ta=>{const Ra={type:"symbol-table",title:Ta.heading,infos:[]};Ta.classes?.forEach(Da=>{const {symbol:Ua,values:cb}=Da;if(Ua){var Ha=[],Ia=[];for(const db of cb??[]){const {value:Va,
value2:Wa,value3:Xa}=db,Ja=[],Oa=[];if(ia||Ga)Ja.push(Va),Oa.push(this._getDomainName(ia,Va,O));ta&&(Ja.push(Wa),Oa.push(this._getDomainName(ta,Wa,O)));za&&(Ja.push(Xa),Oa.push(this._getDomainName(za,Xa,O)));Ha.push(bb?Ja.join(Qa||""):Ja[0]);Ia.push(Oa.join(" - "))}Ha=Ha.join(", ");Da=Da.label;Da||(Ia=Ia.filter(Boolean),Da=Ia.length?Ia.join(", "):Ha);Ra.infos.push({label:Da,value:Ha,symbol:Ua})}});Ra.infos.length&&Ca.push(Ra)});Ca.length&&(ha=Ca[0],1===Ca.length&&"title"in ha&&!ha.title?Y.infos.push(...(ha.infos??
[])):(Na&&(Ca.push({type:"symbol-table",infos:[{label:a.defaultLabel||"others",symbol:Na}]}),qa=!0),Y.infos.push(...Ca)),B||a.legendOptions?.title||a.valueExpressionTitle||(Y.title=null))}a.defaultSymbol&&!qa&&(Y.infos.push({label:a.defaultLabel||"others",symbol:a.defaultSymbol}),qa=!0)}else if(oa(a))ea=this._isUnclassedRenderer(a),ea&&this._hasSizeRamp||(a.classBreakInfos.forEach(ia=>{ia.symbol&&Y.infos.unshift({label:ia.label||(ea?null:ia.minValue+" - "+ia.maxValue),value:[ia.minValue,ia.maxValue],
symbol:ia.symbol})}),ea&&(Y.title=null),this._updateInfosforClassedSizeRenderer(a,Y.infos)),a.defaultSymbol&&!ea&&(Y.infos.push({label:a.defaultLabel||"others",symbol:a.defaultSymbol}),qa=!0);else if("raster-stretch"===a.type)if("esri.layers.ImageryTileLayer"===this.layer.declaredClass||"esri.layers.WCSLayer"===this.layer.declaredClass)ha=await this._constructTileImageryStretchRendererElements(a),"stretch-ramp"===ha.type?S.push(ha):Y.infos=ha;else{ha=this.layer;a.statistics?.length&&(ra=a.statistics[0],
X.isRasterBandStatistics(ra)?(pa=ra.min,ra=ra.max):[pa,ra]=ra);na=[];na=ha.serviceRasterInfo;if(ha.rasterFunction)try{na=await ha.generateRasterInfo(ha.rasterFunction)}catch{}va=y.getPixelValueRange(na.pixelType);if(1===na.bandCount)ha=ha.bandIds?.[0]||0,pa=null!=pa?pa:na.statistics?na.statistics[ha].min:va[0],ra=null!=ra?ra:na.statistics?na.statistics[ha].max:va[1],pa||ra?S.push(await this._getStretchLegendElements(a,{min:pa,max:ra})):this._getServerSideLegend();else if(ha.bandIds&&1===ha.bandIds.length)pa=
null!=pa?pa:na.statistics?na.statistics[ha.bandIds[0]].min:va[0],ra=null!=ra?ra:na.statistics?na.statistics[ha.bandIds[0]].max:va[1],pa||ra?S.push(await this._getStretchLegendElements(a,{min:pa,max:ra})):this._getServerSideLegend();else if(3<=na.bandCount){const {bandInfos:ia}=na;({bandIds:pa}=ha);ia.length>=na.bandCount?3===pa?.length?(na=pa.map(ta=>ia[ta].name),Y.infos=this._createSymbolTableElementMultiBand(na)):"lerc"===ha.format?(na=[0,1,2].map(ta=>ia[ta].name),Y.infos=this._createSymbolTableElementMultiBand(na)):
this._getServerSideLegend():"lerc"===ha.format?(na=["band1","band2","band3"],Y.infos=this._createSymbolTableElementMultiBand(na)):this._getServerSideLegend()}else this._getServerSideLegend()}else if("raster-colormap"===a.type)a.colormapInfos.forEach(ia=>{Y.infos.push({label:ia.label,value:ia.value,symbol:this._getAppliedCloneSymbol($a,ia.color)})});else if(ma(a)){ha=a.symbol;switch(p.geometryType){case "point":ha="pointSymbol"in O?O.pointSymbol:null;break;case "polyline":ha="lineSymbol"in O?O.lineSymbol:
null;break;case "polygon":ha="polygonSymbol"in O?O.polygonSymbol:null}pa=this._hasClusterSizeVariable&&this._getClusterSymbol()||!this._hasSizeRamp;a.symbol&&pa&&Y.infos.push({label:a.label,symbol:ha})}else"vector-field"===a.type?(a.outputUnit&&(this.title="("+a.toJSON().outputUnit+")"),Y.title=a.attributeField,ha=a.getClassBreakInfos(),ha?.length?ha.forEach(ia=>{Y.infos.push({label:ia.minValue+" - "+ia.maxValue,symbol:ia.symbol})}):Y.infos.push({label:a.attributeField,symbol:a.getDefaultSymbol()})):
"raster-shaded-relief"===a.type&&S.push(await this._getStretchLegendElements(a,{min:0,max:255}));else ha=await X.getSymbolForFlowRenderer(a),Y.infos.push({label:null,symbol:ha});const Sa=a.defaultSymbol;!Sa||qa||ma(a)||ea&&!this._hasColorRamp&&!this._hasSizeRamp&&!this._hasOpacityRamp||S.push({type:"symbol-table",infos:[{label:a.defaultLabel||"others",symbol:Sa}]});Y.infos.length&&S.unshift(Y);const eb=null==p.opacity?this.opacity:p.opacity,fb=this._isTallSymbol("visualVariables"in a?a.visualVariables:
null),gb="esri.layers.ImageryLayer"===this.layer.declaredClass||"esri.layers.ImageryTileLayer"===this.layer.declaredClass;p=S.reduce((ia,ta)=>[...ia,...this._getAllInfos(ta)],[]).filter(ia=>!!ia?.symbol).filter(ia=>{if("cim"===ia.symbol.type){const {minScale:ta,maxScale:za}=ia.symbol.data;if(ta&&ta<this.scale||za&&za>this.scale)return!1}return!0}).map(ia=>this._getSymbolPreview(ia,eb,{isDefault:ia.symbol===Sa,applyScaleDrivenSize:!ka.has(ia.symbol),symbolConfig:{isTall:fb,isSquareFill:gb},effectList:ka.has(ia.symbol)?
null:this.effectList}));a=null;await Promise.allSettled(p);return S}_getServerSideLegend(){setTimeout(()=>this.buildLegendElementsForTools(),0)}_getAllInfos(a){const p=a?.infos;return p?p.reduce((B,K)=>B.concat(this._getAllInfos(K)),[]):[a]}async _constructTileImageryStretchRendererElements(a){const p=this.layer,B=p.symbolizer.rasterInfo??p.raster.rasterInfo;var K;if(K=a?.statistics?.length?a.statistics:B?.statistics){var O=K[0];X.isRasterBandStatistics(O)?(K=O.min,O=O.max):[K,O]=O}else O=y.getPixelValueRange(B.pixelType),
K=O[0],O=O[1];p.hasStandardTime()&&(K=p.getStandardTimeValue(K),O=p.getStandardTimeValue(O));if(1===B.bandCount||1===p.bandIds?.length)return this._getStretchLegendElements(a,{min:K,max:O});a=(p?.bandIds?.length?p.bandIds:Array.from(Array(Math.min(B.bandCount,3)).keys())).map(S=>B.bandInfos[S].name);3>a.length?a.push(a[1]):3<a.length&&a.splice(3);return this._createSymbolTableElementMultiBand(a)}async _getStretchLegendElements(a,p){a=U.getStrectchRampStops(a.colorRamp,p);return{type:"stretch-ramp",
title:"",infos:a,preview:n.renderColorRampPreviewHTML(a.map(B=>B.color),{ariaLabel:await ya("previewColorRampAriaLabel")})}}_getClusterSymbol(){var a=this.layer;const p=(a="featureReduction"in a&&a.featureReduction)&&"symbol"in a&&a.renderer;return p&&!0!==p?.authoringInfo?.isAutoGenerated?null:a&&"symbol"in a?a.symbol:null}async _getSizeLegendElement(a,p,B,K){return{type:"size-ramp",title:this._hasClusterSizeVariable?this._getClusterTitle(p):a,infos:await ja.getRampStops(B,p,await X.getMedianColor(B),
this.scale,this.view,K,this._hasClusterSizeVariable?this._getClusterSymbol():null)}}_createSymbolTableElementMultiBand(a){const p=[],B=["red","green","blue"];a.forEach((K,O)=>{p.push({label:{colorName:B[O],bandName:K},src:X.rgbImgSource[O],opacity:this.opacity??1})});return p}_updateInfosforClassedSizeRenderer(a,p){const B=a.authoringInfo&&"class-breaks-size"===a.authoringInfo.type,K=a.classBreakInfos.some(O=>t.isVolumetricSymbol(O.symbol));if(B&&K){const O=ja.realWorldMaxSize;a=a.classBreakInfos.length;
const S=(O-ja.realWorldMinSize)/(1<a?a-1:a);p.forEach((Y,ea)=>{Y.size=O-S*ea})}}_isTallSymbol(a){let p=!1,B=!1;if(a)for(let K=0;K<a.length&&(!p||!B);K++){const O=a[K];"size"===O.type&&("height"===O.axis&&(p=!0),"width-and-depth"===O.axis&&(B=!0))}return p&&B}async _getSymbolPreview(a,p,B){var K=!B?.isDefault&&null==a.size&&this._hasSizeRamp?h.px2pt(W.SymbolSizeDefaults.size):a.size;this._scaleDrivenSizeVariable&&B?.applyScaleDrivenSize&&({getSize:K}=await new Promise((O,S)=>q(["../../../renderers/visualVariables/support/visualVariableUtils"],
O,S)),K=K(this._scaleDrivenSizeVariable,null,{view:this.view.type,scale:this.scale,shape:"simple-marker"===a.symbol.type?a.symbol.style:null}));return n.renderPreviewHTML(a.symbol,{size:K,opacity:p,scale:!1,symbolConfig:B?.symbolConfig,effectView:B?.effectList,style:"legend",cimOptions:{allowScalingUp:!B?.isDefault&&this._hasSizeRamp||!(!this._scaleDrivenSizeVariable||!B?.applyScaleDrivenSize),viewParams:this.isScaleDriven?{viewingMode:"2d"===this.view?.type?"map":this.view?.viewingMode,scale:this.view?.scale}:
null},ariaLabel:a.label&&"string"!==typeof a.label?null:await ya("previewTemplateAriaLabel",a.label)}).then(O=>{a.preview=O;return a}).catch(()=>{a.preview=null;return a})}_getClusterRenderer(a){this._hasClusterSizeVariable=!1;var p="renderer"in this.layer?this.layer.renderer:null;p=a.renderer?.clone()||p?.clone();const B=R.getClusterSizeVariable(this.layerView._effectiveRenderer,this.view);if(B&&null!=p&&"visualVariables"in p&&!p.visualVariables?.some(K=>"size"===K.type&&"outline"!==K.target&&!La.test(K.valueExpression))){if("clusterMinSize"in
a&&"clusterMaxSize"in a){const {clusterMinSize:K,clusterMaxSize:O}=a;B.legendOptions=new N({showLegend:K!==O})}p.visualVariables=(p.visualVariables||[]).concat([B]);this._hasClusterSizeVariable=!0}return p}async _loadRenderer(a){const p=[],B=a.clone(),K=await X.getMedianColor(B);if(oa(B)||sa(B))a=(B.classBreakInfos||B.uniqueValueInfos).map(O=>this._fetchSymbol(O.symbol,K).then(S=>{O.symbol=S}).catch(()=>{O.symbol=null})),Array.prototype.push.apply(p,a);p.push(this._fetchSymbol(B.symbol||B.defaultSymbol,
B.defaultSymbol?null:K).then(O=>{this._applySymbolToRenderer(B,O,ma(B))}).catch(()=>{this._applySymbolToRenderer(B,null,ma(B))}));await Promise.allSettled(p);return B}_applySymbolToRenderer(a,p,B){B?a.symbol=p:a.defaultSymbol=p}async _fetchSymbol(a,p){if(!a)throw Error();if("web-style"===a.type){const B=this._webStyleSymbolCache;try{const K=await ("2d"===this.view.type?a.fetchCIMSymbol({cache:B}):a.fetchSymbol({cache:B}));return this._getAppliedCloneSymbol(K,p)}catch{throw b.getLogger(this).warn("Fetching web-style failed!"),
Error();}}return this._getAppliedCloneSymbol(a,p)}_getAppliedCloneSymbol(a,p){if(!a||!p)return a;a=a.clone();const B=p&&p.toRgba();a.type.includes("3d")?this._applyColorTo3dSymbol(a,B):"cim"===a.type?Z.applyCIMSymbolColor(a,p):a.color&&(a.color=new P(B||a.color));return a}_applyColorTo3dSymbol(a,p){p&&a.symbolLayers.forEach(B=>{B&&(B.material||(B.material={}),B.material.color=new P(p))})}async _getVisualVariableLegendElements(a,p){if(!("visualVariables"in a&&a.visualVariables)||"vector-field"===a.type)return null;
var B=a.visualVariables,K=[];const O=[],S=[];for(const ka of B)"color"===ka.type?K.push(ka):"size"===ka.type?O.push(ka):"opacity"===ka.type&&S.push(ka);B=[...K,...O,...S];let Y;if(0===K.length&&oa(a)&&a.classBreakInfos&&1===a.classBreakInfos.length)var ea=(ea=a.classBreakInfos[0])&&ea.symbol;0===K.length&&ma(a)&&(ea=a.symbol);ea&&(ea.type.includes("3d")?(K=ea.symbolLayers.at(0),"water"===K.type?null!=K.color&&(Y=K.color):null!=K.material?.color&&(Y=K.material.color)):ea.url||(Y=ea.color));const qa=
this.effectList;return(await Promise.all(B.map(async ka=>{if(!ka.legendOptions||!1!==ka.legendOptions.showLegend){const ha="flow"===a.type?ka.field:this._getRampTitle(ka,p);let pa=null;const ra=this._getDateFormatOptions(p,ka);"color"===ka.type?(ka=await U.getRampStops(ka,null,ra)??[],pa={type:"color-ramp",title:ha,infos:ka,preview:n.renderColorRampPreviewHTML(ka.map(na=>na.color),{effectList:qa,ariaLabel:await ya("previewColorRampAriaLabel")})},this._hasColorRamp||(this._hasColorRamp=0<ka.length)):
"size"===ka.type&&"outline"!==ka.target?La.test(ka.valueExpression)?this._hasClusterSizeVariable||(this._scaleDrivenSizeVariable=ka):(pa=await this._getSizeLegendElement(ha,ka,a,ra),this._hasSizeRamp||(this._hasSizeRamp=!(null==pa.infos||!pa.infos.length))):"opacity"===ka.type&&(ka=await U.getRampStops(ka,Y,ra)??[],pa={type:"opacity-ramp",title:ha,infos:ka,preview:n.renderColorRampPreviewHTML(ka.map(na=>na.color),{effectList:qa,ariaLabel:await ya("previewColorRampAriaLabel")})},this._hasOpacityRamp||
(this._hasOpacityRamp=0<ka.length));return pa&&pa.infos?pa:null}}))).filter(Q.isSome)}_getFieldInfo(a,p){if(!p.field)return null;if("featureReduction"in a)switch(a.featureReduction?.type){case "cluster":case "binning":const B=a.featureReduction.fields.find(({name:K})=>K.toLowerCase()===p.field.toLowerCase());return B&&"getField"in a?a.getField(B.onStatisticField):null}return"getField"in a?a.getField?.(p.field):null}_getDateFormat(a,p){a="popupTemplate"in a?a.popupTemplate?.fieldInfos:null;if(a?.length&&
p)return a.find(B=>B.fieldName?.toLowerCase()===p.toLowerCase())?.format?.dateFormat}_getDateFormatOptions(a,p){const B=this._getFieldInfo(a,p);if(!B||!T.isAnyDateField(B)&&!x.isTimeOnlyField(B))return null;var K=this._getDateFormat(a,B.name);if(!K&&"date"===B.type){let O=K=0;p.stops?(K=p.stops?.at(0)?.value??K,O=p.stops?.at(-1)?.value??O):"minDataValue"in p&&"maxDataValue"in p&&(K=p.minDataValue??K,O=p.maxDataValue??O);K=O-K>2*e.millisecondsPerTimeUnit.days?"short-date":"short-date-short-time"}return{fieldType:B.type,
format:K,timeZoneOptions:{layerTimeZone:"preferredTimeZone"in a?a.preferredTimeZone:null,viewTimeZone:this.view.timeZone,datesInUnknownTimezone:"datesInUnknownTimezone"in a&&a.datesInUnknownTimezone}}}_getDomainName(a,p,B){return a&&"function"!==typeof a?(B=(a="getField"in B&&B.getField?.(a))&&"getFieldDomain"in B&&B.getFieldDomain?B.getFieldDomain(a.name):null,"coded-value"===B?.type?B.getName(p):null):null}_getClusterTitle(a){var p=this.layer;a=a.field;if("featureReduction"in p&&p.featureReduction&&
"cluster"===p.featureReduction.type&&(p=p.featureReduction,p=(p="popupTemplate"in p&&p.popupTemplate)&&p.fieldInfos))for(const B of p)if(B.fieldName===a)return"cluster_count"===a?B.label||{showCount:!0}:B.label;return{showCount:!0}}_getRampTitle(a,p){let B=a.field,K=a.normalizationField,O=!1,S=!1,Y=!1;var ea=null;B="function"===typeof B?null:B;K="function"===typeof K?null:K;ea=a.legendOptions?.title;if(null==ea)if(a.valueExpressionTitle)ea=a.valueExpressionTitle;else{if("renderer"in p&&p.renderer&&
"authoringInfo"in p.renderer&&p.renderer.authoringInfo?.visualVariables)for(a=p.renderer.authoringInfo.visualVariables,ea=0;ea<a.length;ea++){const qa=a[ea];if("color"===qa.type){if("ratio"===qa.style){O=!0;break}if("percent"===qa.style){S=!0;break}if("percent-of-total"===qa.style){Y=!0;break}}}ea={field:B&&this._getFieldAlias(B,p),normField:K&&this._getFieldAlias(K,p),ratio:O,ratioPercent:S,ratioPercentTotal:Y}}return ea}_getRendererTitle(a,p){if(a.legendOptions?.title)return a.legendOptions.title;
if(a.valueExpressionTitle)return a.valueExpressionTitle;var B=a.field;let K=null,O=null;oa(a)&&(K=a.normalizationField,O="percent-of-total"===a.normalizationType);B="function"===typeof B?null:B;K="function"===typeof K?null:K;if(sa(a)){const {field2:S,field3:Y,fieldDelimiter:ea}=a;B=B&&this._getFieldAlias(B,p);S&&(B=`<${B}>${ea}<${this._getFieldAlias(S,p)}>`,Y&&(B=`${B}${ea}<${this._getFieldAlias(Y,p)}>`));return B}a=null;if(B||K)a={field:B&&this._getFieldAlias(B,p),normField:K&&this._getFieldAlias(K,
p),normByPct:O};return a}_getFieldAlias(a,p){var B=("popupTemplate"in p?p.popupTemplate:null)?.fieldInfos;let K;B&&B.some(Y=>a===Y.fieldName?(K=Y,!0):!1);B=null;"getField"in p&&p.getField?B=p.getField(a):"fieldsIndex"in p&&p.fieldsIndex&&(B=p.fieldsIndex.get(a));let O=null;if(p="featureReduction"in p&&p.featureReduction)!K&&"popupTemplate"in p&&p.popupTemplate?.fieldInfos&&p.popupTemplate.fieldInfos.some(Y=>a?.toLowerCase()===Y.fieldName?.toLowerCase()?(K=Y,!0):!1),"fields"in p&&p.fields&&(O=p.fields.find(Y=>
Y.name?.toLowerCase()===a?.toLowerCase()));p=K||B||O;let S=null;p&&(S=K?.label||B?.alias||O?.alias||"name"in p&&p.name||"fieldName"in p&&p.fieldName||null);return S}_isUnclassedRenderer(a){const p=a.visualVariables;let B=!1;oa(a)&&a.classBreakInfos&&1===a.classBreakInfos.length&&p&&(B=a.field?p.some(K=>!(!K||a.field!==K.field||(a.normalizationField||K.normalizationField)&&a.normalizationField!==K.normalizationField)):!!p.length);return B}};E.__decorate([g.property()],C.prototype,"children",void 0);
E.__decorate([g.property({readOnly:!0})],C.prototype,"effectList",null);E.__decorate([g.property()],C.prototype,"layerView",void 0);E.__decorate([g.property()],C.prototype,"layer",void 0);E.__decorate([g.property()],C.prototype,"legendElements",void 0);E.__decorate([g.property({readOnly:!0})],C.prototype,"opacity",null);E.__decorate([g.property()],C.prototype,"parent",void 0);E.__decorate([g.property({readOnly:!0,dependsOn:[]})],C.prototype,"ready",null);E.__decorate([g.property()],C.prototype,"hideLayersNotInCurrentView",
void 0);E.__decorate([g.property()],C.prototype,"keepCacheOnDestroy",void 0);E.__decorate([g.property()],C.prototype,"respectLayerVisibility",void 0);E.__decorate([g.property({readOnly:!0})],C.prototype,"scale",null);E.__decorate([g.property()],C.prototype,"sublayerIds",void 0);E.__decorate([g.property({readOnly:!0})],C.prototype,"isScaleDriven",null);E.__decorate([g.property()],C.prototype,"title",void 0);E.__decorate([g.property({readOnly:!0,dependsOn:["ready"],value:0})],C.prototype,"version",
null);E.__decorate([g.property()],C.prototype,"view",void 0);return C=E.__decorate([A.subclass("esri.widgets.Legend.support.ActiveLayerInfo")],C)})},"esri/layers/effects/EffectView":function(){define("exports ../../chunks/tslib.es6 ../../core/Accessor ../../core/has ../../core/lang ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./parser ./utils".split(" "),function(q,E,P,C,u,I,D,z,Q,F,v){function b(h){h=
F.parse(h)||[];var e=(e=h[0])?"type"in e:!1;return e?[{scale:-1,effects:h}]:h}function k(h,e,c){return h[0]?.effects&&e[0]?.effects?(-1===h[0]?.scale||-1===e[0]?.scale)&&(1<h.length||1<e.length)&&0>=c?!1:v.canInterpolateEffects(h[0].effects,e[0].effects):!0}function l(h,e,c){const g=h.length>e.length?h:e;h=h.length>e.length?e:h;var r=h[h.length-1];e=r?.scale??c;r=r?.effects??[];for(let m=h.length;m<g.length;m++)h.push({scale:e,effects:[...r]});for(e=0;e<g.length;e++)h[e].scale=-1===h[e].scale?c:h[e].scale,
g[e].scale=-1===g[e].scale?c:g[e].scale,v.normalizeEffects(h[e].effects,g[e].effects)}q.EffectView=class extends P{constructor(h){super(h);this._final=this._to=this._from=null;this._current=[];this._time=0;this.duration=C("mapview-transitions-duration");this.effects=[]}set effect(h){const e=this._get("effect");h=h||"";if(e!==h){this._set("effect",h);try{this._transitionTo(b(h))}catch(c){this._transitionTo([]),I.getLogger(this).warn("Invalid Effect",{effect:h,error:c})}}}get hasEffects(){return this.transitioning||
!!this.effects.length}set scale(h){this._updateForScale(h)}get transitioning(){return null!==this._to}canTransitionTo(h){try{return 0<this.scale&&k(this._current,b(h),this.scale)}catch{return!1}}transitionStep(h,e){this._applyTimeTransition(h);this._updateForScale(e)}endTransitions(){this._applyTimeTransition(this.duration)}_transitionTo(h){0<this.scale&&k(this._current,h,this.scale)?(this._final=h,this._to=u.clone(h),l(this._current,this._to,this.scale),this._from=u.clone(this._current),this._time=
0):(this._from=this._to=this._final=null,this._current=h);this._set("effects",this._current[0]?u.clone(this._current[0].effects):[])}_applyTimeTransition(h){if(this._to&&this._from&&this._current&&this._final){this._time+=h;h=Math.min(1,this._time/this.duration);for(let c=0;c<this._current.length;c++){const g=this._current[c],r=this._from[c],m=this._to[c];var e=r.scale;g.scale=e+(m.scale-e)*h;for(e=0;e<g.effects.length;e++)g.effects[e].interpolate(r.effects[e],m.effects[e],h)}1===h&&(this._current=
this._final,this._set("effects",this._current[0]?u.clone(this._current[0].effects):[]),this._from=this._to=this._final=null)}}_updateForScale(h){this._set("scale",h);if(0!==this._current.length){var e=this._current,c=this._current.length-1,g,r=1;if(1===e.length||h>=e[0].scale)var m=g=e[0].effects;else if(h<=e[c].scale)m=g=e[c].effects;else for(let A=0;A<c;A++){const H=e[A],J=e[A+1];if(H.scale>=h&&J.scale<=h){r=(h-H.scale)/(J.scale-H.scale);g=H.effects;m=J.effects;break}}for(h=0;h<this.effects.length;h++)this.effects[h].interpolate(g[h],
m[h],r)}}};E.__decorate([D.property()],q.EffectView.prototype,"_to",void 0);E.__decorate([D.property()],q.EffectView.prototype,"duration",void 0);E.__decorate([D.property({value:""})],q.EffectView.prototype,"effect",null);E.__decorate([D.property({readOnly:!0})],q.EffectView.prototype,"effects",void 0);E.__decorate([D.property({readOnly:!0})],q.EffectView.prototype,"hasEffects",null);E.__decorate([D.property({value:0})],q.EffectView.prototype,"scale",null);E.__decorate([D.property({readOnly:!0})],
q.EffectView.prototype,"transitioning",null);q.EffectView=E.__decorate([Q.subclass("esri.layers.effects.EffectView")],q.EffectView);q.canInterpolateEffectStops=k;q.convertEffectToStops=b;q.normalizeEffectStops=l;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/ExportImageParameters":function(){define("exports ../../chunks/tslib.es6 ../../core/Accessor ../../core/sql ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../geometry/support/scaleUtils ./commonProperties ./floorFilterUtils ./sublayerUtils".split(" "),
function(q,E,P,C,u,I,D,z,Q,F,v,b,k){const l={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};q.ExportImageParameters=class extends P{constructor(h){super(h);this.floors=null;this.scale=0}destroy(){this.layer=null}get dynamicLayers(){if(!this.hasDynamicLayers)return null;const h=this.visibleSublayers.map(e=>
{const c=b.getLayerFloorFilterClause(this.floors,e);return e.toExportImageJSON(c)});return h.length?JSON.stringify(h):null}get hasDynamicLayers(){return this.layer&&k.isExportDynamic(this.visibleSublayers,this.layer.serviceSublayers,this.layer.gdbVersion)}set layer(h){this._get("layer")!==h&&(this._set("layer",h),this.removeHandles("layer"),h&&this.addHandles([h.allSublayers.on("change",()=>this.notifyChange("visibleSublayers")),h.on("sublayer-update",e=>this.notifyChange(l[e.propertyName]))],"layer"))}get layers(){const h=
this.visibleSublayers;return h?h.length?"show:"+h.map(e=>e.id).join(","):"show:-1":null}get layerDefs(){const h=!!this.floors?.length,e=this.visibleSublayers.filter(c=>null!=c.definitionExpression||h&&null!=c.floorInfo);return e.length?JSON.stringify(e.reduce((c,g)=>{var r=b.getLayerFloorFilterClause(this.floors,g);r=C.sqlAnd(r,g.definitionExpression);null!=r&&(c[g.id]=r);return c},{})):null}get version(){this.commitProperty("layers");this.commitProperty("layerDefs");this.commitProperty("dynamicLayers");
this.commitProperty("timeExtent");const h=this.layer;h&&(h.commitProperty("dpi"),h.commitProperty("imageFormat"),h.commitProperty("imageTransparency"),h.commitProperty("gdbVersion"));return(this._get("version")||0)+1}get visibleSublayers(){const h=[];if(!this.layer)return h;var e=this.layer.sublayers;const c=this.scale,g=r=>{r.visible&&(0===c||F.isInScaleRange(c,r.minScale,r.maxScale))&&(r.sublayers?r.sublayers.forEach(g):h.unshift(r))};e&&e.forEach(g);e=this._get("visibleSublayers");return!e||e.length!==
h.length||e.some((r,m)=>h[m]!==r)?h:e}toJSON(){var h=this.layer;h={dpi:h.dpi,format:h.imageFormat,transparent:h.imageTransparency,gdbVersion:h.gdbVersion||null};this.hasDynamicLayers&&this.dynamicLayers?h.dynamicLayers=this.dynamicLayers:h={...h,layers:this.layers,layerDefs:this.layerDefs};return h}};E.__decorate([u.property({readOnly:!0})],q.ExportImageParameters.prototype,"dynamicLayers",null);E.__decorate([u.property()],q.ExportImageParameters.prototype,"floors",void 0);E.__decorate([u.property({readOnly:!0})],
q.ExportImageParameters.prototype,"hasDynamicLayers",null);E.__decorate([u.property()],q.ExportImageParameters.prototype,"layer",null);E.__decorate([u.property({readOnly:!0})],q.ExportImageParameters.prototype,"layers",null);E.__decorate([u.property({readOnly:!0})],q.ExportImageParameters.prototype,"layerDefs",null);E.__decorate([u.property({type:Number})],q.ExportImageParameters.prototype,"scale",void 0);E.__decorate([u.property(v.combinedViewLayerTimeExtentProperty)],q.ExportImageParameters.prototype,
"timeExtent",void 0);E.__decorate([u.property({readOnly:!0})],q.ExportImageParameters.prototype,"version",null);E.__decorate([u.property({readOnly:!0})],q.ExportImageParameters.prototype,"visibleSublayers",null);q.ExportImageParameters=E.__decorate([Q.subclass("esri.layers.mixins.ExportImageParameters")],q.ExportImageParameters);Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/scaleUtils":function(){define(["exports","../../core/mathUtils","../../core/unitUtils"],
function(q,E,P){function C(u,I){I=P.getMetersPerUnitForSR(I);return u/(I*P.inchesPerMeter*96)}q.getExtentForScale=function(u,I){const D=u.extent;u=u.width-(u.padding?u.padding.left+u.padding.right:0);I=C(I,D.spatialReference);return D.clone().expand(I*u/D.width)};q.getResolutionForScale=C;q.getResolutionInMetersForScale=function(u){return u/(96*P.inchesPerMeter)};q.getScale=function(u,I){I=I||u.extent;u=u.width;const D=P.getMetersPerUnitForSR(I?.spatialReference);return I&&u?I.width/u*D*P.inchesPerMeter*
96:0};q.getScaleForResolution=function(u,I){I=P.getMetersPerUnitForSR(I);return u*I*P.inchesPerMeter*96};q.isInScaleRange=function(u,I,D){if(I=0===I||E.floatEqualAbsolute(u,I)||u<I)I=0===D||E.floatEqualAbsolute(u,D)||u>D;return I};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/floorFilterUtils":function(){define(["exports"],function(q){function E(P,C){if(!P?.length)return null;P=P.filter(u=>""!==u).map(u=>`'${u}'`);P.push("''");return`${C} IN (${P.join(",")}) OR ${C} IS NULL`}
q.getFloorFilterClause=function(P){const C=P.layer;return"floorInfo"in C&&C.floorInfo?.floorField&&"floors"in P.view?E(P.view.floors,C.floorInfo.floorField):null};q.getLayerFloorFilterClause=function(P,C){return"floorInfo"in C&&C.floorInfo?.floorField?E(P,C.floorInfo.floorField):null};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/sublayerUtils":function(){define(["exports","../../core/accessorSupport/PropertyOrigin"],function(q,E){function P(C,u){if(!C?.length||
null==u)return!0;u=u.slice().reverse().flatten(({sublayers:z})=>z&&z.toArray().reverse()).map(z=>z.id).toArray();if(C.length>u.length)return!1;let I=0;const D=u.length;for(const {id:z}of C){for(;I<D&&u[I]!==z;)I++;if(I>=D)return!1}return!0}q.isExportDynamic=function(C,u,I){return C.some(D=>{const z=D.source;return!(!z||"map-layer"===z.type&&z.mapLayerId===D.id&&(null==z.gdbVersion||z.gdbVersion===I))||D.originIdOf("renderer")>E.OriginId.SERVICE||D.originIdOf("labelingInfo")>E.OriginId.SERVICE||D.originIdOf("opacity")>
E.OriginId.SERVICE||D.originIdOf("labelsVisible")>E.OriginId.SERVICE})?!0:!P(C,u)};q.isSublayerOverhaul=function(C){return!!C&&C.some(u=>null!=u.minScale||null!=u.layerDefinition?.minScale)};q.shouldWriteSublayerStructure=function(C,u,I){return u.flatten(({sublayers:D})=>D).length!==C.length||C.some(D=>D.originIdOf("minScale")>I||D.originIdOf("maxScale")>I||D.originIdOf("renderer")>I||D.originIdOf("labelingInfo")>I||D.originIdOf("opacity")>I||D.originIdOf("labelsVisible")>I||D.originIdOf("source")>
I)?!0:!P(C,u)};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/pixelRangeUtils":function(){define(["exports"],function(q){function E(C){return P[C]??[-3.4028234663852886E38,3.4028234663852886E38]}const P={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-3.4028234663852886E38,3.4028234663852886E38],f64:[-Number.MAX_VALUE,Number.MAX_VALUE],unknown:void 0,c64:void 0,
c128:void 0};q.convertNoDataToMask=function(C,u,I){if(!(C.depthCount&&1<C.depthCount)){var {pixels:D,statistics:z,pixelType:Q}=C,F=D[0].length,v=C.bandMasks??[];F=C.mask??(new Uint8Array(F)).fill(255);var b="f32"===Q||"f64"===Q,k=E(Q),l=!1;for(let c=0;c<D.length;c++){const g="number"===typeof u?u:u[c];if(null==g)continue;var h=z?.[c]?.maxValue??k[1];if((z?.[c]?.minValue??k[0])>g+Number.EPSILON||h<g-Number.EPSILON)continue;h=v[c]||F.slice();const r=D[c];var e=I?.customFloatTolerance;if(b&&0!==e){e||
(e=9.999999E37<=Math.abs(g)?2E-7*Math.abs(g):"f32"===Q?2**-23:Number.EPSILON);for(let m=0;m<r.length;m++)h[m]&&Math.abs(r[m]-g)<e&&(r[m]=0,h[m]=0,F[m]=0,l=!0)}else for(e=0;e<r.length;e++)h[e]&&r[e]===g&&(r[e]=0,h[e]=0,F[e]=0,l=!0);v[c]=h}l&&(C.bandMasks=C.bandMasks||1<C.pixels.length?v:null,C.mask=F);l&&"updateStatistics"in C&&C.updateStatistics()}};q.getPixelValueRange=E;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/rendererConversion":function(){define(["exports",
"../../core/arrayUtils","../../core/has","../../core/Error","../../symbols/support/symbolConversion"],function(q,E,P,C,u){function I(F){return null==F||"simple"===F.type||"unique-value"===F.type||"class-breaks"===F.type||"dictionary"===F.type||"heatmap"===F.type}function D(F,v){if(!v)return null;v=Array.isArray(v)?v:[v];if(0<v.length){const b=v.map(l=>l.details.symbol.type||l.details.symbol.declaredClass).filter(l=>!!l);b.sort();const k=[];b.forEach((l,h)=>{0!==h&&l===b[h-1]||k.push(l)});return new C("renderer-conversion-3d:unsupported-symbols",
`Renderer contains symbols (${k.join(", ")}) which are not supported in 3D`,{renderer:F,symbolErrors:v})}return null}function z(F,v){const b={...u.defaultTo3DOptions,...v};v=F.uniqueValueInfos?.map(l=>u.to3D(l.symbol,b).error).filter(E.isSome);const k=u.to3D(F.defaultSymbol,b);k.error&&v?.unshift(k.error);return D(F,v)}function Q(F){const v=F.classBreakInfos.map(k=>u.to3D(k.symbol).error).filter(E.isSome),b=u.to3D(F.defaultSymbol);b.error&&v.unshift(b.error);return D(F,v)}q.isSupportedRenderer3D=
I;q.validateTo3D=function(F,v){if(null==F)return null;if(!I(F))return new C("renderer-conversion-3d:unsupported-renderer",`Unsupported renderer of type '${F.type||F.declaredClass}'`,{renderer:F});switch(F.type){case "simple":return D(F,u.to3D(F.symbol).error);case "unique-value":return z(F,v);case "class-breaks":return Q(F)}return null};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/smartMapping/support/utils":function(){define("exports ../../intl/date ../../layers/support/fieldUtils ../../support/arcadeOnDemand ../../support/basemapUtils ../../time/timeZoneUtils".split(" "),
function(q,E,P,C,u,I){function D(l){return String(l).padStart(2,"0")}function z(l,h,e){if("date"===h||"number"===h){"number"===h&&(l=new Date(l));h=e?l.getFullYear():l.getUTCFullYear();const c=D((e?l.getMonth():l.getUTCMonth())+1),g=D(e?l.getDate():l.getUTCDate()),r=D(e?l.getHours():l.getUTCHours()),m=D(e?l.getMinutes():l.getUTCMinutes());l=D(e?l.getSeconds():l.getUTCSeconds());l=`TIMESTAMP'${h}-${c}-${g} ${r}:${m}:${l}'`}return l}function Q(l,h){if(h instanceof Date)return"date";if("number"===typeof h)return"number";
if("string"===typeof h&&(l=l.getField(h),"\x3cnow\x3e"!==h.toLowerCase()&&P.isDateField(l)))return"field"}const F={light:"streets gray topo terrain oceans osm gray-vector streets-vector topo-vector streets-relief-vector streets-navigation-vector topo-3d navigation-3d arcgis-light-gray arcgis-navigation arcgis-streets arcgis-streets-relief arcgis-topographic arcgis-oceans osm-standard osm-standard-relief osm-streets osm-streets-relief osm-light-gray arcgis-terrain arcgis-charted-territory arcgis-community arcgis-colored-pencil arcgis-modern-antique arcgis-midcentury arcgis-newspaper arcgis-hillshade-light".split(" "),
dark:"satellite hybrid dark-gray dark-gray-vector streets-night-vector navigation-dark-3d arcgis-imagery arcgis-imagery-standard arcgis-dark-gray arcgis-navigation-night arcgis-streets-night osm-dark-gray arcgis-nova arcgis-hillshade-dark".split(" ")},v={years:365,months:30,days:1,hours:1/24,minutes:1/1440,seconds:1/86400,milliseconds:1/864E5},b=new Set(["integer","small-integer"]);let k=null;q.castIntegerFieldToFloat=function(l){return`cast(${l} as float)`};q.dateTypes=["date","date-only","timestamp-offset"];
q.defaultBasemapGroups=F;q.fieldDelimiter=",";q.formatAnyDate=function(l,h){const {format:e,timeZoneOptions:c,fieldType:g}=h??{};let r;c&&({timeZone:m,timeZoneName:r}=I.getTimeZoneFormattingOptions(c.layerTimeZone,c.datesInUnknownTimezone,c.viewTimeZone,E.convertDateFormatToIntlOptions(e||"short-date-short-time"),g));if("string"===typeof l&&isNaN(Date.parse("time-only"===g?`1970-01-01T${l}Z`:l)))return l;switch(g){case "date-only":var m=E.convertDateFormatToIntlOptions(e||"short-date");return"string"===
typeof l?E.formatDateOnly(l,{...m}):E.formatDate(l,{...m,timeZone:I.utc});case "time-only":return m=E.convertDateFormatToIntlOptions(e||"short-time"),"string"===typeof l?E.formatTimeOnly(l,m):E.formatDate(l,{...m,timeZone:I.utc});case "timestamp-offset":if(!m&&"string"===typeof l&&(new Date(l)).toISOString()!==l)return l;m=(h=e||c?E.convertDateFormatToIntlOptions(e||"short-date-short-time"):void 0)?{...h,timeZone:m,timeZoneName:r}:void 0;return"string"===typeof l?E.formatTimestamp(l,m):E.formatDate(l,
m);default:return h=e||c?E.convertDateFormatToIntlOptions(e||"short-date-short-time"):void 0,E.formatDate("string"===typeof l?new Date(l):l,h?{...h,timeZone:m,timeZoneName:r}:void 0)}};q.getBasemapGroup=function(l,h=F){for(const e in h)if(h[e].includes(l))return e};q.getBasemapId=function(l,h,e=!0){let c=null;l&&("string"===typeof l?h.includes(l)&&(c=l):c=u.getWellKnownBasemapId(l));return e?c||"gray":c};q.getDateDiffSQL=function(l,h,e,c){const {hasQueryEngine:g}=l;e=z(e,Q(l,e),g);l=z(h,Q(l,h),g);
l=`(${e} - ${l})`;c=v[c];h="/";1>c&&(c=1/c,h="*");return{sqlExpression:1===c?l:`(${l} ${h} ${c})`,sqlWhere:null}};q.getDateType=Q;q.getFieldsList=async function(l){const {field:h,field2:e,field3:c,normalizationField:g,valueExpression:r}=l;l=[];r&&(k||({arcadeUtils:l}=await C.loadArcade(),k=l),l=k.extractFieldNames(r));h&&l.push(h);e&&l.push(e);c&&l.push(c);g&&l.push(g);return l};q.getNormalizationType=function(l){let h=l.normalizationType;h||(l.normalizationField?h="field":null!=l.normalizationTotal&&
(h="percent-of-total"));return h??void 0};q.isAnyDateField=function(l){return P.isDateField(l)||P.isDateOnlyField(l)||P.isTimestampOffsetField(l)};q.isIntegerField=function(l,h){l=h&&l.getField(h);return!!l&&b.has(l.type)};q.unitValueInDays=v;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/cimSymbolUtils":function(){define(["exports","../../Color","../cim/utils"],function(q,E,P){function C(b){b=P.toCIMSymbolJSON(b);if("CIMTextSymbol"===b?.type)return b.height??
0;let k=0;if(b?.symbolLayers)for(const l of b.symbolLayers)P.isCIMMarker(l)&&null!=l.size&&l.size>k?k=l.size:P.isCIMStroke(l)&&null!=l.width&&l.width>k?k=l.width:P.isCIMFill(l);return k}function u(b,k,l,h){if(b)if("CIMTextSymbol"===b.type)null!=b.height&&(b.height*=k);else{if(l&&b.effects)for(const e of b.effects)z(e,k);if(b.symbolLayers)for(const e of b.symbolLayers)switch(e.type){case "CIMPictureMarker":case "CIMVectorMarker":I(e,k,h);break;case "CIMPictureStroke":case "CIMSolidStroke":!h?.preserveOutlineWidth&&
e.width&&(e.width*=k);break;case "CIMPictureFill":e.height&&(e.height*=k);e.offsetX&&(e.offsetX*=k);e.offsetY&&(e.offsetY*=k);break;case "CIMHatchFill":u(e.lineSymbol,k,!0,{...h,preserveOutlineWidth:!1}),e.offsetX&&(e.offsetX*=k),e.offsetY&&(e.offsetY*=k),e.separation&&(e.separation*=k)}}}function I(b,k,l){if(b&&(b.markerPlacement&&D(b.markerPlacement,k),b.offsetX&&(b.offsetX*=k),b.offsetY&&(b.offsetY*=k),b.anchorPoint&&"Absolute"===b.anchorPointUnits&&(b.anchorPoint={x:b.anchorPoint.x*k,y:b.anchorPoint.y*
k}),b.size=null!=b.size?b.size*k:0,"CIMVectorMarker"===b.type&&b.markerGraphics))for(const h of b.markerGraphics)b.scaleSymbolsProportionally||u(h.symbol,k,!0,l)}function D(b,k){P.isCIMMarkerStrokePlacement(b)&&b.offset&&(b.offset*=k);switch(b.type){case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineSameSize":b.customEndingOffset&&(b.customEndingOffset*=k);b.offsetAlongLine&&(b.offsetAlongLine*=k);if(b.placementTemplate&&b.placementTemplate.length){var l=b.placementTemplate.map(h=>
h*k);b.placementTemplate=l}break;case "CIMMarkerPlacementAlongLineVariableSize":b.maxRandomOffset&&(b.maxRandomOffset*=k);b.placementTemplate&&b.placementTemplate.length&&(l=b.placementTemplate.map(h=>h*k),b.placementTemplate=l);break;case "CIMMarkerPlacementOnLine":b.startPointOffset&&(b.startPointOffset*=k);break;case "CIMMarkerPlacementAtExtremities":b.offsetAlongLine&&(b.offsetAlongLine*=k);break;case "CIMMarkerPlacementAtRatioPositions":b.beginPosition&&(b.beginPosition*=k);b.endPosition&&(b.endPosition*=
k);break;case "CIMMarkerPlacementPolygonCenter":b.offsetX&&(b.offsetX*=k);b.offsetY&&(b.offsetY*=k);break;case "CIMMarkerPlacementInsidePolygon":b.offsetX&&(b.offsetX*=k),b.offsetY&&(b.offsetY*=k),b.stepX&&(b.stepX*=k),b.stepY&&(b.stepY*=k)}}function z(b,k){switch(b.type){case "CIMGeometricEffectArrow":case "CIMGeometricEffectDonut":b.width&&(b.width*=k);break;case "CIMGeometricEffectBuffer":b.size&&(b.size*=k);break;case "CIMGeometricEffectCut":b.beginCut&&(b.beginCut*=k);b.endCut&&(b.endCut*=k);
b.middleCut&&(b.middleCut*=k);break;case "CIMGeometricEffectDashes":b.customEndingOffset&&(b.customEndingOffset*=k);b.offsetAlongLine&&(b.offsetAlongLine*=k);if(b.dashTemplate&&b.dashTemplate.length){const l=b.dashTemplate.map(h=>h*k);b.dashTemplate=l}break;case "CIMGeometricEffectExtension":case "CIMGeometricEffectJog":case "CIMGeometricEffectRadial":b.length&&(b.length*=k);break;case "CIMGeometricEffectMove":b.offsetX&&(b.offsetX*=k);b.offsetY&&(b.offsetY*=k);break;case "CIMGeometricEffectOffset":case "CIMGeometricEffectOffsetTangent":b.offset&&
(b.offset*=k);break;case "CIMGeometricEffectRegularPolygon":b.radius&&(b.radius*=k);break;case "CIMGeometricEffectTaperedPolygon":b.fromWidth&&(b.fromWidth*=k);b.length&&(b.length*=k);b.toWidth&&(b.toWidth*=k);break;case "CIMGeometricEffectWave":b.amplitude&&(b.amplitude*=k),b.period&&(b.period*=k)}}function Q(b,k){if(b){var l="CIMTextSymbol"===b.type?b.symbol:b;b="CIMPolygonSymbol"===b.type;if(l?.symbolLayers)for(const h of l.symbolLayers)if(!(h.colorLocked||b&&(P.isCIMStroke(h)||P.isCIMMarker(h)&&
h.markerPlacement&&P.isCIMMarkerStrokePlacement(h.markerPlacement))))switch(h.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":h.tintColor&&F(k,h.tintColor);break;case "CIMVectorMarker":h.markerGraphics?.forEach(e=>{Q(e.symbol,k)});break;case "CIMSolidStroke":case "CIMSolidFill":F(k,h.color);break;case "CIMHatchFill":Q(h.lineSymbol,k)}}}function F(b,k){for(const l of b)if(l.join(".")===k.join("."))return;b.push(k)}function v(b,k,l){if(b){var h="CIMTextSymbol"===b.type?b.symbol:
b;b="CIMPolygonSymbol"===h?.type;if(h?.symbolLayers)for(const e of h.symbolLayers)if(!e.colorLocked){if(b)if(l){if({layersToColor:h}=l,(P.isCIMStroke(e)||P.isCIMMarker(e)&&e.markerPlacement&&P.isCIMMarkerStrokePlacement(e.markerPlacement))&&"fill"===h||P.isCIMFill(e)&&"outline"===h)continue}else if(P.isCIMStroke(e)||P.isCIMMarker(e)&&e.markerPlacement&&P.isCIMMarkerStrokePlacement(e.markerPlacement))continue;h=k.toArray();switch(e.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":e.tintColor=
h;break;case "CIMVectorMarker":e.markerGraphics?.forEach(c=>{v(c.symbol,k,l)});break;case "CIMSolidStroke":case "CIMSolidFill":e.color=h;break;case "CIMHatchFill":v(e.lineSymbol,k,l)}}}}q.applyCIMSymbolColor=function(b,k,l){k instanceof E||(k=new E(k));(b=P.toCIMSymbolJSON(b))&&v(b,k,l)};q.applyCIMSymbolRotation=function(b,k,l=!1){b=P.toCIMSymbolJSON(b);l&&0!==k&&(k=360-k);if("CIMTextSymbol"===b?.type)b.angle=k;else if("CIMPointSymbol"===b?.type&&b.symbolLayers){l=k-(b.angle||0);for(const h of b.symbolLayers)if(P.isCIMMarker(h)){let e=
h.rotation||0;e=h.rotateClockwise?e-l:e+l;h.rotation=e}b.angle=k}};q.getCIMSymbolColor=function(b){b=P.toCIMSymbolJSON(b);const k=[];Q(b,k);return k.length?new E(P.fromCIMColor(k[0])):null};q.getCIMSymbolRotation=function(b,k=!1){b=P.toCIMSymbolJSON(b);return"CIMTextSymbol"===b?.type||"CIMPointSymbol"===b?.type?(b=b.angle,null!=b&&0!==b&&k?360-b:b??0):0};q.getCIMSymbolSize=C;q.getCIMSymbolType=function(b){b=P.toCIMSymbolJSON(b);if(!b)return null;switch(b.type){case "CIMPointSymbol":return"CIMPointSymbol";
case "CIMLineSymbol":return"CIMLineSymbol";case "CIMPolygonSymbol":return"CIMPolygonSymbol";case "CIMTextSymbol":return"CIMTextSymbol";case "CIMMeshSymbol":return"CIMMeshSymbol";default:return null}};q.scaleCIMMarker=I;q.scaleCIMSymbol=u;q.scaleCIMSymbolTo=function(b,k,l){if(b){var h=P.toCIMSymbolJSON(b);b=C(b);if(0===b){if(h)if("CIMTextSymbol"===h.type)h.height=k;else if(h.symbolLayers)for(const e of h.symbolLayers)switch(e.type){case "CIMPictureMarker":case "CIMVectorMarker":e.size=k;break;case "CIMPictureStroke":case "CIMSolidStroke":e.width=
k}}else u(h,k/b,!1,l)}};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/utils":function(){define(["require","exports"],function(q,E){function P(b){return"function"===typeof b}function C(b){let k=b.length;for(;k--;)if(!" /-,\n".includes(b.charAt(k)))return!1;return!0}function u(b,k){const l=[];var h=0;let e=-1;do e=b.indexOf("[",h),e>=h&&(e>h&&(h=b.substr(h,e-h),l.push([h,null,C(h)])),h=e+1,e=b.indexOf("]",h),e>=h&&(e>h&&(h=b.substr(h,e-h),(h=k[h])&&l.push([null,h,
!1])),h=e+1));while(-1!==e);h<b.length-1&&(b=b.substr(h),l.push([b,null,C(b)]));return l}function I(b,k,l){let h="",e=null;for(const c of k){const [g,r,m]=c;if(g)m?e=g:(e&&(h+=e,e=null),h+=g);else if(k=b.attributes[r])e&&(h+=e,e=null),h+=k}return D(h,l)}function D(b,k){"string"!==typeof b&&(b=String(b));switch(k){case "LowerCase":return b.toLowerCase();case "Allcaps":return b.toUpperCase();default:return b}}function z(b){return b?{r:b[0],g:b[1],b:b[2],a:b[3]/255}:{r:0,g:0,b:0,a:0}}function Q(b){if(!b)return null;
switch(b.type){case "CIMPolygonSymbol":if(b.symbolLayers)for(const k of b.symbolLayers)if(b=Q(k),null!=b)return b;break;case "CIMTextSymbol":return Q(b.symbol);case "CIMSolidFill":return b.color}}function F(b){if(b)switch(b.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(b=b.symbolLayers)for(const k of b)if(b=F(k),null!=b)return b;break;case "CIMTextSymbol":return F(b.symbol);case "CIMSolidStroke":return b.color}}function v(b){if(b)switch(b.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(b.symbolLayers)for(const k of b.symbolLayers)if(b=
v(k),void 0!==b)return b;break;case "CIMTextSymbol":return v(b.symbol);case "CIMSolidStroke":case "CIMGradientStroke":case "CIMPictureStroke":return b.width}}E.adjustTextCase=D;E.analyzeTextParts=u;E.assignTextValuesFromFeature=I;E.attributesToFields=function(b){return(b?Object.keys(b):[]).map(k=>({name:k,alias:k,type:"string"===typeof b[k]?"esriFieldTypeString":"esriFieldTypeDouble"}))};E.colorToArray=function(b){return[b.r,b.g,b.b,b.a]};E.createLabelOverrideFunction=function(b,k,l){const h=u(k,
b);return e=>I(e,h,l)};E.evaluateValueOrFunction=function(b,k,l,h){return P(b)?b(k,l,h):b};E.fromCIMColor=z;E.fromCIMFontDecoration=function(b){return b.underline?"underline":b.strikethrough?"line-through":"none"};E.fromCIMFontStyle=function(b){let k="normal",l="normal";b&&(b=b.toLowerCase(),b.includes("italic")?k="italic":b.includes("oblique")&&(k="oblique"),b.includes("bold")?l="bold":b.includes("light")&&(l="lighter"));return{style:k,weight:l}};E.fromCIMHorizontalAlignment=function(b){switch(b){default:return"left";
case "Right":return"right";case "Center":return"center";case "Justify":return"center"}};E.fromCIMVerticalAlignment=function(b){switch(b){default:return"top";case "Center":return"middle";case "Baseline":return"baseline";case "Bottom":return"bottom"}};E.getFillColor=Q;E.getFontStyle=function(b){if(!b)return"normal";switch(b.toLowerCase()){case "italic":return"italic";case "oblique":return"oblique";default:return"normal"}};E.getFontWeight=function(b){if(!b)return"normal";switch(b.toLowerCase()){case "bold":return"bold";
case "bolder":return"bolder";case "lighter":return"lighter";default:return"normal"}};E.getStrokeColor=F;E.getStrokeWidth=v;E.getTintColor=b=>b.tintColor?z(b.tintColor):{r:255,g:255,b:255,a:1};E.getValue=(b,k=0)=>null==b||isNaN(b)?k:b;E.importGeometryEngine=function(){return new Promise((b,k)=>q(["../../geometry/geometryEngineJSON"],b,k))};E.isCIMFill=function(b){return null!=b&&("CIMGradientFill"===b.type||"CIMHatchFill"===b.type||"CIMPictureFill"===b.type||"CIMSolidFill"===b.type||"CIMWaterFill"===
b.type)};E.isCIMMarker=function(b){return"CIMVectorMarker"===b.type||"CIMPictureMarker"===b.type||"CIMBarChartMarker"===b.type||"CIMCharacterMarker"===b.type||"CIMPieChartMarker"===b.type||"CIMStackedBarChartMarker"===b.type};E.isCIMMarkerStrokePlacement=function(b){return null!=b&&("CIMMarkerPlacementAlongLineRandomSize"===b.type||"CIMMarkerPlacementAlongLineSameSize"===b.type||"CIMMarkerPlacementAlongLineVariableSize"===b.type||"CIMMarkerPlacementAtExtremities"===b.type||"CIMMarkerPlacementAtMeasuredUnits"===
b.type||"CIMMarkerPlacementAtRatioPositions"===b.type||"CIMMarkerPlacementOnLine"===b.type||"CIMMarkerPlacementOnVertices"===b.type)};E.isCIMStroke=function(b){return"CIMGradientStroke"===b.type||"CIMPictureStroke"===b.type||"CIMSolidStroke"===b.type};E.isFeatureValueFn=P;E.isGeometryEngineRequired=b=>{if(!b)return!1;for(const k of b)switch(k.type){case "CIMGeometricEffectBuffer":case "CIMGeometricEffectOffset":case "CIMGeometricEffectDonut":return!0}return!1};E.isSVGImage=b=>b.includes("data:image/svg+xml");
E.mapCIMSymbolToGeometryType=function(b){if(!b)return null;switch(b.type){case "CIMPointSymbol":case "CIMTextSymbol":return"esriGeometryPoint";case "CIMLineSymbol":return"esriGeometryPolyline";case "CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}};E.resampleHermite=function(b,k,l,h,e,c,g=!0){const r=k/e;l/=c;const m=Math.ceil(r/2),A=Math.ceil(l/2);for(let f=0;f<c;f++)for(let d=0;d<e;d++){const x=4*(d+(g?c-f-1:f)*e);var H=0;let G=0,y=0,M=0,L=0,N=0,T=0;const Z=(f+.5)*l;for(let W=
Math.floor(f*l);W<(f+1)*l;W++){var J=Math.abs(Z-(W+.5))/A;const w=(d+.5)*r;J*=J;for(let n=Math.floor(d*r);n<(d+1)*r;n++){let t=Math.abs(w-(n+.5))/m;H=Math.sqrt(J+t*t);-1<=H&&1>=H&&(H=2*H*H*H-3*H*H+1,0<H&&(t=4*(n+W*k),T+=H*b[t+3],y+=H,255>b[t+3]&&(H=H*b[t+3]/250),M+=H*b[t],L+=H*b[t+1],N+=H*b[t+2],G+=H))}}h[x]=M/G;h[x+1]=L/G;h[x+2]=N/G;h[x+3]=T/y}};E.toCIMSymbolJSON=function(b){return b.data?.symbol??null};Object.defineProperty(E,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/previewUtils":function(){define(["exports",
"../../Color"],function(q,E){function P(C,u){return Math.round(Math.min(Math.max(C+191.25*u,0),255))}q.SymbolSizeDefaults=void 0;(function(C){C[C.size=22]="size";C[C.lineWidth=50]="lineWidth";C[C.maxSize=120]="maxSize";C[C.maxOutlineSize=80]="maxOutlineSize";C[C.tallSymbolWidth=20]="tallSymbolWidth"})(q.SymbolSizeDefaults||(q.SymbolSizeDefaults={}));q.adjustColorBrightness=function(C,u){if(null==C)return new E;if("type"in C&&("linear"===C.type||"pattern"===C.type))return C;C=new E(C);return new E([P(C.r,
u),P(C.g,u),P(C.b,u),C.a])};q.adjustColorComponentBrightness=P;q.getConeShapes=function(C,u){let I=u?q.SymbolSizeDefaults.tallSymbolWidth:C;u=u?4:6;I=I<=q.SymbolSizeDefaults.size?I-.5*u:I-u;u=.15*I;const D=I;C-=u;return[{type:"ellipse",cx:.5*I,cy:C,rx:.5*I,ry:u},{type:"path",path:[{command:"M",values:[.5*D,0]},{command:"L",values:[D,C]},{command:"L",values:[0,C]},{command:"Z",values:[]}]}]};q.getCubeShapes=function(C,u){let I=u?q.SymbolSizeDefaults.tallSymbolWidth:C;var D=u?4:6;D=I=I<=q.SymbolSizeDefaults.size?
I-.5*D:I-D;u=u?.35*I:.5*I;return[{type:"path",path:[{command:"M",values:[.5*D,0]},{command:"L",values:[D,.5*u]},{command:"L",values:[.5*D,u]},{command:"L",values:[0,.5*u]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*u]},{command:"L",values:[.5*D,u]},{command:"L",values:[.5*D,C]},{command:"L",values:[0,C-.5*u]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*D,u]},{command:"L",values:[.5*D,C]},{command:"L",values:[D,C-.5*u]},{command:"L",values:[D,.5*
u]},{command:"Z",values:[]}]}]};q.getCylinderShapes=function(C,u){var I=u?q.SymbolSizeDefaults.tallSymbolWidth:C;u=u?4:6;I=I<=q.SymbolSizeDefaults.size?I-.5*u:I-u;u=.5*I;const D=.15*I;C-=D;return[{type:"ellipse",cx:.5*I,cy:C,rx:u,ry:D},{type:"path",path:[{command:"M",values:[0,D]},{command:"L",values:[0,C]},{command:"L",values:[I,C]},{command:"L",values:[I,D]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*I,cy:D,rx:u,ry:D}]};q.getDiamondShapes=function(C){var u=C;u=u<q.SymbolSizeDefaults.size?u-
2:u-4;const I=Math.floor(C/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*u,0]},{command:"L",values:[u,.5*C-I]},{command:"L",values:[.45*u-I,.5*C+I]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*u,0]},{command:"L",values:[.45*u-I,.5*C+I]},{command:"L",values:[0,.5*C-I]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*C-I]},{command:"L",values:[.45*u-I,.5*C+I]},{command:"L",values:[.45*u,C]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",
values:[.45*u,C]},{command:"L",values:[u,.5*C-I]},{command:"L",values:[.45*u-I,.5*C+I]},{command:"Z",values:[]}]}]};q.getExtrudeSymbolShapes=function(C){const u=q.SymbolSizeDefaults.size;C*=.5;return[{type:"path",path:[{command:"M",values:[0,.35*u]},{command:"L",values:[.3*u,.7*u]},{command:"L",values:[.3*u,.7*u+C]},{command:"L",values:[0,.7*u+C-.35*u]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*u,.7*u]},{command:"L",values:[.3*u,.7*u+C]},{command:"L",values:[u,C]},{command:"L",
values:[u,0]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*u,0]},{command:"L",values:[u,0]},{command:"L",values:[.3*u,.7*u]},{command:"L",values:[0,.35*u]},{command:"Z",values:[]}]}]};q.getInvertedConeShapes=function(C){let u=C;u=u<q.SymbolSizeDefaults.size?u-3:u-6;const I=.15*u,D=u;return[{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[D,0]},{command:"L",values:[.5*D,C-I]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*u,cy:0,rx:.5*u,ry:I}]};q.getPathSymbolShapes=
function(C,u,I){var D=q.SymbolSizeDefaults.size;let z=D,Q=D;1>C?z*=.75:1<C&&(Q*=1.25);C=D;u&&I&&(z=Q=C=D=0);return[{type:"path",path:[{command:"M",values:[C,0]},{command:"L",values:[I?C:.875*C,0]},{command:"L",values:[I?z-.5*C:0,Q-.5*D]},{command:"L",values:[z-.5*C,Q-.5*D]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[C,0]},{command:"L",values:[C,u?0:.125*D]},{command:"L",values:[z-.5*C,u?Q-.5*D:D]},{command:"L",values:[z-.5*C,Q-.5*D]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",
values:[z-.5*C,Q-.5*D]},{command:"L",values:[I?z-.5*C:0,Q-.5*D]},{command:"L",values:[I?z-.5*C:0,u?Q-.5*D:D]},{command:"L",values:[z-.5*C,u?Q-.5*D:D]},{command:"Z",values:[]}]}]};q.getTetrahedronShapes=function(C){var u=C;u=u<q.SymbolSizeDefaults.size?u-1:u-2;return[{type:"path",path:[{command:"M",values:[.45*C,0]},{command:"L",values:[C,u]},{command:"L",values:[.45*C,.6*u]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*C,0]},{command:"L",values:[.45*C,.6*u]},{command:"L",
values:[0,u]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,u]},{command:"L",values:[.45*C,.6*u]},{command:"L",values:[C,u]},{command:"Z",values:[]}]}]};q.getWaterSymbolShapes=function(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},
{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},
{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]};
q.shapes={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],squareFill:[{type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 Z"}],meshSymbol3DFill:[{type:"path",path:"M -10,-8 L 6,0 L 6,6 L -10,6 L -10,-8 Z"},{type:"path",path:"M -10,-8 L -7,-10 L 9,-2 L 6,0 L -10,-8 Z"},{type:"path",path:"M 6,0 L 9,-2 L 9,4 L 6,6 L 6,0 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",
path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",
path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,
cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",
path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/renderUtils":function(){define("exports ../../kernel ../../request ../../core/colorUtils ../../core/Error ../../core/has ../../libs/maquette/projection ../../libs/maquette/projector ./svgUtils ./utils".split(" "),function(q,E,P,C,u,I,D,z,Q,F){function v(l,h){k.append(l,h);k.detach(h)}function b(l,h,e){return l?P(l,{responseType:"image"}).then(c=>{c=c.data;const g=c.width,r=
c.height,m=g/r;let A=h;e&&(A=Math.min(A,Math.max(g,r)));return{image:c,width:1>=m?Math.ceil(A*m):A,height:1>=m?A:Math.ceil(A/m)}}):Promise.reject(new u("renderUtils: imageDataSize","href not provided."))}const k=z.createProjector();q.renderOnce=v;q.renderSymbol=function(l,h,e){const c=Math.ceil(h[0]),g=Math.ceil(h[1]);if(!l.some(r=>!!r.length))return null;h=e?.node||document.createElement("div");null!=e.opacity&&(h.style.opacity=e.opacity.toString());null!=e.effectView&&(h.style.filter=F.getCSSFilterFromEffectList(e.effectView));
v(h,()=>Q.renderSVG(l,c,g,e));return h};q.tintImageWithColor=function(l,h,e,c,g){return b(l,h,g).then(r=>{const m=r.width??h,A=r.height??h;var H;if(H=r.image)H=e&&"ignore"!==c?"multiply"===c&&255===e.r&&255===e.g&&255===e.b&&1===e.a?!1:!0:!1;if(H){var J=r.image.width,f=r.image.height;I("edge")&&/\.svg$/i.test(l)&&(--J,--f);H=Math.ceil(m);var d=Math.ceil(A);var x=document.createElement("canvas");x.width=H;x.height=d;x.style.width=H+"px";x.style.height=d+"px";x=x.getContext("2d");x.clearRect(0,0,H,
d);H=x;H.drawImage(r.image,0,0,J,f,0,0,m,A);d=H.getImageData(0,0,m,A);x=[e.r/255,e.g/255,e.b/255,e.a];const y=C.toHSV(e);for(let M=0;M<d.data.length;M+=4){r=d.data;J=M;f=x;var G=y;switch(c){case "multiply":r[J]*=f[0];r[J+1]*=f[1];r[J+2]*=f[2];r[J+3]*=f[3];break;default:const L=C.toHSV({r:r[J],g:r[J+1],b:r[J+2]});L.h=G.h;L.s=G.s;L.v=L.v/100*G.v;G=C.toRGB(L);r[J]=G.r;r[J+1]=G.g;r[J+2]=G.b;r[J+3]*=f[3]}}H.putImageData(d,0,0);l=H.canvas.toDataURL("image/png")}else H=E.id?.findCredential(l),H?.token&&
(r=l.includes("?")?"\x26":"?",l=`${l}${r}token=${H.token}`);return{url:l,width:m,height:A}}).catch(()=>({url:l,width:h,height:h}))};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/core/colorUtils":function(){define(["exports","../Color","../chunks/vec4","../chunks/vec4f64"],function(q,E,P,C){function u(c,g){const r=[];let m,A;if(c[0].length!==g.length)throw Error("dimensions do not match");const H=c.length,J=c[0].length;let f=0;for(m=0;m<H;m++){for(A=f=0;A<J;A++)f+=c[m][A]*g[A];
r.push(f)}return r}function I(c){c=[c.r/255,c.g/255,c.b/255].map(g=>.04045>=g?g/12.92:((g+.055)/1.055)**2.4);c=u(h,c);return{x:100*c[0],y:100*c[1],z:100*c[2]}}function D(c){c=u(e,[c.x/100,c.y/100,c.z/100]).map(g=>Math.min(1,Math.max(.0031308>=g?12.92*g:1.055*g**(1/2.4)-.055,0)));return{r:Math.round(255*c[0]),g:Math.round(255*c[1]),b:Math.round(255*c[2])}}function z(c){c=[c.x/95.047,c.y/100,c.z/108.883].map(g=>g>(6/29)**3?g**(1/3):1/3*(29/6)**2*g+4/29);return{l:116*c[1]-16,a:500*(c[0]-c[1]),b:200*
(c[1]-c[2])}}function Q(c){const g=c.l;c=[(g+16)/116+c.a/500,(g+16)/116,(g+16)/116-c.b/200].map(r=>r>6/29?r**3:3*(6/29)**2*(r-4/29));return{x:95.047*c[0],y:100*c[1],z:108.883*c[2]}}function F(c){if("r"in c&&"g"in c&&"b"in c)return c;if("l"in c&&"c"in c&&"h"in c){var g=c.c,r=c.h;return D(Q({l:c.l,a:g*Math.cos(r),b:g*Math.sin(r)}))}if("l"in c&&"a"in c&&"b"in c)return D(Q(c));if("x"in c&&"y"in c&&"z"in c)return D(c);if("h"in c&&"s"in c&&"v"in c){r=(c.h+360)%360/60;g=c.v/100*255;c=c.s/100*g;const m=c*
(1-Math.abs(r%2-1));switch(Math.floor(r)){case 0:r={r:c,g:m,b:0};break;case 1:r={r:m,g:c,b:0};break;case 2:r={r:0,g:c,b:m};break;case 3:r={r:0,g:m,b:c};break;case 4:r={r:m,g:0,b:c};break;case 5:case 6:r={r:c,g:0,b:m};break;default:r={r:0,g:0,b:0}}r.r=Math.round(r.r+g-c);r.g=Math.round(r.g+g-c);r.b=Math.round(r.b+g-c);return r}return c}function v(c){if("h"in c&&"s"in c&&"v"in c)return c;var g=F(c);c=g.r;const r=g.g,m=g.b;g=Math.max(c,r,m);const A=g-Math.min(c,r,m);c=0===A?0:g===c?(r-m)/A%6:g===r?(m-
c)/A+2:(c-r)/A+4;0>c&&(c+=6);return{h:60*c,s:100*(0===A?0:A/g),v:100/255*g}}function b(c){return"l"in c&&"a"in c&&"b"in c?c:z(I(F(c)))}function k(c){let {r:g,g:r,b:m,a:A}=c;1>A&&(g=Math.round(A*g+255*(1-A)),r=Math.round(A*r+255*(1-A)),m=Math.round(A*m+255*(1-A)));return new E({r:g,g:r,b:m})}function l(c,g){const {r,g:m,b:A}=g?.ignoreAlpha?c:k(c);return.2126*r+.7152*m+.0722*A}const h=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],e=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,
-.204,1.057]];q.BrightnessThreshold=void 0;(function(c){c[c.Low=160]="Low";c[c.High=225]="High"})(q.BrightnessThreshold||(q.BrightnessThreshold={}));q.colorEquals=function(c,g){return c===g||null!=c&&c.equals(g)};q.colorVectorEquals=function(c,g){return c===g||null!=c&&null!=g&&P.equals(c,g)};q.colorVectorToColorAndOpacity=function(c){return C.fromValues(c[0],c[1],c[2],3<c.length?c[3]:1)};q.darken=function(c,g){var r=b(c);r.l*=1-g;g=F(r);r=c.clone();r.setColor(g);r.a=c.a;return r};q.desaturate=function(c,
g){var r=v(c);r.s*=g;g=F(r);r=c.clone();r.setColor(g);r.a=c.a;return r};q.getColorLuminance=l;q.getColorTheme=function(c){return k(c).isBright?"light":"dark"};q.getContrast=function(c,g=q.BrightnessThreshold.High){return l(c,{ignoreAlpha:!0})>g?new E([0,0,0,c.a]):new E([255,255,255,c.a])};q.multiplyOpacity=function(c,g){c=c.clone();c.a*=g;return c};q.multiplyOpacityToUnitRGBA=function(c,g){c=E.toUnitRGBA(c);c[3]*=g;return c};q.toHSV=v;q.toLAB=b;q.toLCH=function(c){if(!("l"in c&&"c"in c&&"h"in c)){var g=
z(I(F(c)));c=g.l;var r=g.a;const m=g.b;g=Math.sqrt(r*r+m*m);r=Math.atan2(m,r);r=0<r?r:r+2*Math.PI;c={l:c,c:g,h:r}}return c};q.toRGB=F;q.unitRGBAFromColor=function(c){return E.toUnitRGBA(c)};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/svgUtils":function(){define("exports ../../Color ../../core/has ../../core/maybe ../../chunks/mat2df32 ../../chunks/mat2d ../../widgets/support/widgetUtils ../../widgets/support/jsxFactory".split(" "),function(q,E,P,C,u,I,D,z){function Q(w,
n){w*=Z/180;return Math.abs(n*Math.sin(w))+Math.abs(n*Math.cos(w))}function F(w){return w.map(n=>`${n.command} ${n.values.join(" ")}`).join(" ").trim()}function v(w,n,t,R){if(w){if("circle"===w.type)return z.tsx("circle",{cx:w.cx,cy:w.cy,fill:n,"fill-rule":"evenodd",r:w.r,stroke:t.color,"stroke-dasharray":t.dashArray,"stroke-dashoffset":t.dashOffset,"stroke-linecap":t.cap,"stroke-linejoin":t.join,"stroke-miterlimit":"4","stroke-width":t.width});if("ellipse"===w.type)return z.tsx("ellipse",{cx:w.cx,
cy:w.cy,fill:n,"fill-rule":"evenodd",rx:w.rx,ry:w.ry,stroke:t.color,"stroke-dasharray":t.dashArray,"stroke-linecap":t.cap,"stroke-linejoin":t.join,"stroke-miterlimit":"4","stroke-width":t.width});if("rect"===w.type)return z.tsx("rect",{fill:n,"fill-rule":"evenodd",height:w.height,stroke:t.color,"stroke-dasharray":t.dashArray,"stroke-linecap":t.cap,"stroke-linejoin":t.join,"stroke-miterlimit":"4","stroke-width":t.width,width:w.width,x:w.x,y:w.y});if("image"===w.type)return z.tsx("image",{height:w.height,
href:w.src,preserveAspectRatio:"none",width:w.width,x:w.x,y:w.y});if("path"===w.type)return w="string"!==typeof w.path?F(w.path):w.path,z.tsx("path",{d:w,fill:n,"fill-rule":"evenodd",stroke:t.color,"stroke-dasharray":t.dashArray,"stroke-linecap":t.cap,"stroke-linejoin":t.join,"stroke-miterlimit":"4","stroke-width":t.width});if("text"===w.type)return C.assertIsSome(R),z.tsx("text",{"dominant-baseline":R.dominantBaseline,fill:n,"fill-rule":"evenodd","font-family":R.font.family,"font-size":R.font.size,
"font-style":R.font.style,"font-variant":R.font.variant,"font-weight":R.font.weight,kerning:R.kerning,rotate:R.rotate,stroke:t.color,"stroke-dasharray":t.dashArray,"stroke-linecap":t.cap,"stroke-linejoin":t.join,"stroke-miterlimit":"4","stroke-width":t.width,"text-anchor":R.align,"text-decoration":R.decoration,"text-rendering":G,x:w.x,y:w.y},w.text)}return null}function b(w){const n={fill:"none",pattern:null,linearGradient:null};if(w)if("type"in w&&"pattern"===w.type){var t=`patternId-${++d}`;n.fill=
`url(#${t})`;n.pattern={id:t,x:w.x,y:w.y,width:w.width,height:w.height,image:{x:0,y:0,width:w.width,height:w.height,href:w.src}}}else"type"in w&&"linear"===w.type?(t=`linearGradientId-${++x}`,n.fill=`url(#${t})`,n.linearGradient={id:t,x1:w.x1,y1:w.y1,x2:w.x2,y2:w.y2,stops:w.colors.map(R=>({offset:R.offset,color:R.color&&(new E(R.color)).toString()}))}):w&&(w=new E(w),n.fill=w.toString());return n}function k(w){const n={color:"none",width:1,cap:"butt",join:"4",dashArray:"none",dashOffset:"0"};if(w&&
(null!=w.width&&(n.width=w.width),w.cap&&(n.cap=w.cap),w.join&&(n.join=w.join.toString()),w.color&&(n.color=(new E(w.color)).toString()),w.dashArray&&(n.dashArray=w.dashArray),w.dashArray&&(n.dashOffset=w.dashoffset),w.style)){let t=null;w.style in T&&(t=T[w.style]);if(Array.isArray(t)){t=t.slice(0);const R=w.width??0;for(let U=0;U<t.length;++U)t[U]*=R;if("butt"!==w.cap){for(w=0;w<t.length;w+=2)t[w]-=R,1>t[w]&&(t[w]=1);for(w=1;w<t.length;w+=2)t[w]+=R}t=t.join(",")}n.dashArray=t}return n}function l(w,
n){const t={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};if(w){const R=w.alignBaseline;t.align=w.align;t.dominantBaseline="baseline"===R?"auto":"top"===R?"text-top":"bottom"===R?"hanging":R;t.decoration=w.decoration;t.kerning=w.kerning?"auto":"0";t.rotate=w.rotated?"90":"0";C.assertIsSome(n);t.font.style=n.style||"normal";t.font.variant=n.variant||"normal";t.font.weight=n.weight||"normal";t.font.size=n.size&&n.size.toString()||
"10pt";t.font.family=n.family||"serif"}return t}function h(w){const {pattern:n,linearGradient:t}=w;return n?z.tsx("pattern",{height:n.height,id:n.id,patternUnits:"userSpaceOnUse",width:n.width,x:n.x,y:n.y},z.tsx("image",{height:n.image.height,href:n.image.href,width:n.image.width,x:n.image.x,y:n.image.y})):t?(w=t.stops.map((R,U)=>z.tsx("stop",{key:`${U}-stop`,offset:R.offset,"stop-color":R.color})),z.tsx("linearGradient",{gradientUnits:"userSpaceOnUse",id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2},w)):
null}function e(w,n){if(!w||0===w.length)return null;const t=[];for(const R of w){const {shape:U,fill:aa,stroke:fa,font:ja}=R;w=b(aa);const X=k(fa),la="text"===U.type?l(U,ja):null;(w=v(U,w.fill,X,la))&&t.push(w)}return z.tsx("mask",{id:n,maskUnits:"userSpaceOnUse"},z.tsx("g",null,t))}function c(w,n,t,R,U){I.scale(w,I.identity(w),[n,t]);w[4]=w[4]*n-R*n+R;w[5]=w[5]*t-U*t+U;return w}function g(w,n){if(L&&"left"in L){null!=L.left&&L.left>w&&(L.left=w);if(null==L.right||L.right<w)L.right=w;if(null==L.top||
L.top>n)L.top=n;if(null==L.bottom||L.bottom<n)L.bottom=n}else L={left:w,bottom:n,right:w,top:n}}function r(w){const n=w.args,t=n.length;switch(w.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(w=0;w<t;w+=2)g(n[w],n[w+1]);N.x=n[t-2];N.y=n[t-1];break;case "H":for(w=0;w<t;++w)g(n[w],N.y);N.x=n[t-1];break;case "V":for(w=0;w<t;++w)g(N.x,n[w]);N.y=n[t-1];break;case "m":w=0;"x"in N||(g(N.x=n[0],N.y=n[1]),w=2);for(;w<t;w+=2)g(N.x+=n[w],N.y+=n[w+1]);break;case "l":case "t":for(w=0;w<t;w+=
2)g(N.x+=n[w],N.y+=n[w+1]);break;case "h":for(w=0;w<t;++w)g(N.x+=n[w],N.y);break;case "v":for(w=0;w<t;++w)g(N.x,N.y+=n[w]);break;case "c":for(w=0;w<t;w+=6)g(N.x+n[w],N.y+n[w+1]),g(N.x+n[w+2],N.y+n[w+3]),g(N.x+=n[w+4],N.y+=n[w+5]);break;case "s":case "q":for(w=0;w<t;w+=4)g(N.x+n[w],N.y+n[w+1]),g(N.x+=n[w+2],N.y+=n[w+3]);break;case "A":for(w=0;w<t;w+=7)g(n[w+5],n[w+6]);N.x=n[t-2];N.y=n[t-1];break;case "a":for(w=0;w<t;w+=7)g(N.x+=n[w+5],N.y+=n[w+6])}}function m(w,n,t){const R=y[w.toLowerCase()];"number"===
typeof R&&(R?n.length>=R&&(w={action:w,args:n.slice(0,n.length-n.length%R)},t.push(w),r(w)):(w={action:w,args:[]},t.push(w),r(w)))}function A(w){const n={x:0,y:0,width:0,height:0};if("circle"===w.type)n.x=w.cx-w.r,n.y=w.cy-w.r,n.width=2*w.r,n.height=2*w.r;else if("ellipse"===w.type)n.x=w.cx-w.rx,n.y=w.cy-w.ry,n.width=2*w.rx,n.height=2*w.ry;else if("image"===w.type||"rect"===w.type)n.x=w.x,n.y=w.y,n.width=w.width,n.height=w.height;else if("path"===w.type){{const U=("string"!==typeof w.path?F(w.path):
w.path).match(M),aa=[];L={};N={};if(U){w="";var t=[],R=U.length;for(let fa=0;fa<R;++fa){const ja=U[fa],X=parseFloat(ja);isNaN(X)?(w&&m(w,t,aa),t=[],w=ja):t.push(X)}m(w,t,aa);w={x:0,y:0,width:0,height:0};L&&"left"in L&&(w.x=L.left,w.y=L.top,w.width=L.right-L.left,w.height=L.bottom-L.top)}else w=null}n.x=w.x;n.y=w.y;n.width=w.width;n.height=w.height}return n}function H(w){const n={x:0,y:0,width:0,height:0};let t=null,R=Number.NEGATIVE_INFINITY,U=Number.NEGATIVE_INFINITY;for(const aa of w)t?(t.x=Math.min(t.x,
aa.x),t.y=Math.min(t.y,aa.y),R=Math.max(R,aa.x+aa.width),U=Math.max(U,aa.y+aa.height)):(t=n,t.x=aa.x,t.y=aa.y,R=aa.x+aa.width,U=aa.y+aa.height);t&&(t.width=R-t.x,t.height=U-t.y);return t}function J(w,n,t,R,U,aa,fa,ja,X){var la=(fa&&aa?Q(aa,n):n)/2,V=(fa&&aa?Q(aa,t):t)/2;if(X){var ba=X[0];X=X[1];la=(fa&&aa?Q(aa,ba):ba)/2;V=(fa&&aa?Q(aa,X):X)/2}ba=w.width+R;var da=w.height+R;X=u.create();fa=u.create();var ca=!1;if(U&&0!==ba&&0!==da){U=n!==t?n/t:ba/da;ca=n>t?n:t;let ma=1,oa=1;isNaN(ca)||(1<U?(ma=ca/
ba,oa=ca/U/da):(oa=ca/da,ma=ca*U/ba));I.multiply(fa,fa,c(X,ma,oa,la,V));ca=!0}U=w.x+(ba-R)/2;w=w.y+(da-R)/2;R=I.multiply;la-=U;V-=w;la=I.translate(X,I.identity(X),[la,V]);R.call(I,fa,fa,la);!ca&&(ba>n||da>t)&&(la=ba/n>da/t,n=(la?n:t)/(la?ba:da),I.multiply(fa,fa,c(X,n,n,U,w)));aa&&(n=I.multiply,t=aa%360*Math.PI/180,I.rotate(X,I.identity(X),t),aa=Math.cos(t),t=Math.sin(t),ba=X[4],da=X[5],X[4]=ba*aa-da*t+w*t-U*aa+U,X[5]=da*aa+ba*t-U*t-w*aa+w,n.call(I,fa,fa,X));ja&&(aa=I.multiply,n=ja[0],ja=ja[1],ja=
I.translate(X,I.identity(X),[n,ja]),aa.call(I,fa,fa,ja));return`matrix(${fa[0]},${fa[1]},${fa[2]},${fa[3]},${fa[4]},${fa[5]})`}function f(w,n,t){w=w?.effects.find(ja=>"bloom"===ja.type);if(!w)return null;const {strength:R,radius:U}=w;w=0<R?U:0;const aa=(R+w)*n,fa=4*R+1;return z.tsx("filter",{filterUnits:"userSpaceOnUse",height:"300%",id:`bloom${t}`,width:"300%",x:"-100%",y:"-100%"},z.tsx("feMorphology",{in:"SourceGraphic",operator:"dilate",radius:(R+.5*w)*5**(n/100)*(.4+n/100),result:"dilate"}),z.tsx("feGaussianBlur",
{in:"dilate",result:"blur",stdDeviation:aa/25}),z.tsx("feGaussianBlur",{in:"blur",result:"intensityBlur",stdDeviation:aa/50}),z.tsx("feComponentTransfer",{in:"SourceGraphic",result:"intensityBrightness"},z.tsx("feFuncR",{slope:fa,type:"linear"}),z.tsx("feFuncG",{slope:fa,type:"linear"}),z.tsx("feFuncB",{slope:fa,type:"linear"})),z.tsx("feMerge",null,z.tsx("feMergeNode",{in:"intensityBlur"}),z.tsx("feMergeNode",{in:"intensityBrightness"}),z.tsx("feGaussianBlur",{stdDeviation:R/10})))}let d=0,x=0;D=
P("android");const G=P("chrome")||D&&4<=D?"auto":"optimizeLegibility",y={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},M=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g;let L={},N={};const T={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]},Z=Math.PI;let W=1;q.computeBBox=H;q.generateFillAttributes=b;q.generateStrokeAttributes=k;q.generateTextAttributes=
l;q.getBoundingBox=A;q.getTransformMatrix=J;q.renderDef=h;q.renderSVG=function(w,n,t,R={}){const U=[],aa=[],fa=++W,ja=f(R.effectView,n,fa);var X=null;ja&&(X=R.effectView?.effects.find(ca=>"bloom"===ca.type),X=(X.strength?X.strength+X.radius/2:0)/3,X=[Math.max(n+n*X,10),Math.max(t+t*X,10)]);for(let ca=0;ca<w.length;ca++){var la=w[ca];const ma=[];var V=[],ba=0,da=0;let oa=0;for(const sa of la){const {shape:ua,fill:xa,stroke:wa,font:Ea,offset:Aa}=sa;R.ignoreStrokeWidth||"text"===ua.type||(ba+=wa?.width||
0);la=b(xa);const Ka=k(wa),Fa="text"===ua.type?l(ua,Ea):null;U.push(h(la));ma.push(v(ua,la.fill,Ka,Fa));V.push(A(ua));Aa&&(da+=Aa[0],oa+=Aa[1])}V=H(V);ba=J(V,n,t,ba,R.scale??!1,R.rotation,R.useRotationSize??!1,[da,oa],X);da=null;R.masking&&(da=`mask-${ca}`,U.push(e(R.masking[ca],da)),da=`url(#${da})`);aa.push(da?z.tsx("g",{mask:da},z.tsx("g",{transform:ba},ma)):z.tsx("g",{transform:ba},ma))}R.useRotationSize&&R.rotation&&(n=Q(R.rotation,n),t=Q(R.rotation,t));ja&&(C.assertIsSome(X),n=X[0],t=X[1]);
return z.tsx("svg",{"aria-labelledby":R.ariaLabel,focusable:!1,height:t,role:"img",style:"display: block;",width:n,xmlns:"http://www.w3.org/2000/svg"},ja,z.tsx("defs",null,U),ja?z.tsx("g",{filter:`url(#bloom${fa})`},aa):aa)};q.renderShape=v;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/mat2df32":function(){define(["exports"],function(q){function E(){const Q=new Float32Array(6);Q[0]=1;Q[3]=1;return Q}function P(Q){const F=new Float32Array(6);F[0]=Q[0];F[1]=Q[1];F[2]=
Q[2];F[3]=Q[3];F[4]=Q[4];F[5]=Q[5];return F}function C(Q,F,v,b,k,l){const h=new Float32Array(6);h[0]=Q;h[1]=F;h[2]=v;h[3]=b;h[4]=k;h[5]=l;return h}function u(Q,F){return new Float32Array(Q,F,6)}function I(Q,F,v,b){const k=F[b];F=F[b+1];Q[b]=v[0]*k+v[2]*F+v[4];Q[b+1]=v[1]*k+v[3]*F+v[5]}function D(Q,F,v,b=0,k=0,l=2){for(k=k||F.length/l;b<k;b++)I(Q,F,v,b*l)}const z=Object.freeze(Object.defineProperty({__proto__:null,clone:P,create:E,createView:u,fromValues:C,transform:I,transformMany:D},Symbol.toStringTag,
{value:"Module"}));q.clone=P;q.create=E;q.createView=u;q.fromValues=C;q.mat2df32=z;q.transform=I;q.transformMany=D})},"esri/chunks/mat2d":function(){define(["exports","./common"],function(q,E){function P(f,d){f[0]=d[0];f[1]=d[1];f[2]=d[2];f[3]=d[3];f[4]=d[4];f[5]=d[5];return f}function C(f){f[0]=1;f[1]=0;f[2]=0;f[3]=1;f[4]=0;f[5]=0;return f}function u(f,d,x,G,y,M,L){f[0]=d;f[1]=x;f[2]=G;f[3]=y;f[4]=M;f[5]=L;return f}function I(f,d){const x=d[0],G=d[1],y=d[2],M=d[3],L=d[4];d=d[5];let N=x*M-G*y;if(!N)return null;
N=1/N;f[0]=M*N;f[1]=-G*N;f[2]=-y*N;f[3]=x*N;f[4]=(y*d-M*L)*N;f[5]=(G*L-x*d)*N;return f}function D(f){return f[0]*f[3]-f[1]*f[2]}function z(f,d,x){const G=d[0],y=d[1],M=d[2],L=d[3],N=d[4];d=d[5];const T=x[0],Z=x[1],W=x[2],w=x[3],n=x[4];x=x[5];f[0]=G*T+M*Z;f[1]=y*T+L*Z;f[2]=G*W+M*w;f[3]=y*W+L*w;f[4]=G*n+M*x+N;f[5]=y*n+L*x+d;return f}function Q(f,d,x){const G=d[0],y=d[1],M=d[2],L=d[3],N=d[4];d=d[5];const T=Math.sin(x);x=Math.cos(x);f[0]=G*x+M*T;f[1]=y*x+L*T;f[2]=G*-T+M*x;f[3]=y*-T+L*x;f[4]=N;f[5]=d;
return f}function F(f,d,x){const G=d[1],y=d[2],M=d[3],L=d[4],N=d[5],T=x[0];x=x[1];f[0]=d[0]*T;f[1]=G*T;f[2]=y*x;f[3]=M*x;f[4]=L;f[5]=N;return f}function v(f,d,x){const G=d[0],y=d[1],M=d[2],L=d[3],N=d[4];d=d[5];const T=x[0];x=x[1];f[0]=G;f[1]=y;f[2]=M;f[3]=L;f[4]=G*T+M*x+N;f[5]=y*T+L*x+d;return f}function b(f,d){const x=Math.sin(d);d=Math.cos(d);f[0]=d;f[1]=x;f[2]=-x;f[3]=d;f[4]=0;f[5]=0;return f}function k(f,d){f[0]=d[0];f[1]=0;f[2]=0;f[3]=d[1];f[4]=0;f[5]=0;return f}function l(f,d){f[0]=1;f[1]=0;
f[2]=0;f[3]=1;f[4]=d[0];f[5]=d[1];return f}function h(f){return"mat2d("+f[0]+", "+f[1]+", "+f[2]+", "+f[3]+", "+f[4]+", "+f[5]+")"}function e(f){return Math.sqrt(f[0]**2+f[1]**2+f[2]**2+f[3]**2+f[4]**2+f[5]**2+1)}function c(f,d,x){f[0]=d[0]+x[0];f[1]=d[1]+x[1];f[2]=d[2]+x[2];f[3]=d[3]+x[3];f[4]=d[4]+x[4];f[5]=d[5]+x[5];return f}function g(f,d,x){f[0]=d[0]-x[0];f[1]=d[1]-x[1];f[2]=d[2]-x[2];f[3]=d[3]-x[3];f[4]=d[4]-x[4];f[5]=d[5]-x[5];return f}function r(f,d,x){f[0]=d[0]*x;f[1]=d[1]*x;f[2]=d[2]*x;
f[3]=d[3]*x;f[4]=d[4]*x;f[5]=d[5]*x;return f}function m(f,d,x,G){f[0]=d[0]+x[0]*G;f[1]=d[1]+x[1]*G;f[2]=d[2]+x[2]*G;f[3]=d[3]+x[3]*G;f[4]=d[4]+x[4]*G;f[5]=d[5]+x[5]*G;return f}function A(f,d){return f[0]===d[0]&&f[1]===d[1]&&f[2]===d[2]&&f[3]===d[3]&&f[4]===d[4]&&f[5]===d[5]}function H(f,d){const x=f[0],G=f[1],y=f[2],M=f[3],L=f[4];f=f[5];const N=d[0],T=d[1],Z=d[2],W=d[3],w=d[4];d=d[5];const n=E.getEpsilon();return Math.abs(x-N)<=n*Math.max(1,Math.abs(x),Math.abs(N))&&Math.abs(G-T)<=n*Math.max(1,Math.abs(G),
Math.abs(T))&&Math.abs(y-Z)<=n*Math.max(1,Math.abs(y),Math.abs(Z))&&Math.abs(M-W)<=n*Math.max(1,Math.abs(M),Math.abs(W))&&Math.abs(L-w)<=n*Math.max(1,Math.abs(L),Math.abs(w))&&Math.abs(f-d)<=n*Math.max(1,Math.abs(f),Math.abs(d))}const J=Object.freeze(Object.defineProperty({__proto__:null,add:c,copy:P,determinant:D,equals:H,exactEquals:A,frob:e,fromRotation:b,fromScaling:k,fromTranslation:l,identity:C,invert:I,mul:z,multiply:z,multiplyScalar:r,multiplyScalarAndAdd:m,rotate:Q,scale:F,set:u,str:h,sub:g,
subtract:g,translate:v},Symbol.toStringTag,{value:"Module"}));q.add=c;q.copy=P;q.determinant=D;q.equals=H;q.exactEquals=A;q.frob=e;q.fromRotation=b;q.fromScaling=k;q.fromTranslation=l;q.identity=C;q.invert=I;q.mat2d=J;q.mul=z;q.multiply=z;q.multiplyScalar=r;q.multiplyScalarAndAdd=m;q.rotate=Q;q.scale=F;q.set=u;q.str=h;q.sub=g;q.subtract=g;q.translate=v})},"esri/symbols/support/utils":function(){define("require exports ../../Color ../../symbols ../../core/asyncUtils ../../core/has ../../core/screenUtils ../../chunks/vec3f64 ../../layers/effects/jsonUtils ./cimSymbolUtils ./gfxUtils ./Symbol3DMaterial".split(" "),
function(q,E,P,C,u,I,D,z,Q,F,v,b){function k(f){f=f.symbolLayers;if(!f)return null;let d=null;f.forEach(x=>{"object"===x.type&&x.resource?.href||(d="water"===x.type?x.color:x.material?x.material.color:null)});return d?new P(d):null}function l(f,d){if(null==d||null==f)return f;f=f.toRgba();f[3]*=d;return new P(f)}function h(f,d,x){if(f=f.symbolLayers){var G=y=>{d=d??y??(null!=x?J:null);return l(d,x)};f.forEach(y=>{if("object"!==y.type||!y.resource?.href||d)if("water"===y.type)y.color=G(y.color);else{const M=
G(null!=y.material?y.material.color:null);null==y.material?y.material=new b.Symbol3DMaterial({color:M}):y.material.color=M;null!=x&&"outline"in y&&null!=y.outline?.color&&(y.outline.color=l(y.outline.color,x))}})}}async function e(f,d){(f=f.symbolLayers)&&await u.forEach(f,async x=>c(x,d))}async function c(f,d){switch(f.type){case "extrude":f.size="number"===typeof d[2]?d[2]:0;break;case "icon":case "line":case "text":d=g(d);null!=d&&(f.size=d);break;case "path":const x=m(d,z.ONES,[f.width,void 0,
f.height]);f.width=H(d[0],f.width,1,x);f.height=H(d[2],f.height,1,x);break;case "object":await r(f,d)}}function g(f){for(const d of f)if("number"===typeof d)return d;return null}async function r(f,d){const {resourceSize:x,symbolSize:G}=await A(f),y=m(d,x,G);f.width=H(d[0],G[0],x[0],y);f.depth=H(d[1],G[1],x[1],y);f.height=H(d[2],G[2],x[2],y)}function m(f,d,x){for(let G=0;3>G;G++){const y=f[G];switch(y){case "symbol-value":return f=x[G],null!=f?f/d[G]:1;case "proportional":break;default:if(y&&d[G])return y/
d[G]}}return 1}async function A(f){var {computeObjectLayerResourceSize:d}=await new Promise((N,T)=>q(["./symbolLayerUtils"],N,T));d=await d(f,10);const {width:x,height:G,depth:y}=f;f=[x,y,G];let M=1;for(var L=0;3>L;L++){const N=f[L];if(null!=N){M=N/d[L];break}}for(L=0;3>L;L++)null==f[L]&&(f[L]=d[L]*M);return{resourceSize:d,symbolSize:f}}function H(f,d,x,G){switch(f){case "proportional":return x*G;case "symbol-value":return null!=d?d:x;default:return f}}const J=new P("white");E.applyColorToSymbol=
function(f,d,x){if(f&&(d||null!=x))if(d&&(d=new P(d)),C.isSymbol3D(f))h(f,d,x);else if(C.isSymbol2D(f)){if(d=d??f.color)f.color=l(d,x);null!=x&&"outline"in f&&f.outline?.color&&(f.outline.color=l(f.outline.color,x))}};E.applyOpacityToColor=l;E.applyRotationToSymbol=function(f,d,x){f&&null!=d&&(C.isSymbol3D(f)?(f=f.symbolLayers)&&f.forEach(G=>{if(G&&"object"===G.type)switch(x){case "tilt":G.tilt=d;break;case "roll":G.roll=d;break;default:G.heading=d}}):!C.isSymbol2D(f)||"simple-marker"!==f.type&&"picture-marker"!==
f.type&&"text"!==f.type||(f.angle=d))};E.applySizesToSymbol=async function(f,d){if(f&&d){if(C.isSymbol3D(f))return e(f,d);if(C.isSymbol2D(f)&&(d=g(d),null!=d))switch(f.type){case "simple-marker":f.size=d;break;case "picture-marker":const x=f.width/f.height;1<x?(f.width=d,f.height=d*x):(f.width=d*x,f.height=d);break;case "simple-line":f.width=d;break;case "text":f.font.size=d}}};E.fetchWebStyleSymbol=async function(f,d){const x=await f.fetchSymbol(d);return x?x:f.fetchCIMSymbol(d)};E.getCSSFilterFromEffectList=
function(f){if(!f)return null;f=f.effects.filter(d=>"bloom"!==d.type).map(d=>d.toJSON());return Q.effectFunctionsFromJSON(f)};E.getColorFromSymbol=function(f,d){if(!f)return null;let x=null;C.isSymbol3D(f)?x=k(f):C.isSymbol2D(f)&&(x="cim"===f.type?F.getCIMSymbolColor(f):f.color?new P(f.color):null);return x?l(x,d):null};E.getIconHref=function(f){return f.resource?.href??""};E.getSymbolOutlineSize=function(f){return f?C.isSymbol3D(f)?(f=(f=f.symbolLayers?.at(-1))&&"outline"in f?f?.outline?.size:void 0,
null!=f?f:0):D.px2pt(v.getStroke(f)?.width):0};E.isVolumetricSymbol=function(f){if(null==f||!("symbolLayers"in f)||null==f.symbolLayers)return!1;switch(f.type){case "point-3d":return f.symbolLayers.some(d=>"object"===d.type);case "line-3d":return f.symbolLayers.some(d=>"path"===d.type);case "polygon-3d":return f.symbolLayers.some(d=>"object"===d.type||"extrude"===d.type);default:return!1}};E.symbolHasExtrudeSymbolLayer=function(f){return null!=f&&"polygon-3d"===f.type&&f.symbolLayers.some(d=>"extrude"===
d.type)};Object.defineProperty(E,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/gfxUtils":function(){define("exports ../../assets ../../Color ../../request ../../core/LRUCache ../../core/screenUtils ./cimSymbolUtils".split(" "),function(q,E,P,C,u,I,D){function z(v){if(!v)return null;let b=null;switch(v.type){case "simple-fill":case "picture-fill":case "simple-marker":b=z(v.outline);break;case "simple-line":const k=I.pt2px(v.width);null!=v.style&&"none"!==v.style&&0!==k&&(b={color:v.color,
style:F(v.style),width:k,cap:v.cap,join:"miter"===v.join?I.pt2px(v.miterLimit):v.join});break;default:b=null}return b}const Q=new u.LRUCache(1E3),F=(()=>{const v={};return b=>{if(v[b])return v[b];const k=b.replaceAll("-","");return v[b]=k}})();P=new P([128,128,128]);q.defaultThematicColor=P;q.dekebabifyLineStyle=F;q.getFill=function(v){const b=v.style;let k=null;if(v)switch(v.type){case "simple-marker":"cross"!==b&&"x"!==b&&(k=v.color);break;case "simple-fill":"solid"===b?k=v.color:"none"!==b&&(k=
{type:"pattern",x:0,y:0,src:E.getAssetUrl(`esri/symbols/patterns/${b}.png`),width:5,height:5});break;case "picture-fill":k={type:"pattern",src:v.url,width:I.pt2px(v.width)*v.xscale,height:I.pt2px(v.height)*v.yscale,x:I.pt2px(v.xoffset),y:I.pt2px(v.yoffset)};break;case "text":k=v.color;break;case "cim":k=D.getCIMSymbolColor(v)}return k};q.getPatternUrlWithColor=function(v,b){const k=v+"-"+b;return void 0!==Q.get(k)?Promise.resolve(Q.get(k)):C(v,{responseType:"image"}).then(l=>{l=l.data;const h=l.naturalWidth,
e=l.naturalHeight,c=document.createElement("canvas");c.width=h;c.height=e;const g=c.getContext("2d");g.fillStyle=b;g.fillRect(0,0,h,e);g.globalCompositeOperation="destination-in";g.drawImage(l,0,0);l=c.toDataURL();Q.put(k,l);return l})};q.getStroke=z;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/symbolUtils":function(){define("require exports ../../core/has ../../support/arcadeOnDemand ./gfxUtils ./previewUtils ./renderUtils ./utils ../../widgets/Legend/styles/support/relationshipUtils ../../widgets/Legend/support/relationshipRampUtils".split(" "),
function(q,E,P,C,u,I,D,z,Q,F){function v(e,c){if(c&&(e.style.filter=z.getCSSFilterFromEffectList(c),c=c.effects))for(const g of c)if("drop-shadow"===g?.type){0>g.offsetX?e.style.marginLeft=`${Math.abs(g.offsetX)}px`:e.style.marginRight=`${g.offsetX}px`;break}}async function b(e,c){switch(e.type){case "web-style":var {previewWebStyleSymbol:g}=await new Promise((r,m)=>q(["./previewWebStyleSymbol"],r,m));return g(e,b,c);case "label-3d":case "line-3d":case "mesh-3d":case "point-3d":case "polygon-3d":return{previewSymbol3D:g}=
await new Promise((r,m)=>q(["./previewSymbol3D"],r,m)),g(e,c);case "simple-marker":case "simple-line":case "simple-fill":case "picture-marker":case "picture-fill":case "text":return{previewSymbol2D:g}=await new Promise((r,m)=>q(["./previewSymbol2D"],r,m)),g(e,c);case "cim":return{previewCIMSymbol:g}=await new Promise((r,m)=>q(["./previewCIMSymbol"],r,m)),g(e,c)}}function k(e){return e&&"opacity"in e?e.opacity*k(e.parent):1}let l=null;const h=[255,255,255];E.getDisplayedColor=async function(e,c){if(e){var g=
e.layer,r=e.sourceLayer,m=k(g??r);if(null!=e.symbol&&(null==c||!0!==c.ignoreGraphicSymbol))return e="web-style"===e.symbol.type?await z.fetchWebStyleSymbol(e.symbol,c):e.symbol.clone(),z.getColorFromSymbol(e,m);if(r=(g=c?.renderer||(g&&"renderer"in g?g.renderer:void 0)||(r&&"renderer"in r?r.renderer:void 0))&&"getSymbolAsync"in g?await g.getSymbolAsync(e,c):void 0){r="web-style"===r.type?await z.fetchWebStyleSymbol(r,c):r.clone();r=z.getColorFromSymbol(r,m);if(!(g&&"visualVariables"in g)||"visualVariables"in
g&&!g.visualVariables||"visualVariables"in g&&!g.visualVariables?.length)return r;"arcadeRequiredForVisualVariables"in g&&g.arcadeRequiredForVisualVariables&&null==c?.arcade&&(c={...c},c.arcade=await C.loadArcade());var {getColor:A,getOpacity:H}=await new Promise((x,G)=>q(["../../renderers/visualVariables/support/visualVariableUtils"],x,G)),J=[],f=[];for(var d of g.visualVariables)switch(d.type){case "color":J.push(d);break;case "opacity":f.push(d)}d=(d=0<J.length?J[J.length-1]:null)?A(d,e,c):r;e=
(g=0<f.length?f[f.length-1]:null)?H(g,e,c):null;null!=m&&(e=null!=e?e*m:m);return d?z.applyOpacityToColor(d,e):null}}};E.getDisplayedSymbol=async function(e,c){if(e){var g=e.sourceLayer,r=(null!=c&&(c.useSourceLayer??!1)?g:e.layer)??g;g=k(r);if(null!=e.symbol&&(null==c||!0!==c.ignoreGraphicSymbol))return e="web-style"===e.symbol.type?await z.fetchWebStyleSymbol(e.symbol,{...c,cache:null!=c?c.webStyleCache:null}):e.symbol.clone(),z.applyColorToSymbol(e,null,g),e;var m=(null!=c?c.renderer:null)??(r&&
"renderer"in r?r.renderer:null);if(r=m&&"getSymbolAsync"in m?await m.getSymbolAsync(e,c):null){r="web-style"===r.type?await r.fetchSymbol({...c,cache:null!=c?c.webStyleCache:null}):r.clone();if(!(m&&"visualVariables"in m&&m.visualVariables?.length))return z.applyColorToSymbol(r,null,g),r;"arcadeRequiredForVisualVariables"in m&&m.arcadeRequiredForVisualVariables&&null==c?.arcade&&(c={...c},c.arcade=await C.loadArcade());var {getColor:A,getOpacity:H,getAllSizes:J,getRotationAngle:f}=await new Promise((L,
N)=>q(["../../renderers/visualVariables/support/visualVariableUtils"],L,N)),d=[],x=[],G=[],y=[];for(var M of m.visualVariables)switch(M.type){case "color":d.push(M);break;case "opacity":x.push(M);break;case "rotation":y.push(M);break;case "size":M.target||G.push(M)}M=(M=!!d.length&&d[d.length-1])?A(M,e,c):null;x=(x=!!x.length&&x[x.length-1])?H(x,e,c):null;null!=g&&(x=null!=x?x*g:g);z.applyColorToSymbol(r,M,x);G.length&&(g=J(G,e,c),await z.applySizesToSymbol(r,g));for(const L of y)z.applyRotationToSymbol(r,
f(L,e,c),L.axis);return r}}};E.renderColorRampPreviewHTML=function(e,c={}){var g="horizontal"===c.align;const r=c.width??(g?75:24),m=c.height??(g?24:75);var A=c.gradient??!0,H=window.devicePixelRatio,J=r*H,f=m*H;H=document.createElement("canvas");H.width=J;H.height=f;H.ariaLabel=c.ariaLabel??null;H.style.width=`${r}px`;H.style.height=`${m}px`;const d=H.getContext("2d");var x=g?J:0;const G=g?0:f;if(A){const y=d.createLinearGradient(0,0,x,G);g=e.length;const M=1===g?0:1/(g-1);e.forEach((L,N)=>y.addColorStop(N*
M,L.toString()));d.fillStyle=y;d.fillRect(0,0,J,f)}else{J=g?J/e.length:J;f=g?f:f/e.length;x=A=0;for(const y of e)d.fillStyle=y.toString(),d.fillRect(A,x,J,f),A=g?A+J:0,x=g?0:x+f}e=document.createElement("div");e.style.width=`${r}px`;e.style.height=`${m}px`;v(e,c?.effectList);e.appendChild(H);return e};E.renderDotDensityPreviewHTML=function(e,c,g){const {backgroundColor:r,outline:m,dotSize:A}=e;var H=g?.swatchSize||I.SymbolSizeDefaults.size;const J=Math.round(H*H/A**2*.8),f=window.devicePixelRatio;
e=document.createElement("canvas");const d=H*f;e.width=d;e.height=d;e.style.width=`${e.width/f}px`;e.style.height=`${e.height/f}px`;const x=e.getContext("2d");r&&(x.fillStyle=r.toCss(!0),x.fillRect(0,0,d,d),x.fill());x.fillStyle=c?.toCss(!0)??"";if(l&&l.length/2===J)for(c=0;c<2*J;c+=2)x.fillRect(l[c],l[c+1],A*f,A*f),x.fill();else for(l=[],c=0;c<2*J;c+=2){const G=Math.floor(Math.random()*(d-0+1)),y=Math.floor(Math.random()*(d-0+1));l.push(G,y);x.fillRect(G,y,A*f,A*f);x.fill()}m&&(m.color&&(x.strokeStyle=
m.color.toCss(!0)),x.lineWidth=m.width,x.strokeRect(0,0,d,d));H=new Image(H,H);H.src=e.toDataURL();H.ariaLabel=g?.ariaLabel??null;H.alt=g?.ariaLabel??"";return H};E.renderPieChartPreviewHTML=function(e,c={}){const g=c.radius||40;var r=2*Math.PI*g,m=e.length;const A=r/m,H=[],J=u.getStroke(c.outline);null!=J?.width&&(J.width*=2);(J||c.backgroundColor)&&H.push({shape:{type:"circle",cx:g,cy:g,r:g},fill:c.backgroundColor,stroke:J,offset:[0,0]});const f=c.values,d=f&&f.length===m&&100===f.reduce((G,y)=>
G+y,0),x=[0];for(let G=0;G<m;G++){let y=null;d&&(y=f[G]*r/100,x.push(y+x[G]));H.push({shape:{type:"circle",cx:g,cy:g,r:g/2},fill:[0,0,0,0],stroke:{width:g,dashArray:`${(y??A)/2} ${r}`,dashoffset:`-${d?x[G]/2:A/2*G}`,color:e[G]},offset:[0,0]})}m=null;e=2*g+(J?.width||0);if(r=c.holePercentage)J&&H.push({shape:{type:"circle",cx:g,cy:g,r:g*r},fill:null,stroke:J,offset:[0,0]}),m=e/2,m=[[{shape:{type:"circle",cx:m,cy:m,r:m},fill:h,stroke:J?{...J,color:h}:null,offset:[0,0]},{shape:{type:"circle",cx:m,cy:m,
r:g*r},fill:[0,0,0],stroke:null,offset:[0,0]}]];return D.renderSymbol([H],[e,e],{effectView:c.effectList,ignoreStrokeWidth:!0,masking:m,rotation:-90,ariaLabel:c.ariaLabel})};E.renderPreviewHTML=b;E.renderRelationshipRampPreviewHTML=function(e,c={}){const g=e?.authoringInfo;if("relationship"!==g?.type||!g?.numClasses||!e.uniqueValueInfos)return null;const {focus:r,numClasses:m}=g,A=F.getRelationshipRampElement({focus:r,numClasses:m,infos:e.uniqueValueInfos});e=c?.node||document.createElement("div");
D.renderOnce(e,()=>Q.renderRelationshipRamp(A,c.id||"relationship",{opacity:c.opacity||1,effectList:c.effectList,ariaLabel:c.ariaLabel}));return e};Object.defineProperty(E,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/styles/support/relationshipUtils":function(){define(["exports","../../../../symbols/support/svgUtils","../../../../symbols/support/utils","../../../support/widgetUtils","../../../support/jsxFactory"],function(q,E,P,C,u){function I(Q,F,v){const b=`${v}_arrowStart`;v=`${v}_arrowEnd`;
Q="left"===Q;const k={markerStart:null,markerEnd:null};switch(F){case "HL":Q?k.markerStart=`url(#${v})`:k.markerEnd=`url(#${b})`;break;case "LL":k.markerStart=`url(#${v})`;break;case "LH":Q?k.markerEnd=`url(#${b})`:k.markerStart=`url(#${v})`;break;default:k.markerEnd=`url(#${b})`}return k}function D(Q,F,v={}){const {focus:b,numClasses:k,colors:l,rotation:h}=Q,{opacity:e,effectList:c,ariaLabel:g}=v;Q=v.size??60;v=!!b;const r=Math.sqrt(Q**2+Q**2)+(v?0:5),m=[],A=[];var H=[],J=(Q||75)/k;for(var f=0;f<
k;f++){var d=f*J;for(var x=0;x<k;x++){var G=x*J,y=E.generateFillAttributes(l[f][x]);const M=E.generateStrokeAttributes(null);G={type:"rect",x:G,y:d,width:J,height:J};const L=E.renderDef(y);L&&m.push(L);(y=E.renderShape(G,y.fill,M,null))&&A.push(y);H.push(E.getBoundingBox(G))}}J=null;v||(J="margin: -15px -15px -18px -15px");f=I("left",b,F);d=I("right",b,F);x=E.computeBBox(H);H=E.getTransformMatrix(x,r,r,0,!1,h,!1);x=E.getTransformMatrix(x,r,r,0,!1,v?-45:null,!1);y={filter:P.getCSSFilterFromEffectList(c)??
void 0,opacity:null==e?"":`${e}`};return u.tsx("div",{class:v?z.diamondMidColRamp:z.squareTableCell,styles:y},u.tsx("svg",{"aria-labelledBy":g,focusable:!1,height:r,role:"image",style:J,width:r,xmlns:"http://www.w3.org/2000/svg"},u.tsx("defs",null,u.tsx("marker",{id:`${F}_arrowStart`,markerHeight:"10",markerUnits:"strokeWidth",markerWidth:"10",orient:"auto",refX:"5",refY:"5"},u.tsx("polyline",{fill:"none",points:"0,0 5,5 0,10",stroke:"#555555","stroke-width":"1"})),u.tsx("marker",{id:`${F}_arrowEnd`,
markerHeight:"10",markerUnits:"strokeWidth",markerWidth:"10",orient:"auto",refX:"0",refY:"5"},u.tsx("polyline",{fill:"none",points:"5,0 0,5 5,10",stroke:"#555555","stroke-width":"1"})),m),u.tsx("g",{transform:H},A),u.tsx("g",{transform:x},u.tsx("line",{fill:"none","marker-end":f.markerEnd,"marker-start":f.markerStart,stroke:"#555555","stroke-width":"1",x1:-10,x2:-10,y1:Q-15,y2:15}),u.tsx("line",{fill:"none","marker-end":d.markerEnd,"marker-start":d.markerStart,stroke:"#555555","stroke-width":"1",
x1:15,x2:Q-15,y1:Q+10,y2:Q+10}))))}const z={diamondContainer:"esri-relationship-ramp--diamond__container",diamondLeftCol:"esri-relationship-ramp--diamond__left-column",diamondRightCol:"esri-relationship-ramp--diamond__right-column",diamondMidCol:"esri-relationship-ramp--diamond__middle-column",diamondMidColLabel:"esri-relationship-ramp--diamond__middle-column--label",diamondMidColRamp:"esri-relationship-ramp--diamond__middle-column--ramp",squareTable:"esri-relationship-ramp--square__table",squareTableRow:"esri-relationship-ramp--square__table-row",
squareTableCell:"esri-relationship-ramp--square__table-cell",squareTableLabel:"esri-relationship-ramp--square__table-label",squareTableLabelLeftBottom:"esri-relationship-ramp--square__table-label--left-bottom",squareTableLabelRightBottom:"esri-relationship-ramp--square__table-label--right-bottom",squareTableLabelLeftTop:"esri-relationship-ramp--square__table-label--left-top",squareTableLabelRightTop:"esri-relationship-ramp--square__table-label--right-top"};q.renderRelationshipRamp=function(Q,F,v=
{}){const {focus:b,labels:k}=Q,l=!!b;Q=D(Q,F,v);F={justifyContent:"center"};v=C.isRTL();return l?u.tsx("div",{class:z.diamondContainer,styles:F},u.tsx("div",{class:z.diamondLeftCol},v?k.right:k.left),u.tsx("div",{class:z.diamondMidCol},u.tsx("div",{class:z.diamondMidColLabel},k.top),Q,u.tsx("div",{class:z.diamondMidColLabel},k.bottom)),u.tsx("div",{class:z.diamondRightCol},v?k.left:k.right)):u.tsx("div",{class:z.squareTable},u.tsx("div",{class:z.squareTableRow},u.tsx("div",{class:C.classes(z.squareTableCell,
z.squareTableLabel,z.squareTableLabelRightBottom)},v?k.top:k.left),u.tsx("div",{class:z.squareTableCell}),u.tsx("div",{class:C.classes(z.squareTableCell,z.squareTableLabel,z.squareTableLabelLeftBottom)},v?k.left:k.top)),u.tsx("div",{class:z.squareTableRow},u.tsx("div",{class:z.squareTableCell}),Q,u.tsx("div",{class:z.squareTableCell})),u.tsx("div",{class:z.squareTableRow},u.tsx("div",{class:C.classes(z.squareTableCell,z.squareTableLabel,z.squareTableLabelRightTop)},v?k.right:k.bottom),u.tsx("div",
{class:z.squareTableCell}),u.tsx("div",{class:C.classes(z.squareTableCell,z.squareTableLabel,z.squareTableLabelLeftTop)},v?k.bottom:k.right)))};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/relationshipRampUtils":function(){define(["exports","../../../core/lang","../../../symbols/support/gfxUtils","../../../symbols/support/previewSymbol3D"],function(q,E,P,C){function u(F){if(F){var {type:v}=F;return v.includes("3d")?C.getSymbolLayerFill(F.symbolLayers.at(0)):
"simple-line"===v||"simple-marker"===F.type&&("x"===F.style||"cross"===F.style)?(F=P.getStroke(F))&&F.color:P.getFill(F)}}function I(F,v){const b=v.HH.label,k=v.LL.label,l=v.HL.label;v=v.LH.label;switch(F){case "HH":return{top:b,bottom:k,left:l,right:v};case "HL":return{top:l,bottom:v,left:k,right:b};case "LL":return{top:k,bottom:b,left:v,right:l};case "LH":return{top:v,bottom:l,left:b,right:k};default:return{top:b,bottom:k,left:l,right:v}}}function D(F){let v=z[F];F&&null==v&&(v=z.HH);return v||
0}const z={HH:315,HL:45,LL:135,LH:225},Q={2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};q.getRelationshipRampColors2D=function(F,v){const b=[],k=F.length**.5;F=E.clone(F);var l=(v||"HH").split("");v=l[0];for(l="H"===l[1];F.length;){const h=[];for(;h.length<k;)h.push(F.shift());l&&h.reverse();b.push(h)}"L"===v&&b.reverse();return b};q.getRelationshipRampElement=
function(F){const {focus:v,infos:b,numClasses:k}=F;var l=Q[k];const h={};b.forEach(e=>{h[e.value]={label:e.label,fill:u(e.symbol)}});F=[];for(let e=0;e<k;e++){const c=[];for(let g=0;g<k;g++)c.push(h[l[e][g]].fill);F.push(c)}l=I(v,h);return{type:"relationship-ramp",numClasses:k,focus:v,colors:F,labels:l,rotation:D(v)}};q.getRotationAngleForFocus=D;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/previewSymbol3D":function(){define("exports ../../assets ../../core/colorUtils ../../core/has ../../core/Error ../../core/Logger ../../core/screenUtils ./gfxUtils ./IconSymbol3DLayerResource ./ObjectSymbol3DLayerResource ./previewUtils ./renderUtils ./utils ./webStyleSymbolUtils".split(" "),
function(q,E,P,C,u,I,D,z,Q,F,v,b,k,l){function h(n){const t=n.outline;var R=null!=n.material?n.material.color:null;R=null!=R?R.toHex():null;if(null==t||"pattern"in t&&null!=t.pattern&&"style"===t.pattern.type&&"none"===t.pattern.style)return"fill"===n.type&&"#ffffff"===R?{color:"#bdc3c7",width:.75}:null;n=D.pt2px(t.size)||0;return{color:"rgba("+(null!=t.color?t.color.toRgba():"255,255,255,1")+")",width:Math.min(n,Z),style:"pattern"in t&&null!=t.pattern&&"style"===t.pattern.type?z.dekebabifyLineStyle(t.pattern.style):
null,join:"butt",cap:"patternCap"in t?t.patternCap:"butt"}}async function e(n,t){if(n.thumbnail?.url)return n.thumbnail.url;if("icon"===t.type&&t?.resource?.href)return k.getIconHref(t);t=E.getAssetUrl("esri/images/Legend/legend3dsymboldefault.png");return n.styleOrigin&&(n.styleOrigin.styleName||n.styleOrigin.styleUrl)&&(n=await l.resolveWebStyleSymbol(n.styleOrigin,{portal:n.styleOrigin.portal},"webRef").catch(()=>null))&&"thumbnail"in n&&n.thumbnail?.url?n.thumbnail.url:t}function c(n,t=1){const R=
n.a;n=P.toHSV(n);const {r:U,g:aa,b:fa}=P.toRGB({h:n.h,s:n.s/t,v:100-(100-n.v)/t});return[U,aa,fa,R]}function g(n){return"water"===n.type?null==n.color?null:n.color:null==n.material?.color?null:n.material.color}function r(n,t=0){var R=g(n);if(!R){if("fill"===n.type)return null;t=v.adjustColorComponentBrightness(z.defaultThematicColor.r,t);return[t,t,t,100]}n=R.toRgba();for(R=0;3>R;R++)n[R]=v.adjustColorComponentBrightness(n[R],t);return n}async function m(n,t){n=n.style;return"none"===n?null:{type:"pattern",
x:0,y:0,src:await z.getPatternUrlWithColor(E.getAssetUrl(`esri/symbols/patterns/${n}.png`),t.toCss(!0)),width:5,height:5}}function A(n){return n.outline?h(n):{color:"rgba(0, 0, 0, 1)",width:1.5}}function H(n,t){n=g(n);if(!n)return null;let R;R="rgba("+(v.adjustColorComponentBrightness(n.r,t)+",");R+=v.adjustColorComponentBrightness(n.g,t)+",";R+=v.adjustColorComponentBrightness(n.b,t)+",";return R+n.a+");"}function J(n,t){t=H(n,t);if(!t)return{};if("pattern"in n&&null!=n.pattern&&"style"===n.pattern.type&&
"none"===n.pattern.style)return null;const R=Math.min(n.size?D.pt2px(n.size):.75,Z);return{color:t,width:R,style:"pattern"in n&&null!=n.pattern&&"style"===n.pattern.type?z.dekebabifyLineStyle(n.pattern.style):null,cap:"cap"in n?n.cap:null,join:"join"in n?"miter"===n.join?D.pt2px(2):n.join:null}}function f(n,t,R){R=null!=R?.75*R:0;return{type:"linear",x1:R?.25*R:0,y1:R?.5*R:0,x2:R||4,y2:R?.5*R:4,colors:[{color:n,offset:0},{color:t,offset:1}]}}function d(n){const t=n.depth,R=n.height;n=n.width;return 0!==
n&&0!==t&&0!==R&&n===t&&null!=n&&null!=R&&n<R}function x(n,t,R){const U=[];if(!n)return U;switch(n.type){case "icon":switch(n.resource&&n.resource.primitive||Q.defaultPrimitive){case "circle":U.push({shape:{type:"circle",cx:0,cy:0,r:.5*t},fill:r(n,0),stroke:h(n)});break;case "square":U.push({shape:{type:"path",path:[{command:"M",values:[0,t]},{command:"L",values:[0,0]},{command:"L",values:[t,0]},{command:"L",values:[t,t]},{command:"Z",values:[]}]},fill:r(n,0),stroke:h(n)});break;case "triangle":U.push({shape:{type:"path",
path:[{command:"M",values:[0,t]},{command:"L",values:[.5*t,0]},{command:"L",values:[t,t]},{command:"Z",values:[]}]},fill:r(n,0),stroke:h(n)});break;case "cross":U.push({shape:{type:"path",path:[{command:"M",values:[.5*t,0]},{command:"L",values:[.5*t,t]},{command:"M",values:[0,.5*t]},{command:"L",values:[t,.5*t]}]},stroke:A(n)});break;case "x":U.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[t,t]},{command:"M",values:[t,0]},{command:"L",values:[0,t]}]},stroke:A(n)});
break;case "kite":U.push({shape:{type:"path",path:[{command:"M",values:[0,.5*t]},{command:"L",values:[.5*t,0]},{command:"L",values:[t,.5*t]},{command:"L",values:[.5*t,t]},{command:"Z",values:[]}]},fill:r(n,0),stroke:h(n)})}break;case "object":switch(n.resource&&n.resource.primitive||F.defaultPrimitive){case "cone":var aa=r(n,0);n=r(n,-.6);n=f(aa,n,R?w:t);t=v.getConeShapes(t,R);U.push({shape:t[0],fill:n},{shape:t[1],fill:n});break;case "inverted-cone":R=r(n,0);n=r(n,-.6);n=f(R,n,t);t=v.getInvertedConeShapes(t);
U.push({shape:t[0],fill:n},{shape:t[1],fill:R});break;case "cube":t=v.getCubeShapes(t,R);U.push({shape:t[0],fill:r(n,0)},{shape:t[1],fill:r(n,-.3)},{shape:t[2],fill:r(n,-.5)});break;case "cylinder":aa=r(n,0);const fa=r(n,-.6);aa=f(aa,fa,R?w:t);t=v.getCylinderShapes(t,R);U.push({shape:t[0],fill:aa},{shape:t[1],fill:aa},{shape:t[2],fill:r(n,0)});break;case "diamond":t=v.getDiamondShapes(t);U.push({shape:t[0],fill:r(n,-.3)},{shape:t[1],fill:r(n,0)},{shape:t[2],fill:r(n,-.3)},{shape:t[3],fill:r(n,-.7)});
break;case "sphere":R=r(n,0);n=r(n,-.6);n=f(R,n);n.x1=0;n.y1=0;n.x2=.25*t;n.y2=.25*t;U.push({shape:{type:"circle",cx:0,cy:0,r:.5*t},fill:n});break;case "tetrahedron":t=v.getTetrahedronShapes(t),U.push({shape:t[0],fill:r(n,-.3)},{shape:t[1],fill:r(n,0)},{shape:t[2],fill:r(n,-.6)})}}return U}function G(n){return(n="number"===typeof n?.size?n?.size:null)?D.pt2px(n):null}async function y(n,t){const R=G(t),U=t?.maxSize?D.pt2px(t.maxSize):null,aa=t?.disableUpsampling??!1,fa=n.symbolLayers,ja=[];let X=0,
la=0;const V=fa.at(-1);let ba;V&&"icon"===V.type&&(ba=V.size&&D.pt2px(V.size));fa.forEach(ca=>{if("icon"===ca.type||"object"===ca.type){var ma="icon"===ca.type?ca.size&&D.pt2px(ca.size):0,oa=R||ma?Math.ceil(Math.min(R||ma,U||T)):N;if(ca?.resource?.href){var sa=e(n,ca).then(ua=>{const xa=ca?.material?.color;var wa="icon"===ca.type?"multiply":"tint";return b.tintImageWithColor(ua,oa,xa,wa,aa)}).then(ua=>{const xa=ua.width,wa=ua.height;X=Math.max(X,xa);la=Math.max(la,wa);return[{shape:{type:"image",
x:0,y:0,width:xa,height:wa,src:ua.url},fill:null,stroke:null}]});ja.push(sa)}else sa=oa,"icon"===ca.type&&ba&&R&&(sa=ma/ba*oa),ma="tall"===t?.symbolConfig||t?.symbolConfig?.isTall||("object"===ca.type?d(ca):!1),X=Math.max(X,ma?w:sa),la=Math.max(la,sa),ja.push(Promise.resolve(x(ca,sa,ma)))}});const da=[];(await Promise.allSettled(ja)).forEach(ca=>{"fulfilled"===ca.status?da.push(ca.value):ca.reason&&I.getLogger("esri.symbols.support.previewSymbol3D").warn("error while building swatchInfo!",ca.reason)});
return b.renderSymbol(da,[X,la],{node:t?.node,scale:!1,opacity:t?.opacity,ariaLabel:t?.ariaLabel})}function M(n,t){const R=n.symbolLayers,U=[];n=k.isVolumetricSymbol(n);const aa=G(t),fa=(t?.maxSize?D.pt2px(t.maxSize):null)||Z;let ja=0,X=0,la;R.forEach((V,ba)=>{if(V&&("line"===V.type||"path"===V.type)){var da=[];switch(V.type){case "line":var ca=J(V,0);if(null==ca)break;var ma=ca?.width||0;0===ba&&(la=ma);V=Math.min(aa||ma,fa);ba=0===ba?V:aa?ma/la*V:V;ma=ba>W/2?2*ba:W;X=Math.max(X,ba);ja=Math.max(ja,
ma);ca.width=ba;da.push({shape:{type:"path",path:[{command:"M",values:[0,.5*X]},{command:"L",values:[ja,.5*X]}]},stroke:ca});break;case "path":ca=Math.min(aa||N,fa);ba=r(V,0);ma=r(V,-.2);var oa=H(V,-.4);oa=oa?{color:oa,width:1}:{};if("quad"===V.profile){const sa=V.width;V=V.height;V=v.getPathSymbolShapes(sa&&V?sa/V:1,0===V,0===sa);oa={...oa,join:"bevel"};da.push({shape:V[0],fill:ma,stroke:oa},{shape:V[1],fill:ma,stroke:oa},{shape:V[2],fill:ba,stroke:oa})}else da.push({shape:v.shapes.pathSymbol3DLayer[0],
fill:ma,stroke:oa},{shape:v.shapes.pathSymbol3DLayer[1],fill:ba,stroke:oa});ja=X=Math.max(X,ca)}U.push(da)}});return Promise.resolve(b.renderSymbol(U,[ja,X],{node:t?.node,scale:n,opacity:t?.opacity,ariaLabel:t?.ariaLabel}))}async function L(n,t){const R="mesh-3d"===n.type;n=n.symbolLayers;var U=G(t);const aa=t?.maxSize?D.pt2px(t.maxSize):null;U=U||N;const fa=[];let ja=0,X=0;var la=!1;for(let ma=0;ma<n.length;ma++){var V=n.at(ma);const oa=[];if(!R||"fill"===V.type){switch(V.type){case "fill":la=Math.min(U,
aa||T);ja=Math.max(ja,la);X=Math.max(X,la);la=!0;if(R){var ba=v.shapes.meshSymbol3DFill,da=H(V,-.4);da=da?{color:da,width:1,join:"round"}:{};oa.push({shape:ba[0],fill:r(V,0),stroke:da},{shape:ba[1],fill:r(V,-.2),stroke:da},{shape:ba[2],fill:r(V,-.6),stroke:da})}else{ba=r(V,0);da="pattern"in V?V.pattern:null;var ca=h(V);V=g(V);null!=da&&"style"===da.type&&"solid"!==da.style&&V&&(ba=await m(da,V));oa.push({shape:v.shapes.fill[0],fill:ba,stroke:ca})}break;case "line":V=J(V,0);if(null==V)break;V={stroke:V,
shape:v.shapes.fill[0]};ja=Math.max(ja,N);X=Math.max(X,N);oa.push(V);break;case "extrude":ba={join:"round",width:1,...J(V,-.4)};da=r(V,0);V=r(V,-.2);ca=Math.min(U,aa||T);const sa=v.getExtrudeSymbolShapes(ca);ba.width=1;oa.push({shape:sa[0],fill:V,stroke:ba},{shape:sa[1],fill:V,stroke:ba},{shape:sa[2],fill:da,stroke:ba});V=.7*N+.5*ca;ja=Math.max(ja,N);X=Math.max(X,V);break;case "water":la=g(V),V=c(la),ba=c(la,2),da=c(la,3),ca=v.getWaterSymbolShapes(),la=!0,oa.push({shape:ca[0],fill:V},{shape:ca[1],
fill:ba},{shape:ca[2],fill:da}),V=Math.min(U,aa||T),ja=Math.max(ja,V),X=Math.max(X,V)}fa.push(oa)}}return b.renderSymbol(fa,[ja,X],{node:t?.node,scale:la,opacity:t?.opacity,ariaLabel:t?.ariaLabel})}const N=v.SymbolSizeDefaults.size,T=v.SymbolSizeDefaults.maxSize,Z=v.SymbolSizeDefaults.maxOutlineSize,W=v.SymbolSizeDefaults.lineWidth,w=v.SymbolSizeDefaults.tallSymbolWidth;q.getPatternDescriptor=m;q.getSizeFromOptions=G;q.getSymbolLayerFill=r;q.previewSymbol3D=function(n,t){if(0===n.symbolLayers.length)return Promise.reject(new u("symbolPreview: renderPreviewHTML3D",
"No symbolLayers in the symbol."));switch(n.type){case "point-3d":return y(n,t);case "line-3d":return M(n,t);case "polygon-3d":case "mesh-3d":return L(n,t)}return Promise.reject(new u("symbolPreview: swatchInfo3D","symbol not supported."))};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/webStyleSymbolUtils":function(){define("exports ../../symbols ../../core/devEnvironmentUtils ../../core/Error ../../core/urlUtils ../../portal/Portal ../../chunks/persistableUrlUtils ./jsonUtils ./StyleOrigin ./styleUtils ./Thumbnail".split(" "),
function(q,E,P,C,u,I,D,z,Q,F,v){function b(h,e){return e.items.find(c=>c.name===h)}function k(h,e,c,g,r,m){const A=null!=c?.portal?c.portal:I.getDefault(),H={portal:A,url:u.urlToObject(h.baseUrl),origin:"portal-item"},J=b(e,h.data);if(!J)return Promise.reject(new C("symbolstyleutils:symbol-name-not-found",`The symbol name '${e}' could not be found`,{symbolName:e}));r=D.fromJSON(r(J,g),H);let f=J.thumbnail?.href??null;const d=J.thumbnail?.imageData;P.isDevEnvironment()&&(r=P.adjustStaticAGOUrl(r)??
"",f=P.adjustStaticAGOUrl(f));const x={portal:A,url:u.urlToObject(u.removeFile(r)),origin:"portal-item"};return F.requestJSON(r,m).then(G=>{G="cimRef"===g?F.makeCIMSymbolRef(G.data):G.data;if((G=z.fromJSON(G,x))&&E.isSymbol3D(G)){if(f){const y=D.fromJSON(f,H);G.thumbnail=new v.Thumbnail({url:y})}else d&&(G.thumbnail=new v.Thumbnail({url:`data:image/png;base64,${d}`}));h.styleUrl?G.styleOrigin=new Q({portal:c.portal,styleUrl:h.styleUrl,name:e}):h.styleName&&(G.styleOrigin=new Q({portal:c.portal,styleName:h.styleName,
name:e}))}return G})}function l(h,e,c){const g=F.Style2DUrlTemplate.replaceAll(/\{SymbolName\}/gi,h),r=null!=e.portal?e.portal:I.getDefault();return F.requestJSON(g,c).then(m=>{m=F.makeCIMSymbolRef(m.data);return z.fromJSON(m,{portal:r,url:u.urlToObject(u.removeFile(g)),origin:"portal-item"})})}q.fetchSymbolFromStyle=k;q.getStyleItemFromStyle=b;q.resolveWebStyleSymbol=function(h,e,c,g){const r=h.name;return null==r?Promise.reject(new C("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):
h.styleName&&"Esri2DPointSymbolsStyle"===h.styleName?l(r,e,g):F.fetchStyle(h,e,g).then(m=>k(m,r,e,c,F.symbolUrlFromStyleItem,g))};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/core/devEnvironmentUtils":function(){define(["exports"],function(q){const E=/^devext.arcgis.com$/,P=/^qaext.arcgis.com$/,C=/^[\w-]*\.mapsdevext.arcgis.com$/,u=/^[\w-]*\.mapsqa.arcgis.com$/,I=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,E,P,/^jsapps.esri.com$/,C,u];q.adjustStaticAGOUrl=function(D,z){return D?
(z=z||globalThis.location.hostname)?null!=z.match(E)||null!=z.match(C)?D.replace("static.arcgis.com","staticdev.arcgis.com"):null!=z.match(P)||null!=z.match(u)?D.replace("static.arcgis.com","staticqa.arcgis.com"):D:D:D};q.devHostnames=I;q.isDevEnvironment=function(D){D=D||globalThis.location.hostname;return I.some(z=>null!=D?.match(z))};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/clusterUtils":function(){define(["exports","../../../renderers/visualVariables/SizeVariable"],
function(q,E){const P=(C,u)=>{C=C.featuresTilingScheme.getClosestInfoForScale(C.scale).level;return u?.levels?u.levels[C]:null};q.getClusterSizeVariable=function(C,u){if(!(C&&"visualVariables"in C&&C.visualVariables))return null;C=C.visualVariables.find(I=>"size"===I.type);return(u=P(u,C))?new E({field:C.field,minSize:u[2].size,minDataValue:u[2].value,maxSize:u[3].size,maxDataValue:u[3].value}):null};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/colorRampUtils":function(){define(["require",
"exports","../../../Color","./utils"],function(q,E,P,C){function u(F,v){const b=[],k=F.length-1;5===F.length?b.push(0,2,4):b.push(0,k);return F.map((l,h)=>b.includes(h)?C.createStopLabel(l,h,k,v):null)}async function I(F,v,b){b=new P(b??Q);F=(await new Promise((k,l)=>q(["../../../renderers/visualVariables/support/visualVariableUtils"],k,l))).getOpacity(v,F);null!=F&&(b.a=F);return b}function D(F,v){const {startIndex:b,endIndex:k,weight:l}=z(F,v);if(b===k)return v[b].color;F=P.blendColors(v[b].color,
v[k].color,l);return new P(F)}function z(F,v){let b=0,k=v.length-1;v.some((l,h)=>{if(F<l.value)return k=h,!0;b=h;return!1});return{startIndex:b,endIndex:k,weight:(F-v[b].value)/(v[k].value-v[b].value)}}const Q=new P([64,64,64]);E.getColorFromPointCloudStops=D;E.getRampStops=async function(F,v,b){let k=!1,l=[],h=[];if(F.stops){var e=F.stops;l=e.map(g=>g.value);(k=e.some(g=>!!g.label))&&(h=e.map(g=>g.label))}e=l[l.length-1];if(null==l[0]&&null==e)return null;const c=k?null:u(l,b);return(await Promise.all(l.map(async(g,
r)=>{const m="opacity"===F.type?await I(g,F,v):(await new Promise((A,H)=>q(["../../../renderers/visualVariables/support/visualVariableUtils"],A,H))).getColor(F,g);return{value:g,color:m,label:k?h[r]:c?.[r]??""}}))).reverse()};E.getRampStopsForPointCloud=function(F){let v=!1,b=[],k=[];b=F.map(e=>e.value);(v=F.some(e=>!!e.label))&&(k=F.map(e=>e.label??""));const l=b[b.length-1];if(null==b[0]&&null==l)return null;const h=v?null:u(b);return b.map((e,c)=>{const g=D(e,F);return{value:e,color:g,label:v?
k[c]:h?.[c]??""}}).reverse()};E.getStrectchRampStops=function(F,v){let b=[];if(F&&"multipart"===F.type)F.colorRamps.reverse().forEach((k,l)=>{0===l?b.push({value:v.max,color:new P(k.toColor),label:"high"}):b.push({value:null,color:new P(k.toColor),label:""});l===F.colorRamps.length-1?b.push({value:v.min,color:new P(k.fromColor),label:"low"}):b.push({value:null,color:new P(k.fromColor),label:""})});else{let k,l;F&&"algorithmic"===F.type?(k=F.fromColor,l=F.toColor):(k=[0,0,0,1],l=[255,255,255,1]);b=
[{value:v.max,color:new P(l),label:"high"},{value:v.min,color:new P(k),label:"low"}]}return b};Object.defineProperty(E,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/utils":function(){define("require exports ../../../symbols ../../../renderers/support/numberUtils ../../../smartMapping/support/utils ../../../symbols/SimpleLineSymbol".split(" "),function(q,E,P,C,u,I){async function D(z){if(!("visualVariables"in z&&z.visualVariables))return null;z=z.visualVariables.find(v=>"color"===
v.type);if(!z)return null;var Q=null,F=null;if(z.stops){if(1===z.stops.length)return z.stops[0].color;Q=z.stops[0].value;F=z.stops[z.stops.length-1].value}Q=null!=Q&&null!=F?Q+(F-Q)/2:0;({getColor:F}=await new Promise((v,b)=>q(["../../../renderers/visualVariables/support/visualVariableUtils"],v,b)));return F(z,Q)??null}E.createStopLabel=function(z,Q,F,v){let b="";0===Q?b="\x3c ":Q===F&&(b="\x3e ");z=v?u.formatAnyDate(z,v):C.format(z);return b+z};E.getMedianColor=D;E.getSymbolForFlowRenderer=async function(z,
Q){const F=z.trailCap,v=z.trailWidth||1;z=Q||await D(z)||z.color;return new I({cap:F,color:z,width:v})};E.isRasterBandStatistics=function(z){return null!=z&&"object"===typeof z&&"min"in z&&"max"in z};E.rgbImgSource=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII\x3d","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII\x3d",
"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII\x3d"];E.specialCharsGreaterThan="\x3e";E.specialCharsLessThan="\x3c";Object.defineProperty(E,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/numberUtils":function(){define(["exports","../../intl","../../intl/number"],function(q,E,P){function C(v,b){return v-b}function u(v,b){let k;k=Number(v.toFixed(b));
k<v?v=k+1/10**b:(v=k,k-=1/10**b);k=Number(k.toFixed(b));v=Number(v.toFixed(b));return[k,v]}function I(v,b,k,l,h){v=z(v,b,k,l);b=null==v.next||v.next<=h;return(null==v.previous||v.previous<=h)&&b||v.previous+v.next<=2*h}function D(v){v=String(v);var b=v.match(Q);if(b&&b[1])return{integer:b[1].split("").length,fractional:b[3]?b[3].split("").length:0};if(v.toLowerCase().includes("e")&&(b=v.split("e"),v=b[0],b=b[1],v&&b)){v=Number(v);b=Number(b);const k=0<b;k||(b=Math.abs(b));v=D(v);k?(v.integer+=b,v.fractional=
b>v.fractional?0:v.fractional-b):(v.fractional+=b,v.integer=b>v.integer?1:v.integer-b);return v}return{integer:0,fractional:0}}function z(v,b,k,l){const h={previous:null,next:null};if(null!=k){const e=v-k;h.previous=Math.floor(Math.abs(100*(b-k-e)/e))}null!=l&&(v=l-v,h.next=Math.floor(Math.abs(100*(l-b-v)/v)));return h}const Q=/^-?(\d+)(\.(\d+))?$/i,F={maximumFractionDigits:20};q.format=function(v){return P.formatNumber(v,F)};q.numDigits=D;q.percentChange=z;q.round=function(v,b={}){v=v.slice(0);const {tolerance:k=
2,strictBounds:l=!1,indexes:h=v.map((c,g)=>g)}=b;h.sort(C);for(b=0;b<h.length;b++){const c=h[b],g=v[c],r=0===c?null:v[c-1],m=c===v.length-1?null:v[c+1],A=D(g).fractional;if(A){let H=0,J=!1;for(var e=void 0;H<=A&&!J;)e=u(g,H),e=l&&0===b?e[1]:e[0],J=I(g,e,r,m,k),H++;J&&(v[c]=e)}}return v};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/heatmapRampUtils":function(){define(["exports","../../../renderers/support/HeatmapColorStop"],function(q,E){q.getHeatmapRampStops=
function(P){if(!P.colorStops)return[];const C=[...P.colorStops].filter(I=>0<I.color?.a);let u=C.length-1;if(C&&C[0]){const I=C[u];I&&1!==I.ratio&&(C.push(new E({ratio:1,color:I.color})),u++)}return C.map((I,D)=>{let z="";0===D?z=P.legendOptions?.minLabel||"low":D===u&&(z=P.legendOptions?.maxLabel||"high");return{color:I.color,label:z,ratio:I.ratio}}).reverse()};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/sizeRampUtils":function(){define("require exports ../../../Color ../../../symbols ../../../renderers/support/numberUtils ../../../symbols/support/cimSymbolUtils ../../../symbols/support/utils ./utils ../../support/widgetUtils ../../../support/themeUtils ../../../symbols/SimpleMarkerSymbol ../../../symbols/SimpleLineSymbol".split(" "),
function(q,E,P,C,u,I,D,z,Q,F,v,b){function k(y,M){const L=y.length-1;return y.map((N,T)=>z.createStopLabel(N,T,L,M))}function l(y,M){y=y?.authoringInfo;const L="univariate-color-size"===y?.type;let N=[12,30];if(L){const T=M[0],Z=M[M.length-1];N=M.map(W=>12+(W-T)/(Z-T)*18)}L&&"below"===y?.univariateTheme&&N.reverse();return N}function h(y,M){const L=y.classBreakInfos,N=L.length;M=2>N||!(2<=M)?L[0].symbol.clone():L[N-1].symbol.clone();y.visualVariables.some(T=>"color"===T.type)&&(M.type.includes("3d")?
g(M):r(M));return M}async function e(y,M){if("flow"===y.type)return z.getSymbolForFlowRenderer(y,M);if("pie-chart"===y.type)return new v({color:null,outline:y.outline?.width?y.outline:new b});let L=null,N=null;"simple"===y.type?L=y.symbol:"class-breaks"===y.type?(L=(y=y.classBreakInfos)&&y[0]&&y[0].symbol,N=1<y.length):"unique-value"===y.type&&(y=y.uniqueValueInfos,L=y?.[0]?.symbol,N=null!=y&&1<y.length);if(!L||c(L))return null;L=L.clone();if(M||N)L.type.includes("3d")?g(L):r(L);return L}function c(y){return y?
C.isSymbol3D(y)?y.symbolLayers?y.symbolLayers.some(M=>M&&"fill"===M.type):!1:y.type.includes("fill"):!1}function g(y){"line-3d"===y.type?y.symbolLayers.forEach(M=>{M.material={color:G}}):y.symbolLayers.forEach(M=>{"icon"!==M.type||M.resource?.href?M.material={color:x}:(M.material={color:d},M.outline={color:G,size:1.5})})}function r(y){const M=F.isDarkTheme();if("cim"===y.type)I.applyCIMSymbolColor(y,new P(x));else if(y.type.includes("line"))y.color=G;else if(y.color=M?G:d,"simple-marker"===y.type)y.outline?
"#ffffff"===y.outline?.color?.toHex()&&(y.outline.color=G):y.outline={color:G,width:1.5}}async function m(y,M,L,N){const T=(await new Promise((w,n)=>q(["../../../renderers/visualVariables/support/visualVariableUtils"],w,n))).getSizeRangeAtScale(y,L,N),Z=T&&A(T);if(T&&Z){var W=Z.map(w=>{const n=T.minSize,t=T.maxSize,R=y.minDataValue,U=y.maxDataValue;return w<=n?R:w>=t?U:(w-n)/(t-n)*(U-R)+R});W=u.round(W);for(let w=1;w<W.length-1;w++){const n=await H(y,M,W[w],W[w-1],L,N);n&&(W[w]=n[0],Z[w]=n[1])}return W}}
function A(y){const M=y.minSize;y=(y.maxSize-M)/4;const L=[];for(let N=0;5>N;N++)L.push(M+y*N);return L}async function H(y,M,L,N,T,Z){const W=await J(y,M,L,T,Z);N=await J(y,M,N,T,Z);var w=u.numDigits(L),n=w.fractional,t=w.integer;let R=w=null;0<L&&1>L&&(w=10**n,L*=w,t=u.numDigits(L).integer);for(n=t-1;0<=n;n--){var U=10**n;t=Math.floor(L/U)*U;U*=Math.ceil(L/U);null!=w&&(t/=w,U/=w);let aa=(t+U)/2;[,aa]=u.round([t,aa,U],{indexes:[1]});const fa=await J(y,M,t,T,Z),ja=await J(y,M,U,T,Z),X=await J(y,M,
aa,T,Z),la=u.percentChange(W,fa,N,null),V=u.percentChange(W,ja,N,null),ba=u.percentChange(W,X,N,null);let da=20>=la.previous,ca=20>=V.previous;da&&ca&&(la.previous<=V.previous?(da=!0,ca=!1):(ca=!0,da=!1));da?R=[t,fa]:ca?R=[U,ja]:20>=ba.previous&&(R=[aa,X]);if(R)break}return R}async function J(y,M,L,N,T){const {getSize:Z}=await new Promise((W,w)=>q(["../../../renderers/visualVariables/support/visualVariableUtils"],W,w));return Z(y,L,{scale:N,view:T,shape:"simple-marker"===M.type?M.style:null})}function f(y,
M){y=y.clone();if(C.isSymbol3D(y))D.isVolumetricSymbol(y)||y.symbolLayers.forEach(L=>{"fill"!==L.type&&(L.size=M)});else if("esri.symbols.SimpleMarkerSymbol"===y.declaredClass)y.size=M;else if("esri.symbols.PictureMarkerSymbol"===y.declaredClass){const L=y.width,N=y.height;y.height=M;y.width=L/N*M}else"esri.symbols.SimpleLineSymbol"===y.declaredClass?y.width=M:"esri.symbols.TextSymbol"===y.declaredClass&&y.font&&(y.font.size=M);return y}const d=[255,255,255],x=[200,200,200],G=[128,128,128];E.getRampStops=
async function(y,M,L,N,T,Z,W){var w=M.legendOptions?.customValues;const n=W||await e(y,L);L=M.stops;var t=null!=M.minSize&&null!=M.maxSize;W=L&&1<L.length;var R=!!M.target;if(n&&(w||t||W&&!R)){var U=D.isVolumetricSymbol(n),aa=!1,fa=t=null;t=U&&!W?u.round([M.minDataValue,M.maxDataValue]):w??await m(M,n,N,T?.type);w=y?.authoringInfo;var ja=(R="univariate-color-size"===w?.type)&&"above-and-below"===w?.univariateTheme;!t&&W&&(t=L.map(ba=>ba.value),aa=L.some(ba=>!!ba.label),"flow"===y.type&&(t=u.round(t)),
aa&&(fa=L.map(ba=>ba.label)));U&&null!=t&&2<t?.length&&!ja&&(t=[t[0],t[t.length-1]]);if(!t)return null;R&&5!==t?.length&&(t=A({minSize:t[0],maxSize:t[t.length-1]}));var X=U?l(y,t):null,la=D.getSymbolOutlineSize(n),V=aa?null:k(t,Z);return(await Promise.all(t.map(async(ba,da)=>{const ca=U?X[da]:await J(M,n,ba,N,T?.type),ma=f(ja&&"class-breaks"===y.type?h(y,da):n,ca);return{value:ba,symbol:ma,label:aa?fa[da]:V[da],size:ca,outlineSize:la}}))).reverse()}};E.realWorldMaxSize=30;E.realWorldMinSize=12;Object.defineProperty(E,
Symbol.toStringTag,{value:"Module"})})},"esri/widgets/smartMapping/support/utils":function(){define("exports ../../../Color ../../../intl/date ../../../intl/number ../../../renderers/support/utils ../../../renderers/visualVariables/SizeVariable".split(" "),function(q,E,P,C,u,I){q.formatDateLabel=function(D){return P.formatDate(new Date(D),u.timelineDateFormatOptions)};q.formatNumberLabel=function(D){const z=Math.floor(Math.log10(Math.abs(D)))+1;return C.formatNumber(D,{notation:1E6<=Math.abs(D)?"compact":
"standard",minimumSignificantDigits:2,maximumSignificantDigits:4>z||6<z?4:z})};q.getDeviationValues=function(D,z,Q){if(null==z||null==D)return[];const F=[];for(let v=-1*Q;v<=Q;v++)0!==v&&F.push(z+v*D);return F};q.getDynamicPathForSizeStops=function(D){const {max:z,min:Q,padding:F,pathHeight:v,pathWidth:b,stops:k}=D,l=z-Q;let h=`M0 0 L${b} 0 `,e;D=3===k.length?[k[0],k[1],k[2]]:[k[0],k[2],k[4]];const c=Math.min.apply(Math,D.map(r=>r.size)),g=Math.max(Math.abs(D[0].size-D[1].size),Math.abs(D[2].size-
D[1].size));D.reverse();D.forEach(({size:r,value:m},A)=>{m=Math.round(v-(m-Q)/l*v);e=Math.round((r-c)/g*100)/100*b;0===e&&(e=F*b);0===A&&(h+=`L${e} 0 `);h+=`L${e} ${m} `});return h+=`L${e} ${v} L0 ${v} L0 0 Z`};q.getFillFromColor=function(D){return D instanceof E?D.toCss(!0):E.fromString(D??"").toCss(!0)};q.getPathForSizeStops=function(D){const {bottomValue:z,bottomWidth:Q,max:F,min:v,pathHeight:b,pathWidth:k,topValue:l,topWidth:h}=D;D=h*k;const e=Q*k,c=F-v;return`M${D} 0 L${D} ${Math.round(b-(l-
v)/c*b)} L${e} ${Math.round(b-(z-v)/c*b)} L${e} ${b} L0 ${b} L0 0 Z`};q.getSizesFromVariable=function(D){let z=D.maxSize;D=D.minSize;z instanceof I&&(z=z.stops[0].size);D instanceof I&&(D=D.stops[0].size);return[z,D]};q.getStopChanges=function(D,z,Q){const F=Q.length-1;if(0>F)return[];const v=Q[0],b=Q[F]-v,k=z-D,l=[];for(let h=1;h<F;h++)l.push({index:h,value:(Q[h]-v)/b*k+D});l.unshift({index:0,value:D});l.push({index:F,value:z});return l};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},
"esri/renderers/support/utils":function(){define("exports ../../core/arrayUtils ../../core/Logger ../../core/MapUtils ../../intl/date ../../layers/support/fieldUtils ./numberUtils ../visualVariables/support/ColorStop ../../smartMapping/support/utils ../../symbols/support/utils ../../widgets/Legend/support/colorRampUtils ../../widgets/Legend/support/heatmapRampUtils".split(" "),function(q,E,P,C,u,I,D,z,Q,F,v,b){async function k(m,A,H){C.getOrCreateMapValue(m,A,()=>[]).push(...H)}async function l(m,
A,H){m=C.getOrCreateMapValue(m,A,()=>new Map);for(const J of H)m.set(J.value,J.color)}function h(m){let A=m.minValue,H=m.maxValue;const J=m.isFirstBreak?"":g.gt+" ";m="percent-of-total"===m.normalizationType?g.pct:"";A=null==A?"":D.format(A);H=null==H?"":D.format(H);return J+A+m+" "+g.ld+" "+H+m}function e(m,A){return"normalizationField"in m&&m.normalizationField?{type:"normalized-field",field:m.field,normalizationField:m.normalizationField}:"field"in m&&m.field?{type:"field",field:m.field}:"valueExpression"in
m&&m.valueExpression?{type:"expression",expression:m.valueExpression,title:m.valueExpressionTitle,returnType:A}:null}const c=P.getLogger("esri.renderers.support.utils"),g={lte:"\x3c\x3d",gte:"\x3e\x3d",lt:"\x3c",gt:"\x3e",pct:"%",ld:"\u2013"},r={millisecond:0,second:1,minute:2,hour:3,day:4,month:5,year:6};P=u.convertDateFormatToIntlOptions("short-date");q.calculateDateFormatInterval=function(m){m=m.map(d=>new Date(d));const A=m.length;let H=Infinity,J=null;for(let d=0;d<A-1;d++){const x=m[d];let G=
Infinity,y=null;for(let M=d+1;M<A;M++){var f=m[M];f=x.getFullYear()!==f.getFullYear()&&"year"||x.getMonth()!==f.getMonth()&&"month"||x.getDate()!==f.getDate()&&"day"||x.getHours()!==f.getHours()&&"hour"||x.getMinutes()!==f.getMinutes()&&"minute"||x.getSeconds()!==f.getSeconds()&&"second"||"millisecond";const L=r[f];L<G&&(G=L,y=f)}G<H&&(H=G,J=y)}return J};q.createClassBreakLabel=h;q.createColorStops=function(m){const {values:A,colors:H,labelIndexes:J,isDate:f}=m;return A.map((d,x)=>{var G=null;if(!J||
J.includes(x)){const y=f?u.formatDate(d):D.format(d);y&&(G="",0===x?G=g.lt+" ":x===A.length-1&&(G=g.gt+" "),G+=y)}return new z({value:d,color:H[x],label:G})})};q.createUniqueValueLabel=function(m){const {value:A,domain:H,fieldInfo:J,dateFormatOptions:f}=m;m=String(A);const d=H&&"codedValues"in H&&H.codedValues?H.getName(A):null;d?m=d:null!=A&&J&&(Q.isAnyDateField(J)||I.isTimeOnlyField(J))?m=Q.formatAnyDate(A,f??{fieldType:J.type}):"number"===typeof A&&(m=D.format(A));return m};q.dateFormatIntervalOptions=
{millisecond:"long-month-day-year-long-time",second:"long-month-day-year-long-time",minute:"long-month-day-year-short-time",hour:"long-month-day-year-short-time",day:"long-month-day-year",month:"long-month-day-year",year:"year"};q.getAttribute=e;q.getAttributes=function(m,A){const H=[];if("class-breaks"===m.type||"heatmap"===m.type)H.push(e(m,"number"));else if("unique-value"===m.type){var J=m.authoringInfo;if(J&&"relationship"===J.type){if(J.field1&&J.field2){var f=J.field2.field;const d=J.field2.normalizationField;
H.push(e({field:J.field1.field,normalizationField:J.field1.normalizationField}));H.push(e({field:f,normalizationField:d}))}}else f=m.uniqueValueInfos?.[0],J=null,f?.value&&(f=typeof f.value,"string"===f||"number"===f)&&(J=f),H.push(e(m,J)),[m.field2,m.field3].forEach(d=>d&&H.push({type:"field",field:d}))}else"attributes"in m&&m.attributes?.forEach(d=>H.push(e(d,"number")));(m=A?A(m):"visualVariables"in m?m.visualVariables:null)&&m.forEach(d=>H.push(e(d,"number")));return E.unique(H.filter(E.isSome),
(d,x)=>"field"===d.type&&"field"===x.type?d.field===x.field:"normalized-field"===d.type&&"normalized-field"===x.type?d.field===x.field&&d.normalizationField===x.normalizationField:"expression"===d.type&&"expression"===x.type?d.expression===x.expression:!1)};q.getColorsForRendererValues=async function(m){const A=new Map;if(!m)return A;if("unique-value"!==m.type||m.authoringInfo?.type)if("class-breaks"===m.type){var H=m.classBreakInfos.map(d=>({value:d.minValue,color:F.getColorFromSymbol(d.symbol,null)})).reverse();
const {field:J,valueExpression:f}=m;await l(A,J??f,H)}else"simple"===m.type&&await l(A,"default",[{value:"default",color:F.getColorFromSymbol(m.symbol,null)}]);else{H=(m.uniqueValueInfos??[]).map(M=>({value:M.value,color:F.getColorFromSymbol(M.symbol,null)}));const {field:J,field2:f,field3:d,valueExpression:x,fieldDelimiter:G}=m,y=[J,f,d].filter(Boolean).join(G||"");(y||x)&&await l(A,y||x,H)}"defaultSymbol"in m&&m.defaultSymbol&&await l(A,"default",[{value:"default",color:F.getColorFromSymbol(m.defaultSymbol,
null)}]);if("visualVariables"in m&&m.visualVariables){m=m.visualVariables.filter(J=>"color"===J.type);for(const J of m)m=await v.getRampStops(J)??[],await l(A,J.field||J.valueExpression,m)}return A};q.getColorsFromRenderer=async function(m){const A=new Map;if(!m)return A;if("visualVariables"in m&&m.visualVariables){var H=m.visualVariables.filter(f=>"color"===f.type);for(var J of H)H=(await v.getRampStops(J)??[]).map(f=>f.color),await k(A,J.field||J.valueExpression,H)}if("heatmap"===m.type)J=b.getHeatmapRampStops(m).map(f=>
f.color),await k(A,m.field||m.valueExpression,J);else if("pie-chart"===m.type){for(const f of m.attributes)await k(A,f.field||f.valueExpression,[f.color]);await k(A,"default",[m?.othersCategory?.color,F.getColorFromSymbol(m.backgroundFillSymbol,null)])}else if("dot-density"===m.type){for(const f of m.attributes)await k(A,f.field||f.valueExpression,[f.color]);await k(A,"default",[m.backgroundColor])}else if("unique-value"===m.type)if("predominance"===m.authoringInfo?.type)for(const f of m.uniqueValueInfos??
[])await k(A,f.value.toString(),[F.getColorFromSymbol(f.symbol,null)]);else{J=(m.uniqueValueInfos??[]).map(y=>F.getColorFromSymbol(y.symbol,null));const {field:f,field2:d,field3:x,valueExpression:G}=m;(f||G)&&await k(A,f||G,J);d&&await k(A,d,J);x&&await k(A,x,J)}else if("class-breaks"===m.type){J=m.classBreakInfos.map(x=>F.getColorFromSymbol(x.symbol,null));const {field:f,valueExpression:d}=m;await k(A,f??d,J)}else"simple"===m.type&&await k(A,"default",[F.getColorFromSymbol(m.symbol,null)]);"defaultSymbol"in
m&&m.defaultSymbol&&await k(A,"default",[F.getColorFromSymbol(m.defaultSymbol,null)]);A.forEach((f,d)=>{f=E.unique(f.filter(Boolean),(x,G)=>JSON.stringify(x)===JSON.stringify(G));A.set(d,f)});return A};q.setLabelsForClassBreaks=function(m){const A=m.classBreakInfos,H=m.normalizationType;let J=[];if(A?.length)if("standard-deviation"===m.classificationMethod)c.warn("setLabelsForClassBreaks","cannot set labels for class breaks generated using 'standard-deviation' method.");else if(m.round){J.push(A[0].minValue);
for(const f of A)J.push(f.maxValue);J=D.round(J);A.forEach((f,d)=>{f.label=h({minValue:0===d?J[0]:J[d],maxValue:J[d+1],isFirstBreak:0===d,normalizationType:H})})}else A.forEach((f,d)=>{f.label=h({minValue:f.minValue,maxValue:f.maxValue,isFirstBreak:0===d,normalizationType:H})})};q.timelineDateFormatOptions=P;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/styles/Card":function(){define("../../../chunks/tslib.es6 ../../../intl ../../../core/reactiveUtils ../../../core/screenUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../symbols/support/svgUtils ../../../symbols/support/utils ../../Widget ./CardCSS ./support/relationshipUtils ./support/univariateUtils ../support/styleUtils ../../support/Heading ../../support/decorators/accessibleHandler ../../support/decorators/messageBundle ../../support/jsxFactory ../../support/widgetUtils ../../../intl/substitute".split(" "),
function(q,E,P,C,u,I,D,z,Q,F,v,b,k,l,h,e,c,g,r,m,A,H){var J;(function(d){d.Auto="auto";d.Stack="stack";d.SideBySide="side-by-side"})(J||(J={}));const f=window.devicePixelRatio;E=class extends b{constructor(d,x){super(d,x);this._hasIndicators=!1;this._selectedSectionName=null;this._sectionNames=[];this._sectionMap=new Map;this.activeLayerInfos=null;this.headingLevel=3;this.layout=J.Stack;this.messagesCommon=this.messages=null;this.type="card";this.view=null}initialize(){this.addHandles(P.watch(()=>
this.activeLayerInfos,d=>{this.removeAllHandles();this._watchForSectionChanges(d)}))}render(){var {view:d}=this;this._hasIndicators=this.layout===J.Auto&&d&&768>=d.container.clientWidth||this.layout===J.Stack;d=(d=this.activeLayerInfos)&&d.toArray().map(y=>this._renderLegendForLayer(y)).filter(y=>!!y);this._hasIndicators?this._selectedSectionName&&this._sectionNames.includes(this._selectedSectionName)||(this._selectedSectionName=this._sectionNames&&this._sectionNames[0]):this._selectedSectionName=
null;const x=this._sectionNames.length;var G=this._sectionNames.map((y,M)=>{M=H.substitute(this.messagesCommon.pagination.pageText,{index:M+1,total:x});return m.tsx("div",{"aria-controls":`${y}-panel`,"aria-label":M,"aria-selected":(this._selectedSectionName===y).toString(),bind:this,class:this.classes(k.css.indicator,{[k.css.activated]:this._selectedSectionName===y}),"data-section-name":y,id:y,key:y,onclick:this._selectSection,onkeydown:this._focusSection,role:"tab",tabIndex:this._selectedSectionName===
y?0:-1,title:M})});G=this._hasIndicators&&1<x?m.tsx("div",{class:k.css.indicatorContainer,key:"carousel-navigation",role:"tablist"},G):null;d=this._hasIndicators?this._sectionMap.get(this._selectedSectionName):d&&d.length?d:null;return m.tsx("div",{class:this.classes(k.css.base,{[k.css.stacked]:this._hasIndicators})},d||m.tsx("div",{class:k.css.message},this.messages.noLegend),G)}_selectSection(d){if(d=d.target.getAttribute("data-section-name"))this._selectedSectionName=d}_focusSection(d){switch(d.key){case "ArrowLeft":case "ArrowRight":this._switchSectionOnArrowPress(d);
break;case "Enter":case " ":this._selectSection(d)}}_switchSectionOnArrowPress(d){const x=d.key,G="ArrowLeft"===x?-1:1;d=d.target.getAttribute("data-section-name");d=this._sectionNames.indexOf(d);const y=this._sectionNames;let M=null;-1!==d&&(y[d+G]?M=document.getElementById(y[d+G]):"ArrowLeft"===x?M=document.getElementById(y[y.length-1]):"ArrowRight"===x&&(M=document.getElementById(y[0])),M?.focus())}_watchForSectionChanges(d){this._generateSectionNames();d&&(d.forEach(x=>{const G=`activeLayerInfo-${x.layer.uid}-version-change`;
this.removeHandles(G);this._watchForSectionChanges(x.children);this.addHandles(P.watch(()=>x.version,()=>this._generateSectionNames()),G)}),this.removeHandles("activeLayerInfos-collection-change"),this.addHandles(d.on("change",()=>this._watchForSectionChanges(d)),"activeLayerInfos-collection-change"))}_generateSectionNames(){this._sectionNames.length=0;this._selectedSectionName=null;this.activeLayerInfos&&this.activeLayerInfos.forEach(this._generateSectionNamesForActiveLayerInfo,this)}_getSectionName(d,
x,G){return`${this.id}${d.uid}-type-${x.type}-${G}`}_generateSectionNamesForActiveLayerInfo(d){d.children.forEach(this._generateSectionNamesForActiveLayerInfo,this);d.legendElements&&d.legendElements.forEach((x,G)=>{this._sectionNames.push(this._getSectionName(d.layer,x,G))})}_renderLegendForLayer(d){if(!d.ready)return null;if(d.children.length){var x=d.children.map(y=>this._renderLegendForLayer(y)).toArray();return m.tsx("div",{class:this.classes(k.css.service,k.css.groupLayer),key:d.layer.uid},
m.tsx("div",{class:k.css.serviceCaptionContainer},d.title),x)}if((x=d.legendElements)&&!x.length)return null;const G=x.some(y=>"relationship-ramp"===y.type);x=x.map((y,M)=>this._renderLegendForElement(y,d,M,G)).filter(y=>!!y);return x.length?m.tsx("div",{class:this.classes(k.css.service,{[k.css.groupLayerChild]:!!d.parent}),key:d.layer.uid},m.tsx("div",{class:k.css.serviceCaptionContainer},m.tsx("div",{class:k.css.serviceCaptionText},d.title)),m.tsx("div",{class:k.css.serviceContent},x)):null}_renderLegendForElement(d,
x,G,y=!1,M=!1){var L="color-ramp"===d.type,N="opacity-ramp"===d.type,T=x.layer,Z=null;"string"===typeof d.title?Z=d.title:d.title&&(Z=d.title,L=e.getTitle(this.messages,Z,L||N),Z=Z.title?`${Z.title} (${L})`:L);G=this._getSectionName(T,d,G);L=this._hasIndicators&&!M?m.tsx("div",null,m.tsx(c.Heading,{class:k.css.carouselTitle,level:this.headingLevel},x.title),m.tsx(c.Heading,{class:k.css.layerCaption,level:c.incrementHeadingLevel(this.headingLevel)},Z)):Z?m.tsx(c.Heading,{class:k.css.layerCaption,level:this.headingLevel},
Z):null;Z=x.effectList;N=null;switch(d.type){case "symbol-table":T=d.infos.map((W,w)=>this._renderLegendForElementInfo(W,x,d.legendType,w)).filter(W=>!!W);T.length&&(N=m.tsx("div",{class:this.classes({[k.css.labelContainer]:!T[0].properties.classes?.[k.css.symbolRow]&&!y,[k.css.relationshipLabelContainer]:y})},T));break;case "color-ramp":case "opacity-ramp":case "heatmap-ramp":case "stretch-ramp":N=this._renderLegendForRamp(d,T.opacity,Z);break;case "size-ramp":N=this._renderSizeRamp(d,T.opacity);
break;case "pie-chart-ramp":N=this._renderPieChartRamp(d);break;case "relationship-ramp":N=l.renderRelationshipRamp(d,this.id,{opacity:T.opacity,effectList:Z,ariaLabel:this.messages.previewRelationshipRampAriaLabel});break;case "univariate-above-and-below-ramp":N=this._renderUnivariateAboveAndBelowRamp(d,T.opacity,Z);break;case "univariate-color-size-ramp":N=this._renderUnivariateColorSizeRamp(d,T.opacity,Z)}if(!N)return null;y=m.tsx("div",{"aria-labelledby":G,class:k.css.section,id:`${G}-panel`,
key:G,role:"tabpanel",tabIndex:0},[L,N]);M||this._sectionMap.set(G,y);return y}_renderPieChartRamp(d){return m.tsx("div",{afterCreate:e.attachToNode,bind:d.preview,class:k.css.pieChartRampPreview})}_renderUnivariateAboveAndBelowRamp(d,x,G){const {sizeRampElement:y,colorRampElement:M}=h.getUnivariateAboveAndBelowRampElements(d,x,"horizontal");if(!y)return null;d=h.getUnivariateSizeRampSize(y,"full",!0,"horizontal");var L=h.getUnivariateColorRampSize(y,"above",!0,"horizontal"),N=h.getUnivariateColorRampSize(y,
"below",!0,"horizontal"),T=this.messages?.previewColorRampAriaLabel;L=h.getUnivariateColorRampPreview(M,{width:L,height:12,rampAlignment:"horizontal",opacity:x,type:"above",effectList:G,ariaLabel:T});x=h.getUnivariateColorRampPreview(M,{width:N,height:12,rampAlignment:"horizontal",opacity:x,type:"below",effectList:G,ariaLabel:T});G=h.getUnivariateColorRampMargin(y,"card");N=y.infos.map(W=>W.label);const Z=N.length-1;N=N.map((W,w)=>0===w||w===Z?m.tsx("div",{key:w},W):null);T={marginTop:"3px",display:"flex"};
A.isRTL(this.container)?T.marginRight=`${G}px`:T.marginLeft=`${G}px`;d={width:`${d}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return m.tsx("div",{class:k.css.layerRow,key:"size-ramp-preview",styles:{display:"flex",flexDirection:"column"}},m.tsx("div",{class:this.classes(k.css.symbolContainer,k.css.sizeRampHorizontal),styles:{display:"flex",flexDirection:"row"}},y.infos.map((W,w)=>m.tsx("div",{afterCreate:e.attachToNode,bind:W.preview,class:k.css.symbol,key:w}))),L?m.tsx("div",
{class:k.css.univariateAboveAndBelowColorRamp,key:"color-ramp-preview",styles:T},m.tsx("div",{afterCreate:e.attachToNode,bind:L}),m.tsx("div",{afterCreate:e.attachToNode,bind:x})):null,m.tsx("div",{class:k.css.layerInfo},m.tsx("div",{class:k.css.rampLabelsContainer,styles:d},N)))}_renderUnivariateColorSizeRamp(d,x,G){const {sizeRampElement:y,colorRampElement:M}=h.getUnivariateColorSizeRampElements(d,"horizontal");if(!y)return null;d=h.getUnivariateSizeRampSize(y,"full",!1,"horizontal");var L=h.getUnivariateColorRampSize(y,
"full",!1,"horizontal");x=h.getUnivariateColorRampPreview(M,{width:L,height:12,rampAlignment:"horizontal",opacity:x,type:"full",effectList:G,ariaLabel:this.messages?.previewColorRampAriaLabel});const N=h.getUnivariateColorRampMargin(y,"card"),T=y.infos.length-1;G=y.infos.map((Z,W)=>0===W||W===T?m.tsx("div",{key:W},Z.label):null);L={marginTop:"3px",display:"flex"};A.isRTL(this.container)?L.marginRight=`${N}px`:L.marginLeft=`${N}px`;d={width:`${d}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};
return m.tsx("div",{class:k.css.layerRow,key:"size-ramp-preview",styles:{display:"flex",flexDirection:"column"}},m.tsx("div",{class:this.classes(k.css.symbolContainer,k.css.sizeRampHorizontal),styles:{display:"flex",flexDirection:"row"}},y.infos.map((Z,W)=>m.tsx("div",{afterCreate:e.attachToNode,bind:Z.preview,class:k.css.symbol,key:W}))),m.tsx("div",{class:k.css.univariateAboveAndBelowColorRamp,key:"color-ramp-preview",styles:L},m.tsx("div",{afterCreate:e.attachToNode,bind:x})),m.tsx("div",{class:k.css.layerInfo},
m.tsx("div",{class:k.css.rampLabelsContainer,styles:d},G)))}_renderLegendForElementInfo(d,x,G,y){var M=x.layer;if(d.type)return this._renderLegendForElement(d,x,y,!1,!0);var L=e.isImageryStretchedLegend(M,G);G=e.getTitle(this.messages,d.label,!1)??"";if(d.preview){if(!d.symbol?.type.includes("simple-fill")){if(!d.label)return m.tsx("div",{afterCreate:e.attachToNode,bind:d.preview,key:y});x={[k.css.symbolCell]:this._hasIndicators};return m.tsx("div",{class:this.classes(k.css.layerRow,{[k.css.symbolRow]:this._hasIndicators}),
key:y},m.tsx("div",{afterCreate:e.attachToNode,bind:d.preview,class:this.classes(x)}),m.tsx("div",{class:this.classes(k.css.imageLabel,{[k.css.labelCell]:this._hasIndicators})},G))}let N=L=255,T=255,Z=0,W=255,w=255,n=255,t=0;const R=d.symbol.color?.a,U=d.symbol.outline?.color?.a;R&&(L=d.symbol.color.r,N=d.symbol.color.g,T=d.symbol.color.b,Z=d.symbol.color.a*M.opacity);U&&(W=d.symbol.outline.color.r,w=d.symbol.outline.color.g,n=d.symbol.outline.color.b,t=d.symbol.outline.color.a*M.opacity);M=(d=d.symbol.color?.isBright??
!0)?"rgba(255, 255, 255, .6)":"rgba(0, 0, 0, .6)";x={background:R?`rgba(${L}, ${N}, ${T}, ${Z})`:"none",color:d?"black":"white",textShadow:`-1px -1px 0 ${M},\n                                              1px -1px 0 ${M},\n                                              -1px 1px 0 ${M},\n                                              1px 1px 0 ${M}`,border:U?`1px solid rgba(${W}, ${w}, ${n}, ${t})`:"none",filter:v.getCSSFilterFromEffectList(x.effectList)??void 0};return m.tsx("div",{class:k.css.layerRow,
key:y},m.tsx("div",{class:k.css.labelElement,styles:x},G))}if(d.src)return x=this._renderImage(d,M,L),m.tsx("div",{class:k.css.layerRow,key:y},x,m.tsx("div",{class:k.css.imageLabel},G))}_renderImage(d,x,G){const {label:y,src:M,opacity:L}=d;G={[k.css.imageryLayerStretchedImage]:G,[k.css.symbol]:!G};x={opacity:`${null!=L?L:x.opacity}`};return m.tsx("img",{alt:e.getTitle(this.messages,y,!1),"aria-label":e.getTitle(this.messages,y,!1),border:0,class:this.classes(G),height:d.height,src:M,styles:x,width:d.width})}_renderSizeRampLines(d){d=
d.infos;var x=d[0],G=d[d.length-1],y=x.symbol;d=this._hasIndicators;x=C.pt2px(x.size+x.outlineSize)*f;G=C.pt2px(G.size+G.outlineSize)*f;const M=d?x:x+50*f,L=d?x/2+50*f:x;var N;y?y.type.includes("3d")?(N=y.symbolLayers?.length)?(N=y.symbolLayers.at(N-1).get("resource.primitive"),N="triangle"===N||"cone"===N||"tetrahedron"===N):N=void 0:N="triangle"===y.style:N=void 0;if(y)if(y.type.includes("3d")){var T=y.symbolLayers?.length;T?(y=y.symbolLayers.at(T-1).resource?.primitive,y="circle"===y||"cross"===
y||"kite"===y||"sphere"===y||"cube"===y||"diamond"===y):y=void 0}else y=y.style,y="circle"===y||"diamond"===y||"cross"===y;else y=void 0;T=document.createElement("canvas");T.width=M;T.height=L;T.style.width=`${T.width/f}px`;T.style.height=`${T.height/f}px`;const Z=T.getContext("2d");if(d){Z.beginPath();var W=M/2-G/2;Z.moveTo(0,0);Z.lineTo(W,L);W=M/2+G/2;Z.moveTo(M,0);Z.lineTo(W,L)}else Z.beginPath(),Z.moveTo(0,L/2-G/2),Z.lineTo(M,0),Z.moveTo(0,L/2+G/2),Z.lineTo(M,L);Z.strokeStyle="#ddd";Z.stroke();
return m.tsx("div",{afterCreate:e.attachToNode,bind:T,styles:d?{display:"flex",marginTop:`-${N?0:y?x/2:0}px`,marginBottom:`-${N?G:y?G/2:0}px`}:{display:"flex",marginRight:`-${N?0:y?x/2:0}px`,marginLeft:`-${N?0:y?G/2:0}px`}})}_renderSizeRamp(d,x){var G=d.infos;const y=G[0].label,M=G[G.length-1].label;let L=G[0].preview;G=G[G.length-1].preview;const N=this._hasIndicators,T={"flex-direction":N?"column":"row-reverse"};L&&(L=L.cloneNode(!0),L.style.display="flex");G&&(G=G.cloneNode(!0),G.style.display=
"flex");x={opacity:null!=x?`${x}`:""};return m.tsx("div",{class:this.classes(k.css.layerRow,{[k.css.sizeRampRow]:N})},m.tsx("div",{class:k.css.rampLabel},N?y:M),m.tsx("div",{class:k.css.sizeRampContainer,styles:T},m.tsx("div",{afterCreate:e.attachToNode,bind:L,class:k.css.sizeRampPreview,styles:x}),this._renderSizeRampLines(d),m.tsx("div",{afterCreate:e.attachToNode,bind:G,class:k.css.sizeRampContainer,styles:x})),m.tsx("div",{class:k.css.rampLabel},N?M:y))}_getRampStopLabel(d,x){switch(x){case "heatmap-ramp":return this.messages[d.label];
case "stretch-ramp":return e.getStretchStopLabel(d,this.messages);default:return d.label}}_renderLegendForRamp(d,x,G){var y=d.infos;d=d.type;const M="heatmap-ramp"===d,L=y.length-1;var N=2<L&&!M?25*L:100,T=N+20;y=y.slice(0).reverse();const Z=y.length-1;var W=0!==y.length%2?y[y.length/2|0]:null;W=W&&m.tsx("div",{class:k.css.intervalSeparatorsContainer},m.tsx("div",{class:k.css.intervalSeparator},"|"),m.tsx("div",{class:k.css.rampLabel},this._getRampStopLabel(W,d)));N=[[{shape:{type:"path",path:"M0 12.5 L10 0 L10 25 Z"},
fill:y[0].color,stroke:{width:0}},{shape:{type:"rect",x:10,y:0,width:N,height:25},fill:{type:"linear",x1:10,y1:0,x2:N+10,y2:0,colors:y.map((w,n)=>({color:w.color,offset:M&&"ratio"in w?w.ratio:n/L}))},stroke:{width:0}},{shape:{type:"path",path:`M${N+10} 0 L${T} ${12.5} L${N+10} ${25} Z`},fill:y[Z].color,stroke:{width:0}}]];T=F.renderSVG(N,T,25);x={filter:v.getCSSFilterFromEffectList(G)??void 0,opacity:null==x?void 0:`${x}`};return m.tsx("div",{class:k.css.layerRow,styles:{justifyContent:"center"}},
m.tsx("div",{class:k.css.rampLabel},this._getRampStopLabel(y[0],d)),m.tsx("div",{class:k.css.symbolContainer},m.tsx("div",{styles:x},T),W),m.tsx("div",{class:k.css.rampLabel},this._getRampStopLabel(y[Z],d)))}};q.__decorate([u.property()],E.prototype,"activeLayerInfos",void 0);q.__decorate([u.property()],E.prototype,"headingLevel",void 0);q.__decorate([u.property()],E.prototype,"layout",void 0);q.__decorate([u.property(),r.messageBundle("esri/widgets/Legend/t9n/Legend")],E.prototype,"messages",void 0);
q.__decorate([u.property(),r.messageBundle("esri/t9n/common")],E.prototype,"messagesCommon",void 0);q.__decorate([u.property({readOnly:!0})],E.prototype,"type",void 0);q.__decorate([u.property()],E.prototype,"view",void 0);q.__decorate([g.accessibleHandler()],E.prototype,"_selectSection",null);return E=q.__decorate([Q.subclass("esri.widgets.Legend.styles.Card")],E)})},"esri/widgets/Legend/styles/CardCSS":function(){define(["exports"],function(q){q.css={activated:"esri-legend--card__carousel-indicator--activated",
base:"esri-legend--card",stacked:"esri-legend--stacked",carouselTitle:"esri-legend--card__carousel-title",indicator:"esri-legend--card__carousel-indicator",intervalSeparator:"esri-legend--card__interval-separator",imageryLayerStretchedImage:"esri-legend--card__imagery-layer-image--stretched",imageLabel:"esri-legend--card__image-label",layerCaption:"esri-legend--card__layer-caption",labelElement:"esri-legend--card__label-element",layerRow:"esri-legend--card__layer-row",labelCell:"esri-legend--card__label-cell",
message:"esri-legend--card__message",rampLabel:"esri-legend--card__ramp-label",section:"esri-legend--card__section",relationshipSection:"esri-legend--card__relationship-section",serviceCaptionText:"esri-legend--card__service-caption-text",serviceContent:"esri-legend--card__service-content",service:"esri-legend--card__service",groupLayer:"esri-legend--card__group-layer",groupLayerChild:"esri-legend--card__group-layer-child",symbol:"esri-legend--card__symbol",sizeRampRow:"esri-legend--card__size-ramp-row",
symbolRow:"esri-legend--card__symbol-row",symbolCell:"esri-legend--card__symbol-cell",indicatorContainer:"esri-legend--card__carousel-indicator-container",intervalSeparatorsContainer:"esri-legend--card__interval-separators-container",relationshipLabelContainer:"esri-legend--card__relationship-label-container",labelContainer:"esri-legend--card__label-container",serviceCaptionContainer:"esri-legend--card__service-caption-container",symbolContainer:"esri-legend--card__symbol-container",sizeRampContainer:"esri-legend--card__size-ramp-container",
sizeRampPreview:"esri-legend--card__size-ramp-preview",pieChartRampPreview:"esri-legend--card__pie-chart-ramp-preview",rampContainer:"esri-legend__ramps",sizeRampHorizontal:"esri-legend__size-ramp--horizontal",rampLabelsContainer:"esri-legend__ramp-labels",layerInfo:"esri-legend__layer-cell esri-legend__layer-cell--info",univariateAboveAndBelowColorRamp:"esri-univariate-above-and-below-ramp__color--card"};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/styles/support/univariateUtils":function(){define("exports ../../../../core/screenUtils ../../../../libs/maquette/projection ../../../../libs/maquette/projector ../../../../symbols/support/symbolUtils ../../../support/widgetUtils ../../../support/jsxFactory".split(" "),
function(q,E,P,C,u,I,D){function z(l="vertical"){return"vertical"===l?D.tsx("svg",{height:"4",width:"10"},D.tsx("line",{style:"stroke:rgb(200, 200, 200);stroke-width:1",x1:"0",x2:"10",y1:"2",y2:"2"})):D.tsx("svg",{height:"10",width:"10"},D.tsx("line",{style:"stroke:rgb(200, 200, 200);stroke-width:1",x1:"5",x2:"5",y1:"0",y2:"10"}))}function Q(l,h="vertical"){const e=document.createElement("div");e.style.height="20px";e.className=k.univariateAboveAndBelowSymbol;null!=l&&(e.style.opacity=l.toString());
b.append(e,z.bind(null,h));return e}function F(l,h,e="vertical",c){l.infos.forEach((g,r)=>{if(c&&2===r)g.preview=Q(h,e);else{r=E.pt2px(g.size)+("horizontal"===e?20:10);const m=g.preview,A="div"===m?.tagName.toLowerCase(),H=A?m:document.createElement("div");H.className=k.univariateAboveAndBelowSymbol;"horizontal"===e?H.style.width=`${r}px`:H.style.height=`${r}px`;!A&&m&&H.appendChild(m);g.preview=H}})}function v(l,h,e,c="vertical"){let g=0;l=l.infos;const r=Math.floor(l.length/2);var m="full"===h||
"above"===h?0:r;for(h="full"===h||"below"===h?l.length-1:r;m<=h;m++)if(e&&m===r)g+="horizontal"===c?10:20;else{const A=E.pt2px(l[m].size)+("horizontal"===c?20:10);g+=A}return Math.round(g)}const b=C.createProjector(),k={univariateAboveAndBelowSymbol:"esri-univariate-above-and-below-ramp__symbol",colorRamp:"esri-legend__color-ramp"};q.getUnivariateAboveAndBelowRampElements=function(l,h,e="vertical"){var c=l.infos;l=c.find(({type:g})=>"size-ramp"===g);c=c.find(({type:g})=>"color-ramp"===g);l&&(l={...l},
l.infos=[...l.infos],F(l,h,e,!0));c&&(c={...c},c.infos=[...c.infos]);"horizontal"===e&&(l?.infos.reverse(),c?.infos.reverse());return{sizeRampElement:l,colorRampElement:c}};q.getUnivariateColorRampMargin=function(l,h="classic"){l=l.infos;return"classic"===h?(E.pt2px(l[0].size)+10)/2:(E.pt2px(l[0].size)-E.pt2px(l[l.length-1].size))/2};q.getUnivariateColorRampPreview=function(l,h){if(!l)return null;l=l.infos.map(e=>e.color);l=u.renderColorRampPreviewHTML("full"===h.type?l:"above"===h.type?l.slice(0,
3):l.slice(2,5),{width:h.width,height:h.height,align:h.rampAlignment,effectList:h.effectList,ariaLabel:h.ariaLabel});l.className=k.colorRamp;null!=h.opacity&&(l.style.opacity=h.opacity.toString());return l};q.getUnivariateColorRampSize=function(l,h,e,c="vertical"){const g=v(l,h,e,c);l=l.infos;var r=Math.floor(l.length/2);const m="full"===h||"above"===h?0:r;r="full"===h||"below"===h?l.length-1:r;e=e?"vertical"===c?20:10:0;c="vertical"===c?10*("full"===h?2:1):20*("full"===h?2:1);return Math.round(g-
(E.pt2px("full"===h?l[m].size+l[r].size:"above"===h?l[m].size:l[r].size)/2+e/2+c/2))};q.getUnivariateColorSizeRampElements=function(l,h="vertical"){var e=l.infos;l=e.find(({type:c})=>"size-ramp"===c);e=e.find(({type:c})=>"color-ramp"===c);l&&(l={...l},l.infos=[...l.infos],F(l,null,h,!1));e&&(e={...e},e.infos=[...e.infos]);"horizontal"===h&&(l?.infos.reverse(),e?.infos.reverse());return{sizeRampElement:l,colorRampElement:e}};q.getUnivariateSizeRampSize=v;Object.defineProperty(q,Symbol.toStringTag,
{value:"Module"})})},"esri/widgets/Legend/support/styleUtils":function(){define(["exports","../../../intl","../../../core/string","../../../intl/substitute","../../../intl/number"],function(q,E,P,C,u){q.attachToNode=function(I){I.appendChild(this)};q.getStretchStopLabel=function(I,D){return I.label?D[I.label]+": "+("string"===typeof I.value?I.value:u.formatNumber(I.value??0,{style:"decimal",notation:I.value?.toString().toLowerCase().includes("e")?"scientific":"standard"})):""};q.getTitle=function(I,
D,z){if(D){if("number"===typeof D)return D;if("string"===typeof D)return P.stripHTML(D);if("value"in D||"unit"in D)return C.substitute(I.dotValue,D);if("colorName"in D&&"bandName"in D)return I[D.colorName]+": "+(I[D.bandName]||D.bandName);if("showCount"in D)return D.showCount?I.clusterCountTitle:void 0;var Q=null;z?Q=D.ratioPercentTotal?"showRatioPercentTotal":D.ratioPercent?"showRatioPercent":D.ratio?"showRatio":D.normField?"showNormField":D.field?"showField":null:z||(Q=D.normField?"showNormField":
D.normByPct?"showNormPct":D.field?"showField":null);return Q?C.substitute("showField"===Q?"{field}":I[Q],{field:D.field,normField:D.normField}):void 0}};q.isImageryStretchedLegend=function(I,D){return!!(D&&"Stretched"===D&&10.3<=I.version&&"esri.layers.ImageryLayer"===I.declaredClass)};q.isRendererTitle=function(I,D){return!D};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/Heading":function(){define(["exports","../../core/mathUtils","./globalCss","./widgetUtils",
"./jsxFactory"],function(q,E,P,C,u){q.Heading=function({level:I,class:D,...z},Q){I=E.clamp(Math.ceil(I),1,6);return u.tsx(`h${I}`,{...z,"aria-level":String(I),class:C.classes(P.globalCss.heading,D),role:"heading"},Q)};q.incrementHeadingLevel=function(I,D=1){return E.clamp(Math.ceil(I+D),1,6)};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/globalCss":function(){define(["exports"],function(q){q.globalCss={anchor:"esri-widget__anchor",anchorDisabled:"esri-widget__anchor--disabled",
button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",disabled:"esri-disabled",disabledElement:"esri-disabled-element",empty:"esri-widget__content--empty",emptyIllustration:"esri-widget__content-illustration--empty",heading:"esri-widget__heading",hidden:"esri-hidden",input:"esri-input",interactive:"esri-interactive",
loader:"esri-widget__loader",loaderAnimation:"esri-widget__loader-animation",loaderText:"esri-widget__loader-text",menu:"esri-menu",menuHeader:"esri-menu__header",menuItem:"esri-menu__list-item",menuItemActive:"esri-menu__list-item--active",menuItemFocus:"esri-menu__list-item--focus",menuList:"esri-menu__list",noBookmarksIcon:"esri-widget__no-bookmark-icon",panel:"esri-widget--panel",panelHeightOnly:"esri-widget--panel-height-only",primaryTick:"primary-tick",primaryTickAmPm:"primary-tick__ampm",primaryTickLabel:"primary-tick__label",
rotating:"esri-rotating",secondaryTick:"secondary-tick",select:"esri-select",table:"esri-widget__table",widget:"esri-widget",widgetButton:"esri-widget--button",widgetButtonActive:"esri-widget--button-active",widgetDisabled:"esri-widget--disabled"};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/styles/Classic":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../Widget ./ClassicCSS ./support/relationshipUtils ./support/univariateUtils ../support/styleUtils ../../support/globalCss ../../support/Heading ../../support/widgetUtils ../../support/decorators/messageBundle ../../support/jsxFactory".split(" "),
function(q,E,P,C,u,I,D,z,Q,F,v,b,k,l,h,e){const c=`${z.legend}__`,g={display:"flex",alignItems:"flex-start"},r={marginLeft:"3px"},m={display:"table-cell",verticalAlign:"middle"};P=class extends D{constructor(A,H){super(A,H);this.activeLayerInfos=null;this.headingLevel=3;this.messages=null;this.type="classic"}render(){var A=this.activeLayerInfos;A=A&&A.toArray().map(H=>this._renderLegendForLayer(H)).filter(H=>!!H);return e.tsx("div",null,A&&A.length?A:e.tsx("div",{class:z.css.message},this.messages.noLegend))}_renderLegendForLayer(A){if(!A.ready)return null;
var H=!!A.children.length;const J=`${c}${A.layer.uid}-version-${A.version}`,f=A.title?k.Heading({level:this.headingLevel,class:this.classes(b.globalCss.heading,z.css.label)},A.title):null;if(H)return H=A.children.map(d=>this._renderLegendForLayer(d)).toArray(),e.tsx("div",{class:this.classes(z.css.service,z.css.groupLayer),key:J},f,H);if((H=A.legendElements)&&!H.length)return null;H=H.map(d=>this._renderLegendForElement(d,A.layer,A.effectList)).filter(d=>!!d);return H.length?e.tsx("div",{class:this.classes(z.css.service,
{[z.css.groupLayerChild]:!!A.parent}),key:J},f,e.tsx("div",{class:z.css.layer},H)):null}_renderLegendForElement(A,H,J,f){var d="color-ramp"===A.type,x="opacity-ramp"===A.type;const G="size-ramp"===A.type;let y=null;if("symbol-table"===A.type||G){var M=A.infos.map(N=>this._renderLegendForElementInfo(N,H,J,G,A.legendType)).filter(N=>!!N);M.length&&(y=e.tsx("div",{class:z.css.layerBody},M))}else"color-ramp"===A.type||"opacity-ramp"===A.type||"heatmap-ramp"===A.type||"stretch-ramp"===A.type?y=this._renderLegendForRamp(A,
H.opacity):"relationship-ramp"===A.type?y=Q.renderRelationshipRamp(A,this.id,{opacity:H.opacity,effectList:J,ariaLabel:this.messages.previewRelationshipRampAriaLabel}):"pie-chart-ramp"===A.type?y=this._renderPieChartRamp(A):"univariate-above-and-below-ramp"===A.type?y=this._renderUnivariateAboveAndBelowRamp(A,H.opacity,J):"univariate-color-size-ramp"===A.type&&(y=this._renderUnivariateColorSizeRamp(A,H.opacity,J));if(!y)return null;M=A.title;var L=null;"string"===typeof M?L=M:M&&(L=v.getTitle(this.messages,
M,d||x),L=v.isRendererTitle(M,d||x)&&M.title?`${M.title} (${L})`:L);d=f?z.css.layerChildTable:z.css.layerTable;x=L?e.tsx("div",{class:z.css.layerCaption},L):null;return e.tsx("div",{class:this.classes(d,{[z.css.layerTableSizeRamp]:G||!f})},x,y)}_renderPieChartRamp(A){return e.tsx("div",{afterCreate:v.attachToNode,bind:A.preview})}_renderUnivariateAboveAndBelowRamp(A,H,J){const {sizeRampElement:f,colorRampElement:d}=F.getUnivariateAboveAndBelowRampElements(A,H);if(!f)return null;var x=this.messages?.previewColorRampAriaLabel,
G=F.getUnivariateColorRampSize(f,"above",!0);A=F.getUnivariateColorRampSize(f,"below",!0);const y=F.getUnivariateColorRampPreview(d,{width:12,height:G,rampAlignment:"vertical",opacity:H,type:"above",effectList:J,ariaLabel:x});H=F.getUnivariateColorRampPreview(d,{width:12,height:A,rampAlignment:"vertical",opacity:H,type:"below",effectList:J,ariaLabel:x});var M=F.getUnivariateColorRampMargin(f);const L=f.infos.map(W=>W.label);J=L.map((W,w)=>{const n=2===w;return 0===w?e.tsx("div",{class:W?y?z.css.univariateAboveAndBelowLabel:
z.css.rampLabel:void 0,key:w},W):n?e.tsx("div",null):null});const N=L.length-1,T=Math.floor(L.length/2);x=L.map((W,w)=>{const n=w===N;return w===T||n?e.tsx("div",{class:W?y?z.css.univariateAboveAndBelowLabel:z.css.rampLabel:void 0,key:w},W):null});const Z={display:"table-cell",verticalAlign:"middle"};M={marginTop:`${M}px`};G={height:`${G}px`};A={height:`${A}px`};return e.tsx("div",{key:"univariate-above-and-below-ramp-preview",styles:g},e.tsx("div",{class:z.css.layerBody},f.infos.map((W,w)=>e.tsx("div",
{class:this.classes(z.css.layerRow,z.css.sizeRamp)},e.tsx("div",{afterCreate:v.attachToNode,bind:W.preview,class:z.css.symbol,styles:Z}),y||0!==w%2?null:e.tsx("div",{class:z.css.layerInfo},L[w])))),y?e.tsx("div",{key:"color-ramp-preview",styles:M},e.tsx("div",{styles:r},e.tsx("div",{styles:m},e.tsx("div",{afterCreate:v.attachToNode,bind:y,class:z.css.rampContainer})),e.tsx("div",{styles:m},e.tsx("div",{class:z.css.rampLabelsContainer,styles:G},J))),e.tsx("div",{styles:r},e.tsx("div",{styles:m},e.tsx("div",
{afterCreate:v.attachToNode,bind:H,class:z.css.rampContainer})),e.tsx("div",{styles:m},e.tsx("div",{class:z.css.rampLabelsContainer,styles:A},x)))):null)}_renderUnivariateColorSizeRamp(A,H,J){const {sizeRampElement:f,colorRampElement:d}=F.getUnivariateColorSizeRampElements(A);if(!f)return null;var x=F.getUnivariateColorRampMargin(f);A=F.getUnivariateColorRampSize(f,"full",!1);H=F.getUnivariateColorRampPreview(d,{width:12,height:A,rampAlignment:"vertical",opacity:H,type:"full",effectList:J,ariaLabel:this.messages?.previewColorRampAriaLabel});
const G=f.infos.length-1;J=f.infos.map((M,L)=>0===L||L===G?e.tsx("div",{class:M.label?d?z.css.univariateAboveAndBelowLabel:z.css.rampLabel:void 0,key:L},M.label):null);const y={display:"table-cell",verticalAlign:"middle"};x={marginTop:`${x}px`};A={height:`${A}px`};return e.tsx("div",{key:"univariate-above-and-below-ramp-preview",styles:g},e.tsx("div",{class:z.css.layerBody},f.infos.map(M=>e.tsx("div",{class:this.classes(z.css.layerRow,z.css.sizeRamp)},e.tsx("div",{afterCreate:v.attachToNode,bind:M.preview,
class:z.css.symbol,styles:y})))),e.tsx("div",{key:"color-ramp-preview",styles:x},e.tsx("div",{styles:r},e.tsx("div",{styles:m},e.tsx("div",{afterCreate:v.attachToNode,bind:H,class:z.css.rampContainer})),e.tsx("div",{styles:m},e.tsx("div",{class:z.css.rampLabelsContainer,styles:A},J)))))}_renderLegendForRamp(A,H){const J=A.infos,f="heatmap-ramp"===A.type,d="stretch-ramp"===A.type,x=A.preview;x.className=`${z.css.colorRamp} ${"opacity-ramp"===A.type?z.css.opacityRamp:""}`;null!=H&&(x.style.opacity=
H.toString());A=J.map(G=>e.tsx("div",{class:G.label?z.css.rampLabel:void 0},f?this.messages[G.label]||G.label:d?v.getStretchStopLabel(G,this.messages):G.label));H={height:x.style.height};return e.tsx("div",{class:z.css.layerRow},e.tsx("div",{class:z.css.symbolContainer,styles:{width:"24px"}},e.tsx("div",{afterCreate:v.attachToNode,bind:x,class:z.css.rampContainer})),e.tsx("div",{class:z.css.layerInfo},e.tsx("div",{class:z.css.rampLabelsContainer,styles:H},A)))}_renderLegendForElementInfo(A,H,J,f,
d){if(A.type)return this._renderLegendForElement(A,H,J,!0);J=null;d=v.isImageryStretchedLegend(H,d);A.preview?J=e.tsx("div",{afterCreate:v.attachToNode,bind:A.preview,class:z.css.symbol}):A.src&&(J=this._renderImage(A,H,d));if(!J)return null;H={[z.css.imageryLayerInfoStretched]:d};return e.tsx("div",{class:z.css.layerRow},e.tsx("div",{class:this.classes(z.css.symbolContainer,{[z.css.imageryLayerInfoStretched]:d,[z.css.sizeRamp]:!d&&f})},J),e.tsx("div",{class:this.classes(z.css.layerInfo,H)},v.getTitle(this.messages,
A.label,!1)||""))}_renderImage(A,H,J){const {label:f,src:d,opacity:x}=A;J={[z.css.imageryLayerStretchedImage]:J,[z.css.symbol]:!J};H={opacity:`${null!=x?x:H.opacity}`};return e.tsx("img",{alt:v.getTitle(this.messages,f,!1),"aria-label":v.getTitle(this.messages,f,!1),border:0,class:this.classes(J),height:A.height,src:d,styles:H,width:A.width})}};q.__decorate([E.property()],P.prototype,"activeLayerInfos",void 0);q.__decorate([E.property()],P.prototype,"headingLevel",void 0);q.__decorate([E.property(),
h.messageBundle("esri/widgets/Legend/t9n/Legend")],P.prototype,"messages",void 0);q.__decorate([E.property({readOnly:!0})],P.prototype,"type",void 0);return P=q.__decorate([I.subclass("esri.widgets.Legend.styles.Classic")],P)})},"esri/widgets/Legend/styles/ClassicCSS":function(){define(["exports"],function(q){q.css={service:"esri-legend__service",label:"esri-legend__service-label",layer:"esri-legend__layer",groupLayer:"esri-legend__group-layer",groupLayerChild:"esri-legend__group-layer-child",layerTable:"esri-legend__layer-table",
layerTableSizeRamp:"esri-legend__layer-table--size-ramp",layerChildTable:"esri-legend__layer-child-table",layerCaption:"esri-legend__layer-caption",layerBody:"esri-legend__layer-body",layerRow:"esri-legend__layer-row",layerCell:"esri-legend__layer-cell",layerInfo:"esri-legend__layer-cell esri-legend__layer-cell--info",imageryLayerStretchedImage:"esri-legend__imagery-layer-image--stretched",imageryLayerCellStretched:"esri-legend__imagery-layer-cell--stretched",imageryLayerInfoStretched:"esri-legend__imagery-layer-info--stretched",
symbolContainer:"esri-legend__layer-cell esri-legend__layer-cell--symbols",symbol:"esri-legend__symbol",rampContainer:"esri-legend__ramps",sizeRamp:"esri-legend__size-ramp",colorRamp:"esri-legend__color-ramp",opacityRamp:"esri-legend__opacity-ramp",borderlessRamp:"esri-legend__borderless-ramp",rampTick:"esri-legend__ramp-tick",rampFirstTick:"esri-legend__ramp-tick-first",rampLastTick:"esri-legend__ramp-tick-last",rampLabelsContainer:"esri-legend__ramp-labels",rampLabel:"esri-legend__ramp-label",message:"esri-legend__message",
univariateAboveAndBelowLabel:"esri-univariate-above-and-below-ramp__label"};q.legend="esri-legend";Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define("../chunks/tslib.es6 ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./Widget ./Legend/LegendViewModel ./Legend/styles/Card ./Legend/styles/Classic ./support/globalCss ./support/legacyIcon ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory".split(" "),function(q,E,P,C,u,I,D,z,Q,F,v,b,k,l,h,e){var c=k.legacyIcon.layerList;u=class extends z{constructor(g,
r){super(g,r);this.headingLevel=3;this.iconClass=c;this.messages=this.icon=null;this.style=new v;this.viewModel=new Q}initialize(){this.addHandles([E.on(()=>this.view,"resize",()=>this.scheduleRender()),E.on(()=>this.activeLayerInfos,"change",()=>this._refreshActiveLayerInfos(this.activeLayerInfos)),E.watch(()=>this.headingLevel,g=>{const {style:r}=this;r&&(r.headingLevel=g)}),E.watch(()=>this.style,(g,r)=>{r&&g!==r&&r.destroy();g&&(g.activeLayerInfos=this.activeLayerInfos,"card"===g.type&&(g.view=
this.view),g.headingLevel=this.headingLevel)},E.initial)])}get activeLayerInfos(){return this.viewModel.activeLayerInfos}set activeLayerInfos(g){this.viewModel.activeLayerInfos=g}get basemapLegendVisible(){return this.viewModel.basemapLegendVisible}set basemapLegendVisible(g){this.viewModel.basemapLegendVisible=g}get groundLegendVisible(){return this.viewModel.groundLegendVisible}set groundLegendVisible(g){this.viewModel.groundLegendVisible=g}get hideLayersNotInCurrentView(){return this.viewModel.hideLayersNotInCurrentView}set hideLayersNotInCurrentView(g){this.viewModel.hideLayersNotInCurrentView=
g}get keepCacheOnDestroy(){return this.viewModel.keepCacheOnDestroy}set keepCacheOnDestroy(g){this.viewModel.keepCacheOnDestroy=g}get respectLayerVisibility(){return this.viewModel.respectLayerVisibility}set respectLayerVisibility(g){this.viewModel.respectLayerVisibility=g}get label(){return this.messages?.widgetLabel??""}set label(g){this._overrideIfSome("label",g)}get layerInfos(){return this.viewModel.layerInfos}set layerInfos(g){this.viewModel.layerInfos=g}castStyle(g){if(g instanceof F||g instanceof
v)return g;if("string"===typeof g)return"card"===g?new F:new v;if(g&&"string"===typeof g.type){const r={...g};delete r.type;return new ("card"===g.type?F:v)(r)}return new v}get view(){return this.viewModel.view}set view(g){this.viewModel.view=g}render(){return e.tsx("div",{class:this.classes("esri-legend",b.globalCss.widget,this.style instanceof v?b.globalCss.panel:null)},this.style.render())}_refreshActiveLayerInfos(g){g.forEach(r=>{this.removeHandles(`version_${r.layer.uid}`);this._renderOnActiveLayerInfoChange(r)});
this.scheduleRender()}_renderOnActiveLayerInfoChange(g){var r=E.watch(()=>g.version,()=>this.scheduleRender());this.addHandles(r,`version_${g.layer.uid}`);r=E.on(()=>g.children,"change",()=>g.children.forEach(m=>this._renderOnActiveLayerInfoChange(m)),E.initial);this.addHandles(r,`version_${g.layer.uid}`);g.children.forEach(m=>this._renderOnActiveLayerInfoChange(m))}};q.__decorate([P.property()],u.prototype,"activeLayerInfos",null);q.__decorate([P.property()],u.prototype,"basemapLegendVisible",null);
q.__decorate([P.property()],u.prototype,"groundLegendVisible",null);q.__decorate([P.property()],u.prototype,"headingLevel",void 0);q.__decorate([P.property()],u.prototype,"hideLayersNotInCurrentView",null);q.__decorate([P.property()],u.prototype,"keepCacheOnDestroy",null);q.__decorate([P.property()],u.prototype,"respectLayerVisibility",null);q.__decorate([P.property()],u.prototype,"iconClass",void 0);q.__decorate([P.property()],u.prototype,"icon",void 0);q.__decorate([P.property()],u.prototype,"label",
null);q.__decorate([P.property()],u.prototype,"layerInfos",null);q.__decorate([P.property(),h.messageBundle("esri/widgets/Legend/t9n/Legend")],u.prototype,"messages",void 0);q.__decorate([P.property()],u.prototype,"style",void 0);q.__decorate([C.cast("style")],u.prototype,"castStyle",null);q.__decorate([P.property()],u.prototype,"view",null);q.__decorate([P.property()],u.prototype,"viewModel",void 0);return u=q.__decorate([D.subclass("esri.widgets.Legend")],u)});