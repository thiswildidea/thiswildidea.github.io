// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.28/esri/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Attachments":function(){define("require ../chunks/tslib.es6 ../core/Error ../core/reactiveUtils ../core/unitFormatUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./Widget ./Attachments/AttachmentsViewModel ./Attachments/support/attachmentUtils ./support/componentsUtils ./support/globalCss ./support/legacyIcon ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory".split(" "),
function(a,b,d,m,g,x,n,B,M,k,w,e,f,l,q,r,c,t,h){const u={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},L=window.CSS;B=class extends w{constructor(K,F){super(K,F);this.displayType="auto";this.selectedFile=this.messagesUnits=this.messages=null;this.submitting=!1;this.viewModel=null;this.visibleElements={...u};this._supportsImageOrientation=L&&L.supports&&L.supports("image-orientation","from-image");this._updateAttachmentForm=
this._addAttachmentForm=null}normalizeCtorArgs(K){K?.viewModel||(K={viewModel:new e,...K});return K}initialize(){this.addHandles([m.on(()=>this.viewModel?.attachmentInfos,"change",()=>this.scheduleRender()),m.on(()=>this.viewModel?.fileInfos,"change",()=>this.scheduleRender()),m.watch(()=>this.viewModel?.mode,()=>this._modeChanged(),m.initial)])}loadDependencies(){return l.loadCalciteComponents({icon:()=>new Promise((K,F)=>a(["../chunks/calcite-icon"],K,F))})}get capabilities(){return this.viewModel.capabilities}set capabilities(K){this.viewModel.capabilities=
K}get effectiveDisplayType(){const {displayType:K}=this;return K&&"auto"!==K?K:this.viewModel.supportsResizeAttachments?"preview":"list"}get graphic(){return this.viewModel.graphic}set graphic(K){this.viewModel.graphic=K}get label(){return this.messages?.widgetLabel??""}set label(K){this._overrideIfSome("label",K)}castVisibleElements(K){return{...u,...K}}addAttachment(){const {_addAttachmentForm:K,viewModel:F}=this;this._set("submitting",!0);this._set("error",null);return F.addAttachment(K).then(y=>
{this._set("submitting",!1);this._set("error",null);F.mode="view";return y}).catch(y=>{this._set("submitting",!1);this._set("error",new d("attachments:add-attachment",this.messages.addErrorMessage,y));throw y;})}deleteAttachment(K){const {viewModel:F}=this;this._set("submitting",!0);this._set("error",null);return F.deleteAttachment(K).then(y=>{this._set("submitting",!1);this._set("error",null);F.mode="view";return y}).catch(y=>{this._set("submitting",!1);this._set("error",new d("attachments:delete-attachment",
this.messages.deleteErrorMessage,y));throw y;})}updateAttachment(){const {viewModel:K}=this,{_updateAttachmentForm:F}=this;this._set("submitting",!0);this._set("error",null);return K.updateAttachment(F).then(y=>{this._set("submitting",!1);this._set("error",null);K.mode="view";return y}).catch(y=>{this._set("submitting",!1);this._set("error",new d("attachments:update-attachment",this.messages.updateErrorMessage,y));throw y;})}addFile(){const K=this.viewModel.addFile(this.selectedFile,this._addAttachmentForm);
this.viewModel.mode="view";return K}updateFile(){const {viewModel:K}=this,F=K.updateFile(this.selectedFile,this._updateAttachmentForm,K.activeFileInfo);K.mode="view";return F}deleteFile(K){K=this.viewModel.deleteFile(K||this.viewModel.activeFileInfo?.file);this.viewModel.mode="view";return K}render(){const {submitting:K,viewModel:F}=this,{state:y}=F;return h.tsx("div",{class:this.classes("esri-attachments",q.globalCss.widget)},K?this._renderProgressBar():null,"loading"===y?this._renderLoading():this._renderAttachments(),
this._renderErrorMessage())}_renderErrorMessage(){const {error:K,visibleElements:F}=this;return K&&F.errorMessage?h.tsx("div",{class:"esri-attachments__error-message",key:"error-message"},K.message):null}_renderAttachments(){const {activeFileInfo:K,mode:F,activeAttachmentInfo:y}=this.viewModel;return"add"===F?this._renderAddForm():"edit"===F?this._renderDetailsForm(y||K):this._renderAttachmentContainer()}_renderLoading(){return h.tsx("div",{class:"esri-attachments__loader-container",key:"loader"},
h.tsx("div",{class:"esri-attachments__loader"}))}_renderProgressBar(){return this.visibleElements.progressBar?h.tsx("div",{class:"esri-attachments__progress-bar",key:"progress-bar"}):null}_renderAddForm(){const {submitting:K,selectedFile:F}=this;var y=K||!F,p=this.visibleElements.cancelAddButton?h.tsx("button",{bind:this,class:this.classes(q.globalCss.button,q.globalCss.buttonTertiary,q.globalCss.buttonSmall,q.globalCss.buttonHalf,K&&q.globalCss.buttonDisabled),disabled:K,onclick:this._cancelForm,
type:"button"},this.messages.cancel):null;y=this.visibleElements.addSubmitButton?h.tsx("button",{class:this.classes(q.globalCss.button,q.globalCss.buttonSecondary,q.globalCss.buttonSmall,q.globalCss.buttonHalf,{[q.globalCss.buttonDisabled]:y}),disabled:y,type:"submit"},this.messages.add):null;const I=F?h.tsx("span",{class:"esri-attachments__file-name",key:"file-name"},F.name):null;p=h.tsx("form",{afterCreate:c.storeNode,afterRemoved:c.discardNode,bind:this,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},
h.tsx("fieldset",{class:"esri-attachments__file-fieldset"},I,h.tsx("label",{class:this.classes("esri-attachments__file-label",q.globalCss.button,q.globalCss.buttonSecondary)},F?this.messages.changeFile:this.messages.selectFile,h.tsx("input",{bind:this,class:"esri-attachments__file-input",name:"attachment",onchange:this._handleFileInputChange,type:"file"}))),y,p);return h.tsx("div",{class:"esri-attachments__form-node",key:"add-form-container"},p)}_renderDetailsForm(K){const {visibleElements:F,viewModel:y,
selectedFile:p,submitting:I}=this;var {capabilities:R}=y,D=I||!p;let E;if(p){var N=p.type;E=p.name;var C=p.size}else if(K&&"file"in K)N=K.file.type,E=K.file.name,C=K.file.size;else if(K&&"contentType"in K){N=K.contentType;E=K.name;C=K.size;var P=K.url}var H=R.editing&&R.operations?.delete&&F.deleteButton?h.tsx("button",{bind:this,class:this.classes(q.globalCss.button,q.globalCss.buttonSmall,q.globalCss.buttonTertiary,"esri-attachments__delete-button",{[q.globalCss.buttonDisabled]:I}),disabled:I,key:"delete-button",
onclick:z=>this._submitDeleteAttachment(z,K),type:"button"},this.messages.delete):void 0;D=R.editing&&R.operations?.update&&F.updateButton?h.tsx("button",{class:this.classes(q.globalCss.button,q.globalCss.buttonSmall,q.globalCss.buttonThird,{[q.globalCss.buttonDisabled]:D}),disabled:D,key:"update-button",type:"submit"},this.messages.update):void 0;const J=this.visibleElements.cancelUpdateButton?h.tsx("button",{bind:this,class:this.classes(q.globalCss.button,q.globalCss.buttonSmall,q.globalCss.buttonTertiary,
q.globalCss.buttonThird,{[q.globalCss.buttonDisabled]:I}),disabled:I,key:"cancel-button",onclick:this._cancelForm,type:"button"},this.messages.cancel):void 0;R=R.editing&&R.operations?.update?h.tsx("fieldset",{class:"esri-attachments__file-fieldset",key:"file"},h.tsx("span",{class:"esri-attachments__file-name",key:"file-name"},E),h.tsx("label",{class:this.classes("esri-attachments__file-label",q.globalCss.button,q.globalCss.buttonSecondary)},this.messages.changeFile,h.tsx("input",{bind:this,class:"esri-attachments__file-input",
name:"attachment",onchange:this._handleFileInputChange,type:"file"}))):void 0;C=h.tsx("fieldset",{class:"esri-attachments__metadata-fieldset",key:"size"},h.tsx("label",null,g.formatFileSize(this.messagesUnits,C??0)));N=h.tsx("fieldset",{class:"esri-attachments__metadata-fieldset",key:"content-type"},h.tsx("label",null,N));P=null!=P?h.tsx("a",{class:"esri-attachments__item-link",href:P,rel:"noreferrer",target:"_blank"},this._renderImageMask(K,400),h.tsx("div",{class:"esri-attachments__item-link-overlay"},
h.tsx("span",{class:"esri-attachments__item-link-overlay-icon"},h.tsx("calcite-icon",{icon:"launch"})))):this._renderImageMask(K,400);H=h.tsx("form",{afterCreate:c.storeNode,afterRemoved:c.discardNode,bind:this,"data-node-ref":"_updateAttachmentForm",onsubmit:z=>this._submitUpdateAttachment(z,K)},h.tsx("div",{class:"esri-attachments__metadata"},C,N),R,h.tsx("div",{class:"esri-attachments__actions"},H,J,D));return h.tsx("div",{class:"esri-attachments__form-node",key:"edit-form-container"},P,H)}_renderImageMask(K,
F){return K?"file"in K?this._renderGenericImageMask(K.file.name,K.file.type):this._renderImageMaskForAttachment(K,F):null}_renderGenericImageMask(K,F){var {supportsResizeAttachments:y}=this.viewModel;F=f.getIconPath(F);y={["esri-attachments__image--resizable"]:y};return h.tsx("div",{class:this.classes("esri-attachments__item-mask--icon","esri-attachments__item-mask"),key:F},h.tsx("img",{alt:K,class:this.classes(y,"esri-attachments__image"),src:F,title:K}))}_renderImageMaskForAttachment(K,F){var {supportsResizeAttachments:y}=
this.viewModel;if(!K)return null;const {contentType:p,name:I,url:R}=K;if(!y||!f.isSupportedImage(p))return this._renderGenericImageMask(I,p);K=(K=this._getCSSTransform(K))?{transform:K,"image-orientation":"none"}:{};F=`${R}${R?.includes("?")?"\x26":"?"}w=${F}`;y={["esri-attachments__image--resizable"]:y};return h.tsx("div",{class:this.classes("esri-attachments__item-mask"),key:F},h.tsx("img",{alt:I,class:this.classes(y,"esri-attachments__image"),src:F,styles:K,title:I}))}_renderFile(K){const {file:F}=
K;return h.tsx("li",{class:"esri-attachments__item",key:F},h.tsx("button",{"aria-label":this.messages.attachmentDetails,bind:this,class:"esri-attachments__item-button",key:"details-button",onclick:()=>this._startEditFile(K),title:this.messages.attachmentDetails,type:"button"},this._renderImageMask(K),h.tsx("label",{class:"esri-attachments__label"},h.tsx("span",{class:"esri-attachments__filename"},F.name||this.messages.noTitle),h.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-chevron-icon",
c.isRTL(this.container)?r.legacyIcon.left:r.legacyIcon.right)}))))}_renderAttachmentInfo({attachmentInfo:K,displayType:F}){const {viewModel:y,effectiveDisplayType:p}=this,{capabilities:I,supportsResizeAttachments:R}=y,{contentType:D,name:E,url:N}=K;F=this._renderImageMask(K,"list"===F?48:400);var C=I.editing?h.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-chevron-icon",c.isRTL(this.container)?r.legacyIcon.left:r.legacyIcon.right)}):null;C="preview"===p&&R&&f.isSupportedImage(D)?
null:h.tsx("label",{class:"esri-attachments__label"},h.tsx("span",{class:"esri-attachments__filename"},E||this.messages.noTitle),C);F=[F,C];F=I.editing?h.tsx("button",{"aria-label":this.messages.attachmentDetails,bind:this,class:"esri-attachments__item-button","data-attachment-info-id":K.id,key:"details-button",onclick:()=>this._startEditAttachment(K),title:this.messages.attachmentDetails,type:"button"},F):h.tsx("a",{class:"esri-attachments__item-button",href:N??void 0,key:"details-link",target:"_blank"},
F);return h.tsx("li",{class:"esri-attachments__item",key:K},F)}_renderAttachmentContainer(){const {effectiveDisplayType:K,viewModel:F,visibleElements:y}=this,{attachmentInfos:p,capabilities:I,fileInfos:R}=F;var D=!!p?.length;const E=!!R?.length,N={["esri-attachments__container--list"]:"preview"!==K,["esri-attachments__container--preview"]:"preview"===K},C=I.editing&&I.operations?.add&&y.addButton?h.tsx("button",{bind:this,class:this.classes(q.globalCss.button,q.globalCss.buttonTertiary,"esri-attachments__add-attachment-button"),
onclick:()=>this._startAddAttachment(),type:"button"},h.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-add-icon",r.legacyIcon.plus)}),this.messages.add):void 0,P=D?h.tsx("ul",{class:"esri-attachments__items",key:"attachments-list"},p.toArray().map(J=>this._renderAttachmentInfo({attachmentInfo:J,displayType:K}))):void 0,H=E?h.tsx("ul",{class:"esri-attachments__items",key:"file-list"},R.toArray().map(J=>this._renderFile(J))):void 0;D=E||D?void 0:h.tsx("div",{class:q.globalCss.empty},
this.messages.noAttachments);return h.tsx("div",{class:this.classes("esri-attachments__container",N),key:"attachments-container"},P,H,D,C)}_modeChanged(){this._set("error",null);this._set("selectedFile",null)}_handleFileInputChange(K){K=K.target.files?.item(0);this._set("selectedFile",K)}_submitDeleteAttachment(K,F){K.preventDefault();F&&("file"in F?this.deleteFile(F.file):F&&this.deleteAttachment(F))}_submitAddAttachment(K){K.preventDefault();this.viewModel.filesEnabled?this.addFile():this.addAttachment()}_submitUpdateAttachment(K,
F){K.preventDefault();F&&"file"in F?this.updateFile():this.updateAttachment()}_startEditAttachment(K){const {viewModel:F}=this;F.activeFileInfo=null;F.activeAttachmentInfo=K;F.mode="edit"}_startEditFile(K){const {viewModel:F}=this;F.activeAttachmentInfo=null;F.activeFileInfo=K;F.mode="edit"}_startAddAttachment(){this.viewModel.mode="add"}_cancelForm(K){K.preventDefault();this.viewModel.mode="view"}_getCSSTransform(K){({orientationInfo:K}=K);return!this._supportsImageOrientation&&K?[K.rotation?`rotate(${K.rotation}deg)`:
"",K.mirrored?"scaleX(-1)":""].join(" "):""}};b.__decorate([x.property()],B.prototype,"capabilities",null);b.__decorate([x.property()],B.prototype,"displayType",void 0);b.__decorate([x.property({readOnly:!0})],B.prototype,"effectiveDisplayType",null);b.__decorate([x.property()],B.prototype,"graphic",null);b.__decorate([x.property()],B.prototype,"label",null);b.__decorate([x.property(),t.messageBundle("esri/widgets/Attachments/t9n/Attachments")],B.prototype,"messages",void 0);b.__decorate([x.property(),
t.messageBundle("esri/core/t9n/Units")],B.prototype,"messagesUnits",void 0);b.__decorate([x.property({readOnly:!0})],B.prototype,"selectedFile",void 0);b.__decorate([x.property({readOnly:!0})],B.prototype,"submitting",void 0);b.__decorate([x.property({readOnly:!0})],B.prototype,"error",void 0);b.__decorate([x.property({type:e})],B.prototype,"viewModel",void 0);b.__decorate([x.property()],B.prototype,"visibleElements",void 0);b.__decorate([n.cast("visibleElements")],B.prototype,"castVisibleElements",
null);return B=b.__decorate([k.subclass("esri.widgets.Attachments")],B)})},"esri/core/unitFormatUtils":function(){define("exports ./ByteSizeUnit ./Cyclical ./mathUtils ./quantityUtils ./string ./unitUtils ../intl/number".split(" "),function(a,b,d,m,g,x,n,B){function M(q,r,c){return q.units[r][c]}function k(q,r,c,t=2,h="abbr"){return`${B.formatNumber(r,{minimumFractionDigits:t,maximumFractionDigits:t,signDisplay:0<r?"never":"exceptZero"})} ${M(q,c,h)}`}function w(q,r,c,t=2,h="abbr"){return`${B.formatNumber(r,
{minimumFractionDigits:t,maximumFractionDigits:t,signDisplay:"exceptZero"})} ${M(q,c,h)}`}function e(q,r){const c=JSON.stringify(r);let t=f.get(c);t||(t=new Intl.NumberFormat("en-US",r),f.set(c,t));return/\-?\+?360/.test(t.format(q))?0:q}const f=new Map,l=["B","kB","MB","GB","TB"];a.formatAngleDegrees=function(q,r,c,t,h){h=h??2;q=d.cyclicalDegrees.normalize(g.convertRotationType(n.convertUnit(q,r,"degrees"),c,t),0,!0);h={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:h,minimumFractionDigits:h,
signDisplay:0<q?"never":"exceptZero"};q=e(q,h);return B.formatNumber(q,h)};a.formatDMS=function(q,r,c=2){q=n.convertUnit(q,r,"degrees");r=q-Math.floor(q);q-=r;r*=60;let t=r-Math.floor(r);r-=t;t*=60;return`${q.toFixed()}\u00b0 ${r.toFixed()}' ${t.toFixed(c)}"`};a.formatDecimal=k;a.formatFileSize=function(q,r){r=Math.round(r);let c=0===r?0:Math.floor(Math.log(r)/Math.log(b.ByteSizeUnit.KILOBYTES));c=m.clamp(c,0,l.length-1);r=B.formatNumber(r/b.ByteSizeUnit.KILOBYTES**c,{maximumFractionDigits:2});return x.replace(q.units.bytes[l[c]],
{fileSize:r})};a.formatImperialArea=function(q,r,c,t=2,h="abbr"){const u=n.adaptiveImperialAreaUnit(r,c);return k(q,n.convertUnit(r,c,u),u,t,h)};a.formatImperialLength=function(q,r,c,t=2,h="abbr"){const u=n.adaptiveImperialLengthUnit(r,c);return k(q,n.convertUnit(r,c,u),u,t,h)};a.formatImperialRelativeLength=function(q,r,c,t=2,h="abbr"){const u=n.adaptiveImperialLengthUnit(r,c);return w(q,n.convertUnit(r,c,u),u,t,h)};a.formatImperialRelativeVerticalLength=function(q,r,c,t=2,h="abbr"){const u=n.adaptiveImperialVerticalLengthUnit(r,
c);return w(q,n.convertUnit(r,c,u),u,t,h)};a.formatImperialVerticalLength=function(q,r,c,t=2,h="abbr"){const u=n.adaptiveImperialVerticalLengthUnit(r,c);return k(q,n.convertUnit(r,c,u),u,t,h)};a.formatMetricArea=function(q,r,c,t=2,h="abbr"){const u=n.adaptiveMetricAreaUnit(r,c);return k(q,n.convertUnit(r,c,u),u,t,h)};a.formatMetricLength=function(q,r,c,t=2,h="abbr"){const u=n.adaptiveMetricLengthUnit(r,c);return k(q,n.convertUnit(r,c,u),u,t,h)};a.formatMetricRelativeLength=function(q,r,c,t=2,h="abbr"){const u=
n.adaptiveMetricLengthUnit(r,c);return w(q,n.convertUnit(r,c,u),u,t,h)};a.formatMetricRelativeVerticalLength=function(q,r,c,t=2,h="abbr"){const u=n.adaptiveMetricVerticalLengthUnit(r,c);return w(q,n.convertUnit(r,c,u),u,t,h)};a.formatMetricVerticalLength=function(q,r,c,t=2,h="abbr"){const u=n.adaptiveMetricVerticalLengthUnit(r,c);return k(q,n.convertUnit(r,c,u),u,t,h)};a.formatRelativeAngleDegrees=function(q,r,c,t,h){c!==t&&(q=-q);h=h??2;c={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:h,
minimumFractionDigits:h,signDisplay:"exceptZero"};q=n.convertUnit(q,r,"degrees")%360;q=e(q,c);return B.formatNumber(q,c)};a.formatRelativeDecimal=w;a.unitName=M;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/ByteSizeUnit":function(){define(["exports"],function(a){a.ByteSizeUnit=void 0;var b=a.ByteSizeUnit||(a.ByteSizeUnit={});b[b.KILOBYTES=1024]="KILOBYTES";b[b.MEGABYTES=1048576]="MEGABYTES";b[b.GIGABYTES=1073741824]="GIGABYTES";Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/core/quantityUtils":function(){define(["exports","./unitUtils"],function(a,b){function d(f,l){return{type:b.unitType(l),value:f,unit:l}}function m(f,l){return{type:b.unitType(l),value:f,unit:l}}function g(f,l){return{type:b.unitType(l),value:f,unit:l}}function x(f,l,q="arithmetic"){return{type:b.unitType(l),value:f,unit:l,rotationType:q}}function n(f,l){const q=B(f,l);return"angle"===f.type?x(q,l,f.rotationType):d(q,l)}function B(f,l){return b.convertUnit(f.value,f.unit,
l)}const M=m(0,"meters"),k=g(0,"square-meters"),w=x(0,"radians"),e=x(0,"degrees");a.convertRotationType=function(f,l,q){if(l===q)return f;switch(q){case "arithmetic":case "geographic":return-f+90}};a.createAngle=x;a.createArea=g;a.createLength=m;a.createQuantity=d;a.createVolume=function(f,l){return{type:b.unitType(l),value:f,unit:l}};a.isBaseUnit=function(f){return b.isBaseUnit(f.unit)};a.max=function(f,l){return null==f?l:null==l?f:f.value>b.convertUnit(l.value,l.unit,f.unit)?f:l};a.min=function(f,
l){return null==f?l:null==l?f:f.value<b.convertUnit(l.value,l.unit,f.unit)?f:l};a.scale=function(f,l){return null==f?null:{...f,value:f.value*l}};a.toBaseUnit=function(f){return n(f,b.baseUnitForUnit(f.unit))};a.toUnit=n;a.valueInUnit=B;a.zeroDegrees=e;a.zeroMeters=M;a.zeroRadians=w;a.zeroSquareMeters=k;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Attachments/AttachmentsViewModel":function(){define("../../chunks/tslib.es6 ../../Graphic ../../core/Accessor ../../core/Collection ../../core/Error ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../rest/query/support/AttachmentInfo ../../rest/support/AttachmentQuery ../Feature/support/featureUtils".split(" "),
function(a,b,d,m,g,x,n,B,M,k,w,e,f,l){const q={editing:!1,operations:{add:!0,update:!0,delete:!0}},r=m.ofType(e);d=class extends d{constructor(c){super(c);this._attachmentLayer=this._getAttachmentsPromise=null;this.capabilities={...q};this.activeFileInfo=this.activeAttachmentInfo=null;this.attachmentInfos=new r;this.fileInfos=new m;this.graphic=null;this.mode="view";this.filesEnabled=!1;this.addHandles(x.watch(()=>this.graphic,()=>this._graphicChanged(),x.initial))}destroy(){this.graphic=this._attachmentLayer=
null}castCapabilities(c){return{...q,...c}}get state(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}get supportsResizeAttachments(){var {graphic:c}=this;if(!c)return!1;c=c.layer||c.sourceLayer;return c?.loaded&&"capabilities"in c&&c.capabilities&&"operations"in c.capabilities&&"supportsResizeAttachments"in c.capabilities.operations&&c.capabilities.operations.supportsResizeAttachments||!1}async getAttachments(){const {_attachmentLayer:c,attachmentInfos:t}=this;if(!c||
"function"!==typeof c.queryAttachments)throw new g("invalid-layer","getAttachments(): A valid layer is required.");const h=this._getObjectId();var u=new f({objectIds:[h],returnMetadata:!0});const L=[];this._getAttachmentsPromise=u=c.queryAttachments(u).then(K=>K[h]||L).catch(()=>L);this.notifyChange("state");u=await u;t.removeAll();u.length&&t.addMany(u);this._getAttachmentsPromise=null;this.notifyChange("state");return u}async addAttachment(c,t=this.graphic){const {_attachmentLayer:h,attachmentInfos:u,
capabilities:L}=this;if(!t)throw new g("invalid-graphic","addAttachment(): A valid graphic is required.",{graphic:t});if(!c)throw new g("invalid-attachment","addAttachment(): An attachment is required.",{attachment:c});if(!L.operations?.add)throw new g("invalid-capabilities","addAttachment(): add capabilities are required.");if(!h||"function"!==typeof h.addAttachment)throw new g("invalid-layer","addAttachment(): A valid layer is required.");c=await h.addAttachment(t,c).then(K=>this._queryAttachment(K.objectId,
t));u.add(c);return c}async deleteAttachment(c){const {_attachmentLayer:t,attachmentInfos:h,graphic:u,capabilities:L}=this;if(!c)throw new g("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:c});if(!L.operations?.delete)throw new g("invalid-capabilities","deleteAttachment(): delete capabilities are required.");if(!t||"function"!==typeof t.deleteAttachments)throw new g("invalid-layer","deleteAttachment(): A valid layer is required.");if(!u)throw new g("invalid-graphic",
"deleteAttachment(): A graphic is required.");const K=await t.deleteAttachments(u,[c.id]).then(()=>c);h.remove(K);return K}async updateAttachment(c,t=this.activeAttachmentInfo){const {_attachmentLayer:h,attachmentInfos:u,graphic:L,capabilities:K}=this;if(!c)throw new g("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:c});if(!t)throw new g("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:t});if(!K.operations?.update)throw new g("invalid-capabilities",
"updateAttachment(): Update capabilities are required.");const F=u.indexOf(t);if(!h||"function"!==typeof h.updateAttachment)throw new g("invalid-layer","updateAttachment(): A valid layer is required.");if(!L)throw new g("invalid-graphic","updateAttachment(): A graphic is required.");c=await h.updateAttachment(L,t.id,c).then(y=>this._queryAttachment(y.objectId));u.splice(F,1,c);return c}async commitFiles(){await Promise.all(this.fileInfos.items.map(c=>this.addAttachment(c.form)));this.fileInfos.removeAll();
return this.getAttachments()}addFile(c,t){if(!c||!t)return null;c={file:c,form:t};this.fileInfos.add(c);return c}updateFile(c,t,h=this.activeFileInfo){if(!c||!t||!h)return null;h=this.fileInfos.indexOf(h);-1<h&&this.fileInfos.splice(h,1,{file:c,form:t});return this.fileInfos.items[h]}deleteFile(c){const t=this.fileInfos.find(h=>h.file===c);return t?(this.fileInfos.remove(t),t):null}async _queryAttachment(c,t){const {_attachmentLayer:h}=this;if(!c||!h?.queryAttachments)throw new g("invalid-attachment-id",
"Could not query attachment.");const u=this._getObjectId(t);c=new f({objectIds:[u],attachmentsWhere:`AttachmentId=${c}`,returnMetadata:!0});return h.queryAttachments(c).then(L=>L[u][0])}_getObjectId(c=this.graphic){return c?.getObjectId()??null}_graphicChanged(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch(()=>{}))}_setAttachmentLayer(){var {graphic:c}=this;this._attachmentLayer=(c=l.getSourceLayer(c))?"scene"===c.type&&null!=c.associatedLayer?c.associatedLayer:c:null}};a.__decorate([n.property()],
d.prototype,"capabilities",void 0);a.__decorate([B.cast("capabilities")],d.prototype,"castCapabilities",null);a.__decorate([n.property()],d.prototype,"activeAttachmentInfo",void 0);a.__decorate([n.property()],d.prototype,"activeFileInfo",void 0);a.__decorate([n.property({readOnly:!0,type:r})],d.prototype,"attachmentInfos",void 0);a.__decorate([n.property()],d.prototype,"fileInfos",void 0);a.__decorate([n.property({type:b})],d.prototype,"graphic",void 0);a.__decorate([n.property()],d.prototype,"mode",
void 0);a.__decorate([n.property({readOnly:!0})],d.prototype,"state",null);a.__decorate([n.property()],d.prototype,"filesEnabled",void 0);a.__decorate([n.property({readOnly:!0})],d.prototype,"supportsResizeAttachments",null);return d=a.__decorate([w.subclass("esri.widgets.Attachments.AttachmentsViewModel")],d)})},"esri/rest/query/support/AttachmentInfo":function(){define("../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../layers/support/exifUtils".split(" "),
function(a,b,d,m,g,x,n,B){var M;const k={1:{id:1,rotation:0,mirrored:!1},2:{id:2,rotation:0,mirrored:!0},3:{id:3,rotation:180,mirrored:!1},4:{id:4,rotation:180,mirrored:!0},5:{id:5,rotation:-90,mirrored:!0},6:{id:6,rotation:90,mirrored:!1},7:{id:7,rotation:90,mirrored:!0},8:{id:8,rotation:-90,mirrored:!1}};b=M=class extends b.JSONSupport{constructor(w){super(w);this.url=this.size=this.parentObjectId=this.parentGlobalId=this.name=this.keywords=this.globalId=this.id=this.exifInfo=this.contentType=null}get orientationInfo(){var {exifInfo:w}=
this;w=B.getExifValue({exifName:"Exif IFD0",tagName:"Orientation",exifInfo:w});return k[w]||null}clone(){return new M({contentType:this.contentType,exifInfo:this.exifInfo,id:this.id,globalId:this.globalId,keywords:this.keywords,name:this.name,parentGlobalId:this.parentGlobalId,parentObjectId:this.parentObjectId,size:this.size,url:this.url})}};a.__decorate([d.property({type:String})],b.prototype,"contentType",void 0);a.__decorate([d.property()],b.prototype,"exifInfo",void 0);a.__decorate([d.property({readOnly:!0})],
b.prototype,"orientationInfo",null);a.__decorate([d.property({type:m.Integer})],b.prototype,"id",void 0);a.__decorate([d.property({type:String})],b.prototype,"globalId",void 0);a.__decorate([d.property({type:String})],b.prototype,"keywords",void 0);a.__decorate([d.property({type:String})],b.prototype,"name",void 0);a.__decorate([d.property({json:{read:!1}})],b.prototype,"parentGlobalId",void 0);a.__decorate([d.property({json:{read:!1}})],b.prototype,"parentObjectId",void 0);a.__decorate([d.property({type:m.Integer})],
b.prototype,"size",void 0);a.__decorate([d.property({json:{read:!1}})],b.prototype,"url",void 0);return b=M=a.__decorate([n.subclass("esri.layers.support.AttachmentInfo")],b)})},"esri/layers/support/exifUtils":function(){define(["exports"],function(a){function b(d){const {tagName:m,tags:g}=d;return g&&m?g.find(x=>x.name===m)?.value||null:null}a.getExifValue=function(d){const {exifInfo:m,exifName:g,tagName:x}=d;return m&&g&&x?(d=m.find(n=>n.name===g))?b({tagName:x,tags:d.tags}):null:null};Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/support/featureUtils":function(){define("exports ../../../core/Logger ../../../core/string ../../../intl/date ../../../intl/number ../../../layers/support/fieldUtils ../../../layers/support/layerUtils ../../../smartMapping/support/utils ../../../support/arcadeOnDemand ../../../time/timeZoneUtils".split(" "),function(a,b,d,m,g,x,n,B,M,k){function w(S){return S?U.test(S):!1}function e(S,T){if(!w(T)||!S)return null;const ba=T.replace(U,"").toLowerCase();
let Q=null;S.some(W=>W.name.toLowerCase()===ba?(Q=W,!0):!1);return Q}function f(S,T){return(T=l(T,S))?T.name:S}function l(S,T){return S&&"function"===typeof S.getField&&T?S.getField(T)??null:null}function q({formattedAttributes:S,template:T,fieldInfoMap:ba}){return`${d.replace(d.replace(T,Q=>`{${ba.get(Q.toLowerCase())?.fieldName||Q}}`),S).replaceAll(v,"")}`.trim()}function r(S,T,ba=!1){const Q=T[S];"string"===typeof Q&&(ba=(ba?encodeURIComponent(Q):Q).replaceAll(O,"%27"),T[S]=ba)}function c(S,T=
!1){const ba={...S};Object.keys(ba).forEach(Q=>r(Q,ba,T));return ba}function t(S,T){return S.replaceAll(G,(ba,Q,W)=>(ba=l(T,W))?`{${ba.name}}`:Q)}function h(S,T,ba){return(S=t(S,ba))?S.replaceAll(da,(Q,W,Z)=>{W=`${W||Z}`.trim();return d.replace(Q,c(T,W&&"{"!==W[0]||!1))}):S}function u(S){return null!=S&&"object"===typeof S&&"fieldsIndex"in S&&"geometryType"in S&&"getField"in S&&"load"in S&&"loaded"in S&&"objectIdField"in S&&"spatialReference"in S&&"type"in S&&("feature"===S.type||"scene"===S.type)&&
"when"in S}function L(S){return null!=S&&"object"===typeof S&&"createQuery"in S&&"queryFeatureCount"in S&&"queryObjectIds"in S&&"queryRelatedFeatures"in S&&"queryRelatedFeaturesCount"in S&&"relationships"in S}function K(S){return u(S)&&L(S)}function F(S,T){const {fieldInfos:ba,fieldName:Q,preventPlacesFormatting:W,layer:Z,timeZone:aa}=T;T=p(ba,Q);var fa=l(Z,Q);if(T&&!x.isRasterPixelValueField(Q)){fa=fa?.type;const ka=T.format?.dateFormat;if("date"===fa||"date-only"===fa||"time-only"===fa||"timestamp-offset"===
fa||ka)return B.formatAnyDate(S,{format:ka,fieldType:fa,timeZoneOptions:{layerTimeZone:Z&&"preferredTimeZone"in Z?Z.preferredTimeZone:null,viewTimeZone:aa,datesInUnknownTimezone:Z&&"datesInUnknownTimezone"in Z?!!Z.datesInUnknownTimezone:!1}})}T=T?.format;if("string"===typeof S&&x.isRasterPixelValueField(Q)&&T)return S=S.trim(),/\d{2}-\d{2}/.test(S)?S:S.includes(",")?y(S,",",", ",T):S.includes(";")?y(S,";","; ",T):S.includes(" ")?y(S," "," ",T):g.formatNumber(Number(S),g.convertNumberFormatToIntlOptions(T));
"string"!==typeof S||!T||null!=T.dateFormat||null==T.places&&null==T.digitSeparator||(fa=Number(S),isNaN(fa)||(S=fa));return"string"===typeof S||null==S||null==T?D(S):W?g.formatNumber(S,{...g.convertNumberFormatToIntlOptions(T),minimumFractionDigits:0,maximumFractionDigits:20}):g.formatNumber(S,g.convertNumberFormatToIntlOptions(T))}function y(S,T,ba,Q){return S.trim().split(T).map(W=>g.formatNumber(Number(W),g.convertNumberFormatToIntlOptions(Q))).join(ba)}function p(S,T){if(S?.length&&T)return S.find(ba=>
ba.fieldName?.toLowerCase()===T.toLowerCase())}function I({fieldName:S,graphic:T,layer:ba}){if(P(S)||!ba||"function"!==typeof ba.getFeatureType)return null;const {typeIdField:Q}=ba;return Q&&S===Q?(S=ba.getFeatureType(T))?S.name:null:null}function R({fieldName:S,value:T,graphic:ba,layer:Q}){return P(S)||!Q||"function"!==typeof Q.getFieldDomain?null:(S=ba&&Q.getFieldDomain(S,{feature:ba}))&&"coded-value"===S.type?S.getName(T):null}function D(S){return"string"===typeof S?S.replaceAll(ca,'\x3cbr class\x3d"esri-text-new-line" /\x3e'):
S}function E(S){const {value:T,fieldName:ba,fieldInfos:Q,fieldInfoMap:W,layer:Z,graphic:aa,timeZone:fa}=S;return null==T?"":(S=R({fieldName:ba,value:T,graphic:aa,layer:Z}))||(S=I({fieldName:ba,graphic:aa,layer:Z}))?S:W.get(ba.toLowerCase())?F(T,{fieldInfos:Q||Array.from(W.values()),fieldName:ba,layer:Z,timeZone:fa}):(S=Z?.fieldsIndex?.get(ba))&&(B.isAnyDateField(S)||x.isTimeOnlyField(S))?B.formatAnyDate(T,{fieldType:S.type,timeZoneOptions:{layerTimeZone:Z&&"preferredTimeZone"in Z?Z.preferredTimeZone:
null,viewTimeZone:fa,datesInUnknownTimezone:Z&&"datesInUnknownTimezone"in Z?!!Z.datesInUnknownTimezone:!1}}):D(T)}async function N(S,T){const {layer:ba,graphic:Q,outFields:W,objectIds:Z,returnGeometry:aa,spatialReference:fa}=S;S=Z[0];if("number"!==typeof S&&"string"!==typeof S)return A.warn("Could not query required fields for the specified feature. The feature's ID is invalid.",{layer:ba,graphic:Q,objectId:S,requiredFields:W}),null;if(!n.getEffectiveLayerCapabilities(ba)?.operations?.supportsQuery)return A.warn("The specified layer cannot be queried. The following fields will not be available.",
{layer:ba,graphic:Q,requiredFields:W,returnGeometry:aa}),null;S=ba.createQuery();S.objectIds=Z;S.outFields=W?.length?W:[ba.objectIdField];S.returnGeometry=!!aa;S.returnZ=!!aa;S.returnM=!!aa;S.outSpatialReference=fa;return(await ba.queryFeatures(S,T)).features[0]}async function C(S){if(!S.expressionInfos?.length)return!1;var T=await M.loadArcade();({arcadeUtils:{hasGeometryFunctions:T}}=T);return T(S)}function P(S=""){return S?S.includes("relationships/"):!1}function H({attributes:S,graphic:T,relatedInfo:ba,
fieldInfos:Q,fieldInfoMap:W,layer:Z,timeZone:aa}){S&&T&&ba&&Object.keys(T.attributes).forEach(fa=>{var ka=(ka={layerId:ba.relation.id.toString(),fieldName:fa},`${"relationships/"}${ka.layerId}/${ka.fieldName}`);S[ka]=E({fieldName:ka,fieldInfos:Q,fieldInfoMap:W,layer:Z,value:T.attributes[fa],graphic:T,timeZone:aa})})}function J({attributes:S,relatedInfo:T,fieldInfoMap:ba,fieldInfos:Q,layer:W,timeZone:Z}){S&&T&&(T.relatedFeatures?.forEach(aa=>H({attributes:S,graphic:aa,relatedInfo:T,fieldInfoMap:ba,
fieldInfos:Q,layer:W,timeZone:Z})),T.relatedStatsFeatures?.forEach(aa=>H({attributes:S,graphic:aa,relatedInfo:T,fieldInfoMap:ba,fieldInfos:Q,layer:W,timeZone:Z})))}function z(S,T,ba){const Q="scene"===T.type&&T.associatedLayer?T.associatedLayer.url:T.url;return S.filter(K).find(W=>W!==T&&W.url===Q&&W.layerId===ba.relatedTableId)}const A=b.getLogger("esri.widgets.Feature.support.featureUtils"),v=/href=(""|'')/gi,G=/(\{([^\{\r\n]+)\})/g,O=/'/g,U=/^\s*expression\//i,ca=/(\n)/gi,X=/[\u00A0-\u9999<>&]/gim,
da=/href\s*=\s*(?:"([^"]+)"|'([^']+)')/gi,ha=/^(?:mailto:|tel:)/,ia=m.convertDateFormatToIntlOptions("short-date-short-time"),ma=S=>{if(!S)return!1;S=S.toUpperCase();return S.includes("CURRENT_TIMESTAMP")||S.includes("CURRENT_DATE")||S.includes("CURRENT_TIME")},ea=({layer:S,method:T,query:ba,definitionExpression:Q})=>{S.capabilities?.query?.supportsCacheHint&&"attachments"!==T&&(S=null!=ba.where?ba.where:null,T=null!=ba.geometry?ba.geometry:null,ma(Q)||ma(S)||"extent"===T?.type||"tile"===ba.resultType||
(ba.cacheHint=!0))};a.applyTextFormattingHTML=D;a.createfieldInfoMap=function(S,T){const ba=new Map;if(!S)return ba;S.forEach(Q=>{const W=f(Q.fieldName,T);Q.fieldName=W;ba.set(W.toLowerCase(),Q)});return ba};a.findRelatedLayer=function(S,T,ba){return S&&T&&ba?z(S.allLayers,T,ba)||z(S.allTables,T,ba):null};a.fixTokens=t;a.formatAttributes=function({fieldInfos:S,attributes:T,layer:ba,graphic:Q,fieldInfoMap:W,relatedInfos:Z,timeZone:aa}){const fa={};Z?.forEach(ka=>J({attributes:fa,relatedInfo:ka,fieldInfoMap:W,
fieldInfos:S,layer:ba,timeZone:aa}));T&&Object.keys(T).forEach(ka=>{fa[ka]=E({fieldName:ka,fieldInfos:S,fieldInfoMap:W,layer:ba,value:T[ka],graphic:Q,timeZone:aa})});return fa};a.formatEditInfo=function(S,T,ba,Q){const {creatorField:W,creationDateField:Z,editorField:aa,editDateField:fa}=S;if(T){S=k.getTimeZoneFormattingOptions(Q&&"preferredTimeZone"in Q?Q.preferredTimeZone:null,Q&&"datesInUnknownTimezone"in Q?!!Q.datesInUnknownTimezone:!1,ba,ia,"date");S={...ia,...S};ba=T[fa];if("number"===typeof ba)return T=
T[aa],{type:"edit",date:m.formatDate(ba,S),user:T};ba=T[Z];return"number"===typeof ba?(T=T[W],{type:"create",date:m.formatDate(ba,S),user:T}):null}};a.formatValueToFieldInfo=F;a.getAllFieldInfos=function(S){const T=[];if(!S)return T;const {fieldInfos:ba,content:Q}=S;ba&&T.push(...ba);if(!Q||!Array.isArray(Q))return T;Q.forEach(W=>{"fields"===W.type&&(W=W?.fieldInfos)&&T.push(...W)});return T};a.getFieldInfo=p;a.getFieldInfoLabel=function(S,T){return(T=e(T,S?.fieldName))?T.title||null:S?S.label||S.fieldName:
null};a.getFixedFieldName=f;a.getFixedFieldNames=function(S,T){return S&&S.map(ba=>f(ba,T))};a.getHighlightKeyForFeature=function(S){const T=S.getObjectId();return null!=T?`oid:${T}`:`uid:${S.uid}`};a.getSourceLayer=function(S){if(null!=S)return(S.sourceLayer||S.layer)??void 0};a.graphicCallback=async function(S,T){return"function"===typeof S?S(T):S};a.htmlEntities=function(S){return S.replaceAll(X,T=>`&#${T.charCodeAt(0)};`)};a.isExpressionField=w;a.isFeatureSupportedLayer=u;a.isGraphicForRelatableFeatureSupportedLayer=
function(S){return!!S&&"object"===typeof S&&"sourceLayer"in S&&K(S.sourceLayer)};a.isRelatableFeatureSupportedLayer=K;a.isRelatableLayer=L;a.isRelatedField=P;a.preLayerQueryCallback=({query:S,layer:T,method:ba})=>{ea({layer:T,method:ba,query:S,definitionExpression:`${T.definitionExpression} ${T.serviceDefinitionExpression}`})};a.preRequestCallback=({queryPayload:S,layer:T,method:ba})=>{ea({layer:T,method:ba,query:S,definitionExpression:`${T.definitionExpression} ${T.serviceDefinitionExpression}`})};
a.querySourceLayer=N;a.queryUpdatedFeature=async function({graphic:S,popupTemplate:T,layer:ba,spatialReference:Q},W){if(ba&&T&&("function"===typeof ba.load&&await ba.load(W),S.attributes)){var Z=S.attributes[ba.objectIdField];if(null!=Z){Z=[Z];var aa=await T.getRequiredFields(ba.fieldsIndex),fa=x.featureHasFields(aa,S);aa=fa?[]:aa;T=T.returnGeometry||await C(T);if(!fa||T)if(ba=await N({layer:ba,graphic:S,outFields:aa,objectIds:Z,returnGeometry:T,spatialReference:Q},W))ba.geometry&&(S.geometry=ba.geometry),
ba.attributes&&(S.attributes={...S.attributes,...ba.attributes})}}};a.shouldOpenInNewTab=function(S=""){if(S)return!ha.test(S.trim().toLowerCase())};a.substituteAttributes=q;a.substituteFieldsInLinksAndAttributes=function({attributes:S,globalAttributes:T,layer:ba,text:Q,expressionAttributes:W,fieldInfoMap:Z}){return Q?q({formattedAttributes:T,template:h(Q,{...T,...W,...S},ba),fieldInfoMap:Z}):""};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/smartMapping/support/utils":function(){define("exports ../../intl/date ../../layers/support/fieldUtils ../../support/arcadeOnDemand ../../support/basemapUtils ../../time/timeZoneUtils".split(" "),
function(a,b,d,m,g,x){function n(l){return String(l).padStart(2,"0")}function B(l,q,r){if("date"===q||"number"===q){"number"===q&&(l=new Date(l));q=r?l.getFullYear():l.getUTCFullYear();const c=n((r?l.getMonth():l.getUTCMonth())+1),t=n(r?l.getDate():l.getUTCDate()),h=n(r?l.getHours():l.getUTCHours()),u=n(r?l.getMinutes():l.getUTCMinutes());l=n(r?l.getSeconds():l.getUTCSeconds());l=`TIMESTAMP'${q}-${c}-${t} ${h}:${u}:${l}'`}return l}function M(l,q){if(q instanceof Date)return"date";if("number"===typeof q)return"number";
if("string"===typeof q&&(l=l.getField(q),"\x3cnow\x3e"!==q.toLowerCase()&&d.isDateField(l)))return"field"}const k={light:"streets gray topo terrain oceans osm gray-vector streets-vector topo-vector streets-relief-vector streets-navigation-vector topo-3d navigation-3d arcgis-light-gray arcgis-navigation arcgis-streets arcgis-streets-relief arcgis-topographic arcgis-oceans osm-standard osm-standard-relief osm-streets osm-streets-relief osm-light-gray arcgis-terrain arcgis-charted-territory arcgis-community arcgis-colored-pencil arcgis-modern-antique arcgis-midcentury arcgis-newspaper arcgis-hillshade-light".split(" "),
dark:"satellite hybrid dark-gray dark-gray-vector streets-night-vector navigation-dark-3d arcgis-imagery arcgis-imagery-standard arcgis-dark-gray arcgis-navigation-night arcgis-streets-night osm-dark-gray arcgis-nova arcgis-hillshade-dark".split(" ")},w={years:365,months:30,days:1,hours:1/24,minutes:1/1440,seconds:1/86400,milliseconds:1/864E5},e=new Set(["integer","small-integer"]);let f=null;a.castIntegerFieldToFloat=function(l){return`cast(${l} as float)`};a.dateTypes=["date","date-only","timestamp-offset"];
a.defaultBasemapGroups=k;a.fieldDelimiter=",";a.formatAnyDate=function(l,q){const {format:r,timeZoneOptions:c,fieldType:t}=q??{};let h;c&&({timeZone:u,timeZoneName:h}=x.getTimeZoneFormattingOptions(c.layerTimeZone,c.datesInUnknownTimezone,c.viewTimeZone,b.convertDateFormatToIntlOptions(r||"short-date-short-time"),t));if("string"===typeof l&&isNaN(Date.parse("time-only"===t?`1970-01-01T${l}Z`:l)))return l;switch(t){case "date-only":var u=b.convertDateFormatToIntlOptions(r||"short-date");return"string"===
typeof l?b.formatDateOnly(l,{...u}):b.formatDate(l,{...u,timeZone:x.utc});case "time-only":return u=b.convertDateFormatToIntlOptions(r||"short-time"),"string"===typeof l?b.formatTimeOnly(l,u):b.formatDate(l,{...u,timeZone:x.utc});case "timestamp-offset":if(!u&&"string"===typeof l&&(new Date(l)).toISOString()!==l)return l;u=(q=r||c?b.convertDateFormatToIntlOptions(r||"short-date-short-time"):void 0)?{...q,timeZone:u,timeZoneName:h}:void 0;return"string"===typeof l?b.formatTimestamp(l,u):b.formatDate(l,
u);default:return q=r||c?b.convertDateFormatToIntlOptions(r||"short-date-short-time"):void 0,b.formatDate("string"===typeof l?new Date(l):l,q?{...q,timeZone:u,timeZoneName:h}:void 0)}};a.getBasemapGroup=function(l,q=k){for(const r in q)if(q[r].includes(l))return r};a.getBasemapId=function(l,q,r=!0){let c=null;l&&("string"===typeof l?q.includes(l)&&(c=l):c=g.getWellKnownBasemapId(l));return r?c||"gray":c};a.getDateDiffSQL=function(l,q,r,c){const {hasQueryEngine:t}=l;r=B(r,M(l,r),t);l=B(q,M(l,q),t);
l=`(${r} - ${l})`;c=w[c];q="/";1>c&&(c=1/c,q="*");return{sqlExpression:1===c?l:`(${l} ${q} ${c})`,sqlWhere:null}};a.getDateType=M;a.getFieldsList=async function(l){const {field:q,field2:r,field3:c,normalizationField:t,valueExpression:h}=l;l=[];h&&(f||({arcadeUtils:l}=await m.loadArcade(),f=l),l=f.extractFieldNames(h));q&&l.push(q);r&&l.push(r);c&&l.push(c);t&&l.push(t);return l};a.getNormalizationType=function(l){let q=l.normalizationType;q||(l.normalizationField?q="field":null!=l.normalizationTotal&&
(q="percent-of-total"));return q??void 0};a.isAnyDateField=function(l){return d.isDateField(l)||d.isDateOnlyField(l)||d.isTimestampOffsetField(l)};a.isIntegerField=function(l,q){l=q&&l.getField(q);return!!l&&e.has(l.type)};a.unitValueInDays=w;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Attachments/support/attachmentUtils":function(){define(["exports","../../../assets"],function(a,b){a.getIconPath=function(d){const m=b.getAssetUrl("esri/themes/base/images/files/");
return d?"text/plain"===d?`${m}text-32.svg`:"application/pdf"===d?`${m}pdf-32.svg`:"text/csv"===d?`${m}csv-32.svg`:"application/gpx+xml"===d?`${m}gpx-32.svg`:"application/x-dwf"===d?`${m}cad-32.svg`:"application/postscript"===d||"application/json"===d||"text/xml"===d||"model/vrml"===d?`${m}code-32.svg`:"application/x-zip-compressed"===d||"application/x-7z-compressed"===d||"application/x-gzip"===d||"application/x-tar"===d||"application/x-gtar"===d||"application/x-bzip2"===d||"application/gzip"===d||
"application/x-compress"===d||"application/x-apple-diskimage"===d||"application/x-rar-compressed"===d||"application/zip"===d?`${m}zip-32.svg`:d.includes("image/")?`${m}image-32.svg`:d.includes("audio/")?`${m}sound-32.svg`:d.includes("video/")?`${m}video-32.svg`:d.includes("msexcel")||d.includes("ms-excel")||d.includes("spreadsheetml")?`${m}excel-32.svg`:d.includes("msword")||d.includes("ms-word")||d.includes("wordprocessingml")?`${m}word-32.svg`:d.includes("powerpoint")||d.includes("presentationml")?
`${m}report-32.svg`:`${m}generic-32.svg`:`${m}generic-32.svg`};a.isSupportedImage=function(d){d=d.toLowerCase();return"image/bmp"===d||"image/emf"===d||"image/exif"===d||"image/gif"===d||"image/x-icon"===d||"image/jpeg"===d||"image/png"===d||"image/tiff"===d||"image/x-wmf"===d};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/globalCss":function(){define(["exports"],function(a){a.globalCss={anchor:"esri-widget__anchor",anchorDisabled:"esri-widget__anchor--disabled",
button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",disabled:"esri-disabled",disabledElement:"esri-disabled-element",empty:"esri-widget__content--empty",emptyIllustration:"esri-widget__content-illustration--empty",heading:"esri-widget__heading",hidden:"esri-hidden",input:"esri-input",interactive:"esri-interactive",
loader:"esri-widget__loader",loaderAnimation:"esri-widget__loader-animation",loaderText:"esri-widget__loader-text",menu:"esri-menu",menuHeader:"esri-menu__header",menuItem:"esri-menu__list-item",menuItemActive:"esri-menu__list-item--active",menuItemFocus:"esri-menu__list-item--focus",menuList:"esri-menu__list",noBookmarksIcon:"esri-widget__no-bookmark-icon",panel:"esri-widget--panel",panelHeightOnly:"esri-widget--panel-height-only",primaryTick:"primary-tick",primaryTickAmPm:"primary-tick__ampm",primaryTickLabel:"primary-tick__label",
rotating:"esri-rotating",secondaryTick:"secondary-tick",select:"esri-select",table:"esri-widget__table",widget:"esri-widget",widgetButton:"esri-widget--button",widgetButtonActive:"esri-widget--button-active",widgetDisabled:"esri-widget--disabled"};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/FeatureForm":function(){define("require ../chunks/tslib.es6 ../intl ../core/arrayUtils ../core/deprecate ../core/Logger ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/has ../core/accessorSupport/decorators/subclass ../layers/support/fieldUtils ./Widget ./FeatureForm/css ./FeatureForm/featureFormUtils ./FeatureForm/FeatureFormViewModel ./support/componentsUtils ./support/dataUtils ./support/dateUtils ./support/globalCss ./support/Heading ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory ../intl/substitute".split(" "),
function(a,b,d,m,g,x,n,B,M,k,w,e,f,l,q,r,c,t,h,u,L,K,F,y,p,I){const R=x.getLogger("esri.widgets.FeatureForm");d=class extends f{constructor(D,E){super(D,E);this._attemptFocusOnNextRender=!1;this._dateComponentMap=new Map;this._inputsWithChanges=new Set;this._listObserverNode=this._focusedFieldName=null;this._listObserver=new IntersectionObserver(N=>{N.length&&N[0].isIntersecting&&this._incrementRelatedRecordPage()},{root:window.document});this.groupDisplay="all";this.headingLevel=2;this.messagesTemplates=
this.messagesFeature=this.messagesCommon=this.messages=null;this.viewModel=new r;this._onShowAllRelatedRecordsClick=N=>{const {feature:C,relatedRecordCallbacks:P}=this;C&&P?.showAllRelatedRecords&&P.showAllRelatedRecords({parentFeature:C,relationshipId:N})};this._onAddRelatedRecordsClick=(N,C)=>{const {feature:P,relatedRecordCallbacks:H}=this;P&&H?.addRelatedRecord&&H.addRelatedRecord({parentFeature:P,relatedLayer:C,relationshipId:N})};this._onFormKeyDown=this._onFormKeyDown.bind(this);this._onFormSubmit=
this._onFormSubmit.bind(this);this._onGroupToggle=this._onGroupToggle.bind(this);this._onComponentBlur=this._onComponentBlur.bind(this);this._onComponentFocus=this._onComponentFocus.bind(this);this._onComponentKeyDown=this._onComponentKeyDown.bind(this);this._afterComponentCreate=this._afterComponentCreate.bind(this);this._afterComponentCreateOrUpdate=this._afterComponentCreateOrUpdate.bind(this);this._afterDateComponentCreate=this._afterDateComponentCreate.bind(this);this._afterDateComponentCreateOrUpdate=
this._afterDateComponentCreateOrUpdate.bind(this);this._afterRadioGroupCreateOrUpdate=this._afterRadioGroupCreateOrUpdate.bind(this)}initialize(){this.addHandles([n.watch(()=>this.feature,()=>{n.whenOnce(()=>!this.viewModel.updating).then(()=>{const D=this._getFocusableInput("forward");this._inputsWithChanges.clear();this._dateComponentMap.clear();this._syncGroupInputStates();this._focusedFieldName=D?.name||null;this._attemptFocusOnNextRender=!0})}),n.watch(()=>this.groupDisplay,()=>this._syncGroupInputStates()),
this.on("submit",D=>{if(0<D.invalid.length){const [E]=D.invalid;D.invalid.forEach(N=>this._inputsWithChanges.add(N));this._focusedFieldName=E;this._attemptFocusOnNextRender=!0;this.scheduleRender()}}),n.watch(()=>[this.viewModel.activeRelationshipInput,this._listObserverNode],()=>this._onObserverChange())])}loadDependencies(){return c.loadCalciteComponents({block:()=>new Promise((D,E)=>a(["../chunks/calcite-block"],D,E)),button:()=>new Promise((D,E)=>a(["../chunks/calcite-button"],D,E)),combobox:()=>
new Promise((D,E)=>a(["../chunks/calcite-combobox"],D,E)),"combobox-item":()=>new Promise((D,E)=>a(["../chunks/calcite-combobox-item"],D,E)),"combobox-item-group":()=>new Promise((D,E)=>a(["../chunks/calcite-combobox-item-group"],D,E)),icon:()=>new Promise((D,E)=>a(["../chunks/calcite-icon"],D,E)),input:()=>new Promise((D,E)=>a(["../chunks/calcite-input"],D,E)),"input-date-picker":()=>new Promise((D,E)=>a(["../chunks/calcite-input-date-picker"],D,E)),"input-message":()=>new Promise((D,E)=>a(["../chunks/calcite-input-message"],
D,E)),"input-number":()=>new Promise((D,E)=>a(["../chunks/calcite-input-number"],D,E)),"input-time-picker":()=>new Promise((D,E)=>a(["../chunks/calcite-input-time-picker"],D,E)),"input-time-zone":()=>new Promise((D,E)=>a(["../chunks/calcite-input-time-zone"],D,E)),label:()=>new Promise((D,E)=>a(["../chunks/calcite-label"],D,E)),list:()=>new Promise((D,E)=>a(["../chunks/calcite-list"],D,E)),"list-item":()=>new Promise((D,E)=>a(["../chunks/calcite-list-item"],D,E)),loader:()=>new Promise((D,E)=>a(["../chunks/calcite-loader"],
D,E)),notice:()=>new Promise((D,E)=>a(["../chunks/calcite-notice"],D,E)),"radio-button":()=>new Promise((D,E)=>a(["../chunks/calcite-radio-button"],D,E)),"radio-button-group":()=>new Promise((D,E)=>a(["../chunks/calcite-radio-button-group"],D,E)),switch:()=>new Promise((D,E)=>a(["../chunks/calcite-switch"],D,E)),"text-area":()=>new Promise((D,E)=>a(["../chunks/calcite-text-area"],D,E))})}destroy(){this._listObserverNode&&this._listObserver.unobserve(this._listObserverNode)}get _relatedRecordsEnabled(){const D=
this.relatedRecordCallbacks;return!(!D||!(D.addRelatedRecord||D.editRelatedRecord||D.showAllRelatedRecords))}get disabled(){return this.viewModel.disabled}set disabled(D){this.viewModel.disabled=D}get feature(){return this.viewModel.feature}set feature(D){this.viewModel.feature=D}get formTemplate(){return this.viewModel.formTemplate}set formTemplate(D){this.viewModel.formTemplate=D}get label(){return this.messages?.widgetLabel??""}set label(D){this._overrideIfSome("label",D)}get layer(){return this.viewModel.layer}set layer(D){this.viewModel.layer=
D}get map(){return this.viewModel.map}set map(D){this.viewModel.map=D}get relatedRecordCallbacks(){return this.viewModel.relatedRecordCallbacks}set relatedRecordCallbacks(D){this.viewModel.relatedRecordCallbacks=D}get relationshipId(){return this.viewModel.relationshipId}set relationshipId(D){this.viewModel.relationshipId=D}get spatialReference(){return this.viewModel.spatialReference}set spatialReference(D){this.viewModel.spatialReference=D}get strict(){return this.viewModel.strict}set strict(D){this.viewModel.strict=
D}get timeZone(){return this.viewModel.timeZone}set timeZone(D){this.viewModel.timeZone=D}get view(){g.deprecatedProperty(R,"view",{replacement:"Use FeatureForm.map instead.",version:"4.27"});return this.viewModel.view}set view(D){g.deprecatedProperty(R,"view",{replacement:"Use FeatureForm.map instead.",version:"4.27"});this.viewModel.view=D}getValues(){return this.viewModel.getValues()}submit(){return this.viewModel.submit()}render(){const {state:D}=this.viewModel;return p.tsx("div",{class:this.classes(l.css.base,
u.globalCss.widget,u.globalCss.panel)},"ready"===D?this._renderForm():null)}_renderForm(){return p.tsx("form",{class:l.css.form,novalidate:!0,onkeydown:this._onFormKeyDown,onsubmit:this._onFormSubmit},this._renderHeader(),this._renderContent())}_renderHeader(){var D=this.viewModel;if(D.formHeaderVisible){var E=null!=D.formTitle&&p.tsx(L.Heading,{key:"title",level:this.headingLevel},D.formTitle);D=null!=D.formDescription&&p.tsx("p",{class:l.css.description,key:"description"},D.formDescription);return p.tsx("div",
{class:l.css.formHeader},E,D)}}_renderContent(){const {viewModel:D}=this;return D.activeRelationshipInput?this._renderActiveRelationshipInput(D.activeRelationshipInput):D.inputs.filter(m.isSome).filter(E=>E.visible).map((E,N)=>{if(q.isGroupInput(E))return this._renderGroup(E,N);if(q.isFieldInput(E))return this._renderLabeledField(E);if(q.isRelationshipInput(E))return this._renderRelationshipInput(E)})}_renderActiveRelationshipInput(D){return this._renderRelationshipInput(D)}_renderDescriptionOrEmpty(D,
E){return null==D?null:p.tsx("div",{class:this.classes(l.css.description),id:E},D)}_renderGroup(D,E){const {disabled:N,formTemplate:C,headingLevel:P}=this,{description:H,inputs:J,label:z,open:A}=D,v=J.filter(O=>O.visible),G=this.viewModel.findField(this._focusedFieldName);E=`${this.id}_group_${E}`;return p.tsx("calcite-block",{class:this.classes(l.css.group,"sequential"===this.groupDisplay?l.css.groupSequential:null,G?.group===D?l.css.groupActive:null,N?l.css.inputDisabled:null),collapsible:!0,"data-group":D,
description:H||void 0,disabled:N,heading:`${z}`,headingLevel:C?.title?L.incrementHeadingLevel(P):P,id:E,key:E,open:A,onCalciteBlockToggle:({target:O})=>this._onGroupToggle(O,D)},v.map(O=>{if(q.isFieldInput(O))return this._renderLabeledField(O);if(q.isRelationshipInput(O))return this._renderRelationshipInput(O)}))}_getFocusableInput(D,E){var N=this.viewModel.allFieldInputs;N="forward"===D?N:N.slice().reverse();!E||q.isRelationshipInput(E)?D=0:q.isGroupInput(E)?D=(D=E.inputs.find(q.isFieldInput))?N.indexOf(D):
0:(q.isInputInGroupInput(E)&&!E.group.open?(E=E.group.inputs.filter(q.isFieldInput),D="forward"===D?E[E.length-1]:E[0]):D=E,D=N.indexOf(D)+1);for(;D<N.length;D++)if(E=N[D],E.visible&&q.isFieldInput(E))return E;return null}_renderLabeledField(D){const {dataType:E,feature:N,label:C,layer:P,required:H}=D,J={"aria-label":H?I.substitute(this.messages.requiredFieldLabel,{name:C}):C,class:l.css.label,key:`${P.id}-${N.uid}-${D.name}`},z=[p.tsx("div",{class:l.css.labelTextContent,key:"labelTextContainer"},
C,H?p.tsx("span",{"aria-hidden":"true",title:this.messagesCommon.required},"*"):void 0),"unsupported"!==E?this._renderFieldInput(D):this._renderReadOnlyComponent(D),this._renderAuxiliaryText(D)];return"date"===E&&"coded-value"!==D.domain?.type?p.tsx("label",{...J},z):p.tsx("calcite-label",{...J},z)}_renderFieldInput(D){const {dataType:E,domain:N,inputType:C,name:P}=D,H=this.getCommonInputProps(D);if("coded-value"===N?.type){const J=this.viewModel.getFieldValueOptionsForField(P,this.messages.empty);
return"switch"!==C||D.hasInvalidSwitchValue?"radio-buttons"===C?this._renderRadioButtonComponents(D,J.flat(),H):this._renderComboBoxComponent(D,J,H):this._renderSwitchComponent(D,H)}return"datetime-picker"===C||"date"===E?this._renderDateComponents(D,H):"number"===E?this._renderNumberComponent(D,H):this._renderStringComponent(D,H)}_renderStringComponent(D,E){return"text-area"===D.inputType?E.readOnly?p.tsx("calcite-input",{...E,loading:D.updating,type:"textarea",onCalciteInputInput:N=>this._saveValueFromComponent(N.target)}):
p.tsx("calcite-text-area",{...E,resize:"vertical",onCalciteTextAreaInput:N=>this._saveValueFromComponent(N.target)}):p.tsx("calcite-input",{...E,loading:D.updating,type:"text",onCalciteInputInput:N=>this._saveValueFromComponent(N.target)})}_renderNumberComponent(D,E){return p.tsx("calcite-input-number",{...E,integer:e.isIntegerField(D.field),loading:D.updating,type:"number",onCalciteInputNumberInput:N=>this._saveValueFromComponent(N.target)})}_renderDateComponents(D,E){const {field:N}=D;switch(N.type){case "date":return this._renderDateFieldComponents(D,
E);case "date-only":return this._renderDateOnlyFieldComponent(D,E);case "time-only":return this._renderTimeOnlyFieldComponent(D,E);case "timestamp-offset":return this._renderTimestampOffsetFieldComponents(D,E);default:return this._renderReadOnlyComponent(D,h.getLabelForDateFieldValue(N,E.value,{timeZone:this.timeZone,...h.getIntlOptionsForField(N)}))}}_renderDateOnlyFieldComponent(D,E){const {range:N,valid:C,value:P}=D,{class:H,key:J,readOnly:z}=E,{rawMax:A,rawMin:v}=N;return p.tsx("calcite-input-date-picker",
{afterCreate:this._afterDateComponentCreate,afterUpdate:this._afterDateComponentCreateOrUpdate,"aria-invalid":!C,class:H,"data-date-part":"date","data-field-name":E["data-field-name"],key:`${J}-date-input`,max:t.isString(A)?A:void 0,min:t.isString(v)?v:void 0,numberingSystem:h.numberingSystem,onblur:G=>{this._focusedFieldName=null;this._saveValueFromDateComponent(G.target)},onfocus:this._onComponentFocus,overlayPositioning:"fixed",readOnly:z,value:null!=P?`${P}`:void 0,onCalciteInputDatePickerChange:G=>
this._saveValueFromDateComponent(G.target)})}_renderTimeOnlyFieldComponent(D,E){const {valid:N,value:C}=D,{class:P,key:H,readOnly:J}=E;return p.tsx("calcite-input-time-picker",{afterCreate:this._afterDateComponentCreate,afterUpdate:this._afterDateComponentCreateOrUpdate,"aria-invalid":!N,class:P,"data-date-part":"time","data-field-name":E["data-field-name"],key:`${H}-time-input`,numberingSystem:h.numberingSystem,onblur:z=>{this._focusedFieldName=null;this._saveValueFromDateComponent(z.target)},onfocus:this._onComponentFocus,
overlayPositioning:"fixed",readOnly:J,step:D.timeStep,value:null!=C?`${C}`:void 0,onCalciteInputTimePickerChange:z=>this._saveValueFromDateComponent(z.target)})}_renderTimestampOffsetFieldComponents(D,E){const {name:N,range:C,valid:P,value:H}=D,{class:J,key:z,readOnly:A}=E,{rawMax:v,rawMin:G}=C;E={afterCreate:this._afterDateComponentCreate,afterUpdate:this._afterDateComponentCreateOrUpdate,"aria-invalid":!P,numberingSystem:h.numberingSystem,overlayPositioning:"fixed",readOnly:A,["data-field-name"]:N,
onfocus:this._onComponentFocus};const O=h.prepareISOFieldValueForDateComponents(v),U=h.prepareISOFieldValueForDateComponents(G),ca=h.prepareISOFieldValueForDateComponents(H);return p.tsx("div",{class:l.css.dateInputContainer,key:`${z}-date-time-container`},p.tsx("calcite-input-date-picker",{...E,class:J,"data-date-part":"date",key:`${z}-date-input`,max:O?.date??void 0,min:U?.date??void 0,onblur:X=>{this._focusedFieldName=null;this._saveValueFromDateComponent(X.target)},value:ca.date??void 0,onCalciteInputDatePickerChange:X=>
this._saveValueFromDateComponent(X.target)}),p.tsx("calcite-input-time-picker",{...E,class:J,"data-date-part":"time",key:`${z}-time-input`,onblur:X=>{this._focusedFieldName=null;this._saveValueFromDateComponent(X.target)},step:D.timeStep,value:ca.time??void 0,onCalciteInputTimePickerChange:X=>this._saveValueFromDateComponent(X.target)}),D.includeTimeOffset?p.tsx("calcite-input-time-zone",{...E,class:J,"data-date-part":"timeZone",disabled:A,key:`${z}-timezone-input`,onblur:X=>{this._focusedFieldName=
null;this._saveValueFromDateComponent(X.target)},value:ca.timeZoneOffset??"0",onCalciteInputTimeZoneChange:X=>this._saveValueFromDateComponent(X.target)}):null)}_renderDateFieldComponents(D,E){const {includeTime:N,name:C,valid:P,value:H}=D,{class:J,key:z,max:A,min:v,readOnly:G}=E;var {timeZone:O}=this;D={afterCreate:this._afterDateComponentCreate,afterUpdate:this._afterDateComponentCreateOrUpdate,"aria-invalid":!P,numberingSystem:h.numberingSystem,overlayPositioning:"fixed",readOnly:G,["data-field-name"]:C,
onfocus:this._onComponentFocus};E=h.prepareUnixFieldValueForDateComponents(H,O);const U=h.prepareUnixFieldValueForDateComponents(A,O);O=h.prepareUnixFieldValueForDateComponents(v,O);return p.tsx("div",{class:l.css.dateInputContainer,key:`${z}-date-time-container`},p.tsx("calcite-input-date-picker",{...D,class:J,"data-date-part":"date",key:`${z}-date-input`,max:U?.date??void 0,min:O?.date??void 0,onblur:ca=>{this._focusedFieldName=null;this._saveValueFromDateComponent(ca.target)},value:E.date??void 0,
onCalciteInputDatePickerChange:ca=>this._saveValueFromDateComponent(ca.target)}),N?p.tsx("calcite-input-time-picker",{...D,class:J,"data-date-part":"time",key:`${z}-time-input`,onblur:ca=>{this._focusedFieldName=null;this._saveValueFromDateComponent(ca.target)},step:1,value:E.time??void 0,onCalciteInputTimePickerChange:ca=>this._saveValueFromDateComponent(ca.target)}):null)}_renderReadOnlyComponent(D,E){D=this.getCommonInputProps(D);return p.tsx("calcite-input",{...D,class:this.classes(l.css.fieldInput,
l.css.inputDisabled),readOnly:!0,type:"text",value:null!=E?`${E}`:D.value})}_renderComboBoxComponent(D,E,N){const {value:C,name:P}=D,{messages:H,messagesTemplates:J,viewModel:z,_inputsWithChanges:A}=this;E=E.map(X=>X.map(({name:da,value:ha})=>p.tsx("calcite-combobox-item",{key:`#${ha}`,selected:C===ha,textLabel:da,value:`${ha}`})));const [v,G]=E;this.viewModel.fieldsWithInvalidCodedValue.has(D)&&G.unshift(p.tsx("calcite-combobox-item",{key:"incompatible-option",readOnly:!0,textLabel:`${D.value}`,
value:`${D.value}`}));E=0<G.length?[p.tsx("calcite-combobox-item-group",{key:"recommended",label:H.recommended},v),p.tsx("calcite-combobox-item-group",{key:"other",label:J.other},G)]:v;const O="INSERT"===z.arcadeEditType,U=A.has(P),ca=null==C&&(!O||U);D.showNoValueOptionEnabled&&E.unshift(p.tsx("calcite-combobox-item",{key:"empty-option",selected:ca,textLabel:H.empty,value:""},D.showNoValueLabel||H.empty));return p.tsx("calcite-combobox",{...N,allowCustomValues:!1,clearDisabled:!0,disabled:N.readOnly,
onblur:O&&D.showNoValueOptionEnabled&&!U?()=>{}:N.onblur,overlayPositioning:"fixed",selectionMode:"single",onCalciteComboboxChange:({target:X})=>{ca&&0===X.selectedItems.length?this._ignoreDeselectionOfNoValueOption(X):this._saveValueFromComponent(X)}},E)}_renderRadioButtonComponents(D,E,N){const {name:C,value:P}=D;E=E.map(({name:H,value:J})=>this._renderRadioButtonComponent({key:H,label:H,name:C,value:J,selected:J===P,props:N}));D.showNoValueOptionEnabled&&E.unshift(this._renderRadioButtonComponent({key:"empty-option",
label:D.showNoValueLabel||this.messages.empty,name:C,value:"",selected:""===P||null===P,props:N}));return p.tsx("calcite-radio-button-group",{afterCreate:this._afterRadioGroupCreateOrUpdate,afterUpdate:this._afterRadioGroupCreateOrUpdate,class:l.css.inputRadioGroup,"data-field-name":N["data-field-name"],key:`${N.key}-radio-group`,layout:"vertical",name:N.key,required:N.required},E)}_renderSwitchComponent(D,E){const {value:N}=D;D=q.isFieldElementWithInputType(D.element,"switch")?N===D.element.input.onValue:
!1;return p.tsx("calcite-switch",{...E,checked:D,class:l.css.inputSwitch,disabled:E.readOnly,onblur:()=>{this._focusedFieldName=null},onCalciteSwitchChange:C=>this._saveValueFromComponent(C.target)})}_renderRadioButtonComponent({key:D,name:E,value:N,selected:C,label:P,props:H}){return p.tsx("calcite-label",{class:l.css.inputRadioLabel,key:D,layout:"inline"},p.tsx("calcite-radio-button",{...H,afterCreate:void 0,afterUpdate:void 0,checked:C,class:l.css.inputRadio,disabled:H.readOnly,name:E,onblur:()=>
{this._focusedFieldName=null},value:N,onCalciteRadioButtonChange:({target:J})=>{J.checked&&this._saveValueFromComponent(J)}}),P)}_renderAuxiliaryText(D){var E=D.name;E=this._inputsWithChanges.has(E)&&!D.valid?q.getErrorMessageForFieldInput(D,this.messages,this.timeZone):null!=this.viewModel.contingencyConstraintViolations.get(E)?this.messages.validationErrors.valuesIncompatible:null!=D.valueExpressionExecutor&&D.valueExpressionExecutor.stale?this.messages.valueExpressionError:null;return null!=E?
p.tsx("calcite-input-message",{icon:!0,status:"invalid"},E):this._renderDescriptionOrEmpty(D.description)}_renderShowAllRelatedRecordsListItem(D){const {featureCount:E,relationshipId:N,showAllActionVisible:C}=D;({relatedRecordCallbacks:D}=this);if(C&&D?.showAllRelatedRecords)return D=this.messages,p.tsx("calcite-list-item",{description:I.substitute(D.totalCount,{count:E}),label:D.showAll,value:!0,onCalciteListItemSelect:()=>this._onShowAllRelatedRecordsClick(N)},p.tsx("calcite-icon",{icon:"list",
scale:"s",slot:"content-end"}))}_renderAddRelatedRecordButton(D){const {canAddRelatedFeature:E,relationshipId:N,relatedLayer:C}=D,{messages:P,relatedRecordCallbacks:H}=this;if(E&&H?.addRelatedRecord&&C)return p.tsx("calcite-button",{alignment:"center",appearance:"outline-fill",class:l.css.centeredButton,disabled:D.updating||!D.originHasValidKey,iconStart:"plus",key:`${N}-add-button`,onclick:()=>this._onAddRelatedRecordsClick(N,C),round:!0,scale:"s",width:"half"},D.relatedLayerIsTable?P.addRecord:
P.addFeature)}_renderRelatedRecordListItem(D,E){const {feature:N,description:C,title:P}=D,{feature:H,relatedRecordCallbacks:J}=this,{highlightHelper:z}=this.viewModel;return p.tsx("calcite-list-item",{bind:this,description:C,key:`${E}-${N.uid}`,label:P,onclick:()=>{z?.removeAll();J?.editRelatedRecord&&H&&J.editRelatedRecord({parentFeature:H,relationshipId:E,relatedFeature:N})},onmouseenter:z?()=>z.add(N):void 0,onmouseleave:z?()=>z.remove(N):void 0,value:P},p.tsx("calcite-icon",{icon:q.getIconForFeature(N),
scale:"m",slot:"content-start"}),p.tsx("calcite-icon",{icon:"chevron-right",scale:"s",slot:"content-end"}))}_renderRelationshipInput(D){if(this._relatedRecordsEnabled&&D.editable){var {featureCount:E,relationshipId:N,showAllEnabled:C}=D,P=C?null:this._renderDescriptionOrEmpty(D.description),H=0<E?this._renderRelatedRecordsList(D):D.loaded?D.originHasValidKey?this._renderNoRelatedRecordsNotice():this._renderNoValidOriginKeyNotice(D):void 0;return p.tsx("calcite-label",{class:this.classes(l.css.label,
l.css.relatedRecordsLabel),key:`relationship-${N}-container`},p.tsx("div",null,this._renderRelatedRecordsHeaderContainer(D),P,H),this._renderAddRelatedRecordButton(D))}}_renderRelatedRecordsHeaderContainer(D){const E=D.updating||!D.loaded;return p.tsx("div",{class:l.css.relatedRecordsHeader,key:`relationship-${D.relationshipId}-header`},p.tsx("span",null,D.label),E?p.tsx("calcite-loader",{inline:!0,key:"loader",label:this.messagesCommon?.loading,scale:"s",type:"indeterminate"}):void 0)}_renderRelatedRecordsList(D){const {relationshipId:E}=
D;return p.tsx("calcite-list",{class:l.css.relatedRecordsList},D.relatedFeatureInfos.map(N=>this._renderRelatedRecordListItem(N,E)),this._renderShowAllRelatedRecordsListItem(D),this._renderObserverNode())}_renderNoValidOriginKeyNotice(D){var {messages:E}=this;E=D.relatedLayerIsTable?E.noOriginKeyRecord:E.noOriginKeyFeature;const N=D.relationship?.keyField,C=this.viewModel.findField(N),P=D.layer?.fieldsIndex.get(N);D=I.substitute(E,{relatedLayerName:D.relatedLayer?.title,originKeyField:C?.label||P?.alias||
N});return p.tsx("calcite-notice",{icon:"information",kind:"brand",open:!0,scale:"s",width:"full"},p.tsx("div",{slot:"message"},D))}_renderNoRelatedRecordsNotice(){return p.tsx("calcite-notice",{icon:"information",kind:"brand",open:!0,scale:"s",width:"full"},p.tsx("div",{slot:"message"},this.messagesFeature.noRelatedFeatures))}_renderObserverNode(){if(this.viewModel.activeRelationshipInput?.showAllEnabled)return p.tsx("div",{afterCreate:this._afterListObserverCreated,afterRemoved:this._afterListObserverRemoved,
bind:this,class:l.css.listObserver,key:"feature-observer"})}getCommonInputProps(D){var {disabled:E}=this;const {editable:N,hint:C,label:P,maxLength:H,minLength:J,name:z,range:{max:A,min:v},required:G,valid:O,value:U}=D;D=this._inputsWithChanges.has(z);E=!N||E;return{afterCreate:this._afterComponentCreate,afterUpdate:this._afterComponentCreateOrUpdate,"aria-invalid":O?"false":"true",class:this.classes(l.css.fieldInput,E?l.css.inputDisabled:null,D&&!O?l.css.inputInvalid:null),key:z,label:P,max:null!=
A?A:void 0,min:null!=v?v:void 0,maxLength:-1<H?H:void 0,minLength:-1<J?J:void 0,placeholder:C??void 0,readOnly:E,required:G,value:null==U?"":`${U}`,onblur:this._onComponentBlur,onfocus:this._onComponentFocus,onkeydown:this._onComponentKeyDown,["data-field-name"]:z}}_getFieldInputFromHTMLElement(D){return this.viewModel.findField(D.getAttribute("data-field-name"))}_afterDateComponentCreate(D){const E=this._getFieldInputFromHTMLElement(D),N=D.dataset.datePart,C=this._dateComponentMap.get(E.name);if("valueAsDate"in
D&&null!=D.value){const P=D.value,H=new ResizeObserver(()=>{D.value=void 0;D.value=P;H.unobserve(D)});H.observe(D)}if(null!=C)switch(N){case "date":C.date=D;break;case "time":C.time=D;break;case "timeZone":C.timeZone=D}else this._dateComponentMap.set(E.name,{[N]:D});this._afterDateComponentCreateOrUpdate(D)}_afterDateComponentCreateOrUpdate(D){this._afterComponentCreateOrUpdate(D)}_afterComponentCreate(D){const E=this._getFieldInputFromHTMLElement(D);q.isNumberFieldInput(E)&&null!=D.value&&"setNumberValue"in
D&&D.setNumberValue({committing:!1,value:D.value,origin:"direct"});this._afterComponentCreateOrUpdate(D)}_afterRadioGroupCreateOrUpdate(D){var E=D.selectedItem;D=D.querySelector("calcite-radio-button");(E=E||D)&&this._afterComponentCreateOrUpdate(E)}_afterComponentCreateOrUpdate(D){var {viewModel:E}=this;const N=this._getFieldInputFromHTMLElement(D);E=E.findField(this._focusedFieldName);this._attemptFocusOnNextRender&&E===N&&(this._attemptFocusOnNextRender=!1,q.isInputInGroupInput(N)&&(N.group.open=
!0),D.setFocus())}_onComponentFocus(D){this._focusedFieldName=this._getFieldInputFromHTMLElement(D.target).name}_onComponentBlur(D){D=D.target;this._focusedFieldName=null;this._saveValueFromComponent(D)}_saveValueFromDateComponent(D){var E=this._getFieldInputFromHTMLElement(D);const N=E.field.type,{name:C,range:P}=E;if(E=this._dateComponentMap.get(C)){var H=this.viewModel.getValue(C),J=null;"date-only"===N?J=D.value:"time-only"===N?(H=h.normalizeTimeOnlyString(H),J=h.normalizeTimeOnlyString(D.value)):
J="timestamp-offset"===N?null!=D.value?h.getISOFieldValueFromDateComponents({dateComponent:E.date,timeComponent:E.time,timeZoneComponent:E.timeZone,oldValue:H}):null:null!=D.value?h.getUnixFieldValueFromDateComponents({oldValue:H,dateComponent:E.date,timeComponent:E.time,timeZone:this.timeZone,max:P.max,min:P.min}):null;null!==J&&D.value?H!==J&&this._updateFieldValue(C,J):this._updateFieldValue(C,null)}}_saveValueFromComponent(D){const E=this._getFieldInputFromHTMLElement(D);this._updateFieldValue(E.name,
this._parseValue(D))}_onComponentKeyDown({key:D,target:E}){E=this._getFieldInputFromHTMLElement(E);"Enter"===D&&q.isInputInGroupInput(E)&&!E.group.open&&(E.group.open=!0)}_updateFieldValue(D,E){this.viewModel.setValue(D,E);this._inputsWithChanges.add(D);this.viewModel.fieldsWithContingentValues.has(D)&&(D=Object.fromEntries(Object.entries(this.getValues()).filter(([,N])=>null!=N)),this.viewModel.validateContingencyConstraints(D))}_parseValue(D){const E=this._getFieldInputFromHTMLElement(D),N=D.value;
return q.isFieldElementWithInputType(E.element,"switch")?D.checked?E.element.input.onValue:E.element.input.offValue:null==N||""===N?null:"number"===E.dataType?"-0"===N||"-0."===N||"-0,"===N?N:parseFloat(N):"date"===E.field.type?parseFloat(N):N}_ignoreDeselectionOfNoValueOption(D){const {firstChild:E,selectedItems:N}=D;0===N.length&&E&&"selected"in E?E.selected=!0:R.warnOnce("Failed to override user attempt to deselect 'No value' option.")}_onGroupToggle(D,E){D.open?(E.open=!0,this._focusedFieldName=
this._getFocusableInput("forward",E)?.name||null,this._attemptFocusOnNextRender=!0,"sequential"===this.groupDisplay&&this.viewModel.allGroupInputs.forEach(N=>{N!==E&&(N.open=!1)})):E.open=!1;this.scheduleRender()}_onFormSubmit(D){D.preventDefault()}_onFormKeyDown(D){"Enter"===D.key&&this.viewModel.submit()}_afterListObserverCreated(D){this.viewModel.activeRelationshipInput&&(this._listObserverNode=D)}_afterListObserverRemoved(){this._listObserverNode=null}_onObserverChange(){this._listObserverNode&&
this._listObserver.unobserve(this._listObserverNode);const D=this.viewModel.activeRelationshipInput;D&&this._listObserverNode&&D.showAllEnabled&&this._listObserver.observe(this._listObserverNode)}_incrementRelatedRecordPage(){this.viewModel.activeRelationshipInput?.incrementPage()}_syncGroupInputStates(){if("sequential"===this.groupDisplay){var D=this.viewModel.allGroupInputs;if(D.length){var E=D.filter(N=>N.open);0===E.length?D[0].open=!0:1<E.length&&E.slice(1).forEach(N=>N.open=!1)}}}};b.__decorate([B.property()],
d.prototype,"_listObserverNode",void 0);b.__decorate([B.property()],d.prototype,"_relatedRecordsEnabled",null);b.__decorate([B.property()],d.prototype,"disabled",null);b.__decorate([B.property()],d.prototype,"feature",null);b.__decorate([B.property()],d.prototype,"formTemplate",null);b.__decorate([B.property()],d.prototype,"groupDisplay",void 0);b.__decorate([B.property()],d.prototype,"headingLevel",void 0);b.__decorate([B.property()],d.prototype,"label",null);b.__decorate([B.property()],d.prototype,
"layer",null);b.__decorate([B.property()],d.prototype,"map",null);b.__decorate([B.property(),F.messageBundle("esri/widgets/FeatureForm/t9n/FeatureForm")],d.prototype,"messages",void 0);b.__decorate([B.property(),F.messageBundle("esri/t9n/common")],d.prototype,"messagesCommon",void 0);b.__decorate([B.property(),F.messageBundle("esri/widgets/Feature/t9n/Feature")],d.prototype,"messagesFeature",void 0);b.__decorate([B.property(),F.messageBundle("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],
d.prototype,"messagesTemplates",void 0);b.__decorate([B.property()],d.prototype,"relatedRecordCallbacks",null);b.__decorate([B.property()],d.prototype,"relationshipId",null);b.__decorate([B.property()],d.prototype,"spatialReference",null);b.__decorate([B.property()],d.prototype,"strict",null);b.__decorate([B.property()],d.prototype,"timeZone",null);b.__decorate([B.property()],d.prototype,"view",null);b.__decorate([B.property(),y.vmEvent(["value-change","submit"])],d.prototype,"viewModel",void 0);
return d=b.__decorate([w.subclass("esri.widgets.FeatureForm")],d)})},"esri/widgets/FeatureForm/css":function(){define(["exports"],function(a){a.css={base:"esri-feature-form",form:"esri-feature-form__form",formHeader:"esri-feature-form__form-header",label:"esri-feature-form__label",labelTextContent:"esri-feature-form__label-text-content",fieldInput:"esri-feature-form__input",inputRadio:"esri-feature-form__input--radio",inputRadioGroup:"esri-feature-form__input--radio-group",inputRadioLabel:"esri-feature-form__input--radio-label",
inputDisabled:"esri-feature-form__input--disabled",inputSwitch:"esri-feature-form__input--switch",inputInvalid:"esri-feature-form__input--invalid",centeredButton:"esri-feature-form__centered-button",description:"esri-feature-form__description-text",listObserver:"esri-feature-form__list-observer",relatedRecordsHeader:"esri-feature-form__related-records_header",relatedRecordsLabel:"esri-feature-form__related-records_label",relatedRecordsList:"esri-feature-form__related-records_list",dateInputContainer:"esri-feature-form__date-input-container",
group:"esri-feature-form__group",groupSequential:"esri-feature-form__group--sequential",groupActive:"esri-feature-form__group--active"};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/FeatureForm/featureFormUtils":function(){define("exports ../../intl ../../core/arrayUtils ../../core/compilerUtils ../../core/string ../../layers/support/domainUtils ../../layers/support/fieldUtils ../../smartMapping/support/utils ../support/dateUtils ../../intl/substitute".split(" "),function(a,
b,d,m,g,x,n,B,M,k){function w(p){const {fields:I,values:R}=p,D=p.timeZone??void 0;p=I.map((E,N)=>{let C=R[N];E.domain&&"coded-value"===E.domain.type&&(N=E.domain.codedValues.find(P=>P.code===C),N?.name&&(C=N.name));if(B.isAnyDateField(E)||n.isTimeOnlyField(E))C=M.getLabelForDateFieldValue(E,C,{timeZone:D,...M.getIntlOptionsForField(E)});return[E.name,C]});return Object.fromEntries(p)}function e(p,I){return g.replace(g.replace(p,R=>`{${R.toLowerCase()}}`),Object.fromEntries(Object.entries(I).map(([R,
D])=>[R.toLowerCase(),D])))}function f(p){return 1E7<=p||-1E7>=p}const l=p=>"field"===p?.type,q=p=>"relationship"===p?.type,r=p=>"field"===p.type,c=p=>p.reduce((I,R)=>"group"===R?.type?[...I,...R.inputs]:[...I,R],[]),t=(p,I)=>null!=p&&p.input?.type===I,h={typeFieldName:null,types:[]};a.LengthValidationError=void 0;(a.LengthValidationError||(a.LengthValidationError={})).TOO_SHORT="length-validation-error::too-short";const u={type:"number"},L={type:"number",intlOptions:{notation:"scientific"}},K={day:"2-digit",
month:"2-digit",year:"numeric"},F={hour:"numeric",minute:"numeric",second:"numeric"},y={...K,...F};a.capabilitiesAllowEditType=(p,I)=>{if(!p)return!0;({operations:p}=p);switch(I){case "INSERT":return p.supportsAdd;case "UPDATE":case "DELETE":return p.supportsUpdate;default:return!0}};a.flattenFieldInputs=p=>c(p).filter(l);a.flattenInputs=c;a.flattenRelationshipInputs=p=>c(p).filter(q);a.formTemplateHasInvalidFields=function(p){return"formTemplate"in p&&p.formTemplate?(p.formTemplate.elements?.filter(r)??
[]).some(({fieldName:I})=>!p.fieldsIndex.get(I)):!1};a.getComputedAttributes=w;a.getErrorMessageForFieldInput=(p,I,R)=>{const {dataType:D,error:E,minLength:N,value:C,required:P}=p;if(!I||!E)return null;if(P&&null===C)return I.validationErrors.cannotBeNull;if(E===x.DomainValidationError.VALUE_OUT_OF_RANGE||E===n.NumericRangeValidationError.OUT_OF_RANGE){const {field:H,range:J}=p;p={type:"date",intlOptions:{...("time-only"===H.type?F:"date-only"===H.type?K:y),timeZone:R??void 0}};return k.substitute(I.validationErrors.outsideRange,
J,{format:{max:"date"===D?p:null!=J.max&&f(J.max)?L:u,min:"date"===D?p:null!=J.min&&f(J.min)?L:u}})}return E===x.DomainValidationError.INVALID_CODED_VALUE?I.validationErrors.invalidCodedValue:E===n.TypeValidationError.INVALID_TYPE?I.validationErrors.invalidType:E===a.LengthValidationError.TOO_SHORT?k.substitute(I.validationErrors.tooShort,{min:N}):null};a.getFieldsInTitleAndDesc=p=>{const I=[];if(p.formTemplate){const {description:R,title:D}=p.formTemplate;p.fields?.forEach(E=>{const N=D&&g.templateHasKey(D,
E.name),C=R&&g.templateHasKey(R,E.name);(N||C)&&I.push(E.name)})}return I};a.getIconForFeature=p=>{if(p){var I=p.layer;I=I&&"geometryType"in I?I.geometryType:void 0;p=p.geometry?.type;return"polyline"===p||"polyline"===I?"line":p||I||"table"}};a.getNormalizedFeatureTypeInfo=p=>p?"subtype-sublayer"===p.type?{typeFieldName:p.parent?.subtypeField,types:p.parent?.subtypes??[]}:"types"in p&&p.types?{typeFieldName:p.typeIdField,types:p.types.map(({id:I,name:R,domains:D})=>({code:I,name:R,domains:D}))}:
h:h;a.isFieldElement=r;a.isFieldElementWithInputType=t;a.isFieldElementWithShowNoValueOptionInput=p=>null!=p&&(t(p,"combo-box")||t(p,"radio-buttons"));a.isFieldElementWithTextInput=p=>null!=p&&(t(p,"text-box")||t(p,"text-area"));a.isFieldInput=l;a.isGroupElement=p=>"group"===p.type;a.isGroupInput=p=>"group"===p?.type;a.isInputInGroupInput=p=>"group"!==p?.type&&null!=p.group;a.isNumberFieldInput=({domain:p,inputType:I="text-box",dataType:R})=>"number"===R&&"text-box"===I&&(!p||"coded-value"!==p.type);
a.isRelationshipElement=p=>"relationship"===p.type;a.isRelationshipInput=q;a.isTemplateItemGroup=p=>"items"in p;a.parseFormTemplateString=function(p){const {attributes:I,fieldsIndex:R,label:D,timeZone:E}=p;if(!I||"object"!==typeof I)return D;var N=Object.keys(I).filter(C=>g.templateHasKey(D,C));p=N.map(C=>I[C]);N=N.map(C=>R.get(C)).filter(d.isSome);return e(D,w({values:p,fields:N,timeZone:E}))};a.substituteFieldTemplatesInString=e;a.valueIsInvalidSwitchValue=function(p,I){return null==p||I.onValue!==
p&&I.offValue!==p};a.valueIsValidContingentValue=function(p,I){switch(I.objectType){case "any":return!0;case "null":return null==p;case "code":return p===I.codedValue?.code;case "range":return null!=p&&null!=I.minValue&&null!=I.maxValue&&+p>=I.minValue&&+p<=I.maxValue;default:return m.neverReached(I.objectType),!1}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/FeatureForm/FeatureFormViewModel":function(){define("../../chunks/tslib.es6 ../../Graphic ../../core/deprecate ../../core/Evented ../../core/Logger ../../core/maybe ../../core/Promise ../../core/reactiveUtils ../../core/string ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../core/support/UpdatingHandles ../../form/FormTemplate ../../layers/support/ContingentValue ../../layers/support/editableLayers ../../layers/support/LayerContingentValuesCache ../../time/timeZoneUtils ./featureFormUtils ./FieldInput ./FormExpressionArcadeExecutor ./FormExpressionsManager ./GroupInput ./RelationshipInput".split(" "),
function(a,b,d,m,g,x,n,B,M,k,w,e,f,l,q,r,c,t,h,u,L,K,F,y,p,I){function R(H){if("field"===H.type||"group"===H.type||"relationship"===H.type)return!0;g.getLogger("esri.widgets.FeatureForm.FeatureFormViewModel").warn("form-info::unsupported-element-type","Only element types 'field', 'group' and 'relationship' are supported",`Element ${H.label} has unsupported type '${H.type}'`);return!1}const D=new b({attributes:{}}),E=["editableExpression","requiredExpression","valueExpression","visibilityExpression"],
N=["visibilityExpression"],C=["editableExpression","visibilityExpression"],P=g.getLogger("esri.widgets.FeatureForm.FeatureFormViewModel");b=class extends n.EsriPromiseMixin(m.EventedAccessor){constructor(H){super(H);this._expressionExecutorsInUse=new Set;this._expressionExecutorLookup=new Map;this._contingentValuesCache=this._expressionsManager=null;this._featureClone=D.clone();this._initialFeature=D.clone();this._timeZone=null;this._updatingHandles=new q.UpdatingHandles;this.arcadeEditType="NA";
this.contingencyConstraintViolations=new Map;this.disabled=!1;this.highlightHelper=null;this.inputs=[];this.relatedRecordCallbacks=this.map=null;this.strict=!1}initialize(){const H=B.watch(()=>[this.layer,!!this.layer?.loaded,this.formTemplate,this.feature,this.timeZone,this.arcadeEditType],async([A,v])=>{null!=A&&(v?this._updatingHandles.addPromise(this._updateInputs()):A.load().catch(()=>{}))},{equals:([A,v,G,O,U,ca],[X,da,ha,ia,ma,ea])=>A===X&&v===da&&G===ha&&O===ia&&U===ma&&ca===ea,initial:!0}),
J=B.watch(()=>this._arcadeContextInfo,A=>{null!=this._expressionsManager&&(this._expressionsManager.arcadeContextInfo=A,this._updatingHandles.addPromise(this._expressionsManager.evaluateAll().finally(()=>this._afterExpressionsEvaluated())))}),z=B.watch(()=>this.layer,A=>{(A="subtype-sublayer"===A?.type?A.parent:"feature"===A?.type?A:null)&&this.addResolvingPromise(h.createLoadedLayerContingentValuesCache(A).then(v=>{this._contingentValuesCache=v;this.notifyChange("fieldsWithContingentValues")}))},
{initial:!0});this.addHandles([H,J,z])}destroy(){this.layer=this.feature=null;this._contingentValuesCache=x.destroyMaybe(this._contingentValuesCache);this.highlightHelper?.removeAll();this._updatingHandles.destroy()}get _expressionInfosLookup(){return new Map(this.formTemplate?.expressionInfos?.map(H=>[H.name,H]))}get activeRelationshipInput(){return this.allRelationshipInputs.find(H=>H.relationshipId===this.relationshipId)}get _arcadeContextInfo(){const {_initialFeature:H,arcadeEditType:J,layer:z,
map:A,spatialReference:v,timeZone:G}=this;return{layer:t.isEditableLayer(z)?z:null,originalFeature:H,editType:J,map:A,spatialReference:v,timeZone:G}}get allFieldInputs(){return L.flattenFieldInputs(this.inputs)}get allGroupInputs(){return this.inputs.filter(L.isGroupInput)}get allRelationshipInputs(){return L.flattenRelationshipInputs(this.inputs)}get _layerFieldsByName(){return new Map(this.layer?.fields.map(H=>[H.name,H]))}get feature(){return this._get("feature")}set feature(H){this._featureClone=
H?H.clone():D.clone();this._initialFeature=this._featureClone.clone();this._expressionsManager&&(this._expressionsManager.feature=this._featureClone);H?(this._resetFieldInputValues(this._featureClone),this.allRelationshipInputs.forEach(J=>J.feature=H)):(this.inputs.forEach(J=>J.destroy()),this.inputs.length=0);this.contingencyConstraintViolations.clear();this._set("feature",H)}get fieldsWithContingentValues(){if(null==this._contingentValuesCache)return new Set;const H=this._contingentValuesCache.fieldGroups.flatMap(J=>
J.fields);return new Set(H)}get fieldsWithInvalidCodedValue(){return new Set(this.allFieldInputs.filter(H=>{const {name:J,domain:z,value:A}=H;return"coded-value"===z?.type?(H=this.getFieldValueOptionsForField(J),null!=A&&""!==A&&!H.flat().some(v=>v.value===A)):!1}))}get formTemplate(){return this.layer&&"formTemplate"in this.layer?this.layer.formTemplate:null}set formTemplate(H){void 0===H?this._clearOverride("formTemplate"):this._override("formTemplate",H)}get formDescription(){const {formTemplate:H,
layer:J}=this;return H?.description&&J?L.parseFormTemplateString({label:H.description,attributes:this.getValues(),fieldsIndex:J.fieldsIndex,timeZone:this.timeZone}):null}get formTitle(){const {formTemplate:H,layer:J}=this;return H?.title&&J?L.parseFormTemplateString({label:H.title,attributes:this.getValues(),fieldsIndex:J.fieldsIndex,timeZone:this.timeZone}):null}get formHeaderVisible(){const {activeRelationshipInput:H,formDescription:J,formTitle:z}=this;return!(H||!J&&!z)}set inputFields(H){d.deprecatedProperty(P,
"inputFields",{replacement:"FeatureFormViewModel.inputs",version:"4.27"});this.inputs=H}get inputFields(){d.deprecatedProperty(P,"inputFields",{replacement:"FeatureFormViewModel.inputs",version:"4.27"});return this.inputs}get joinedContingentValues(){return this._joinContingentValues()}get layer(){return this.feature?.sourceLayer&&"applyEdits"in this.feature.sourceLayer?this.feature.sourceLayer:null}set layer(H){this._override("layer",H)}get relationshipId(){return this._get("relationshipId")}set relationshipId(H){var J=
this.allRelationshipInputs;null!=H&&H===this.relationshipId||J.forEach(z=>z.showAllEnabled=!1);null!=H&&(J=J.find(z=>z.relationshipId===H))&&(J.showAllEnabled=!0);this._set("relationshipId",H)}get spatialReference(){return this.layer?.spatialReference??null}set spatialReference(H){this._override("spatialReference",H)}get state(){return this.layer?.loaded?"ready":"disabled"}get submittable(){return this.valid?!0:this.allFieldInputs.filter(H=>!H.valid).every(({submittable:H})=>H)}get timeZone(){var {layer:H}=
this;if(H&&"datesInUnknownTimezone"in H&&H.datesInUnknownTimezone)return u.utc;H=H&&"preferredTimeZone"in H&&H.preferredTimeZone;return this._timeZone===u.unknown?H||u.utc:this._timeZone||u.system}set timeZone(H){this._timeZone=H}get updating(){return this._updatingHandles.updating}get valid(){const H=this.allFieldInputs;return 0<H.length&&H.every(({valid:J})=>J)}get view(){d.deprecatedProperty(P,"view",{replacement:"FeatureForm.map",version:"4.27"});return this._get("view")}set view(H){d.deprecatedProperty(P,
"view",{replacement:"FeatureForm.map",version:"4.27"});this._set("view",H);H?.map&&(this.map=H.map)}findField(H){return this.allFieldInputs.find(J=>J.name===H)}getFieldValueOptionsForField(H,J){var z=this.findField(H);if(!z)return[[],[]];z="coded-value"===z.domain?.type?z.domain.codedValues.map(({name:A,code:v})=>({name:A,value:v})):[];H=this.fieldsWithContingentValues.has(H)?this._getContingentValueOptionsForField(H,J):[];if(0<H.length){const A=new Set(H.map(v=>v.value));J=z.filter(v=>!A.has(v.value));
return[H,J]}return[z,[]]}getValue(H){const {_featureClone:J,layer:z}=this,A=!!z?.getField(H);return J.getAttribute(H)??(A?null:void 0)}setValue(H,J){const {_featureClone:z,strict:A}=this,v=this.findField(H);J=""===J?null:J;v&&z.getAttribute(H)!==J&&(v.value=J,!A||v.valid)&&(this._afterValueChange(v),null!=this._expressionsManager&&this._updatingHandles.addPromise(this._expressionsManager.evaluateInvalidated([v.name]).finally(()=>this._afterExpressionsEvaluated())))}getValues(){return{...this._featureClone.attributes}}overrideInitialFeature(H){this._initialFeature=
H}submit(){var H=this.allFieldInputs;const J=new Set(H.filter(A=>A.valid).map(({name:A})=>A));H=H.filter(A=>!A.valid).map(({name:A})=>A);const z=this.getValues();if(0<this.validateContingencyConstraints(z,{includeIncompleteViolations:!0}).length)for(const [A,v]of this.contingencyConstraintViolations.entries())"error"===v.type&&(J.delete(A),H.push(A));this.emit("submit",{valid:[...J],invalid:H,values:z})}validateContingencyConstraints(H,J){const {_contingentValuesCache:z}=this,A=new Map;this.contingencyConstraintViolations=
A;if(null==z)return[];const {invalid:v,incomplete:G}=z.validateContingencyConstraints(H);H=[...v,...(J?.includeIncompleteViolations?G:[])];for(const O of H)for(const U of O.fieldGroup.fields)A.set(U,O);return H}notifyFeatureGeometryChanged(){const {_expressionsManager:H,feature:J,_featureClone:z}=this;z.geometry=J.geometry;null!=H&&this._updatingHandles.addPromise(H.evaluateInvalidatedByGeometry().finally(()=>this._afterExpressionsEvaluated()))}_emitChangeEvent({name:H,valid:J,value:z}){this.emit("value-change",
{layer:this.layer,feature:this.feature,fieldName:H,value:z,valid:J})}async _updateInputs(){this._stopExpressions();const {_featureClone:H,_initialFeature:J,arcadeEditType:z,formTemplate:A,inputs:v,layer:G,timeZone:O}=this;if(G){var U={arcadeEditType:z,feature:H,initialFeature:J,layer:G,timeZone:O},ca=v.slice();this.inputs=A?.elements&&0<A.elements.length?await this._updateInputsUsingFormElements(ca,A.elements,U):this._updateInputsUsingLayerFields(ca,G?.fields,U);await this._startExpressions()}}async _updateInputsUsingFormElements(H,
J,z){const A=new Map;for(const v of H)if(L.isGroupInput(v)){A.set(v.element,v);for(const G of v.inputs)G.element&&A.set(G.element,G)}else v.element&&A.set(v.element,v);H=new Map;J=this._updateInputsUsingFormElementsRecursive({existingInputsByElement:A,updatedElements:J.filter(R),sharedInitializationProperties:z,group:null,newExpressionExecutorPromises:H});for(const [v,G]of A.entries())A.delete(v),G.destroy();await Promise.all(Array.from(H.values()));return J}_updateInputsUsingFormElementsRecursive(H){const {existingInputsByElement:J,
updatedElements:z,sharedInitializationProperties:A,group:v,newExpressionExecutorPromises:G}=H;H=[];for(const U of z){var O=J.has(U);const ca=O?J.get(U):L.isGroupElement(U)?this._makeGroupInputFromElement(U,A):L.isFieldElement(U)?this._makeFieldInputFromElement(U,A,v):L.isRelationshipElement(U)?this._makeRelationshipInputFromElement(U,A,v):null;if(ca){H.push(ca);this._assignExpressionExecutors(ca,U,G);if(O)if(J.delete(U),L.isGroupInput(ca)){const {feature:X,timeZone:da}=A;ca.set({feature:X,timeZone:da})}else L.isRelationshipInput(ca)?
(O=this.relationshipId===U.relationshipId,ca.set(A),ca.set({map:this.map,showAllEnabled:O})):ca.set(A);L.isGroupElement(U)&&(O=U.elements.filter(X=>R(X)),ca.inputs=this._updateInputsUsingFormElementsRecursive({existingInputsByElement:J,updatedElements:O,sharedInitializationProperties:A,group:ca,newExpressionExecutorPromises:G}))}}return H}_updateInputsUsingLayerFields(H,J,z){if(!Array.isArray(J))return g.getLogger(this).warn(this.declaredClass,"No attribute fields found."),[];const A=new Map;for(const X of H)if(L.isGroupInput(X)){for(const da of X.inputs)da.destroy();
X.inputs.length=0;X.destroy()}else L.isRelationshipInput(X)?X.destroy():L.isFieldInput(X)&&(null!==X.element?X.destroy():A.set(X.field,X));H=[];const {arcadeEditType:v,feature:G,initialFeature:O,layer:U,timeZone:ca}=z;for(const X of J)J=A.get(X)??new K({arcadeEditType:v,field:X,feature:G,initialFeature:O,layer:U,value:G?.getAttribute(X.name)??null,preservesValueWhenHidden:this.formTemplate?.preserveFieldValuesWhenHidden,timeZone:ca}),H.push(J),A.delete(X);for(const [X,da]of A.entries())A.delete(X),
da.destroy();return H}_resetFieldInputValues(H){for(const J of this.allFieldInputs)J.value=H.getAttribute(J.name)}_makeFieldInputFromElement(H,J,z){const {arcadeEditType:A,feature:v,initialFeature:G,layer:O,timeZone:U}=J;({fieldName:J}=H);return(J=J&&this._layerFieldsByName.get(J))?new K({arcadeEditType:A,element:H,field:J,value:v?.getAttribute(H.fieldName)??null,feature:v,initialFeature:G,layer:O,group:z,preservesValueWhenHidden:this.formTemplate?.preserveFieldValuesWhenHidden,timeZone:U}):null}_makeGroupInputFromElement(H,
J){const {feature:z,layer:A}=J;return new p({element:H,inputs:[],feature:z,layer:A})}_makeRelationshipInputFromElement(H,J,z=null){const {map:A}=this,{feature:v,layer:G,timeZone:O}=J;return new I({element:H,feature:v,group:z,layer:G,map:A,timeZone:O})}_assignExpressionExecutors(H,J,z){var A=L.isGroupElement(J)?N:L.isRelationshipElement(J)?C:E;for(const v of A){const G=`${v}Executor`;if(H[G]){this._useExecutor(H[G]);continue}A=J[v];const {_expressionExecutorLookup:O}=this;if(null!=A&&""!==A){const U=
this._expressionInfosLookup.get(A)?.expression??A;O.has(U)?H[G]=this._useExecutor(O.get(U)):z.has(U)?(A=z.get(U).then(ca=>H[G]=ca),z.set(U,A)):(A=F.createFormExpressionArcadeExecutor(U,this.layer).then(ca=>{H[G]=this._useExecutor(ca);O.set(U,ca);return ca}),z.set(U,A))}}return[]}_createExpressionsManager(H){const {_arcadeContextInfo:J,_featureClone:z,allFieldInputs:A,formTemplate:v}=this;this._expressionsManager=new y.FormExpressionsManager({executors:H,feature:z,arcadeContextInfo:J,fieldInputs:A,
preserveFieldValuesWhenHidden:!0===v?.preserveFieldValuesWhenHidden})}async _startExpressions(){if(0!==this._expressionExecutorsInUse.size){var H=Array.from(this._expressionExecutorsInUse);this._createExpressionsManager(H);await this._expressionsManager.evaluateAll().finally(()=>this._afterExpressionsEvaluated())}}_stopExpressions(){this._expressionsManager=x.destroyMaybe(this._expressionsManager);this._expressionExecutorsInUse.clear()}_useExecutor(H){this._expressionExecutorsInUse.add(H);return H}_afterValueChange(H){const {name:J,
value:z}=H,{_featureClone:A,formTemplate:v,layer:G}=this;if(G){var O=A.getAttribute(J);A.setAttribute(J,z);var {typeFieldName:U,types:ca}=L.getNormalizedFeatureTypeInfo(G);if(J===U&&z!==O){"subtype-sublayer"===G.type&&(O=G.parent?.findSublayerForFeature(A),A.sourceLayer=this.feature.sourceLayer=O);O=new Set;for(var X of ca)if(X.domains&&"object"===typeof X.domains)for(const da of Object.keys(X.domains))O.add(da);for(const da of O)(X=this.findField(da))&&X.notifyChange("domain")}if(null!=v){const {description:da,
title:ha}=v;ha&&M.templateHasKey(ha,J)&&this.notifyChange("formTitle");da&&M.templateHasKey(da,J)&&this.notifyChange("formDescription")}this._emitChangeEvent(H)}}_afterExpressionsEvaluated(){const {_featureClone:H}=this;for(const J of this.allFieldInputs)J.value!==H.getAttribute(J.name)&&this._afterValueChange(J)}_joinContingentValues(){var H=this._contingentValuesCache;if(null==H)return[];var {typeFieldName:J}=L.getNormalizedFeatureTypeInfo(this.layer);J=J?this.getValue(J):null;const z=[];for(var A of H.fieldGroups){const {contingencies:U,
fields:ca,name:X}=A;H=[];for(var v of U)v.isRetired||(null==v.subtype||v.subtype.code===J)&&H.push({values:v.values});0<H.length&&z.push({name:X,fields:ca,contingencies:H})}const [G,O]=this._generateJoinPlan(z);A=G.flatMap(U=>this._joinFieldGroupContingencies(U));v=O.flatMap(U=>U.contingencies);return[...A,...v]}_generateJoinPlan(H){var J=new Map,z=[],A=new Set;for(var v of H)for(const ca of v.fields)if(J.has(ca)){const X=J.get(ca),da=v,ha=[X.name,da.name].sort().join("|");A.has(ha)||(z.push([X,da]),
A.add(ha),J.set(ca,da))}else J.set(ca,v);J=new Set(z.flat());H=new Set(H);for(var G of J)H.delete(G);G=new Map;J=new Map;for(var O of new Set(z.flat()))A=Symbol(O.name),G.set(A,new Set([O])),J.set(O,A);for(const [ca,X]of z)if(z=J.get(ca),O=J.get(X),z!==O){A=G.get(z);v=G.get(O);for(var U of v)A.add(U),J.set(U,z);G.delete(O)}U=[...G.values()].map(ca=>[...ca]);z=[...H];return[U,z]}_joinFieldGroupContingencies(H){const J=H.slice();var z=J.shift(),A=J.shift();H=this._generateJoinKey(z.fields,A.fields);
let v=new Set([...z.fields,...A.fields]),G=new Map;for(var O of z.contingencies)[z]=this._hashContingency(O,H.codedValueFields,!0),G.has(z)?G.get(z)?.push(O):G.set(z,[O]);for(;0<J.length;){O=new Map;z=J.shift();const X=this._generateJoinKey(v,z.fields);for(var U of A.contingencies){const [da,ha]=this._hashContingency(U,H.codedValueFields);A=ha?this._findMatchingContingenciesWithAnyHashMask(G,da):G.get(da);G.has("#JSAPI_CONTINGENT_VALUE_ANY_HASH")&&A?.push(...this._findMatchingContingenciesContainingAny(U,
G.get("#JSAPI_CONTINGENT_VALUE_ANY_HASH"),H.codedValueFields));if(null!=A)for(var ca of A){A=0<H.rangeFields.length?this._joinContingenciesWithRangeDomains(ca,U,H.rangeFields):this._joinContingencies(ca,U);if(null==A)break;const [ia]=this._hashContingency(A,X.codedValueFields,!0);O.has(ia)?O.get(ia)?.push(A):O.set(ia,[A])}}G=O;A=z;H=X;v=new Set([...v,...A.fields])}U=[];for(const X of A.contingencies){const [da,ha]=this._hashContingency(X,H.codedValueFields);ca=ha?this._findMatchingContingenciesWithAnyHashMask(G,
da):G.get(da);G.has("#JSAPI_CONTINGENT_VALUE_ANY_HASH")&&ca.push(...this._findMatchingContingenciesContainingAny(X,G.get("#JSAPI_CONTINGENT_VALUE_ANY_HASH"),H.codedValueFields));if(null!=ca)for(const ia of ca)ca=0<H.rangeFields.length?this._joinContingenciesWithRangeDomains(ia,X,H.rangeFields):this._joinContingencies(ia,X),null!=ca&&U.push(ca)}return U}_joinContingencies(H,J){J={values:{...H.values,...J.values}};for(const [z,A]of Object.entries(J.values))"any"===A.objectType&&null!=H.values[z]&&(J.values[z]=
H.values[z]);return J}_joinContingenciesWithRangeDomains(H,J,z){const A=this._joinContingencies(H,J);for(const G of z){var v=H.values[G];const O=J.values[G],{leftIsNull:U,rightIsNull:ca,bothAreNull:X,leftIsAny:da,rightIsAny:ha,bothAreAny:ia,leftIsRange:ma,rightIsRange:ea}=this._compareObjectTypes(v.objectType,O.objectType);if(!X&&!ia)if(U&&ha||ca&&da)A.values[G]=new c({objectType:"null"});else{if(U&&ea||ca&&ma)return null;da?(v.minValue=-Infinity,v.maxValue=Infinity):ha&&(O.minValue=-Infinity,O.maxValue=
Infinity);z=Math.max(v.minValue,O.minValue);v=Math.min(v.maxValue,O.maxValue);if(z>v)return null;A.values[G]=new c({objectType:"range",minValue:z,maxValue:v})}}return A}_findMatchingContingenciesContainingAny(H,J,z){return J.filter(A=>z.every(v=>{const G=A.values[v];v=H.values[v];return"any"===G.objectType||"any"===v.objectType||G.codedValue?.code===v.codedValue?.code}))}_findMatchingContingenciesWithAnyHashMask(H,J){J=RegExp(`${J}$`);const z=[];for(const [A,v]of H){if("#JSAPI_CONTINGENT_VALUE_ANY_HASH"===
A)break;J.test(A)&&z.push(...v)}return z}_generateJoinKey(H,J){H=Array.isArray(H)?new Set(H):H;var z=Array.isArray(J)?new Set(J):J;J=H.size<z.size?H:z;H=J===H?z:H;z=new Set;const A=new Set;for(const v of J)if(H.has(v)&&(J=this.layer?.getFieldDomain(v,{feature:this.feature}),null!=J))switch(J.type){case "coded-value":z.add(v);break;case "range":A.add(v)}return{codedValueFields:[...z],rangeFields:[...A]}}_contingencyIsValid(H,J){const z={};for(const {name:A,value:v}of this.allFieldInputs)this.fieldsWithContingentValues.has(A)&&
null!=v&&A!==H&&(z[A]=v);return Object.entries(z).every(([A,v])=>!J.values.hasOwnProperty(A)||L.valueIsValidContingentValue(v,J.values[A]))}_getContingentValueOptionsForField(H,J){var z=this.joinedContingentValues.slice();const A=new Map;J={code:"",name:J??"No value"};for(const v of z)if(z=v.values[H],"code"===z?.objectType||"null"===z?.objectType){const {code:G,name:O}=z.codedValue&&"null"!==z.objectType?z.codedValue:J;!A.has(G)&&this._contingencyIsValid(H,v)&&A.set(G,{name:O,value:G})}return[...A.values()]}_hashContingency(H,
J,z=!1){if(1>J.length)return["#JSAPI_CONTINGENT_VALUE_EMPTY_HASH",!1];const A=[];let v=!1;for(const G of J)if(J=H.values[G],"any"===J.objectType){if(z)return["#JSAPI_CONTINGENT_VALUE_ANY_HASH",!0];v=!0;A.push(`${G}:.*`)}else"null"===J.objectType?A.push(`${G}:${"#JSAPI_CONTINGENT_VALUE_NULL_HASH"}`):A.push(`${G}:${J.codedValue?.code}`);return[A.sort().join("\x26"),v]}_compareObjectTypes(H,J){return{leftIsNull:"null"===H,rightIsNull:"null"===J,bothAreNull:"null"===H&&"null"===J,leftIsAny:"any"===H,
rightIsAny:"any"===J,bothAreAny:"any"===H&&"any"===J,leftIsRange:"range"===H,rightIsRange:"range"===J}}};a.__decorate([k.property()],b.prototype,"_expressionInfosLookup",null);a.__decorate([k.property()],b.prototype,"_featureClone",void 0);a.__decorate([k.property()],b.prototype,"_timeZone",void 0);a.__decorate([k.property()],b.prototype,"activeRelationshipInput",null);a.__decorate([k.property()],b.prototype,"_arcadeContextInfo",null);a.__decorate([k.property()],b.prototype,"allFieldInputs",null);
a.__decorate([k.property()],b.prototype,"allGroupInputs",null);a.__decorate([k.property()],b.prototype,"allRelationshipInputs",null);a.__decorate([k.property()],b.prototype,"_layerFieldsByName",null);a.__decorate([k.property()],b.prototype,"arcadeEditType",void 0);a.__decorate([k.property()],b.prototype,"contingencyConstraintViolations",void 0);a.__decorate([k.property()],b.prototype,"disabled",void 0);a.__decorate([k.property()],b.prototype,"feature",null);a.__decorate([k.property()],b.prototype,
"fieldsWithContingentValues",null);a.__decorate([k.property()],b.prototype,"fieldsWithInvalidCodedValue",null);a.__decorate([k.property({type:r})],b.prototype,"formTemplate",null);a.__decorate([k.property()],b.prototype,"formDescription",null);a.__decorate([k.property()],b.prototype,"formTitle",null);a.__decorate([k.property()],b.prototype,"formHeaderVisible",null);a.__decorate([k.property()],b.prototype,"highlightHelper",void 0);a.__decorate([k.property()],b.prototype,"inputs",void 0);a.__decorate([k.property()],
b.prototype,"inputFields",null);a.__decorate([k.property()],b.prototype,"joinedContingentValues",null);a.__decorate([k.property()],b.prototype,"layer",null);a.__decorate([k.property()],b.prototype,"map",void 0);a.__decorate([k.property()],b.prototype,"relatedRecordCallbacks",void 0);a.__decorate([k.property()],b.prototype,"relationshipId",null);a.__decorate([k.property()],b.prototype,"spatialReference",null);a.__decorate([k.property()],b.prototype,"state",null);a.__decorate([k.property()],b.prototype,
"strict",void 0);a.__decorate([k.property()],b.prototype,"submittable",null);a.__decorate([k.property()],b.prototype,"timeZone",null);a.__decorate([k.property()],b.prototype,"updating",null);a.__decorate([k.property()],b.prototype,"valid",null);a.__decorate([k.property()],b.prototype,"view",null);a.__decorate([k.property()],b.prototype,"getValues",null);a.__decorate([k.property()],b.prototype,"submit",null);return b=a.__decorate([l.subclass("esri.widgets.FeatureForm.FeatureFormViewModel")],b)})},
"esri/layers/support/ContingentValue":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),function(a,b,d,m,g,x,n){b=class extends b{constructor(B){super(B);this.codedValue=this.minValue=this.maxValue=null}};a.__decorate([d.property()],b.prototype,"objectType",void 0);a.__decorate([d.property()],b.prototype,"maxValue",
void 0);a.__decorate([d.property()],b.prototype,"minValue",void 0);a.__decorate([d.property()],b.prototype,"codedValue",void 0);return b=a.__decorate([n.subclass("esri.layers.support.ContingentValue")],b)})},"esri/layers/support/LayerContingentValuesCache":function(){define("../../chunks/tslib.es6 ../../request ../../core/arrayUtils ../../core/JSONSupport ../../core/Loadable ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/has ../../core/accessorSupport/decorators/subclass ./arcgisLayerUrl ./Contingency ./ContingencyConstraintViolation ./ContingentValue ./ContingentValuesResult ./FieldGroup ./fieldUtils ./Subtype".split(" "),
function(a,b,d,m,g,x,n,B,M,k,w,e,f,l,q,r,c){var t;m=t=class extends m.JSONSupportMixin(g){constructor(h){super(h);this.request=b;this.fieldGroupDefinitions=this.fieldGroups=null}initialize(){}get subtypeFieldName(){const {layer:h}=this;return"subtype-group"===h.type?h.subtypeField:h.typeIdField}static async createLoadedLayerContingentValuesCache(h){await h.load();if(void 0===h.layerId)return null;var u=h.sourceJSON.hasContingentValuesDefinition;if(u)return(new t({layer:h})).load();if(void 0===u){u=
k.parse(h.url);if(null==u)return null;u=u.url.path;if((await t._staticFetchEnterpriseFeatureRoot(u)).supportsQueryDataElements&&(u=await t._staticFetchEnterpriseFieldGroup(u,h.layerId.toString())))return u=u.map(L=>({name:L.name,isEditingRestrictive:L.isEditingRestrictive,fields:L.fieldNames.names.map(K=>h.fieldsIndex.normalizeFieldName(K))})),(new t({layer:h,fieldGroupDefinitions:u})).load()}return null}async load(h){const u=this.layer.load(h).then(()=>this._initializeContingentValues(this.fieldGroupDefinitions,
h));this.addResolvingPromise(u);return this}validateContingencyConstraints(h,u){const L=Object.keys(h),K=[],F=[];for(const p of this.fieldGroups){const I=p.isEditingRestrictive?"error":"warning";if(u&&!p.fields.some(E=>u.includes(E)))continue;if(!p.fields.every(E=>L.includes(E))){F.push(new e({fieldGroup:p,type:I}));continue}let R=!1;const D=h[this.subtypeFieldName];var y=p.contingencies.filter(E=>!E.isRetired&&E.subtype?E.subtype.code===D:!0);for(const E of y){y=!0;for(const N in E.values){const C=
E.values[N];if("any"!==C.objectType)if("null"===C.objectType){if(null!=h[N]){y=!1;break}}else if("code"===C.objectType){if(h[N]!==C.codedValue.code){y=!1;break}}else if("range"===C.objectType){const P=h[N];if(P<C.minValue||P>C.maxValue){y=!1;break}}}if(y){R=!0;break}}R||K.push(new e({fieldGroup:p,type:I}))}return{invalid:K,incomplete:F}}getContingentValues(h,u,L=!1){const K=h[this.subtypeFieldName],F=void 0!==K&&null!==K,y={};let p=[];const I=this.fieldGroups.filter(D=>D.fields.includes(u));p.push(new f({objectType:"any"}));
for(const D of I){let E=[];var R=D.contingencies.filter(P=>!P.isRetired&&(P.subtype&&F?P.subtype.code===K:!0));let N=!1;const C={};for(const P of R){let H;R=!0;for(const J in P.values){const z=P.values[J];if(u===J)H=z,N=N||"range"===z.objectType;else if(void 0!==h[J]&&"any"!==z.objectType)if("null"===z.objectType)null!==h[J]&&(R=!1);else if("code"===z.objectType)h[J]!==z.codedValue.code&&(R=!1);else if("range"===z.objectType){const A=h[J];if(A<z.minValue||A>z.maxValue)R=!1}}if(H&&R){if("any"===H.objectType){E.length=
0;E.push(H);break}R=this._generateKey(H);C[R]||E.push(H);C[R]=!0}}N&&(E=this._joinRange(E));y[D.name]=E;p=L?this._filterIntersection(p,E):[]}1===I.length&&L&&(p=[]);return new l({contingentValuesAllGroups:p,contingentValuesByFieldGroup:y})}_generateKey(h){switch(h.objectType){case "any":return"@any@";case "null":return"@null@";case "code":return h.codedValue.name+h.codedValue.code.toString();case "range":return h.minValue.toString()+"-"+h.maxValue.toString()}}_joinRange(h){h.sort((F,y)=>"null"===
F.objectType?-1:"null"===y.objectType?1:F.minValue-y.minValue);let u,L;const K=[];for(const F of h)"null"===F.objectType?K.push(F):null==u||null==L?(u=F.minValue,L=F.maxValue):L<F.minValue?(K.push(new f({objectType:"range",minValue:u,maxValue:L})),u=F.minValue,L=F.maxValue):L<F.maxValue&&(L=F.maxValue);K.push(new f({objectType:"range",minValue:u,maxValue:L}));return K}_filterIntersection(h,u){if(0===h.length||0===u.length)return[];if("any"===h[0].objectType)return u;if("any"===u[0].objectType)return h;
const L="range"===u[0].objectType||"range"===u[1]?.objectType;return"range"===h[0].objectType||"range"===h[1]?.objectType||L?this._intersectRanges(h,u):this._intersectValues(h,u)}_intersectRanges(h,u){const L=[];let K=0;for(const F of h)for(;K<u.length;K++){const y=u[K];if("null"===F.objectType&&"null"===y.objectType)L.push(new f({objectType:"null"}));else if("null"===F.objectType)break;else if("null"===y.objectType)continue;if(F.maxValue<y.minValue)break;if(F.maxValue===y.minValue){L.push(new f({objectType:"range",
minValue:F.maxValue,maxValue:y.minValue}));break}if(!(F.minValue>y.maxValue))if(F.minValue===y.maxValue)L.push(new f({objectType:"range",minValue:F.minValue,maxValue:y.maxValue}));else{h=F.minValue>y.minValue?F.minValue:y.minValue;if(F.maxValue<y.maxValue){L.push(new f({objectType:"range",minValue:h,maxValue:F.maxValue}));break}L.push(new f({objectType:"range",minValue:h,maxValue:y.maxValue}))}}return L}_intersectValues(h,u){const L=[];for(const K of h)u.some(F=>{if(K.objectType===F.objectType)switch(K.objectType){case "any":case "null":return!0;
case "code":return K.codedValue.code===F.codedValue.code&&K.codedValue.name===F.codedValue.name}return!1})&&L.push(K);return L}static async _staticFetchEnterpriseFeatureRoot(h,u){return b(h,{responseType:"json",query:{f:"json"},...u}).then(L=>L.data)}static async _staticFetchEnterpriseFieldGroup(h,u,L){return b(`${h}/queryDataElements`,{responseType:"json",query:{layers:JSON.stringify([u]),f:"json"},...L}).then(K=>K.data.layerDataElements?.[0].dataElement.fieldGroups)}async _initializeContingentValues(h,
u){h=h??await this._fetchFieldGroupDefs(u);this.fieldGroups=0===h.length?[]:await this._fetchContingentValues(h,u)}async _fetchFieldGroupDefs(h){if(void 0===this.layer.layerId)return[];const u=this.layer.sourceJSON,L=this.layer.layerId.toString(),K=k.parse(this.layer.url).url.path;return u.hasContingentValuesDefinition?(await this._fetchAGOLFieldGroup(K,L,h)).map(F=>({name:F.name,isEditingRestrictive:F.restrictive,fields:F.fields.map(y=>this.layer.fieldsIndex.normalizeFieldName(y))})):void 0!==u.hasContingentValuesDefinition?
[]:this._fetchEnterpriseFeatureRoot(K,h).then(async F=>F.supportsQueryDataElements?(await this._fetchEnterpriseFieldGroup(K,L,h)).map(y=>({name:y.name,isEditingRestrictive:y.isEditingRestrictive,fields:y.fieldNames.names.map(p=>this.layer.fieldsIndex.normalizeFieldName(p))})):[])}async _fetchAGOLFieldGroup(h,u,L){return b(`${h}/${u}/fieldgroups`,{responseType:"json",query:{f:"json"},...L}).then(K=>K.data.fieldGroups)}async _fetchEnterpriseFieldGroup(h,u,L){return t._staticFetchEnterpriseFieldGroup(h,
u,L)}async _fetchEnterpriseFeatureRoot(h,u){return t._staticFetchEnterpriseFeatureRoot(h,u)}async _fetchContingentValues(h,u){if(void 0===this.layer.layerId)return[];const L=this.layer.sourceJSON,K=this.layer.layerId.toString(),F=k.parse(this.layer.url).url.path;if(L.hasContingentValuesDefinition)return u=await this._fetchAGOLContingentValues(F,K,u),this._constructFieldGroupsAGOL(h,u);u=await this._fetchEnterpriseContingentValues(F,K,u);return this._constructFieldGroupsEnterprise(h,u)}_constructFieldGroupsAGOL(h,
u){return h.map(L=>{const K=u.contingentValuesDefinition.fieldGroups.find(F=>F.name===L.name);if(K){let F=[];F=u.contingentValuesDefinition.hasSubType?this._parseAGOLFieldGroupSubtype(L,u,K.subTypes):this._parseAGOLFieldGroup(L,u,K.contingentValues);return new q({name:L.name,isEditingRestrictive:L.isEditingRestrictive,fields:L.fields,contingencies:F})}return null}).filter(d.isSome)}_parseAGOLFieldGroupSubtype(h,u,L){let K=[];L?.forEach(F=>{const y=this._getSubtypeAGOL(F.name);K=K.concat(this._parseAGOLFieldGroup(h,
u,F.contingentValues,y))});return K}_parseAGOLFieldGroup(h,u,L,K=null){const F=[];for(const y of L??[])L=this._parseAGOLContingency(y,h,u,K),F.push(L);return F}_parseAGOLContingency(h,u,L,K){const F=h.id,y=h.retired?1===h.retired:!1,p={};for(let R=0,D=0;R<u.fields.length;R++){const E=u.fields[R];var I=L.typeCodes[h.types[R]];if("Code"===I){let N=h.values[D];D++;const C=this._getDomain(K,E);"string"===this.layer.getField(E)?.type&&(I=L.stringDicts.find(P=>P.domain===C?.name))&&(N=I.entries[N]);I=C?.codedValues.find(P=>
P.code===N);I=new f({codedValue:I,objectType:"code"});p[E]=I}else"Range"===I?(I=h.values[D],D++,I=new f({minValue:I.range[0],maxValue:I.range[1],objectType:"range"}),p[E]=I):"Any"===I?(I=new f({objectType:"any"}),p[E]=I):(I=new f({objectType:"null"}),p[E]=I)}return new w({id:F,isRetired:y,subtype:K,values:p})}_constructFieldGroupsEnterprise(h,u){const L=u.fieldGroups;return h.map(K=>{var F=L.find(y=>y.name===K.name);return F?(F=F.contingencies.map(y=>{const p=y.id,I=y.isRetired||!1,R=this._getSubtypeEnterprise(y.subtypeCode),
D={};for(let N=0;N<K.fields.length;N++){const C=K.fields[N];let P=y.values[N];if("number"===typeof P||"string"===typeof P){var E=this._getDomain(R,C);const H=this.layer.getField(C);r.isStringField(H)?P=u.stringDictionary[P]:r.isDateField(H)&&(P=(new Date(`${P}+00:00`)).getTime());E=E?.codedValues.find(J=>J.code===P);E=new f({codedValue:E,objectType:"code"});D[C]=E}else"object"===typeof P?(E=new f({minValue:P.minValue,maxValue:P.maxValue,objectType:"range"}),D[C]=E):P?(E=new f({objectType:"any"}),
D[C]=E):(E=new f({objectType:"null"}),D[C]=E)}return new w({id:p,isRetired:I,subtype:R,values:D})}),new q({name:K.name,isEditingRestrictive:K.isEditingRestrictive,fields:K.fields,contingencies:F})):null}).filter(d.isSome)}async _fetchEnterpriseContingentValues(h,u,L){return b(`${h}/queryContingentValues`,{responseType:"json",query:{layers:JSON.stringify([u]),f:"json"},...L}).then(K=>K.data.contingentValueSets?.[0])}async _fetchAGOLContingentValues(h,u,L){return b(`${h}/${u}/contingentValues`,{responseType:"json",
query:{f:"json"},...L}).then(K=>K.data)}_getSubtypeEnterprise(h){var u=this.layer.sourceJSON;let L;u.subtypes&&(u=u.subtypes.find(K=>K.code===h),L=c.fromJSON(u));return L||null}_getSubtypeAGOL(h){var u=this.layer.sourceJSON;let L;u.subtypes&&(u=u.subtypes.find(K=>K.name===h),L=c.fromJSON(u));return L||null}_findDomainByFieldName(h,u){return(h=h.domains)?([,h]=Object.entries(h).find(([L])=>L.trim().toLowerCase()===u.trim().toLowerCase())||[],h||null):null}_getDomain(h,u){h=h?this._findDomainByFieldName(h,
u):this.layer.getFieldDomain(u);return"inherited"===h?.type?this.layer.getFieldDomain(u):h}};a.__decorate([x.property({constructOnly:!0})],m.prototype,"layer",void 0);a.__decorate([x.property({constructOnly:!0})],m.prototype,"request",void 0);a.__decorate([x.property({type:[q]})],m.prototype,"fieldGroups",void 0);a.__decorate([x.property({constructOnly:!0})],m.prototype,"fieldGroupDefinitions",void 0);a.__decorate([x.property()],m.prototype,"subtypeFieldName",null);return m=t=a.__decorate([M.subclass("esri.layers.support.LayerContingentValuesCache")],
m)})},"esri/layers/support/Contingency":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),function(a,b,d,m,g,x,n){b=class extends b{constructor(B){super(B);this.isRetired=!1}};a.__decorate([d.property()],b.prototype,"id",void 0);a.__decorate([d.property()],b.prototype,"isRetired",void 0);a.__decorate([d.property()],
b.prototype,"subtype",void 0);a.__decorate([d.property()],b.prototype,"values",void 0);return b=a.__decorate([n.subclass("esri.layers.support.Contingency")],b)})},"esri/layers/support/ContingencyConstraintViolation":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),function(a,b,d,m,g,x,n){b=class extends b{constructor(B){super(B)}};
a.__decorate([d.property()],b.prototype,"fieldGroup",void 0);a.__decorate([d.property()],b.prototype,"type",void 0);return b=a.__decorate([n.subclass("esri.layers.support.ContingencyConstraintViolation")],b)})},"esri/layers/support/ContingentValuesResult":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),function(a,
b,d,m,g,x,n){b=class extends b{constructor(B){super(B)}};a.__decorate([d.property()],b.prototype,"contingentValuesAllGroups",void 0);a.__decorate([d.property()],b.prototype,"contingentValuesByFieldGroup",void 0);return b=a.__decorate([n.subclass("esri.layers.support.ContingentValuesResult")],b)})},"esri/layers/support/FieldGroup":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,d,m,g,x,n){b=class extends b{constructor(B){super(B);this.fields=null;this.isEditingRestrictive=!1}};a.__decorate([d.property()],b.prototype,"name",void 0);a.__decorate([d.property()],b.prototype,"fields",void 0);a.__decorate([d.property()],b.prototype,"isEditingRestrictive",void 0);a.__decorate([d.property()],b.prototype,"contingencies",void 0);return b=a.__decorate([n.subclass("esri.layers.support.FieldGroup")],b)})},"esri/widgets/FeatureForm/FieldInput":function(){define("../../chunks/tslib.es6 ../../core/Error ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../layers/support/CodedValue ../../layers/support/CodedValueDomain ../../layers/support/Domain ../../layers/support/InheritedDomain ../../layers/support/RangeDomain ../../layers/support/domainUtils ../../layers/support/fieldUtils ../../smartMapping/support/utils ../Feature/support/featureUtils ./EditableInput ./featureFormUtils ../support/dataUtils ../support/dateUtils".split(" "),
function(a,b,d,m,g,x,n,B,M,k,w,e,f,l,q,r,c,t,h,u,L){var K;(function(F){F.Text="text";F.Number="number";F.Date="date";F.Unsupported="unsupported"})(K||(K={}));g=class extends t{constructor(F){super(F);this.error=this._storedValue=null;this.preservesValueWhenHidden=!0;this.requiredExpressionExecutor=this.group=this.field=null;this.type="field";this._fieldInputWasVisibleDuringLifetime=!1;this.valueExpressionExecutor=null}initialize(){this.addHandles(d.watch(()=>this.feature,()=>this._fieldInputWasVisibleDuringLifetime=
!1,d.sync))}get _dateFormRange(){const {element:F,field:y}=this;if("date"!==this.dataType)return{};const p=F?.domain?l.getDomainRange(y,F.domain):null;if(!F?.input)return p??{};var I=F.input,{type:R}=I;let D={};if("date-picker"===R||"time-picker"===R||"datetimeoffset-picker"===R)D=l.dateTimeFieldValuesToNumericRange(y,I.max,I.min);if("datetime-picker"===R){const {max:C,min:P}=I;D={max:null!=C&&C&&!Number.isNaN(C.valueOf())?C.getTime():null,min:null!=P&&P&&!Number.isNaN(P.valueOf())?P.getTime():null}}const {max:E,
min:N}=D;if(p){const {max:C,min:P}=p;I=u.isNumber(C)&&(null==E||null!=E&&C<E);R=u.isNumber(P)&&(null==N||null!=N&&P>N);return{max:I?C:E??null,min:R?P:N??null,rawMax:I?p.rawMax:D?.rawMax??null,rawMin:R?p.rawMin:D?.rawMin??null}}return{min:N,max:E,rawMax:D?.rawMax??null,rawMin:D?.rawMin??null}}get _dateRange(){const {_dateFormRange:F,field:y}=this;if("date"!==this.dataType)return{};var p=l.getDomainRange(y);if(!p)return F;const {max:I,min:R,rawMax:D,rawMin:E}=F;if("date"===y.type){const {max:N,min:C}=
p;return{max:u.isNumber(I)&&(null===N||null!=N&&I<N)?I:N??null,min:u.isNumber(R)&&(null===C||null!=C&&R>C)?R:C??null}}if("date-only"===y.type||"time-only"===y.type||"timestamp-offset"===y.type){const {max:N,min:C,rawMax:P,rawMin:H}=p;p=u.isNumber(I)&&D&&(null==N||I<N);const J=u.isNumber(R)&&E&&(null==C||R>C);return{max:p?I:N,min:J?R:C,rawMax:p?D:P,rawMin:p?E:H}}return{max:null,min:null}}get _configAllowsEdits(){const {element:F,layer:y,name:p}=this;return null!=F?F.editableExpression?!!this.evaluatedEditableExpression:
!1!==F.editable:y?.userHasUpdateItemPrivileges?!0:(y&&"popupTemplate"in y?y?.popupTemplate?.fieldInfos?.find(({fieldName:I})=>I===p):null)?.isEditable??!0}get _layerAndFieldAllowEdits(){return this.layerAllowsEdits&&this.field?.editable}get _isVisibleByDefault(){const {field:F,layer:y}=this;return!!F?.visible&&q.isFieldVisibleByDefault(F,y)}get _isEditTrackingField(){return q.getLowerCaseEditTrackingFields(this.layer).includes(this.name?.toLowerCase())}get _shouldUseValueExpression(){return this._layerAndFieldAllowEdits&&
!this._configAllowsEdits&&null!=this.valueExpressionExecutor}get _isSubtypeField(){const {layer:F}=this;if(F&&"subtypeField"in F){const {subtypeField:y,fieldsIndex:p}=F;return(p.get(y)?.name??y)===this.name}return!1}get test(){return{_isSubtypeField:this._isSubtypeField}}get dataType(){const {field:F}=this;return q.isNumericField(F)?K.Number:q.isStringField(F)?K.Text:r.isAnyDateField(F)||q.isTimeOnlyField(F)?K.Date:K.Unsupported}get dateDataType(){if(this.dataType===K.Date)return"date"!==this.field.type?
"string":"number"}get description(){const {element:F,feature:y,layer:p,timeZone:I}=this,R=F?.description;return null!=p&&null!=R?h.parseFormTemplateString({label:R,attributes:y.attributes,fieldsIndex:p.fieldsIndex,timeZone:I}):R}get domain(){var {layer:F}=this;const {typeFieldName:y,types:p}=h.getNormalizedFeatureTypeInfo(F);if(this._isSubtypeField&&"subtypes"in F&&F.subtypes)return new k({name:"__internal-type-based-coded-value-domain__",codedValues:F.subtypes.map(({code:R,name:D})=>new M.CodedValue({code:R,
name:D}))});if(y===this.name&&null==this.field.domain)return new k({name:"__internal-type-based-coded-value-domain__",codedValues:p.map(({code:R,name:D})=>new M.CodedValue({code:R,name:D}))});var {feature:I}=this;F=F?.getFieldDomain(this.name,{feature:I});I=this.element?.domain;return null!=I&&this._isDomainCompatible(I)?I:F}get editable(){return this._layerAndFieldAllowEdits?this.evaluatedEditableExpression??this._configAllowsEdits:!1}get evaluatedRequiredExpression(){const {requiredExpressionExecutor:F}=
this;return null!=F?!!F.lastEvaluatedValue:null}get evaluatedValueExpression(){const {valueExpressionExecutor:F}=this;return null!=F?F.lastEvaluatedValue:null}get hint(){return this.element?.hint}get includeDate(){return!(this.dataType!==K.Date||"time-only"===this.field.type)}get includeTime(){const {element:F,field:y}=this;if(this.dataType!==K.Date)return!1;if("time-only"===y.type)return!0;if("date-only"===y.type)return!1;const p="datetime-picker"===F?.input?.type?F.input.includeTime:void 0;return void 0===
p||p}get includeTimeOffset(){if("timestamp-offset"!==this.field.type)return!1;const F=this.element?.input;return F?"datetimeoffset-picker"===F.type&&F.includeTimeOffset:!0}set initialFeature(F){this._set("initialFeature",F);this.notifyChange("valid")}get inputType(){return this.element?.input?.type}get hasInvalidSwitchValue(){var {element:F}=this;F=h.isFieldElementWithInputType(F,"switch")?F.input:null;return!F||h.valueIsInvalidSwitchValue(this.value,F)}get isRelationshipKeyField(){const {field:F,
layer:y}=this;return c.isRelatableFeatureSupportedLayer(y)&&!!y.relationships?.some(p=>p.keyField===F.name)}get label(){const {element:F,feature:y,field:p,layer:I,timeZone:R}=this;return null!=I&&null!=F?.label?h.parseFormTemplateString({label:F.label,attributes:y.attributes,fieldsIndex:I.fieldsIndex,timeZone:R}):F?.label||p.alias||p.name}get maxLength(){if(this.dataType===K.Date)return-1;const {field:F,element:y}=this,p=F?.length??-1,I=h.isFieldElementWithTextInput(y)?y.input.maxLength:NaN;return null!=
I&&!isNaN(I)&&-1<=I&&(-1===p||I<=p)?I:p}get minLength(){if(this.dataType===K.Date)return-1;const {field:F,element:y}=this,p=F?.length??-1,I=h.isFieldElementWithTextInput(y)?y.input.minLength:NaN;return null!=I&&!isNaN(I)&&-1<=I&&(-1===p||I<=p)?I:-1}get name(){return this.field?.name}get range(){const {domain:F,element:y,field:p}=this;if("date"===this.dataType)return this._dateRange;var I=l.getDomainRange(p,F)||q.getFieldRange(p,F);const R=I?.max===Number.MAX_VALUE?null:I?.max??null;I=I?.min===-Number.MAX_VALUE?
null:I?.min??null;if(!y?.domain||"range"!==y.domain.type)return{max:R,min:I};const {max:D,min:E}=l.getDomainRange(p)||{};return{max:null!=D&&(null===R||null!=R&&D<R)?D:R,min:null!=E&&(null===I||null!=I&&E>I)?E:I}}get required(){const {editable:F,evaluatedRequiredExpression:y,field:p,visible:I,_isSubtypeField:R}=this;return F?!1===p?.nullable||R?!0:I&&null!=y?y:!1:!1}set required(F){this._overrideIfSome("required",F)}get showNoValueOptionEnabled(){const {element:F}=this;return this.required?!1:h.isFieldElementWithShowNoValueOptionInput(F)?
F.input.showNoValueOption:!0}get showNoValueLabel(){const {element:F}=this;return h.isFieldElementWithShowNoValueOptionInput(F)?F.input.noValueOptionLabel:null}get submittable(){const {field:F,required:y,valid:p,value:I}=this;return y&&null==I?!1:p?!0:this.initialFeature.getAttribute(F.name)===I}get timeResolution(){const F=this.element?.input;if(F&&("datetimeoffset-picker"===F.type||"time-picker"===F.type))return F.timeResolution??"minutes"}get timeStep(){return null!=this.timeResolution?L.timeResolutionToStepMap.get(this.timeResolution):
void 0}get updating(){const {editableExpressionExecutor:F,valueExpressionExecutor:y,visibilityExpressionExecutor:p,preservesValueWhenHidden:I}=this;return null!=y&&y.updating||null!=F&&F.updating||!1===I&&null!=p&&p.updating}get valid(){const F=this.editable?this._validate():null;this._set("error",F);return null===F}get value(){this._fieldInputWasVisibleDuringLifetime=this._fieldInputWasVisibleDuringLifetime||this.visible&&!1!==this.group?.visible;if(!1===this.preservesValueWhenHidden&&this._fieldInputWasVisibleDuringLifetime&&
(!1===this.visibilityExpressionExecutor?.lastEvaluatedValue||!1===this.group?.visibilityExpressionExecutor?.lastEvaluatedValue))return null!==this._storedValue&&this.set("_storedValue",null),null;if(this._shouldUseValueExpression){const F=this.evaluatedValueExpression;return this.dataType===K.Date?this._arcadeOutputToDateFieldValue(F):null!=F&&"object"===typeof F?F.toString():F}return this._storedValue}set value(F){this.notifyChange("evaluatedVisibilityExpression");this.set("_storedValue",F)}get visible(){return this._isEditTrackingField?
!1:null!=this.evaluatedVisibilityExpression?this.evaluatedVisibilityExpression:null!=this.element?!0:this._isVisibleByDefault}_arcadeOutputToDateFieldValue(F){const y=this.field.type;try{if("object"===typeof F){if(null!==F){if(L.isArcadeDate(F))return L.arcadeDateToFieldValue(F,y);if("getTime"in F&&"function"===typeof F.getTime&&"date"===y)return parseInt(F.getTime(),10);if("date-only"===y||"time-only"===y||"timestamp-offset"===y)return F.toString()}}else{if("string"===typeof F)return"date"===y?parseInt(F,
10):F;if("number"===typeof F&&"date"===y)return F}throw new b("feature-form:invalid-date-value");}catch{return"date"===y?NaN:""}}_isDomainCompatible(F){const {field:y}=this;if("coded-value"===F?.type){const p=typeof F.codedValues[0].code;if("string"===p&&q.isStringField(y)||"number"===p&&q.isNumericField(y))return!0}return"range"===F?.type&&q.isNumericField(y)||r.isAnyDateField(y)||q.isTimeOnlyField(y)?!0:!1}_validate(){const {dataType:F,domain:y,field:p,initialFeature:I,minLength:R,range:D,required:E,
valid:N,value:C}=this,P=E&&null==C,H=void 0!==N;return!P&&I.getAttribute(p.name)===C&&H?null:P?q.TypeValidationError.INVALID_TYPE:"text"===F&&-1<R&&"string"===typeof C&&C.length<R?h.LengthValidationError.TOO_SHORT:"date"!==F||null==C||L.dateTimeIsInRange({type:p.type,range:D,value:C})?y?null!==C||E?l.validateDomainValue(p,C):null:q.validateFieldValue(p,C):q.NumericRangeValidationError.OUT_OF_RANGE}};a.__decorate([m.property()],g.prototype,"_dateFormRange",null);a.__decorate([m.property()],g.prototype,
"_dateRange",null);a.__decorate([m.property()],g.prototype,"_storedValue",void 0);a.__decorate([m.property()],g.prototype,"_configAllowsEdits",null);a.__decorate([m.property()],g.prototype,"_layerAndFieldAllowEdits",null);a.__decorate([m.property()],g.prototype,"_isVisibleByDefault",null);a.__decorate([m.property()],g.prototype,"_isEditTrackingField",null);a.__decorate([m.property()],g.prototype,"_shouldUseValueExpression",null);a.__decorate([m.property()],g.prototype,"_isSubtypeField",null);a.__decorate([m.property()],
g.prototype,"dataType",null);a.__decorate([m.property()],g.prototype,"dateDataType",null);a.__decorate([m.property()],g.prototype,"description",null);a.__decorate([m.property()],g.prototype,"domain",null);a.__decorate([m.property()],g.prototype,"editable",null);a.__decorate([m.property({readOnly:!0})],g.prototype,"error",void 0);a.__decorate([m.property({constructOnly:!0})],g.prototype,"preservesValueWhenHidden",void 0);a.__decorate([m.property()],g.prototype,"evaluatedRequiredExpression",null);a.__decorate([m.property()],
g.prototype,"evaluatedValueExpression",null);a.__decorate([m.property()],g.prototype,"field",void 0);a.__decorate([m.property()],g.prototype,"group",void 0);a.__decorate([m.property({readOnly:!0})],g.prototype,"hint",null);a.__decorate([m.property()],g.prototype,"includeDate",null);a.__decorate([m.property()],g.prototype,"includeTime",null);a.__decorate([m.property()],g.prototype,"includeTimeOffset",null);a.__decorate([m.property()],g.prototype,"initialFeature",null);a.__decorate([m.property({readOnly:!0})],
g.prototype,"inputType",null);a.__decorate([m.property()],g.prototype,"hasInvalidSwitchValue",null);a.__decorate([m.property()],g.prototype,"isRelationshipKeyField",null);a.__decorate([m.property()],g.prototype,"label",null);a.__decorate([m.property()],g.prototype,"maxLength",null);a.__decorate([m.property()],g.prototype,"minLength",null);a.__decorate([m.property({readOnly:!0})],g.prototype,"name",null);a.__decorate([m.property()],g.prototype,"range",null);a.__decorate([m.property()],g.prototype,
"required",null);a.__decorate([m.property()],g.prototype,"requiredExpressionExecutor",void 0);a.__decorate([m.property()],g.prototype,"showNoValueOptionEnabled",null);a.__decorate([m.property()],g.prototype,"submittable",null);a.__decorate([m.property()],g.prototype,"timeResolution",null);a.__decorate([m.property()],g.prototype,"timeStep",null);a.__decorate([m.property({readOnly:!0})],g.prototype,"type",void 0);a.__decorate([m.property()],g.prototype,"updating",null);a.__decorate([m.property()],g.prototype,
"valid",null);a.__decorate([m.property({value:null})],g.prototype,"value",null);a.__decorate([m.property()],g.prototype,"valueExpressionExecutor",void 0);a.__decorate([m.property()],g.prototype,"visible",null);return g=a.__decorate([B.subclass("esri.widgets.FeatureForm.FieldInput")],g)})},"esri/widgets/FeatureForm/EditableInput":function(){define("../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../layers/support/layerUtils ./featureFormUtils ./InputBase".split(" "),
function(a,b,d,m,g,x,n,B,M){d=class extends M{constructor(k){super(k);this.arcadeEditType="NA";this.editableExpressionExecutor=null}get editable(){return this.layerAllowsEdits?this.evaluatedEditableExpression??!0:!1}get evaluatedEditableExpression(){const {editableExpressionExecutor:k}=this;return null!=k?!!k.lastEvaluatedValue:null}get layerAllowsEdits(){var {layer:k}=this;if(!k)return!1;var w=n.getEffectiveLayerCapabilities(k);k=w?.operations.supportsEditing;w=B.capabilitiesAllowEditType(w,this.arcadeEditType);
return!(!k||!w)}};a.__decorate([b.property()],d.prototype,"arcadeEditType",void 0);a.__decorate([b.property()],d.prototype,"editable",null);a.__decorate([b.property()],d.prototype,"editableExpressionExecutor",void 0);a.__decorate([b.property()],d.prototype,"evaluatedEditableExpression",null);a.__decorate([b.property()],d.prototype,"layerAllowsEdits",null);return d=a.__decorate([x.subclass("esri.widgets.FeatureForm.EditableInput")],d)})},"esri/widgets/FeatureForm/InputBase":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,d,m,g,x,n){b=class extends b{constructor(B){super(B);this.visibilityExpressionExecutor=this.type=this.timeZone=this.layer=this.feature=this.element=null}get description(){return this.element?.description}get evaluatedVisibilityExpression(){const {visibilityExpressionExecutor:B}=this;return null!=B?!!B.lastEvaluatedValue:null}get label(){return this.element?.label}get visible(){return null!=this.evaluatedVisibilityExpression?this.evaluatedVisibilityExpression:null!=this.element}};a.__decorate([d.property({readOnly:!0})],
b.prototype,"description",null);a.__decorate([d.property({constructOnly:!0})],b.prototype,"element",void 0);a.__decorate([d.property()],b.prototype,"evaluatedVisibilityExpression",null);a.__decorate([d.property()],b.prototype,"feature",void 0);a.__decorate([d.property()],b.prototype,"label",null);a.__decorate([d.property()],b.prototype,"layer",void 0);a.__decorate([d.property()],b.prototype,"timeZone",void 0);a.__decorate([d.property()],b.prototype,"type",void 0);a.__decorate([d.property()],b.prototype,
"visible",null);a.__decorate([d.property()],b.prototype,"visibilityExpressionExecutor",void 0);return b=a.__decorate([n.subclass("esri.widgets.FeatureForm.InputBase")],b)})},"esri/widgets/FeatureForm/FormExpressionArcadeExecutor":function(){define("exports ../../chunks/tslib.es6 ../../arcade ../../core/Accessor ../../core/promiseUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../core/support/UpdatingHandles ../../layers/support/fieldUtils".split(" "),
function(a,b,d,m,g,x,n,B,M,k,w,e){n=Symbol("FormExpressionArcadeExecutor");a.FormExpressionArcadeExecutor=class extends m{constructor(l){super(l);this[f]=!0;this._lastEvaluatedValue=null;this._abortController=new AbortController;this._stale=!1;this._updatingTracking=new w.UpdatingHandles;this._executeAsyncDebounced=g.debounce(async(q,r,c)=>{q=await this.executor.executeAsync(q,{...r,abortSignal:c});if(c.aborted)return this._lastEvaluatedValue;this._lastEvaluatedValue=q;this._stale=!1;return q})}get isAsync(){return this.executor.isAsync}get fieldsUsed(){return this.executor.fieldsUsed}get syntaxTree(){return this.executor.syntaxTree}get updating(){return this._updatingTracking.updating}get stale(){return this._stale}get geometryUsed(){return this.executor.geometryUsed}get variablesUsed(){return this.executor.variablesUsed}get lastEvaluatedValue(){return this._lastEvaluatedValue}abort(){this._abortController.abort()}execute(l,
q){this._abortController=new AbortController;return this._lastEvaluatedValue=l=this.executor.execute(l,{...q,abortSignal:this._abortController.signal})}async executeAsync(l,q){this._abortController=new AbortController;return this._updatingTracking.addPromise(this._executeAsyncDebounced(l,q??{},this._abortController.signal))}markStale(){this._stale=!0}reset(){this.abort();this._lastEvaluatedValue=null;this._stale=!1}};var f=n;b.__decorate([x.property()],a.FormExpressionArcadeExecutor.prototype,"_lastEvaluatedValue",
void 0);b.__decorate([x.property()],a.FormExpressionArcadeExecutor.prototype,"_stale",void 0);b.__decorate([x.property()],a.FormExpressionArcadeExecutor.prototype,"_updatingTracking",void 0);b.__decorate([x.property({constructOnly:!0})],a.FormExpressionArcadeExecutor.prototype,"executor",void 0);b.__decorate([x.property()],a.FormExpressionArcadeExecutor.prototype,"isAsync",null);b.__decorate([x.property()],a.FormExpressionArcadeExecutor.prototype,"fieldsUsed",null);b.__decorate([x.property()],a.FormExpressionArcadeExecutor.prototype,
"syntaxTree",null);b.__decorate([x.property()],a.FormExpressionArcadeExecutor.prototype,"updating",null);b.__decorate([x.property()],a.FormExpressionArcadeExecutor.prototype,"stale",null);b.__decorate([x.property()],a.FormExpressionArcadeExecutor.prototype,"geometryUsed",null);b.__decorate([x.property()],a.FormExpressionArcadeExecutor.prototype,"variablesUsed",null);b.__decorate([x.property()],a.FormExpressionArcadeExecutor.prototype,"lastEvaluatedValue",null);a.FormExpressionArcadeExecutor=b.__decorate([k.subclass("esri.widgets.FeatureForm.FormExpressionArcadeExecutor")],
a.FormExpressionArcadeExecutor);a.createFormExpressionArcadeExecutor=async(l,q)=>{const r=d.createArcadeProfile("form-calculation");l=await d.createArcadeExecutor(l,r,{});q?.fieldsIndex&&(l.fieldsUsed=e.fixFields(q.fieldsIndex,l.fieldsUsed));return new a.FormExpressionArcadeExecutor({executor:l})};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/arcade":function(){define("exports ./Graphic ./arcade/ArcadeDate ./arcade/ImmutableArray ./core/Error ./core/lang ./core/sql/DateOnly ./core/sql/TimeOnly ./layers/FeatureLayer ./portal/Portal ./rest/support/FeatureSet ./support/arcadeOnDemand".split(" "),
function(a,b,d,m,g,x,n,B,M,k,w,e){function f(p,I,R,D={}){I=I.elementType;const E="array"===I.type?[{name:"value",type:I.type,elementType:I.elementType}]:"dictionary"===I.type?[{name:"value",type:I.type,properties:I.properties}]:[{name:"value",type:I.type}];return new m(p.map(N=>{const C={};c(C,E,{value:N},R,D);return C.value}))}function l(p,I,R={}){p=p instanceof w?new M({source:p.features,geometryType:p.geometryType,fields:p.fields,spatialReference:p.spatialReference}):p;return I.constructFeatureSet(p,
R.spatialReference,null,!0,R.lruCache,R.interceptor)}function q(p,I,R={}){const {spatialReference:D,interceptor:E,lruCache:N}=R;return"string"===typeof p?I.createFeatureSetCollectionFromService(p,D,N,E):I.createFeatureSetCollectionFromMap(p,D,N,E)}function r(p,I,R,D={}){const E={};c(E,I.properties,p,R,D);return new L.Dictionary(E)}function c(p,I,R,D,E={}){const N={};for(const C of Object.keys(R))N[C.toLowerCase()]=R[C];for(const C of I)if(I=C.name.toLowerCase(),E.variablesPreProcessed)p[I]=N[I];else switch(C.type){case "array":R=
N[I];p[I]=null==R?null:f(R,C,D,E);break;case "feature":R=N[I];p[I]=null==R?null:L.Feature.createFromGraphic(R,E?.timeZone);break;case "featureSet":R=N[I];p[I]=null==R?null:D?l(R,D,E):null;break;case "featureSetCollection":R=N[I];p[I]=null==R?null:D?q(R,D,E):null;break;case "dictionary":R=N[I];p[I]=null==R?null:r(R,C,D,E);break;case "date":R=N[I];p[I]=R?R instanceof d.ArcadeDate?R:E?.timeZone?d.ArcadeDate.dateJSAndZoneToArcadeDate(R,E?.timeZone):d.ArcadeDate.dateJSToArcadeDate(R):null;break;case "dateOnly":R=
N[I];p[I]=R?R instanceof n.DateOnly?R:n.DateOnly.fromReader(R):null;break;case "time":R=N[I];p[I]=R?R instanceof B.TimeOnly?R:B.TimeOnly.fromReader(R):null;break;case "geometry":case "boolean":case "text":case "number":p[I]=N[I]}}function t(p,I){for(const R of p)I.push(R),"dictionary"===R.type&&t(R.properties,I);return I}function h(p,I,R,D,E){const {spatialReference:N,interceptor:C,lruCache:P,console:H,abortSignal:J,timeZone:z,services:A={portal:k.getDefault()}}=R;E={vars:{},spatialReference:N,interceptor:C,
timeZone:z,lrucache:P,useAsync:E,services:A,console:H,abortSignal:J};if(!I)return E;c(E.vars,p.variables,I,D,R);return E}function u(p,I){switch(I.getArcadeType(p)){case "date":return p.toJSDate();case "time":return p.toString();case "dateOnly":return p.toString();case "feature":var R="geometry"in p?p.geometry():null;p="readAttributes"in p?p.readAttributes():p.attributes;return new b({geometry:R,attributes:p});case "dictionary":R=p.attributes;const D={};for(const E of Object.keys(R))D[E]=u(p.field(E),
I);return D;case "array":return("toArray"in p?p.toArray():p).map(E=>u(E,I))}return p}let L=null;const K={variables:[{name:"$feature",type:"feature"},{name:"$layer",type:"featureSet"},{name:"$datastore",type:"featureSetCollection"},{name:"$map",type:"featureSetCollection"}]},F={variables:[{name:"$feature",type:"feature"},{name:"$aggregatedFeatures",type:"featureSet"}]},y=new Map([["form-constraint",{variables:[{name:"$feature",type:"feature"}]}],["feature-z",{variables:[{name:"$feature",type:"feature"}]}],
["field-calculation",{variables:[{name:"$feature",type:"feature"},{name:"$datastore",type:"featureSetCollection"}]}],["form-calculation",{variables:[{name:"$feature",type:"feature"},{name:"$originalFeature",type:"feature"},{name:"$layer",type:"featureSet"},{name:"$featureSet",type:"featureSet"},{name:"$datastore",type:"featureSetCollection"},{name:"$map",type:"featureSetCollection"},{name:"$editContext",type:"dictionary",properties:[{name:"editType",type:"text"}]}]}],["labeling",{variables:[{name:"$feature",
type:"feature"}]}],["popup",K],["popup-element",K],["feature-reduction-popup",F],["feature-reduction-popup-element",F],["visualization",{variables:[{name:"$feature",type:"feature"},{name:"$view",type:"dictionary",properties:[{name:"scale",type:"number"}]}]}]]);a.createArcadeExecutor=async function(p,I,R={}){L||(L=await e.loadArcade());const {arcade:D,arcadeUtils:E}=L,{loadScriptDependencies:N,referencesMember:C,scriptIsAsync:P}=D;var H=t(I.variables,[]),J=H.filter(X=>"featureSet"===X.type||"featureSetCollection"===
X.type).map(X=>X.name.toLowerCase());const z=D.parseScript(p,J);if(!z)throw new g("arcade:invalid-script","Unable to create SyntaxTree");p=E.extractFieldNames(z);const A=D.scriptTouchesGeometry(z);H=H.map(X=>X.name.toLowerCase()).filter(X=>C(z,X));const v=P(z,J);await N(z,v,J);J={vars:{},spatialReference:null,useAsync:v};for(const X of H)J.vars[X]="any";const {lruCache:G}=R,O=D.compileScript(z,J),U=D.featureSetUtils(),{services:ca}=R;return{execute:(X,da={})=>{if(v)throw new g("arcade:invalid-execution-mode",
"Cannot execute the script in synchronous mode");X=O(h(I,X,{lruCache:G,...da},U,v));return da.rawOutput?X:u(X,E)},executeAsync:async(X,da={})=>{X=await O(h(I,X,{lruCache:G,services:ca,...da},U,v));return da.rawOutput?X:u(X,E)},isAsync:v,variablesUsed:H,fieldsUsed:p,geometryUsed:A,syntaxTree:z}};a.createArcadeProfile=function(p){var I=y.get(p);if(!I)throw I=Array.from(y.keys()).map(R=>`'${R}'`).join(", "),new g("createArcadeProfile:invalid-profile-name",`Invalid profile name '${p}'. You must specify one of the following values: ${I}`);
return x.clone(I)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/ArcadeDate":function(){define(["exports","../core/string","../core/sql/UnknownTimeZone","../chunks/datetime"],function(a,b,d,m){function g(k,w,e){return k<w?k-w:k>e?k-e:0}function x(k,w=!0){if(k instanceof m.Zone)return k;if("system"===k.toLowerCase())return"system";if("utc"===k.toLowerCase())return"UTC";if("unknown"===k.toLowerCase())return d.UnknownTimeZone.instance;if(/^[\+\-]?[0-9]{1,2}([:][0-9]{2})?$/.test(k)){const e=
m.FixedOffsetZone.parseSpecifier("UTC"+(k.startsWith("+")||k.startsWith("-")?"":"+")+k);if(e)return e}k=m.IANAZone.create(k);if(!k.isValid){if(w)throw new B(a.ArcadeDateErrorCodes.TimeZoneNotRecognized);return null}return k}a.ArcadeDateErrorCodes=void 0;(a.ArcadeDateErrorCodes||(a.ArcadeDateErrorCodes={})).TimeZoneNotRecognized="TimeZoneNotRecognized";const n={[a.ArcadeDateErrorCodes.TimeZoneNotRecognized]:"Timezone identifier has not been recognized."};class B extends Error{constructor(k,w){super(b.replace(n[k],
w));this.declaredRootClass="esri.arcade.arcadedate.dateerror";Error.captureStackTrace&&Error.captureStackTrace(this,B)}}class M{constructor(k){this._date=k;this.declaredRootClass="esri.arcade.arcadedate"}static fromParts(k=0,w=1,e=1,f=0,l=0,q=0,r=0,c){if(isNaN(k)||isNaN(w)||isNaN(e)||isNaN(f)||isNaN(l)||isNaN(q)||isNaN(r))return null;const t=m.DateTime.local(k,w).daysInMonth;k=m.DateTime.fromObject({day:1>e?1:e>t?t:e,year:k,month:1>w?1:12<w?12:w,hour:0>f?0:23<f?23:f,minute:0>l?0:59<l?59:l,second:0>
q?0:59<q?59:q,millisecond:0>r?0:999<r?999:r},{zone:x(c)});k=k.plus({months:g(w,1,12),days:g(e,1,t),hours:g(f,0,23),minutes:g(l,0,59),seconds:g(q,0,59),milliseconds:g(r,0,999)});return new M(k)}static get systemTimeZoneCanonicalName(){return Intl.DateTimeFormat().resolvedOptions().timeZone??"system"}static arcadeDateAndZoneToArcadeDate(k,w){w=x(w);return k.isUnknownTimeZone||w===d.UnknownTimeZone.instance?M.fromParts(k.year,k.monthJS+1,k.day,k.hour,k.minute,k.second,k.millisecond,w):new M(k._date.setZone(w))}static dateJSToArcadeDate(k){return new M(m.DateTime.fromJSDate(k,
{zone:"system"}))}static dateJSAndZoneToArcadeDate(k,w="system"){w=x(w);return new M(m.DateTime.fromJSDate(k,{zone:w}))}static unknownEpochToArcadeDate(k){return new M(m.DateTime.fromMillis(k,{zone:d.UnknownTimeZone.instance}))}static unknownDateJSToArcadeDate(k){return new M(m.DateTime.fromMillis(k.getTime(),{zone:d.UnknownTimeZone.instance}))}static epochToArcadeDate(k,w="system"){w=x(w);return new M(m.DateTime.fromMillis(k,{zone:w}))}static dateTimeToArcadeDate(k){return new M(k)}clone(){return new M(this._date)}changeTimeZone(k){k=
x(k);return M.dateTimeToArcadeDate(this._date.setZone(k))}static dateTimeAndZoneToArcadeDate(k,w){w=x(w);return k.zone===d.UnknownTimeZone.instance||w===d.UnknownTimeZone.instance?M.fromParts(k.year,k.month,k.day,k.hour,k.minute,k.second,k.millisecond,w):new M(k.setZone(w))}static nowToArcadeDate(k){k=x(k);return new M(m.DateTime.fromJSDate(new Date,{zone:k}))}static nowUTCToArcadeDate(){return new M(m.DateTime.utc())}get isSystem(){return"system"===this.timeZone||this.timeZone===M.systemTimeZoneCanonicalName}equals(k){return this.isSystem&&
k.isSystem?this.toNumber()===k.toNumber():this.isUnknownTimeZone!==k.isUnknownTimeZone?!1:this._date.equals(k._date)}get isUnknownTimeZone(){return this._date.zone===d.UnknownTimeZone.instance}get isValid(){return this._date.isValid}get hour(){return this._date.hour}get second(){return this._date.second}get day(){return this._date.day}get dayOfWeekISO(){return this._date.weekday}get dayOfWeekJS(){let k=this._date.weekday;6<k&&(k=0);return k}get millisecond(){return this._date.millisecond}get monthISO(){return this._date.month}get weekISO(){return this._date.weekNumber}get yearISO(){return this._date.weekYear}get monthJS(){return this._date.month-
1}get year(){return this._date.year}get minute(){return this._date.minute}get zone(){return this._date.zone}get timeZoneOffset(){return this.isUnknownTimeZone?0:this._date.offset}get timeZone(){if(this.isUnknownTimeZone)return"unknown";if("system"===this._date.zone.type)return"system";const k=this.zone;return"fixed"===k.type?0===k.fixed?"UTC":k.formatOffset(0,"short"):k.name}stringify(){return JSON.stringify(this.toJSDate())}plus(k){return new M(this._date.plus(k))}diff(k,w="milliseconds"){return this._date.diff(k._date,
w)[w]}toISODate(){return this._date.toISODate()}toISOString(k){return k?this._date.toISO({suppressMilliseconds:!0,includeOffset:!this.isUnknownTimeZone}):this._date.toISO({includeOffset:!this.isUnknownTimeZone})}toISOTime(k,w){return this._date.toISOTime({suppressMilliseconds:k,includeOffset:w&&!this.isUnknownTimeZone})}toFormat(k,w){this.isUnknownTimeZone&&(k=k.replaceAll("Z",""));return this._date.toFormat(k,w)}toJSDate(){return this._date.toJSDate()}toSQLValue(){return this._date.toFormat("yyyy-LL-dd HH:mm:ss")}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}toDateTime(){return this._date}toNumber(){return this._date.toMillis()}getTime(){return this._date.toMillis()}toUTC(){return new M(this._date.toUTC())}toLocal(){return new M(this._date.toLocal())}toString(){return this.toISOString(!0)}static fromReaderAsTimeStampOffset(k){if(!k)return null;
k=m.DateTime.fromISO(k,{setZone:!0});return new M(k)}}a.ArcadeDate=M;a.ArcadeDateError=B;a.ArcadeDateErrorMessages=n;a.createDateTimeZone=x;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/ImmutableArray":function(){define(function(){class a{constructor(b=[]){this._elements=b}length(){return this._elements.length}get(b){return this._elements[b]}toArray(){const b=[];for(let d=0;d<this.length();d++)b.push(this.get(d));return b}}return a})},"esri/core/sql/DateOnly":function(){define(["exports",
"../../arcade/ArcadeDate","../../intl/locale","../../chunks/datetime"],function(a,b,d,m){function g(n){n=n.replaceAll(/LTS|LT|LL?L?L?|l{1,4}/g,"[$\x26]");let B="";const M=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;for(const k of n.match(M)||[])switch(k){case "D":B+="d";break;case "DD":B+="dd";break;case "DDD":B+="o";break;case "d":B+="c";break;
case "ddd":B+="ccc";break;case "dddd":B+="cccc";break;case "M":B+="L";break;case "MM":B+="LL";break;case "MMM":B+="LLL";break;case "MMMM":B+="LLLL";break;case "YY":B+="yy";break;case "Y":case "YYYY":B+="yyyy";break;case "Q":B+="q";break;case "X":case "x":B+=k;break;default:B=2<=k.length&&"["===k.slice(0,1)&&"]"===k.slice(-1)?B+`'${k.slice(1,-1)}'`:B+`'${k}'`}return B}class x{constructor(n,B,M){this._year=n;this._month=B;this._day=M;this.declaredRootClass="esri.core.sql.dateonly"}get month(){return this._month}get monthJS(){return this._month-
1}get year(){return this._year}get day(){return this._day}get isValid(){return this.toDateTime("unknown").isValid}equals(n){return n instanceof x&&n.day===this.day&&n.month===this.month&&n.year===this.year}clone(){return new x(this._year,this._month,this._day)}toDateTime(n){return m.DateTime.fromObject({day:this.day,month:this.month,year:this.year},{zone:b.createDateTimeZone(n)})}toDateTimeLuxon(n){return m.DateTime.fromObject({day:this.day,month:this.month,year:this.year},{zone:b.createDateTimeZone(n)})}toString(){return`${this.year.toString().padStart(4,
"0")}-${this.month.toString().padStart(2,"0")}-${this.day.toString().padStart(2,"0")}`}toFormat(n=null){if(null===n||""===n)return this.toString();n=g(n);if(!n)return"";const B=this.toDateTime("unknown");return b.ArcadeDate.dateTimeToArcadeDate(B).toFormat(n,{locale:d.getLocale(),numberingSystem:"latn"})}toArcadeDate(){const n=this.toDateTime("unknown");return b.ArcadeDate.dateTimeToArcadeDate(n)}toNumber(){return this.toDateTime("unknown").toMillis()}toJSDate(){return this.toDateTime("unknown").toJSDate()}toStorageFormat(){return this.toFormat("yyyy-LL-dd")}toSQLValue(){return this.toFormat("yyyy-LL-dd")}toSQLWithKeyword(){return"date '"+
this.toFormat("yyyy-LL-dd")+"'"}plus(n,B){return x.fromDateTime(this.toUTCDateTime().plus({[n]:B}))}toUTCDateTime(){return m.DateTime.utc(this.year,this.month,this.day,0,0,0,0)}difference(n,B){switch(B.toLowerCase()){case "days":case "day":case "d":return this.toUTCDateTime().diff(n.toUTCDateTime(),"days").days;case "months":case "month":return this.toUTCDateTime().diff(n.toUTCDateTime(),"months").months;case "minutes":case "minute":case "m":return"M"===B?this.toUTCDateTime().diff(n.toUTCDateTime(),
"months").months:this.toUTCDateTime().diff(n.toUTCDateTime(),"minutes").minutes;case "seconds":case "second":case "s":return this.toUTCDateTime().diff(n.toUTCDateTime(),"seconds").seconds;case "milliseconds":case "millisecond":case "ms":return this.toUTCDateTime().diff(n.toUTCDateTime(),"milliseconds").milliseconds;case "hours":case "hour":case "h":return this.toUTCDateTime().diff(n.toUTCDateTime(),"hours").hours;case "years":case "year":case "y":return this.toUTCDateTime().diff(n.toUTCDateTime(),
"years").years;default:return this.toUTCDateTime().diff(n.toUTCDateTime(),"milliseconds").milliseconds}}static fromMilliseconds(n){n=m.DateTime.fromMillis(n,{zone:m.FixedOffsetZone.utcInstance});return n.isValid?x.fromParts(n.year,n.month,n.day):null}static fromSeconds(n){n=m.DateTime.fromSeconds(n,{zone:m.FixedOffsetZone.utcInstance});return n.isValid?x.fromParts(n.year,n.month,n.day):null}static fromReader(n){if(!n)return null;n=n.split("-");return 3!==n.length?null:new x(parseInt(n[0],10),parseInt(n[1],
10),parseInt(n[2],10))}static fromParts(n,B,M){n=new x(n,B,M);return!1===n.isValid?null:n}static fromDateJS(n){return x.fromParts(n.getFullYear(),n.getMonth()+1,n.getDay())}static fromDateTime(n){return x.fromParts(n.year,n.month,n.day)}static fromSqlTimeStampOffset(n){return this.fromDateTime(n.toDateTime())}static fromString(n,B=null){if(""===n||null===n)return null;var M=[];if(B)(B=g(B))&&M.push(B);else if(null===B||""===B)return n=m.DateTime.fromISO(n,{setZone:!0}),n.isValid?x.fromParts(n.year,
n.month,n.day):null;for(const k of M)if(M=m.DateTime.fromFormat(n,B??k),M.isValid)return new x(M.year,M.month,M.day);return null}static fromNow(n="system"){n=m.DateTime.fromJSDate(new Date).setZone(b.createDateTimeZone(n));return new x(n.year,n.month,n.day)}}a.DateOnly=x;a.standardiseDateOnlyFormat=g;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/TimeOnly":function(){define(["exports","../../arcade/kernel","../../intl/locale","../../chunks/datetime"],function(a,b,d,
m){function g(n){if(!n)return"";const B=/(a|A|hh?|HH?|mm?|ss?|SSS|S|.)/g;let M="";for(const k of n.match(B)||[])switch(k){case "SSS":M+=k;break;case "A":case "a":M+="a";break;case "m":case "mm":case "h":case "hh":case "H":case "HH":case "s":case "ss":M+=k;break;default:M+=`'${k}'`}return M}class x{constructor(n,B,M,k){this._hour=n;this._minute=B;this._second=M;this._millisecond=k;this.declaredRootClass="esri.core.sql.timeonly"}get hour(){return this._hour}get minute(){return this._minute}get second(){return this._second}get millisecond(){return this._millisecond}equals(n){return n instanceof
x&&n.hour===this.hour&&n.minute===this.minute&&n.second===this.second&&n.millisecond===this.millisecond}clone(){return new x(this.hour,this.minute,this.second,this.millisecond)}isValid(){return b.isInteger(this.hour)&&b.isInteger(this.minute)&&b.isInteger(this.second)&&b.isInteger(this.millisecond)&&0<=this.hour&&24>this.hour&&0<=this.minute&&60>this.minute&&0<=this.second&&60>this.second&&0<=this.millisecond&&1E3>this.millisecond}toString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,
"0")}:${this.second.toString().padStart(2,"0")}`+(0<this.millisecond?"."+this.millisecond.toString().padStart(3,"0"):"")}toSQLValue(){return this.toString()}toSQLWithKeyword(){return`time '${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}${0<this.millisecond?"."+this.millisecond.toString().padStart(3,"0"):""}'`}toStorageString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,
"0")}`}toFormat(n=null){return null===n||""===n?this.toString():(n=g(n))?m.DateTime.local(1970,1,1,this._hour,this._minute,this._second,this._millisecond).toFormat(n,{locale:d.getLocale(),numberingSystem:"latn"}):""}toNumber(){return this.millisecond+1E3*this.second+6E4*this.minute+36E5*this.hour}static fromParts(n,B,M,k){n=new x(n,B,M,k);return n.isValid()?n:null}static fromReader(n){if(!n)return null;n=n.split(":");return 3!==n.length?null:new x(parseInt(n[0],10),parseInt(n[1],10),parseInt(n[2],
10),0)}static fromMilliseconds(n){return 864E5<n||0>n?null:new x(Math.floor(n/36E5%24),Math.floor(n/6E4%60),Math.floor(n/1E3%60),Math.floor(n%1E3))}static fromDateJS(n){return new x(n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds())}static fromDateTime(n){return new x(n.hour,n.minute,n.second,n.millisecond)}static fromSqlTimeStampOffset(n){return this.fromDateTime(n.toDateTime())}static fromString(n,B=null){if(""===n||null===n)return null;const M=[];if(B)(B=g(B))&&M.push(B);else if(null===
B||""===B)M.push("HH:mm:ss"),M.push("HH:mm:ss.SSS"),M.push("hh:mm:ss a"),M.push("hh:mm:ss.SSS a"),M.push("HH:mm"),M.push("hh:mm a"),M.push("H:mm"),M.push("h:mm a"),M.push("H:mm:ss"),M.push("h:mm:ss a"),M.push("H:mm:ss.SSS"),M.push("h:mm:ss.SSS a");for(const k of M)if(B=m.DateTime.fromFormat(n,k),B.isValid)return new x(B.hour,B.minute,B.second,B.millisecond);return null}plus(n,B){switch(n){case "days":case "years":case "months":return this.clone();case "hours":case "minutes":case "seconds":case "milliseconds":return x.fromDateTime(this.toUTCDateTime().plus({[n]:B}))}return null}toUTCDateTime(){return m.DateTime.utc(1970,
1,1,this.hour,this.minute,this.second,this.millisecond)}difference(n,B){switch(B.toLowerCase()){case "days":case "day":case "d":return this.toUTCDateTime().diff(n.toUTCDateTime(),"days").days;case "months":case "month":return this.toUTCDateTime().diff(n.toUTCDateTime(),"months").months;case "minutes":case "minute":case "m":return"M"===B?this.toUTCDateTime().diff(n.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(n.toUTCDateTime(),"minutes").minutes;case "seconds":case "second":case "s":return this.toUTCDateTime().diff(n.toUTCDateTime(),
"seconds").seconds;case "milliseconds":case "millisecond":case "ms":return this.toUTCDateTime().diff(n.toUTCDateTime(),"milliseconds").milliseconds;case "hours":case "hour":case "h":return this.toUTCDateTime().diff(n.toUTCDateTime(),"hours").hours;case "years":case "year":case "y":return this.toUTCDateTime().diff(n.toUTCDateTime(),"years").years;default:return this.toUTCDateTime().diff(n.toUTCDateTime(),"milliseconds").milliseconds}}}a.TimeOnly=x;a.standardiseTimeFormat=g;Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/arcade/kernel":function(){define(["exports","../geometry/Extent"],function(a,b){a.cloneGeometry=function(d){if(null==d)return null;const m=d.clone();void 0!==d.cache._geVersion&&(m.cache._geVersion=d.cache._geVersion);return m};a.convertLinearUnitsToCode=function(d){if(null==d)return null;if("number"===typeof d)return d;d=d.toLowerCase();d=d.replaceAll(/\s/g,"");d=d.replaceAll("-","");switch(d){case "meters":case "meter":case "m":case "squaremeters":case "squaremeter":return 9001;
case "miles":case "mile":case "squaremile":case "squaremiles":return 9093;case "kilometers":case "kilometer":case "squarekilometers":case "squarekilometer":case "km":return 9036;case "yard":case "yd":case "yards":case "squareyards":case "squareyard":return 9096;case "feet":case "ft":case "foot":case "squarefeet":case "squarefoot":return 9002;case "nmi":case "nauticalmile":case "nauticalmiles":case "squarenauticalmile":case "squarenauticalmiles":return 9030}return null};a.convertSquareUnitsToCode=
function(d){if(null==d)return null;if("number"===typeof d)return d;d=d.toLowerCase();d=d.replaceAll(/\s/g,"");d=d.replaceAll("-","");switch(d){case "meters":case "meter":case "m":case "squaremeters":case "squaremeter":return 109404;case "miles":case "mile":case "squaremile":case "squaremiles":return 109439;case "kilometers":case "kilometer":case "squarekilometers":case "squarekilometer":case "km":return 109414;case "acres":case "acre":case "ac":return 109402;case "hectares":case "hectare":case "ha":return 109401;
case "yard":case "yd":case "yards":case "squareyards":case "squareyard":return 109442;case "feet":case "ft":case "foot":case "squarefeet":case "squarefoot":return 109405;case "nmi":case "nauticalmile":case "nauticalmiles":case "squarenauticalmile":case "squarenauticalmiles":return 109409}return null};a.isInteger=function(d){return"number"===typeof d&&isFinite(d)&&Math.floor(d)===d};a.sameGeomType=function(d,m){return d===m||"point"===d&&"esriGeometryPoint"===m||"polyline"===d&&"esriGeometryPolyline"===
m||"polygon"===d&&"esriGeometryPolygon"===m||"extent"===d&&"esriGeometryEnvelope"===m||"multipoint"===d&&"esriGeometryMultipoint"===m||"point"===m&&"esriGeometryPoint"===d||"polyline"===m&&"esriGeometryPolyline"===d||"polygon"===m&&"esriGeometryPolygon"===d||"extent"===m&&"esriGeometryEnvelope"===d||"multipoint"===m&&"esriGeometryMultipoint"===d?!0:!1};a.shapeExtent=function(d){if(null==d)return null;switch(d.type){case "polygon":case "multipoint":case "polyline":return d.extent;case "point":return new b({xmin:d.x,
ymin:d.y,xmax:d.x,ymax:d.y,spatialReference:d.spatialReference});case "extent":return d}return null};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/FeatureForm/FormExpressionsManager":function(){define("exports ../../chunks/tslib.es6 ../../core/Accessor ../../core/MapUtils ../../core/promiseUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,d,m,g,x,n,B,M,k){a.FormExpressionsManager=class extends d{constructor(f){super(f);this._fieldReferencesLookup=new Map;this._fieldsAffectedLookup=new Map;this.preserveFieldValuesWhenHidden=!0;this._latestFieldValues={...f.feature.attributes}}initialize(){this._dependencyGraph=this._buildDependencyGraph()}destroy(){this.resetExecutors()}get _baseContext(){const {editType:f,layer:l,map:q,originalFeature:r,spatialReference:c,timeZone:t}=this.arcadeContextInfo,h="feature"===l?.type?l:"scene"===
l?.type&&null!=l.associatedLayer?l.associatedLayer:void 0;return[{$originalfeature:r,$editcontext:{editType:f},$layer:h,$featureset:h,$datastore:l?.url,$map:q},{rawOutput:!0,spatialReference:c??void 0,timeZone:t}]}set feature(f){this._latestFieldValues={...f?.attributes};this._set("feature",f)}evaluateAll(){return this._evaluate(this.executors)}evaluateExpressions(f){return this._evaluate(f)}evaluateInvalidated(f){const {_fieldReferencesLookup:l,_latestFieldValues:q,feature:r}=this,c=new Set;for(const t of f)if(q[t]=
r.getAttribute(t),l.has(t))for(const h of l.get(t))c.add(h);return this._evaluate([...c])}async evaluateInvalidatedByGeometry(){if(this._fieldReferencesLookup.has("#JSAPI_FORM_EXPRESSIONS_MANAGER_GEOMETRY"))return this._evaluate([...this._fieldReferencesLookup.get("#JSAPI_FORM_EXPRESSIONS_MANAGER_GEOMETRY")])}resetExecutors(){for(const f of this.executors)f.reset()}_buildDependencyGraph(){const {_fieldReferencesLookup:f,_fieldsAffectedLookup:l,executors:q,preserveFieldValuesWhenHidden:r}=this,c=new Map(this.fieldInputs.map(u=>
[u.name,u])),t=!1===r,h=new Map(q.map(u=>[u,[]]));for(const u of q){for(const L of u.fieldsUsed){m.getOrCreateMapValue(f,L,()=>new Set).add(u);const K=c.get(L);[K?.valueExpressionExecutor,K?.editableExpressionExecutor,t?K?.group?.visibilityExpressionExecutor:null,t?K?.visibilityExpressionExecutor:null].filter(F=>null!=F&&F!==u).forEach(F=>{h.get(F).push(u);m.getOrCreateMapValue(l,F,()=>new Set).add(K)})}u.geometryUsed&&m.getOrCreateMapValue(f,"#JSAPI_FORM_EXPRESSIONS_MANAGER_GEOMETRY",()=>new Set).add(u)}return h}async _evaluate(f){const l=
new Map,{_dependencyGraph:q,_fieldsAffectedLookup:r,_latestFieldValues:c}=this;for(const t of f)w(t,l,q);for(const [t,{resolver:h,dependencyPromises:u}]of l)Promise.all(u).then(async()=>{const [L,K]=this._makeContext(c);return t.executeAsync(L,K)}).then(()=>{if(r.has(t))for(const L of r.get(t))this._latestFieldValues[L.name]=L.value;h.resolve()},L=>{!L||g.isAbortError(L)||e(L)||t.markStale();h.reject(L)});f=(await Promise.allSettled(Array.from(l.values(),({resolver:t})=>t.promise))).filter(t=>"rejected"===
t.status&&!(g.isAbortError(t.reason)||e(t.reason)));if(0<f.length)throw new AggregateError(f,"One or more expression executions failed");}_makeContext(f){const [l,q]=this._baseContext,r=this.feature.clone();r.attributes=f;return[{...l,$feature:r},q]}};b.__decorate([x.property()],a.FormExpressionsManager.prototype,"_baseContext",null);b.__decorate([x.property()],a.FormExpressionsManager.prototype,"feature",null);b.__decorate([x.property({constructOnly:!0})],a.FormExpressionsManager.prototype,"preserveFieldValuesWhenHidden",
void 0);b.__decorate([x.property()],a.FormExpressionsManager.prototype,"executors",void 0);b.__decorate([x.property()],a.FormExpressionsManager.prototype,"fieldInputs",void 0);b.__decorate([x.property()],a.FormExpressionsManager.prototype,"arcadeContextInfo",void 0);a.FormExpressionsManager=b.__decorate([k.subclass("esri.widgets.FeatureForm.FormExpressionsManager")],a.FormExpressionsManager);const w=(f,l,q)=>{if(!l.has(f)){var r=g.createResolver();l.set(f,{resolver:r,dependencyPromises:[]});f.abort();
f=q.get(f);for(const c of f)w(c,l,q),l.get(c).dependencyPromises.push(r.promise)}},e=f=>f&&"object"===typeof f&&"message"in f&&"Cancelled"===f.message;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/FeatureForm/GroupInput":function(){define("../../chunks/tslib.es6 ../../core/deprecate ../../core/Logger ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ./featureFormUtils ./InputBase".split(" "),
function(a,b,d,m,g,x,n,B,M,k,w){x=class extends w{constructor(e){super(e);this._expressionTrackingHandles=new Map;this.type="group"}initialize(){this.addHandles([m.watch(()=>[this.visible,this.inputs],([e])=>{const {inputs:f}=this;e=e?void 0:!1;for(const l of f)k.isFieldInput(l)&&(l.required=e)},{initial:!0,equals:(e,f)=>f[0]===e[0]&&f[1]===e[1]})])}destroy(){for(const e of this._expressionTrackingHandles.values())e.remove()}get initialState(){return this.element.initialState||"expanded"}set inputFields(e){b.deprecatedProperty(d.getLogger(this),
"inputFields",{replacement:"inputs",version:"4.27",warnOnce:!0});this.inputs=e}get inputFields(){b.deprecatedProperty(d.getLogger(this),"inputFields",{replacement:"inputs",version:"4.27",warnOnce:!0});return this.inputs}get inputs(){return this._get("inputs")}set inputs(e){this.removeAllHandles();e&&this.addHandles(e.map(f=>m.watch(()=>f.visible,()=>this._dirtyEvaluatedVisibilityExpression())));this._set("inputs",e)}get label(){return this.element.label}set label(e){const {element:f}=this;f&&(f.label=
e)}get open(){return"expanded"===this.initialState}set open(e){this._override("open",e)}get state(){b.deprecatedProperty(d.getLogger(this),"state",{replacement:"open",version:"4.28",warnOnce:!0});return this.open?"expanded":"collapsed"}set state(e){b.deprecatedProperty(d.getLogger(this),"state",{replacement:"open",version:"4.28",warnOnce:!0});this.open="expanded"===e}get visible(){return!1!==this.evaluatedVisibilityExpression&&this.inputs&&this.inputs.some(e=>e.visible)}_dirtyEvaluatedVisibilityExpression(){const {element:e}=
this;e.visibilityExpression&&this.notifyChange("evaluatedVisibilityExpression")}};a.__decorate([g.property()],x.prototype,"initialState",null);a.__decorate([g.property()],x.prototype,"inputs",null);a.__decorate([g.property()],x.prototype,"label",null);a.__decorate([g.property()],x.prototype,"open",null);a.__decorate([g.property()],x.prototype,"type",void 0);a.__decorate([g.property()],x.prototype,"visible",null);return x=a.__decorate([M.subclass("esri.widgets.FeatureForm.GroupInput")],x)})},"esri/widgets/FeatureForm/RelationshipInput":function(){define("../../chunks/tslib.es6 ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../layers/support/layerUtils ../Feature/FeatureRelationship/FeatureRelationshipViewModel ../Feature/support/featureUtils ./EditableInput ./featureFormUtils".split(" "),
function(a,b,d,m,g,x,n,B,M,k,w,e){m=class extends w{constructor(f){super(f);this.group=this._relationshipVM=null;this.type="relationship";this.addHandles([b.watch(()=>({feature:this.feature,element:this.element,layer:this.layer}),l=>this._createRelationshipVM(l),b.initial)])}destroy(){this._relationshipVM?.destroy()}get canAddRelatedFeature(){const {editable:f,featureCount:l,relationship:q}=this;if(!q||!this.loaded||!this.relatedLayerAllowsAdds)return!1;const {cardinality:r,role:c}=q;return"one-to-one"===
r&&0<l||"many-to-many"===r||"one-to-many"===r&&"destination"===c&&0<l?!1:f}get displayCount(){return this.element.displayCount??3}get displayType(){return this.element.displayType}get editable(){return this.relatedLayerAllowsEdits?this.evaluatedEditableExpression??!0:!1}get featureCount(){return this._relationshipVM?.featureCount??0}get loaded(){return"loading"!==this._relationshipVM?.state}get map(){return this._get("map")}set map(f){f&&this._relationshipVM?.set("map",f);this._set("map",f)}get orderByFields(){return this.element.orderByFields}get originHasValidKey(){return!(!this.relationship||
!this.feature.getAttribute(this.relationship.keyField))}get relationship(){return this._relationshipVM?.relationship}get relationshipId(){return this.element.relationshipId}get relatedFeatureInfos(){const {_relationshipVM:f,timeZone:l}=this;if(!f?.relatedFeatures?.length||!f?.relatedLayer)return[];const {itemDescriptionFieldName:q,relatedFeatures:r,relatedLayer:c}=f,t=c&&"formTemplate"in c&&c.formTemplate?c.formTemplate.title:void 0;return r.map(h=>{let u=void 0;if(q){var L=h.getAttribute(q);const K=
c.fieldsIndex.get(q);K&&(L=e.getComputedAttributes({values:[L],fields:[K],timeZone:l??void 0})[q],null!=L&&(u=L.toString()))}L=t?e.parseFormTemplateString({label:t,attributes:h.attributes,fieldsIndex:c.fieldsIndex,timeZone:l}):void 0;return{feature:h,description:u,title:L}}).toArray()}get relatedLayer(){return this._relationshipVM?.relatedLayer}get relatedLayerIsTable(){return!!this.relatedLayer?.isTable}get relatedLayerAllowsAdds(){const {relatedLayer:f}=this;return f&&this.relatedLayerAllowsEdits?
!!B.getEffectiveLayerCapabilities(f)?.operations?.supportsAdd:!1}get relatedLayerAllowsEdits(){const {relatedLayer:f}=this;return f?!!B.getEffectiveLayerCapabilities(f)?.operations?.supportsEditing:!1}get showAllEnabled(){return this._get("showAllEnabled")}set showAllEnabled(f){this._relationshipVM?.set("showAllEnabled",f);this._set("showAllEnabled",f)}get showAllActionVisible(){return!this.showAllEnabled&&0<this.featureCount&&this.featureCount>this.displayCount}get visible(){var {relationship:f}=
this;if(!f)return!1;({cardinality:f}=f);return"many-to-many"===f?!1:null!=this.evaluatedVisibilityExpression?this.evaluatedVisibilityExpression:null!=this.element}get updating(){return"loading"===this._relationshipVM?.state||"querying"===this._relationshipVM?.state}incrementPage(){this._relationshipVM&&this._relationshipVM.featurePage++}getRelatedFeatureByObjectId(f){return this._relationshipVM?.getRelatedFeatureByObjectId(f)}_createRelationshipVM(f){const {feature:l,element:q,layer:r}=f;this._relationshipVM?.destroy();
if(l&&q&&r){var {displayCount:c,map:t,orderByFields:h,relationshipId:u,showAllEnabled:L}=this;k.isRelatableFeatureSupportedLayer(r)&&(this._relationshipVM=new M({graphic:l,displayCount:c,layer:r,map:t,orderByFields:h,relationshipId:u,showAllEnabled:L}))}}};a.__decorate([d.property()],m.prototype,"_relationshipVM",void 0);a.__decorate([d.property()],m.prototype,"canAddRelatedFeature",null);a.__decorate([d.property()],m.prototype,"displayCount",null);a.__decorate([d.property()],m.prototype,"displayType",
null);a.__decorate([d.property()],m.prototype,"editable",null);a.__decorate([d.property()],m.prototype,"featureCount",null);a.__decorate([d.property()],m.prototype,"group",void 0);a.__decorate([d.property()],m.prototype,"loaded",null);a.__decorate([d.property()],m.prototype,"map",null);a.__decorate([d.property()],m.prototype,"orderByFields",null);a.__decorate([d.property()],m.prototype,"originHasValidKey",null);a.__decorate([d.property()],m.prototype,"relationship",null);a.__decorate([d.property()],
m.prototype,"relationshipId",null);a.__decorate([d.property()],m.prototype,"relatedFeatureInfos",null);a.__decorate([d.property()],m.prototype,"relatedLayer",null);a.__decorate([d.property()],m.prototype,"relatedLayerIsTable",null);a.__decorate([d.property()],m.prototype,"relatedLayerAllowsAdds",null);a.__decorate([d.property()],m.prototype,"relatedLayerAllowsEdits",null);a.__decorate([d.property()],m.prototype,"showAllEnabled",null);a.__decorate([d.property()],m.prototype,"showAllActionVisible",
null);a.__decorate([d.property({readOnly:!0})],m.prototype,"type",void 0);a.__decorate([d.property()],m.prototype,"visible",null);a.__decorate([d.property()],m.prototype,"updating",null);return m=a.__decorate([n.subclass("esri.widgets.FeatureForm.RelationshipInput")],m)})},"esri/widgets/Feature/FeatureRelationship/FeatureRelationshipViewModel":function(){define("../../../chunks/tslib.es6 ../../../Graphic ../../../core/Accessor ../../../core/arrayUtils ../../../core/Clonable ../../../core/Collection ../../../core/Identifiable ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../rest/support/RelationshipQuery ../support/featureUtils ../../FeatureForm/featureFormUtils".split(" "),
function(a,b,d,m,g,x,n,B,M,k,w,e,f,l,q,r){d=class extends g.ClonableMixin(n.IdentifiableMixin(d)){constructor(c){super(c);this._loaded=!1;this._queryFeatureCountAbortController=this._queryPageAbortController=this._queryAbortController=null;this.featuresPerPage=10;this.orderByFields=this.map=this.layer=this.graphic=this.description=null;this.featureCount=0;this.relationshipId=null;this.showAllEnabled=!1;this.title=null;this._cancelQuery=()=>{const {_queryAbortController:t}=this;t&&t.abort();this._queryAbortController=
null};this._cancelQueryFeatureCount=()=>{const {_queryFeatureCountAbortController:t}=this;t&&t.abort();this._queryFeatureCountAbortController=null};this._cancelQueryPage=()=>{const {_queryPageAbortController:t}=this;t&&t.abort();this._queryPageAbortController=null};this._queryController=async()=>{this._cancelQuery();const t=new AbortController;this._queryAbortController=t;await B.ignoreAbortErrors(this._query());this._queryAbortController===t&&(this._queryAbortController=null)};this._queryFeatureCountController=
async()=>{this._loaded=!1;this._cancelQueryFeatureCount();const t=new AbortController;this._queryFeatureCountAbortController=t;await B.ignoreAbortErrors(this._queryFeatureCount());this._queryFeatureCountAbortController===t&&(this._queryFeatureCountAbortController=null);this._loaded=!0};this._queryPageController=async()=>{const t=new AbortController;this._queryPageAbortController=t;await B.ignoreAbortErrors(this._queryPage());this._queryPageAbortController===t&&(this._queryPageAbortController=null)};
this._queryDebounced=B.debounce(this._queryController,100);this._queryFeatureCountDebounced=B.debounce(this._queryFeatureCountController,100);this._queryPageDebounced=B.debounce(this._queryPageController,100);this._query=async()=>{const {_queryAbortController:t,relatedFeatures:h}=this;this.featureCount&&(this._destroyRelatedFeatureViewModels(),this.featurePage=1,h.removeAll(),this.destroyed||h.addMany(this._sliceFeatures(await this._queryRelatedFeatures({signal:t?.signal}))))};this.addHandles([M.watch(()=>
[this.displayCount,this.graphic,this.layer,this.layer?.loaded,this.map,this.orderByFields,this.relationshipId,this.featuresPerPage,this.showAllEnabled,this.canQuery,this.featureCount],()=>this._queryDebounced(),M.initial),M.watch(()=>[this.featurePage,this.showAllEnabled],()=>this._queryPageDebounced()),M.watch(()=>[this.layer,this.relationshipId,this.objectId,this.canQuery],()=>this._queryFeatureCountDebounced())])}destroy(){this._destroyRelatedFeatureViewModels();this.relatedFeatures.removeAll();
this._cancelQuery();this._cancelQueryFeatureCount();this._cancelQueryPage()}set featurePage(c){const {featuresPerPage:t,featureCount:h}=this;this._set("featurePage",Math.min(Math.max(c,1),Math.ceil(h/t)||1))}get featurePage(){return this._get("featurePage")}get orderByFieldsFixedCasing(){const {orderByFields:c,relatedLayer:t}=this;return c&&t?.loaded?c.map(h=>{const u=h.clone();u.field=q.getFixedFieldName(h.field,t);return u}):c??[]}get supportsCacheHint(){return!!this.layer?.capabilities?.queryRelated?.supportsCacheHint}get canLoad(){return!!this.map&&
"number"===typeof this.relationshipId&&"number"===typeof this.objectId}get canQuery(){const c=this.layer?.capabilities?.queryRelated;return!!this.relatedLayer&&!!this.relationship&&"number"===typeof this.relationshipId&&"number"===typeof this.objectId&&!!c?.supportsCount&&!!c?.supportsPagination}get itemDescriptionFieldName(){return this.orderByFieldsFixedCasing[0]?.field||null}set displayCount(c){this._set("displayCount",Math.min(Math.max(c,0),10))}get displayCount(){return this._get("displayCount")}get objectId(){return(this.objectIdField&&
this.graphic?.attributes?.[this.objectIdField])??null}get objectIdField(){return this.layer?.objectIdField||null}get relatedFeatures(){return this._get("relatedFeatures")||new x}get relatedLayer(){const {layer:c,map:t,relationship:h}=this;return c?.loaded&&t&&h?q.findRelatedLayer(t,c,h)??null:null}get relationship(){const {relationshipId:c,layer:t}=this;return"number"===typeof c?t?.relationships?.find(({id:h})=>h===c)??null:null}get relatedFeatureViewModels(){return this._get("relatedFeatureViewModels")||
new x}get state(){const {_queryAbortController:c,_queryFeatureCountAbortController:t,_queryPageAbortController:h,canQuery:u,_loaded:L,canLoad:K}=this;return t||K&&!L?"loading":c||h?"querying":u?"ready":"disabled"}getRelatedFeatureByObjectId(c){return this.relatedFeatures.find(t=>t.getObjectId()===c)}_destroyRelatedFeatureViewModels(){this.relatedFeatureViewModels?.forEach(c=>!c.destroyed&&c.destroy());this.relatedFeatureViewModels.removeAll()}async _queryFeatureCount(){const {layer:c,relatedLayer:t,
relationshipId:h,objectId:u,_queryFeatureCountAbortController:L,canQuery:K,supportsCacheHint:F}=this;await c?.load();await t?.load();if(K&&c&&t){var y=t.createQuery();y=new l({cacheHint:F,relationshipId:h,returnGeometry:!1,objectIds:[u],where:y.where??void 0});y=await c.queryRelatedFeaturesCount(y,{signal:L?.signal});this._set("featureCount",y[u]||0)}else this._set("featureCount",0)}_sliceFeatures(c){const {showAllEnabled:t,displayCount:h}=this;return t?c:h?c.slice(0,h):[]}async _queryPage(){const {relatedFeatures:c,
featurePage:t,showAllEnabled:h,_queryPageAbortController:u,featureCount:L}=this;!h||2>t||!L||c.addMany(await this._queryRelatedFeatures({signal:u?.signal}))}async _queryRelatedFeatures(c){const {orderByFieldsFixedCasing:t,showAllEnabled:h,featuresPerPage:u,displayCount:L,layer:K,relationshipId:F,featurePage:y,featureCount:p,relatedLayer:I,supportsCacheHint:R}=this,{canQuery:D,objectId:E}=this;if(!D||!K||!I)return[];var N=h?((y-1)*u+p)%p:0;const C=h?u:L;var P=I.objectIdField;P=[...t.map(z=>z.field),
...r.getFieldsInTitleAndDesc(I),P].filter(m.isSome);const H=t.map(z=>`${z.field} ${z.order}`),J=I.createQuery();N=new l({orderByFields:H,start:N,num:C,outFields:P,cacheHint:R,relationshipId:F,returnGeometry:!1,objectIds:[E],where:J.where??void 0});c=(await K.queryRelatedFeatures(N,{signal:c?.signal}))[E]?.features||[];c.forEach(z=>{z.sourceLayer=I;z.layer=I});return c}};a.__decorate([k.property()],d.prototype,"_loaded",void 0);a.__decorate([k.property()],d.prototype,"_queryAbortController",void 0);
a.__decorate([k.property()],d.prototype,"_queryPageAbortController",void 0);a.__decorate([k.property()],d.prototype,"_queryFeatureCountAbortController",void 0);a.__decorate([k.property({value:1})],d.prototype,"featurePage",null);a.__decorate([k.property()],d.prototype,"featuresPerPage",void 0);a.__decorate([k.property({readOnly:!0})],d.prototype,"orderByFieldsFixedCasing",null);a.__decorate([k.property({readOnly:!0})],d.prototype,"supportsCacheHint",null);a.__decorate([k.property({readOnly:!0})],
d.prototype,"canLoad",null);a.__decorate([k.property({readOnly:!0})],d.prototype,"canQuery",null);a.__decorate([k.property()],d.prototype,"description",void 0);a.__decorate([k.property({readOnly:!0})],d.prototype,"itemDescriptionFieldName",null);a.__decorate([k.property({value:3})],d.prototype,"displayCount",null);a.__decorate([k.property({type:b})],d.prototype,"graphic",void 0);a.__decorate([k.property()],d.prototype,"layer",void 0);a.__decorate([k.property()],d.prototype,"map",void 0);a.__decorate([k.property({readOnly:!0})],
d.prototype,"objectId",null);a.__decorate([k.property({readOnly:!0})],d.prototype,"objectIdField",null);a.__decorate([k.property()],d.prototype,"orderByFields",void 0);a.__decorate([k.property({readOnly:!0})],d.prototype,"relatedFeatures",null);a.__decorate([k.property({readOnly:!0})],d.prototype,"relatedLayer",null);a.__decorate([k.property({readOnly:!0})],d.prototype,"relationship",null);a.__decorate([k.property()],d.prototype,"featureCount",void 0);a.__decorate([k.property({readOnly:!0})],d.prototype,
"relatedFeatureViewModels",null);a.__decorate([k.property()],d.prototype,"relationshipId",void 0);a.__decorate([k.property()],d.prototype,"showAllEnabled",void 0);a.__decorate([k.property()],d.prototype,"state",null);a.__decorate([k.property()],d.prototype,"title",void 0);a.__decorate([k.property()],d.prototype,"getRelatedFeatureByObjectId",null);return d=a.__decorate([f.subclass("esri.widgets.Feature.FeatureRelationship.FeatureRelationshipViewModel")],d)})},"esri/widgets/support/Heading":function(){define(["exports",
"../../core/mathUtils","./globalCss","./widgetUtils","./jsxFactory"],function(a,b,d,m,g){a.Heading=function({level:x,class:n,...B},M){x=b.clamp(Math.ceil(x),1,6);return g.tsx(`h${x}`,{...B,"aria-level":String(x),class:m.classes(d.globalCss.heading,n),role:"heading"},M)};a.incrementHeadingLevel=function(x,n=1){return b.clamp(Math.ceil(x+n),1,6)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/FeatureTemplates":function(){define("require ../chunks/tslib.es6 ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ../layers/support/layerUtils ./Widget ./FeatureForm/featureFormUtils ./FeatureTemplates/FeatureTemplatesViewModel ./FeatureTemplates/ItemList ./FeatureTemplates/TemplateItem ./FeatureTemplates/VisibleElements ./support/componentsUtils ./support/globalCss ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory".split(" "),
function(a,b,d,m,g,x,n,B,M,k,w,e,f,l,q,r,c,t,h,u,L){function K(F){return F.id}g=class extends k{constructor(F,y){super(F,y);this.enableListScroll=!0;this.filterText="";this.headingLevel=4;this.messages=null;this.selectionMode="none";this.viewModel=new e;this.visibleElements=new q;this.renderCustomItem=p=>null;this.renderCustomGroupContent=p=>null;this.renderItemLabel=()=>null;this.renderItemDescription=()=>null;this.renderItemContent=p=>null;this.renderItemContentEnd=p=>null;this._iconIntersectionObserver=
new IntersectionObserver((p,I)=>{p.forEach(async R=>{if(R.isIntersecting){const N=R.target;if(N?.["data-has-icon"])I.unobserve(N);else{var {layer:D,template:E}=N?.["data-item"];N&&(N["data-has-icon"]=!0);R=await l.fetchThumbnail(D,E).catch(()=>{N&&(N["data-has-icon"]=!1);return null});null!=R&&N.appendChild(R)}}})});this._renderItemIcon=p=>M.isTable(p.layer)?L.tsx("span",{"data-has-icon":!0,"data-item":p,key:"icon"},L.tsx("calcite-icon",{icon:"table"})):L.tsx("span",{afterCreate:this._afterItemCreateOrUpdate,
afterRemoved:this._afterItemRemoved,afterUpdate:this._afterItemCreateOrUpdate,"data-has-icon":!1,"data-item":p,key:"icon"});this._afterItemCreateOrUpdate=p=>{this._iconIntersectionObserver?.observe(p)};this._afterItemRemoved=p=>{this._iconIntersectionObserver?.unobserve(p)}}initialize(){const F=({label:y})=>!this.filterText||!!y?.toLowerCase().includes(this.filterText.toLowerCase());this.addHandles(d.watch(()=>this.viewModel,(y,p)=>{y&&!y.filterFunction&&(this.filterFunction=F);p&&p!==y&&p.filterFunction===
F&&(p.filterFunction=null)},d.initial))}destroy(){this._iconIntersectionObserver?.disconnect();this._iconIntersectionObserver=null}loadDependencies(){return r.loadCalciteComponents({icon:()=>new Promise((F,y)=>a(["../chunks/calcite-icon"],F,y)),input:()=>new Promise((F,y)=>a(["../chunks/calcite-input"],F,y)),list:()=>new Promise((F,y)=>a(["../chunks/calcite-list"],F,y)),"list-item":()=>new Promise((F,y)=>a(["../chunks/calcite-list-item"],F,y)),notice:()=>new Promise((F,y)=>a(["../chunks/calcite-notice"],
F,y))})}get disabled(){return this.viewModel.disabled}set disabled(F){this.viewModel.disabled=F}get filterFunction(){return this.viewModel.filterFunction}set filterFunction(F){this.viewModel.filterFunction=F}get groupBy(){return this.viewModel.groupBy}set groupBy(F){this.viewModel.groupBy=F}get label(){return this.messages?.widgetLabel??""}set label(F){this._overrideIfSome("label",F)}get layers(){return this.viewModel.layers}set layers(F){this.viewModel.layers=F}get selectedItem(){return this.viewModel.selectedItem}select(F,
y){return this.viewModel.select(F,y)}render(){const {disabled:F,enableListScroll:y,filterText:p,headingLevel:I,messages:R,viewModel:{items:D,numberOfFeatureTemplates:E,selectedItem:N,state:C}}=this,P=this.visibleElements.filter&&1<E;if(0<D.length&&w.isTemplateItemGroup(D[0])){const H=D.find(J=>J.label===e.nullGroupBy.label);H&&(H.label=R.other)}return L.tsx("div",{"aria-label":R.widgetLabel,class:this.classes("esri-feature-templates",c.globalCss.widget)},"loading"===C?this._renderLoader():"ready"===
C?L.tsx(f.ItemList,{disabled:F,enableListScroll:y,filterEnabled:P,filterText:p,headingLevel:I,id:this.id,identify:K,items:D,messages:{filterPlaceholder:R.filterPlaceholder,noItems:R.noItems,noMatches:R.noMatches},renderCustomGroupContent:this.renderCustomGroupContent,renderCustomItem:this.renderCustomItem,renderIcon:this._renderItemIcon,renderItemContent:this.renderItemContent,renderItemContentEnd:this.renderItemContentEnd,renderItemDescription:this.renderItemDescription,renderItemLabel:this.renderItemLabel,
selectedItem:N??void 0,selectionMode:this.selectionMode??void 0,onFilterChange:H=>{this.filterText=H;this.viewModel.refresh()},onItemSelect:H=>!w.isTemplateItemGroup(H)&&this.viewModel.select(H)}):null)}_renderLoader(){return L.tsx("div",{class:"esri-feature-templates__loader",key:"loader"})}};b.__decorate([m.property()],g.prototype,"disabled",null);b.__decorate([m.property()],g.prototype,"enableListScroll",void 0);b.__decorate([m.property()],g.prototype,"filterFunction",null);b.__decorate([m.property()],
g.prototype,"filterText",void 0);b.__decorate([m.property()],g.prototype,"groupBy",null);b.__decorate([m.property()],g.prototype,"headingLevel",void 0);b.__decorate([m.property()],g.prototype,"label",null);b.__decorate([m.property()],g.prototype,"layers",null);b.__decorate([m.property(),h.messageBundle("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],g.prototype,"messages",void 0);b.__decorate([m.property({readOnly:!0})],g.prototype,"selectedItem",null);b.__decorate([m.property()],g.prototype,
"selectionMode",void 0);b.__decorate([m.property(),u.vmEvent("select")],g.prototype,"viewModel",void 0);b.__decorate([m.property({type:q,nonNullable:!0})],g.prototype,"visibleElements",void 0);b.__decorate([m.property()],g.prototype,"renderCustomItem",void 0);b.__decorate([m.property()],g.prototype,"renderCustomGroupContent",void 0);b.__decorate([m.property()],g.prototype,"renderItemLabel",void 0);b.__decorate([m.property()],g.prototype,"renderItemDescription",void 0);b.__decorate([m.property()],
g.prototype,"renderItemContent",void 0);b.__decorate([m.property()],g.prototype,"renderItemContentEnd",void 0);return g=b.__decorate([B.subclass("esri.widgets.FeatureTemplates")],g)})},"esri/widgets/FeatureTemplates/FeatureTemplatesViewModel":function(){define("../../chunks/tslib.es6 ../../core/Evented ../../core/ObjectPool ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../layers/support/layerUtils ./TemplateItem ./TemplateItemGroup ../support/templateUtils".split(" "),
function(a,b,d,m,g,x,n,B,M,k,w,e,f){var l;const q=({layer:c})=>({key:c,label:c.title??""}),r=({layer:c})=>({key:c.geometryType,label:c.geometryType??""});b=l=class extends b.EventedAccessor{constructor(c){super(c);this._groupPool=new d(e);this._itemPool=new d(w);this.disabled=!1;this.selectedItem=this.filterFunction=this.disabledItemFunction=null}initialize(){this._get("groupBy")||(this.groupBy="layer")}get _featureTemplatesByLayer(){if(!this.layers)return new Map;const c=new Map;for(const t of this.layers)if("subtype-group"===
t.type)for(const h of t.sublayers)c.set(h,f.getAllTemplatesForLayer(h));else c.set(t,f.getAllTemplatesForLayer(t));return c}set groupBy(c){this._set("groupBy",c);if("function"===typeof c)this._groupByFunction=t=>this._ensureGroupByObject(c(t));else switch(c){case "layer":this._groupByFunction=q;break;case "geometry":this._groupByFunction=r;break;default:this._groupByFunction=null}}set layers(c){this.removeHandles("layers");if(c){const t=()=>this.notifyChange("state");this.addHandles(c.map(h=>m.when(()=>
h.loadStatus,t)),"layers")}this._set("layers",c)}get layers(){return this._get("layers")}get state(){const {layers:c}=this;return c&&0!==c.length?c.some(t=>"loading"===t.loadStatus||"not-loaded"===t.loadStatus)?"loading":"ready":"disabled"}get numberOfFeatureTemplates(){return Array.from(this._featureTemplatesByLayer.values()).reduce((c,t)=>c+t.length,0)}get items(){if(0===this.numberOfFeatureTemplates)return this._releasePreviousItems(),[];var c=this._featureTemplatesByLayer,t=[],h=null!=this.filterFunction?
this.filterFunction:l._nullFilterFunction;for(const [K,F]of c)if(K.loaded||"subtype-sublayer"===K.type&&K.parent?.loaded)if(c=k.getEffectiveLayerCapabilities(K)?.operations,c?.supportsEditing&&c?.supportsAdd)for(var u of F)t.push({layer:K,template:u,matchesFilter:h({label:u.name})});if(null==this._groupByFunction)return h=t.filter(({matchesFilter:K})=>K).map(({template:K,layer:F})=>this._createItem(K,F)),this._releasePreviousItems(),h;u=new Map;for(var L of t){const {template:K,layer:F}=L;t=this._groupByFunction({template:K,
layer:F});const {key:y,label:p}=null!=t.key?t:l.nullGroupBy;u.has(y)||u.set(y,{label:p,templateItemInfos:[]});u.get(y)?.templateItemInfos.push(L)}L=[];for(const K of u.values()){const {label:F,templateItemInfos:y}=K;t=y.filter(({matchesFilter:p})=>p);t=h({label:F})?y:0<y.length?t:[];0<t.length&&(t=t.map(({template:p,layer:I})=>this._createItem(p,I)),L.push(this._createGroup(F,t)))}if(1===L.length&&L[0].label===l.nullGroupBy.label)return this._releasePreviousItems(),L[0].items;this._releasePreviousItems();
return L}refresh(){this.notifyChange("items")}select(c,{emit:t=!0}={}){const h=this.selectedItem;c=c?.clone()||null;this._set("selectedItem",c);t&&this.emit("select",{item:c,oldItem:h,template:c?.template??null})}_createItem(c,t){const h=this._itemPool.acquire(),u=this.disabledItemFunction?.({template:c,layer:t})??!1;h.set({disabled:u,layer:t,template:c});return h}_createGroup(c,t){const h=this._groupPool.acquire();h.set("label",c);h.items=t;return h}_releasePreviousItems(){this._destroyItems(this._get("items"))}_destroyItems(c){c&&
(c[0]instanceof w?c.forEach(t=>this._destroyItem(t)):c.forEach(t=>this._destroyGroup(t)))}_destroyGroup(c){c.items.forEach(t=>this._destroyItem(t));c.items.length=0;this._groupPool.release(c)}_destroyItem(c){c.layer=null;c.template=null;this._itemPool.release(c)}_ensureGroupByObject(c){return"string"===typeof c?{key:c,label:c}:c}};b.nullGroupBy={key:Symbol(),label:"Other\u200b"};b._nullFilterFunction=c=>!0;a.__decorate([g.property()],b.prototype,"_featureTemplatesByLayer",null);a.__decorate([g.property()],
b.prototype,"_groupByFunction",void 0);a.__decorate([g.property()],b.prototype,"disabled",void 0);a.__decorate([g.property()],b.prototype,"disabledItemFunction",void 0);a.__decorate([g.property()],b.prototype,"filterFunction",void 0);a.__decorate([g.property()],b.prototype,"groupBy",null);a.__decorate([g.property()],b.prototype,"layers",null);a.__decorate([g.property()],b.prototype,"state",null);a.__decorate([g.property({readOnly:!0})],b.prototype,"numberOfFeatureTemplates",null);a.__decorate([g.property({readOnly:!0})],
b.prototype,"items",null);a.__decorate([g.property({readOnly:!0})],b.prototype,"selectedItem",void 0);return b=l=a.__decorate([M.subclass("esri.widgets.FeatureTemplates.FeatureTemplatesViewModel")],b)})},"esri/widgets/FeatureTemplates/TemplateItem":function(){define("require ../../chunks/tslib.es6 ../../Graphic ../../core/Accessor ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../symbols/support/symbolUtils".split(" "),
function(a,b,d,m,g,x,n,B,M,k,w){async function e(r,c){var {renderer:t}=r;return t&&(c=new d({attributes:c.prototype.attributes}),t=await t.getSymbolAsync(c))?t:f(r)}async function f(r){({geometryType:r}=r);return(r="point"===r||"multipoint"===r?await new Promise((c,t)=>a(["../../symbols/SimpleMarkerSymbol"],h=>c(l(h)),t)):"polyline"===r?await new Promise((c,t)=>a(["../../symbols/SimpleLineSymbol"],h=>c(l(h)),t)):"polygon"===r||"mesh"===r||"multipatch"===r?await new Promise((c,t)=>a(["../../symbols/SimpleFillSymbol"],
h=>c(l(h)),t)):null)?new r.default:null}const l=r=>Object.freeze(Object.defineProperty({__proto__:null,default:r},Symbol.toStringTag,{value:"Module"}));var q;m=q=class extends m{constructor(r){super(r);this._activeFetchInfo={id:null,request:null};this.disabled=!1;this.thumbnail=this.template=this.layer=null}initialize(){this.addHandles(g.watch(()=>{const {layer:r}=this;return[r&&"renderer"in r?r.renderer:null,this.template]},()=>{this._activeFetchInfo.id=null;this._activeFetchInfo.request=null;this._set("thumbnail",
null)},g.initial))}get description(){return this.template?.description}set description(r){this.template&&(this.template.description=r)}get label(){return this.template?.name}set label(r){this.template&&(this.template.name=r)}get id(){return`${this.label??""}\u2013${this.layer?.id}`}get supportsUpload(){return"scene"===this.layer?.type}clone(){const r=null!=this.thumbnail?this.thumbnail.cloneNode(!0):null,c=new q({layer:this.layer,template:this.template});c._set("thumbnail",r);return c}static async fetchThumbnail(r,
c){const t=await e(r,c);if(null==t)return null;const h={maxSize:36};"dictionary"===r.renderer?.type&&(h.fieldMap=r.renderer.fieldMap??void 0,h.feature={attributes:c.prototype.attributes??{}});return await w.renderPreviewHTML(t,h)}};b.__decorate([x.property()],m.prototype,"description",null);b.__decorate([x.property()],m.prototype,"disabled",void 0);b.__decorate([x.property()],m.prototype,"label",null);b.__decorate([x.property()],m.prototype,"layer",void 0);b.__decorate([x.property()],m.prototype,
"template",void 0);b.__decorate([x.property({readOnly:!0})],m.prototype,"thumbnail",void 0);b.__decorate([x.property()],m.prototype,"id",null);b.__decorate([x.property()],m.prototype,"supportsUpload",null);return m=q=b.__decorate([k.subclass("esri.widgets.FeatureTemplates.TemplateItem")],m)})},"esri/symbols/support/symbolUtils":function(){define("require exports ../../core/has ../../support/arcadeOnDemand ./gfxUtils ./previewUtils ./renderUtils ./utils ../../widgets/Legend/styles/support/relationshipUtils ../../widgets/Legend/support/relationshipRampUtils".split(" "),
function(a,b,d,m,g,x,n,B,M,k){function w(r,c){if(c&&(r.style.filter=B.getCSSFilterFromEffectList(c),c=c.effects))for(const t of c)if("drop-shadow"===t?.type){0>t.offsetX?r.style.marginLeft=`${Math.abs(t.offsetX)}px`:r.style.marginRight=`${t.offsetX}px`;break}}async function e(r,c){switch(r.type){case "web-style":var {previewWebStyleSymbol:t}=await new Promise((h,u)=>a(["./previewWebStyleSymbol"],h,u));return t(r,e,c);case "label-3d":case "line-3d":case "mesh-3d":case "point-3d":case "polygon-3d":return{previewSymbol3D:t}=
await new Promise((h,u)=>a(["./previewSymbol3D"],h,u)),t(r,c);case "simple-marker":case "simple-line":case "simple-fill":case "picture-marker":case "picture-fill":case "text":return{previewSymbol2D:t}=await new Promise((h,u)=>a(["./previewSymbol2D"],h,u)),t(r,c);case "cim":return{previewCIMSymbol:t}=await new Promise((h,u)=>a(["./previewCIMSymbol"],h,u)),t(r,c)}}function f(r){return r&&"opacity"in r?r.opacity*f(r.parent):1}let l=null;const q=[255,255,255];b.getDisplayedColor=async function(r,c){if(r){var t=
r.layer,h=r.sourceLayer,u=f(t??h);if(null!=r.symbol&&(null==c||!0!==c.ignoreGraphicSymbol))return r="web-style"===r.symbol.type?await B.fetchWebStyleSymbol(r.symbol,c):r.symbol.clone(),B.getColorFromSymbol(r,u);if(h=(t=c?.renderer||(t&&"renderer"in t?t.renderer:void 0)||(h&&"renderer"in h?h.renderer:void 0))&&"getSymbolAsync"in t?await t.getSymbolAsync(r,c):void 0){h="web-style"===h.type?await B.fetchWebStyleSymbol(h,c):h.clone();h=B.getColorFromSymbol(h,u);if(!(t&&"visualVariables"in t)||"visualVariables"in
t&&!t.visualVariables||"visualVariables"in t&&!t.visualVariables?.length)return h;"arcadeRequiredForVisualVariables"in t&&t.arcadeRequiredForVisualVariables&&null==c?.arcade&&(c={...c},c.arcade=await m.loadArcade());var {getColor:L,getOpacity:K}=await new Promise((I,R)=>a(["../../renderers/visualVariables/support/visualVariableUtils"],I,R)),F=[],y=[];for(var p of t.visualVariables)switch(p.type){case "color":F.push(p);break;case "opacity":y.push(p)}p=(p=0<F.length?F[F.length-1]:null)?L(p,r,c):h;r=
(t=0<y.length?y[y.length-1]:null)?K(t,r,c):null;null!=u&&(r=null!=r?r*u:u);return p?B.applyOpacityToColor(p,r):null}}};b.getDisplayedSymbol=async function(r,c){if(r){var t=r.sourceLayer,h=(null!=c&&(c.useSourceLayer??!1)?t:r.layer)??t;t=f(h);if(null!=r.symbol&&(null==c||!0!==c.ignoreGraphicSymbol))return r="web-style"===r.symbol.type?await B.fetchWebStyleSymbol(r.symbol,{...c,cache:null!=c?c.webStyleCache:null}):r.symbol.clone(),B.applyColorToSymbol(r,null,t),r;var u=(null!=c?c.renderer:null)??(h&&
"renderer"in h?h.renderer:null);if(h=u&&"getSymbolAsync"in u?await u.getSymbolAsync(r,c):null){h="web-style"===h.type?await h.fetchSymbol({...c,cache:null!=c?c.webStyleCache:null}):h.clone();if(!(u&&"visualVariables"in u&&u.visualVariables?.length))return B.applyColorToSymbol(h,null,t),h;"arcadeRequiredForVisualVariables"in u&&u.arcadeRequiredForVisualVariables&&null==c?.arcade&&(c={...c},c.arcade=await m.loadArcade());var {getColor:L,getOpacity:K,getAllSizes:F,getRotationAngle:y}=await new Promise((N,
C)=>a(["../../renderers/visualVariables/support/visualVariableUtils"],N,C)),p=[],I=[],R=[],D=[];for(var E of u.visualVariables)switch(E.type){case "color":p.push(E);break;case "opacity":I.push(E);break;case "rotation":D.push(E);break;case "size":E.target||R.push(E)}E=(E=!!p.length&&p[p.length-1])?L(E,r,c):null;I=(I=!!I.length&&I[I.length-1])?K(I,r,c):null;null!=t&&(I=null!=I?I*t:t);B.applyColorToSymbol(h,E,I);R.length&&(t=F(R,r,c),await B.applySizesToSymbol(h,t));for(const N of D)B.applyRotationToSymbol(h,
y(N,r,c),N.axis);return h}}};b.renderColorRampPreviewHTML=function(r,c={}){var t="horizontal"===c.align;const h=c.width??(t?75:24),u=c.height??(t?24:75);var L=c.gradient??!0,K=window.devicePixelRatio,F=h*K,y=u*K;K=document.createElement("canvas");K.width=F;K.height=y;K.ariaLabel=c.ariaLabel??null;K.style.width=`${h}px`;K.style.height=`${u}px`;const p=K.getContext("2d");var I=t?F:0;const R=t?0:y;if(L){const D=p.createLinearGradient(0,0,I,R);t=r.length;const E=1===t?0:1/(t-1);r.forEach((N,C)=>D.addColorStop(C*
E,N.toString()));p.fillStyle=D;p.fillRect(0,0,F,y)}else{F=t?F/r.length:F;y=t?y:y/r.length;I=L=0;for(const D of r)p.fillStyle=D.toString(),p.fillRect(L,I,F,y),L=t?L+F:0,I=t?0:I+y}r=document.createElement("div");r.style.width=`${h}px`;r.style.height=`${u}px`;w(r,c?.effectList);r.appendChild(K);return r};b.renderDotDensityPreviewHTML=function(r,c,t){const {backgroundColor:h,outline:u,dotSize:L}=r;var K=t?.swatchSize||x.SymbolSizeDefaults.size;const F=Math.round(K*K/L**2*.8),y=window.devicePixelRatio;
r=document.createElement("canvas");const p=K*y;r.width=p;r.height=p;r.style.width=`${r.width/y}px`;r.style.height=`${r.height/y}px`;const I=r.getContext("2d");h&&(I.fillStyle=h.toCss(!0),I.fillRect(0,0,p,p),I.fill());I.fillStyle=c?.toCss(!0)??"";if(l&&l.length/2===F)for(c=0;c<2*F;c+=2)I.fillRect(l[c],l[c+1],L*y,L*y),I.fill();else for(l=[],c=0;c<2*F;c+=2){const R=Math.floor(Math.random()*(p-0+1)),D=Math.floor(Math.random()*(p-0+1));l.push(R,D);I.fillRect(R,D,L*y,L*y);I.fill()}u&&(u.color&&(I.strokeStyle=
u.color.toCss(!0)),I.lineWidth=u.width,I.strokeRect(0,0,p,p));K=new Image(K,K);K.src=r.toDataURL();K.ariaLabel=t?.ariaLabel??null;K.alt=t?.ariaLabel??"";return K};b.renderPieChartPreviewHTML=function(r,c={}){const t=c.radius||40;var h=2*Math.PI*t,u=r.length;const L=h/u,K=[],F=g.getStroke(c.outline);null!=F?.width&&(F.width*=2);(F||c.backgroundColor)&&K.push({shape:{type:"circle",cx:t,cy:t,r:t},fill:c.backgroundColor,stroke:F,offset:[0,0]});const y=c.values,p=y&&y.length===u&&100===y.reduce((R,D)=>
R+D,0),I=[0];for(let R=0;R<u;R++){let D=null;p&&(D=y[R]*h/100,I.push(D+I[R]));K.push({shape:{type:"circle",cx:t,cy:t,r:t/2},fill:[0,0,0,0],stroke:{width:t,dashArray:`${(D??L)/2} ${h}`,dashoffset:`-${p?I[R]/2:L/2*R}`,color:r[R]},offset:[0,0]})}u=null;r=2*t+(F?.width||0);if(h=c.holePercentage)F&&K.push({shape:{type:"circle",cx:t,cy:t,r:t*h},fill:null,stroke:F,offset:[0,0]}),u=r/2,u=[[{shape:{type:"circle",cx:u,cy:u,r:u},fill:q,stroke:F?{...F,color:q}:null,offset:[0,0]},{shape:{type:"circle",cx:u,cy:u,
r:t*h},fill:[0,0,0],stroke:null,offset:[0,0]}]];return n.renderSymbol([K],[r,r],{effectView:c.effectList,ignoreStrokeWidth:!0,masking:u,rotation:-90,ariaLabel:c.ariaLabel})};b.renderPreviewHTML=e;b.renderRelationshipRampPreviewHTML=function(r,c={}){const t=r?.authoringInfo;if("relationship"!==t?.type||!t?.numClasses||!r.uniqueValueInfos)return null;const {focus:h,numClasses:u}=t,L=k.getRelationshipRampElement({focus:h,numClasses:u,infos:r.uniqueValueInfos});r=c?.node||document.createElement("div");
n.renderOnce(r,()=>M.renderRelationshipRamp(L,c.id||"relationship",{opacity:c.opacity||1,effectList:c.effectList,ariaLabel:c.ariaLabel}));return r};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/gfxUtils":function(){define("exports ../../assets ../../Color ../../request ../../core/LRUCache ../../core/screenUtils ./cimSymbolUtils".split(" "),function(a,b,d,m,g,x,n){function B(w){if(!w)return null;let e=null;switch(w.type){case "simple-fill":case "picture-fill":case "simple-marker":e=
B(w.outline);break;case "simple-line":const f=x.pt2px(w.width);null!=w.style&&"none"!==w.style&&0!==f&&(e={color:w.color,style:k(w.style),width:f,cap:w.cap,join:"miter"===w.join?x.pt2px(w.miterLimit):w.join});break;default:e=null}return e}const M=new g.LRUCache(1E3),k=(()=>{const w={};return e=>{if(w[e])return w[e];const f=e.replaceAll("-","");return w[e]=f}})();d=new d([128,128,128]);a.defaultThematicColor=d;a.dekebabifyLineStyle=k;a.getFill=function(w){const e=w.style;let f=null;if(w)switch(w.type){case "simple-marker":"cross"!==
e&&"x"!==e&&(f=w.color);break;case "simple-fill":"solid"===e?f=w.color:"none"!==e&&(f={type:"pattern",x:0,y:0,src:b.getAssetUrl(`esri/symbols/patterns/${e}.png`),width:5,height:5});break;case "picture-fill":f={type:"pattern",src:w.url,width:x.pt2px(w.width)*w.xscale,height:x.pt2px(w.height)*w.yscale,x:x.pt2px(w.xoffset),y:x.pt2px(w.yoffset)};break;case "text":f=w.color;break;case "cim":f=n.getCIMSymbolColor(w)}return f};a.getPatternUrlWithColor=function(w,e){const f=w+"-"+e;return void 0!==M.get(f)?
Promise.resolve(M.get(f)):m(w,{responseType:"image"}).then(l=>{l=l.data;const q=l.naturalWidth,r=l.naturalHeight,c=document.createElement("canvas");c.width=q;c.height=r;const t=c.getContext("2d");t.fillStyle=e;t.fillRect(0,0,q,r);t.globalCompositeOperation="destination-in";t.drawImage(l,0,0);l=c.toDataURL();M.put(f,l);return l})};a.getStroke=B;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/cimSymbolUtils":function(){define(["exports","../../Color","../cim/utils"],
function(a,b,d){function m(e){e=d.toCIMSymbolJSON(e);if("CIMTextSymbol"===e?.type)return e.height??0;let f=0;if(e?.symbolLayers)for(const l of e.symbolLayers)d.isCIMMarker(l)&&null!=l.size&&l.size>f?f=l.size:d.isCIMStroke(l)&&null!=l.width&&l.width>f?f=l.width:d.isCIMFill(l);return f}function g(e,f,l,q){if(e)if("CIMTextSymbol"===e.type)null!=e.height&&(e.height*=f);else{if(l&&e.effects)for(const r of e.effects)B(r,f);if(e.symbolLayers)for(const r of e.symbolLayers)switch(r.type){case "CIMPictureMarker":case "CIMVectorMarker":x(r,
f,q);break;case "CIMPictureStroke":case "CIMSolidStroke":!q?.preserveOutlineWidth&&r.width&&(r.width*=f);break;case "CIMPictureFill":r.height&&(r.height*=f);r.offsetX&&(r.offsetX*=f);r.offsetY&&(r.offsetY*=f);break;case "CIMHatchFill":g(r.lineSymbol,f,!0,{...q,preserveOutlineWidth:!1}),r.offsetX&&(r.offsetX*=f),r.offsetY&&(r.offsetY*=f),r.separation&&(r.separation*=f)}}}function x(e,f,l){if(e&&(e.markerPlacement&&n(e.markerPlacement,f),e.offsetX&&(e.offsetX*=f),e.offsetY&&(e.offsetY*=f),e.anchorPoint&&
"Absolute"===e.anchorPointUnits&&(e.anchorPoint={x:e.anchorPoint.x*f,y:e.anchorPoint.y*f}),e.size=null!=e.size?e.size*f:0,"CIMVectorMarker"===e.type&&e.markerGraphics))for(const q of e.markerGraphics)e.scaleSymbolsProportionally||g(q.symbol,f,!0,l)}function n(e,f){d.isCIMMarkerStrokePlacement(e)&&e.offset&&(e.offset*=f);switch(e.type){case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineSameSize":e.customEndingOffset&&(e.customEndingOffset*=f);e.offsetAlongLine&&(e.offsetAlongLine*=
f);if(e.placementTemplate&&e.placementTemplate.length){var l=e.placementTemplate.map(q=>q*f);e.placementTemplate=l}break;case "CIMMarkerPlacementAlongLineVariableSize":e.maxRandomOffset&&(e.maxRandomOffset*=f);e.placementTemplate&&e.placementTemplate.length&&(l=e.placementTemplate.map(q=>q*f),e.placementTemplate=l);break;case "CIMMarkerPlacementOnLine":e.startPointOffset&&(e.startPointOffset*=f);break;case "CIMMarkerPlacementAtExtremities":e.offsetAlongLine&&(e.offsetAlongLine*=f);break;case "CIMMarkerPlacementAtRatioPositions":e.beginPosition&&
(e.beginPosition*=f);e.endPosition&&(e.endPosition*=f);break;case "CIMMarkerPlacementPolygonCenter":e.offsetX&&(e.offsetX*=f);e.offsetY&&(e.offsetY*=f);break;case "CIMMarkerPlacementInsidePolygon":e.offsetX&&(e.offsetX*=f),e.offsetY&&(e.offsetY*=f),e.stepX&&(e.stepX*=f),e.stepY&&(e.stepY*=f)}}function B(e,f){switch(e.type){case "CIMGeometricEffectArrow":case "CIMGeometricEffectDonut":e.width&&(e.width*=f);break;case "CIMGeometricEffectBuffer":e.size&&(e.size*=f);break;case "CIMGeometricEffectCut":e.beginCut&&
(e.beginCut*=f);e.endCut&&(e.endCut*=f);e.middleCut&&(e.middleCut*=f);break;case "CIMGeometricEffectDashes":e.customEndingOffset&&(e.customEndingOffset*=f);e.offsetAlongLine&&(e.offsetAlongLine*=f);if(e.dashTemplate&&e.dashTemplate.length){const l=e.dashTemplate.map(q=>q*f);e.dashTemplate=l}break;case "CIMGeometricEffectExtension":case "CIMGeometricEffectJog":case "CIMGeometricEffectRadial":e.length&&(e.length*=f);break;case "CIMGeometricEffectMove":e.offsetX&&(e.offsetX*=f);e.offsetY&&(e.offsetY*=
f);break;case "CIMGeometricEffectOffset":case "CIMGeometricEffectOffsetTangent":e.offset&&(e.offset*=f);break;case "CIMGeometricEffectRegularPolygon":e.radius&&(e.radius*=f);break;case "CIMGeometricEffectTaperedPolygon":e.fromWidth&&(e.fromWidth*=f);e.length&&(e.length*=f);e.toWidth&&(e.toWidth*=f);break;case "CIMGeometricEffectWave":e.amplitude&&(e.amplitude*=f),e.period&&(e.period*=f)}}function M(e,f){if(e){var l="CIMTextSymbol"===e.type?e.symbol:e;e="CIMPolygonSymbol"===e.type;if(l?.symbolLayers)for(const q of l.symbolLayers)if(!(q.colorLocked||
e&&(d.isCIMStroke(q)||d.isCIMMarker(q)&&q.markerPlacement&&d.isCIMMarkerStrokePlacement(q.markerPlacement))))switch(q.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":q.tintColor&&k(f,q.tintColor);break;case "CIMVectorMarker":q.markerGraphics?.forEach(r=>{M(r.symbol,f)});break;case "CIMSolidStroke":case "CIMSolidFill":k(f,q.color);break;case "CIMHatchFill":M(q.lineSymbol,f)}}}function k(e,f){for(const l of e)if(l.join(".")===f.join("."))return;e.push(f)}function w(e,f,l){if(e){var q=
"CIMTextSymbol"===e.type?e.symbol:e;e="CIMPolygonSymbol"===q?.type;if(q?.symbolLayers)for(const r of q.symbolLayers)if(!r.colorLocked){if(e)if(l){if({layersToColor:q}=l,(d.isCIMStroke(r)||d.isCIMMarker(r)&&r.markerPlacement&&d.isCIMMarkerStrokePlacement(r.markerPlacement))&&"fill"===q||d.isCIMFill(r)&&"outline"===q)continue}else if(d.isCIMStroke(r)||d.isCIMMarker(r)&&r.markerPlacement&&d.isCIMMarkerStrokePlacement(r.markerPlacement))continue;q=f.toArray();switch(r.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":r.tintColor=
q;break;case "CIMVectorMarker":r.markerGraphics?.forEach(c=>{w(c.symbol,f,l)});break;case "CIMSolidStroke":case "CIMSolidFill":r.color=q;break;case "CIMHatchFill":w(r.lineSymbol,f,l)}}}}a.applyCIMSymbolColor=function(e,f,l){f instanceof b||(f=new b(f));(e=d.toCIMSymbolJSON(e))&&w(e,f,l)};a.applyCIMSymbolRotation=function(e,f,l=!1){e=d.toCIMSymbolJSON(e);l&&0!==f&&(f=360-f);if("CIMTextSymbol"===e?.type)e.angle=f;else if("CIMPointSymbol"===e?.type&&e.symbolLayers){l=f-(e.angle||0);for(const q of e.symbolLayers)if(d.isCIMMarker(q)){let r=
q.rotation||0;r=q.rotateClockwise?r-l:r+l;q.rotation=r}e.angle=f}};a.getCIMSymbolColor=function(e){e=d.toCIMSymbolJSON(e);const f=[];M(e,f);return f.length?new b(d.fromCIMColor(f[0])):null};a.getCIMSymbolRotation=function(e,f=!1){e=d.toCIMSymbolJSON(e);return"CIMTextSymbol"===e?.type||"CIMPointSymbol"===e?.type?(e=e.angle,null!=e&&0!==e&&f?360-e:e??0):0};a.getCIMSymbolSize=m;a.getCIMSymbolType=function(e){e=d.toCIMSymbolJSON(e);if(!e)return null;switch(e.type){case "CIMPointSymbol":return"CIMPointSymbol";
case "CIMLineSymbol":return"CIMLineSymbol";case "CIMPolygonSymbol":return"CIMPolygonSymbol";case "CIMTextSymbol":return"CIMTextSymbol";case "CIMMeshSymbol":return"CIMMeshSymbol";default:return null}};a.scaleCIMMarker=x;a.scaleCIMSymbol=g;a.scaleCIMSymbolTo=function(e,f,l){if(e){var q=d.toCIMSymbolJSON(e);e=m(e);if(0===e){if(q)if("CIMTextSymbol"===q.type)q.height=f;else if(q.symbolLayers)for(const r of q.symbolLayers)switch(r.type){case "CIMPictureMarker":case "CIMVectorMarker":r.size=f;break;case "CIMPictureStroke":case "CIMSolidStroke":r.width=
f}}else g(q,f/e,!1,l)}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/utils":function(){define(["require","exports"],function(a,b){function d(e){return"function"===typeof e}function m(e){let f=e.length;for(;f--;)if(!" /-,\n".includes(e.charAt(f)))return!1;return!0}function g(e,f){const l=[];var q=0;let r=-1;do r=e.indexOf("[",q),r>=q&&(r>q&&(q=e.substr(q,r-q),l.push([q,null,m(q)])),q=r+1,r=e.indexOf("]",q),r>=q&&(r>q&&(q=e.substr(q,r-q),(q=f[q])&&l.push([null,q,
!1])),q=r+1));while(-1!==r);q<e.length-1&&(e=e.substr(q),l.push([e,null,m(e)]));return l}function x(e,f,l){let q="",r=null;for(const c of f){const [t,h,u]=c;if(t)u?r=t:(r&&(q+=r,r=null),q+=t);else if(f=e.attributes[h])r&&(q+=r,r=null),q+=f}return n(q,l)}function n(e,f){"string"!==typeof e&&(e=String(e));switch(f){case "LowerCase":return e.toLowerCase();case "Allcaps":return e.toUpperCase();default:return e}}function B(e){return e?{r:e[0],g:e[1],b:e[2],a:e[3]/255}:{r:0,g:0,b:0,a:0}}function M(e){if(!e)return null;
switch(e.type){case "CIMPolygonSymbol":if(e.symbolLayers)for(const f of e.symbolLayers)if(e=M(f),null!=e)return e;break;case "CIMTextSymbol":return M(e.symbol);case "CIMSolidFill":return e.color}}function k(e){if(e)switch(e.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(e=e.symbolLayers)for(const f of e)if(e=k(f),null!=e)return e;break;case "CIMTextSymbol":return k(e.symbol);case "CIMSolidStroke":return e.color}}function w(e){if(e)switch(e.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(e.symbolLayers)for(const f of e.symbolLayers)if(e=
w(f),void 0!==e)return e;break;case "CIMTextSymbol":return w(e.symbol);case "CIMSolidStroke":case "CIMGradientStroke":case "CIMPictureStroke":return e.width}}b.adjustTextCase=n;b.analyzeTextParts=g;b.assignTextValuesFromFeature=x;b.attributesToFields=function(e){return(e?Object.keys(e):[]).map(f=>({name:f,alias:f,type:"string"===typeof e[f]?"esriFieldTypeString":"esriFieldTypeDouble"}))};b.colorToArray=function(e){return[e.r,e.g,e.b,e.a]};b.createLabelOverrideFunction=function(e,f,l){const q=g(f,
e);return r=>x(r,q,l)};b.evaluateValueOrFunction=function(e,f,l,q){return d(e)?e(f,l,q):e};b.fromCIMColor=B;b.fromCIMFontDecoration=function(e){return e.underline?"underline":e.strikethrough?"line-through":"none"};b.fromCIMFontStyle=function(e){let f="normal",l="normal";e&&(e=e.toLowerCase(),e.includes("italic")?f="italic":e.includes("oblique")&&(f="oblique"),e.includes("bold")?l="bold":e.includes("light")&&(l="lighter"));return{style:f,weight:l}};b.fromCIMHorizontalAlignment=function(e){switch(e){default:return"left";
case "Right":return"right";case "Center":return"center";case "Justify":return"center"}};b.fromCIMVerticalAlignment=function(e){switch(e){default:return"top";case "Center":return"middle";case "Baseline":return"baseline";case "Bottom":return"bottom"}};b.getFillColor=M;b.getFontStyle=function(e){if(!e)return"normal";switch(e.toLowerCase()){case "italic":return"italic";case "oblique":return"oblique";default:return"normal"}};b.getFontWeight=function(e){if(!e)return"normal";switch(e.toLowerCase()){case "bold":return"bold";
case "bolder":return"bolder";case "lighter":return"lighter";default:return"normal"}};b.getStrokeColor=k;b.getStrokeWidth=w;b.getTintColor=e=>e.tintColor?B(e.tintColor):{r:255,g:255,b:255,a:1};b.getValue=(e,f=0)=>null==e||isNaN(e)?f:e;b.importGeometryEngine=function(){return new Promise((e,f)=>a(["../../geometry/geometryEngineJSON"],e,f))};b.isCIMFill=function(e){return null!=e&&("CIMGradientFill"===e.type||"CIMHatchFill"===e.type||"CIMPictureFill"===e.type||"CIMSolidFill"===e.type||"CIMWaterFill"===
e.type)};b.isCIMMarker=function(e){return"CIMVectorMarker"===e.type||"CIMPictureMarker"===e.type||"CIMBarChartMarker"===e.type||"CIMCharacterMarker"===e.type||"CIMPieChartMarker"===e.type||"CIMStackedBarChartMarker"===e.type};b.isCIMMarkerStrokePlacement=function(e){return null!=e&&("CIMMarkerPlacementAlongLineRandomSize"===e.type||"CIMMarkerPlacementAlongLineSameSize"===e.type||"CIMMarkerPlacementAlongLineVariableSize"===e.type||"CIMMarkerPlacementAtExtremities"===e.type||"CIMMarkerPlacementAtMeasuredUnits"===
e.type||"CIMMarkerPlacementAtRatioPositions"===e.type||"CIMMarkerPlacementOnLine"===e.type||"CIMMarkerPlacementOnVertices"===e.type)};b.isCIMStroke=function(e){return"CIMGradientStroke"===e.type||"CIMPictureStroke"===e.type||"CIMSolidStroke"===e.type};b.isFeatureValueFn=d;b.isGeometryEngineRequired=e=>{if(!e)return!1;for(const f of e)switch(f.type){case "CIMGeometricEffectBuffer":case "CIMGeometricEffectOffset":case "CIMGeometricEffectDonut":return!0}return!1};b.isSVGImage=e=>e.includes("data:image/svg+xml");
b.mapCIMSymbolToGeometryType=function(e){if(!e)return null;switch(e.type){case "CIMPointSymbol":case "CIMTextSymbol":return"esriGeometryPoint";case "CIMLineSymbol":return"esriGeometryPolyline";case "CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}};b.resampleHermite=function(e,f,l,q,r,c,t=!0){const h=f/r;l/=c;const u=Math.ceil(h/2),L=Math.ceil(l/2);for(let y=0;y<c;y++)for(let p=0;p<r;p++){const I=4*(p+(t?c-y-1:y)*r);var K=0;let R=0,D=0,E=0,N=0,C=0,P=0;const H=(y+.5)*l;for(let J=
Math.floor(y*l);J<(y+1)*l;J++){var F=Math.abs(H-(J+.5))/L;const z=(p+.5)*h;F*=F;for(let A=Math.floor(p*h);A<(p+1)*h;A++){let v=Math.abs(z-(A+.5))/u;K=Math.sqrt(F+v*v);-1<=K&&1>=K&&(K=2*K*K*K-3*K*K+1,0<K&&(v=4*(A+J*f),P+=K*e[v+3],D+=K,255>e[v+3]&&(K=K*e[v+3]/250),E+=K*e[v],N+=K*e[v+1],C+=K*e[v+2],R+=K))}}q[I]=E/R;q[I+1]=N/R;q[I+2]=C/R;q[I+3]=P/D}};b.toCIMSymbolJSON=function(e){return e.data?.symbol??null};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/previewUtils":function(){define(["exports",
"../../Color"],function(a,b){function d(m,g){return Math.round(Math.min(Math.max(m+191.25*g,0),255))}a.SymbolSizeDefaults=void 0;(function(m){m[m.size=22]="size";m[m.lineWidth=50]="lineWidth";m[m.maxSize=120]="maxSize";m[m.maxOutlineSize=80]="maxOutlineSize";m[m.tallSymbolWidth=20]="tallSymbolWidth"})(a.SymbolSizeDefaults||(a.SymbolSizeDefaults={}));a.adjustColorBrightness=function(m,g){if(null==m)return new b;if("type"in m&&("linear"===m.type||"pattern"===m.type))return m;m=new b(m);return new b([d(m.r,
g),d(m.g,g),d(m.b,g),m.a])};a.adjustColorComponentBrightness=d;a.getConeShapes=function(m,g){let x=g?a.SymbolSizeDefaults.tallSymbolWidth:m;g=g?4:6;x=x<=a.SymbolSizeDefaults.size?x-.5*g:x-g;g=.15*x;const n=x;m-=g;return[{type:"ellipse",cx:.5*x,cy:m,rx:.5*x,ry:g},{type:"path",path:[{command:"M",values:[.5*n,0]},{command:"L",values:[n,m]},{command:"L",values:[0,m]},{command:"Z",values:[]}]}]};a.getCubeShapes=function(m,g){let x=g?a.SymbolSizeDefaults.tallSymbolWidth:m;var n=g?4:6;n=x=x<=a.SymbolSizeDefaults.size?
x-.5*n:x-n;g=g?.35*x:.5*x;return[{type:"path",path:[{command:"M",values:[.5*n,0]},{command:"L",values:[n,.5*g]},{command:"L",values:[.5*n,g]},{command:"L",values:[0,.5*g]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*g]},{command:"L",values:[.5*n,g]},{command:"L",values:[.5*n,m]},{command:"L",values:[0,m-.5*g]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*n,g]},{command:"L",values:[.5*n,m]},{command:"L",values:[n,m-.5*g]},{command:"L",values:[n,.5*
g]},{command:"Z",values:[]}]}]};a.getCylinderShapes=function(m,g){var x=g?a.SymbolSizeDefaults.tallSymbolWidth:m;g=g?4:6;x=x<=a.SymbolSizeDefaults.size?x-.5*g:x-g;g=.5*x;const n=.15*x;m-=n;return[{type:"ellipse",cx:.5*x,cy:m,rx:g,ry:n},{type:"path",path:[{command:"M",values:[0,n]},{command:"L",values:[0,m]},{command:"L",values:[x,m]},{command:"L",values:[x,n]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*x,cy:n,rx:g,ry:n}]};a.getDiamondShapes=function(m){var g=m;g=g<a.SymbolSizeDefaults.size?g-
2:g-4;const x=Math.floor(m/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*g,0]},{command:"L",values:[g,.5*m-x]},{command:"L",values:[.45*g-x,.5*m+x]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*g,0]},{command:"L",values:[.45*g-x,.5*m+x]},{command:"L",values:[0,.5*m-x]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*m-x]},{command:"L",values:[.45*g-x,.5*m+x]},{command:"L",values:[.45*g,m]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",
values:[.45*g,m]},{command:"L",values:[g,.5*m-x]},{command:"L",values:[.45*g-x,.5*m+x]},{command:"Z",values:[]}]}]};a.getExtrudeSymbolShapes=function(m){const g=a.SymbolSizeDefaults.size;m*=.5;return[{type:"path",path:[{command:"M",values:[0,.35*g]},{command:"L",values:[.3*g,.7*g]},{command:"L",values:[.3*g,.7*g+m]},{command:"L",values:[0,.7*g+m-.35*g]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*g,.7*g]},{command:"L",values:[.3*g,.7*g+m]},{command:"L",values:[g,m]},{command:"L",
values:[g,0]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*g,0]},{command:"L",values:[g,0]},{command:"L",values:[.3*g,.7*g]},{command:"L",values:[0,.35*g]},{command:"Z",values:[]}]}]};a.getInvertedConeShapes=function(m){let g=m;g=g<a.SymbolSizeDefaults.size?g-3:g-6;const x=.15*g,n=g;return[{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[n,0]},{command:"L",values:[.5*n,m-x]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*g,cy:0,rx:.5*g,ry:x}]};a.getPathSymbolShapes=
function(m,g,x){var n=a.SymbolSizeDefaults.size;let B=n,M=n;1>m?B*=.75:1<m&&(M*=1.25);m=n;g&&x&&(B=M=m=n=0);return[{type:"path",path:[{command:"M",values:[m,0]},{command:"L",values:[x?m:.875*m,0]},{command:"L",values:[x?B-.5*m:0,M-.5*n]},{command:"L",values:[B-.5*m,M-.5*n]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[m,0]},{command:"L",values:[m,g?0:.125*n]},{command:"L",values:[B-.5*m,g?M-.5*n:n]},{command:"L",values:[B-.5*m,M-.5*n]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",
values:[B-.5*m,M-.5*n]},{command:"L",values:[x?B-.5*m:0,M-.5*n]},{command:"L",values:[x?B-.5*m:0,g?M-.5*n:n]},{command:"L",values:[B-.5*m,g?M-.5*n:n]},{command:"Z",values:[]}]}]};a.getTetrahedronShapes=function(m){var g=m;g=g<a.SymbolSizeDefaults.size?g-1:g-2;return[{type:"path",path:[{command:"M",values:[.45*m,0]},{command:"L",values:[m,g]},{command:"L",values:[.45*m,.6*g]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*m,0]},{command:"L",values:[.45*m,.6*g]},{command:"L",
values:[0,g]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,g]},{command:"L",values:[.45*m,.6*g]},{command:"L",values:[m,g]},{command:"Z",values:[]}]}]};a.getWaterSymbolShapes=function(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},
{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},
{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]};
a.shapes={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],squareFill:[{type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 Z"}],meshSymbol3DFill:[{type:"path",path:"M -10,-8 L 6,0 L 6,6 L -10,6 L -10,-8 Z"},{type:"path",path:"M -10,-8 L -7,-10 L 9,-2 L 6,0 L -10,-8 Z"},{type:"path",path:"M 6,0 L 9,-2 L 9,4 L 6,6 L 6,0 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",
path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",
path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,
cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",
path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/renderUtils":function(){define("exports ../../kernel ../../request ../../core/colorUtils ../../core/Error ../../core/has ../../libs/maquette/projection ../../libs/maquette/projector ./svgUtils ./utils".split(" "),function(a,b,d,m,g,x,n,B,M,k){function w(l,q){f.append(l,q);f.detach(q)}function e(l,q,r){return l?d(l,{responseType:"image"}).then(c=>{c=c.data;const t=c.width,h=
c.height,u=t/h;let L=q;r&&(L=Math.min(L,Math.max(t,h)));return{image:c,width:1>=u?Math.ceil(L*u):L,height:1>=u?L:Math.ceil(L/u)}}):Promise.reject(new g("renderUtils: imageDataSize","href not provided."))}const f=B.createProjector();a.renderOnce=w;a.renderSymbol=function(l,q,r){const c=Math.ceil(q[0]),t=Math.ceil(q[1]);if(!l.some(h=>!!h.length))return null;q=r?.node||document.createElement("div");null!=r.opacity&&(q.style.opacity=r.opacity.toString());null!=r.effectView&&(q.style.filter=k.getCSSFilterFromEffectList(r.effectView));
w(q,()=>M.renderSVG(l,c,t,r));return q};a.tintImageWithColor=function(l,q,r,c,t){return e(l,q,t).then(h=>{const u=h.width??q,L=h.height??q;var K;if(K=h.image)K=r&&"ignore"!==c?"multiply"===c&&255===r.r&&255===r.g&&255===r.b&&1===r.a?!1:!0:!1;if(K){var F=h.image.width,y=h.image.height;x("edge")&&/\.svg$/i.test(l)&&(--F,--y);K=Math.ceil(u);var p=Math.ceil(L);var I=document.createElement("canvas");I.width=K;I.height=p;I.style.width=K+"px";I.style.height=p+"px";I=I.getContext("2d");I.clearRect(0,0,K,
p);K=I;K.drawImage(h.image,0,0,F,y,0,0,u,L);p=K.getImageData(0,0,u,L);I=[r.r/255,r.g/255,r.b/255,r.a];const D=m.toHSV(r);for(let E=0;E<p.data.length;E+=4){h=p.data;F=E;y=I;var R=D;switch(c){case "multiply":h[F]*=y[0];h[F+1]*=y[1];h[F+2]*=y[2];h[F+3]*=y[3];break;default:const N=m.toHSV({r:h[F],g:h[F+1],b:h[F+2]});N.h=R.h;N.s=R.s;N.v=N.v/100*R.v;R=m.toRGB(N);h[F]=R.r;h[F+1]=R.g;h[F+2]=R.b;h[F+3]*=y[3]}}K.putImageData(p,0,0);l=K.canvas.toDataURL("image/png")}else K=b.id?.findCredential(l),K?.token&&
(h=l.includes("?")?"\x26":"?",l=`${l}${h}token=${K.token}`);return{url:l,width:u,height:L}}).catch(()=>({url:l,width:q,height:q}))};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/colorUtils":function(){define(["exports","../Color","../chunks/vec4","../chunks/vec4f64"],function(a,b,d,m){function g(c,t){const h=[];let u,L;if(c[0].length!==t.length)throw Error("dimensions do not match");const K=c.length,F=c[0].length;let y=0;for(u=0;u<K;u++){for(L=y=0;L<F;L++)y+=c[u][L]*t[L];
h.push(y)}return h}function x(c){c=[c.r/255,c.g/255,c.b/255].map(t=>.04045>=t?t/12.92:((t+.055)/1.055)**2.4);c=g(q,c);return{x:100*c[0],y:100*c[1],z:100*c[2]}}function n(c){c=g(r,[c.x/100,c.y/100,c.z/100]).map(t=>Math.min(1,Math.max(.0031308>=t?12.92*t:1.055*t**(1/2.4)-.055,0)));return{r:Math.round(255*c[0]),g:Math.round(255*c[1]),b:Math.round(255*c[2])}}function B(c){c=[c.x/95.047,c.y/100,c.z/108.883].map(t=>t>(6/29)**3?t**(1/3):1/3*(29/6)**2*t+4/29);return{l:116*c[1]-16,a:500*(c[0]-c[1]),b:200*
(c[1]-c[2])}}function M(c){const t=c.l;c=[(t+16)/116+c.a/500,(t+16)/116,(t+16)/116-c.b/200].map(h=>h>6/29?h**3:3*(6/29)**2*(h-4/29));return{x:95.047*c[0],y:100*c[1],z:108.883*c[2]}}function k(c){if("r"in c&&"g"in c&&"b"in c)return c;if("l"in c&&"c"in c&&"h"in c){var t=c.c,h=c.h;return n(M({l:c.l,a:t*Math.cos(h),b:t*Math.sin(h)}))}if("l"in c&&"a"in c&&"b"in c)return n(M(c));if("x"in c&&"y"in c&&"z"in c)return n(c);if("h"in c&&"s"in c&&"v"in c){h=(c.h+360)%360/60;t=c.v/100*255;c=c.s/100*t;const u=c*
(1-Math.abs(h%2-1));switch(Math.floor(h)){case 0:h={r:c,g:u,b:0};break;case 1:h={r:u,g:c,b:0};break;case 2:h={r:0,g:c,b:u};break;case 3:h={r:0,g:u,b:c};break;case 4:h={r:u,g:0,b:c};break;case 5:case 6:h={r:c,g:0,b:u};break;default:h={r:0,g:0,b:0}}h.r=Math.round(h.r+t-c);h.g=Math.round(h.g+t-c);h.b=Math.round(h.b+t-c);return h}return c}function w(c){if("h"in c&&"s"in c&&"v"in c)return c;var t=k(c);c=t.r;const h=t.g,u=t.b;t=Math.max(c,h,u);const L=t-Math.min(c,h,u);c=0===L?0:t===c?(h-u)/L%6:t===h?(u-
c)/L+2:(c-h)/L+4;0>c&&(c+=6);return{h:60*c,s:100*(0===L?0:L/t),v:100/255*t}}function e(c){return"l"in c&&"a"in c&&"b"in c?c:B(x(k(c)))}function f(c){let {r:t,g:h,b:u,a:L}=c;1>L&&(t=Math.round(L*t+255*(1-L)),h=Math.round(L*h+255*(1-L)),u=Math.round(L*u+255*(1-L)));return new b({r:t,g:h,b:u})}function l(c,t){const {r:h,g:u,b:L}=t?.ignoreAlpha?c:f(c);return.2126*h+.7152*u+.0722*L}const q=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],r=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,
-.204,1.057]];a.BrightnessThreshold=void 0;(function(c){c[c.Low=160]="Low";c[c.High=225]="High"})(a.BrightnessThreshold||(a.BrightnessThreshold={}));a.colorEquals=function(c,t){return c===t||null!=c&&c.equals(t)};a.colorVectorEquals=function(c,t){return c===t||null!=c&&null!=t&&d.equals(c,t)};a.colorVectorToColorAndOpacity=function(c){return m.fromValues(c[0],c[1],c[2],3<c.length?c[3]:1)};a.darken=function(c,t){var h=e(c);h.l*=1-t;t=k(h);h=c.clone();h.setColor(t);h.a=c.a;return h};a.desaturate=function(c,
t){var h=w(c);h.s*=t;t=k(h);h=c.clone();h.setColor(t);h.a=c.a;return h};a.getColorLuminance=l;a.getColorTheme=function(c){return f(c).isBright?"light":"dark"};a.getContrast=function(c,t=a.BrightnessThreshold.High){return l(c,{ignoreAlpha:!0})>t?new b([0,0,0,c.a]):new b([255,255,255,c.a])};a.multiplyOpacity=function(c,t){c=c.clone();c.a*=t;return c};a.multiplyOpacityToUnitRGBA=function(c,t){c=b.toUnitRGBA(c);c[3]*=t;return c};a.toHSV=w;a.toLAB=e;a.toLCH=function(c){if(!("l"in c&&"c"in c&&"h"in c)){var t=
B(x(k(c)));c=t.l;var h=t.a;const u=t.b;t=Math.sqrt(h*h+u*u);h=Math.atan2(u,h);h=0<h?h:h+2*Math.PI;c={l:c,c:t,h}}return c};a.toRGB=k;a.unitRGBAFromColor=function(c){return b.toUnitRGBA(c)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/svgUtils":function(){define("exports ../../Color ../../core/has ../../core/maybe ../../chunks/mat2df32 ../../chunks/mat2d ../../widgets/support/widgetUtils ../../widgets/support/jsxFactory".split(" "),function(a,b,d,m,g,x,n,B){function M(z,
A){z*=H/180;return Math.abs(A*Math.sin(z))+Math.abs(A*Math.cos(z))}function k(z){return z.map(A=>`${A.command} ${A.values.join(" ")}`).join(" ").trim()}function w(z,A,v,G){if(z){if("circle"===z.type)return B.tsx("circle",{cx:z.cx,cy:z.cy,fill:A,"fill-rule":"evenodd",r:z.r,stroke:v.color,"stroke-dasharray":v.dashArray,"stroke-dashoffset":v.dashOffset,"stroke-linecap":v.cap,"stroke-linejoin":v.join,"stroke-miterlimit":"4","stroke-width":v.width});if("ellipse"===z.type)return B.tsx("ellipse",{cx:z.cx,
cy:z.cy,fill:A,"fill-rule":"evenodd",rx:z.rx,ry:z.ry,stroke:v.color,"stroke-dasharray":v.dashArray,"stroke-linecap":v.cap,"stroke-linejoin":v.join,"stroke-miterlimit":"4","stroke-width":v.width});if("rect"===z.type)return B.tsx("rect",{fill:A,"fill-rule":"evenodd",height:z.height,stroke:v.color,"stroke-dasharray":v.dashArray,"stroke-linecap":v.cap,"stroke-linejoin":v.join,"stroke-miterlimit":"4","stroke-width":v.width,width:z.width,x:z.x,y:z.y});if("image"===z.type)return B.tsx("image",{height:z.height,
href:z.src,preserveAspectRatio:"none",width:z.width,x:z.x,y:z.y});if("path"===z.type)return z="string"!==typeof z.path?k(z.path):z.path,B.tsx("path",{d:z,fill:A,"fill-rule":"evenodd",stroke:v.color,"stroke-dasharray":v.dashArray,"stroke-linecap":v.cap,"stroke-linejoin":v.join,"stroke-miterlimit":"4","stroke-width":v.width});if("text"===z.type)return m.assertIsSome(G),B.tsx("text",{"dominant-baseline":G.dominantBaseline,fill:A,"fill-rule":"evenodd","font-family":G.font.family,"font-size":G.font.size,
"font-style":G.font.style,"font-variant":G.font.variant,"font-weight":G.font.weight,kerning:G.kerning,rotate:G.rotate,stroke:v.color,"stroke-dasharray":v.dashArray,"stroke-linecap":v.cap,"stroke-linejoin":v.join,"stroke-miterlimit":"4","stroke-width":v.width,"text-anchor":G.align,"text-decoration":G.decoration,"text-rendering":R,x:z.x,y:z.y},z.text)}return null}function e(z){const A={fill:"none",pattern:null,linearGradient:null};if(z)if("type"in z&&"pattern"===z.type){var v=`patternId-${++p}`;A.fill=
`url(#${v})`;A.pattern={id:v,x:z.x,y:z.y,width:z.width,height:z.height,image:{x:0,y:0,width:z.width,height:z.height,href:z.src}}}else"type"in z&&"linear"===z.type?(v=`linearGradientId-${++I}`,A.fill=`url(#${v})`,A.linearGradient={id:v,x1:z.x1,y1:z.y1,x2:z.x2,y2:z.y2,stops:z.colors.map(G=>({offset:G.offset,color:G.color&&(new b(G.color)).toString()}))}):z&&(z=new b(z),A.fill=z.toString());return A}function f(z){const A={color:"none",width:1,cap:"butt",join:"4",dashArray:"none",dashOffset:"0"};if(z&&
(null!=z.width&&(A.width=z.width),z.cap&&(A.cap=z.cap),z.join&&(A.join=z.join.toString()),z.color&&(A.color=(new b(z.color)).toString()),z.dashArray&&(A.dashArray=z.dashArray),z.dashArray&&(A.dashOffset=z.dashoffset),z.style)){let v=null;z.style in P&&(v=P[z.style]);if(Array.isArray(v)){v=v.slice(0);const G=z.width??0;for(let O=0;O<v.length;++O)v[O]*=G;if("butt"!==z.cap){for(z=0;z<v.length;z+=2)v[z]-=G,1>v[z]&&(v[z]=1);for(z=1;z<v.length;z+=2)v[z]+=G}v=v.join(",")}A.dashArray=v}return A}function l(z,
A){const v={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};if(z){const G=z.alignBaseline;v.align=z.align;v.dominantBaseline="baseline"===G?"auto":"top"===G?"text-top":"bottom"===G?"hanging":G;v.decoration=z.decoration;v.kerning=z.kerning?"auto":"0";v.rotate=z.rotated?"90":"0";m.assertIsSome(A);v.font.style=A.style||"normal";v.font.variant=A.variant||"normal";v.font.weight=A.weight||"normal";v.font.size=A.size&&A.size.toString()||
"10pt";v.font.family=A.family||"serif"}return v}function q(z){const {pattern:A,linearGradient:v}=z;return A?B.tsx("pattern",{height:A.height,id:A.id,patternUnits:"userSpaceOnUse",width:A.width,x:A.x,y:A.y},B.tsx("image",{height:A.image.height,href:A.image.href,width:A.image.width,x:A.image.x,y:A.image.y})):v?(z=v.stops.map((G,O)=>B.tsx("stop",{key:`${O}-stop`,offset:G.offset,"stop-color":G.color})),B.tsx("linearGradient",{gradientUnits:"userSpaceOnUse",id:v.id,x1:v.x1,x2:v.x2,y1:v.y1,y2:v.y2},z)):
null}function r(z,A){if(!z||0===z.length)return null;const v=[];for(const G of z){const {shape:O,fill:U,stroke:ca,font:X}=G;z=e(U);const da=f(ca),ha="text"===O.type?l(O,X):null;(z=w(O,z.fill,da,ha))&&v.push(z)}return B.tsx("mask",{id:A,maskUnits:"userSpaceOnUse"},B.tsx("g",null,v))}function c(z,A,v,G,O){x.scale(z,x.identity(z),[A,v]);z[4]=z[4]*A-G*A+G;z[5]=z[5]*v-O*v+O;return z}function t(z,A){if(N&&"left"in N){null!=N.left&&N.left>z&&(N.left=z);if(null==N.right||N.right<z)N.right=z;if(null==N.top||
N.top>A)N.top=A;if(null==N.bottom||N.bottom<A)N.bottom=A}else N={left:z,bottom:A,right:z,top:A}}function h(z){const A=z.args,v=A.length;switch(z.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(z=0;z<v;z+=2)t(A[z],A[z+1]);C.x=A[v-2];C.y=A[v-1];break;case "H":for(z=0;z<v;++z)t(A[z],C.y);C.x=A[v-1];break;case "V":for(z=0;z<v;++z)t(C.x,A[z]);C.y=A[v-1];break;case "m":z=0;"x"in C||(t(C.x=A[0],C.y=A[1]),z=2);for(;z<v;z+=2)t(C.x+=A[z],C.y+=A[z+1]);break;case "l":case "t":for(z=0;z<v;z+=
2)t(C.x+=A[z],C.y+=A[z+1]);break;case "h":for(z=0;z<v;++z)t(C.x+=A[z],C.y);break;case "v":for(z=0;z<v;++z)t(C.x,C.y+=A[z]);break;case "c":for(z=0;z<v;z+=6)t(C.x+A[z],C.y+A[z+1]),t(C.x+A[z+2],C.y+A[z+3]),t(C.x+=A[z+4],C.y+=A[z+5]);break;case "s":case "q":for(z=0;z<v;z+=4)t(C.x+A[z],C.y+A[z+1]),t(C.x+=A[z+2],C.y+=A[z+3]);break;case "A":for(z=0;z<v;z+=7)t(A[z+5],A[z+6]);C.x=A[v-2];C.y=A[v-1];break;case "a":for(z=0;z<v;z+=7)t(C.x+=A[z+5],C.y+=A[z+6])}}function u(z,A,v){const G=D[z.toLowerCase()];"number"===
typeof G&&(G?A.length>=G&&(z={action:z,args:A.slice(0,A.length-A.length%G)},v.push(z),h(z)):(z={action:z,args:[]},v.push(z),h(z)))}function L(z){const A={x:0,y:0,width:0,height:0};if("circle"===z.type)A.x=z.cx-z.r,A.y=z.cy-z.r,A.width=2*z.r,A.height=2*z.r;else if("ellipse"===z.type)A.x=z.cx-z.rx,A.y=z.cy-z.ry,A.width=2*z.rx,A.height=2*z.ry;else if("image"===z.type||"rect"===z.type)A.x=z.x,A.y=z.y,A.width=z.width,A.height=z.height;else if("path"===z.type){{const O=("string"!==typeof z.path?k(z.path):
z.path).match(E),U=[];N={};C={};if(O){z="";var v=[],G=O.length;for(let ca=0;ca<G;++ca){const X=O[ca],da=parseFloat(X);isNaN(da)?(z&&u(z,v,U),v=[],z=X):v.push(da)}u(z,v,U);z={x:0,y:0,width:0,height:0};N&&"left"in N&&(z.x=N.left,z.y=N.top,z.width=N.right-N.left,z.height=N.bottom-N.top)}else z=null}A.x=z.x;A.y=z.y;A.width=z.width;A.height=z.height}return A}function K(z){const A={x:0,y:0,width:0,height:0};let v=null,G=Number.NEGATIVE_INFINITY,O=Number.NEGATIVE_INFINITY;for(const U of z)v?(v.x=Math.min(v.x,
U.x),v.y=Math.min(v.y,U.y),G=Math.max(G,U.x+U.width),O=Math.max(O,U.y+U.height)):(v=A,v.x=U.x,v.y=U.y,G=U.x+U.width,O=U.y+U.height);v&&(v.width=G-v.x,v.height=O-v.y);return v}function F(z,A,v,G,O,U,ca,X,da){var ha=(ca&&U?M(U,A):A)/2,ia=(ca&&U?M(U,v):v)/2;if(da){var ma=da[0];da=da[1];ha=(ca&&U?M(U,ma):ma)/2;ia=(ca&&U?M(U,da):da)/2}ma=z.width+G;var ea=z.height+G;da=g.create();ca=g.create();var S=!1;if(O&&0!==ma&&0!==ea){O=A!==v?A/v:ma/ea;S=A>v?A:v;let T=1,ba=1;isNaN(S)||(1<O?(T=S/ma,ba=S/O/ea):(ba=
S/ea,T=S*O/ma));x.multiply(ca,ca,c(da,T,ba,ha,ia));S=!0}O=z.x+(ma-G)/2;z=z.y+(ea-G)/2;G=x.multiply;ha-=O;ia-=z;ha=x.translate(da,x.identity(da),[ha,ia]);G.call(x,ca,ca,ha);!S&&(ma>A||ea>v)&&(ha=ma/A>ea/v,A=(ha?A:v)/(ha?ma:ea),x.multiply(ca,ca,c(da,A,A,O,z)));U&&(A=x.multiply,v=U%360*Math.PI/180,x.rotate(da,x.identity(da),v),U=Math.cos(v),v=Math.sin(v),ma=da[4],ea=da[5],da[4]=ma*U-ea*v+z*v-O*U+O,da[5]=ea*U+ma*v-O*v-z*U+z,A.call(x,ca,ca,da));X&&(U=x.multiply,A=X[0],X=X[1],X=x.translate(da,x.identity(da),
[A,X]),U.call(x,ca,ca,X));return`matrix(${ca[0]},${ca[1]},${ca[2]},${ca[3]},${ca[4]},${ca[5]})`}function y(z,A,v){z=z?.effects.find(X=>"bloom"===X.type);if(!z)return null;const {strength:G,radius:O}=z;z=0<G?O:0;const U=(G+z)*A,ca=4*G+1;return B.tsx("filter",{filterUnits:"userSpaceOnUse",height:"300%",id:`bloom${v}`,width:"300%",x:"-100%",y:"-100%"},B.tsx("feMorphology",{in:"SourceGraphic",operator:"dilate",radius:(G+.5*z)*5**(A/100)*(.4+A/100),result:"dilate"}),B.tsx("feGaussianBlur",{in:"dilate",
result:"blur",stdDeviation:U/25}),B.tsx("feGaussianBlur",{in:"blur",result:"intensityBlur",stdDeviation:U/50}),B.tsx("feComponentTransfer",{in:"SourceGraphic",result:"intensityBrightness"},B.tsx("feFuncR",{slope:ca,type:"linear"}),B.tsx("feFuncG",{slope:ca,type:"linear"}),B.tsx("feFuncB",{slope:ca,type:"linear"})),B.tsx("feMerge",null,B.tsx("feMergeNode",{in:"intensityBlur"}),B.tsx("feMergeNode",{in:"intensityBrightness"}),B.tsx("feGaussianBlur",{stdDeviation:G/10})))}let p=0,I=0;n=d("android");const R=
d("chrome")||n&&4<=n?"auto":"optimizeLegibility",D={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},E=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g;let N={},C={};const P={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]},H=Math.PI;let J=1;a.computeBBox=K;a.generateFillAttributes=e;a.generateStrokeAttributes=f;a.generateTextAttributes=l;a.getBoundingBox=
L;a.getTransformMatrix=F;a.renderDef=q;a.renderSVG=function(z,A,v,G={}){const O=[],U=[],ca=++J,X=y(G.effectView,A,ca);var da=null;X&&(da=G.effectView?.effects.find(S=>"bloom"===S.type),da=(da.strength?da.strength+da.radius/2:0)/3,da=[Math.max(A+A*da,10),Math.max(v+v*da,10)]);for(let S=0;S<z.length;S++){var ha=z[S];const T=[];var ia=[],ma=0,ea=0;let ba=0;for(const Q of ha){const {shape:W,fill:Z,stroke:aa,font:fa,offset:ka}=Q;G.ignoreStrokeWidth||"text"===W.type||(ma+=aa?.width||0);ha=e(Z);const la=
f(aa),ja="text"===W.type?l(W,fa):null;O.push(q(ha));T.push(w(W,ha.fill,la,ja));ia.push(L(W));ka&&(ea+=ka[0],ba+=ka[1])}ia=K(ia);ma=F(ia,A,v,ma,G.scale??!1,G.rotation,G.useRotationSize??!1,[ea,ba],da);ea=null;G.masking&&(ea=`mask-${S}`,O.push(r(G.masking[S],ea)),ea=`url(#${ea})`);U.push(ea?B.tsx("g",{mask:ea},B.tsx("g",{transform:ma},T)):B.tsx("g",{transform:ma},T))}G.useRotationSize&&G.rotation&&(A=M(G.rotation,A),v=M(G.rotation,v));X&&(m.assertIsSome(da),A=da[0],v=da[1]);return B.tsx("svg",{"aria-labelledby":G.ariaLabel,
focusable:!1,height:v,role:"img",style:"display: block;",width:A,xmlns:"http://www.w3.org/2000/svg"},X,B.tsx("defs",null,O),X?B.tsx("g",{filter:`url(#bloom${ca})`},U):U)};a.renderShape=w;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/mat2df32":function(){define(["exports"],function(a){function b(){const M=new Float32Array(6);M[0]=1;M[3]=1;return M}function d(M){const k=new Float32Array(6);k[0]=M[0];k[1]=M[1];k[2]=M[2];k[3]=M[3];k[4]=M[4];k[5]=M[5];return k}function m(M,
k,w,e,f,l){const q=new Float32Array(6);q[0]=M;q[1]=k;q[2]=w;q[3]=e;q[4]=f;q[5]=l;return q}function g(M,k){return new Float32Array(M,k,6)}function x(M,k,w,e){const f=k[e];k=k[e+1];M[e]=w[0]*f+w[2]*k+w[4];M[e+1]=w[1]*f+w[3]*k+w[5]}function n(M,k,w,e=0,f=0,l=2){for(f=f||k.length/l;e<f;e++)x(M,k,w,e*l)}const B=Object.freeze(Object.defineProperty({__proto__:null,clone:d,create:b,createView:g,fromValues:m,transform:x,transformMany:n},Symbol.toStringTag,{value:"Module"}));a.clone=d;a.create=b;a.createView=
g;a.fromValues=m;a.mat2df32=B;a.transform=x;a.transformMany=n})},"esri/chunks/mat2d":function(){define(["exports","./common"],function(a,b){function d(y,p){y[0]=p[0];y[1]=p[1];y[2]=p[2];y[3]=p[3];y[4]=p[4];y[5]=p[5];return y}function m(y){y[0]=1;y[1]=0;y[2]=0;y[3]=1;y[4]=0;y[5]=0;return y}function g(y,p,I,R,D,E,N){y[0]=p;y[1]=I;y[2]=R;y[3]=D;y[4]=E;y[5]=N;return y}function x(y,p){const I=p[0],R=p[1],D=p[2],E=p[3],N=p[4];p=p[5];let C=I*E-R*D;if(!C)return null;C=1/C;y[0]=E*C;y[1]=-R*C;y[2]=-D*C;y[3]=
I*C;y[4]=(D*p-E*N)*C;y[5]=(R*N-I*p)*C;return y}function n(y){return y[0]*y[3]-y[1]*y[2]}function B(y,p,I){const R=p[0],D=p[1],E=p[2],N=p[3],C=p[4];p=p[5];const P=I[0],H=I[1],J=I[2],z=I[3],A=I[4];I=I[5];y[0]=R*P+E*H;y[1]=D*P+N*H;y[2]=R*J+E*z;y[3]=D*J+N*z;y[4]=R*A+E*I+C;y[5]=D*A+N*I+p;return y}function M(y,p,I){const R=p[0],D=p[1],E=p[2],N=p[3],C=p[4];p=p[5];const P=Math.sin(I);I=Math.cos(I);y[0]=R*I+E*P;y[1]=D*I+N*P;y[2]=R*-P+E*I;y[3]=D*-P+N*I;y[4]=C;y[5]=p;return y}function k(y,p,I){const R=p[1],
D=p[2],E=p[3],N=p[4],C=p[5],P=I[0];I=I[1];y[0]=p[0]*P;y[1]=R*P;y[2]=D*I;y[3]=E*I;y[4]=N;y[5]=C;return y}function w(y,p,I){const R=p[0],D=p[1],E=p[2],N=p[3],C=p[4];p=p[5];const P=I[0];I=I[1];y[0]=R;y[1]=D;y[2]=E;y[3]=N;y[4]=R*P+E*I+C;y[5]=D*P+N*I+p;return y}function e(y,p){const I=Math.sin(p);p=Math.cos(p);y[0]=p;y[1]=I;y[2]=-I;y[3]=p;y[4]=0;y[5]=0;return y}function f(y,p){y[0]=p[0];y[1]=0;y[2]=0;y[3]=p[1];y[4]=0;y[5]=0;return y}function l(y,p){y[0]=1;y[1]=0;y[2]=0;y[3]=1;y[4]=p[0];y[5]=p[1];return y}
function q(y){return"mat2d("+y[0]+", "+y[1]+", "+y[2]+", "+y[3]+", "+y[4]+", "+y[5]+")"}function r(y){return Math.sqrt(y[0]**2+y[1]**2+y[2]**2+y[3]**2+y[4]**2+y[5]**2+1)}function c(y,p,I){y[0]=p[0]+I[0];y[1]=p[1]+I[1];y[2]=p[2]+I[2];y[3]=p[3]+I[3];y[4]=p[4]+I[4];y[5]=p[5]+I[5];return y}function t(y,p,I){y[0]=p[0]-I[0];y[1]=p[1]-I[1];y[2]=p[2]-I[2];y[3]=p[3]-I[3];y[4]=p[4]-I[4];y[5]=p[5]-I[5];return y}function h(y,p,I){y[0]=p[0]*I;y[1]=p[1]*I;y[2]=p[2]*I;y[3]=p[3]*I;y[4]=p[4]*I;y[5]=p[5]*I;return y}
function u(y,p,I,R){y[0]=p[0]+I[0]*R;y[1]=p[1]+I[1]*R;y[2]=p[2]+I[2]*R;y[3]=p[3]+I[3]*R;y[4]=p[4]+I[4]*R;y[5]=p[5]+I[5]*R;return y}function L(y,p){return y[0]===p[0]&&y[1]===p[1]&&y[2]===p[2]&&y[3]===p[3]&&y[4]===p[4]&&y[5]===p[5]}function K(y,p){const I=y[0],R=y[1],D=y[2],E=y[3],N=y[4];y=y[5];const C=p[0],P=p[1],H=p[2],J=p[3],z=p[4];p=p[5];const A=b.getEpsilon();return Math.abs(I-C)<=A*Math.max(1,Math.abs(I),Math.abs(C))&&Math.abs(R-P)<=A*Math.max(1,Math.abs(R),Math.abs(P))&&Math.abs(D-H)<=A*Math.max(1,
Math.abs(D),Math.abs(H))&&Math.abs(E-J)<=A*Math.max(1,Math.abs(E),Math.abs(J))&&Math.abs(N-z)<=A*Math.max(1,Math.abs(N),Math.abs(z))&&Math.abs(y-p)<=A*Math.max(1,Math.abs(y),Math.abs(p))}const F=Object.freeze(Object.defineProperty({__proto__:null,add:c,copy:d,determinant:n,equals:K,exactEquals:L,frob:r,fromRotation:e,fromScaling:f,fromTranslation:l,identity:m,invert:x,mul:B,multiply:B,multiplyScalar:h,multiplyScalarAndAdd:u,rotate:M,scale:k,set:g,str:q,sub:t,subtract:t,translate:w},Symbol.toStringTag,
{value:"Module"}));a.add=c;a.copy=d;a.determinant=n;a.equals=K;a.exactEquals=L;a.frob=r;a.fromRotation=e;a.fromScaling=f;a.fromTranslation=l;a.identity=m;a.invert=x;a.mat2d=F;a.mul=B;a.multiply=B;a.multiplyScalar=h;a.multiplyScalarAndAdd=u;a.rotate=M;a.scale=k;a.set=g;a.str=q;a.sub=t;a.subtract=t;a.translate=w})},"esri/symbols/support/utils":function(){define("require exports ../../Color ../../symbols ../../core/asyncUtils ../../core/has ../../core/screenUtils ../../chunks/vec3f64 ../../layers/effects/jsonUtils ./cimSymbolUtils ./gfxUtils ./Symbol3DMaterial".split(" "),
function(a,b,d,m,g,x,n,B,M,k,w,e){function f(y){y=y.symbolLayers;if(!y)return null;let p=null;y.forEach(I=>{"object"===I.type&&I.resource?.href||(p="water"===I.type?I.color:I.material?I.material.color:null)});return p?new d(p):null}function l(y,p){if(null==p||null==y)return y;y=y.toRgba();y[3]*=p;return new d(y)}function q(y,p,I){if(y=y.symbolLayers){var R=D=>{p=p??D??(null!=I?F:null);return l(p,I)};y.forEach(D=>{if("object"!==D.type||!D.resource?.href||p)if("water"===D.type)D.color=R(D.color);else{const E=
R(null!=D.material?D.material.color:null);null==D.material?D.material=new e.Symbol3DMaterial({color:E}):D.material.color=E;null!=I&&"outline"in D&&null!=D.outline?.color&&(D.outline.color=l(D.outline.color,I))}})}}async function r(y,p){(y=y.symbolLayers)&&await g.forEach(y,async I=>c(I,p))}async function c(y,p){switch(y.type){case "extrude":y.size="number"===typeof p[2]?p[2]:0;break;case "icon":case "line":case "text":p=t(p);null!=p&&(y.size=p);break;case "path":const I=u(p,B.ONES,[y.width,void 0,
y.height]);y.width=K(p[0],y.width,1,I);y.height=K(p[2],y.height,1,I);break;case "object":await h(y,p)}}function t(y){for(const p of y)if("number"===typeof p)return p;return null}async function h(y,p){const {resourceSize:I,symbolSize:R}=await L(y),D=u(p,I,R);y.width=K(p[0],R[0],I[0],D);y.depth=K(p[1],R[1],I[1],D);y.height=K(p[2],R[2],I[2],D)}function u(y,p,I){for(let R=0;3>R;R++){const D=y[R];switch(D){case "symbol-value":return y=I[R],null!=y?y/p[R]:1;case "proportional":break;default:if(D&&p[R])return D/
p[R]}}return 1}async function L(y){var {computeObjectLayerResourceSize:p}=await new Promise((C,P)=>a(["./symbolLayerUtils"],C,P));p=await p(y,10);const {width:I,height:R,depth:D}=y;y=[I,D,R];let E=1;for(var N=0;3>N;N++){const C=y[N];if(null!=C){E=C/p[N];break}}for(N=0;3>N;N++)null==y[N]&&(y[N]=p[N]*E);return{resourceSize:p,symbolSize:y}}function K(y,p,I,R){switch(y){case "proportional":return I*R;case "symbol-value":return null!=p?p:I;default:return y}}const F=new d("white");b.applyColorToSymbol=
function(y,p,I){if(y&&(p||null!=I))if(p&&(p=new d(p)),m.isSymbol3D(y))q(y,p,I);else if(m.isSymbol2D(y)){if(p=p??y.color)y.color=l(p,I);null!=I&&"outline"in y&&y.outline?.color&&(y.outline.color=l(y.outline.color,I))}};b.applyOpacityToColor=l;b.applyRotationToSymbol=function(y,p,I){y&&null!=p&&(m.isSymbol3D(y)?(y=y.symbolLayers)&&y.forEach(R=>{if(R&&"object"===R.type)switch(I){case "tilt":R.tilt=p;break;case "roll":R.roll=p;break;default:R.heading=p}}):!m.isSymbol2D(y)||"simple-marker"!==y.type&&"picture-marker"!==
y.type&&"text"!==y.type||(y.angle=p))};b.applySizesToSymbol=async function(y,p){if(y&&p){if(m.isSymbol3D(y))return r(y,p);if(m.isSymbol2D(y)&&(p=t(p),null!=p))switch(y.type){case "simple-marker":y.size=p;break;case "picture-marker":const I=y.width/y.height;1<I?(y.width=p,y.height=p*I):(y.width=p*I,y.height=p);break;case "simple-line":y.width=p;break;case "text":y.font.size=p}}};b.fetchWebStyleSymbol=async function(y,p){const I=await y.fetchSymbol(p);return I?I:y.fetchCIMSymbol(p)};b.getCSSFilterFromEffectList=
function(y){if(!y)return null;y=y.effects.filter(p=>"bloom"!==p.type).map(p=>p.toJSON());return M.effectFunctionsFromJSON(y)};b.getColorFromSymbol=function(y,p){if(!y)return null;let I=null;m.isSymbol3D(y)?I=f(y):m.isSymbol2D(y)&&(I="cim"===y.type?k.getCIMSymbolColor(y):y.color?new d(y.color):null);return I?l(I,p):null};b.getIconHref=function(y){return y.resource?.href??""};b.getSymbolOutlineSize=function(y){return y?m.isSymbol3D(y)?(y=(y=y.symbolLayers?.at(-1))&&"outline"in y?y?.outline?.size:void 0,
null!=y?y:0):n.px2pt(w.getStroke(y)?.width):0};b.isVolumetricSymbol=function(y){if(null==y||!("symbolLayers"in y)||null==y.symbolLayers)return!1;switch(y.type){case "point-3d":return y.symbolLayers.some(p=>"object"===p.type);case "line-3d":return y.symbolLayers.some(p=>"path"===p.type);case "polygon-3d":return y.symbolLayers.some(p=>"object"===p.type||"extrude"===p.type);default:return!1}};b.symbolHasExtrudeSymbolLayer=function(y){return null!=y&&"polygon-3d"===y.type&&y.symbolLayers.some(p=>"extrude"===
p.type)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/styles/support/relationshipUtils":function(){define(["exports","../../../../symbols/support/svgUtils","../../../../symbols/support/utils","../../../support/widgetUtils","../../../support/jsxFactory"],function(a,b,d,m,g){function x(M,k,w){const e=`${w}_arrowStart`;w=`${w}_arrowEnd`;M="left"===M;const f={markerStart:null,markerEnd:null};switch(k){case "HL":M?f.markerStart=`url(#${w})`:f.markerEnd=`url(#${e})`;
break;case "LL":f.markerStart=`url(#${w})`;break;case "LH":M?f.markerEnd=`url(#${e})`:f.markerStart=`url(#${w})`;break;default:f.markerEnd=`url(#${e})`}return f}function n(M,k,w={}){const {focus:e,numClasses:f,colors:l,rotation:q}=M,{opacity:r,effectList:c,ariaLabel:t}=w;M=w.size??60;w=!!e;const h=Math.sqrt(M**2+M**2)+(w?0:5),u=[],L=[];var K=[],F=(M||75)/f;for(var y=0;y<f;y++){var p=y*F;for(var I=0;I<f;I++){var R=I*F,D=b.generateFillAttributes(l[y][I]);const E=b.generateStrokeAttributes(null);R={type:"rect",
x:R,y:p,width:F,height:F};const N=b.renderDef(D);N&&u.push(N);(D=b.renderShape(R,D.fill,E,null))&&L.push(D);K.push(b.getBoundingBox(R))}}F=null;w||(F="margin: -15px -15px -18px -15px");y=x("left",e,k);p=x("right",e,k);I=b.computeBBox(K);K=b.getTransformMatrix(I,h,h,0,!1,q,!1);I=b.getTransformMatrix(I,h,h,0,!1,w?-45:null,!1);D={filter:d.getCSSFilterFromEffectList(c)??void 0,opacity:null==r?"":`${r}`};return g.tsx("div",{class:w?B.diamondMidColRamp:B.squareTableCell,styles:D},g.tsx("svg",{"aria-labelledBy":t,
focusable:!1,height:h,role:"image",style:F,width:h,xmlns:"http://www.w3.org/2000/svg"},g.tsx("defs",null,g.tsx("marker",{id:`${k}_arrowStart`,markerHeight:"10",markerUnits:"strokeWidth",markerWidth:"10",orient:"auto",refX:"5",refY:"5"},g.tsx("polyline",{fill:"none",points:"0,0 5,5 0,10",stroke:"#555555","stroke-width":"1"})),g.tsx("marker",{id:`${k}_arrowEnd`,markerHeight:"10",markerUnits:"strokeWidth",markerWidth:"10",orient:"auto",refX:"0",refY:"5"},g.tsx("polyline",{fill:"none",points:"5,0 0,5 5,10",
stroke:"#555555","stroke-width":"1"})),u),g.tsx("g",{transform:K},L),g.tsx("g",{transform:I},g.tsx("line",{fill:"none","marker-end":y.markerEnd,"marker-start":y.markerStart,stroke:"#555555","stroke-width":"1",x1:-10,x2:-10,y1:M-15,y2:15}),g.tsx("line",{fill:"none","marker-end":p.markerEnd,"marker-start":p.markerStart,stroke:"#555555","stroke-width":"1",x1:15,x2:M-15,y1:M+10,y2:M+10}))))}const B={diamondContainer:"esri-relationship-ramp--diamond__container",diamondLeftCol:"esri-relationship-ramp--diamond__left-column",
diamondRightCol:"esri-relationship-ramp--diamond__right-column",diamondMidCol:"esri-relationship-ramp--diamond__middle-column",diamondMidColLabel:"esri-relationship-ramp--diamond__middle-column--label",diamondMidColRamp:"esri-relationship-ramp--diamond__middle-column--ramp",squareTable:"esri-relationship-ramp--square__table",squareTableRow:"esri-relationship-ramp--square__table-row",squareTableCell:"esri-relationship-ramp--square__table-cell",squareTableLabel:"esri-relationship-ramp--square__table-label",
squareTableLabelLeftBottom:"esri-relationship-ramp--square__table-label--left-bottom",squareTableLabelRightBottom:"esri-relationship-ramp--square__table-label--right-bottom",squareTableLabelLeftTop:"esri-relationship-ramp--square__table-label--left-top",squareTableLabelRightTop:"esri-relationship-ramp--square__table-label--right-top"};a.renderRelationshipRamp=function(M,k,w={}){const {focus:e,labels:f}=M,l=!!e;M=n(M,k,w);k={justifyContent:"center"};w=m.isRTL();return l?g.tsx("div",{class:B.diamondContainer,
styles:k},g.tsx("div",{class:B.diamondLeftCol},w?f.right:f.left),g.tsx("div",{class:B.diamondMidCol},g.tsx("div",{class:B.diamondMidColLabel},f.top),M,g.tsx("div",{class:B.diamondMidColLabel},f.bottom)),g.tsx("div",{class:B.diamondRightCol},w?f.left:f.right)):g.tsx("div",{class:B.squareTable},g.tsx("div",{class:B.squareTableRow},g.tsx("div",{class:m.classes(B.squareTableCell,B.squareTableLabel,B.squareTableLabelRightBottom)},w?f.top:f.left),g.tsx("div",{class:B.squareTableCell}),g.tsx("div",{class:m.classes(B.squareTableCell,
B.squareTableLabel,B.squareTableLabelLeftBottom)},w?f.left:f.top)),g.tsx("div",{class:B.squareTableRow},g.tsx("div",{class:B.squareTableCell}),M,g.tsx("div",{class:B.squareTableCell})),g.tsx("div",{class:B.squareTableRow},g.tsx("div",{class:m.classes(B.squareTableCell,B.squareTableLabel,B.squareTableLabelRightTop)},w?f.right:f.bottom),g.tsx("div",{class:B.squareTableCell}),g.tsx("div",{class:m.classes(B.squareTableCell,B.squareTableLabel,B.squareTableLabelLeftTop)},w?f.bottom:f.right)))};Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/relationshipRampUtils":function(){define(["exports","../../../core/lang","../../../symbols/support/gfxUtils","../../../symbols/support/previewSymbol3D"],function(a,b,d,m){function g(k){if(k){var {type:w}=k;return w.includes("3d")?m.getSymbolLayerFill(k.symbolLayers.at(0)):"simple-line"===w||"simple-marker"===k.type&&("x"===k.style||"cross"===k.style)?(k=d.getStroke(k))&&k.color:d.getFill(k)}}function x(k,w){const e=w.HH.label,f=
w.LL.label,l=w.HL.label;w=w.LH.label;switch(k){case "HH":return{top:e,bottom:f,left:l,right:w};case "HL":return{top:l,bottom:w,left:f,right:e};case "LL":return{top:f,bottom:e,left:w,right:l};case "LH":return{top:w,bottom:l,left:e,right:f};default:return{top:e,bottom:f,left:l,right:w}}}function n(k){let w=B[k];k&&null==w&&(w=B.HH);return w||0}const B={HH:315,HL:45,LL:135,LH:225},M={2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L",
"M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};a.getRelationshipRampColors2D=function(k,w){const e=[],f=k.length**.5;k=b.clone(k);var l=(w||"HH").split("");w=l[0];for(l="H"===l[1];k.length;){const q=[];for(;q.length<f;)q.push(k.shift());l&&q.reverse();e.push(q)}"L"===w&&e.reverse();return e};a.getRelationshipRampElement=function(k){const {focus:w,infos:e,numClasses:f}=k;var l=M[f];const q={};e.forEach(r=>{q[r.value]={label:r.label,fill:g(r.symbol)}});k=[];for(let r=0;r<
f;r++){const c=[];for(let t=0;t<f;t++)c.push(q[l[r][t]].fill);k.push(c)}l=x(w,q);return{type:"relationship-ramp",numClasses:f,focus:w,colors:k,labels:l,rotation:n(w)}};a.getRotationAngleForFocus=n;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/previewSymbol3D":function(){define("exports ../../assets ../../core/colorUtils ../../core/has ../../core/Error ../../core/Logger ../../core/screenUtils ./gfxUtils ./IconSymbol3DLayerResource ./ObjectSymbol3DLayerResource ./previewUtils ./renderUtils ./utils ./webStyleSymbolUtils".split(" "),
function(a,b,d,m,g,x,n,B,M,k,w,e,f,l){function q(A){const v=A.outline;var G=null!=A.material?A.material.color:null;G=null!=G?G.toHex():null;if(null==v||"pattern"in v&&null!=v.pattern&&"style"===v.pattern.type&&"none"===v.pattern.style)return"fill"===A.type&&"#ffffff"===G?{color:"#bdc3c7",width:.75}:null;A=n.pt2px(v.size)||0;return{color:"rgba("+(null!=v.color?v.color.toRgba():"255,255,255,1")+")",width:Math.min(A,H),style:"pattern"in v&&null!=v.pattern&&"style"===v.pattern.type?B.dekebabifyLineStyle(v.pattern.style):
null,join:"butt",cap:"patternCap"in v?v.patternCap:"butt"}}async function r(A,v){if(A.thumbnail?.url)return A.thumbnail.url;if("icon"===v.type&&v?.resource?.href)return f.getIconHref(v);v=b.getAssetUrl("esri/images/Legend/legend3dsymboldefault.png");return A.styleOrigin&&(A.styleOrigin.styleName||A.styleOrigin.styleUrl)&&(A=await l.resolveWebStyleSymbol(A.styleOrigin,{portal:A.styleOrigin.portal},"webRef").catch(()=>null))&&"thumbnail"in A&&A.thumbnail?.url?A.thumbnail.url:v}function c(A,v=1){const G=
A.a;A=d.toHSV(A);const {r:O,g:U,b:ca}=d.toRGB({h:A.h,s:A.s/v,v:100-(100-A.v)/v});return[O,U,ca,G]}function t(A){return"water"===A.type?null==A.color?null:A.color:null==A.material?.color?null:A.material.color}function h(A,v=0){var G=t(A);if(!G){if("fill"===A.type)return null;v=w.adjustColorComponentBrightness(B.defaultThematicColor.r,v);return[v,v,v,100]}A=G.toRgba();for(G=0;3>G;G++)A[G]=w.adjustColorComponentBrightness(A[G],v);return A}async function u(A,v){A=A.style;return"none"===A?null:{type:"pattern",
x:0,y:0,src:await B.getPatternUrlWithColor(b.getAssetUrl(`esri/symbols/patterns/${A}.png`),v.toCss(!0)),width:5,height:5}}function L(A){return A.outline?q(A):{color:"rgba(0, 0, 0, 1)",width:1.5}}function K(A,v){A=t(A);if(!A)return null;let G;G="rgba("+(w.adjustColorComponentBrightness(A.r,v)+",");G+=w.adjustColorComponentBrightness(A.g,v)+",";G+=w.adjustColorComponentBrightness(A.b,v)+",";return G+A.a+");"}function F(A,v){v=K(A,v);if(!v)return{};if("pattern"in A&&null!=A.pattern&&"style"===A.pattern.type&&
"none"===A.pattern.style)return null;const G=Math.min(A.size?n.pt2px(A.size):.75,H);return{color:v,width:G,style:"pattern"in A&&null!=A.pattern&&"style"===A.pattern.type?B.dekebabifyLineStyle(A.pattern.style):null,cap:"cap"in A?A.cap:null,join:"join"in A?"miter"===A.join?n.pt2px(2):A.join:null}}function y(A,v,G){G=null!=G?.75*G:0;return{type:"linear",x1:G?.25*G:0,y1:G?.5*G:0,x2:G||4,y2:G?.5*G:4,colors:[{color:A,offset:0},{color:v,offset:1}]}}function p(A){const v=A.depth,G=A.height;A=A.width;return 0!==
A&&0!==v&&0!==G&&A===v&&null!=A&&null!=G&&A<G}function I(A,v,G){const O=[];if(!A)return O;switch(A.type){case "icon":switch(A.resource&&A.resource.primitive||M.defaultPrimitive){case "circle":O.push({shape:{type:"circle",cx:0,cy:0,r:.5*v},fill:h(A,0),stroke:q(A)});break;case "square":O.push({shape:{type:"path",path:[{command:"M",values:[0,v]},{command:"L",values:[0,0]},{command:"L",values:[v,0]},{command:"L",values:[v,v]},{command:"Z",values:[]}]},fill:h(A,0),stroke:q(A)});break;case "triangle":O.push({shape:{type:"path",
path:[{command:"M",values:[0,v]},{command:"L",values:[.5*v,0]},{command:"L",values:[v,v]},{command:"Z",values:[]}]},fill:h(A,0),stroke:q(A)});break;case "cross":O.push({shape:{type:"path",path:[{command:"M",values:[.5*v,0]},{command:"L",values:[.5*v,v]},{command:"M",values:[0,.5*v]},{command:"L",values:[v,.5*v]}]},stroke:L(A)});break;case "x":O.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[v,v]},{command:"M",values:[v,0]},{command:"L",values:[0,v]}]},stroke:L(A)});
break;case "kite":O.push({shape:{type:"path",path:[{command:"M",values:[0,.5*v]},{command:"L",values:[.5*v,0]},{command:"L",values:[v,.5*v]},{command:"L",values:[.5*v,v]},{command:"Z",values:[]}]},fill:h(A,0),stroke:q(A)})}break;case "object":switch(A.resource&&A.resource.primitive||k.defaultPrimitive){case "cone":var U=h(A,0);A=h(A,-.6);A=y(U,A,G?z:v);v=w.getConeShapes(v,G);O.push({shape:v[0],fill:A},{shape:v[1],fill:A});break;case "inverted-cone":G=h(A,0);A=h(A,-.6);A=y(G,A,v);v=w.getInvertedConeShapes(v);
O.push({shape:v[0],fill:A},{shape:v[1],fill:G});break;case "cube":v=w.getCubeShapes(v,G);O.push({shape:v[0],fill:h(A,0)},{shape:v[1],fill:h(A,-.3)},{shape:v[2],fill:h(A,-.5)});break;case "cylinder":U=h(A,0);const ca=h(A,-.6);U=y(U,ca,G?z:v);v=w.getCylinderShapes(v,G);O.push({shape:v[0],fill:U},{shape:v[1],fill:U},{shape:v[2],fill:h(A,0)});break;case "diamond":v=w.getDiamondShapes(v);O.push({shape:v[0],fill:h(A,-.3)},{shape:v[1],fill:h(A,0)},{shape:v[2],fill:h(A,-.3)},{shape:v[3],fill:h(A,-.7)});break;
case "sphere":G=h(A,0);A=h(A,-.6);A=y(G,A);A.x1=0;A.y1=0;A.x2=.25*v;A.y2=.25*v;O.push({shape:{type:"circle",cx:0,cy:0,r:.5*v},fill:A});break;case "tetrahedron":v=w.getTetrahedronShapes(v),O.push({shape:v[0],fill:h(A,-.3)},{shape:v[1],fill:h(A,0)},{shape:v[2],fill:h(A,-.6)})}}return O}function R(A){return(A="number"===typeof A?.size?A?.size:null)?n.pt2px(A):null}async function D(A,v){const G=R(v),O=v?.maxSize?n.pt2px(v.maxSize):null,U=v?.disableUpsampling??!1,ca=A.symbolLayers,X=[];let da=0,ha=0;const ia=
ca.at(-1);let ma;ia&&"icon"===ia.type&&(ma=ia.size&&n.pt2px(ia.size));ca.forEach(S=>{if("icon"===S.type||"object"===S.type){var T="icon"===S.type?S.size&&n.pt2px(S.size):0,ba=G||T?Math.ceil(Math.min(G||T,O||P)):C;if(S?.resource?.href){var Q=r(A,S).then(W=>{const Z=S?.material?.color;var aa="icon"===S.type?"multiply":"tint";return e.tintImageWithColor(W,ba,Z,aa,U)}).then(W=>{const Z=W.width,aa=W.height;da=Math.max(da,Z);ha=Math.max(ha,aa);return[{shape:{type:"image",x:0,y:0,width:Z,height:aa,src:W.url},
fill:null,stroke:null}]});X.push(Q)}else Q=ba,"icon"===S.type&&ma&&G&&(Q=T/ma*ba),T="tall"===v?.symbolConfig||v?.symbolConfig?.isTall||("object"===S.type?p(S):!1),da=Math.max(da,T?z:Q),ha=Math.max(ha,Q),X.push(Promise.resolve(I(S,Q,T)))}});const ea=[];(await Promise.allSettled(X)).forEach(S=>{"fulfilled"===S.status?ea.push(S.value):S.reason&&x.getLogger("esri.symbols.support.previewSymbol3D").warn("error while building swatchInfo!",S.reason)});return e.renderSymbol(ea,[da,ha],{node:v?.node,scale:!1,
opacity:v?.opacity,ariaLabel:v?.ariaLabel})}function E(A,v){const G=A.symbolLayers,O=[];A=f.isVolumetricSymbol(A);const U=R(v),ca=(v?.maxSize?n.pt2px(v.maxSize):null)||H;let X=0,da=0,ha;G.forEach((ia,ma)=>{if(ia&&("line"===ia.type||"path"===ia.type)){var ea=[];switch(ia.type){case "line":var S=F(ia,0);if(null==S)break;var T=S?.width||0;0===ma&&(ha=T);ia=Math.min(U||T,ca);ma=0===ma?ia:U?T/ha*ia:ia;T=ma>J/2?2*ma:J;da=Math.max(da,ma);X=Math.max(X,T);S.width=ma;ea.push({shape:{type:"path",path:[{command:"M",
values:[0,.5*da]},{command:"L",values:[X,.5*da]}]},stroke:S});break;case "path":S=Math.min(U||C,ca);ma=h(ia,0);T=h(ia,-.2);var ba=K(ia,-.4);ba=ba?{color:ba,width:1}:{};if("quad"===ia.profile){const Q=ia.width;ia=ia.height;ia=w.getPathSymbolShapes(Q&&ia?Q/ia:1,0===ia,0===Q);ba={...ba,join:"bevel"};ea.push({shape:ia[0],fill:T,stroke:ba},{shape:ia[1],fill:T,stroke:ba},{shape:ia[2],fill:ma,stroke:ba})}else ea.push({shape:w.shapes.pathSymbol3DLayer[0],fill:T,stroke:ba},{shape:w.shapes.pathSymbol3DLayer[1],
fill:ma,stroke:ba});X=da=Math.max(da,S)}O.push(ea)}});return Promise.resolve(e.renderSymbol(O,[X,da],{node:v?.node,scale:A,opacity:v?.opacity,ariaLabel:v?.ariaLabel}))}async function N(A,v){const G="mesh-3d"===A.type;A=A.symbolLayers;var O=R(v);const U=v?.maxSize?n.pt2px(v.maxSize):null;O=O||C;const ca=[];let X=0,da=0;var ha=!1;for(let T=0;T<A.length;T++){var ia=A.at(T);const ba=[];if(!G||"fill"===ia.type){switch(ia.type){case "fill":ha=Math.min(O,U||P);X=Math.max(X,ha);da=Math.max(da,ha);ha=!0;if(G){var ma=
w.shapes.meshSymbol3DFill,ea=K(ia,-.4);ea=ea?{color:ea,width:1,join:"round"}:{};ba.push({shape:ma[0],fill:h(ia,0),stroke:ea},{shape:ma[1],fill:h(ia,-.2),stroke:ea},{shape:ma[2],fill:h(ia,-.6),stroke:ea})}else{ma=h(ia,0);ea="pattern"in ia?ia.pattern:null;var S=q(ia);ia=t(ia);null!=ea&&"style"===ea.type&&"solid"!==ea.style&&ia&&(ma=await u(ea,ia));ba.push({shape:w.shapes.fill[0],fill:ma,stroke:S})}break;case "line":ia=F(ia,0);if(null==ia)break;ia={stroke:ia,shape:w.shapes.fill[0]};X=Math.max(X,C);da=
Math.max(da,C);ba.push(ia);break;case "extrude":ma={join:"round",width:1,...F(ia,-.4)};ea=h(ia,0);ia=h(ia,-.2);S=Math.min(O,U||P);const Q=w.getExtrudeSymbolShapes(S);ma.width=1;ba.push({shape:Q[0],fill:ia,stroke:ma},{shape:Q[1],fill:ia,stroke:ma},{shape:Q[2],fill:ea,stroke:ma});ia=.7*C+.5*S;X=Math.max(X,C);da=Math.max(da,ia);break;case "water":ha=t(ia),ia=c(ha),ma=c(ha,2),ea=c(ha,3),S=w.getWaterSymbolShapes(),ha=!0,ba.push({shape:S[0],fill:ia},{shape:S[1],fill:ma},{shape:S[2],fill:ea}),ia=Math.min(O,
U||P),X=Math.max(X,ia),da=Math.max(da,ia)}ca.push(ba)}}return e.renderSymbol(ca,[X,da],{node:v?.node,scale:ha,opacity:v?.opacity,ariaLabel:v?.ariaLabel})}const C=w.SymbolSizeDefaults.size,P=w.SymbolSizeDefaults.maxSize,H=w.SymbolSizeDefaults.maxOutlineSize,J=w.SymbolSizeDefaults.lineWidth,z=w.SymbolSizeDefaults.tallSymbolWidth;a.getPatternDescriptor=u;a.getSizeFromOptions=R;a.getSymbolLayerFill=h;a.previewSymbol3D=function(A,v){if(0===A.symbolLayers.length)return Promise.reject(new g("symbolPreview: renderPreviewHTML3D",
"No symbolLayers in the symbol."));switch(A.type){case "point-3d":return D(A,v);case "line-3d":return E(A,v);case "polygon-3d":case "mesh-3d":return N(A,v)}return Promise.reject(new g("symbolPreview: swatchInfo3D","symbol not supported."))};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/webStyleSymbolUtils":function(){define("exports ../../symbols ../../core/devEnvironmentUtils ../../core/Error ../../core/urlUtils ../../portal/Portal ../../chunks/persistableUrlUtils ./jsonUtils ./StyleOrigin ./styleUtils ./Thumbnail".split(" "),
function(a,b,d,m,g,x,n,B,M,k,w){function e(q,r){return r.items.find(c=>c.name===q)}function f(q,r,c,t,h,u){const L=null!=c?.portal?c.portal:x.getDefault(),K={portal:L,url:g.urlToObject(q.baseUrl),origin:"portal-item"},F=e(r,q.data);if(!F)return Promise.reject(new m("symbolstyleutils:symbol-name-not-found",`The symbol name '${r}' could not be found`,{symbolName:r}));h=n.fromJSON(h(F,t),K);let y=F.thumbnail?.href??null;const p=F.thumbnail?.imageData;d.isDevEnvironment()&&(h=d.adjustStaticAGOUrl(h)??
"",y=d.adjustStaticAGOUrl(y));const I={portal:L,url:g.urlToObject(g.removeFile(h)),origin:"portal-item"};return k.requestJSON(h,u).then(R=>{R="cimRef"===t?k.makeCIMSymbolRef(R.data):R.data;if((R=B.fromJSON(R,I))&&b.isSymbol3D(R)){if(y){const D=n.fromJSON(y,K);R.thumbnail=new w.Thumbnail({url:D})}else p&&(R.thumbnail=new w.Thumbnail({url:`data:image/png;base64,${p}`}));q.styleUrl?R.styleOrigin=new M({portal:c.portal,styleUrl:q.styleUrl,name:r}):q.styleName&&(R.styleOrigin=new M({portal:c.portal,styleName:q.styleName,
name:r}))}return R})}function l(q,r,c){const t=k.Style2DUrlTemplate.replaceAll(/\{SymbolName\}/gi,q),h=null!=r.portal?r.portal:x.getDefault();return k.requestJSON(t,c).then(u=>{u=k.makeCIMSymbolRef(u.data);return B.fromJSON(u,{portal:h,url:g.urlToObject(g.removeFile(t)),origin:"portal-item"})})}a.fetchSymbolFromStyle=f;a.getStyleItemFromStyle=e;a.resolveWebStyleSymbol=function(q,r,c,t){const h=q.name;return null==h?Promise.reject(new m("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):
q.styleName&&"Esri2DPointSymbolsStyle"===q.styleName?l(h,r,t):k.fetchStyle(q,r,t).then(u=>f(u,h,r,c,k.symbolUrlFromStyleItem,t))};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/devEnvironmentUtils":function(){define(["exports"],function(a){const b=/^devext.arcgis.com$/,d=/^qaext.arcgis.com$/,m=/^[\w-]*\.mapsdevext.arcgis.com$/,g=/^[\w-]*\.mapsqa.arcgis.com$/,x=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,b,d,/^jsapps.esri.com$/,m,g];a.adjustStaticAGOUrl=function(n,B){return n?
(B=B||globalThis.location.hostname)?null!=B.match(b)||null!=B.match(m)?n.replace("static.arcgis.com","staticdev.arcgis.com"):null!=B.match(d)||null!=B.match(g)?n.replace("static.arcgis.com","staticqa.arcgis.com"):n:n:n};a.devHostnames=x;a.isDevEnvironment=function(n){n=n||globalThis.location.hostname;return x.some(B=>null!=n?.match(B))};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/FeatureTemplates/TemplateItemGroup":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/Identifiable ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,d,m,g,x,n,B){b=class extends d.IdentifiableMixin(b){constructor(M){super(M);this.label=this.items=null}get id(){return this.label}findByTemplate(M){return this.items.find(k=>k.template===M)}};a.__decorate([m.property()],b.prototype,"items",void 0);a.__decorate([m.property()],b.prototype,"label",void 0);a.__decorate([m.property()],b.prototype,"id",null);return b=a.__decorate([B.subclass("esri.widgets.FeatureTemplates.TemplateItemGroup")],b)})},"esri/widgets/support/templateUtils":function(){define(["exports"],
function(a){a.getAllTemplatesForLayer=b=>{if(null==b||"object"!==typeof b)return[];const d="templates"in b&&Array.isArray(b.templates)?b.templates:[];b="types"in b&&Array.isArray(b.types)?b.types.flatMap(m=>m.templates):[];return[...d,...b]};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/FeatureTemplates/ItemList":function(){define(["exports","../support/Heading","../support/widgetUtils","../support/jsxFactory"],function(a,b,d,m){function g(k){const {headingLevel:w,
items:e,...f}=k;return 0===e.length?m.tsx("div",{class:M.noMatchesMessage,key:"no-matches"},k.messages.noMatches):m.tsx("div",{class:d.classes({[M.scroller]:!0,[M.scrollerEnabled]:!!k.enableListScroll}),key:"item-container"},e.map(l=>l.items?B({...f,group:l,headingLevel:w}):n({...f,grouped:!0,item:l})))}function x(k){const {disabled:w,messages:e,filterText:f,enableListScroll:l}=k;return m.tsx("div",{class:l?void 0:M.filterContainerSticky,key:"filter"},m.tsx("calcite-input",{disabled:w,placeholder:e.filterPlaceholder,
type:"search",value:f,onCalciteInputInput:q=>{q=q.currentTarget;k.onFilterChange&&k.onFilterChange(q.value)}}))}function n(k){const {disabled:w,grouped:e,identify:f,item:l,onItemMouseEnter:q,onItemMouseLeave:r,onItemSelect:c,renderIcon:t,renderCustomItem:h,renderItemContent:u,renderItemContentEnd:L,renderItemLabel:K,renderItemDescription:F,selectedItem:y}=k,p=l?`${f?.(l)||l.id}__${l.label}`:"";var I=y?`${f?.(y)||y.id}__${y.label}`:"";const R=p===I;if(k=h?.(k))return k;k=u?.(l);I=L?.(l);const D=!(!l.disabled&&
!w);return m.tsx("calcite-list-item",{afterUpdate:E=>{E.selected=R},"aria-level":e?"2":"",class:d.classes({[M.item]:!0,[M.itemDisabled]:D}),"data-item":l,description:k?void 0:F?.(l)??void 0,disabled:D,key:p,label:k?void 0:K?.(l)??l.label??void 0,onmouseenter:E=>q?.(E.currentTarget["data-item"]),onmouseleave:E=>r?.(E.currentTarget["data-item"]),selected:R,tabIndex:D?-1:0,onCalciteListItemSelect:E=>{E.preventDefault();c?.(E.currentTarget["data-item"])}},m.tsx("div",{class:M.itemIcon,key:"content-start",
slot:"content-start"},t?.(l)),k?m.tsx("div",{key:"content",slot:"content"},k):null,I?m.tsx("div",{class:M.itemContentEnd,key:"content-end",slot:"content-end"},I):null)}function B(k){const {disabled:w,group:e,headingLevel:f=4,selectionMode:l="none",renderCustomGroupContent:q,...r}=k;k=q?.(k);return m.tsx("div",{class:M.group,key:e.label??void 0},m.tsx(b.Heading,{class:M.groupHeader,level:f},e.label),k||m.tsx("calcite-list",{disabled:w,selectionAppearance:"border",selectionMode:l},e.items.map(c=>n({...r,
disabled:w,item:c,grouped:!0}))))}const M={base:"esri-item-list",filterContainerSticky:"esri-item-list__filter-container--sticky",group:"esri-item-list__group",groupHeader:"esri-item-list__group__header",item:"esri-item-list__list-item",itemDisabled:"esri-item-list__list-item--disabled",itemIcon:"esri-item-list__list-item-icon",itemContentEnd:"esri-item-list__list-item-content-end",noMatchesMessage:"esri-item-list__no-matches-message",scroller:"esri-item-list__scroller",scrollerEnabled:"esri-item-list__scroller--enabled"};
a.ItemList=function(k){const {disabled:w,filterText:e="",id:f,messages:l,onFilterChange:q,...r}=k;return m.tsx("div",{key:f},k.filterEnabled??!0?x({disabled:w,filterText:e,id:f,messages:l,onFilterChange:q}):null,g({...r,disabled:w,enableListScroll:k.enableListScroll??!0,filterText:e,messages:l}))};a.renderGroup=B;a.renderItem=n;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/FeatureTemplates/VisibleElements":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,d,m,g,x,n){b=class extends b{constructor(B){super(B);this.filter=!0}};a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"filter",void 0);return b=a.__decorate([n.subclass("esri.widgets.FeatureTemplates.VisibleElements")],b)})},"esri/widgets/Spinner":function(){define("../chunks/tslib.es6 ../core/promiseUtils ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./Widget ./Spinner/SpinnerViewModel ./support/widgetUtils ./support/jsxFactory".split(" "),
function(a,b,d,m,g,x,n,B,M,k,w,e){g=class extends M{constructor(f,l){super(f,l);this._animationDelay=500;this._animationPromise=null;this.viewModel=new k}initialize(){this.addHandles(d.watch(()=>this.visible,f=>this._visibleChange(f)))}destroy(){this._animationPromise=null}get location(){return this.viewModel.location}set location(f){this.viewModel.location=f}get view(){return this.viewModel.view}set view(f){this.viewModel.view=f}get visible(){return this.viewModel.visible}set visible(f){this.viewModel.visible=
f}show(f){const {location:l,promise:q}=f??{};l&&(this.viewModel.location=l);this.visible=!0;f=()=>this.hide();q&&q.catch(()=>{}).then(f)}hide(){this.visible=!1}render(){var {visible:f}=this,{screenLocation:l}=this.viewModel;l=!!l;f={["esri-spinner--start"]:f&&l,["esri-spinner--finish"]:!f&&l};l=this._getPositionStyles();return e.tsx("div",{class:this.classes("esri-spinner",f),styles:l})}_visibleChange(f){if(f)this.viewModel.screenLocationEnabled=!0;else{var l=b.after(this._animationDelay);this._animationPromise=
l;l.catch(()=>{}).then(()=>{this._animationPromise===l&&(this.viewModel.screenLocationEnabled=!1,this._animationPromise=null)})}}_getPositionStyles(){const {screenLocation:f,view:l}=this.viewModel;if(null==l||null==f)return{};const {padding:q}=l;return{left:`${f.x-q.left}px`,top:`${f.y-q.top}px`}}};a.__decorate([m.property()],g.prototype,"location",null);a.__decorate([m.property()],g.prototype,"view",null);a.__decorate([m.property({type:k})],g.prototype,"viewModel",void 0);a.__decorate([m.property()],
g.prototype,"visible",null);return g=a.__decorate([B.subclass("esri.widgets.Spinner")],g)})},"esri/widgets/Spinner/SpinnerViewModel":function(){define("../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../support/AnchorElementViewModel".split(" "),function(a,b,d,m,g,x,n){d=class extends n{constructor(B){super(B);this.visible=!1}};a.__decorate([b.property()],
d.prototype,"visible",void 0);return d=a.__decorate([x.subclass("esri.widgets.CompassViewModel")],d)})},"esri/widgets/support/AnchorElementViewModel":function(){define("../../chunks/tslib.es6 ../../core/Evented ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),function(a,b,d,m,g,x,n,B){b=class extends b.EventedAccessor{constructor(M){super(M);
this.location=null;this.screenLocationEnabled=!1;this.view=null;this.addHandles([d.when(()=>{const k=this.screenLocationEnabled?this.view:null;return k?[k.size,"3d"===k.type?k.camera:k.viewpoint]:null},()=>this.notifyChange("screenLocation")),d.watch(()=>this.screenLocation,(k,w)=>{null!=k&&null!=w&&this.emit("view-change")})])}destroy(){this.view=null}get screenLocation(){const {location:M,view:k,screenLocationEnabled:w}=this;return w&&null!=M&&null!=k&&k.ready?k.toScreen(M):null}};a.__decorate([m.property()],
b.prototype,"location",void 0);a.__decorate([m.property()],b.prototype,"screenLocation",null);a.__decorate([m.property()],b.prototype,"screenLocationEnabled",void 0);a.__decorate([m.property()],b.prototype,"view",void 0);return b=a.__decorate([B.subclass("esri.widgets.support.AnchorElementViewModel")],b)})},"esri/widgets/Editor/css":function(){define(["exports","../support/legacyIcon"],function(a,b){a.css={base:"esri-editor",helpMessage:"esri-editor__help-message",updateActions:"esri-editor__update-actions",
updateActionsList:"esri-editor__update-actions-list",featureTemplatesContainer:"esri-editor__feature-templates-container",templateItemContentEnd:"esri-editor__template-item-content-end",widgetIcon:b.legacyIcon.edit};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/deprecationUtils":function(){define(["exports","../../core/deprecate"],function(a,b){a.workflowDeprecation=function(d,m,g){b.deprecated(d,"`"+m+"` is deprecated, because it instantiates the deprecated class 'esri.widgets.Editor.CreateWorkflow'",
{replacement:g,version:"4.23",see:"https://developers.arcgis.com/javascript/latest/api-reference/esri-widgets-Editor-CreateFeaturesWorkflow.html"})};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/EditorViewModel":function(){define("../../chunks/tslib.es6 ../../core/asyncUtils ../../core/Collection ../../core/deprecate ../../core/Error ../../core/Evented ../../core/handleUtils ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../core/support/UpdatingHandles ../../layers/GraphicsLayer ../../layers/support/editableLayers ../../layers/support/layerUtils ../../portal/support/urlUtils ../Attachments/AttachmentsViewModel ./CreateFeaturesWorkflow ./CreateWorkflow ./deprecationUtils ./UpdateWorkflow ./workflowUtils ../FeatureForm/featureFormUtils ../FeatureForm/FeatureFormViewModel ../FeatureTemplates/FeatureTemplatesViewModel ../Sketch/SketchViewModel ../Spinner/SpinnerViewModel".split(" "),
function(a,b,d,m,g,x,n,B,M,k,w,e,f,l,q,r,c,t,h,u,L,K,F,y,p,I,R,D,E,N,C,P){function H(v,G,O){z.error(new g(v,G,O))}function J(v,G){return v?v.find(O=>O.layer===G):void 0}const z=B.getLogger("esri.widgets.Editor.EditorViewModel"),A=["create","create-features","update"];x=class extends x.EventedAccessor{constructor(v){super(v);this._editableItems=new d;this._sketchGraphicsLayer=new t({listMode:"hide",internal:!0});this._updateEditableItemsTask=null;this._updatingHandles=new c.UpdatingHandles;this._featureTemplatesViewModelLocked=
!1;this.activeWorkflow=null;this._activityQueue=[];this.failures=[];this.hideTemplatesForInactiveLayers=!1;this.attachmentsViewModel=new K({capabilities:{editing:!0}});this.featureFormViewModel=new E;this.featureTemplatesViewModel=new N({disabledItemFunction:({layer:G})=>this._itemIsSuspended(G)});this.sketchViewModel=new C({layer:this._sketchGraphicsLayer});this.spinnerViewModel=new P;this.pageStack=[];this.showDiscardEditsPrompt=()=>Promise.resolve(!0);this.useDeprecatedCreateWorkflow=this._candidateCommitted=
!1;this.back=async()=>{this.canGoBack&&(this.activeWorkflow?.hasPreviousStep?await this.activeWorkflow.back(this.showDiscardEditsPrompt):await this._cancelWorkflow({force:!this.hasPendingEdits}))};this.saveWorkflow=async()=>{const {featureFormViewModel:G}=this;G.submit();if(G.submittable){var O=G.getValues();0<G.validateContingencyConstraints(O,{includeIncompleteViolations:!0}).length||await this.activeWorkflow?.save()}};this.selectFeature=(G,O=!1)=>{const U=this.activeWorkflow;this._candidateCommitted||
"update"!==U?.type||(U.data.rootFeature=G,O&&(U.next(),this._candidateCommitted=!0))}}initialize(){this.addHandles([w.watch(()=>{const v=this.view?.map?.editableLayers.filter(({parent:O,visible:U})=>O&&"visible"in O?U&&O.visible:U),G=this.view?.allLayerViews?.filter(O=>!!v?.includes(O.layer)&&!O.suspended);return[v,G,this.layerInfos,this.allowedWorkflows,this.hideTemplatesForInactiveLayers]},()=>this._updateEditableItems(),w.syncAndInitial),w.on(()=>this.activeWorkflow,"cancel",()=>this.emit("workflow-cancel")),
w.on(()=>this.activeWorkflow,"commit",()=>this.emit("workflow-commit")),w.on(()=>this.activeWorkflow,"complete",()=>{this.emit("workflow-commit");this._set("activeWorkflow",null)}),w.when(()=>this.view?.map,v=>v.add(this._sketchGraphicsLayer),w.initial),w.watch(()=>this.view?.timeZone,v=>this.featureFormViewModel.timeZone=v),w.watch(()=>this._editableItems.toArray(),()=>{const {activeWorkflow:v}=this;this.syncFeatureTemplates();if(v){var {stepId:G}=v;"create"===v.type?"awaiting-feature-creation-info"!==
G||this.canCreate||this._cancelWorkflow():"update"===v.type&&("awaiting-feature-to-update"===G&&!this.canUpdate||"awaiting-update-feature-candidate"===G&&!v.data.candidates.some(O=>{const U=this._editableItems.find(ca=>ca.layer===O.layer);return U&&U.supports.includes("update")}))&&this._cancelWorkflow()}}),w.watch(()=>this.page,(v,G)=>{G=[...this.pageStack];if(-1===G.indexOf(v))G.push(v);else for(;G.length&&G.at(-1)!==v;)G.pop();this.pageStack=G},w.syncAndInitial),w.when(()=>"awaiting-update-feature-candidate"===
this.state,()=>this._candidateCommitted=!1),w.on(()=>this.featureTemplatesViewModel,"select",async({item:v,oldItem:G})=>{var {activeWorkflow:O}=this;if(O){if("update"===O.type&&"awaiting-feature-creation-info"===O.activeWorkflow?.stepId)return;try{await this.cancelWorkflow({force:!this.hasPendingEdits})}catch{this.featureTemplatesViewModel.select(G,{emit:!1});return}}if(v){O={layer:v.layer,template:v.template};if(v.supportsUpload)return this.featureTemplatesViewModel.select(G,{emit:!1}),this.startCreateFeaturesWorkflow(O);
this.useDeprecatedCreateWorkflow?this.startCreateWorkflowAtFeatureCreation(O):this.startCreateFeaturesWorkflowAtFeatureCreation(O)}}),w.on(()=>this.view,"key-down",v=>{"Escape"===v.key&&this.activeWorkflow?.keyboardCancellationEnabled&&(v.stopPropagation(),this.back())})])}destroy(){this._cancelWorkflow({warnIfNoWorkflow:!1}).then(()=>{this.view?.map?.remove(this._sketchGraphicsLayer);this.view=null});this._updateEditableItemsTask=M.abortMaybe(this._updateEditableItemsTask);this._updatingHandles.destroy()}get allowedWorkflows(){return this._get("allowedWorkflows")}set allowedWorkflows(v){v&&
0!==v.length||(v=[...A]);this._set("allowedWorkflows",v)}get canCreate(){return this._editableItems.some(v=>v.supports.includes("create")&&!v.suspended)}get canUpdate(){return this._editableItems.some(({attachmentsOnUpdateEnabled:v,layer:G,supports:O,suspended:U})=>{v=!U&&(O.includes("update")||O.includes("delete")||v);O=G.parent;O=!(O&&"visible"in O)||!!O.visible;return G.visible&&O&&v})}get editableItems(){return this._editableItems}get labelOptions(){return this.sketchViewModel.labelOptions}set labelOptions(v){this.sketchViewModel.labelOptions=
v}set layerInfos(v){v?.some(G=>{"allowAttachments"in G&&m.deprecated(z,"Property: layerInfo.allowAttachments",{replacement:"layerInfo.attachmentsOnCreateEnabled or layerInfo.attachmentsOnUpdateEnabled",version:"4.26"});return!0});this._set("layerInfos",v)}get snappingOptions(){return this.sketchViewModel.snappingOptions}set snappingOptions(v){this.sketchViewModel.snappingOptions=v}get state(){if(!this.view?.ready)return"disabled";var v=this.attachmentsViewModel.mode;if("add"===v)return"adding-attachment";
if("edit"===v)return"editing-attachment";({activeWorkflow:v}=this);return v?"update"===v.type&&v.activeWorkflow?.stepId?v.activeWorkflow.stepId:v.stepId:"ready"}get syncing(){return 0<this._activityQueue.length}get updating(){return this._updatingHandles.updating||!0===this.activeWorkflow?.updating}get tooltipOptions(){return this.sketchViewModel.tooltipOptions}set tooltipOptions(v){this.sketchViewModel.tooltipOptions=v}set view(v){this.sketchViewModel.view=v;this.spinnerViewModel.view=v;this._set("view",
v)}get page(){const {activeWorkflow:v,state:G}=this;if("update"===v?.type&&"awaiting-feature-to-update"===v.stepId)return"ready";if("create-features"===v?.type&&0===v.numPendingFeatures){const O=v.data.upload;if(O)return"default"===O.state?"ready":"creating-features-upload-details"}return G??"disabled"}get featureFormDisabled(){const {activeWorkflow:v}=this;return"update"===v?.type&&!1===v.activeEditableItem?.attributeUpdatesEnabled}get canGoBack(){return null!=this.activeWorkflow&&!this.syncing}get shouldShowDeleteButton(){const {activeWorkflow:v}=
this;return!!v&&"update"===v.type&&!!v.activeEditableItem?.supports.includes("delete")}get hasPendingEdits(){return this.activeWorkflow?.hasPendingEdits??!1}async startCreateWorkflowAtFeatureTypeSelection(){p.workflowDeprecation(z,"startCreateWorkflowAtFeatureTypeSelection","startCreateFeaturesWorkflowAtFeatureTypeSelection");await w.whenOnce(()=>!this.updating);if(this.canCreate){await this._cancelWorkflow();var v=this._createCreateWorkflow();await v.start();this._set("activeWorkflow",v)}else H("editing:unsupported-workflow",
"Create workflow is unsupported or disabled.")}async startCreateFeaturesWorkflowAtFeatureTypeSelection(){return this.startCreateFeaturesWorkflow()}async startCreateWorkflowAtFeatureCreation(v){p.workflowDeprecation(z,"startCreateWorkflowAtFeatureCreation","startCreateFeaturesWorkflowAtFeatureCreation");await w.whenOnce(()=>!this.updating);if(this.canCreate){await this._cancelWorkflow();var G=this._createCreateWorkflow("awaiting-feature-to-create");G.data.creationInfo=v;await G.start();this._set("activeWorkflow",
G)}else H("editing:unsupported-workflow","Create workflow is unsupported or disabled.")}async startCreateFeaturesWorkflowAtFeatureCreation(v){return this.startCreateFeaturesWorkflow(v,"creating-features")}async startCreateFeaturesWorkflow(v,G="awaiting-feature-creation-info"){await w.whenOnce(()=>!this.updating);if(!this.canCreate)throw new g("editing:unsupported-workflow","Creating features is unsupported or disabled.");await this._cancelWorkflow();v=this._createCreateFeaturesWorkflow(v,G);await v.start();
this._set("activeWorkflow",v)}async startCreateWorkflowAtFeatureEdit(v){p.workflowDeprecation(z,"startCreateWorkflowAtFeatureEdit");await w.whenOnce(()=>!this.updating);if(this.canCreate){await this._cancelWorkflow();var G=this._createCreateWorkflow("editing-new-feature");G.data.edits.feature=v;await G.start();this._set("activeWorkflow",G)}else H("editing:unsupported-workflow","Create workflow is unsupported or disabled.")}async startCreateFeaturesWorkflowAtFeatureEdit(v){await w.whenOnce(()=>!this.updating);
({initialFeature:v}=v);var G=v.sourceLayer;G=G?this.findEditableItemForLayer(G):void 0;if(!this.canCreate||!G)throw new g("editing:unsupported-workflow","Creating features is unsupported or disabled.");await this._cancelWorkflow();v=this._createCreateFeaturesWorkflow({initialFeature:v,layer:G.layer,maxFeatures:1},"creating-features");await v.start();this._set("activeWorkflow",v)}async startUpdateWorkflowAtFeatureSelection(){await w.whenOnce(()=>!this.updating);if(this.canUpdate){await this._cancelWorkflow();
var v=this._createUpdateWorkflow();await v.start();this._set("activeWorkflow",v)}else H("editing:unsupported-workflow","Update workflow is unsupported or disabled.")}async startUpdateWorkflowAtMultipleFeatureSelection(v){await w.whenOnce(()=>!this.updating);if(this.canUpdate){await this._cancelWorkflow();var G=this._createUpdateWorkflow("awaiting-update-feature-candidate");G.data.candidates=v;await G.start();this._set("activeWorkflow",G)}else H("editing:unsupported-workflow","Update workflow is unsupported or disabled.")}async startUpdateWorkflowAtFeatureEdit(v){await w.whenOnce(()=>
!this.updating);if(this.canUpdate){await this._cancelWorkflow();var G=this._createUpdateWorkflow("editing-existing-feature");G.data.rootFeature=v;await G.start();this._set("activeWorkflow",G)}else H("editing:unsupported-workflow","Update workflow is unsupported or disabled.")}async deleteFeatureFromWorkflow(){const {activeWorkflow:v}=this;v&&"update"===v.type?await v.deleteActiveFeature():H("editing:unsupported-workflow","Deleting requires an active update workflow.")}async cancelWorkflow(v){return this._cancelWorkflow({warnIfNoWorkflow:!0,
...v})}findEditableItemForLayer(v){const G="subtype-sublayer"===v.type?v.parent:v;return this._editableItems.find(O=>O.layer===G)}itemHasInvalidFormTemplate(v){return v?this.findEditableItemForLayer(v.layer)?.hasInvalidFormTemplate??!1:!1}itemHasUnsupportedFields(v){return v?this.findEditableItemForLayer(v.layer)?.hasUnsupportedFields??!1:!1}syncFeatureTemplates(){if(!this._featureTemplatesViewModelLocked){var v=[];for(const {layer:G,supports:O}of this._editableItems)G.loaded&&O.includes("create")&&
!u.isTable(G)&&v.push(G);this.featureTemplatesViewModel.layers=v}}async toggleUpdateWorkflow(){!this.canUpdate||this.hasPendingEdits&&!await this.showDiscardEditsPrompt()||(this.activeWorkflow&&"awaiting-feature-to-update"===this.state?await this.cancelWorkflow({force:!0}):await this.startUpdateWorkflowAtFeatureSelection())}lockFeatureTemplatesViewModel(){this._featureTemplatesViewModelLocked=!0;return n.makeHandle(()=>{this._featureTemplatesViewModelLocked=!1;this.syncFeatureTemplates()})}async _updateEditableItems(){M.abortMaybe(this._updateEditableItemsTask);
const v=b.createTask(async G=>{const O=this.view?.allLayerViews;var U=this.view?.map,ca=U?.editableLayers.toArray()??[];U=U?.allTables.toArray().filter(u.isFeatureLayer)??[];await Promise.allSettled(U.map(ha=>ha.load()));U=U.filter(ha=>h.isEditableLayer(ha));var X=[...ca.reverse(),...U.reverse()].filter(ha=>"mesh"===ha.geometryType?"3d"===this.view?.type:!0);if(O&&ca){ca=[];U=[];for(const ha of X){var da=O.find(ia=>ia.layer===ha);X=da?ca:U;da=!!da?.suspended;if(!da||!this.hideTemplatesForInactiveLayers)if("subtype-group"===
ha.type){await ha.loadAll();k.throwIfAborted(G);for(let ia=ha.sublayers.length-1;0<=ia;--ia)X.push(this._makeEditableItemForLayer(ha.sublayers.at(ia),da))}else X.push(this._makeEditableItemForLayer(ha,da))}G.aborted||(G=this._editableItems,this._editableItems=new d(ca.concat(U)),G.destroy())}});this._updatingHandles.addPromise(v.promise);this._updateEditableItemsTask=v}async _cancelWorkflow(v){const G=this.activeWorkflow;G?v&&!1===v.force?(await G.cancel(v),this._set("activeWorkflow",null)):(this.emit("workflow-cancel"),
this._set("activeWorkflow",null),await G.cancel(v)):v?.warnIfNoWorkflow&&H("editing:no-active-workflow","There is no active workflow to cancel.")}_createCreateFeaturesWorkflow(v,G){return F.create({viewModel:this,creationInfo:v,startAt:G,applyEditsCallback:(O,U,ca)=>this._applyEdits(O,U,ca),addAttachmentsCallback:(O,U)=>this._addAttachments(O,U)})}_createCreateWorkflow(v){return y.create(this,v,(G,O,U)=>this._applyEdits(G,O,U))}_createUpdateWorkflow(v){return I.create({viewModel:this,startAt:v,applyEditsCallback:(G,
O,U)=>this._applyEdits(G,O,U),addAttachmentsCallback:(G,O)=>this._addAttachments(G,O)})}_addAttachments(v,G){G=G.map(O=>this._addAttachment(v,O.feature,O.attachment))??[];return Promise.all(G)}async _addAttachment(v,G,O){let U=null;if("geojson"===v.type||"scene"===v.type||"oriented-imagery"===v.type)throw new g("editor:attachments-not-supported","Adding attachments is not supported for this layer type");await this._queueOperation(async()=>U=await v.addAttachment?.(G,O).catch(ca=>{throw ca?.error||
ca;})??null);return U}async _applyEdits(v,G,O){let U=null;const ca=v.url?await u.getOwningPortalUrl(v.url):null,X={returnServiceEditsOption:ca&&L.parseKnownArcGISOnlineDomain(ca)||RegExp("/hosted/","i").test(v.url)?void 0:"original-and-current-features",...O};await this._queueOperation(async()=>{const {view:da}=this;if(!da)return null;const ha=await R.whenEditorLayerView(da,v).catch(()=>null);U=await v.applyEdits(G,X);ha&&await w.whenOnce(()=>!ha.updating);return U});return U}_queueOperation(v){this._activityQueue.push(v);
this.notifyChange("syncing");const G=(O,U)=>{O=U.indexOf(O);-1<O&&U.splice(O,1)};return v().then(O=>{if(null!=O&&"error"in O&&null!=O.error)throw O.error;if(null!=O&&"addFeatureResults"in O){const {addFeatureResults:U,deleteFeatureResults:ca,updateFeatureResults:X}=O,da=U.find(ha=>!!ha.error)||X.find(ha=>!!ha.error)||ca.find(ha=>!!ha.error);if(da)throw da.error;}return O}).catch(O=>{H("editing:operation-error","An error occurred.",{error:O});const U={error:O,retry:()=>{G(U,this.failures);return this._queueOperation(v)},
cancel:()=>{G(U,this.failures)}};this._set("failures",[...this.failures,U])}).then(()=>{G(v,this._activityQueue);this.notifyChange("syncing")})}_makeEditableItemForLayer(v,G=!0){const O=u.getEffectiveLayerCapabilities(v);var U=O?.operations;const ca=J(this.layerInfos,v),X=D.formTemplateHasInvalidFields(v),da=X||G;var {allowedWorkflows:ha}=this;const ia=ha.includes("create")||ha.includes("create-features");var ma=ha.includes("update");ha=ma&&!!U?.supportsUpdate&&(!ca||!1!==ca.enabled&&!1!==ca.updateEnabled);
const ea=!da&&ma&&!!U?.supportsDelete&&(!ca||!1!==ca.enabled&&!1!==ca.deleteEnabled);ma=[];ia&&U?.supportsAdd&&(!ca||!1!==ca.enabled&&!1!==ca.addEnabled)&&ma.push("create");ha&&ma.push("update");ea&&ma.push("delete");U=!!O?.data?.supportsAttachment&&(!ca||!1!==ca.allowAttachments);return{layer:v,supports:ma,suspended:G,attributeUpdatesEnabled:ha&&!da&&(!ca||!1!==ca.attributeUpdatesEnabled),geometryUpdatesEnabled:ha&&!da&&!!O?.editing?.supportsGeometryUpdate&&(!ca||!1!==ca.geometryUpdatesEnabled),
hasAttachments:U,attachmentsOnCreateEnabled:U&&ia&&(!ca||!1!==ca.attachmentsOnCreateEnabled),attachmentsOnUpdateEnabled:!da&&U&&(!ca||!1!==ca.attachmentsOnUpdateEnabled),hasInvalidFormTemplate:X,hasUnsupportedFields:!1}}_itemIsSuspended(v){return this.findEditableItemForLayer(v)?.suspended??!1}};a.__decorate([e.property()],x.prototype,"_editableItems",void 0);a.__decorate([e.property({readOnly:!0})],x.prototype,"activeWorkflow",void 0);a.__decorate([e.property({readOnly:!0})],x.prototype,"_activityQueue",
void 0);a.__decorate([e.property({value:[...A]})],x.prototype,"allowedWorkflows",null);a.__decorate([e.property({readOnly:!0})],x.prototype,"canCreate",null);a.__decorate([e.property({readOnly:!0})],x.prototype,"canUpdate",null);a.__decorate([e.property()],x.prototype,"editableItems",null);a.__decorate([e.property({readOnly:!0})],x.prototype,"failures",void 0);a.__decorate([e.property()],x.prototype,"hideTemplatesForInactiveLayers",void 0);a.__decorate([e.property()],x.prototype,"attachmentsViewModel",
void 0);a.__decorate([e.property()],x.prototype,"featureFormViewModel",void 0);a.__decorate([e.property()],x.prototype,"featureTemplatesViewModel",void 0);a.__decorate([e.property()],x.prototype,"labelOptions",null);a.__decorate([e.property()],x.prototype,"layerInfos",null);a.__decorate([e.property()],x.prototype,"sketchViewModel",void 0);a.__decorate([e.property()],x.prototype,"snappingOptions",null);a.__decorate([e.property()],x.prototype,"spinnerViewModel",void 0);a.__decorate([e.property()],x.prototype,
"state",null);a.__decorate([e.property({readOnly:!0})],x.prototype,"syncing",null);a.__decorate([e.property()],x.prototype,"updating",null);a.__decorate([e.property()],x.prototype,"tooltipOptions",null);a.__decorate([e.property()],x.prototype,"view",null);a.__decorate([e.property()],x.prototype,"pageStack",void 0);a.__decorate([e.property()],x.prototype,"showDiscardEditsPrompt",void 0);a.__decorate([e.property()],x.prototype,"_candidateCommitted",void 0);a.__decorate([e.property()],x.prototype,"page",
null);a.__decorate([e.property()],x.prototype,"featureFormDisabled",null);a.__decorate([e.property()],x.prototype,"canGoBack",null);a.__decorate([e.property()],x.prototype,"shouldShowDeleteButton",null);a.__decorate([e.property()],x.prototype,"hasPendingEdits",null);a.__decorate([e.property()],x.prototype,"useDeprecatedCreateWorkflow",void 0);return x=a.__decorate([r.subclass("esri.widgets.Editor.EditorViewModel")],x)})},"esri/layers/GraphicsLayer":function(){define("../chunks/tslib.es6 ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ../core/support/OwningCollection ./Layer ./mixins/BlendLayer ./mixins/ScaleRangeLayer ../support/GraphicsCollection ../symbols/support/ElevationInfo".split(" "),
function(a,b,d,m,g,x,n,B,M,k,w,e){d=class extends M.BlendLayer(k.ScaleRangeLayer(B)){constructor(f){super(f);this.elevationInfo=null;this.graphics=new w.GraphicsCollection;this.screenSizePerspectiveEnabled=!0;this.type="graphics";this.internal=!1}destroy(){this.removeAll();this.graphics.destroy()}add(f){this.graphics.add(f);return this}addMany(f){this.graphics.addMany(f);return this}removeAll(){this.graphics.removeAll();return this}remove(f){this.graphics.remove(f)}removeMany(f){this.graphics.removeMany(f)}on(f,
l){return super.on(f,l)}graphicChanged(f){this.emit("graphic-update",f)}};a.__decorate([b.property({type:e})],d.prototype,"elevationInfo",void 0);a.__decorate([b.property(n.owningCollectionProperty(w.GraphicsCollection,"graphics"))],d.prototype,"graphics",void 0);a.__decorate([b.property({type:["show","hide"]})],d.prototype,"listMode",void 0);a.__decorate([b.property()],d.prototype,"screenSizePerspectiveEnabled",void 0);a.__decorate([b.property({readOnly:!0})],d.prototype,"type",void 0);a.__decorate([b.property({constructOnly:!0})],
d.prototype,"internal",void 0);return d=a.__decorate([x.subclass("esri.layers.GraphicsLayer")],d)})},"esri/widgets/Editor/CreateFeaturesWorkflow":function(){define("require ../../chunks/tslib.es6 ../../Graphic ../../core/arrayUtils ../../core/handleUtils ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/uuid ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/has ../../core/accessorSupport/decorators/subclass ../../layers/support/layerUtils ../../views/draw/support/helpMessageUtils ../../views/interactive/snapping/FeatureSnappingLayerSource ./CreateFeaturesWorkflowData ./modelUploadUtils ./Workflow ./workflowUtils".split(" "),
function(a,b,d,m,g,x,n,B,M,k,w,e,f,l,q,r,c,t,h,u){function L(E,N){let C=null;const P=()=>{null!=C&&(E.snappingOptions.featureSources.remove(C),C=x.destroyMaybe(C))};return g.handlesGroup([B.watch(()=>{const H=N.creationInfo?.layer,J=E.snappingOptions.featureSources.find(z=>z.layer===H);return{hasFeatureLayerSource:!!J,enabled:J?.enabled??!1}},({hasFeatureLayerSource:H,enabled:J})=>{if(H)null==C&&(C=new r({layer:E.layer}),E.snappingOptions.featureSources.add(C)),C.enabled=J;else return P()},B.syncAndInitial),
g.makeHandle(P)])}function K(E,N,C,P){const H=[];N.forEach((J,z)=>{if(!J.error){const A=E[z];z=P.get(A)||[];A.attributes[C.objectIdField]=J.objectId;z.forEach(({form:v})=>H.push({feature:A,attachment:v}))}});return H}function F(E,N,C){const P=[],H=N.globalIdField;E.forEach((J,z)=>{var A;(A=E[z].attributes)[H]??(A[H]=M.generateBracedUUID());(C?.get(J)||[]).forEach(({file:v})=>P.push({feature:J,attachment:{globalId:M.generateBracedUUID(),data:v}}))});return P.length?{addFeatures:E,addAttachments:P}:
{addFeatures:E}}var y;const p=Symbol(),I=Symbol(),R=Symbol(),D=Symbol();w=y=class extends h{constructor(E){super(E);this.type="create-features";this.createFeatureState="create-new";this.isNested=!1;this._getDrawMeshHelpMessage=void 0;this._featureFormHandle=null;this._visualVariableAttributes={rotation:null,size:null};this._attachmentFileInfos=new Map;this._highlightHandles=new Map;this._preventDefaultActionOnCancel=!1;this._lastActiveGraphics=[];this._isActive=!0;this._updateGraphicDebounced=n.debounce((N,
C,P)=>u.updateGraphicSymbolWhenRequired(N,C,P))}initialize(){this.isNested&&(this._isActive=!1)}get hasPendingEdits(){if(0<this.numPendingFeatures)return!0;const {data:E}=this;var {sketchViewModel:N}=E.viewModel,{activeComponent:C}=N;N=N.createGraphic?.geometry;if(!("polyline"!==N?.type&&"polygon"!==N?.type&&"multipoint"!==N?.type||"draw-2d"!==C?.type&&"draw-3d"!==C?.type)&&0<C.drawOperation.committedVertices.length)return!0;({upload:C}=E);return C&&("pending"===C.state||"success"===C.state)||E.creationInfo?.geometryToPlace?
!0:!1}get helpMessage(){const {creationInfo:E,viewModel:N}=this.data;if("creating-features"===this.stepId&&E){var C=E.layer.geometryType,P=N.sketchViewModel.createGraphic;return"mesh"===C?(this._getDrawMeshHelpMessage||(new Promise((H,J)=>a(["../../views/draw/support/helpMessageUtils3d"],H,J))).then(H=>{this._getDrawMeshHelpMessage=H.getDrawMeshHelpMessage}),{view:C}=N,"3d"===C?.type?this._getDrawMeshHelpMessage?.(P,C):void 0):q.getDrawHelpMessage(C,P?.geometry)}}get numPendingFeatures(){return this.pendingFeatures.length}get parent(){return this.data.parent}get pendingFeatures(){return this.data.pendingFeatures}get keyboardCancellationEnabled(){return 0===
this.numPendingFeatures}get reliesOnOwnerAdminPrivileges(){var {creationInfo:E}=this.data;if(!E)return!1;({layer:E}=E);const N=E.capabilities?.operations.supportsAdd,C=l.getEffectiveLayerCapabilities(E)?.operations.supportsAdd;return l.getEffectiveEditingEnabled(E)&&!E.editingEnabled||!!C&&!N}get shouldShowAttachments(){return this.data.creationInfo&&this.data.viewModel?u.shouldShowAttachmentsForCreateWorkflow(this.data):!1}get shouldAllowAttachmentEditing(){return this.shouldShowAttachments}get test(){return{addAttachment:(E,
N)=>{this._attachmentFileInfos.set(E,N)}}}async enter(){this._isActive=!0;const {featureFormViewModel:E}=this.data.viewModel,N=E.relatedRecordCallbacks;E.relatedRecordCallbacks=null;this.addHandles(g.makeHandle(()=>{E.relatedRecordCallbacks=N}),I);"awaiting-feature-creation-info"!==this.stepId&&this._setUpCreatingFeaturesStep()}exit(){this._isActive=!1;this.removeHandles([I,D])}async updatePendingFeature(E,N){this._preventDefaultActionOnCancel=!0;this.data.viewModel.sketchViewModel.cancel();m.remove(this._lastActiveGraphics,
E);return this._startUpdating(E,N)}async start(){await super.start();return l.isTable(this.data.creationInfo?.layer)?null:{enter:async()=>{},exit:async()=>{}}}static create(E){const {addAttachmentsCallback:N,applyEditsCallback:C,isNested:P,creationInfo:H,parent:J,startAt:z,viewModel:A}=E,v=new y({data:new c.CreateFeaturesWorkflowData({creationInfo:H,parent:J,viewModel:A}),isNested:P,onCommit:async G=>{var {creationInfo:O}=G;if(O){G=G.pendingFeatures.toArray();({layer:O}=O);var U=v._attachmentFileInfos;
if(O.capabilities?.editing.supportsGlobalId&&"globalIdField"in O)G=F(G,O,U),await C(O,G,{globalIdUsed:!0});else{var ca=await C(O,{addFeatures:G});0<U.size&&await N(O,K(G,ca?.addFeatureResults??[],O,U))}}}});v._set("steps",this._createWorkflowSteps(v,z));return v}_fadeExistingFeatures(E){if("effect"in E){const C=E.effect;E.effect="saturate(0.6) opacity(0.8)";return g.makeHandle(()=>E.effect=C)}const N=E.opacity;E.opacity=.7;return g.makeHandle(()=>E.opacity=N)}_highlight(E){const N=this.data.viewModel.view;
"3d"===N?.type&&this._highlightHandles.set(E,N.highlight(E))}_removeHighlight(E){x.removeMaybe(this._highlightHandles.get(E));this._highlightHandles.delete(E)}async _startCreating(E){this.removeHandles(R);const {data:N}=this,{creationInfo:C}=N;C&&(this.createFeatureState="create-new",E=await u.startCreatingNewFeature(N.viewModel.sketchViewModel,C,E),this.addHandles(E,R))}async _startUpdating(E,N){var {pendingFeatures:C}=this;C.includes(E)||C.add(E);const {creationInfo:P,viewModel:H}=this.data,{attachmentsViewModel:J,
editableItems:z,featureFormViewModel:A,layerInfos:v,sketchViewModel:G,view:O}=H;if(O&&P){var U=P.layer;C=u.findLayerInfo(v,U)?.formTemplate;var ca=O.spatialReference;this.data.editableItem=z.find(X=>X.layer===U);A.set({arcadeEditType:"INSERT",feature:E,formTemplate:C,spatialReference:ca,map:O.map});"add"!==J.mode&&"edit"!==J.mode||H.activeWorkflow?.previous();J.graphic=E;J.fileInfos.removeAll();J.mode="view";(this._attachmentFileInfos.get(E)||[]).forEach(({file:X,form:da})=>J.addFile(X,da));this._removeHighlight(E);
await u.updateGraphicSymbolWhenRequired(E,N,"2d"===O.type?O.scale:null);this.removeHandles(R);x.removeMaybe(this._featureFormHandle);"2d"===O.type&&(C=B.watch(()=>O.scale,X=>this._updateGraphicDebounced(E,N,X)),this.addHandles(C,R));this._featureFormHandle=g.handlesGroup([A.on("value-change",async()=>{E.attributes=A.getValues();await u.updateGraphicSymbolWhenRequired(E,N,"2d"===O.type?O.scale:null)}),G.on(["update","undo","redo"],X=>{("undo"===X.type||"redo"===X.type||"update"===X.type&&null!=X.toolEventInfo&&
u.isTerminalUpdateEventType(X.toolEventInfo.type))&&A.notifyFeatureGeometryChanged()})]);this.createFeatureState="update-pending";this._visualVariableAttributes=u.getVisualVariableAttributes(E);if(!l.isTable(U))return u.startUpdatingFeature({graphic:E,sketchViewModel:G,sourceLayer:U,visualVariables:this._visualVariableAttributes,webStyleCache:N})}}static _createWorkflowSteps(E,N="awaiting-feature-creation-info"){const {data:C}=E;N=u.createWorkflowSteps(["awaiting-feature-creation-info","creating-features",
"adding-attachment","editing-attachment"],N,{"awaiting-feature-creation-info":()=>({id:"awaiting-feature-creation-info",async setUp(){const {creationInfo:P,viewModel:H}=C,{view:J}=H;J&&(t.isModelUpload(P)?E.addHandles(await t.handleModelUpload({view:J,data:C,next:()=>E.next(),cancel:()=>H.cancelWorkflow({warnIfNoWorkflow:!1})}),this.id):(C.parent&&P&&(E.addHandles(H.lockFeatureTemplatesViewModel(),this.id),H.featureTemplatesViewModel.layers=[P.layer]),E.addHandles(H.featureTemplatesViewModel.on("select",
({item:z})=>{z&&(C.creationInfo={...C.creationInfo,layer:z.layer,template:z.template},E.next())}),this.id)))},async tearDown(){E.removeHandles([this.id,R])}}),"creating-features":()=>({id:"creating-features",async setUp(){E._isActive&&await E._setUpCreatingFeaturesStep()},async tearDown(P){const {viewModel:H}=C;P.canceled&&(E.removeHandles([D,p,R]),H.attachmentsViewModel.fileInfos.removeAll(),E._attachmentFileInfos.clear())}}),"adding-attachment":()=>({id:"adding-attachment",parent:"creating-features",
async setUp(){},async tearDown(){const {attachmentsViewModel:P}=C.viewModel,{graphic:H,fileInfos:J}=P;E._attachmentFileInfos.set(H,J.toArray());P.mode="view"}}),"editing-attachment":()=>({id:"editing-attachment",parent:"creating-features",async setUp(){},async tearDown(){const {attachmentsViewModel:P}=C.viewModel,{graphic:H,fileInfos:J}=P;E._attachmentFileInfos.set(H,J.toArray());P.mode="view"}})});return u.avoidFeatureTemplateSelectionWithOnlyOneItem(C,N)}static _configureSketchViewModel(E,N){const {data:C}=
E;var {viewModel:P}=C;const {view:H}=P,J=P.sketchViewModel;let z=null;P=[];if(!H)return{beforeCommit:g.makeHandle(),afterCommit:g.makeHandle()};const A=J.updateOnGraphicClick;J.updateOnGraphicClick=!1;"2d"===H.type&&C.creationInfo&&P.push(E._fadeExistingFeatures(C.creationInfo.layer));P.push(J.on("create",async v=>{if("cancel"===v.state){if(E._preventDefaultActionOnCancel){E._preventDefaultActionOnCancel=!1;return}if(1>E._lastActiveGraphics.length)return E._startCreating(N);v=E._lastActiveGraphics.pop();
return E._startUpdating(v,N)}if("complete"===v.state&&v.graphic)return E._startUpdating(v.graphic,N)}),J.on("update",async v=>{var {viewModel:G}=C;const {attachmentsViewModel:O,featureFormViewModel:U}=G;var ca=v.graphics[0];if("complete"===v.state){ca!==z&&(E._lastActiveGraphics.push(ca),E._highlight(ca));z=null;if(E.numPendingFeatures===C.creationInfo?.maxFeatures)return v=E._lastActiveGraphics.pop(),E._startUpdating(v,N);"add"!==O.mode&&"edit"!==O.mode||G.activeWorkflow?.previous();if(v.aborted&&
E._preventDefaultActionOnCancel){E._preventDefaultActionOnCancel=!1;return}E.addHandles([u.showProgressCursor(H),H.on("click",ha=>ha.preventDefault())],p);await B.whenOnce(()=>!U.updating);E.removeHandles(p);E._startCreating(N)}"start"===v.state&&E._removeHighlight(ca);G=E._visualVariableAttributes;await u.visualVariableInteractiveUpdate(H,ca,v,G,N);v=ca.attributes;const {rotation:X,size:da}=G;null!=X&&({field:ca}=X,U.setValue(ca,v[ca]));null!=da&&({field:ca}=da,U.setValue(ca,v[ca]))}),J.on("delete",
async v=>{v=v.graphics[0];E.pendingFeatures.remove(v);m.remove(E._lastActiveGraphics,v);z=v}),H.on("immediate-click",async v=>{!t.isModelUpload(C.creationInfo)&&({results:v}=await H.hitTest(v,{include:J.layer}),v=v.find(G=>"graphic"===G.type&&G.graphic.sourceLayer===C.creationInfo?.layer))&&(v=v.graphic,"transform"!==J.activeTool&&"reshape"!==J.activeTool||J.updateGraphics.at(0)===v||await E.updatePendingFeature(v,N))}),g.makeHandle(()=>{E._preventDefaultActionOnCancel=!0;J.cancel()}),L(J,C));return{beforeCommit:g.handlesGroup(P),
afterCommit:g.makeHandle(()=>{J.updateOnGraphicClick=A})}}async _setUpCreatingFeaturesStep(){if(!this.hasHandles(D)){var {creationInfo:E,viewModel:N}=this.data,{attachmentsViewModel:C,view:P}=N;if(P){var H=new Map,J=[],z=[];this._lastActiveGraphics=[];this._featureFormHandle=x.removeMaybe(this._featureFormHandle);this._visualVariableAttributes={rotation:null,size:null};u.prepareAttachmentsForCreateWorkflow(C);J.push(B.watch(()=>C.mode,G=>{switch(G){case "add":this.go("adding-attachment");break;case "edit":this.go("editing-attachment")}}));
var A=u.showProgressCursor(P);J.push(A);var v=l.isTable(E?.layer);try{if(t.isModelUpload(E)&&z.push(g.makeHandle(()=>N.cancelWorkflow({warnIfNoWorkflow:!1}))),v){const G=E?.initialFeature??new d({attributes:{...E?.template?.prototype.attributes,...E?.attributeOverrides},sourceLayer:E?.layer});await this._startUpdating(G,H)}else{const G=y._configureSketchViewModel(this,H);J.push(G.beforeCommit);z.push(G.afterCommit);E?.initialFeature?(N.sketchViewModel.layer.add(E.initialFeature),await this._startUpdating(E.initialFeature,
H)):await this._startCreating(H)}}finally{A.remove()}H=g.makeHandle(()=>this.pendingFeatures.drain(G=>N.sketchViewModel.layer.remove(G)));J.push(this._featureFormHandle);this.addHandles(J.filter(m.isSome),this._handleKeys.beforeCommit);this.addHandles([g.makeHandle(()=>C.fileInfos.removeAll()),...J,...z,H].filter(m.isSome),D)}}}};b.__decorate([k.property({constructOnly:!0})],w.prototype,"isNested",void 0);b.__decorate([k.property()],w.prototype,"hasPendingEdits",null);b.__decorate([k.property()],
w.prototype,"_getDrawMeshHelpMessage",void 0);b.__decorate([k.property()],w.prototype,"helpMessage",null);b.__decorate([k.property()],w.prototype,"parent",null);b.__decorate([k.property()],w.prototype,"keyboardCancellationEnabled",null);b.__decorate([k.property()],w.prototype,"reliesOnOwnerAdminPrivileges",null);b.__decorate([k.property()],w.prototype,"shouldShowAttachments",null);b.__decorate([k.property()],w.prototype,"shouldAllowAttachmentEditing",null);return w=y=b.__decorate([f.subclass("esri.widgets.Editor.CreateFeaturesWorkflow")],
w)})},"esri/views/draw/support/helpMessageUtils":function(){define(["exports"],function(a){a.getDrawHelpMessage=function(b,d){switch(b){case "point":case "multipoint":return"point";case "polyline":return 2>(null!=d&&"polyline"===d.type&&d.paths.length?d.paths[0].length:0)?"polylineZeroVertices":"polylineOneVertex";case "polygon":return b=null!=d&&"polygon"===d.type&&d.rings.length?d.rings[0].length:0,b=3>b?"polylineZeroVertices":4>b?"polygonOneVertex":"polygonTwoVertices",b}};Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/FeatureSnappingLayerSource":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass".split(" "),function(a,b,d,m,g,x,n){b=class extends b{constructor(B){super(B);this.layer=null;this.enabled=!0;this.updating=!1;this.availability=1}};
a.__decorate([d.property({constructOnly:!0})],b.prototype,"layer",void 0);a.__decorate([d.property()],b.prototype,"enabled",void 0);a.__decorate([d.property()],b.prototype,"updating",void 0);a.__decorate([d.property()],b.prototype,"availability",void 0);return b=a.__decorate([n.subclass("esri.views.interactive.snapping.FeatureSnappingLayerSource")],b)})},"esri/widgets/Editor/CreateFeaturesWorkflowData":function(){define("exports ../../chunks/tslib.es6 ../../core/Accessor ../../core/Collection ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,d,m,g,x,n,B,M){a.CreateFeaturesWorkflowData=class extends d{constructor(k){super(k);this.parent=this.editableItem=this.creationInfo=null;this.pendingFeatures=new m;this.upload=this.viewModel=null}};b.__decorate([g.property()],a.CreateFeaturesWorkflowData.prototype,"creationInfo",void 0);b.__decorate([g.property()],a.CreateFeaturesWorkflowData.prototype,"editableItem",void 0);b.__decorate([g.property()],a.CreateFeaturesWorkflowData.prototype,"parent",void 0);b.__decorate([g.property()],
a.CreateFeaturesWorkflowData.prototype,"viewModel",void 0);b.__decorate([g.property()],a.CreateFeaturesWorkflowData.prototype,"upload",void 0);a.CreateFeaturesWorkflowData=b.__decorate([M.subclass("esri.widgets.Editor.CreateFeaturesWorkflowData")],a.CreateFeaturesWorkflowData);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/modelUploadUtils":function(){define("require exports ../../core/handleUtils ../../core/promiseUtils ../../core/reactiveUtils ./workflowUtils".split(" "),
function(a,b,d,m,g,x){function n(B){return"scene"===B?.layer?.type}b.handleModelUpload=async function({view:B,data:M,signal:k,next:w,cancel:e}){const {creationInfo:f}=M;if(!f||!n(f))return d.makeHandle();const {layer:l}=f,q=null!=f.geometryToPlace;f.geometryToPlace=null;if(q)return e(),d.makeHandle();({Upload:e}=await new Promise((t,h)=>a(["./Upload"],t,h)));m.throwIfAborted(k);const r=new e;M.upload=r;let c=null;M=d.handlesGroup([g.watch(()=>r.state,t=>{switch(t){case "default":c?.remove();break;
case "pending":c?.remove();c=x.showProgressCursor(B);break;case "success":f.maxFeatures=1;f.geometryToPlace=r.result;c?.remove();w();break;case "error":c?.remove()}}),d.makeHandle(()=>{r.cancel();c?.remove()})]);r.uploadTo(l);return M};b.isModelUpload=n;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/workflowUtils":function(){define("require exports ../../Graphic ../../core/arrayUtils ../../core/asyncUtils ../../core/has ../../core/handleUtils ../../core/lang ../../core/promiseUtils ../../core/reactiveUtils ../../core/screenUtils ../../core/accessorSupport/diffUtils ../../layers/support/fieldUtils ../../renderers/support/clickToleranceUtils ../../renderers/support/lengthUtils ../../renderers/visualVariables/support/sizeVariableUtils ../../renderers/visualVariables/support/visualVariableUtils ../../support/featureFlags ../../symbols/support/symbolConversion ../../symbols/support/symbolUtils ../../views/3d/layers/graphics/GraphicState ../../views/support/drapedUtils ../../views/support/hitTestSelectUtils ../support/templateUtils".split(" "),
function(a,b,d,m,g,x,n,B,M,k,w,e,f,l,q,r,c,t,h,u,L,K,F,y){function p(ea){const S=ea.sourceLayer;var T;if(!(T=!S||"feature"!==S.type)){a:switch(S.renderer?.type){case "class-breaks":case "simple":case "unique-value":case "dot-density":case "dictionary":case "pie-chart":T=!0;break a;default:T=!1}T=!T}if(T)return{rotation:null,size:null};let ba=T=null;var Q=S.renderer.getVisualVariablesForType("rotation").filter(W=>(!W.axis||"heading"===W.axis)&&W.field&&!W.valueExpression&&null!=c.getRotationAngle(W,
ea));1===Q.length&&(T=I(Q[0],S));Q=S.renderer.getVisualVariablesForType("size").filter(W=>W.field&&!W.useSymbolValue&&!W.valueExpression&&r.getTransformationType(W)===r.TransformationType.RealWorldSize&&null!=c.getSize(W,ea));1===Q.length&&(ba=E(Q[0],S));return{rotation:T,size:ba}}function I(ea,S){const T="heading"===(ea.axis||"heading")&&"arithmetic"===ea.rotationType?-1:1,ba=ea.field,Q=(S=S.fields&&S.fields.filter(aa=>aa.name===ba))&&1===S.length?S[0].type:"double";var W=0,Z=0;return{field:ba,fieldType:Q,
getDefault:()=>Promise.resolve(0),getValue:aa=>{Z=W-T*aa;return N((Z+360)%360,Q)},initValue:aa=>{W=null!=aa?aa:Z;Z=0},isUpdatingInteractively:!1,rotationType:ea.rotationType??"geographic"}}function R(ea,S){switch(S){case "width":return ea[0];case "depth":return ea[1];case "height":return ea[2];default:return ea[2]||ea[1]||ea[0]}}async function D(ea,S,T){if(null==S)return 0;({symbol:S}=h.to3D(S));if(null==S||"web-style"===S.type||"cim"===S.type)return 0;S=S.symbolLayers.at(0);if(!S)return 0;switch(S.type){case "icon":return{computeIconLayerResourceSize:T}=
await new Promise((Q,W)=>a(["../../symbols/support/symbolLayerUtils"],Q,W)),S.size||Math.min(ia.icon,(await T(S,ia.icon))[0])||ia.icon;case "text":return S.size||ia.text;case "line":return S.size||ia.line;case "object":const {computeObjectLayerResourceSize:ba}=await new Promise((Q,W)=>a(["../../symbols/support/symbolLayerUtils"],Q,W));ea=await ba(S,ea.scale/ia.viewScaleSizeFactor);return R(ea,T);case "path":return(null!=S.width?S.width:S.height)||ea.scale/ia.viewScaleSizeFactor;case "extrude":return S.size||
ea.scale/ia.viewScaleSizeFactor;case "fill":case "water":return 0;default:return 0}}function E(ea,S){const T=ea.field,ba=ea.axis,Q=(S=S.fields&&S.fields.filter(ka=>ka.name===T))&&1===S.length?S[0].type:"double";var W=0,Z=0;const aa=q.meterIn[ea.valueUnit]??1;let fa;fa="area"===ea.valueRepresentation?ka=>(ka*aa/2)**2*Math.PI:"radius"===ea.valueRepresentation||"distance"===ea.valueRepresentation?ka=>ka*aa/2:ka=>ka*aa;return{field:T,fieldType:Q,getDefault:async(ka,la)=>N(fa(await D(la,ka,ba)),Q),getValue:(ka,
la)=>{W||(W=la.pixelSizeAt(la.center));Z=W*ka;return N(Z,Q)},initValue:ka=>{W=null!=ka?ka:Z;Z=0},isUpdatingInteractively:!1,displayUnit:da(ea.valueUnit),axis:ea.axis}}function N(ea,S){switch(S){case "small-integer":case "integer":case "long":return Math.round(ea);case "double":case "single":return ea;default:return 0}}async function C(ea,S,T){S=await u.getDisplayedSymbol(ea,{useSourceLayer:!0,ignoreGraphicSymbol:!0,webStyleCache:S,scale:T});null!=e.diff(ea.symbol,S)&&(ea.symbol=S)}function P(ea){if(!ea)throw Error("no geometry type");
return"multipatch"===ea?"mesh":ea}async function H(ea,S,T){const ba=S.layer,Q={...S.template?.prototype.attributes,...S.attributeOverrides};let W=null;const {view:Z}=ea,aa="2d"===Z?.type;await J(ea,ba,Q,T,aa?Z.scale:null);if(aa){const la=M.debounce(ja=>J(ea,ba,Q,T,ja));W=k.watch(()=>Z.scale,ja=>la(ja))}const {data:fa,editing:ka}=ba.capabilities;ea.layer.elevationInfo=ba.elevationInfo;await ea.create(P(ba.geometryType),{graphicProperties:{attributes:Q,sourceLayer:ba},hasZ:fa.supportsZ,defaultZ:(aa?
ka.zDefault:null)??ea.defaultCreateOptions.defaultZ,geometryToPlace:S.geometryToPlace??void 0});return W??n.makeHandle()}async function J(ea,S,T,ba,Q){S=new d({sourceLayer:S,attributes:T});const {rotation:W,size:Z}=p(S);let aa=await u.getDisplayedSymbol(S,{useSourceLayer:!0,webStyleCache:ba,scale:Q}),fa=!1;for(const ka of[Z,W])null!=ka&&null==T[ka.field]&&(T[ka.field]=await ka.getDefault(aa,ea.view),fa=!0);fa&&(aa=await u.getDisplayedSymbol(S,{useSourceLayer:!0,webStyleCache:ba,scale:Q}));switch(aa?.type){case "simple-fill":case "polygon-3d":ea.polygonSymbol=
aa;break;case "simple-line":case "line-3d":ea.polylineSymbol=aa;break;case "simple-marker":case "picture-marker":case "point-3d":case "cim":ea.pointSymbol=aa;break;case "mesh-3d":ea.meshSymbol=aa}z(ea.tooltipOptions,Z,W)}function z(ea,S,T){ea.visualVariables=null!=S||null!=T?{size:null!=S?{unit:S.displayUnit,axis:S.axis,valueType:S.fieldType}:null,rotation:null!=T?{valueType:T.fieldType,rotationType:T.rotationType??"geographic"}:null}:null}async function A(ea,S,T,ba){if(0===ea.length)return[];const {updatable:Q,
graphicsByLayer:W}=await T.async(async()=>{var {results:Z}=await M.whenOrAbort(F.hitTestSelectSimilarDistance(S,T),ba);const aa=new Map;F.filterGraphicHits(Z).forEach(({graphic:fa})=>{var ka=fa.layer;var la=aa.get(ka);la?ka=la:(la=[],aa.set(ka,la),ka=la);return ka.push(fa)});Z=ea.filter(({supports:fa,layer:ka})=>fa.includes("update")&&aa.has(ka));0!==Z.length&&T.stopPropagation();return{updatable:Z,graphicsByLayer:aa}});return M.whenOrAbort(Promise.allSettled(Q.map(async({layer:Z})=>{var aa=W.get(Z);
const fa=G(Z);if(aa.every(ja=>f.featureHasFields(fa,ja)))return aa;const ka=[];for(var la of aa)ka.push(la.getObjectId()),aa=Object.keys(la.attributes),m.addMany(fa,aa);la=Z.createQuery();la.returnGeometry=!1;la.objectIds=ka;la.outFields=f.fixFields(Z.fieldsIndex,fa);return Z.queryFeatures(la,{signal:ba}).then(({features:ja})=>ja)})),ba)}async function v(ea,S,T,ba){if(0===ea.length)return[];let Q=null;const W=await T.async(async()=>{var {results:Z}=await M.whenOrAbort(S.hitTest(T),ba);if(0===Z.length)return[];
const aa=new Set;Q=F.filterGraphicHits(Z);Q.forEach(({graphic:fa})=>fa&&aa.add(fa.layer));Z=ea.items.filter(({layer:fa,supports:ka,attachmentsOnUpdateEnabled:la})=>aa.has(fa)&&(ka.includes("update")||ka.includes("delete")||la));0<Z.length&&T.stopPropagation();return Z});return M.whenOrAbort(Promise.allSettled(W.map(async({layer:Z})=>{const aa=Z.createQuery();aa.returnGeometry=!1;aa.outFields=G(Z);const fa="renderer"in Z?l.calculateTolerance({renderer:Z.renderer,event:T}):0;aa.geometry=K.createQueryGeometry(T.mapPoint,
fa,S);aa.outSpatialReference=S.spatialReference;const {features:ka}=await Z.queryFeatures(aa,{signal:ba});Q?.forEach(({graphic:la})=>{la.layer!==Z||ka.some(ja=>ja.getObjectId()===la.getObjectId())||ka.push(la)});return ka})),ba)}function G(ea){return f.fixFields(ea.fieldsIndex,[ea.objectIdField,f.getDisplayFieldName({displayField:"displayField"in ea?ea.displayField:null,fields:ea.fields})])}async function O(ea){const {graphic:S,sketchViewModel:T,sourceLayer:ba,visualVariables:Q,webStyleCache:W}=ea;
let Z=!1;const {rotation:aa,size:fa}=Q;[aa,fa].forEach(async ka=>{if(null!=ka){var la=S.getAttribute(ka.field);null!=la?ka.initValue(la):(la=await ka.getDefault(S.symbol,T.view),ka.initValue(la),S.setAttribute(ka.field,la),Z=!0)}});Z&&await C(S,W,"2d"===T.view?.type?T.view.scale:null);ea={multipleSelectionEnabled:!1};"point"===ba.geometryType&&(ea.enableRotation=null!=aa,ea.enableScaling=null!=fa);z(T.tooltipOptions,fa,aa);T.layer.elevationInfo=ba.elevationInfo;return T.update(S,ea)}async function U(ea,
S,T,ba,Q){if(null!=S.geometry&&"point"===S.geometry?.type){var W=ba.rotation;var Z=T.toolEventInfo;Z=null==Z||"rotate-start"!==Z.type&&"rotate"!==Z.type&&"rotate-stop"!==Z.type?null:Z;if(null!=W&&null!=Z)if("rotate-stop"===Z.type)W.isUpdatingInteractively=!1,W.initValue();else{W.isUpdatingInteractively=!0;const {field:aa,getValue:fa}=W;S.setAttribute(aa,fa(Z.angle,ea))}ba=ba.size;T=T.toolEventInfo;T=null==T||"scale-start"!==T.type&&"scale"!==T.type&&"scale-stop"!==T.type?null:T;if(null!=ba&&null!=
T)if("scale-stop"===T.type)ba.isUpdatingInteractively=!1,ba.initValue();else{ba.isUpdatingInteractively=!0;const {field:aa,getValue:fa}=ba;S.setAttribute(aa,fa(T.xScale,ea))}await C(S,Q,"2d"===ea.type?ea.scale:null)}}function ca(ea,S,T){if("3d"===ea.type){const ba=new L.GraphicState({graphic:S});return n.handlesGroup([ea.trackGraphicState(ba),k.watch(()=>ba.displaying,T)])}return k.watch(()=>S.visible,T)}async function X(ea,S){if("3d"===ea.type){const T=new L.GraphicState({graphic:S});ea=ea.trackGraphicState(T);
await k.whenOnce(()=>T.displaying);ea.remove()}else await k.whenOnce(()=>S.visible)}function da(ea){switch(ea){case "unknown":case "decimal-degrees":return null;default:return ea}}function ha(ea){const S=ea.geometry;if("mesh"===S?.type){const T=ea.cloneShallow();T.attributes=B.clone(ea.attributes);T.geometry=S.cloneShallow();T.geometry.transform=S.transform?.clone()??null;return T}return ea.clone()}const ia={icon:w.px2pt(24),text:w.px2pt(12),line:w.px2pt(1),viewScaleSizeFactor:100},ma=(ea,S)=>ea.whenLayerView("subtype-sublayer"===
S.type?S.parent:S);x=Symbol();b.UsesSketchViewModelSymbol=x;b.avoidFeatureTemplateSelectionWithOnlyOneItem=function(ea,S){ea.viewModel.syncFeatureTemplates();ea=ea.creationInfo;if("awaiting-feature-creation-info"===S[0].id&&ea){const T=ea.layer,ba=y.getAllTemplatesForLayer(T);1===ba.length&&"scene"!==T.type&&(ea.template=ba[0],S.shift())}return S};b.canCreateInteractiveEditSession=function(ea){return"createInteractiveEditSession"in ea};b.cloneGraphicExceptMesh=ha;b.createWorkflowSteps=function(ea,
S,T){let ba=!1;return ea.filter(Q=>ba?!0:ba=Q===S).map(Q=>T[Q]())};b.fetchCandidates=async function(ea,S,T,ba){switch(S.type){case "3d":return A(ea,S,T,ba);case "2d":return v(ea,S,T,ba)}};b.fetchFullFeature=async function(ea,S,T){const {sourceLayer:ba}=ea,Q=ba.createQuery();Q.objectIds=[ea.getAttribute(ba.objectIdField)];Q.outFields=["*"];Q.outSpatialReference=S;Q.returnM=ba.capabilities.data.supportsM;Q.returnZ=ba.capabilities.data.supportsZ;t.sceneLayerEditingEnabled()&&t.i3sPatchingEnabled()&&
"scene"===ba.type&&null!=ba.infoFor3D&&(Q.returnGeometry=!0,Q.formatOf3DObjects="3D_glb");ea=await ba.queryFeatures(Q,{signal:T});M.throwIfAborted(T);return ea.features[0]};b.findLayerInfo=function(ea,S){return ea?ea.find(T=>T.layer===S):void 0};b.getVisualVariableAttributes=p;b.isTerminalUpdateEventType=ea=>/-stop/.test(ea)||/vertex-/.test(ea);b.prepareAttachmentsForCreateWorkflow=function(ea){ea.filesEnabled=!0;ea.mode="view";ea.capabilities={editing:!0,operations:{add:!0,update:!0,delete:!0}}};
b.setUpFeatureAdd=async function(ea,S,T,ba){(await H(ea,S,ba)).remove();const Q=ea.on("create",async W=>{"cancel"===W.state&&(await H(ea,S,ba)).remove();"complete"===W.state&&(W=W.graphic,W.sourceLayer||(W.sourceLayer=S.layer),W.attributes||(W.attributes={...S.template?.prototype.attributes}),await C(W,ba,"2d"===ea.view?.type?ea.view?.scale:null),T(W))});return n.handlesGroup([Q,n.makeHandle(()=>ea.cancel())])};b.setUpGeometryUpdate=async function({feature:ea,featureClone:S,visualVariableAttributes:T,
sketchViewModel:ba,view:Q,onUpdate:W,webStyleCache:Z}){await C(S,Z,"2d"===Q.type?Q.scale:null);let aa=null;if("2d"===ba?.view?.type){const oa=M.debounce(pa=>C(S,Z,pa));aa=k.watch(()=>ba?.view?.scale,pa=>oa(pa))}Q.map.add(ba.layer);const fa=S.sourceLayer;var ka=ma(Q,fa);await O({graphic:S,sketchViewModel:ba,sourceLayer:fa,visualVariables:T,webStyleCache:Z});let la=null;ka.then(oa=>la=oa).catch(()=>{});const ja=T.size,V=T.rotation;ka=k.watch(()=>ea.attributes,async oa=>{let pa=!1;for(const qa in oa){const ra=
oa[qa];ra!==S.getAttribute(qa)&&(S.setAttribute(qa,ra),null==ja||ja.isUpdatingInteractively||ja.field!==qa||ja.initValue(ra),null==V||V.isUpdatingInteractively||V.field!==qa||V.initValue(ra),null==la||la.requiredFields.includes(qa))&&(pa=!0)}pa&&await C(S,Z,"2d"===Q.type?Q.scale:null)});const Y=ba.on("update",async oa=>{const pa=oa.graphics[0];if("complete"===oa.state)return O({graphic:pa,sketchViewModel:ba,sourceLayer:fa,visualVariables:T,webStyleCache:Z});await U(Q,pa,oa,T,Z);W(ha(pa),oa)}),na=
ba.on(["undo","redo"],async oa=>{W(ha(oa.graphics[0]),oa)});return n.handlesGroup([na,Y,n.makeHandle(()=>ba.cancel()),ka,aa])};b.shouldShowAttachmentsForCreateWorkflow=function(ea){const {creationInfo:S,viewModel:T}=ea;if(!S)return!1;const {layer:ba}=S;if(ea=T.editableItems.find(W=>W.layer===ba))return ea.attachmentsOnCreateEnabled;ea=ba.capabilities?.data;const Q=T.layerInfos?.find(W=>W.layer===ba);return!(!(ea&&"supportsAttachment"in ea&&ea.supportsAttachment)||Q&&(!1===Q.allowAttachments||!1===
Q.attachmentsOnUpdateEnabled))};b.showProgressCursor=function(ea){const S=ea.cursor;ea.cursor="progress";return n.makeHandle(()=>ea.cursor=S)};b.sizeDefaults=ia;b.sizeVariableUnitToLengthUnit=da;b.startCreatingNewFeature=H;b.startUpdatingFeature=O;b.swapForEditingSession=async function(ea,S,T){function ba(fa){aa?.abort();aa=g.createTask(async ka=>{const la=await ma(Q,W);M.throwIfAborted(ka);la.setVisibility?.(Z,fa)})}const Q=ea.view;ea.layer.add(T);const W=S.sourceLayer,Z=S.getAttribute(S.layer.objectIdField);
let aa=null;await X(Q,T);ba(!1);return n.handlesGroup([ca(Q,T,fa=>ba(!fa)),n.makeHandle(async()=>{ba(!0);try{const fa=await ma(Q,W);await k.whenOnce(()=>!fa.updating)}finally{ea.layer.remove(T)}})])};b.updateGraphicSymbolWhenRequired=C;b.visualVariableInteractiveUpdate=U;b.whenEditorLayerView=ma;b.whenGraphicDisplayed=X;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/clickToleranceUtils":function(){define(["exports"],function(a){function b(g,x){return x?"xoffset"in
x&&x.xoffset?Math.max(g,Math.abs(x.xoffset)):"yoffset"in x&&x.yoffset?Math.max(g,Math.abs(x.yoffset||0)):g:g}function d(g,x){if("number"===typeof g)return g;if(g?.stops?.length){g=g.stops;let n=x=0;for(let B=0;B<g.length;B++){const M=g[B].size;"number"===typeof M&&(x+=M,n++)}return x/n}return x}function m(g,x){if(!x)return g;x=x.filter(M=>"size"===M.type).map(M=>{const {maxSize:k,minSize:w}=M;return(d(k,g)+d(w,g))/2});let n=0;const B=x.length;if(0===B)return g;for(let M=0;M<B;M++)n+=x[M];return Math.max(Math.floor(n/
B),g)}a.calculateTolerance=function(g){const x=g?.renderer;g="touch"===g?.event?.pointerType?9:6;if(!x)return g;g="visualVariables"in x?m(g,x.visualVariables):g;if("simple"===x.type)return b(g,x.symbol);if("unique-value"===x.type){let n=g;x.uniqueValueInfos?.forEach(B=>{n=b(n,B.symbol)});return n}if("class-breaks"===x.type){let n=g;x.classBreakInfos.forEach(B=>{n=b(n,B.symbol)});return n}return g};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/layers/graphics/GraphicState":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Evented ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,d,m,g,x,n,B){a.GraphicState=class extends d.EventedAccessor{constructor(M){super(M);this.isDraped=this.displaying=this.tracking=!1}};b.__decorate([m.property({constructOnly:!0})],a.GraphicState.prototype,"graphic",void 0);b.__decorate([m.property()],a.GraphicState.prototype,"tracking",void 0);b.__decorate([m.property()],a.GraphicState.prototype,"displaying",void 0);b.__decorate([m.property()],a.GraphicState.prototype,"isDraped",void 0);a.GraphicState=b.__decorate([B.subclass("esri.views.3d.layers.graphics.GraphicState")],
a.GraphicState);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/drapedUtils":function(){define(["exports","../../geometry","../../core/unitUtils","../../renderers/support/clickToleranceUtils","../../geometry/Extent"],function(a,b,d,m,g){function x(B,M,k,w=new g){let e=0;if("2d"===k.type)e=M*(k.resolution??0);else if("3d"===k.type){var f=k.overlayPixelSizeInMapUnits(B),l=k.basemapSpatialReference;e=null==l||l.equals(k.spatialReference)?M*f:d.getMetersPerUnitForSR(l)/
d.getMetersPerUnitForSR(k.spatialReference)}M=B.x-e;f=B.y-e;l=B.x+e;B=B.y+e;({spatialReference:k}=k);w.xmin=Math.min(M,l);w.ymin=Math.min(f,B);w.xmax=Math.max(M,l);w.ymax=Math.max(f,B);w.spatialReference=k;return w}const n=new g;a.createQueryGeometry=x;a.intersectsDrapedGeometry=function(B,M,k){B=k.toMap(B);if(null==B)return!1;const w=m.calculateTolerance();return x(B,w,k,n).intersects(M)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/hitTestSelectUtils":function(){define(["exports"],
function(a){function b(d){return"graphic"===d?.type}a.filterGraphicHits=function(d){return d.filter(b)};a.findFirstGraphicHit=function(d){return d.find(b)??null};a.hitTestSelectSimilarDistance=async function(d,m){if("2d"===d.type)return d.hitTest(m);d=await d.hitTest(m);if(0===d.results.length)return d;const g=1.05*(d.results[0].distance??0);m=d.results.findIndex(x=>(x.distance??0)>g);-1!==m&&(d.results=d.results.slice(0,m));return d};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/widgets/Editor/Workflow":function(){define("../../chunks/tslib.es6 ../../core/Error ../../core/Evented ../../core/promiseUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../core/support/UpdatingHandles".split(" "),function(a,b,d,m,g,x,n,B,M,k){d=class extends d.EventedAccessor{constructor(w){super(w);this._indexHistory=[];this._stepIndex=this._lastStepIndex=-1;this._updatingHandles=
new k.UpdatingHandles;this._handleKeys={afterCommit:"after-commit",beforeCommit:"before-commit"};this.data=void 0;this.started=!1;this.steps=[];this._pendingOperation=this.type=null}destroy(){this._updatingHandles.destroy()}get hasNextStep(){const {steps:w}=this;return!!(w&&this._stepIndex<w.filter(e=>!e.parent).length-1)}get hasPreviousStep(){return 0<this._stepIndex}get reliesOnOwnerAdminPrivileges(){return!1}get hasInvalidFormTemplate(){return!1}get hasUnsupportedFields(){return!1}get shouldShowAttachments(){return!1}get shouldAllowAttachmentEditing(){return!1}get stepId(){var {steps:w}=
this;return(w=w&&w[this._stepIndex])&&w.id}get helpMessage(){}get hasPendingEdits(){return!1}get keyboardCancellationEnabled(){return!0}get updating(){return this._updatingHandles.updating}async back(w=()=>Promise.resolve(!0)){if(!this.hasPendingEdits||await w())this.hasPreviousStep?await this.previous({cancelCurrentStep:!0}):await this.cancel({force:!0})}async cancel(w={force:!0}){return!1!==w.force?this._cancel(w):new Promise((e,f)=>{this.emit("cancel-request",{controller:{allow:()=>{this._cancel({...w,
force:!0}).then(e)},deny:()=>f(new b("workflow:cancel-denied","Request to cancel workflow was denied."))}})})}async commit(){this.removeHandles(this._handleKeys.beforeCommit);this.onCommit&&await this.onCommit(this.data);this.removeHandles(this._handleKeys.afterCommit);this.emit("commit")}async go(w){var {steps:e}=this;e=e.findIndex(f=>f.id===w);this._indexHistory.push(this._stepIndex);await this._go(e)}async next(){this._indexHistory.push(this._stepIndex);await this._go(this._stepIndex+1)}async previous(w=
{cancelCurrentStep:!1}){await this._go(this._indexHistory.pop(),w.cancelCurrentStep)}async reset(){await this._cancel({emitCancelEvent:!1});await this.start()}async save(){await this.commit();await this.reset()}async start(){this._set("started",!0);await this._go(-1===this._stepIndex?0:this._stepIndex)}async _cancel({emitCancelEvent:w=!0,error:e}={}){this.started&&(this._set("started",!1),await this._transaction(()=>this.steps[this._stepIndex]?.tearDown({canceled:!0})));this.removeHandles([this._handleKeys.afterCommit,
this._handleKeys.beforeCommit]);this._resetIndexing(w);w&&this.emit("cancel",{error:e})}_go(w=-1,e=!1){return this._transaction(async()=>{const {steps:f}=this;if(!(-1>=w||w>=f.length)){if(this.started){-1<this._lastStepIndex&&await f[this._lastStepIndex].tearDown({canceled:e});try{await f[w].setUp()}catch(l){m.throwIfNotAbortError(l)}this._lastStepIndex=w}this._stepIndex=w;this._notifyStepProps()}})}async _transaction(w){const e=this._pendingOperation,f=m.createResolver(),l=(e??Promise.resolve()).then(()=>
f.promise);this._pendingOperation=l;this._updatingHandles.addPromise(l);try{e&&await e,await w()}finally{f.resolve(),l===this._pendingOperation&&(this._pendingOperation=null)}}_resetIndexing(w=!0){this._lastStepIndex=this._stepIndex=-1;this._indexHistory.length=0;w&&this._notifyStepProps()}_notifyStepProps(){this.notifyChange("stepId");this.notifyChange("hasPreviousStep");this.notifyChange("hasNextStep")}};a.__decorate([g.property()],d.prototype,"data",void 0);a.__decorate([g.property()],d.prototype,
"hasNextStep",null);a.__decorate([g.property()],d.prototype,"hasPreviousStep",null);a.__decorate([g.property()],d.prototype,"onCommit",void 0);a.__decorate([g.property()],d.prototype,"reliesOnOwnerAdminPrivileges",null);a.__decorate([g.property()],d.prototype,"hasInvalidFormTemplate",null);a.__decorate([g.property()],d.prototype,"hasUnsupportedFields",null);a.__decorate([g.property()],d.prototype,"shouldShowAttachments",null);a.__decorate([g.property()],d.prototype,"shouldAllowAttachmentEditing",
null);a.__decorate([g.property()],d.prototype,"started",void 0);a.__decorate([g.property({readOnly:!0})],d.prototype,"stepId",null);a.__decorate([g.property()],d.prototype,"steps",void 0);a.__decorate([g.property({readOnly:!0})],d.prototype,"type",void 0);a.__decorate([g.property()],d.prototype,"helpMessage",null);a.__decorate([g.property()],d.prototype,"hasPendingEdits",null);a.__decorate([g.property()],d.prototype,"keyboardCancellationEnabled",null);a.__decorate([g.property()],d.prototype,"updating",
null);return d=a.__decorate([M.subclass("esri.widgets.Editor.Workflow")],d)})},"esri/widgets/Editor/CreateWorkflow":function(){define("../../chunks/tslib.es6 ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../layers/support/layerUtils ../../views/draw/support/helpMessageUtils ./CreateWorkflowData ./Edits ./Workflow ./workflowUtils".split(" "),function(a,
b,d,m,g,x,n,B,M,k,w,e,f){var l;m=l=class extends e{constructor(q){super(q);this.type="create"}get shouldShowAttachments(){return this.data?.creationInfo&&this.data.viewModel?f.shouldShowAttachmentsForCreateWorkflow(this.data):!1}get shouldAllowAttachmentEditing(){return this.shouldShowAttachments}get hasPendingEdits(){return!0}get helpMessage(){if("editing-new-feature"===this.stepId){var {creationInfo:q,viewModel:r}=this.data,c=q.layer.geometryType;if("mesh"!==c)return M.getDrawHelpMessage(c,r.sketchViewModel.createGraphic?.geometry)}}get reliesOnOwnerAdminPrivileges(){const {layer:q}=
this.data.creationInfo,r=q.capabilities?.operations.supportsAdd,c=B.getEffectiveLayerCapabilities(q)?.operations.supportsAdd;return B.getEffectiveEditingEnabled(q)&&!q.editingEnabled||!!c&&!r}static create(q,r,c){q=new l({data:new k({edits:new w.Edits,viewModel:q}),onCommit:async t=>{await c(t.creationInfo.layer,{addFeatures:[t.edits.feature]})}});q._set("steps",this._createWorkflowSteps(q,r));return q}static _createWorkflowSteps(q,r="awaiting-feature-creation-info"){const {data:c}=q,t=new Map;r=
f.createWorkflowSteps(["awaiting-feature-creation-info","awaiting-feature-to-create","editing-new-feature","adding-attachment","editing-attachment"],r,{"awaiting-feature-creation-info":()=>({id:"awaiting-feature-creation-info",async setUp(){c.creationInfo=null;c.edits.feature=null;c.viewModel.featureTemplatesViewModel.select(null);q.addHandles(c.viewModel.featureTemplatesViewModel.on("select",({item:h})=>{h&&(c.creationInfo=h,c.viewModel.activeWorkflow?.next())}),this.id)},async tearDown(){q.removeHandles(this.id)}}),
"awaiting-feature-to-create":()=>({id:"awaiting-feature-to-create",async setUp(){q.addHandles(await f.setUpFeatureAdd(c.viewModel.sketchViewModel,c.creationInfo,h=>{c.edits.feature=h;c.viewModel.activeWorkflow?.next()},t),this.id)},async tearDown(){q.removeHandles(this.id)}}),"editing-new-feature":()=>({id:"editing-new-feature",async setUp(){const h=c.edits.feature,u=h.sourceLayer,L=c.viewModel,K=L.sketchViewModel;var F=f.findLayerInfo(L.layerInfos,u);const {spatialReference:y}=L.view;L.featureFormViewModel.set({arcadeEditType:"INSERT",
feature:h,formTemplate:F?.formTemplate,spatialReference:y});K.allowDeleteKey=!1;f.prepareAttachmentsForCreateWorkflow(L.attachmentsViewModel);const p=f.getVisualVariableAttributes(h);await f.startUpdatingFeature({graphic:h,sketchViewModel:K,sourceLayer:u,visualVariables:p,webStyleCache:t});F=K.on("update",async I=>{var R=I.graphics[0];if("complete"===I.state)return f.startUpdatingFeature({graphic:R,sketchViewModel:K,sourceLayer:u,visualVariables:p,webStyleCache:t});await f.visualVariableInteractiveUpdate(K.view,
R,I,p,t);I=R.attributes;null!=p.rotation&&({field:R}=p.rotation,L.featureFormViewModel.setValue(R,I[R]));null!=p.size&&({field:R}=p.size,L.featureFormViewModel.setValue(R,I[R]))});q.addHandles([c.viewModel.featureFormViewModel.on("value-change",async()=>{c.edits.updateAttributes(c.viewModel.featureFormViewModel.getValues());h.attributes=c.edits.feature.attributes;"3d"===K.view.type&&await f.updateGraphicSymbolWhenRequired(h,t)}),F,b.watch(()=>c.viewModel.attachmentsViewModel.mode,I=>{"add"===I&&c.viewModel.activeWorkflow.go("adding-attachment");
"edit"===I&&c.viewModel.activeWorkflow.go("editing-attachment")})],this.id)},async tearDown(h){h.canceled&&c.viewModel.sketchViewModel.layer.removeAll();q.removeHandles(this.id)}}),"adding-attachment":()=>({id:"adding-attachment",parent:"editing-new-feature",async setUp(){},async tearDown(){c.viewModel.attachmentsViewModel.mode="view"}}),"editing-attachment":()=>({id:"editing-attachment",parent:"editing-new-feature",async setUp(){},async tearDown(){c.viewModel.attachmentsViewModel.mode="view"}})});
return f.avoidFeatureTemplateSelectionWithOnlyOneItem(c,r)}};a.__decorate([d.property()],m.prototype,"shouldShowAttachments",null);a.__decorate([d.property()],m.prototype,"shouldAllowAttachmentEditing",null);a.__decorate([d.property()],m.prototype,"hasPendingEdits",null);a.__decorate([d.property()],m.prototype,"helpMessage",null);a.__decorate([d.property()],m.prototype,"reliesOnOwnerAdminPrivileges",null);return m=l=a.__decorate([n.subclass("esri.widgets.Editor.CreateWorkflow")],m)})},"esri/widgets/Editor/CreateWorkflowData":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,d,m,g,x,n){b=class extends b{constructor(B){super(B);this.viewModel=this.edits=this.creationInfo=null}};a.__decorate([d.property()],b.prototype,"creationInfo",void 0);a.__decorate([d.property()],b.prototype,"edits",void 0);a.__decorate([d.property()],b.prototype,"viewModel",void 0);return b=a.__decorate([n.subclass("esri.widgets.Editor.CreateWorkflowData")],b)})},"esri/widgets/Editor/Edits":function(){define("exports ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,d,m,g,x,n,B){function M(k){return null==k?null:JSON.stringify(k)}a.Edits=class extends d{constructor(k){super(k);this._stagedForDelete=!1;this.initialFeature=this.feature=null}get attributesModified(){return this._stringifyAttributes(this.feature)!==this._stringifyAttributes(this.initialFeature)}get geometryModified(){return this._stringifyGeometry(this.feature)!==this._stringifyGeometry(this.initialFeature)}get stagedForDelete(){return this._stagedForDelete}get modified(){return this.attributesModified||
this.geometryModified||this._stagedForDelete}stageDelete(){this._stagedForDelete=!0}unstageDelete(){this._stagedForDelete=!1}trackChanges(){this.initialFeature=this.feature?.clone()}updateAttributes(k){const {feature:w}=this;w&&(w.attributes=k,this.notifyChange("attributesModified"))}updateGeometry(k){const {feature:w}=this;w&&(w.geometry=k,this.notifyChange("geometryModified"))}_stringifyAttributes(k){return M(k?.attributes)}_stringifyGeometry(k){k=k?.geometry;return"mesh"===k?.type?M({transform:k.transform,
vertexSpace:k.vertexSpace}):M(k)}};b.__decorate([m.property()],a.Edits.prototype,"_stagedForDelete",void 0);b.__decorate([m.property()],a.Edits.prototype,"attributesModified",null);b.__decorate([m.property()],a.Edits.prototype,"feature",void 0);b.__decorate([m.property()],a.Edits.prototype,"geometryModified",null);b.__decorate([m.property()],a.Edits.prototype,"initialFeature",void 0);b.__decorate([m.property()],a.Edits.prototype,"modified",null);a.Edits=b.__decorate([B.subclass("esri.widgets.Editor.Edits")],
a.Edits);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/UpdateWorkflow":function(){define("../../chunks/tslib.es6 ../../Graphic ../../core/Error ../../core/handleUtils ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/Queue ../../core/reactiveUtils ../../core/SetUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../layers/support/editableLayers ../../layers/support/layerUtils ../../views/draw/support/HighlightHelper ./CreateFeaturesWorkflow ./UpdateFeatureWorkflow ./UpdateRecordWorkflow ./UpdateWorkflowData ./Workflow ./workflowUtils ../Feature/support/featureUtils ../support/templateUtils".split(" "),
function(a,b,d,m,g,x,n,B,M,k,w,e,f,l,q,r,c,t,h,u,L,K,F,y,p,I){var R;const D=g.getLogger("esri.widgets.Editor.UpdateWorkflow");g=R=class extends F{constructor(N){super(N);this._workflowStack=new B(k.last);this._sketchStack=new B(k.last);this.type="update"}get activeEditableItem(){return this.activeWorkflow?.data.editableItem??void 0}get activeWorkflow(){return this._workflowStack.last()}get nestedWorkflowCount(){return this._workflowStack.length}get shouldShowAttachments(){return!!this.activeEditableItem?.attachmentsOnUpdateEnabled}get shouldAllowAttachmentEditing(){return!!this.activeEditableItem?.supports.includes("update")}get hasPendingEdits(){return Array.from(this._workflowStack).some(N=>
N.hasPendingEdits)}get helpMessage(){return this.activeWorkflow?.helpMessage?this.activeWorkflow.helpMessage:"awaiting-feature-to-update"===this.stepId?"select":void 0}get reliesOnOwnerAdminPrivileges(){return this.activeWorkflow?.reliesOnOwnerAdminPrivileges??!1}get hasInvalidFormTemplate(){return!!this.activeEditableItem?.hasInvalidFormTemplate}get hasUnsupportedFields(){return!!this.activeEditableItem?.hasUnsupportedFields}async back(N=()=>Promise.resolve(!0)){const {featureFormViewModel:C}=this.data.viewModel;
if(null!=C.relationshipId)C.relationshipId=null;else if(this.activeWorkflow){if(!this.activeWorkflow.hasPendingEdits||await N())this.activeWorkflow.hasPreviousStep?await this.activeWorkflow.previous({cancelCurrentStep:!0}):await this.cancelActiveWorkflow({force:!0})}else this.hasPreviousStep?await this.previous({cancelCurrentStep:!0}):await this.cancel({force:!0})}async cancelActiveWorkflow(N){await this.activeWorkflow?.cancel(N);await this._popWorkflow()}async commit(){await this._drainWorkflowStack(N=>
N.commit());await super.commit()}static create(N){const {viewModel:C,startAt:P,addAttachmentsCallback:H,applyEditsCallback:J}=N;N=new R({data:new K({addAttachmentsCallback:H,applyEditsCallback:J,viewModel:C}),onCommit:async()=>{}});N._set("steps",this._createWorkflowSteps(N,P));return N}async save(){1<this.nestedWorkflowCount?(await this.activeWorkflow?.commit(),await this._popWorkflow()):await this.commit()}async startCreatingRelatedRecord(N){try{const C=await this._createNestedCreateFeaturesWorkflow(N);
await this._pushWorkflow(C)}catch(C){throw new d("editor:unable-to-start-creating","Could not begin updating the provided feature or table record.",{error:C});}}async startUpdating(N){try{const C=await this._createNestedUpdateWorkflow(N);await this._pushWorkflow(C)}catch(C){throw new d("editor:unable-to-start-updating","Could not begin updating the provided feature or table record.",{error:C});}}async deleteActiveFeature(){const {activeWorkflow:N}=this;if(!N)throw new d("editor:nothing-to-delete",
"There is no feature to delete");N&&/update-/.test(N.type)?await N.deleteAndCommit():await N.cancel();1===this.nestedWorkflowCount?await this.reset():await this._popWorkflow()}async cancelAll(){await this._drainWorkflowStack(N=>N.cancel({force:!0}))}async _createNestedCreateFeaturesWorkflow(N){const {relatedLayer:C}=N,{addAttachmentsCallback:P,applyEditsCallback:H,viewModel:J}=this.data;if(!r.isEditableLayer(C))throw new d("editor:unsupported-layer","Editing is not supported on the provided layer");
N=this._getCreationInfoForNestedCreateFeaturesWorkflow(N);return h.create({addAttachmentsCallback:P,applyEditsCallback:H,creationInfo:N,isNested:!0,parent:"create-features"!==this.activeWorkflow?.type?this.activeWorkflow:void 0,startAt:N.template||N.initialFeature?"creating-features":"awaiting-feature-creation-info",viewModel:J})}_getCreationInfoForNestedCreateFeaturesWorkflow(N){const {relatedLayer:C}=N;if(!r.isEditableLayer(C)||c.isSubtypeGroupLayer(C))throw new d("editor:unsupported-layer","Editing is not supported on the provided layer");
const P={layer:C,maxFeatures:1};N=this._makeRelatedRecordAttributes(N);const H=I.getAllTemplatesForLayer(C);0<H?.length?(P.attributeOverrides=N,1===H.length&&(P.template=H[0])):P.initialFeature=new b({sourceLayer:C,attributes:N});return P}async _createNestedUpdateWorkflow(N){const C=c.isTable(N.sourceLayer)?L.UpdateRecordWorkflow:u.UpdateFeatureWorkflow,{applyEditsCallback:P,viewModel:H}=this.data,J=await C.create({feature:N,parent:"create-features"!==this.activeWorkflow?.type?this.activeWorkflow:
void 0,viewModel:H,applyEdits:P});await M.whenOnce(()=>!J.updating);return J}async _drainWorkflowStack(N){const C=this._workflowStack,P=[];for(;0<C.length;){const H=C.pop();this._sketchStack.pop();const J=N(H).then(()=>H.destroy());this._updatingHandles.addPromise(J);P.push(J)}await Promise.all(P)}_makeRelatedRecordAttributes(N){const {parentFeature:C,relatedLayer:P,relationshipId:H}=N;if(p.isGraphicForRelatableFeatureSupportedLayer(C))if(N=P.relationships?.find(z=>z.id===H))if("origin"===N.role)E("unsupported-role",
"Creating new related records in the 'origin' table of a relationship is not yet supported");else{var J=C.sourceLayer;N.relatedTableId!==J.layerId&&E("invalid-argument-combination","The given parent feature does not belong to the relationship designated by the given relationship ID.");if(J=J.relationships?.find(z=>z.id===H))return(J=C.getAttribute(J.keyField))||E("no-key-on-origin-feature","The given parent feature does not have a value for the relationship's origin primary key field."),{[N.keyField]:J};
E("relationship-not-found","Could not begin creating a related record because the relationship specified could not be found on the origin layer.")}else E("relationship-not-found","Could not begin creating a related record because the relationship specified could not be found on the destination layer.")}async _popWorkflow(){this._workflowStack.pop()?.destroy();this._sketchStack.pop();const N=await this._reconcileWorkflowStack();if(0<N.failureCount)throw new d("editor:next-workflow-failed","Popped the top workflow, but the next workflow in the stack failed to activate",
N);}async _pushWorkflow(N){var C=this._workflowRequiresSketchViewModel(N);this.activeWorkflow?.exit({removeSketchHandles:C});C=this._sketchStack;const P=await N?.start(),H=C.peek();P?(H?.exit(),C.push(P)):C.push(this._cloneSketchController(H));this._workflowStack.push(N);N=await this._reconcileWorkflowStack();if(0<N.failureCount)throw new d("editor:failed-to-start-updating-feature","Failed to enter the provided workflow.",N);}async _reconcileWorkflowStack(){const N=this._workflowStack,C=this._sketchStack;
try{const P=N.peek();await P?.enter();await C.peek()?.enter();return{activeWorkflow:P,failureCount:0}}catch(P){N.pop().destroy();C.pop();const {activeWorkflow:H,failureCount:J}=await this._reconcileWorkflowStack();return{activeWorkflow:H,failureCount:J+1}}}_cloneSketchController(N){return{enter:N?.enter??(async()=>{}),exit:N?.exit??(async()=>{})}}_workflowRequiresSketchViewModel(N){const {type:C}=N;return"update-feature"===C||"create-features"===C&&!c.isTable(N.data.creationInfo?.layer)}static _createWorkflowSteps(N,
C="awaiting-feature-to-update"){const {data:P}=N;return y.createWorkflowSteps(["awaiting-feature-to-update","awaiting-update-feature-candidate","editing-existing-feature","adding-attachment","editing-attachment"],C,{"awaiting-feature-to-update":()=>({id:"awaiting-feature-to-update",async setUp(){const {spinnerViewModel:H}=P.viewModel,J=P.viewModel.view;let z=null;N.addHandles(m.makeHandle(()=>{z=x.abortMaybe(z)}),this.id);P.rootFeature=null;P.candidates=[];const A=J.on("immediate-click",async v=>
{v.stopPropagation();H.location=v.mapPoint;H.visible=!0;z?.abort();const {editableItems:G}=P.viewModel;z=new AbortController;const O=await new Promise((U,ca)=>{n.onAbort(z?.signal,()=>ca(n.createAbortError()));U(y.fetchCandidates(G,J,v,z?.signal))});n.throwIfAborted(z);P.candidates=O.filter(U=>"fulfilled"===U.status).flatMap(U=>U.value);H.visible=1===P.candidates.length;0!==P.candidates.length&&(1===P.candidates.length?(P.rootFeature=P.candidates[0],N.go("editing-existing-feature").catch(()=>{}).then(()=>
H.visible=!1)):N.next())});J.focus();N.addHandles(A,this.id)},async tearDown(){0===P.candidates.length&&(P.viewModel.spinnerViewModel.visible=!1);N.removeHandles(this.id)}}),"awaiting-update-feature-candidate":()=>({id:"awaiting-update-feature-candidate",async setUp(){P.rootFeature=null;const {view:H}=P.viewModel;if(H){var J=new t({view:H});N.addHandles([M.watch(()=>P.rootFeature,(z,A)=>{J.remove(A);J.add(z)},M.sync),m.makeHandle(()=>J.removeAll())],this.id)}},async tearDown(){N.removeHandles(this.id)}}),
"editing-existing-feature":()=>({id:"editing-existing-feature",async setUp(){const {rootFeature:H,viewModel:J}=N.data;if(!H)throw new d("editor:no-feature-specified","Cannot setup the 'updating-existing-feature' step until the root feature is defined");await N.startUpdating(H);J.spinnerViewModel.visible=!1;const z=n.debounce(async()=>{await M.whenOnce(()=>!N.updating);N.previous()}),{featureFormViewModel:A}=P.viewModel,v=A.relatedRecordCallbacks;A.relatedRecordCallbacks={addRelatedRecord:async G=>
{await N.startCreatingRelatedRecord(G);A.relationshipId=null},editRelatedRecord:async({relatedFeature:G})=>{await N.startUpdating(G);A.relationshipId=null},showAllRelatedRecords:G=>A.relationshipId=G.relationshipId};N.addHandles([m.makeHandle(()=>A.relatedRecordCallbacks=v),M.watch(()=>N.nestedWorkflowCount,(G,O)=>{0===G&&0!==O&&z()},M.sync)],this.id)},async tearDown(){await N.cancelAll();N.removeHandles(this.id)}}),"adding-attachment":()=>({id:"adding-attachment",parent:"editing-existing-feature",
async setUp(){},async tearDown(){P.viewModel.attachmentsViewModel.mode="view"}}),"editing-attachment":()=>({id:"editing-attachment",parent:"editing-existing-feature",async setUp(){},async tearDown(){P.viewModel.attachmentsViewModel.mode="view"}})})}};a.__decorate([w.property()],g.prototype,"activeEditableItem",null);a.__decorate([w.property()],g.prototype,"activeWorkflow",null);a.__decorate([w.property()],g.prototype,"nestedWorkflowCount",null);a.__decorate([w.property()],g.prototype,"shouldShowAttachments",
null);a.__decorate([w.property()],g.prototype,"shouldAllowAttachmentEditing",null);a.__decorate([w.property()],g.prototype,"hasPendingEdits",null);a.__decorate([w.property()],g.prototype,"helpMessage",null);a.__decorate([w.property()],g.prototype,"reliesOnOwnerAdminPrivileges",null);a.__decorate([w.property()],g.prototype,"hasInvalidFormTemplate",null);a.__decorate([w.property()],g.prototype,"hasUnsupportedFields",null);g=R=a.__decorate([q.subclass("esri.widgets.Editor.UpdateWorkflow")],g);const E=
(N,C)=>D.warn(`editor:${N}`,C,"The create operation will be allowed to proceed, but the resulting feature may not be related to the given parent feature.");return g})},"esri/views/draw/support/HighlightHelper":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./layerUtils ../../support/layerViewUtils ../../../widgets/Feature/support/featureUtils".split(" "),
function(a,b,d,m,g,x,n,B,M,k){b=class extends b{constructor(w){super(w);this.view=null}add(w){w=!w||Array.isArray(w)?w:[w];w?.length&&w.forEach(e=>this._highlight(e))}remove(w){w=!w||Array.isArray(w)?w:[w];w?.length&&w.forEach(e=>this._unhighlight(e))}removeAll(){this.removeAllHandles()}_highlight(w){const e=B.findLayerView(this.view,w.layer);M.highlightsSupported(e)&&this.addHandles(e.highlight(w),k.getHighlightKeyForFeature(w))}_unhighlight(w){w&&this.removeHandles(k.getHighlightKeyForFeature(w))}};
a.__decorate([d.property()],b.prototype,"view",void 0);return b=a.__decorate([n.subclass("esri.views.draw.support.HighlightHelper")],b)})},"esri/views/draw/support/layerUtils":function(){define(["exports"],function(a){a.addUniqueLayer=function(b,d,m){if(d&&b?.map){({map:b}=b);var g=b.layers.find(x=>x===d);g||b.add(d,m);g&&null!=m&&b.layers.reorder(g,m)}};a.findLayerView=function(b,d){const m="subtype-sublayer"===d?.type?d.parent:d;return b.allLayerViews.find(g=>{g=g.layer;return g===m||"sublayers"in
g&&null!=g.sublayers&&g.sublayers.includes(m)})};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/layerViewUtils":function(){define(["exports"],function(a){a.extractSafeScaleBounds=function(b){b=b.effectiveScaleRange;return{minScale:b?.minScale??0,maxScale:b?.maxScale??0}};a.highlightsSupported=function(b){return b&&"function"===typeof b.highlight};a.isScaleRangeActive=function(b,d){return null!=b&&0<b||null!=d&&0<d};a.isSelectableLayerView2D=function(b){return null!=
b&&"object"===typeof b&&"createQuery"in b&&"queryFeatures"in b&&"layer"in b&&"view"in b};a.occludeesSupported=function(b){return b&&"function"===typeof b.maskOccludee};a.scaleBoundsPredicate=function(b,d,m){return null==b||b>m&&(0===d||b<d)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/UpdateFeatureWorkflow":function(){define("exports ../../chunks/tslib.es6 ../../core/Error ../../core/handleUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../views/support/layerViewUtils ./UpdateFeatureWorkflowData ./UpdateRecordWorkflow ./workflowUtils".split(" "),
function(a,b,d,m,g,x,n,B,M,k,w,e,f){var l;const q={...e.handleKeys,highlights:Symbol(),sketch:Symbol()};a.UpdateFeatureWorkflow=l=class extends e.UpdateRecordWorkflow{constructor(r){super(r);this.type="update-feature";this._sketchGraphicClone=this._layerViewEditSession=null;this._webStyleCache=new Map}initialize(){const {edits:{feature:r},layerView:c}=this.data;f.canCreateInteractiveEditSession(c)&&(this._layerViewEditSession=c.createInteractiveEditSession(r))}destroy(){this._layerViewEditSession?.rollback()}async commit(){this.removeHandles(q.sketch);
try{const r=this.data.edits.stagedForDelete;await super.commit();const c=this._layerViewEditSession;r?c?.rollback():c?.commit()}catch(r){throw await this._configureSketchViewModel(),new d("editor-workflow:failed-to-commit","An error occurred when sending the updates to the service",{error:r});}}async start(){await super.start();return this._initializeSketchViewModel()}_configureFeatureFormViewModel(){super._configureFeatureFormViewModel();const {_layerViewEditSession:r}=this,{viewModel:c}=this.data;
this.addHandles(c.featureFormViewModel.on("value-change",t=>{r?.setAttribute(t.fieldName,t.value)}),q.exit)}_configureHighlight(){const {edits:r,layerView:c}=this.data;k.highlightsSupported(c)&&this.addHandles(c.highlight(r.feature),q.highlights)}async _configureSketchViewModel(){const {data:r,_sketchGraphicClone:c}=this,{edits:t,viewModel:h}=r;var u=t.feature;const {featureFormViewModel:L,sketchViewModel:K,view:F}=h;K.allowDeleteKey=!1;const y=f.getVisualVariableAttributes(u);u=await f.setUpGeometryUpdate({feature:u,
featureClone:c,visualVariableAttributes:y,sketchViewModel:K,view:F,onUpdate:({geometry:p,attributes:I},R)=>{t.updateAttributes(I);t.updateGeometry(p);L.feature.geometry=p;null!=y.rotation&&({field:p}=y.rotation,L.setValue(p,I[p]));null!=y.size&&({field:p}=y.size,L.setValue(p,I[p]));("undo"===R.type||"redo"===R.type||"update"===R.type&&null!=R.toolEventInfo&&f.isTerminalUpdateEventType(R.toolEventInfo.type))&&L.notifyFeatureGeometryChanged()},webStyleCache:this._webStyleCache});this.addHandles(u,q.sketch)}async _initializeSketchViewModel(){const {data:r,
_sketchGraphicClone:c}=this,t=r.edits.feature,{sketchViewModel:h}=r.viewModel,{geometryUpdatesEnabled:u}=r.editableItem,L=h.updateOnGraphicClick;h.updateOnGraphicClick=!1;this.addHandles([m.makeHandle(()=>{h.updateOnGraphicClick=L})]);u&&this.addHandles([await f.swapForEditingSession(h,t,c)]);const {highlights:K,sketch:F}=q;return{enter:async()=>{!this.hasHandles(F)&&u?await this._configureSketchViewModel():this.hasHandles(K)||this._configureHighlight()},exit:()=>this.removeHandles([F,K])}}_onFullFeatureLoaded(r){super._onFullFeatureLoaded(r);
this._sketchGraphicClone=f.cloneGraphicExceptMesh(r);const {edits:c}=this.data;c.updateGeometry(r.geometry);c.trackChanges()}static async create(r){r=new l({data:await w.create(r),onCommit:this._onCommitFactory(r.applyEdits)});r._set("steps",this._createWorkflowSteps(r));return r}};b.__decorate([g.property()],a.UpdateFeatureWorkflow.prototype,"_layerViewEditSession",void 0);b.__decorate([g.property()],a.UpdateFeatureWorkflow.prototype,"_sketchGraphicClone",void 0);a.UpdateFeatureWorkflow=l=b.__decorate([M.subclass("esri.widgets.Editor.UpdateFeatureWorkflow")],
a.UpdateFeatureWorkflow);a.handleKeys=q;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/UpdateFeatureWorkflowData":function(){define("../../chunks/tslib.es6 ../../core/Error ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ./UpdateRecordWorkflowData ./workflowUtils".split(" "),function(a,b,d,m,g,x,n,B,M){var k;m=k=class extends B{constructor(w){super(w)}static async create(w){const {feature:e,
viewModel:f}=w;var {view:l}=f;if(!l)throw new b("editor:cannot-create-workflow-data","The provided EditorViewModel does not have an associated view");l=await M.whenEditorLayerView(l,e.layer);return new k({...k._makeConstructorProps(w),layerView:l})}};a.__decorate([d.property()],m.prototype,"layerView",void 0);return m=k=a.__decorate([n.subclass("esri.widgets.Editor.UpdateFeatureWorkflowData")],m)})},"esri/widgets/Editor/UpdateRecordWorkflowData":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/Error ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ./Edits ./workflowUtils".split(" "),
function(a,b,d,m,g,x,n,B,M,k){var w;b=w=class extends b{constructor(e){super(e);this.viewModel=this.parent=this.formTemplate=this.edits=this.editableItem=this.attachmentsCapabilities=null}static async create(e){e=w._makeConstructorProps(e);return new w(e)}static _makeConstructorProps(e){const {feature:f,parent:l,viewModel:q}=e;e=q.editableItems.find(h=>h.layer===f.layer);if(!e)throw new d("no-editableItem-found","The EditorViewModel provided did not have an EditableItem associated with the specified Graphic's layer");
const r=k.findLayerInfo(q.layerInfos,f.sourceLayer);var c=e.supports;const t=c.includes("create");c=c.includes("update");return{attachmentsCapabilities:{editing:!0,operations:{add:t||c,update:c,delete:c}},editableItem:e,edits:new M.Edits({feature:f}),formTemplate:r?.formTemplate,parent:l,viewModel:q}}};a.__decorate([m.property()],b.prototype,"attachmentsCapabilities",void 0);a.__decorate([m.property()],b.prototype,"editableItem",void 0);a.__decorate([m.property()],b.prototype,"edits",void 0);a.__decorate([m.property()],
b.prototype,"formTemplate",void 0);a.__decorate([m.property()],b.prototype,"parent",void 0);a.__decorate([m.property()],b.prototype,"viewModel",void 0);return b=w=a.__decorate([B.subclass("esri.widgets.Editor.UpdateRecordWorkflowData")],b)})},"esri/widgets/Editor/UpdateRecordWorkflow":function(){define("exports ../../chunks/tslib.es6 ../../core/Error ../../core/handleUtils ../../core/promiseUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../layers/support/layerUtils ../../support/featureFlags ../../views/draw/support/HighlightHelper ./UpdateRecordWorkflowData ./Workflow ./workflowUtils".split(" "),
function(a,b,d,m,g,x,n,B,M,k,w,e,f,l,q,r,c){var t;const h={exit:Symbol()};a.UpdateRecordWorkflow=t=class extends r{constructor(u){super(u);this.fullFeature=this._highlightHelper=null;this.type="update-table-record"}initialize(){const {data:u}=this;var {edits:L}=u;const {view:K}=u.viewModel;L=L.feature;const F=new AbortController;this.addHandles(m.abortHandle(F));this._updatingHandles.addPromise(c.fetchFullFeature(L,u.viewModel.view.spatialReference,F.signal).then(y=>{g.isAborted(F)||this._onFullFeatureLoaded(y)},
y=>this.cancel({force:!0,error:new d("editor:failed-to-fetch-full-feature","Failed to retrieve all information for this feature. The update cannot proceed.",{detail:{error:y}})})));K&&(this._highlightHelper=new l({view:K}),this.addHandles(m.makeHandle(()=>this._highlightHelper?.removeAll())))}get editableItem(){return this.data.editableItem}get hasPendingEdits(){return this.data.edits.modified}get parent(){return this.data.parent}get shouldShowAttachments(){return this.editableItem.attachmentsOnUpdateEnabled}get shouldAllowAttachmentEditing(){return this.editableItem.supports.includes("update")}get reliesOnOwnerAdminPrivileges(){const {layer:u}=
this.editableItem,L=u.capabilities?.operations.supportsUpdate,K=e.getEffectiveLayerCapabilities(u)?.operations.supportsUpdate;return e.getEffectiveEditingEnabled(u)&&!u.editingEnabled||!!K&&!L}async deleteAndCommit(){this.data.edits.stageDelete();return this.commit()}async enter(){this._configureAttachmentsViewModel();this._configureFeatureFormViewModel()}exit(u){this.removeHandles(h.exit)}async start(){await super.start();return null}_configureAttachmentsViewModel(){const {data:u,fullFeature:L}=
this,{attachmentsCapabilities:K,viewModel:F}=u,{attachmentsViewModel:y}=F;y.set({capabilities:K,graphic:L,filesEnabled:!1,mode:"view"});this.addHandles([m.makeHandle(()=>y.fileInfos.removeAll()),x.watch(()=>y.mode,p=>{switch(p){case "add":this.go("adding-attachment");break;case "edit":this.go("editing-attachment")}})],h.exit)}_configureFeatureFormViewModel(){const {edits:u,formTemplate:L,viewModel:{featureFormViewModel:K,view:F}}=this.data;K.set({arcadeEditType:"UPDATE",feature:this.fullFeature,formTemplate:L,
highlightHelper:this._highlightHelper,map:F?.map,spatialReference:F.spatialReference});const {initialFeature:y}=u;y&&K.overrideInitialFeature(y);this.addHandles(K.on("value-change",()=>{u.updateAttributes(K.getValues());this.fullFeature.attributes=u.feature.attributes}),h.exit)}_onFullFeatureLoaded(u){this.fullFeature=u;const {edits:L}=this.data;L.updateAttributes(u.attributes);L.trackChanges()}static async create(u){u=new t({data:await q.create(u),onCommit:this._onCommitFactory(u.applyEdits)});u._set("steps",
this._createWorkflowSteps(u));return u}static _createWorkflowSteps(u){const {attachmentsViewModel:L}=u.data.viewModel;return[{id:"editing-attributes",async setUp(){},async tearDown(){}},{id:"adding-attachment",async setUp(){},async tearDown(){L.mode="view"}},{id:"editing-attachment",async setUp(){},async tearDown(){L.mode="view"}}]}};a.UpdateRecordWorkflow._onCommitFactory=u=>async L=>{({edits:L}=L);const {feature:K}=L;if(K){var F=K.sourceLayer,y=K.clone();if(!L.attributesModified||L.stagedForDelete){var p=
F.objectIdField;y.attributes={[p]:K.getAttribute(p)};f.sceneLayerEditingEnabled()&&f.i3sPatchingEnabled()&&"scene"===F.type&&null!=F.infoFor3D&&(p=F.associatedLayer?.globalIdField,null!=p&&y.setAttribute(p,K.getAttribute(p)))}if(!L.geometryModified||L.stagedForDelete)y.geometry=null;await u(F,{[L.stagedForDelete?"deleteFeatures":"updateFeatures"]:[y]})}};b.__decorate([n.property()],a.UpdateRecordWorkflow.prototype,"editableItem",null);b.__decorate([n.property()],a.UpdateRecordWorkflow.prototype,"fullFeature",
void 0);b.__decorate([n.property()],a.UpdateRecordWorkflow.prototype,"hasPendingEdits",null);b.__decorate([n.property()],a.UpdateRecordWorkflow.prototype,"parent",null);b.__decorate([n.property()],a.UpdateRecordWorkflow.prototype,"shouldShowAttachments",null);b.__decorate([n.property()],a.UpdateRecordWorkflow.prototype,"shouldAllowAttachmentEditing",null);b.__decorate([n.property()],a.UpdateRecordWorkflow.prototype,"reliesOnOwnerAdminPrivileges",null);a.UpdateRecordWorkflow=t=b.__decorate([w.subclass("esri.widgets.Editor.UpdateRecordWorkflow")],
a.UpdateRecordWorkflow);a.handleKeys=h;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/UpdateWorkflowData":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),function(a,b,d,m,g,x,n){b=class extends b{constructor(B){super(B);this.viewModel=this.rootFeature=this.candidates=
this.applyEditsCallback=this.addAttachmentsCallback=null}};a.__decorate([d.property()],b.prototype,"addAttachmentsCallback",void 0);a.__decorate([d.property()],b.prototype,"applyEditsCallback",void 0);a.__decorate([d.property()],b.prototype,"candidates",void 0);a.__decorate([d.property()],b.prototype,"rootFeature",void 0);a.__decorate([d.property()],b.prototype,"viewModel",void 0);return b=a.__decorate([n.subclass("esri.widgets.Editor.UpdateWorkflowData")],b)})},"esri/widgets/Sketch/SketchViewModel":function(){define("require ../../chunks/tslib.es6 ../../symbols ../../core/Collection ../../core/Error ../../core/Evented ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../geometry/ellipsoidUtils ../../geometry/projection ../../geometry/support/coordsUtils ../../geometry/support/spatialReferenceUtils ../../layers/GraphicsLayer ../../views/3d/interactive/editingTools/isSupportedGraphicUtils ../../views/3d/interactive/editingTools/moveGraphic/isSupportedGraphic ../../views/3d/interactive/editingTools/reshapeGraphic/isSupportedGraphic ../../views/3d/interactive/editingTools/transformGraphic/isSupportedGraphic ../../views/draw/support/layerUtils ../../views/input/InputManager ../../views/interactive/keybindings ../../views/interactive/sketch/SketchLabelOptions ../../views/interactive/sketch/SketchTooltipOptions ../../views/interactive/snapping/SnappingManager ../../views/interactive/snapping/SnappingOptions ../../views/interactive/snapping/snappingUtils ../../views/support/hitTestSelectUtils ../../views/support/screenUtils ./support/OperationHandle ../../symbols/SimpleMarkerSymbol ../../symbols/SimpleFillSymbol ../../symbols/SimpleLineSymbol ../../symbols/MeshSymbol3D ../../symbols/FillSymbol3DLayer".split(" "),
function(a,b,d,m,g,x,n,B,M,k,w,e,f,l,q,r,c,t,h,u,L,K,F,y,p,I,R,D,E,N,C,P,H,J,z,A,v,G,O,U){function ca(Q){return"polygon"===Q||"rectangle"===Q||"circle"===Q}function X(Q,W){ha("undo",Q.history.undo,Q.history.redo,W)}function da(Q,W){ha("redo",Q.history.redo,Q.history.undo,W)}function ha(Q,W,Z,aa){if(W=W.pop()){var fa=W.updates,ka=[];aa.forEach((la,ja)=>{ja=fa[ja];null!=ja&&("geometry"in ja&&null!=ja.geometry&&(ka.push({geometry:la.geometry}),la.geometry=ja.geometry),"symbol"in ja&&null!=ja.symbol&&
(ka.push({symbol:la.symbol}),la.symbol=ja.symbol),"undo"in ja&&(ka.push(ja),ja[Q](la)))});Z.push({updates:ka})}}function ia(Q){return{updates:Q.map(W=>({geometry:W.geometry}))}}function ma(Q){return"requireError"in Q&&"aborted"===Q.requireError}const ea=Q=>Object.freeze(Object.defineProperty({__proto__:null,default:Q},Symbol.toStringTag,{value:"Module"})),S={defaultZ:0},T={reshapeOptions:{edgeOperation:"split",shapeOperation:"move",vertexOperation:"move"},enableMoveAllGraphics:!0,enableRotation:!0,
enableScaling:!0,multipleSelectionEnabled:!0,preserveAspectRatio:!1,toggleToolOnClick:!0,enableZ:!0,highlightOptions:{enabled:!0},tool:"transform"};x=class extends x.EventedAccessor{constructor(Q){super(Q);this._numUpdating=0;this._internalGraphicsLayer=new u({listMode:"hide",internal:!0,title:"SVM Internal"});this._operationHandle=null;this._viewHandlesKey="viewHandles";this.activeVertexSymbol=this.activeLineSymbol=this.activeFillSymbol=null;this.allowDeleteKey=!0;this.labelOptions=new D;this.layer=
null;this.pointSymbol=new A({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}});this.polygonSymbol=new v({color:[150,150,150,.2],outline:{color:[50,50,50],width:2}});this.polylineSymbol=new G({color:[130,130,130,1],width:2});this.meshSymbol=new O({symbolLayers:new m([new U])});this._snappingManager=null;this.tooltipOptions=new E;this.updateGraphics=new m;this.updateOnGraphicClick=!0;this.vertexSymbol=new A({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,
50],width:1}});this._originalPopupEnabled=this._viewReadyAbortController=this._moduleLoaderAbortController=null;this.defaultCreateOptions=S;this.defaultUpdateOptions=T;this.snappingOptions=new C}initialize(){this.addHandles([k.on(()=>this.view?.map?.layers,"change",Q=>{Q.removed.includes(this.layer)&&this.cancel()}),k.on(()=>this.layer?.graphics,"change",Q=>{if(null!=this._operationHandle)for(const W of Q.removed)this.updateGraphics.includes(W)&&(1<this.updateGraphics.length?this._operationHandle.removeFromSelection(W):
this._operationHandle.cancel())}),k.watch(()=>this.layer?.elevationInfo??null,Q=>{Q!==this._internalGraphicsLayer.elevationInfo&&(this.cancel(),this._internalGraphicsLayer.elevationInfo=Q)},k.syncAndInitial),k.watch(()=>this.view,Q=>{B.destroyMaybe(this._snappingManager);Q&&(this._snappingManager=new N.SnappingManager({view:Q,options:this.snappingOptions}),"2d"===Q.type?new Promise((W,Z)=>a(["../../views/2d/interactive/editingTools"],W,Z)):"3d"===Q.type&&(new Promise((W,Z)=>a(["../../views/3d/interactive/editingTools"],
W,Z)),new Promise((W,Z)=>a(["../../views/3d/layers/GraphicsLayerView3D"],aa=>W(ea(aa)),Z))))},k.syncAndInitial),k.watch(()=>this.view?.spatialReference,(Q,W)=>{Q&&W&&!Q.equals(W)&&this.cancel()})]);P.setupSnappingToggleHandles(this)}destroy(){this.cancel();this._removeDefaultLayer();this._snappingManager=B.destroyMaybe(this._snappingManager);this._set("view",null);this.emit("destroy")}get _defaultUpdateTool(){return"3d"===this.view?.type?"move":"transform"}get updating(){return 0<this._numUpdating||
null!=this._snappingManager&&this._snappingManager.updating}get activeTool(){return this._operationHandle?.tool??null}get activeComponent(){return this._operationHandle?.activeComponent??null}get createGraphic(){return null==this.activeComponent||"draw-3d"!==this.activeComponent.type&&"draw-2d"!==this.activeComponent.type?this._get("createGraphic"):this.activeComponent.graphic}get defaultCreateOptions(){return this._get("defaultCreateOptions")}set defaultCreateOptions(Q){this._set("defaultCreateOptions",
{...S,...Q})}get defaultUpdateOptions(){return this._get("defaultUpdateOptions")}set defaultUpdateOptions(Q){this._set("defaultUpdateOptions",{...T,...Q,reshapeOptions:{...T.reshapeOptions,...Q?.reshapeOptions},highlightOptions:{...T.highlightOptions,...Q?.highlightOptions}})}set snappingOptions(Q){null!=this._snappingManager&&(this._snappingManager.options=Q);this._set("snappingOptions",Q)}get state(){const Q=!(!this.view?.ready||!this.layer),W=this._operationHandle;return Q&&W?"active":Q?"ready":
"disabled"}get view(){return this._get("view")}set view(Q){const W=this._get("view");if(W){const {container:Z,map:aa}=W;Z&&(W.cursor=null);aa?.remove(this._internalGraphicsLayer);this.removeHandles(this._viewHandlesKey);this.cancel()}this.removeHandles("view-ready");Q&&this.addHandles(k.when(()=>Q.ready,Z=>{this.removeHandles(this._viewHandlesKey);Z&&this.addHandles(this._generateViewHandles(Q),this._viewHandlesKey)},k.syncAndInitial),"view-ready");this._set("view",Q)}cancel(){this._moduleLoaderAbortController=
B.abortMaybe(this._moduleLoaderAbortController);this._viewReadyAbortController=B.abortMaybe(this._viewReadyAbortController);this._operationHandle&&this._operationHandle.cancel()}complete(){this._operationHandle&&this._operationHandle.complete()}delete(){const {state:Q,updateGraphics:W}=this;if("active"===Q&&W.length){const {activeTool:Z,layer:aa}=this,fa=W.toArray();aa.removeMany(fa);this.cancel();this._emitDeleteEvent({graphics:fa,tool:Z})}}duplicate(){if("active"===this.state&&this.updateGraphics.length){const Q=
this.updateGraphics.map(W=>W.clone()).toArray();this.layer.addMany(Q);this.emit("duplicate",{graphics:Q,type:"duplicate"});return Q}return[]}async create(Q,W){this.cancel();await this._waitViewReady();const {view:Z,layer:aa}=this;if(!Z||"disabled"===this.state)throw aa||this._logMissingLayer(),M.createAbortError();null!=Z.activeTool&&(Z.activeTool=null);if(Q){p.addUniqueLayer(Z,this._internalGraphicsLayer);var fa=await this._setupCreateOperation(Q,W);null==fa||this.destroyed?Z.map.remove(this._internalGraphicsLayer):
(fa.on("complete",()=>{if(fa===this._operationHandle){const ka=this.createGraphic,la=this._operationHandle.cancelled;this._operationHandle.destroy();this._operationHandle=null;this._set("createGraphic",null);this.view?.map&&this.view.map.remove(this._internalGraphicsLayer);fa.cancelled||null==ka||aa.add(ka);this.emit("create",{graphic:ka,state:la?"cancel":"complete",tool:Q,toolEventInfo:null,type:"create"})}}),this._operationHandle=fa,Z.ready&&Z.focus())}else this._logError("sketch:missing-parameter",
"Missing parameter 'tool'.")}async update(Q,W){this.cancel();await this._waitViewReady();const {layer:Z,view:aa,state:fa}=this;if(!aa||"disabled"===fa)throw Z||this._logMissingLayer(),M.createAbortError();null!=aa.activeTool&&(aa.activeTool=null);const ka=Array.isArray(Q)?Q:[Q];null!=Q&&ka?.length?ka.some(la=>la.layer!==Z?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics missing from the supplied GraphicsLayer."),!0):null==la.geometry?(this._logError("sketch:invalid-parameter",
"Parameter 'graphics' contains one or more graphics with an unsupported geometry."),!0):!1)||(Q=await this._setupUpdateOperation(ka,W),this.destroyed||null==Q||ma(Q)||(p.addUniqueLayer(aa,this._internalGraphicsLayer),this._setUpdateOperationHandle(Q,W),this.emit("update",{graphics:ka,state:"start",aborted:!1,tool:Q.tool,toolEventInfo:null,type:"update"}))):this._logError("sketch:missing-parameter","Missing parameter 'graphics'.")}async _updateSpatialReference(Q){const W=this.view;if(W){this._beginAsyncOperation();
Q=Array.isArray(Q)?Q:[Q];for(const Z of Q)null==Z.geometry||"mesh"===Z.geometry.type||h.equals(Z.geometry.spatialReference,W.spatialReference)||(c.canProjectWithoutEngine(Z.geometry.spatialReference,W.spatialReference)||c.isLoaded()||await c.load(),Z.geometry=c.project(Z.geometry,W.spatialReference));this._endAsyncOperation()}else this._logMissingView()}undo(){this.canUndo()&&this._operationHandle?.undo()}redo(){this.canRedo()&&this._operationHandle?.redo()}canUndo(){return!(!this._operationHandle||
!this._operationHandle.canUndo())}canRedo(){return!(!this._operationHandle||!this._operationHandle.canRedo())}toggleUpdateTool(){this._operationHandle&&this._operationHandle.toggleTool&&this._operationHandle.toggleTool()}async _getFirstHit(Q){var W=this.view;if(!W)return this._logMissingView(),null;if("2d"===W.type){const aa=[];W.map.allLayers.forEach(fa=>{"vector-tile"!==fa.type&&"imagery"!==fa.type||aa.push(fa)});W=await W.hitTest(Q,{exclude:aa});return H.findFirstGraphicHit(W.results)}const Z=
[W.map.ground];W.map.allLayers.forEach(aa=>{"integrated-mesh"===aa.type&&Z.push(aa)});Q=await W.hitTest(Q,{exclude:Z});if(0<Q.results.length){const aa=Q.results[0];if(null!=aa&&"graphic"===aa.type&&aa.graphic&&(!Q.ground.mapPoint||1>W.map.ground.opacity||Q.ground.distance-(aa.distance??0)>-Math.min(3*Q.ground.distance,"global"===W.viewingMode?r.getReferenceEllipsoid(W.renderCoordsHelper.spatialReference).radius/W.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY)))return aa}return null}_generateViewHandles(Q){return[Q.on("immediate-click",
async W=>{var Z="active"===this.state&&"create"===this._operationHandle?.type;if("disabled"!==this.state&&!Z&&this.updateOnGraphicClick){this._beginAsyncOperation();var aa=await W.async(()=>this._getFirstHit(J.createScreenPointFromEvent(W)));Z=null;null!=aa?(aa=aa.graphic,this.updateGraphics.includes(aa)||aa.layer===this.layer?(W.stopPropagation(),Z=aa):"2d"!==Q.type||this._isComponentGraphic(aa)||"active"!==this.state||this.cancel()):"active"===this.state&&this.cancel();null==Z||this.updateGraphics.includes(Z)||
await this.update([Z],{...this.defaultUpdateOptions,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions}});this._endAsyncOperation()}},I.ViewEventPriorities.WIDGET)]}async _setupCreateOperation(Q,W){const Z=this.view;if(!Z)return this._logMissingView(),null;Q=await this._setupDrawGraphicTool(Q,Z,{hasZ:"3d"===Z.type,...this.defaultCreateOptions,...W});if(null==Q)return null;Z.tools.add(Q);Z.activeTool=Q;return this._setupCreateOperationHandle(Q)}async _setupDrawGraphicTool(Q,W,Z){if("multipoint"===
Q&&"3d"===W.type)return this._logError("sketch:create","Multipoint geometries are not supported in SceneView."),null;if(!W)return this._logMissingView(),null;const aa="rectangle"!==Q,fa="rectangle"!==Q;Q={view:W,mode:"rectangle"===Q||"circle"===Q?"hybrid":"click",...Z,snapToScene:!1,geometryType:Q,graphicSymbol:this._getGraphicSymbolFromTool(Q),snappingManager:this._snappingManager,forceUniformSize:fa,centered:aa};return"2d"===W.type?this._makeDrawGraphicTool2D(Q):this._makeDrawGraphicTool3D(Q)}async _makeDrawGraphicTool2D(Q){const W=
await this._requireModule(new Promise((Z,aa)=>a(["../../views/2d/interactive/editingTools"],Z,aa)));return ma(W)||this.destroyed?null:new W.module.DrawGraphicTool2D({...Q,activeVertexSymbol:this.activeVertexSymbol,regularVerticesSymbol:this.vertexSymbol,activeLineSymbol:this.activeLineSymbol,activeFillSymbol:ca(Q.geometryType)?this.activeFillSymbol:null,tooltipOptions:this.tooltipOptions})}async _makeDrawGraphicTool3D(Q){const W=await this._requireModule(new Promise((aa,fa)=>a(["../../views/3d/interactive/editingTools"],
aa,fa)));if(ma(W)||this.destroyed)return null;const {elevationInfo:Z}=this.layer;return new W.module.DrawGraphicTool3D({...Q,elevationInfo:Z,snapToScene:null!=Z?"absolute-height"===Z.mode:!0,labelOptions:this.labelOptions,tooltipOptions:this.tooltipOptions})}_setupCreateOperationHandle(Q){const W=this.view;if(!W)return this._logMissingView(),null;let Z=null;const aa=Q.forceUniformSize,fa=Q.centered,ka=[W.on("key-down",ja=>{if(ja.key===R.sketchKeys.pan)ja.stopPropagation(),ja.repeat||(Q.enabled=!1);
else if(ja.key===R.sketchKeys.complete)ja.stopPropagation(),Q.completeCreateOperation();else if(ja.key!==R.sketchKeys.vertexAdd||ja.repeat)ja.key===R.sketchKeys.undo?(ja.stopPropagation(),la.undo()):ja.key===R.sketchKeys.redo?(ja.stopPropagation(),la.redo()):ja.key!==R.sketchKeys.constraint||"rectangle"!==Q.geometryType&&"circle"!==Q.geometryType||ja.repeat?ja.key!==R.sketchKeys.center||ja.repeat||(Q.centered=!fa,ja.stopPropagation()):(Q.forceUniformSize=!aa,ja.stopPropagation());else{const V=Q.drawOperation.geometryType;
if("polyline"===V||"polygon"===V||"multipoint"===V)ja.stopPropagation(),Q.drawOperation.commitStagedVertex()}},I.ViewEventPriorities.WIDGET),W.on("key-up",ja=>{ja.key===R.sketchKeys.pan?Q.enabled=!0:ja.key!==R.sketchKeys.constraint||"rectangle"!==Q.geometryType&&"circle"!==Q.geometryType?ja.key===R.sketchKeys.center&&(Q.centered=fa,ja.stopPropagation()):(Q.forceUniformSize=aa,ja.stopPropagation())},I.ViewEventPriorities.WIDGET),Q.on("vertex-add",ja=>{Z=null==Z?"start":"active";switch(ja.operation){case "apply":this.emit("create",
{graphic:Q.graphic,state:Z,tool:this.activeTool,toolEventInfo:ja,type:"create"});break;case "undo":this._emitUndoEvent({graphics:[Q.graphic],tool:Q.geometryType});break;case "redo":this._emitRedoEvent({graphics:[Q.graphic],tool:Q.geometryType})}}),Q.on("cursor-update",ja=>{0<Q.drawOperation.numCommittedVertices&&this.emit("create",{graphic:Q.graphic,state:"active",tool:this.activeTool,toolEventInfo:{coordinates:ja.vertices[0].coordinates,type:"cursor-update"},type:"create"})}),Q.on("vertex-remove",
ja=>{switch(ja.operation){case "apply":this.emit("create",{graphic:Q.graphic,state:"active",tool:this.activeTool,toolEventInfo:ja,type:"create"});break;case "undo":this._emitUndoEvent({graphics:[Q.graphic],tool:Q.geometryType});break;case "redo":this._emitRedoEvent({graphics:[Q.graphic],tool:Q.geometryType})}}),Q.on("complete",ja=>{this._set("createGraphic",ja.graphic);Z="complete";ja.aborted?la&&la.cancel():la&&la.complete()}),k.watch(()=>this._getGraphicSymbolFromTool(Q.geometryType),ja=>{Q.graphicSymbol=
ja})],la=new z.CreateOperationHandle({activeComponent:Q,tool:Q.geometryType,type:"create",onEnd:()=>{ka.forEach(ja=>ja.remove());ka.length=0;W.tools?.remove(Q)},undo:()=>{Q.canUndo&&Q.undo()},redo:()=>{Q.canRedo&&Q.redo()},canUndo:()=>Q.canUndo,canRedo:()=>Q.canRedo});return la}_getGraphicSymbolFromTool(Q){switch(Q){case "point":case "multipoint":return this.pointSymbol;case "polyline":return this.polylineSymbol;case "circle":case "rectangle":case "polygon":return this.polygonSymbol;case "mesh":return this.meshSymbol}}async _setupUpdateOperation(Q,
W){const {layer:Z,view:aa}=this;if(!aa)return this._logMissingView(),null;W={tool:this._defaultUpdateTool,...this.defaultUpdateOptions,...W,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions,...W?.reshapeOptions},highlightOptions:{...this.defaultUpdateOptions.highlightOptions,...W?.highlightOptions}};var fa=W.tool;for(var ka of Q)Z.remove(ka),Z.add(ka);if("3d"===aa.type){if(0===Q.length)return null;switch(fa){case "move":return this._setupMove3DOperation(Q,W,aa,fa);case "reshape":if(1<Q.length)return this._logError("sketch:reshape-multiple",
"Reshape operation does not support multiple graphics."),null;fa=F.isSupportedGraphic(Q[0]);if(fa===L.SupportedGraphicResult.SUPPORTED)return this._setupReshape3DOperation(Q[0],W,aa);this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${L.isSupportedGraphicResultMessage(fa)}).`);return null;case "transform":return this._setupGraphicTransform3DOperation(Q,W,aa)}}switch(fa){case "move":return this._setupMove2DOperation(Q,W,aa);case "reshape":if(1<Q.length)return this._logError("sketch:reshape-multiple",
"Reshape operation does not support multiple graphics."),null;ka=F.isSupportedGraphic(Q[0]);if(ka===L.SupportedGraphicResult.SUPPORTED)return this._setupTransformOrReshape2DOperation(Q,fa,W,aa);this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${L.isSupportedGraphicResultMessage(ka)}).`);return null;case "transform":return 1===Q.length&&(ka=Q[0].geometry?.type,"point"===ka||"multipoint"===ka)&&(fa="reshape"),this._setupTransformOrReshape2DOperation(Q,fa,W,aa)}}async _setupMove3DOperation(Q,
W,Z,aa,fa=!1){for(var ka of Q){const Y=K.isSupportedGraphic(ka);if(Y!==L.SupportedGraphicResult.SUPPORTED)return this._logError("sketch:move",`Move operation not supported for provided graphic(s) (${L.isSupportedGraphicResultMessage(Y)}).`),null}ka=await this._requireModule(new Promise((Y,na)=>a(["../../views/3d/interactive/editingTools"],Y,na)));if(ma(ka))return ka;const la=new ka.module.GraphicMoveTool({view:Z,enableZ:W.enableZ,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions});
Z.tools.add(la);la.graphics.addMany(Q);fa||this.updateGraphics.addMany(Q);const ja=[],V=new z.UpdateOperationHandle({activeComponent:la,tool:aa,type:"update",onEnd:()=>{ja.forEach(Y=>Y.remove());ja.length=0;Z.tools?.remove(la);la.destroyed||la.destroy()},undo:()=>{X(V,this.updateGraphics.toArray());this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:aa})},redo:()=>{da(V,this.updateGraphics.toArray());this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:aa})},addToSelection:Y=>
{this.updateGraphics.push(Y);la.graphics.push(Y);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[Y],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:Y=>{const na=this.updateGraphics.indexOf(Y);V.history.undo.forEach(oa=>oa.updates.splice(na,1));V.history.redo.forEach(oa=>oa.updates.splice(na,1));this.updateGraphics.remove(Y);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",
aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[Y],type:"selection-change"},type:"update"});0===this.updateGraphics.length?V.complete():la.graphics.remove(Y)},toggleTool:async()=>{if(1===this.updateGraphics.length&&!1!==W.toggleToolOnClick&&"transform"===aa){var Y=this.updateGraphics.at(0);F.isSupportedGraphic(Y)===L.SupportedGraphicResult.SUPPORTED&&(V.onEnd(),V.destroy(),Y=await this._setupReshape3DOperation(Y,W,Z,!0),ma(Y)||this._setUpdateOperationHandle(Y,W))}}});ja.push(...this._getHandlesForComponent(V,
W),Z.on("immediate-click",Y=>this._getCommonUpdateOperationClickHandlers(V,Y,W),I.ViewEventPriorities.WIDGET),Z.on("key-down",Y=>{this._getCommonUpdateOperationKeyDownHandlers(V,Y)},I.ViewEventPriorities.WIDGET));return V}_setupGraphicTransform3DOperation(Q,W,Z,aa=!1){if(1===Q.length&&y.isSupportedGraphic(Q[0])===L.SupportedGraphicResult.SUPPORTED){const fa=Q[0],ka=fa.geometry;if(null!=ka&&("point"===ka.type||"mesh"===ka.type))return this._setupPointTransform3DOperation(fa,W,Z);if(null!=ka&&("polygon"===
ka.type||"polyline"===ka.type))return this._setupPolyTransform3DOperation(fa,W,Z,aa)}return this._setupMove3DOperation(Q,W,Z,"transform",aa)}async _setupPointTransform3DOperation(Q,W,Z){const {enableRotation:aa,enableScaling:fa,enableZ:ka}=W,la=await this._requireModule(new Promise((na,oa)=>a(["../../views/3d/interactive/editingTools"],na,oa)));if(ma(la))return la;const ja=new la.module.GraphicTransformTool({graphic:Q,view:Z,enableRotation:aa,enableScaling:fa,enableZ:ka,snappingManager:this._snappingManager,
tooltipOptions:this.tooltipOptions});Z.tools.add(ja);this.updateGraphics.add(Q);const V=[],Y=new z.UpdateOperationHandle({activeComponent:ja,tool:"transform",type:"update",onEnd:()=>{V.forEach(na=>na.remove());V.length=0;Z.tools?.remove(ja);ja.destroyed||ja.destroy()},undo:()=>{X(Y,this.updateGraphics.toArray());this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},redo:()=>{da(Y,this.updateGraphics.toArray());this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},
addToSelection:async na=>{this.updateGraphics.add(na);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[na],removed:[],type:"selection-change"},type:"update"});Y.onEnd();Y.destroy();na=await this._setupMove3DOperation(this.updateGraphics.toArray(),W,Z,"transform",!0);ma(na)||this._setUpdateOperationHandle(na,W)},removeFromSelection:na=>{this.updateGraphics.remove(na);this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[na],type:"selection-change"},type:"update"});Y.complete()},toggleTool:()=>{}});V.push(...this._getHandlesForComponent(Y,W),Z.on("immediate-click",na=>this._getCommonUpdateOperationClickHandlers(Y,na,W),I.ViewEventPriorities.WIDGET),Z.on("key-down",na=>{this._getCommonUpdateOperationKeyDownHandlers(Y,na)},I.ViewEventPriorities.WIDGET));return Y}async _setupPolyTransform3DOperation(Q,W,Z,aa=!1){const {enableRotation:fa,
enableScaling:ka,enableZ:la,preserveAspectRatio:ja}=W,V=await this._requireModule(new Promise((pa,qa)=>a(["../../views/3d/interactive/editingTools"],pa,qa)));if(ma(V))return V;const Y=new V.module.ExtentTransformTool({graphic:Q,view:Z,enableRotation:fa,enableScaling:ka,enableZ:la,preserveAspectRatio:ja,tooltipOptions:this.tooltipOptions});Z.tools.add(Y);aa||this.updateGraphics.add(Q);const na=[],oa=new z.UpdateOperationHandle({activeComponent:Y,tool:"transform",type:"update",onEnd:()=>{na.forEach(pa=>
pa.remove());na.length=0;Z.tools?.remove(Y);Y.destroyed||Y.destroy()},canUndo:()=>Y.canUndo,undo:()=>{Y.undo();this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},canRedo:()=>Y.canRedo,redo:()=>{Y.redo();this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},addToSelection:async pa=>{this.updateGraphics.add(pa);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[pa],removed:[],
type:"selection-change"},type:"update"});oa.onEnd();oa.destroy();pa=await this._setupMove3DOperation(this.updateGraphics.toArray(),W,Z,"transform",!0);ma(pa)||this._setUpdateOperationHandle(pa,W)},removeFromSelection:pa=>{this.updateGraphics.remove(pa);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[pa],type:"selection-change"},type:"update"});oa.complete()},toggleTool:async()=>{if(1===this.updateGraphics.length&&
!1!==W.toggleToolOnClick){var pa=this.updateGraphics.at(0);F.isSupportedGraphic(pa)===L.SupportedGraphicResult.SUPPORTED&&(oa.onEnd(),oa.destroy(),pa=await this._setupReshape3DOperation(pa,W,Z,!0),ma(pa)||this._setUpdateOperationHandle(pa,W))}}});na.push(...this._getHandlesForComponent(oa,W),Z.on("immediate-click",pa=>this._getCommonUpdateOperationClickHandlers(oa,pa,W),I.ViewEventPriorities.WIDGET),Z.on("key-down",pa=>this._getCommonUpdateOperationKeyDownHandlers(oa,pa),I.ViewEventPriorities.WIDGET),
Z.on("key-down",pa=>{pa.key!==R.sketchKeys.constraint||pa.repeat||(Y.preserveAspectRatio=!Y.preserveAspectRatio,pa.stopPropagation())},I.ViewEventPriorities.WIDGET),Z.on("key-up",pa=>{pa.key===R.sketchKeys.constraint&&(Y.preserveAspectRatio=!Y.preserveAspectRatio,pa.stopPropagation())},I.ViewEventPriorities.WIDGET));return oa}async _setupMove2DOperation(Q,W,Z){this.updateGraphics.addMany(Q);await this._updateSpatialReference(Q);const aa=await this._getGraphicMover(Q,W,Z);if(ma(aa))return aa;const fa=
new z.UpdateOperationHandle({activeComponent:aa,tool:"move",type:"update",onEnd:()=>{this._displayDefaultCursor();ja.forEach(V=>V.remove());la.forEach(V=>V.remove());ja=[];la=[];aa.destroy();this._internalGraphicsLayer?.removeMany([...this.updateGraphics.toArray()])},undo:()=>{const V=this.updateGraphics.toArray();X(fa,V);fa.refreshComponent();this._emitUndoEvent({graphics:V,tool:"move"})},redo:()=>{const V=this.updateGraphics.toArray();da(fa,V);fa.refreshComponent();this._emitRedoEvent({graphics:V,
tool:"move"})},addToSelection:async V=>{await this._updateSpatialReference(V);this.updateGraphics.push(V);aa.graphics=this.updateGraphics.toArray();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[V],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:V=>{const Y=this.updateGraphics.indexOf(V);fa.history.undo.forEach(oa=>oa.updates.splice(Y,1));fa.history.redo.forEach(oa=>oa.updates.splice(Y,1));this.updateGraphics.remove(V);
const na=this.updateGraphics.toArray();this.emit("update",{graphics:na,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[V],type:"selection-change"},type:"update"});0===this.updateGraphics.length?fa.complete():aa.graphics=na}});let ka=!1,la=[Z.on("immediate-click",V=>this._getCommonUpdateOperationClickHandlers(fa,V,W),I.ViewEventPriorities.WIDGET),Z.on("key-down",V=>{this._getCommonUpdateOperationKeyDownHandlers(fa,V);V.key!==R.sketchKeys.constraint||V.repeat||(ka=!0,
aa.enableMoveAllGraphics=!aa.enableMoveAllGraphics)},I.ViewEventPriorities.WIDGET),Z.on("key-up",V=>{V.key===R.sketchKeys.constraint&&ka&&(ka=!1,aa.enableMoveAllGraphics=!aa.enableMoveAllGraphics)},I.ViewEventPriorities.WIDGET)],ja=this._getHandlesForComponent(fa,W);return fa}async _setupReshape3DOperation(Q,W,Z,aa=!1){const fa=await this._requireModule(new Promise((Y,na)=>a(["../../views/3d/interactive/editingTools"],Y,na)));if(ma(fa))return fa;const ka=W.reshapeOptions,la=new fa.module.GraphicReshapeTool({view:Z,
graphic:Q,enableZVertex:W.enableZ&&"move"===ka?.vertexOperation,enableZShape:W.enableZ&&"move"===ka?.shapeOperation,enableMoveGraphic:"move"===ka?.shapeOperation||"move-xy"===ka?.shapeOperation,enableMidpoints:"split"===ka?.edgeOperation,enableEdgeOffset:"offset"===ka?.edgeOperation,snappingManager:this._snappingManager,labelOptions:this.labelOptions,tooltipOptions:this.tooltipOptions});Z.tools.add(la);aa||this.updateGraphics.add(Q);const ja=[],V=new z.UpdateOperationHandle({activeComponent:la,tool:"reshape",
type:"update",onEnd:()=>{ja.forEach(Y=>Y.remove());ja.length=0;Z.tools?.remove(la);la.destroyed||la.destroy()},canUndo:()=>la.canUndo,undo:()=>{la.undo();this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"reshape"})},canRedo:()=>la.canRedo,redo:()=>{la.redo();this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:"reshape"})},addToSelection:async Y=>{this.updateGraphics.add(Y);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,
toolEventInfo:{added:[Y],removed:[],type:"selection-change"},type:"update"});V.onEnd();V.destroy();Y=await this._setupMove3DOperation(this.updateGraphics.toArray(),W,Z,"transform",!0);ma(Y)||this._setUpdateOperationHandle(Y,W)},removeFromSelection:Y=>{this.updateGraphics.remove(Y);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[Y],type:"selection-change"},type:"update"});V.complete()},toggleTool:async()=>{if(!1!==
W.toggleToolOnClick){V.onEnd();V.destroy();var Y=await this._setupGraphicTransform3DOperation(this.updateGraphics.toArray(),W,Z,!0);ma(Y)||this._setUpdateOperationHandle(Y,W)}}});ja.push(...this._getHandlesForComponent(V,W),Z.on("immediate-click",Y=>this._getCommonUpdateOperationClickHandlers(V,Y,W),I.ViewEventPriorities.WIDGET),Z.on("key-down",Y=>{this._getCommonUpdateOperationKeyDownHandlers(V,Y)},I.ViewEventPriorities.WIDGET));return V}async _setupTransformOrReshape2DOperation(Q,W,Z,aa){this.updateGraphics.addMany(Q);
await this._updateSpatialReference(Q);Q="transform"===W?await this._getBox(Q,Z,aa):await this._getReshape(Q,Z,aa);if(ma(Q))return Q;const fa=new z.UpdateOperationHandle({activeComponent:Q,type:"update",onEnd:()=>{la.forEach(ja=>ja.remove());ka.forEach(ja=>ja.remove());la=[];ka=[];fa.activeComponent&&!fa.activeComponent.destroyed&&fa.activeComponent.destroy();this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray())},undo:()=>{X(fa,this.updateGraphics.toArray());fa.refreshComponent();this._emitUndoEvent({graphics:this.updateGraphics.toArray(),
tool:fa.tool})},redo:()=>{da(fa,this.updateGraphics.toArray());fa.refreshComponent();this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:fa.tool})},addToSelection:async ja=>{var V=fa.activeComponent;if("reshape"===V?.type){V=[...this.updateGraphics,ja];this.updateGraphics.removeAll();fa.onEnd();fa.destroy();V=await this._setupMove2DOperation(V,Z,aa);if(ma(V))return;this._setUpdateOperationHandle(V,Z)}else this.updateGraphics.add(ja),V.graphics=this.updateGraphics.toArray(),V.refresh(),
fa.resetHistory();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[ja],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:async ja=>{const V=this.updateGraphics.indexOf(ja);fa.history.undo.forEach(na=>na.updates.splice(V,1));fa.history.redo.forEach(na=>na.updates.splice(V,1));this.updateGraphics.remove(ja);const Y=this.updateGraphics.toArray();if(0===Y.length)fa.complete();else{const na=Y[0].geometry;
1!==Y.length||null==na||"point"!==na.type&&"multipoint"!==na.type?fa.activeComponent.graphics=Y:fa.toggleTool()}this.emit("update",{graphics:Y,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[ja],type:"selection-change"},type:"update"})},toggleTool:async()=>{if(!(1<this.updateGraphics.length)){var ja=this.updateGraphics.at(0),V=ja.geometry;if(null==V||("reshape"!==fa.tool||"point"!==V.type&&"multipoint"!==V.type)&&("transform"!==fa.tool||"extent"!==V.type))V=null,"transform"===
fa.tool?V=await this._getReshape([ja],Z,aa):"reshape"===fa.tool&&(V=await this._getBox([ja],Z,aa)),ma(V)||(fa.activeComponent?.destroy(),fa.activeComponent=V,fa.activeComponent&&(la.forEach(Y=>Y.remove()),la=this._getHandlesForComponent(fa,Z)))}}});let ka=[aa.on("immediate-click",ja=>this._getCommonUpdateOperationClickHandlers(fa,ja,Z),I.ViewEventPriorities.WIDGET),aa.on("key-down",ja=>{this._getCommonUpdateOperationKeyDownHandlers(fa,ja);ja.key===R.sketchKeys.constraint&&!ja.repeat&&fa&&(ja=fa.activeComponent)&&
"box"===ja.type&&(ja.preserveAspectRatio=!ja.preserveAspectRatio)},I.ViewEventPriorities.WIDGET),aa.on("key-up",ja=>{ja.key===R.sketchKeys.constraint&&fa&&(ja=fa.activeComponent)&&"box"===ja.type&&(ja.preserveAspectRatio=!ja.preserveAspectRatio)},I.ViewEventPriorities.WIDGET)],la=this._getHandlesForComponent(fa,Z);return fa}async _getGraphicMover(Q,W,Z){const {enableMoveAllGraphics:aa,highlightOptions:fa}=W;W=await this._requireModule(new Promise((ka,la)=>a(["../../views/draw/support/GraphicMover"],
ja=>ka(ea(ja)),la)));return ma(W)?W:new W.module.default({enableMoveAllGraphics:aa,highlightsEnabled:!!fa?.enabled,indicatorsEnabled:!1,graphics:Q,view:Z,callbacks:{onGraphicMoveStart:({dx:ka,dy:la,graphic:ja})=>{this._displayGrabbingCursor();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ka,dy:la,mover:ja,type:"move-start"},type:"update"})},onGraphicMove:({dx:ka,dy:la,graphic:ja})=>this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ka,dy:la,mover:ja,type:"move"},type:"update"}),onGraphicMoveStop:({dx:ka,dy:la,graphic:ja})=>{this._displayPointerCursor();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ka,dy:la,mover:ja,type:"move-stop"},type:"update"})},onGraphicPointerOver:()=>this._displayPointerCursor(),onGraphicPointerOut:()=>this._displayDefaultCursor()}})}async _getBox(Q,W,Z){const {enableRotation:aa,
enableScaling:fa,highlightOptions:ka,preserveAspectRatio:la}=W;W=await this._requireModule(new Promise((ja,V)=>a(["../../views/draw/support/Box"],Y=>ja(ea(Y)),V)));return ma(W)?W:new W.module.default({graphics:Q,enableRotation:aa,enableScaling:fa,highlightsEnabled:!!ka?.enabled,preserveAspectRatio:la,layer:this._internalGraphicsLayer,view:Z,tooltipOptions:this.tooltipOptions,callbacks:{onMoveStart:ja=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,
toolEventInfo:{...ja},type:"update"}),onMove:ja=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ja},type:"update"}),onMoveStop:ja=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ja},type:"update"}),onScaleStart:ja=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ja},type:"update"}),
onScale:ja=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ja},type:"update"}),onScaleStop:ja=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ja},type:"update"}),onRotateStart:ja=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ja},type:"update"}),onRotate:ja=>this.emit("update",
{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ja},type:"update"}),onRotateStop:ja=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ja},type:"update"})}})}async _getReshape(Q,W,Z){const aa="split"===W.reshapeOptions?.edgeOperation,fa="move"===W.reshapeOptions?.shapeOperation;W=!!W.highlightOptions?.enabled;const ka=await this._requireModule(new Promise((la,ja)=>a(["../../views/draw/support/Reshape"],
V=>la(ea(V)),ja)));return ma(ka)?ka:new ka.module.default({enableMidpoints:aa,enableMovement:fa,graphic:Q[0],highlightsEnabled:W,layer:this._internalGraphicsLayer,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions,view:Z,callbacks:{onReshapeStart:la=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...la},type:"update"}),onReshape:la=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",
aborted:!1,tool:this.activeTool,toolEventInfo:{...la},type:"update"}),onReshapeStop:({mover:la,type:ja})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:la,type:ja},type:"update"}),onMoveStart:({dx:la,dy:ja,mover:V,type:Y})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:la,dy:ja,mover:V,type:Y},type:"update"}),onMove:({dx:la,dy:ja,mover:V,type:Y})=>
this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:la,dy:ja,mover:V,type:Y},type:"update"}),onMoveStop:({dx:la,dy:ja,mover:V,type:Y})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:la,dy:ja,mover:V,type:Y},type:"update"}),onVertexAdd:({added:la,type:ja,vertices:V})=>{la=la.map(Y=>t.geometryToCoordinates(Y.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:la,vertices:V,type:ja},type:"update"})},onVertexRemove:({removed:la,type:ja,vertices:V})=>{la=la.map(Y=>t.geometryToCoordinates(Y.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{removed:la,vertices:V,type:ja},type:"update"})}}})}_getHandlesForComponent(Q,W){const Z=Q.activeComponent;if(!Z)return[];switch(Z.type){case "graphic-mover":return[Z.on("graphic-click",
({graphic:aa,viewEvent:fa})=>{fa.native?.shiftKey&&(fa.stopPropagation(),Q.removeFromSelection(aa))}),Z.on("graphic-move-start",aa=>Q.addToHistory(ia(aa.allGraphics)))];case "box":return[Z.on("graphic-click",aa=>this._onTransformOrReshape2DGraphicClick(Q,W,aa)),Z.on("move-start",aa=>Q.addToHistory(ia(aa.graphics))),Z.on("rotate-start",aa=>Q.addToHistory(ia(aa.graphics))),Z.on("scale-start",aa=>Q.addToHistory(ia(aa.graphics)))];case "reshape":return[Z.on("graphic-click",aa=>this._onTransformOrReshape2DGraphicClick(Q,
W,aa)),Z.on("move-start",aa=>Q.addToHistory(ia([aa.mover]))),Z.on("reshape-start",aa=>Q.addToHistory(ia([aa.graphic]))),Z.on("vertex-add",aa=>Q.addToHistory(ia([aa.oldGraphic]))),Z.on("vertex-remove",aa=>Q.addToHistory(ia([aa.oldGraphic])))];case "move-3d":return[Z.on("graphic-move-start",aa=>{Q.addToHistory(ia(aa.allGraphics));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:0<aa.allGraphics.length?aa.allGraphics[0]:
null,type:"move-start"},type:"update"})}),Z.on("graphic-move",aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:aa.dx,dy:aa.dy,mover:0<aa.allGraphics.length?aa.allGraphics[0]:null,type:"move"},type:"update"})}),Z.on("graphic-move-stop",aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:0<aa.allGraphics.length?aa.allGraphics[0]:null,
type:"move-stop"},type:"update"})}),Z.on("immediate-click",aa=>{aa.shiftKey?this._toggleSelection([aa.graphic],Q,W):Q.toggleTool()})];case "transform-3d":return[Z.on("record-undo",({record:aa})=>{Q.addToHistory({updates:[aa]})}),Z.on("graphic-translate-start",aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:aa.graphic,dx:aa.dxScreen,dy:aa.dyScreen,type:"move-start"},type:"update"})}),Z.on("graphic-translate-stop",aa=>
{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:aa.graphic,dx:aa.dxScreen,dy:aa.dyScreen,type:"move-stop"},type:"update"})}),Z.on("graphic-rotate-start",aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:aa.graphic,angle:aa.angle,type:"rotate-start"},type:"update"})}),Z.on("graphic-rotate-stop",aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:aa.graphic,angle:aa.angle,type:"rotate-stop"},type:"update"})}),Z.on("graphic-scale-start",aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:aa.graphic,xScale:aa.xScale,yScale:aa.yScale,type:"scale-start"},type:"update"})}),Z.on("graphic-scale-stop",aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,
toolEventInfo:{mover:aa.graphic,xScale:aa.xScale,yScale:aa.yScale,type:"scale-stop"},type:"update"})}),Z.on("graphic-translate",aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:aa.graphic,dx:aa.dxScreen,dy:aa.dyScreen,type:"move"},type:"update"})}),Z.on("graphic-rotate",aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:aa.graphic,angle:aa.angle,
type:"rotate"},type:"update"})}),Z.on("graphic-scale",aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:aa.graphic,xScale:aa.xScale,yScale:aa.yScale,type:"scale"},type:"update"})}),Z.on("immediate-click",aa=>{aa.shiftKey?this._toggleSelection([aa.graphic],Q,W):Q.toggleTool()})];case "reshape-3d":return[Z.on("reshape",aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,
toolEventInfo:aa,type:"update"})}),Z.on("move",aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:aa,type:"update"})}),Z.on("vertex-add",aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:aa,type:"update"})}),Z.on("vertex-remove",aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:aa,
type:"update"})}),Z.on("immediate-click",aa=>{aa.shiftKey?this._toggleSelection([aa.graphic],Q,W):Q.toggleTool()})]}}_onTransformOrReshape2DGraphicClick(Q,W,Z){const {graphic:aa,viewEvent:fa}=Z;if(fa.native?.shiftKey&&aa.layer===this.layer)return fa.stopPropagation(),Q.removeFromSelection(aa);if(W.toggleToolOnClick)return fa.stopPropagation(),Q.toggleTool()}_setUpdateOperationHandle(Q,W){this._operationHandle=Q;const Z=this.view?.map;this._disablePopup(W);Q.on("complete",()=>{if(Q===this._operationHandle){const aa=
this.updateGraphics.toArray(),fa=this._operationHandle.tool;this._operationHandle.destroy();this._operationHandle=null;this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray());this.updateGraphics.removeAll();Z&&Z.remove(this._internalGraphicsLayer);this._restorePopup(W);this.emit("update",{graphics:aa,state:"complete",aborted:Q.cancelled,tool:fa,toolEventInfo:null,type:"update"})}})}async _getCommonUpdateOperationClickHandlers(Q,W,Z){const aa=J.createScreenPointFromEvent(W),fa=await W.async(()=>
this._getFirstHit(aa));null==fa?Q.complete():W.native.shiftKey&&this._toggleSelection([fa.graphic],Q,Z)?W.stopPropagation():this.updateGraphics.includes(fa.graphic)?W.stopPropagation():Q.complete()}_toggleSelection(Q,W,Z){const aa=!!Z.multipleSelectionEnabled;return Q.some(fa=>null==fa?!1:aa&&fa.layer===this.layer?(this.updateGraphics.includes(fa)?W.removeFromSelection(fa):W.addToSelection(fa),!0):!1)}_getCommonUpdateOperationKeyDownHandlers(Q,W){if(Q){var Z=W.key;Z===R.sketchKeys.undo&&Q.canUndo()?
(W.stopPropagation(),Q.undo()):Z===R.sketchKeys.redo&&Q.canRedo()?(W.stopPropagation(),Q.redo()):Z===R.sketchKeys.cancel?(W.stopPropagation(),Q.cancel()):this.allowDeleteKey&&R.sketchKeys.delete.includes(Z)&&this._onDeleteKey(W)}}_onDeleteKey(Q){if(this._operationHandle&&"update"===this._operationHandle.type){var W=this.activeComponent,Z=this.updateGraphics.toArray();null!=W&&"reshape-3d"!==W.type&&("reshape"!==W.type||1===Z.length&&"point"===Z[0].geometry?.type)&&(Q.stopPropagation(),this.delete())}}_removeDefaultLayer(){this._internalGraphicsLayer&&
(this.view?.map?.remove(this._internalGraphicsLayer),this._internalGraphicsLayer=B.destroyMaybe(this._internalGraphicsLayer))}_isComponentGraphic(Q){const {activeComponent:W}=this;return Q&&null!=W?Q.attributes?.esriSketchTool||"draw-2d"===W.type&&W.graphic===Q||("box"===W.type||"reshape"===W.type)&&W.isUIGraphic(Q):!1}_displayPointerCursor(){this.view?.container&&"pointer"!==this.view.cursor&&(this.view.cursor="pointer")}_displayGrabbingCursor(){this.view?.container&&"grabbing"!==this.view.cursor&&
(this.view.cursor="grabbing")}_displayDefaultCursor(){this.view?.container&&null!==this.view.cursor&&(this.view.cursor=null)}_logError(Q,W,Z){n.getLogger(this).error(new g(Q,W,Z))}async _requireModule(Q){const W=new AbortController;this._moduleLoaderAbortController=W;Q=await Q;return this._moduleLoaderAbortController!==W||W.signal.aborted?{requireError:"aborted"}:{module:Q}}_emitUndoEvent(Q){this.emit("undo",{...Q,type:"undo"})}_emitRedoEvent(Q){this.emit("redo",{...Q,type:"redo"})}_emitDeleteEvent(Q){this.emit("delete",
{...Q,type:"delete"})}get test(){return{operationHandle:this._operationHandle,snappingManager:this._snappingManager,defaultUpdateOptions:T}}wait(){return k.whenOnce(()=>!this.updating)}_beginAsyncOperation(){this._numUpdating+=1;this.notifyChange("updating")}_endAsyncOperation(){--this._numUpdating;this.notifyChange("updating")}_disablePopupEnabled(Q){return"3d"!==this.view?.type||this.updateOnGraphicClick||(Q?.toggleToolOnClick??!1)}_disablePopup(Q){this._disablePopupEnabled(Q)&&this.view&&null==
this._originalPopupEnabled&&(this._originalPopupEnabled=this.view.popupEnabled,this.view.popupEnabled=!1)}_restorePopup(Q){this._disablePopupEnabled(Q)&&this.view&&null!=this._originalPopupEnabled&&(this.view.popupEnabled=this._originalPopupEnabled,this._originalPopupEnabled=null)}async _waitViewReady(){const Q=this.view;Q?(B.abortMaybe(this._viewReadyAbortController),this._viewReadyAbortController=new AbortController,await M.whenOrAbort(k.whenOnce(()=>Q?.ready),this._viewReadyAbortController.signal)):
this._logMissingView()}_logMissingView(){this._logError("sketch:missing-property",ba("view"))}_logMissingLayer(){this._logError("sketch:missing-property",ba("layer"))}};b.__decorate([w.property()],x.prototype,"updating",null);b.__decorate([w.property()],x.prototype,"_operationHandle",void 0);b.__decorate([w.property({readOnly:!0})],x.prototype,"activeTool",null);b.__decorate([w.property()],x.prototype,"activeFillSymbol",void 0);b.__decorate([w.property()],x.prototype,"activeLineSymbol",void 0);b.__decorate([w.property()],
x.prototype,"activeVertexSymbol",void 0);b.__decorate([w.property()],x.prototype,"allowDeleteKey",void 0);b.__decorate([w.property({readOnly:!0})],x.prototype,"createGraphic",null);b.__decorate([w.property()],x.prototype,"defaultCreateOptions",null);b.__decorate([w.property()],x.prototype,"defaultUpdateOptions",null);b.__decorate([w.property({type:D,nonNullable:!0})],x.prototype,"labelOptions",void 0);b.__decorate([w.property()],x.prototype,"layer",void 0);b.__decorate([w.property({types:d.symbolTypes})],
x.prototype,"pointSymbol",void 0);b.__decorate([w.property({types:d.symbolTypes})],x.prototype,"polygonSymbol",void 0);b.__decorate([w.property({types:d.symbolTypes})],x.prototype,"polylineSymbol",void 0);b.__decorate([w.property()],x.prototype,"meshSymbol",void 0);b.__decorate([w.property({type:C,nonNullable:!0})],x.prototype,"snappingOptions",null);b.__decorate([w.property()],x.prototype,"_snappingManager",void 0);b.__decorate([w.property({readOnly:!0})],x.prototype,"state",null);b.__decorate([w.property({type:E,
nonNullable:!0})],x.prototype,"tooltipOptions",void 0);b.__decorate([w.property({readOnly:!0})],x.prototype,"updateGraphics",void 0);b.__decorate([w.property()],x.prototype,"updateOnGraphicClick",void 0);b.__decorate([w.property({types:d.symbolTypes})],x.prototype,"vertexSymbol",void 0);b.__decorate([w.property({value:null})],x.prototype,"view",null);x=b.__decorate([q.subclass("esri.widgets.Sketch.SketchViewModel")],x);const ba=Q=>`Property '${Q}' is missing on SketchViewModel.`;return x})},"esri/views/3d/interactive/editingTools/isSupportedGraphicUtils":function(){define(["exports",
"../../../../core/has"],function(a,b){a.SupportedGraphicResult=void 0;(function(d){d[d.SUPPORTED=0]="SUPPORTED";d[d.GRAPHICS_LAYER_MISSING=1]="GRAPHICS_LAYER_MISSING";d[d.GEOMETRY_MISSING=2]="GEOMETRY_MISSING";d[d.GEOMETRY_TYPE_UNSUPPORTED=3]="GEOMETRY_TYPE_UNSUPPORTED";d[d.ELEVATION_MODE_UNSUPPORTED=4]="ELEVATION_MODE_UNSUPPORTED";d[d.SYMBOL_TYPE_UNSUPPORTED=5]="SYMBOL_TYPE_UNSUPPORTED"})(a.SupportedGraphicResult||(a.SupportedGraphicResult={}));a.isSupportedGraphicResultMessage=function(d){switch(d){case a.SupportedGraphicResult.GRAPHICS_LAYER_MISSING:return"not owned by a graphics layer";
case a.SupportedGraphicResult.GEOMETRY_MISSING:return"no geometry";case a.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED:return"the geometry type is not supported";case a.SupportedGraphicResult.ELEVATION_MODE_UNSUPPORTED:return"the elevation mode is not supported";case a.SupportedGraphicResult.SYMBOL_TYPE_UNSUPPORTED:return"the symbol type is not supported"}return""};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/moveGraphic/isSupportedGraphic":function(){define(["exports",
"../../../../../core/has","../../../../../support/elevationInfoUtils","../isSupportedGraphicUtils"],function(a,b,d,m){a.isSupportedGraphic=function(g){if("graphics"!==g.layer?.type)return m.SupportedGraphicResult.GRAPHICS_LAYER_MISSING;if(null==g.geometry)return m.SupportedGraphicResult.GEOMETRY_MISSING;switch(g.geometry.type){case "polygon":case "point":case "polyline":case "mesh":break;case "multipoint":case "extent":return m.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED;default:return m.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED}return"on-the-ground"!==
d.getGraphicEffectiveElevationMode(g)&&d.hasGraphicFeatureExpressionInfo(g)?m.SupportedGraphicResult.ELEVATION_MODE_UNSUPPORTED:m.SupportedGraphicResult.SUPPORTED};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/support/elevationInfoUtils":function(){define(["exports","../symbols/support/unitConversionUtils"],function(a,b){function d(e,f){return f?.mode?f.mode:(e?k:w).mode}function m(e,f){return null!=f?f:e?k:w}function g(e,f){return d(null!=e?e.hasZ:!1,f)}function x(e){const f=
n(e);return g(e.geometry,f)}function n(e){return e.layer&&"elevationInfo"in e.layer?e.layer.elevationInfo:null}function B(e,f,l,q,r,c,t=null){if(null!=c){var h=null!=t?t.mode:"absolute-height";if("on-the-ground"===h)return 0;({absoluteZ:c}=M(f,l,q,r,e,c));a:{t=null!=t?.offset?t.offset:0;switch(h){case "absolute-height":e=c-t;break a;case "relative-to-ground":e=c-((e.elevationProvider.getElevation(f,l,q,r,"ground")??0)+t);break a;case "relative-to-scene":e=c-((e.elevationProvider.getElevation(f,l,
q,r,"scene")??0)+t);break a}e=void 0}return e}}function M(e,f,l,q,r,c){const t=null!=c.offset?c.offset:0;switch(c.mode){case "absolute-height":return{absoluteZ:l+t,elevation:0};case "on-the-ground":return l=r.elevationProvider.getElevation(e,f,0,q,"ground")??0,{absoluteZ:l,elevation:l};case "relative-to-ground":return e=r.elevationProvider.getElevation(e,f,l,q,"ground")??0,{absoluteZ:l+e+t,elevation:e};case "relative-to-scene":return e=r.elevationProvider.getElevation(e,f,l,q,"scene")??0,{absoluteZ:l+
e+t,elevation:e}}}const k={mode:"absolute-height",offset:0},w={mode:"on-the-ground",offset:null};a.absoluteHeightElevationInfo=k;a.elevationContextAffectsAlignment=function(e,f){if(null==f)return!1;({mode:f}=f);return null!=f&&("scene"===e&&"relative-to-scene"===f||"ground"===e&&"absolute-height"!==f)};a.elevationInfoLikeEquals=function(e,f){return e===f||null!=e&&null!=f&&e.mode===f.mode&&e.offset===f.offset};a.elevationModeRequiredMessage=function(e,f,l){return l&&l.mode!==f?`${e} only support ${f} elevation mode`:
null};a.elevationModeUnsupportedMessage=function(e,f,l){return l?.mode===f?`${e} do not support ${f} elevation mode`:null};a.featureExpressionUnsupportedMessage=function(e,f){return null!=f?.featureExpressionInfo&&"0"!==f.featureExpressionInfo.expression?`${e} do not support featureExpressionInfo`:null};a.getConvertedElevation=function(e,f,l,q=null){return B(e,f.x,f.y,f.hasZ?f.z:0,f.spatialReference,l,q)};a.getConvertedElevationFromVector=function(e,f,l,q,r=null){return B(e,f[0],f[1],2<f.length?f[2]:
0,l,q,r)};a.getEffectiveElevationInfo=m;a.getEffectiveElevationMode=d;a.getGeometryEffectiveElevationInfo=function(e,f){return m(null!=e?!!e.hasZ:!1,f)};a.getGeometryEffectiveElevationMode=g;a.getGraphicEffectiveElevationInfo=function(e){var f=n(e);e=g(e.geometry,f);f=null!=f&&"on-the-ground"!==e?(f.offset??0)*b.getMetersPerUnit(f.unit??"meters"):0;return{mode:e,offset:f}};a.getGraphicEffectiveElevationMode=x;a.getZForElevationMode=function(e,f,l){if(l?.mode){var q=e.hasZ?e.z:0,r=null!=l.offset?l.offset:
0;switch(l.mode){case "absolute-height":return q-r;case "on-the-ground":return 0;case "relative-to-ground":return e=(f.elevationProvider.getElevation(e.x,e.y,q,e.spatialReference,"ground")??0)+r,q-e;case "relative-to-scene":return e=(f.elevationProvider.getElevation(e.x,e.y,q,e.spatialReference,"scene")??0)+r,q-e}}};a.hasGraphicFeatureExpressionInfo=function(e){if("on-the-ground"===x(e))return!1;e=n(e);e=e?.featureExpressionInfo?e.featureExpressionInfo.expression:null;return!(!e||"0"===e)};a.logInvalidElevationInfoWarning=
function(e,f){f&&e.warn(".elevationInfo\x3d",f)};a.onTheGroundElevationInfo=w;a.zValueInAbsoluteHeightMode=M;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/reshapeGraphic/isSupportedGraphic":function(){define(["exports","../../../../../geometry/Circle","../../../../../support/elevationInfoUtils","../isSupportedGraphicUtils"],function(a,b,d,m){function g(x){if("graphics"!==x.layer?.type)return{result:m.SupportedGraphicResult.GRAPHICS_LAYER_MISSING,
geometry:null};const {geometry:n}=x;if(null==n)return{result:m.SupportedGraphicResult.GEOMETRY_MISSING,geometry:null};if("on-the-ground"!==d.getGraphicEffectiveElevationMode(x)&&d.hasGraphicFeatureExpressionInfo(x))return{result:m.SupportedGraphicResult.ELEVATION_MODE_UNSUPPORTED,geometry:null};const B=n.type;return"point"!==B&&"mesh"!==B&&"polyline"!==B&&("polygon"!==B||x.geometry instanceof b)?{result:m.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED,geometry:null}:{result:m.SupportedGraphicResult.SUPPORTED,
geometry:n}}a.geometryOfSupportedGraphic=function(x){return g(x).geometry};a.isSupportedGraphic=function(x){return g(x).result};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/Circle":function(){define("../chunks/tslib.es6 ../core/unitUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./ellipsoidUtils ./Point ./Polygon ./support/geodesicUtils ./support/webMercatorUtils ./support/WKIDUnitConversion".split(" "),
function(a,b,d,m,g,x,n,B,M,k,w,e,f){var l;m=l=class extends k{constructor(...q){super(...q);this.center=null;this.geodesic=!1;this.numberOfPoints=60;this.radius=1E3;this.radiusUnit="meters"}normalizeCtorArgs(q,r){if(!q?.center){if(q?.rings)return super.normalizeCtorArgs(q,r);q={center:q}}return{...super.normalizeCtorArgs(),...q,...r}}initialize(){var q=this.center;const r=this.numberOfPoints;this.hasZ=q?.hasZ??!1;if(0===this.rings.length&&q){var c=b.convertUnit(this.radius,this.radiusUnit,"meters"),
t=q.spatialReference,h="geographic";if(t.isWebMercator)h="webMercator";else if(null!=(t.wkid&&f[t.wkid])||(t.wkt2||t.wkt)&&b.isProjectedWKT(t.wkt2||t.wkt))h="projected";if(this.geodesic){let u;switch(h){case "webMercator":u=e.webMercatorToGeographic(q);break;case "projected":console.error("Creating a geodesic circle requires the center to be specified in web mercator or geographic coordinate system");break;case "geographic":u=q}q=this._createGeodesicCircle(u,c,r);"webMercator"===h&&(q=e.geographicToWebMercator(q))}else{let u;
"webMercator"===h||"projected"===h?u=c/b.getMetersPerUnit(q.spatialReference):"geographic"===h&&(u=b.lengthToDegrees(c,"meters",B.getReferenceEllipsoid(q.spatialReference).radius));q=this._createPlanarCircle(q,u,r)}this.spatialReference=q.spatialReference;this.addRing(q.rings[0])}}clone(){const {center:q,numberOfPoints:r,radius:c,radiusUnit:t,geodesic:h}=this;return new l({center:q?.clone(),numberOfPoints:r,radius:c,radiusUnit:t,geodesic:h})}_createGeodesicCircle(q,r,c){let t=0;const h=[];for(;360>
t;){const u=[0,0];w.directGeodeticSolver(u,[q.x,q.y],t,r);this.hasZ&&u.push(q.z);h.push(u);t+=360/c}h.push(h[0]);return new k(h)}_createPlanarCircle(q,r,c){const t=[],h=2*Math.PI/c;for(let L=0;L<c;++L){var u=h*L;u=[q.x+Math.cos(-u)*r,q.y+Math.sin(-u)*r];this.hasZ&&u.push(q.z);t.push(u)}t.push(t[0]);return new k({spatialReference:q.spatialReference,rings:[t]})}};a.__decorate([d.property({type:M})],m.prototype,"center",void 0);a.__decorate([d.property()],m.prototype,"geodesic",void 0);a.__decorate([d.property()],
m.prototype,"numberOfPoints",void 0);a.__decorate([d.property()],m.prototype,"radius",void 0);a.__decorate([d.property()],m.prototype,"radiusUnit",void 0);return m=l=a.__decorate([n.subclass("esri.geometry.Circle")],m)})},"esri/geometry/support/geodesicUtils":function(){define("exports ../../geometry ../../core/Error ../../core/unitUtils ./geodesicConstants ./spatialReferenceUtils ../Polyline ../Polygon ../Point ../SpatialReference".split(" "),function(a,b,d,m,g,x,n,B,M,k){function w(u){if(!u)return null;
if(x.isGeographic(u)&&u.wkid){var L=g.spheroids[u.wkid];if(L)return L}if(u=u.wkt2||u.wkt)if((u=g.wktSpheroidRegex.exec(u))&&2===u.length?(L=u[1].split(","),!L||3>L.length?u=null:(u=parseFloat(L[1]),L=parseFloat(L[2]),u=isNaN(u)||isNaN(L)?null:{a:u,f:0===L?0:1/L})):u=null,u)return u;return null}function e(u){u=w(u??k.WGS84);if(null!=u&&"b"in u&&"eSq"in u&&"radius"in u)return u;const L=u.a*(1-u.f);return Object.assign(u,{b:L,eSq:1-(L/u.a)**2,radius:(2*u.a+L)/3,densificationRatio:1E4/((2*u.a+L)/3)})}
function f(u){return null!=u&&0>u?u+360:u}function l(u,L,K){const {a:F,eSq:y}=e(K);K=Math.sqrt(y);const p=Math.sin(L[1]*g.toRadians);L=F*L[0]*g.toRadians;K=0<y?F*(1-y)*(p/(1-y*p*p)-1/(2*K)*Math.log((1-K*p)/(1+K*p)))*.5:F*p;u[0]=L;u[1]=K;return u}function q(u){return null!==w(u)}function r(u,L){if("polyline"!==u.type&&"polygon"!==u.type)throw new d("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");const {spatialReference:K}=u;if(!q(K))throw new d("geodesic-densify:invalid-spatial-reference",
"the input geometry spatial reference is not supported");var F="polyline"===u.type?u.paths:u.rings;const y=[],p=[0,0],I=new h;for(const E of F){F=[];y.push(F);F.push([E[0][0],E[0][1]]);var R=E[0][0],D=E[0][1];let N,C;for(let P=0;P<E.length-1;P++){N=E[P+1][0];C=E[P+1][1];if(R===N&&D===C)continue;const H=[R,D];t(I,[R,D],[N,C],K);const {azimuth:J,distance:z}=I;R=z/L;if(1<R){for(D=1;D<=R-1;D++)c(p,H,J,D*L,K),F.push(p.slice(0));c(p,H,J,(z+Math.floor(R-1)*L)/2,K);F.push(p.slice(0))}c(p,H,J,z,K);F.push(p.slice(0));
R=p[0];D=p[1]}}return"polyline"===u.type?new n({paths:y,spatialReference:K}):new B({rings:y,spatialReference:K})}function c(u,L,K,F,y){const p=L[0]*g.toRadians;L=L[1]*g.toRadians;K=(K??0)*g.toRadians;const {a:I,b:R,f:D}=e(y);y=Math.sin(K);K=Math.cos(K);var E=(1-D)*Math.tan(L);L=1/Math.sqrt(1+E*E);const N=E*L,C=Math.atan2(E,K);E=L*y;const P=E*E;var H=1-P,J=H*(I*I-R*R)/(R*R);const z=1+J/16384*(4096+J*(-768+J*(320-175*J))),A=J/1024*(256+J*(-128+J*(74-47*J)));J=F/(R*z);let v=2*Math.PI,G,O,U,ca;for(;1E-12<
Math.abs(J-v);)U=Math.cos(2*C+J),G=Math.sin(J),O=Math.cos(J),ca=A*G*(U+A/4*(O*(-1+2*U*U)-A/6*U*(-3+4*G*G)*(-3+4*U*U))),v=J,J=F/(R*z)+ca;F=N*G-L*O*K;H=D/16*H*(4+D*(4-3*H));F=Math.atan2(N*O+L*G*K,(1-D)*Math.sqrt(P+F*F))/g.toRadians;u[0]=(p+(Math.atan2(G*y,L*O-N*G*K)-(1-H)*D*E*(J+H*G*(U+H*O*(-1+2*U*U)))))/g.toRadians;u[1]=F;return u}function t(u,L,K,F){var y=L[0]*g.toRadians;L=L[1]*g.toRadians;var p=K[0]*g.toRadians;K=K[1]*g.toRadians;const {a:I,b:R,f:D,radius:E}=e(F),N=p-y;var C=Math.atan((1-D)*Math.tan(L)),
P=Math.atan((1-D)*Math.tan(K));F=Math.sin(C);C=Math.cos(C);const H=Math.sin(P);P=Math.cos(P);let J=1E3,z=N,A,v,G;let O,U,ca;do{var X=Math.sin(z);var da=Math.cos(z);G=Math.sqrt(P*X*P*X+(C*H-F*P*da)*(C*H-F*P*da));if(0===G)return u.distance=0,u.azimuth=void 0,u.reverseAzimuth=void 0,u;da=F*H+C*P*da;O=Math.atan2(G,da);U=C*P*X/G;v=1-U*U;X=da-2*F*H/v;isNaN(X)&&(X=0);ca=D/16*v*(4+D*(4-3*v));A=z;z=N+(1-ca)*D*U*(O+ca*G*(X+ca*da*(-1+2*X*X)))}while(1E-12<Math.abs(z-A)&&0<--J);if(0===J)return F=Math.acos(Math.sin(L)*
Math.sin(K)+Math.cos(L)*Math.cos(K)*Math.cos(p-y))*E,y=p-y,u.azimuth=Math.atan2(Math.sin(y)*Math.cos(K),Math.cos(L)*Math.sin(K)-Math.sin(L)*Math.cos(K)*Math.cos(y))/g.toRadians,u.distance=F,u.reverseAzimuth=void 0,u;y=v*(I*I-R*R)/(R*R);L=y/1024*(256+y*(-128+y*(74-47*y)));p=Math.atan2(C*Math.sin(z),C*H*Math.cos(z)-F*P);u.azimuth=Math.atan2(P*Math.sin(z),C*H-F*P*Math.cos(z))/g.toRadians;u.distance=R*(1+y/16384*(4096+y*(-768+y*(320-175*y))))*(O-L*G*(X+L/4*(da*(-1+2*X*X)-L/6*X*(-3+4*G*G)*(-3+4*X*X))));
u.reverseAzimuth=p/g.toRadians;return u}class h{constructor(u=0,L,K){this.distance=u;this.azimuth=L;this.reverseAzimuth=K}}a.InverseGeodeticSolverResult=h;a.directGeodeticSolver=c;a.geodesicAreas=function(u,L="square-meters"){if(u.some(p=>!q(p.spatialReference)))throw new d("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");const K=[];for(var F=0;F<u.length;F++){var y=u[F];const {radius:p,densificationRatio:I}=e(y.spatialReference);K.push(r(y,p*I))}u=
[];F=[0,0];y=[0,0];for(let p=0;p<K.length;p++){const {rings:I,spatialReference:R}=K[p];let D=0;for(let E=0;E<I.length;E++){const N=I[E];l(F,N[0],R);l(y,N[N.length-1],R);let C=y[0]*F[1]-F[0]*y[1];for(let P=0;P<N.length-1;P++)l(F,N[P+1],R),l(y,N[P],R),C+=y[0]*F[1]-F[0]*y[1];D+=C}D=m.convertUnit(D,"square-meters",L);u.push(D/-2)}return u};a.geodesicDensify=r;a.geodesicDistance=function(u,L,K="meters"){if(!u||!L)throw new d("geodesic-distance:missing-parameters","one or both input parameters are missing");
if(!u.spatialReference||!L.spatialReference)throw new d("geodesic-distance:invalid-parameters","one or both input points do not have a spatial reference");if(!x.equals(u.spatialReference,L.spatialReference))throw new d("geodesic-distance:invalid-parameters","spatial references of input parameters do not match");const {spatialReference:F}=u;if(!q(F))throw new d("geodesic-distance:not-supported","input geometry spatial reference is not supported");if(u.x===L.x&&u.y===L.y)return new h(0,0,0);const y=
new h;t(y,[u.x,u.y],[L.x,L.y],F);y.distance=m.convertUnit(y.distance,"meters",K);y.azimuth=f(y.azimuth);y.reverseAzimuth=f(y.reverseAzimuth);return y};a.geodesicLengths=function(u,L="meters"){if(!u)throw new d("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(u.some(y=>!q(y.spatialReference)))throw new d("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");const K=[];for(let y=0;y<u.length;y++){var F=u[y];const {spatialReference:p}=
F;F="polyline"===F.type?F.paths:F.rings;let I=0;for(let R=0;R<F.length;R++){const D=F[R];let E=0;for(let N=1;N<D.length;N++){const C=D[N-1][0],P=D[N][0],H=D[N-1][1],J=D[N][1];if(H!==J||C!==P){const z=new h;t(z,[C,H],[P,J],p);E+=z.distance}}I+=E}I=m.convertUnit(I,"meters",L);K.push(I)}return K};a.inverseGeodeticSolver=t;a.isSupported=q;a.pointFromDistance=function(u,L,K){if(!u||null==L||null==K)throw new d("point-from-distance:missing-parameters","one or more input parameters are missing or undefined");
if(0>K||360<K)throw new d("point-from-distance:-of-bounds","azimuth is restricted to angles between, and including, 0\u00b0 to 360\u00b0 degrees");if(!u.spatialReference)throw new d("point-from-distance:missing-spatial-reference","the input point must have a spatial reference");const {spatialReference:F}=u;if(!q(F))throw new d("geodesic-distance:not-supported","input geometry spatial reference is not supported");const y=[0,0];c(y,[u.x,u.y],K,L,F);return new M({x:y[0],y:y[1],spatialReference:F})};
Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/transformGraphic/isSupportedGraphic":function(){define(["exports","../../../../../core/has","../../../../../support/elevationInfoUtils","../isSupportedGraphicUtils"],function(a,b,d,m){a.isSupportedGraphic=function(g){if("graphics"!==g.layer?.type)return m.SupportedGraphicResult.GRAPHICS_LAYER_MISSING;if(null==g.geometry)return m.SupportedGraphicResult.GEOMETRY_MISSING;switch(g.geometry.type){case "point":break;
case "polygon":case "polyline":case "multipoint":case "extent":case "mesh":return m.SupportedGraphicResult.SUPPORTED;default:return m.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED}const x=null!=g.symbol&&"point-3d"===g.symbol.type&&g.symbol.symbolLayers;return x&&x.some(n=>"object"===n.type)?"on-the-ground"!==d.getGraphicEffectiveElevationMode(g)&&d.hasGraphicFeatureExpressionInfo(g)?m.SupportedGraphicResult.ELEVATION_MODE_UNSUPPORTED:m.SupportedGraphicResult.SUPPORTED:m.SupportedGraphicResult.SYMBOL_TYPE_UNSUPPORTED};
Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/keybindings":function(){define(["exports"],function(a){a.sketchKeys={redo:"r",undo:"z",center:"Alt",constraint:"Shift",cancel:"Escape",delete:["Backspace","Delete"],complete:"Enter",vertexAdd:"f",pan:" "};a.snappingKeys={toggle:"Control"};a.tooltipKeys={enterInputMode:"Tab",commit:"Enter",discard:"Escape",next:"Tab"};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/sketch/SketchLabelOptions":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,d,m,g,x,n){b=class extends b{constructor(B){super(B);this.enabled=!1}};a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"enabled",void 0);return b=a.__decorate([n.subclass("esri.views.interactive.sketch.SketchLabelOptions")],b)})},"esri/views/interactive/sketch/SketchTooltipOptions":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./SketchTooltipElevationOptions ./SketchTooltipVisibleElements".split(" "),
function(a,b,d,m,g,x,n,B,M){b=class extends b{constructor(k){super(k);this.inputEnabled=this.enabled=!1;this.elevation=new B.SketchTooltipElevationOptions;this.visibleElements=new M.SketchTooltipVisibleElements;this.visualVariables=null}toJSON(){return{enabled:this.enabled,elevation:this.elevation,visibleElements:this.visibleElements}}};a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"enabled",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"inputEnabled",
void 0);a.__decorate([d.property({type:B.SketchTooltipElevationOptions,nonNullable:!0})],b.prototype,"elevation",void 0);a.__decorate([d.property({type:M.SketchTooltipVisibleElements,nonNullable:!0})],b.prototype,"visibleElements",void 0);a.__decorate([d.property()],b.prototype,"visualVariables",void 0);return b=a.__decorate([n.subclass("esri.widgets.Sketch.SketchTooltipOptions")],b)})},"esri/views/interactive/sketch/SketchTooltipElevationOptions":function(){define("exports ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,d,m,g,x,n,B){a.SketchTooltipElevationOptions=class extends d{constructor(M){super(M);this.mode="absolute-height"}toJSON(){return{mode:this.mode}}};b.__decorate([m.property({type:String,nonNullable:!0})],a.SketchTooltipElevationOptions.prototype,"mode",void 0);a.SketchTooltipElevationOptions=b.__decorate([B.subclass("esri.widgets.Sketch.SketchTooltipOptions.ElevationOptions")],a.SketchTooltipElevationOptions);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/sketch/SketchTooltipVisibleElements":function(){define("exports ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,d,m,g,x,n,B){a.SketchTooltipVisibleElements=class extends d{constructor(M){super(M);this.elevation=this.distance=this.area=!0;this.helpMessage=!1;this.totalLength=this.size=this.scale=this.rotation=this.radius=this.orientation=!0}toJSON(){return{area:this.area,distance:this.distance,elevation:this.elevation,helpMessage:this.helpMessage,orientation:this.orientation,radius:this.radius,rotation:this.rotation,scale:this.scale,size:this.size,totalLength:this.totalLength}}};b.__decorate([m.property({type:Boolean,
nonNullable:!0})],a.SketchTooltipVisibleElements.prototype,"area",void 0);b.__decorate([m.property({type:Boolean,nonNullable:!0})],a.SketchTooltipVisibleElements.prototype,"distance",void 0);b.__decorate([m.property({type:Boolean,nonNullable:!0})],a.SketchTooltipVisibleElements.prototype,"elevation",void 0);b.__decorate([m.property({type:Boolean,nonNullable:!0})],a.SketchTooltipVisibleElements.prototype,"helpMessage",void 0);b.__decorate([m.property({type:Boolean,nonNullable:!0})],a.SketchTooltipVisibleElements.prototype,
"orientation",void 0);b.__decorate([m.property({type:Boolean,nonNullable:!0})],a.SketchTooltipVisibleElements.prototype,"radius",void 0);b.__decorate([m.property({type:Boolean,nonNullable:!0})],a.SketchTooltipVisibleElements.prototype,"rotation",void 0);b.__decorate([m.property({type:Boolean,nonNullable:!0})],a.SketchTooltipVisibleElements.prototype,"scale",void 0);b.__decorate([m.property({type:Boolean,nonNullable:!0})],a.SketchTooltipVisibleElements.prototype,"size",void 0);b.__decorate([m.property({type:Boolean,
nonNullable:!0})],a.SketchTooltipVisibleElements.prototype,"totalLength",void 0);a.SketchTooltipVisibleElements=b.__decorate([B.subclass("esri.widgets.Sketch.SketchTooltipOptions.VisibleElements")],a.SketchTooltipVisibleElements);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingManager":function(){define("exports ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Evented ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../geometry/projection ../../../support/elevationInfoUtils ../sketch/normalizedPoint ./Settings ./SnappingDomain ./snappingFactory ./SnappingOptions ./snappingPointUtils ./snappingUtils ./candidates/IntersectionSnappingCandidate ../support/viewUtils".split(" "),
function(a,b,d,m,g,x,n,B,M,k,w,e,f,l,q,r,c,t,h,u,L,K){function F({coordinateHelper:p,elevationInfo:I}){return p.hasZ()?f.absoluteHeightElevationInfo:I}a.SnappingManager=class extends m.EventedMixin(d){constructor(p){super(p);this.options=new t;this.snappingEnginesFactory=c.defaultSnappingEnginesFactory;this._engines=[];this._currentMainCandidate=null;this._currentOtherActiveCandidates=[];this._currentSnappedType=y.MAIN}initialize(){this.addHandles([x.watch(()=>{const {effectiveFeatureEnabled:p,effectiveSelfEnabled:I,
touchSensitivityMultiplier:R,distance:D}=this.options;return{effectiveFeatureEnabled:p,effectiveSelfEnabled:I,touchSensitivityMultiplier:R,distance:D}},()=>{this.doneSnapping();this.emit("changed")},x.sync),x.watch(()=>this.options,p=>{for(const I of this._engines)I.options=p},x.sync),x.watch(()=>({viewReady:this.view.ready,viewSpatialReference:this.view.spatialReference,snappingEnginesFactory:this.snappingEnginesFactory}),({viewReady:p,snappingEnginesFactory:I})=>this._recreateEngines(p,I),x.syncAndInitial)])}destroy(){this._destroyEngines()}get updating(){return this._engines.some(p=>
p.updating)}_recreateEngines(p,I){this._destroyEngines();if(p){var {view:R,options:D}=this;this._engines=I(R,D)}}_destroyEngines(){for(const p of this._engines)p.destroy();this._engines=[]}get _squaredMouseProximityTreshold(){return this.options.distance*this.options.distance}get _squaredTouchProximityThreshold(){const {distance:p,touchSensitivityMultiplier:I}=this.options,R=p*I;return R*R}get _squaredSatisfiesConstraintThreshold(){return q.defaults.satisfiesConstraintScreenThreshold*q.defaults.satisfiesConstraintScreenThreshold}snap(p){return null!=
p.scenePoint?this._snapMultiPoint(p):this._snapSinglePoint(p)}update(p){const {point:I,context:R}=p;this._removeVisualization();const D=this._currentMainCandidate;if(null==D)return I;var E=this._selectUpdateInput(p);if(null==E)return I;({spatialReference:p}=R);var N=e.project(E,p);if(null==N)return I;({view:E}=this);const {elevationInfo:C,visualizer:P}=R,H=[];N=l.fromPoint(N,E,C);const J=D.constraint.closestTo(N);if(!this._arePointsWithinScreenThreshold(N,J,R))return this._resetSnappingState(),I;
D.targetPoint=J;H.push(...D.hints);for(const z of this._currentOtherActiveCandidates)z.targetPoint=J,H.push(...z.hints);null!=P&&this.addHandles(P.draw(H,{spatialReference:p,elevationInfo:F(R),view:E,selfSnappingZ:R.selfSnappingZ}),"visualization-handle");return h.snappingPointToSnappingOutput(J,E,{z:I.z,m:I.m,spatialReference:I.spatialReference,elevationInfo:C})}doneSnapping(){this._removeVisualization();this._resetSnappingState()}_selectUpdateInput({point:p,scenePoint:I}){switch(this._currentSnappedType){case y.MAIN:return p;
case y.SCENE:return I}}_resetSnappingState(){this._currentMainCandidate=null;this._currentOtherActiveCandidates=[];this._currentSnappedType=y.MAIN}_removeVisualization(){this.removeHandles("visualization-handle")}async _snapSinglePoint({point:p,context:I,signal:R}){const {view:D}=this,{elevationInfo:E}=I,N=l.fromPoint(p,D,E),C=await this._fetchCandidates(N,r.SnappingDomain.ALL,I,R);return this._createSnapResult(N,y.MAIN,C,D,I,{z:p.z,m:p.m,spatialReference:p.spatialReference,elevationInfo:E},R)}async _snapMultiPoint({point:p,
scenePoint:I,context:R,signal:D}){const {view:E}=this,{coordinateHelper:N,elevationInfo:C,spatialReference:P}=R;await e.initializeProjection(I.spatialReference,P);I=e.project(I,P);var H=l.fromPoint(I,E,C);const J=await this._fetchCandidates(H,r.SnappingDomain.FEATURE,R,D);if(0<J.length)return p=await this._fetchCandidates(H,r.SnappingDomain.SELF,R,D),this._createSnapResult(H,y.SCENE,[...J,...p],E,R,{z:I.z,m:I.m,spatialReference:I.spatialReference,elevationInfo:C},D);I=l.fromPoint(p,E,C);H=await this._fetchCandidates(I,
r.SnappingDomain.SELF,R,D);return this._createSnapResult(I,y.MAIN,H,E,R,{z:N.hasZ()&&p.hasZ?p.z??0:void 0,m:N.hasM()&&p.hasM?p.m??0:void 0,spatialReference:p.spatialReference,elevationInfo:C},D)}async _fetchCandidates(p,I,R,D){return(await Promise.all(this._engines.map(E=>E.fetchCandidates(p,I,R,D)))).flat()}_createSnapResult(p,I,R,D,E,N,C){return{get valid(){return!g.isAborted(C)},apply:()=>{const {spatialReference:P}=E,{snappedPoint:H,hints:J}=this._processCandidates(p,I,R,E);this._removeVisualization();
null!=E.visualizer&&this.addHandles(E.visualizer.draw(J,{spatialReference:P,elevationInfo:f.absoluteHeightElevationInfo,view:D,selfSnappingZ:E.selfSnappingZ}),"visualization-handle");return h.snappingPointToSnappingOutput(H,D,N)}}}_processCandidates(p,I,R,D){if(1>R.length)return this.doneSnapping(),{snappedPoint:p,hints:[]};this._currentSnappedType!==I&&this._resetSnappingState();u.sortCandidatesInPlace(p,R);const E=this._currentMainCandidate;if(null!=E){const N=this._findOldConstraintInNewCandidates(E,
R);if(0<=N)if(R[N]instanceof L.IntersectionSnappingCandidate){if(this._arePointsWithinScreenThreshold(p,E.targetPoint,D))return this._updateSnappingCandidate(E,I,R,D)}else return this._intersectWithOtherCandidates(N,R,p,I,D)}return this._intersectWithOtherCandidates(0,R,p,I,D)}_findOldConstraintInNewCandidates(p,I){return p instanceof L.IntersectionSnappingCandidate?0<=this._findOldCandidateIndex(I,p.first)&&0<=this._findOldCandidateIndex(I,p.second)?0:-1:this._findOldCandidateIndex(I,p)}_intersectWithOtherCandidates(p,
I,R,D,E){const {coordinateHelper:N}=E,C=I[p],P=[];for(let H=0;H<I.length;++H){if(H===p)continue;const J=I[H],z=C.constraint.intersect(J.constraint);if(z)for(const A of z.closestPoints(C.targetPoint))P.push([new L.IntersectionSnappingCandidate(A,C,J,J.isDraped),this._squaredScreenDistance(R,A,N)])}return 0<P.length&&(P.sort((H,J)=>H[1]-J[1]),P[0][1]<this._squaredPointProximityThreshold(E.pointer))?this._updateSnappingCandidate(P[0][0],D,I,E):this._updateSnappingCandidate(C,D,I,E)}_updateSnappingCandidate(p,
I,R,D){this.doneSnapping();this._currentMainCandidate=p;this._currentSnappedType=I;I=this._currentMainCandidate.targetPoint;const E=[];E.push(...p.hints);for(const N of R){if(p instanceof L.IntersectionSnappingCandidate){if(N.constraint.equals(p.first.constraint)||N.constraint.equals(p.second.constraint))continue}else if(N.constraint.equals(p.constraint))continue;R=N.constraint.closestTo(I);this._squaredScreenDistance(R,I,D.coordinateHelper)<this._squaredSatisfiesConstraintThreshold&&(N.targetPoint=
I,this._currentOtherActiveCandidates.push(N),E.push(...N.hints))}return{snappedPoint:I,hints:E}}_squaredPointProximityThreshold(p){return"touch"===p?this._squaredTouchProximityThreshold:this._squaredMouseProximityTreshold}_arePointsWithinScreenThreshold(p,I,R){return this._squaredScreenDistance(p,I,R.coordinateHelper)<this._squaredPointProximityThreshold(R.pointer)}_squaredScreenDistance(p,I,R){return u.squaredScreenDistance(this._toScreen(p,R),this._toScreen(I,R))}_toScreen(p,I){return K.vectorToScreenPoint(p,
I.spatialReference,f.absoluteHeightElevationInfo,this.view)}_findOldCandidateIndex(p,I){let R=-1;for(let D=0;D<p.length;++D)if(I.constraint.equals(p[D].constraint)){R=D;break}return R}get test(){return{visualizationsActive:this.hasHandles("visualization-handle"),engines:this._engines}}};b.__decorate([n.property({constructOnly:!0})],a.SnappingManager.prototype,"view",void 0);b.__decorate([n.property()],a.SnappingManager.prototype,"options",void 0);b.__decorate([n.property({readOnly:!0})],a.SnappingManager.prototype,
"updating",null);b.__decorate([n.property()],a.SnappingManager.prototype,"snappingEnginesFactory",void 0);b.__decorate([n.property()],a.SnappingManager.prototype,"_engines",void 0);b.__decorate([n.property()],a.SnappingManager.prototype,"_squaredMouseProximityTreshold",null);b.__decorate([n.property()],a.SnappingManager.prototype,"_squaredTouchProximityThreshold",null);b.__decorate([n.property()],a.SnappingManager.prototype,"_squaredSatisfiesConstraintThreshold",null);a.SnappingManager=b.__decorate([w.subclass("esri.views.interactive.snapping.SnappingManager")],
a.SnappingManager);var y;(function(p){p[p.MAIN=0]="MAIN";p[p.SCENE=1]="SCENE"})(y||(y={}));Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/sketch/normalizedPoint":function(){define(["exports","../../../chunks/vec3f64","../../../layers/graphics/dehydratedPoint","../../../support/elevationInfoUtils"],function(a,b,d,m){function g(n,B,M){if(null==n)return null;if(null==B)return b.fromValues(n.x,n.y,n.z??0);if("2d"===B.type)return b.fromValues(n.x,n.y,0);B=m.getConvertedElevation(B,
n,M,m.absoluteHeightElevationInfo)??0;return b.fromValues(n.x,n.y,B)}const x=d.makeDehydratedPoint(0,0,0,null);a.clone=function(n){return b.clone(n)};a.create=function(n,B,M){return b.fromValues(n,B,M)};a.fromAnyMapPoint=function(n,B,{coordinateHelper:M,elevationInfo:k}){return n?g(M.vectorToDehydratedPoint(n,x),B,k):null};a.fromPoint=g;a.fromValues=function(n,B,M){return b.fromValues(n,B,M)};a.fromVec3=function(n){return n};a.toDehydratedPoint=function(n,B){return d.makeDehydratedPoint(n[0],n[1],
n[2],B)};a.toWritableVec3=function(n){return b.clone(n)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/dehydratedPoint":function(){define(["exports"],function(a){a.makeDehydratedPoint=function(b,d,m,g){return{x:b,y:d,z:m,hasZ:null!=m,hasM:!1,spatialReference:g,type:"point"}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/Settings":function(){define("exports ../../../chunks/tslib.es6 ../../../Color ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,d,m,g,x){let n=class extends m.JSONSupport{constructor(){super(...arguments);this.enabled=!0}};b.__decorate([g.property({type:Boolean})],n.prototype,"enabled",void 0);n=b.__decorate([x.subclass("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],n);m=class extends m.JSONSupport{constructor(B){super(B);this.lineSnapper=new n;this.parallelLineSnapper=new n;this.rightAngleSnapper=new n;this.rightAngleTriangleSnapper=new n;this.shortLineThreshold=15;this.distance=5;this.parallelLineThreshold=
this.intersectionParallelLineThreshold=this.pointThreshold=1E-6;this.verticalLineThreshold=.1;this.touchSensitivityMultiplier=1.5;this.pointOnLineThreshold=1E-6;this.orange=new d([255,127,0]);this.orangeTransparent=new d([255,127,0,.5]);this.lineHintWidthTarget=this.lineHintWidthReference=3;this.lineHintFadedExtensions=.3;this.parallelLineHintWidth=2;this.parallelLineHintLength=24;this.parallelLineHintOffset=1.5;this.rightAngleHintSize=24;this.rightAngleHintOutlineSize=1.5;this.satisfiesConstraintScreenThreshold=
1}};b.__decorate([g.property({type:n,constructOnly:!0,nonNullable:!0,json:{write:!0}})],m.prototype,"lineSnapper",void 0);b.__decorate([g.property({type:n,constructOnly:!0,nonNullable:!0,json:{write:!0}})],m.prototype,"parallelLineSnapper",void 0);b.__decorate([g.property({type:n,constructOnly:!0,nonNullable:!0,json:{write:!0}})],m.prototype,"rightAngleSnapper",void 0);b.__decorate([g.property({type:n,constructOnly:!0,nonNullable:!0,json:{write:!0}})],m.prototype,"rightAngleTriangleSnapper",void 0);
b.__decorate([g.property({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],m.prototype,"shortLineThreshold",void 0);b.__decorate([g.property({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],m.prototype,"distance",void 0);b.__decorate([g.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],m.prototype,"pointThreshold",void 0);b.__decorate([g.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],
m.prototype,"intersectionParallelLineThreshold",void 0);b.__decorate([g.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],m.prototype,"parallelLineThreshold",void 0);b.__decorate([g.property({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],m.prototype,"verticalLineThreshold",void 0);b.__decorate([g.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],m.prototype,"touchSensitivityMultiplier",void 0);b.__decorate([g.property({type:Number,
nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],m.prototype,"pointOnLineThreshold",void 0);b.__decorate([g.property({type:d,nonNullable:!0})],m.prototype,"orange",void 0);b.__decorate([g.property({type:d,nonNullable:!0})],m.prototype,"orangeTransparent",void 0);b.__decorate([g.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],m.prototype,"lineHintWidthReference",void 0);b.__decorate([g.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],
m.prototype,"lineHintWidthTarget",void 0);b.__decorate([g.property({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],m.prototype,"lineHintFadedExtensions",void 0);b.__decorate([g.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],m.prototype,"parallelLineHintWidth",void 0);b.__decorate([g.property({type:Number,nonNullable:!0,range:{min:0,max:50},json:{write:!0}})],m.prototype,"parallelLineHintLength",void 0);b.__decorate([g.property({type:Number,nonNullable:!0,
range:{min:0,max:5},json:{write:!0}})],m.prototype,"parallelLineHintOffset",void 0);b.__decorate([g.property({type:Number,nonNullable:!0,range:{min:0,max:46},json:{write:!0}})],m.prototype,"rightAngleHintSize",void 0);b.__decorate([g.property({type:Number,nonNullable:!0,range:{min:0,max:6},json:{write:!0}})],m.prototype,"rightAngleHintOutlineSize",void 0);b.__decorate([g.property({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],m.prototype,"satisfiesConstraintScreenThreshold",void 0);
m=b.__decorate([x.subclass("esri.views.interactive.snapping.Settings.Defaults")],m);b=new m;a.defaults=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingDomain":function(){define(["exports"],function(a){a.SnappingDomain=void 0;var b=a.SnappingDomain||(a.SnappingDomain={});b[b.FEATURE=1]="FEATURE";b[b.SELF=2]="SELF";b[b.ALL=3]="ALL";Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/snappingFactory":function(){define(["exports",
"./FeatureSnappingEngine","./SelfSnappingEngine"],function(a,b,d){a.defaultSnappingEnginesFactory=function(m,g){return[new d.SelfSnappingEngine({view:m,options:g}),new b.FeatureSnappingEngine({view:m,options:g,spatialReference:m.spatialReference})]};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/FeatureSnappingEngine":function(){define("require exports ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/handleUtils ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/unitUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../chunks/vec2 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../chunks/common ../../../core/support/UpdatingHandles ../../../support/elevationInfoUtils ../sketch/constraints ../sketch/normalizedPoint ./FeatureSnappingSourceInfo ./SnappingDomain ./snappingUtils ./candidates/DrapedEdgeSnappingCandidate ./candidates/EdgeSnappingCandidate ./candidates/FeatureSnappingCandidate ./candidates/RightAngleSnappingCandidate ../support/viewUtils".split(" "),
function(a,b,d,m,g,x,n,B,M,k,w,e,f,l,q,r,c,t,h,u,L,K,F,y,p,I,R,D,E){function N({constraint:{start:J,end:z}}){const A=q.squaredDistance(J,z);J=l.squaredDistance(J,z);return A<c.getEpsilon()||1E-4>J/A}function C(J,z,A,v,G,O,{spatialReference:U}){z=q.copy(H,z);z[0]+=A;z[1]+=v;z[2]+=G;return(A=E.vectorToScreenPoint(z,U,h.absoluteHeightElevationInfo,O))?y.screenDistance(A,J):Infinity}b.FeatureSnappingEngine=class extends m{get updating(){return this._snappingSources.some(J=>null==J||J.valid&&J.snappingSource.updating)||
this._updatingHandles.updating}constructor(J){super(J);this.options=null;this._domain=F.SnappingDomain.FEATURE;this._updatingHandles=new t.UpdatingHandles;this._sourceModules={featureService:{module:null,loader:null},featureCollection:{module:null,loader:null},graphics:{module:null,loader:null},notes:{module:null,loader:null},scene:{module:null,loader:null}}}initialize(){const J=n.mapCollectionAsync(()=>this.options?.featureSources,(z,A)=>this._createSourceInfo(z,A));this._snappingSources=J;this.addHandles(g.destroyHandle(J))}destroy(){this._set("options",
null);this._updatingHandles.destroy()}async fetchCandidates(J,z,A,v){if(!(z&this._domain&&null!=this.options&&this.options.effectiveFeatureEnabled))return[];const G=[];z=this._computeScreenSizeDistanceParameters(J,A);for(const U of this._snappingSources){if(null==U||!U.valid||!U.snappingSource.layerSource.enabled||U.layerView?.suspended)continue;const ca=U.getFetchCandidatesParameters(J,A,z);for(var O of ca)G.push(U.snappingSource.fetchCandidates(O,v).then(X=>X.filter(da=>!this._candidateIsExcluded(U.snappingSource,
da,A.excludeFeature))))}O=(await x.allSettledValues(G)).flat();this._addRightAngleCandidates(O,J,z,A);x.throwIfAborted(v);y.sortCandidatesInPlace(J,O);return O}_addRightAngleCandidates(J,z,A,v){var G=null!=v.vertexHandle?v.vertexHandle.rightEdge?.rightVertex?.pos:null!=v.editGeometryOperations&&"polygon"===v.editGeometryOperations.data.type?v.editGeometryOperations.data.components[0]?.getFirstVertex()?.pos:null,O=null!=v.vertexHandle?v.vertexHandle.leftEdge?.leftVertex?.pos:null!=v.editGeometryOperations?
v.editGeometryOperations.data.components[0]?.getLastVertex()?.pos:null,{view:U}=this;G=L.fromAnyMapPoint(G,U,v);v=L.fromAnyMapPoint(O,U,v);O=J.length;for(U=0;U<O;U++)this._addRightAngleCandidate(J[U],v,z,A,J),this._addRightAngleCandidate(J[U],G,z,A,J)}_addRightAngleCandidate(J,z,A,v,G){var O;(O=null==z)||(O=!((J instanceof I.EdgeSnappingCandidate||J instanceof p.DrapedEdgeSnappingCandidate)&&!N(J)));if(!O){O=J.constraint.closestTo(z);var U=(O[0]-A[0])/v.x;A=(O[1]-A[1])/v.y;var {start:ca,end:X}=J.constraint;
1>=U*U+A*A&&(J=new D.RightAngleSnappingCandidate({targetPoint:O,otherVertex:z,otherVertexType:D.OtherVertexType.NEXT,previousVertex:l.squaredDistance(O,ca)>l.squaredDistance(O,X)?ca:X,constraint:new u.VerticalHalfPlaneConstraint(z,O),objectId:J.objectId,isDraped:J.isDraped}),G.push(J))}}_computeScreenSizeDistanceParameters(J,z){let A=null!=this.options?this.options.distance*("touch"===z.pointer?this.options.touchSensitivityMultiplier:1):0;return null==this.view?{x:A,y:A,z:A,distance:A}:"2d"===this.view.type?
(A*=this.view.resolution,{x:A,y:A,z:A,distance:A}):this._computeScreenSizeDistanceParameters3D(J,A,this.view,z)}_computeScreenSizeDistanceParameters3D(J,z,A,v){var {spatialReference:G}=v;A.renderCoordsHelper.toRenderCoords(J,G,P);const O=A.state.camera.computeScreenPixelSizeAt(P);var U=O*A.renderCoordsHelper.unitInMeters,ca=U/B.getMetersPerUnitForSR(G);const X=U/B.getMetersPerVerticalUnitForSR(G);U=z*ca;const da=z*X,ha=E.vectorToScreenPoint(J,G,h.absoluteHeightElevationInfo,A);G=ha?C(ha,J,ca,0,0,
A,v):0;ca=ha?C(ha,J,0,ca,0,A,v):0;J=ha?C(ha,J,0,0,X,A,v):0;return{x:0===G?0:U/G,y:0===ca?0:U/ca,z:0===J?0:da/J,distance:O*z}}_candidateIsExcluded(J,z,A){if(null==A)return!1;z=this._getCandidateObjectId(z);if(null==z)return!1;J=J.layerSource.layer;return"graphics"===J.type?A.uid===z:A.sourceLayer===J&&A.attributes&&"objectIdField"in J?A.attributes[J.objectIdField]===z:!1}_getCandidateObjectId(J){return J instanceof R.FeatureSnappingCandidate?J.objectId:null}async _createSourceInfo(J,z){const A=J.layer;
A.loaded||(await A.load(),x.throwIfAborted(z));const {view:v}=this;J=await this._createFeatureSnappingSourceType(J);x.throwIfAborted(z);return null==J?new K.FeatureSnappingSourceInfo({}):new K.FeatureSnappingSourceInfo({snappingSource:J,view:v,layer:A})}async _createFeatureSnappingSourceType(J){switch(J.layer.type){case "feature":case "geojson":case "csv":case "oriented-imagery":case "subtype-group":case "wfs":return this._createFeatureSnappingSourceFeatureLayer(J);case "graphics":return this._createFeatureSnappingSourceGraphicsLayer(J);
case "map-notes":return this._createFeatureSnappingSourceMapNotesLayer(J);case "scene":case "building-scene":return this._createFeatureSnappingSourceSceneLayer(J)}return null}async _createFeatureSnappingSourceSceneLayer(J){const {view:z}=this;return null==z||"3d"!==z.type?null:new ((await this._getSourceModule("scene")).SceneLayerSnappingSource)({layerSource:J,view:z})}async _createFeatureSnappingSourceFeatureLayer(J){switch(J.layer.source?.type){case "feature-layer":case "oriented-imagery":return new ((await this._getSourceModule("featureService")).FeatureServiceSnappingSource)({spatialReference:this.spatialReference,
view:this.view,layerSource:J});case "memory":case "csv":case "geojson":case "wfs":if("mesh"!==J.layer.geometryType)return new ((await this._getSourceModule("featureCollection")).FeatureCollectionSnappingSource)({layerSource:J,view:this.view})}return null}async _createFeatureSnappingSourceGraphicsLayer(J){return new ((await this._getSourceModule("graphics")).GraphicsSnappingSource)({getGraphicsLayers:()=>[J.layer],spatialReference:this.spatialReference,view:this.view,layerSource:J})}async _createFeatureSnappingSourceMapNotesLayer(J){return new ((await this._getSourceModule("notes")).GraphicsSnappingSource)({getGraphicsLayers:()=>
J.layer.sublayers?.toArray()??[],spatialReference:this.spatialReference,view:this.view,layerSource:J})}async _getSourceModule(J){var z=this._sourceModules[J];if(null==z.loader){z=this._loadSourceModule(J);this._sourceModules[J]={module:null,loader:z};const A=await z;this._sourceModules[J]={module:A,loader:z};return A}return null==z.module?z.loader:z.module}_loadSourceModule(J){const z=this._updatingHandles;switch(J){case "featureService":return z.addPromise(new Promise((A,v)=>a(["./featureSources/FeatureServiceSnappingSource"],
A,v)));case "featureCollection":return z.addPromise(new Promise((A,v)=>a(["./featureSources/FeatureCollectionSnappingSource"],A,v)));case "graphics":return z.addPromise(new Promise((A,v)=>a(["./featureSources/GraphicsSnappingSource"],A,v)));case "notes":return z.addPromise(new Promise((A,v)=>a(["./featureSources/GraphicsSnappingSource"],A,v)));case "scene":return z.addPromise(new Promise((A,v)=>a(["./featureSources/SceneLayerSnappingSource"],A,v)))}}get test(){return{snappingSources:this._snappingSources}}};
d.__decorate([M.property({constructOnly:!0})],b.FeatureSnappingEngine.prototype,"spatialReference",void 0);d.__decorate([M.property({constructOnly:!0})],b.FeatureSnappingEngine.prototype,"view",void 0);d.__decorate([M.property()],b.FeatureSnappingEngine.prototype,"options",void 0);d.__decorate([M.property({readOnly:!0})],b.FeatureSnappingEngine.prototype,"updating",null);d.__decorate([M.property()],b.FeatureSnappingEngine.prototype,"_snappingSources",void 0);b.FeatureSnappingEngine=d.__decorate([f.subclass("esri.views.interactive.snapping.FeatureSnappingEngine")],
b.FeatureSnappingEngine);const P=r.create(),H=r.create();Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/vec2":function(){define(["exports","./common"],function(a,b){function d(G,O){G[0]=O[0];G[1]=O[1];return G}function m(G,O,U){G[0]=O;G[1]=U;return G}function g(G,O,U){G[0]=O[0]+U[0];G[1]=O[1]+U[1];return G}function x(G,O,U){G[0]=O[0]-U[0];G[1]=O[1]-U[1];return G}function n(G,O,U){G[0]=O[0]*U[0];G[1]=O[1]*U[1];return G}function B(G,O,U){G[0]=O[0]/U[0];G[1]=O[1]/U[1];return G}
function M(G,O){G[0]=Math.ceil(O[0]);G[1]=Math.ceil(O[1]);return G}function k(G,O){G[0]=Math.floor(O[0]);G[1]=Math.floor(O[1]);return G}function w(G,O,U){G[0]=Math.min(O[0],U[0]);G[1]=Math.min(O[1],U[1]);return G}function e(G,O,U){G[0]=Math.max(O[0],U[0]);G[1]=Math.max(O[1],U[1]);return G}function f(G,O){G[0]=Math.round(O[0]);G[1]=Math.round(O[1]);return G}function l(G,O,U){G[0]=O[0]*U;G[1]=O[1]*U;return G}function q(G,O,U,ca){G[0]=O[0]+U[0]*ca;G[1]=O[1]+U[1]*ca;return G}function r(G,O){const U=O[0]-
G[0];G=O[1]-G[1];return Math.sqrt(U*U+G*G)}function c(G,O){const U=O[0]-G[0];G=O[1]-G[1];return U*U+G*G}function t(G){const O=G[0];G=G[1];return Math.sqrt(O*O+G*G)}function h(G){const O=G[0];G=G[1];return O*O+G*G}function u(G,O){G[0]=-O[0];G[1]=-O[1];return G}function L(G,O){G[0]=1/O[0];G[1]=1/O[1];return G}function K(G,O){var U=O[0];const ca=O[1];U=U*U+ca*ca;0<U&&(U=1/Math.sqrt(U),G[0]=O[0]*U,G[1]=O[1]*U);return G}function F(G,O){return G[0]*O[0]+G[1]*O[1]}function y(G,O,U){O=O[0]*U[1]-O[1]*U[0];
G[0]=G[1]=0;G[2]=O;return G}function p(G,O,U,ca){const X=O[0];O=O[1];G[0]=X+ca*(U[0]-X);G[1]=O+ca*(U[1]-O);return G}function I(G,O){O=O||1;const U=2*b.RANDOM()*Math.PI;G[0]=Math.cos(U)*O;G[1]=Math.sin(U)*O;return G}function R(G,O,U){const ca=O[0];O=O[1];G[0]=U[0]*ca+U[2]*O;G[1]=U[1]*ca+U[3]*O;return G}function D(G,O,U){const ca=O[0];O=O[1];G[0]=U[0]*ca+U[2]*O+U[4];G[1]=U[1]*ca+U[3]*O+U[5];return G}function E(G,O,U){const ca=O[0];O=O[1];G[0]=U[0]*ca+U[3]*O+U[6];G[1]=U[1]*ca+U[4]*O+U[7];return G}function N(G,
O,U){const ca=O[0];O=O[1];G[0]=U[0]*ca+U[4]*O+U[12];G[1]=U[1]*ca+U[5]*O+U[13];return G}function C(G,O,U,ca){const X=O[0]-U[0];O=O[1]-U[1];const da=Math.sin(ca);ca=Math.cos(ca);G[0]=X*ca-O*da+U[0];G[1]=X*da+O*ca+U[1];return G}function P(G,O){var U=G[0];G=G[1];const ca=O[0];O=O[1];let X=U*U+G*G;0<X&&(X=1/Math.sqrt(X));let da=ca*ca+O*O;0<da&&(da=1/Math.sqrt(da));U=(U*ca+G*O)*X*da;return 1<U?0:-1>U?Math.PI:Math.acos(U)}function H(G){return"vec2("+G[0]+", "+G[1]+")"}function J(G,O){return G[0]===O[0]&&
G[1]===O[1]}function z(G,O){const U=G[0];G=G[1];const ca=O[0];O=O[1];const X=b.getEpsilon();return Math.abs(U-ca)<=X*Math.max(1,Math.abs(U),Math.abs(ca))&&Math.abs(G-O)<=X*Math.max(1,Math.abs(G),Math.abs(O))}function A(G,O,U,ca,X){let da=O[0]-U[0];U=O[1]-U[1];X=(ca[0]*da+ca[1]*U)*(X-1);da=ca[0]*X;U=ca[1]*X;G[0]=O[0]+da;G[1]=O[1]+U;return G}const v=Object.freeze(Object.defineProperty({__proto__:null,add:g,angle:P,ceil:M,copy:d,cross:y,dist:r,distance:r,div:B,divide:B,dot:F,equals:z,exactEquals:J,floor:k,
inverse:L,len:t,length:t,lerp:p,max:e,min:w,mul:n,multiply:n,negate:u,normalize:K,projectAndScale:A,random:I,rotate:C,round:f,scale:l,scaleAndAdd:q,set:m,sqrDist:c,sqrLen:h,squaredDistance:c,squaredLength:h,str:H,sub:x,subtract:x,transformMat2:R,transformMat2d:D,transformMat3:E,transformMat4:N},Symbol.toStringTag,{value:"Module"}));a.add=g;a.angle=P;a.ceil=M;a.copy=d;a.cross=y;a.dist=r;a.distance=r;a.div=B;a.divide=B;a.dot=F;a.equals=z;a.exactEquals=J;a.floor=k;a.inverse=L;a.len=t;a.length=t;a.lerp=
p;a.max=e;a.min=w;a.mul=n;a.multiply=n;a.negate=u;a.normalize=K;a.projectAndScale=A;a.random=I;a.rotate=C;a.round=f;a.scale=l;a.scaleAndAdd=q;a.set=m;a.sqrDist=c;a.sqrLen=h;a.squaredDistance=c;a.squaredLength=h;a.str=H;a.sub=x;a.subtract=x;a.transformMat2=R;a.transformMat2d=D;a.transformMat3=E;a.transformMat4=N;a.vec2=v})},"esri/views/interactive/sketch/constraints":function(){define("exports ../../../core/arrayUtils ../../../chunks/vec2 ../../../chunks/vec2f64 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../geometry/support/plane ../../../geometry/support/ray ../../../chunks/sphere ./normalizedPoint ../../support/geometry3dUtils ../../support/geometry2dUtils".split(" "),
function(a,b,d,m,g,x,n,B,M,k,w,e){function f(V,Y){if(V instanceof A){var na=[];for(const oa of V.constraints)(V=oa.intersect(Y))&&na.push(V);return K(na)}if(Y instanceof A)return f(Y,V);if(V instanceof W)return t(V,Y);if(Y instanceof W)return t(Y,V);if(F(V))return{point:na}=V,Y=Y.closestTo(na),g.equals(Y,na)?V:void 0;if(y(V)){if(F(Y))return f(Y,V);if(y(Y))return u(w.intersectLineLikes(V.lineLike,Y.lineLike));if(p(Y))return Z(V,Y);if(I(Y))return u(w.intersectVerticalPlaneAndLineLike(Y.planeLike,V.lineLike));
if(R(Y))return u(w.intersectLineLikeAndVerticalCylinder(V.lineLike,Y.center,Y.radius));if(E(Y))return u(w.intersectLineLikeAndCircle(V.lineLike,Y));if(D(Y))return l(V,Y);if(N(Y))return q(V,Y)}else if(p(V)){if(F(Y)||y(Y))return f(Y,V);if(p(Y))return w.isClose(V.z,Y.z)?V:void 0;if(I(Y))return r(V,Y);if(R(Y)){const [oa,pa]=Y.center;return new G(k.fromValues(oa,pa,V.z),Y.radius)}if(E(Y))return fa(V,Y);if(D(Y))return w.isClose(Y.center[2],V.z)?Y:void 0;if(N(Y))return c(V,Y)}else if(I(V)){if(F(Y)||y(Y)||
p(Y))return f(Y,V);if(I(Y))return h(w.intersectVerticalPlanes(V.planeLike,Y.planeLike));if(R(Y))return h(w.intersectVerticalPlaneAndVerticalCylinder(V.planeLike,Y.center,Y.radius));if(E(Y))return la(V,Y);if(D(Y))return ka(V,Y);if(N(Y))return ja(V,Y)}else if(R(V)){if(F(Y)||y(Y)||p(Y)||I(Y))return f(Y,V);if(R(Y))return h(w.intersectVerticalCylinders(V.center,V.radius,Y.center,Y.radius));if(!E(Y)){if(D(Y))return na=d.squaredDistance(V.center,Y.center),w.isClose(na,0)&&w.isClose(V.radius,Y.radius)||(V=
w.intersectVerticalCylinders(V.center,V.radius,Y.center,Y.radius),Y=L(V,Y.center[2])),Y;N(Y)}}else if(E(V)){if(F(Y)||y(Y)||p(Y)||I(Y)||R(Y))return f(Y,V);E(Y)||(D(Y)?Y.asCircle():N(Y))}else if(D(V)){if(F(Y)||y(Y)||p(Y)||I(Y)||R(Y)||E(Y))return f(Y,V);if(D(Y))return w.vectorsHaveCloseZ(Y.center,V.center)?(na=d.squaredDistance(Y.center,V.center),w.isClose(na,0)&&w.isClose(Y.radius,V.radius)||(V=w.intersectVerticalCylinders(Y.center,Y.radius,V.center,V.radius),Y=L(V,Y.center[2]))):Y=void 0,Y;N(Y)}else if(N(V)){if(F(Y)||
y(Y)||p(Y)||I(Y)||R(Y)||D(Y))return f(Y,V);N(Y)}}function l({lineLike:V},{center:Y,radius:na}){const oa=Y[2];V=w.intersectLineLikeAndVerticalCylinder(V,Y,na).filter(pa=>w.isClose(pa[2],oa));return u(V)}function q({lineLike:V},{sphere:Y}){return u(M.intersectLine(Y,V.start,V.end))}function r({z:V},{planeLike:Y}){const [na,oa]=Y.start,[pa,qa]=Y.end,ra=k.fromValues(na,oa,V);V=k.fromValues(pa,qa,V);return Y.type===w.VerticalPlaneType.PLANE?new J(ra,V):new z(ra,V)}function c(V,{center:Y,radius:na}){const oa=
Math.abs(Y[2]-V.z);if(!(oa>na)||w.isClose(oa,na))if(V=k.fromValues(Y[0],Y[1],V.z),na=Math.sqrt(na**2-oa**2),!w.isClose(na,0))return new G(V,na)}function t(V,Y){const {planeLike:na,getZ:oa}=V,pa=[];if(F(Y))V.addIfOnTheGround(pa,w.intersectVerticalPlaneAndPoint(na,Y.point));else if(y(Y))V.addIfOnTheGround(pa,w.intersectVerticalPlaneAndLineLike(na,Y.lineLike));else if(R(Y))for(const [qa,ra]of w.intersectVerticalPlaneAndVerticalCylinder(na,Y.center,Y.radius))V=oa(qa,ra),null!=V&&pa.push(x.fromValues(qa,
ra,V));else if(I(Y)||Y instanceof W)for(const [qa,ra]of w.intersectVerticalPlanes(na,Y.planeLike))V=oa(qa,ra)??0,pa.push(x.fromValues(qa,ra,V));return u(pa)}function h(V){return K(V.map(([Y,na])=>{const oa=k.fromValues(Y,na,0);Y=k.fromValues(Y,na,1);return new J(oa,Y)}))}function u(V){return K(V.map(Y=>Y?new P(k.fromVec3(Y)):void 0))}function L(V,Y){return u(V.map(([na,oa])=>[na,oa,Y]))}function K(V){if(0!==V.length)return 1===V.length?V[0]??void 0:new A(V.filter(b.isSome))}function F(V){return V instanceof
P}function y(V){return V instanceof H}function p(V){return V instanceof X}function I(V){return V instanceof ha}function R(V){return V instanceof v}function D(V){return V instanceof G}function E(V){return V instanceof O}function N(V){return V instanceof Q}class C{intersect(V){return f(this,V)}closestPoints(V){return[this.closestTo(V)]}}class P extends C{constructor(V){super();this.point=V}equals(V){return this===V||F(V)&&g.exactEquals(this.point,V.point)}closestTo(){return k.clone(this.point)}}class H extends C{constructor(V,
Y,na){super();this.start=V;this.end=Y;this.lineLike={start:V,end:Y,type:na}}equals(V){return this===V||y(V)&&this.lineLike.type===V.lineLike.type&&g.exactEquals(this.start,V.start)&&g.exactEquals(this.end,V.end)}closestTo(V){V=w.projectPointToLineLike(V,this.lineLike);return k.fromVec3(V)}}class J extends H{constructor(V,Y){super(V,Y,e.LineType.LINE)}}class z extends H{constructor(V,Y){super(V,Y,e.LineType.RAY)}}class A extends C{constructor(V){super();this.constraints=V}equals(V){return this===V||
V instanceof A&&b.equals(this.constraints,V.constraints,(Y,na)=>Y.equals(na))}closestTo(V){let Y=Infinity,na;for(const oa of this.constraints){const pa=oa.closestTo(V),qa=g.squaredDistance(V,pa);qa<Y&&(Y=qa,na=pa)}return na?k.clone(na):V}closestPoints(V){return this.constraints.flatMap(Y=>Y===this?[]:Y.closestPoints(V))}}class v extends C{constructor(V,Y){super();this.center=V;this.radius=Y}equals(V){return this===V||R(V)&&this.center[0]===V.center[0]&&this.center[1]===V.center[1]&&this.radius===
V.radius}closestTo(V){V=w.projectPointToVerticalCylinder(V,this.center,this.radius);return k.fromVec3(V)}}class G extends C{constructor(V,Y){super();this.center=V;this.radius=Y}equals(V){return this===V||D(V)&&g.exactEquals(this.center,V.center)&&this.radius===V.radius}closestTo(V){V=w.projectPointToVerticalCylinder(V,this.center,this.radius);V[2]=this.center[2];return k.fromVec3(V)}asCircle(){return new O(k.clone(this.center),this.radius,k.fromValues(0,0,1))}}class O extends C{constructor(V,Y,na,
oa){super();this.center=V;this.radius=Y;this.normal=na;this.slicePlane=oa}equals(V){return this===V||E(V)&&g.exactEquals(this.center,V.center)&&g.exactEquals(this.normal,V.normal)&&this.radius===V.radius}closestTo(V){const {center:Y,radius:na}=this;n.projectPoint(this.getPlane(ca),V,U);var oa=g.sub(U,U,Y),pa=g.squaredLength(oa);if(w.isClose(pa,0))return k.clone(V);pa=na/Math.sqrt(pa);oa=g.scaleAndAdd(x.create(),Y,oa,pa);({slicePlane:pa}=this);return pa&&!w.isPointInsidePlane(pa,oa)?aa(pa,this)?.closestTo(V)??
k.clone(V):k.fromVec3(oa)}getPlane(V=n.create()){return n.fromPositionAndNormal(this.center,this.normal,V)}}const U=x.create(),ca=n.create();class X extends C{constructor(V){super();this.z=V}equals(V){return this===V||p(V)&&this.z===V.z}closestTo(V){return k.fromVec3(x.fromValues(V[0],V[1],this.z))}getPlane(V=n.create()){g.set(da,0,0,this.z);return n.fromPositionAndNormal(da,x.UNIT_Z,V)}}const da=x.create();class ha extends C{constructor(V,Y,na){super();this.start=V;this.end=Y;this.planeLike={start:V,
end:Y,type:na}}equals(V){return this===V||I(V)&&this.planeLike.type===V.planeLike.type&&g.exactEquals(this.start,V.start)&&g.exactEquals(this.end,V.end)}closestTo(V){return k.fromVec3(w.projectPointToVerticalPlane(V,this.planeLike))}closestEndTo(V){const {start:Y,end:na}=this;return 0<Math.sign(d.dot(d.subtract(ia,na,Y),d.subtract(ma,V,Y)))?na:Y}getPlane(V=n.create()){const Y=g.copy(ea,this.end);Y[2]+=1;return n.fromPoints(this.start,this.end,Y,V)}getSlicePlane(V=n.create()){const {start:Y,end:na,
type:oa}=this.planeLike;if(oa!==w.VerticalPlaneType.PLANE){var pa=g.set(ea,Y[0],Y[1],0),qa=g.set(S,na[0],na[1],0);qa=g.subtract(S,qa,pa);n.fromPositionAndNormal(pa,qa,V);return V}}}const ia=m.create(),ma=m.create(),ea=x.create(),S=x.create();class T extends ha{constructor(V,Y){super(V,Y,w.VerticalPlaneType.HALF_PLANE)}}class ba extends ha{constructor(V,Y){super(V,Y,w.VerticalPlaneType.PLANE)}}class Q extends C{constructor(V,Y){super();this.sphere=M.fromCenterAndRadius(V,Y)}equals(V){return this===
V||N(V)&&M.exactEquals(this.sphere,V.sphere)}closestTo(V){V=M.projectPoint(this.sphere,V,x.create());return k.fromVec3(V)}get center(){return this.sphere}get radius(){return this.sphere[3]}}class W extends C{constructor(V,Y,na){super();this.start=V;this.end=Y;this.getZ=na;this.planeLike={start:V,end:Y,type:w.VerticalPlaneType.PLANE}}equals(V){return this===V||V instanceof W&&g.exactEquals(this.start,V.start)&&g.exactEquals(this.end,V.end)&&this.getZ===V.getZ}closestTo(V){V=w.projectPointToVerticalPlane(V,
this.planeLike);V[2]=this.getZ(V[0],V[1])??0;return k.fromVec3(V)}addIfOnTheGround(V,Y){for(const na of Y)Y=this.getZ(na[0],na[1])??0,w.isClose(na[2],Y)&&(na[2]=Y,V.push(na))}}const Z=(()=>{const V=n.create();return(Y,na)=>{const {start:oa,end:pa}=Y;if(w.vectorsHaveCloseZ(oa,pa)&&w.isClose(oa[2],na.z))return Y;Y=x.create();if(n.intersectLine(na.getPlane(V),oa,pa,Y))return new P(k.fromVec3(Y))}})(),aa=(()=>{const V=B.create(),Y=n.create(),na={start:x.create(),end:x.create(),type:e.LineType.LINE};return(oa,
pa,qa)=>{const {normal:ra,center:sa,radius:ua}=pa;var ta=g.dot(ra,n.normal(oa));const va=w.isClose(n.distance(oa,sa),0);if(w.isClose(ta,1)){if(va)return pa}else{pa.getPlane(Y);if(va&&w.isClose(ta,0)&&n.isVertical(oa)&&n.isVertical(Y)){if(w.isClose(ua,0))return!qa||w.isPointInsidePlane(qa,sa)?new P(k.clone(sa)):void 0;oa=x.clone(sa);oa[2]+=ua;pa=x.clone(sa);pa[2]-=ua;ta=[];qa&&!w.isPointInsidePlane(qa,oa)||ta.push(oa);qa&&!w.isPointInsidePlane(qa,pa)||ta.push(pa);return u(ta)}if(n.intersectPlanes(oa,
Y,V))return g.copy(na.start,V.origin),g.add(na.end,V.origin,V.direction),oa=w.intersectLineLikeAndCircle(na,pa),u(qa?w.pointsInsidePlane(qa,oa):oa)}}})(),fa=(()=>{const V=n.create();return(Y,na)=>aa(Y.getPlane(V),na)})(),ka=(()=>{const V=n.create();return(Y,{center:na,radius:oa})=>{oa=w.intersectVerticalPlaneAndVerticalCylinder(Y.planeLike,na,oa);na=na[2];Y.getSlicePlane(V);Y=[];for(const [pa,qa]of oa)oa=[pa,qa,na],w.isPointInsidePlane(V,oa)&&Y.push(oa);return u(Y)}})(),la=(()=>{const V=n.create(),
Y=n.create();return(na,oa)=>aa(na.getPlane(V),oa,na.getSlicePlane(Y))})(),ja=(()=>{const V=n.create();return(Y,{center:na,radius:oa})=>{const pa=Y.getPlane(V),qa=n.signedDistance(pa,na);var ra=Math.abs(qa);if(!(ra>oa)||w.isClose(ra,oa)){ra=x.clone(n.normal(pa));var sa=g.scaleAndAdd(x.create(),na,ra,qa);oa=Math.sqrt(oa**2-qa**2);return w.isClose(oa,0)?new P(k.fromVec3(n.projectPoint(pa,na,x.create()))):new O(k.fromVec3(sa),oa,ra,Y.getSlicePlane())}}})();a.CircleConstraint=O;a.Constraint=C;a.DrapedLineConstraint=
W;a.HorizontalCircleConstraint=G;a.HorizontalPlaneConstraint=X;a.LineConstraint=J;a.LineLikeConstraint=H;a.PointConstraint=P;a.RayConstraint=z;a.SetConstraint=A;a.SphereConstraint=Q;a.VerticalCylinderConstraint=v;a.VerticalHalfPlaneConstraint=T;a.VerticalPlaneConstraint=ba;a.VerticalPlaneLikeConstraint=ha;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/vec2f64":function(){define(["exports"],function(a){function b(){return[0,0]}function d(r){return[r[0],r[1]]}function m(r,
c){return[r,c]}function g(r,c=[0,0]){const t=Math.min(2,r.length);for(let h=0;h<t;++h)c[h]=r[h];return c}function x(r,c){return new Float64Array(r,c,2)}function n(){return[0,0]}function B(){return[1,1]}function M(){return[1,0]}function k(){return[0,1]}const w=[0,0],e=[1,1],f=[1,0],l=[0,1],q=Object.freeze(Object.defineProperty({__proto__:null,ONES:e,UNIT_X:f,UNIT_Y:l,ZEROS:w,clone:d,create:b,createView:x,fromArray:g,fromValues:m,ones:B,unitX:M,unitY:k,zeros:n},Symbol.toStringTag,{value:"Module"}));
a.ONES=e;a.UNIT_X=f;a.UNIT_Y=l;a.ZEROS=w;a.clone=d;a.create=b;a.createView=x;a.fromArray=g;a.fromValues=m;a.ones=B;a.unitX=M;a.unitY=k;a.vec2f64=q;a.zeros=n})},"esri/geometry/support/plane":function(){define("exports ../../core/mathUtils ../../chunks/vec3 ../../chunks/vec3f64 ../../chunks/vec4 ../../chunks/common ../../chunks/sphere ./vector ./vectorStacks ../../views/3d/support/mathUtils".split(" "),function(a,b,d,m,g,x,n,B,M,k){function w(C=R){return[C[0],C[1],C[2],C[3]]}function e(C,P){return f(P[0],
P[1],P[2],P[3],C)}function f(C,P,H,J,z=w()){z[0]=C;z[1]=P;z[2]=H;z[3]=J;return z}function l(C,P,H){var J=P[0]*P[0]+P[1]*P[1]+P[2]*P[2];J=1E-5<Math.abs(J-1)&&1E-12<J?1/Math.sqrt(J):1;H[0]=P[0]*J;H[1]=P[1]*J;H[2]=P[2]*J;H[3]=-(H[0]*C[0]+H[1]*C[1]+H[2]*C[2]);return H}function q(C,P,H,J=w()){var z=H[0]-P[0],A=H[1]-P[1],v=H[2]-P[2];H=C[0]-P[0];const G=C[1]-P[1],O=C[2]-P[2];P=A*O-v*G;v=v*H-z*O;z=z*G-A*H;A=P*P+v*v+z*z;A=1E-5<Math.abs(A-1)&&1E-12<A?1/Math.sqrt(A):1;J[0]=P*A;J[1]=v*A;J[2]=z*A;J[3]=-(J[0]*
C[0]+J[1]*C[1]+J[2]*C[2]);return J}function r(C,P,H,J=0,z=Math.floor(1/3*H),A=Math.floor(2/3*H)){if(3>H)return!1;P(L,J);let v=z,G=!1;for(;v<H-1&&!G;)P(K,v),v++,G=!d.exactEquals(L,K);if(!G)return!1;v=Math.max(v,A);for(G=!1;v<H&&!G;)P(F,v),v++,d.subtract(y,L,K),d.normalize(y,y),d.subtract(p,K,F),d.normalize(p,p),G=!d.exactEquals(L,F)&&!d.exactEquals(K,F)&&.99619469809>Math.abs(d.dot(y,p));if(!G)return 0===J&&1===z&&2===A?!1:r(C,P,H,0,1,2);q(L,K,F,C);return!0}function c(C,P,H){C=d.scale(M.sv3d.get(),
C,d.dot(C,P));d.subtract(H,P,C);return H}function t(C,P){return d.dot(C,P)+C[3]}function h(C,P,H,J,z){const A=d.dot(C,H);if(0===A)return!1;C=-(d.dot(C,P)+C[3])/A;J&D.CLAMP&&(C=b.clamp(C,0,1));if(!(J&D.INFINITE_MIN)&&0>C||!(J&D.INFINITE_MAX)&&1<C)return!1;d.add(z,P,d.scale(z,H,C));return!0}const u=g.exactEquals;g=g.equals;const L=m.create(),K=m.create(),F=m.create(),y=m.create(),p=m.create(),I=(()=>{const C=m.create();return(P,H,J)=>{d.cross(C,P,H);if(d.squaredLength(C)<x.getEpsilon())return!1;d.normalize(C,
C);const [z,A,v]=C,G=J.origin,O=Math.abs(z),U=Math.abs(A),ca=Math.abs(v),[X,da,ha]=P,[ia,ma,ea]=H;P=P[3];H=H[3];O>U&&O>ca?(G[1]=(H*ha-P*ea)/z,G[2]=(P*ma-H*da)/z):U>ca?(G[0]=(P*ea-H*ha)/A,G[2]=(H*X-P*ia)/A):(G[0]=(H*da-P*ma)/v,G[1]=(P*ia-H*X)/v);d.copy(J.direction,C);return!0}})(),R=[0,0,1,0];var D;(function(C){C[C.NONE=0]="NONE";C[C.CLAMP=1]="CLAMP";C[C.INFINITE_MIN=4]="INFINITE_MIN";C[C.INFINITE_MAX=8]="INFINITE_MAX"})(D||(D={}));const E=D.INFINITE_MIN|D.INFINITE_MAX,N=D.INFINITE_MAX;a.clip=function(C,
P){const H=d.dot(C,P.ray.direction);C=-t(C,P.ray.origin);if(0>C&&0<=H)return!1;if(-1E-6<H&&1E-6>H)return 0<C;if((0>C||0>H)&&!(0>C&&0>H))return!0;C/=H;0<H?C<P.c1&&(P.c1=C):C>P.c0&&(P.c0=C);return P.c0<=P.c1};a.clipInfinite=function(C,P){const H=d.dot(C,P.ray.direction);C=-t(C,P.ray.origin);if(-1E-6<H&&1E-6>H)return 0<C;C/=H;0<H?C<P.c1&&(P.c1=C):C>P.c0&&(P.c0=C);return P.c0<=P.c1};a.copy=e;a.create=w;a.distance=function(C,P){return Math.abs(t(C,P))};a.equals=g;a.exactEquals=u;a.fromArray=function(C,
P,H=!0){const J=P.length/3;return r(C,(z,A)=>d.set(z,P[3*A],P[3*A+1],P[3*A+2]),H?J-1:J)};a.fromManyPoints=r;a.fromNormalAndOffset=function(C,P,H){d.copy(H,C);H[3]=P;return H};a.fromPoints=q;a.fromPositionAndNormal=l;a.fromValues=f;a.fromVectorsAndPoint=function(C,P,H,J){d.cross(F,P,C);return l(H,F,J)};a.intersectLine=function(C,P,H,J){H=d.subtract(M.sv3d.get(),H,P);return h(C,P,H,E,J)};a.intersectLineSegment=function(C,P,H){return h(C,P.origin,P.vector,D.NONE,H)};a.intersectLineSegmentClamp=function(C,
P,H){return h(C,P.origin,P.vector,D.CLAMP,H)};a.intersectPlanes=I;a.intersectRay=function(C,P,H){return null!=P?h(C,P.origin,P.direction,N,H):!1};a.isPointInside=function(C,P){return 0<=t(C,P)};a.isPointOutside=function(C,P){return 0>t(C,P)};a.isSphereFullyInside=function(C,P){return 0<=t(C,n.getCenter(P))-P[3]};a.isSphereFullyOutside=function(C,P){return 0>t(C,n.getCenter(P))+P[3]};a.isVertical=function(C){return Math.abs(C[2])<x.getEpsilon()};a.negate=function(C,P){P[0]=-C[0];P[1]=-C[1];P[2]=-C[2];
P[3]=-C[3];return P};a.normal=function(C){return C};a.projectPoint=function(C,P,H){const J=d.scale(M.sv3d.get(),C,-C[3]);P=d.subtract(M.sv3d.get(),P,J);C=c(C,P,M.sv3d.get());d.add(H,C,J);return H};a.projectPointLocal=function(C,P,H,J){var z=M.sv3d.get(),A=M.sv3d.get();k.tangentFrame(C,z,A);P=d.subtract(M.sv3d.get(),H,P);z=B.projectPointSignedLength(z,P);A=B.projectPointSignedLength(A,P);C=B.projectPointSignedLength(C,P);return d.set(J,z,A,C)};a.projectVector=c;a.setOffsetFromPoint=function(C,P,H){P!==
C&&e(C,P);C[3]=-d.dot(C,H);return C};a.signedDistance=t;a.up=R;a.wrap=function(C=R[0],P=R[1],H=R[2],J=R[3]){return f(C,P,H,J,M.sv4d.get())};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/sphere":function(){define("exports ../core/has ../core/Logger ../core/mathUtils ./mat4 ./vec3 ./vec3f64 ./vec4 ./vec4f64 ./common ../geometry/support/Axis ../geometry/support/ray ../geometry/support/vector ../geometry/support/vectorStacks".split(" "),function(a,b,d,m,g,x,n,B,M,k,w,e,
f,l){function q(){return M.create()}function r(T,ba=q()){return B.copy(ba,T)}function c(T,ba){return M.fromValues(T[0],T[1],T[2],ba)}function t(T){return T}function h(T){T[0]=T[1]=T[2]=T[3]=0}function u(T,ba){T[0]=T[1]=T[2]=0;T[3]=ba;return T}function L(T){return T[3]}function K(T){return T}function F(T,ba,Q,W){return M.fromValues(T,ba,Q,W)}function y(T,ba,Q){T!==Q&&x.copy(Q,T);Q[3]=T[3]+ba;return Q}function p(T,ba,Q){d.getLogger("esri.geometry.support.sphere").error("sphere.setExtent is not yet supported");
return T===Q?Q:r(T,Q)}function I(T,ba,Q){if(null==ba||!D(T,ba,da))return!1;let {t0:W,t1:Z}=da;if(0>W||Z<W&&0<Z)W=Z;if(0>W)return!1;if(Q){const {origin:aa,direction:fa}=ba;Q[0]=aa[0]+fa[0]*W;Q[1]=aa[1]+fa[1]*W;Q[2]=aa[2]+fa[2]*W}return!0}function R(T,ba,Q){ba=e.fromPoints(ba,Q);if(!D(T,ba,da))return[];const {origin:W,direction:Z}=ba,{t0:aa,t1:fa}=da;ba=ka=>{const la=n.create();x.scaleAndAdd(la,W,Z,ka);return H(T,la,la)};return Math.abs(aa-fa)<k.getEpsilon()?[ba(aa)]:[ba(aa),ba(fa)]}function D(T,ba,
Q){const {origin:W,direction:Z}=ba,aa=ha;aa[0]=W[0]-T[0];aa[1]=W[1]-T[1];aa[2]=W[2]-T[2];ba=Z[0]*Z[0]+Z[1]*Z[1]+Z[2]*Z[2];if(0===ba)return!1;const fa=2*(Z[0]*aa[0]+Z[1]*aa[1]+Z[2]*aa[2]);T=fa*fa-4*ba*(aa[0]*aa[0]+aa[1]*aa[1]+aa[2]*aa[2]-T[3]*T[3]);if(0>T)return!1;T=Math.sqrt(T);Q.t0=(-fa-T)/(2*ba);Q.t1=(-fa+T)/(2*ba);return!0}function E(T,ba){return I(T,ba,null)}function N(T,ba,Q){if(I(T,ba,Q))return Q;T=C(T,ba,l.sv3d.get());x.add(Q,ba.origin,x.scale(l.sv3d.get(),ba.direction,x.distance(ba.origin,
T)/x.length(ba.direction)));return Q}function C(T,ba,Q){const W=l.sv3d.get(),Z=l.sm4d.get();x.cross(W,ba.origin,ba.direction);const aa=T[3];x.cross(Q,W,ba.origin);x.scale(Q,Q,1/x.length(Q)*aa);T=z(T,ba.origin);ba=f.angle(ba.origin,Q);g.fromRotation(Z,ba+T,W);x.transformMat4(Q,Q,Z);return Q}function P(T,ba,Q){if(I(T,ba,Q))return Q;e.closestPoint(ba,T,Q);return H(T,Q,Q)}function H(T,ba,Q){ba=x.subtract(l.sv3d.get(),ba,T);ba=x.scale(l.sv3d.get(),ba,T[3]/x.length(ba));return x.add(Q,ba,T)}function J(T,
ba){ba=x.subtract(l.sv3d.get(),ba,T);ba=x.squaredLength(ba);return Math.sqrt(Math.abs(ba-T[3]*T[3]))}function z(T,ba){ba=x.subtract(l.sv3d.get(),ba,T);ba=x.length(ba);T=T[3];return m.acosClamped(T/(T+Math.abs(T-ba)))}function A(T,ba,Q,W){T=x.subtract(ia,ba,T);switch(Q){case w.Axis.X:return Q=m.cartesianToSpherical(T,ia)[2],x.set(W,-Math.sin(Q),Math.cos(Q),0);case w.Axis.Y:return T=m.cartesianToSpherical(T,ia),Q=T[1],T=T[2],ba=Math.sin(Q),x.set(W,-ba*Math.cos(T),-ba*Math.sin(T),Math.cos(Q));case w.Axis.Z:return x.normalize(W,
T)}}function v(T,ba){ba=x.subtract(ma,ba,T);return x.length(ba)-T[3]}function G(T,ba,Q,W){const Z=v(T,ba);T=A(T,ba,w.Axis.Z,ma);Q=x.scale(ma,T,Q-Z);return x.add(W,ba,Q)}function O(T,ba){ba=x.squaredDistance(T,ba);T=T[3];return ba<=T*T}function U(T,ba,Q=q()){const W=x.distance(T,ba),Z=T[3],aa=ba[3];if(W+aa<Z)return B.copy(Q,T),Q;if(W+Z<aa)return B.copy(Q,ba),Q;x.lerp(Q,T,ba,(W+aa-Z)/(2*W));Q[3]=(W+Z+aa)/2;return Q}b=q();const ca=B.equals,X=B.equals,da={t0:0,t1:0},ha=n.create(),ia=n.create(),ma=n.create(),
ea=q(),S=Object.freeze(Object.defineProperty({__proto__:null,NullSphere:b,altitudeAt:v,angleToSilhouette:z,axisAt:A,clear:h,closestPoint:P,closestPointOnSilhouette:C,containsPoint:O,copy:r,create:q,distanceToSilhouette:J,elevate:y,equals:X,exactEquals:ca,fromCenterAndRadius:c,fromRadius:u,fromValues:F,getCenter:K,getRadius:L,intersectLine:R,intersectRay:I,intersectRayClosestSilhouette:N,intersectsRay:E,projectPoint:H,setAltitudeAt:G,setExtent:p,tmpSphere:ea,union:U,wrap:t},Symbol.toStringTag,{value:"Module"}));
a.NullSphere=b;a.altitudeAt=v;a.angleToSilhouette=z;a.axisAt=A;a.clear=h;a.closestPoint=P;a.closestPointOnSilhouette=C;a.containsPoint=O;a.copy=r;a.create=q;a.distanceToSilhouette=J;a.elevate=y;a.equals=X;a.exactEquals=ca;a.fromCenterAndRadius=c;a.fromRadius=u;a.fromValues=F;a.getCenter=K;a.getRadius=L;a.intersectLine=R;a.intersectRay=I;a.intersectRayClosestSilhouette=N;a.intersectsRay=E;a.projectPoint=H;a.setAltitudeAt=G;a.setExtent=p;a.sphere=S;a.tmpSphere=ea;a.union=U;a.wrap=t})},"esri/geometry/support/ray":function(){define("exports ../../core/arrayUtils ../../core/ObjectStack ../../chunks/vec3 ../../chunks/vec3f64 ./vectorStacks".split(" "),
function(a,b,d,m,g,x){function n(e){return e?B(g.clone(e.origin),g.clone(e.direction)):B(g.create(),g.create())}function B(e,f){return{origin:e,direction:f}}function M(e,f,l=n()){m.copy(l.origin,e);m.copy(l.direction,f);return l}function k(e,f){e=m.cross(x.sv3d.get(),m.normalize(x.sv3d.get(),e.direction),m.subtract(x.sv3d.get(),f,e.origin));return m.dot(e,e)}const w=new d.ObjectStack(()=>n());a.closestPoint=function(e,f,l){f=m.dot(e.direction,m.subtract(l,f,e.origin));m.add(l,e.origin,m.scale(l,e.direction,
f));return l};a.copy=function(e,f=n()){return M(e.origin,e.direction,f)};a.create=n;a.distance=function(e,f){return Math.sqrt(k(e,f))};a.distance2=k;a.equals=function(e,f){return b.equals(e.origin,f.origin)&&b.equals(e.direction,f.direction)};a.fromPoints=function(e,f,l=n()){m.copy(l.origin,e);m.subtract(l.direction,f,e);return l};a.fromValues=M;a.wrap=function(e,f){const l=w.get();l.origin=e;l.direction=f;return l};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/ObjectStack":function(){define(["exports",
"./nextTick"],function(a,b){class d{constructor(m){this._allocator=m;this._items=[];this._itemsPtr=0;this._grow()}get(){0===this._itemsPtr&&b.nextTick(()=>this._reset());this._itemsPtr===this._items.length&&this._grow();return this._items[this._itemsPtr++]}_reset(){this._items.length=Math.min(Math.min(3*Math.max(8,this._itemsPtr),this._itemsPtr+3072),this._items.length);this._itemsPtr=0}_grow(){for(let m=0;m<Math.max(8,Math.min(this._items.length,1024));m++)this._items.push(this._allocator())}}a.ObjectStack=
d;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/vectorStacks":function(){define(["exports","../../core/VectorStack"],function(a,b){const d=b.VectorStack.createVec2f64(),m=b.VectorStack.createVec3f64(),g=b.VectorStack.createVec4f64(),x=b.VectorStack.createMat3f64(),n=b.VectorStack.createMat4f64();b=b.VectorStack.createQuatf64();a.sm3d=x;a.sm4d=n;a.sq4d=b;a.sv2d=d;a.sv3d=m;a.sv4d=g;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/VectorStack":function(){define("exports ./ByteSizeUnit ./nextTick ../chunks/mat3f64 ../chunks/mat4f64 ../chunks/quatf64 ../chunks/vec2f64 ../chunks/vec3f64 ../chunks/vec4f64".split(" "),
function(a,b,d,m,g,x,n,B,M){class k{constructor(e,f,l){this._itemByteSize=e;this._itemCreate=f;this._buffers=[];this._items=[];this._itemsPtr=0;this._itemsPerBuffer=Math.ceil(l/this._itemByteSize)}get(){0===this._itemsPtr&&d.nextTick(()=>this._reset());const e=Math.floor(this._itemsPtr/this._itemsPerBuffer);for(;this._buffers.length<=e;){const f=new ArrayBuffer(this._itemsPerBuffer*this._itemByteSize);for(let l=0;l<this._itemsPerBuffer;++l)this._items.push(this._itemCreate(f,l*this._itemByteSize));
this._buffers.push(f)}return this._items[this._itemsPtr++]}_reset(){const e=2*(Math.floor(this._itemsPtr/this._itemsPerBuffer)+1);for(;this._buffers.length>e;)this._buffers.pop(),this._items.length=this._buffers.length*this._itemsPerBuffer;this._itemsPtr=0}static createVec2f64(e=w){return new k(16,n.createView,e)}static createVec3f64(e=w){return new k(24,B.createView,e)}static createVec4f64(e=w){return new k(32,M.createView,e)}static createMat3f64(e=w){return new k(72,m.createView,e)}static createMat4f64(e=
w){return new k(128,g.createView,e)}static createQuatf64(e=w){return new k(32,x.createView,e)}get test(){return{size:this._buffers.length*this._itemsPerBuffer*this._itemByteSize}}}const w=4*b.ByteSizeUnit.KILOBYTES;a.VectorStack=k;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/mat3f64":function(){define(["exports"],function(a){function b(){return[1,0,0,0,1,0,0,0,1]}function d(n){return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8]]}function m(n,B,M,k,w,e,f,l,q){return[n,
B,M,k,w,e,f,l,q]}function g(n,B){return new Float64Array(n,B,9)}const x=Object.freeze(Object.defineProperty({__proto__:null,clone:d,create:b,createView:g,fromValues:m},Symbol.toStringTag,{value:"Module"}));a.clone=d;a.create=b;a.createView=g;a.fromValues=m;a.mat3f64=x})},"esri/chunks/quatf64":function(){define(["exports"],function(a){function b(){return[0,0,0,1]}function d(B){return[B[0],B[1],B[2],B[3]]}function m(B,M,k,w){return[B,M,k,w]}function g(B,M){return new Float64Array(B,M,4)}const x=b(),
n=Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:x,clone:d,create:b,createView:g,fromValues:m},Symbol.toStringTag,{value:"Module"}));a.IDENTITY=x;a.clone=d;a.create=b;a.createView=g;a.fromValues=m;a.quatf64=n})},"esri/geometry/support/vector":function(){define(["exports","../../core/mathUtils","../../chunks/vec3","../../chunks/vec3f64"],function(a,b,d,m){const g=m.create(),x=m.create();a.angle=function(n,B){n=d.dot(n,B)/(d.length(n)*d.length(B));return-b.acosClamped(n)};a.angleAroundAxis=
function(n,B,M){d.normalize(g,n);d.normalize(x,B);n=d.dot(g,x);n=b.acosClamped(n);B=d.cross(g,g,x);return 0>d.dot(B,M)?2*Math.PI-n:n};a.projectPoint=function(n,B,M){B=d.dot(n,B)/d.dot(n,n);return d.scale(M,n,B)};a.projectPointSignedLength=function(n,B){return d.dot(n,B)/d.length(n)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/support/mathUtils":function(){define(["exports","../../../core/mathUtils","../../../chunks/vec3","../../../chunks/vec3f64"],function(a,b,d,
m){const g=m.create(),x=m.create(),n=m.create(),B=m.create(),M=m.create();a.angle=function(k,w,e){k=d.normalize(B,k);w=d.normalize(M,w);const f=b.acosClamped(d.dot(k,w));return e&&(k=d.cross(n,k,w),0>d.dot(k,e))?-f:f};a.bilerp=function(k,w,e,f,l,q){k+=(w-k)*l;return k+(e+(f-e)*l-k)*q};a.cosCapped=function(k,w){return k>w?Math.cos(w):Math.cos(k)};a.fovx2fovy=function(k,w,e){return 2*Math.atan(e*Math.tan(.5*k)/w)};a.fovy2fovx=function(k,w,e){return 2*Math.atan(w*Math.tan(.5*k)/e)};a.makeOrthonormal=
function(k,w,e){e=e||k;const f=d.dot(k,w);d.set(e,k[0]-f*w[0],k[1]-f*w[1],k[2]-f*w[2]);d.normalize(e,e)};a.makePiecewiseLinearFunction=function(k){const w=k.length;return e=>{if(e<=k[0][0])return k[0][1];if(e>=k[w-1][0])return k[w-1][1];let f=1;for(;e>k[f][0];)f++;const l=k[f][0];e=(l-e)/(l-k[f-1][0]);return e*k[f-1][1]+(1-e)*k[f][1]}};a.maxScale=function(k){return Math.sqrt(Math.max(k[0]*k[0]+k[4]*k[4]+k[8]*k[8],k[1]*k[1]+k[5]*k[5]+k[9]*k[9],k[2]*k[2]+k[6]*k[6]+k[10]*k[10]))};a.planeFromPoints=function(k,
w,e,f){d.subtract(g,w,k);d.subtract(x,e,k);d.cross(f,g,x);d.normalize(f,f);f[3]=-d.dot(k,f)};a.scaleFromMatrix=function(k,w){d.set(k,Math.sqrt(w[0]*w[0]+w[4]*w[4]+w[8]*w[8]),Math.sqrt(w[1]*w[1]+w[5]*w[5]+w[9]*w[9]),Math.sqrt(w[2]*w[2]+w[6]*w[6]+w[10]*w[10]));return k};a.slerp=function(k,w,e,f=m.create()){const l=d.length(k);var q=d.length(w),r=d.dot(k,w)/(l*q);if(.9999999999999999>r){r=Math.acos(r);const c=((1-e)*l+e*q)/Math.sin(r);q=c/q*Math.sin(e*r);d.scale(B,k,c/l*Math.sin((1-e)*r));d.scale(M,
w,q);return d.add(f,B,M)}return d.lerp(f,k,w,e)};a.slerpTangent=function(k,w,e,f=m.create(),l=m.create()){const q=d.length(k),r=d.length(w);var c=d.dot(k,w)/(q*r);if(.9999999999999999>c){c=Math.acos(c);const t=Math.sin(c),h=Math.sin(e*c),u=Math.sin((1-e)*c),L=(1-e)*q+e*r,K=L/t,F=K/r*h;d.scale(B,k,K/q*u);d.scale(M,w,F);d.add(f,B,M);d.scale(B,k,1/q*(-Math.cos((1-e)*c)*c*L+u*(-q+r)));d.scale(M,w,1/r*(Math.cos(e*c)*c*L+h*(-q+r)));d.add(l,B,M);d.scale(l,l,1/t);return l}d.lerp(f,k,w,e);d.subtract(l,w,k);
d.normalize(l,l);return l};a.tangentFrame=function(k,w,e){Math.abs(k[0])>Math.abs(k[1])?d.set(w,0,1,0):d.set(w,1,0,0);d.cross(e,k,w);d.normalize(w,w);d.cross(w,e,k);d.normalize(e,e)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/geometry3dUtils":function(){define("exports ../../core/mathUtils ../../chunks/vec2 ../../chunks/vec2f64 ../../chunks/vec3 ../../chunks/vec3f64 ../../geometry/support/plane ../3d/support/mathUtils ./geometry2dUtils".split(" "),function(a,
b,d,m,g,x,n,B,M){function k(C,{start:P,end:H,type:J}){C=g.sub(L,C,P);H=g.sub(K,H,P);C=g.dot(C,H)/g.dot(H,H);return g.scaleAndAdd(x.create(),P,H,J===M.LineType.RAY?Math.max(C,0):C)}function w({start:C,end:P,type:H},J){const z=g.sub(L,J,C);P=g.sub(K,P,C);if(H===M.LineType.RAY&&-1E-6>g.dot(P,z))return g.distance(C,J);C=g.cross(F,P,z);return g.len(C)/g.len(P)}function e(C,P){const H=C.start,J=P.start;var z=P.end;const A=g.sub(L,C.end,H);z=g.sub(K,z,J);var v=g.sub(F,J,H),G=g.cross(y,A,z),O=g.dot(v,G);
if(!b.floatEqualAbsolute(O,0,1E-6))return[];O=g.sqrLen(G);if(b.floatEqualAbsolute(O,0,1E-6))return[];v=g.cross(p,v,z);G=g.dot(v,G)/O;G=g.scaleAndAdd(I,H,A,G);return C.type===M.LineType.RAY&&(C=g.sub(R,G,H),-1E-6>g.dot(A,C))||P.type===M.LineType.RAY&&(P=g.sub(R,G,J),-1E-6>g.dot(z,P))?[]:[x.clone(G)]}function f({start:C,end:P,type:H},J){const z=g.sub(L,J,C);C=g.sub(K,P,C);P=g.cross(F,C,z);if(1E-6>g.sqrLen(P)/g.sqrLen(C))switch(H){case M.LineType.LINE:return[x.clone(J)];case M.LineType.RAY:return-1E-6>
g.dot(C,z)?[]:[x.clone(J)]}return[]}function l(C,P,{start:H,end:J,type:z}){g.set(C.start,H[0],H[1],P);g.set(C.end,J[0],J[1],P);C.type=t[z];return C}function q(C,P){return 1E-6>Math.abs(C-P)}function r(C,P){return n.isPointInside(C,P)}const c=(()=>{const C=x.create(),P=x.create(),H=x.create();return({start:J,end:z},{center:A,radius:v,normal:G,slicePlane:O})=>{const U=x.create(),ca=n.fromPositionAndNormal(A,G,D);if(q(n.distance(ca,J),0)&&q(n.distance(ca,z),0)){B.tangentFrame(G,C,P);G=(X,da)=>{g.subtract(H,
da,A);d.set(X,g.dot(H,C),g.dot(H,P));return X};z=M.intersectLineLikeAndCircle({start:G(h,J),end:G(u,z),type:M.LineType.LINE},m.ZEROS,v);J=[];for(const [X,da]of z)z=g.copy(x.create(),A),g.scaleAndAdd(z,z,C,X),g.scaleAndAdd(z,z,P,da),O&&!r(O,z)||J.push(z);return J}return n.intersectLine(ca,J,z,U)?!q(g.distance(U,A),v)||O&&!r(O,U)?[]:[U]:[]}})();a.VerticalPlaneType=void 0;(function(C){C[C.PLANE=0]="PLANE";C[C.HALF_PLANE=1]="HALF_PLANE"})(a.VerticalPlaneType||(a.VerticalPlaneType={}));const t={[a.VerticalPlaneType.PLANE]:M.LineType.LINE,
[a.VerticalPlaneType.HALF_PLANE]:M.LineType.RAY},h=m.create(),u=m.create(),L=x.create(),K=x.create(),F=x.create(),y=x.create(),p=x.create(),I=x.create(),R=x.create(),D=n.create(),E={start:x.create(),end:x.create(),type:M.LineType.LINE},N={start:x.create(),end:x.create(),type:M.LineType.LINE};Object.defineProperty(a,"LineType",{enumerable:!0,get:()=>M.LineType});a.epsilon=1E-6;a.intersectLineAndPoint=f;a.intersectLineLikeAndCircle=c;a.intersectLineLikeAndVerticalCylinder=function({start:C,end:P,type:H},
J,z){const A=[];P=g.subtract(L,P,C);var v=d.subtract(K,C,J);J=d.squaredLength(P);const G=2*d.dot(P,v);z=d.squaredLength(v)-z*z;z=G*G-4*J*z;0===z?(J=-G/(2*J),(H===M.LineType.LINE||0<=J)&&A.push(g.scaleAndAdd(x.create(),C,P,J))):0<z&&(z=Math.sqrt(z),v=(-G+z)/(2*J),(H===M.LineType.LINE||0<=v)&&A.push(g.scaleAndAdd(x.create(),C,P,v)),J=(-G-z)/(2*J),(H===M.LineType.LINE||0<=J)&&A.push(g.scaleAndAdd(x.create(),C,P,J)));return A};a.intersectLineLikes=e;a.intersectVerticalCylinderAndPoint=function(C,P,H){return b.floatEqualAbsolute(d.squaredDistance(H,
C),P*P,1E-6)?[x.clone(H)]:[]};a.intersectVerticalCylinders=function(C,P,H,J){const [z,A]=C,[v,G]=H;var O=v-z,U=G-A;const ca=O*O+U*U,X=Math.sqrt(ca);if(X>P+J||X<Math.abs(P-J)||q(X,0)&&q(P,J))return[];J=(P*P-J*J+ca)/(2*X);P=Math.sqrt(P*P-J*J);U=P*U/X;O=P*O/X;const [da,ha]=d.lerp(h,C,H,J/X);return q(U,O)?[m.fromValues(da,ha)]:[m.fromValues(da+U,ha-O),m.fromValues(da-U,ha+O)]};a.intersectVerticalPlaneAndLineLike=function(C,P){const H=C.start,J=d.subtract(L,C.end,H);var z=g.set(K,-J[1],J[0],0);const A=
P.start,v=g.sub(F,P.end,A);var G=g.dot(v,z),O=g.set(y,H[0],H[1],0);O=g.sub(p,O,A);z=g.dot(O,z);if(1E-6>Math.abs(G))return[];G=g.scaleAndAdd(I,A,v,z/G);return P.type===M.LineType.RAY&&(P=g.sub(R,G,A),-1E-6>g.dot(P,v))||C.type===a.VerticalPlaneType.HALF_PLANE&&(C=d.sub(R,G,H),-1E-6>d.dot(C,J))?[]:[x.clone(G)]};a.intersectVerticalPlaneAndPoint=function(C,P){return f(l(E,P[2],C),P)};a.intersectVerticalPlaneAndVerticalCylinder=function({start:C,end:P,type:H},J,z){const A=[];P=d.subtract(L,P,C);var v=d.subtract(K,
C,J);J=d.squaredLength(P);const G=2*d.dot(P,v);z=d.squaredLength(v)-z*z;z=G*G-4*J*z;0===z?(J=-G/(2*J),(H===a.VerticalPlaneType.PLANE||0<=J)&&A.push(d.scaleAndAdd(m.create(),C,P,J))):0<z&&(z=Math.sqrt(z),v=(-G+z)/(2*J),(H===a.VerticalPlaneType.PLANE||0<=v)&&A.push(d.scaleAndAdd(m.create(),C,P,v)),J=(-G-z)/(2*J),(H===a.VerticalPlaneType.PLANE||0<=J)&&A.push(d.scaleAndAdd(m.create(),C,P,J)));return A};a.intersectVerticalPlanes=function(C,P){C=l(E,0,C);P=l(N,0,P);P=e(C,P);C=[];for(const H of P)C.push(m.clone(H));
return C};a.isClose=q;a.isPointInsidePlane=r;a.pointToLineLikeDistance=w;a.pointToVerticalCylinderDistance=function(C,P,H){return d.distance(C,P)-H};a.pointToVerticalPlaneDistance=function(C,P){return w(l(E,C[2],P),C)};a.pointsInsidePlane=function(C,P){return P.filter(H=>r(C,H))};a.projectPointToLineLike=k;a.projectPointToVerticalCylinder=function(C,P,H){const J=d.subtract(L,C,P);H/=d.length(J);P=d.scaleAndAdd(x.create(),P,J,H);P[2]=C[2];return P};a.projectPointToVerticalPlane=function(C,P){return k(C,
l(E,C[2],P))};a.vectorsHaveCloseZ=function(C,P){return q(C[2],P[2])};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/geometry2dUtils":function(){define(["exports","../../core/mathUtils","../../chunks/vec2","../../chunks/vec2f64"],function(a,b,d,m){function g(f,l){return f[0]*l[1]-f[1]*l[0]}function x(f,l,q){l=d.dot(q,l)/d.squaredLength(q);return d.scale(f,q,l)}function n(f,l,q,r,c=q){d.subtract(M,r,q);d.subtract(w,l,c);x(e,w,M);return d.add(f,c,e)}function B(f,
l,q,r){d.subtract(M,l,q);l=r/d.length(M);return d.scaleAndAdd(f,q,M,l)}a.LineType=void 0;(function(f){f[f.RAY=0]="RAY";f[f.LINE=1]="LINE"})(a.LineType||(a.LineType={}));const M=m.create(),k=m.create(),w=m.create(),e=m.create();a.cross=g;a.intersectCircleAndPoint=function(f,l,q){B(w,q,f,l);return b.floatEqualAbsolute(w[0],q[0])&&b.floatEqualAbsolute(w[1],q[1])?[m.clone(q)]:[]};a.intersectLineAndPoint=function(f,l){n(w,l,f.start,f.end);return b.floatEqualAbsolute(w[0],l[0])&&b.floatEqualAbsolute(w[1],
l[1])?[m.clone(l)]:[]};a.intersectLineAndRay=function(f,l){const q=f.start;var r=l.start,c=l.end;const t=d.subtract(M,f.end,q);var h=d.subtract(k,c,r);c=g(t,h);if(1E-6>=Math.abs(c))return[];r=d.subtract(w,q,r);h=g(h,r)/c;c=g(t,r)/c;if(0<=h){if(0<=c||l.type===a.LineType.LINE)return[d.scaleAndAdd(e,q,t,h)]}else if(f.type===a.LineType.LINE&&(0<=c||l.type===a.LineType.LINE))return[d.scaleAndAdd(e,q,t,h)];return[]};a.intersectLineLikeAndCircle=function(f,l,q){const r=[],c=d.subtract(M,f.end,f.start);var t=
d.subtract(k,f.start,l);l=d.squaredLength(c);const h=2*d.dot(c,t);q=d.squaredLength(t)-q*q;q=h*h-4*l*q;0===q?(l=-h/(2*l),(f.type===a.LineType.LINE||0<=l)&&r.push(d.scaleAndAdd(e,f.start,c,l))):0<q&&(q=Math.sqrt(q),t=(-h+q)/(2*l),(f.type===a.LineType.LINE||0<=t)&&r.push(d.scaleAndAdd(e,f.start,c,t)),l=(-h-q)/(2*l),(f.type===a.LineType.LINE||0<=l)&&r.push(d.scaleAndAdd(w,f.start,c,l)));return r};a.pointToLineDistance=function(f,l,q){return Math.abs((l[0]-f[0])*(q[1]-f[1])-(l[1]-f[1])*(q[0]-f[0]))/d.distance(l,
q)};a.projectPoint=x;a.projectPointToCircle=B;a.projectPointToLine=n;a.projectPointToRay=function(f,l,q,r){d.subtract(M,r,q);d.subtract(w,l,q);l=d.dot(M,w)/d.squaredLength(M);return 0<l?d.scaleAndAdd(f,q,M,l):d.copy(f,q)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/FeatureSnappingSourceInfo":function(){define("exports ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Logger ../../../core/reactiveUtils ../../../core/sql ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../layers/support/FeatureFilter ../../../layers/support/floorFilterUtils ../../../layers/support/layerUtils ./snappingUtils".split(" "),
function(a,b,d,m,g,x,n,B,M,k,w,e,f,l,q){function r(c,t){return null==c?new e({where:t}):c.where?new e({where:x.sqlAnd(c.where,t)}):new e({where:t})}a.FeatureSnappingSourceInfo=class extends d{get layerView(){return this.view?.allLayerViews?.find(c=>c.layer===this.layer)}get valid(){return this._valid}get subtypeFilter(){const {layer:c}=this;if(!l.isSubtypeGroupLayer(c)||!c.subtypes?.length)return{mode:"not-in-use",filter:null};const t=c.fieldsIndex.get(c.subtypeField)?.name??c.subtypeField,h=c.sublayers.filter(u=>
u.visible).map(u=>u.subtypeCode);return h.length?h.length===c.subtypes.length?{mode:"all-visible",filter:null}:1===h.length?{mode:"in-use",filter:`${t} = ${h.getItemAt(0)}`}:{mode:"in-use",filter:`${t} IN (${h.join(", ")})`}:{mode:"none-visible",filter:null}}get floorFilter(){const {view:c,layer:t}=this;return c&&t?f.getFloorFilterClause({view:c,layer:t}):null}constructor(c){super(c);this.rulesTable=null;this._valid=!1}initialize(){if(this.snappingSource&&this.layer){var {layer:c,snappingSource:t}=
this;"refresh"in c&&this.addHandles(c.on("refresh",()=>t.refresh()));this.loadRules();this.addHandles([g.watch(()=>t.updating,h=>t.layerSource.updating=h,g.syncAndInitial),g.watch(()=>t.availability,h=>t.layerSource.availability=h,g.syncAndInitial)])}}getFetchCandidatesParameters(c,t,h){if(!this.valid)return[];const {layer:u,layerView:L,floorFilter:K,rulesTable:F,subtypeFilter:y}=this;c={distance:h,mode:this.view?.type??"2d",point:c,coordinateHelper:t.coordinateHelper,...this._types,filter:L&&"filter"in
L?L.filter:null};K&&(c.filter=r(c.filter,K));if("not-in-use"!==y.mode&&"all-visible"!==y.mode){if("none-visible"===y.mode)return[];c.filter?c.filter.where=x.sqlAnd(c.filter.where,y.mode):c.filter=new e({where:y.filter})}if(F){h=t.feature;var p=h?.sourceLayer;if(!(h&&l.isFeatureLayer(u)&&u.layerId&&l.isFeatureLayer(p))||"loaded"!==F.loadStatus)return[];t=[];const I=u.layerId;p=F.getFeatureSQL(p,h)?.[I];if(!p)return[];h=p.anyVertex;(p=p.endVertex)&&h&&p===h&&(p="");p&&t.push({...c,returnEdge:!1,vertexMode:"ends",
filter:r(c.filter,p)});h&&t.push({...c,returnEdge:!1,vertexMode:"all",filter:r(c.filter,h)});return t}return[c]}async loadRules(){const {layer:c,view:t}=this;if(c&&t&&q.isUtilityNetworkWebMap(t?.map)&&l.isFeatureLayer(c)){const h=t.map.utilityNetworks?.find(u=>u.isUtilityLayer(c));if(h)try{this.rulesTable=await h.getRulesTable(),await this.rulesTable?.load(),this._valid=!0}catch(u){m.getLogger("esri.views.interactive.snapping.FeatureSnappingSourceInfo").error("Failed to load rules table for snapping source",
c.title)}}else this._valid=!0}get _types(){return{returnEdge:!0,vertexMode:"all"}}remove(){this.destroy()}destroy(){this.snappingSource?.destroy()}};b.__decorate([n.property({constructOnly:!0})],a.FeatureSnappingSourceInfo.prototype,"layer",void 0);b.__decorate([n.property({constructOnly:!0})],a.FeatureSnappingSourceInfo.prototype,"snappingSource",void 0);b.__decorate([n.property({constructOnly:!0})],a.FeatureSnappingSourceInfo.prototype,"view",void 0);b.__decorate([n.property()],a.FeatureSnappingSourceInfo.prototype,
"layerView",null);b.__decorate([n.property()],a.FeatureSnappingSourceInfo.prototype,"rulesTable",void 0);b.__decorate([n.property()],a.FeatureSnappingSourceInfo.prototype,"valid",null);b.__decorate([n.property()],a.FeatureSnappingSourceInfo.prototype,"subtypeFilter",null);b.__decorate([n.property()],a.FeatureSnappingSourceInfo.prototype,"floorFilter",null);b.__decorate([n.property()],a.FeatureSnappingSourceInfo.prototype,"_valid",void 0);a.FeatureSnappingSourceInfo=b.__decorate([w.subclass("esri.views.interactive.snapping.FeatureSnappingSourceInfo")],
a.FeatureSnappingSourceInfo);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/floorFilterUtils":function(){define(["exports"],function(a){function b(d,m){if(!d?.length)return null;d=d.filter(g=>""!==g).map(g=>`'${g}'`);d.push("''");return`${m} IN (${d.join(",")}) OR ${m} IS NULL`}a.getFloorFilterClause=function(d){const m=d.layer;return"floorInfo"in m&&m.floorInfo?.floorField&&"floors"in d.view?b(d.view.floors,m.floorInfo.floorField):null};a.getLayerFloorFilterClause=
function(d,m){return"floorInfo"in m&&m.floorInfo?.floorField?b(d,m.floorInfo.floorField):null};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/snappingUtils":function(){define("exports ../../../core/reactiveUtils ../../../core/SetUtils ../../../core/sql ../../../core/timeUtils ../../../chunks/vec3 ../../../layers/graphics/dehydratedPoint ../../../rest/support/Query ../../input/InputManager ../keybindings ../sketch/normalizedPoint".split(" "),function(a,
b,d,m,g,x,n,B,M,k,w){function e(f,l){const q=f.x-l.x;f=f.y-l.y;return q*q+f*f}a.LineSegmentHintType=void 0;(function(f){f[f.TARGET=0]="TARGET";f[f.REFERENCE=1]="REFERENCE";f[f.REFERENCE_EXTENSION=2]="REFERENCE_EXTENSION"})(a.LineSegmentHintType||(a.LineSegmentHintType={}));a.editEdgeToSnappingEdge=function(f,l,q){return{left:w.fromAnyMapPoint(f.leftVertex.pos,l,q),right:w.fromAnyMapPoint(f.rightVertex.pos,l,q)}};a.isUtilityNetworkWebMap=function(f){return null!=f&&"object"===typeof f&&"declaredClass"in
f&&"esri.WebMap"===f.declaredClass&&"utilityNetworks"in f&&!!f?.utilityNetworks?.length};a.makeFilter=function(f){return f.createQuery()};a.makeSnappingQuery=function({point:f,distance:l,returnEdge:q,vertexMode:r,coordinateHelper:{spatialReference:c},filter:t},h,u){u=null!=u?u.clone():new B({where:"1\x3d1"});if(t){u.geometry=t.geometry;u.distance=t.distance;u.spatialRelationship=t.spatialRelationship;u.where=m.sqlAnd(u.where,t.where);u.timeExtent=g.mergeTimeExtents(u.timeExtent,t.timeExtent);var L=
u;var K=u.objectIds;t=t.objectIds;K=K||t?t?K?Array.from(d.intersection(new Set(K),new Set(t))):t:K:null;L.objectIds=K}return{point:n.makeDehydratedPoint(f[0],f[1],f[2],c.toJSON()),mode:h,distance:l,returnEdge:q,vertexMode:r,query:u.toJSON()}};a.objectEqual=function(f,l){const q=f.length===l.length&&f[0]===l[0]&&f[1]===l[1];switch(f.length){case 2:return q;case 3:return q&&f[2]===l[2];case 4:return q&&f[2]===l[2]&&f[3]===l[3]}return!1};a.screenDistance=function(f,l){return Math.sqrt(e(f,l))};a.setupSnappingToggleHandles=
function(f,l=()=>{}){const q=b.watch(()=>({view:f.view,snappingOptions:f.snappingOptions}),({view:r,snappingOptions:c})=>{const t=M.ViewEventPriorities.TOOL;f.removeHandles("snapping-toggle");r&&null!=c&&(r=[r.on("key-down",h=>{h.key!==k.snappingKeys.toggle||h.repeat||(c.enabledToggled=!0,l())},t),r.on("key-up",h=>{h.key===k.snappingKeys.toggle&&(c.enabledToggled=!1,l())},t),r.on("pointer-move",h=>{h=h.native.ctrlKey;c.enabledToggled!==h&&(c.enabledToggled=h,l())},t)],f.addHandles(r,"snapping-toggle"))},
b.syncAndInitial);f.addHandles(q)};a.sortCandidatesInPlace=function(f,l){l.sort((q,r)=>{q=x.squaredDistance(q.targetPoint,f);r=x.squaredDistance(r.targetPoint,f);return q-r})};a.squaredScreenDistance=e;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/DrapedEdgeSnappingCandidate":function(){define(["exports","../../sketch/constraints","../snappingUtils","./FeatureSnappingCandidate","../hints/LineSnappingHint"],function(a,b,d,m,g){class x extends m.FeatureSnappingCandidate{constructor(n){super({...n,
isDraped:!0,constraint:new b.DrapedLineConstraint(n.edgeStart,n.edgeEnd,n.getGroundElevation)})}get hints(){return[new g.LineSnappingHint(d.LineSegmentHintType.REFERENCE,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}}a.DrapedEdgeSnappingCandidate=x;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/FeatureSnappingCandidate":function(){define(["exports","../SnappingDomain","./SnappingCandidate"],function(a,b,d){class m extends d.SnappingCandidate{constructor({targetPoint:g,
objectId:x,constraint:n,isDraped:B}){super(g,n,B,b.SnappingDomain.FEATURE);this.objectId=x}}a.FeatureSnappingCandidate=m;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/SnappingCandidate":function(){define(["exports"],function(a){class b{constructor(d,m,g,x){this.targetPoint=d;this.constraint=m;this.isDraped=g;this.domain=x}}a.SnappingCandidate=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/LineSnappingHint":function(){define("exports ../../../../core/has ../../../../core/Logger ../../../../chunks/vec3 ../SnappingDomain ./SnappingHint".split(" "),
function(a,b,d,m,g,x){class n extends x.SnappingHint{constructor(B,M,k,w,e=g.SnappingDomain.ALL,f=!0,l=!0){super(w,e);this.type=B;this.lineStart=M;this.lineEnd=k;this.fadeLeft=f;this.fadeRight=l}equals(B){return B instanceof n?this.type===B.type&&m.exactEquals(this.lineStart,B.lineStart)&&m.exactEquals(this.lineEnd,B.lineEnd)&&this.fadeLeft===B.fadeLeft&&this.fadeRight===B.fadeRight:!1}get length(){return m.distance(this.lineStart,this.lineEnd)}}a.LineSnappingHint=n;Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/views/interactive/snapping/hints/SnappingHint":function(){define(["exports"],function(a){class b{constructor(d,m){this.isDraped=d;this.domain=m}}a.SnappingHint=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/EdgeSnappingCandidate":function(){define(["exports","../../sketch/constraints","../snappingUtils","./FeatureSnappingCandidate","../hints/LineSnappingHint"],function(a,b,d,m,g){class x extends m.FeatureSnappingCandidate{constructor(n){super({...n,
constraint:new b.LineConstraint(n.edgeStart,n.edgeEnd)})}get hints(){return[new g.LineSnappingHint(d.LineSegmentHintType.REFERENCE,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}}a.EdgeSnappingCandidate=x;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/RightAngleSnappingCandidate":function(){define("exports ../SnappingDomain ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint ../hints/RightAngleSnappingHint".split(" "),
function(a,b,d,m,g,x){class n extends m.SnappingCandidate{constructor({targetPoint:B,constraint:M,previousVertex:k,otherVertex:w,otherVertexType:e,objectId:f,isDraped:l}){super(B,M,l,b.SnappingDomain.SELF);this.previousVertex=k;this.otherVertex=w;this.otherVertexType=e;this.objectId=f}get hints(){const B=this.previousVertex,M=this.otherVertexType===a.OtherVertexType.CENTER?this.otherVertex:this.targetPoint,k=this.otherVertexType===a.OtherVertexType.CENTER?this.targetPoint:this.otherVertex;return[new g.LineSnappingHint(d.LineSegmentHintType.TARGET,
M,k,this.isDraped,this.domain),new g.LineSnappingHint(d.LineSegmentHintType.REFERENCE,B,M,this.isDraped,this.domain),new x.RightAngleSnappingHint(this.previousVertex,M,k,this.isDraped,this.domain)]}}a.OtherVertexType=void 0;(function(B){B[B.NEXT=0]="NEXT";B[B.CENTER=1]="CENTER"})(a.OtherVertexType||(a.OtherVertexType={}));a.RightAngleSnappingCandidate=n;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/RightAngleSnappingHint":function(){define("exports ../../../../core/has ../../../../core/Logger ../../../../chunks/vec3 ../SnappingDomain ./SnappingHint".split(" "),
function(a,b,d,m,g,x){class n extends x.SnappingHint{constructor(B,M,k,w,e=g.SnappingDomain.ALL){super(w,e);this.previousVertex=B;this.centerVertex=M;this.nextVertex=k}equals(B){return B instanceof n?m.exactEquals(this.previousVertex,B.previousVertex)&&m.exactEquals(this.centerVertex,B.centerVertex)&&m.exactEquals(this.nextVertex,B.nextVertex):!1}}a.RightAngleSnappingHint=n;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/support/viewUtils":function(){define("exports ../../../core/screenUtils ../../../chunks/vec2 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../layers/graphics/dehydratedPoint ../../../support/elevationInfoUtils".split(" "),
function(a,b,d,m,g,x,n){function B(r,c,t,h,u=g.create()){r=c.toXYZ(r);r[2]=n.getConvertedElevationFromVector(h,r,c.spatialReference,t)||0;h.renderCoordsHelper.toRenderCoords(r,c.spatialReference,u);return u}function M(r,c,t,h,u=g.create()){r=m.copy(e,r);r[2]=n.getConvertedElevationFromVector(h,r,c,t)||0;h.renderCoordsHelper.toRenderCoords(r,c,u);return u}function k(r,c,t,h){if("2d"===h.type)return w.x=r[0],w.y=r[1],w.spatialReference=c,h.toScreen(w);M(r,c,t,h,e);h.state.camera.projectToScreen(e,q);
return b.createScreenPoint(q[0],q[1])}const w=x.makeDehydratedPoint(0,0,0,null),e=g.create(),f=b.createRenderScreenPointArray3(),l=b.createRenderScreenPointArray3(),q=b.createScreenPointArray();a.anyMapPointToRender=B;a.anyMapPointToScreenPoint=function(r,c,t,h){return k(c.toXYZ(r),c.spatialReference,t,h)};a.anyMapPointsToRenderWithEqualRelativeZ=function(r,c,t,h,u,L,K){if("absolute-height"===h.mode)B(r,t,h,u,L),B(c,t,h,u,K);else{r=t.toXYZ(r);c=t.toXYZ(c);var F=n.getConvertedElevationFromVector(u,
r,t.spatialReference,h);h=n.getConvertedElevationFromVector(u,c,t.spatialReference,h);h=(null==F?h:null==h?F:Math.min(F,h))||0;r[2]=h;c[2]=h;u.renderCoordsHelper.toRenderCoords(r,t.spatialReference,L);u.renderCoordsHelper.toRenderCoords(c,t.spatialReference,K)}};a.renderScreenSpaceTangent=function(r,c,t,h){t.projectToRenderScreen(r,f);t.projectToRenderScreen(c,l);d.subtract(h,l,f);d.normalize(h,h)};a.vectorToRender=M;a.vectorToScreenPoint=k;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/views/interactive/snapping/SelfSnappingEngine":function(){define("exports ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Collection ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./LineSnapper ./ParallelLineSnapper ./RightAngleSnapper ./RightAngleTriangleSnapper ./SnappingDomain ./snappingUtils".split(" "),function(a,b,d,m,g,x,n,B,M,k,w,e,f,
l,q){a.SelfSnappingEngine=class extends d{constructor(r){super(r);this.updating=!1;this._snappers=new m;this._domain=l.SnappingDomain.SELF}initialize(){this._snappers.push(new w.ParallelLineSnapper(this.view,this.options),new k.LineSnapper(this.view,this.options),new e.RightAngleSnapper(this.view,this.options),new f.RightAngleTriangleSnapper(this.view,this.options))}set options(r){this._set("options",r);for(const c of this._snappers)c.options=r}async fetchCandidates(r,c,t){if(!(c&this._domain&&this.options.effectiveSelfEnabled))return[];
c=[];for(const h of this._snappers.items)for(const u of h.snap(r,t))c.push(u);q.sortCandidatesInPlace(r,c);return c}};b.__decorate([g.property({readOnly:!0})],a.SelfSnappingEngine.prototype,"updating",void 0);b.__decorate([g.property({constructOnly:!0})],a.SelfSnappingEngine.prototype,"view",void 0);b.__decorate([g.property()],a.SelfSnappingEngine.prototype,"options",null);a.SelfSnappingEngine=b.__decorate([M.subclass("esri.views.interactive.snapping.SelfSnappingEngine")],a.SelfSnappingEngine);Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/LineSnapper":function(){define("exports ../../../support/elevationInfoUtils ../sketch/normalizedPoint ./SnappingAlgorithm ./snappingUtils ./candidates/LineSnappingCandidate ../support/viewUtils ../../support/geometry3dUtils ../../support/geometry2dUtils".split(" "),function(a,b,d,m,g,x,n,B,M){class k extends m.SnappingAlgorithm{snapNewVertex(w,e){var f=e.editGeometryOperations.data.components[0],l=f.edges.length;const q=[];if(1>
l)return q;var {spatialReference:r}=e;r=n.vectorToScreenPoint(w,r,b.absoluteHeightElevationInfo,this.view);const {view:c}=this;l=f=f.edges[l-1];do{if(this.edgeExceedsShortLineThreshold(l,e)){const t=g.editEdgeToSnappingEdge(l,c,e);this._processCandidateProposal(t.left,t.right,w,r,e,q)}l=l.leftVertex.leftEdge}while(l&&l!==f);return q}snapExistingVertex(w,e){const f=[],l=e.vertexHandle;var q=l.component;if(2>q.edges.length)return f;const {view:r}=this;var {spatialReference:c}=e;c=n.vectorToScreenPoint(w,
c,b.absoluteHeightElevationInfo,r);var t=l.leftEdge,h=l.rightEdge;t&&h&&this.edgeExceedsShortLineThreshold(t,e)&&this.edgeExceedsShortLineThreshold(h,e)&&this._processCandidateProposal(d.fromAnyMapPoint(t.leftVertex.pos,r,e),d.fromAnyMapPoint(h.rightVertex.pos,r,e),w,c,e,f);t=q=q.edges[0];do t!==l.leftEdge&&t!==l.rightEdge&&this.edgeExceedsShortLineThreshold(t,e)&&(h=g.editEdgeToSnappingEdge(t,r,e),this._processCandidateProposal(h.left,h.right,w,c,e,f)),t=t.rightVertex.rightEdge;while(t&&t!==q);return f}_processCandidateProposal(w,
e,f,l,q,r){const {spatialReference:c,pointer:t}=q;f=d.fromVec3(B.projectPointToLineLike(f,{start:w,end:e,type:M.LineType.LINE}));g.squaredScreenDistance(l,n.vectorToScreenPoint(f,c,b.absoluteHeightElevationInfo,this.view))<this.squaredProximityThreshold(t)&&r.push(new x.LineSnappingCandidate({lineStart:w,lineEnd:e,targetPoint:f,isDraped:"on-the-ground"===q.elevationInfo?.mode}))}}a.LineSnapper=k;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingAlgorithm":function(){define("exports ../../../chunks/vec2 ../../../support/elevationInfoUtils ../sketch/normalizedPoint ./Settings ./snappingUtils ../support/viewUtils".split(" "),
function(a,b,d,m,g,x,n){class B{constructor(M,k){this.view=M;this.options=k;this.squaredShortLineThreshold=g.defaults.shortLineThreshold*g.defaults.shortLineThreshold}snap(M,k){return null!=k.vertexHandle?"vertex"!==k.vertexHandle.type?[]:this.snapExistingVertex(M,k):this.snapNewVertex(M,k)}edgeExceedsShortLineThreshold(M,k){return this.exceedsShortLineThreshold(m.fromAnyMapPoint(M.leftVertex.pos,this.view,k),m.fromAnyMapPoint(M.rightVertex.pos,this.view,k),k)}exceedsShortLineThreshold(M,k,{spatialReference:w}){return 0===
this.squaredShortLineThreshold||x.squaredScreenDistance(n.vectorToScreenPoint(k,w,d.absoluteHeightElevationInfo,this.view),n.vectorToScreenPoint(M,w,d.absoluteHeightElevationInfo,this.view))>this.squaredShortLineThreshold}isVertical(M,k){return b.squaredDistance(M,k)<g.defaults.verticalLineThreshold}squaredProximityThreshold(M){return"touch"===M?this._squaredTouchProximityThreshold:this._squaredMouseProximityThreshold}get _squaredMouseProximityThreshold(){return this.options.distance*this.options.distance}get _squaredTouchProximityThreshold(){const {distance:M,
touchSensitivityMultiplier:k}=this.options,w=M*k;return w*w}}a.SnappingAlgorithm=B;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/LineSnappingCandidate":function(){define("exports ../../sketch/constraints ../SnappingDomain ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint".split(" "),function(a,b,d,m,g,x){class n extends g.SnappingCandidate{constructor({lineStart:B,lineEnd:M,targetPoint:k,isDraped:w}){super(k,new b.VerticalPlaneConstraint(B,
M),w,d.SnappingDomain.SELF);this._referenceLineHint=new x.LineSnappingHint(m.LineSegmentHintType.REFERENCE_EXTENSION,B,M,w,this.domain)}get hints(){return[this._referenceLineHint,new x.LineSnappingHint(m.LineSegmentHintType.TARGET,this._lineEndClosestToTarget(),this.targetPoint,this.isDraped,this.domain)]}_lineEndClosestToTarget(){return this.constraint.closestEndTo(this.targetPoint)}}a.LineSnappingCandidate=n;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/ParallelLineSnapper":function(){define("exports ../../../chunks/vec2 ../../../chunks/vec2f64 ../../../support/elevationInfoUtils ../sketch/normalizedPoint ./Settings ./SnappingAlgorithm ./snappingUtils ./candidates/ParallelLineSnappingCandidate ../support/viewUtils ../../support/geometry2dUtils".split(" "),
function(a,b,d,m,g,x,n,B,M,k,w){class e extends n.SnappingAlgorithm{snapNewVertex(l,q){var r=q.editGeometryOperations.data.components[0],c=r.edges.length,t=r.vertices.length;const h=[];if(2>c)return h;const {view:u}=this,L=k.vectorToScreenPoint(l,q.spatialReference,m.absoluteHeightElevationInfo,u);t=g.fromAnyMapPoint(r.vertices[t-1].pos,u,q);const K=g.fromAnyMapPoint(r.vertices[0].pos,u,q);c=r=r.edges[c-1];do{if(this.edgeExceedsShortLineThreshold(c,q)){const F=B.editEdgeToSnappingEdge(c,u,q);this._checkEdgeForParallelLines(F,
t,l,L,q,h);this._checkEdgeForParallelLines(F,K,l,L,q,h)}c=c.leftVertex.leftEdge}while(c&&c!==r);return h}snapExistingVertex(l,q){const r=[],c=q.vertexHandle;var t=c.component;if(3>t.edges.length)return r;const {view:h}=this,u=k.vectorToScreenPoint(l,q.spatialReference,m.absoluteHeightElevationInfo,h),L=c.leftEdge,K=c.rightEdge,F=t.vertices[0],y=g.fromAnyMapPoint(F.pos,h,q),p=t.vertices[t.vertices.length-1],I=g.fromAnyMapPoint(p.pos,h,q);let R=t=t.edges[0];do{if(R!==L&&R!==K&&this.edgeExceedsShortLineThreshold(R,
q)){const D=B.editEdgeToSnappingEdge(R,h,q);L&&this._checkEdgeForParallelLines(D,g.fromAnyMapPoint(L.leftVertex.pos,h,q),l,u,q,r);K&&this._checkEdgeForParallelLines(D,g.fromAnyMapPoint(K.rightVertex.pos,h,q),l,u,q,r);c===F?this._checkEdgeForParallelLines(D,I,l,u,q,r):c===p&&this._checkEdgeForParallelLines(D,y,l,u,q,r)}R=R.rightVertex.rightEdge}while(R&&R!==t);return r}_checkEdgeForParallelLines(l,q,r,c,t,h){const u=l.left,L=l.right;w.projectPointToLine(f,q,u,L);if(!(b.squaredDistance(f,q)<x.defaults.parallelLineThreshold)){w.projectPointToLine(f,
r,u,L,q);var {spatialReference:K,pointer:F}=t;r=g.fromValues(f[0],f[1],r[2]);B.squaredScreenDistance(c,k.vectorToScreenPoint(r,K,m.absoluteHeightElevationInfo,this.view))<this.squaredProximityThreshold(F)&&!(this.isVertical(r,q)||this.isVertical(u,L)||this._parallelToPreviousCandidate(l,h))&&h.push(new M.ParallelLineSnappingCandidate({referenceLine:l,lineStart:q,targetPoint:r,isDraped:"on-the-ground"===t.elevationInfo?.mode}))}}_parallelToPreviousCandidate(l,q){const r=l.left,c=l.right;for(const t of q)if(w.projectPointToLine(f,
c,t.constraint.start,t.constraint.end,r),b.squaredDistance(f,c)<x.defaults.parallelLineThreshold)return t.addReferenceLine(l),!0;return!1}}const f=d.create();a.ParallelLineSnapper=e;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/ParallelLineSnappingCandidate":function(){define("exports ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../sketch/constraints ../../sketch/normalizedPoint ../SnappingDomain ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint ../hints/ParallelSnappingHint".split(" "),
function(a,b,d,m,g,x,n,B,M,k){class w extends B.SnappingCandidate{constructor({referenceLine:e,lineStart:f,targetPoint:l,isDraped:q}){const r=d.clone(f),{left:c,right:t}=e;b.subtract(r,b.add(r,r,t),c);super(l,new m.VerticalPlaneConstraint(f,g.fromVec3(r)),q,x.SnappingDomain.SELF);this._referenceLines=[{edge:e,fadeLeft:!0,fadeRight:!0}]}get hints(){return[new M.LineSnappingHint(n.LineSegmentHintType.TARGET,this.constraint.start,this.targetPoint,this.isDraped,this.domain),new k.ParallelSnappingHint(this.constraint.start,
this.targetPoint,this.isDraped,this.domain),...this._referenceLines.map(e=>new M.LineSnappingHint(n.LineSegmentHintType.REFERENCE,e.edge.left,e.edge.right,this.isDraped,this.domain,e.fadeLeft,e.fadeRight))]}addReferenceLine(e){const f={edge:e,fadeLeft:!0,fadeRight:!0};this._referenceLines.forEach(l=>{b.exactEquals(e.right,l.edge.left)&&(l.fadeLeft=!1,f.fadeRight=!1);b.exactEquals(e.right,l.edge.right)&&(l.fadeRight=!1,f.fadeRight=!1);b.exactEquals(e.left,l.edge.right)&&(l.fadeRight=!1,f.fadeLeft=
!1);b.exactEquals(e.left,l.edge.left)&&(l.fadeLeft=!1,f.fadeLeft=!1)});this._referenceLines.push(f)}}a.ParallelLineSnappingCandidate=w;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/ParallelSnappingHint":function(){define("exports ../../../../core/has ../../../../core/Logger ../../../../chunks/vec3 ../SnappingDomain ./SnappingHint".split(" "),function(a,b,d,m,g,x){class n extends x.SnappingHint{constructor(B,M,k,w=g.SnappingDomain.ALL){super(k,
w);this.lineStart=B;this.lineEnd=M}equals(B){return B instanceof n?m.exactEquals(this.lineStart,B.lineStart)&&m.exactEquals(this.lineEnd,B.lineEnd):!1}}a.ParallelSnappingHint=n;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/RightAngleSnapper":function(){define("exports ../../../chunks/vec2 ../../../chunks/vec2f64 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../support/elevationInfoUtils ../sketch/constraints ../sketch/normalizedPoint ./SnappingAlgorithm ./snappingUtils ./candidates/RightAngleSnappingCandidate ../support/viewUtils".split(" "),
function(a,b,d,m,g,x,n,B,M,k,w,e){class f extends M.SnappingAlgorithm{snapNewVertex(r,c){var t=c.editGeometryOperations.data.components[0],h=t.vertices.length;const u=[];if(2>h)return u;var {view:L}=this;const K=e.vectorToScreenPoint(r,c.spatialReference,x.absoluteHeightElevationInfo,L);var F=t.vertices[h-1];this.edgeExceedsShortLineThreshold(F.leftEdge,c)&&(h=B.fromAnyMapPoint(F.pos,L,c),F=B.fromAnyMapPoint(F.leftEdge.leftVertex.pos,L,c),this._checkForSnappingCandidate(u,F,h,r,K,c));h=t.vertices[0];
this.edgeExceedsShortLineThreshold(h.rightEdge,c)&&(t=B.fromAnyMapPoint(h.pos,L,c),L=B.fromAnyMapPoint(h.rightEdge.rightVertex.pos,L,c),this._checkForSnappingCandidate(u,L,t,r,K,c));return u}snapExistingVertex(r,c){const t=[];var h=c.vertexHandle;if(3>h.component.vertices.length)return t;var {view:u}=this;const L=e.vectorToScreenPoint(r,c.spatialReference,x.absoluteHeightElevationInfo,u);var K=h.leftEdge;h=h.rightEdge;if(K?.leftVertex.leftEdge){var F=K.leftVertex.leftEdge;this.edgeExceedsShortLineThreshold(F,
c)&&(K=B.fromAnyMapPoint(F.rightVertex.pos,u,c),F=B.fromAnyMapPoint(F.leftVertex.pos,u,c),this._checkForSnappingCandidate(t,F,K,r,L,c))}h?.rightVertex.rightEdge&&(K=h.rightVertex.rightEdge,this.edgeExceedsShortLineThreshold(K,c)&&(h=B.fromAnyMapPoint(K.leftVertex.pos,u,c),u=B.fromAnyMapPoint(K.rightVertex.pos,u,c),this._checkForSnappingCandidate(t,u,h,r,L,c)));return t}_checkForSnappingCandidate(r,c,t,h,u,L){const {spatialReference:K,pointer:F}=L;b.subtract(l,t,c);const y=m.set(q,l[1],-l[0],0),p=
b.dot(y,b.subtract(l,h,t))/b.squaredLength(y);h=B.fromVec3(b.scaleAndAdd(g.clone(h),t,y,p));k.squaredScreenDistance(u,e.vectorToScreenPoint(h,K,x.absoluteHeightElevationInfo,this.view))<this.squaredProximityThreshold(F)&&!this.isVertical(h,t)&&!this.isVertical(t,c)&&(u=m.scaleAndAdd(g.create(),t,y,Math.sign(p)),r.push(new w.RightAngleSnappingCandidate({targetPoint:h,constraint:new n.VerticalHalfPlaneConstraint(t,B.fromVec3(u)),previousVertex:c,otherVertex:t,otherVertexType:w.OtherVertexType.CENTER,
isDraped:"on-the-ground"===L.elevationInfo?.mode})))}}const l=d.create(),q=g.create();a.RightAngleSnapper=f;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/RightAngleTriangleSnapper":function(){define("exports ../../../chunks/vec2 ../../../chunks/vec2f64 ../../../chunks/vec3f64 ../../../support/elevationInfoUtils ../sketch/normalizedPoint ./SnappingAlgorithm ./snappingUtils ./candidates/RightAngleTriangleSnappingCandidate ../support/viewUtils ../../support/geometry2dUtils".split(" "),
function(a,b,d,m,g,x,n,B,M,k,w){class e extends n.SnappingAlgorithm{snapNewVertex(l,q){var r=q.editGeometryOperations.data.components[0];const c=[];var t=r.vertices.length;if("polygon"!==q.editGeometryOperations.data.type||2>t)return c;var {view:h}=this;t=r.vertices[t-1];r=x.fromAnyMapPoint(r.vertices[0].pos,h,q);h=x.fromAnyMapPoint(t.pos,h,q);this._processCandidateProposal(r,h,l,q,c);return c}snapExistingVertex(l,q){const r=[];var c=q.vertexHandle,t=c.component;if(2>t.edges.length||"polyline"===
q.editGeometryOperations.data.type&&(0===c.index||c.index===t.vertices.length-1))return r;const {view:h}=this;t=x.fromAnyMapPoint(c.leftEdge.leftVertex.pos,h,q);c=x.fromAnyMapPoint(c.rightEdge.rightVertex.pos,h,q);this._processCandidateProposal(t,c,l,q,r);return r}_processCandidateProposal(l,q,r,c,t){if(this.exceedsShortLineThreshold(l,q,c)){var h=b.lerp(f,l,q,.5),u=.5*b.distance(l,q),L=m.create();w.projectPointToCircle(L,r,h,u);L[2]=r[2];h=x.fromVec3(L);var {spatialReference:K,pointer:F}=c;r=k.vectorToScreenPoint(r,
K,g.absoluteHeightElevationInfo,this.view);B.squaredScreenDistance(r,k.vectorToScreenPoint(h,K,g.absoluteHeightElevationInfo,this.view))<this.squaredProximityThreshold(F)&&!this.isVertical(l,h)&&!this.isVertical(h,q)&&t.push(new M.RightAngleTriangleSnappingCandidate({targetPoint:h,point1:l,point2:q,isDraped:"on-the-ground"===c.elevationInfo?.mode}))}}}const f=d.create();a.RightAngleTriangleSnapper=e;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/RightAngleTriangleSnappingCandidate":function(){define("exports ../../../../chunks/vec2 ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../sketch/constraints ../../sketch/normalizedPoint ../SnappingDomain ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint ../hints/RightAngleSnappingHint".split(" "),
function(a,b,d,m,g,x,n,B,M,k,w){class e extends M.SnappingCandidate{constructor({targetPoint:f,point1:l,point2:q,isDraped:r}){super(f,new g.VerticalCylinderConstraint(x.fromVec3(d.lerp(m.create(),l,q,.5)),.5*b.distance(l,q)),r,n.SnappingDomain.SELF);this._p1=l;this._p2=q}get hints(){return[new k.LineSnappingHint(B.LineSegmentHintType.REFERENCE,this.targetPoint,this._p1,this.isDraped,this.domain),new k.LineSnappingHint(B.LineSegmentHintType.REFERENCE,this.targetPoint,this._p2,this.isDraped,this.domain),
new w.RightAngleSnappingHint(this._p1,this.targetPoint,this._p2,this.isDraped,this.domain)]}}a.RightAngleTriangleSnappingCandidate=e;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingOptions":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Collection ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./FeatureSnappingLayerSource ./Settings".split(" "),
function(a,b,d,m,g,x,n,B,M,k){b=class extends b{constructor(w){super(w);this.enabledToggled=this.enabled=!1;this.featureEnabled=this.selfEnabled=!0;this.featureSources=new d;this.distance=k.defaults.distance;this.touchSensitivityMultiplier=k.defaults.touchSensitivityMultiplier}get effectiveEnabled(){return this.enabledToggled?!this.enabled:this.enabled}get effectiveSelfEnabled(){return this.effectiveEnabled&&this.selfEnabled}get effectiveFeatureEnabled(){return this.effectiveEnabled&&this.featureEnabled}};
a.__decorate([m.property()],b.prototype,"enabled",void 0);a.__decorate([m.property()],b.prototype,"enabledToggled",void 0);a.__decorate([m.property()],b.prototype,"selfEnabled",void 0);a.__decorate([m.property()],b.prototype,"featureEnabled",void 0);a.__decorate([m.property({type:d.ofType(M)})],b.prototype,"featureSources",void 0);a.__decorate([m.property()],b.prototype,"distance",void 0);a.__decorate([m.property()],b.prototype,"touchSensitivityMultiplier",void 0);a.__decorate([m.property({readOnly:!0})],
b.prototype,"effectiveEnabled",null);a.__decorate([m.property({readOnly:!0})],b.prototype,"effectiveSelfEnabled",null);a.__decorate([m.property({readOnly:!0})],b.prototype,"effectiveFeatureEnabled",null);return b=a.__decorate([B.subclass("esri.views.interactive.snapping.SnappingOptions")],b)})},"esri/views/interactive/snapping/snappingPointUtils":function(){define(["exports","../../../layers/graphics/dehydratedPoint","../../../support/elevationInfoUtils"],function(a,b,d){a.snappingPointToSnappingOutput=
function(m,g,{z:x,m:n,spatialReference:B,elevationInfo:M}){if(null==x&&null==n)return m=b.makeDehydratedPoint(m[0],m[1],void 0,B),null!=n&&(m.m=n,m.hasM=!0),m;if(null==g||"2d"===g.type)return m=b.makeDehydratedPoint(m[0],m[1],x,B),null!=n&&(m.m=n,m.hasM=!0),m;g=d.getConvertedElevationFromVector(g,m,B,d.absoluteHeightElevationInfo,M)??0;m=b.makeDehydratedPoint(m[0],m[1],g,B);null!=n&&(m.m=n,m.hasM=!0);return m};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/IntersectionSnappingCandidate":function(){define(["exports",
"../../sketch/constraints","../SnappingDomain","./SnappingCandidate","../hints/IntersectionSnappingHint"],function(a,b,d,m,g){class x extends m.SnappingCandidate{constructor(n,B,M,k){super(n,new b.PointConstraint(n),k,d.SnappingDomain.ALL);this.first=B;this.second=M}get hints(){this.first.targetPoint=this.targetPoint;this.second.targetPoint=this.targetPoint;return[...this.first.hints,...this.second.hints,new g.IntersectionSnappingHint(this.targetPoint,this.isDraped,this.domain)]}}a.IntersectionSnappingCandidate=
x;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/IntersectionSnappingHint":function(){define(["exports","../../../../chunks/vec3","../SnappingDomain","./SnappingHint"],function(a,b,d,m){class g extends m.SnappingHint{constructor(x,n,B=d.SnappingDomain.ALL){super(n,B);this.intersectionPoint=x}equals(x){return x instanceof g?b.exactEquals(this.intersectionPoint,x.intersectionPoint):!1}}a.IntersectionSnappingHint=g;Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/widgets/Sketch/support/OperationHandle":function(){define("exports ../../../chunks/tslib.es6 ../../../core/compilerUtils ../../../core/Evented ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass".split(" "),function(a,b,d,m,g,x,n,B){a.OperationHandle=class extends m.EventedAccessor{constructor(M){super(M);this.cancelled=!1;this.history={undo:[],redo:[]};this.type=
null}get tool(){if(!this.activeComponent)return null;switch(this.activeComponent.type){case "graphic-mover":case "move-3d":return"move";case "box":case "transform-3d":return"transform";case "reshape":case "reshape-3d":return"reshape";case "draw-2d":case "draw-3d":return this.activeComponent.geometryType;default:d.neverReached(this.activeComponent)}return null}addToHistory(M){this.history.redo=[];this.history.undo.push(M)}resetHistory(){this.history.redo=[];this.history.undo=[]}canUndo(){return 0<
this.history.undo.length}canRedo(){return 0<this.history.redo.length}complete(){this._reset();this.onEnd();this.emit("complete")}cancel(){this.cancelled=!0;this.complete()}_reset(){this.activeComponent?.reset()}refreshComponent(){const M=this.activeComponent;M&&("box"!==M.type&&"reshape"!==M.type&&"graphic-mover"!==M.type||M.refresh())}set undo(M){this._set("undo",()=>{this.canUndo()&&M()})}set redo(M){this._set("redo",()=>{this.canRedo()&&M()})}};b.__decorate([g.property()],a.OperationHandle.prototype,
"activeComponent",void 0);b.__decorate([g.property()],a.OperationHandle.prototype,"cancelled",void 0);b.__decorate([g.property()],a.OperationHandle.prototype,"history",void 0);b.__decorate([g.property()],a.OperationHandle.prototype,"tool",null);b.__decorate([g.property()],a.OperationHandle.prototype,"type",void 0);b.__decorate([g.property()],a.OperationHandle.prototype,"canUndo",null);b.__decorate([g.property()],a.OperationHandle.prototype,"canRedo",null);b.__decorate([g.property()],a.OperationHandle.prototype,
"onEnd",void 0);b.__decorate([g.property()],a.OperationHandle.prototype,"undo",null);b.__decorate([g.property()],a.OperationHandle.prototype,"redo",null);b.__decorate([g.property()],a.OperationHandle.prototype,"toggleTool",void 0);b.__decorate([g.property()],a.OperationHandle.prototype,"addToSelection",void 0);b.__decorate([g.property()],a.OperationHandle.prototype,"removeFromSelection",void 0);a.OperationHandle=b.__decorate([B.subclass("esri.widgets.Sketch.support.OperationHandle")],a.OperationHandle);
a.CreateOperationHandle=class extends a.OperationHandle{};b.__decorate([g.property()],a.CreateOperationHandle.prototype,"activeComponent",void 0);a.CreateOperationHandle=b.__decorate([B.subclass("esri.widgets.Sketch.support.CreateOperationHandle")],a.CreateOperationHandle);a.UpdateOperationHandle=class extends a.OperationHandle{};b.__decorate([g.property()],a.UpdateOperationHandle.prototype,"activeComponent",void 0);a.UpdateOperationHandle=b.__decorate([B.subclass("esri.widgets.Sketch.support.UpdateOperationHandle")],
a.UpdateOperationHandle);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/icons":function(){define(["exports"],function(a){a.warningIcon="exclamation-mark-triangle";Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/VisibleElements":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../support/SketchTooltipControls/VisibleElements ../support/SnappingControls/VisibleElements".split(" "),
function(a,b,d,m,g,x,n,B,M){b=class extends b{constructor(k){super(k);this.sketchTooltipControls=this.editFeaturesSection=this.createFeaturesSection=!0;this.sketchTooltipControlsElements=new B;this.snappingControls=!0;this.snappingControlsElements=new M;this.undoRedoButtons=!1}};a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"createFeaturesSection",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"editFeaturesSection",void 0);a.__decorate([d.property({type:Boolean,
nonNullable:!0})],b.prototype,"sketchTooltipControls",void 0);a.__decorate([d.property({type:B,nonNullable:!0})],b.prototype,"sketchTooltipControlsElements",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"snappingControls",void 0);a.__decorate([d.property({type:M,nonNullable:!0})],b.prototype,"snappingControlsElements",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"undoRedoButtons",void 0);return b=a.__decorate([n.subclass("esri.widgets.Editor.VisibleElements")],
b)})},"esri/widgets/support/SketchTooltipControls/VisibleElements":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass".split(" "),function(a,b,d,m,g,x,n){b=class extends b{constructor(B){super(B);this.header=!1;this.tooltipsToggle=this.labelsToggle=!0}};a.__decorate([d.property({type:Boolean,nonNullable:!0})],
b.prototype,"header",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"labelsToggle",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"tooltipsToggle",void 0);return b=a.__decorate([n.subclass("esri.widgets.support.SketchTooltipControls.VisibleElements")],b)})},"esri/widgets/support/SnappingControls/VisibleElements":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,d,m,g,x,n){b=class extends b{constructor(B){super(B);this.featureEnabledToggle=this.enabledToggle=!0;this.header=!1;this.selfEnabledToggle=this.layerListToggleLayersButton=this.layerList=!0}};a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"enabledToggle",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"featureEnabledToggle",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"header",void 0);a.__decorate([d.property({type:Boolean,
nonNullable:!0})],b.prototype,"layerList",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"layerListToggleLayersButton",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"selfEnabledToggle",void 0);return b=a.__decorate([n.subclass("esri.widgets.support.SnappingControls.VisibleElements")],b)})},"esri/widgets/Editor/components/CreateFeaturesPanelContent":function(){define(["exports","./PanelContent","../../support/widgetUtils","../../support/jsxFactory"],
function(a,b,d,m){a.CreateFeaturesPanelContent=function({helpMessage:g}){return m.tsx(b.PanelContent,{key:"creating-features-panel-content"},m.tsx(b.PanelContentMessage,{key:"content-message"},g))};a.loadCreateFeaturesPanelContentComponents=()=>b.loadPanelContentComponents();Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/components/PanelContent":function(){define(["require","exports","../../support/componentsUtils","../../support/widgetUtils","../../support/jsxFactory"],
function(a,b,d,m,g){const x={base:"esri-editor__panel-content",message:"esri-editor__panel-content__message",section:"esri-editor__panel-content__section",sectionGroup:"esri-editor__panel-content__section__group",scrimContainer:"esri-editor__panel-content__scrim-container"};b.PanelContent=function(n,...B){return g.tsx("div",{class:m.classes(x.base,n?.showScrimOverlay?x.scrimContainer:void 0),key:n?.key??"panel-content"},...B,n?.showScrimOverlay?g.tsx("calcite-scrim",null):void 0)};b.PanelContentMessage=
function(n,...B){return g.tsx("div",{class:x.message,"data-testid":"panel-content-message",key:n?.key??"panel-content-message"},...B)};b.PanelContentSection=function(n,...B){return g.tsx("div",{class:x.section,key:n?.key??"panel-content-section"},...B)};b.PanelContentSectionGroup=function(n,...B){return g.tsx("div",{class:x.sectionGroup,key:n?.key??"panel-content-section-group"},...B)};b.css=x;b.loadPanelContentComponents=()=>d.loadCalciteComponents({scrim:()=>new Promise((n,B)=>a(["../../../chunks/calcite-scrim"],
n,B))});Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/components/FeatureList":function(){define("exports ../../../core/arrayUtils ../../../layers/support/fieldUtils ./PanelContent ../../FeatureTemplates/ItemList ../../support/widgetUtils ../../support/jsxFactory".split(" "),function(a,b,d,m,g,x,n){a.FeatureList=function({editableItems:B,filterText:M,id:k,messagesTemplates:w,onFilterTextChange:e,onSelectFeature:f,workflow:l}){const q=new Map;let r=0;l.data.candidates.map(c=>
{var t=c.layer;if(t){var h=t.fieldsIndex.get(t.objectIdField);var u=h.alias||h.name,{attributes:L}=c;h=(t=d.getDisplayFieldName(t))&&L[t]&&`${L[t]}`||`${u}: ${L[h.name]}`}else h=null;return{label:h,id:c.attributes[c.layer.objectIdField],data:c}}).filter(c=>{const {label:t,data:h}=c;c=M.toLowerCase();const {title:u}=h.layer,L=B.find(y=>y.layer===h.layer);if(!L)return null;const {attachmentsOnUpdateEnabled:K,supports:F}=L;return(F.includes("update")||F.includes("delete")||K)&&(!c||t?.toLowerCase().includes(c)||
u?.toLowerCase().includes(c))}).filter(b.isSome).forEach(c=>{r++;const t=c.data.layer;q.has(t)?q.get(t)?.items.push(c):q.set(t,{id:`${t.id}`,label:t.title??"",items:[c]})});l=B.toArray().map(({layer:c})=>q.get(c)).filter(b.isSome);return n.tsx(m.PanelContent,{key:"feature-list"},n.tsx(m.PanelContentSection,null,g.ItemList({enableListScroll:!1,filterEnabled:10<r||0<M.length,filterText:M,id:k,items:l,messages:{filterPlaceholder:w.filterPlaceholder,noItems:w.noItems,noMatches:w.noMatches},onFilterChange:c=>
e(c),onItemMouseEnter:c=>f(c.data),onItemMouseLeave:()=>f(null),onItemSelect:c=>f(c.data,!0)})))};a.loadFeatureListComponents=()=>m.loadPanelContentComponents();Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/components/FooterActions":function(){define("require exports ../../../core/arrayUtils ../../support/componentsUtils ../../support/widgetUtils ../../support/jsxFactory".split(" "),function(a,b,d,m,g,x){const n={base:"esri-editor__actions"};b.FooterActions=
function({buttons:B,key:M}){return x.tsx("div",{class:n.base,key:M??"footer-actions",slot:"footer"},B.filter(d.isSome).map(({disabled:k,onClick:w,label:e,...f},l)=>x.tsx("calcite-button",{disabled:k??!1,key:`action-${l}`,onclick:w,slot:"footer-actions",width:"full",...f},e)))};b.css=n;b.loadFooterActionsComponents=()=>m.loadCalciteComponents({button:()=>new Promise((B,M)=>a(["../../../chunks/calcite-button"],B,M))});Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/components/Notices":function(){define("require exports ../icons ../../support/componentsUtils ../../support/widgetUtils ../../support/jsxFactory".split(" "),
function(a,b,d,m,g,x){function n({message:M,...k}){return x.tsx("calcite-notice",{class:B.notice,open:!0,scale:"s",...k},x.tsx("div",{slot:"message"},M))}const B={notice:"esri-editor__notice"};b.Notice=n;b.Notices=function({workflow:M,messages:k}){return x.tsx(x.tsxFragment,null,M?.reliesOnOwnerAdminPrivileges?x.tsx(n,{message:k.ownerAdminNotice}):void 0,M?.hasInvalidFormTemplate?x.tsx(n,{icon:d.warningIcon,message:k.formFieldUpdateError}):void 0,M?.hasUnsupportedFields?x.tsx(n,{icon:d.warningIcon,
message:k.formFieldUnsupportedUpdateError}):void 0)};b.css=B;b.loadNoticesComponents=()=>m.loadCalciteComponents({notice:()=>new Promise((M,k)=>a(["../../../chunks/calcite-notice"],M,k))});Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/components/PanelToolbar":function(){define(["require","exports","./Settings","../../support/componentsUtils","../../support/jsxFactory"],function(a,b,d,m,g){const x={base:"esri-editor__panel-toolbar"};b.PanelToolbar=function({editorViewModel:n,
messagesCommon:B,visibleElements:M}){const {sketchViewModel:k}=n;return g.tsx("div",{class:x.base,key:"panel-toolbar"},g.tsx(d.Settings,{editorViewModel:n,messagesCommon:B,visibleElements:M}),M.undoRedoButtons?[g.tsx("calcite-button",{alignment:"center",appearance:"transparent",disabled:!k.canUndo(),iconStart:"undo",key:"undo-button",kind:"neutral",label:B.undo,onclick:()=>k.undo(),scale:"l"},B.undo),g.tsx("calcite-button",{alignment:"center",appearance:"transparent",disabled:!k.canRedo(),iconStart:"redo",
key:"redo-button",kind:"neutral",label:B.redo,onclick:()=>k.redo(),scale:"l"},B.redo)]:null)};b.css=x;b.loadPanelToolbarComponents=()=>Promise.all([m.loadCalciteComponents({button:()=>new Promise((n,B)=>a(["../../../chunks/calcite-button"],n,B))}),d.loadSettingsComponents()]);Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/components/Settings":function(){define("require exports ../../support/componentsUtils ../../support/SketchTooltipControls ../../support/SnappingControls ../../support/widgetUtils ../../support/jsxFactory ../../support/SketchTooltipControls/VisibleElements ../../support/SnappingControls/VisibleElements".split(" "),
function(a,b,d,m,g,x,n,B,M){const k={settingsContainer:"esri-editor__settings"};b.Settings=function({editorViewModel:w,messagesCommon:e,visibleElements:f}){const {labelOptions:l,snappingOptions:q,tooltipOptions:r,view:c}=w;w=[];f.sketchTooltipControls&&w.push(n.tsx(m,{labelOptions:l,tooltipOptions:r,viewType:c?.type,visibleElements:f.sketchTooltipControlsElements??new B}));f.snappingControls&&w.push(n.tsx(g,{afterCreate:t=>t.layerListOpen=!1,snappingOptions:q,view:c,visibleElements:f.snappingControlsElements??
new M}));return 0===w.length?null:n.tsx("calcite-accordion",{appearance:"transparent",class:k.settingsContainer,key:"settings"},n.tsx("calcite-accordion-item",{"data-testid":"settings",heading:e.settings,iconStart:"gear"},w))};b.css=k;b.loadSettingsComponents=()=>d.loadCalciteComponents({accordion:()=>new Promise((w,e)=>a(["../../../chunks/calcite-accordion"],w,e)),"accordion-item":()=>new Promise((w,e)=>a(["../../../chunks/calcite-accordion-item"],w,e))});Object.defineProperty(b,Symbol.toStringTag,
{value:"Module"})})},"esri/widgets/support/SketchTooltipControls":function(){define("require ../../chunks/tslib.es6 ../../core/arrayUtils ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/has ../../core/accessorSupport/decorators/subclass ../Widget ./componentsUtils ./globalCss ./LabeledSwitch ./legacyIcon ./widgetUtils ./decorators/messageBundle ./jsxFactory ./SketchTooltipControls/SketchTooltipControlsViewModel ./SketchTooltipControls/VisibleElements".split(" "),
function(a,b,d,m,g,x,n,B,M,k,w,e,f,l,q,r,c,t){var h=f.legacyIcon.gear;x=class extends M{constructor(u,L){super(u,L);this.icon=this._defaultViewModel=null;this.iconClass=h;this.visibleElements=new t;this.viewType=void 0;this._onTooltipsEnabledChange=p=>{this.tooltipOptions.enabled=p};this._onLabelsEnabledChange=p=>{this.labelOptions.enabled=p};const {tooltipOptions:K,labelOptions:F,viewModel:y}=u;this.viewModel=y??(this._defaultViewModel=new c({tooltipOptions:K,labelOptions:F}))}loadDependencies(){return Promise.all([k.loadCalciteComponents({block:()=>
new Promise((u,L)=>a(["../../chunks/calcite-block"],u,L))}),e.loadLabeledSwitchComponents()])}render(){const {label:u,visibleElements:L}=this,K=this._renderContent();return r.tsx("div",{"aria-label":u,class:this.classes("esri-sketch-tooltip-controls",w.globalCss.widget)},K?r.tsx("calcite-block",{class:"esri-sketch-tooltip-controls__block",heading:L.header?this.label:"",key:"content-block",open:!0},r.tsx("div",{class:"esri-sketch-tooltip-controls__block-content",key:"content"},K)):void 0)}get label(){return this.messages?.widgetLabel??
""}set label(u){this._overrideIfSome("label",u)}get labelOptions(){return this.viewModel.labelOptions}set labelOptions(u){this.viewModel.labelOptions=u}get tooltipOptions(){return this.viewModel.tooltipOptions}set tooltipOptions(u){this.viewModel.tooltipOptions=u}set viewModel(u){if(u!==this._get("viewModel")){if(null==this._defaultViewModel||this._defaultViewModel!==u)this._defaultViewModel=m.destroyMaybe(this._defaultViewModel);this._set("viewModel",u)}}_renderContent(){const {visibleElements:u,
viewType:L}=this,K=[u.tooltipsToggle?this._renderTooltipsToggle():null,u.labelsToggle&&"2d"!==L?this._renderLabelsToggle():null].filter(d.isSome);return 0===K.length?null:K}_renderTooltipsToggle(){const {messages:u,tooltipOptions:L}=this;return r.tsx(e.LabeledSwitch,{checked:L.enabled,hint:u.tooltipsToggleHint,key:`${this.id}__tooltips`,label:u.tooltipsToggle,onChange:this._onTooltipsEnabledChange})}_renderLabelsToggle(){const {messages:u,labelOptions:L}=this;return r.tsx(e.LabeledSwitch,{checked:L.enabled,
hint:u.labelsToggleHint,key:`${this.id}__labels`,label:u.labelsToggle,onChange:this._onLabelsEnabledChange})}};b.__decorate([g.property()],x.prototype,"icon",void 0);b.__decorate([g.property()],x.prototype,"iconClass",void 0);b.__decorate([g.property()],x.prototype,"label",null);b.__decorate([g.property()],x.prototype,"labelOptions",null);b.__decorate([g.property()],x.prototype,"tooltipOptions",null);b.__decorate([g.property()],x.prototype,"viewModel",null);b.__decorate([g.property({type:t,nonNullable:!0})],
x.prototype,"visibleElements",void 0);b.__decorate([g.property(),q.messageBundle("esri/widgets/support/SketchTooltipControls/t9n/SketchTooltipControls")],x.prototype,"messages",void 0);b.__decorate([g.property({type:String})],x.prototype,"viewType",void 0);return x=b.__decorate([B.subclass("esri.widgets.support.SketchTooltipControls")],x)})},"esri/widgets/support/LabeledSwitch":function(){define(["require","exports","./componentsUtils","./widgetUtils","./jsxFactory"],function(a,b,d,m,g){b.LabeledSwitch=
function({checked:x,disabled:n,hint:B,key:M,label:k,onChange:w}){return g.tsx("calcite-label",{class:"esri-labeled-switch__label",disabled:n,key:M,layout:"inline-space-between",scale:"s"},g.tsx("div",{class:"esri-labeled-switch__label-content",key:"label-content"},B?g.tsx(g.tsxFragment,null,g.tsx("div",null,k),g.tsx("calcite-icon",{class:"esri-labeled-switch__icon",icon:"information",id:M,scale:"s"}),g.tsx("calcite-tooltip",{referenceElement:M},B)):k),g.tsx("calcite-switch",{checked:x,disabled:n,
scale:"s",onCalciteSwitchChange:e=>w(e.target.checked)}))};b.loadLabeledSwitchComponents=()=>Promise.all([d.loadCalciteComponents({icon:()=>new Promise((x,n)=>a(["../../chunks/calcite-icon"],x,n)),label:()=>new Promise((x,n)=>a(["../../chunks/calcite-label"],x,n)),switch:()=>new Promise((x,n)=>a(["../../chunks/calcite-switch"],x,n)),tooltip:()=>new Promise((x,n)=>a(["../../chunks/calcite-tooltip"],x,n))})]);Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/SketchTooltipControls/SketchTooltipControlsViewModel":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../views/interactive/sketch/SketchLabelOptions ../../../views/interactive/sketch/SketchTooltipOptions".split(" "),
function(a,b,d,m,g,x,n,B,M){b=class extends b{constructor(k){super(k);this.labelOptions=new B;this.tooltipOptions=new M}};a.__decorate([d.property({type:B,nonNullable:!0})],b.prototype,"labelOptions",void 0);a.__decorate([d.property({type:M,nonNullable:!0})],b.prototype,"tooltipOptions",void 0);return b=a.__decorate([n.subclass("esri.widgets.support.SketchTooltipControls.SketchTooltipControlsViewModel")],b)})},"esri/widgets/support/SnappingControls":function(){define("require ../../chunks/tslib.es6 ../../core/arrayUtils ../../core/maybe ../../core/uid ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/has ../../core/accessorSupport/decorators/subclass ../Widget ./componentsUtils ./globalCss ./LabeledSwitch ./legacyIcon ./widgetUtils ./decorators/messageBundle ./jsxFactory ./SnappingControls/SnappingControlsViewModel ./SnappingControls/VisibleElements".split(" "),
function(a,b,d,m,g,x,n,B,M,k,w,e,f,l,q,r,c,t,h){var u=l.legacyIcon.vertexGps;n=class extends k{constructor(L,K){super(L,K);this._layerListFilter=this._defaultViewModel=null;this.iconClass=u;this.icon=null;this.layerListOpen=!0;this.messages=null;this.visibleElements=new h;this._enableSnappingSwitchChange=I=>{this.snappingOptions.enabled=I};this._featureEnabledSwitchChange=I=>{this.snappingOptions.featureEnabled=I};this._selfEnabledSwitchChange=I=>{this.snappingOptions.selfEnabled=I};this._onToggleLayersButtonClick=
I=>{this.viewModel.toggleSnappingForAllLayers(!this.viewModel.allLayersEnabled);requestAnimationFrame(()=>I.target.setFocus())};const {snappingOptions:F,view:y,viewModel:p}=L;this.viewModel=p??(this._defaultViewModel=new t({snappingOptions:F,view:y}))}normalizeCtorArgs(L){const {snappingOptions:K,view:F,viewModel:y,...p}=L;return p}destroy(){this.viewModel!==this._defaultViewModel&&(this._defaultViewModel=m.destroyMaybe(this._defaultViewModel))}loadDependencies(){return Promise.all([w.loadCalciteComponents({accordion:()=>
new Promise((L,K)=>a(["../../chunks/calcite-accordion"],L,K)),"accordion-item":()=>new Promise((L,K)=>a(["../../chunks/calcite-accordion-item"],L,K)),action:()=>new Promise((L,K)=>a(["../../chunks/calcite-action"],L,K)),block:()=>new Promise((L,K)=>a(["../../chunks/calcite-block"],L,K)),button:()=>new Promise((L,K)=>a(["../../chunks/calcite-button"],L,K)),icon:()=>new Promise((L,K)=>a(["../../chunks/calcite-icon"],L,K)),input:()=>new Promise((L,K)=>a(["../../chunks/calcite-input"],L,K)),list:()=>
new Promise((L,K)=>a(["../../chunks/calcite-list"],L,K)),"list-item":()=>new Promise((L,K)=>a(["../../chunks/calcite-list-item"],L,K))}),f.loadLabeledSwitchComponents()])}get label(){return this.messages?.widgetLabel??""}set label(L){this._overrideIfSome("label",L)}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(L){this.viewModel.snappingOptions=L}get view(){return this.viewModel.view}set view(L){this.viewModel.view=L}set viewModel(L){if(L!==this._get("viewModel")){if(null==
this._defaultViewModel||this._defaultViewModel!==L)this._defaultViewModel=m.destroyMaybe(this._defaultViewModel);this._set("viewModel",L)}}render(){const {label:L}=this;return c.tsx("div",{"aria-label":L,class:this.classes("esri-snapping-controls",e.globalCss.widget)},c.tsx("div",{class:"esri-snapping-controls__container"},this._renderContent()))}_renderContent(){return[this._renderToggles(),this._renderLayerList()]}_renderToggles(){const {visibleElements:L}=this;var K=[L.selfEnabledToggle?this._renderSelfEnabledToggle():
null,L.featureEnabledToggle?this._renderFeatureEnabledToggle():null].filter(d.isSome);K=[L.enabledToggle?this._renderEnabledToggle():null,0<K.length?c.tsx("div",{class:"esri-snapping-controls__nested-container"},K):null].filter(d.isSome);return 0===K.length?null:c.tsx("calcite-block",{class:"esri-snapping-controls__toggle-block",heading:L.header?this.label:"",key:"toggle-block",open:!0},K)}_renderEnabledToggle(){const {messages:L,viewModel:K}=this,{snappingOptions:F}=K;return c.tsx(f.LabeledSwitch,
{checked:F.enabled,disabled:F.enabledToggled,key:`${this.id}__enabled-toggle`,label:L.enableSnapping,onChange:this._enableSnappingSwitchChange})}_renderSelfEnabledToggle(){const {messages:L,viewModel:K}=this,{snappingOptions:F}=K;return c.tsx(f.LabeledSwitch,{checked:F.enabled&&F.selfEnabled,disabled:F.enabledToggled||!F.enabled,key:`${this.id}__self-enabled-toggle`,label:L.geometryGuides,onChange:this._selfEnabledSwitchChange})}_renderFeatureEnabledToggle(){const {messages:L,viewModel:K}=this,{snappingOptions:F}=
K;return c.tsx(f.LabeledSwitch,{checked:F.enabled&&F.featureEnabled,disabled:F.enabledToggled||!F.enabled,key:`${this.id}__feature-enabled-toggle`,label:L.featureToFeature,onChange:this._featureEnabledSwitchChange})}_renderLayerList(){if(!this.visibleElements.layerList)return null;const {messages:L,viewModel:K}=this,{snappingOptions:{enabled:F,enabledToggled:y}}=K;var p=({target:{value:R}})=>{this._layerListFilter=""===R?null:new RegExp(R,"i")};p=9<K.layerListViewModel.operationalItems.length?c.tsx("calcite-input",
{class:"esri-snapping-controls__layer-list__filter",clearable:!0,placeholder:L?.searchLayers,onCalciteInputInput:p}):null;const I=y||!F;return c.tsx("calcite-block",{class:"esri-snapping-controls__layer-list-block",collapsible:!0,disabled:I,heading:L.snappingLayers,key:"list-block",open:this.layerListOpen&&!I,onCalciteBlockToggle:R=>this.layerListOpen=R.target.open},p,this._renderToggleLayersButton(),c.tsx("calcite-list",{class:"esri-snapping-controls__layer-list"},this._renderLayerListItemCollection(K.layerListViewModel.operationalItems,
this._layerListFilter)))}_renderLayerListItemCollection(L,K){return L.map(F=>{if(K?this._itemTitleMatchesFilter(F,K):1)return 0<F.children.length?this._renderLayerListItemGroup(F):this._renderLayerListItem(F);const y=F.children.filter(p=>this._itemTitleMatchesFilter(p,K));return 0<y.length?this._renderLayerListItemGroup(F,y):null}).toArray().filter(d.isSome)}_renderToggleLayersButton(){if(!this.visibleElements.layerListToggleLayersButton)return null;const {viewModel:{allLayersEnabled:L},messages:K}=
this,F=L?K.disableAllLayers:K.enableAllLayers;return c.tsx("calcite-button",{appearance:"transparent",class:"esri-snapping-controls__layer-list__button",label:F,name:"layer-toggle",onclick:this._onToggleLayersButtonClick,scale:"m"},F)}_renderLayerListItem(L){const {messages:{untitledLayer:K}}=this,F=L.enabled;return c.tsx("calcite-list-item",{class:"esri-snapping-controls__layer-list__item",key:`${this.id}-list-item-${L.uid}`,label:L.title||K,onCalciteListItemSelect:()=>{this._handleLayerListItemChange({checked:!F,
value:L.layer.id})}},c.tsx("calcite-icon",{icon:F?"check-square-f":"square",scale:"s",slot:"content-start"}))}_renderLayerListItemGroup(L,K){const {allChildrenEnabled:F,children:y,hasChildrenEnabled:p,title:I}=L,R=this.messages,D=I||R.untitledLayer,E=I&&""!==I?I:g.generateUID(),N=K??y;return c.tsx("calcite-list-item",{class:"esri-snapping-controls__layer-list__item",key:E},c.tsx("calcite-accordion",{appearance:"transparent",class:"esri-snapping-controls__layer-list__group"},c.tsx("calcite-accordion-item",
{expanded:!!K,heading:D,key:L.uid},c.tsx("calcite-action",{onclick:()=>{this.viewModel.toggleSnappingForLayers(L.childLayerIds,!F)},scale:"m",slot:"actions-start",text:F?R.disableAllLayers:R.enableAllLayers,textEnabled:!1},c.tsx("calcite-icon",{icon:F?"check-square-f":p?"minus-square":"square",scale:"s"})),c.tsx("calcite-list",null,this._renderLayerListItemCollection(N)))))}_itemTitleMatchesFilter(L,K){return null!=K&&K.test(L.title)}async _handleLayerListItemChange(L){L.checked?this.viewModel.enableSnappingForLayer(L.value):
this.viewModel.disableSnappingForLayer(L.value)}};b.__decorate([x.property()],n.prototype,"_defaultViewModel",void 0);b.__decorate([x.property()],n.prototype,"_layerListFilter",void 0);b.__decorate([x.property()],n.prototype,"iconClass",void 0);b.__decorate([x.property()],n.prototype,"icon",void 0);b.__decorate([x.property()],n.prototype,"label",null);b.__decorate([x.property({type:Boolean,nonNullable:!0})],n.prototype,"layerListOpen",void 0);b.__decorate([x.property(),r.messageBundle("esri/widgets/support/SnappingControls/t9n/SnappingControls")],
n.prototype,"messages",void 0);b.__decorate([x.property()],n.prototype,"snappingOptions",null);b.__decorate([x.property()],n.prototype,"view",null);b.__decorate([x.property()],n.prototype,"viewModel",null);b.__decorate([x.property({type:h,nonNullable:!0})],n.prototype,"visibleElements",void 0);return n=b.__decorate([M.subclass("esri.widgets.support.SnappingControls")],n)})},"esri/widgets/support/SnappingControls/SnappingControlsViewModel":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Error ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../views/interactive/snapping/FeatureSnappingLayerSource ../../../views/interactive/snapping/SnappingOptions ../../LayerList/support/layerListUtils ./SnappingLayerListViewModel".split(" "),
function(a,b,d,m,g,x,n,B,M,k,w,e,f){b=class extends b{constructor(l){super(l);this.layerListViewModel=new f.SnappingLayerListViewModel;this.snappingOptions=new w;this.view=null}initialize(){this.addHandles([m.watch(()=>({viewModel:this.layerListViewModel,view:this.view}),({viewModel:l,view:q})=>{l.view=q},m.initial),m.watch(()=>({viewModel:this.layerListViewModel,sources:this.snappingOptions?.featureSources}),({viewModel:l,sources:q})=>{l.featureSnappingSources=q},m.initial)])}get allLayersEnabled(){return(this.layerListViewModel?.selectableItems??
[]).every(l=>l.enabled)}get allLayersDisabled(){return(this.layerListViewModel?.selectableItems??[]).every(l=>!l.enabled)}get layersEnabledCount(){return this.layerListViewModel?.selectableItems?.filter(l=>l.enabled).length??0}get state(){return this.snappingOptions?"ready":"disabled"}toggleSnappingForLayers(l,q){l?.forEach(r=>q?this.enableSnappingForLayer(r):this.disableSnappingForLayer(r))}toggleSnappingForAllLayers(l){this.layerListViewModel.selectableItems.forEach(({layer:{id:q}})=>{l?this.enableSnappingForLayer(q):
this.disableSnappingForLayer(q)})}enableSnappingForLayer(l){(this._findSnappingSourceForLayer(l)??this._makeSnappingSourceForLayer(l)).enabled=!0}disableSnappingForLayer(l){if(l=this._findSnappingSourceForLayer(l))l.enabled=!1}updateEnabledFeatureSources(l){for(const q of this.snappingOptions.featureSources)e.canDisplayLayer(q.layer)&&(q.enabled=l.includes(q.layer.id))}_findSnappingSourceForLayer(l){return this.snappingOptions.featureSources.find(q=>q.layer.id===l)}_makeSnappingSourceForLayer(l){var q=
this.layerListViewModel.operationalItemsFlat.find(r=>r.layer.id===l)?.layer;if(!q)throw new d("snapping-controls:layer-not-found",`cannot enable snapping for layer with id ${l} because no such layer was found in the view`);q=new k({layer:q});this.snappingOptions.featureSources.add(q);return q}};a.__decorate([g.property()],b.prototype,"allLayersEnabled",null);a.__decorate([g.property()],b.prototype,"allLayersDisabled",null);a.__decorate([g.property({constructOnly:!0})],b.prototype,"layerListViewModel",
void 0);a.__decorate([g.property()],b.prototype,"layersEnabledCount",null);a.__decorate([g.property({type:w,nonNullable:!0})],b.prototype,"snappingOptions",void 0);a.__decorate([g.property()],b.prototype,"state",null);a.__decorate([g.property()],b.prototype,"view",void 0);return b=a.__decorate([M.subclass("esri.widgets.support.SnappingControls.SnappingControlsViewModel")],b)})},"esri/widgets/LayerList/support/layerListUtils":function(){define(["exports"],function(a){function b(k){if(k)return null!=
k.listMode?k.listMode:void 0}function d(k){return null!=k&&"minScale"in k&&null!=k.minScale?k.minScale:void 0}function m(k){return null!=k&&"maxScale"in k&&null!=k.maxScale?k.maxScale:void 0}function g(k){if(k&&!("type"in k&&"wmts"===k.type)&&k.listMode!==M.hideChildren)return"sublayers"in k?"sublayers":"layers"in k?"layers":void 0}function x(k,w){k?.sort((e,f)=>{e="uid"in e?w.indexOf(e.uid):-1;f="uid"in f?w.indexOf(f.uid):-1;return e>f?-1:e<f?1:0})}function n(k){return null!=k&&"layer"in k&&null!=
k.layer}function B(k){return k&&"capabilities"in k&&null!=k.capabilities&&"exportMap"in k.capabilities?k.capabilities.exportMap:void 0}const M={hide:"hide",hideChildren:"hide-children"};a.canDisplayLayer=function(k){return b(k)!==M.hide};a.canSortSublayers=function(k){k=(k?.layer&&n(k.layer)?k.layer.layer:void 0)??k?.layer;if(!k)return!1;k=B(k);return(null!=k&&"supportsDynamicLayers"in k?k.supportsDynamicLayers:void 0)??!0};a.findLayerListMode=b;a.findLayerMaxScale=m;a.findLayerMinScale=d;a.findLayerVisibilityMode=
function(k){if(!k)return"inherited";var w=n(k)?k.layer:k;w=B(w);w=null!=w&&"supportsSublayerVisibility"in w?w.supportsSublayerVisibility:void 0;return null!=w?w?"independent":"inherited":"visibilityMode"in k&&null!=k.visibilityMode?k.visibilityMode:"independent"};a.findSelectedItem=function(k,w){const e=k.layer?.uid;return null!=e?w.find(f=>f.layer?.uid===e):null};a.getItemLayers=function(k){return(k=k?.layer)&&"layers"in k?k.layers:null};a.getLegendLayerInfo=function(k){var w=n(k)?k:null;const e=
k?.parent;return(w=null!=e&&"type"in e&&"map-image"===e.type?w?.source:null)&&e?{layer:e,title:"",sublayerIds:[w.mapLayerId]}:{layer:k,title:""}};a.getNormalizedChildLayerProperty=g;a.isLayerOutsideScaleRange=function(k,w){if(!k||null==w||isNaN(w))return!1;var e=d(k);k=m(k);e=null!=e&&!isNaN(e)&&0<e&&w>e;w=null!=k&&!isNaN(k)&&0<k&&w<k;return e||w};a.isSublayer=n;a.sortChildLayersToIds=function(k,w){if(k=k?.layer){var e=g(k);if(e){if("layers"===e&&"layers"in k)var f=k.layers;else"sublayers"===e&&"sublayers"in
k&&(f=k.sublayers);x(f,w)}}};a.sortLayersToIds=x;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/SnappingControls/SnappingLayerListViewModel":function(){define("exports ../../../chunks/tslib.es6 ../../../core/Collection ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../LayerList/LayerListViewModel ./snappingLayerListUtils ./SnappingListItem".split(" "),
function(a,b,d,m,g,x,n,B,M,k,w){a.SnappingLayerListViewModel=class extends M{constructor(){super(...arguments);this.featureSnappingSources=new d}get operationalItemsFlat(){return this.operationalItems.flatten(e=>e.children)}get selectableItems(){return this.operationalItemsFlat.filter(e=>!e.children?.length)}_compileList(){var e=this.view?.map?.layers;e&&(e=e.filter(k.isValidSnappingLayer),this._watchLayersListMode(e),e=this._getViewableLayers(e),e?.length?(this._createNewItems(e),this._removeItems(e),
this._sortItems(e)):this._removeAllItems())}_createListItem(e){return new w.SnappingListItem({layer:e,view:this.view,getFeatureSnappingSources:()=>this.featureSnappingSources})}};b.__decorate([m.property()],a.SnappingLayerListViewModel.prototype,"featureSnappingSources",void 0);b.__decorate([m.property()],a.SnappingLayerListViewModel.prototype,"operationalItems",void 0);b.__decorate([m.property()],a.SnappingLayerListViewModel.prototype,"operationalItemsFlat",null);b.__decorate([m.property()],a.SnappingLayerListViewModel.prototype,
"selectableItems",null);a.SnappingLayerListViewModel=b.__decorate([B.subclass("esri.widgets.support.SnappingControls.SnappingLayerListViewModel")],a.SnappingLayerListViewModel);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/LayerList/LayerListViewModel":function(){define("../../chunks/tslib.es6 ../../core/Collection ../../core/Evented ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ./ListItem ./support/layerListUtils".split(" "),
function(a,b,d,m,g,x,n,B,M,k,w){const e=b.ofType(k);b=class extends d.EventedAccessor{constructor(f){super(f);this.checkPublishStatusEnabled=!1;this.listItemCreatedFunction=null;this.operationalItems=new e;this.view=null}initialize(){this.addHandles([m.watch(()=>[this.view,this.view?.ready],()=>this._viewHandles(),m.initial),m.watch(()=>[this.listItemCreatedFunction,this.checkPublishStatusEnabled],()=>this._recompileList())],"view")}destroy(){this.view=null;this.operationalItems.removeAll()}get state(){const {view:f}=
this;return f?.ready?"ready":f?"loading":"disabled"}triggerAction(f,l){f&&!f.disabled&&this.emit("trigger-action",{action:f,item:l})}moveListItem(f,l,q,r){const c=f?.layer;if(c){var t=this.view?.map?.layers,h=l?w.getItemLayers(l):t;t=q?w.getItemLayers(q):t;if(h&&t){var {operationalItems:u}=this;l=l?.children||u;u=q?.children||u;r=t.length-r;f.parent=q||null;l.includes(f)&&l.remove(f);h.includes(c)&&h.remove(c);u.includes(f)||u.add(f,r);t.includes(c)||t.add(c,r)}}}_createLayerViewHandles(f){this.removeHandles("layer-views");
this._compileList();f&&this.addHandles(f.on("change",()=>this._compileList()),"layer-views")}_createMapLayerHandles(f){this.removeHandles("map-layers");this._compileList();f&&this.addHandles(f.on("change",()=>this._compileList()),"map-layers")}_createListItem(f){const {view:l,listItemCreatedFunction:q,checkPublishStatusEnabled:r}=this;return new k({checkPublishStatusEnabled:r,layer:f,listItemCreatedFunction:q,view:l})}_removeAllItems(){this.operationalItems.removeAll()}_getViewableLayers(f){if(f)return f.filter(l=>
"hide"!==w.findLayerListMode(l))}_watchLayersListMode(f){this.removeHandles("layer-list-mode");f&&f.forEach(l=>{"listMode"in l&&this.addHandles(m.watch(()=>l.listMode,()=>this._compileList()),"layer-list-mode")})}_compileList(){var f=this.view?.map?.layers;this._watchLayersListMode(f);f=this._getViewableLayers(f);f?.length?(this._createNewItems(f),this._removeItems(f),this._sortItems(f)):this._removeAllItems()}_createNewItems(f){const {operationalItems:l}=this;f.forEach(q=>{l.find(r=>r.layer===q)||
l.add(this._createListItem(q))})}_removeItems(f){const {operationalItems:l}=this,q=[];l.forEach(r=>{r&&f&&f.includes(r.layer)||q.push(r)});l.removeMany(q)}_sortItems(f){const {operationalItems:l}=this;l.sort((q,r)=>{q=f.indexOf(q.layer);r=f.indexOf(r.layer);return q>r?-1:q<r?1:0})}_recompileList(){this._removeAllItems();this._compileList()}_viewHandles(){const {view:f}=this;this.removeHandles(["map-layers","layer-views","view-layers"]);this._recompileList();f&&f.ready&&this.addHandles([m.watch(()=>
this.view?.map?.allLayers,l=>this._createMapLayerHandles(l),m.initial),m.watch(()=>this.view?.allLayerViews,l=>this._createLayerViewHandles(l),m.initial)],"view-layers")}};a.__decorate([g.property()],b.prototype,"checkPublishStatusEnabled",void 0);a.__decorate([g.property()],b.prototype,"listItemCreatedFunction",void 0);a.__decorate([g.property({type:e})],b.prototype,"operationalItems",void 0);a.__decorate([g.property({readOnly:!0})],b.prototype,"state",null);a.__decorate([g.property()],b.prototype,
"view",void 0);return b=a.__decorate([M.subclass("esri.widgets.LayerList.LayerListViewModel")],b)})},"esri/widgets/LayerList/ListItem":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/arrayUtils ../../core/Collection ../../core/Identifiable ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/has ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/get ../../support/actions/ActionBase ../../support/actions/ActionButton ../../support/actions/ActionSlider ../../support/actions/ActionToggle ./ListItemPanel ./support/layerListUtils".split(" "),
function(a,b,d,m,g,x,n,B,M,k,w,e,f,l,q,r,c){var t;M=m.ofType({key:"type",defaultKeyValue:"button",base:e,typeMap:{button:f,toggle:q,slider:l}});const h=m.ofType(M);b=t=class extends g.IdentifiableMixin(b){constructor(u){super(u);this.actionsSections=new h;this.checkPublishStatusEnabled=this.actionsOpen=!1;this.children=new (m.ofType(t));this.childrenSortable=!0;this.hidden=!1;this.listItemCreatedFunction=this.layerView=this.layer=null;this.open=!1;this.parent=this.panel=null;this.sortable=!0;this.view=
null}initialize(){this.addHandles([x.watch(()=>this.layer,u=>this._watchLayerProperties(u),x.initial),x.watch(()=>this.checkPublishStatusEnabled,u=>this._updateChildrenPublishing(u),x.initial),x.watch(()=>this.view,u=>this._updateChildrenView(u),x.initial),x.watch(()=>this.panel,u=>this._setListItemOnPanel(u),x.initial),x.watch(()=>[this.layer,this.view],()=>this._getLayerView(),x.initial)]);"function"===typeof this.listItemCreatedFunction&&this.listItemCreatedFunction.call(null,{item:this})}destroy(){this.view=
null}get connectionStatus(){const {layerView:u,publishing:L}=this;if(!L&&u&&"connectionStatus"in u)return u.connectionStatus}get error(){return this.layer?.loadError}get incompatible(){const {layerView:u}=this;return u&&"spatialReferenceSupported"in u?!u.spatialReferenceSupported:!1}castPanel(u){this.panel?.open&&!u.hasOwnProperty("open")&&(u.open=!0);return u?new r(u):null}get title(){const u=w.get(this,"layer.layer");return(!u||u&&w.get(this,"layer.layer.loaded"))&&w.get(this,"layer.title")||w.get(this,
"layer.attributes.title")||""}set title(u){this._override("title",u)}get publishing(){const {layer:u,checkPublishStatusEnabled:L}=this;return L&&u&&"publishingInfo"in u&&"publishing"===u.publishingInfo?.status}get updating(){const {layerView:u,connectionStatus:L,layer:K,publishing:F}=this;return F||L?!1:u?u.updating:"loading"===K?.loadStatus||!1}get visible(){return this.layer?.visible}set visible(u){const L=this.layer;L&&(L.visible=u)}get visibleAtCurrentScale(){return!c.isLayerOutsideScaleRange(this.layer,
this.view?.scale)}get visibilityMode(){return c.findLayerVisibilityMode(this.layer)}clone(){return new t({actionsSections:this.actionsSections.clone(),actionsOpen:this.actionsOpen,checkPublishStatusEnabled:this.checkPublishStatusEnabled,children:this.children.clone(),layer:this.layer,listItemCreatedFunction:this.listItemCreatedFunction,open:this.open,panel:this.panel,title:this.title,view:this.view,visible:this.visible})}_setListItemOnPanel(u){u&&(u.listItem=this)}_updateChildrenPublishing(u){const L=
this.children;L&&L.forEach(K=>K.checkPublishStatusEnabled=u)}_updateChildrenView(u){const L=this.children;L&&L.forEach(K=>K.view=u)}_addChildren(u){this.removeHandles("child-list-mode");this.children.removeAll();if(u){u.forEach(K=>{this.addHandles(x.watch(()=>K.listMode,()=>this._addChildren(u)),"child-list-mode")});var L=u.filter(K=>"hide"!==c.findLayerListMode(K));this.children.addMany(this._makeChildren(L))}}_watchSublayerChanges(u){u&&this.addHandles(u.on("change",()=>{this._addChildren(u)}),
"layer")}_initializeChildLayers(u){this._addChildren(u);this._watchSublayerChanges(u)}_makeChildren(u){return u.map(L=>c.canDisplayLayer(L)?new t({layer:L,checkPublishStatusEnabled:this.checkPublishStatusEnabled,listItemCreatedFunction:this.listItemCreatedFunction,parent:this,view:this.view}):null).filter(d.isSome).reverse()}_watchLayerProperties(u){this.removeHandles("layer");this.removeHandles("child-list-mode");if(u)if(this.addHandles(x.watch(()=>u.listMode,()=>this._watchLayerProperties(u)),"layer"),
"hide-children"===c.findLayerListMode(u))this.children.removeAll();else{var L=c.getNormalizedChildLayerProperty(u);L&&this.addHandles(x.watch(()=>u[L],K=>{u.hasOwnProperty(L)&&this._initializeChildLayers(K)},x.initial),"layer")}}async _getLayerView(){const {layer:u,view:L}=this;if(u&&L)try{const K=await L.whenLayerView(u);K.layer===this.layer&&this._set("layerView",K)}catch{}}};a.__decorate([n.property({type:h})],b.prototype,"actionsSections",void 0);a.__decorate([n.property()],b.prototype,"actionsOpen",
void 0);a.__decorate([n.property()],b.prototype,"checkPublishStatusEnabled",void 0);a.__decorate([n.property({type:m})],b.prototype,"children",void 0);a.__decorate([n.property()],b.prototype,"childrenSortable",void 0);a.__decorate([n.property({readOnly:!0})],b.prototype,"connectionStatus",null);a.__decorate([n.property({readOnly:!0})],b.prototype,"error",null);a.__decorate([n.property()],b.prototype,"hidden",void 0);a.__decorate([n.property({readOnly:!0})],b.prototype,"incompatible",null);a.__decorate([n.property()],
b.prototype,"layer",void 0);a.__decorate([n.property({readOnly:!0})],b.prototype,"layerView",void 0);a.__decorate([n.property()],b.prototype,"listItemCreatedFunction",void 0);a.__decorate([n.property()],b.prototype,"open",void 0);a.__decorate([n.property({type:r})],b.prototype,"panel",void 0);a.__decorate([B.cast("panel")],b.prototype,"castPanel",null);a.__decorate([n.property()],b.prototype,"parent",void 0);a.__decorate([n.property()],b.prototype,"sortable",void 0);a.__decorate([n.property()],b.prototype,
"title",null);a.__decorate([n.property({readOnly:!0})],b.prototype,"publishing",null);a.__decorate([n.property({readOnly:!0})],b.prototype,"updating",null);a.__decorate([n.property()],b.prototype,"view",void 0);a.__decorate([n.property()],b.prototype,"visible",null);a.__decorate([n.property({readOnly:!0})],b.prototype,"visibleAtCurrentScale",null);a.__decorate([n.property({readOnly:!0})],b.prototype,"visibilityMode",null);return b=t=a.__decorate([k.subclass("esri.widgets.LayerList.ListItem")],b)})},
"esri/support/actions/ActionSlider":function(){define("../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ./ActionBase".split(" "),function(a,b,d,m,g,x,n){var B;d=B=class extends n{constructor(M){super(M);this.displayValueEnabled=!1;this.max=1;this.min=0;this.step=.1;this.type="slider";this.value=null}clone(){return new B({active:this.active,className:this.className,
disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,displayValueEnabled:this.displayValueEnabled,max:this.max,min:this.min,step:this.step,value:this.value})}};a.__decorate([b.property()],d.prototype,"displayValueEnabled",void 0);a.__decorate([b.property()],d.prototype,"max",void 0);a.__decorate([b.property()],d.prototype,"min",void 0);a.__decorate([b.property()],d.prototype,"step",void 0);a.__decorate([b.property()],d.prototype,"value",void 0);return d=
B=a.__decorate([x.subclass("esri.support.Action.ActionSlider")],d)})},"esri/widgets/LayerList/ListItemPanel":function(){define("require ../../chunks/tslib.es6 ../../core/Identifiable ../../core/maybe ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../Widget ./support/layerListUtils ../support/widget ../support/jsxFactory".split(" "),function(a,b,d,m,g,x,
n,B,M,k,w,e,f,l){d=class extends d.IdentifiableMixin(w){constructor(q,r){super(q,r);this.listItem=this.image=this.content=this._legend=null;this.open=!1;this.visible=!0}initialize(){this.addHandles(g.watch(()=>this.content,q=>this._createLegend(q),g.initial))}destroy(){this._legend=m.destroyMaybe(this._legend)}get className(){const {image:q}=this,r=this._getFirstWidget();return this._get("className")||(!q&&r?r.iconClass??"":"")}set className(q){this._override("className",q)}get disabled(){const {listItem:q,
_legend:r,content:c}=this;return q?Array.isArray(c)&&1<c.length?!1:r?!r.activeLayerInfos?.length||!q.visibleAtCurrentScale||!q.visible:!1:!0}set disabled(q){this._overrideIfSome("disabled",q)}get title(){const q=this._getFirstWidget();return this._get("title")||(q?.label??"")}set title(q){this._override("title",q)}render(){return l.tsx("div",{class:"esri-layer-list-panel"},this._renderContents())}_renderContent(q){const {_legend:r,disabled:c}=this;return!q||c?null:"legend"===q&&r?l.tsx("div",{class:this.classes("esri-layer-list-panel__content",
"esri-layer-list-panel__content--legend"),key:r},r.render()):"string"===typeof q?l.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--string"),innerHTML:q,key:q}):f.isWidget(q)?l.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--widget"),key:q},q.render()):q instanceof HTMLElement?l.tsx("div",{afterCreate:this._attachToNode,bind:q,class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--html-element"),
key:q}):null}_renderContents(){const {content:q}=this;return Array.isArray(q)?q.map(r=>this._renderContent(r)):this._renderContent(q)}_getLegendOptions(){const {listItem:q}=this;if(!q)return{};const {layer:r,view:c}=q;return r&&c?{view:c,layerInfos:[e.getLegendLayerInfo(r)]}:{}}async _createLegend(q){if(this._hasLegend(q)&&!this._legend){({default:q}=await new Promise((t,h)=>a(["../Legend"],u=>t(Object.freeze(Object.defineProperty({__proto__:null,default:u},Symbol.toStringTag,{value:"Module"}))),
h)));var {listItem:r}=this,c=new q(this._getLegendOptions());this._legend=c;this.notifyChange("className");this.notifyChange("title");q=g.watch(()=>[r?.view,r?.layer,r?.layer?.source,r?.layer?.parent],()=>this._updateLegend(c),g.initial);this.addHandles(q,"legends");this.scheduleRender()}}_hasLegend(q){return"legend"===q?!0:null!=q&&(Array.isArray(q)?q.includes("legend"):!1)}_attachToNode(q){q.appendChild(this)}_updateLegend(q){q.set(this._getLegendOptions());this.scheduleRender()}_getWidget(q){return"legend"===
q?this._legend:f.isWidget(q)?q:null}_getFirstWidget(){const {content:q}=this;if(Array.isArray(q)){let r=null;q.some(c=>{(c=this._getWidget(c))&&(r=c);return!!c});return r}return this._getWidget(q)}};b.__decorate([x.property()],d.prototype,"_legend",void 0);b.__decorate([x.property()],d.prototype,"className",null);b.__decorate([x.property()],d.prototype,"content",void 0);b.__decorate([x.property()],d.prototype,"disabled",null);b.__decorate([x.property()],d.prototype,"image",void 0);b.__decorate([x.property()],
d.prototype,"listItem",void 0);b.__decorate([x.property()],d.prototype,"title",null);b.__decorate([x.property()],d.prototype,"open",void 0);b.__decorate([x.property()],d.prototype,"visible",void 0);return d=b.__decorate([k.subclass("esri.widgets.LayerList.ListItemPanel")],d)})},"esri/widgets/support/SnappingControls/snappingLayerListUtils":function(){define(["exports","../../LayerList/support/layerListUtils"],function(a,b){const d=x=>m(x)||g(x),m=x=>{if(!("type"in x))return!1;switch(x.type){case "feature":case "geojson":case "csv":case "graphics":case "wfs":case "map-notes":case "oriented-imagery":case "scene":case "building-scene":return!0;
default:return!1}},g=x=>{const n=b.getNormalizedChildLayerProperty(x);if(null!=n&&x.hasOwnProperty(n)&&null!=x[n])for(const B of x[n])if(d(B))return!0;return!1};a.isValidSnappingLayer=d;a.isValidSnappingLayerGroup=g;a.isValidSnappingLayerSource=m;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/SnappingControls/SnappingListItem":function(){define("exports ../../../chunks/tslib.es6 ../../../core/arrayUtils ../../../core/Collection ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../LayerList/ListItem ../../LayerList/support/layerListUtils ./snappingLayerListUtils".split(" "),
function(a,b,d,m,g,x,n,B,M,k,w){var e;a.SnappingListItem=e=class extends M{constructor(f){super(f);this.children=new m;this.parent=null}get allChildrenEnabled(){return this.children.every(f=>f.enabled)??!1}get childLayerIds(){return this.children.map(f=>f.layer.id).toArray()}get enabled(){return null!=this.featureSource?this.featureSource.enabled:!1}get featureSource(){const {layer:f,getFeatureSnappingSources:l}=this;return l().find(q=>q.layer===f)}get hasChildrenEnabled(){return this.children.some(f=>
f.enabled)}_initializeChildLayers(f){f&&(f=f.filter(w.isValidSnappingLayer),super._initializeChildLayers(f))}_makeChildren(f){return f.map(l=>k.canDisplayLayer(l)?new e({layer:l,parent:this,view:this.view,getFeatureSnappingSources:this.getFeatureSnappingSources}):null).filter(d.isSome).reverse()}};b.__decorate([g.property()],a.SnappingListItem.prototype,"allChildrenEnabled",null);b.__decorate([g.property()],a.SnappingListItem.prototype,"children",void 0);b.__decorate([g.property()],a.SnappingListItem.prototype,
"childLayerIds",null);b.__decorate([g.property()],a.SnappingListItem.prototype,"enabled",null);b.__decorate([g.property()],a.SnappingListItem.prototype,"featureSource",null);b.__decorate([g.property({constructOnly:!0})],a.SnappingListItem.prototype,"getFeatureSnappingSources",void 0);b.__decorate([g.property()],a.SnappingListItem.prototype,"hasChildrenEnabled",null);b.__decorate([g.property()],a.SnappingListItem.prototype,"parent",void 0);a.SnappingListItem=e=b.__decorate([B.subclass("esri.widgets.support.SnappingControls.SnappingListItem")],
a.SnappingListItem);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/components/Prompt":function(){define("require exports ../icons ../../support/componentsUtils ../../support/Heading ../../support/widgetUtils ../../support/jsxFactory".split(" "),function(a,b,d,m,g,x,n){function B(k){requestAnimationFrame(()=>k.setFocus())}const M={base:"esri-editor__prompt",header:"esri-editor__prompt__header",heading:"esri-editor__prompt__header__heading",message:"esri-editor__prompt__message",
divider:"esri-editor__prompt__divider",actions:"esri-editor__prompt__actions"};b.Prompt=function({actions:k,context:w,headingLevel:e,message:f,title:l}){var q=k.secondary;let r;switch(w){case "danger":r="danger";break;case "info":r="brand";break;default:r="neutral"}k=n.tsx("calcite-button",{afterCreate:B,appearance:"solid","data-testid":"primary-prompt-button",key:"prompt-primary-button",kind:r,onclick:k.primary.action,scale:"m",width:q?"half":"full"},k.primary.label);q=q&&n.tsx("calcite-button",
{appearance:"outline","data-testid":"secondary-prompt-button",key:"prompt-secondary-button",kind:r,onclick:q.action,scale:"m",width:"half"},q.label);return n.tsx("calcite-scrim",{"data-testid":"prompt",key:"prompt"},n.tsx("div",{class:`${M.base}--${w}`},n.tsx("div",{class:M.header},n.tsx("calcite-icon",{icon:d.warningIcon}),n.tsx(g.Heading,{class:M.heading,level:e},l)),n.tsx("div",{class:M.message},f),n.tsx("div",{class:M.divider}),n.tsx("div",{class:M.actions},q,k)))};b.css=M;b.loadPromptComponents=
()=>m.loadCalciteComponents({button:()=>new Promise((k,w)=>a(["../../../chunks/calcite-button"],k,w)),icon:()=>new Promise((k,w)=>a(["../../../chunks/calcite-icon"],k,w)),scrim:()=>new Promise((k,w)=>a(["../../../chunks/calcite-scrim"],k,w))});Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/components/UpdateFeaturePanelContent":function(){define("exports ../../../intl/substitute ./FooterActions ./Notices ./PanelContent ../../support/Heading ../../support/widgetUtils ../../support/jsxFactory".split(" "),
function(a,b,d,m,g,x,n,B){a.UpdateFeaturePanelContent=function({editorViewModel:M,headingLevel:k,messages:w,messagesCommon:e,onDelete:f,onSave:l,renderAttachments:q,renderFeatureForm:r}){const {activeWorkflow:c,syncing:t}=M;if(!c)return null;var h=c.type,u="activeWorkflow"in c?c.activeWorkflow:void 0;const L=M.featureFormViewModel,K=u&&!u.hasPendingEdits||"update"===h&&!c.hasPendingEdits||t||L.updating,F="update"===h&&"create-features"!==u?.type?e.update:e.create;u="create-features"===h&&"create-new"===
c.createFeatureState;h="create-features"===h?c.numPendingFeatures:0;h=1<h?b.substitute(w.createFeaturesTemplate,{numFeatures:h}):F;const y=c.shouldShowAttachments&&!M.featureFormViewModel.activeRelationshipInput;k=L.inputs.every(p=>!p.visible)&&!y?B.tsx(g.PanelContentMessage,{key:"panel-content-message"},b.substitute(w.clickToFinishTemplate,{button:F})):B.tsx(g.PanelContentSection,{key:"panel-content-section"},B.tsx(m.Notices,{messages:w,workflow:c}),B.tsx(g.PanelContentSectionGroup,null,r(),y?B.tsx("div",
{key:"attachments"},B.tsx(x.Heading,{level:x.incrementHeadingLevel(k)},w.attachments),q()):null));return B.tsx(B.tsxFragment,null,B.tsx(g.PanelContent,{key:"attribute-panel-content",showScrimOverlay:u},k),B.tsx(d.FooterActions,{buttons:[{onClick:l,disabled:K,label:h},M.shouldShowDeleteButton?{appearance:"outline",onClick:f,disabled:t,kind:"danger",label:e.delete}:void 0]}))};a.loadUpdateFeaturePanelContentComponents=()=>Promise.all([d.loadFooterActionsComponents(),m.loadNoticesComponents(),g.loadPanelContentComponents()]);
Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/components/UploadDetails":function(){define("require exports ../../../geometry/support/meshErrors ../../../layers/graphics/sources/support/uploadAssetErrors ./FooterActions ./PanelContent ../../support/componentsUtils ../../support/widgetUtils ../../support/jsxFactory".split(" "),function(a,b,d,m,g,x,n,B,M){function k(r){const c=w(r);return c?M.tsx("div",{class:l.base,"data-testid":"upload-details",key:"upload-details-content"},
M.tsx("div",{class:l.status,key:"status"},c.iconContent,M.tsx("div",{class:l.titleWrapper,key:"text"},M.tsx("div",{class:l.title,key:"title"},c.title),M.tsx("div",{class:l.description,key:"description"},c.description))),f(r.upload)):null}function w({helpMessage:r,messages:c,upload:t}){switch(t.state){case "pending":const {title:h,description:u}=c.modelUploads.pending;return{title:h,description:u,iconContent:M.tsx("calcite-loader",{"aria-hidden":"true",class:l.loader,label:"",scale:"s",type:"determinate",
value:Math.min(Math.round(100*t.progress),1===t.progress?100:99)})};case "success":return{title:t}=c.modelUploads.success,{title:t,description:r||c.helpMessages3d.mesh,iconContent:M.tsx("calcite-icon",{class:B.classes(l.iconSuccess),icon:"check",scale:"l"})};case "error":return{title:r}=c.modelUploads.error,{title:r,description:e(t.error,c),iconContent:M.tsx("calcite-icon",{class:B.classes(l.iconError),icon:"exclamation-mark-circle",scale:"l"})};default:return null}}function e(r,c){if(!r)return null;
c=c.modelUploads.error.messages;switch(r.constructor){case d.NoModelError:return c.noModel;case d.MultipleModelsError:return c.multipleModels;case m.Convert3DFailedError:return c.conversionFailed;default:return c.default}}function f(r){return M.tsx("div",{class:l.fileList,key:"file-list"},r.files.map(c=>{var t=M.tsx,h={class:l.file,key:`file-${c.name}`},u=M.tsx,L=l.fileIcon;const K=c.name.split(".").pop()?.toLowerCase();return t.call(M,"div",h,u.call(M,"calcite-icon",{class:L,icon:(K?q[K]:null)??
"file",scale:"s"}),M.tsx("span",{class:l.fileName},c.name.split("/").pop()?.split("\\").pop()??""))}))}const l={base:"esri-editor__upload-details",status:"esri-editor__upload-details__status",titleWrapper:"esri-editor__upload-details__title-wrapper",title:"esri-editor__upload-details__title",description:"esri-editor__upload-details__description",loader:"esri-editor__upload-details__loader",iconSuccess:"esri-editor__upload-details__icon esri-editor__upload-details__icon--success",iconError:"esri-editor__upload-details__icon esri-editor__upload-details__icon--error",
fileList:"esri-editor__upload-details__file-list",file:"esri-editor__upload-details__file",fileIcon:"esri-editor__upload-details__file-icon",fileName:"esri-editor__upload-details__file-name"},q={glb:"file-shape",gltf:"file-shape",jpeg:"file-image",jpg:"file-image",png:"file-image",svg:"file-image",zip:"file-zip"};b.UploadDetails=function(r){const {messages:c,key:t,upload:h}=r;return M.tsx(M.tsxFragment,null,M.tsx(x.PanelContent,{key:t??"upload-details"},M.tsx(x.PanelContentSection,null,k(r))),"error"===
h.state?M.tsx(g.FooterActions,{buttons:[{onClick:()=>h.retry(),label:c.modelUploads.error.uploadNew,iconStart:"upload-to"}],key:"upload-details-footer-actions"}):null)};b.css=l;b.loadUploadDetailsComponents=()=>Promise.all([n.loadCalciteComponents({icon:()=>new Promise((r,c)=>a(["../../../chunks/calcite-icon"],r,c)),loader:()=>new Promise((r,c)=>a(["../../../chunks/calcite-loader"],r,c))}),g.loadFooterActionsComponents(),x.loadPanelContentComponents()]);Object.defineProperty(b,Symbol.toStringTag,
{value:"Module"})})},"esri/geometry/support/meshErrors":function(){define(["exports","../../core/Error"],function(a,b){class d extends b{constructor(){super("mesh-not-loaded","Mesh must be loaded before applying operations")}}class m extends b{constructor(){super("component-not-found","Provided component is not part of the list of components")}}class g extends b{constructor(){super("invalid-polygon","expected polygon to be a Polygon instance")}}class x extends b{constructor(){super("invalid-input:location",
"Expected location to be a Point instance")}}class n extends b{constructor(){super("invalid-input:no-layer","A layer is needed to convert the files")}}class B extends b{constructor(){super("invalid-input:no-model","No supported model found")}}class M extends b{constructor(){super("invalid-input:multiple-models","Multiple supported models found")}}a.ComponentNotFoundError=m;a.InvalidLocationError=x;a.InvalidPolygonError=g;a.MeshNotLoadedError=d;a.MultipleModelsError=M;a.NoLayerError=n;a.NoModelError=
B;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/sources/support/uploadAssetErrors":function(){define(["exports","../../../../core/Error"],function(a,b){class d extends b{constructor(){super("upload-assets:unsupported","Layer does not support asset uploads.",Error())}}class m extends b{constructor(){super("upload-assets:no-glb-support","Layer does not support glb.",Error())}}class g extends b{constructor(){super("upload-assets:no-supported-source","No supported external source found",
Error())}}class x extends b{constructor(){super("upload-assets:not-base-64","Expected gltf data in base64 format after conversion.",Error())}}class n extends b{constructor(){super("upload-assets:unable-to-prepare-options","Unable to prepare uploadAsset request options.",Error())}}class B extends b{constructor(e,f){super("upload-assets:bad-response",`Bad response. Uploaded ${e} items and received ${f} results.`,Error())}}class M extends b{constructor(e,f){super("upload-assets-layer:upload-failed",
`Failed to upload mesh file ${e}. Error code: ${f?.code??"-1"}. Error message: ${f?.messages??"unknown"}`,Error())}}class k extends b{constructor(e){super("upload-assets-layer:unsupported-format",`The service allowed us to upload an asset of FormatID ${e}, but it does not list it in its supported formats.`,Error())}}class w extends b{constructor(){super("upload-assets:convert3D-failed","convert3D failed.")}}a.BadResponseError=B;a.Convert3DFailedError=w;a.NoGlbSupportError=m;a.NoSupportedSourceError=
g;a.NotBase64Error=x;a.UnableToPrepareOptionsError=n;a.UnsupportedError=d;a.UnsupportedFormatUploadedError=k;a.UploadFailedError=M;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define("require ../chunks/tslib.es6 ../intl ../core/Logger ../core/promiseUtils ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./Attachments ./FeatureForm ./FeatureTemplates ./Spinner ./Widget ./Editor/css ./Editor/deprecationUtils ./Editor/EditorViewModel ./Editor/icons ./Editor/modelUploadUtils ./Editor/VisibleElements ./Editor/components/CreateFeaturesPanelContent ./Editor/components/FeatureList ./Editor/components/FooterActions ./Editor/components/Notices ./Editor/components/PanelContent ./Editor/components/PanelToolbar ./Editor/components/Prompt ./Editor/components/UpdateFeaturePanelContent ./Editor/components/UploadDetails ./FeatureTemplates/ItemList ./support/componentsUtils ./support/globalCss ./support/Heading ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory ../intl/substitute".split(" "),function(a,
b,d,m,g,x,n,B,M,k,w,e,f,l,q,r,c,t,h,u,L,K,F,y,p,I,R,D,E,N,C,P,H,J,z,A,v,G,O,U){const ca=m.getLogger("esri.widgets.Editor");d=class extends r{constructor(X,da){super(X,da);this._featureForm=new f;this._attachments=new e({visibleElements:{addSubmitButton:!1,cancelAddButton:!1,cancelUpdateButton:!1,deleteButton:!1,errorMessage:!1,progressBar:!1,updateButton:!1}});this._featureTemplates=new l({enableListScroll:!1,renderItemContentEnd:ha=>ha.supportsUpload?O.tsx("calcite-icon",{class:c.css.templateItemContentEnd,
icon:"upload-to",key:"upload-icon"}):null,renderItemLabel:ha=>ha.label,renderCustomGroupContent:ha=>this._renderCustomTemplateGroupContent(ha)});this._filterText="";this._prompt=null;this._spinner=new q;this.headingLevel=4;this.iconClass=c.css.widgetIcon;this.supportingWidgetDefaults=this.messagesTemplates=this.messagesCommon=this.messages=null;this.viewModel=new h;this.visibleElements=new K;this._renderSelectIcon=()=>O.tsx("calcite-icon",{icon:"cursor",slot:"content-start"});this.EditorPanel=({heading:ha,
key:ia},...ma)=>O.tsx("calcite-flow-item",{closable:!1,heading:ha,headingLevel:this.headingLevel,key:ia,loading:this._loading,onCalciteFlowItemBack:this._onBack},O.tsx(D.PanelToolbar,{editorViewModel:this.viewModel,messagesCommon:this.messagesCommon,visibleElements:this.visibleElements}),...ma);this._showDiscardEditsPrompt=()=>{const {messages:ha,activeWorkflow:ia}=this;if("create-features"===ia?.type&&L.isModelUpload(ia.data.creationInfo))return this._showPrompt("success"===ia.data.upload?.state?
ha.modelUploads.cancelPlacementPrompt:ha.modelUploads.cancelUploadPrompt);const ma="create"===ia?.type;return this._showPrompt({title:ha[ma?"cancelAddTitle":"cancelEditTitle"],message:ha[ma?"cancelAddWarningMessage":"cancelEditWarningMessage"],yesLabel:ha[ma?"discardFeature":"discardEdits"],noLabel:ha[ma?"continueAdding":"continueEditing"]})};this._showGenericCancelPrompt=()=>{const {messages:ha,messagesCommon:ia}=this;return this._showPrompt({title:ha.cancelRequestTitle,message:ha.cancelRequestWarningMessage,
yesLabel:ia.form.yes,noLabel:ia.form.no})};this._onSave=()=>{this.viewModel.saveWorkflow()};this._onDelete=()=>{const {messages:ha,messagesCommon:ia}=this;this._prompt={title:ha.deleteWarningTitle,message:ha.deleteWarningMessage,context:"danger",actions:{primary:{label:ia.delete,action:()=>{this.deleteFeatureFromWorkflow();this._clearPrompt()}},secondary:{label:ha.keepFeature,action:this._clearPrompt}}}};this._onToggleUpdateWorkflow=()=>this.viewModel.toggleUpdateWorkflow();this._onBack=ha=>{ha?.stopPropagation();
return this.viewModel.back()};this._onAttachmentAdd=()=>{const {activeWorkflow:ha}=this.viewModel;ha&&("create-features"===ha.type||"update"===ha.type&&"create-features"===ha.activeWorkflow?.type?(this._attachments.addFile(),ha.back()):this._attachments.addAttachment().then(()=>ha.back()))};this._onAttachmentUpdate=()=>{const {activeWorkflow:ha}=this.viewModel;ha&&("create-features"===ha.type?(this._attachments.updateFile(),ha.back()):this._attachments.updateAttachment().then(()=>ha.back()))};this._onAttachmentDelete=
()=>{const {messages:ha,messagesCommon:ia}=this;this._prompt={title:ha.deleteAttachmentWarningTitle,message:ha.deleteAttachmentWarningMessage,context:"danger",actions:{primary:{label:ia.delete,action:this._onAttachmentDeleteConfirm},secondary:{label:ha.keepAttachment,action:this._clearPrompt}}}};this._onAttachmentDeleteConfirm=async()=>{const ha=this._attachments,{activeWorkflow:ia}=this.viewModel;ia&&("create-features"===ia.type?ha.deleteFile():(await ha.deleteAttachment(ha.viewModel.activeAttachmentInfo),
this._clearPrompt()),await ia.back(),this._clearPrompt())};this._onAttachmentsError=ha=>{this._prompt={title:this.messages.errorWarningTitle,message:ha.message,context:"warning",actions:{primary:{label:this.messagesCommon.form.ok,action:this._clearPrompt}}}};this._clearPrompt=()=>{this._prompt=null}}initialize(){this.addHandles([x.watch(()=>z.incrementHeadingLevel(this.headingLevel),X=>{this._featureForm.headingLevel=X;this._featureTemplates.headingLevel=X},x.initial),x.on(()=>this.viewModel.activeWorkflow,
"cancel-request",({controller:X})=>{(this.viewModel.hasPendingEdits?this._showDiscardEditsPrompt():this._showGenericCancelPrompt()).then(da=>da?X.allow():X.deny())}),x.watch(()=>this.viewModel,X=>{this._featureForm.viewModel=X?.featureFormViewModel??null;this._attachments.viewModel=X?.attachmentsViewModel??null;this._featureTemplates.viewModel=X?.featureTemplatesViewModel??null;this._spinner.viewModel=X?.spinnerViewModel??null;X.showDiscardEditsPrompt=this._showDiscardEditsPrompt},x.initial),x.watch(()=>
this.view,(X,da)=>{const ha=`editor-${this.id}-spinner`;da?.ui.remove(this._spinner,ha);X?.ui.add(this._spinner,{key:ha,position:"manual"})},x.initial),x.when(()=>this.supportingWidgetDefaults,X=>{this._featureForm.set(X.featureForm);this._attachments.set(X.attachments);this._featureTemplates.set(X.featureTemplates);this.viewModel.sketchViewModel.set(X.sketch)},x.initial),x.when(()=>this._attachments?.error,X=>this._onAttachmentsError(X)),x.when(()=>this.viewModel?.failures,X=>{const {messages:da}=
this,[{error:ha,retry:ia,cancel:ma}]=X;this._prompt={title:da.errorWarningTitle,message:U.substitute(da.errorWarningMessageTemplate,{errorMessage:ha.message}),context:"warning",actions:{primary:{label:da.retry,action:()=>{ia();this._clearPrompt()}},secondary:{label:da.ignore,action:()=>{ma();this._clearPrompt()}}}}}),x.watch(()=>this.viewModel?.state,X=>{switch(X){case "awaiting-feature-to-update":case "ready":case "disabled":this._filterText="",this._featureTemplates.filterText=""}}),x.watch(()=>
this.viewModel.featureFormDisabled,X=>this._featureForm.disabled=X)])}destroy(){this._attachments.destroy();this._featureForm.destroy();this._featureTemplates.destroy()}loadDependencies(){return Promise.all([H.loadCalciteComponents({"flow-item":()=>new Promise((X,da)=>a(["../chunks/calcite-flow-item"],X,da)),flow:()=>new Promise((X,da)=>a(["../chunks/calcite-flow"],X,da)),icon:()=>new Promise((X,da)=>a(["../chunks/calcite-icon"],X,da)),list:()=>new Promise((X,da)=>a(["../chunks/calcite-list"],X,da))}),
F.loadCreateFeaturesPanelContentComponents(),y.loadFeatureListComponents(),p.loadFooterActionsComponents(),I.loadNoticesComponents(),R.loadPanelContentComponents(),D.loadPanelToolbarComponents(),E.loadPromptComponents(),N.loadUpdateFeaturePanelContentComponents(),C.loadUploadDetailsComponents()])}get _deleteButtonCommonInfo(){return{appearance:"outline",kind:"danger"}}get _loading(){const {viewModel:X}=this;return X.syncing||X.updating||this._attachments.submitting}get activeWorkflow(){return this.viewModel.activeWorkflow}get allowedWorkflows(){return this.viewModel.allowedWorkflows}set allowedWorkflows(X){this.viewModel.allowedWorkflows=
X}get useDeprecatedCreateWorkflow(){return this.viewModel.useDeprecatedCreateWorkflow}set useDeprecatedCreateWorkflow(X){this.viewModel.useDeprecatedCreateWorkflow=X}get hideTemplatesForInactiveLayers(){return this.viewModel.hideTemplatesForInactiveLayers}set hideTemplatesForInactiveLayers(X){this.viewModel.hideTemplatesForInactiveLayers=X}get label(){return this.messages?.widgetLabel??""}set label(X){this._overrideIfSome("label",X)}get labelOptions(){return this.viewModel.labelOptions}set labelOptions(X){this.viewModel.labelOptions=
X}get layerInfos(){return this.viewModel.layerInfos}set layerInfos(X){this.viewModel.layerInfos=X}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(X){this.viewModel.snappingOptions=X}get tooltipOptions(){return this.viewModel.tooltipOptions}set tooltipOptions(X){this.viewModel.tooltipOptions=X}get view(){return this.viewModel.view}set view(X){this.viewModel.view=X}startCreateWorkflowAtFeatureTypeSelection(){t.workflowDeprecation(ca,"startCreateWorkflowAtFeatureTypeSelection",
"startCreateFeaturesWorkflowAtFeatureTypeSelection");return this.viewModel.startCreateWorkflowAtFeatureTypeSelection()}startCreateFeaturesWorkflowAtFeatureTypeSelection(){return this.viewModel.startCreateFeaturesWorkflowAtFeatureTypeSelection()}startCreateWorkflowAtFeatureCreation(X){t.workflowDeprecation(ca,"startCreateWorkflowAtFeatureCreation","startCreateFeaturesWorkflowAtFeatureCreation");return this.viewModel.startCreateWorkflowAtFeatureCreation(X)}startCreateFeaturesWorkflowAtFeatureCreation(X){return this.viewModel.startCreateFeaturesWorkflowAtFeatureCreation(X)}startCreateWorkflowAtFeatureEdit(X){t.workflowDeprecation(ca,
"startCreateWorkflowAtFeatureEdit");return this.viewModel.startCreateWorkflowAtFeatureEdit(X)}startUpdateWorkflowAtFeatureSelection(){return this.viewModel.startUpdateWorkflowAtFeatureSelection()}startUpdateWorkflowAtMultipleFeatureSelection(X){return this.viewModel.startUpdateWorkflowAtMultipleFeatureSelection(X)}startUpdateWorkflowAtFeatureEdit(X){return this.viewModel.startUpdateWorkflowAtFeatureEdit(X)}deleteFeatureFromWorkflow(){return this.viewModel.deleteFeatureFromWorkflow()}cancelWorkflow(X){return this.viewModel.cancelWorkflow(X)}render(){const {viewModel:X}=
this,da=this.classes(c.css.base,J.globalCss.widget,J.globalCss.panel);return X?O.tsx("div",{class:da,key:"base"},O.tsx("calcite-flow",{key:"flow"},X.pageStack.map(ha=>this._renderPage(ha))),this._prompt?O.tsx(E.Prompt,{...this._prompt,headingLevel:this.headingLevel}):void 0):O.tsx("div",{class:da,key:"empty"})}_renderPage(X){switch(X){case "ready":return this._renderReady();case "awaiting-feature-creation-info":return this._renderAwaitingFeatureCreationInfo();case "creating-features-upload-details":return this._renderUploadDetails();
case "creating-features":return this._renderCreatingFeatures();case "editing-new-feature":case "editing-existing-feature":case "editing-attributes":return this._renderUpdateFeature();case "awaiting-update-feature-candidate":return this._renderFeatureList();case "adding-attachment":return this._renderAttachmentAdding();case "editing-attachment":return this._renderAttachmentEditing()}return O.tsx("div",{key:"empty-page"})}_renderAwaitingFeatureCreationInfo(){const {EditorPanel:X,messages:da}=this;return O.tsx(X,
{heading:da.selectTemplate,key:"templates-panel"},O.tsx(R.PanelContent,{key:"feature-templates"},O.tsx(R.PanelContentSection,null,this._featureTemplates.render())))}_renderUploadDetails(){const {EditorPanel:X,activeWorkflow:da,messages:ha}=this;if("create-features"!==da?.type)return null;const ia=da.data.upload;return ia?O.tsx(X,{heading:ha.createFeatures,key:"upload-details-panel"},O.tsx(C.UploadDetails,{helpMessage:this._helpMessage,messages:ha,upload:ia})):null}_renderCreatingFeatures(){const {EditorPanel:X,
activeWorkflow:da,messages:ha,messagesCommon:ia,headingLevel:ma,viewModel:ea}=this;return da?O.tsx(X,{heading:ha.createFeatures,key:"create-features-panel"},"create-features"===da.type&&0<da.numPendingFeatures||"update"===da.type&&"create-features"===da?.activeWorkflow?.type&&0<da.activeWorkflow?.numPendingFeatures?O.tsx(N.UpdateFeaturePanelContent,{editorViewModel:ea,headingLevel:ma,messages:ha,messagesCommon:ia,renderAttachments:()=>this._attachments.render(),renderFeatureForm:()=>this._featureForm.render(),
onDelete:this._onDelete,onSave:this._onSave}):O.tsx(F.CreateFeaturesPanelContent,{helpMessage:this._helpMessage})):null}_renderUpdateFeature(){const {EditorPanel:X,messages:da,messagesCommon:ha,headingLevel:ia,viewModel:ma}=this;return O.tsx(X,{heading:da.editFeature,key:"update-feature-panel"},O.tsx(N.UpdateFeaturePanelContent,{editorViewModel:ma,headingLevel:ia,messages:da,messagesCommon:ha,renderAttachments:()=>this._attachments.render(),renderFeatureForm:()=>this._featureForm.render(),onDelete:this._onDelete,
onSave:this._onSave}))}_renderCustomTemplateGroupContent(X){const {messages:da,viewModel:ha}=this;let ia=null;X.group.items.some(ma=>{ha.itemHasUnsupportedFields(ma)?ia=da.formFieldUnsupportedCreateError:ha.itemHasInvalidFormTemplate(ma)&&(ia=da.formFieldCreateError);return ia});return ia?O.tsx(I.Notice,{icon:u.warningIcon,message:ia}):null}_renderAttachmentAdding(){const {EditorPanel:X,_attachments:da,messages:ha,messagesCommon:ia}=this;return O.tsx(X,{heading:ha.addAttachment,key:"attachment-adding-panel"},
O.tsx(R.PanelContent,{key:"attachments"},da.render()),O.tsx(p.FooterActions,{buttons:[{label:da.submitting?ia.cancel:ia.add,disabled:da.submitting||!da.selectedFile,onClick:this._onAttachmentAdd}]}))}_renderAttachmentEditing(){const {EditorPanel:X,_attachments:da,activeWorkflow:ha,messages:ia,messagesCommon:ma}=this;return ha?O.tsx(X,{heading:ia.editAttachment,key:"attachment-editing-panel"},O.tsx(R.PanelContent,{key:"attachments"},da.render()),ha.shouldAllowAttachmentEditing?O.tsx(p.FooterActions,
{buttons:[{label:ma.update,disabled:da.submitting||!da.selectedFile,onClick:this._onAttachmentUpdate},{...this._deleteButtonCommonInfo,onClick:this._onAttachmentDelete,disabled:da.submitting,label:ma.delete}]}):void 0):null}_renderReady(){const {EditorPanel:X,messages:da,viewModel:ha,visibleElements:ia}=this,ma=this._helpMessage;return O.tsx(X,{heading:da.widgetLabel,key:"landing-panel"},O.tsx(R.PanelContent,{key:"landing-content"},ha.editableItems.length?[ia.editFeaturesSection?O.tsx(R.PanelContentSection,
{key:"edit-actions"},this._renderUpdateActions()):null,ia.createFeaturesSection?O.tsx(R.PanelContentSection,{key:"create-actions"},this._renderCreateActions()):null]:O.tsx(R.PanelContentMessage,{key:"no-content"},da.noEditableLayers)),ma?O.tsx("div",{class:c.css.helpMessage,key:"footer-actions",slot:"footer"},ma):void 0)}get _helpMessage(){const {activeWorkflow:X,messages:da,view:ha}=this,ia=X?.helpMessage;return ia?da["3d"===ha?.type?"helpMessages3d":"helpMessages2d"]?.[ia]:void 0}_renderUpdateActions(){const {messages:X,
messagesCommon:da,viewModel:ha}=this,ia={id:"select",label:da.select};return O.tsx("div",{class:c.css.updateActions,key:"update-actions"},O.tsx(z.Heading,{level:z.incrementHeadingLevel(this.headingLevel)},X.editFeatures),O.tsx("calcite-list",{class:c.css.updateActionsList,selectionAppearance:"border",selectionMode:"single"},P.renderItem({disabled:!ha.canUpdate,grouped:!1,item:ia,selectedItem:"awaiting-feature-to-update"===ha.activeWorkflow?.stepId?ia:void 0,renderIcon:this._renderSelectIcon,onItemSelect:this._onToggleUpdateWorkflow})))}_renderCreateActions(){return O.tsx("div",
{key:"create-actions"},O.tsx(z.Heading,{level:z.incrementHeadingLevel(this.headingLevel)},this.messages.createFeatures),O.tsx("div",{class:c.css.featureTemplatesContainer,key:"templates"},this._featureTemplates.render()))}_renderFeatureList(){const {EditorPanel:X,viewModel:da}=this,{activeWorkflow:ha}=da;if("update"!==ha?.type)return null;const ia=U.substitute(this.messages.multipleFeaturesTemplate,{total:ha.data.candidates.length});return O.tsx(X,{heading:ia,key:"feature-list"},O.tsx(y.FeatureList,
{editableItems:da.editableItems,filterText:this._filterText,id:this.id,messagesTemplates:this.messagesTemplates,workflow:ha,onFilterTextChange:ma=>this._filterText=ma,onSelectFeature:(ma,ea)=>da.selectFeature(ma,ea)}))}_showPrompt({title:X,message:da,yesLabel:ha,noLabel:ia}){const ma=g.createResolver(),{view:ea}=this,S=ea?.focused;this._prompt={title:X,message:da,context:"danger",actions:{primary:{label:ha,action:()=>ma.resolve(!0)},secondary:{label:ia,action:()=>ma.resolve(!1)}}};return ma.promise.finally(()=>
{this._clearPrompt();S&&ea?.focus()})}};b.__decorate([n.property()],d.prototype,"_featureForm",void 0);b.__decorate([n.property()],d.prototype,"_attachments",void 0);b.__decorate([n.property()],d.prototype,"_featureTemplates",void 0);b.__decorate([n.property()],d.prototype,"_filterText",void 0);b.__decorate([n.property()],d.prototype,"_prompt",void 0);b.__decorate([n.property()],d.prototype,"_spinner",void 0);b.__decorate([n.property()],d.prototype,"_deleteButtonCommonInfo",null);b.__decorate([n.property()],
d.prototype,"_loading",null);b.__decorate([n.property({readOnly:!0})],d.prototype,"activeWorkflow",null);b.__decorate([n.property()],d.prototype,"allowedWorkflows",null);b.__decorate([n.property()],d.prototype,"useDeprecatedCreateWorkflow",null);b.__decorate([n.property()],d.prototype,"headingLevel",void 0);b.__decorate([n.property()],d.prototype,"hideTemplatesForInactiveLayers",null);b.__decorate([n.property()],d.prototype,"iconClass",void 0);b.__decorate([n.property()],d.prototype,"label",null);
b.__decorate([n.property()],d.prototype,"labelOptions",null);b.__decorate([n.property()],d.prototype,"layerInfos",null);b.__decorate([n.property(),v.messageBundle("esri/widgets/Editor/t9n/Editor")],d.prototype,"messages",void 0);b.__decorate([n.property(),v.messageBundle("esri/t9n/common")],d.prototype,"messagesCommon",void 0);b.__decorate([n.property(),v.messageBundle("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],d.prototype,"messagesTemplates",void 0);b.__decorate([n.property()],d.prototype,
"snappingOptions",null);b.__decorate([n.property()],d.prototype,"tooltipOptions",null);b.__decorate([n.property()],d.prototype,"supportingWidgetDefaults",void 0);b.__decorate([n.property()],d.prototype,"view",null);b.__decorate([n.property(),G.vmEvent(["workflow-cancel","workflow-commit"])],d.prototype,"viewModel",void 0);b.__decorate([n.property({type:K,nonNullable:!0})],d.prototype,"visibleElements",void 0);b.__decorate([n.property()],d.prototype,"_helpMessage",null);return d=b.__decorate([w.subclass("esri.widgets.Editor")],
d)});