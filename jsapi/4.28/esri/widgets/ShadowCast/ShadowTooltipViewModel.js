// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.28/esri/copyright.txt for details.
//>>built
define("exports ../../chunks/tslib.es6 ../../core/Accessor ../../core/asyncUtils ../../core/handleUtils ../../core/maybe ../../core/reactiveUtils ../../core/screenUtils ../../core/throttle ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),function(b,d,p,q,r,k,l,m,n,e,w,x,y,t){var f;(function(a){a.PointerMove="pointer-move";a.Main="main"})(f||(f={}));b.ShadowTooltipViewModel=
class extends p{constructor(a){super(a);this._shadowTimeTask=this._accumulatedShadowTime=this._screenPoint=null;this._updateAccumulatedShadowTime=(g,h)=>{this._shadowTimeTask=k.abortMaybe(this._shadowTimeTask);this._shadowTimeTask=q.createTask(async c=>{const {results:u,ground:v}=await g.hitTest(h);this._accumulatedShadowTime=0!==u.length||v.mapPoint?await this.getDuration(h,c):null})};this._throttledUpdateAccumulatedShadowTime=n.throttle(this._updateAccumulatedShadowTime,300)}initialize(){this.addHandles(l.watch(()=>
({enabled:this.enabled,view:this.view}),({enabled:a,view:g})=>{a&&null!=g?this._startTracking(g):this._stopTracking()},l.syncAndInitial))}get screenPoint(){return this.enabled?this._screenPoint:null}get accumulatedShadowTime(){return this.enabled?this._accumulatedShadowTime:null}get testData(){return{setThrottleDelay:a=>{this._throttledUpdateAccumulatedShadowTime.remove();this._throttledUpdateAccumulatedShadowTime=n.throttle(this._updateAccumulatedShadowTime,a)}}}_startTracking(a){if(!this.hasHandles(f.Main)){var g=
()=>{this.hasHandles(f.PointerMove)||this.addHandles(a.on("pointer-move",c=>{this._screenPoint=c=m.createScreenPoint(c.x,c.y);this._throttledUpdateAccumulatedShadowTime(a,c)}),f.PointerMove)},h=()=>{this.removeHandles(f.PointerMove);this._accumulatedShadowTime=this._screenPoint=null};this.addHandles([this._throttledUpdateAccumulatedShadowTime,a.on("pointer-enter",g),a.on("pointer-leave",h),a.on("pointer-down",h),a.on("pointer-drag",h),a.on("pointer-up",g),a.on("click",c=>{this._screenPoint=c=m.createScreenPoint(c.x,
c.y);this._updateAccumulatedShadowTime(a,c)}),r.makeHandle(()=>{this._shadowTimeTask=k.abortMaybe(this._shadowTimeTask)})],f.Main);g()}}_stopTracking(){this.removeHandles(f.Main)}};d.__decorate([e.property()],b.ShadowTooltipViewModel.prototype,"getDuration",void 0);d.__decorate([e.property()],b.ShadowTooltipViewModel.prototype,"view",void 0);d.__decorate([e.property()],b.ShadowTooltipViewModel.prototype,"enabled",void 0);d.__decorate([e.property()],b.ShadowTooltipViewModel.prototype,"screenPoint",
null);d.__decorate([e.property()],b.ShadowTooltipViewModel.prototype,"accumulatedShadowTime",null);d.__decorate([e.property()],b.ShadowTooltipViewModel.prototype,"_screenPoint",void 0);d.__decorate([e.property()],b.ShadowTooltipViewModel.prototype,"_accumulatedShadowTime",void 0);d.__decorate([e.property()],b.ShadowTooltipViewModel.prototype,"_shadowTimeTask",void 0);b.ShadowTooltipViewModel=d.__decorate([t.subclass("esri.widgets.ShadowCast.ShadowTooltipViewModel")],b.ShadowTooltipViewModel);Object.defineProperty(b,
Symbol.toStringTag,{value:"Module"})});