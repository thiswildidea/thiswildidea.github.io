// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.28/esri/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Sketch/SketchViewModel":function(){define("require ../../chunks/tslib.es6 ../../symbols ../../core/Collection ../../core/Error ../../core/Evented ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../geometry/ellipsoidUtils ../../geometry/projection ../../geometry/support/coordsUtils ../../geometry/support/spatialReferenceUtils ../../layers/GraphicsLayer ../../views/3d/interactive/editingTools/isSupportedGraphicUtils ../../views/3d/interactive/editingTools/moveGraphic/isSupportedGraphic ../../views/3d/interactive/editingTools/reshapeGraphic/isSupportedGraphic ../../views/3d/interactive/editingTools/transformGraphic/isSupportedGraphic ../../views/draw/support/layerUtils ../../views/input/InputManager ../../views/interactive/keybindings ../../views/interactive/sketch/SketchLabelOptions ../../views/interactive/sketch/SketchTooltipOptions ../../views/interactive/snapping/SnappingManager ../../views/interactive/snapping/SnappingOptions ../../views/interactive/snapping/snappingUtils ../../views/support/hitTestSelectUtils ../../views/support/screenUtils ./support/OperationHandle ../../symbols/SimpleMarkerSymbol ../../symbols/SimpleFillSymbol ../../symbols/SimpleLineSymbol ../../symbols/MeshSymbol3D ../../symbols/FillSymbol3DLayer".split(" "),
function(a,b,c,q,d,f,g,B,D,k,u,h,e,l,m,A,p,C,I,r,v,E,H,K,J,R,z,T,X,aa,w,y,P,F,Q,V,ba,G,N,S){function fa(t){return"polygon"===t||"rectangle"===t||"circle"===t}function ja(t,L){na("undo",t.history.undo,t.history.redo,L)}function ka(t,L){na("redo",t.history.redo,t.history.undo,L)}function na(t,L,O,M){if(L=L.pop()){var W=L.updates,ia=[];M.forEach((da,U)=>{U=W[U];null!=U&&("geometry"in U&&null!=U.geometry&&(ia.push({geometry:da.geometry}),da.geometry=U.geometry),"symbol"in U&&null!=U.symbol&&(ia.push({symbol:da.symbol}),
da.symbol=U.symbol),"undo"in U&&(ia.push(U),U[t](da)))});O.push({updates:ia})}}function oa(t){return{updates:t.map(L=>({geometry:L.geometry}))}}function ma(t){return"requireError"in t&&"aborted"===t.requireError}const qa=t=>Object.freeze(Object.defineProperty({__proto__:null,default:t},Symbol.toStringTag,{value:"Module"})),ra={defaultZ:0},Y={reshapeOptions:{edgeOperation:"split",shapeOperation:"move",vertexOperation:"move"},enableMoveAllGraphics:!0,enableRotation:!0,enableScaling:!0,multipleSelectionEnabled:!0,
preserveAspectRatio:!1,toggleToolOnClick:!0,enableZ:!0,highlightOptions:{enabled:!0},tool:"transform"};f=class extends f.EventedAccessor{constructor(t){super(t);this._numUpdating=0;this._internalGraphicsLayer=new r({listMode:"hide",internal:!0,title:"SVM Internal"});this._operationHandle=null;this._viewHandlesKey="viewHandles";this.activeVertexSymbol=this.activeLineSymbol=this.activeFillSymbol=null;this.allowDeleteKey=!0;this.labelOptions=new T;this.layer=null;this.pointSymbol=new V({style:"circle",
size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}});this.polygonSymbol=new ba({color:[150,150,150,.2],outline:{color:[50,50,50],width:2}});this.polylineSymbol=new G({color:[130,130,130,1],width:2});this.meshSymbol=new N({symbolLayers:new q([new S])});this._snappingManager=null;this.tooltipOptions=new X;this.updateGraphics=new q;this.updateOnGraphicClick=!0;this.vertexSymbol=new V({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}});this._originalPopupEnabled=
this._viewReadyAbortController=this._moduleLoaderAbortController=null;this.defaultCreateOptions=ra;this.defaultUpdateOptions=Y;this.snappingOptions=new w}initialize(){this.addHandles([k.on(()=>this.view?.map?.layers,"change",t=>{t.removed.includes(this.layer)&&this.cancel()}),k.on(()=>this.layer?.graphics,"change",t=>{if(null!=this._operationHandle)for(const L of t.removed)this.updateGraphics.includes(L)&&(1<this.updateGraphics.length?this._operationHandle.removeFromSelection(L):this._operationHandle.cancel())}),
k.watch(()=>this.layer?.elevationInfo??null,t=>{t!==this._internalGraphicsLayer.elevationInfo&&(this.cancel(),this._internalGraphicsLayer.elevationInfo=t)},k.syncAndInitial),k.watch(()=>this.view,t=>{B.destroyMaybe(this._snappingManager);t&&(this._snappingManager=new aa.SnappingManager({view:t,options:this.snappingOptions}),"2d"===t.type?new Promise((L,O)=>a(["../../views/2d/interactive/editingTools"],L,O)):"3d"===t.type&&(new Promise((L,O)=>a(["../../views/3d/interactive/editingTools"],L,O)),new Promise((L,
O)=>a(["../../views/3d/layers/GraphicsLayerView3D"],M=>L(qa(M)),O))))},k.syncAndInitial),k.watch(()=>this.view?.spatialReference,(t,L)=>{t&&L&&!t.equals(L)&&this.cancel()})]);y.setupSnappingToggleHandles(this)}destroy(){this.cancel();this._removeDefaultLayer();this._snappingManager=B.destroyMaybe(this._snappingManager);this._set("view",null);this.emit("destroy")}get _defaultUpdateTool(){return"3d"===this.view?.type?"move":"transform"}get updating(){return 0<this._numUpdating||null!=this._snappingManager&&
this._snappingManager.updating}get activeTool(){return this._operationHandle?.tool??null}get activeComponent(){return this._operationHandle?.activeComponent??null}get createGraphic(){return null==this.activeComponent||"draw-3d"!==this.activeComponent.type&&"draw-2d"!==this.activeComponent.type?this._get("createGraphic"):this.activeComponent.graphic}get defaultCreateOptions(){return this._get("defaultCreateOptions")}set defaultCreateOptions(t){this._set("defaultCreateOptions",{...ra,...t})}get defaultUpdateOptions(){return this._get("defaultUpdateOptions")}set defaultUpdateOptions(t){this._set("defaultUpdateOptions",
{...Y,...t,reshapeOptions:{...Y.reshapeOptions,...t?.reshapeOptions},highlightOptions:{...Y.highlightOptions,...t?.highlightOptions}})}set snappingOptions(t){null!=this._snappingManager&&(this._snappingManager.options=t);this._set("snappingOptions",t)}get state(){const t=!(!this.view?.ready||!this.layer),L=this._operationHandle;return t&&L?"active":t?"ready":"disabled"}get view(){return this._get("view")}set view(t){const L=this._get("view");if(L){const {container:O,map:M}=L;O&&(L.cursor=null);M?.remove(this._internalGraphicsLayer);
this.removeHandles(this._viewHandlesKey);this.cancel()}this.removeHandles("view-ready");t&&this.addHandles(k.when(()=>t.ready,O=>{this.removeHandles(this._viewHandlesKey);O&&this.addHandles(this._generateViewHandles(t),this._viewHandlesKey)},k.syncAndInitial),"view-ready");this._set("view",t)}cancel(){this._moduleLoaderAbortController=B.abortMaybe(this._moduleLoaderAbortController);this._viewReadyAbortController=B.abortMaybe(this._viewReadyAbortController);this._operationHandle&&this._operationHandle.cancel()}complete(){this._operationHandle&&
this._operationHandle.complete()}delete(){const {state:t,updateGraphics:L}=this;if("active"===t&&L.length){const {activeTool:O,layer:M}=this,W=L.toArray();M.removeMany(W);this.cancel();this._emitDeleteEvent({graphics:W,tool:O})}}duplicate(){if("active"===this.state&&this.updateGraphics.length){const t=this.updateGraphics.map(L=>L.clone()).toArray();this.layer.addMany(t);this.emit("duplicate",{graphics:t,type:"duplicate"});return t}return[]}async create(t,L){this.cancel();await this._waitViewReady();
const {view:O,layer:M}=this;if(!O||"disabled"===this.state)throw M||this._logMissingLayer(),D.createAbortError();null!=O.activeTool&&(O.activeTool=null);if(t){J.addUniqueLayer(O,this._internalGraphicsLayer);var W=await this._setupCreateOperation(t,L);null==W||this.destroyed?O.map.remove(this._internalGraphicsLayer):(W.on("complete",()=>{if(W===this._operationHandle){const ia=this.createGraphic,da=this._operationHandle.cancelled;this._operationHandle.destroy();this._operationHandle=null;this._set("createGraphic",
null);this.view?.map&&this.view.map.remove(this._internalGraphicsLayer);W.cancelled||null==ia||M.add(ia);this.emit("create",{graphic:ia,state:da?"cancel":"complete",tool:t,toolEventInfo:null,type:"create"})}}),this._operationHandle=W,O.ready&&O.focus())}else this._logError("sketch:missing-parameter","Missing parameter 'tool'.")}async update(t,L){this.cancel();await this._waitViewReady();const {layer:O,view:M,state:W}=this;if(!M||"disabled"===W)throw O||this._logMissingLayer(),D.createAbortError();
null!=M.activeTool&&(M.activeTool=null);const ia=Array.isArray(t)?t:[t];null!=t&&ia?.length?ia.some(da=>da.layer!==O?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics missing from the supplied GraphicsLayer."),!0):null==da.geometry?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics with an unsupported geometry."),!0):!1)||(t=await this._setupUpdateOperation(ia,L),this.destroyed||null==t||ma(t)||(J.addUniqueLayer(M,
this._internalGraphicsLayer),this._setUpdateOperationHandle(t,L),this.emit("update",{graphics:ia,state:"start",aborted:!1,tool:t.tool,toolEventInfo:null,type:"update"}))):this._logError("sketch:missing-parameter","Missing parameter 'graphics'.")}async _updateSpatialReference(t){const L=this.view;if(L){this._beginAsyncOperation();t=Array.isArray(t)?t:[t];for(const O of t)null==O.geometry||"mesh"===O.geometry.type||I.equals(O.geometry.spatialReference,L.spatialReference)||(p.canProjectWithoutEngine(O.geometry.spatialReference,
L.spatialReference)||p.isLoaded()||await p.load(),O.geometry=p.project(O.geometry,L.spatialReference));this._endAsyncOperation()}else this._logMissingView()}undo(){this.canUndo()&&this._operationHandle?.undo()}redo(){this.canRedo()&&this._operationHandle?.redo()}canUndo(){return!(!this._operationHandle||!this._operationHandle.canUndo())}canRedo(){return!(!this._operationHandle||!this._operationHandle.canRedo())}toggleUpdateTool(){this._operationHandle&&this._operationHandle.toggleTool&&this._operationHandle.toggleTool()}async _getFirstHit(t){var L=
this.view;if(!L)return this._logMissingView(),null;if("2d"===L.type){const M=[];L.map.allLayers.forEach(W=>{"vector-tile"!==W.type&&"imagery"!==W.type||M.push(W)});L=await L.hitTest(t,{exclude:M});return P.findFirstGraphicHit(L.results)}const O=[L.map.ground];L.map.allLayers.forEach(M=>{"integrated-mesh"===M.type&&O.push(M)});t=await L.hitTest(t,{exclude:O});if(0<t.results.length){const M=t.results[0];if(null!=M&&"graphic"===M.type&&M.graphic&&(!t.ground.mapPoint||1>L.map.ground.opacity||t.ground.distance-
(M.distance??0)>-Math.min(3*t.ground.distance,"global"===L.viewingMode?A.getReferenceEllipsoid(L.renderCoordsHelper.spatialReference).radius/L.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY)))return M}return null}_generateViewHandles(t){return[t.on("immediate-click",async L=>{var O="active"===this.state&&"create"===this._operationHandle?.type;if("disabled"!==this.state&&!O&&this.updateOnGraphicClick){this._beginAsyncOperation();var M=await L.async(()=>this._getFirstHit(F.createScreenPointFromEvent(L)));
O=null;null!=M?(M=M.graphic,this.updateGraphics.includes(M)||M.layer===this.layer?(L.stopPropagation(),O=M):"2d"!==t.type||this._isComponentGraphic(M)||"active"!==this.state||this.cancel()):"active"===this.state&&this.cancel();null==O||this.updateGraphics.includes(O)||await this.update([O],{...this.defaultUpdateOptions,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions}});this._endAsyncOperation()}},R.ViewEventPriorities.WIDGET)]}async _setupCreateOperation(t,L){const O=this.view;if(!O)return this._logMissingView(),
null;t=await this._setupDrawGraphicTool(t,O,{hasZ:"3d"===O.type,...this.defaultCreateOptions,...L});if(null==t)return null;O.tools.add(t);O.activeTool=t;return this._setupCreateOperationHandle(t)}async _setupDrawGraphicTool(t,L,O){if("multipoint"===t&&"3d"===L.type)return this._logError("sketch:create","Multipoint geometries are not supported in SceneView."),null;if(!L)return this._logMissingView(),null;const M="rectangle"!==t,W="rectangle"!==t;t={view:L,mode:"rectangle"===t||"circle"===t?"hybrid":
"click",...O,snapToScene:!1,geometryType:t,graphicSymbol:this._getGraphicSymbolFromTool(t),snappingManager:this._snappingManager,forceUniformSize:W,centered:M};return"2d"===L.type?this._makeDrawGraphicTool2D(t):this._makeDrawGraphicTool3D(t)}async _makeDrawGraphicTool2D(t){const L=await this._requireModule(new Promise((O,M)=>a(["../../views/2d/interactive/editingTools"],O,M)));return ma(L)||this.destroyed?null:new L.module.DrawGraphicTool2D({...t,activeVertexSymbol:this.activeVertexSymbol,regularVerticesSymbol:this.vertexSymbol,
activeLineSymbol:this.activeLineSymbol,activeFillSymbol:fa(t.geometryType)?this.activeFillSymbol:null,tooltipOptions:this.tooltipOptions})}async _makeDrawGraphicTool3D(t){const L=await this._requireModule(new Promise((M,W)=>a(["../../views/3d/interactive/editingTools"],M,W)));if(ma(L)||this.destroyed)return null;const {elevationInfo:O}=this.layer;return new L.module.DrawGraphicTool3D({...t,elevationInfo:O,snapToScene:null!=O?"absolute-height"===O.mode:!0,labelOptions:this.labelOptions,tooltipOptions:this.tooltipOptions})}_setupCreateOperationHandle(t){const L=
this.view;if(!L)return this._logMissingView(),null;let O=null;const M=t.forceUniformSize,W=t.centered,ia=[L.on("key-down",U=>{if(U.key===z.sketchKeys.pan)U.stopPropagation(),U.repeat||(t.enabled=!1);else if(U.key===z.sketchKeys.complete)U.stopPropagation(),t.completeCreateOperation();else if(U.key!==z.sketchKeys.vertexAdd||U.repeat)U.key===z.sketchKeys.undo?(U.stopPropagation(),da.undo()):U.key===z.sketchKeys.redo?(U.stopPropagation(),da.redo()):U.key!==z.sketchKeys.constraint||"rectangle"!==t.geometryType&&
"circle"!==t.geometryType||U.repeat?U.key!==z.sketchKeys.center||U.repeat||(t.centered=!W,U.stopPropagation()):(t.forceUniformSize=!M,U.stopPropagation());else{const n=t.drawOperation.geometryType;if("polyline"===n||"polygon"===n||"multipoint"===n)U.stopPropagation(),t.drawOperation.commitStagedVertex()}},R.ViewEventPriorities.WIDGET),L.on("key-up",U=>{U.key===z.sketchKeys.pan?t.enabled=!0:U.key!==z.sketchKeys.constraint||"rectangle"!==t.geometryType&&"circle"!==t.geometryType?U.key===z.sketchKeys.center&&
(t.centered=W,U.stopPropagation()):(t.forceUniformSize=M,U.stopPropagation())},R.ViewEventPriorities.WIDGET),t.on("vertex-add",U=>{O=null==O?"start":"active";switch(U.operation){case "apply":this.emit("create",{graphic:t.graphic,state:O,tool:this.activeTool,toolEventInfo:U,type:"create"});break;case "undo":this._emitUndoEvent({graphics:[t.graphic],tool:t.geometryType});break;case "redo":this._emitRedoEvent({graphics:[t.graphic],tool:t.geometryType})}}),t.on("cursor-update",U=>{0<t.drawOperation.numCommittedVertices&&
this.emit("create",{graphic:t.graphic,state:"active",tool:this.activeTool,toolEventInfo:{coordinates:U.vertices[0].coordinates,type:"cursor-update"},type:"create"})}),t.on("vertex-remove",U=>{switch(U.operation){case "apply":this.emit("create",{graphic:t.graphic,state:"active",tool:this.activeTool,toolEventInfo:U,type:"create"});break;case "undo":this._emitUndoEvent({graphics:[t.graphic],tool:t.geometryType});break;case "redo":this._emitRedoEvent({graphics:[t.graphic],tool:t.geometryType})}}),t.on("complete",
U=>{this._set("createGraphic",U.graphic);O="complete";U.aborted?da&&da.cancel():da&&da.complete()}),k.watch(()=>this._getGraphicSymbolFromTool(t.geometryType),U=>{t.graphicSymbol=U})],da=new Q.CreateOperationHandle({activeComponent:t,tool:t.geometryType,type:"create",onEnd:()=>{ia.forEach(U=>U.remove());ia.length=0;L.tools?.remove(t)},undo:()=>{t.canUndo&&t.undo()},redo:()=>{t.canRedo&&t.redo()},canUndo:()=>t.canUndo,canRedo:()=>t.canRedo});return da}_getGraphicSymbolFromTool(t){switch(t){case "point":case "multipoint":return this.pointSymbol;
case "polyline":return this.polylineSymbol;case "circle":case "rectangle":case "polygon":return this.polygonSymbol;case "mesh":return this.meshSymbol}}async _setupUpdateOperation(t,L){const {layer:O,view:M}=this;if(!M)return this._logMissingView(),null;L={tool:this._defaultUpdateTool,...this.defaultUpdateOptions,...L,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions,...L?.reshapeOptions},highlightOptions:{...this.defaultUpdateOptions.highlightOptions,...L?.highlightOptions}};var W=L.tool;
for(var ia of t)O.remove(ia),O.add(ia);if("3d"===M.type){if(0===t.length)return null;switch(W){case "move":return this._setupMove3DOperation(t,L,M,W);case "reshape":if(1<t.length)return this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null;W=H.isSupportedGraphic(t[0]);if(W===v.SupportedGraphicResult.SUPPORTED)return this._setupReshape3DOperation(t[0],L,M);this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${v.isSupportedGraphicResultMessage(W)}).`);
return null;case "transform":return this._setupGraphicTransform3DOperation(t,L,M)}}switch(W){case "move":return this._setupMove2DOperation(t,L,M);case "reshape":if(1<t.length)return this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null;ia=H.isSupportedGraphic(t[0]);if(ia===v.SupportedGraphicResult.SUPPORTED)return this._setupTransformOrReshape2DOperation(t,W,L,M);this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${v.isSupportedGraphicResultMessage(ia)}).`);
return null;case "transform":return 1===t.length&&(ia=t[0].geometry?.type,"point"===ia||"multipoint"===ia)&&(W="reshape"),this._setupTransformOrReshape2DOperation(t,W,L,M)}}async _setupMove3DOperation(t,L,O,M,W=!1){for(var ia of t){const x=E.isSupportedGraphic(ia);if(x!==v.SupportedGraphicResult.SUPPORTED)return this._logError("sketch:move",`Move operation not supported for provided graphic(s) (${v.isSupportedGraphicResultMessage(x)}).`),null}ia=await this._requireModule(new Promise((x,Z)=>a(["../../views/3d/interactive/editingTools"],
x,Z)));if(ma(ia))return ia;const da=new ia.module.GraphicMoveTool({view:O,enableZ:L.enableZ,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions});O.tools.add(da);da.graphics.addMany(t);W||this.updateGraphics.addMany(t);const U=[],n=new Q.UpdateOperationHandle({activeComponent:da,tool:M,type:"update",onEnd:()=>{U.forEach(x=>x.remove());U.length=0;O.tools?.remove(da);da.destroyed||da.destroy()},undo:()=>{ja(n,this.updateGraphics.toArray());this._emitUndoEvent({graphics:this.updateGraphics.toArray(),
tool:M})},redo:()=>{ka(n,this.updateGraphics.toArray());this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:M})},addToSelection:x=>{this.updateGraphics.push(x);da.graphics.push(x);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[x],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:x=>{const Z=this.updateGraphics.indexOf(x);n.history.undo.forEach(ea=>ea.updates.splice(Z,1));n.history.redo.forEach(ea=>
ea.updates.splice(Z,1));this.updateGraphics.remove(x);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[x],type:"selection-change"},type:"update"});0===this.updateGraphics.length?n.complete():da.graphics.remove(x)},toggleTool:async()=>{if(1===this.updateGraphics.length&&!1!==L.toggleToolOnClick&&"transform"===M){var x=this.updateGraphics.at(0);H.isSupportedGraphic(x)===v.SupportedGraphicResult.SUPPORTED&&(n.onEnd(),
n.destroy(),x=await this._setupReshape3DOperation(x,L,O,!0),ma(x)||this._setUpdateOperationHandle(x,L))}}});U.push(...this._getHandlesForComponent(n,L),O.on("immediate-click",x=>this._getCommonUpdateOperationClickHandlers(n,x,L),R.ViewEventPriorities.WIDGET),O.on("key-down",x=>{this._getCommonUpdateOperationKeyDownHandlers(n,x)},R.ViewEventPriorities.WIDGET));return n}_setupGraphicTransform3DOperation(t,L,O,M=!1){if(1===t.length&&K.isSupportedGraphic(t[0])===v.SupportedGraphicResult.SUPPORTED){const W=
t[0],ia=W.geometry;if(null!=ia&&("point"===ia.type||"mesh"===ia.type))return this._setupPointTransform3DOperation(W,L,O);if(null!=ia&&("polygon"===ia.type||"polyline"===ia.type))return this._setupPolyTransform3DOperation(W,L,O,M)}return this._setupMove3DOperation(t,L,O,"transform",M)}async _setupPointTransform3DOperation(t,L,O){const {enableRotation:M,enableScaling:W,enableZ:ia}=L,da=await this._requireModule(new Promise((Z,ea)=>a(["../../views/3d/interactive/editingTools"],Z,ea)));if(ma(da))return da;
const U=new da.module.GraphicTransformTool({graphic:t,view:O,enableRotation:M,enableScaling:W,enableZ:ia,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions});O.tools.add(U);this.updateGraphics.add(t);const n=[],x=new Q.UpdateOperationHandle({activeComponent:U,tool:"transform",type:"update",onEnd:()=>{n.forEach(Z=>Z.remove());n.length=0;O.tools?.remove(U);U.destroyed||U.destroy()},undo:()=>{ja(x,this.updateGraphics.toArray());this._emitUndoEvent({graphics:this.updateGraphics.toArray(),
tool:"transform"})},redo:()=>{ka(x,this.updateGraphics.toArray());this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},addToSelection:async Z=>{this.updateGraphics.add(Z);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[Z],removed:[],type:"selection-change"},type:"update"});x.onEnd();x.destroy();Z=await this._setupMove3DOperation(this.updateGraphics.toArray(),L,O,"transform",!0);ma(Z)||this._setUpdateOperationHandle(Z,
L)},removeFromSelection:Z=>{this.updateGraphics.remove(Z);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[Z],type:"selection-change"},type:"update"});x.complete()},toggleTool:()=>{}});n.push(...this._getHandlesForComponent(x,L),O.on("immediate-click",Z=>this._getCommonUpdateOperationClickHandlers(x,Z,L),R.ViewEventPriorities.WIDGET),O.on("key-down",Z=>{this._getCommonUpdateOperationKeyDownHandlers(x,Z)},R.ViewEventPriorities.WIDGET));
return x}async _setupPolyTransform3DOperation(t,L,O,M=!1){const {enableRotation:W,enableScaling:ia,enableZ:da,preserveAspectRatio:U}=L,n=await this._requireModule(new Promise((ha,la)=>a(["../../views/3d/interactive/editingTools"],ha,la)));if(ma(n))return n;const x=new n.module.ExtentTransformTool({graphic:t,view:O,enableRotation:W,enableScaling:ia,enableZ:da,preserveAspectRatio:U,tooltipOptions:this.tooltipOptions});O.tools.add(x);M||this.updateGraphics.add(t);const Z=[],ea=new Q.UpdateOperationHandle({activeComponent:x,
tool:"transform",type:"update",onEnd:()=>{Z.forEach(ha=>ha.remove());Z.length=0;O.tools?.remove(x);x.destroyed||x.destroy()},canUndo:()=>x.canUndo,undo:()=>{x.undo();this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},canRedo:()=>x.canRedo,redo:()=>{x.redo();this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},addToSelection:async ha=>{this.updateGraphics.add(ha);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,
tool:this.activeTool,toolEventInfo:{added:[ha],removed:[],type:"selection-change"},type:"update"});ea.onEnd();ea.destroy();ha=await this._setupMove3DOperation(this.updateGraphics.toArray(),L,O,"transform",!0);ma(ha)||this._setUpdateOperationHandle(ha,L)},removeFromSelection:ha=>{this.updateGraphics.remove(ha);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[ha],type:"selection-change"},type:"update"});ea.complete()},
toggleTool:async()=>{if(1===this.updateGraphics.length&&!1!==L.toggleToolOnClick){var ha=this.updateGraphics.at(0);H.isSupportedGraphic(ha)===v.SupportedGraphicResult.SUPPORTED&&(ea.onEnd(),ea.destroy(),ha=await this._setupReshape3DOperation(ha,L,O,!0),ma(ha)||this._setUpdateOperationHandle(ha,L))}}});Z.push(...this._getHandlesForComponent(ea,L),O.on("immediate-click",ha=>this._getCommonUpdateOperationClickHandlers(ea,ha,L),R.ViewEventPriorities.WIDGET),O.on("key-down",ha=>this._getCommonUpdateOperationKeyDownHandlers(ea,
ha),R.ViewEventPriorities.WIDGET),O.on("key-down",ha=>{ha.key!==z.sketchKeys.constraint||ha.repeat||(x.preserveAspectRatio=!x.preserveAspectRatio,ha.stopPropagation())},R.ViewEventPriorities.WIDGET),O.on("key-up",ha=>{ha.key===z.sketchKeys.constraint&&(x.preserveAspectRatio=!x.preserveAspectRatio,ha.stopPropagation())},R.ViewEventPriorities.WIDGET));return ea}async _setupMove2DOperation(t,L,O){this.updateGraphics.addMany(t);await this._updateSpatialReference(t);const M=await this._getGraphicMover(t,
L,O);if(ma(M))return M;const W=new Q.UpdateOperationHandle({activeComponent:M,tool:"move",type:"update",onEnd:()=>{this._displayDefaultCursor();U.forEach(n=>n.remove());da.forEach(n=>n.remove());U=[];da=[];M.destroy();this._internalGraphicsLayer?.removeMany([...this.updateGraphics.toArray()])},undo:()=>{const n=this.updateGraphics.toArray();ja(W,n);W.refreshComponent();this._emitUndoEvent({graphics:n,tool:"move"})},redo:()=>{const n=this.updateGraphics.toArray();ka(W,n);W.refreshComponent();this._emitRedoEvent({graphics:n,
tool:"move"})},addToSelection:async n=>{await this._updateSpatialReference(n);this.updateGraphics.push(n);M.graphics=this.updateGraphics.toArray();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[n],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:n=>{const x=this.updateGraphics.indexOf(n);W.history.undo.forEach(ea=>ea.updates.splice(x,1));W.history.redo.forEach(ea=>ea.updates.splice(x,1));this.updateGraphics.remove(n);
const Z=this.updateGraphics.toArray();this.emit("update",{graphics:Z,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[n],type:"selection-change"},type:"update"});0===this.updateGraphics.length?W.complete():M.graphics=Z}});let ia=!1,da=[O.on("immediate-click",n=>this._getCommonUpdateOperationClickHandlers(W,n,L),R.ViewEventPriorities.WIDGET),O.on("key-down",n=>{this._getCommonUpdateOperationKeyDownHandlers(W,n);n.key!==z.sketchKeys.constraint||n.repeat||(ia=!0,M.enableMoveAllGraphics=
!M.enableMoveAllGraphics)},R.ViewEventPriorities.WIDGET),O.on("key-up",n=>{n.key===z.sketchKeys.constraint&&ia&&(ia=!1,M.enableMoveAllGraphics=!M.enableMoveAllGraphics)},R.ViewEventPriorities.WIDGET)],U=this._getHandlesForComponent(W,L);return W}async _setupReshape3DOperation(t,L,O,M=!1){const W=await this._requireModule(new Promise((x,Z)=>a(["../../views/3d/interactive/editingTools"],x,Z)));if(ma(W))return W;const ia=L.reshapeOptions,da=new W.module.GraphicReshapeTool({view:O,graphic:t,enableZVertex:L.enableZ&&
"move"===ia?.vertexOperation,enableZShape:L.enableZ&&"move"===ia?.shapeOperation,enableMoveGraphic:"move"===ia?.shapeOperation||"move-xy"===ia?.shapeOperation,enableMidpoints:"split"===ia?.edgeOperation,enableEdgeOffset:"offset"===ia?.edgeOperation,snappingManager:this._snappingManager,labelOptions:this.labelOptions,tooltipOptions:this.tooltipOptions});O.tools.add(da);M||this.updateGraphics.add(t);const U=[],n=new Q.UpdateOperationHandle({activeComponent:da,tool:"reshape",type:"update",onEnd:()=>
{U.forEach(x=>x.remove());U.length=0;O.tools?.remove(da);da.destroyed||da.destroy()},canUndo:()=>da.canUndo,undo:()=>{da.undo();this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"reshape"})},canRedo:()=>da.canRedo,redo:()=>{da.redo();this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:"reshape"})},addToSelection:async x=>{this.updateGraphics.add(x);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[x],
removed:[],type:"selection-change"},type:"update"});n.onEnd();n.destroy();x=await this._setupMove3DOperation(this.updateGraphics.toArray(),L,O,"transform",!0);ma(x)||this._setUpdateOperationHandle(x,L)},removeFromSelection:x=>{this.updateGraphics.remove(x);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[x],type:"selection-change"},type:"update"});n.complete()},toggleTool:async()=>{if(!1!==L.toggleToolOnClick){n.onEnd();
n.destroy();var x=await this._setupGraphicTransform3DOperation(this.updateGraphics.toArray(),L,O,!0);ma(x)||this._setUpdateOperationHandle(x,L)}}});U.push(...this._getHandlesForComponent(n,L),O.on("immediate-click",x=>this._getCommonUpdateOperationClickHandlers(n,x,L),R.ViewEventPriorities.WIDGET),O.on("key-down",x=>{this._getCommonUpdateOperationKeyDownHandlers(n,x)},R.ViewEventPriorities.WIDGET));return n}async _setupTransformOrReshape2DOperation(t,L,O,M){this.updateGraphics.addMany(t);await this._updateSpatialReference(t);
t="transform"===L?await this._getBox(t,O,M):await this._getReshape(t,O,M);if(ma(t))return t;const W=new Q.UpdateOperationHandle({activeComponent:t,type:"update",onEnd:()=>{da.forEach(U=>U.remove());ia.forEach(U=>U.remove());da=[];ia=[];W.activeComponent&&!W.activeComponent.destroyed&&W.activeComponent.destroy();this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray())},undo:()=>{ja(W,this.updateGraphics.toArray());W.refreshComponent();this._emitUndoEvent({graphics:this.updateGraphics.toArray(),
tool:W.tool})},redo:()=>{ka(W,this.updateGraphics.toArray());W.refreshComponent();this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:W.tool})},addToSelection:async U=>{var n=W.activeComponent;if("reshape"===n?.type){n=[...this.updateGraphics,U];this.updateGraphics.removeAll();W.onEnd();W.destroy();n=await this._setupMove2DOperation(n,O,M);if(ma(n))return;this._setUpdateOperationHandle(n,O)}else this.updateGraphics.add(U),n.graphics=this.updateGraphics.toArray(),n.refresh(),W.resetHistory();
this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[U],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:async U=>{const n=this.updateGraphics.indexOf(U);W.history.undo.forEach(Z=>Z.updates.splice(n,1));W.history.redo.forEach(Z=>Z.updates.splice(n,1));this.updateGraphics.remove(U);const x=this.updateGraphics.toArray();if(0===x.length)W.complete();else{const Z=x[0].geometry;1!==x.length||null==Z||"point"!==
Z.type&&"multipoint"!==Z.type?W.activeComponent.graphics=x:W.toggleTool()}this.emit("update",{graphics:x,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[U],type:"selection-change"},type:"update"})},toggleTool:async()=>{if(!(1<this.updateGraphics.length)){var U=this.updateGraphics.at(0),n=U.geometry;if(null==n||("reshape"!==W.tool||"point"!==n.type&&"multipoint"!==n.type)&&("transform"!==W.tool||"extent"!==n.type))n=null,"transform"===W.tool?n=await this._getReshape([U],
O,M):"reshape"===W.tool&&(n=await this._getBox([U],O,M)),ma(n)||(W.activeComponent?.destroy(),W.activeComponent=n,W.activeComponent&&(da.forEach(x=>x.remove()),da=this._getHandlesForComponent(W,O)))}}});let ia=[M.on("immediate-click",U=>this._getCommonUpdateOperationClickHandlers(W,U,O),R.ViewEventPriorities.WIDGET),M.on("key-down",U=>{this._getCommonUpdateOperationKeyDownHandlers(W,U);U.key===z.sketchKeys.constraint&&!U.repeat&&W&&(U=W.activeComponent)&&"box"===U.type&&(U.preserveAspectRatio=!U.preserveAspectRatio)},
R.ViewEventPriorities.WIDGET),M.on("key-up",U=>{U.key===z.sketchKeys.constraint&&W&&(U=W.activeComponent)&&"box"===U.type&&(U.preserveAspectRatio=!U.preserveAspectRatio)},R.ViewEventPriorities.WIDGET)],da=this._getHandlesForComponent(W,O);return W}async _getGraphicMover(t,L,O){const {enableMoveAllGraphics:M,highlightOptions:W}=L;L=await this._requireModule(new Promise((ia,da)=>a(["../../views/draw/support/GraphicMover"],U=>ia(qa(U)),da)));return ma(L)?L:new L.module.default({enableMoveAllGraphics:M,
highlightsEnabled:!!W?.enabled,indicatorsEnabled:!1,graphics:t,view:O,callbacks:{onGraphicMoveStart:({dx:ia,dy:da,graphic:U})=>{this._displayGrabbingCursor();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ia,dy:da,mover:U,type:"move-start"},type:"update"})},onGraphicMove:({dx:ia,dy:da,graphic:U})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ia,
dy:da,mover:U,type:"move"},type:"update"}),onGraphicMoveStop:({dx:ia,dy:da,graphic:U})=>{this._displayPointerCursor();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ia,dy:da,mover:U,type:"move-stop"},type:"update"})},onGraphicPointerOver:()=>this._displayPointerCursor(),onGraphicPointerOut:()=>this._displayDefaultCursor()}})}async _getBox(t,L,O){const {enableRotation:M,enableScaling:W,highlightOptions:ia,preserveAspectRatio:da}=
L;L=await this._requireModule(new Promise((U,n)=>a(["../../views/draw/support/Box"],x=>U(qa(x)),n)));return ma(L)?L:new L.module.default({graphics:t,enableRotation:M,enableScaling:W,highlightsEnabled:!!ia?.enabled,preserveAspectRatio:da,layer:this._internalGraphicsLayer,view:O,tooltipOptions:this.tooltipOptions,callbacks:{onMoveStart:U=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...U},type:"update"}),onMove:U=>this.emit("update",
{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...U},type:"update"}),onMoveStop:U=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...U},type:"update"}),onScaleStart:U=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...U},type:"update"}),onScale:U=>this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...U},type:"update"}),onScaleStop:U=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...U},type:"update"}),onRotateStart:U=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...U},type:"update"}),onRotate:U=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,
toolEventInfo:{...U},type:"update"}),onRotateStop:U=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...U},type:"update"})}})}async _getReshape(t,L,O){const M="split"===L.reshapeOptions?.edgeOperation,W="move"===L.reshapeOptions?.shapeOperation;L=!!L.highlightOptions?.enabled;const ia=await this._requireModule(new Promise((da,U)=>a(["../../views/draw/support/Reshape"],n=>da(qa(n)),U)));return ma(ia)?ia:new ia.module.default({enableMidpoints:M,
enableMovement:W,graphic:t[0],highlightsEnabled:L,layer:this._internalGraphicsLayer,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions,view:O,callbacks:{onReshapeStart:da=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...da},type:"update"}),onReshape:da=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...da},type:"update"}),onReshapeStop:({mover:da,
type:U})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:da,type:U},type:"update"}),onMoveStart:({dx:da,dy:U,mover:n,type:x})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:da,dy:U,mover:n,type:x},type:"update"}),onMove:({dx:da,dy:U,mover:n,type:x})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,
toolEventInfo:{dx:da,dy:U,mover:n,type:x},type:"update"}),onMoveStop:({dx:da,dy:U,mover:n,type:x})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:da,dy:U,mover:n,type:x},type:"update"}),onVertexAdd:({added:da,type:U,vertices:n})=>{da=da.map(x=>C.geometryToCoordinates(x.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:da,vertices:n,type:U},
type:"update"})},onVertexRemove:({removed:da,type:U,vertices:n})=>{da=da.map(x=>C.geometryToCoordinates(x.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{removed:da,vertices:n,type:U},type:"update"})}}})}_getHandlesForComponent(t,L){const O=t.activeComponent;if(!O)return[];switch(O.type){case "graphic-mover":return[O.on("graphic-click",({graphic:M,viewEvent:W})=>{W.native?.shiftKey&&(W.stopPropagation(),t.removeFromSelection(M))}),
O.on("graphic-move-start",M=>t.addToHistory(oa(M.allGraphics)))];case "box":return[O.on("graphic-click",M=>this._onTransformOrReshape2DGraphicClick(t,L,M)),O.on("move-start",M=>t.addToHistory(oa(M.graphics))),O.on("rotate-start",M=>t.addToHistory(oa(M.graphics))),O.on("scale-start",M=>t.addToHistory(oa(M.graphics)))];case "reshape":return[O.on("graphic-click",M=>this._onTransformOrReshape2DGraphicClick(t,L,M)),O.on("move-start",M=>t.addToHistory(oa([M.mover]))),O.on("reshape-start",M=>t.addToHistory(oa([M.graphic]))),
O.on("vertex-add",M=>t.addToHistory(oa([M.oldGraphic]))),O.on("vertex-remove",M=>t.addToHistory(oa([M.oldGraphic])))];case "move-3d":return[O.on("graphic-move-start",M=>{t.addToHistory(oa(M.allGraphics));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:0<M.allGraphics.length?M.allGraphics[0]:null,type:"move-start"},type:"update"})}),O.on("graphic-move",M=>{this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:M.dx,dy:M.dy,mover:0<M.allGraphics.length?M.allGraphics[0]:null,type:"move"},type:"update"})}),O.on("graphic-move-stop",M=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:0<M.allGraphics.length?M.allGraphics[0]:null,type:"move-stop"},type:"update"})}),O.on("immediate-click",M=>{M.shiftKey?this._toggleSelection([M.graphic],t,L):t.toggleTool()})];
case "transform-3d":return[O.on("record-undo",({record:M})=>{t.addToHistory({updates:[M]})}),O.on("graphic-translate-start",M=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:M.graphic,dx:M.dxScreen,dy:M.dyScreen,type:"move-start"},type:"update"})}),O.on("graphic-translate-stop",M=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:M.graphic,
dx:M.dxScreen,dy:M.dyScreen,type:"move-stop"},type:"update"})}),O.on("graphic-rotate-start",M=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:M.graphic,angle:M.angle,type:"rotate-start"},type:"update"})}),O.on("graphic-rotate-stop",M=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:M.graphic,angle:M.angle,type:"rotate-stop"},type:"update"})}),
O.on("graphic-scale-start",M=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:M.graphic,xScale:M.xScale,yScale:M.yScale,type:"scale-start"},type:"update"})}),O.on("graphic-scale-stop",M=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:M.graphic,xScale:M.xScale,yScale:M.yScale,type:"scale-stop"},type:"update"})}),O.on("graphic-translate",M=>
{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:M.graphic,dx:M.dxScreen,dy:M.dyScreen,type:"move"},type:"update"})}),O.on("graphic-rotate",M=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:M.graphic,angle:M.angle,type:"rotate"},type:"update"})}),O.on("graphic-scale",M=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",
aborted:!1,tool:this.activeTool,toolEventInfo:{mover:M.graphic,xScale:M.xScale,yScale:M.yScale,type:"scale"},type:"update"})}),O.on("immediate-click",M=>{M.shiftKey?this._toggleSelection([M.graphic],t,L):t.toggleTool()})];case "reshape-3d":return[O.on("reshape",M=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:M,type:"update"})}),O.on("move",M=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,
tool:this.activeTool,toolEventInfo:M,type:"update"})}),O.on("vertex-add",M=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:M,type:"update"})}),O.on("vertex-remove",M=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:M,type:"update"})}),O.on("immediate-click",M=>{M.shiftKey?this._toggleSelection([M.graphic],t,L):t.toggleTool()})]}}_onTransformOrReshape2DGraphicClick(t,
L,O){const {graphic:M,viewEvent:W}=O;if(W.native?.shiftKey&&M.layer===this.layer)return W.stopPropagation(),t.removeFromSelection(M);if(L.toggleToolOnClick)return W.stopPropagation(),t.toggleTool()}_setUpdateOperationHandle(t,L){this._operationHandle=t;const O=this.view?.map;this._disablePopup(L);t.on("complete",()=>{if(t===this._operationHandle){const M=this.updateGraphics.toArray(),W=this._operationHandle.tool;this._operationHandle.destroy();this._operationHandle=null;this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray());
this.updateGraphics.removeAll();O&&O.remove(this._internalGraphicsLayer);this._restorePopup(L);this.emit("update",{graphics:M,state:"complete",aborted:t.cancelled,tool:W,toolEventInfo:null,type:"update"})}})}async _getCommonUpdateOperationClickHandlers(t,L,O){const M=F.createScreenPointFromEvent(L),W=await L.async(()=>this._getFirstHit(M));null==W?t.complete():L.native.shiftKey&&this._toggleSelection([W.graphic],t,O)?L.stopPropagation():this.updateGraphics.includes(W.graphic)?L.stopPropagation():
t.complete()}_toggleSelection(t,L,O){const M=!!O.multipleSelectionEnabled;return t.some(W=>null==W?!1:M&&W.layer===this.layer?(this.updateGraphics.includes(W)?L.removeFromSelection(W):L.addToSelection(W),!0):!1)}_getCommonUpdateOperationKeyDownHandlers(t,L){if(t){var O=L.key;O===z.sketchKeys.undo&&t.canUndo()?(L.stopPropagation(),t.undo()):O===z.sketchKeys.redo&&t.canRedo()?(L.stopPropagation(),t.redo()):O===z.sketchKeys.cancel?(L.stopPropagation(),t.cancel()):this.allowDeleteKey&&z.sketchKeys.delete.includes(O)&&
this._onDeleteKey(L)}}_onDeleteKey(t){if(this._operationHandle&&"update"===this._operationHandle.type){var L=this.activeComponent,O=this.updateGraphics.toArray();null!=L&&"reshape-3d"!==L.type&&("reshape"!==L.type||1===O.length&&"point"===O[0].geometry?.type)&&(t.stopPropagation(),this.delete())}}_removeDefaultLayer(){this._internalGraphicsLayer&&(this.view?.map?.remove(this._internalGraphicsLayer),this._internalGraphicsLayer=B.destroyMaybe(this._internalGraphicsLayer))}_isComponentGraphic(t){const {activeComponent:L}=
this;return t&&null!=L?t.attributes?.esriSketchTool||"draw-2d"===L.type&&L.graphic===t||("box"===L.type||"reshape"===L.type)&&L.isUIGraphic(t):!1}_displayPointerCursor(){this.view?.container&&"pointer"!==this.view.cursor&&(this.view.cursor="pointer")}_displayGrabbingCursor(){this.view?.container&&"grabbing"!==this.view.cursor&&(this.view.cursor="grabbing")}_displayDefaultCursor(){this.view?.container&&null!==this.view.cursor&&(this.view.cursor=null)}_logError(t,L,O){g.getLogger(this).error(new d(t,
L,O))}async _requireModule(t){const L=new AbortController;this._moduleLoaderAbortController=L;t=await t;return this._moduleLoaderAbortController!==L||L.signal.aborted?{requireError:"aborted"}:{module:t}}_emitUndoEvent(t){this.emit("undo",{...t,type:"undo"})}_emitRedoEvent(t){this.emit("redo",{...t,type:"redo"})}_emitDeleteEvent(t){this.emit("delete",{...t,type:"delete"})}get test(){return{operationHandle:this._operationHandle,snappingManager:this._snappingManager,defaultUpdateOptions:Y}}wait(){return k.whenOnce(()=>
!this.updating)}_beginAsyncOperation(){this._numUpdating+=1;this.notifyChange("updating")}_endAsyncOperation(){--this._numUpdating;this.notifyChange("updating")}_disablePopupEnabled(t){return"3d"!==this.view?.type||this.updateOnGraphicClick||(t?.toggleToolOnClick??!1)}_disablePopup(t){this._disablePopupEnabled(t)&&this.view&&null==this._originalPopupEnabled&&(this._originalPopupEnabled=this.view.popupEnabled,this.view.popupEnabled=!1)}_restorePopup(t){this._disablePopupEnabled(t)&&this.view&&null!=
this._originalPopupEnabled&&(this.view.popupEnabled=this._originalPopupEnabled,this._originalPopupEnabled=null)}async _waitViewReady(){const t=this.view;t?(B.abortMaybe(this._viewReadyAbortController),this._viewReadyAbortController=new AbortController,await D.whenOrAbort(k.whenOnce(()=>t?.ready),this._viewReadyAbortController.signal)):this._logMissingView()}_logMissingView(){this._logError("sketch:missing-property",ca("view"))}_logMissingLayer(){this._logError("sketch:missing-property",ca("layer"))}};
b.__decorate([u.property()],f.prototype,"updating",null);b.__decorate([u.property()],f.prototype,"_operationHandle",void 0);b.__decorate([u.property({readOnly:!0})],f.prototype,"activeTool",null);b.__decorate([u.property()],f.prototype,"activeFillSymbol",void 0);b.__decorate([u.property()],f.prototype,"activeLineSymbol",void 0);b.__decorate([u.property()],f.prototype,"activeVertexSymbol",void 0);b.__decorate([u.property()],f.prototype,"allowDeleteKey",void 0);b.__decorate([u.property({readOnly:!0})],
f.prototype,"createGraphic",null);b.__decorate([u.property()],f.prototype,"defaultCreateOptions",null);b.__decorate([u.property()],f.prototype,"defaultUpdateOptions",null);b.__decorate([u.property({type:T,nonNullable:!0})],f.prototype,"labelOptions",void 0);b.__decorate([u.property()],f.prototype,"layer",void 0);b.__decorate([u.property({types:c.symbolTypes})],f.prototype,"pointSymbol",void 0);b.__decorate([u.property({types:c.symbolTypes})],f.prototype,"polygonSymbol",void 0);b.__decorate([u.property({types:c.symbolTypes})],
f.prototype,"polylineSymbol",void 0);b.__decorate([u.property()],f.prototype,"meshSymbol",void 0);b.__decorate([u.property({type:w,nonNullable:!0})],f.prototype,"snappingOptions",null);b.__decorate([u.property()],f.prototype,"_snappingManager",void 0);b.__decorate([u.property({readOnly:!0})],f.prototype,"state",null);b.__decorate([u.property({type:X,nonNullable:!0})],f.prototype,"tooltipOptions",void 0);b.__decorate([u.property({readOnly:!0})],f.prototype,"updateGraphics",void 0);b.__decorate([u.property()],
f.prototype,"updateOnGraphicClick",void 0);b.__decorate([u.property({types:c.symbolTypes})],f.prototype,"vertexSymbol",void 0);b.__decorate([u.property({value:null})],f.prototype,"view",null);f=b.__decorate([m.subclass("esri.widgets.Sketch.SketchViewModel")],f);const ca=t=>`Property '${t}' is missing on SketchViewModel.`;return f})},"esri/layers/GraphicsLayer":function(){define("../chunks/tslib.es6 ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ../core/support/OwningCollection ./Layer ./mixins/BlendLayer ./mixins/ScaleRangeLayer ../support/GraphicsCollection ../symbols/support/ElevationInfo".split(" "),
function(a,b,c,q,d,f,g,B,D,k,u,h){c=class extends D.BlendLayer(k.ScaleRangeLayer(B)){constructor(e){super(e);this.elevationInfo=null;this.graphics=new u.GraphicsCollection;this.screenSizePerspectiveEnabled=!0;this.type="graphics";this.internal=!1}destroy(){this.removeAll();this.graphics.destroy()}add(e){this.graphics.add(e);return this}addMany(e){this.graphics.addMany(e);return this}removeAll(){this.graphics.removeAll();return this}remove(e){this.graphics.remove(e)}removeMany(e){this.graphics.removeMany(e)}on(e,
l){return super.on(e,l)}graphicChanged(e){this.emit("graphic-update",e)}};a.__decorate([b.property({type:h})],c.prototype,"elevationInfo",void 0);a.__decorate([b.property(g.owningCollectionProperty(u.GraphicsCollection,"graphics"))],c.prototype,"graphics",void 0);a.__decorate([b.property({type:["show","hide"]})],c.prototype,"listMode",void 0);a.__decorate([b.property()],c.prototype,"screenSizePerspectiveEnabled",void 0);a.__decorate([b.property({readOnly:!0})],c.prototype,"type",void 0);a.__decorate([b.property({constructOnly:!0})],
c.prototype,"internal",void 0);return c=a.__decorate([f.subclass("esri.layers.GraphicsLayer")],c)})},"esri/views/3d/interactive/editingTools/isSupportedGraphicUtils":function(){define(["exports","../../../../core/has"],function(a,b){a.SupportedGraphicResult=void 0;(function(c){c[c.SUPPORTED=0]="SUPPORTED";c[c.GRAPHICS_LAYER_MISSING=1]="GRAPHICS_LAYER_MISSING";c[c.GEOMETRY_MISSING=2]="GEOMETRY_MISSING";c[c.GEOMETRY_TYPE_UNSUPPORTED=3]="GEOMETRY_TYPE_UNSUPPORTED";c[c.ELEVATION_MODE_UNSUPPORTED=4]="ELEVATION_MODE_UNSUPPORTED";
c[c.SYMBOL_TYPE_UNSUPPORTED=5]="SYMBOL_TYPE_UNSUPPORTED"})(a.SupportedGraphicResult||(a.SupportedGraphicResult={}));a.isSupportedGraphicResultMessage=function(c){switch(c){case a.SupportedGraphicResult.GRAPHICS_LAYER_MISSING:return"not owned by a graphics layer";case a.SupportedGraphicResult.GEOMETRY_MISSING:return"no geometry";case a.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED:return"the geometry type is not supported";case a.SupportedGraphicResult.ELEVATION_MODE_UNSUPPORTED:return"the elevation mode is not supported";
case a.SupportedGraphicResult.SYMBOL_TYPE_UNSUPPORTED:return"the symbol type is not supported"}return""};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/moveGraphic/isSupportedGraphic":function(){define(["exports","../../../../../core/has","../../../../../support/elevationInfoUtils","../isSupportedGraphicUtils"],function(a,b,c,q){a.isSupportedGraphic=function(d){if("graphics"!==d.layer?.type)return q.SupportedGraphicResult.GRAPHICS_LAYER_MISSING;
if(null==d.geometry)return q.SupportedGraphicResult.GEOMETRY_MISSING;switch(d.geometry.type){case "polygon":case "point":case "polyline":case "mesh":break;case "multipoint":case "extent":return q.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED;default:return q.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED}return"on-the-ground"!==c.getGraphicEffectiveElevationMode(d)&&c.hasGraphicFeatureExpressionInfo(d)?q.SupportedGraphicResult.ELEVATION_MODE_UNSUPPORTED:q.SupportedGraphicResult.SUPPORTED};Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/support/elevationInfoUtils":function(){define(["exports","../symbols/support/unitConversionUtils"],function(a,b){function c(h,e){return e?.mode?e.mode:(h?k:u).mode}function q(h,e){return null!=e?e:h?k:u}function d(h,e){return c(null!=h?h.hasZ:!1,e)}function f(h){const e=g(h);return d(h.geometry,e)}function g(h){return h.layer&&"elevationInfo"in h.layer?h.layer.elevationInfo:null}function B(h,e,l,m,A,p,C=null){if(null!=p){var I=null!=C?C.mode:"absolute-height";
if("on-the-ground"===I)return 0;({absoluteZ:p}=D(e,l,m,A,h,p));a:{C=null!=C?.offset?C.offset:0;switch(I){case "absolute-height":h=p-C;break a;case "relative-to-ground":h=p-((h.elevationProvider.getElevation(e,l,m,A,"ground")??0)+C);break a;case "relative-to-scene":h=p-((h.elevationProvider.getElevation(e,l,m,A,"scene")??0)+C);break a}h=void 0}return h}}function D(h,e,l,m,A,p){const C=null!=p.offset?p.offset:0;switch(p.mode){case "absolute-height":return{absoluteZ:l+C,elevation:0};case "on-the-ground":return l=
A.elevationProvider.getElevation(h,e,0,m,"ground")??0,{absoluteZ:l,elevation:l};case "relative-to-ground":return h=A.elevationProvider.getElevation(h,e,l,m,"ground")??0,{absoluteZ:l+h+C,elevation:h};case "relative-to-scene":return h=A.elevationProvider.getElevation(h,e,l,m,"scene")??0,{absoluteZ:l+h+C,elevation:h}}}const k={mode:"absolute-height",offset:0},u={mode:"on-the-ground",offset:null};a.absoluteHeightElevationInfo=k;a.elevationContextAffectsAlignment=function(h,e){if(null==e)return!1;({mode:e}=
e);return null!=e&&("scene"===h&&"relative-to-scene"===e||"ground"===h&&"absolute-height"!==e)};a.elevationInfoLikeEquals=function(h,e){return h===e||null!=h&&null!=e&&h.mode===e.mode&&h.offset===e.offset};a.elevationModeRequiredMessage=function(h,e,l){return l&&l.mode!==e?`${h} only support ${e} elevation mode`:null};a.elevationModeUnsupportedMessage=function(h,e,l){return l?.mode===e?`${h} do not support ${e} elevation mode`:null};a.featureExpressionUnsupportedMessage=function(h,e){return null!=
e?.featureExpressionInfo&&"0"!==e.featureExpressionInfo.expression?`${h} do not support featureExpressionInfo`:null};a.getConvertedElevation=function(h,e,l,m=null){return B(h,e.x,e.y,e.hasZ?e.z:0,e.spatialReference,l,m)};a.getConvertedElevationFromVector=function(h,e,l,m,A=null){return B(h,e[0],e[1],2<e.length?e[2]:0,l,m,A)};a.getEffectiveElevationInfo=q;a.getEffectiveElevationMode=c;a.getGeometryEffectiveElevationInfo=function(h,e){return q(null!=h?!!h.hasZ:!1,e)};a.getGeometryEffectiveElevationMode=
d;a.getGraphicEffectiveElevationInfo=function(h){var e=g(h);h=d(h.geometry,e);e=null!=e&&"on-the-ground"!==h?(e.offset??0)*b.getMetersPerUnit(e.unit??"meters"):0;return{mode:h,offset:e}};a.getGraphicEffectiveElevationMode=f;a.getZForElevationMode=function(h,e,l){if(l?.mode){var m=h.hasZ?h.z:0,A=null!=l.offset?l.offset:0;switch(l.mode){case "absolute-height":return m-A;case "on-the-ground":return 0;case "relative-to-ground":return h=(e.elevationProvider.getElevation(h.x,h.y,m,h.spatialReference,"ground")??
0)+A,m-h;case "relative-to-scene":return h=(e.elevationProvider.getElevation(h.x,h.y,m,h.spatialReference,"scene")??0)+A,m-h}}};a.hasGraphicFeatureExpressionInfo=function(h){if("on-the-ground"===f(h))return!1;h=g(h);h=h?.featureExpressionInfo?h.featureExpressionInfo.expression:null;return!(!h||"0"===h)};a.logInvalidElevationInfoWarning=function(h,e){e&&h.warn(".elevationInfo\x3d",e)};a.onTheGroundElevationInfo=u;a.zValueInAbsoluteHeightMode=D;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/views/3d/interactive/editingTools/reshapeGraphic/isSupportedGraphic":function(){define(["exports","../../../../../geometry/Circle","../../../../../support/elevationInfoUtils","../isSupportedGraphicUtils"],function(a,b,c,q){function d(f){if("graphics"!==f.layer?.type)return{result:q.SupportedGraphicResult.GRAPHICS_LAYER_MISSING,geometry:null};const {geometry:g}=f;if(null==g)return{result:q.SupportedGraphicResult.GEOMETRY_MISSING,geometry:null};if("on-the-ground"!==c.getGraphicEffectiveElevationMode(f)&&
c.hasGraphicFeatureExpressionInfo(f))return{result:q.SupportedGraphicResult.ELEVATION_MODE_UNSUPPORTED,geometry:null};const B=g.type;return"point"!==B&&"mesh"!==B&&"polyline"!==B&&("polygon"!==B||f.geometry instanceof b)?{result:q.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED,geometry:null}:{result:q.SupportedGraphicResult.SUPPORTED,geometry:g}}a.geometryOfSupportedGraphic=function(f){return d(f).geometry};a.isSupportedGraphic=function(f){return d(f).result};Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/geometry/Circle":function(){define("../chunks/tslib.es6 ../core/unitUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./ellipsoidUtils ./Point ./Polygon ./support/geodesicUtils ./support/webMercatorUtils ./support/WKIDUnitConversion".split(" "),function(a,b,c,q,d,f,g,B,D,k,u,h,e){var l;q=l=class extends k{constructor(...m){super(...m);this.center=null;this.geodesic=
!1;this.numberOfPoints=60;this.radius=1E3;this.radiusUnit="meters"}normalizeCtorArgs(m,A){if(!m?.center){if(m?.rings)return super.normalizeCtorArgs(m,A);m={center:m}}return{...super.normalizeCtorArgs(),...m,...A}}initialize(){var m=this.center;const A=this.numberOfPoints;this.hasZ=m?.hasZ??!1;if(0===this.rings.length&&m){var p=b.convertUnit(this.radius,this.radiusUnit,"meters"),C=m.spatialReference,I="geographic";if(C.isWebMercator)I="webMercator";else if(null!=(C.wkid&&e[C.wkid])||(C.wkt2||C.wkt)&&
b.isProjectedWKT(C.wkt2||C.wkt))I="projected";if(this.geodesic){let r;switch(I){case "webMercator":r=h.webMercatorToGeographic(m);break;case "projected":console.error("Creating a geodesic circle requires the center to be specified in web mercator or geographic coordinate system");break;case "geographic":r=m}m=this._createGeodesicCircle(r,p,A);"webMercator"===I&&(m=h.geographicToWebMercator(m))}else{let r;"webMercator"===I||"projected"===I?r=p/b.getMetersPerUnit(m.spatialReference):"geographic"===
I&&(r=b.lengthToDegrees(p,"meters",B.getReferenceEllipsoid(m.spatialReference).radius));m=this._createPlanarCircle(m,r,A)}this.spatialReference=m.spatialReference;this.addRing(m.rings[0])}}clone(){const {center:m,numberOfPoints:A,radius:p,radiusUnit:C,geodesic:I}=this;return new l({center:m?.clone(),numberOfPoints:A,radius:p,radiusUnit:C,geodesic:I})}_createGeodesicCircle(m,A,p){let C=0;const I=[];for(;360>C;){const r=[0,0];u.directGeodeticSolver(r,[m.x,m.y],C,A);this.hasZ&&r.push(m.z);I.push(r);
C+=360/p}I.push(I[0]);return new k(I)}_createPlanarCircle(m,A,p){const C=[],I=2*Math.PI/p;for(let v=0;v<p;++v){var r=I*v;r=[m.x+Math.cos(-r)*A,m.y+Math.sin(-r)*A];this.hasZ&&r.push(m.z);C.push(r)}C.push(C[0]);return new k({spatialReference:m.spatialReference,rings:[C]})}};a.__decorate([c.property({type:D})],q.prototype,"center",void 0);a.__decorate([c.property()],q.prototype,"geodesic",void 0);a.__decorate([c.property()],q.prototype,"numberOfPoints",void 0);a.__decorate([c.property()],q.prototype,
"radius",void 0);a.__decorate([c.property()],q.prototype,"radiusUnit",void 0);return q=l=a.__decorate([g.subclass("esri.geometry.Circle")],q)})},"esri/geometry/support/geodesicUtils":function(){define("exports ../../geometry ../../core/Error ../../core/unitUtils ./geodesicConstants ./spatialReferenceUtils ../Polyline ../Polygon ../Point ../SpatialReference".split(" "),function(a,b,c,q,d,f,g,B,D,k){function u(r){if(!r)return null;if(f.isGeographic(r)&&r.wkid){var v=d.spheroids[r.wkid];if(v)return v}if(r=
r.wkt2||r.wkt)if((r=d.wktSpheroidRegex.exec(r))&&2===r.length?(v=r[1].split(","),!v||3>v.length?r=null:(r=parseFloat(v[1]),v=parseFloat(v[2]),r=isNaN(r)||isNaN(v)?null:{a:r,f:0===v?0:1/v})):r=null,r)return r;return null}function h(r){r=u(r??k.WGS84);if(null!=r&&"b"in r&&"eSq"in r&&"radius"in r)return r;const v=r.a*(1-r.f);return Object.assign(r,{b:v,eSq:1-(v/r.a)**2,radius:(2*r.a+v)/3,densificationRatio:1E4/((2*r.a+v)/3)})}function e(r){return null!=r&&0>r?r+360:r}function l(r,v,E){const {a:H,eSq:K}=
h(E);E=Math.sqrt(K);const J=Math.sin(v[1]*d.toRadians);v=H*v[0]*d.toRadians;E=0<K?H*(1-K)*(J/(1-K*J*J)-1/(2*E)*Math.log((1-E*J)/(1+E*J)))*.5:H*J;r[0]=v;r[1]=E;return r}function m(r){return null!==u(r)}function A(r,v){if("polyline"!==r.type&&"polygon"!==r.type)throw new c("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");const {spatialReference:E}=r;if(!m(E))throw new c("geodesic-densify:invalid-spatial-reference","the input geometry spatial reference is not supported");
var H="polyline"===r.type?r.paths:r.rings;const K=[],J=[0,0],R=new I;for(const X of H){H=[];K.push(H);H.push([X[0][0],X[0][1]]);var z=X[0][0],T=X[0][1];let aa,w;for(let y=0;y<X.length-1;y++){aa=X[y+1][0];w=X[y+1][1];if(z===aa&&T===w)continue;const P=[z,T];C(R,[z,T],[aa,w],E);const {azimuth:F,distance:Q}=R;z=Q/v;if(1<z){for(T=1;T<=z-1;T++)p(J,P,F,T*v,E),H.push(J.slice(0));p(J,P,F,(Q+Math.floor(z-1)*v)/2,E);H.push(J.slice(0))}p(J,P,F,Q,E);H.push(J.slice(0));z=J[0];T=J[1]}}return"polyline"===r.type?
new g({paths:K,spatialReference:E}):new B({rings:K,spatialReference:E})}function p(r,v,E,H,K){const J=v[0]*d.toRadians;v=v[1]*d.toRadians;E=(E??0)*d.toRadians;const {a:R,b:z,f:T}=h(K);K=Math.sin(E);E=Math.cos(E);var X=(1-T)*Math.tan(v);v=1/Math.sqrt(1+X*X);const aa=X*v,w=Math.atan2(X,E);X=v*K;const y=X*X;var P=1-y,F=P*(R*R-z*z)/(z*z);const Q=1+F/16384*(4096+F*(-768+F*(320-175*F))),V=F/1024*(256+F*(-128+F*(74-47*F)));F=H/(z*Q);let ba=2*Math.PI,G,N,S,fa;for(;1E-12<Math.abs(F-ba);)S=Math.cos(2*w+F),
G=Math.sin(F),N=Math.cos(F),fa=V*G*(S+V/4*(N*(-1+2*S*S)-V/6*S*(-3+4*G*G)*(-3+4*S*S))),ba=F,F=H/(z*Q)+fa;H=aa*G-v*N*E;P=T/16*P*(4+T*(4-3*P));H=Math.atan2(aa*N+v*G*E,(1-T)*Math.sqrt(y+H*H))/d.toRadians;r[0]=(J+(Math.atan2(G*K,v*N-aa*G*E)-(1-P)*T*X*(F+P*G*(S+P*N*(-1+2*S*S)))))/d.toRadians;r[1]=H;return r}function C(r,v,E,H){var K=v[0]*d.toRadians;v=v[1]*d.toRadians;var J=E[0]*d.toRadians;E=E[1]*d.toRadians;const {a:R,b:z,f:T,radius:X}=h(H),aa=J-K;var w=Math.atan((1-T)*Math.tan(v)),y=Math.atan((1-T)*
Math.tan(E));H=Math.sin(w);w=Math.cos(w);const P=Math.sin(y);y=Math.cos(y);let F=1E3,Q=aa,V,ba,G;let N,S,fa;do{var ja=Math.sin(Q);var ka=Math.cos(Q);G=Math.sqrt(y*ja*y*ja+(w*P-H*y*ka)*(w*P-H*y*ka));if(0===G)return r.distance=0,r.azimuth=void 0,r.reverseAzimuth=void 0,r;ka=H*P+w*y*ka;N=Math.atan2(G,ka);S=w*y*ja/G;ba=1-S*S;ja=ka-2*H*P/ba;isNaN(ja)&&(ja=0);fa=T/16*ba*(4+T*(4-3*ba));V=Q;Q=aa+(1-fa)*T*S*(N+fa*G*(ja+fa*ka*(-1+2*ja*ja)))}while(1E-12<Math.abs(Q-V)&&0<--F);if(0===F)return H=Math.acos(Math.sin(v)*
Math.sin(E)+Math.cos(v)*Math.cos(E)*Math.cos(J-K))*X,K=J-K,r.azimuth=Math.atan2(Math.sin(K)*Math.cos(E),Math.cos(v)*Math.sin(E)-Math.sin(v)*Math.cos(E)*Math.cos(K))/d.toRadians,r.distance=H,r.reverseAzimuth=void 0,r;K=ba*(R*R-z*z)/(z*z);v=K/1024*(256+K*(-128+K*(74-47*K)));J=Math.atan2(w*Math.sin(Q),w*P*Math.cos(Q)-H*y);r.azimuth=Math.atan2(y*Math.sin(Q),w*P-H*y*Math.cos(Q))/d.toRadians;r.distance=z*(1+K/16384*(4096+K*(-768+K*(320-175*K))))*(N-v*G*(ja+v/4*(ka*(-1+2*ja*ja)-v/6*ja*(-3+4*G*G)*(-3+4*ja*
ja))));r.reverseAzimuth=J/d.toRadians;return r}class I{constructor(r=0,v,E){this.distance=r;this.azimuth=v;this.reverseAzimuth=E}}a.InverseGeodeticSolverResult=I;a.directGeodeticSolver=p;a.geodesicAreas=function(r,v="square-meters"){if(r.some(J=>!m(J.spatialReference)))throw new c("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");const E=[];for(var H=0;H<r.length;H++){var K=r[H];const {radius:J,densificationRatio:R}=h(K.spatialReference);E.push(A(K,
J*R))}r=[];H=[0,0];K=[0,0];for(let J=0;J<E.length;J++){const {rings:R,spatialReference:z}=E[J];let T=0;for(let X=0;X<R.length;X++){const aa=R[X];l(H,aa[0],z);l(K,aa[aa.length-1],z);let w=K[0]*H[1]-H[0]*K[1];for(let y=0;y<aa.length-1;y++)l(H,aa[y+1],z),l(K,aa[y],z),w+=K[0]*H[1]-H[0]*K[1];T+=w}T=q.convertUnit(T,"square-meters",v);r.push(T/-2)}return r};a.geodesicDensify=A;a.geodesicDistance=function(r,v,E="meters"){if(!r||!v)throw new c("geodesic-distance:missing-parameters","one or both input parameters are missing");
if(!r.spatialReference||!v.spatialReference)throw new c("geodesic-distance:invalid-parameters","one or both input points do not have a spatial reference");if(!f.equals(r.spatialReference,v.spatialReference))throw new c("geodesic-distance:invalid-parameters","spatial references of input parameters do not match");const {spatialReference:H}=r;if(!m(H))throw new c("geodesic-distance:not-supported","input geometry spatial reference is not supported");if(r.x===v.x&&r.y===v.y)return new I(0,0,0);const K=
new I;C(K,[r.x,r.y],[v.x,v.y],H);K.distance=q.convertUnit(K.distance,"meters",E);K.azimuth=e(K.azimuth);K.reverseAzimuth=e(K.reverseAzimuth);return K};a.geodesicLengths=function(r,v="meters"){if(!r)throw new c("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(r.some(K=>!m(K.spatialReference)))throw new c("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");const E=[];for(let K=0;K<r.length;K++){var H=r[K];const {spatialReference:J}=
H;H="polyline"===H.type?H.paths:H.rings;let R=0;for(let z=0;z<H.length;z++){const T=H[z];let X=0;for(let aa=1;aa<T.length;aa++){const w=T[aa-1][0],y=T[aa][0],P=T[aa-1][1],F=T[aa][1];if(P!==F||w!==y){const Q=new I;C(Q,[w,P],[y,F],J);X+=Q.distance}}R+=X}R=q.convertUnit(R,"meters",v);E.push(R)}return E};a.inverseGeodeticSolver=C;a.isSupported=m;a.pointFromDistance=function(r,v,E){if(!r||null==v||null==E)throw new c("point-from-distance:missing-parameters","one or more input parameters are missing or undefined");
if(0>E||360<E)throw new c("point-from-distance:-of-bounds","azimuth is restricted to angles between, and including, 0\u00b0 to 360\u00b0 degrees");if(!r.spatialReference)throw new c("point-from-distance:missing-spatial-reference","the input point must have a spatial reference");const {spatialReference:H}=r;if(!m(H))throw new c("geodesic-distance:not-supported","input geometry spatial reference is not supported");const K=[0,0];p(K,[r.x,r.y],E,v,H);return new D({x:K[0],y:K[1],spatialReference:H})};
Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/transformGraphic/isSupportedGraphic":function(){define(["exports","../../../../../core/has","../../../../../support/elevationInfoUtils","../isSupportedGraphicUtils"],function(a,b,c,q){a.isSupportedGraphic=function(d){if("graphics"!==d.layer?.type)return q.SupportedGraphicResult.GRAPHICS_LAYER_MISSING;if(null==d.geometry)return q.SupportedGraphicResult.GEOMETRY_MISSING;switch(d.geometry.type){case "point":break;
case "polygon":case "polyline":case "multipoint":case "extent":case "mesh":return q.SupportedGraphicResult.SUPPORTED;default:return q.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED}const f=null!=d.symbol&&"point-3d"===d.symbol.type&&d.symbol.symbolLayers;return f&&f.some(g=>"object"===g.type)?"on-the-ground"!==c.getGraphicEffectiveElevationMode(d)&&c.hasGraphicFeatureExpressionInfo(d)?q.SupportedGraphicResult.ELEVATION_MODE_UNSUPPORTED:q.SupportedGraphicResult.SUPPORTED:q.SupportedGraphicResult.SYMBOL_TYPE_UNSUPPORTED};
Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/draw/support/layerUtils":function(){define(["exports"],function(a){a.addUniqueLayer=function(b,c,q){if(c&&b?.map){({map:b}=b);var d=b.layers.find(f=>f===c);d||b.add(c,q);d&&null!=q&&b.layers.reorder(d,q)}};a.findLayerView=function(b,c){const q="subtype-sublayer"===c?.type?c.parent:c;return b.allLayerViews.find(d=>{d=d.layer;return d===q||"sublayers"in d&&null!=d.sublayers&&d.sublayers.includes(q)})};Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/keybindings":function(){define(["exports"],function(a){a.sketchKeys={redo:"r",undo:"z",center:"Alt",constraint:"Shift",cancel:"Escape",delete:["Backspace","Delete"],complete:"Enter",vertexAdd:"f",pan:" "};a.snappingKeys={toggle:"Control"};a.tooltipKeys={enterInputMode:"Tab",commit:"Enter",discard:"Escape",next:"Tab"};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/sketch/SketchLabelOptions":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,c,q,d,f,g){b=class extends b{constructor(B){super(B);this.enabled=!1}};a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"enabled",void 0);return b=a.__decorate([g.subclass("esri.views.interactive.sketch.SketchLabelOptions")],b)})},"esri/views/interactive/sketch/SketchTooltipOptions":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./SketchTooltipElevationOptions ./SketchTooltipVisibleElements".split(" "),
function(a,b,c,q,d,f,g,B,D){b=class extends b{constructor(k){super(k);this.inputEnabled=this.enabled=!1;this.elevation=new B.SketchTooltipElevationOptions;this.visibleElements=new D.SketchTooltipVisibleElements;this.visualVariables=null}toJSON(){return{enabled:this.enabled,elevation:this.elevation,visibleElements:this.visibleElements}}};a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"enabled",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"inputEnabled",
void 0);a.__decorate([c.property({type:B.SketchTooltipElevationOptions,nonNullable:!0})],b.prototype,"elevation",void 0);a.__decorate([c.property({type:D.SketchTooltipVisibleElements,nonNullable:!0})],b.prototype,"visibleElements",void 0);a.__decorate([c.property()],b.prototype,"visualVariables",void 0);return b=a.__decorate([g.subclass("esri.widgets.Sketch.SketchTooltipOptions")],b)})},"esri/views/interactive/sketch/SketchTooltipElevationOptions":function(){define("exports ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,c,q,d,f,g,B){a.SketchTooltipElevationOptions=class extends c{constructor(D){super(D);this.mode="absolute-height"}toJSON(){return{mode:this.mode}}};b.__decorate([q.property({type:String,nonNullable:!0})],a.SketchTooltipElevationOptions.prototype,"mode",void 0);a.SketchTooltipElevationOptions=b.__decorate([B.subclass("esri.widgets.Sketch.SketchTooltipOptions.ElevationOptions")],a.SketchTooltipElevationOptions);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/sketch/SketchTooltipVisibleElements":function(){define("exports ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,c,q,d,f,g,B){a.SketchTooltipVisibleElements=class extends c{constructor(D){super(D);this.elevation=this.distance=this.area=!0;this.helpMessage=!1;this.totalLength=this.size=this.scale=this.rotation=this.radius=this.orientation=!0}toJSON(){return{area:this.area,distance:this.distance,elevation:this.elevation,helpMessage:this.helpMessage,orientation:this.orientation,radius:this.radius,rotation:this.rotation,scale:this.scale,size:this.size,totalLength:this.totalLength}}};b.__decorate([q.property({type:Boolean,
nonNullable:!0})],a.SketchTooltipVisibleElements.prototype,"area",void 0);b.__decorate([q.property({type:Boolean,nonNullable:!0})],a.SketchTooltipVisibleElements.prototype,"distance",void 0);b.__decorate([q.property({type:Boolean,nonNullable:!0})],a.SketchTooltipVisibleElements.prototype,"elevation",void 0);b.__decorate([q.property({type:Boolean,nonNullable:!0})],a.SketchTooltipVisibleElements.prototype,"helpMessage",void 0);b.__decorate([q.property({type:Boolean,nonNullable:!0})],a.SketchTooltipVisibleElements.prototype,
"orientation",void 0);b.__decorate([q.property({type:Boolean,nonNullable:!0})],a.SketchTooltipVisibleElements.prototype,"radius",void 0);b.__decorate([q.property({type:Boolean,nonNullable:!0})],a.SketchTooltipVisibleElements.prototype,"rotation",void 0);b.__decorate([q.property({type:Boolean,nonNullable:!0})],a.SketchTooltipVisibleElements.prototype,"scale",void 0);b.__decorate([q.property({type:Boolean,nonNullable:!0})],a.SketchTooltipVisibleElements.prototype,"size",void 0);b.__decorate([q.property({type:Boolean,
nonNullable:!0})],a.SketchTooltipVisibleElements.prototype,"totalLength",void 0);a.SketchTooltipVisibleElements=b.__decorate([B.subclass("esri.widgets.Sketch.SketchTooltipOptions.VisibleElements")],a.SketchTooltipVisibleElements);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingManager":function(){define("exports ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Evented ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../geometry/projection ../../../support/elevationInfoUtils ../sketch/normalizedPoint ./Settings ./SnappingDomain ./snappingFactory ./SnappingOptions ./snappingPointUtils ./snappingUtils ./candidates/IntersectionSnappingCandidate ../support/viewUtils".split(" "),
function(a,b,c,q,d,f,g,B,D,k,u,h,e,l,m,A,p,C,I,r,v,E){function H({coordinateHelper:J,elevationInfo:R}){return J.hasZ()?e.absoluteHeightElevationInfo:R}a.SnappingManager=class extends q.EventedMixin(c){constructor(J){super(J);this.options=new C;this.snappingEnginesFactory=p.defaultSnappingEnginesFactory;this._engines=[];this._currentMainCandidate=null;this._currentOtherActiveCandidates=[];this._currentSnappedType=K.MAIN}initialize(){this.addHandles([f.watch(()=>{const {effectiveFeatureEnabled:J,effectiveSelfEnabled:R,
touchSensitivityMultiplier:z,distance:T}=this.options;return{effectiveFeatureEnabled:J,effectiveSelfEnabled:R,touchSensitivityMultiplier:z,distance:T}},()=>{this.doneSnapping();this.emit("changed")},f.sync),f.watch(()=>this.options,J=>{for(const R of this._engines)R.options=J},f.sync),f.watch(()=>({viewReady:this.view.ready,viewSpatialReference:this.view.spatialReference,snappingEnginesFactory:this.snappingEnginesFactory}),({viewReady:J,snappingEnginesFactory:R})=>this._recreateEngines(J,R),f.syncAndInitial)])}destroy(){this._destroyEngines()}get updating(){return this._engines.some(J=>
J.updating)}_recreateEngines(J,R){this._destroyEngines();if(J){var {view:z,options:T}=this;this._engines=R(z,T)}}_destroyEngines(){for(const J of this._engines)J.destroy();this._engines=[]}get _squaredMouseProximityTreshold(){return this.options.distance*this.options.distance}get _squaredTouchProximityThreshold(){const {distance:J,touchSensitivityMultiplier:R}=this.options,z=J*R;return z*z}get _squaredSatisfiesConstraintThreshold(){return m.defaults.satisfiesConstraintScreenThreshold*m.defaults.satisfiesConstraintScreenThreshold}snap(J){return null!=
J.scenePoint?this._snapMultiPoint(J):this._snapSinglePoint(J)}update(J){const {point:R,context:z}=J;this._removeVisualization();const T=this._currentMainCandidate;if(null==T)return R;var X=this._selectUpdateInput(J);if(null==X)return R;({spatialReference:J}=z);var aa=h.project(X,J);if(null==aa)return R;({view:X}=this);const {elevationInfo:w,visualizer:y}=z,P=[];aa=l.fromPoint(aa,X,w);const F=T.constraint.closestTo(aa);if(!this._arePointsWithinScreenThreshold(aa,F,z))return this._resetSnappingState(),
R;T.targetPoint=F;P.push(...T.hints);for(const Q of this._currentOtherActiveCandidates)Q.targetPoint=F,P.push(...Q.hints);null!=y&&this.addHandles(y.draw(P,{spatialReference:J,elevationInfo:H(z),view:X,selfSnappingZ:z.selfSnappingZ}),"visualization-handle");return I.snappingPointToSnappingOutput(F,X,{z:R.z,m:R.m,spatialReference:R.spatialReference,elevationInfo:w})}doneSnapping(){this._removeVisualization();this._resetSnappingState()}_selectUpdateInput({point:J,scenePoint:R}){switch(this._currentSnappedType){case K.MAIN:return J;
case K.SCENE:return R}}_resetSnappingState(){this._currentMainCandidate=null;this._currentOtherActiveCandidates=[];this._currentSnappedType=K.MAIN}_removeVisualization(){this.removeHandles("visualization-handle")}async _snapSinglePoint({point:J,context:R,signal:z}){const {view:T}=this,{elevationInfo:X}=R,aa=l.fromPoint(J,T,X),w=await this._fetchCandidates(aa,A.SnappingDomain.ALL,R,z);return this._createSnapResult(aa,K.MAIN,w,T,R,{z:J.z,m:J.m,spatialReference:J.spatialReference,elevationInfo:X},z)}async _snapMultiPoint({point:J,
scenePoint:R,context:z,signal:T}){const {view:X}=this,{coordinateHelper:aa,elevationInfo:w,spatialReference:y}=z;await h.initializeProjection(R.spatialReference,y);R=h.project(R,y);var P=l.fromPoint(R,X,w);const F=await this._fetchCandidates(P,A.SnappingDomain.FEATURE,z,T);if(0<F.length)return J=await this._fetchCandidates(P,A.SnappingDomain.SELF,z,T),this._createSnapResult(P,K.SCENE,[...F,...J],X,z,{z:R.z,m:R.m,spatialReference:R.spatialReference,elevationInfo:w},T);R=l.fromPoint(J,X,w);P=await this._fetchCandidates(R,
A.SnappingDomain.SELF,z,T);return this._createSnapResult(R,K.MAIN,P,X,z,{z:aa.hasZ()&&J.hasZ?J.z??0:void 0,m:aa.hasM()&&J.hasM?J.m??0:void 0,spatialReference:J.spatialReference,elevationInfo:w},T)}async _fetchCandidates(J,R,z,T){return(await Promise.all(this._engines.map(X=>X.fetchCandidates(J,R,z,T)))).flat()}_createSnapResult(J,R,z,T,X,aa,w){return{get valid(){return!d.isAborted(w)},apply:()=>{const {spatialReference:y}=X,{snappedPoint:P,hints:F}=this._processCandidates(J,R,z,X);this._removeVisualization();
null!=X.visualizer&&this.addHandles(X.visualizer.draw(F,{spatialReference:y,elevationInfo:e.absoluteHeightElevationInfo,view:T,selfSnappingZ:X.selfSnappingZ}),"visualization-handle");return I.snappingPointToSnappingOutput(P,T,aa)}}}_processCandidates(J,R,z,T){if(1>z.length)return this.doneSnapping(),{snappedPoint:J,hints:[]};this._currentSnappedType!==R&&this._resetSnappingState();r.sortCandidatesInPlace(J,z);const X=this._currentMainCandidate;if(null!=X){const aa=this._findOldConstraintInNewCandidates(X,
z);if(0<=aa)if(z[aa]instanceof v.IntersectionSnappingCandidate){if(this._arePointsWithinScreenThreshold(J,X.targetPoint,T))return this._updateSnappingCandidate(X,R,z,T)}else return this._intersectWithOtherCandidates(aa,z,J,R,T)}return this._intersectWithOtherCandidates(0,z,J,R,T)}_findOldConstraintInNewCandidates(J,R){return J instanceof v.IntersectionSnappingCandidate?0<=this._findOldCandidateIndex(R,J.first)&&0<=this._findOldCandidateIndex(R,J.second)?0:-1:this._findOldCandidateIndex(R,J)}_intersectWithOtherCandidates(J,
R,z,T,X){const {coordinateHelper:aa}=X,w=R[J],y=[];for(let P=0;P<R.length;++P){if(P===J)continue;const F=R[P],Q=w.constraint.intersect(F.constraint);if(Q)for(const V of Q.closestPoints(w.targetPoint))y.push([new v.IntersectionSnappingCandidate(V,w,F,F.isDraped),this._squaredScreenDistance(z,V,aa)])}return 0<y.length&&(y.sort((P,F)=>P[1]-F[1]),y[0][1]<this._squaredPointProximityThreshold(X.pointer))?this._updateSnappingCandidate(y[0][0],T,R,X):this._updateSnappingCandidate(w,T,R,X)}_updateSnappingCandidate(J,
R,z,T){this.doneSnapping();this._currentMainCandidate=J;this._currentSnappedType=R;R=this._currentMainCandidate.targetPoint;const X=[];X.push(...J.hints);for(const aa of z){if(J instanceof v.IntersectionSnappingCandidate){if(aa.constraint.equals(J.first.constraint)||aa.constraint.equals(J.second.constraint))continue}else if(aa.constraint.equals(J.constraint))continue;z=aa.constraint.closestTo(R);this._squaredScreenDistance(z,R,T.coordinateHelper)<this._squaredSatisfiesConstraintThreshold&&(aa.targetPoint=
R,this._currentOtherActiveCandidates.push(aa),X.push(...aa.hints))}return{snappedPoint:R,hints:X}}_squaredPointProximityThreshold(J){return"touch"===J?this._squaredTouchProximityThreshold:this._squaredMouseProximityTreshold}_arePointsWithinScreenThreshold(J,R,z){return this._squaredScreenDistance(J,R,z.coordinateHelper)<this._squaredPointProximityThreshold(z.pointer)}_squaredScreenDistance(J,R,z){return r.squaredScreenDistance(this._toScreen(J,z),this._toScreen(R,z))}_toScreen(J,R){return E.vectorToScreenPoint(J,
R.spatialReference,e.absoluteHeightElevationInfo,this.view)}_findOldCandidateIndex(J,R){let z=-1;for(let T=0;T<J.length;++T)if(R.constraint.equals(J[T].constraint)){z=T;break}return z}get test(){return{visualizationsActive:this.hasHandles("visualization-handle"),engines:this._engines}}};b.__decorate([g.property({constructOnly:!0})],a.SnappingManager.prototype,"view",void 0);b.__decorate([g.property()],a.SnappingManager.prototype,"options",void 0);b.__decorate([g.property({readOnly:!0})],a.SnappingManager.prototype,
"updating",null);b.__decorate([g.property()],a.SnappingManager.prototype,"snappingEnginesFactory",void 0);b.__decorate([g.property()],a.SnappingManager.prototype,"_engines",void 0);b.__decorate([g.property()],a.SnappingManager.prototype,"_squaredMouseProximityTreshold",null);b.__decorate([g.property()],a.SnappingManager.prototype,"_squaredTouchProximityThreshold",null);b.__decorate([g.property()],a.SnappingManager.prototype,"_squaredSatisfiesConstraintThreshold",null);a.SnappingManager=b.__decorate([u.subclass("esri.views.interactive.snapping.SnappingManager")],
a.SnappingManager);var K;(function(J){J[J.MAIN=0]="MAIN";J[J.SCENE=1]="SCENE"})(K||(K={}));Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/sketch/normalizedPoint":function(){define(["exports","../../../chunks/vec3f64","../../../layers/graphics/dehydratedPoint","../../../support/elevationInfoUtils"],function(a,b,c,q){function d(g,B,D){if(null==g)return null;if(null==B)return b.fromValues(g.x,g.y,g.z??0);if("2d"===B.type)return b.fromValues(g.x,g.y,0);B=q.getConvertedElevation(B,
g,D,q.absoluteHeightElevationInfo)??0;return b.fromValues(g.x,g.y,B)}const f=c.makeDehydratedPoint(0,0,0,null);a.clone=function(g){return b.clone(g)};a.create=function(g,B,D){return b.fromValues(g,B,D)};a.fromAnyMapPoint=function(g,B,{coordinateHelper:D,elevationInfo:k}){return g?d(D.vectorToDehydratedPoint(g,f),B,k):null};a.fromPoint=d;a.fromValues=function(g,B,D){return b.fromValues(g,B,D)};a.fromVec3=function(g){return g};a.toDehydratedPoint=function(g,B){return c.makeDehydratedPoint(g[0],g[1],
g[2],B)};a.toWritableVec3=function(g){return b.clone(g)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/dehydratedPoint":function(){define(["exports"],function(a){a.makeDehydratedPoint=function(b,c,q,d){return{x:b,y:c,z:q,hasZ:null!=q,hasM:!1,spatialReference:d,type:"point"}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/Settings":function(){define("exports ../../../chunks/tslib.es6 ../../../Color ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,c,q,d,f){let g=class extends q.JSONSupport{constructor(){super(...arguments);this.enabled=!0}};b.__decorate([d.property({type:Boolean})],g.prototype,"enabled",void 0);g=b.__decorate([f.subclass("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],g);q=class extends q.JSONSupport{constructor(B){super(B);this.lineSnapper=new g;this.parallelLineSnapper=new g;this.rightAngleSnapper=new g;this.rightAngleTriangleSnapper=new g;this.shortLineThreshold=15;this.distance=5;this.parallelLineThreshold=
this.intersectionParallelLineThreshold=this.pointThreshold=1E-6;this.verticalLineThreshold=.1;this.touchSensitivityMultiplier=1.5;this.pointOnLineThreshold=1E-6;this.orange=new c([255,127,0]);this.orangeTransparent=new c([255,127,0,.5]);this.lineHintWidthTarget=this.lineHintWidthReference=3;this.lineHintFadedExtensions=.3;this.parallelLineHintWidth=2;this.parallelLineHintLength=24;this.parallelLineHintOffset=1.5;this.rightAngleHintSize=24;this.rightAngleHintOutlineSize=1.5;this.satisfiesConstraintScreenThreshold=
1}};b.__decorate([d.property({type:g,constructOnly:!0,nonNullable:!0,json:{write:!0}})],q.prototype,"lineSnapper",void 0);b.__decorate([d.property({type:g,constructOnly:!0,nonNullable:!0,json:{write:!0}})],q.prototype,"parallelLineSnapper",void 0);b.__decorate([d.property({type:g,constructOnly:!0,nonNullable:!0,json:{write:!0}})],q.prototype,"rightAngleSnapper",void 0);b.__decorate([d.property({type:g,constructOnly:!0,nonNullable:!0,json:{write:!0}})],q.prototype,"rightAngleTriangleSnapper",void 0);
b.__decorate([d.property({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],q.prototype,"shortLineThreshold",void 0);b.__decorate([d.property({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],q.prototype,"distance",void 0);b.__decorate([d.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],q.prototype,"pointThreshold",void 0);b.__decorate([d.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],
q.prototype,"intersectionParallelLineThreshold",void 0);b.__decorate([d.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],q.prototype,"parallelLineThreshold",void 0);b.__decorate([d.property({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],q.prototype,"verticalLineThreshold",void 0);b.__decorate([d.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],q.prototype,"touchSensitivityMultiplier",void 0);b.__decorate([d.property({type:Number,
nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],q.prototype,"pointOnLineThreshold",void 0);b.__decorate([d.property({type:c,nonNullable:!0})],q.prototype,"orange",void 0);b.__decorate([d.property({type:c,nonNullable:!0})],q.prototype,"orangeTransparent",void 0);b.__decorate([d.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],q.prototype,"lineHintWidthReference",void 0);b.__decorate([d.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],
q.prototype,"lineHintWidthTarget",void 0);b.__decorate([d.property({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],q.prototype,"lineHintFadedExtensions",void 0);b.__decorate([d.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],q.prototype,"parallelLineHintWidth",void 0);b.__decorate([d.property({type:Number,nonNullable:!0,range:{min:0,max:50},json:{write:!0}})],q.prototype,"parallelLineHintLength",void 0);b.__decorate([d.property({type:Number,nonNullable:!0,
range:{min:0,max:5},json:{write:!0}})],q.prototype,"parallelLineHintOffset",void 0);b.__decorate([d.property({type:Number,nonNullable:!0,range:{min:0,max:46},json:{write:!0}})],q.prototype,"rightAngleHintSize",void 0);b.__decorate([d.property({type:Number,nonNullable:!0,range:{min:0,max:6},json:{write:!0}})],q.prototype,"rightAngleHintOutlineSize",void 0);b.__decorate([d.property({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],q.prototype,"satisfiesConstraintScreenThreshold",void 0);
q=b.__decorate([f.subclass("esri.views.interactive.snapping.Settings.Defaults")],q);b=new q;a.defaults=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingDomain":function(){define(["exports"],function(a){a.SnappingDomain=void 0;var b=a.SnappingDomain||(a.SnappingDomain={});b[b.FEATURE=1]="FEATURE";b[b.SELF=2]="SELF";b[b.ALL=3]="ALL";Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/snappingFactory":function(){define(["exports",
"./FeatureSnappingEngine","./SelfSnappingEngine"],function(a,b,c){a.defaultSnappingEnginesFactory=function(q,d){return[new c.SelfSnappingEngine({view:q,options:d}),new b.FeatureSnappingEngine({view:q,options:d,spatialReference:q.spatialReference})]};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/FeatureSnappingEngine":function(){define("require exports ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/handleUtils ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/unitUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../chunks/vec2 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../chunks/common ../../../core/support/UpdatingHandles ../../../support/elevationInfoUtils ../sketch/constraints ../sketch/normalizedPoint ./FeatureSnappingSourceInfo ./SnappingDomain ./snappingUtils ./candidates/DrapedEdgeSnappingCandidate ./candidates/EdgeSnappingCandidate ./candidates/FeatureSnappingCandidate ./candidates/RightAngleSnappingCandidate ../support/viewUtils".split(" "),
function(a,b,c,q,d,f,g,B,D,k,u,h,e,l,m,A,p,C,I,r,v,E,H,K,J,R,z,T,X){function aa({constraint:{start:F,end:Q}}){const V=m.squaredDistance(F,Q);F=l.squaredDistance(F,Q);return V<p.getEpsilon()||1E-4>F/V}function w(F,Q,V,ba,G,N,{spatialReference:S}){Q=m.copy(P,Q);Q[0]+=V;Q[1]+=ba;Q[2]+=G;return(V=X.vectorToScreenPoint(Q,S,I.absoluteHeightElevationInfo,N))?K.screenDistance(V,F):Infinity}b.FeatureSnappingEngine=class extends q{get updating(){return this._snappingSources.some(F=>null==F||F.valid&&F.snappingSource.updating)||
this._updatingHandles.updating}constructor(F){super(F);this.options=null;this._domain=H.SnappingDomain.FEATURE;this._updatingHandles=new C.UpdatingHandles;this._sourceModules={featureService:{module:null,loader:null},featureCollection:{module:null,loader:null},graphics:{module:null,loader:null},notes:{module:null,loader:null},scene:{module:null,loader:null}}}initialize(){const F=g.mapCollectionAsync(()=>this.options?.featureSources,(Q,V)=>this._createSourceInfo(Q,V));this._snappingSources=F;this.addHandles(d.destroyHandle(F))}destroy(){this._set("options",
null);this._updatingHandles.destroy()}async fetchCandidates(F,Q,V,ba){if(!(Q&this._domain&&null!=this.options&&this.options.effectiveFeatureEnabled))return[];const G=[];Q=this._computeScreenSizeDistanceParameters(F,V);for(const S of this._snappingSources){if(null==S||!S.valid||!S.snappingSource.layerSource.enabled||S.layerView?.suspended)continue;const fa=S.getFetchCandidatesParameters(F,V,Q);for(var N of fa)G.push(S.snappingSource.fetchCandidates(N,ba).then(ja=>ja.filter(ka=>!this._candidateIsExcluded(S.snappingSource,
ka,V.excludeFeature))))}N=(await f.allSettledValues(G)).flat();this._addRightAngleCandidates(N,F,Q,V);f.throwIfAborted(ba);K.sortCandidatesInPlace(F,N);return N}_addRightAngleCandidates(F,Q,V,ba){var G=null!=ba.vertexHandle?ba.vertexHandle.rightEdge?.rightVertex?.pos:null!=ba.editGeometryOperations&&"polygon"===ba.editGeometryOperations.data.type?ba.editGeometryOperations.data.components[0]?.getFirstVertex()?.pos:null,N=null!=ba.vertexHandle?ba.vertexHandle.leftEdge?.leftVertex?.pos:null!=ba.editGeometryOperations?
ba.editGeometryOperations.data.components[0]?.getLastVertex()?.pos:null,{view:S}=this;G=v.fromAnyMapPoint(G,S,ba);ba=v.fromAnyMapPoint(N,S,ba);N=F.length;for(S=0;S<N;S++)this._addRightAngleCandidate(F[S],ba,Q,V,F),this._addRightAngleCandidate(F[S],G,Q,V,F)}_addRightAngleCandidate(F,Q,V,ba,G){var N;(N=null==Q)||(N=!((F instanceof R.EdgeSnappingCandidate||F instanceof J.DrapedEdgeSnappingCandidate)&&!aa(F)));if(!N){N=F.constraint.closestTo(Q);var S=(N[0]-V[0])/ba.x;V=(N[1]-V[1])/ba.y;var {start:fa,
end:ja}=F.constraint;1>=S*S+V*V&&(F=new T.RightAngleSnappingCandidate({targetPoint:N,otherVertex:Q,otherVertexType:T.OtherVertexType.NEXT,previousVertex:l.squaredDistance(N,fa)>l.squaredDistance(N,ja)?fa:ja,constraint:new r.VerticalHalfPlaneConstraint(Q,N),objectId:F.objectId,isDraped:F.isDraped}),G.push(F))}}_computeScreenSizeDistanceParameters(F,Q){let V=null!=this.options?this.options.distance*("touch"===Q.pointer?this.options.touchSensitivityMultiplier:1):0;return null==this.view?{x:V,y:V,z:V,
distance:V}:"2d"===this.view.type?(V*=this.view.resolution,{x:V,y:V,z:V,distance:V}):this._computeScreenSizeDistanceParameters3D(F,V,this.view,Q)}_computeScreenSizeDistanceParameters3D(F,Q,V,ba){var {spatialReference:G}=ba;V.renderCoordsHelper.toRenderCoords(F,G,y);const N=V.state.camera.computeScreenPixelSizeAt(y);var S=N*V.renderCoordsHelper.unitInMeters,fa=S/B.getMetersPerUnitForSR(G);const ja=S/B.getMetersPerVerticalUnitForSR(G);S=Q*fa;const ka=Q*ja,na=X.vectorToScreenPoint(F,G,I.absoluteHeightElevationInfo,
V);G=na?w(na,F,fa,0,0,V,ba):0;fa=na?w(na,F,0,fa,0,V,ba):0;F=na?w(na,F,0,0,ja,V,ba):0;return{x:0===G?0:S/G,y:0===fa?0:S/fa,z:0===F?0:ka/F,distance:N*Q}}_candidateIsExcluded(F,Q,V){if(null==V)return!1;Q=this._getCandidateObjectId(Q);if(null==Q)return!1;F=F.layerSource.layer;return"graphics"===F.type?V.uid===Q:V.sourceLayer===F&&V.attributes&&"objectIdField"in F?V.attributes[F.objectIdField]===Q:!1}_getCandidateObjectId(F){return F instanceof z.FeatureSnappingCandidate?F.objectId:null}async _createSourceInfo(F,
Q){const V=F.layer;V.loaded||(await V.load(),f.throwIfAborted(Q));const {view:ba}=this;F=await this._createFeatureSnappingSourceType(F);f.throwIfAborted(Q);return null==F?new E.FeatureSnappingSourceInfo({}):new E.FeatureSnappingSourceInfo({snappingSource:F,view:ba,layer:V})}async _createFeatureSnappingSourceType(F){switch(F.layer.type){case "feature":case "geojson":case "csv":case "oriented-imagery":case "subtype-group":case "wfs":return this._createFeatureSnappingSourceFeatureLayer(F);case "graphics":return this._createFeatureSnappingSourceGraphicsLayer(F);
case "map-notes":return this._createFeatureSnappingSourceMapNotesLayer(F);case "scene":case "building-scene":return this._createFeatureSnappingSourceSceneLayer(F)}return null}async _createFeatureSnappingSourceSceneLayer(F){const {view:Q}=this;return null==Q||"3d"!==Q.type?null:new ((await this._getSourceModule("scene")).SceneLayerSnappingSource)({layerSource:F,view:Q})}async _createFeatureSnappingSourceFeatureLayer(F){switch(F.layer.source?.type){case "feature-layer":case "oriented-imagery":return new ((await this._getSourceModule("featureService")).FeatureServiceSnappingSource)({spatialReference:this.spatialReference,
view:this.view,layerSource:F});case "memory":case "csv":case "geojson":case "wfs":if("mesh"!==F.layer.geometryType)return new ((await this._getSourceModule("featureCollection")).FeatureCollectionSnappingSource)({layerSource:F,view:this.view})}return null}async _createFeatureSnappingSourceGraphicsLayer(F){return new ((await this._getSourceModule("graphics")).GraphicsSnappingSource)({getGraphicsLayers:()=>[F.layer],spatialReference:this.spatialReference,view:this.view,layerSource:F})}async _createFeatureSnappingSourceMapNotesLayer(F){return new ((await this._getSourceModule("notes")).GraphicsSnappingSource)({getGraphicsLayers:()=>
F.layer.sublayers?.toArray()??[],spatialReference:this.spatialReference,view:this.view,layerSource:F})}async _getSourceModule(F){var Q=this._sourceModules[F];if(null==Q.loader){Q=this._loadSourceModule(F);this._sourceModules[F]={module:null,loader:Q};const V=await Q;this._sourceModules[F]={module:V,loader:Q};return V}return null==Q.module?Q.loader:Q.module}_loadSourceModule(F){const Q=this._updatingHandles;switch(F){case "featureService":return Q.addPromise(new Promise((V,ba)=>a(["./featureSources/FeatureServiceSnappingSource"],
V,ba)));case "featureCollection":return Q.addPromise(new Promise((V,ba)=>a(["./featureSources/FeatureCollectionSnappingSource"],V,ba)));case "graphics":return Q.addPromise(new Promise((V,ba)=>a(["./featureSources/GraphicsSnappingSource"],V,ba)));case "notes":return Q.addPromise(new Promise((V,ba)=>a(["./featureSources/GraphicsSnappingSource"],V,ba)));case "scene":return Q.addPromise(new Promise((V,ba)=>a(["./featureSources/SceneLayerSnappingSource"],V,ba)))}}get test(){return{snappingSources:this._snappingSources}}};
c.__decorate([D.property({constructOnly:!0})],b.FeatureSnappingEngine.prototype,"spatialReference",void 0);c.__decorate([D.property({constructOnly:!0})],b.FeatureSnappingEngine.prototype,"view",void 0);c.__decorate([D.property()],b.FeatureSnappingEngine.prototype,"options",void 0);c.__decorate([D.property({readOnly:!0})],b.FeatureSnappingEngine.prototype,"updating",null);c.__decorate([D.property()],b.FeatureSnappingEngine.prototype,"_snappingSources",void 0);b.FeatureSnappingEngine=c.__decorate([e.subclass("esri.views.interactive.snapping.FeatureSnappingEngine")],
b.FeatureSnappingEngine);const y=A.create(),P=A.create();Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/vec2":function(){define(["exports","./common"],function(a,b){function c(G,N){G[0]=N[0];G[1]=N[1];return G}function q(G,N,S){G[0]=N;G[1]=S;return G}function d(G,N,S){G[0]=N[0]+S[0];G[1]=N[1]+S[1];return G}function f(G,N,S){G[0]=N[0]-S[0];G[1]=N[1]-S[1];return G}function g(G,N,S){G[0]=N[0]*S[0];G[1]=N[1]*S[1];return G}function B(G,N,S){G[0]=N[0]/S[0];G[1]=N[1]/S[1];return G}
function D(G,N){G[0]=Math.ceil(N[0]);G[1]=Math.ceil(N[1]);return G}function k(G,N){G[0]=Math.floor(N[0]);G[1]=Math.floor(N[1]);return G}function u(G,N,S){G[0]=Math.min(N[0],S[0]);G[1]=Math.min(N[1],S[1]);return G}function h(G,N,S){G[0]=Math.max(N[0],S[0]);G[1]=Math.max(N[1],S[1]);return G}function e(G,N){G[0]=Math.round(N[0]);G[1]=Math.round(N[1]);return G}function l(G,N,S){G[0]=N[0]*S;G[1]=N[1]*S;return G}function m(G,N,S,fa){G[0]=N[0]+S[0]*fa;G[1]=N[1]+S[1]*fa;return G}function A(G,N){const S=N[0]-
G[0];G=N[1]-G[1];return Math.sqrt(S*S+G*G)}function p(G,N){const S=N[0]-G[0];G=N[1]-G[1];return S*S+G*G}function C(G){const N=G[0];G=G[1];return Math.sqrt(N*N+G*G)}function I(G){const N=G[0];G=G[1];return N*N+G*G}function r(G,N){G[0]=-N[0];G[1]=-N[1];return G}function v(G,N){G[0]=1/N[0];G[1]=1/N[1];return G}function E(G,N){var S=N[0];const fa=N[1];S=S*S+fa*fa;0<S&&(S=1/Math.sqrt(S),G[0]=N[0]*S,G[1]=N[1]*S);return G}function H(G,N){return G[0]*N[0]+G[1]*N[1]}function K(G,N,S){N=N[0]*S[1]-N[1]*S[0];
G[0]=G[1]=0;G[2]=N;return G}function J(G,N,S,fa){const ja=N[0];N=N[1];G[0]=ja+fa*(S[0]-ja);G[1]=N+fa*(S[1]-N);return G}function R(G,N){N=N||1;const S=2*b.RANDOM()*Math.PI;G[0]=Math.cos(S)*N;G[1]=Math.sin(S)*N;return G}function z(G,N,S){const fa=N[0];N=N[1];G[0]=S[0]*fa+S[2]*N;G[1]=S[1]*fa+S[3]*N;return G}function T(G,N,S){const fa=N[0];N=N[1];G[0]=S[0]*fa+S[2]*N+S[4];G[1]=S[1]*fa+S[3]*N+S[5];return G}function X(G,N,S){const fa=N[0];N=N[1];G[0]=S[0]*fa+S[3]*N+S[6];G[1]=S[1]*fa+S[4]*N+S[7];return G}
function aa(G,N,S){const fa=N[0];N=N[1];G[0]=S[0]*fa+S[4]*N+S[12];G[1]=S[1]*fa+S[5]*N+S[13];return G}function w(G,N,S,fa){const ja=N[0]-S[0];N=N[1]-S[1];const ka=Math.sin(fa);fa=Math.cos(fa);G[0]=ja*fa-N*ka+S[0];G[1]=ja*ka+N*fa+S[1];return G}function y(G,N){var S=G[0];G=G[1];const fa=N[0];N=N[1];let ja=S*S+G*G;0<ja&&(ja=1/Math.sqrt(ja));let ka=fa*fa+N*N;0<ka&&(ka=1/Math.sqrt(ka));S=(S*fa+G*N)*ja*ka;return 1<S?0:-1>S?Math.PI:Math.acos(S)}function P(G){return"vec2("+G[0]+", "+G[1]+")"}function F(G,
N){return G[0]===N[0]&&G[1]===N[1]}function Q(G,N){const S=G[0];G=G[1];const fa=N[0];N=N[1];const ja=b.getEpsilon();return Math.abs(S-fa)<=ja*Math.max(1,Math.abs(S),Math.abs(fa))&&Math.abs(G-N)<=ja*Math.max(1,Math.abs(G),Math.abs(N))}function V(G,N,S,fa,ja){let ka=N[0]-S[0];S=N[1]-S[1];ja=(fa[0]*ka+fa[1]*S)*(ja-1);ka=fa[0]*ja;S=fa[1]*ja;G[0]=N[0]+ka;G[1]=N[1]+S;return G}const ba=Object.freeze(Object.defineProperty({__proto__:null,add:d,angle:y,ceil:D,copy:c,cross:K,dist:A,distance:A,div:B,divide:B,
dot:H,equals:Q,exactEquals:F,floor:k,inverse:v,len:C,length:C,lerp:J,max:h,min:u,mul:g,multiply:g,negate:r,normalize:E,projectAndScale:V,random:R,rotate:w,round:e,scale:l,scaleAndAdd:m,set:q,sqrDist:p,sqrLen:I,squaredDistance:p,squaredLength:I,str:P,sub:f,subtract:f,transformMat2:z,transformMat2d:T,transformMat3:X,transformMat4:aa},Symbol.toStringTag,{value:"Module"}));a.add=d;a.angle=y;a.ceil=D;a.copy=c;a.cross=K;a.dist=A;a.distance=A;a.div=B;a.divide=B;a.dot=H;a.equals=Q;a.exactEquals=F;a.floor=
k;a.inverse=v;a.len=C;a.length=C;a.lerp=J;a.max=h;a.min=u;a.mul=g;a.multiply=g;a.negate=r;a.normalize=E;a.projectAndScale=V;a.random=R;a.rotate=w;a.round=e;a.scale=l;a.scaleAndAdd=m;a.set=q;a.sqrDist=p;a.sqrLen=I;a.squaredDistance=p;a.squaredLength=I;a.str=P;a.sub=f;a.subtract=f;a.transformMat2=z;a.transformMat2d=T;a.transformMat3=X;a.transformMat4=aa;a.vec2=ba})},"esri/views/interactive/sketch/constraints":function(){define("exports ../../../core/arrayUtils ../../../chunks/vec2 ../../../chunks/vec2f64 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../geometry/support/plane ../../../geometry/support/ray ../../../chunks/sphere ./normalizedPoint ../../support/geometry3dUtils ../../support/geometry2dUtils".split(" "),
function(a,b,c,q,d,f,g,B,D,k,u,h){function e(n,x){if(n instanceof V){var Z=[];for(const ea of n.constraints)(n=ea.intersect(x))&&Z.push(n);return E(Z)}if(x instanceof V)return e(x,n);if(n instanceof L)return C(n,x);if(x instanceof L)return C(x,n);if(H(n))return{point:Z}=n,x=x.closestTo(Z),d.equals(x,Z)?n:void 0;if(K(n)){if(H(x))return e(x,n);if(K(x))return r(u.intersectLineLikes(n.lineLike,x.lineLike));if(J(x))return O(n,x);if(R(x))return r(u.intersectVerticalPlaneAndLineLike(x.planeLike,n.lineLike));
if(z(x))return r(u.intersectLineLikeAndVerticalCylinder(n.lineLike,x.center,x.radius));if(X(x))return r(u.intersectLineLikeAndCircle(n.lineLike,x));if(T(x))return l(n,x);if(aa(x))return m(n,x)}else if(J(n)){if(H(x)||K(x))return e(x,n);if(J(x))return u.isClose(n.z,x.z)?n:void 0;if(R(x))return A(n,x);if(z(x)){const [ea,ha]=x.center;return new G(k.fromValues(ea,ha,n.z),x.radius)}if(X(x))return W(n,x);if(T(x))return u.isClose(x.center[2],n.z)?x:void 0;if(aa(x))return p(n,x)}else if(R(n)){if(H(x)||K(x)||
J(x))return e(x,n);if(R(x))return I(u.intersectVerticalPlanes(n.planeLike,x.planeLike));if(z(x))return I(u.intersectVerticalPlaneAndVerticalCylinder(n.planeLike,x.center,x.radius));if(X(x))return da(n,x);if(T(x))return ia(n,x);if(aa(x))return U(n,x)}else if(z(n)){if(H(x)||K(x)||J(x)||R(x))return e(x,n);if(z(x))return I(u.intersectVerticalCylinders(n.center,n.radius,x.center,x.radius));if(!X(x)){if(T(x))return Z=c.squaredDistance(n.center,x.center),u.isClose(Z,0)&&u.isClose(n.radius,x.radius)||(n=
u.intersectVerticalCylinders(n.center,n.radius,x.center,x.radius),x=v(n,x.center[2])),x;aa(x)}}else if(X(n)){if(H(x)||K(x)||J(x)||R(x)||z(x))return e(x,n);X(x)||(T(x)?x.asCircle():aa(x))}else if(T(n)){if(H(x)||K(x)||J(x)||R(x)||z(x)||X(x))return e(x,n);if(T(x))return u.vectorsHaveCloseZ(x.center,n.center)?(Z=c.squaredDistance(x.center,n.center),u.isClose(Z,0)&&u.isClose(x.radius,n.radius)||(n=u.intersectVerticalCylinders(x.center,x.radius,n.center,n.radius),x=v(n,x.center[2]))):x=void 0,x;aa(x)}else if(aa(n)){if(H(x)||
K(x)||J(x)||R(x)||z(x)||T(x))return e(x,n);aa(x)}}function l({lineLike:n},{center:x,radius:Z}){const ea=x[2];n=u.intersectLineLikeAndVerticalCylinder(n,x,Z).filter(ha=>u.isClose(ha[2],ea));return r(n)}function m({lineLike:n},{sphere:x}){return r(D.intersectLine(x,n.start,n.end))}function A({z:n},{planeLike:x}){const [Z,ea]=x.start,[ha,la]=x.end,pa=k.fromValues(Z,ea,n);n=k.fromValues(ha,la,n);return x.type===u.VerticalPlaneType.PLANE?new F(pa,n):new Q(pa,n)}function p(n,{center:x,radius:Z}){const ea=
Math.abs(x[2]-n.z);if(!(ea>Z)||u.isClose(ea,Z))if(n=k.fromValues(x[0],x[1],n.z),Z=Math.sqrt(Z**2-ea**2),!u.isClose(Z,0))return new G(n,Z)}function C(n,x){const {planeLike:Z,getZ:ea}=n,ha=[];if(H(x))n.addIfOnTheGround(ha,u.intersectVerticalPlaneAndPoint(Z,x.point));else if(K(x))n.addIfOnTheGround(ha,u.intersectVerticalPlaneAndLineLike(Z,x.lineLike));else if(z(x))for(const [la,pa]of u.intersectVerticalPlaneAndVerticalCylinder(Z,x.center,x.radius))n=ea(la,pa),null!=n&&ha.push(f.fromValues(la,pa,n));
else if(R(x)||x instanceof L)for(const [la,pa]of u.intersectVerticalPlanes(Z,x.planeLike))n=ea(la,pa)??0,ha.push(f.fromValues(la,pa,n));return r(ha)}function I(n){return E(n.map(([x,Z])=>{const ea=k.fromValues(x,Z,0);x=k.fromValues(x,Z,1);return new F(ea,x)}))}function r(n){return E(n.map(x=>x?new y(k.fromVec3(x)):void 0))}function v(n,x){return r(n.map(([Z,ea])=>[Z,ea,x]))}function E(n){if(0!==n.length)return 1===n.length?n[0]??void 0:new V(n.filter(b.isSome))}function H(n){return n instanceof y}
function K(n){return n instanceof P}function J(n){return n instanceof ja}function R(n){return n instanceof na}function z(n){return n instanceof ba}function T(n){return n instanceof G}function X(n){return n instanceof N}function aa(n){return n instanceof t}class w{intersect(n){return e(this,n)}closestPoints(n){return[this.closestTo(n)]}}class y extends w{constructor(n){super();this.point=n}equals(n){return this===n||H(n)&&d.exactEquals(this.point,n.point)}closestTo(){return k.clone(this.point)}}class P extends w{constructor(n,
x,Z){super();this.start=n;this.end=x;this.lineLike={start:n,end:x,type:Z}}equals(n){return this===n||K(n)&&this.lineLike.type===n.lineLike.type&&d.exactEquals(this.start,n.start)&&d.exactEquals(this.end,n.end)}closestTo(n){n=u.projectPointToLineLike(n,this.lineLike);return k.fromVec3(n)}}class F extends P{constructor(n,x){super(n,x,h.LineType.LINE)}}class Q extends P{constructor(n,x){super(n,x,h.LineType.RAY)}}class V extends w{constructor(n){super();this.constraints=n}equals(n){return this===n||
n instanceof V&&b.equals(this.constraints,n.constraints,(x,Z)=>x.equals(Z))}closestTo(n){let x=Infinity,Z;for(const ea of this.constraints){const ha=ea.closestTo(n),la=d.squaredDistance(n,ha);la<x&&(x=la,Z=ha)}return Z?k.clone(Z):n}closestPoints(n){return this.constraints.flatMap(x=>x===this?[]:x.closestPoints(n))}}class ba extends w{constructor(n,x){super();this.center=n;this.radius=x}equals(n){return this===n||z(n)&&this.center[0]===n.center[0]&&this.center[1]===n.center[1]&&this.radius===n.radius}closestTo(n){n=
u.projectPointToVerticalCylinder(n,this.center,this.radius);return k.fromVec3(n)}}class G extends w{constructor(n,x){super();this.center=n;this.radius=x}equals(n){return this===n||T(n)&&d.exactEquals(this.center,n.center)&&this.radius===n.radius}closestTo(n){n=u.projectPointToVerticalCylinder(n,this.center,this.radius);n[2]=this.center[2];return k.fromVec3(n)}asCircle(){return new N(k.clone(this.center),this.radius,k.fromValues(0,0,1))}}class N extends w{constructor(n,x,Z,ea){super();this.center=
n;this.radius=x;this.normal=Z;this.slicePlane=ea}equals(n){return this===n||X(n)&&d.exactEquals(this.center,n.center)&&d.exactEquals(this.normal,n.normal)&&this.radius===n.radius}closestTo(n){const {center:x,radius:Z}=this;g.projectPoint(this.getPlane(fa),n,S);var ea=d.sub(S,S,x),ha=d.squaredLength(ea);if(u.isClose(ha,0))return k.clone(n);ha=Z/Math.sqrt(ha);ea=d.scaleAndAdd(f.create(),x,ea,ha);({slicePlane:ha}=this);return ha&&!u.isPointInsidePlane(ha,ea)?M(ha,this)?.closestTo(n)??k.clone(n):k.fromVec3(ea)}getPlane(n=
g.create()){return g.fromPositionAndNormal(this.center,this.normal,n)}}const S=f.create(),fa=g.create();class ja extends w{constructor(n){super();this.z=n}equals(n){return this===n||J(n)&&this.z===n.z}closestTo(n){return k.fromVec3(f.fromValues(n[0],n[1],this.z))}getPlane(n=g.create()){d.set(ka,0,0,this.z);return g.fromPositionAndNormal(ka,f.UNIT_Z,n)}}const ka=f.create();class na extends w{constructor(n,x,Z){super();this.start=n;this.end=x;this.planeLike={start:n,end:x,type:Z}}equals(n){return this===
n||R(n)&&this.planeLike.type===n.planeLike.type&&d.exactEquals(this.start,n.start)&&d.exactEquals(this.end,n.end)}closestTo(n){return k.fromVec3(u.projectPointToVerticalPlane(n,this.planeLike))}closestEndTo(n){const {start:x,end:Z}=this;return 0<Math.sign(c.dot(c.subtract(oa,Z,x),c.subtract(ma,n,x)))?Z:x}getPlane(n=g.create()){const x=d.copy(qa,this.end);x[2]+=1;return g.fromPoints(this.start,this.end,x,n)}getSlicePlane(n=g.create()){const {start:x,end:Z,type:ea}=this.planeLike;if(ea!==u.VerticalPlaneType.PLANE){var ha=
d.set(qa,x[0],x[1],0),la=d.set(ra,Z[0],Z[1],0);la=d.subtract(ra,la,ha);g.fromPositionAndNormal(ha,la,n);return n}}}const oa=q.create(),ma=q.create(),qa=f.create(),ra=f.create();class Y extends na{constructor(n,x){super(n,x,u.VerticalPlaneType.HALF_PLANE)}}class ca extends na{constructor(n,x){super(n,x,u.VerticalPlaneType.PLANE)}}class t extends w{constructor(n,x){super();this.sphere=D.fromCenterAndRadius(n,x)}equals(n){return this===n||aa(n)&&D.exactEquals(this.sphere,n.sphere)}closestTo(n){n=D.projectPoint(this.sphere,
n,f.create());return k.fromVec3(n)}get center(){return this.sphere}get radius(){return this.sphere[3]}}class L extends w{constructor(n,x,Z){super();this.start=n;this.end=x;this.getZ=Z;this.planeLike={start:n,end:x,type:u.VerticalPlaneType.PLANE}}equals(n){return this===n||n instanceof L&&d.exactEquals(this.start,n.start)&&d.exactEquals(this.end,n.end)&&this.getZ===n.getZ}closestTo(n){n=u.projectPointToVerticalPlane(n,this.planeLike);n[2]=this.getZ(n[0],n[1])??0;return k.fromVec3(n)}addIfOnTheGround(n,
x){for(const Z of x)x=this.getZ(Z[0],Z[1])??0,u.isClose(Z[2],x)&&(Z[2]=x,n.push(Z))}}const O=(()=>{const n=g.create();return(x,Z)=>{const {start:ea,end:ha}=x;if(u.vectorsHaveCloseZ(ea,ha)&&u.isClose(ea[2],Z.z))return x;x=f.create();if(g.intersectLine(Z.getPlane(n),ea,ha,x))return new y(k.fromVec3(x))}})(),M=(()=>{const n=B.create(),x=g.create(),Z={start:f.create(),end:f.create(),type:h.LineType.LINE};return(ea,ha,la)=>{const {normal:pa,center:sa,radius:ua}=ha;var ta=d.dot(pa,g.normal(ea));const va=
u.isClose(g.distance(ea,sa),0);if(u.isClose(ta,1)){if(va)return ha}else{ha.getPlane(x);if(va&&u.isClose(ta,0)&&g.isVertical(ea)&&g.isVertical(x)){if(u.isClose(ua,0))return!la||u.isPointInsidePlane(la,sa)?new y(k.clone(sa)):void 0;ea=f.clone(sa);ea[2]+=ua;ha=f.clone(sa);ha[2]-=ua;ta=[];la&&!u.isPointInsidePlane(la,ea)||ta.push(ea);la&&!u.isPointInsidePlane(la,ha)||ta.push(ha);return r(ta)}if(g.intersectPlanes(ea,x,n))return d.copy(Z.start,n.origin),d.add(Z.end,n.origin,n.direction),ea=u.intersectLineLikeAndCircle(Z,
ha),r(la?u.pointsInsidePlane(la,ea):ea)}}})(),W=(()=>{const n=g.create();return(x,Z)=>M(x.getPlane(n),Z)})(),ia=(()=>{const n=g.create();return(x,{center:Z,radius:ea})=>{ea=u.intersectVerticalPlaneAndVerticalCylinder(x.planeLike,Z,ea);Z=Z[2];x.getSlicePlane(n);x=[];for(const [ha,la]of ea)ea=[ha,la,Z],u.isPointInsidePlane(n,ea)&&x.push(ea);return r(x)}})(),da=(()=>{const n=g.create(),x=g.create();return(Z,ea)=>M(Z.getPlane(n),ea,Z.getSlicePlane(x))})(),U=(()=>{const n=g.create();return(x,{center:Z,
radius:ea})=>{const ha=x.getPlane(n),la=g.signedDistance(ha,Z);var pa=Math.abs(la);if(!(pa>ea)||u.isClose(pa,ea)){pa=f.clone(g.normal(ha));var sa=d.scaleAndAdd(f.create(),Z,pa,la);ea=Math.sqrt(ea**2-la**2);return u.isClose(ea,0)?new y(k.fromVec3(g.projectPoint(ha,Z,f.create()))):new N(k.fromVec3(sa),ea,pa,x.getSlicePlane())}}})();a.CircleConstraint=N;a.Constraint=w;a.DrapedLineConstraint=L;a.HorizontalCircleConstraint=G;a.HorizontalPlaneConstraint=ja;a.LineConstraint=F;a.LineLikeConstraint=P;a.PointConstraint=
y;a.RayConstraint=Q;a.SetConstraint=V;a.SphereConstraint=t;a.VerticalCylinderConstraint=ba;a.VerticalHalfPlaneConstraint=Y;a.VerticalPlaneConstraint=ca;a.VerticalPlaneLikeConstraint=na;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/vec2f64":function(){define(["exports"],function(a){function b(){return[0,0]}function c(A){return[A[0],A[1]]}function q(A,p){return[A,p]}function d(A,p=[0,0]){const C=Math.min(2,A.length);for(let I=0;I<C;++I)p[I]=A[I];return p}function f(A,
p){return new Float64Array(A,p,2)}function g(){return[0,0]}function B(){return[1,1]}function D(){return[1,0]}function k(){return[0,1]}const u=[0,0],h=[1,1],e=[1,0],l=[0,1],m=Object.freeze(Object.defineProperty({__proto__:null,ONES:h,UNIT_X:e,UNIT_Y:l,ZEROS:u,clone:c,create:b,createView:f,fromArray:d,fromValues:q,ones:B,unitX:D,unitY:k,zeros:g},Symbol.toStringTag,{value:"Module"}));a.ONES=h;a.UNIT_X=e;a.UNIT_Y=l;a.ZEROS=u;a.clone=c;a.create=b;a.createView=f;a.fromArray=d;a.fromValues=q;a.ones=B;a.unitX=
D;a.unitY=k;a.vec2f64=m;a.zeros=g})},"esri/geometry/support/plane":function(){define("exports ../../core/mathUtils ../../chunks/vec3 ../../chunks/vec3f64 ../../chunks/vec4 ../../chunks/common ../../chunks/sphere ./vector ./vectorStacks ../../views/3d/support/mathUtils".split(" "),function(a,b,c,q,d,f,g,B,D,k){function u(w=z){return[w[0],w[1],w[2],w[3]]}function h(w,y){return e(y[0],y[1],y[2],y[3],w)}function e(w,y,P,F,Q=u()){Q[0]=w;Q[1]=y;Q[2]=P;Q[3]=F;return Q}function l(w,y,P){var F=y[0]*y[0]+y[1]*
y[1]+y[2]*y[2];F=1E-5<Math.abs(F-1)&&1E-12<F?1/Math.sqrt(F):1;P[0]=y[0]*F;P[1]=y[1]*F;P[2]=y[2]*F;P[3]=-(P[0]*w[0]+P[1]*w[1]+P[2]*w[2]);return P}function m(w,y,P,F=u()){var Q=P[0]-y[0],V=P[1]-y[1],ba=P[2]-y[2];P=w[0]-y[0];const G=w[1]-y[1],N=w[2]-y[2];y=V*N-ba*G;ba=ba*P-Q*N;Q=Q*G-V*P;V=y*y+ba*ba+Q*Q;V=1E-5<Math.abs(V-1)&&1E-12<V?1/Math.sqrt(V):1;F[0]=y*V;F[1]=ba*V;F[2]=Q*V;F[3]=-(F[0]*w[0]+F[1]*w[1]+F[2]*w[2]);return F}function A(w,y,P,F=0,Q=Math.floor(1/3*P),V=Math.floor(2/3*P)){if(3>P)return!1;
y(v,F);let ba=Q,G=!1;for(;ba<P-1&&!G;)y(E,ba),ba++,G=!c.exactEquals(v,E);if(!G)return!1;ba=Math.max(ba,V);for(G=!1;ba<P&&!G;)y(H,ba),ba++,c.subtract(K,v,E),c.normalize(K,K),c.subtract(J,E,H),c.normalize(J,J),G=!c.exactEquals(v,H)&&!c.exactEquals(E,H)&&.99619469809>Math.abs(c.dot(K,J));if(!G)return 0===F&&1===Q&&2===V?!1:A(w,y,P,0,1,2);m(v,E,H,w);return!0}function p(w,y,P){w=c.scale(D.sv3d.get(),w,c.dot(w,y));c.subtract(P,y,w);return P}function C(w,y){return c.dot(w,y)+w[3]}function I(w,y,P,F,Q){const V=
c.dot(w,P);if(0===V)return!1;w=-(c.dot(w,y)+w[3])/V;F&T.CLAMP&&(w=b.clamp(w,0,1));if(!(F&T.INFINITE_MIN)&&0>w||!(F&T.INFINITE_MAX)&&1<w)return!1;c.add(Q,y,c.scale(Q,P,w));return!0}const r=d.exactEquals;d=d.equals;const v=q.create(),E=q.create(),H=q.create(),K=q.create(),J=q.create(),R=(()=>{const w=q.create();return(y,P,F)=>{c.cross(w,y,P);if(c.squaredLength(w)<f.getEpsilon())return!1;c.normalize(w,w);const [Q,V,ba]=w,G=F.origin,N=Math.abs(Q),S=Math.abs(V),fa=Math.abs(ba),[ja,ka,na]=y,[oa,ma,qa]=
P;y=y[3];P=P[3];N>S&&N>fa?(G[1]=(P*na-y*qa)/Q,G[2]=(y*ma-P*ka)/Q):S>fa?(G[0]=(y*qa-P*na)/V,G[2]=(P*ja-y*oa)/V):(G[0]=(P*ka-y*ma)/ba,G[1]=(y*oa-P*ja)/ba);c.copy(F.direction,w);return!0}})(),z=[0,0,1,0];var T;(function(w){w[w.NONE=0]="NONE";w[w.CLAMP=1]="CLAMP";w[w.INFINITE_MIN=4]="INFINITE_MIN";w[w.INFINITE_MAX=8]="INFINITE_MAX"})(T||(T={}));const X=T.INFINITE_MIN|T.INFINITE_MAX,aa=T.INFINITE_MAX;a.clip=function(w,y){const P=c.dot(w,y.ray.direction);w=-C(w,y.ray.origin);if(0>w&&0<=P)return!1;if(-1E-6<
P&&1E-6>P)return 0<w;if((0>w||0>P)&&!(0>w&&0>P))return!0;w/=P;0<P?w<y.c1&&(y.c1=w):w>y.c0&&(y.c0=w);return y.c0<=y.c1};a.clipInfinite=function(w,y){const P=c.dot(w,y.ray.direction);w=-C(w,y.ray.origin);if(-1E-6<P&&1E-6>P)return 0<w;w/=P;0<P?w<y.c1&&(y.c1=w):w>y.c0&&(y.c0=w);return y.c0<=y.c1};a.copy=h;a.create=u;a.distance=function(w,y){return Math.abs(C(w,y))};a.equals=d;a.exactEquals=r;a.fromArray=function(w,y,P=!0){const F=y.length/3;return A(w,(Q,V)=>c.set(Q,y[3*V],y[3*V+1],y[3*V+2]),P?F-1:F)};
a.fromManyPoints=A;a.fromNormalAndOffset=function(w,y,P){c.copy(P,w);P[3]=y;return P};a.fromPoints=m;a.fromPositionAndNormal=l;a.fromValues=e;a.fromVectorsAndPoint=function(w,y,P,F){c.cross(H,y,w);return l(P,H,F)};a.intersectLine=function(w,y,P,F){P=c.subtract(D.sv3d.get(),P,y);return I(w,y,P,X,F)};a.intersectLineSegment=function(w,y,P){return I(w,y.origin,y.vector,T.NONE,P)};a.intersectLineSegmentClamp=function(w,y,P){return I(w,y.origin,y.vector,T.CLAMP,P)};a.intersectPlanes=R;a.intersectRay=function(w,
y,P){return null!=y?I(w,y.origin,y.direction,aa,P):!1};a.isPointInside=function(w,y){return 0<=C(w,y)};a.isPointOutside=function(w,y){return 0>C(w,y)};a.isSphereFullyInside=function(w,y){return 0<=C(w,g.getCenter(y))-y[3]};a.isSphereFullyOutside=function(w,y){return 0>C(w,g.getCenter(y))+y[3]};a.isVertical=function(w){return Math.abs(w[2])<f.getEpsilon()};a.negate=function(w,y){y[0]=-w[0];y[1]=-w[1];y[2]=-w[2];y[3]=-w[3];return y};a.normal=function(w){return w};a.projectPoint=function(w,y,P){const F=
c.scale(D.sv3d.get(),w,-w[3]);y=c.subtract(D.sv3d.get(),y,F);w=p(w,y,D.sv3d.get());c.add(P,w,F);return P};a.projectPointLocal=function(w,y,P,F){var Q=D.sv3d.get(),V=D.sv3d.get();k.tangentFrame(w,Q,V);y=c.subtract(D.sv3d.get(),P,y);Q=B.projectPointSignedLength(Q,y);V=B.projectPointSignedLength(V,y);w=B.projectPointSignedLength(w,y);return c.set(F,Q,V,w)};a.projectVector=p;a.setOffsetFromPoint=function(w,y,P){y!==w&&h(w,y);w[3]=-c.dot(w,P);return w};a.signedDistance=C;a.up=z;a.wrap=function(w=z[0],
y=z[1],P=z[2],F=z[3]){return e(w,y,P,F,D.sv4d.get())};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/sphere":function(){define("exports ../core/has ../core/Logger ../core/mathUtils ./mat4 ./vec3 ./vec3f64 ./vec4 ./vec4f64 ./common ../geometry/support/Axis ../geometry/support/ray ../geometry/support/vector ../geometry/support/vectorStacks".split(" "),function(a,b,c,q,d,f,g,B,D,k,u,h,e,l){function m(){return D.create()}function A(Y,ca=m()){return B.copy(ca,Y)}function p(Y,
ca){return D.fromValues(Y[0],Y[1],Y[2],ca)}function C(Y){return Y}function I(Y){Y[0]=Y[1]=Y[2]=Y[3]=0}function r(Y,ca){Y[0]=Y[1]=Y[2]=0;Y[3]=ca;return Y}function v(Y){return Y[3]}function E(Y){return Y}function H(Y,ca,t,L){return D.fromValues(Y,ca,t,L)}function K(Y,ca,t){Y!==t&&f.copy(t,Y);t[3]=Y[3]+ca;return t}function J(Y,ca,t){c.getLogger("esri.geometry.support.sphere").error("sphere.setExtent is not yet supported");return Y===t?t:A(Y,t)}function R(Y,ca,t){if(null==ca||!T(Y,ca,ka))return!1;let {t0:L,
t1:O}=ka;if(0>L||O<L&&0<O)L=O;if(0>L)return!1;if(t){const {origin:M,direction:W}=ca;t[0]=M[0]+W[0]*L;t[1]=M[1]+W[1]*L;t[2]=M[2]+W[2]*L}return!0}function z(Y,ca,t){ca=h.fromPoints(ca,t);if(!T(Y,ca,ka))return[];const {origin:L,direction:O}=ca,{t0:M,t1:W}=ka;ca=ia=>{const da=g.create();f.scaleAndAdd(da,L,O,ia);return P(Y,da,da)};return Math.abs(M-W)<k.getEpsilon()?[ca(M)]:[ca(M),ca(W)]}function T(Y,ca,t){const {origin:L,direction:O}=ca,M=na;M[0]=L[0]-Y[0];M[1]=L[1]-Y[1];M[2]=L[2]-Y[2];ca=O[0]*O[0]+O[1]*
O[1]+O[2]*O[2];if(0===ca)return!1;const W=2*(O[0]*M[0]+O[1]*M[1]+O[2]*M[2]);Y=W*W-4*ca*(M[0]*M[0]+M[1]*M[1]+M[2]*M[2]-Y[3]*Y[3]);if(0>Y)return!1;Y=Math.sqrt(Y);t.t0=(-W-Y)/(2*ca);t.t1=(-W+Y)/(2*ca);return!0}function X(Y,ca){return R(Y,ca,null)}function aa(Y,ca,t){if(R(Y,ca,t))return t;Y=w(Y,ca,l.sv3d.get());f.add(t,ca.origin,f.scale(l.sv3d.get(),ca.direction,f.distance(ca.origin,Y)/f.length(ca.direction)));return t}function w(Y,ca,t){const L=l.sv3d.get(),O=l.sm4d.get();f.cross(L,ca.origin,ca.direction);
const M=Y[3];f.cross(t,L,ca.origin);f.scale(t,t,1/f.length(t)*M);Y=Q(Y,ca.origin);ca=e.angle(ca.origin,t);d.fromRotation(O,ca+Y,L);f.transformMat4(t,t,O);return t}function y(Y,ca,t){if(R(Y,ca,t))return t;h.closestPoint(ca,Y,t);return P(Y,t,t)}function P(Y,ca,t){ca=f.subtract(l.sv3d.get(),ca,Y);ca=f.scale(l.sv3d.get(),ca,Y[3]/f.length(ca));return f.add(t,ca,Y)}function F(Y,ca){ca=f.subtract(l.sv3d.get(),ca,Y);ca=f.squaredLength(ca);return Math.sqrt(Math.abs(ca-Y[3]*Y[3]))}function Q(Y,ca){ca=f.subtract(l.sv3d.get(),
ca,Y);ca=f.length(ca);Y=Y[3];return q.acosClamped(Y/(Y+Math.abs(Y-ca)))}function V(Y,ca,t,L){Y=f.subtract(oa,ca,Y);switch(t){case u.Axis.X:return t=q.cartesianToSpherical(Y,oa)[2],f.set(L,-Math.sin(t),Math.cos(t),0);case u.Axis.Y:return Y=q.cartesianToSpherical(Y,oa),t=Y[1],Y=Y[2],ca=Math.sin(t),f.set(L,-ca*Math.cos(Y),-ca*Math.sin(Y),Math.cos(t));case u.Axis.Z:return f.normalize(L,Y)}}function ba(Y,ca){ca=f.subtract(ma,ca,Y);return f.length(ca)-Y[3]}function G(Y,ca,t,L){const O=ba(Y,ca);Y=V(Y,ca,
u.Axis.Z,ma);t=f.scale(ma,Y,t-O);return f.add(L,ca,t)}function N(Y,ca){ca=f.squaredDistance(Y,ca);Y=Y[3];return ca<=Y*Y}function S(Y,ca,t=m()){const L=f.distance(Y,ca),O=Y[3],M=ca[3];if(L+M<O)return B.copy(t,Y),t;if(L+O<M)return B.copy(t,ca),t;f.lerp(t,Y,ca,(L+M-O)/(2*L));t[3]=(L+O+M)/2;return t}b=m();const fa=B.equals,ja=B.equals,ka={t0:0,t1:0},na=g.create(),oa=g.create(),ma=g.create(),qa=m(),ra=Object.freeze(Object.defineProperty({__proto__:null,NullSphere:b,altitudeAt:ba,angleToSilhouette:Q,axisAt:V,
clear:I,closestPoint:y,closestPointOnSilhouette:w,containsPoint:N,copy:A,create:m,distanceToSilhouette:F,elevate:K,equals:ja,exactEquals:fa,fromCenterAndRadius:p,fromRadius:r,fromValues:H,getCenter:E,getRadius:v,intersectLine:z,intersectRay:R,intersectRayClosestSilhouette:aa,intersectsRay:X,projectPoint:P,setAltitudeAt:G,setExtent:J,tmpSphere:qa,union:S,wrap:C},Symbol.toStringTag,{value:"Module"}));a.NullSphere=b;a.altitudeAt=ba;a.angleToSilhouette=Q;a.axisAt=V;a.clear=I;a.closestPoint=y;a.closestPointOnSilhouette=
w;a.containsPoint=N;a.copy=A;a.create=m;a.distanceToSilhouette=F;a.elevate=K;a.equals=ja;a.exactEquals=fa;a.fromCenterAndRadius=p;a.fromRadius=r;a.fromValues=H;a.getCenter=E;a.getRadius=v;a.intersectLine=z;a.intersectRay=R;a.intersectRayClosestSilhouette=aa;a.intersectsRay=X;a.projectPoint=P;a.setAltitudeAt=G;a.setExtent=J;a.sphere=ra;a.tmpSphere=qa;a.union=S;a.wrap=C})},"esri/geometry/support/ray":function(){define("exports ../../core/arrayUtils ../../core/ObjectStack ../../chunks/vec3 ../../chunks/vec3f64 ./vectorStacks".split(" "),
function(a,b,c,q,d,f){function g(h){return h?B(d.clone(h.origin),d.clone(h.direction)):B(d.create(),d.create())}function B(h,e){return{origin:h,direction:e}}function D(h,e,l=g()){q.copy(l.origin,h);q.copy(l.direction,e);return l}function k(h,e){h=q.cross(f.sv3d.get(),q.normalize(f.sv3d.get(),h.direction),q.subtract(f.sv3d.get(),e,h.origin));return q.dot(h,h)}const u=new c.ObjectStack(()=>g());a.closestPoint=function(h,e,l){e=q.dot(h.direction,q.subtract(l,e,h.origin));q.add(l,h.origin,q.scale(l,h.direction,
e));return l};a.copy=function(h,e=g()){return D(h.origin,h.direction,e)};a.create=g;a.distance=function(h,e){return Math.sqrt(k(h,e))};a.distance2=k;a.equals=function(h,e){return b.equals(h.origin,e.origin)&&b.equals(h.direction,e.direction)};a.fromPoints=function(h,e,l=g()){q.copy(l.origin,h);q.subtract(l.direction,e,h);return l};a.fromValues=D;a.wrap=function(h,e){const l=u.get();l.origin=h;l.direction=e;return l};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/ObjectStack":function(){define(["exports",
"./nextTick"],function(a,b){class c{constructor(q){this._allocator=q;this._items=[];this._itemsPtr=0;this._grow()}get(){0===this._itemsPtr&&b.nextTick(()=>this._reset());this._itemsPtr===this._items.length&&this._grow();return this._items[this._itemsPtr++]}_reset(){this._items.length=Math.min(Math.min(3*Math.max(8,this._itemsPtr),this._itemsPtr+3072),this._items.length);this._itemsPtr=0}_grow(){for(let q=0;q<Math.max(8,Math.min(this._items.length,1024));q++)this._items.push(this._allocator())}}a.ObjectStack=
c;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/vectorStacks":function(){define(["exports","../../core/VectorStack"],function(a,b){const c=b.VectorStack.createVec2f64(),q=b.VectorStack.createVec3f64(),d=b.VectorStack.createVec4f64(),f=b.VectorStack.createMat3f64(),g=b.VectorStack.createMat4f64();b=b.VectorStack.createQuatf64();a.sm3d=f;a.sm4d=g;a.sq4d=b;a.sv2d=c;a.sv3d=q;a.sv4d=d;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/VectorStack":function(){define("exports ./ByteSizeUnit ./nextTick ../chunks/mat3f64 ../chunks/mat4f64 ../chunks/quatf64 ../chunks/vec2f64 ../chunks/vec3f64 ../chunks/vec4f64".split(" "),
function(a,b,c,q,d,f,g,B,D){class k{constructor(h,e,l){this._itemByteSize=h;this._itemCreate=e;this._buffers=[];this._items=[];this._itemsPtr=0;this._itemsPerBuffer=Math.ceil(l/this._itemByteSize)}get(){0===this._itemsPtr&&c.nextTick(()=>this._reset());const h=Math.floor(this._itemsPtr/this._itemsPerBuffer);for(;this._buffers.length<=h;){const e=new ArrayBuffer(this._itemsPerBuffer*this._itemByteSize);for(let l=0;l<this._itemsPerBuffer;++l)this._items.push(this._itemCreate(e,l*this._itemByteSize));
this._buffers.push(e)}return this._items[this._itemsPtr++]}_reset(){const h=2*(Math.floor(this._itemsPtr/this._itemsPerBuffer)+1);for(;this._buffers.length>h;)this._buffers.pop(),this._items.length=this._buffers.length*this._itemsPerBuffer;this._itemsPtr=0}static createVec2f64(h=u){return new k(16,g.createView,h)}static createVec3f64(h=u){return new k(24,B.createView,h)}static createVec4f64(h=u){return new k(32,D.createView,h)}static createMat3f64(h=u){return new k(72,q.createView,h)}static createMat4f64(h=
u){return new k(128,d.createView,h)}static createQuatf64(h=u){return new k(32,f.createView,h)}get test(){return{size:this._buffers.length*this._itemsPerBuffer*this._itemByteSize}}}const u=4*b.ByteSizeUnit.KILOBYTES;a.VectorStack=k;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/ByteSizeUnit":function(){define(["exports"],function(a){a.ByteSizeUnit=void 0;var b=a.ByteSizeUnit||(a.ByteSizeUnit={});b[b.KILOBYTES=1024]="KILOBYTES";b[b.MEGABYTES=1048576]="MEGABYTES";b[b.GIGABYTES=
1073741824]="GIGABYTES";Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/mat3f64":function(){define(["exports"],function(a){function b(){return[1,0,0,0,1,0,0,0,1]}function c(g){return[g[0],g[1],g[2],g[3],g[4],g[5],g[6],g[7],g[8]]}function q(g,B,D,k,u,h,e,l,m){return[g,B,D,k,u,h,e,l,m]}function d(g,B){return new Float64Array(g,B,9)}const f=Object.freeze(Object.defineProperty({__proto__:null,clone:c,create:b,createView:d,fromValues:q},Symbol.toStringTag,{value:"Module"}));
a.clone=c;a.create=b;a.createView=d;a.fromValues=q;a.mat3f64=f})},"esri/chunks/quatf64":function(){define(["exports"],function(a){function b(){return[0,0,0,1]}function c(B){return[B[0],B[1],B[2],B[3]]}function q(B,D,k,u){return[B,D,k,u]}function d(B,D){return new Float64Array(B,D,4)}const f=b(),g=Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:f,clone:c,create:b,createView:d,fromValues:q},Symbol.toStringTag,{value:"Module"}));a.IDENTITY=f;a.clone=c;a.create=b;a.createView=d;a.fromValues=
q;a.quatf64=g})},"esri/geometry/support/vector":function(){define(["exports","../../core/mathUtils","../../chunks/vec3","../../chunks/vec3f64"],function(a,b,c,q){const d=q.create(),f=q.create();a.angle=function(g,B){g=c.dot(g,B)/(c.length(g)*c.length(B));return-b.acosClamped(g)};a.angleAroundAxis=function(g,B,D){c.normalize(d,g);c.normalize(f,B);g=c.dot(d,f);g=b.acosClamped(g);B=c.cross(d,d,f);return 0>c.dot(B,D)?2*Math.PI-g:g};a.projectPoint=function(g,B,D){B=c.dot(g,B)/c.dot(g,g);return c.scale(D,
g,B)};a.projectPointSignedLength=function(g,B){return c.dot(g,B)/c.length(g)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/support/mathUtils":function(){define(["exports","../../../core/mathUtils","../../../chunks/vec3","../../../chunks/vec3f64"],function(a,b,c,q){const d=q.create(),f=q.create(),g=q.create(),B=q.create(),D=q.create();a.angle=function(k,u,h){k=c.normalize(B,k);u=c.normalize(D,u);const e=b.acosClamped(c.dot(k,u));return h&&(k=c.cross(g,k,u),0>c.dot(k,
h))?-e:e};a.bilerp=function(k,u,h,e,l,m){k+=(u-k)*l;return k+(h+(e-h)*l-k)*m};a.cosCapped=function(k,u){return k>u?Math.cos(u):Math.cos(k)};a.fovx2fovy=function(k,u,h){return 2*Math.atan(h*Math.tan(.5*k)/u)};a.fovy2fovx=function(k,u,h){return 2*Math.atan(u*Math.tan(.5*k)/h)};a.makeOrthonormal=function(k,u,h){h=h||k;const e=c.dot(k,u);c.set(h,k[0]-e*u[0],k[1]-e*u[1],k[2]-e*u[2]);c.normalize(h,h)};a.makePiecewiseLinearFunction=function(k){const u=k.length;return h=>{if(h<=k[0][0])return k[0][1];if(h>=
k[u-1][0])return k[u-1][1];let e=1;for(;h>k[e][0];)e++;const l=k[e][0];h=(l-h)/(l-k[e-1][0]);return h*k[e-1][1]+(1-h)*k[e][1]}};a.maxScale=function(k){return Math.sqrt(Math.max(k[0]*k[0]+k[4]*k[4]+k[8]*k[8],k[1]*k[1]+k[5]*k[5]+k[9]*k[9],k[2]*k[2]+k[6]*k[6]+k[10]*k[10]))};a.planeFromPoints=function(k,u,h,e){c.subtract(d,u,k);c.subtract(f,h,k);c.cross(e,d,f);c.normalize(e,e);e[3]=-c.dot(k,e)};a.scaleFromMatrix=function(k,u){c.set(k,Math.sqrt(u[0]*u[0]+u[4]*u[4]+u[8]*u[8]),Math.sqrt(u[1]*u[1]+u[5]*u[5]+
u[9]*u[9]),Math.sqrt(u[2]*u[2]+u[6]*u[6]+u[10]*u[10]));return k};a.slerp=function(k,u,h,e=q.create()){const l=c.length(k);var m=c.length(u),A=c.dot(k,u)/(l*m);if(.9999999999999999>A){A=Math.acos(A);const p=((1-h)*l+h*m)/Math.sin(A);m=p/m*Math.sin(h*A);c.scale(B,k,p/l*Math.sin((1-h)*A));c.scale(D,u,m);return c.add(e,B,D)}return c.lerp(e,k,u,h)};a.slerpTangent=function(k,u,h,e=q.create(),l=q.create()){const m=c.length(k),A=c.length(u);var p=c.dot(k,u)/(m*A);if(.9999999999999999>p){p=Math.acos(p);const C=
Math.sin(p),I=Math.sin(h*p),r=Math.sin((1-h)*p),v=(1-h)*m+h*A,E=v/C,H=E/A*I;c.scale(B,k,E/m*r);c.scale(D,u,H);c.add(e,B,D);c.scale(B,k,1/m*(-Math.cos((1-h)*p)*p*v+r*(-m+A)));c.scale(D,u,1/A*(Math.cos(h*p)*p*v+I*(-m+A)));c.add(l,B,D);c.scale(l,l,1/C);return l}c.lerp(e,k,u,h);c.subtract(l,u,k);c.normalize(l,l);return l};a.tangentFrame=function(k,u,h){Math.abs(k[0])>Math.abs(k[1])?c.set(u,0,1,0):c.set(u,1,0,0);c.cross(h,k,u);c.normalize(u,u);c.cross(u,h,k);c.normalize(h,h)};Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/views/support/geometry3dUtils":function(){define("exports ../../core/mathUtils ../../chunks/vec2 ../../chunks/vec2f64 ../../chunks/vec3 ../../chunks/vec3f64 ../../geometry/support/plane ../3d/support/mathUtils ./geometry2dUtils".split(" "),function(a,b,c,q,d,f,g,B,D){function k(w,{start:y,end:P,type:F}){w=d.sub(v,w,y);P=d.sub(E,P,y);w=d.dot(w,P)/d.dot(P,P);return d.scaleAndAdd(f.create(),y,P,F===D.LineType.RAY?Math.max(w,0):w)}function u({start:w,end:y,type:P},F){const Q=
d.sub(v,F,w);y=d.sub(E,y,w);if(P===D.LineType.RAY&&-1E-6>d.dot(y,Q))return d.distance(w,F);w=d.cross(H,y,Q);return d.len(w)/d.len(y)}function h(w,y){const P=w.start,F=y.start;var Q=y.end;const V=d.sub(v,w.end,P);Q=d.sub(E,Q,F);var ba=d.sub(H,F,P),G=d.cross(K,V,Q),N=d.dot(ba,G);if(!b.floatEqualAbsolute(N,0,1E-6))return[];N=d.sqrLen(G);if(b.floatEqualAbsolute(N,0,1E-6))return[];ba=d.cross(J,ba,Q);G=d.dot(ba,G)/N;G=d.scaleAndAdd(R,P,V,G);return w.type===D.LineType.RAY&&(w=d.sub(z,G,P),-1E-6>d.dot(V,
w))||y.type===D.LineType.RAY&&(y=d.sub(z,G,F),-1E-6>d.dot(Q,y))?[]:[f.clone(G)]}function e({start:w,end:y,type:P},F){const Q=d.sub(v,F,w);w=d.sub(E,y,w);y=d.cross(H,w,Q);if(1E-6>d.sqrLen(y)/d.sqrLen(w))switch(P){case D.LineType.LINE:return[f.clone(F)];case D.LineType.RAY:return-1E-6>d.dot(w,Q)?[]:[f.clone(F)]}return[]}function l(w,y,{start:P,end:F,type:Q}){d.set(w.start,P[0],P[1],y);d.set(w.end,F[0],F[1],y);w.type=C[Q];return w}function m(w,y){return 1E-6>Math.abs(w-y)}function A(w,y){return g.isPointInside(w,
y)}const p=(()=>{const w=f.create(),y=f.create(),P=f.create();return({start:F,end:Q},{center:V,radius:ba,normal:G,slicePlane:N})=>{const S=f.create(),fa=g.fromPositionAndNormal(V,G,T);if(m(g.distance(fa,F),0)&&m(g.distance(fa,Q),0)){B.tangentFrame(G,w,y);G=(ja,ka)=>{d.subtract(P,ka,V);c.set(ja,d.dot(P,w),d.dot(P,y));return ja};Q=D.intersectLineLikeAndCircle({start:G(I,F),end:G(r,Q),type:D.LineType.LINE},q.ZEROS,ba);F=[];for(const [ja,ka]of Q)Q=d.copy(f.create(),V),d.scaleAndAdd(Q,Q,w,ja),d.scaleAndAdd(Q,
Q,y,ka),N&&!A(N,Q)||F.push(Q);return F}return g.intersectLine(fa,F,Q,S)?!m(d.distance(S,V),ba)||N&&!A(N,S)?[]:[S]:[]}})();a.VerticalPlaneType=void 0;(function(w){w[w.PLANE=0]="PLANE";w[w.HALF_PLANE=1]="HALF_PLANE"})(a.VerticalPlaneType||(a.VerticalPlaneType={}));const C={[a.VerticalPlaneType.PLANE]:D.LineType.LINE,[a.VerticalPlaneType.HALF_PLANE]:D.LineType.RAY},I=q.create(),r=q.create(),v=f.create(),E=f.create(),H=f.create(),K=f.create(),J=f.create(),R=f.create(),z=f.create(),T=g.create(),X={start:f.create(),
end:f.create(),type:D.LineType.LINE},aa={start:f.create(),end:f.create(),type:D.LineType.LINE};Object.defineProperty(a,"LineType",{enumerable:!0,get:()=>D.LineType});a.epsilon=1E-6;a.intersectLineAndPoint=e;a.intersectLineLikeAndCircle=p;a.intersectLineLikeAndVerticalCylinder=function({start:w,end:y,type:P},F,Q){const V=[];y=d.subtract(v,y,w);var ba=c.subtract(E,w,F);F=c.squaredLength(y);const G=2*c.dot(y,ba);Q=c.squaredLength(ba)-Q*Q;Q=G*G-4*F*Q;0===Q?(F=-G/(2*F),(P===D.LineType.LINE||0<=F)&&V.push(d.scaleAndAdd(f.create(),
w,y,F))):0<Q&&(Q=Math.sqrt(Q),ba=(-G+Q)/(2*F),(P===D.LineType.LINE||0<=ba)&&V.push(d.scaleAndAdd(f.create(),w,y,ba)),F=(-G-Q)/(2*F),(P===D.LineType.LINE||0<=F)&&V.push(d.scaleAndAdd(f.create(),w,y,F)));return V};a.intersectLineLikes=h;a.intersectVerticalCylinderAndPoint=function(w,y,P){return b.floatEqualAbsolute(c.squaredDistance(P,w),y*y,1E-6)?[f.clone(P)]:[]};a.intersectVerticalCylinders=function(w,y,P,F){const [Q,V]=w,[ba,G]=P;var N=ba-Q,S=G-V;const fa=N*N+S*S,ja=Math.sqrt(fa);if(ja>y+F||ja<Math.abs(y-
F)||m(ja,0)&&m(y,F))return[];F=(y*y-F*F+fa)/(2*ja);y=Math.sqrt(y*y-F*F);S=y*S/ja;N=y*N/ja;const [ka,na]=c.lerp(I,w,P,F/ja);return m(S,N)?[q.fromValues(ka,na)]:[q.fromValues(ka+S,na-N),q.fromValues(ka-S,na+N)]};a.intersectVerticalPlaneAndLineLike=function(w,y){const P=w.start,F=c.subtract(v,w.end,P);var Q=d.set(E,-F[1],F[0],0);const V=y.start,ba=d.sub(H,y.end,V);var G=d.dot(ba,Q),N=d.set(K,P[0],P[1],0);N=d.sub(J,N,V);Q=d.dot(N,Q);if(1E-6>Math.abs(G))return[];G=d.scaleAndAdd(R,V,ba,Q/G);return y.type===
D.LineType.RAY&&(y=d.sub(z,G,V),-1E-6>d.dot(y,ba))||w.type===a.VerticalPlaneType.HALF_PLANE&&(w=c.sub(z,G,P),-1E-6>c.dot(w,F))?[]:[f.clone(G)]};a.intersectVerticalPlaneAndPoint=function(w,y){return e(l(X,y[2],w),y)};a.intersectVerticalPlaneAndVerticalCylinder=function({start:w,end:y,type:P},F,Q){const V=[];y=c.subtract(v,y,w);var ba=c.subtract(E,w,F);F=c.squaredLength(y);const G=2*c.dot(y,ba);Q=c.squaredLength(ba)-Q*Q;Q=G*G-4*F*Q;0===Q?(F=-G/(2*F),(P===a.VerticalPlaneType.PLANE||0<=F)&&V.push(c.scaleAndAdd(q.create(),
w,y,F))):0<Q&&(Q=Math.sqrt(Q),ba=(-G+Q)/(2*F),(P===a.VerticalPlaneType.PLANE||0<=ba)&&V.push(c.scaleAndAdd(q.create(),w,y,ba)),F=(-G-Q)/(2*F),(P===a.VerticalPlaneType.PLANE||0<=F)&&V.push(c.scaleAndAdd(q.create(),w,y,F)));return V};a.intersectVerticalPlanes=function(w,y){w=l(X,0,w);y=l(aa,0,y);y=h(w,y);w=[];for(const P of y)w.push(q.clone(P));return w};a.isClose=m;a.isPointInsidePlane=A;a.pointToLineLikeDistance=u;a.pointToVerticalCylinderDistance=function(w,y,P){return c.distance(w,y)-P};a.pointToVerticalPlaneDistance=
function(w,y){return u(l(X,w[2],y),w)};a.pointsInsidePlane=function(w,y){return y.filter(P=>A(w,P))};a.projectPointToLineLike=k;a.projectPointToVerticalCylinder=function(w,y,P){const F=c.subtract(v,w,y);P/=c.length(F);y=c.scaleAndAdd(f.create(),y,F,P);y[2]=w[2];return y};a.projectPointToVerticalPlane=function(w,y){return k(w,l(X,w[2],y))};a.vectorsHaveCloseZ=function(w,y){return m(w[2],y[2])};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/geometry2dUtils":function(){define(["exports",
"../../core/mathUtils","../../chunks/vec2","../../chunks/vec2f64"],function(a,b,c,q){function d(e,l){return e[0]*l[1]-e[1]*l[0]}function f(e,l,m){l=c.dot(m,l)/c.squaredLength(m);return c.scale(e,m,l)}function g(e,l,m,A,p=m){c.subtract(D,A,m);c.subtract(u,l,p);f(h,u,D);return c.add(e,p,h)}function B(e,l,m,A){c.subtract(D,l,m);l=A/c.length(D);return c.scaleAndAdd(e,m,D,l)}a.LineType=void 0;(function(e){e[e.RAY=0]="RAY";e[e.LINE=1]="LINE"})(a.LineType||(a.LineType={}));const D=q.create(),k=q.create(),
u=q.create(),h=q.create();a.cross=d;a.intersectCircleAndPoint=function(e,l,m){B(u,m,e,l);return b.floatEqualAbsolute(u[0],m[0])&&b.floatEqualAbsolute(u[1],m[1])?[q.clone(m)]:[]};a.intersectLineAndPoint=function(e,l){g(u,l,e.start,e.end);return b.floatEqualAbsolute(u[0],l[0])&&b.floatEqualAbsolute(u[1],l[1])?[q.clone(l)]:[]};a.intersectLineAndRay=function(e,l){const m=e.start;var A=l.start,p=l.end;const C=c.subtract(D,e.end,m);var I=c.subtract(k,p,A);p=d(C,I);if(1E-6>=Math.abs(p))return[];A=c.subtract(u,
m,A);I=d(I,A)/p;p=d(C,A)/p;if(0<=I){if(0<=p||l.type===a.LineType.LINE)return[c.scaleAndAdd(h,m,C,I)]}else if(e.type===a.LineType.LINE&&(0<=p||l.type===a.LineType.LINE))return[c.scaleAndAdd(h,m,C,I)];return[]};a.intersectLineLikeAndCircle=function(e,l,m){const A=[],p=c.subtract(D,e.end,e.start);var C=c.subtract(k,e.start,l);l=c.squaredLength(p);const I=2*c.dot(p,C);m=c.squaredLength(C)-m*m;m=I*I-4*l*m;0===m?(l=-I/(2*l),(e.type===a.LineType.LINE||0<=l)&&A.push(c.scaleAndAdd(h,e.start,p,l))):0<m&&(m=
Math.sqrt(m),C=(-I+m)/(2*l),(e.type===a.LineType.LINE||0<=C)&&A.push(c.scaleAndAdd(h,e.start,p,C)),l=(-I-m)/(2*l),(e.type===a.LineType.LINE||0<=l)&&A.push(c.scaleAndAdd(u,e.start,p,l)));return A};a.pointToLineDistance=function(e,l,m){return Math.abs((l[0]-e[0])*(m[1]-e[1])-(l[1]-e[1])*(m[0]-e[0]))/c.distance(l,m)};a.projectPoint=f;a.projectPointToCircle=B;a.projectPointToLine=g;a.projectPointToRay=function(e,l,m,A){c.subtract(D,A,m);c.subtract(u,l,m);l=c.dot(D,u)/c.squaredLength(D);return 0<l?c.scaleAndAdd(e,
m,D,l):c.copy(e,m)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/FeatureSnappingSourceInfo":function(){define("exports ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Logger ../../../core/reactiveUtils ../../../core/sql ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../layers/support/FeatureFilter ../../../layers/support/floorFilterUtils ../../../layers/support/layerUtils ./snappingUtils".split(" "),
function(a,b,c,q,d,f,g,B,D,k,u,h,e,l,m){function A(p,C){return null==p?new h({where:C}):p.where?new h({where:f.sqlAnd(p.where,C)}):new h({where:C})}a.FeatureSnappingSourceInfo=class extends c{get layerView(){return this.view?.allLayerViews?.find(p=>p.layer===this.layer)}get valid(){return this._valid}get subtypeFilter(){const {layer:p}=this;if(!l.isSubtypeGroupLayer(p)||!p.subtypes?.length)return{mode:"not-in-use",filter:null};const C=p.fieldsIndex.get(p.subtypeField)?.name??p.subtypeField,I=p.sublayers.filter(r=>
r.visible).map(r=>r.subtypeCode);return I.length?I.length===p.subtypes.length?{mode:"all-visible",filter:null}:1===I.length?{mode:"in-use",filter:`${C} = ${I.getItemAt(0)}`}:{mode:"in-use",filter:`${C} IN (${I.join(", ")})`}:{mode:"none-visible",filter:null}}get floorFilter(){const {view:p,layer:C}=this;return p&&C?e.getFloorFilterClause({view:p,layer:C}):null}constructor(p){super(p);this.rulesTable=null;this._valid=!1}initialize(){if(this.snappingSource&&this.layer){var {layer:p,snappingSource:C}=
this;"refresh"in p&&this.addHandles(p.on("refresh",()=>C.refresh()));this.loadRules();this.addHandles([d.watch(()=>C.updating,I=>C.layerSource.updating=I,d.syncAndInitial),d.watch(()=>C.availability,I=>C.layerSource.availability=I,d.syncAndInitial)])}}getFetchCandidatesParameters(p,C,I){if(!this.valid)return[];const {layer:r,layerView:v,floorFilter:E,rulesTable:H,subtypeFilter:K}=this;p={distance:I,mode:this.view?.type??"2d",point:p,coordinateHelper:C.coordinateHelper,...this._types,filter:v&&"filter"in
v?v.filter:null};E&&(p.filter=A(p.filter,E));if("not-in-use"!==K.mode&&"all-visible"!==K.mode){if("none-visible"===K.mode)return[];p.filter?p.filter.where=f.sqlAnd(p.filter.where,K.mode):p.filter=new h({where:K.filter})}if(H){I=C.feature;var J=I?.sourceLayer;if(!(I&&l.isFeatureLayer(r)&&r.layerId&&l.isFeatureLayer(J))||"loaded"!==H.loadStatus)return[];C=[];const R=r.layerId;J=H.getFeatureSQL(J,I)?.[R];if(!J)return[];I=J.anyVertex;(J=J.endVertex)&&I&&J===I&&(J="");J&&C.push({...p,returnEdge:!1,vertexMode:"ends",
filter:A(p.filter,J)});I&&C.push({...p,returnEdge:!1,vertexMode:"all",filter:A(p.filter,I)});return C}return[p]}async loadRules(){const {layer:p,view:C}=this;if(p&&C&&m.isUtilityNetworkWebMap(C?.map)&&l.isFeatureLayer(p)){const I=C.map.utilityNetworks?.find(r=>r.isUtilityLayer(p));if(I)try{this.rulesTable=await I.getRulesTable(),await this.rulesTable?.load(),this._valid=!0}catch(r){q.getLogger("esri.views.interactive.snapping.FeatureSnappingSourceInfo").error("Failed to load rules table for snapping source",
p.title)}}else this._valid=!0}get _types(){return{returnEdge:!0,vertexMode:"all"}}remove(){this.destroy()}destroy(){this.snappingSource?.destroy()}};b.__decorate([g.property({constructOnly:!0})],a.FeatureSnappingSourceInfo.prototype,"layer",void 0);b.__decorate([g.property({constructOnly:!0})],a.FeatureSnappingSourceInfo.prototype,"snappingSource",void 0);b.__decorate([g.property({constructOnly:!0})],a.FeatureSnappingSourceInfo.prototype,"view",void 0);b.__decorate([g.property()],a.FeatureSnappingSourceInfo.prototype,
"layerView",null);b.__decorate([g.property()],a.FeatureSnappingSourceInfo.prototype,"rulesTable",void 0);b.__decorate([g.property()],a.FeatureSnappingSourceInfo.prototype,"valid",null);b.__decorate([g.property()],a.FeatureSnappingSourceInfo.prototype,"subtypeFilter",null);b.__decorate([g.property()],a.FeatureSnappingSourceInfo.prototype,"floorFilter",null);b.__decorate([g.property()],a.FeatureSnappingSourceInfo.prototype,"_valid",void 0);a.FeatureSnappingSourceInfo=b.__decorate([u.subclass("esri.views.interactive.snapping.FeatureSnappingSourceInfo")],
a.FeatureSnappingSourceInfo);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/floorFilterUtils":function(){define(["exports"],function(a){function b(c,q){if(!c?.length)return null;c=c.filter(d=>""!==d).map(d=>`'${d}'`);c.push("''");return`${q} IN (${c.join(",")}) OR ${q} IS NULL`}a.getFloorFilterClause=function(c){const q=c.layer;return"floorInfo"in q&&q.floorInfo?.floorField&&"floors"in c.view?b(c.view.floors,q.floorInfo.floorField):null};a.getLayerFloorFilterClause=
function(c,q){return"floorInfo"in q&&q.floorInfo?.floorField?b(c,q.floorInfo.floorField):null};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/snappingUtils":function(){define("exports ../../../core/reactiveUtils ../../../core/SetUtils ../../../core/sql ../../../core/timeUtils ../../../chunks/vec3 ../../../layers/graphics/dehydratedPoint ../../../rest/support/Query ../../input/InputManager ../keybindings ../sketch/normalizedPoint".split(" "),function(a,
b,c,q,d,f,g,B,D,k,u){function h(e,l){const m=e.x-l.x;e=e.y-l.y;return m*m+e*e}a.LineSegmentHintType=void 0;(function(e){e[e.TARGET=0]="TARGET";e[e.REFERENCE=1]="REFERENCE";e[e.REFERENCE_EXTENSION=2]="REFERENCE_EXTENSION"})(a.LineSegmentHintType||(a.LineSegmentHintType={}));a.editEdgeToSnappingEdge=function(e,l,m){return{left:u.fromAnyMapPoint(e.leftVertex.pos,l,m),right:u.fromAnyMapPoint(e.rightVertex.pos,l,m)}};a.isUtilityNetworkWebMap=function(e){return null!=e&&"object"===typeof e&&"declaredClass"in
e&&"esri.WebMap"===e.declaredClass&&"utilityNetworks"in e&&!!e?.utilityNetworks?.length};a.makeFilter=function(e){return e.createQuery()};a.makeSnappingQuery=function({point:e,distance:l,returnEdge:m,vertexMode:A,coordinateHelper:{spatialReference:p},filter:C},I,r){r=null!=r?r.clone():new B({where:"1\x3d1"});if(C){r.geometry=C.geometry;r.distance=C.distance;r.spatialRelationship=C.spatialRelationship;r.where=q.sqlAnd(r.where,C.where);r.timeExtent=d.mergeTimeExtents(r.timeExtent,C.timeExtent);var v=
r;var E=r.objectIds;C=C.objectIds;E=E||C?C?E?Array.from(c.intersection(new Set(E),new Set(C))):C:E:null;v.objectIds=E}return{point:g.makeDehydratedPoint(e[0],e[1],e[2],p.toJSON()),mode:I,distance:l,returnEdge:m,vertexMode:A,query:r.toJSON()}};a.objectEqual=function(e,l){const m=e.length===l.length&&e[0]===l[0]&&e[1]===l[1];switch(e.length){case 2:return m;case 3:return m&&e[2]===l[2];case 4:return m&&e[2]===l[2]&&e[3]===l[3]}return!1};a.screenDistance=function(e,l){return Math.sqrt(h(e,l))};a.setupSnappingToggleHandles=
function(e,l=()=>{}){const m=b.watch(()=>({view:e.view,snappingOptions:e.snappingOptions}),({view:A,snappingOptions:p})=>{const C=D.ViewEventPriorities.TOOL;e.removeHandles("snapping-toggle");A&&null!=p&&(A=[A.on("key-down",I=>{I.key!==k.snappingKeys.toggle||I.repeat||(p.enabledToggled=!0,l())},C),A.on("key-up",I=>{I.key===k.snappingKeys.toggle&&(p.enabledToggled=!1,l())},C),A.on("pointer-move",I=>{I=I.native.ctrlKey;p.enabledToggled!==I&&(p.enabledToggled=I,l())},C)],e.addHandles(A,"snapping-toggle"))},
b.syncAndInitial);e.addHandles(m)};a.sortCandidatesInPlace=function(e,l){l.sort((m,A)=>{m=f.squaredDistance(m.targetPoint,e);A=f.squaredDistance(A.targetPoint,e);return m-A})};a.squaredScreenDistance=h;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/DrapedEdgeSnappingCandidate":function(){define(["exports","../../sketch/constraints","../snappingUtils","./FeatureSnappingCandidate","../hints/LineSnappingHint"],function(a,b,c,q,d){class f extends q.FeatureSnappingCandidate{constructor(g){super({...g,
isDraped:!0,constraint:new b.DrapedLineConstraint(g.edgeStart,g.edgeEnd,g.getGroundElevation)})}get hints(){return[new d.LineSnappingHint(c.LineSegmentHintType.REFERENCE,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}}a.DrapedEdgeSnappingCandidate=f;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/FeatureSnappingCandidate":function(){define(["exports","../SnappingDomain","./SnappingCandidate"],function(a,b,c){class q extends c.SnappingCandidate{constructor({targetPoint:d,
objectId:f,constraint:g,isDraped:B}){super(d,g,B,b.SnappingDomain.FEATURE);this.objectId=f}}a.FeatureSnappingCandidate=q;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/SnappingCandidate":function(){define(["exports"],function(a){class b{constructor(c,q,d,f){this.targetPoint=c;this.constraint=q;this.isDraped=d;this.domain=f}}a.SnappingCandidate=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/LineSnappingHint":function(){define("exports ../../../../core/has ../../../../core/Logger ../../../../chunks/vec3 ../SnappingDomain ./SnappingHint".split(" "),
function(a,b,c,q,d,f){class g extends f.SnappingHint{constructor(B,D,k,u,h=d.SnappingDomain.ALL,e=!0,l=!0){super(u,h);this.type=B;this.lineStart=D;this.lineEnd=k;this.fadeLeft=e;this.fadeRight=l}equals(B){return B instanceof g?this.type===B.type&&q.exactEquals(this.lineStart,B.lineStart)&&q.exactEquals(this.lineEnd,B.lineEnd)&&this.fadeLeft===B.fadeLeft&&this.fadeRight===B.fadeRight:!1}get length(){return q.distance(this.lineStart,this.lineEnd)}}a.LineSnappingHint=g;Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/views/interactive/snapping/hints/SnappingHint":function(){define(["exports"],function(a){class b{constructor(c,q){this.isDraped=c;this.domain=q}}a.SnappingHint=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/EdgeSnappingCandidate":function(){define(["exports","../../sketch/constraints","../snappingUtils","./FeatureSnappingCandidate","../hints/LineSnappingHint"],function(a,b,c,q,d){class f extends q.FeatureSnappingCandidate{constructor(g){super({...g,
constraint:new b.LineConstraint(g.edgeStart,g.edgeEnd)})}get hints(){return[new d.LineSnappingHint(c.LineSegmentHintType.REFERENCE,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}}a.EdgeSnappingCandidate=f;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/RightAngleSnappingCandidate":function(){define("exports ../SnappingDomain ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint ../hints/RightAngleSnappingHint".split(" "),
function(a,b,c,q,d,f){class g extends q.SnappingCandidate{constructor({targetPoint:B,constraint:D,previousVertex:k,otherVertex:u,otherVertexType:h,objectId:e,isDraped:l}){super(B,D,l,b.SnappingDomain.SELF);this.previousVertex=k;this.otherVertex=u;this.otherVertexType=h;this.objectId=e}get hints(){const B=this.previousVertex,D=this.otherVertexType===a.OtherVertexType.CENTER?this.otherVertex:this.targetPoint,k=this.otherVertexType===a.OtherVertexType.CENTER?this.targetPoint:this.otherVertex;return[new d.LineSnappingHint(c.LineSegmentHintType.TARGET,
D,k,this.isDraped,this.domain),new d.LineSnappingHint(c.LineSegmentHintType.REFERENCE,B,D,this.isDraped,this.domain),new f.RightAngleSnappingHint(this.previousVertex,D,k,this.isDraped,this.domain)]}}a.OtherVertexType=void 0;(function(B){B[B.NEXT=0]="NEXT";B[B.CENTER=1]="CENTER"})(a.OtherVertexType||(a.OtherVertexType={}));a.RightAngleSnappingCandidate=g;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/RightAngleSnappingHint":function(){define("exports ../../../../core/has ../../../../core/Logger ../../../../chunks/vec3 ../SnappingDomain ./SnappingHint".split(" "),
function(a,b,c,q,d,f){class g extends f.SnappingHint{constructor(B,D,k,u,h=d.SnappingDomain.ALL){super(u,h);this.previousVertex=B;this.centerVertex=D;this.nextVertex=k}equals(B){return B instanceof g?q.exactEquals(this.previousVertex,B.previousVertex)&&q.exactEquals(this.centerVertex,B.centerVertex)&&q.exactEquals(this.nextVertex,B.nextVertex):!1}}a.RightAngleSnappingHint=g;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/support/viewUtils":function(){define("exports ../../../core/screenUtils ../../../chunks/vec2 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../layers/graphics/dehydratedPoint ../../../support/elevationInfoUtils".split(" "),
function(a,b,c,q,d,f,g){function B(A,p,C,I,r=d.create()){A=p.toXYZ(A);A[2]=g.getConvertedElevationFromVector(I,A,p.spatialReference,C)||0;I.renderCoordsHelper.toRenderCoords(A,p.spatialReference,r);return r}function D(A,p,C,I,r=d.create()){A=q.copy(h,A);A[2]=g.getConvertedElevationFromVector(I,A,p,C)||0;I.renderCoordsHelper.toRenderCoords(A,p,r);return r}function k(A,p,C,I){if("2d"===I.type)return u.x=A[0],u.y=A[1],u.spatialReference=p,I.toScreen(u);D(A,p,C,I,h);I.state.camera.projectToScreen(h,m);
return b.createScreenPoint(m[0],m[1])}const u=f.makeDehydratedPoint(0,0,0,null),h=d.create(),e=b.createRenderScreenPointArray3(),l=b.createRenderScreenPointArray3(),m=b.createScreenPointArray();a.anyMapPointToRender=B;a.anyMapPointToScreenPoint=function(A,p,C,I){return k(p.toXYZ(A),p.spatialReference,C,I)};a.anyMapPointsToRenderWithEqualRelativeZ=function(A,p,C,I,r,v,E){if("absolute-height"===I.mode)B(A,C,I,r,v),B(p,C,I,r,E);else{A=C.toXYZ(A);p=C.toXYZ(p);var H=g.getConvertedElevationFromVector(r,
A,C.spatialReference,I);I=g.getConvertedElevationFromVector(r,p,C.spatialReference,I);I=(null==H?I:null==I?H:Math.min(H,I))||0;A[2]=I;p[2]=I;r.renderCoordsHelper.toRenderCoords(A,C.spatialReference,v);r.renderCoordsHelper.toRenderCoords(p,C.spatialReference,E)}};a.renderScreenSpaceTangent=function(A,p,C,I){C.projectToRenderScreen(A,e);C.projectToRenderScreen(p,l);c.subtract(I,l,e);c.normalize(I,I)};a.vectorToRender=D;a.vectorToScreenPoint=k;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/views/interactive/snapping/SelfSnappingEngine":function(){define("exports ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Collection ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./LineSnapper ./ParallelLineSnapper ./RightAngleSnapper ./RightAngleTriangleSnapper ./SnappingDomain ./snappingUtils".split(" "),function(a,b,c,q,d,f,g,B,D,k,u,h,e,
l,m){a.SelfSnappingEngine=class extends c{constructor(A){super(A);this.updating=!1;this._snappers=new q;this._domain=l.SnappingDomain.SELF}initialize(){this._snappers.push(new u.ParallelLineSnapper(this.view,this.options),new k.LineSnapper(this.view,this.options),new h.RightAngleSnapper(this.view,this.options),new e.RightAngleTriangleSnapper(this.view,this.options))}set options(A){this._set("options",A);for(const p of this._snappers)p.options=A}async fetchCandidates(A,p,C){if(!(p&this._domain&&this.options.effectiveSelfEnabled))return[];
p=[];for(const I of this._snappers.items)for(const r of I.snap(A,C))p.push(r);m.sortCandidatesInPlace(A,p);return p}};b.__decorate([d.property({readOnly:!0})],a.SelfSnappingEngine.prototype,"updating",void 0);b.__decorate([d.property({constructOnly:!0})],a.SelfSnappingEngine.prototype,"view",void 0);b.__decorate([d.property()],a.SelfSnappingEngine.prototype,"options",null);a.SelfSnappingEngine=b.__decorate([D.subclass("esri.views.interactive.snapping.SelfSnappingEngine")],a.SelfSnappingEngine);Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/LineSnapper":function(){define("exports ../../../support/elevationInfoUtils ../sketch/normalizedPoint ./SnappingAlgorithm ./snappingUtils ./candidates/LineSnappingCandidate ../support/viewUtils ../../support/geometry3dUtils ../../support/geometry2dUtils".split(" "),function(a,b,c,q,d,f,g,B,D){class k extends q.SnappingAlgorithm{snapNewVertex(u,h){var e=h.editGeometryOperations.data.components[0],l=e.edges.length;const m=[];if(1>
l)return m;var {spatialReference:A}=h;A=g.vectorToScreenPoint(u,A,b.absoluteHeightElevationInfo,this.view);const {view:p}=this;l=e=e.edges[l-1];do{if(this.edgeExceedsShortLineThreshold(l,h)){const C=d.editEdgeToSnappingEdge(l,p,h);this._processCandidateProposal(C.left,C.right,u,A,h,m)}l=l.leftVertex.leftEdge}while(l&&l!==e);return m}snapExistingVertex(u,h){const e=[],l=h.vertexHandle;var m=l.component;if(2>m.edges.length)return e;const {view:A}=this;var {spatialReference:p}=h;p=g.vectorToScreenPoint(u,
p,b.absoluteHeightElevationInfo,A);var C=l.leftEdge,I=l.rightEdge;C&&I&&this.edgeExceedsShortLineThreshold(C,h)&&this.edgeExceedsShortLineThreshold(I,h)&&this._processCandidateProposal(c.fromAnyMapPoint(C.leftVertex.pos,A,h),c.fromAnyMapPoint(I.rightVertex.pos,A,h),u,p,h,e);C=m=m.edges[0];do C!==l.leftEdge&&C!==l.rightEdge&&this.edgeExceedsShortLineThreshold(C,h)&&(I=d.editEdgeToSnappingEdge(C,A,h),this._processCandidateProposal(I.left,I.right,u,p,h,e)),C=C.rightVertex.rightEdge;while(C&&C!==m);return e}_processCandidateProposal(u,
h,e,l,m,A){const {spatialReference:p,pointer:C}=m;e=c.fromVec3(B.projectPointToLineLike(e,{start:u,end:h,type:D.LineType.LINE}));d.squaredScreenDistance(l,g.vectorToScreenPoint(e,p,b.absoluteHeightElevationInfo,this.view))<this.squaredProximityThreshold(C)&&A.push(new f.LineSnappingCandidate({lineStart:u,lineEnd:h,targetPoint:e,isDraped:"on-the-ground"===m.elevationInfo?.mode}))}}a.LineSnapper=k;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingAlgorithm":function(){define("exports ../../../chunks/vec2 ../../../support/elevationInfoUtils ../sketch/normalizedPoint ./Settings ./snappingUtils ../support/viewUtils".split(" "),
function(a,b,c,q,d,f,g){class B{constructor(D,k){this.view=D;this.options=k;this.squaredShortLineThreshold=d.defaults.shortLineThreshold*d.defaults.shortLineThreshold}snap(D,k){return null!=k.vertexHandle?"vertex"!==k.vertexHandle.type?[]:this.snapExistingVertex(D,k):this.snapNewVertex(D,k)}edgeExceedsShortLineThreshold(D,k){return this.exceedsShortLineThreshold(q.fromAnyMapPoint(D.leftVertex.pos,this.view,k),q.fromAnyMapPoint(D.rightVertex.pos,this.view,k),k)}exceedsShortLineThreshold(D,k,{spatialReference:u}){return 0===
this.squaredShortLineThreshold||f.squaredScreenDistance(g.vectorToScreenPoint(k,u,c.absoluteHeightElevationInfo,this.view),g.vectorToScreenPoint(D,u,c.absoluteHeightElevationInfo,this.view))>this.squaredShortLineThreshold}isVertical(D,k){return b.squaredDistance(D,k)<d.defaults.verticalLineThreshold}squaredProximityThreshold(D){return"touch"===D?this._squaredTouchProximityThreshold:this._squaredMouseProximityThreshold}get _squaredMouseProximityThreshold(){return this.options.distance*this.options.distance}get _squaredTouchProximityThreshold(){const {distance:D,
touchSensitivityMultiplier:k}=this.options,u=D*k;return u*u}}a.SnappingAlgorithm=B;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/LineSnappingCandidate":function(){define("exports ../../sketch/constraints ../SnappingDomain ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint".split(" "),function(a,b,c,q,d,f){class g extends d.SnappingCandidate{constructor({lineStart:B,lineEnd:D,targetPoint:k,isDraped:u}){super(k,new b.VerticalPlaneConstraint(B,
D),u,c.SnappingDomain.SELF);this._referenceLineHint=new f.LineSnappingHint(q.LineSegmentHintType.REFERENCE_EXTENSION,B,D,u,this.domain)}get hints(){return[this._referenceLineHint,new f.LineSnappingHint(q.LineSegmentHintType.TARGET,this._lineEndClosestToTarget(),this.targetPoint,this.isDraped,this.domain)]}_lineEndClosestToTarget(){return this.constraint.closestEndTo(this.targetPoint)}}a.LineSnappingCandidate=g;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/ParallelLineSnapper":function(){define("exports ../../../chunks/vec2 ../../../chunks/vec2f64 ../../../support/elevationInfoUtils ../sketch/normalizedPoint ./Settings ./SnappingAlgorithm ./snappingUtils ./candidates/ParallelLineSnappingCandidate ../support/viewUtils ../../support/geometry2dUtils".split(" "),
function(a,b,c,q,d,f,g,B,D,k,u){class h extends g.SnappingAlgorithm{snapNewVertex(l,m){var A=m.editGeometryOperations.data.components[0],p=A.edges.length,C=A.vertices.length;const I=[];if(2>p)return I;const {view:r}=this,v=k.vectorToScreenPoint(l,m.spatialReference,q.absoluteHeightElevationInfo,r);C=d.fromAnyMapPoint(A.vertices[C-1].pos,r,m);const E=d.fromAnyMapPoint(A.vertices[0].pos,r,m);p=A=A.edges[p-1];do{if(this.edgeExceedsShortLineThreshold(p,m)){const H=B.editEdgeToSnappingEdge(p,r,m);this._checkEdgeForParallelLines(H,
C,l,v,m,I);this._checkEdgeForParallelLines(H,E,l,v,m,I)}p=p.leftVertex.leftEdge}while(p&&p!==A);return I}snapExistingVertex(l,m){const A=[],p=m.vertexHandle;var C=p.component;if(3>C.edges.length)return A;const {view:I}=this,r=k.vectorToScreenPoint(l,m.spatialReference,q.absoluteHeightElevationInfo,I),v=p.leftEdge,E=p.rightEdge,H=C.vertices[0],K=d.fromAnyMapPoint(H.pos,I,m),J=C.vertices[C.vertices.length-1],R=d.fromAnyMapPoint(J.pos,I,m);let z=C=C.edges[0];do{if(z!==v&&z!==E&&this.edgeExceedsShortLineThreshold(z,
m)){const T=B.editEdgeToSnappingEdge(z,I,m);v&&this._checkEdgeForParallelLines(T,d.fromAnyMapPoint(v.leftVertex.pos,I,m),l,r,m,A);E&&this._checkEdgeForParallelLines(T,d.fromAnyMapPoint(E.rightVertex.pos,I,m),l,r,m,A);p===H?this._checkEdgeForParallelLines(T,R,l,r,m,A):p===J&&this._checkEdgeForParallelLines(T,K,l,r,m,A)}z=z.rightVertex.rightEdge}while(z&&z!==C);return A}_checkEdgeForParallelLines(l,m,A,p,C,I){const r=l.left,v=l.right;u.projectPointToLine(e,m,r,v);if(!(b.squaredDistance(e,m)<f.defaults.parallelLineThreshold)){u.projectPointToLine(e,
A,r,v,m);var {spatialReference:E,pointer:H}=C;A=d.fromValues(e[0],e[1],A[2]);B.squaredScreenDistance(p,k.vectorToScreenPoint(A,E,q.absoluteHeightElevationInfo,this.view))<this.squaredProximityThreshold(H)&&!(this.isVertical(A,m)||this.isVertical(r,v)||this._parallelToPreviousCandidate(l,I))&&I.push(new D.ParallelLineSnappingCandidate({referenceLine:l,lineStart:m,targetPoint:A,isDraped:"on-the-ground"===C.elevationInfo?.mode}))}}_parallelToPreviousCandidate(l,m){const A=l.left,p=l.right;for(const C of m)if(u.projectPointToLine(e,
p,C.constraint.start,C.constraint.end,A),b.squaredDistance(e,p)<f.defaults.parallelLineThreshold)return C.addReferenceLine(l),!0;return!1}}const e=c.create();a.ParallelLineSnapper=h;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/ParallelLineSnappingCandidate":function(){define("exports ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../sketch/constraints ../../sketch/normalizedPoint ../SnappingDomain ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint ../hints/ParallelSnappingHint".split(" "),
function(a,b,c,q,d,f,g,B,D,k){class u extends B.SnappingCandidate{constructor({referenceLine:h,lineStart:e,targetPoint:l,isDraped:m}){const A=c.clone(e),{left:p,right:C}=h;b.subtract(A,b.add(A,A,C),p);super(l,new q.VerticalPlaneConstraint(e,d.fromVec3(A)),m,f.SnappingDomain.SELF);this._referenceLines=[{edge:h,fadeLeft:!0,fadeRight:!0}]}get hints(){return[new D.LineSnappingHint(g.LineSegmentHintType.TARGET,this.constraint.start,this.targetPoint,this.isDraped,this.domain),new k.ParallelSnappingHint(this.constraint.start,
this.targetPoint,this.isDraped,this.domain),...this._referenceLines.map(h=>new D.LineSnappingHint(g.LineSegmentHintType.REFERENCE,h.edge.left,h.edge.right,this.isDraped,this.domain,h.fadeLeft,h.fadeRight))]}addReferenceLine(h){const e={edge:h,fadeLeft:!0,fadeRight:!0};this._referenceLines.forEach(l=>{b.exactEquals(h.right,l.edge.left)&&(l.fadeLeft=!1,e.fadeRight=!1);b.exactEquals(h.right,l.edge.right)&&(l.fadeRight=!1,e.fadeRight=!1);b.exactEquals(h.left,l.edge.right)&&(l.fadeRight=!1,e.fadeLeft=
!1);b.exactEquals(h.left,l.edge.left)&&(l.fadeLeft=!1,e.fadeLeft=!1)});this._referenceLines.push(e)}}a.ParallelLineSnappingCandidate=u;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/ParallelSnappingHint":function(){define("exports ../../../../core/has ../../../../core/Logger ../../../../chunks/vec3 ../SnappingDomain ./SnappingHint".split(" "),function(a,b,c,q,d,f){class g extends f.SnappingHint{constructor(B,D,k,u=d.SnappingDomain.ALL){super(k,
u);this.lineStart=B;this.lineEnd=D}equals(B){return B instanceof g?q.exactEquals(this.lineStart,B.lineStart)&&q.exactEquals(this.lineEnd,B.lineEnd):!1}}a.ParallelSnappingHint=g;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/RightAngleSnapper":function(){define("exports ../../../chunks/vec2 ../../../chunks/vec2f64 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../support/elevationInfoUtils ../sketch/constraints ../sketch/normalizedPoint ./SnappingAlgorithm ./snappingUtils ./candidates/RightAngleSnappingCandidate ../support/viewUtils".split(" "),
function(a,b,c,q,d,f,g,B,D,k,u,h){class e extends D.SnappingAlgorithm{snapNewVertex(A,p){var C=p.editGeometryOperations.data.components[0],I=C.vertices.length;const r=[];if(2>I)return r;var {view:v}=this;const E=h.vectorToScreenPoint(A,p.spatialReference,f.absoluteHeightElevationInfo,v);var H=C.vertices[I-1];this.edgeExceedsShortLineThreshold(H.leftEdge,p)&&(I=B.fromAnyMapPoint(H.pos,v,p),H=B.fromAnyMapPoint(H.leftEdge.leftVertex.pos,v,p),this._checkForSnappingCandidate(r,H,I,A,E,p));I=C.vertices[0];
this.edgeExceedsShortLineThreshold(I.rightEdge,p)&&(C=B.fromAnyMapPoint(I.pos,v,p),v=B.fromAnyMapPoint(I.rightEdge.rightVertex.pos,v,p),this._checkForSnappingCandidate(r,v,C,A,E,p));return r}snapExistingVertex(A,p){const C=[];var I=p.vertexHandle;if(3>I.component.vertices.length)return C;var {view:r}=this;const v=h.vectorToScreenPoint(A,p.spatialReference,f.absoluteHeightElevationInfo,r);var E=I.leftEdge;I=I.rightEdge;if(E?.leftVertex.leftEdge){var H=E.leftVertex.leftEdge;this.edgeExceedsShortLineThreshold(H,
p)&&(E=B.fromAnyMapPoint(H.rightVertex.pos,r,p),H=B.fromAnyMapPoint(H.leftVertex.pos,r,p),this._checkForSnappingCandidate(C,H,E,A,v,p))}I?.rightVertex.rightEdge&&(E=I.rightVertex.rightEdge,this.edgeExceedsShortLineThreshold(E,p)&&(I=B.fromAnyMapPoint(E.leftVertex.pos,r,p),r=B.fromAnyMapPoint(E.rightVertex.pos,r,p),this._checkForSnappingCandidate(C,r,I,A,v,p)));return C}_checkForSnappingCandidate(A,p,C,I,r,v){const {spatialReference:E,pointer:H}=v;b.subtract(l,C,p);const K=q.set(m,l[1],-l[0],0),J=
b.dot(K,b.subtract(l,I,C))/b.squaredLength(K);I=B.fromVec3(b.scaleAndAdd(d.clone(I),C,K,J));k.squaredScreenDistance(r,h.vectorToScreenPoint(I,E,f.absoluteHeightElevationInfo,this.view))<this.squaredProximityThreshold(H)&&!this.isVertical(I,C)&&!this.isVertical(C,p)&&(r=q.scaleAndAdd(d.create(),C,K,Math.sign(J)),A.push(new u.RightAngleSnappingCandidate({targetPoint:I,constraint:new g.VerticalHalfPlaneConstraint(C,B.fromVec3(r)),previousVertex:p,otherVertex:C,otherVertexType:u.OtherVertexType.CENTER,
isDraped:"on-the-ground"===v.elevationInfo?.mode})))}}const l=c.create(),m=d.create();a.RightAngleSnapper=e;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/RightAngleTriangleSnapper":function(){define("exports ../../../chunks/vec2 ../../../chunks/vec2f64 ../../../chunks/vec3f64 ../../../support/elevationInfoUtils ../sketch/normalizedPoint ./SnappingAlgorithm ./snappingUtils ./candidates/RightAngleTriangleSnappingCandidate ../support/viewUtils ../../support/geometry2dUtils".split(" "),
function(a,b,c,q,d,f,g,B,D,k,u){class h extends g.SnappingAlgorithm{snapNewVertex(l,m){var A=m.editGeometryOperations.data.components[0];const p=[];var C=A.vertices.length;if("polygon"!==m.editGeometryOperations.data.type||2>C)return p;var {view:I}=this;C=A.vertices[C-1];A=f.fromAnyMapPoint(A.vertices[0].pos,I,m);I=f.fromAnyMapPoint(C.pos,I,m);this._processCandidateProposal(A,I,l,m,p);return p}snapExistingVertex(l,m){const A=[];var p=m.vertexHandle,C=p.component;if(2>C.edges.length||"polyline"===
m.editGeometryOperations.data.type&&(0===p.index||p.index===C.vertices.length-1))return A;const {view:I}=this;C=f.fromAnyMapPoint(p.leftEdge.leftVertex.pos,I,m);p=f.fromAnyMapPoint(p.rightEdge.rightVertex.pos,I,m);this._processCandidateProposal(C,p,l,m,A);return A}_processCandidateProposal(l,m,A,p,C){if(this.exceedsShortLineThreshold(l,m,p)){var I=b.lerp(e,l,m,.5),r=.5*b.distance(l,m),v=q.create();u.projectPointToCircle(v,A,I,r);v[2]=A[2];I=f.fromVec3(v);var {spatialReference:E,pointer:H}=p;A=k.vectorToScreenPoint(A,
E,d.absoluteHeightElevationInfo,this.view);B.squaredScreenDistance(A,k.vectorToScreenPoint(I,E,d.absoluteHeightElevationInfo,this.view))<this.squaredProximityThreshold(H)&&!this.isVertical(l,I)&&!this.isVertical(I,m)&&C.push(new D.RightAngleTriangleSnappingCandidate({targetPoint:I,point1:l,point2:m,isDraped:"on-the-ground"===p.elevationInfo?.mode}))}}}const e=c.create();a.RightAngleTriangleSnapper=h;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/RightAngleTriangleSnappingCandidate":function(){define("exports ../../../../chunks/vec2 ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../sketch/constraints ../../sketch/normalizedPoint ../SnappingDomain ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint ../hints/RightAngleSnappingHint".split(" "),
function(a,b,c,q,d,f,g,B,D,k,u){class h extends D.SnappingCandidate{constructor({targetPoint:e,point1:l,point2:m,isDraped:A}){super(e,new d.VerticalCylinderConstraint(f.fromVec3(c.lerp(q.create(),l,m,.5)),.5*b.distance(l,m)),A,g.SnappingDomain.SELF);this._p1=l;this._p2=m}get hints(){return[new k.LineSnappingHint(B.LineSegmentHintType.REFERENCE,this.targetPoint,this._p1,this.isDraped,this.domain),new k.LineSnappingHint(B.LineSegmentHintType.REFERENCE,this.targetPoint,this._p2,this.isDraped,this.domain),
new u.RightAngleSnappingHint(this._p1,this.targetPoint,this._p2,this.isDraped,this.domain)]}}a.RightAngleTriangleSnappingCandidate=h;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingOptions":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Collection ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./FeatureSnappingLayerSource ./Settings".split(" "),
function(a,b,c,q,d,f,g,B,D,k){b=class extends b{constructor(u){super(u);this.enabledToggled=this.enabled=!1;this.featureEnabled=this.selfEnabled=!0;this.featureSources=new c;this.distance=k.defaults.distance;this.touchSensitivityMultiplier=k.defaults.touchSensitivityMultiplier}get effectiveEnabled(){return this.enabledToggled?!this.enabled:this.enabled}get effectiveSelfEnabled(){return this.effectiveEnabled&&this.selfEnabled}get effectiveFeatureEnabled(){return this.effectiveEnabled&&this.featureEnabled}};
a.__decorate([q.property()],b.prototype,"enabled",void 0);a.__decorate([q.property()],b.prototype,"enabledToggled",void 0);a.__decorate([q.property()],b.prototype,"selfEnabled",void 0);a.__decorate([q.property()],b.prototype,"featureEnabled",void 0);a.__decorate([q.property({type:c.ofType(D)})],b.prototype,"featureSources",void 0);a.__decorate([q.property()],b.prototype,"distance",void 0);a.__decorate([q.property()],b.prototype,"touchSensitivityMultiplier",void 0);a.__decorate([q.property({readOnly:!0})],
b.prototype,"effectiveEnabled",null);a.__decorate([q.property({readOnly:!0})],b.prototype,"effectiveSelfEnabled",null);a.__decorate([q.property({readOnly:!0})],b.prototype,"effectiveFeatureEnabled",null);return b=a.__decorate([B.subclass("esri.views.interactive.snapping.SnappingOptions")],b)})},"esri/views/interactive/snapping/FeatureSnappingLayerSource":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,c,q,d,f,g){b=class extends b{constructor(B){super(B);this.layer=null;this.enabled=!0;this.updating=!1;this.availability=1}};a.__decorate([c.property({constructOnly:!0})],b.prototype,"layer",void 0);a.__decorate([c.property()],b.prototype,"enabled",void 0);a.__decorate([c.property()],b.prototype,"updating",void 0);a.__decorate([c.property()],b.prototype,"availability",void 0);return b=a.__decorate([g.subclass("esri.views.interactive.snapping.FeatureSnappingLayerSource")],b)})},"esri/views/interactive/snapping/snappingPointUtils":function(){define(["exports",
"../../../layers/graphics/dehydratedPoint","../../../support/elevationInfoUtils"],function(a,b,c){a.snappingPointToSnappingOutput=function(q,d,{z:f,m:g,spatialReference:B,elevationInfo:D}){if(null==f&&null==g)return q=b.makeDehydratedPoint(q[0],q[1],void 0,B),null!=g&&(q.m=g,q.hasM=!0),q;if(null==d||"2d"===d.type)return q=b.makeDehydratedPoint(q[0],q[1],f,B),null!=g&&(q.m=g,q.hasM=!0),q;d=c.getConvertedElevationFromVector(d,q,B,c.absoluteHeightElevationInfo,D)??0;q=b.makeDehydratedPoint(q[0],q[1],
d,B);null!=g&&(q.m=g,q.hasM=!0);return q};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/IntersectionSnappingCandidate":function(){define(["exports","../../sketch/constraints","../SnappingDomain","./SnappingCandidate","../hints/IntersectionSnappingHint"],function(a,b,c,q,d){class f extends q.SnappingCandidate{constructor(g,B,D,k){super(g,new b.PointConstraint(g),k,c.SnappingDomain.ALL);this.first=B;this.second=D}get hints(){this.first.targetPoint=
this.targetPoint;this.second.targetPoint=this.targetPoint;return[...this.first.hints,...this.second.hints,new d.IntersectionSnappingHint(this.targetPoint,this.isDraped,this.domain)]}}a.IntersectionSnappingCandidate=f;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/IntersectionSnappingHint":function(){define(["exports","../../../../chunks/vec3","../SnappingDomain","./SnappingHint"],function(a,b,c,q){class d extends q.SnappingHint{constructor(f,
g,B=c.SnappingDomain.ALL){super(g,B);this.intersectionPoint=f}equals(f){return f instanceof d?b.exactEquals(this.intersectionPoint,f.intersectionPoint):!1}}a.IntersectionSnappingHint=d;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/hitTestSelectUtils":function(){define(["exports"],function(a){function b(c){return"graphic"===c?.type}a.filterGraphicHits=function(c){return c.filter(b)};a.findFirstGraphicHit=function(c){return c.find(b)??null};a.hitTestSelectSimilarDistance=
async function(c,q){if("2d"===c.type)return c.hitTest(q);c=await c.hitTest(q);if(0===c.results.length)return c;const d=1.05*(c.results[0].distance??0);q=c.results.findIndex(f=>(f.distance??0)>d);-1!==q&&(c.results=c.results.slice(0,q));return c};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Sketch/support/OperationHandle":function(){define("exports ../../../chunks/tslib.es6 ../../../core/compilerUtils ../../../core/Evented ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,c,q,d,f,g,B){a.OperationHandle=class extends q.EventedAccessor{constructor(D){super(D);this.cancelled=!1;this.history={undo:[],redo:[]};this.type=null}get tool(){if(!this.activeComponent)return null;switch(this.activeComponent.type){case "graphic-mover":case "move-3d":return"move";case "box":case "transform-3d":return"transform";case "reshape":case "reshape-3d":return"reshape";case "draw-2d":case "draw-3d":return this.activeComponent.geometryType;default:c.neverReached(this.activeComponent)}return null}addToHistory(D){this.history.redo=
[];this.history.undo.push(D)}resetHistory(){this.history.redo=[];this.history.undo=[]}canUndo(){return 0<this.history.undo.length}canRedo(){return 0<this.history.redo.length}complete(){this._reset();this.onEnd();this.emit("complete")}cancel(){this.cancelled=!0;this.complete()}_reset(){this.activeComponent?.reset()}refreshComponent(){const D=this.activeComponent;D&&("box"!==D.type&&"reshape"!==D.type&&"graphic-mover"!==D.type||D.refresh())}set undo(D){this._set("undo",()=>{this.canUndo()&&D()})}set redo(D){this._set("redo",
()=>{this.canRedo()&&D()})}};b.__decorate([d.property()],a.OperationHandle.prototype,"activeComponent",void 0);b.__decorate([d.property()],a.OperationHandle.prototype,"cancelled",void 0);b.__decorate([d.property()],a.OperationHandle.prototype,"history",void 0);b.__decorate([d.property()],a.OperationHandle.prototype,"tool",null);b.__decorate([d.property()],a.OperationHandle.prototype,"type",void 0);b.__decorate([d.property()],a.OperationHandle.prototype,"canUndo",null);b.__decorate([d.property()],
a.OperationHandle.prototype,"canRedo",null);b.__decorate([d.property()],a.OperationHandle.prototype,"onEnd",void 0);b.__decorate([d.property()],a.OperationHandle.prototype,"undo",null);b.__decorate([d.property()],a.OperationHandle.prototype,"redo",null);b.__decorate([d.property()],a.OperationHandle.prototype,"toggleTool",void 0);b.__decorate([d.property()],a.OperationHandle.prototype,"addToSelection",void 0);b.__decorate([d.property()],a.OperationHandle.prototype,"removeFromSelection",void 0);a.OperationHandle=
b.__decorate([B.subclass("esri.widgets.Sketch.support.OperationHandle")],a.OperationHandle);a.CreateOperationHandle=class extends a.OperationHandle{};b.__decorate([d.property()],a.CreateOperationHandle.prototype,"activeComponent",void 0);a.CreateOperationHandle=b.__decorate([B.subclass("esri.widgets.Sketch.support.CreateOperationHandle")],a.CreateOperationHandle);a.UpdateOperationHandle=class extends a.OperationHandle{};b.__decorate([d.property()],a.UpdateOperationHandle.prototype,"activeComponent",
void 0);a.UpdateOperationHandle=b.__decorate([B.subclass("esri.widgets.Sketch.support.UpdateOperationHandle")],a.UpdateOperationHandle);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Sketch/VisibleElements":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../support/SketchTooltipControls/VisibleElements ../support/SnappingControls/VisibleElements".split(" "),
function(a,b,c,q,d,f,g,B,D){let k=class extends b{constructor(h){super(h);this.mesh=this.multipoint=this.circle=this.rectangle=this.polygon=this.polyline=this.point=!0}};a.__decorate([c.property({type:Boolean,nonNullable:!0})],k.prototype,"point",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],k.prototype,"polyline",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],k.prototype,"polygon",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],k.prototype,"rectangle",
void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],k.prototype,"circle",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],k.prototype,"multipoint",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],k.prototype,"mesh",void 0);k=a.__decorate([g.subclass("esri.widgets.Sketch.VisibleElements.CreateToolVisibilityMap")],k);let u=class extends b{constructor(h){super(h);this["rectangle-selection"]=!0;this["lasso-selection"]=!0;this["custom-selection"]=!0}};a.__decorate([c.property({nonNullable:!0})],
u.prototype,"rectangle-selection",void 0);a.__decorate([c.property({nonNullable:!0})],u.prototype,"lasso-selection",void 0);a.__decorate([c.property({nonNullable:!0})],u.prototype,"custom-selection",void 0);u=a.__decorate([g.subclass("esri.widgets.Sketch.VisibleElements.SelectionToolVisibilityMap")],u);b=class extends b{constructor(h){super(h);this.createTools=new k;this.duplicateButton=!0;this.selectionTools=new u;this.sketchTooltipControls=this.settingsMenu=!0;this.sketchTooltipControlsElements=
new B;this.snappingControls=!0;this.snappingControlsElements=new D;this.undoRedoMenu=!0}};a.__decorate([c.property({type:k,nonNullable:!0})],b.prototype,"createTools",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"duplicateButton",void 0);a.__decorate([c.property({type:u,nonNullable:!0})],b.prototype,"selectionTools",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"settingsMenu",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],
b.prototype,"sketchTooltipControls",void 0);a.__decorate([c.property({type:B,nonNullable:!0})],b.prototype,"sketchTooltipControlsElements",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"snappingControls",void 0);a.__decorate([c.property({type:D,nonNullable:!0})],b.prototype,"snappingControlsElements",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"undoRedoMenu",void 0);return b=a.__decorate([g.subclass("esri.widgets.Sketch.VisibleElements")],
b)})},"esri/widgets/support/SketchTooltipControls/VisibleElements":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass".split(" "),function(a,b,c,q,d,f,g){b=class extends b{constructor(B){super(B);this.header=!1;this.tooltipsToggle=this.labelsToggle=!0}};a.__decorate([c.property({type:Boolean,nonNullable:!0})],
b.prototype,"header",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"labelsToggle",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"tooltipsToggle",void 0);return b=a.__decorate([g.subclass("esri.widgets.support.SketchTooltipControls.VisibleElements")],b)})},"esri/widgets/support/SnappingControls/VisibleElements":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,c,q,d,f,g){b=class extends b{constructor(B){super(B);this.featureEnabledToggle=this.enabledToggle=!0;this.header=!1;this.selfEnabledToggle=this.layerListToggleLayersButton=this.layerList=!0}};a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"enabledToggle",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"featureEnabledToggle",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"header",void 0);a.__decorate([c.property({type:Boolean,
nonNullable:!0})],b.prototype,"layerList",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"layerListToggleLayersButton",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"selfEnabledToggle",void 0);return b=a.__decorate([g.subclass("esri.widgets.support.SnappingControls.VisibleElements")],b)})},"esri/widgets/support/globalCss":function(){define(["exports"],function(a){a.globalCss={anchor:"esri-widget__anchor",anchorDisabled:"esri-widget__anchor--disabled",
button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",disabled:"esri-disabled",disabledElement:"esri-disabled-element",empty:"esri-widget__content--empty",emptyIllustration:"esri-widget__content-illustration--empty",heading:"esri-widget__heading",hidden:"esri-hidden",input:"esri-input",interactive:"esri-interactive",
loader:"esri-widget__loader",loaderAnimation:"esri-widget__loader-animation",loaderText:"esri-widget__loader-text",menu:"esri-menu",menuHeader:"esri-menu__header",menuItem:"esri-menu__list-item",menuItemActive:"esri-menu__list-item--active",menuItemFocus:"esri-menu__list-item--focus",menuList:"esri-menu__list",noBookmarksIcon:"esri-widget__no-bookmark-icon",panel:"esri-widget--panel",panelHeightOnly:"esri-widget--panel-height-only",primaryTick:"primary-tick",primaryTickAmPm:"primary-tick__ampm",primaryTickLabel:"primary-tick__label",
rotating:"esri-rotating",secondaryTick:"secondary-tick",select:"esri-select",table:"esri-widget__table",widget:"esri-widget",widgetButton:"esri-widget--button",widgetButtonActive:"esri-widget--button-active",widgetDisabled:"esri-widget--disabled"};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/SelectionToolbar":function(){define("require ../../chunks/tslib.es6 ../../core/deprecate ../../core/handleUtils ../../core/Logger ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../Widget ./componentsUtils ./globalCss ./legacyIcon ./widgetUtils ./decorators/messageBundle ./jsxFactory ./SelectionToolbar/SelectionToolbarViewModel".split(" "),
function(a,b,c,q,d,f,g,B,D,k,u,h,e,l,m,A,p,C,I){const r={lassoTool:!0,rectangleTool:!0},v={createTool:"polygon",createOptions:{mode:"freehand"}},E={createTool:"rectangle"};D=class extends h{constructor(H,K){super(H,K);this.messages=this.activeToolInfo=this._viewModelHandlesGroup=null;this.toolConfigs=[];this.viewModel=new I;this.visibleElements={...r};this._viewModelHandlesGroup=q.handlesGroup([this.viewModel.on("selection-change",J=>this.emit("selection-change",J)),this.viewModel.on("complete",J=>
{this._set("activeToolInfo",null);this.emit("complete",J)})])}destroy(){this._viewModelHandlesGroup=f.removeMaybe(this._viewModelHandlesGroup)}loadDependencies(){return e.loadCalciteComponents({action:()=>new Promise((H,K)=>a(["../../chunks/calcite-action"],H,K)),icon:()=>new Promise((H,K)=>a(["../../chunks/calcite-icon"],H,K))})}get label(){return this.messages?.widgetLabel??""}set label(H){this._overrideIfSome("label",H)}get layers(){c.deprecatedProperty(d.getLogger(this),"layers",{replacement:"Use SelectionToolbar.sources instead."});
return this.viewModel.sources}set layers(H){c.deprecatedProperty(d.getLogger(this),"layers",{replacement:"Use SelectionToolbar.sources instead."});this.viewModel.sources=H}get sources(){return this.viewModel.sources}set sources(H){this.viewModel.sources=H}get view(){return this.viewModel.view}set view(H){this.viewModel.view=H}castVisibleElements(H){return{...r,...H}}get visibleToolCount(){const {view:H,toolConfigs:K,visibleElements:J}=this;return(K?.length??0)+("2d"===H?.type?(J.lassoTool?1:0)+(J.rectangleTool?
1:0):0)}activate(H){this.cancel();switch(H){case "lasso":this._activateTool("lasso");break;case "rectangle":this._activateTool("rectangle");break;default:this._activateTool(H)}}cancel(){this.viewModel.cancel();this._set("activeToolInfo",null)}render(){return C.tsx("div",{"aria-label":this.label,class:this.classes("esri-selection-toolbar",l.globalCss.widget)},C.tsx("div",{class:"esri-selection-toolbar__container"},this._renderDefaultTools(),this._renderCustomTools()))}_renderDefaultTools(){if("2d"===
this.view?.type)return[this._renderRectangleTool(),this._renderLassoTool()]}_renderCustomTools(){if(this.toolConfigs?.length)return this.toolConfigs.map(H=>C.tsx("calcite-action",{active:this.activeToolInfo?.toolName===H.toolName,bind:this,class:"esri-selection-toolbar__tool-button",label:H.toolName,onclick:()=>this._onCustomToolClick(H.toolName),scale:"s",text:H.toolName,title:H.toolName},C.tsx("calcite-icon",{icon:H.icon||"selection",scale:"s"})))}_renderLassoTool(){const {activeToolInfo:H,messages:K,
visibleElements:J}=this;if(J.lassoTool)return C.tsx("calcite-action",{active:"lasso"===H?.toolName,bind:this,label:K.selectByLasso,onclick:this._onLassoToolClick,scale:"s",text:K.selectByLasso,title:K.selectByLasso},C.tsx("calcite-icon",{icon:"lasso-select",scale:"s"}))}_renderRectangleTool(){const {activeToolInfo:H,messages:K,visibleElements:J}=this;if(J.rectangleTool)return C.tsx("calcite-action",{active:"rectangle"===H?.toolName,bind:this,label:K.selectByRectangle,onclick:this._onRectangleToolClick,
scale:"s",text:K.selectByRectangle,title:K.selectByRectangle},C.tsx("calcite-icon",{icon:"cursor-marquee",scale:"s"}))}_onCustomToolClick(H){this._toggleTool(H)}_onLassoToolClick(){this._toggleTool("lasso")}_onRectangleToolClick(){this._toggleTool("rectangle")}_activateTool(H){var K=this._getToolOptions(H);K&&(K=this.viewModel.activate(K))&&this._set("activeToolInfo",{toolName:H,operation:K})}_toggleTool(H){if(this.activeToolInfo){const K=this.activeToolInfo.toolName;this.cancel();if(K===H)return}this._activateTool(H)}_getToolOptions(H){if("lasso"===
H)return v;if("rectangle"===H)return E;const K=this.toolConfigs.find(T=>T.toolName===H);if(K){var {createTool:J,createOptions:R,selectionOptions:z}=K;return{createTool:J,createOptions:R,selectionOptions:z}}}};b.__decorate([g.property({readOnly:!0})],D.prototype,"activeToolInfo",void 0);b.__decorate([g.property()],D.prototype,"label",null);b.__decorate([g.property()],D.prototype,"layers",null);b.__decorate([g.property(),p.messageBundle("esri/widgets/support/SelectionToolbar/t9n/SelectionToolbar")],
D.prototype,"messages",void 0);b.__decorate([g.property()],D.prototype,"sources",null);b.__decorate([g.property()],D.prototype,"toolConfigs",void 0);b.__decorate([g.property()],D.prototype,"view",null);b.__decorate([g.property()],D.prototype,"viewModel",void 0);b.__decorate([g.property()],D.prototype,"visibleElements",void 0);b.__decorate([B.cast("visibleElements")],D.prototype,"castVisibleElements",null);b.__decorate([g.property()],D.prototype,"visibleToolCount",null);return D=b.__decorate([u.subclass("esri.widgets.support.SelectionToolbar")],
D)})},"esri/widgets/support/SelectionToolbar/SelectionToolbarViewModel":function(){define("../../../chunks/tslib.es6 ../../../core/deprecate ../../../core/Evented ../../../core/handleUtils ../../../core/Logger ../../../core/maybe ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../layers/support/layerUtils ../../../views/draw/support/layerUtils ../../../views/support/layerViewUtils ../Selector2D".split(" "),
function(a,b,c,q,d,f,g,B,D,k,u,h,e,l,m,A){c=class extends c.EventedAccessor{constructor(p){super(p);this.activeOperation=this._operationHandlesGroup=null;this.selector=new A;this.sources=null}initialize(){this.addHandles([g.watch(()=>this._sources,p=>{this.selector.sources=p;this.activeOperation&&(this.activeOperation.sources=p)})])}destroy(){this._operationHandlesGroup=f.removeMaybe(this._operationHandlesGroup);this.selector.destroy()}get _sources(){const {sources:p,view:C}=this;return C&&p?.length?
p.flatMap(I=>{if(m.isSelectableLayerView2D(I))return I;if(e.isKnowledgeGraphLayer(I)){var r=I.layers||[];const v=r.map(E=>{const H=l.findLayerView(C,E)||void 0;return m.isSelectableLayerView2D(H)?H:E});return v.length?v.toArray():r.length?r.toArray():I}r=l.findLayerView(C,I)||void 0;return m.isSelectableLayerView2D(r)?r:I}):[]}set cursor(p){this.activeOperation&&(this.activeOperation.cursor=p);this.selector.cursor=p;this._set("cursor",p)}get layers(){b.deprecatedProperty(d.getLogger(this),"layers",
{replacement:"Use SelectionToolbar.sources instead."});return this.sources}set layers(p){b.deprecatedProperty(d.getLogger(this),"layers",{replacement:"Use SelectionToolbar.sources instead."});this.sources=p}get state(){return this.activeOperation?"active":this.view?.ready&&this._sources.length?"ready":"disabled"}set view(p){this.selector.view=p;this._set("view",p)}async selectionFrom(p,C){const {_sources:I}=this;return this.view&&I.length?this.selector.selectionFrom({geometry:p,selectionOptions:C,
sources:I}):[]}cancel(){"active"===this.state&&(this.activeOperation?.cancel(),this._set("activeOperation",null))}activate(p){const {_sources:C,state:I}=this;if("disabled"!==I&&C?.length)return"active"===I&&this.cancel(),p=this.selector.draw({sources:C,operationOptions:p}),this._operationHandlesGroup=q.handlesGroup([p.once("complete",r=>this._onOperationComplete(r)),p.on("selection-change",r=>this._onOperationSelectionChange(r))]),this._set("activeOperation",p),p}_onOperationSelectionChange(p){this.emit("selection-change",
p)}_onOperationComplete(p){this._operationHandlesGroup=f.removeMaybe(this._operationHandlesGroup);this._set("activeOperation",null);this.emit("complete",p)}};a.__decorate([B.property()],c.prototype,"_sources",null);a.__decorate([B.property({readOnly:!0})],c.prototype,"activeOperation",void 0);a.__decorate([B.property()],c.prototype,"cursor",null);a.__decorate([B.property()],c.prototype,"layers",null);a.__decorate([B.property({readOnly:!0})],c.prototype,"selector",void 0);a.__decorate([B.property()],
c.prototype,"sources",void 0);a.__decorate([B.property({readOnly:!0})],c.prototype,"state",null);a.__decorate([B.property()],c.prototype,"view",null);return c=a.__decorate([h.subclass("esri.widgets.support.SelectionToolbar.SelectionToolbarViewModel")],c)})},"esri/views/support/layerViewUtils":function(){define(["exports"],function(a){a.extractSafeScaleBounds=function(b){b=b.effectiveScaleRange;return{minScale:b?.minScale??0,maxScale:b?.maxScale??0}};a.highlightsSupported=function(b){return b&&"function"===
typeof b.highlight};a.isScaleRangeActive=function(b,c){return null!=b&&0<b||null!=c&&0<c};a.isSelectableLayerView2D=function(b){return null!=b&&"object"===typeof b&&"createQuery"in b&&"queryFeatures"in b&&"layer"in b&&"view"in b};a.occludeesSupported=function(b){return b&&"function"===typeof b.maskOccludee};a.scaleBoundsPredicate=function(b,c,q){return null==b||b>q&&(0===c||b<c)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/Selector2D":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/Collection ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ./Selector2D/SelectionOperation2D ./Selector2D/selectorUtils".split(" "),
function(a,b,c,q,d,f,g,B,D,k){b=class extends b{constructor(u){super(u);this._defaultSelectionOptions={intersects:!0,overlaps:!0,contains:!0};this.view=this.sources=this.options=this.cursor=null}draw(u){const {operationOptions:h}=u,{view:e}=this;return new D({cursor:this.cursor,sources:u.sources??this.sources??[],options:{...h,selectionOptions:{...this._defaultSelectionOptions,...this.options,...h?.selectionOptions}},view:e})}async selectionFrom(u){const {view:h}=this,e=u.sources??this.sources??[];
if(!e.length||!h)return[];const l=new c;await k.getSelectionFromGeometry({selector:u.geometry,currentSelection:l,sources:e,options:{...this._defaultSelectionOptions,...this.options,...u.selectionOptions},view:h});return l.toArray()}};a.__decorate([q.property()],b.prototype,"cursor",void 0);a.__decorate([q.property()],b.prototype,"options",void 0);a.__decorate([q.property()],b.prototype,"sources",void 0);a.__decorate([q.property()],b.prototype,"view",void 0);return b=a.__decorate([B.subclass("esri.widgets.support.Selector2D")],
b)})},"esri/widgets/support/Selector2D/SelectionOperation2D":function(){define("../../../chunks/tslib.es6 ../../../symbols ../../../core/Collection ../../../core/Evented ../../../core/promiseUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../layers/GraphicsLayer ../../Sketch/SketchViewModel ./selectorUtils ../../../symbols/SimpleFillSymbol ../../../symbols/SimpleLineSymbol ../../../symbols/SimpleMarkerSymbol".split(" "),
function(a,b,c,q,d,f,g,B,D,k,u,h,e,l,m,A){b=class extends q.EventedAccessor{constructor({options:p,view:C}){super();this._activeOptions=this._abortController=null;this._completed=!1;this._dashedFillSymbol=new l({color:[0,0,0,0],outline:{style:"dash",color:[12,207,255],width:2}});this._dashedLineSymbol=new m({style:"dash",color:[12,207,255],width:2});this._defaultOptions={createTool:"rectangle",selectionOptions:{overlaps:!0,intersects:!0,contains:!1}};this._processSelectionGeometry=async({canceled:K,
completed:J,selector:R})=>{const {_activeOptions:z,sources:T,selection:X,view:aa}=this;this._abortController&&this._abortController.abort();if(J||K)this._completed=!0;if(K)this._onComplete([],!0);else if(R&&T?.length&&aa){this._abortController=K=new AbortController;var {added:w,removed:y}=await e.getSelectionFromGeometry({currentSelection:X,sources:T,options:z.selectionOptions,selector:R,signal:K.signal,view:aa});this._abortController===K&&(this._abortController=null);K.signal.aborted||(J?this._onComplete(this.selection.toArray(),
!1):(w.length||y.length)&&this.emit("selection-change",{added:w,removed:y,type:"selection-change"}))}else X.removeAll()};this._processDebounced=d.debounce(this._processSelectionGeometry,100);this._sketchViewModel=new h;this._sketchGraphicsLayer=new u({listMode:"hide",internal:!0});this._transparentPointSymbol=new A({color:[0,0,0,0],outline:{style:"none",width:0}});this.options=null;this.selection=new c;this.sources=null;this.options=p;this.view=C;const {_dashedFillSymbol:I,_dashedLineSymbol:r,_sketchViewModel:v,
_sketchGraphicsLayer:E,_transparentPointSymbol:H}=this;v.set({layer:E,activePointSymbol:H,activeLineSymbol:r,activeVertexSymbol:H,activeFillSymbol:I,pointSymbol:H,polygonSymbol:I,polylineSymbol:r,vertexSymbol:H,view:C});this.addHandles([v.on("create",K=>this._onSketchEvent(K)),v.on(["undo","redo"],K=>this._onSketchEvent(K)),v.watch("activeComponent.forceUniformSize",()=>this._onSketchGeometryChange())])}initialize(){this._load()}set cursor(p){const C=this._sketchViewModel?.activeComponent;if("draw-2d"===
C?.type||"draw-3d"===C?.type)C.cursor=p;this._set("cursor",p)}get state(){const {_completed:p,_sketchViewModel:{state:C}}=this;return p?"complete":"active"===C?"active":"disabled"}set view(p){this._sketchViewModel.view=p;this._set("view",p)}cancel(){return this._sketchViewModel.cancel()}async _load(){await this.view?.whenReady();const {_defaultOptions:p,options:C}=this,{createTool:I,createOptions:r}=this._activeOptions={...p,...C,createOptions:{...p.createOptions,cursor:C?.createOptions?.cursor||
this.cursor||p.createOptions?.cursor,...C?.createOptions},selectionOptions:{...p.selectionOptions,...C?.selectionOptions}};this._sketchViewModel.create(I,r)}_onSketchEvent(p){d.ignoreAbortErrors(this._processDebounced({canceled:"create"===p.type&&"cancel"===p.state,completed:"create"===p.type&&"complete"===p.state,selector:("create"===p.type?p.graphic:p.graphics[0])?.geometry}))}_onSketchGeometryChange(){const p=this._sketchViewModel.createGraphic?.geometry;p&&d.ignoreAbortErrors(this._processDebounced({canceled:!1,
completed:!1,selector:p}))}_onComplete(p,C){this.removeAllHandles();this.notifyChange("state");this.emit("complete",{aborted:C,selection:p,type:"complete"})}};a.__decorate([f.property()],b.prototype,"_abortController",void 0);a.__decorate([f.property()],b.prototype,"_completed",void 0);a.__decorate([f.property()],b.prototype,"cursor",null);a.__decorate([f.property()],b.prototype,"options",void 0);a.__decorate([f.property({readOnly:!0})],b.prototype,"selection",void 0);a.__decorate([f.property()],
b.prototype,"sources",void 0);a.__decorate([f.property({readOnly:!0})],b.prototype,"state",null);a.__decorate([f.property()],b.prototype,"view",null);return b=a.__decorate([k.subclass("esri.widgets.support.Selector2D.SelectionOperation2D")],b)})},"esri/widgets/support/Selector2D/selectorUtils":function(){define("require exports ../../../core/promiseUtils ../../../layers/support/fieldUtils ../../../layers/support/layerUtils ../../../renderers/support/clickToleranceUtils ../../../views/support/drapedUtils ../../../views/support/layerViewUtils".split(" "),
function(a,b,c,q,d,f,g,B){async function D(){return new Promise((v,E)=>a(["../../../geometry/geometryEngineJSON"],v,E))}async function k(){return D().then(({contains:v,intersects:E,overlaps:H,simplify:K})=>({contains:v,intersects:E,overlaps:H,simplify:K}))}function u(v){const E=[],H=[],K=[];v.forEach(J=>{d.isFeatureLayer(J)?E.push(J):d.isKnowledgeGraphLayer(J)&&J.layers?.length?E.push(...J.layers.toArray()):d.isMapNotesLayer(J)&&J.sublayers?.length?K.push(...J.sublayers.toArray()):d.isGraphicsLayer(J)?
K.push(J):B.isSelectableLayerView2D(J)&&H.push(J)});return{layers:E,layerViews:H,graphicsLayers:K}}function h(v,E){const H=v.includes(E),K=E.getObjectId(),J=null!=K;v=v.some(R=>{const z=E.layer===R.layer,T=J&&R.getObjectId()===K;R=E.uid===R.uid;return z&&(T||R)});return!H&&!v}async function e(v){const {layerViews:E,selector:H,signal:K,view:J}=v;return c.whenOrAbort(Promise.allSettled(E.map(async R=>{const z=R.createQuery(),{outFields:T,geometry:X}=m(H,R.layer,J);z.outFields=T;z.geometry=X;z.returnGeometry=
!0;z.outSpatialReference=J.spatialReference;return R.queryFeatures(z,{signal:K}).then(({features:aa})=>aa)})),K)}async function l(v){const {layers:E,selector:H,signal:K,view:J}=v;return c.whenOrAbort(Promise.allSettled(E.map(async R=>R.queryFeatures(A(R.createQuery(),H,R,J),{signal:K}).then(({features:z})=>z))),K)}function m(v,E,H){const K=q.getDisplayFieldName({displayField:"displayField"in E?E.displayField:null,fields:E.fields}),J=[E.objectIdField];null!=K&&E.fieldsIndex.has(K)&&J.push(K);E="renderer"in
E?f.calculateTolerance({renderer:E.renderer}):0;return{geometry:"point"===v.type?g.createQueryGeometry(v,E,H):v,outFields:J}}function A(v,E,H,K){const {outFields:J,geometry:R}=m(E,H,K);v.outFields=J;v.geometry=R;v.returnGeometry=!0;v.outSpatialReference=K.spatialReference;return v}async function p(v){const {selector:E,candidates:H,options:K,view:J}=v;if(!H?.length||!E||!K)return[];const {overlaps:R,intersects:z,contains:T}=K,{spatialReference:X}=J,aa=await k();return H.filter(w=>{var y=w.geometry;
w=R&&aa.overlaps(X,E,y);const P=z&&aa.intersects(X,E,y);y=T&&aa.contains(X,E,y);return w||P||y})}const C=async(v,E,H,K)=>{E=E.flatMap(J=>J.graphics.toArray())??[];return p({candidates:E,selector:v,options:H,view:K})},I=async(v,E,H,K)=>(v=await c.ignoreAbortErrors(l({selector:v,signal:K,layers:E,view:H})))?v.filter(J=>"fulfilled"===J.status).flatMap(J=>J.value):[],r=async(v,E,H,K)=>(v=await c.ignoreAbortErrors(e({selector:v,signal:K,layerViews:E,view:H})))?v.filter(J=>"fulfilled"===J.status).flatMap(J=>
J.value):[];b.getGeometryEngineOperations=k;b.getQueryOptionsFromLayer=m;b.getSelectionFromFeatureLayerViews=e;b.getSelectionFromFeatureLayers=l;b.getSelectionFromGeometry=async function(v){const {currentSelection:E,options:H,selector:K,signal:J,sources:R,view:z}=v;if(!R?.length)return{added:[],removed:[]};const {layers:T,layerViews:X,graphicsLayers:aa}=u(R),w=(await c.whenOrAbort(Promise.all([I(K,T,z,J),r(K,X,z,J),C(K,aa,H,z)]),J)).flat();if(!E)return{added:w,removed:[]};v=w.filter(P=>h(E.toArray(),
P));const y=E.filter(P=>h(w,P)).toArray();E.removeMany(y);E.addMany(v);return{added:v,removed:y}};b.getSelectionFromGeometryEngine=p;b.importGeometryEngine=D;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/clickToleranceUtils":function(){define(["exports"],function(a){function b(d,f){return f?"xoffset"in f&&f.xoffset?Math.max(d,Math.abs(f.xoffset)):"yoffset"in f&&f.yoffset?Math.max(d,Math.abs(f.yoffset||0)):d:d}function c(d,f){if("number"===typeof d)return d;
if(d?.stops?.length){d=d.stops;let g=f=0;for(let B=0;B<d.length;B++){const D=d[B].size;"number"===typeof D&&(f+=D,g++)}return f/g}return f}function q(d,f){if(!f)return d;f=f.filter(D=>"size"===D.type).map(D=>{const {maxSize:k,minSize:u}=D;return(c(k,d)+c(u,d))/2});let g=0;const B=f.length;if(0===B)return d;for(let D=0;D<B;D++)g+=f[D];return Math.max(Math.floor(g/B),d)}a.calculateTolerance=function(d){const f=d?.renderer;d="touch"===d?.event?.pointerType?9:6;if(!f)return d;d="visualVariables"in f?
q(d,f.visualVariables):d;if("simple"===f.type)return b(d,f.symbol);if("unique-value"===f.type){let g=d;f.uniqueValueInfos?.forEach(B=>{g=b(g,B.symbol)});return g}if("class-breaks"===f.type){let g=d;f.classBreakInfos.forEach(B=>{g=b(g,B.symbol)});return g}return d};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/drapedUtils":function(){define(["exports","../../geometry","../../core/unitUtils","../../renderers/support/clickToleranceUtils","../../geometry/Extent"],
function(a,b,c,q,d){function f(B,D,k,u=new d){let h=0;if("2d"===k.type)h=D*(k.resolution??0);else if("3d"===k.type){var e=k.overlayPixelSizeInMapUnits(B),l=k.basemapSpatialReference;h=null==l||l.equals(k.spatialReference)?D*e:c.getMetersPerUnitForSR(l)/c.getMetersPerUnitForSR(k.spatialReference)}D=B.x-h;e=B.y-h;l=B.x+h;B=B.y+h;({spatialReference:k}=k);u.xmin=Math.min(D,l);u.ymin=Math.min(e,B);u.xmax=Math.max(D,l);u.ymax=Math.max(e,B);u.spatialReference=k;return u}const g=new d;a.createQueryGeometry=
f;a.intersectsDrapedGeometry=function(B,D,k){B=k.toMap(B);if(null==B)return!1;const u=q.calculateTolerance();return f(B,u,k,g).intersects(D)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/SketchTooltipControls":function(){define("require ../../chunks/tslib.es6 ../../core/arrayUtils ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/has ../../core/accessorSupport/decorators/subclass ../Widget ./componentsUtils ./globalCss ./LabeledSwitch ./legacyIcon ./widgetUtils ./decorators/messageBundle ./jsxFactory ./SketchTooltipControls/SketchTooltipControlsViewModel ./SketchTooltipControls/VisibleElements".split(" "),
function(a,b,c,q,d,f,g,B,D,k,u,h,e,l,m,A,p,C){var I=e.legacyIcon.gear;f=class extends D{constructor(r,v){super(r,v);this.icon=this._defaultViewModel=null;this.iconClass=I;this.visibleElements=new C;this.viewType=void 0;this._onTooltipsEnabledChange=J=>{this.tooltipOptions.enabled=J};this._onLabelsEnabledChange=J=>{this.labelOptions.enabled=J};const {tooltipOptions:E,labelOptions:H,viewModel:K}=r;this.viewModel=K??(this._defaultViewModel=new p({tooltipOptions:E,labelOptions:H}))}loadDependencies(){return Promise.all([k.loadCalciteComponents({block:()=>
new Promise((r,v)=>a(["../../chunks/calcite-block"],r,v))}),h.loadLabeledSwitchComponents()])}render(){const {label:r,visibleElements:v}=this,E=this._renderContent();return A.tsx("div",{"aria-label":r,class:this.classes("esri-sketch-tooltip-controls",u.globalCss.widget)},E?A.tsx("calcite-block",{class:"esri-sketch-tooltip-controls__block",heading:v.header?this.label:"",key:"content-block",open:!0},A.tsx("div",{class:"esri-sketch-tooltip-controls__block-content",key:"content"},E)):void 0)}get label(){return this.messages?.widgetLabel??
""}set label(r){this._overrideIfSome("label",r)}get labelOptions(){return this.viewModel.labelOptions}set labelOptions(r){this.viewModel.labelOptions=r}get tooltipOptions(){return this.viewModel.tooltipOptions}set tooltipOptions(r){this.viewModel.tooltipOptions=r}set viewModel(r){if(r!==this._get("viewModel")){if(null==this._defaultViewModel||this._defaultViewModel!==r)this._defaultViewModel=q.destroyMaybe(this._defaultViewModel);this._set("viewModel",r)}}_renderContent(){const {visibleElements:r,
viewType:v}=this,E=[r.tooltipsToggle?this._renderTooltipsToggle():null,r.labelsToggle&&"2d"!==v?this._renderLabelsToggle():null].filter(c.isSome);return 0===E.length?null:E}_renderTooltipsToggle(){const {messages:r,tooltipOptions:v}=this;return A.tsx(h.LabeledSwitch,{checked:v.enabled,hint:r.tooltipsToggleHint,key:`${this.id}__tooltips`,label:r.tooltipsToggle,onChange:this._onTooltipsEnabledChange})}_renderLabelsToggle(){const {messages:r,labelOptions:v}=this;return A.tsx(h.LabeledSwitch,{checked:v.enabled,
hint:r.labelsToggleHint,key:`${this.id}__labels`,label:r.labelsToggle,onChange:this._onLabelsEnabledChange})}};b.__decorate([d.property()],f.prototype,"icon",void 0);b.__decorate([d.property()],f.prototype,"iconClass",void 0);b.__decorate([d.property()],f.prototype,"label",null);b.__decorate([d.property()],f.prototype,"labelOptions",null);b.__decorate([d.property()],f.prototype,"tooltipOptions",null);b.__decorate([d.property()],f.prototype,"viewModel",null);b.__decorate([d.property({type:C,nonNullable:!0})],
f.prototype,"visibleElements",void 0);b.__decorate([d.property(),m.messageBundle("esri/widgets/support/SketchTooltipControls/t9n/SketchTooltipControls")],f.prototype,"messages",void 0);b.__decorate([d.property({type:String})],f.prototype,"viewType",void 0);return f=b.__decorate([B.subclass("esri.widgets.support.SketchTooltipControls")],f)})},"esri/widgets/support/LabeledSwitch":function(){define(["require","exports","./componentsUtils","./widgetUtils","./jsxFactory"],function(a,b,c,q,d){b.LabeledSwitch=
function({checked:f,disabled:g,hint:B,key:D,label:k,onChange:u}){return d.tsx("calcite-label",{class:"esri-labeled-switch__label",disabled:g,key:D,layout:"inline-space-between",scale:"s"},d.tsx("div",{class:"esri-labeled-switch__label-content",key:"label-content"},B?d.tsx(d.tsxFragment,null,d.tsx("div",null,k),d.tsx("calcite-icon",{class:"esri-labeled-switch__icon",icon:"information",id:D,scale:"s"}),d.tsx("calcite-tooltip",{referenceElement:D},B)):k),d.tsx("calcite-switch",{checked:f,disabled:g,
scale:"s",onCalciteSwitchChange:h=>u(h.target.checked)}))};b.loadLabeledSwitchComponents=()=>Promise.all([c.loadCalciteComponents({icon:()=>new Promise((f,g)=>a(["../../chunks/calcite-icon"],f,g)),label:()=>new Promise((f,g)=>a(["../../chunks/calcite-label"],f,g)),switch:()=>new Promise((f,g)=>a(["../../chunks/calcite-switch"],f,g)),tooltip:()=>new Promise((f,g)=>a(["../../chunks/calcite-tooltip"],f,g))})]);Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/SketchTooltipControls/SketchTooltipControlsViewModel":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../views/interactive/sketch/SketchLabelOptions ../../../views/interactive/sketch/SketchTooltipOptions".split(" "),
function(a,b,c,q,d,f,g,B,D){b=class extends b{constructor(k){super(k);this.labelOptions=new B;this.tooltipOptions=new D}};a.__decorate([c.property({type:B,nonNullable:!0})],b.prototype,"labelOptions",void 0);a.__decorate([c.property({type:D,nonNullable:!0})],b.prototype,"tooltipOptions",void 0);return b=a.__decorate([g.subclass("esri.widgets.support.SketchTooltipControls.SketchTooltipControlsViewModel")],b)})},"esri/widgets/support/SnappingControls":function(){define("require ../../chunks/tslib.es6 ../../core/arrayUtils ../../core/maybe ../../core/uid ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/has ../../core/accessorSupport/decorators/subclass ../Widget ./componentsUtils ./globalCss ./LabeledSwitch ./legacyIcon ./widgetUtils ./decorators/messageBundle ./jsxFactory ./SnappingControls/SnappingControlsViewModel ./SnappingControls/VisibleElements".split(" "),
function(a,b,c,q,d,f,g,B,D,k,u,h,e,l,m,A,p,C,I){var r=l.legacyIcon.vertexGps;g=class extends k{constructor(v,E){super(v,E);this._layerListFilter=this._defaultViewModel=null;this.iconClass=r;this.icon=null;this.layerListOpen=!0;this.messages=null;this.visibleElements=new I;this._enableSnappingSwitchChange=R=>{this.snappingOptions.enabled=R};this._featureEnabledSwitchChange=R=>{this.snappingOptions.featureEnabled=R};this._selfEnabledSwitchChange=R=>{this.snappingOptions.selfEnabled=R};this._onToggleLayersButtonClick=
R=>{this.viewModel.toggleSnappingForAllLayers(!this.viewModel.allLayersEnabled);requestAnimationFrame(()=>R.target.setFocus())};const {snappingOptions:H,view:K,viewModel:J}=v;this.viewModel=J??(this._defaultViewModel=new C({snappingOptions:H,view:K}))}normalizeCtorArgs(v){const {snappingOptions:E,view:H,viewModel:K,...J}=v;return J}destroy(){this.viewModel!==this._defaultViewModel&&(this._defaultViewModel=q.destroyMaybe(this._defaultViewModel))}loadDependencies(){return Promise.all([u.loadCalciteComponents({accordion:()=>
new Promise((v,E)=>a(["../../chunks/calcite-accordion"],v,E)),"accordion-item":()=>new Promise((v,E)=>a(["../../chunks/calcite-accordion-item"],v,E)),action:()=>new Promise((v,E)=>a(["../../chunks/calcite-action"],v,E)),block:()=>new Promise((v,E)=>a(["../../chunks/calcite-block"],v,E)),button:()=>new Promise((v,E)=>a(["../../chunks/calcite-button"],v,E)),icon:()=>new Promise((v,E)=>a(["../../chunks/calcite-icon"],v,E)),input:()=>new Promise((v,E)=>a(["../../chunks/calcite-input"],v,E)),list:()=>
new Promise((v,E)=>a(["../../chunks/calcite-list"],v,E)),"list-item":()=>new Promise((v,E)=>a(["../../chunks/calcite-list-item"],v,E))}),e.loadLabeledSwitchComponents()])}get label(){return this.messages?.widgetLabel??""}set label(v){this._overrideIfSome("label",v)}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(v){this.viewModel.snappingOptions=v}get view(){return this.viewModel.view}set view(v){this.viewModel.view=v}set viewModel(v){if(v!==this._get("viewModel")){if(null==
this._defaultViewModel||this._defaultViewModel!==v)this._defaultViewModel=q.destroyMaybe(this._defaultViewModel);this._set("viewModel",v)}}render(){const {label:v}=this;return p.tsx("div",{"aria-label":v,class:this.classes("esri-snapping-controls",h.globalCss.widget)},p.tsx("div",{class:"esri-snapping-controls__container"},this._renderContent()))}_renderContent(){return[this._renderToggles(),this._renderLayerList()]}_renderToggles(){const {visibleElements:v}=this;var E=[v.selfEnabledToggle?this._renderSelfEnabledToggle():
null,v.featureEnabledToggle?this._renderFeatureEnabledToggle():null].filter(c.isSome);E=[v.enabledToggle?this._renderEnabledToggle():null,0<E.length?p.tsx("div",{class:"esri-snapping-controls__nested-container"},E):null].filter(c.isSome);return 0===E.length?null:p.tsx("calcite-block",{class:"esri-snapping-controls__toggle-block",heading:v.header?this.label:"",key:"toggle-block",open:!0},E)}_renderEnabledToggle(){const {messages:v,viewModel:E}=this,{snappingOptions:H}=E;return p.tsx(e.LabeledSwitch,
{checked:H.enabled,disabled:H.enabledToggled,key:`${this.id}__enabled-toggle`,label:v.enableSnapping,onChange:this._enableSnappingSwitchChange})}_renderSelfEnabledToggle(){const {messages:v,viewModel:E}=this,{snappingOptions:H}=E;return p.tsx(e.LabeledSwitch,{checked:H.enabled&&H.selfEnabled,disabled:H.enabledToggled||!H.enabled,key:`${this.id}__self-enabled-toggle`,label:v.geometryGuides,onChange:this._selfEnabledSwitchChange})}_renderFeatureEnabledToggle(){const {messages:v,viewModel:E}=this,{snappingOptions:H}=
E;return p.tsx(e.LabeledSwitch,{checked:H.enabled&&H.featureEnabled,disabled:H.enabledToggled||!H.enabled,key:`${this.id}__feature-enabled-toggle`,label:v.featureToFeature,onChange:this._featureEnabledSwitchChange})}_renderLayerList(){if(!this.visibleElements.layerList)return null;const {messages:v,viewModel:E}=this,{snappingOptions:{enabled:H,enabledToggled:K}}=E;var J=({target:{value:z}})=>{this._layerListFilter=""===z?null:new RegExp(z,"i")};J=9<E.layerListViewModel.operationalItems.length?p.tsx("calcite-input",
{class:"esri-snapping-controls__layer-list__filter",clearable:!0,placeholder:v?.searchLayers,onCalciteInputInput:J}):null;const R=K||!H;return p.tsx("calcite-block",{class:"esri-snapping-controls__layer-list-block",collapsible:!0,disabled:R,heading:v.snappingLayers,key:"list-block",open:this.layerListOpen&&!R,onCalciteBlockToggle:z=>this.layerListOpen=z.target.open},J,this._renderToggleLayersButton(),p.tsx("calcite-list",{class:"esri-snapping-controls__layer-list"},this._renderLayerListItemCollection(E.layerListViewModel.operationalItems,
this._layerListFilter)))}_renderLayerListItemCollection(v,E){return v.map(H=>{if(E?this._itemTitleMatchesFilter(H,E):1)return 0<H.children.length?this._renderLayerListItemGroup(H):this._renderLayerListItem(H);const K=H.children.filter(J=>this._itemTitleMatchesFilter(J,E));return 0<K.length?this._renderLayerListItemGroup(H,K):null}).toArray().filter(c.isSome)}_renderToggleLayersButton(){if(!this.visibleElements.layerListToggleLayersButton)return null;const {viewModel:{allLayersEnabled:v},messages:E}=
this,H=v?E.disableAllLayers:E.enableAllLayers;return p.tsx("calcite-button",{appearance:"transparent",class:"esri-snapping-controls__layer-list__button",label:H,name:"layer-toggle",onclick:this._onToggleLayersButtonClick,scale:"m"},H)}_renderLayerListItem(v){const {messages:{untitledLayer:E}}=this,H=v.enabled;return p.tsx("calcite-list-item",{class:"esri-snapping-controls__layer-list__item",key:`${this.id}-list-item-${v.uid}`,label:v.title||E,onCalciteListItemSelect:()=>{this._handleLayerListItemChange({checked:!H,
value:v.layer.id})}},p.tsx("calcite-icon",{icon:H?"check-square-f":"square",scale:"s",slot:"content-start"}))}_renderLayerListItemGroup(v,E){const {allChildrenEnabled:H,children:K,hasChildrenEnabled:J,title:R}=v,z=this.messages,T=R||z.untitledLayer,X=R&&""!==R?R:d.generateUID(),aa=E??K;return p.tsx("calcite-list-item",{class:"esri-snapping-controls__layer-list__item",key:X},p.tsx("calcite-accordion",{appearance:"transparent",class:"esri-snapping-controls__layer-list__group"},p.tsx("calcite-accordion-item",
{expanded:!!E,heading:T,key:v.uid},p.tsx("calcite-action",{onclick:()=>{this.viewModel.toggleSnappingForLayers(v.childLayerIds,!H)},scale:"m",slot:"actions-start",text:H?z.disableAllLayers:z.enableAllLayers,textEnabled:!1},p.tsx("calcite-icon",{icon:H?"check-square-f":J?"minus-square":"square",scale:"s"})),p.tsx("calcite-list",null,this._renderLayerListItemCollection(aa)))))}_itemTitleMatchesFilter(v,E){return null!=E&&E.test(v.title)}async _handleLayerListItemChange(v){v.checked?this.viewModel.enableSnappingForLayer(v.value):
this.viewModel.disableSnappingForLayer(v.value)}};b.__decorate([f.property()],g.prototype,"_defaultViewModel",void 0);b.__decorate([f.property()],g.prototype,"_layerListFilter",void 0);b.__decorate([f.property()],g.prototype,"iconClass",void 0);b.__decorate([f.property()],g.prototype,"icon",void 0);b.__decorate([f.property()],g.prototype,"label",null);b.__decorate([f.property({type:Boolean,nonNullable:!0})],g.prototype,"layerListOpen",void 0);b.__decorate([f.property(),A.messageBundle("esri/widgets/support/SnappingControls/t9n/SnappingControls")],
g.prototype,"messages",void 0);b.__decorate([f.property()],g.prototype,"snappingOptions",null);b.__decorate([f.property()],g.prototype,"view",null);b.__decorate([f.property()],g.prototype,"viewModel",null);b.__decorate([f.property({type:I,nonNullable:!0})],g.prototype,"visibleElements",void 0);return g=b.__decorate([D.subclass("esri.widgets.support.SnappingControls")],g)})},"esri/widgets/support/SnappingControls/SnappingControlsViewModel":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Error ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../views/interactive/snapping/FeatureSnappingLayerSource ../../../views/interactive/snapping/SnappingOptions ../../LayerList/support/layerListUtils ./SnappingLayerListViewModel".split(" "),
function(a,b,c,q,d,f,g,B,D,k,u,h,e){b=class extends b{constructor(l){super(l);this.layerListViewModel=new e.SnappingLayerListViewModel;this.snappingOptions=new u;this.view=null}initialize(){this.addHandles([q.watch(()=>({viewModel:this.layerListViewModel,view:this.view}),({viewModel:l,view:m})=>{l.view=m},q.initial),q.watch(()=>({viewModel:this.layerListViewModel,sources:this.snappingOptions?.featureSources}),({viewModel:l,sources:m})=>{l.featureSnappingSources=m},q.initial)])}get allLayersEnabled(){return(this.layerListViewModel?.selectableItems??
[]).every(l=>l.enabled)}get allLayersDisabled(){return(this.layerListViewModel?.selectableItems??[]).every(l=>!l.enabled)}get layersEnabledCount(){return this.layerListViewModel?.selectableItems?.filter(l=>l.enabled).length??0}get state(){return this.snappingOptions?"ready":"disabled"}toggleSnappingForLayers(l,m){l?.forEach(A=>m?this.enableSnappingForLayer(A):this.disableSnappingForLayer(A))}toggleSnappingForAllLayers(l){this.layerListViewModel.selectableItems.forEach(({layer:{id:m}})=>{l?this.enableSnappingForLayer(m):
this.disableSnappingForLayer(m)})}enableSnappingForLayer(l){(this._findSnappingSourceForLayer(l)??this._makeSnappingSourceForLayer(l)).enabled=!0}disableSnappingForLayer(l){if(l=this._findSnappingSourceForLayer(l))l.enabled=!1}updateEnabledFeatureSources(l){for(const m of this.snappingOptions.featureSources)h.canDisplayLayer(m.layer)&&(m.enabled=l.includes(m.layer.id))}_findSnappingSourceForLayer(l){return this.snappingOptions.featureSources.find(m=>m.layer.id===l)}_makeSnappingSourceForLayer(l){var m=
this.layerListViewModel.operationalItemsFlat.find(A=>A.layer.id===l)?.layer;if(!m)throw new c("snapping-controls:layer-not-found",`cannot enable snapping for layer with id ${l} because no such layer was found in the view`);m=new k({layer:m});this.snappingOptions.featureSources.add(m);return m}};a.__decorate([d.property()],b.prototype,"allLayersEnabled",null);a.__decorate([d.property()],b.prototype,"allLayersDisabled",null);a.__decorate([d.property({constructOnly:!0})],b.prototype,"layerListViewModel",
void 0);a.__decorate([d.property()],b.prototype,"layersEnabledCount",null);a.__decorate([d.property({type:u,nonNullable:!0})],b.prototype,"snappingOptions",void 0);a.__decorate([d.property()],b.prototype,"state",null);a.__decorate([d.property()],b.prototype,"view",void 0);return b=a.__decorate([D.subclass("esri.widgets.support.SnappingControls.SnappingControlsViewModel")],b)})},"esri/widgets/LayerList/support/layerListUtils":function(){define(["exports"],function(a){function b(k){if(k)return null!=
k.listMode?k.listMode:void 0}function c(k){return null!=k&&"minScale"in k&&null!=k.minScale?k.minScale:void 0}function q(k){return null!=k&&"maxScale"in k&&null!=k.maxScale?k.maxScale:void 0}function d(k){if(k&&!("type"in k&&"wmts"===k.type)&&k.listMode!==D.hideChildren)return"sublayers"in k?"sublayers":"layers"in k?"layers":void 0}function f(k,u){k?.sort((h,e)=>{h="uid"in h?u.indexOf(h.uid):-1;e="uid"in e?u.indexOf(e.uid):-1;return h>e?-1:h<e?1:0})}function g(k){return null!=k&&"layer"in k&&null!=
k.layer}function B(k){return k&&"capabilities"in k&&null!=k.capabilities&&"exportMap"in k.capabilities?k.capabilities.exportMap:void 0}const D={hide:"hide",hideChildren:"hide-children"};a.canDisplayLayer=function(k){return b(k)!==D.hide};a.canSortSublayers=function(k){k=(k?.layer&&g(k.layer)?k.layer.layer:void 0)??k?.layer;if(!k)return!1;k=B(k);return(null!=k&&"supportsDynamicLayers"in k?k.supportsDynamicLayers:void 0)??!0};a.findLayerListMode=b;a.findLayerMaxScale=q;a.findLayerMinScale=c;a.findLayerVisibilityMode=
function(k){if(!k)return"inherited";var u=g(k)?k.layer:k;u=B(u);u=null!=u&&"supportsSublayerVisibility"in u?u.supportsSublayerVisibility:void 0;return null!=u?u?"independent":"inherited":"visibilityMode"in k&&null!=k.visibilityMode?k.visibilityMode:"independent"};a.findSelectedItem=function(k,u){const h=k.layer?.uid;return null!=h?u.find(e=>e.layer?.uid===h):null};a.getItemLayers=function(k){return(k=k?.layer)&&"layers"in k?k.layers:null};a.getLegendLayerInfo=function(k){var u=g(k)?k:null;const h=
k?.parent;return(u=null!=h&&"type"in h&&"map-image"===h.type?u?.source:null)&&h?{layer:h,title:"",sublayerIds:[u.mapLayerId]}:{layer:k,title:""}};a.getNormalizedChildLayerProperty=d;a.isLayerOutsideScaleRange=function(k,u){if(!k||null==u||isNaN(u))return!1;var h=c(k);k=q(k);h=null!=h&&!isNaN(h)&&0<h&&u>h;u=null!=k&&!isNaN(k)&&0<k&&u<k;return h||u};a.isSublayer=g;a.sortChildLayersToIds=function(k,u){if(k=k?.layer){var h=d(k);if(h){if("layers"===h&&"layers"in k)var e=k.layers;else"sublayers"===h&&"sublayers"in
k&&(e=k.sublayers);f(e,u)}}};a.sortLayersToIds=f;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/SnappingControls/SnappingLayerListViewModel":function(){define("exports ../../../chunks/tslib.es6 ../../../core/Collection ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../LayerList/LayerListViewModel ./snappingLayerListUtils ./SnappingListItem".split(" "),
function(a,b,c,q,d,f,g,B,D,k,u){a.SnappingLayerListViewModel=class extends D{constructor(){super(...arguments);this.featureSnappingSources=new c}get operationalItemsFlat(){return this.operationalItems.flatten(h=>h.children)}get selectableItems(){return this.operationalItemsFlat.filter(h=>!h.children?.length)}_compileList(){var h=this.view?.map?.layers;h&&(h=h.filter(k.isValidSnappingLayer),this._watchLayersListMode(h),h=this._getViewableLayers(h),h?.length?(this._createNewItems(h),this._removeItems(h),
this._sortItems(h)):this._removeAllItems())}_createListItem(h){return new u.SnappingListItem({layer:h,view:this.view,getFeatureSnappingSources:()=>this.featureSnappingSources})}};b.__decorate([q.property()],a.SnappingLayerListViewModel.prototype,"featureSnappingSources",void 0);b.__decorate([q.property()],a.SnappingLayerListViewModel.prototype,"operationalItems",void 0);b.__decorate([q.property()],a.SnappingLayerListViewModel.prototype,"operationalItemsFlat",null);b.__decorate([q.property()],a.SnappingLayerListViewModel.prototype,
"selectableItems",null);a.SnappingLayerListViewModel=b.__decorate([B.subclass("esri.widgets.support.SnappingControls.SnappingLayerListViewModel")],a.SnappingLayerListViewModel);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/LayerList/LayerListViewModel":function(){define("../../chunks/tslib.es6 ../../core/Collection ../../core/Evented ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ./ListItem ./support/layerListUtils".split(" "),
function(a,b,c,q,d,f,g,B,D,k,u){const h=b.ofType(k);b=class extends c.EventedAccessor{constructor(e){super(e);this.checkPublishStatusEnabled=!1;this.listItemCreatedFunction=null;this.operationalItems=new h;this.view=null}initialize(){this.addHandles([q.watch(()=>[this.view,this.view?.ready],()=>this._viewHandles(),q.initial),q.watch(()=>[this.listItemCreatedFunction,this.checkPublishStatusEnabled],()=>this._recompileList())],"view")}destroy(){this.view=null;this.operationalItems.removeAll()}get state(){const {view:e}=
this;return e?.ready?"ready":e?"loading":"disabled"}triggerAction(e,l){e&&!e.disabled&&this.emit("trigger-action",{action:e,item:l})}moveListItem(e,l,m,A){const p=e?.layer;if(p){var C=this.view?.map?.layers,I=l?u.getItemLayers(l):C;C=m?u.getItemLayers(m):C;if(I&&C){var {operationalItems:r}=this;l=l?.children||r;r=m?.children||r;A=C.length-A;e.parent=m||null;l.includes(e)&&l.remove(e);I.includes(p)&&I.remove(p);r.includes(e)||r.add(e,A);C.includes(p)||C.add(p,A)}}}_createLayerViewHandles(e){this.removeHandles("layer-views");
this._compileList();e&&this.addHandles(e.on("change",()=>this._compileList()),"layer-views")}_createMapLayerHandles(e){this.removeHandles("map-layers");this._compileList();e&&this.addHandles(e.on("change",()=>this._compileList()),"map-layers")}_createListItem(e){const {view:l,listItemCreatedFunction:m,checkPublishStatusEnabled:A}=this;return new k({checkPublishStatusEnabled:A,layer:e,listItemCreatedFunction:m,view:l})}_removeAllItems(){this.operationalItems.removeAll()}_getViewableLayers(e){if(e)return e.filter(l=>
"hide"!==u.findLayerListMode(l))}_watchLayersListMode(e){this.removeHandles("layer-list-mode");e&&e.forEach(l=>{"listMode"in l&&this.addHandles(q.watch(()=>l.listMode,()=>this._compileList()),"layer-list-mode")})}_compileList(){var e=this.view?.map?.layers;this._watchLayersListMode(e);e=this._getViewableLayers(e);e?.length?(this._createNewItems(e),this._removeItems(e),this._sortItems(e)):this._removeAllItems()}_createNewItems(e){const {operationalItems:l}=this;e.forEach(m=>{l.find(A=>A.layer===m)||
l.add(this._createListItem(m))})}_removeItems(e){const {operationalItems:l}=this,m=[];l.forEach(A=>{A&&e&&e.includes(A.layer)||m.push(A)});l.removeMany(m)}_sortItems(e){const {operationalItems:l}=this;l.sort((m,A)=>{m=e.indexOf(m.layer);A=e.indexOf(A.layer);return m>A?-1:m<A?1:0})}_recompileList(){this._removeAllItems();this._compileList()}_viewHandles(){const {view:e}=this;this.removeHandles(["map-layers","layer-views","view-layers"]);this._recompileList();e&&e.ready&&this.addHandles([q.watch(()=>
this.view?.map?.allLayers,l=>this._createMapLayerHandles(l),q.initial),q.watch(()=>this.view?.allLayerViews,l=>this._createLayerViewHandles(l),q.initial)],"view-layers")}};a.__decorate([d.property()],b.prototype,"checkPublishStatusEnabled",void 0);a.__decorate([d.property()],b.prototype,"listItemCreatedFunction",void 0);a.__decorate([d.property({type:h})],b.prototype,"operationalItems",void 0);a.__decorate([d.property({readOnly:!0})],b.prototype,"state",null);a.__decorate([d.property()],b.prototype,
"view",void 0);return b=a.__decorate([D.subclass("esri.widgets.LayerList.LayerListViewModel")],b)})},"esri/widgets/LayerList/ListItem":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/arrayUtils ../../core/Collection ../../core/Identifiable ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/has ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/get ../../support/actions/ActionBase ../../support/actions/ActionButton ../../support/actions/ActionSlider ../../support/actions/ActionToggle ./ListItemPanel ./support/layerListUtils".split(" "),
function(a,b,c,q,d,f,g,B,D,k,u,h,e,l,m,A,p){var C;D=q.ofType({key:"type",defaultKeyValue:"button",base:h,typeMap:{button:e,toggle:m,slider:l}});const I=q.ofType(D);b=C=class extends d.IdentifiableMixin(b){constructor(r){super(r);this.actionsSections=new I;this.checkPublishStatusEnabled=this.actionsOpen=!1;this.children=new (q.ofType(C));this.childrenSortable=!0;this.hidden=!1;this.listItemCreatedFunction=this.layerView=this.layer=null;this.open=!1;this.parent=this.panel=null;this.sortable=!0;this.view=
null}initialize(){this.addHandles([f.watch(()=>this.layer,r=>this._watchLayerProperties(r),f.initial),f.watch(()=>this.checkPublishStatusEnabled,r=>this._updateChildrenPublishing(r),f.initial),f.watch(()=>this.view,r=>this._updateChildrenView(r),f.initial),f.watch(()=>this.panel,r=>this._setListItemOnPanel(r),f.initial),f.watch(()=>[this.layer,this.view],()=>this._getLayerView(),f.initial)]);"function"===typeof this.listItemCreatedFunction&&this.listItemCreatedFunction.call(null,{item:this})}destroy(){this.view=
null}get connectionStatus(){const {layerView:r,publishing:v}=this;if(!v&&r&&"connectionStatus"in r)return r.connectionStatus}get error(){return this.layer?.loadError}get incompatible(){const {layerView:r}=this;return r&&"spatialReferenceSupported"in r?!r.spatialReferenceSupported:!1}castPanel(r){this.panel?.open&&!r.hasOwnProperty("open")&&(r.open=!0);return r?new A(r):null}get title(){const r=u.get(this,"layer.layer");return(!r||r&&u.get(this,"layer.layer.loaded"))&&u.get(this,"layer.title")||u.get(this,
"layer.attributes.title")||""}set title(r){this._override("title",r)}get publishing(){const {layer:r,checkPublishStatusEnabled:v}=this;return v&&r&&"publishingInfo"in r&&"publishing"===r.publishingInfo?.status}get updating(){const {layerView:r,connectionStatus:v,layer:E,publishing:H}=this;return H||v?!1:r?r.updating:"loading"===E?.loadStatus||!1}get visible(){return this.layer?.visible}set visible(r){const v=this.layer;v&&(v.visible=r)}get visibleAtCurrentScale(){return!p.isLayerOutsideScaleRange(this.layer,
this.view?.scale)}get visibilityMode(){return p.findLayerVisibilityMode(this.layer)}clone(){return new C({actionsSections:this.actionsSections.clone(),actionsOpen:this.actionsOpen,checkPublishStatusEnabled:this.checkPublishStatusEnabled,children:this.children.clone(),layer:this.layer,listItemCreatedFunction:this.listItemCreatedFunction,open:this.open,panel:this.panel,title:this.title,view:this.view,visible:this.visible})}_setListItemOnPanel(r){r&&(r.listItem=this)}_updateChildrenPublishing(r){const v=
this.children;v&&v.forEach(E=>E.checkPublishStatusEnabled=r)}_updateChildrenView(r){const v=this.children;v&&v.forEach(E=>E.view=r)}_addChildren(r){this.removeHandles("child-list-mode");this.children.removeAll();if(r){r.forEach(E=>{this.addHandles(f.watch(()=>E.listMode,()=>this._addChildren(r)),"child-list-mode")});var v=r.filter(E=>"hide"!==p.findLayerListMode(E));this.children.addMany(this._makeChildren(v))}}_watchSublayerChanges(r){r&&this.addHandles(r.on("change",()=>{this._addChildren(r)}),
"layer")}_initializeChildLayers(r){this._addChildren(r);this._watchSublayerChanges(r)}_makeChildren(r){return r.map(v=>p.canDisplayLayer(v)?new C({layer:v,checkPublishStatusEnabled:this.checkPublishStatusEnabled,listItemCreatedFunction:this.listItemCreatedFunction,parent:this,view:this.view}):null).filter(c.isSome).reverse()}_watchLayerProperties(r){this.removeHandles("layer");this.removeHandles("child-list-mode");if(r)if(this.addHandles(f.watch(()=>r.listMode,()=>this._watchLayerProperties(r)),"layer"),
"hide-children"===p.findLayerListMode(r))this.children.removeAll();else{var v=p.getNormalizedChildLayerProperty(r);v&&this.addHandles(f.watch(()=>r[v],E=>{r.hasOwnProperty(v)&&this._initializeChildLayers(E)},f.initial),"layer")}}async _getLayerView(){const {layer:r,view:v}=this;if(r&&v)try{const E=await v.whenLayerView(r);E.layer===this.layer&&this._set("layerView",E)}catch{}}};a.__decorate([g.property({type:I})],b.prototype,"actionsSections",void 0);a.__decorate([g.property()],b.prototype,"actionsOpen",
void 0);a.__decorate([g.property()],b.prototype,"checkPublishStatusEnabled",void 0);a.__decorate([g.property({type:q})],b.prototype,"children",void 0);a.__decorate([g.property()],b.prototype,"childrenSortable",void 0);a.__decorate([g.property({readOnly:!0})],b.prototype,"connectionStatus",null);a.__decorate([g.property({readOnly:!0})],b.prototype,"error",null);a.__decorate([g.property()],b.prototype,"hidden",void 0);a.__decorate([g.property({readOnly:!0})],b.prototype,"incompatible",null);a.__decorate([g.property()],
b.prototype,"layer",void 0);a.__decorate([g.property({readOnly:!0})],b.prototype,"layerView",void 0);a.__decorate([g.property()],b.prototype,"listItemCreatedFunction",void 0);a.__decorate([g.property()],b.prototype,"open",void 0);a.__decorate([g.property({type:A})],b.prototype,"panel",void 0);a.__decorate([B.cast("panel")],b.prototype,"castPanel",null);a.__decorate([g.property()],b.prototype,"parent",void 0);a.__decorate([g.property()],b.prototype,"sortable",void 0);a.__decorate([g.property()],b.prototype,
"title",null);a.__decorate([g.property({readOnly:!0})],b.prototype,"publishing",null);a.__decorate([g.property({readOnly:!0})],b.prototype,"updating",null);a.__decorate([g.property()],b.prototype,"view",void 0);a.__decorate([g.property()],b.prototype,"visible",null);a.__decorate([g.property({readOnly:!0})],b.prototype,"visibleAtCurrentScale",null);a.__decorate([g.property({readOnly:!0})],b.prototype,"visibilityMode",null);return b=C=a.__decorate([k.subclass("esri.widgets.LayerList.ListItem")],b)})},
"esri/support/actions/ActionSlider":function(){define("../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ./ActionBase".split(" "),function(a,b,c,q,d,f,g){var B;c=B=class extends g{constructor(D){super(D);this.displayValueEnabled=!1;this.max=1;this.min=0;this.step=.1;this.type="slider";this.value=null}clone(){return new B({active:this.active,className:this.className,
disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,displayValueEnabled:this.displayValueEnabled,max:this.max,min:this.min,step:this.step,value:this.value})}};a.__decorate([b.property()],c.prototype,"displayValueEnabled",void 0);a.__decorate([b.property()],c.prototype,"max",void 0);a.__decorate([b.property()],c.prototype,"min",void 0);a.__decorate([b.property()],c.prototype,"step",void 0);a.__decorate([b.property()],c.prototype,"value",void 0);return c=
B=a.__decorate([f.subclass("esri.support.Action.ActionSlider")],c)})},"esri/widgets/LayerList/ListItemPanel":function(){define("require ../../chunks/tslib.es6 ../../core/Identifiable ../../core/maybe ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../Widget ./support/layerListUtils ../support/widget ../support/jsxFactory".split(" "),function(a,b,c,q,d,f,
g,B,D,k,u,h,e,l){c=class extends c.IdentifiableMixin(u){constructor(m,A){super(m,A);this.listItem=this.image=this.content=this._legend=null;this.open=!1;this.visible=!0}initialize(){this.addHandles(d.watch(()=>this.content,m=>this._createLegend(m),d.initial))}destroy(){this._legend=q.destroyMaybe(this._legend)}get className(){const {image:m}=this,A=this._getFirstWidget();return this._get("className")||(!m&&A?A.iconClass??"":"")}set className(m){this._override("className",m)}get disabled(){const {listItem:m,
_legend:A,content:p}=this;return m?Array.isArray(p)&&1<p.length?!1:A?!A.activeLayerInfos?.length||!m.visibleAtCurrentScale||!m.visible:!1:!0}set disabled(m){this._overrideIfSome("disabled",m)}get title(){const m=this._getFirstWidget();return this._get("title")||(m?.label??"")}set title(m){this._override("title",m)}render(){return l.tsx("div",{class:"esri-layer-list-panel"},this._renderContents())}_renderContent(m){const {_legend:A,disabled:p}=this;return!m||p?null:"legend"===m&&A?l.tsx("div",{class:this.classes("esri-layer-list-panel__content",
"esri-layer-list-panel__content--legend"),key:A},A.render()):"string"===typeof m?l.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--string"),innerHTML:m,key:m}):e.isWidget(m)?l.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--widget"),key:m},m.render()):m instanceof HTMLElement?l.tsx("div",{afterCreate:this._attachToNode,bind:m,class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--html-element"),
key:m}):null}_renderContents(){const {content:m}=this;return Array.isArray(m)?m.map(A=>this._renderContent(A)):this._renderContent(m)}_getLegendOptions(){const {listItem:m}=this;if(!m)return{};const {layer:A,view:p}=m;return A&&p?{view:p,layerInfos:[h.getLegendLayerInfo(A)]}:{}}async _createLegend(m){if(this._hasLegend(m)&&!this._legend){({default:m}=await new Promise((C,I)=>a(["../Legend"],r=>C(Object.freeze(Object.defineProperty({__proto__:null,default:r},Symbol.toStringTag,{value:"Module"}))),
I)));var {listItem:A}=this,p=new m(this._getLegendOptions());this._legend=p;this.notifyChange("className");this.notifyChange("title");m=d.watch(()=>[A?.view,A?.layer,A?.layer?.source,A?.layer?.parent],()=>this._updateLegend(p),d.initial);this.addHandles(m,"legends");this.scheduleRender()}}_hasLegend(m){return"legend"===m?!0:null!=m&&(Array.isArray(m)?m.includes("legend"):!1)}_attachToNode(m){m.appendChild(this)}_updateLegend(m){m.set(this._getLegendOptions());this.scheduleRender()}_getWidget(m){return"legend"===
m?this._legend:e.isWidget(m)?m:null}_getFirstWidget(){const {content:m}=this;if(Array.isArray(m)){let A=null;m.some(p=>{(p=this._getWidget(p))&&(A=p);return!!p});return A}return this._getWidget(m)}};b.__decorate([f.property()],c.prototype,"_legend",void 0);b.__decorate([f.property()],c.prototype,"className",null);b.__decorate([f.property()],c.prototype,"content",void 0);b.__decorate([f.property()],c.prototype,"disabled",null);b.__decorate([f.property()],c.prototype,"image",void 0);b.__decorate([f.property()],
c.prototype,"listItem",void 0);b.__decorate([f.property()],c.prototype,"title",null);b.__decorate([f.property()],c.prototype,"open",void 0);b.__decorate([f.property()],c.prototype,"visible",void 0);return c=b.__decorate([k.subclass("esri.widgets.LayerList.ListItemPanel")],c)})},"esri/widgets/support/SnappingControls/snappingLayerListUtils":function(){define(["exports","../../LayerList/support/layerListUtils"],function(a,b){const c=f=>q(f)||d(f),q=f=>{if(!("type"in f))return!1;switch(f.type){case "feature":case "geojson":case "csv":case "graphics":case "wfs":case "map-notes":case "oriented-imagery":case "scene":case "building-scene":return!0;
default:return!1}},d=f=>{const g=b.getNormalizedChildLayerProperty(f);if(null!=g&&f.hasOwnProperty(g)&&null!=f[g])for(const B of f[g])if(c(B))return!0;return!1};a.isValidSnappingLayer=c;a.isValidSnappingLayerGroup=d;a.isValidSnappingLayerSource=q;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/SnappingControls/SnappingListItem":function(){define("exports ../../../chunks/tslib.es6 ../../../core/arrayUtils ../../../core/Collection ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../LayerList/ListItem ../../LayerList/support/layerListUtils ./snappingLayerListUtils".split(" "),
function(a,b,c,q,d,f,g,B,D,k,u){var h;a.SnappingListItem=h=class extends D{constructor(e){super(e);this.children=new q;this.parent=null}get allChildrenEnabled(){return this.children.every(e=>e.enabled)??!1}get childLayerIds(){return this.children.map(e=>e.layer.id).toArray()}get enabled(){return null!=this.featureSource?this.featureSource.enabled:!1}get featureSource(){const {layer:e,getFeatureSnappingSources:l}=this;return l().find(m=>m.layer===e)}get hasChildrenEnabled(){return this.children.some(e=>
e.enabled)}_initializeChildLayers(e){e&&(e=e.filter(u.isValidSnappingLayer),super._initializeChildLayers(e))}_makeChildren(e){return e.map(l=>k.canDisplayLayer(l)?new h({layer:l,parent:this,view:this.view,getFeatureSnappingSources:this.getFeatureSnappingSources}):null).filter(c.isSome).reverse()}};b.__decorate([d.property()],a.SnappingListItem.prototype,"allChildrenEnabled",null);b.__decorate([d.property()],a.SnappingListItem.prototype,"children",void 0);b.__decorate([d.property()],a.SnappingListItem.prototype,
"childLayerIds",null);b.__decorate([d.property()],a.SnappingListItem.prototype,"enabled",null);b.__decorate([d.property()],a.SnappingListItem.prototype,"featureSource",null);b.__decorate([d.property({constructOnly:!0})],a.SnappingListItem.prototype,"getFeatureSnappingSources",void 0);b.__decorate([d.property()],a.SnappingListItem.prototype,"hasChildrenEnabled",null);b.__decorate([d.property()],a.SnappingListItem.prototype,"parent",void 0);a.SnappingListItem=h=b.__decorate([B.subclass("esri.widgets.support.SnappingControls.SnappingListItem")],
a.SnappingListItem);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define("require ../chunks/tslib.es6 ../intl ../core/handleUtils ../core/maybe ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./Widget ./Sketch/SketchViewModel ./Sketch/VisibleElements ./support/componentsUtils ./support/globalCss ./support/legacyIcon ./support/SelectionToolbar ./support/SketchTooltipControls ./support/SnappingControls ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory ../intl/substitute".split(" "),function(a,
b,c,q,d,f,g,B,D,k,u,h,e,l,m,A,p,C,I,r,v,E,H,K,J){var R=p.legacyIcon.edit;c=class extends h{constructor(z,T){super(z,T);this._activeCreateOptions=null;this._menuOpen=!1;this._viewModelHandlesGroup=this._selectionToolbar=null;this.availableCreateTools=["point","polyline","polygon","rectangle","circle"];this.creationMode="continuous";this.iconClass=R;this.icon=null;this.layout="horizontal";this.messagesCommon=this.messages=null;this.visibleElements=new l;this._activateCreateTool=this._activateCreateTool.bind(this);
this.viewModel=z?.viewModel||new e}initialize(){const {layer:z,view:T}=this,X=new C({view:"2d"===T?.type?T:null,sources:z?[z]:null});this.addHandles([f.watch(()=>this.viewModel,aa=>{this._viewModelHandlesGroup=d.removeMaybe(this._viewModelHandlesGroup);aa&&(this._viewModelHandlesGroup=q.handlesGroup([aa.on("create",w=>{this.scheduleRender();this._onCreateOperation(w)}),aa.on("update",()=>this.scheduleRender()),aa.on("delete",w=>this.emit("delete",w)),aa.on("undo",()=>this.scheduleRender()),aa.on("redo",
()=>this.scheduleRender()),f.watch(()=>aa.layer,w=>{this._selectionToolbar&&(this._selectionToolbar.sources=w?[w]:null)}),f.watch(()=>aa.view,w=>{this._selectionToolbar&&(this._selectionToolbar.view="2d"===w?.type?w:null)}),f.watch(()=>aa.state,()=>this.notifyChange("state"))]))},f.syncAndInitial),f.when(()=>X.activeToolInfo,()=>this.viewModel.cancel()),X.on("complete",aa=>this._onSelectionOperationComplete(aa)),f.watch(()=>{const {selectionTools:aa}=this.visibleElements;return{lassoTool:!!aa?.["lasso-selection"],
rectangleTool:!!aa?.["rectangle-selection"]}},aa=>{Object.assign(X.visibleElements,aa)},f.syncAndInitial)]);this._selectionToolbar=X}loadDependencies(){return m.loadCalciteComponents({action:()=>new Promise((z,T)=>a(["../chunks/calcite-action"],z,T)),icon:()=>new Promise((z,T)=>a(["../chunks/calcite-icon"],z,T))})}destroy(){this._selectionToolbar?.destroy();this._viewModelHandlesGroup=d.removeMaybe(this._viewModelHandlesGroup)}get activeTool(){const z=this._selectionToolbar?.activeToolInfo;if(z)switch(z.toolName){case "lasso":return"lasso-selection";
case "rectangle":return"rectangle-selection";case "default":return"custom-selection"}return this.viewModel.activeTool}get createGraphic(){return this.viewModel.createGraphic}get defaultCreateOptions(){return this.viewModel.defaultCreateOptions}set defaultCreateOptions(z){this.viewModel.defaultCreateOptions=z}get defaultUpdateOptions(){return this.viewModel.defaultUpdateOptions}set defaultUpdateOptions(z){this.viewModel.defaultUpdateOptions=z}get label(){return this.messages?.widgetLabel??""}set label(z){this._overrideIfSome("label",
z)}get labelOptions(){return this.viewModel.labelOptions}set labelOptions(z){this.viewModel.labelOptions=z}get layer(){return this.viewModel.layer}set layer(z){this.viewModel.layer=z}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(z){this.viewModel.snappingOptions=z}get state(){return this._selectionToolbar?.activeToolInfo?"active":this.viewModel.state}get tooltipOptions(){return this.viewModel.tooltipOptions}set tooltipOptions(z){this.viewModel.tooltipOptions=z}get updateGraphics(){return this.viewModel.updateGraphics}get view(){return this.viewModel.view}set view(z){this.viewModel.view=
z}set viewModel(z){const T=this._get("viewModel");z!==T&&(T&&d.destroyMaybe(T),this._set("viewModel",z))}get _effectiveAvailableCreateTools(){const {availableCreateTools:z,visibleElements:T}=this;return z?.filter(X=>!!T.createTools?.[X])}create(z,T){this._activeCreateOptions=T||null;this.viewModel.create(z,T)}update(z,T){return this.viewModel.update(z,T)}complete(){this.viewModel.complete()}cancel(){this._selectionToolbar?.cancel();this.viewModel.cancel()}undo(){this.viewModel.undo();this.view?.focus()}redo(){this.viewModel.redo();
this.view?.focus()}delete(){this.viewModel.delete()}duplicate(){return this.viewModel.duplicate()}render(){const {label:z,layout:T,viewModel:{state:X}}=this;return K.tsx("div",{"aria-label":z,class:this.classes("esri-sketch",A.globalCss.widget,{[A.globalCss.disabled]:"disabled"===X,["esri-sketch--vertical"]:"vertical"===T})},K.tsx("div",{class:"esri-sketch__panel",role:"toolbar"},this._renderTopPanelContents()),K.tsx("div",{class:this.classes("esri-sketch__panel","esri-sketch__info-panel")},this._renderInfoPanelContents()))}_renderTopPanelContents(){const z=
this.classes("esri-sketch__section","esri-sketch__tool-section"),{_effectiveAvailableCreateTools:T,visibleElements:X,viewModel:aa}=this;return[aa.updateOnGraphicClick||this._selectionToolbar?.visibleToolCount?K.tsx("div",{class:z,key:"selection-button-container",role:"menu"},this._renderDefaultSelectionButton(),this._renderSelectionToolbar()):null,T?.length?K.tsx("div",{class:z,role:"menu"},this._renderDrawButtons()):null,X.undoRedoMenu?K.tsx("div",{class:z,key:"undo-redo-menu-button-container",role:"menu"},
this._renderUndoRedoMenuButtons()):null,X.settingsMenu?K.tsx("div",{class:"esri-sketch__section",key:"settings-menu-button-container"},this._renderSettingsMenuButton()):null]}_renderInfoPanelContents(){if(this._menuOpen)return this._renderSettingsMenu();if(this.updateGraphics.length)return[K.tsx("div",{class:this.classes("esri-sketch__section","esri-sketch__info-section","esri-sketch__info-count-section"),key:"feature-count-container"},this._renderFeatureCount()),K.tsx("div",{class:this.classes("esri-sketch__section",
"esri-sketch__info-section"),key:"delete-button-container"},this._renderDuplicateButton(),this._renderDeleteButton())]}_renderSettingsMenu(){const {labelOptions:z,messagesCommon:T,snappingOptions:X,tooltipOptions:aa,view:w,visibleElements:y}=this;return[K.tsx("div",{class:"esri-sketch__menu-container","data-testid":"menu",key:"settings-menu-container",role:"menu"},K.tsx("header",{class:"esri-sketch__menu-header",key:"settings-menu-header"},K.tsx("span",{class:"esri-sketch__menu-title"},T.settings)),
y.sketchTooltipControls?K.tsx(I,{labelOptions:z,tooltipOptions:aa,viewType:w?.type,visibleElements:y.sketchTooltipControlsElements}):void 0,y.snappingControls&&w&&X?K.tsx(r,{snappingOptions:X,view:w,visibleElements:y.snappingControlsElements}):void 0)]}_renderFeatureCount(){const {layout:z,messages:T,updateGraphics:{length:X}}=this,aa=J.substitute(T.selectedCount,{count:X});return K.tsx("div",{"aria-label":aa,class:"esri-sketch__feature-count-badge"},K.tsx("span",{class:"esri-sketch__feature-count-number"},
"vertical"===z?X:aa))}_renderDuplicateButton(){if(this.visibleElements.duplicateButton){var z=this.messages;z=1<this.updateGraphics.length?z.duplicateFeatures:z.duplicateFeature;return K.tsx("calcite-action",{bind:this,label:z,onclick:this._onDuplicateSelect,scale:"s",text:z,title:z},K.tsx("calcite-icon",{icon:"copy",scale:"s"}))}}_renderDeleteButton(){var z=this.messages;z=1<this.updateGraphics.length?z.deleteFeatures:z.deleteFeature;return K.tsx("calcite-action",{bind:this,label:z,onclick:this.delete,
scale:"s",text:z,title:z},K.tsx("calcite-icon",{icon:"trash",scale:"s"}))}_renderDefaultSelectionButton(){if(this.viewModel.updateOnGraphicClick){var z=this.messages.selectFeature;return K.tsx("calcite-action",{active:"ready"===this.state,bind:this,label:z,onclick:this._activateDefaultSelectTool,scale:"s",text:z,title:z},K.tsx("calcite-icon",{icon:"cursor",scale:"s"}))}}_renderSelectionToolbar(){if("2d"===this.view?.type&&this._selectionToolbar)return this._selectionToolbar.render()}_renderDrawButtons(){return this._effectiveAvailableCreateTools?.map(z=>
{switch(z){case "point":return this._renderPointButton();case "polyline":return this._renderPolylineButton();case "polygon":return this._renderPolygonButton();case "rectangle":return this._renderRectangleButton();case "circle":return this._renderCircleButton()}})}_renderPointButton(){const z=this.messages.drawPoint;return K.tsx("calcite-action",{active:"point"===this.activeTool,bind:this,label:z,onclick:()=>this._activateCreateTool("point"),scale:"s",text:z,title:z},K.tsx("calcite-icon",{icon:"pin",
scale:"s"}))}_renderPolygonButton(){const z=this.messages.drawPolygon;return K.tsx("calcite-action",{active:"polygon"===this.activeTool,bind:this,label:z,onclick:()=>this._activateCreateTool("polygon"),scale:"s",text:z,title:z},K.tsx("calcite-icon",{icon:"polygon",scale:"s"}))}_renderPolylineButton(){const z=this.messages.drawPolyline;return K.tsx("calcite-action",{active:"polyline"===this.activeTool,bind:this,label:z,onclick:()=>this._activateCreateTool("polyline"),scale:"s",text:z,title:z},K.tsx("calcite-icon",
{icon:"line",scale:"s"}))}_renderCircleButton(){const z=this.messages.drawCircle;return K.tsx("calcite-action",{active:"circle"===this.activeTool,bind:this,label:z,onclick:()=>this._activateCreateTool("circle"),scale:"s",text:z,title:z},K.tsx("calcite-icon",{icon:"circle",scale:"s"}))}_renderRectangleButton(){const z=this.messages.drawRectangle;return K.tsx("calcite-action",{active:"rectangle"===this.activeTool,bind:this,label:z,onclick:()=>this._activateCreateTool("rectangle"),scale:"s",text:z,title:z},
K.tsx("calcite-icon",{icon:"rectangle",scale:"s"}))}_renderUndoRedoMenuButtons(){return[this._renderUndoButton(),this._renderRedoButton()]}_renderUndoButton(){const z=this.messages.undo;return K.tsx("calcite-action",{bind:this,disabled:!this.viewModel.canUndo(),label:z,onclick:this.undo,scale:"s",text:z,title:z},K.tsx("calcite-icon",{icon:v.isRTL(this.container)?"redo":"undo",scale:"s"}))}_renderRedoButton(){const z=this.messages.redo;return K.tsx("calcite-action",{bind:this,disabled:!this.viewModel.canRedo(),
label:z,onclick:this.redo,scale:"s",text:z,title:z},K.tsx("calcite-icon",{icon:v.isRTL(this.container)?"undo":"redo",scale:"s"}))}_renderSettingsMenuButton(){const z=this.messagesCommon.settings;return K.tsx("calcite-action",{active:this._menuOpen,bind:this,"data-testid":"settings-menu-action",label:z,onclick:this._toggleMenu,scale:"s",text:z,title:z},K.tsx("calcite-icon",{icon:"gear",scale:"s"}))}_activateCreateTool(z){this.activeTool===z?this.cancel():(this._selectionToolbar?.cancel(),this.create(z))}_onCreateOperation(z){if("complete"===
z.state){var {creationMode:T}=this,{type:X}=z;if("create"===X){const {tool:aa,graphic:w}=z;z=this._activeCreateOptions;this._activeCreateOptions=null;"continuous"===T?this.create(aa,z):"update"===T&&this.update([w])}}}_toggleMenu(){this._menuOpen=!this._menuOpen;this.scheduleRender()}_onDuplicateSelect(){const z=this.duplicate(),T=this.viewModel.activeTool;"transform"!==T&&"reshape"!==T||this.update(z,{tool:T})}_onSelectionOperationComplete(z){const {viewModel:{defaultUpdateOptions:T}}=this,{selection:X}=
z;!z.aborted&&X.length&&(z=T.tool,this.update(X,{...T,tool:1<X.length&&"reshape"===z?"transform":z}));this.notifyChange("state")}_activateDefaultSelectTool(){this.cancel();this.view?.focus()}};b.__decorate([g.property()],c.prototype,"activeTool",null);b.__decorate([g.property({cast:z=>{if(!z?.length)return null;const T=new Set(["point","polyline","polygon","rectangle","circle"]);return z.filter(X=>T.has(X))}})],c.prototype,"availableCreateTools",void 0);b.__decorate([g.property({readOnly:!0})],c.prototype,
"createGraphic",null);b.__decorate([g.property()],c.prototype,"creationMode",void 0);b.__decorate([g.property()],c.prototype,"defaultCreateOptions",null);b.__decorate([g.property()],c.prototype,"defaultUpdateOptions",null);b.__decorate([g.property()],c.prototype,"iconClass",void 0);b.__decorate([g.property()],c.prototype,"icon",void 0);b.__decorate([g.property()],c.prototype,"label",null);b.__decorate([g.property()],c.prototype,"labelOptions",null);b.__decorate([g.property()],c.prototype,"layer",
null);b.__decorate([g.property({type:["horizontal","vertical"]})],c.prototype,"layout",void 0);b.__decorate([g.property(),E.messageBundle("esri/widgets/Sketch/t9n/Sketch")],c.prototype,"messages",void 0);b.__decorate([g.property(),E.messageBundle("esri/t9n/common")],c.prototype,"messagesCommon",void 0);b.__decorate([g.property()],c.prototype,"snappingOptions",null);b.__decorate([g.property()],c.prototype,"state",null);b.__decorate([g.property()],c.prototype,"tooltipOptions",null);b.__decorate([g.property({readOnly:!0})],
c.prototype,"updateGraphics",null);b.__decorate([g.property()],c.prototype,"view",null);b.__decorate([g.property(),H.vmEvent(["create","update","undo","redo"])],c.prototype,"viewModel",null);b.__decorate([g.property({type:l,nonNullable:!0})],c.prototype,"visibleElements",void 0);b.__decorate([g.property()],c.prototype,"_effectiveAvailableCreateTools",null);return c=b.__decorate([u.subclass("esri.widgets.Sketch")],c)});