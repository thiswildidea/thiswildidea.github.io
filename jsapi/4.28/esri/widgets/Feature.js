// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.28/esri/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Feature/FeatureAttachments":function(){define("../../chunks/tslib.es6 ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../Attachments ../Widget ./FeatureAttachments/FeatureAttachmentsViewModel ./support/FeatureElementInfo ../support/widgetUtils ../support/jsxFactory".split(" "),function(c,p,g,z,K,F,E,H,M,C,u,a,f){z=class extends M{constructor(l,
h){super(l,h);this._featureElementInfo=null;this.attachmentsWidget=new H;this.headingLevel=2;this.viewModel=new C}initialize(){this._featureElementInfo=new u;this.addHandles([p.watch(()=>[this.viewModel?.description,this.viewModel?.title,this.headingLevel],()=>this._setupFeatureElementInfo(),p.initial),p.watch(()=>this.viewModel,l=>this.attachmentsWidget.viewModel=l,p.initial)])}destroy(){this.attachmentsWidget.viewModel=null;this.attachmentsWidget.destroy();this._featureElementInfo?.destroy()}get description(){return this.viewModel.description}set description(l){this.viewModel.description=
l}get displayType(){return this.attachmentsWidget.displayType}set displayType(l){this.attachmentsWidget.displayType=l}get graphic(){return this.viewModel.graphic}set graphic(l){this.viewModel.graphic=l}get title(){return this.viewModel.title}set title(l){this.viewModel.title=l}render(){const {attachmentsWidget:l}=this;return f.tsx("div",{class:"esri-feature-attachments"},this._featureElementInfo?.render(),l?.render())}_setupFeatureElementInfo(){const {description:l,title:h,headingLevel:k}=this;this._featureElementInfo?.set({description:l,
title:h,headingLevel:k})}};c.__decorate([g.property({readOnly:!0})],z.prototype,"attachmentsWidget",void 0);c.__decorate([g.property()],z.prototype,"description",null);c.__decorate([g.property()],z.prototype,"displayType",null);c.__decorate([g.property()],z.prototype,"graphic",null);c.__decorate([g.property()],z.prototype,"headingLevel",void 0);c.__decorate([g.property()],z.prototype,"title",null);c.__decorate([g.property({type:C})],z.prototype,"viewModel",void 0);return z=c.__decorate([E.subclass("esri.widgets.Feature.FeatureAttachments")],
z)})},"esri/widgets/Attachments":function(){define("require ../chunks/tslib.es6 ../core/Error ../core/reactiveUtils ../core/unitFormatUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./Widget ./Attachments/AttachmentsViewModel ./Attachments/support/attachmentUtils ./support/componentsUtils ./support/globalCss ./support/legacyIcon ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory".split(" "),
function(c,p,g,z,K,F,E,H,M,C,u,a,f,l,h,k,m,r,y){const q={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},I=window.CSS;H=class extends u{constructor(v,e){super(v,e);this.displayType="auto";this.selectedFile=this.messagesUnits=this.messages=null;this.submitting=!1;this.viewModel=null;this.visibleElements={...q};this._supportsImageOrientation=I&&I.supports&&I.supports("image-orientation","from-image");this._updateAttachmentForm=
this._addAttachmentForm=null}normalizeCtorArgs(v){v?.viewModel||(v={viewModel:new a,...v});return v}initialize(){this.addHandles([z.on(()=>this.viewModel?.attachmentInfos,"change",()=>this.scheduleRender()),z.on(()=>this.viewModel?.fileInfos,"change",()=>this.scheduleRender()),z.watch(()=>this.viewModel?.mode,()=>this._modeChanged(),z.initial)])}loadDependencies(){return l.loadCalciteComponents({icon:()=>new Promise((v,e)=>c(["../chunks/calcite-icon"],v,e))})}get capabilities(){return this.viewModel.capabilities}set capabilities(v){this.viewModel.capabilities=
v}get effectiveDisplayType(){const {displayType:v}=this;return v&&"auto"!==v?v:this.viewModel.supportsResizeAttachments?"preview":"list"}get graphic(){return this.viewModel.graphic}set graphic(v){this.viewModel.graphic=v}get label(){return this.messages?.widgetLabel??""}set label(v){this._overrideIfSome("label",v)}castVisibleElements(v){return{...q,...v}}addAttachment(){const {_addAttachmentForm:v,viewModel:e}=this;this._set("submitting",!0);this._set("error",null);return e.addAttachment(v).then(b=>
{this._set("submitting",!1);this._set("error",null);e.mode="view";return b}).catch(b=>{this._set("submitting",!1);this._set("error",new g("attachments:add-attachment",this.messages.addErrorMessage,b));throw b;})}deleteAttachment(v){const {viewModel:e}=this;this._set("submitting",!0);this._set("error",null);return e.deleteAttachment(v).then(b=>{this._set("submitting",!1);this._set("error",null);e.mode="view";return b}).catch(b=>{this._set("submitting",!1);this._set("error",new g("attachments:delete-attachment",
this.messages.deleteErrorMessage,b));throw b;})}updateAttachment(){const {viewModel:v}=this,{_updateAttachmentForm:e}=this;this._set("submitting",!0);this._set("error",null);return v.updateAttachment(e).then(b=>{this._set("submitting",!1);this._set("error",null);v.mode="view";return b}).catch(b=>{this._set("submitting",!1);this._set("error",new g("attachments:update-attachment",this.messages.updateErrorMessage,b));throw b;})}addFile(){const v=this.viewModel.addFile(this.selectedFile,this._addAttachmentForm);
this.viewModel.mode="view";return v}updateFile(){const {viewModel:v}=this,e=v.updateFile(this.selectedFile,this._updateAttachmentForm,v.activeFileInfo);v.mode="view";return e}deleteFile(v){v=this.viewModel.deleteFile(v||this.viewModel.activeFileInfo?.file);this.viewModel.mode="view";return v}render(){const {submitting:v,viewModel:e}=this,{state:b}=e;return y.tsx("div",{class:this.classes("esri-attachments",h.globalCss.widget)},v?this._renderProgressBar():null,"loading"===b?this._renderLoading():this._renderAttachments(),
this._renderErrorMessage())}_renderErrorMessage(){const {error:v,visibleElements:e}=this;return v&&e.errorMessage?y.tsx("div",{class:"esri-attachments__error-message",key:"error-message"},v.message):null}_renderAttachments(){const {activeFileInfo:v,mode:e,activeAttachmentInfo:b}=this.viewModel;return"add"===e?this._renderAddForm():"edit"===e?this._renderDetailsForm(b||v):this._renderAttachmentContainer()}_renderLoading(){return y.tsx("div",{class:"esri-attachments__loader-container",key:"loader"},
y.tsx("div",{class:"esri-attachments__loader"}))}_renderProgressBar(){return this.visibleElements.progressBar?y.tsx("div",{class:"esri-attachments__progress-bar",key:"progress-bar"}):null}_renderAddForm(){const {submitting:v,selectedFile:e}=this;var b=v||!e,d=this.visibleElements.cancelAddButton?y.tsx("button",{bind:this,class:this.classes(h.globalCss.button,h.globalCss.buttonTertiary,h.globalCss.buttonSmall,h.globalCss.buttonHalf,v&&h.globalCss.buttonDisabled),disabled:v,onclick:this._cancelForm,
type:"button"},this.messages.cancel):null;b=this.visibleElements.addSubmitButton?y.tsx("button",{class:this.classes(h.globalCss.button,h.globalCss.buttonSecondary,h.globalCss.buttonSmall,h.globalCss.buttonHalf,{[h.globalCss.buttonDisabled]:b}),disabled:b,type:"submit"},this.messages.add):null;const w=e?y.tsx("span",{class:"esri-attachments__file-name",key:"file-name"},e.name):null;d=y.tsx("form",{afterCreate:m.storeNode,afterRemoved:m.discardNode,bind:this,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},
y.tsx("fieldset",{class:"esri-attachments__file-fieldset"},w,y.tsx("label",{class:this.classes("esri-attachments__file-label",h.globalCss.button,h.globalCss.buttonSecondary)},e?this.messages.changeFile:this.messages.selectFile,y.tsx("input",{bind:this,class:"esri-attachments__file-input",name:"attachment",onchange:this._handleFileInputChange,type:"file"}))),b,d);return y.tsx("div",{class:"esri-attachments__form-node",key:"add-form-container"},d)}_renderDetailsForm(v){const {visibleElements:e,viewModel:b,
selectedFile:d,submitting:w}=this;var {capabilities:G}=b,n=w||!d;let B;if(d){var x=d.type;B=d.name;var A=d.size}else if(v&&"file"in v)x=v.file.type,B=v.file.name,A=v.file.size;else if(v&&"contentType"in v){x=v.contentType;B=v.name;A=v.size;var L=v.url}var O=G.editing&&G.operations?.delete&&e.deleteButton?y.tsx("button",{bind:this,class:this.classes(h.globalCss.button,h.globalCss.buttonSmall,h.globalCss.buttonTertiary,"esri-attachments__delete-button",{[h.globalCss.buttonDisabled]:w}),disabled:w,key:"delete-button",
onclick:Q=>this._submitDeleteAttachment(Q,v),type:"button"},this.messages.delete):void 0;n=G.editing&&G.operations?.update&&e.updateButton?y.tsx("button",{class:this.classes(h.globalCss.button,h.globalCss.buttonSmall,h.globalCss.buttonThird,{[h.globalCss.buttonDisabled]:n}),disabled:n,key:"update-button",type:"submit"},this.messages.update):void 0;const N=this.visibleElements.cancelUpdateButton?y.tsx("button",{bind:this,class:this.classes(h.globalCss.button,h.globalCss.buttonSmall,h.globalCss.buttonTertiary,
h.globalCss.buttonThird,{[h.globalCss.buttonDisabled]:w}),disabled:w,key:"cancel-button",onclick:this._cancelForm,type:"button"},this.messages.cancel):void 0;G=G.editing&&G.operations?.update?y.tsx("fieldset",{class:"esri-attachments__file-fieldset",key:"file"},y.tsx("span",{class:"esri-attachments__file-name",key:"file-name"},B),y.tsx("label",{class:this.classes("esri-attachments__file-label",h.globalCss.button,h.globalCss.buttonSecondary)},this.messages.changeFile,y.tsx("input",{bind:this,class:"esri-attachments__file-input",
name:"attachment",onchange:this._handleFileInputChange,type:"file"}))):void 0;A=y.tsx("fieldset",{class:"esri-attachments__metadata-fieldset",key:"size"},y.tsx("label",null,K.formatFileSize(this.messagesUnits,A??0)));x=y.tsx("fieldset",{class:"esri-attachments__metadata-fieldset",key:"content-type"},y.tsx("label",null,x));L=null!=L?y.tsx("a",{class:"esri-attachments__item-link",href:L,rel:"noreferrer",target:"_blank"},this._renderImageMask(v,400),y.tsx("div",{class:"esri-attachments__item-link-overlay"},
y.tsx("span",{class:"esri-attachments__item-link-overlay-icon"},y.tsx("calcite-icon",{icon:"launch"})))):this._renderImageMask(v,400);O=y.tsx("form",{afterCreate:m.storeNode,afterRemoved:m.discardNode,bind:this,"data-node-ref":"_updateAttachmentForm",onsubmit:Q=>this._submitUpdateAttachment(Q,v)},y.tsx("div",{class:"esri-attachments__metadata"},A,x),G,y.tsx("div",{class:"esri-attachments__actions"},O,N,n));return y.tsx("div",{class:"esri-attachments__form-node",key:"edit-form-container"},L,O)}_renderImageMask(v,
e){return v?"file"in v?this._renderGenericImageMask(v.file.name,v.file.type):this._renderImageMaskForAttachment(v,e):null}_renderGenericImageMask(v,e){var {supportsResizeAttachments:b}=this.viewModel;e=f.getIconPath(e);b={["esri-attachments__image--resizable"]:b};return y.tsx("div",{class:this.classes("esri-attachments__item-mask--icon","esri-attachments__item-mask"),key:e},y.tsx("img",{alt:v,class:this.classes(b,"esri-attachments__image"),src:e,title:v}))}_renderImageMaskForAttachment(v,e){var {supportsResizeAttachments:b}=
this.viewModel;if(!v)return null;const {contentType:d,name:w,url:G}=v;if(!b||!f.isSupportedImage(d))return this._renderGenericImageMask(w,d);v=(v=this._getCSSTransform(v))?{transform:v,"image-orientation":"none"}:{};e=`${G}${G?.includes("?")?"\x26":"?"}w=${e}`;b={["esri-attachments__image--resizable"]:b};return y.tsx("div",{class:this.classes("esri-attachments__item-mask"),key:e},y.tsx("img",{alt:w,class:this.classes(b,"esri-attachments__image"),src:e,styles:v,title:w}))}_renderFile(v){const {file:e}=
v;return y.tsx("li",{class:"esri-attachments__item",key:e},y.tsx("button",{"aria-label":this.messages.attachmentDetails,bind:this,class:"esri-attachments__item-button",key:"details-button",onclick:()=>this._startEditFile(v),title:this.messages.attachmentDetails,type:"button"},this._renderImageMask(v),y.tsx("label",{class:"esri-attachments__label"},y.tsx("span",{class:"esri-attachments__filename"},e.name||this.messages.noTitle),y.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-chevron-icon",
m.isRTL(this.container)?k.legacyIcon.left:k.legacyIcon.right)}))))}_renderAttachmentInfo({attachmentInfo:v,displayType:e}){const {viewModel:b,effectiveDisplayType:d}=this,{capabilities:w,supportsResizeAttachments:G}=b,{contentType:n,name:B,url:x}=v;e=this._renderImageMask(v,"list"===e?48:400);var A=w.editing?y.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-chevron-icon",m.isRTL(this.container)?k.legacyIcon.left:k.legacyIcon.right)}):null;A="preview"===d&&G&&f.isSupportedImage(n)?
null:y.tsx("label",{class:"esri-attachments__label"},y.tsx("span",{class:"esri-attachments__filename"},B||this.messages.noTitle),A);e=[e,A];e=w.editing?y.tsx("button",{"aria-label":this.messages.attachmentDetails,bind:this,class:"esri-attachments__item-button","data-attachment-info-id":v.id,key:"details-button",onclick:()=>this._startEditAttachment(v),title:this.messages.attachmentDetails,type:"button"},e):y.tsx("a",{class:"esri-attachments__item-button",href:x??void 0,key:"details-link",target:"_blank"},
e);return y.tsx("li",{class:"esri-attachments__item",key:v},e)}_renderAttachmentContainer(){const {effectiveDisplayType:v,viewModel:e,visibleElements:b}=this,{attachmentInfos:d,capabilities:w,fileInfos:G}=e;var n=!!d?.length;const B=!!G?.length,x={["esri-attachments__container--list"]:"preview"!==v,["esri-attachments__container--preview"]:"preview"===v},A=w.editing&&w.operations?.add&&b.addButton?y.tsx("button",{bind:this,class:this.classes(h.globalCss.button,h.globalCss.buttonTertiary,"esri-attachments__add-attachment-button"),
onclick:()=>this._startAddAttachment(),type:"button"},y.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-add-icon",k.legacyIcon.plus)}),this.messages.add):void 0,L=n?y.tsx("ul",{class:"esri-attachments__items",key:"attachments-list"},d.toArray().map(N=>this._renderAttachmentInfo({attachmentInfo:N,displayType:v}))):void 0,O=B?y.tsx("ul",{class:"esri-attachments__items",key:"file-list"},G.toArray().map(N=>this._renderFile(N))):void 0;n=B||n?void 0:y.tsx("div",{class:h.globalCss.empty},
this.messages.noAttachments);return y.tsx("div",{class:this.classes("esri-attachments__container",x),key:"attachments-container"},L,O,n,A)}_modeChanged(){this._set("error",null);this._set("selectedFile",null)}_handleFileInputChange(v){v=v.target.files?.item(0);this._set("selectedFile",v)}_submitDeleteAttachment(v,e){v.preventDefault();e&&("file"in e?this.deleteFile(e.file):e&&this.deleteAttachment(e))}_submitAddAttachment(v){v.preventDefault();this.viewModel.filesEnabled?this.addFile():this.addAttachment()}_submitUpdateAttachment(v,
e){v.preventDefault();e&&"file"in e?this.updateFile():this.updateAttachment()}_startEditAttachment(v){const {viewModel:e}=this;e.activeFileInfo=null;e.activeAttachmentInfo=v;e.mode="edit"}_startEditFile(v){const {viewModel:e}=this;e.activeAttachmentInfo=null;e.activeFileInfo=v;e.mode="edit"}_startAddAttachment(){this.viewModel.mode="add"}_cancelForm(v){v.preventDefault();this.viewModel.mode="view"}_getCSSTransform(v){({orientationInfo:v}=v);return!this._supportsImageOrientation&&v?[v.rotation?`rotate(${v.rotation}deg)`:
"",v.mirrored?"scaleX(-1)":""].join(" "):""}};p.__decorate([F.property()],H.prototype,"capabilities",null);p.__decorate([F.property()],H.prototype,"displayType",void 0);p.__decorate([F.property({readOnly:!0})],H.prototype,"effectiveDisplayType",null);p.__decorate([F.property()],H.prototype,"graphic",null);p.__decorate([F.property()],H.prototype,"label",null);p.__decorate([F.property(),r.messageBundle("esri/widgets/Attachments/t9n/Attachments")],H.prototype,"messages",void 0);p.__decorate([F.property(),
r.messageBundle("esri/core/t9n/Units")],H.prototype,"messagesUnits",void 0);p.__decorate([F.property({readOnly:!0})],H.prototype,"selectedFile",void 0);p.__decorate([F.property({readOnly:!0})],H.prototype,"submitting",void 0);p.__decorate([F.property({readOnly:!0})],H.prototype,"error",void 0);p.__decorate([F.property({type:a})],H.prototype,"viewModel",void 0);p.__decorate([F.property()],H.prototype,"visibleElements",void 0);p.__decorate([E.cast("visibleElements")],H.prototype,"castVisibleElements",
null);return H=p.__decorate([C.subclass("esri.widgets.Attachments")],H)})},"esri/core/unitFormatUtils":function(){define("exports ./ByteSizeUnit ./Cyclical ./mathUtils ./quantityUtils ./string ./unitUtils ../intl/number".split(" "),function(c,p,g,z,K,F,E,H){function M(h,k,m){return h.units[k][m]}function C(h,k,m,r=2,y="abbr"){return`${H.formatNumber(k,{minimumFractionDigits:r,maximumFractionDigits:r,signDisplay:0<k?"never":"exceptZero"})} ${M(h,m,y)}`}function u(h,k,m,r=2,y="abbr"){return`${H.formatNumber(k,
{minimumFractionDigits:r,maximumFractionDigits:r,signDisplay:"exceptZero"})} ${M(h,m,y)}`}function a(h,k){const m=JSON.stringify(k);let r=f.get(m);r||(r=new Intl.NumberFormat("en-US",k),f.set(m,r));return/\-?\+?360/.test(r.format(h))?0:h}const f=new Map,l=["B","kB","MB","GB","TB"];c.formatAngleDegrees=function(h,k,m,r,y){y=y??2;h=g.cyclicalDegrees.normalize(K.convertRotationType(E.convertUnit(h,k,"degrees"),m,r),0,!0);y={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:y,minimumFractionDigits:y,
signDisplay:0<h?"never":"exceptZero"};h=a(h,y);return H.formatNumber(h,y)};c.formatDMS=function(h,k,m=2){h=E.convertUnit(h,k,"degrees");k=h-Math.floor(h);h-=k;k*=60;let r=k-Math.floor(k);k-=r;r*=60;return`${h.toFixed()}\u00b0 ${k.toFixed()}' ${r.toFixed(m)}"`};c.formatDecimal=C;c.formatFileSize=function(h,k){k=Math.round(k);let m=0===k?0:Math.floor(Math.log(k)/Math.log(p.ByteSizeUnit.KILOBYTES));m=z.clamp(m,0,l.length-1);k=H.formatNumber(k/p.ByteSizeUnit.KILOBYTES**m,{maximumFractionDigits:2});return F.replace(h.units.bytes[l[m]],
{fileSize:k})};c.formatImperialArea=function(h,k,m,r=2,y="abbr"){const q=E.adaptiveImperialAreaUnit(k,m);return C(h,E.convertUnit(k,m,q),q,r,y)};c.formatImperialLength=function(h,k,m,r=2,y="abbr"){const q=E.adaptiveImperialLengthUnit(k,m);return C(h,E.convertUnit(k,m,q),q,r,y)};c.formatImperialRelativeLength=function(h,k,m,r=2,y="abbr"){const q=E.adaptiveImperialLengthUnit(k,m);return u(h,E.convertUnit(k,m,q),q,r,y)};c.formatImperialRelativeVerticalLength=function(h,k,m,r=2,y="abbr"){const q=E.adaptiveImperialVerticalLengthUnit(k,
m);return u(h,E.convertUnit(k,m,q),q,r,y)};c.formatImperialVerticalLength=function(h,k,m,r=2,y="abbr"){const q=E.adaptiveImperialVerticalLengthUnit(k,m);return C(h,E.convertUnit(k,m,q),q,r,y)};c.formatMetricArea=function(h,k,m,r=2,y="abbr"){const q=E.adaptiveMetricAreaUnit(k,m);return C(h,E.convertUnit(k,m,q),q,r,y)};c.formatMetricLength=function(h,k,m,r=2,y="abbr"){const q=E.adaptiveMetricLengthUnit(k,m);return C(h,E.convertUnit(k,m,q),q,r,y)};c.formatMetricRelativeLength=function(h,k,m,r=2,y="abbr"){const q=
E.adaptiveMetricLengthUnit(k,m);return u(h,E.convertUnit(k,m,q),q,r,y)};c.formatMetricRelativeVerticalLength=function(h,k,m,r=2,y="abbr"){const q=E.adaptiveMetricVerticalLengthUnit(k,m);return u(h,E.convertUnit(k,m,q),q,r,y)};c.formatMetricVerticalLength=function(h,k,m,r=2,y="abbr"){const q=E.adaptiveMetricVerticalLengthUnit(k,m);return C(h,E.convertUnit(k,m,q),q,r,y)};c.formatRelativeAngleDegrees=function(h,k,m,r,y){m!==r&&(h=-h);y=y??2;m={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:y,
minimumFractionDigits:y,signDisplay:"exceptZero"};h=E.convertUnit(h,k,"degrees")%360;h=a(h,m);return H.formatNumber(h,m)};c.formatRelativeDecimal=u;c.unitName=M;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/core/ByteSizeUnit":function(){define(["exports"],function(c){c.ByteSizeUnit=void 0;var p=c.ByteSizeUnit||(c.ByteSizeUnit={});p[p.KILOBYTES=1024]="KILOBYTES";p[p.MEGABYTES=1048576]="MEGABYTES";p[p.GIGABYTES=1073741824]="GIGABYTES";Object.defineProperty(c,Symbol.toStringTag,
{value:"Module"})})},"esri/core/quantityUtils":function(){define(["exports","./unitUtils"],function(c,p){function g(f,l){return{type:p.unitType(l),value:f,unit:l}}function z(f,l){return{type:p.unitType(l),value:f,unit:l}}function K(f,l){return{type:p.unitType(l),value:f,unit:l}}function F(f,l,h="arithmetic"){return{type:p.unitType(l),value:f,unit:l,rotationType:h}}function E(f,l){const h=H(f,l);return"angle"===f.type?F(h,l,f.rotationType):g(h,l)}function H(f,l){return p.convertUnit(f.value,f.unit,
l)}const M=z(0,"meters"),C=K(0,"square-meters"),u=F(0,"radians"),a=F(0,"degrees");c.convertRotationType=function(f,l,h){if(l===h)return f;switch(h){case "arithmetic":case "geographic":return-f+90}};c.createAngle=F;c.createArea=K;c.createLength=z;c.createQuantity=g;c.createVolume=function(f,l){return{type:p.unitType(l),value:f,unit:l}};c.isBaseUnit=function(f){return p.isBaseUnit(f.unit)};c.max=function(f,l){return null==f?l:null==l?f:f.value>p.convertUnit(l.value,l.unit,f.unit)?f:l};c.min=function(f,
l){return null==f?l:null==l?f:f.value<p.convertUnit(l.value,l.unit,f.unit)?f:l};c.scale=function(f,l){return null==f?null:{...f,value:f.value*l}};c.toBaseUnit=function(f){return E(f,p.baseUnitForUnit(f.unit))};c.toUnit=E;c.valueInUnit=H;c.zeroDegrees=a;c.zeroMeters=M;c.zeroRadians=u;c.zeroSquareMeters=C;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Attachments/AttachmentsViewModel":function(){define("../../chunks/tslib.es6 ../../Graphic ../../core/Accessor ../../core/Collection ../../core/Error ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../rest/query/support/AttachmentInfo ../../rest/support/AttachmentQuery ../Feature/support/featureUtils".split(" "),
function(c,p,g,z,K,F,E,H,M,C,u,a,f,l){const h={editing:!1,operations:{add:!0,update:!0,delete:!0}},k=z.ofType(a);g=class extends g{constructor(m){super(m);this._attachmentLayer=this._getAttachmentsPromise=null;this.capabilities={...h};this.activeFileInfo=this.activeAttachmentInfo=null;this.attachmentInfos=new k;this.fileInfos=new z;this.graphic=null;this.mode="view";this.filesEnabled=!1;this.addHandles(F.watch(()=>this.graphic,()=>this._graphicChanged(),F.initial))}destroy(){this.graphic=this._attachmentLayer=
null}castCapabilities(m){return{...h,...m}}get state(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}get supportsResizeAttachments(){var {graphic:m}=this;if(!m)return!1;m=m.layer||m.sourceLayer;return m?.loaded&&"capabilities"in m&&m.capabilities&&"operations"in m.capabilities&&"supportsResizeAttachments"in m.capabilities.operations&&m.capabilities.operations.supportsResizeAttachments||!1}async getAttachments(){const {_attachmentLayer:m,attachmentInfos:r}=this;if(!m||
"function"!==typeof m.queryAttachments)throw new K("invalid-layer","getAttachments(): A valid layer is required.");const y=this._getObjectId();var q=new f({objectIds:[y],returnMetadata:!0});const I=[];this._getAttachmentsPromise=q=m.queryAttachments(q).then(v=>v[y]||I).catch(()=>I);this.notifyChange("state");q=await q;r.removeAll();q.length&&r.addMany(q);this._getAttachmentsPromise=null;this.notifyChange("state");return q}async addAttachment(m,r=this.graphic){const {_attachmentLayer:y,attachmentInfos:q,
capabilities:I}=this;if(!r)throw new K("invalid-graphic","addAttachment(): A valid graphic is required.",{graphic:r});if(!m)throw new K("invalid-attachment","addAttachment(): An attachment is required.",{attachment:m});if(!I.operations?.add)throw new K("invalid-capabilities","addAttachment(): add capabilities are required.");if(!y||"function"!==typeof y.addAttachment)throw new K("invalid-layer","addAttachment(): A valid layer is required.");m=await y.addAttachment(r,m).then(v=>this._queryAttachment(v.objectId,
r));q.add(m);return m}async deleteAttachment(m){const {_attachmentLayer:r,attachmentInfos:y,graphic:q,capabilities:I}=this;if(!m)throw new K("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:m});if(!I.operations?.delete)throw new K("invalid-capabilities","deleteAttachment(): delete capabilities are required.");if(!r||"function"!==typeof r.deleteAttachments)throw new K("invalid-layer","deleteAttachment(): A valid layer is required.");if(!q)throw new K("invalid-graphic",
"deleteAttachment(): A graphic is required.");const v=await r.deleteAttachments(q,[m.id]).then(()=>m);y.remove(v);return v}async updateAttachment(m,r=this.activeAttachmentInfo){const {_attachmentLayer:y,attachmentInfos:q,graphic:I,capabilities:v}=this;if(!m)throw new K("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:m});if(!r)throw new K("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:r});if(!v.operations?.update)throw new K("invalid-capabilities",
"updateAttachment(): Update capabilities are required.");const e=q.indexOf(r);if(!y||"function"!==typeof y.updateAttachment)throw new K("invalid-layer","updateAttachment(): A valid layer is required.");if(!I)throw new K("invalid-graphic","updateAttachment(): A graphic is required.");m=await y.updateAttachment(I,r.id,m).then(b=>this._queryAttachment(b.objectId));q.splice(e,1,m);return m}async commitFiles(){await Promise.all(this.fileInfos.items.map(m=>this.addAttachment(m.form)));this.fileInfos.removeAll();
return this.getAttachments()}addFile(m,r){if(!m||!r)return null;m={file:m,form:r};this.fileInfos.add(m);return m}updateFile(m,r,y=this.activeFileInfo){if(!m||!r||!y)return null;y=this.fileInfos.indexOf(y);-1<y&&this.fileInfos.splice(y,1,{file:m,form:r});return this.fileInfos.items[y]}deleteFile(m){const r=this.fileInfos.find(y=>y.file===m);return r?(this.fileInfos.remove(r),r):null}async _queryAttachment(m,r){const {_attachmentLayer:y}=this;if(!m||!y?.queryAttachments)throw new K("invalid-attachment-id",
"Could not query attachment.");const q=this._getObjectId(r);m=new f({objectIds:[q],attachmentsWhere:`AttachmentId=${m}`,returnMetadata:!0});return y.queryAttachments(m).then(I=>I[q][0])}_getObjectId(m=this.graphic){return m?.getObjectId()??null}_graphicChanged(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch(()=>{}))}_setAttachmentLayer(){var {graphic:m}=this;this._attachmentLayer=(m=l.getSourceLayer(m))?"scene"===m.type&&null!=m.associatedLayer?m.associatedLayer:m:null}};c.__decorate([E.property()],
g.prototype,"capabilities",void 0);c.__decorate([H.cast("capabilities")],g.prototype,"castCapabilities",null);c.__decorate([E.property()],g.prototype,"activeAttachmentInfo",void 0);c.__decorate([E.property()],g.prototype,"activeFileInfo",void 0);c.__decorate([E.property({readOnly:!0,type:k})],g.prototype,"attachmentInfos",void 0);c.__decorate([E.property()],g.prototype,"fileInfos",void 0);c.__decorate([E.property({type:p})],g.prototype,"graphic",void 0);c.__decorate([E.property()],g.prototype,"mode",
void 0);c.__decorate([E.property({readOnly:!0})],g.prototype,"state",null);c.__decorate([E.property()],g.prototype,"filesEnabled",void 0);c.__decorate([E.property({readOnly:!0})],g.prototype,"supportsResizeAttachments",null);return g=c.__decorate([u.subclass("esri.widgets.Attachments.AttachmentsViewModel")],g)})},"esri/rest/query/support/AttachmentInfo":function(){define("../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../layers/support/exifUtils".split(" "),
function(c,p,g,z,K,F,E,H){var M;const C={1:{id:1,rotation:0,mirrored:!1},2:{id:2,rotation:0,mirrored:!0},3:{id:3,rotation:180,mirrored:!1},4:{id:4,rotation:180,mirrored:!0},5:{id:5,rotation:-90,mirrored:!0},6:{id:6,rotation:90,mirrored:!1},7:{id:7,rotation:90,mirrored:!0},8:{id:8,rotation:-90,mirrored:!1}};p=M=class extends p.JSONSupport{constructor(u){super(u);this.url=this.size=this.parentObjectId=this.parentGlobalId=this.name=this.keywords=this.globalId=this.id=this.exifInfo=this.contentType=null}get orientationInfo(){var {exifInfo:u}=
this;u=H.getExifValue({exifName:"Exif IFD0",tagName:"Orientation",exifInfo:u});return C[u]||null}clone(){return new M({contentType:this.contentType,exifInfo:this.exifInfo,id:this.id,globalId:this.globalId,keywords:this.keywords,name:this.name,parentGlobalId:this.parentGlobalId,parentObjectId:this.parentObjectId,size:this.size,url:this.url})}};c.__decorate([g.property({type:String})],p.prototype,"contentType",void 0);c.__decorate([g.property()],p.prototype,"exifInfo",void 0);c.__decorate([g.property({readOnly:!0})],
p.prototype,"orientationInfo",null);c.__decorate([g.property({type:z.Integer})],p.prototype,"id",void 0);c.__decorate([g.property({type:String})],p.prototype,"globalId",void 0);c.__decorate([g.property({type:String})],p.prototype,"keywords",void 0);c.__decorate([g.property({type:String})],p.prototype,"name",void 0);c.__decorate([g.property({json:{read:!1}})],p.prototype,"parentGlobalId",void 0);c.__decorate([g.property({json:{read:!1}})],p.prototype,"parentObjectId",void 0);c.__decorate([g.property({type:z.Integer})],
p.prototype,"size",void 0);c.__decorate([g.property({json:{read:!1}})],p.prototype,"url",void 0);return p=M=c.__decorate([E.subclass("esri.layers.support.AttachmentInfo")],p)})},"esri/layers/support/exifUtils":function(){define(["exports"],function(c){function p(g){const {tagName:z,tags:K}=g;return K&&z?K.find(F=>F.name===z)?.value||null:null}c.getExifValue=function(g){const {exifInfo:z,exifName:K,tagName:F}=g;return z&&K&&F?(g=z.find(E=>E.name===K))?p({tagName:F,tags:g.tags}):null:null};Object.defineProperty(c,
Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/support/featureUtils":function(){define("exports ../../../core/Logger ../../../core/string ../../../intl/date ../../../intl/number ../../../layers/support/fieldUtils ../../../layers/support/layerUtils ../../../smartMapping/support/utils ../../../support/arcadeOnDemand ../../../time/timeZoneUtils".split(" "),function(c,p,g,z,K,F,E,H,M,C){function u(t){return t?aa.test(t):!1}function a(t,D){if(!u(D)||!t)return null;const J=D.replace(aa,"").toLowerCase();
let P=null;t.some(R=>R.name.toLowerCase()===J?(P=R,!0):!1);return P}function f(t,D){return(D=l(D,t))?D.name:t}function l(t,D){return t&&"function"===typeof t.getField&&D?t.getField(D)??null:null}function h({formattedAttributes:t,template:D,fieldInfoMap:J}){return`${g.replace(g.replace(D,P=>`{${J.get(P.toLowerCase())?.fieldName||P}}`),t).replaceAll(V,"")}`.trim()}function k(t,D,J=!1){const P=D[t];"string"===typeof P&&(J=(J?encodeURIComponent(P):P).replaceAll(Y,"%27"),D[t]=J)}function m(t,D=!1){const J=
{...t};Object.keys(J).forEach(P=>k(P,J,D));return J}function r(t,D){return t.replaceAll(ba,(J,P,R)=>(J=l(D,R))?`{${J.name}}`:P)}function y(t,D,J){return(t=r(t,J))?t.replaceAll(ia,(P,R,W)=>{R=`${R||W}`.trim();return g.replace(P,m(D,R&&"{"!==R[0]||!1))}):t}function q(t){return null!=t&&"object"===typeof t&&"fieldsIndex"in t&&"geometryType"in t&&"getField"in t&&"load"in t&&"loaded"in t&&"objectIdField"in t&&"spatialReference"in t&&"type"in t&&("feature"===t.type||"scene"===t.type)&&"when"in t}function I(t){return null!=
t&&"object"===typeof t&&"createQuery"in t&&"queryFeatureCount"in t&&"queryObjectIds"in t&&"queryRelatedFeatures"in t&&"queryRelatedFeaturesCount"in t&&"relationships"in t}function v(t){return q(t)&&I(t)}function e(t,D){const {fieldInfos:J,fieldName:P,preventPlacesFormatting:R,layer:W,timeZone:Z}=D;D=d(J,P);var X=l(W,P);if(D&&!F.isRasterPixelValueField(P)){X=X?.type;const ca=D.format?.dateFormat;if("date"===X||"date-only"===X||"time-only"===X||"timestamp-offset"===X||ca)return H.formatAnyDate(t,{format:ca,
fieldType:X,timeZoneOptions:{layerTimeZone:W&&"preferredTimeZone"in W?W.preferredTimeZone:null,viewTimeZone:Z,datesInUnknownTimezone:W&&"datesInUnknownTimezone"in W?!!W.datesInUnknownTimezone:!1}})}D=D?.format;if("string"===typeof t&&F.isRasterPixelValueField(P)&&D)return t=t.trim(),/\d{2}-\d{2}/.test(t)?t:t.includes(",")?b(t,",",", ",D):t.includes(";")?b(t,";","; ",D):t.includes(" ")?b(t," "," ",D):K.formatNumber(Number(t),K.convertNumberFormatToIntlOptions(D));"string"!==typeof t||!D||null!=D.dateFormat||
null==D.places&&null==D.digitSeparator||(X=Number(t),isNaN(X)||(t=X));return"string"===typeof t||null==t||null==D?n(t):R?K.formatNumber(t,{...K.convertNumberFormatToIntlOptions(D),minimumFractionDigits:0,maximumFractionDigits:20}):K.formatNumber(t,K.convertNumberFormatToIntlOptions(D))}function b(t,D,J,P){return t.trim().split(D).map(R=>K.formatNumber(Number(R),K.convertNumberFormatToIntlOptions(P))).join(J)}function d(t,D){if(t?.length&&D)return t.find(J=>J.fieldName?.toLowerCase()===D.toLowerCase())}
function w({fieldName:t,graphic:D,layer:J}){if(L(t)||!J||"function"!==typeof J.getFeatureType)return null;const {typeIdField:P}=J;return P&&t===P?(t=J.getFeatureType(D))?t.name:null:null}function G({fieldName:t,value:D,graphic:J,layer:P}){return L(t)||!P||"function"!==typeof P.getFieldDomain?null:(t=J&&P.getFieldDomain(t,{feature:J}))&&"coded-value"===t.type?t.getName(D):null}function n(t){return"string"===typeof t?t.replaceAll(da,'\x3cbr class\x3d"esri-text-new-line" /\x3e'):t}function B(t){const {value:D,
fieldName:J,fieldInfos:P,fieldInfoMap:R,layer:W,graphic:Z,timeZone:X}=t;return null==D?"":(t=G({fieldName:J,value:D,graphic:Z,layer:W}))||(t=w({fieldName:J,graphic:Z,layer:W}))?t:R.get(J.toLowerCase())?e(D,{fieldInfos:P||Array.from(R.values()),fieldName:J,layer:W,timeZone:X}):(t=W?.fieldsIndex?.get(J))&&(H.isAnyDateField(t)||F.isTimeOnlyField(t))?H.formatAnyDate(D,{fieldType:t.type,timeZoneOptions:{layerTimeZone:W&&"preferredTimeZone"in W?W.preferredTimeZone:null,viewTimeZone:X,datesInUnknownTimezone:W&&
"datesInUnknownTimezone"in W?!!W.datesInUnknownTimezone:!1}}):n(D)}async function x(t,D){const {layer:J,graphic:P,outFields:R,objectIds:W,returnGeometry:Z,spatialReference:X}=t;t=W[0];if("number"!==typeof t&&"string"!==typeof t)return U.warn("Could not query required fields for the specified feature. The feature's ID is invalid.",{layer:J,graphic:P,objectId:t,requiredFields:R}),null;if(!E.getEffectiveLayerCapabilities(J)?.operations?.supportsQuery)return U.warn("The specified layer cannot be queried. The following fields will not be available.",
{layer:J,graphic:P,requiredFields:R,returnGeometry:Z}),null;t=J.createQuery();t.objectIds=W;t.outFields=R?.length?R:[J.objectIdField];t.returnGeometry=!!Z;t.returnZ=!!Z;t.returnM=!!Z;t.outSpatialReference=X;return(await J.queryFeatures(t,D)).features[0]}async function A(t){if(!t.expressionInfos?.length)return!1;var D=await M.loadArcade();({arcadeUtils:{hasGeometryFunctions:D}}=D);return D(t)}function L(t=""){return t?t.includes("relationships/"):!1}function O({attributes:t,graphic:D,relatedInfo:J,
fieldInfos:P,fieldInfoMap:R,layer:W,timeZone:Z}){t&&D&&J&&Object.keys(D.attributes).forEach(X=>{var ca=(ca={layerId:J.relation.id.toString(),fieldName:X},`${"relationships/"}${ca.layerId}/${ca.fieldName}`);t[ca]=B({fieldName:ca,fieldInfos:P,fieldInfoMap:R,layer:W,value:D.attributes[X],graphic:D,timeZone:Z})})}function N({attributes:t,relatedInfo:D,fieldInfoMap:J,fieldInfos:P,layer:R,timeZone:W}){t&&D&&(D.relatedFeatures?.forEach(Z=>O({attributes:t,graphic:Z,relatedInfo:D,fieldInfoMap:J,fieldInfos:P,
layer:R,timeZone:W})),D.relatedStatsFeatures?.forEach(Z=>O({attributes:t,graphic:Z,relatedInfo:D,fieldInfoMap:J,fieldInfos:P,layer:R,timeZone:W})))}function Q(t,D,J){const P="scene"===D.type&&D.associatedLayer?D.associatedLayer.url:D.url;return t.filter(v).find(R=>R!==D&&R.url===P&&R.layerId===J.relatedTableId)}const U=p.getLogger("esri.widgets.Feature.support.featureUtils"),V=/href=(""|'')/gi,ba=/(\{([^\{\r\n]+)\})/g,Y=/'/g,aa=/^\s*expression\//i,da=/(\n)/gi,ja=/[\u00A0-\u9999<>&]/gim,ia=/href\s*=\s*(?:"([^"]+)"|'([^']+)')/gi,
fa=/^(?:mailto:|tel:)/,ea=z.convertDateFormatToIntlOptions("short-date-short-time"),T=t=>{if(!t)return!1;t=t.toUpperCase();return t.includes("CURRENT_TIMESTAMP")||t.includes("CURRENT_DATE")||t.includes("CURRENT_TIME")},S=({layer:t,method:D,query:J,definitionExpression:P})=>{t.capabilities?.query?.supportsCacheHint&&"attachments"!==D&&(t=null!=J.where?J.where:null,D=null!=J.geometry?J.geometry:null,T(P)||T(t)||"extent"===D?.type||"tile"===J.resultType||(J.cacheHint=!0))};c.applyTextFormattingHTML=
n;c.createfieldInfoMap=function(t,D){const J=new Map;if(!t)return J;t.forEach(P=>{const R=f(P.fieldName,D);P.fieldName=R;J.set(R.toLowerCase(),P)});return J};c.findRelatedLayer=function(t,D,J){return t&&D&&J?Q(t.allLayers,D,J)||Q(t.allTables,D,J):null};c.fixTokens=r;c.formatAttributes=function({fieldInfos:t,attributes:D,layer:J,graphic:P,fieldInfoMap:R,relatedInfos:W,timeZone:Z}){const X={};W?.forEach(ca=>N({attributes:X,relatedInfo:ca,fieldInfoMap:R,fieldInfos:t,layer:J,timeZone:Z}));D&&Object.keys(D).forEach(ca=>
{X[ca]=B({fieldName:ca,fieldInfos:t,fieldInfoMap:R,layer:J,value:D[ca],graphic:P,timeZone:Z})});return X};c.formatEditInfo=function(t,D,J,P){const {creatorField:R,creationDateField:W,editorField:Z,editDateField:X}=t;if(D){t=C.getTimeZoneFormattingOptions(P&&"preferredTimeZone"in P?P.preferredTimeZone:null,P&&"datesInUnknownTimezone"in P?!!P.datesInUnknownTimezone:!1,J,ea,"date");t={...ea,...t};J=D[X];if("number"===typeof J)return D=D[Z],{type:"edit",date:z.formatDate(J,t),user:D};J=D[W];return"number"===
typeof J?(D=D[R],{type:"create",date:z.formatDate(J,t),user:D}):null}};c.formatValueToFieldInfo=e;c.getAllFieldInfos=function(t){const D=[];if(!t)return D;const {fieldInfos:J,content:P}=t;J&&D.push(...J);if(!P||!Array.isArray(P))return D;P.forEach(R=>{"fields"===R.type&&(R=R?.fieldInfos)&&D.push(...R)});return D};c.getFieldInfo=d;c.getFieldInfoLabel=function(t,D){return(D=a(D,t?.fieldName))?D.title||null:t?t.label||t.fieldName:null};c.getFixedFieldName=f;c.getFixedFieldNames=function(t,D){return t&&
t.map(J=>f(J,D))};c.getHighlightKeyForFeature=function(t){const D=t.getObjectId();return null!=D?`oid:${D}`:`uid:${t.uid}`};c.getSourceLayer=function(t){if(null!=t)return(t.sourceLayer||t.layer)??void 0};c.graphicCallback=async function(t,D){return"function"===typeof t?t(D):t};c.htmlEntities=function(t){return t.replaceAll(ja,D=>`&#${D.charCodeAt(0)};`)};c.isExpressionField=u;c.isFeatureSupportedLayer=q;c.isGraphicForRelatableFeatureSupportedLayer=function(t){return!!t&&"object"===typeof t&&"sourceLayer"in
t&&v(t.sourceLayer)};c.isRelatableFeatureSupportedLayer=v;c.isRelatableLayer=I;c.isRelatedField=L;c.preLayerQueryCallback=({query:t,layer:D,method:J})=>{S({layer:D,method:J,query:t,definitionExpression:`${D.definitionExpression} ${D.serviceDefinitionExpression}`})};c.preRequestCallback=({queryPayload:t,layer:D,method:J})=>{S({layer:D,method:J,query:t,definitionExpression:`${D.definitionExpression} ${D.serviceDefinitionExpression}`})};c.querySourceLayer=x;c.queryUpdatedFeature=async function({graphic:t,
popupTemplate:D,layer:J,spatialReference:P},R){if(J&&D&&("function"===typeof J.load&&await J.load(R),t.attributes)){var W=t.attributes[J.objectIdField];if(null!=W){W=[W];var Z=await D.getRequiredFields(J.fieldsIndex),X=F.featureHasFields(Z,t);Z=X?[]:Z;D=D.returnGeometry||await A(D);if(!X||D)if(J=await x({layer:J,graphic:t,outFields:Z,objectIds:W,returnGeometry:D,spatialReference:P},R))J.geometry&&(t.geometry=J.geometry),J.attributes&&(t.attributes={...t.attributes,...J.attributes})}}};c.shouldOpenInNewTab=
function(t=""){if(t)return!fa.test(t.trim().toLowerCase())};c.substituteAttributes=h;c.substituteFieldsInLinksAndAttributes=function({attributes:t,globalAttributes:D,layer:J,text:P,expressionAttributes:R,fieldInfoMap:W}){return P?h({formattedAttributes:D,template:y(P,{...D,...R,...t},J),fieldInfoMap:W}):""};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/smartMapping/support/utils":function(){define("exports ../../intl/date ../../layers/support/fieldUtils ../../support/arcadeOnDemand ../../support/basemapUtils ../../time/timeZoneUtils".split(" "),
function(c,p,g,z,K,F){function E(l){return String(l).padStart(2,"0")}function H(l,h,k){if("date"===h||"number"===h){"number"===h&&(l=new Date(l));h=k?l.getFullYear():l.getUTCFullYear();const m=E((k?l.getMonth():l.getUTCMonth())+1),r=E(k?l.getDate():l.getUTCDate()),y=E(k?l.getHours():l.getUTCHours()),q=E(k?l.getMinutes():l.getUTCMinutes());l=E(k?l.getSeconds():l.getUTCSeconds());l=`TIMESTAMP'${h}-${m}-${r} ${y}:${q}:${l}'`}return l}function M(l,h){if(h instanceof Date)return"date";if("number"===typeof h)return"number";
if("string"===typeof h&&(l=l.getField(h),"\x3cnow\x3e"!==h.toLowerCase()&&g.isDateField(l)))return"field"}const C={light:"streets gray topo terrain oceans osm gray-vector streets-vector topo-vector streets-relief-vector streets-navigation-vector topo-3d navigation-3d arcgis-light-gray arcgis-navigation arcgis-streets arcgis-streets-relief arcgis-topographic arcgis-oceans osm-standard osm-standard-relief osm-streets osm-streets-relief osm-light-gray arcgis-terrain arcgis-charted-territory arcgis-community arcgis-colored-pencil arcgis-modern-antique arcgis-midcentury arcgis-newspaper arcgis-hillshade-light".split(" "),
dark:"satellite hybrid dark-gray dark-gray-vector streets-night-vector navigation-dark-3d arcgis-imagery arcgis-imagery-standard arcgis-dark-gray arcgis-navigation-night arcgis-streets-night osm-dark-gray arcgis-nova arcgis-hillshade-dark".split(" ")},u={years:365,months:30,days:1,hours:1/24,minutes:1/1440,seconds:1/86400,milliseconds:1/864E5},a=new Set(["integer","small-integer"]);let f=null;c.castIntegerFieldToFloat=function(l){return`cast(${l} as float)`};c.dateTypes=["date","date-only","timestamp-offset"];
c.defaultBasemapGroups=C;c.fieldDelimiter=",";c.formatAnyDate=function(l,h){const {format:k,timeZoneOptions:m,fieldType:r}=h??{};let y;m&&({timeZone:q,timeZoneName:y}=F.getTimeZoneFormattingOptions(m.layerTimeZone,m.datesInUnknownTimezone,m.viewTimeZone,p.convertDateFormatToIntlOptions(k||"short-date-short-time"),r));if("string"===typeof l&&isNaN(Date.parse("time-only"===r?`1970-01-01T${l}Z`:l)))return l;switch(r){case "date-only":var q=p.convertDateFormatToIntlOptions(k||"short-date");return"string"===
typeof l?p.formatDateOnly(l,{...q}):p.formatDate(l,{...q,timeZone:F.utc});case "time-only":return q=p.convertDateFormatToIntlOptions(k||"short-time"),"string"===typeof l?p.formatTimeOnly(l,q):p.formatDate(l,{...q,timeZone:F.utc});case "timestamp-offset":if(!q&&"string"===typeof l&&(new Date(l)).toISOString()!==l)return l;q=(h=k||m?p.convertDateFormatToIntlOptions(k||"short-date-short-time"):void 0)?{...h,timeZone:q,timeZoneName:y}:void 0;return"string"===typeof l?p.formatTimestamp(l,q):p.formatDate(l,
q);default:return h=k||m?p.convertDateFormatToIntlOptions(k||"short-date-short-time"):void 0,p.formatDate("string"===typeof l?new Date(l):l,h?{...h,timeZone:q,timeZoneName:y}:void 0)}};c.getBasemapGroup=function(l,h=C){for(const k in h)if(h[k].includes(l))return k};c.getBasemapId=function(l,h,k=!0){let m=null;l&&("string"===typeof l?h.includes(l)&&(m=l):m=K.getWellKnownBasemapId(l));return k?m||"gray":m};c.getDateDiffSQL=function(l,h,k,m){const {hasQueryEngine:r}=l;k=H(k,M(l,k),r);l=H(h,M(l,h),r);
l=`(${k} - ${l})`;m=u[m];h="/";1>m&&(m=1/m,h="*");return{sqlExpression:1===m?l:`(${l} ${h} ${m})`,sqlWhere:null}};c.getDateType=M;c.getFieldsList=async function(l){const {field:h,field2:k,field3:m,normalizationField:r,valueExpression:y}=l;l=[];y&&(f||({arcadeUtils:l}=await z.loadArcade(),f=l),l=f.extractFieldNames(y));h&&l.push(h);k&&l.push(k);m&&l.push(m);r&&l.push(r);return l};c.getNormalizationType=function(l){let h=l.normalizationType;h||(l.normalizationField?h="field":null!=l.normalizationTotal&&
(h="percent-of-total"));return h??void 0};c.isAnyDateField=function(l){return g.isDateField(l)||g.isDateOnlyField(l)||g.isTimestampOffsetField(l)};c.isIntegerField=function(l,h){l=h&&l.getField(h);return!!l&&a.has(l.type)};c.unitValueInDays=u;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Attachments/support/attachmentUtils":function(){define(["exports","../../../assets"],function(c,p){c.getIconPath=function(g){const z=p.getAssetUrl("esri/themes/base/images/files/");
return g?"text/plain"===g?`${z}text-32.svg`:"application/pdf"===g?`${z}pdf-32.svg`:"text/csv"===g?`${z}csv-32.svg`:"application/gpx+xml"===g?`${z}gpx-32.svg`:"application/x-dwf"===g?`${z}cad-32.svg`:"application/postscript"===g||"application/json"===g||"text/xml"===g||"model/vrml"===g?`${z}code-32.svg`:"application/x-zip-compressed"===g||"application/x-7z-compressed"===g||"application/x-gzip"===g||"application/x-tar"===g||"application/x-gtar"===g||"application/x-bzip2"===g||"application/gzip"===g||
"application/x-compress"===g||"application/x-apple-diskimage"===g||"application/x-rar-compressed"===g||"application/zip"===g?`${z}zip-32.svg`:g.includes("image/")?`${z}image-32.svg`:g.includes("audio/")?`${z}sound-32.svg`:g.includes("video/")?`${z}video-32.svg`:g.includes("msexcel")||g.includes("ms-excel")||g.includes("spreadsheetml")?`${z}excel-32.svg`:g.includes("msword")||g.includes("ms-word")||g.includes("wordprocessingml")?`${z}word-32.svg`:g.includes("powerpoint")||g.includes("presentationml")?
`${z}report-32.svg`:`${z}generic-32.svg`:`${z}generic-32.svg`};c.isSupportedImage=function(g){g=g.toLowerCase();return"image/bmp"===g||"image/emf"===g||"image/exif"===g||"image/gif"===g||"image/x-icon"===g||"image/jpeg"===g||"image/png"===g||"image/tiff"===g||"image/x-wmf"===g};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/globalCss":function(){define(["exports"],function(c){c.globalCss={anchor:"esri-widget__anchor",anchorDisabled:"esri-widget__anchor--disabled",
button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",disabled:"esri-disabled",disabledElement:"esri-disabled-element",empty:"esri-widget__content--empty",emptyIllustration:"esri-widget__content-illustration--empty",heading:"esri-widget__heading",hidden:"esri-hidden",input:"esri-input",interactive:"esri-interactive",
loader:"esri-widget__loader",loaderAnimation:"esri-widget__loader-animation",loaderText:"esri-widget__loader-text",menu:"esri-menu",menuHeader:"esri-menu__header",menuItem:"esri-menu__list-item",menuItemActive:"esri-menu__list-item--active",menuItemFocus:"esri-menu__list-item--focus",menuList:"esri-menu__list",noBookmarksIcon:"esri-widget__no-bookmark-icon",panel:"esri-widget--panel",panelHeightOnly:"esri-widget--panel-height-only",primaryTick:"primary-tick",primaryTickAmPm:"primary-tick__ampm",primaryTickLabel:"primary-tick__label",
rotating:"esri-rotating",secondaryTick:"secondary-tick",select:"esri-select",table:"esri-widget__table",widget:"esri-widget",widgetButton:"esri-widget--button",widgetButtonActive:"esri-widget--button-active",widgetDisabled:"esri-widget--disabled"};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureAttachments/FeatureAttachmentsViewModel":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../Attachments/AttachmentsViewModel".split(" "),
function(c,p,g,z,K,F,E){g=class extends E{constructor(H){super(H);this.title=this.description=null}};c.__decorate([p.property()],g.prototype,"description",void 0);c.__decorate([p.property()],g.prototype,"title",void 0);return g=c.__decorate([F.subclass("esri.widgets.Feature.FeatureAttachments.FeatureAttachmentsViewModel")],g)})},"esri/widgets/Feature/support/FeatureElementInfo":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../Widget ../../support/Heading ../../support/widgetUtils ../../support/jsxFactory".split(" "),
function(c,p,g,z,K,F,E,H,M,C){g=class extends E{constructor(u,a){super(u,a);this.description=null;this.headingLevel=2;this.title=null}render(){return C.tsx("div",{class:"esri-feature-element-info"},this._renderTitle(),this._renderDescription())}_renderTitle(){const {title:u}=this;return u?C.tsx(H.Heading,{class:"esri-feature-element-info__title",level:this.headingLevel},u):null}_renderDescription(){const {description:u}=this;return u?C.tsx("div",{class:"esri-feature-element-info__description",key:"description"},
u):null}};c.__decorate([p.property()],g.prototype,"description",void 0);c.__decorate([p.property()],g.prototype,"headingLevel",void 0);c.__decorate([p.property()],g.prototype,"title",void 0);return g=c.__decorate([F.subclass("esri.widgets.Feature.support.FeatureElementInfo")],g)})},"esri/widgets/support/Heading":function(){define(["exports","../../core/mathUtils","./globalCss","./widgetUtils","./jsxFactory"],function(c,p,g,z,K){c.Heading=function({level:F,class:E,...H},M){F=p.clamp(Math.ceil(F),1,
6);return K.tsx(`h${F}`,{...H,"aria-level":String(F),class:z.classes(g.globalCss.heading,E),role:"heading"},M)};c.incrementHeadingLevel=function(F,E=1){return p.clamp(Math.ceil(F+E),1,6)};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureContent":function(){define("../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../Widget ./FeatureContent/FeatureContentViewModel ./support/featureUtils ../support/widget ../support/jsxFactory".split(" "),
function(c,p,g,z,K,F,E,H,M,C,u){g=class extends E{constructor(a,f){super(a,f);this.viewModel=null;this._addTargetToAnchors=l=>{Array.from(l.querySelectorAll("a")).forEach(h=>{M.shouldOpenInNewTab(h.href)&&!h.hasAttribute("target")&&h.setAttribute("target","_blank")})}}get creator(){return this.viewModel?.creator}set creator(a){this.viewModel&&(this.viewModel.creator=a)}get graphic(){return this.viewModel?.graphic}set graphic(a){this.viewModel&&(this.viewModel.graphic=a)}render(){return u.tsx("div",
{class:"esri-feature-content"},"loading"===this.viewModel?.state?this._renderLoading():this._renderCreated())}_renderLoading(){return u.tsx("div",{class:"esri-feature-content__loader-container",key:"loader"},u.tsx("div",{class:"esri-feature-content__loader"}))}_renderCreated(){const a=this.viewModel?.created;return a?a instanceof HTMLElement?u.tsx("div",{afterCreate:this._attachToNode,bind:a,key:a}):C.isWidget(a)?u.tsx("div",{key:a},!a.destroyed&&a.render()):u.tsx("div",{afterCreate:this._addTargetToAnchors,
innerHTML:a,key:a}):null}_attachToNode(a){a.appendChild(this)}};c.__decorate([p.property()],g.prototype,"creator",null);c.__decorate([p.property()],g.prototype,"graphic",null);c.__decorate([p.property({type:H})],g.prototype,"viewModel",void 0);return g=c.__decorate([F.subclass("esri.widgets.Feature.FeatureContent")],g)})},"esri/widgets/Feature/FeatureContent/FeatureContentViewModel":function(){define("../../../chunks/tslib.es6 ../../../Graphic ../../../core/Accessor ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../support/featureUtils".split(" "),
function(c,p,g,z,K,F,E,H,M,C){g=class extends g{constructor(u){super(u);this.graphic=this.destroyer=this.creator=this.created=this._loadingPromise=null;this.addHandles(z.watch(()=>this.creator,a=>{this._destroyContent();this._createContent(a)},z.initial))}destroy(){this._destroyContent()}get state(){return this._loadingPromise?"loading":"ready"}_destroyContent(){const {created:u,graphic:a,destroyer:f}=this;u&&a&&(C.graphicCallback(f,{graphic:a}).catch(()=>null),this._set("created",null))}async _createContent(u){var a=
this.graphic;a&&u&&(this._loadingPromise=u=C.graphicCallback(u,{graphic:a}).catch(()=>null),this.notifyChange("state"),a=await u,u===this._loadingPromise&&(this._loadingPromise=null,this.notifyChange("state"),this._set("created",a)))}};c.__decorate([K.property({readOnly:!0})],g.prototype,"created",void 0);c.__decorate([K.property()],g.prototype,"creator",void 0);c.__decorate([K.property()],g.prototype,"destroyer",void 0);c.__decorate([K.property({type:p})],g.prototype,"graphic",void 0);c.__decorate([K.property({readOnly:!0})],
g.prototype,"state",null);return g=c.__decorate([M.subclass("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")],g)})},"esri/widgets/Feature/FeatureExpression":function(){define("../../chunks/tslib.es6 ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../Widget ./FeatureContent ./FeatureFields ./FeatureMedia ./FeatureExpression/FeatureExpressionViewModel ../support/globalCss ../support/legacyIcon ../support/widgetUtils ../support/jsxFactory".split(" "),
function(c,p,g,z,K,F,E,H,M,C,u,a,f,l,h,k){z=class extends H{constructor(m,r){super(m,r);this._contentWidget=null;this.viewModel=new a}initialize(){this.addHandles(p.watch(()=>this.viewModel?.contentElementViewModel,()=>this._setupExpressionWidget(),p.initial))}destroy(){this._destroyContentWidget()}render(){const {state:m}=this.viewModel;return k.tsx("div",{class:"esri-feature-expression"},"loading"===m?this._renderLoading():"disabled"===m?null:this._contentWidget?.render())}_renderLoading(){return k.tsx("div",
{class:"esri-feature__loading-container",key:"loading-container"},k.tsx("span",{class:this.classes(l.legacyIcon.loadingIndicator,f.globalCss.rotating,"esri-feature__loading-spinner")}))}_destroyContentWidget(){const {_contentWidget:m}=this;m&&(m.viewModel=null,m.destroy());this._contentWidget=null}_setupExpressionWidget(){const {contentElementViewModel:m,contentElement:r}=this.viewModel,y=r?.type;this._destroyContentWidget();this._contentWidget=m?"fields"===y?new C({viewModel:m}):"media"===y?new u({viewModel:m}):
"text"===y?new M({viewModel:m}):null:null;this.scheduleRender()}};c.__decorate([g.property({type:a})],z.prototype,"viewModel",void 0);return z=c.__decorate([E.subclass("esri.widgets.Feature.FeatureExpression")],z)})},"esri/widgets/Feature/FeatureFields":function(){define("../../chunks/tslib.es6 ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../Widget ./FeatureFields/FeatureFieldsViewModel ./support/FeatureElementInfo ../support/globalCss ../support/uriUtils ../support/widgetUtils ../support/decorators/messageBundle ../support/jsxFactory".split(" "),
function(c,p,g,z,K,F,E,H,M,C,u,a,f,l,h){z=class extends H{constructor(k,m){super(k,m);this._featureElementInfo=null;this.viewModel=new M;this.messagesURIUtils=this.messages=null}initialize(){this._featureElementInfo=new C;this.addHandles(p.watch(()=>[this.viewModel?.description,this.viewModel?.title],()=>this._setupFeatureElementInfo(),p.initial))}destroy(){this._featureElementInfo?.destroy()}get attributes(){return this.viewModel.attributes}set attributes(k){this.viewModel.attributes=k}get description(){return this.viewModel.description}set description(k){this.viewModel.description=
k}get expressionInfos(){return this.viewModel.expressionInfos}set expressionInfos(k){this.viewModel.expressionInfos=k}get fieldInfos(){return this.viewModel.fieldInfos}set fieldInfos(k){this.viewModel.fieldInfos=k}get title(){return this.viewModel.title}set title(k){this.viewModel.title=k}render(){return h.tsx("div",{class:"esri-feature-fields"},this._featureElementInfo?.render(),this._renderFields())}_renderFieldInfo(k,m){var {attributes:r}=this.viewModel;const y=k.fieldName,q=k.label||y;r=r?null==
r[y]?"":r[y]:"";k=!(!k.format||!k.format.dateFormat);r="number"!==typeof r||k?a.autoLink(this.messagesURIUtils,r):this._forceLTR(r);k={["esri-feature-fields__field-data--date"]:k};return h.tsx("tr",{key:`fields-element-info-row-${y}-${m}`},h.tsx("th",{class:"esri-feature-fields__field-header",innerHTML:q,key:`fields-element-info-row-header-${y}-${m}`}),h.tsx("td",{class:this.classes("esri-feature-fields__field-data",k),innerHTML:r,key:`fields-element-info-row-data-${y}-${m}`}))}_renderFields(){const {formattedFieldInfos:k}=
this.viewModel;return k?.length?h.tsx("table",{class:u.globalCss.table,summary:this.messages.fieldsSummary},h.tsx("tbody",null,k.map((m,r)=>this._renderFieldInfo(m,r)))):null}_setupFeatureElementInfo(){const {description:k,title:m}=this;this._featureElementInfo?.set({description:k,title:m})}_forceLTR(k){return`&lrm;${k}`}};c.__decorate([g.property()],z.prototype,"attributes",null);c.__decorate([g.property()],z.prototype,"description",null);c.__decorate([g.property()],z.prototype,"expressionInfos",
null);c.__decorate([g.property()],z.prototype,"fieldInfos",null);c.__decorate([g.property()],z.prototype,"title",null);c.__decorate([g.property({type:M,nonNullable:!0})],z.prototype,"viewModel",void 0);c.__decorate([g.property(),l.messageBundle("esri/widgets/Feature/t9n/Feature")],z.prototype,"messages",void 0);c.__decorate([g.property(),l.messageBundle("esri/widgets/support/t9n/uriUtils")],z.prototype,"messagesURIUtils",void 0);return z=c.__decorate([E.subclass("esri.widgets.Feature.FeatureFields")],
z)})},"esri/widgets/Feature/FeatureFields/FeatureFieldsViewModel":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../popup/ExpressionInfo ../../../popup/FieldInfo ../support/featureUtils".split(" "),function(c,p,g,z,K,F,E,H,M,C){p=class extends p{constructor(u){super(u);this.title=this.fieldInfos=
this.description=this.expressionInfos=this.attributes=null}get formattedFieldInfos(){const {expressionInfos:u,fieldInfos:a}=this,f=[];a?.forEach(l=>{if(!l.hasOwnProperty("visible")||l.visible)l=l.clone(),l.label=C.getFieldInfoLabel(l,u),f.push(l)});return f}};c.__decorate([g.property()],p.prototype,"attributes",void 0);c.__decorate([g.property({type:[H]})],p.prototype,"expressionInfos",void 0);c.__decorate([g.property()],p.prototype,"description",void 0);c.__decorate([g.property({type:[M]})],p.prototype,
"fieldInfos",void 0);c.__decorate([g.property({readOnly:!0})],p.prototype,"formattedFieldInfos",null);c.__decorate([g.property()],p.prototype,"title",void 0);return p=c.__decorate([E.subclass("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")],p)})},"esri/widgets/support/uriUtils":function(){define(["exports","../../core/string"],function(c,p){function g(K){let F=null;z.some(E=>{E.pattern.test(K)&&(F=E);return!!F});return F}const z=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",
label:"{messages.view}"},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"App Studio Player"},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Collector"},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Explorer"},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,
label:"{messages.openInApp}",appName:"Navigator"},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Survey123"},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Trek2There"},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Workforce"},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"iForm"},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",
appName:"FlowFinity"},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Laserfische"},{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Microsoft Power Bi"}];c.autoLink=function(K,F){if("string"!==typeof F||!F)return F;const E=g(F);if(!E)return F;const H=F.match(E.pattern);K=p.replace(p.replace(E.label,{messages:K,hierPart:H&&H[2]}),{appName:E.appName});return F.replace(E.pattern,`<a${E.target?` target="${E.target}"`:""} href="$1"${"_blank"===
E.target?' rel\x3d"noreferrer"':""}>${K}</a>`)};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureMedia":function(){define("require ../../chunks/tslib.es6 ../../intl ../../core/a11yUtils ../../core/events ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../renderers/support/utils ../Widget ./FeatureMedia/FeatureMediaViewModel ./support/FeatureElementInfo ./support/featureUtils ../support/componentsUtils ../support/widgetUtils ../support/decorators/messageBundle ../support/jsxFactory ../../support/themeUtils ../../intl/substitute".split(" "),
function(c,p,g,z,K,F,E,H,M,C,u,a,f,l,h,k,m,r,y,q,I,v){g=class extends f{constructor(e,b){super(e,b);this._featureElementInfo=this._refreshIntervalInfo=this._refreshTimer=null;this._chartRootMap=new WeakMap;this.viewModel=new l;this.messages=null;this._disposeChart=d=>{this._chartRootMap.get(d)?.dispose();this._chartRootMap.delete(d)};this._createChart=async d=>{const {destroyed:w,viewModel:G}=this;if(!w&&G&&d){var {createRoot:n}=await new Promise((B,x)=>c(["../support/chartUtilsAm5"],B,x));n=await n(d);
this._chartRootMap.set(d,n);this._renderChart({mediaInfo:G.activeMediaInfo,root:n})}}}initialize(){this._featureElementInfo=new h;this.addHandles([F.watch(()=>[this.viewModel?.activeMediaInfo,this.viewModel?.activeMediaInfoIndex],()=>this._setupMediaRefreshTimer(),F.initial),F.watch(()=>[this.viewModel?.description,this.viewModel?.title],()=>this._setupFeatureElementInfo(),F.initial)])}loadDependencies(){return m.loadCalciteComponents({icon:()=>new Promise((e,b)=>c(["../../chunks/calcite-icon"],e,
b))})}destroy(){this._clearMediaRefreshTimer();this._featureElementInfo?.destroy()}get attributes(){return this.viewModel.attributes}set attributes(e){this.viewModel.attributes=e}get activeMediaInfoIndex(){return this.viewModel.activeMediaInfoIndex}set activeMediaInfoIndex(e){this.viewModel.activeMediaInfoIndex=e}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get fieldInfoMap(){return this.viewModel.fieldInfoMap}set fieldInfoMap(e){this.viewModel.fieldInfoMap=
e}get layer(){return this.viewModel.layer}set layer(e){this.viewModel.layer=e}get mediaInfos(){return this.viewModel.mediaInfos}set mediaInfos(e){this.viewModel.mediaInfos=e}get popupTemplate(){return this.viewModel.popupTemplate}set popupTemplate(e){this.viewModel.popupTemplate=e}get relatedInfos(){return this.viewModel.relatedInfos}set relatedInfos(e){this.viewModel.relatedInfos=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}render(){return q.tsx("div",{bind:this,
class:"esri-feature-media",onkeyup:this._handleMediaKeyup},this._featureElementInfo?.render(),this._renderMedia())}_renderMedia(){const {formattedMediaInfoCount:e,activeMediaInfoIndex:b}=this.viewModel,d=this._renderMediaText();return e?q.tsx("div",{class:"esri-feature-media__container",key:"media-element-container"},this._renderMediaInfo(),q.tsx("div",{class:"esri-feature-media__item-navigation"},d,1<e?q.tsx("div",{class:"esri-feature-media__pagination"},this._renderMediaPageButton("previous"),q.tsx("span",
{class:"esri-feature-media__pagination-text"},v.substitute(this.messages.pageText,{index:b+1,total:e})),this._renderMediaPageButton("next")):null)):null}_renderMediaText(){var {activeMediaInfo:e}=this.viewModel;if(!e)return null;const b=e&&e.title?q.tsx("div",{class:"esri-feature-media__item-title",innerHTML:e.title,key:"media-title"}):null;e=e&&e.caption?q.tsx("div",{class:"esri-feature-media__item-caption",innerHTML:e.caption,key:"media-caption"}):null;return b||e?q.tsx("div",{class:"esri-feature-media__item-text",
key:"media-text"},b,e):null}_renderImageMediaInfo(e){var {_refreshIntervalInfo:b}=this;const {activeMediaInfoIndex:d,formattedMediaInfoCount:w}=this.viewModel,{value:G,refreshInterval:n,altText:B,title:x,type:A}=e,{sourceURL:L,linkURL:O}=G;e=k.shouldOpenInNewTab(O??void 0)?"_blank":"_self";const N="_blank"===e?"noreferrer":"";b=n?b:null;b=q.tsx("img",{alt:B||x,key:`media-${A}-${d}-${w}-${b?b.timestamp:0}`,src:(b?b.sourceURL:L)??void 0});return(O?q.tsx("a",{href:O,rel:N,target:e,title:x},b):null)??
b}_renderChartMediaInfo(e){const {activeMediaInfoIndex:b,formattedMediaInfoCount:d}=this.viewModel;return q.tsx("div",{afterCreate:this._createChart,afterRemoved:this._disposeChart,bind:this,class:"esri-feature-media__chart",key:`media-${e.type}-${b}-${d}`})}_renderMediaInfoType(){const {activeMediaInfo:e}=this.viewModel;return e?"image"===e.type?this._renderImageMediaInfo(e):e.type.includes("chart")?this._renderChartMediaInfo(e):null:null}_renderMediaInfo(){const {activeMediaInfo:e}=this.viewModel;
return e?q.tsx("div",{class:"esri-feature-media__item-container",key:"media-container"},q.tsx("div",{class:"esri-feature-media__item",key:"media-item-container"},this._renderMediaInfoType())):null}_renderMediaPageButton(e){if(2>this.viewModel.formattedMediaInfoCount)return null;const b=(e="previous"===e)?this.messages.previous:this.messages.next;return q.tsx("button",{"aria-label":b,bind:this,class:"esri-feature-media__pagination-button",key:e?"media-previous":"media-next",onclick:e?this._previous:
this._next,tabIndex:0,title:b,type:"button"},q.tsx("calcite-icon",{class:"esri-feature-media__pagination-icon",icon:e?"chevron-left":"chevron-right",scale:"s"}))}_setupFeatureElementInfo(){const {description:e,title:b}=this;this._featureElementInfo?.set({description:e,title:b})}_next(){this.viewModel.next()}_previous(){this.viewModel.previous()}_getRenderer(){if(this.viewModel){var {isAggregate:e,layer:b}=this.viewModel;return e&&b?.featureReduction&&"renderer"in b.featureReduction?b.featureReduction.renderer:
b?.renderer}}async _getSeriesColors(e){const {colorAm5:b}=await new Promise((w,G)=>c(["./FeatureMedia/chartCommon"],w,G)),d=new Map;e.forEach(w=>{w.color&&d.set(w,b(w.color.toCss(!0)))});return d}async _getRendererColors(){const {colorAm5:e}=await new Promise((G,n)=>c(["./FeatureMedia/chartCommon"],G,n)),b=new Map,d=this._getRenderer();if(!d)return b;const w=await a.getColorsFromRenderer(d);w.delete("default");if(!Array.from(w.values()).every(G=>1===G?.length))return b;Array.from(w.keys()).forEach(G=>
{const n=w.get(G)?.[0]?.toCss(!0);n&&b.set(G,e(n))});return b}_handleMediaKeyup(e){const b=K.eventKey(e);"ArrowLeft"===b&&(e.stopPropagation(),this.viewModel.previous());"ArrowRight"===b&&(e.stopPropagation(),this.viewModel.next())}_canAnimateChart(){return this.viewModel?!!this.viewModel.abilities.chartAnimation&&!z.prefersReducedMotion():!1}_getChartAnimationMS(){return this._canAnimateChart()?250:0}_getChartSeriesAnimationMS(){return this._canAnimateChart()?500:0}async _renderChart(e){const {root:b,
mediaInfo:d}=e,{value:w,type:G}=d,{ResponsiveThemeAm5:n,DarkThemeAm5:B,AnimatedThemeAm5:x,ColorSetAm5:A,ThemeAm5:L,esriChartColorSet:O}=await new Promise((Y,aa)=>c(["./FeatureMedia/chartCommon"],Y,aa));var N=L.new(b);N.rule("ColorSet").set("colors",O);N.rule("ColorSet").set("reuse",!0);N=[n.new(b),N];I.isDarkTheme()&&N.push(B.new(b));this._canAnimateChart()&&N.push(x.new(b));b.setThemes(N);const Q=await this._getRendererColors(),U=await this._getSeriesColors(w.series),V=A.new(b,{}),ba=(N=U.get(w.series[0]))?
{lineSettings:{stroke:N}}:void 0;N=w.series.map((Y,aa)=>{aa=U.get(Y)||Q.get(Y.fieldName)||V.getIndex(aa);return{category:Y.tooltip,value:Y.value,columnSettings:{fill:aa,stroke:aa},...ba}}).filter(Y=>"pie-chart"===G?null!=Y.value&&0<Y.value:!0);"pie-chart"===G?this._createPieChart(e,N):this._createXYChart(e,N)}_getDirection(){return r.isRTL(this.container)?"rtl":"ltr"}_isInversed(){return!!r.isRTL(this.container)}async _customizeChartTooltip(e,b="horizontal"){const {colorAm5:d}=await new Promise((w,
G)=>c(["./FeatureMedia/chartCommon"],w,G));e.setAll({pointerOrientation:b});e.get("background")?.setAll({stroke:d("rgba(50, 50, 50, 1)")});e.label.setAll({direction:this._getDirection(),oversizedBehavior:"wrap",maxWidth:200})}async _createPieChart(e,b){var {TooltipAm5:d}=await new Promise((A,L)=>c(["./FeatureMedia/chartCommon"],A,L));const {PieChartAm5:w,PieSeriesAm5:G}=await new Promise((A,L)=>c(["./FeatureMedia/pieChart"],A,L)),{mediaInfo:n,root:B}=e;var {title:x}=n;e=B.container.children.push(w.new(B,
{ariaLabel:n?.altText||n?.title||"",focusable:!0,paddingBottom:5,paddingTop:5,paddingLeft:5,paddingRight:5}));d=d.new(B,{labelText:"{category}: {valuePercentTotal.formatNumber('0.00')}%\n ({value})"});x=e.series.push(G.new(B,{name:x,valueField:"value",categoryField:"category",tooltip:d}));x.ticks.template.set("forceHidden",!0);x.labels.template.set("forceHidden",!0);x.slices.template.states.create("active",{shiftRadius:5});this._customizeChartTooltip(d);x.slices.template.setAll({ariaLabel:"{category}: {valuePercentTotal.formatNumber('0.00')}%\n ({value})",
focusable:!0,templateField:"columnSettings"});x.data.setAll(b);x.appear(this._getChartSeriesAnimationMS());e.appear(this._getChartAnimationMS());e.root.dom.classList.toggle("esri-feature-media__chart--rendered",!0)}_getMinSeriesValue(e){let b=0;e.forEach(d=>b=Math.min(d.value,b));return b}async _createColumnChart(e,b,d){const {TooltipAm5:w,ScrollbarAm5:G}=await new Promise((Y,aa)=>c(["./FeatureMedia/chartCommon"],Y,aa)),{CategoryAxisAm5:n,AxisRendererXAm5:B,ValueAxisAm5:x,AxisRendererYAm5:A,ColumnSeriesAm5:L}=
await new Promise((Y,aa)=>c(["./FeatureMedia/xyChart"],Y,aa)),{mediaInfo:O,root:N}=b,{value:Q,title:U}=O;e.setAll({wheelX:"panX",wheelY:"zoomX"});b=e.xAxes.push(n.new(N,{renderer:B.new(N,{inversed:this._isInversed()}),categoryField:"category"}));b.get("renderer").labels.template.setAll({forceHidden:!0});var V=e.yAxes.push(x.new(N,{renderer:A.new(N,{inside:!1}),min:this._getMinSeriesValue(Q.series)}));V.get("renderer").labels.template.setAll({direction:this._getDirection()});const ba=w.new(N,{labelText:"{categoryX}"});
V=e.series.push(L.new(N,{name:U,xAxis:b,yAxis:V,valueYField:"value",categoryXField:"category",tooltip:ba}));this._customizeChartTooltip(ba);V.columns.template.setAll({ariaLabel:"{categoryX}",focusable:!0,templateField:"columnSettings"});15<Q.series.length&&e.set("scrollbarX",G.new(N,{orientation:"horizontal"}));b.data.setAll(d);V.data.setAll(d);V.appear(this._getChartSeriesAnimationMS());e.appear(this._getChartAnimationMS())}async _createBarChart(e,b,d){const {TooltipAm5:w,ScrollbarAm5:G}=await new Promise((Y,
aa)=>c(["./FeatureMedia/chartCommon"],Y,aa)),{CategoryAxisAm5:n,AxisRendererXAm5:B,ValueAxisAm5:x,AxisRendererYAm5:A,ColumnSeriesAm5:L}=await new Promise((Y,aa)=>c(["./FeatureMedia/xyChart"],Y,aa)),{mediaInfo:O,root:N}=b,{value:Q,title:U}=O;e.setAll({wheelX:"panY",wheelY:"zoomY"});b=e.yAxes.push(n.new(N,{renderer:A.new(N,{inversed:!0}),categoryField:"category"}));b.get("renderer").labels.template.setAll({forceHidden:!0});var V=e.xAxes.push(x.new(N,{renderer:B.new(N,{inside:!1,inversed:this._isInversed()}),
min:this._getMinSeriesValue(Q.series)}));V.get("renderer").labels.template.setAll({direction:this._getDirection()});const ba=w.new(N,{labelText:"{categoryY}"});V=e.series.push(L.new(N,{name:U,xAxis:V,yAxis:b,valueXField:"value",categoryYField:"category",tooltip:ba}));this._customizeChartTooltip(ba,"vertical");V.columns.template.setAll({ariaLabel:"{categoryY}",focusable:!0,templateField:"columnSettings"});15<Q.series.length&&e.set("scrollbarY",G.new(N,{orientation:"vertical"}));b.data.setAll(d);V.data.setAll(d);
V.appear(this._getChartSeriesAnimationMS());e.appear(this._getChartAnimationMS())}async _createLineChart(e,b,d){const {TooltipAm5:w,ScrollbarAm5:G}=await new Promise((aa,da)=>c(["./FeatureMedia/chartCommon"],aa,da)),{CategoryAxisAm5:n,AxisRendererXAm5:B,ValueAxisAm5:x,AxisRendererYAm5:A,LineSeriesAm5:L}=await new Promise((aa,da)=>c(["./FeatureMedia/xyChart"],aa,da)),{root:O,mediaInfo:N}=b,{value:Q,title:U}=N;e.setAll({wheelX:"panX",wheelY:"zoomX"});b=e.xAxes.push(n.new(O,{renderer:B.new(O,{inversed:this._isInversed()}),
categoryField:"category"}));b.get("renderer").labels.template.setAll({forceHidden:!0});var V=e.yAxes.push(x.new(O,{renderer:A.new(O,{inside:!1}),min:this._getMinSeriesValue(Q.series)}));V.get("renderer").labels.template.setAll({direction:this._getDirection()});const ba=d[0]?.lineSettings?.stroke,Y=w.new(O,{getFillFromSprite:!ba,labelText:"{categoryX}"});ba&&Y.get("background")?.setAll({fill:ba});V=e.series.push(L.new(O,{name:U,xAxis:b,yAxis:V,valueYField:"value",categoryXField:"category",tooltip:Y}));
V.strokes.template.setAll({templateField:"lineSettings"});this._customizeChartTooltip(Y,"vertical");15<Q.series.length&&e.set("scrollbarX",G.new(O,{orientation:"horizontal"}));b.data.setAll(d);V.data.setAll(d);V.appear(this._getChartSeriesAnimationMS());e.appear(this._getChartAnimationMS())}async _createXYChart(e,b){const {XYChartAm5:d,XYCursorAm5:w}=await new Promise((A,L)=>c(["./FeatureMedia/xyChart"],A,L)),{root:G,mediaInfo:n}=e,{type:B}=n,x=G.container.children.push(d.new(G,{ariaLabel:n?.altText||
n?.title||"",focusable:!0,panX:!0,panY:!0}));x.set("cursor",w.new(G,{}));"column-chart"===B&&await this._createColumnChart(x,e,b);"bar-chart"===B&&await this._createBarChart(x,e,b);"line-chart"===B&&await this._createLineChart(x,e,b);x.root.dom.classList.toggle("esri-feature-media__chart--rendered",!0)}_clearMediaRefreshTimer(){const {_refreshTimer:e}=this;e&&(clearTimeout(e),this._refreshTimer=null)}_updateMediaInfoTimestamp(e){const b=Date.now();this._refreshIntervalInfo={timestamp:b,sourceURL:e&&
this._getImageSource(e,b)}}_setupMediaRefreshTimer(){this._clearMediaRefreshTimer();const {activeMediaInfo:e}=this.viewModel;e&&"image"===e.type&&e.refreshInterval&&this._setRefreshTimeout(e)}_setRefreshTimeout(e){const {refreshInterval:b,value:d}=e;b&&(e=6E4*b,this._updateMediaInfoTimestamp(d.sourceURL),this._refreshTimer=setInterval(()=>{this._updateMediaInfoTimestamp(d.sourceURL)},e))}_getImageSource(e,b){const d=e.includes("?")?"\x26":"?",[w,G=""]=e.split("#");return`${w}${d}timestamp=${b}${G?
"#":""}${G}`}};p.__decorate([E.property()],g.prototype,"_refreshIntervalInfo",void 0);p.__decorate([E.property()],g.prototype,"attributes",null);p.__decorate([E.property()],g.prototype,"activeMediaInfoIndex",null);p.__decorate([E.property()],g.prototype,"description",null);p.__decorate([E.property()],g.prototype,"fieldInfoMap",null);p.__decorate([E.property()],g.prototype,"layer",null);p.__decorate([E.property()],g.prototype,"mediaInfos",null);p.__decorate([E.property()],g.prototype,"popupTemplate",
null);p.__decorate([E.property()],g.prototype,"relatedInfos",null);p.__decorate([E.property()],g.prototype,"title",null);p.__decorate([E.property({type:l})],g.prototype,"viewModel",void 0);p.__decorate([E.property(),y.messageBundle("esri/widgets/Feature/t9n/Feature")],g.prototype,"messages",void 0);return g=p.__decorate([u.subclass("esri.widgets.Feature.FeatureMedia")],g)})},"esri/core/a11yUtils":function(){define(["exports"],function(c){c.prefersReducedMotion=()=>window.matchMedia("(prefers-reduced-motion: reduce)").matches;
Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/utils":function(){define("exports ../../core/arrayUtils ../../core/Logger ../../core/MapUtils ../../intl/date ../../layers/support/fieldUtils ./numberUtils ../visualVariables/support/ColorStop ../../smartMapping/support/utils ../../symbols/support/utils ../../widgets/Legend/support/colorRampUtils ../../widgets/Legend/support/heatmapRampUtils".split(" "),function(c,p,g,z,K,F,E,H,M,C,u,a){async function f(q,I,v){z.getOrCreateMapValue(q,
I,()=>[]).push(...v)}async function l(q,I,v){q=z.getOrCreateMapValue(q,I,()=>new Map);for(const e of v)q.set(e.value,e.color)}function h(q){let I=q.minValue,v=q.maxValue;const e=q.isFirstBreak?"":r.gt+" ";q="percent-of-total"===q.normalizationType?r.pct:"";I=null==I?"":E.format(I);v=null==v?"":E.format(v);return e+I+q+" "+r.ld+" "+v+q}function k(q,I){return"normalizationField"in q&&q.normalizationField?{type:"normalized-field",field:q.field,normalizationField:q.normalizationField}:"field"in q&&q.field?
{type:"field",field:q.field}:"valueExpression"in q&&q.valueExpression?{type:"expression",expression:q.valueExpression,title:q.valueExpressionTitle,returnType:I}:null}const m=g.getLogger("esri.renderers.support.utils"),r={lte:"\x3c\x3d",gte:"\x3e\x3d",lt:"\x3c",gt:"\x3e",pct:"%",ld:"\u2013"},y={millisecond:0,second:1,minute:2,hour:3,day:4,month:5,year:6};g=K.convertDateFormatToIntlOptions("short-date");c.calculateDateFormatInterval=function(q){q=q.map(d=>new Date(d));const I=q.length;let v=Infinity,
e=null;for(let d=0;d<I-1;d++){const w=q[d];let G=Infinity,n=null;for(let B=d+1;B<I;B++){var b=q[B];b=w.getFullYear()!==b.getFullYear()&&"year"||w.getMonth()!==b.getMonth()&&"month"||w.getDate()!==b.getDate()&&"day"||w.getHours()!==b.getHours()&&"hour"||w.getMinutes()!==b.getMinutes()&&"minute"||w.getSeconds()!==b.getSeconds()&&"second"||"millisecond";const x=y[b];x<G&&(G=x,n=b)}G<v&&(v=G,e=n)}return e};c.createClassBreakLabel=h;c.createColorStops=function(q){const {values:I,colors:v,labelIndexes:e,
isDate:b}=q;return I.map((d,w)=>{var G=null;if(!e||e.includes(w)){const n=b?K.formatDate(d):E.format(d);n&&(G="",0===w?G=r.lt+" ":w===I.length-1&&(G=r.gt+" "),G+=n)}return new H({value:d,color:v[w],label:G})})};c.createUniqueValueLabel=function(q){const {value:I,domain:v,fieldInfo:e,dateFormatOptions:b}=q;q=String(I);const d=v&&"codedValues"in v&&v.codedValues?v.getName(I):null;d?q=d:null!=I&&e&&(M.isAnyDateField(e)||F.isTimeOnlyField(e))?q=M.formatAnyDate(I,b??{fieldType:e.type}):"number"===typeof I&&
(q=E.format(I));return q};c.dateFormatIntervalOptions={millisecond:"long-month-day-year-long-time",second:"long-month-day-year-long-time",minute:"long-month-day-year-short-time",hour:"long-month-day-year-short-time",day:"long-month-day-year",month:"long-month-day-year",year:"year"};c.getAttribute=k;c.getAttributes=function(q,I){const v=[];if("class-breaks"===q.type||"heatmap"===q.type)v.push(k(q,"number"));else if("unique-value"===q.type){var e=q.authoringInfo;if(e&&"relationship"===e.type){if(e.field1&&
e.field2){var b=e.field2.field;const d=e.field2.normalizationField;v.push(k({field:e.field1.field,normalizationField:e.field1.normalizationField}));v.push(k({field:b,normalizationField:d}))}}else b=q.uniqueValueInfos?.[0],e=null,b?.value&&(b=typeof b.value,"string"===b||"number"===b)&&(e=b),v.push(k(q,e)),[q.field2,q.field3].forEach(d=>d&&v.push({type:"field",field:d}))}else"attributes"in q&&q.attributes?.forEach(d=>v.push(k(d,"number")));(q=I?I(q):"visualVariables"in q?q.visualVariables:null)&&q.forEach(d=>
v.push(k(d,"number")));return p.unique(v.filter(p.isSome),(d,w)=>"field"===d.type&&"field"===w.type?d.field===w.field:"normalized-field"===d.type&&"normalized-field"===w.type?d.field===w.field&&d.normalizationField===w.normalizationField:"expression"===d.type&&"expression"===w.type?d.expression===w.expression:!1)};c.getColorsForRendererValues=async function(q){const I=new Map;if(!q)return I;if("unique-value"!==q.type||q.authoringInfo?.type)if("class-breaks"===q.type){var v=q.classBreakInfos.map(d=>
({value:d.minValue,color:C.getColorFromSymbol(d.symbol,null)})).reverse();const {field:e,valueExpression:b}=q;await l(I,e??b,v)}else"simple"===q.type&&await l(I,"default",[{value:"default",color:C.getColorFromSymbol(q.symbol,null)}]);else{v=(q.uniqueValueInfos??[]).map(B=>({value:B.value,color:C.getColorFromSymbol(B.symbol,null)}));const {field:e,field2:b,field3:d,valueExpression:w,fieldDelimiter:G}=q,n=[e,b,d].filter(Boolean).join(G||"");(n||w)&&await l(I,n||w,v)}"defaultSymbol"in q&&q.defaultSymbol&&
await l(I,"default",[{value:"default",color:C.getColorFromSymbol(q.defaultSymbol,null)}]);if("visualVariables"in q&&q.visualVariables){q=q.visualVariables.filter(e=>"color"===e.type);for(const e of q)q=await u.getRampStops(e)??[],await l(I,e.field||e.valueExpression,q)}return I};c.getColorsFromRenderer=async function(q){const I=new Map;if(!q)return I;if("visualVariables"in q&&q.visualVariables){var v=q.visualVariables.filter(b=>"color"===b.type);for(var e of v)v=(await u.getRampStops(e)??[]).map(b=>
b.color),await f(I,e.field||e.valueExpression,v)}if("heatmap"===q.type)e=a.getHeatmapRampStops(q).map(b=>b.color),await f(I,q.field||q.valueExpression,e);else if("pie-chart"===q.type){for(const b of q.attributes)await f(I,b.field||b.valueExpression,[b.color]);await f(I,"default",[q?.othersCategory?.color,C.getColorFromSymbol(q.backgroundFillSymbol,null)])}else if("dot-density"===q.type){for(const b of q.attributes)await f(I,b.field||b.valueExpression,[b.color]);await f(I,"default",[q.backgroundColor])}else if("unique-value"===
q.type)if("predominance"===q.authoringInfo?.type)for(const b of q.uniqueValueInfos??[])await f(I,b.value.toString(),[C.getColorFromSymbol(b.symbol,null)]);else{e=(q.uniqueValueInfos??[]).map(n=>C.getColorFromSymbol(n.symbol,null));const {field:b,field2:d,field3:w,valueExpression:G}=q;(b||G)&&await f(I,b||G,e);d&&await f(I,d,e);w&&await f(I,w,e)}else if("class-breaks"===q.type){e=q.classBreakInfos.map(w=>C.getColorFromSymbol(w.symbol,null));const {field:b,valueExpression:d}=q;await f(I,b??d,e)}else"simple"===
q.type&&await f(I,"default",[C.getColorFromSymbol(q.symbol,null)]);"defaultSymbol"in q&&q.defaultSymbol&&await f(I,"default",[C.getColorFromSymbol(q.defaultSymbol,null)]);I.forEach((b,d)=>{b=p.unique(b.filter(Boolean),(w,G)=>JSON.stringify(w)===JSON.stringify(G));I.set(d,b)});return I};c.setLabelsForClassBreaks=function(q){const I=q.classBreakInfos,v=q.normalizationType;let e=[];if(I?.length)if("standard-deviation"===q.classificationMethod)m.warn("setLabelsForClassBreaks","cannot set labels for class breaks generated using 'standard-deviation' method.");
else if(q.round){e.push(I[0].minValue);for(const b of I)e.push(b.maxValue);e=E.round(e);I.forEach((b,d)=>{b.label=h({minValue:0===d?e[0]:e[d],maxValue:e[d+1],isFirstBreak:0===d,normalizationType:v})})}else I.forEach((b,d)=>{b.label=h({minValue:b.minValue,maxValue:b.maxValue,isFirstBreak:0===d,normalizationType:v})})};c.timelineDateFormatOptions=g;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/numberUtils":function(){define(["exports","../../intl","../../intl/number"],
function(c,p,g){function z(u,a){return u-a}function K(u,a){let f;f=Number(u.toFixed(a));f<u?u=f+1/10**a:(u=f,f-=1/10**a);f=Number(f.toFixed(a));u=Number(u.toFixed(a));return[f,u]}function F(u,a,f,l,h){u=H(u,a,f,l);a=null==u.next||u.next<=h;return(null==u.previous||u.previous<=h)&&a||u.previous+u.next<=2*h}function E(u){u=String(u);var a=u.match(M);if(a&&a[1])return{integer:a[1].split("").length,fractional:a[3]?a[3].split("").length:0};if(u.toLowerCase().includes("e")&&(a=u.split("e"),u=a[0],a=a[1],
u&&a)){u=Number(u);a=Number(a);const f=0<a;f||(a=Math.abs(a));u=E(u);f?(u.integer+=a,u.fractional=a>u.fractional?0:u.fractional-a):(u.fractional+=a,u.integer=a>u.integer?1:u.integer-a);return u}return{integer:0,fractional:0}}function H(u,a,f,l){const h={previous:null,next:null};if(null!=f){const k=u-f;h.previous=Math.floor(Math.abs(100*(a-f-k)/k))}null!=l&&(u=l-u,h.next=Math.floor(Math.abs(100*(l-a-u)/u)));return h}const M=/^-?(\d+)(\.(\d+))?$/i,C={maximumFractionDigits:20};c.format=function(u){return g.formatNumber(u,
C)};c.numDigits=E;c.percentChange=H;c.round=function(u,a={}){u=u.slice(0);const {tolerance:f=2,strictBounds:l=!1,indexes:h=u.map((m,r)=>r)}=a;h.sort(z);for(a=0;a<h.length;a++){const m=h[a],r=u[m],y=0===m?null:u[m-1],q=m===u.length-1?null:u[m+1],I=E(r).fractional;if(I){let v=0,e=!1;for(var k=void 0;v<=I&&!e;)k=K(r,v),k=l&&0===a?k[1]:k[0],e=F(r,k,y,q,f),v++;e&&(u[m]=k)}}return u};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/utils":function(){define("require exports ../../Color ../../symbols ../../core/asyncUtils ../../core/has ../../core/screenUtils ../../chunks/vec3f64 ../../layers/effects/jsonUtils ./cimSymbolUtils ./gfxUtils ./Symbol3DMaterial".split(" "),
function(c,p,g,z,K,F,E,H,M,C,u,a){function f(b){b=b.symbolLayers;if(!b)return null;let d=null;b.forEach(w=>{"object"===w.type&&w.resource?.href||(d="water"===w.type?w.color:w.material?w.material.color:null)});return d?new g(d):null}function l(b,d){if(null==d||null==b)return b;b=b.toRgba();b[3]*=d;return new g(b)}function h(b,d,w){if(b=b.symbolLayers){var G=n=>{d=d??n??(null!=w?e:null);return l(d,w)};b.forEach(n=>{if("object"!==n.type||!n.resource?.href||d)if("water"===n.type)n.color=G(n.color);else{const B=
G(null!=n.material?n.material.color:null);null==n.material?n.material=new a.Symbol3DMaterial({color:B}):n.material.color=B;null!=w&&"outline"in n&&null!=n.outline?.color&&(n.outline.color=l(n.outline.color,w))}})}}async function k(b,d){(b=b.symbolLayers)&&await K.forEach(b,async w=>m(w,d))}async function m(b,d){switch(b.type){case "extrude":b.size="number"===typeof d[2]?d[2]:0;break;case "icon":case "line":case "text":d=r(d);null!=d&&(b.size=d);break;case "path":const w=q(d,H.ONES,[b.width,void 0,
b.height]);b.width=v(d[0],b.width,1,w);b.height=v(d[2],b.height,1,w);break;case "object":await y(b,d)}}function r(b){for(const d of b)if("number"===typeof d)return d;return null}async function y(b,d){const {resourceSize:w,symbolSize:G}=await I(b),n=q(d,w,G);b.width=v(d[0],G[0],w[0],n);b.depth=v(d[1],G[1],w[1],n);b.height=v(d[2],G[2],w[2],n)}function q(b,d,w){for(let G=0;3>G;G++){const n=b[G];switch(n){case "symbol-value":return b=w[G],null!=b?b/d[G]:1;case "proportional":break;default:if(n&&d[G])return n/
d[G]}}return 1}async function I(b){var {computeObjectLayerResourceSize:d}=await new Promise((A,L)=>c(["./symbolLayerUtils"],A,L));d=await d(b,10);const {width:w,height:G,depth:n}=b;b=[w,n,G];let B=1;for(var x=0;3>x;x++){const A=b[x];if(null!=A){B=A/d[x];break}}for(x=0;3>x;x++)null==b[x]&&(b[x]=d[x]*B);return{resourceSize:d,symbolSize:b}}function v(b,d,w,G){switch(b){case "proportional":return w*G;case "symbol-value":return null!=d?d:w;default:return b}}const e=new g("white");p.applyColorToSymbol=
function(b,d,w){if(b&&(d||null!=w))if(d&&(d=new g(d)),z.isSymbol3D(b))h(b,d,w);else if(z.isSymbol2D(b)){if(d=d??b.color)b.color=l(d,w);null!=w&&"outline"in b&&b.outline?.color&&(b.outline.color=l(b.outline.color,w))}};p.applyOpacityToColor=l;p.applyRotationToSymbol=function(b,d,w){b&&null!=d&&(z.isSymbol3D(b)?(b=b.symbolLayers)&&b.forEach(G=>{if(G&&"object"===G.type)switch(w){case "tilt":G.tilt=d;break;case "roll":G.roll=d;break;default:G.heading=d}}):!z.isSymbol2D(b)||"simple-marker"!==b.type&&"picture-marker"!==
b.type&&"text"!==b.type||(b.angle=d))};p.applySizesToSymbol=async function(b,d){if(b&&d){if(z.isSymbol3D(b))return k(b,d);if(z.isSymbol2D(b)&&(d=r(d),null!=d))switch(b.type){case "simple-marker":b.size=d;break;case "picture-marker":const w=b.width/b.height;1<w?(b.width=d,b.height=d*w):(b.width=d*w,b.height=d);break;case "simple-line":b.width=d;break;case "text":b.font.size=d}}};p.fetchWebStyleSymbol=async function(b,d){const w=await b.fetchSymbol(d);return w?w:b.fetchCIMSymbol(d)};p.getCSSFilterFromEffectList=
function(b){if(!b)return null;b=b.effects.filter(d=>"bloom"!==d.type).map(d=>d.toJSON());return M.effectFunctionsFromJSON(b)};p.getColorFromSymbol=function(b,d){if(!b)return null;let w=null;z.isSymbol3D(b)?w=f(b):z.isSymbol2D(b)&&(w="cim"===b.type?C.getCIMSymbolColor(b):b.color?new g(b.color):null);return w?l(w,d):null};p.getIconHref=function(b){return b.resource?.href??""};p.getSymbolOutlineSize=function(b){return b?z.isSymbol3D(b)?(b=(b=b.symbolLayers?.at(-1))&&"outline"in b?b?.outline?.size:void 0,
null!=b?b:0):E.px2pt(u.getStroke(b)?.width):0};p.isVolumetricSymbol=function(b){if(null==b||!("symbolLayers"in b)||null==b.symbolLayers)return!1;switch(b.type){case "point-3d":return b.symbolLayers.some(d=>"object"===d.type);case "line-3d":return b.symbolLayers.some(d=>"path"===d.type);case "polygon-3d":return b.symbolLayers.some(d=>"object"===d.type||"extrude"===d.type);default:return!1}};p.symbolHasExtrudeSymbolLayer=function(b){return null!=b&&"polygon-3d"===b.type&&b.symbolLayers.some(d=>"extrude"===
d.type)};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/cimSymbolUtils":function(){define(["exports","../../Color","../cim/utils"],function(c,p,g){function z(a){a=g.toCIMSymbolJSON(a);if("CIMTextSymbol"===a?.type)return a.height??0;let f=0;if(a?.symbolLayers)for(const l of a.symbolLayers)g.isCIMMarker(l)&&null!=l.size&&l.size>f?f=l.size:g.isCIMStroke(l)&&null!=l.width&&l.width>f?f=l.width:g.isCIMFill(l);return f}function K(a,f,l,h){if(a)if("CIMTextSymbol"===
a.type)null!=a.height&&(a.height*=f);else{if(l&&a.effects)for(const k of a.effects)H(k,f);if(a.symbolLayers)for(const k of a.symbolLayers)switch(k.type){case "CIMPictureMarker":case "CIMVectorMarker":F(k,f,h);break;case "CIMPictureStroke":case "CIMSolidStroke":!h?.preserveOutlineWidth&&k.width&&(k.width*=f);break;case "CIMPictureFill":k.height&&(k.height*=f);k.offsetX&&(k.offsetX*=f);k.offsetY&&(k.offsetY*=f);break;case "CIMHatchFill":K(k.lineSymbol,f,!0,{...h,preserveOutlineWidth:!1}),k.offsetX&&
(k.offsetX*=f),k.offsetY&&(k.offsetY*=f),k.separation&&(k.separation*=f)}}}function F(a,f,l){if(a&&(a.markerPlacement&&E(a.markerPlacement,f),a.offsetX&&(a.offsetX*=f),a.offsetY&&(a.offsetY*=f),a.anchorPoint&&"Absolute"===a.anchorPointUnits&&(a.anchorPoint={x:a.anchorPoint.x*f,y:a.anchorPoint.y*f}),a.size=null!=a.size?a.size*f:0,"CIMVectorMarker"===a.type&&a.markerGraphics))for(const h of a.markerGraphics)a.scaleSymbolsProportionally||K(h.symbol,f,!0,l)}function E(a,f){g.isCIMMarkerStrokePlacement(a)&&
a.offset&&(a.offset*=f);switch(a.type){case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineSameSize":a.customEndingOffset&&(a.customEndingOffset*=f);a.offsetAlongLine&&(a.offsetAlongLine*=f);if(a.placementTemplate&&a.placementTemplate.length){var l=a.placementTemplate.map(h=>h*f);a.placementTemplate=l}break;case "CIMMarkerPlacementAlongLineVariableSize":a.maxRandomOffset&&(a.maxRandomOffset*=f);a.placementTemplate&&a.placementTemplate.length&&(l=a.placementTemplate.map(h=>
h*f),a.placementTemplate=l);break;case "CIMMarkerPlacementOnLine":a.startPointOffset&&(a.startPointOffset*=f);break;case "CIMMarkerPlacementAtExtremities":a.offsetAlongLine&&(a.offsetAlongLine*=f);break;case "CIMMarkerPlacementAtRatioPositions":a.beginPosition&&(a.beginPosition*=f);a.endPosition&&(a.endPosition*=f);break;case "CIMMarkerPlacementPolygonCenter":a.offsetX&&(a.offsetX*=f);a.offsetY&&(a.offsetY*=f);break;case "CIMMarkerPlacementInsidePolygon":a.offsetX&&(a.offsetX*=f),a.offsetY&&(a.offsetY*=
f),a.stepX&&(a.stepX*=f),a.stepY&&(a.stepY*=f)}}function H(a,f){switch(a.type){case "CIMGeometricEffectArrow":case "CIMGeometricEffectDonut":a.width&&(a.width*=f);break;case "CIMGeometricEffectBuffer":a.size&&(a.size*=f);break;case "CIMGeometricEffectCut":a.beginCut&&(a.beginCut*=f);a.endCut&&(a.endCut*=f);a.middleCut&&(a.middleCut*=f);break;case "CIMGeometricEffectDashes":a.customEndingOffset&&(a.customEndingOffset*=f);a.offsetAlongLine&&(a.offsetAlongLine*=f);if(a.dashTemplate&&a.dashTemplate.length){const l=
a.dashTemplate.map(h=>h*f);a.dashTemplate=l}break;case "CIMGeometricEffectExtension":case "CIMGeometricEffectJog":case "CIMGeometricEffectRadial":a.length&&(a.length*=f);break;case "CIMGeometricEffectMove":a.offsetX&&(a.offsetX*=f);a.offsetY&&(a.offsetY*=f);break;case "CIMGeometricEffectOffset":case "CIMGeometricEffectOffsetTangent":a.offset&&(a.offset*=f);break;case "CIMGeometricEffectRegularPolygon":a.radius&&(a.radius*=f);break;case "CIMGeometricEffectTaperedPolygon":a.fromWidth&&(a.fromWidth*=
f);a.length&&(a.length*=f);a.toWidth&&(a.toWidth*=f);break;case "CIMGeometricEffectWave":a.amplitude&&(a.amplitude*=f),a.period&&(a.period*=f)}}function M(a,f){if(a){var l="CIMTextSymbol"===a.type?a.symbol:a;a="CIMPolygonSymbol"===a.type;if(l?.symbolLayers)for(const h of l.symbolLayers)if(!(h.colorLocked||a&&(g.isCIMStroke(h)||g.isCIMMarker(h)&&h.markerPlacement&&g.isCIMMarkerStrokePlacement(h.markerPlacement))))switch(h.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":h.tintColor&&
C(f,h.tintColor);break;case "CIMVectorMarker":h.markerGraphics?.forEach(k=>{M(k.symbol,f)});break;case "CIMSolidStroke":case "CIMSolidFill":C(f,h.color);break;case "CIMHatchFill":M(h.lineSymbol,f)}}}function C(a,f){for(const l of a)if(l.join(".")===f.join("."))return;a.push(f)}function u(a,f,l){if(a){var h="CIMTextSymbol"===a.type?a.symbol:a;a="CIMPolygonSymbol"===h?.type;if(h?.symbolLayers)for(const k of h.symbolLayers)if(!k.colorLocked){if(a)if(l){if({layersToColor:h}=l,(g.isCIMStroke(k)||g.isCIMMarker(k)&&
k.markerPlacement&&g.isCIMMarkerStrokePlacement(k.markerPlacement))&&"fill"===h||g.isCIMFill(k)&&"outline"===h)continue}else if(g.isCIMStroke(k)||g.isCIMMarker(k)&&k.markerPlacement&&g.isCIMMarkerStrokePlacement(k.markerPlacement))continue;h=f.toArray();switch(k.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":k.tintColor=h;break;case "CIMVectorMarker":k.markerGraphics?.forEach(m=>{u(m.symbol,f,l)});break;case "CIMSolidStroke":case "CIMSolidFill":k.color=h;break;case "CIMHatchFill":u(k.lineSymbol,
f,l)}}}}c.applyCIMSymbolColor=function(a,f,l){f instanceof p||(f=new p(f));(a=g.toCIMSymbolJSON(a))&&u(a,f,l)};c.applyCIMSymbolRotation=function(a,f,l=!1){a=g.toCIMSymbolJSON(a);l&&0!==f&&(f=360-f);if("CIMTextSymbol"===a?.type)a.angle=f;else if("CIMPointSymbol"===a?.type&&a.symbolLayers){l=f-(a.angle||0);for(const h of a.symbolLayers)if(g.isCIMMarker(h)){let k=h.rotation||0;k=h.rotateClockwise?k-l:k+l;h.rotation=k}a.angle=f}};c.getCIMSymbolColor=function(a){a=g.toCIMSymbolJSON(a);const f=[];M(a,f);
return f.length?new p(g.fromCIMColor(f[0])):null};c.getCIMSymbolRotation=function(a,f=!1){a=g.toCIMSymbolJSON(a);return"CIMTextSymbol"===a?.type||"CIMPointSymbol"===a?.type?(a=a.angle,null!=a&&0!==a&&f?360-a:a??0):0};c.getCIMSymbolSize=z;c.getCIMSymbolType=function(a){a=g.toCIMSymbolJSON(a);if(!a)return null;switch(a.type){case "CIMPointSymbol":return"CIMPointSymbol";case "CIMLineSymbol":return"CIMLineSymbol";case "CIMPolygonSymbol":return"CIMPolygonSymbol";case "CIMTextSymbol":return"CIMTextSymbol";
case "CIMMeshSymbol":return"CIMMeshSymbol";default:return null}};c.scaleCIMMarker=F;c.scaleCIMSymbol=K;c.scaleCIMSymbolTo=function(a,f,l){if(a){var h=g.toCIMSymbolJSON(a);a=z(a);if(0===a){if(h)if("CIMTextSymbol"===h.type)h.height=f;else if(h.symbolLayers)for(const k of h.symbolLayers)switch(k.type){case "CIMPictureMarker":case "CIMVectorMarker":k.size=f;break;case "CIMPictureStroke":case "CIMSolidStroke":k.width=f}}else K(h,f/a,!1,l)}};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},
"esri/symbols/cim/utils":function(){define(["require","exports"],function(c,p){function g(a){return"function"===typeof a}function z(a){let f=a.length;for(;f--;)if(!" /-,\n".includes(a.charAt(f)))return!1;return!0}function K(a,f){const l=[];var h=0;let k=-1;do k=a.indexOf("[",h),k>=h&&(k>h&&(h=a.substr(h,k-h),l.push([h,null,z(h)])),h=k+1,k=a.indexOf("]",h),k>=h&&(k>h&&(h=a.substr(h,k-h),(h=f[h])&&l.push([null,h,!1])),h=k+1));while(-1!==k);h<a.length-1&&(a=a.substr(h),l.push([a,null,z(a)]));return l}
function F(a,f,l){let h="",k=null;for(const m of f){const [r,y,q]=m;if(r)q?k=r:(k&&(h+=k,k=null),h+=r);else if(f=a.attributes[y])k&&(h+=k,k=null),h+=f}return E(h,l)}function E(a,f){"string"!==typeof a&&(a=String(a));switch(f){case "LowerCase":return a.toLowerCase();case "Allcaps":return a.toUpperCase();default:return a}}function H(a){return a?{r:a[0],g:a[1],b:a[2],a:a[3]/255}:{r:0,g:0,b:0,a:0}}function M(a){if(!a)return null;switch(a.type){case "CIMPolygonSymbol":if(a.symbolLayers)for(const f of a.symbolLayers)if(a=
M(f),null!=a)return a;break;case "CIMTextSymbol":return M(a.symbol);case "CIMSolidFill":return a.color}}function C(a){if(a)switch(a.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(a=a.symbolLayers)for(const f of a)if(a=C(f),null!=a)return a;break;case "CIMTextSymbol":return C(a.symbol);case "CIMSolidStroke":return a.color}}function u(a){if(a)switch(a.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(a.symbolLayers)for(const f of a.symbolLayers)if(a=u(f),void 0!==a)return a;break;case "CIMTextSymbol":return u(a.symbol);
case "CIMSolidStroke":case "CIMGradientStroke":case "CIMPictureStroke":return a.width}}p.adjustTextCase=E;p.analyzeTextParts=K;p.assignTextValuesFromFeature=F;p.attributesToFields=function(a){return(a?Object.keys(a):[]).map(f=>({name:f,alias:f,type:"string"===typeof a[f]?"esriFieldTypeString":"esriFieldTypeDouble"}))};p.colorToArray=function(a){return[a.r,a.g,a.b,a.a]};p.createLabelOverrideFunction=function(a,f,l){const h=K(f,a);return k=>F(k,h,l)};p.evaluateValueOrFunction=function(a,f,l,h){return g(a)?
a(f,l,h):a};p.fromCIMColor=H;p.fromCIMFontDecoration=function(a){return a.underline?"underline":a.strikethrough?"line-through":"none"};p.fromCIMFontStyle=function(a){let f="normal",l="normal";a&&(a=a.toLowerCase(),a.includes("italic")?f="italic":a.includes("oblique")&&(f="oblique"),a.includes("bold")?l="bold":a.includes("light")&&(l="lighter"));return{style:f,weight:l}};p.fromCIMHorizontalAlignment=function(a){switch(a){default:return"left";case "Right":return"right";case "Center":return"center";
case "Justify":return"center"}};p.fromCIMVerticalAlignment=function(a){switch(a){default:return"top";case "Center":return"middle";case "Baseline":return"baseline";case "Bottom":return"bottom"}};p.getFillColor=M;p.getFontStyle=function(a){if(!a)return"normal";switch(a.toLowerCase()){case "italic":return"italic";case "oblique":return"oblique";default:return"normal"}};p.getFontWeight=function(a){if(!a)return"normal";switch(a.toLowerCase()){case "bold":return"bold";case "bolder":return"bolder";case "lighter":return"lighter";
default:return"normal"}};p.getStrokeColor=C;p.getStrokeWidth=u;p.getTintColor=a=>a.tintColor?H(a.tintColor):{r:255,g:255,b:255,a:1};p.getValue=(a,f=0)=>null==a||isNaN(a)?f:a;p.importGeometryEngine=function(){return new Promise((a,f)=>c(["../../geometry/geometryEngineJSON"],a,f))};p.isCIMFill=function(a){return null!=a&&("CIMGradientFill"===a.type||"CIMHatchFill"===a.type||"CIMPictureFill"===a.type||"CIMSolidFill"===a.type||"CIMWaterFill"===a.type)};p.isCIMMarker=function(a){return"CIMVectorMarker"===
a.type||"CIMPictureMarker"===a.type||"CIMBarChartMarker"===a.type||"CIMCharacterMarker"===a.type||"CIMPieChartMarker"===a.type||"CIMStackedBarChartMarker"===a.type};p.isCIMMarkerStrokePlacement=function(a){return null!=a&&("CIMMarkerPlacementAlongLineRandomSize"===a.type||"CIMMarkerPlacementAlongLineSameSize"===a.type||"CIMMarkerPlacementAlongLineVariableSize"===a.type||"CIMMarkerPlacementAtExtremities"===a.type||"CIMMarkerPlacementAtMeasuredUnits"===a.type||"CIMMarkerPlacementAtRatioPositions"===
a.type||"CIMMarkerPlacementOnLine"===a.type||"CIMMarkerPlacementOnVertices"===a.type)};p.isCIMStroke=function(a){return"CIMGradientStroke"===a.type||"CIMPictureStroke"===a.type||"CIMSolidStroke"===a.type};p.isFeatureValueFn=g;p.isGeometryEngineRequired=a=>{if(!a)return!1;for(const f of a)switch(f.type){case "CIMGeometricEffectBuffer":case "CIMGeometricEffectOffset":case "CIMGeometricEffectDonut":return!0}return!1};p.isSVGImage=a=>a.includes("data:image/svg+xml");p.mapCIMSymbolToGeometryType=function(a){if(!a)return null;
switch(a.type){case "CIMPointSymbol":case "CIMTextSymbol":return"esriGeometryPoint";case "CIMLineSymbol":return"esriGeometryPolyline";case "CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}};p.resampleHermite=function(a,f,l,h,k,m,r=!0){const y=f/k;l/=m;const q=Math.ceil(y/2),I=Math.ceil(l/2);for(let b=0;b<m;b++)for(let d=0;d<k;d++){const w=4*(d+(r?m-b-1:b)*k);var v=0;let G=0,n=0,B=0,x=0,A=0,L=0;const O=(b+.5)*l;for(let N=Math.floor(b*l);N<(b+1)*l;N++){var e=Math.abs(O-(N+.5))/I;const Q=
(d+.5)*y;e*=e;for(let U=Math.floor(d*y);U<(d+1)*y;U++){let V=Math.abs(Q-(U+.5))/q;v=Math.sqrt(e+V*V);-1<=v&&1>=v&&(v=2*v*v*v-3*v*v+1,0<v&&(V=4*(U+N*f),L+=v*a[V+3],n+=v,255>a[V+3]&&(v=v*a[V+3]/250),B+=v*a[V],x+=v*a[V+1],A+=v*a[V+2],G+=v))}}h[w]=B/G;h[w+1]=x/G;h[w+2]=A/G;h[w+3]=L/n}};p.toCIMSymbolJSON=function(a){return a.data?.symbol??null};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/gfxUtils":function(){define("exports ../../assets ../../Color ../../request ../../core/LRUCache ../../core/screenUtils ./cimSymbolUtils".split(" "),
function(c,p,g,z,K,F,E){function H(u){if(!u)return null;let a=null;switch(u.type){case "simple-fill":case "picture-fill":case "simple-marker":a=H(u.outline);break;case "simple-line":const f=F.pt2px(u.width);null!=u.style&&"none"!==u.style&&0!==f&&(a={color:u.color,style:C(u.style),width:f,cap:u.cap,join:"miter"===u.join?F.pt2px(u.miterLimit):u.join});break;default:a=null}return a}const M=new K.LRUCache(1E3),C=(()=>{const u={};return a=>{if(u[a])return u[a];const f=a.replaceAll("-","");return u[a]=
f}})();g=new g([128,128,128]);c.defaultThematicColor=g;c.dekebabifyLineStyle=C;c.getFill=function(u){const a=u.style;let f=null;if(u)switch(u.type){case "simple-marker":"cross"!==a&&"x"!==a&&(f=u.color);break;case "simple-fill":"solid"===a?f=u.color:"none"!==a&&(f={type:"pattern",x:0,y:0,src:p.getAssetUrl(`esri/symbols/patterns/${a}.png`),width:5,height:5});break;case "picture-fill":f={type:"pattern",src:u.url,width:F.pt2px(u.width)*u.xscale,height:F.pt2px(u.height)*u.yscale,x:F.pt2px(u.xoffset),
y:F.pt2px(u.yoffset)};break;case "text":f=u.color;break;case "cim":f=E.getCIMSymbolColor(u)}return f};c.getPatternUrlWithColor=function(u,a){const f=u+"-"+a;return void 0!==M.get(f)?Promise.resolve(M.get(f)):z(u,{responseType:"image"}).then(l=>{l=l.data;const h=l.naturalWidth,k=l.naturalHeight,m=document.createElement("canvas");m.width=h;m.height=k;const r=m.getContext("2d");r.fillStyle=a;r.fillRect(0,0,h,k);r.globalCompositeOperation="destination-in";r.drawImage(l,0,0);l=m.toDataURL();M.put(f,l);
return l})};c.getStroke=H;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/colorRampUtils":function(){define(["require","exports","../../../Color","./utils"],function(c,p,g,z){function K(C,u){const a=[],f=C.length-1;5===C.length?a.push(0,2,4):a.push(0,f);return C.map((l,h)=>a.includes(h)?z.createStopLabel(l,h,f,u):null)}async function F(C,u,a){a=new g(a??M);C=(await new Promise((f,l)=>c(["../../../renderers/visualVariables/support/visualVariableUtils"],
f,l))).getOpacity(u,C);null!=C&&(a.a=C);return a}function E(C,u){const {startIndex:a,endIndex:f,weight:l}=H(C,u);if(a===f)return u[a].color;C=g.blendColors(u[a].color,u[f].color,l);return new g(C)}function H(C,u){let a=0,f=u.length-1;u.some((l,h)=>{if(C<l.value)return f=h,!0;a=h;return!1});return{startIndex:a,endIndex:f,weight:(C-u[a].value)/(u[f].value-u[a].value)}}const M=new g([64,64,64]);p.getColorFromPointCloudStops=E;p.getRampStops=async function(C,u,a){let f=!1,l=[],h=[];if(C.stops){var k=
C.stops;l=k.map(r=>r.value);(f=k.some(r=>!!r.label))&&(h=k.map(r=>r.label))}k=l[l.length-1];if(null==l[0]&&null==k)return null;const m=f?null:K(l,a);return(await Promise.all(l.map(async(r,y)=>{const q="opacity"===C.type?await F(r,C,u):(await new Promise((I,v)=>c(["../../../renderers/visualVariables/support/visualVariableUtils"],I,v))).getColor(C,r);return{value:r,color:q,label:f?h[y]:m?.[y]??""}}))).reverse()};p.getRampStopsForPointCloud=function(C){let u=!1,a=[],f=[];a=C.map(k=>k.value);(u=C.some(k=>
!!k.label))&&(f=C.map(k=>k.label??""));const l=a[a.length-1];if(null==a[0]&&null==l)return null;const h=u?null:K(a);return a.map((k,m)=>{const r=E(k,C);return{value:k,color:r,label:u?f[m]:h?.[m]??""}}).reverse()};p.getStrectchRampStops=function(C,u){let a=[];if(C&&"multipart"===C.type)C.colorRamps.reverse().forEach((f,l)=>{0===l?a.push({value:u.max,color:new g(f.toColor),label:"high"}):a.push({value:null,color:new g(f.toColor),label:""});l===C.colorRamps.length-1?a.push({value:u.min,color:new g(f.fromColor),
label:"low"}):a.push({value:null,color:new g(f.fromColor),label:""})});else{let f,l;C&&"algorithmic"===C.type?(f=C.fromColor,l=C.toColor):(f=[0,0,0,1],l=[255,255,255,1]);a=[{value:u.max,color:new g(l),label:"high"},{value:u.min,color:new g(f),label:"low"}]}return a};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/utils":function(){define("require exports ../../../symbols ../../../renderers/support/numberUtils ../../../smartMapping/support/utils ../../../symbols/SimpleLineSymbol".split(" "),
function(c,p,g,z,K,F){async function E(H){if(!("visualVariables"in H&&H.visualVariables))return null;H=H.visualVariables.find(u=>"color"===u.type);if(!H)return null;var M=null,C=null;if(H.stops){if(1===H.stops.length)return H.stops[0].color;M=H.stops[0].value;C=H.stops[H.stops.length-1].value}M=null!=M&&null!=C?M+(C-M)/2:0;({getColor:C}=await new Promise((u,a)=>c(["../../../renderers/visualVariables/support/visualVariableUtils"],u,a)));return C(H,M)??null}p.createStopLabel=function(H,M,C,u){let a=
"";0===M?a="\x3c ":M===C&&(a="\x3e ");H=u?K.formatAnyDate(H,u):z.format(H);return a+H};p.getMedianColor=E;p.getSymbolForFlowRenderer=async function(H,M){const C=H.trailCap,u=H.trailWidth||1;H=M||await E(H)||H.color;return new F({cap:C,color:H,width:u})};p.isRasterBandStatistics=function(H){return null!=H&&"object"===typeof H&&"min"in H&&"max"in H};p.rgbImgSource=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII\x3d",
"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII\x3d","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII\x3d"];p.specialCharsGreaterThan="\x3e";p.specialCharsLessThan="\x3c";Object.defineProperty(p,Symbol.toStringTag,
{value:"Module"})})},"esri/widgets/Legend/support/heatmapRampUtils":function(){define(["exports","../../../renderers/support/HeatmapColorStop"],function(c,p){c.getHeatmapRampStops=function(g){if(!g.colorStops)return[];const z=[...g.colorStops].filter(F=>0<F.color?.a);let K=z.length-1;if(z&&z[0]){const F=z[K];F&&1!==F.ratio&&(z.push(new p({ratio:1,color:F.color})),K++)}return z.map((F,E)=>{let H="";0===E?H=g.legendOptions?.minLabel||"low":E===K&&(H=g.legendOptions?.maxLabel||"high");return{color:F.color,
label:H,ratio:F.ratio}}).reverse()};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureMedia/FeatureMediaViewModel":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/arrayUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/cast ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../popup/FieldInfo ../../../popup/content/support/ChartMediaInfoValueSeries ../support/featureUtils ../support/relatedFeatureUtils".split(" "),
function(c,p,g,z,K,F,E,H,M,C,u){const a={chartAnimation:!0};p=class extends p{constructor(f){super(f);this.abilities={...a};this.activeMediaInfoIndex=0;this.expressionAttributes=this.formattedAttributes=this.fieldInfoMap=this.description=this.attributes=null;this.isAggregate=!1;this.title=this.relatedInfos=this.popupTemplate=this.mediaInfos=this.layer=null}castAbilities(f){return{...a,...f}}get activeMediaInfo(){return this.formattedMediaInfos[this.activeMediaInfoIndex]||null}get formattedMediaInfos(){return this._formatMediaInfos()||
[]}get formattedMediaInfoCount(){return this.formattedMediaInfos.length}setActiveMedia(f){this._setContentElementMedia(f)}next(){this._pageContentElementMedia(1)}previous(){this._pageContentElementMedia(-1)}_setContentElementMedia(f){const {formattedMediaInfoCount:l}=this;this.activeMediaInfoIndex=(f+l)%l}_pageContentElementMedia(f){const {activeMediaInfoIndex:l}=this;this._setContentElementMedia(l+f)}_formatMediaInfos(){const {mediaInfos:f,layer:l}=this,h=this.attributes??{},k=this.formattedAttributes??
{},m=this.expressionAttributes??{},r=this.fieldInfoMap??new Map;return f?.map(y=>{y=y?.clone();if(!y)return null;y.title=C.substituteFieldsInLinksAndAttributes({attributes:h,fieldInfoMap:r,globalAttributes:k,expressionAttributes:m,layer:l,text:y.title});y.caption=C.substituteFieldsInLinksAndAttributes({attributes:h,fieldInfoMap:r,globalAttributes:k,expressionAttributes:m,layer:l,text:y.caption});y.altText=C.substituteFieldsInLinksAndAttributes({attributes:h,fieldInfoMap:r,globalAttributes:k,expressionAttributes:m,
layer:l,text:y.altText});if("image"===y.type){var {value:q}=y;this._setImageValue({value:q,formattedAttributes:k,layer:l});return y.value.sourceURL?y:void 0}return"pie-chart"===y.type||"line-chart"===y.type||"column-chart"===y.type||"bar-chart"===y.type?({value:q}=y,this._setChartValue({value:q,chartType:y.type,attributes:h,formattedAttributes:k,layer:l,expressionAttributes:m}),y):null}).filter(g.isSome)??[]}_setImageValue(f){const l=this.fieldInfoMap??new Map,{value:h,formattedAttributes:k,layer:m}=
f,{linkURL:r,sourceURL:y}=h;y&&(f=C.fixTokens(y,m),h.sourceURL=C.substituteAttributes({formattedAttributes:k,template:f,fieldInfoMap:l}));r&&(f=C.fixTokens(r,m),h.linkURL=C.substituteAttributes({formattedAttributes:k,template:f,fieldInfoMap:l}))}_setChartValue(f){const {value:l,attributes:h,formattedAttributes:k,chartType:m,layer:r,expressionAttributes:y}=f,{popupTemplate:q,relatedInfos:I}=this,{fields:v,normalizeField:e}=l;l.fields=C.getFixedFieldNames(v,r);e&&(l.normalizeField=C.getFixedFieldName(e,
r));if(v.some(d=>!!(null!=k[d]||C.isRelatedField(d)&&I?.size))){var b=q?.fieldInfos??[];v.forEach((d,w)=>{w=l.colors?.[w];C.isRelatedField(d)?l.series=[...l.series,...this._getRelatedChartInfos({fieldInfos:b,fieldName:d,formattedAttributes:k,chartType:m,value:l,color:w})]:(d=this._getChartOption({value:l,attributes:h,chartType:m,formattedAttributes:k,expressionAttributes:y,fieldName:d,fieldInfos:b,color:w}),l.series.push(d))})}}_getRelatedChartInfos(f){const {fieldInfos:l,fieldName:h,formattedAttributes:k,
chartType:m,value:r,color:y}=f,q=[],I=u.getRelatedFieldInfo(h);f=I&&this.relatedInfos?.get(I.layerId.toString());if(!f)return q;const {relatedFeatures:v,relation:e}=f;if(!e||!v)return q;({cardinality:f}=e);v.forEach(b=>{const {attributes:d}=b;d&&Object.keys(d).forEach(w=>{w===I.fieldName&&q.push(this._getChartOption({value:r,attributes:d,formattedAttributes:k,fieldName:h,chartType:m,relatedFieldName:w,hasMultipleRelatedFeatures:1<v?.length,fieldInfos:l,color:y}))})});return"one-to-many"===f||"many-to-many"===
f?q:[q[0]]}_getTooltip({label:f,value:l,chartType:h}){return"pie-chart"===h?`${f}`:`${f}: ${l}`}_getChartOption(f){const {value:l,attributes:h,formattedAttributes:k,expressionAttributes:m,fieldName:r,relatedFieldName:y,fieldInfos:q,chartType:I,hasMultipleRelatedFeatures:v,color:e}=f;var b=this.layer,d=this.fieldInfoMap??new Map;const {normalizeField:w,tooltipField:G}=l;f=w?C.isRelatedField(w)?h[u.getRelatedFieldInfo(w).fieldName]:h[w]:null;var n=C.isExpressionField(r)&&m&&void 0!==m[r]?m[r]:y&&void 0!==
h[y]?h[y]:void 0!==h[r]?h[r]:k[r];f=new M({fieldName:r,color:e,value:void 0===n?null:n&&f?n/f:n});if(C.isRelatedField(r))return b=d.get(r.toLowerCase()),n=G&&d.get(G.toLowerCase()),d=b?.fieldName??r,n=v&&G?u.getRelatedFieldInfo(G).fieldName:n?.fieldName??G,f.tooltip=this._getTooltip({label:v&&n?h[n]:k[n]??b?.label??b?.fieldName??y,value:v&&y?h[y]:k[d],chartType:I}),f;d=C.getFieldInfo(q,r);b=C.getFixedFieldName(r,b);d=G&&void 0!==k[G]?k[G]:C.getFieldInfoLabel(d||new H({fieldName:b}),this.popupTemplate?.expressionInfos);
f.tooltip=this._getTooltip({label:d,value:k[b],chartType:I});return f}};c.__decorate([z.property()],p.prototype,"abilities",void 0);c.__decorate([K.cast("abilities")],p.prototype,"castAbilities",null);c.__decorate([z.property()],p.prototype,"activeMediaInfoIndex",void 0);c.__decorate([z.property({readOnly:!0})],p.prototype,"activeMediaInfo",null);c.__decorate([z.property()],p.prototype,"attributes",void 0);c.__decorate([z.property()],p.prototype,"description",void 0);c.__decorate([z.property()],p.prototype,
"fieldInfoMap",void 0);c.__decorate([z.property()],p.prototype,"formattedAttributes",void 0);c.__decorate([z.property()],p.prototype,"expressionAttributes",void 0);c.__decorate([z.property({readOnly:!0})],p.prototype,"formattedMediaInfos",null);c.__decorate([z.property()],p.prototype,"isAggregate",void 0);c.__decorate([z.property()],p.prototype,"layer",void 0);c.__decorate([z.property({readOnly:!0})],p.prototype,"formattedMediaInfoCount",null);c.__decorate([z.property()],p.prototype,"mediaInfos",
void 0);c.__decorate([z.property()],p.prototype,"popupTemplate",void 0);c.__decorate([z.property()],p.prototype,"relatedInfos",void 0);c.__decorate([z.property()],p.prototype,"title",void 0);return p=c.__decorate([E.subclass("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")],p)})},"esri/widgets/Feature/support/relatedFeatureUtils":function(){define("exports ../../../request ../../../core/arrayUtils ../../../core/Error ../../../core/Logger ../../../core/promiseUtils ../../../layers/support/fieldUtils ../../../core/has ../../../layers/support/source/DataLayerSource ../../../rest/query/executeQueryJSON ../../../config ../../../kernel ../../../core/urlUtils ../../../core/unitUtils ../../../geometry/ellipsoidUtils ../../../geometry/support/spatialReferenceUtils ../../../layers/graphics/featureConversionUtils ../../../geometry/Extent ../../../geometry/Geometry ../../../geometry/Multipoint ../../../geometry/Point ../../../geometry/Polygon ../../../geometry/Polyline ../../../geometry/support/normalizeUtils ../../../core/pbf ../../../rest/support/FeatureSet ../../../rest/support/Query ../../../rest/query/support/AttachmentInfo ../../../rest/support/AttachmentQuery ../../../geometry ../../../rest/support/RelationshipQuery ../../../rest/support/TopFeaturesQuery ../../../rest/support/StatisticDefinition ./featureUtils".split(" "),
function(c,p,g,z,K,F,E,H,M,C,u,a,f,l,h,k,m,r,y,q,I,v,e,b,d,w,G,n,B,x,A,L,O,N){function Q(T,S){if(!S.relationships)return null;let t=null;({relationships:S}=S);S.some(D=>D.id===parseInt(T,10)?(t=D,!0):!1);return t}function U({originRelationship:T,relationships:S,layerId:t}){let D=null;S&&S.some(J=>{`${J.relatedTableId}`===t&&J.id===T?.id&&(D=J);return!!D});return D}function V(T,S){S=S.toLowerCase();for(const t in T)if(t.toLowerCase()===S)return T[t];return null}function ba(T,S,t,D){const J=new A;J.outFields=
["*"];J.relationshipId="number"===typeof S.id?S.id:parseInt(S.id,10);J.objectIds=[T.attributes[t.objectIdField]];return t.queryRelatedFeatures?.(J,D)??Promise.resolve({})}function Y(T,S,t){let D=0;const J=[];for(;D<S.length;)J.push(`${T} IN (${S.slice(D,t+D)})`),D+=t;return J.join(" OR ")}function aa(T){return T?g.unique(T):void 0}function da(T){return T?g.unique(T,(S,t)=>JSON.stringify(S.toJSON())===JSON.stringify(t.toJSON())):void 0}async function ja(T,S,t,D){var J=t.layerId.toString();const {layerInfo:P,
relation:R,relatedFields:W,outStatistics:Z,url:X,sourceSpatialReference:ca}=S;S=aa(W);const ha=da(Z);if(!P||!R)return null;J=U({originRelationship:R,relationships:P.relationships,layerId:J});if(J?.relationshipTableId&&J.keyFieldInRelationshipTable){t=(await ba(T,J,t,D))[T.attributes[t.objectIdField]];if(!t)return null;const la=t.features.map(ka=>ka.attributes[P.objectIdField]);if(ha?.length&&P.supportsStatistics)return D=new G,D.where=Y(P.objectIdField,la,1E3),D.outFields=S,D.outStatistics=ha,D.sourceSpatialReference=
ca,D={features:Promise.resolve(t),statsFeatures:C.executeQueryJSON(X,D)},F.eachAlways(D)}return(t=J?.keyField)?(J=E.isNumericField(ia(P.fields,t)),T=V(T.attributes,R.keyField),t=J?`${t}=${T}`:`${t}='${T}'`,T=C.executeQueryJSON(X,new G({where:t,outFields:S,sourceSpatialReference:ca}),D),D=ha?.length&&P.supportsStatistics?C.executeQueryJSON(X,new G({where:t,outFields:S,outStatistics:ha,sourceSpatialReference:ca}),D):null,S={features:T},D&&(S.statsFeatures=D),F.eachAlways(S)):null}function ia(T,S){if(null!=
T){S=S.toLowerCase();for(const t of T)if(t&&t.name.toLowerCase()===S)return t}return null}const fa=K.getLogger("esri.widgets.Feature.support.relatedFeatureUtils"),ea=new Map;c.createRelatedInfo=function(T,S){if(T=Q(T,S))return{url:`${S.url}/${T.relatedTableId}`,sourceSpatialReference:S.spatialReference,relation:T,relatedFields:[],outStatistics:[]}};c.getDestinationRelation=U;c.getRelatedFieldInfo=function(T){if(!N.isRelatedField(T))return null;const [S,t]=T.split("/").slice(1);return{layerId:S,fieldName:t}};
c.getUniqueOutFields=aa;c.getUniqueOutStatistics=da;c.queryLayerInfos=function({relatedInfos:T,layer:S},t){const D={};T.forEach((J,P)=>{({relation:J}=J);if(!J)throw P=new z("relation-required","A relation is required on a layer to retrieve related records."),fa.error(P),P;({relatedTableId:J}=J);if("number"!==typeof J)throw P=new z("A related table ID is required on a layer to retrieve related records."),fa.error(P),P;J=`${S.url}/${J}`;const R=ea.get(J),W=R??p(J,{query:{f:"json"},signal:(void 0)?.signal});
R||ea.set(J,W);D[P]=W});return F.whenOrAbort(F.eachAlways(D),t)};c.queryRelatedFeatures=function({graphic:T,relatedInfos:S,layer:t},D){const J={};S.forEach((P,R)=>{P.layerInfo&&(J[R]=ja(T,P,t,D))});return F.eachAlways(J)};c.setRelatedFeatures=function(T,S){if(S&&T){var {features:t,statsFeatures:D}=T;T=t?.value;S.relatedFeatures=T?T.features:[];T=D?.value;S.relatedStatsFeatures=T?T.features:[]}};c.updateRelatedInfo=function({relatedInfo:T,fieldName:S,fieldInfo:t}){T.relatedFields?.push(S);t.statisticType&&
(S=new O({statisticType:t.statisticType,onStatisticField:S,outStatisticFieldName:S}),T.outStatistics?.push(S))};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureExpression/FeatureExpressionViewModel":function(){define("../../../chunks/tslib.es6 ../../../Graphic ../../../core/Accessor ../../../core/reactiveUtils ../../../core/throttle ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../popup/content/AttachmentsContent ../../../popup/content/Content ../../../popup/content/CustomContent ../../../popup/content/ExpressionContent ../../../popup/content/FieldsContent ../../../popup/content/MediaContent ../../../popup/content/RelationshipContent ../../../popup/content/TextContent ../../../popup/ElementExpressionInfo ../FeatureContent/FeatureContentViewModel ../FeatureFields/FeatureFieldsViewModel ../FeatureMedia/FeatureMediaViewModel ../support/arcadeFeatureUtils".split(" "),
function(c,p,g,z,K,F,E,H,M,C,u,a,f,l,h,k,m,r,y,q,I,v,e){g=class extends g{constructor(b){super(b);this.view=this.interceptor=this.contentElementViewModel=this.contentElement=this.graphic=this.expressionInfo=this._abortController=null;this._cancelQuery=()=>{const {_abortController:d}=this;d&&d.abort();this._abortController=null};this._createVM=()=>{var d=this.contentElement?.type;this.contentElementViewModel?.destroy();d="fields"===d?new I:"media"===d?new v:"text"===d?new q:null;this._set("contentElementViewModel",
d)};this._compile=async()=>{this._cancelQuery();const d=new AbortController;this._abortController=d;await this._compileExpression();this._abortController===d&&(this._abortController=null)};this._compileThrottled=K.throttle(this._compile,1,this);this._compileExpression=async()=>{const {expressionInfo:d,graphic:w,interceptor:G,spatialReference:n,map:B,view:x,_abortController:A}=this;if(d&&w&&n&&B){var L=await e.loadArcadeUtils();if(A===this._abortController)if((L=await e.createCompiledExpression({arcadeUtils:L,
expressionInfo:d,graphic:w,interceptor:G,map:B,spatialReference:n,view:x}))&&"esri.arcade.Dictionary"===L.declaredClass){L=await L.castAsJsonAsync(A?.signal);var O=L?.type;L="media"===O?k.fromJSON(L):"text"===O?r.fromJSON(L):"fields"===O?h.fromJSON(L):null;this._set("contentElement",L)}else this._set("contentElement",null)}else this._set("contentElement",null)};this.addHandles([z.watch(()=>[this.expressionInfo,this.graphic,this.map,this.spatialReference,this.view],()=>this._compileThrottled(),z.initial),
z.watch(()=>[this.contentElement],()=>this._createVM(),z.initial)])}initialize(){this.addHandles(this._compileThrottled)}destroy(){this._cancelQuery();this.contentElementViewModel?.destroy();this._set("contentElementViewModel",null);this._set("contentElement",null)}get spatialReference(){return this.view?.spatialReference??null}set spatialReference(b){this._override("spatialReference",b)}get state(){const {_abortController:b,contentElement:d,contentElementViewModel:w}=this;return b?"loading":d||w?
"ready":"disabled"}get map(){return this.view?.map??null}set map(b){this._override("map",b)}};c.__decorate([F.property()],g.prototype,"_abortController",void 0);c.__decorate([F.property({type:y})],g.prototype,"expressionInfo",void 0);c.__decorate([F.property({type:p})],g.prototype,"graphic",void 0);c.__decorate([F.property({readOnly:!0})],g.prototype,"contentElement",void 0);c.__decorate([F.property({readOnly:!0})],g.prototype,"contentElementViewModel",void 0);c.__decorate([F.property()],g.prototype,
"interceptor",void 0);c.__decorate([F.property()],g.prototype,"spatialReference",null);c.__decorate([F.property({readOnly:!0})],g.prototype,"state",null);c.__decorate([F.property()],g.prototype,"map",null);c.__decorate([F.property()],g.prototype,"view",void 0);return g=c.__decorate([C.subclass("esri.widgets.Feature.FeatureExpression.FeatureExpressionViewModel")],g)})},"esri/core/throttle":function(){define(["exports"],function(c){c.throttle=function(p,g,z,K){let F=null,E=1E3;"number"===typeof g?(E=
g,K=z):(F=g??null,E=z);let H=0,M;const C=()=>{H=0;p.apply(K,M)};g=(...u)=>{F&&F.apply(K,u);M=u;E?H||(H=setTimeout(C,E)):C()};g.remove=()=>{H&&(clearTimeout(H),H=0)};g.forceUpdate=()=>{H&&(clearTimeout(H),C())};g.hasPendingUpdates=()=>!!H;return g};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/support/arcadeFeatureUtils":function(){define("require exports ../../../core/Logger ../../../core/promiseUtils ../../../layers/FeatureLayer ./featureUtils".split(" "),
function(c,p,g,z,K,F){function E(h){return`<ul class="esri-widget__list">${h.map(k=>`<li>${"string"===typeof k?F.applyTextFormattingHTML(F.htmlEntities(k)):k}</li>`).join("")}</ul>`}function H(h){return`<table class="esri-widget__table">${h.keys().map(k=>{var m=h.field(k);m="string"===typeof m?F.applyTextFormattingHTML(F.htmlEntities(m)):m;return`<tr><th>${k}</th><td>${m}</td></tr>`}).join("")}</table>`}function M({aggregatedFeatures:h,arcadeUtils:k,featureSetVars:m,context:r,viewInfo:y,map:q,graphic:I,
interceptor:v}){m.forEach(e=>{e=e.toLowerCase();var b=y.sr;const d={map:q,spatialReference:b,interceptor:v};"$map"===e&&(r.vars[e]=k.convertMapToFeatureSetCollection(d));"$layer"===e&&(r.vars[e]=k.convertFeatureLayerToFeatureSet({layer:I.sourceLayer,spatialReference:b,interceptor:v}));"$datastore"===e&&(r.vars[e]=k.convertServiceUrlToWorkspace({url:I.sourceLayer.url,spatialReference:b,interceptor:v}));if("$aggregatedfeatures"===e){b=I.layer;const {fields:w,objectIdField:G,geometryType:n,spatialReference:B,
displayField:x}=b;b=new K({fields:w,objectIdField:G,geometryType:n,spatialReference:B,displayField:x,...("feature"===b.type?{templates:b.templates,typeIdField:b.typeIdField,types:b.types}:null),source:h});r.vars[e]=k.convertFeatureLayerToFeatureSet({layer:b,spatialReference:B,interceptor:v})}})}function C(){return new Promise((h,k)=>c(["../../../support/arcadeUtils"],h,k))}async function u({graphic:h,view:k}){const {isAggregate:m,layer:r}=h;if(!m||!r||"2d"!==k?.type)return[];k=await k.whenLayerView(r);
if(!("createQuery"in k&&"queryFeatures"in k))return[];const y=k.createQuery();h=h.getObjectId();y.aggregateIds=null!=h?[h]:[];({features:h}=await k.queryFeatures(y));return h}async function a({expressionInfo:h,arcadeUtils:k,interceptor:m,spatialReference:r,map:y,graphic:q,view:I}){if(!h?.expression)return null;const v=k.createSyntaxTree(h.expression),e=f.filter(d=>k.hasVariable(v,d)),[b]=await Promise.all([u({graphic:q,view:I}),k.loadScriptDependencies(v,!0,e)]);r=k.getViewInfo({spatialReference:r});
I=k.createExecContext(q,r,I?.timeZone);I.interceptor=m;I.useAsync=!0;M({aggregatedFeatures:b,arcadeUtils:k,featureSetVars:e,context:I,viewInfo:r,map:y,graphic:q,interceptor:m});m=k.createFunction(v,I);return k.executeAsyncFunction(m,I).catch(d=>l.error("arcade-execution-error",{error:d,graphic:q,expressionInfo:h}))}const f=["$datastore","$map","$layer","$aggregatedfeatures"],l=g.getLogger("esri.widgets.Feature.support.arcadeFeatureUtils");p.createCompiledExpression=a;p.createCompiledExpressions=async function({expressionInfos:h,
spatialReference:k,graphic:m,interceptor:r,map:y,view:q}){if(!h?.length)return{};const I=await C(),v={};for(const e of h)v[`expression/${e.name}`]=a({expressionInfo:e,arcadeUtils:I,interceptor:r,spatialReference:k,map:y,graphic:m,view:q});h=await z.eachAlways(v);k={};for(const e in h)m=h[e].value,m="string"===typeof m?F.applyTextFormattingHTML(F.htmlEntities(m)):Array.isArray(m)?E(m):"esri.arcade.Dictionary"===m?.declaredClass?H(m):m,k[e]=m;return k};p.loadArcadeUtils=C;Object.defineProperty(p,Symbol.toStringTag,
{value:"Module"})})},"esri/widgets/Feature/FeatureRelationship":function(){define("require ../../chunks/tslib.es6 ../../intl ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../Widget ./FeatureRelationship/FeatureRelationshipViewModel ./support/FeatureElementInfo ../support/componentsUtils ../support/globalCss ../support/legacyIcon ../support/widgetUtils ../support/decorators/messageBundle ../support/jsxFactory ../../intl/substitute".split(" "),
function(c,p,g,z,K,F,E,H,M,C,u,a,f,l,h,k,m,r,y,q,I){const v={title:!0,description:!0};g=class extends a{constructor(e,b){super(e,b);this._relatedFeatureIntersectionObserverNode=this._featureElementInfo=null;this._relatedFeatureIntersectionObserver=new IntersectionObserver(([d])=>{d?.isIntersecting&&this._increaseFeaturePage()},{root:window.document});this.headingLevel=2;this.viewModel=new f;this.messagesCommon=this.messages=null;this.visibleElements={...v};this._increaseFeaturePage=()=>{const {state:d,
showAllEnabled:w,relatedFeatures:G,featuresPerPage:n,featurePage:B}=this.viewModel;"ready"===d&&w&&G.length>=n*B&&this.viewModel.featurePage++}}initialize(){this._featureElementInfo=new l;this.addHandles([F.watch(()=>[this.viewModel.description,this.viewModel.title,this.headingLevel],()=>this._setupFeatureElementInfo(),F.initial),F.watch(()=>[this.viewModel.state,this.viewModel.showAllEnabled,this._relatedFeatureIntersectionObserverNode],()=>this._handleRelatedFeatureObserverChange()),F.on(()=>this.viewModel.relatedFeatureViewModels,
"change",()=>this._setupRelatedFeatureViewModels())])}loadDependencies(){return h.loadCalciteComponents({icon:()=>new Promise((e,b)=>c(["../../chunks/calcite-icon"],e,b)),list:()=>new Promise((e,b)=>c(["../../chunks/calcite-list"],e,b)),"list-item":()=>new Promise((e,b)=>c(["../../chunks/calcite-list-item"],e,b)),notice:()=>new Promise((e,b)=>c(["../../chunks/calcite-notice"],e,b))})}destroy(){this._unobserveRelatedFeatureObserver();this._featureElementInfo=z.destroyMaybe(this._featureElementInfo)}get displayShowAllButton(){const {showAllEnabled:e,
featureCount:b,displayCount:d,state:w}=this.viewModel;return!e&&!!b&&"ready"===w&&(b>d||0===d)}get displayListItems(){return this.displayShowAllButton||0<this.viewModel.relatedFeatureViewModels.length}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get featureCountDescription(){const {messages:e}=this,{featureCount:b}=this.viewModel;return I.substitute(e?.numberRecords,{number:b})}get title(){return this.viewModel.title}set title(e){this.viewModel.title=
e}castVisibleElements(e){return{...v,...e}}render(){const {state:e}=this.viewModel;return q.tsx("div",{class:this.classes("esri-feature-relationship",k.globalCss.widget)},this._featureElementInfo?.render(),"loading"===e?this._renderLoading():"disabled"===e?this._renderRelationshipNotFound():this._renderRelatedFeatures())}_renderStickyLoading(){return"querying"===this.viewModel.state?q.tsx("div",{class:"esri-feature__sticky-loading-container",key:"sticky-loader"},this._renderLoadingIcon()):null}_renderLoadingIcon(){return q.tsx("span",
{class:this.classes(m.legacyIcon.loadingIndicator,k.globalCss.rotating,"esri-feature__loading-spinner")})}_renderLoading(){return q.tsx("div",{class:"esri-feature__loading-container",key:"loading-container"},this._renderLoadingIcon())}_renderShowAllIconNode(){return q.tsx("calcite-icon",{icon:"list",scale:"s",slot:"content-end"})}_renderChevronIconNode(){const e=r.isRTL(this.container)?"chevron-left":"chevron-right";return q.tsx("calcite-icon",{icon:e,scale:"s",slot:"content-end"})}_renderRelatedFeature(e){const {itemDescriptionFieldName:b}=
this.viewModel,d=e.title;e.description=b&&e.formattedAttributes?.global[b];return q.tsx("calcite-list-item",{class:this.classes("esri-feature-relationship__list-item",{["esri-feature-relationship__list-item--hidden"]:"loading"===e.state}),description:e.description??"",key:e.uid,label:d,onCalciteListItemSelect:()=>this.emit("select-record",{featureViewModel:e})},this._renderChevronIconNode())}_renderShowAllListItem(){return this.displayShowAllButton?q.tsx("calcite-list-item",{description:this.featureCountDescription,
key:"show-all-item",label:this.messages?.showAll,onCalciteListItemSelect:()=>this.emit("show-all-records")},this._renderShowAllIconNode()):null}_renderNoRelatedFeaturesMessage(){return q.tsx("calcite-notice",{icon:"information",key:"no-related-features-message",kind:"brand",open:!0,scale:"s",width:"full"},q.tsx("div",{slot:"message"},this.messages?.noRelatedFeatures))}_renderFeatureObserver(){return q.tsx("div",{afterCreate:this._relatedFeatureIntersectionObserverCreated,bind:this,class:"esri-feature__feature-observer",
key:"feature-observer"})}_renderList(){const {relatedFeatureViewModels:e}=this.viewModel;return q.tsx("calcite-list",null,e.toArray().map(b=>this._renderRelatedFeature(b)),this._renderShowAllListItem())}_renderRelatedFeatures(){const {displayListItems:e}=this,{state:b}=this.viewModel;return q.tsx("div",{class:this.classes("esri-feature-relationship__list",{["esri-feature-relationship__list--querying"]:"querying"===b}),key:"list-container"},e?this._renderList():"ready"===b?this._renderNoRelatedFeaturesMessage():
null,this._renderStickyLoading(),this._renderFeatureObserver())}_renderRelationshipNotFound(){return q.tsx("calcite-notice",{icon:"exclamation-mark-triangle",key:"relationship-not-found",kind:"danger",open:!0,scale:"s",width:"full"},q.tsx("div",{slot:"message"},this.messages?.relationshipNotFound))}_setupRelatedFeatureViewModels(){const {relatedFeatureViewModels:e}=this.viewModel;this.removeHandles("related-feature-viewmodels");e?.forEach(b=>{this.addHandles(F.watch(()=>[b.title,b.state],()=>this.scheduleRender(),
F.initial),"related-feature-viewmodels")});this.scheduleRender()}_setupFeatureElementInfo(){const {headingLevel:e,visibleElements:b}=this,d=b.description&&this.description,w=b.title&&this.title;this._featureElementInfo?.set({description:d,title:w,headingLevel:e})}async _handleRelatedFeatureObserverChange(){this._unobserveRelatedFeatureObserver();const {state:e,showAllEnabled:b}=this.viewModel;await K.after(0);this._relatedFeatureIntersectionObserverNode&&"ready"===e&&b&&this._relatedFeatureIntersectionObserver.observe(this._relatedFeatureIntersectionObserverNode)}_relatedFeatureIntersectionObserverCreated(e){this._relatedFeatureIntersectionObserverNode=
e}_unobserveRelatedFeatureObserver(){this._relatedFeatureIntersectionObserverNode&&this._relatedFeatureIntersectionObserver.unobserve(this._relatedFeatureIntersectionObserverNode)}};p.__decorate([E.property()],g.prototype,"_relatedFeatureIntersectionObserverNode",void 0);p.__decorate([E.property({readOnly:!0})],g.prototype,"displayShowAllButton",null);p.__decorate([E.property({readOnly:!0})],g.prototype,"displayListItems",null);p.__decorate([E.property()],g.prototype,"description",null);p.__decorate([E.property({readOnly:!0})],
g.prototype,"featureCountDescription",null);p.__decorate([E.property()],g.prototype,"headingLevel",void 0);p.__decorate([E.property()],g.prototype,"title",null);p.__decorate([E.property({type:f})],g.prototype,"viewModel",void 0);p.__decorate([E.property(),y.messageBundle("esri/widgets/Feature/t9n/Feature")],g.prototype,"messages",void 0);p.__decorate([E.property(),y.messageBundle("esri/t9n/common")],g.prototype,"messagesCommon",void 0);p.__decorate([E.property()],g.prototype,"visibleElements",void 0);
p.__decorate([H.cast("visibleElements")],g.prototype,"castVisibleElements",null);return g=p.__decorate([u.subclass("esri.widgets.Feature.FeatureRelationship")],g)})},"esri/widgets/Feature/FeatureRelationship/FeatureRelationshipViewModel":function(){define("../../../chunks/tslib.es6 ../../../Graphic ../../../core/Accessor ../../../core/arrayUtils ../../../core/Clonable ../../../core/Collection ../../../core/Identifiable ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../rest/support/RelationshipQuery ../support/featureUtils ../../FeatureForm/featureFormUtils".split(" "),
function(c,p,g,z,K,F,E,H,M,C,u,a,f,l,h,k){g=class extends K.ClonableMixin(E.IdentifiableMixin(g)){constructor(m){super(m);this._loaded=!1;this._queryFeatureCountAbortController=this._queryPageAbortController=this._queryAbortController=null;this.featuresPerPage=10;this.orderByFields=this.map=this.layer=this.graphic=this.description=null;this.featureCount=0;this.relationshipId=null;this.showAllEnabled=!1;this.title=null;this._cancelQuery=()=>{const {_queryAbortController:r}=this;r&&r.abort();this._queryAbortController=
null};this._cancelQueryFeatureCount=()=>{const {_queryFeatureCountAbortController:r}=this;r&&r.abort();this._queryFeatureCountAbortController=null};this._cancelQueryPage=()=>{const {_queryPageAbortController:r}=this;r&&r.abort();this._queryPageAbortController=null};this._queryController=async()=>{this._cancelQuery();const r=new AbortController;this._queryAbortController=r;await H.ignoreAbortErrors(this._query());this._queryAbortController===r&&(this._queryAbortController=null)};this._queryFeatureCountController=
async()=>{this._loaded=!1;this._cancelQueryFeatureCount();const r=new AbortController;this._queryFeatureCountAbortController=r;await H.ignoreAbortErrors(this._queryFeatureCount());this._queryFeatureCountAbortController===r&&(this._queryFeatureCountAbortController=null);this._loaded=!0};this._queryPageController=async()=>{const r=new AbortController;this._queryPageAbortController=r;await H.ignoreAbortErrors(this._queryPage());this._queryPageAbortController===r&&(this._queryPageAbortController=null)};
this._queryDebounced=H.debounce(this._queryController,100);this._queryFeatureCountDebounced=H.debounce(this._queryFeatureCountController,100);this._queryPageDebounced=H.debounce(this._queryPageController,100);this._query=async()=>{const {_queryAbortController:r,relatedFeatures:y}=this;this.featureCount&&(this._destroyRelatedFeatureViewModels(),this.featurePage=1,y.removeAll(),this.destroyed||y.addMany(this._sliceFeatures(await this._queryRelatedFeatures({signal:r?.signal}))))};this.addHandles([M.watch(()=>
[this.displayCount,this.graphic,this.layer,this.layer?.loaded,this.map,this.orderByFields,this.relationshipId,this.featuresPerPage,this.showAllEnabled,this.canQuery,this.featureCount],()=>this._queryDebounced(),M.initial),M.watch(()=>[this.featurePage,this.showAllEnabled],()=>this._queryPageDebounced()),M.watch(()=>[this.layer,this.relationshipId,this.objectId,this.canQuery],()=>this._queryFeatureCountDebounced())])}destroy(){this._destroyRelatedFeatureViewModels();this.relatedFeatures.removeAll();
this._cancelQuery();this._cancelQueryFeatureCount();this._cancelQueryPage()}set featurePage(m){const {featuresPerPage:r,featureCount:y}=this;this._set("featurePage",Math.min(Math.max(m,1),Math.ceil(y/r)||1))}get featurePage(){return this._get("featurePage")}get orderByFieldsFixedCasing(){const {orderByFields:m,relatedLayer:r}=this;return m&&r?.loaded?m.map(y=>{const q=y.clone();q.field=h.getFixedFieldName(y.field,r);return q}):m??[]}get supportsCacheHint(){return!!this.layer?.capabilities?.queryRelated?.supportsCacheHint}get canLoad(){return!!this.map&&
"number"===typeof this.relationshipId&&"number"===typeof this.objectId}get canQuery(){const m=this.layer?.capabilities?.queryRelated;return!!this.relatedLayer&&!!this.relationship&&"number"===typeof this.relationshipId&&"number"===typeof this.objectId&&!!m?.supportsCount&&!!m?.supportsPagination}get itemDescriptionFieldName(){return this.orderByFieldsFixedCasing[0]?.field||null}set displayCount(m){this._set("displayCount",Math.min(Math.max(m,0),10))}get displayCount(){return this._get("displayCount")}get objectId(){return(this.objectIdField&&
this.graphic?.attributes?.[this.objectIdField])??null}get objectIdField(){return this.layer?.objectIdField||null}get relatedFeatures(){return this._get("relatedFeatures")||new F}get relatedLayer(){const {layer:m,map:r,relationship:y}=this;return m?.loaded&&r&&y?h.findRelatedLayer(r,m,y)??null:null}get relationship(){const {relationshipId:m,layer:r}=this;return"number"===typeof m?r?.relationships?.find(({id:y})=>y===m)??null:null}get relatedFeatureViewModels(){return this._get("relatedFeatureViewModels")||
new F}get state(){const {_queryAbortController:m,_queryFeatureCountAbortController:r,_queryPageAbortController:y,canQuery:q,_loaded:I,canLoad:v}=this;return r||v&&!I?"loading":m||y?"querying":q?"ready":"disabled"}getRelatedFeatureByObjectId(m){return this.relatedFeatures.find(r=>r.getObjectId()===m)}_destroyRelatedFeatureViewModels(){this.relatedFeatureViewModels?.forEach(m=>!m.destroyed&&m.destroy());this.relatedFeatureViewModels.removeAll()}async _queryFeatureCount(){const {layer:m,relatedLayer:r,
relationshipId:y,objectId:q,_queryFeatureCountAbortController:I,canQuery:v,supportsCacheHint:e}=this;await m?.load();await r?.load();if(v&&m&&r){var b=r.createQuery();b=new l({cacheHint:e,relationshipId:y,returnGeometry:!1,objectIds:[q],where:b.where??void 0});b=await m.queryRelatedFeaturesCount(b,{signal:I?.signal});this._set("featureCount",b[q]||0)}else this._set("featureCount",0)}_sliceFeatures(m){const {showAllEnabled:r,displayCount:y}=this;return r?m:y?m.slice(0,y):[]}async _queryPage(){const {relatedFeatures:m,
featurePage:r,showAllEnabled:y,_queryPageAbortController:q,featureCount:I}=this;!y||2>r||!I||m.addMany(await this._queryRelatedFeatures({signal:q?.signal}))}async _queryRelatedFeatures(m){const {orderByFieldsFixedCasing:r,showAllEnabled:y,featuresPerPage:q,displayCount:I,layer:v,relationshipId:e,featurePage:b,featureCount:d,relatedLayer:w,supportsCacheHint:G}=this,{canQuery:n,objectId:B}=this;if(!n||!v||!w)return[];var x=y?((b-1)*q+d)%d:0;const A=y?q:I;var L=w.objectIdField;L=[...r.map(Q=>Q.field),
...k.getFieldsInTitleAndDesc(w),L].filter(z.isSome);const O=r.map(Q=>`${Q.field} ${Q.order}`),N=w.createQuery();x=new l({orderByFields:O,start:x,num:A,outFields:L,cacheHint:G,relationshipId:e,returnGeometry:!1,objectIds:[B],where:N.where??void 0});m=(await v.queryRelatedFeatures(x,{signal:m?.signal}))[B]?.features||[];m.forEach(Q=>{Q.sourceLayer=w;Q.layer=w});return m}};c.__decorate([C.property()],g.prototype,"_loaded",void 0);c.__decorate([C.property()],g.prototype,"_queryAbortController",void 0);
c.__decorate([C.property()],g.prototype,"_queryPageAbortController",void 0);c.__decorate([C.property()],g.prototype,"_queryFeatureCountAbortController",void 0);c.__decorate([C.property({value:1})],g.prototype,"featurePage",null);c.__decorate([C.property()],g.prototype,"featuresPerPage",void 0);c.__decorate([C.property({readOnly:!0})],g.prototype,"orderByFieldsFixedCasing",null);c.__decorate([C.property({readOnly:!0})],g.prototype,"supportsCacheHint",null);c.__decorate([C.property({readOnly:!0})],
g.prototype,"canLoad",null);c.__decorate([C.property({readOnly:!0})],g.prototype,"canQuery",null);c.__decorate([C.property()],g.prototype,"description",void 0);c.__decorate([C.property({readOnly:!0})],g.prototype,"itemDescriptionFieldName",null);c.__decorate([C.property({value:3})],g.prototype,"displayCount",null);c.__decorate([C.property({type:p})],g.prototype,"graphic",void 0);c.__decorate([C.property()],g.prototype,"layer",void 0);c.__decorate([C.property()],g.prototype,"map",void 0);c.__decorate([C.property({readOnly:!0})],
g.prototype,"objectId",null);c.__decorate([C.property({readOnly:!0})],g.prototype,"objectIdField",null);c.__decorate([C.property()],g.prototype,"orderByFields",void 0);c.__decorate([C.property({readOnly:!0})],g.prototype,"relatedFeatures",null);c.__decorate([C.property({readOnly:!0})],g.prototype,"relatedLayer",null);c.__decorate([C.property({readOnly:!0})],g.prototype,"relationship",null);c.__decorate([C.property()],g.prototype,"featureCount",void 0);c.__decorate([C.property({readOnly:!0})],g.prototype,
"relatedFeatureViewModels",null);c.__decorate([C.property()],g.prototype,"relationshipId",void 0);c.__decorate([C.property()],g.prototype,"showAllEnabled",void 0);c.__decorate([C.property()],g.prototype,"state",null);c.__decorate([C.property()],g.prototype,"title",void 0);c.__decorate([C.property()],g.prototype,"getRelatedFeatureByObjectId",null);return g=c.__decorate([f.subclass("esri.widgets.Feature.FeatureRelationship.FeatureRelationshipViewModel")],g)})},"esri/widgets/FeatureForm/featureFormUtils":function(){define("exports ../../intl ../../core/arrayUtils ../../core/compilerUtils ../../core/string ../../layers/support/domainUtils ../../layers/support/fieldUtils ../../smartMapping/support/utils ../support/dateUtils ../../intl/substitute".split(" "),
function(c,p,g,z,K,F,E,H,M,C){function u(d){const {fields:w,values:G}=d,n=d.timeZone??void 0;d=w.map((B,x)=>{let A=G[x];B.domain&&"coded-value"===B.domain.type&&(x=B.domain.codedValues.find(L=>L.code===A),x?.name&&(A=x.name));if(H.isAnyDateField(B)||E.isTimeOnlyField(B))A=M.getLabelForDateFieldValue(B,A,{timeZone:n,...M.getIntlOptionsForField(B)});return[B.name,A]});return Object.fromEntries(d)}function a(d,w){return K.replace(K.replace(d,G=>`{${G.toLowerCase()}}`),Object.fromEntries(Object.entries(w).map(([G,
n])=>[G.toLowerCase(),n])))}function f(d){return 1E7<=d||-1E7>=d}const l=d=>"field"===d?.type,h=d=>"relationship"===d?.type,k=d=>"field"===d.type,m=d=>d.reduce((w,G)=>"group"===G?.type?[...w,...G.inputs]:[...w,G],[]),r=(d,w)=>null!=d&&d.input?.type===w,y={typeFieldName:null,types:[]};c.LengthValidationError=void 0;(c.LengthValidationError||(c.LengthValidationError={})).TOO_SHORT="length-validation-error::too-short";const q={type:"number"},I={type:"number",intlOptions:{notation:"scientific"}},v={day:"2-digit",
month:"2-digit",year:"numeric"},e={hour:"numeric",minute:"numeric",second:"numeric"},b={...v,...e};c.capabilitiesAllowEditType=(d,w)=>{if(!d)return!0;({operations:d}=d);switch(w){case "INSERT":return d.supportsAdd;case "UPDATE":case "DELETE":return d.supportsUpdate;default:return!0}};c.flattenFieldInputs=d=>m(d).filter(l);c.flattenInputs=m;c.flattenRelationshipInputs=d=>m(d).filter(h);c.formTemplateHasInvalidFields=function(d){return"formTemplate"in d&&d.formTemplate?(d.formTemplate.elements?.filter(k)??
[]).some(({fieldName:w})=>!d.fieldsIndex.get(w)):!1};c.getComputedAttributes=u;c.getErrorMessageForFieldInput=(d,w,G)=>{const {dataType:n,error:B,minLength:x,value:A,required:L}=d;if(!w||!B)return null;if(L&&null===A)return w.validationErrors.cannotBeNull;if(B===F.DomainValidationError.VALUE_OUT_OF_RANGE||B===E.NumericRangeValidationError.OUT_OF_RANGE){const {field:O,range:N}=d;d={type:"date",intlOptions:{...("time-only"===O.type?e:"date-only"===O.type?v:b),timeZone:G??void 0}};return C.substitute(w.validationErrors.outsideRange,
N,{format:{max:"date"===n?d:null!=N.max&&f(N.max)?I:q,min:"date"===n?d:null!=N.min&&f(N.min)?I:q}})}return B===F.DomainValidationError.INVALID_CODED_VALUE?w.validationErrors.invalidCodedValue:B===E.TypeValidationError.INVALID_TYPE?w.validationErrors.invalidType:B===c.LengthValidationError.TOO_SHORT?C.substitute(w.validationErrors.tooShort,{min:x}):null};c.getFieldsInTitleAndDesc=d=>{const w=[];if(d.formTemplate){const {description:G,title:n}=d.formTemplate;d.fields?.forEach(B=>{const x=n&&K.templateHasKey(n,
B.name),A=G&&K.templateHasKey(G,B.name);(x||A)&&w.push(B.name)})}return w};c.getIconForFeature=d=>{if(d){var w=d.layer;w=w&&"geometryType"in w?w.geometryType:void 0;d=d.geometry?.type;return"polyline"===d||"polyline"===w?"line":d||w||"table"}};c.getNormalizedFeatureTypeInfo=d=>d?"subtype-sublayer"===d.type?{typeFieldName:d.parent?.subtypeField,types:d.parent?.subtypes??[]}:"types"in d&&d.types?{typeFieldName:d.typeIdField,types:d.types.map(({id:w,name:G,domains:n})=>({code:w,name:G,domains:n}))}:
y:y;c.isFieldElement=k;c.isFieldElementWithInputType=r;c.isFieldElementWithShowNoValueOptionInput=d=>null!=d&&(r(d,"combo-box")||r(d,"radio-buttons"));c.isFieldElementWithTextInput=d=>null!=d&&(r(d,"text-box")||r(d,"text-area"));c.isFieldInput=l;c.isGroupElement=d=>"group"===d.type;c.isGroupInput=d=>"group"===d?.type;c.isInputInGroupInput=d=>"group"!==d?.type&&null!=d.group;c.isNumberFieldInput=({domain:d,inputType:w="text-box",dataType:G})=>"number"===G&&"text-box"===w&&(!d||"coded-value"!==d.type);
c.isRelationshipElement=d=>"relationship"===d.type;c.isRelationshipInput=h;c.isTemplateItemGroup=d=>"items"in d;c.parseFormTemplateString=function(d){const {attributes:w,fieldsIndex:G,label:n,timeZone:B}=d;if(!w||"object"!==typeof w)return n;var x=Object.keys(w).filter(A=>K.templateHasKey(n,A));d=x.map(A=>w[A]);x=x.map(A=>G.get(A)).filter(g.isSome);return a(n,u({values:d,fields:x,timeZone:B}))};c.substituteFieldTemplatesInString=a;c.valueIsInvalidSwitchValue=function(d,w){return null==d||w.onValue!==
d&&w.offValue!==d};c.valueIsValidContingentValue=function(d,w){switch(w.objectType){case "any":return!0;case "null":return null==d;case "code":return d===w.codedValue?.code;case "range":return null!=d&&null!=w.minValue&&null!=w.maxValue&&+d>=w.minValue&&+d<=w.maxValue;default:return z.neverReached(w.objectType),!1}};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureViewModel":function(){define("../../chunks/tslib.es6 ../../Graphic ../../arcade/featureset/support/FeatureSetQueryInterceptor ../../core/Accessor ../../core/arrayUtils ../../core/Identifiable ../../core/Logger ../../core/promiseUtils ../../core/reactiveUtils ../../core/throttle ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/has ../../core/accessorSupport/decorators/subclass ../../popup/content/TextContent ../../time/timeZoneUtils ./FeatureAttachments/FeatureAttachmentsViewModel ./FeatureContent/FeatureContentViewModel ./FeatureExpression/FeatureExpressionViewModel ./FeatureFields/FeatureFieldsViewModel ./FeatureMedia/FeatureMediaViewModel ./FeatureRelationship/FeatureRelationshipViewModel ./support/arcadeFeatureUtils ./support/featureUtils ./support/relatedFeatureUtils".split(" "),
function(c,p,g,z,K,F,E,H,M,C,u,a,f,l,h,k,m,r,y,q,I,v,e,b,d){var w;const G={attachmentsContent:!0,chartAnimation:!0,customContent:!0,expressionContent:!0,fieldsContent:!0,mediaContent:!0,textContent:!0,relationshipContent:!0};z=w=class extends F.IdentifiableMixin(z){constructor(n){super(n);this._featureAbortController=this._error=null;this._graphicChangedThrottled=C.throttle(this._graphicChanged,1,this);this._graphicExpressionAttributes=this._expressionAttributes=null;this.abilities={...G};this.content=
null;this.contentViewModels=[];this.description=null;this.defaultPopupTemplateEnabled=!1;this.lastEditInfo=this.formattedAttributes=null;this.relatedInfos=new Map;this.title="";this.view=null;this._isAllowedContentType=B=>{const {abilities:x}=this;return"attachments"===B.type&&!!x.attachmentsContent||"custom"===B.type&&!!x.customContent||"fields"===B.type&&!!x.fieldsContent||"media"===B.type&&!!x.mediaContent||"text"===B.type&&!!x.textContent||"expression"===B.type&&!!x.expressionContent||"relationship"===
B.type&&!!x.relationshipContent};this.addHandles(M.watch(()=>[this.graphic,this._effectivePopupTemplate,this.abilities],()=>this._graphicChangedThrottled(),M.initial))}initialize(){this.addHandles(this._graphicChangedThrottled)}destroy(){this._clear();this._cancelFeatureQuery();this.graphic=this._error=null;this._destroyContentViewModels();this.relatedInfos.clear()}get _effectivePopupTemplate(){return null!=this.graphic?this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled):null}get _fieldInfoMap(){return b.createfieldInfoMap(b.getAllFieldInfos(this._effectivePopupTemplate),
this._sourceLayer)}get _sourceLayer(){return b.getSourceLayer(this.graphic)}castAbilities(n){return{...G,...n}}get isTable(){return this._sourceLayer?.isTable||!1}get state(){return this.graphic?this._error?"error":this.waitingForContent?"loading":"ready":"disabled"}set graphic(n){this._set("graphic",n?n.clone():null)}get spatialReference(){return this.view?.spatialReference??null}set spatialReference(n){this._override("spatialReference",n)}get map(){return this.view?.map||null}set map(n){this._override("map",
n)}get waitingForContent(){return!!this._featureAbortController}setActiveMedia(n,B){n=this.contentViewModels[n];n instanceof I&&n.setActiveMedia(B)}nextMedia(n){n=this.contentViewModels[n];n instanceof I&&n.next()}previousMedia(n){n=this.contentViewModels[n];n instanceof I&&n.previous()}async updateGeometry(){const {graphic:n,spatialReference:B,_sourceLayer:x}=this;await x?.load();var A=x?.objectIdField;A&&n&&x&&(A=n?.attributes?.[A],null!=A&&(A=[A],!n.geometry&&(A=(await b.querySourceLayer({layer:x,
graphic:n,outFields:[],objectIds:A,returnGeometry:!0,spatialReference:B}))?.geometry)))&&(n.geometry=A)}_clear(){this._set("title","");this._set("content",null);this._set("formattedAttributes",null)}async _graphicChanged(){this._cancelFeatureQuery();this._error=null;this._clear();const {graphic:n}=this;if(n){var B=new AbortController;this._featureAbortController=B;try{await this._queryFeature({signal:B.signal})}catch(x){H.isAbortError(x)||(this._error=x,E.getLogger(this).error("error","The popupTemplate could not be displayed for this feature.",
{error:x,graphic:n,popupTemplate:this._effectivePopupTemplate}))}this._featureAbortController===B&&(this._featureAbortController=null)}}_cancelFeatureQuery(){const {_featureAbortController:n}=this;n&&n.abort();this._featureAbortController=null}_compileContentElement(n,B){if("attachments"===n.type)return this._compileAttachments(n,B);if("custom"===n.type)return this._compileCustom(n,B);if("fields"===n.type)return this._compileFields(n,B);if("media"===n.type)return this._compileMedia(n,B);if("text"===
n.type)return this._compileText(n,B);if("expression"===n.type)return this._compileExpression(n,B);if("relationship"===n.type)return this._compileRelationship(n,B)}_compileContent(n){this._destroyContentViewModels();if(this.graphic)return Array.isArray(n)?n.filter(this._isAllowedContentType).map((B,x)=>this._compileContentElement(B,x)).filter(K.isSome):"string"===typeof n?this._compileText(new h({text:n}),0).text:n}_destroyContentViewModels(){this.removeHandles("relationship-view-models");this.removeHandles("content-view-models");
this.contentViewModels.forEach(n=>n&&!n.destroyed&&n.destroy());this._set("contentViewModels",[])}_matchesFeature(n,B){n=n?.graphic?.getObjectId();B=B?.getObjectId();return null!=n&&null!=B&&n===B}_setRelatedFeaturesViewModels({relatedFeatureViewModels:n,relatedFeatures:B,map:x}){const {view:A,spatialReference:L}=this;B?.filter(Boolean).forEach(O=>{n.find(N=>this._matchesFeature(N,O))||n.add(new w({abilities:{relationshipContent:!1},map:x,view:A,spatialReference:L,graphic:O}))});n.forEach(O=>{B?.find(N=>
this._matchesFeature(O,N))||n.remove(O)})}_setExpressionContentVM(n,B){const x=this.formattedAttributes,{contentElement:A,contentElementViewModel:L}=n;n=A?.type;L&&n&&("fields"===n&&(this._createFieldsFormattedAttributes({contentElement:A,contentElementIndex:B,formattedAttributes:x}),L.set(this._createFieldsVMParams(A,B))),"media"===n&&(this._createMediaFormattedAttributes({contentElement:A,contentElementIndex:B,formattedAttributes:x}),L.set(this._createMediaVMParams(A,B))),"text"===n&&L.set(this._createTextVMParams(A)))}_compileRelationship(n,
B){const {displayCount:x,orderByFields:A,relationshipId:L,title:O,description:N}=n,{_sourceLayer:Q,graphic:U,map:V}=this;if(b.isRelatableFeatureSupportedLayer(Q)){var ba=new v({displayCount:x,graphic:U,orderByFields:A,relationshipId:L,layer:Q,map:V,...this._compileTitleAndDesc({title:O,description:N})});this.contentViewModels[B]=ba;this.addHandles(M.on(()=>ba.relatedFeatures,"change",()=>this._setRelatedFeaturesViewModels(ba)),"relationship-view-models");return n}}_compileExpression(n,B){const {expressionInfo:x}=
n,{graphic:A,map:L,spatialReference:O,view:N}=this,Q=new y({expressionInfo:x,graphic:A,interceptor:w.interceptor,map:L,spatialReference:O,view:N});this.contentViewModels[B]=Q;this.addHandles(M.watch(()=>Q.contentElementViewModel,()=>this._setExpressionContentVM(Q,B),M.initial),"content-view-models");return n}_compileAttachments(n,B){const {graphic:x}=this,{description:A,title:L}=n;this.contentViewModels[B]=new m({graphic:x,...this._compileTitleAndDesc({title:L,description:A})});return n}_compileCustom(n,
B){const {graphic:x}=this,{creator:A,destroyer:L}=n;this.contentViewModels[B]=new r({graphic:x,creator:A,destroyer:L});return n}_compileTitleAndDesc({title:n,description:B}){const {_fieldInfoMap:x,_sourceLayer:A,graphic:L,formattedAttributes:O}=this,N=L?.attributes,Q=this._expressionAttributes,U=O.global;return{title:b.substituteFieldsInLinksAndAttributes({attributes:N,fieldInfoMap:x,globalAttributes:U,expressionAttributes:Q,layer:A,text:n}),description:b.substituteFieldsInLinksAndAttributes({attributes:N,
fieldInfoMap:x,globalAttributes:U,expressionAttributes:Q,layer:A,text:B})}}_createFieldsVMParams(n,B){const x=this._effectivePopupTemplate,A=this.formattedAttributes,L={...A?.global,...A?.content[B]};B=(n?.fieldInfos||x?.fieldInfos)?.filter(({fieldName:Q})=>b.isExpressionField(Q)||b.isRelatedField(Q)||L.hasOwnProperty(Q));const {description:O,title:N}=n;return{attributes:L,expressionInfos:x?.expressionInfos,fieldInfos:B,...this._compileTitleAndDesc({title:N,description:O})}}_compileFields(n,B){const x=
n.clone();n=new q(this._createFieldsVMParams(n,B));this.contentViewModels[B]=n;x.fieldInfos=n.formattedFieldInfos.slice(0);return x}_createMediaVMParams(n,B){const {abilities:x,graphic:A,_fieldInfoMap:L,_effectivePopupTemplate:O,relatedInfos:N,_sourceLayer:Q,_expressionAttributes:U}=this,V=this.formattedAttributes,ba=A?.attributes??{},{description:Y,mediaInfos:aa,title:da}=n;return{abilities:{chartAnimation:x.chartAnimation},activeMediaInfoIndex:n.activeMediaInfoIndex||0,attributes:ba,isAggregate:A?.isAggregate,
layer:Q,fieldInfoMap:L,formattedAttributes:{...V?.global,...V?.content[B]},expressionAttributes:U,mediaInfos:aa,popupTemplate:O,relatedInfos:N,...this._compileTitleAndDesc({title:da,description:Y})}}_compileMedia(n,B){const x=n.clone();n=new I(this._createMediaVMParams(n,B));x.mediaInfos=n.formattedMediaInfos.slice(0);this.contentViewModels[B]=n;return x}_createTextVMParams(n){const {graphic:B,_fieldInfoMap:x,_sourceLayer:A,_expressionAttributes:L}=this;n&&n.text&&(n.text=b.substituteFieldsInLinksAndAttributes({attributes:B?.attributes??
{},fieldInfoMap:x,globalAttributes:this.formattedAttributes?.global??{},expressionAttributes:L,layer:A,text:n.text}));return{graphic:B,creator:n.text}}_compileText(n,B){n=n.clone();this.contentViewModels[B]=new r(this._createTextVMParams(n));return n}_compileLastEditInfo(){const {_effectivePopupTemplate:n,_sourceLayer:B,graphic:x,view:A}=this;if(n){var {lastEditInfoEnabled:L}=n,O=B?.editFieldsInfo;if(L&&O)return b.formatEditInfo(O,x?.attributes,A?.timeZone??k.system,B)}}_compileTitle(n){const {_fieldInfoMap:B,
_sourceLayer:x,graphic:A,_expressionAttributes:L}=this;return b.substituteFieldsInLinksAndAttributes({attributes:A?.attributes??{},fieldInfoMap:B,globalAttributes:this.formattedAttributes?.global??{},expressionAttributes:L,layer:x,text:n})}async _getTitle(){const {_effectivePopupTemplate:n,graphic:B}=this;return B?b.graphicCallback(n?.title,{graphic:B}):null}async _getContent(){const {_effectivePopupTemplate:n,graphic:B}=this;return B?b.graphicCallback(n?.content,{graphic:B}):null}async _queryFeature(n){const {_featureAbortController:B,
_sourceLayer:x,graphic:A,_effectivePopupTemplate:L}=this,O=this.map,N=this.view,Q=this.spatialReference;if(B===this._featureAbortController&&A){await b.queryUpdatedFeature({graphic:A,popupTemplate:L,layer:x,spatialReference:Q},n);var {content:{value:U},title:{value:V}}=await H.eachAlways({content:this._getContent(),title:this._getTitle()});({expressionAttributes:{value:n}}=await H.eachAlways({checkForRelatedFeatures:this._checkForRelatedFeatures(n),expressionAttributes:e.createCompiledExpressions({expressionInfos:L?.expressionInfos,
spatialReference:Q,graphic:A,map:O,interceptor:w.interceptor,view:N})}));B===this._featureAbortController&&A&&(this._expressionAttributes=n,this._graphicExpressionAttributes={...A.attributes,...n},this._set("formattedAttributes",this._createFormattedAttributes(U)),this._set("title",this._compileTitle(V)),this._set("lastEditInfo",this._compileLastEditInfo()||null),this._set("content",this._compileContent(U)||null))}}_createMediaFormattedAttributes({contentElement:n,contentElementIndex:B,formattedAttributes:x}){const {_effectivePopupTemplate:A,
graphic:L,relatedInfos:O,_sourceLayer:N,_fieldInfoMap:Q,_graphicExpressionAttributes:U}=this;x.content[B]=b.formatAttributes({fieldInfos:A?.fieldInfos,graphic:L,attributes:{...U,...n.attributes},layer:N,fieldInfoMap:Q,relatedInfos:O,timeZone:this.view?.timeZone??k.system})}_createFieldsFormattedAttributes({contentElement:n,contentElementIndex:B,formattedAttributes:x}){if(n.fieldInfos){const {graphic:A,relatedInfos:L,_sourceLayer:O,_fieldInfoMap:N,_graphicExpressionAttributes:Q}=this;x.content[B]=
b.formatAttributes({fieldInfos:n.fieldInfos,graphic:A,attributes:{...Q,...n.attributes},layer:O,fieldInfoMap:N,relatedInfos:L,timeZone:this.view?.timeZone??k.system})}}_createFormattedAttributes(n){const {_effectivePopupTemplate:B,graphic:x,relatedInfos:A,_sourceLayer:L,_fieldInfoMap:O,_graphicExpressionAttributes:N}=this,Q={global:b.formatAttributes({fieldInfos:B?.fieldInfos,graphic:x,attributes:N,layer:L,fieldInfoMap:O,relatedInfos:A,timeZone:this.view?.timeZone??k.system}),content:[]};Array.isArray(n)&&
n.forEach((U,V)=>{"fields"===U.type&&this._createFieldsFormattedAttributes({contentElement:U,contentElementIndex:V,formattedAttributes:Q});"media"===U.type&&this._createMediaFormattedAttributes({contentElement:U,contentElementIndex:V,formattedAttributes:Q})});return Q}_checkForRelatedFeatures(n){const {graphic:B,_effectivePopupTemplate:x}=this;return this._queryRelatedInfos(B,b.getAllFieldInfos(x),n)}async _queryRelatedInfos(n,B,x){const {relatedInfos:A,_sourceLayer:L}=this;A.clear();const O=null!=
L?.associatedLayer?await L?.associatedLayer.load(x):L;if(O&&n&&B.filter(U=>U&&b.isRelatedField(U.fieldName))?.length){B.forEach(U=>this._configureRelatedInfo(U,O));var N=await d.queryLayerInfos({relatedInfos:A,layer:O},x);Object.keys(N).forEach(U=>{const V=A.get(U.toString());U=N[U]?.value;V&&U&&(V.layerInfo=U.data)});var Q=await d.queryRelatedFeatures({graphic:n,relatedInfos:A,layer:O},x);Object.keys(Q).forEach(U=>{d.setRelatedFeatures(Q[U]?.value,A.get(U.toString()))})}}_configureRelatedInfo(n,
B){const {relatedInfos:x}=this,A=d.getRelatedFieldInfo(n.fieldName);if(A){var {layerId:L,fieldName:O}=A;L&&(B=x.get(L.toString())||d.createRelatedInfo(L,B))&&(d.updateRelatedInfo({relatedInfo:B,fieldName:O,fieldInfo:n}),this.relatedInfos.set(L,B))}}};z.interceptor=new g.FeatureSetQueryInterceptor(b.preLayerQueryCallback,b.preRequestCallback);c.__decorate([u.property()],z.prototype,"_error",void 0);c.__decorate([u.property()],z.prototype,"_featureAbortController",void 0);c.__decorate([u.property({readOnly:!0})],
z.prototype,"_effectivePopupTemplate",null);c.__decorate([u.property({readOnly:!0})],z.prototype,"_fieldInfoMap",null);c.__decorate([u.property({readOnly:!0})],z.prototype,"_sourceLayer",null);c.__decorate([u.property()],z.prototype,"abilities",void 0);c.__decorate([a.cast("abilities")],z.prototype,"castAbilities",null);c.__decorate([u.property({readOnly:!0})],z.prototype,"content",void 0);c.__decorate([u.property({readOnly:!0})],z.prototype,"contentViewModels",void 0);c.__decorate([u.property()],
z.prototype,"description",void 0);c.__decorate([u.property({type:Boolean})],z.prototype,"defaultPopupTemplateEnabled",void 0);c.__decorate([u.property({readOnly:!0})],z.prototype,"isTable",null);c.__decorate([u.property({readOnly:!0})],z.prototype,"state",null);c.__decorate([u.property({readOnly:!0})],z.prototype,"formattedAttributes",void 0);c.__decorate([u.property({type:p,value:null})],z.prototype,"graphic",null);c.__decorate([u.property({readOnly:!0})],z.prototype,"lastEditInfo",void 0);c.__decorate([u.property({readOnly:!0})],
z.prototype,"relatedInfos",void 0);c.__decorate([u.property()],z.prototype,"spatialReference",null);c.__decorate([u.property({readOnly:!0})],z.prototype,"title",void 0);c.__decorate([u.property()],z.prototype,"map",null);c.__decorate([u.property({readOnly:!0})],z.prototype,"waitingForContent",null);c.__decorate([u.property()],z.prototype,"view",void 0);return z=w=c.__decorate([l.subclass("esri.widgets.FeatureViewModel")],z)})},"esri/arcade/featureset/support/FeatureSetQueryInterceptor":function(){define(["exports"],
function(c){class p{constructor(g,z){this.preLayerQueryCallback=g;this.preRequestCallback=z;this.preLayerQueryCallback||(this.preLayerQueryCallback=K=>{});this.preRequestCallback||(this.preLayerQueryCallback=K=>{})}}c.FeatureSetQueryInterceptor=p;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/resources":function(){define(["exports"],function(c){c.css={base:"esri-feature",container:"esri-feature__size-container",title:"esri-feature__title",main:"esri-feature__main-container",
btn:"esri-feature__button",icon:"esri-feature__icon",content:"esri-feature__content",contentNode:"esri-feature__content-node",contentNodeText:"esri-feature__content-node--text",contentElement:"esri-feature__content-element",text:"esri-feature__text",lastEditedInfo:"esri-feature__last-edited-info",fields:"esri-feature__fields",fieldHeader:"esri-feature__field-header",fieldData:"esri-feature__field-data",fieldDataDate:"esri-feature__field-data--date",loadingSpinnerContainer:"esri-feature__loading-container",
spinner:"esri-feature__loading-spinner"};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/support/FeatureContentMixin":function(){define("exports ../../../chunks/tslib.es6 ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/Error ../../../core/accessorSupport/decorators/subclass ../resources ../../support/widget ../../support/jsxFactory".split(" "),function(c,p,g,z,K,F,E,H,M,C,u){c.FeatureContentMixin=
a=>{a=class extends a{constructor(){super(...arguments);this.renderNodeContent=f=>C.isWidget(f)&&!f.destroyed?u.tsx("div",{class:M.css.contentNode,key:f},f.render()):f instanceof HTMLElement?u.tsx("div",{afterCreate:this._attachToNode,bind:f,class:M.css.contentNode,key:f}):C.hasDomNode(f)?u.tsx("div",{afterCreate:this._attachToNode,bind:f.domNode,class:M.css.contentNode,key:f}):null}_attachToNode(f){f.appendChild(this)}};return a=p.__decorate([H.subclass("esri.widgets.Feature.ContentMixin")],a)};
Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define("require ../chunks/tslib.es6 ../intl ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./Widget ./Feature/FeatureAttachments ./Feature/FeatureContent ./Feature/FeatureExpression ./Feature/FeatureFields ./Feature/FeatureMedia ./Feature/FeatureRelationship ./Feature/FeatureViewModel ./Feature/resources ./Feature/support/FeatureContentMixin ./support/componentsUtils ./support/globalCss ./support/Heading ./support/legacyIcon ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory ../intl/substitute".split(" "),function(c,
p,g,z,K,F,E,H,M,C,u,a,f,l,h,k,m,r,y,q,I,v,e,b,d,w,G){var n;const B={title:!0,content:!0,lastEditedInfo:!0};g=n=class extends y.FeatureContentMixin(C){constructor(x,A){super(x,A);this._contentWidgets=[];this.flowItems=null;this.headingLevel=2;this.messagesURIUtils=this.messagesCommon=this.messages=null;this.visibleElements={...B};this.viewModel=new m}initialize(){this.addHandles(z.watch(()=>this.viewModel?.contentViewModels,()=>this._setupContentWidgets(),z.initial))}loadDependencies(){return q.loadCalciteComponents({notice:()=>
new Promise((x,A)=>c(["../chunks/calcite-notice"],x,A))})}destroy(){this._destroyContentWidgets()}get graphic(){return this.viewModel.graphic}set graphic(x){this.viewModel.graphic=x}get defaultPopupTemplateEnabled(){return this.viewModel.defaultPopupTemplateEnabled}set defaultPopupTemplateEnabled(x){this.viewModel.defaultPopupTemplateEnabled=x}get isTable(){return this.viewModel.isTable}get label(){return this.messages?.widgetLabel??""}set label(x){this._overrideIfSome("label",x)}get spatialReference(){return this.viewModel.spatialReference}set spatialReference(x){this.viewModel.spatialReference=
x}get title(){return this.viewModel.title}castVisibleElements(x){return{...B,...x}}get map(){return this.viewModel.map}set map(x){this.viewModel.map=x}get view(){return this.viewModel.view}set view(x){this.viewModel.view=x}setActiveMedia(x,A){return this.viewModel.setActiveMedia(x,A)}nextMedia(x){return this.viewModel.nextMedia(x)}previousMedia(x){return this.viewModel.previousMedia(x)}render(){var {state:x}=this.viewModel;x=w.tsx("div",{class:r.css.container,key:"container"},this._renderTitle(),
"error"===x?this._renderError():"loading"===x?this._renderLoading():this._renderContentContainer());return w.tsx("div",{class:this.classes(r.css.base,I.globalCss.widget)},x)}_renderError(){const {messagesCommon:x,messages:A,visibleElements:L}=this;return w.tsx("calcite-notice",{icon:"exclamation-mark-circle",kind:"danger",open:!0,scale:"s"},L.title?w.tsx("div",{key:"error-title",slot:"title"},x.errorMessage):null,w.tsx("div",{key:"error-message",slot:"message"},A.loadingError))}_renderLoading(){return w.tsx("div",
{class:r.css.loadingSpinnerContainer,key:"loading-container"},w.tsx("span",{class:this.classes(e.legacyIcon.loadingIndicator,I.globalCss.rotating,r.css.spinner)}))}_renderContentContainer(){const {visibleElements:x}=this;return x.content?w.tsx("div",{class:r.css.main},[this._renderContent(),this._renderLastEditInfo()]):null}_renderTitle(){const {visibleElements:x,title:A}=this;return x.title?w.tsx(v.Heading,{class:r.css.title,innerHTML:A,level:this.headingLevel}):null}_renderContent(){var x=this.viewModel.content;
return x?Array.isArray(x)?x.length?w.tsx("div",{class:r.css.contentNode,key:"content-content-elements"},x.map(this._renderContentElement,this)):null:"string"===typeof x?(x=this._contentWidgets[0],!x||x.destroyed?null:w.tsx("div",{class:this.classes(r.css.contentNode,r.css.contentNodeText),key:"content-content"},x.render())):this.renderNodeContent(x):null}_renderContentElement(x,A){const {visibleElements:L}=this;if("boolean"!==typeof L.content&&!L.content?.[x.type])return null;switch(x.type){case "attachments":return this._renderAttachments(A);
case "custom":return this._renderCustom(x,A);case "fields":return this._renderFields(A);case "media":return this._renderMedia(A);case "text":return this._renderText(x,A);case "expression":return this._renderExpression(A);case "relationship":return this._renderRelationship(A);default:return null}}_renderAttachments(x){const A=this._contentWidgets[x];if(!A||A.destroyed)return null;const {state:L,attachmentInfos:O}=A.viewModel;return"loading"===L||0<O.length?w.tsx("div",{class:this.classes(r.css.contentElement),
key:this._buildKey("attachments-element",x)},A.render()):null}_renderRelationship(x){const A=this._contentWidgets[x];return A&&!A.destroyed&&this.flowItems?w.tsx("div",{class:r.css.contentElement,key:this._buildKey("relationship-element",x)},A.render()):null}_renderExpression(x){const A=this._contentWidgets[x];return!A||A.destroyed?null:w.tsx("div",{class:r.css.contentElement,key:this._buildKey("expression-element",x)},A.render())}_renderCustom(x,A){({creator:x}=x);const L=this._contentWidgets[A];
return!L||L.destroyed?null:x?w.tsx("div",{class:r.css.contentElement,key:this._buildKey("custom-element",A)},L.render()):null}_renderFields(x){const A=this._contentWidgets[x];return!A||A.destroyed?null:w.tsx("div",{class:r.css.contentElement,key:this._buildKey("fields-element",x)},A.render())}_renderMedia(x){const A=this._contentWidgets[x];return!A||A.destroyed?null:w.tsx("div",{class:r.css.contentElement,key:this._buildKey("media-element",x)},A.render())}_renderLastEditInfo(){const {visibleElements:x,
messages:A}=this;var {lastEditInfo:L}=this.viewModel;if(!L||!x.lastEditedInfo)return null;const {date:O,user:N}=L;L=G.substitute("edit"===L.type?N?A.lastEditedByUser:A.lastEdited:N?A.lastCreatedByUser:A.lastCreated,{date:O,user:N});return w.tsx("div",{class:this.classes(r.css.lastEditedInfo,r.css.contentElement),key:"edit-info-element"},L)}_renderText(x,A){const L=this._contentWidgets[A];return!L||L.destroyed?null:x.text?w.tsx("div",{class:this.classes(r.css.contentElement,r.css.text),key:this._buildKey("text-element",
A)},L.render()):null}_buildKey(x,...A){const L=this.viewModel?.graphic?.uid||"0";A=A.join("-");return`${x}__${L}-${A}`}_destroyContentWidget(x){x&&(x.viewModel=null,!x.destroyed&&x.destroy())}_destroyContentWidgets(){this.removeHandles("relationship-handles");this._contentWidgets.forEach(x=>this._destroyContentWidget(x));this._contentWidgets=[]}_addFeatureRelationshipHandles(x){const {flowItems:A,visibleElements:L}=this;this.addHandles([z.on(()=>x,"select-record",({featureViewModel:O})=>{A&&(O.abilities=
{relationshipContent:!0},A.push(new n({flowItems:A,viewModel:O,visibleElements:L})))}),z.on(()=>x,"show-all-records",()=>{if(A){var {viewModel:O}=x;O.showAllEnabled=!0;O=new k({visibleElements:{title:!1,description:!1},viewModel:O});this._addFeatureRelationshipHandles(O);A.push(O)}})],"relationship-handles")}_setupContentWidgets(){this._destroyContentWidgets();const {headingLevel:x,visibleElements:A}=this;var L=this.viewModel?.content;const {contentViewModels:O}=this.viewModel;Array.isArray(L)?L.forEach((N,
Q)=>{"attachments"===N.type&&(this._contentWidgets[Q]=new u({displayType:N.displayType,headingLevel:A.title?x+1:x,viewModel:O[Q]}));"fields"===N.type&&(this._contentWidgets[Q]=new l({viewModel:O[Q]}));"media"===N.type&&(this._contentWidgets[Q]=new h({viewModel:O[Q]}));"text"===N.type&&(this._contentWidgets[Q]=new a({viewModel:O[Q]}));"custom"===N.type&&(this._contentWidgets[Q]=new a({viewModel:O[Q]}));"expression"===N.type&&(this._contentWidgets[Q]=new f({viewModel:O[Q]}));"relationship"===N.type&&
(N=new k({viewModel:O[Q]}),this._addFeatureRelationshipHandles(N),this._contentWidgets[Q]=N)},this):(L=O[0])&&!L.destroyed&&(this._contentWidgets[0]=new a({viewModel:L}));this.scheduleRender()}};p.__decorate([K.property()],g.prototype,"graphic",null);p.__decorate([K.property()],g.prototype,"defaultPopupTemplateEnabled",null);p.__decorate([K.property()],g.prototype,"flowItems",void 0);p.__decorate([K.property()],g.prototype,"headingLevel",void 0);p.__decorate([K.property({readOnly:!0})],g.prototype,
"isTable",null);p.__decorate([K.property()],g.prototype,"label",null);p.__decorate([K.property(),d.messageBundle("esri/widgets/Feature/t9n/Feature")],g.prototype,"messages",void 0);p.__decorate([K.property(),d.messageBundle("esri/t9n/common")],g.prototype,"messagesCommon",void 0);p.__decorate([K.property(),d.messageBundle("esri/widgets/support/t9n/uriUtils")],g.prototype,"messagesURIUtils",void 0);p.__decorate([K.property()],g.prototype,"spatialReference",null);p.__decorate([K.property({readOnly:!0})],
g.prototype,"title",null);p.__decorate([K.property()],g.prototype,"visibleElements",void 0);p.__decorate([F.cast("visibleElements")],g.prototype,"castVisibleElements",null);p.__decorate([K.property()],g.prototype,"map",null);p.__decorate([K.property()],g.prototype,"view",null);p.__decorate([K.property({type:m})],g.prototype,"viewModel",void 0);return g=n=p.__decorate([M.subclass("esri.widgets.Feature")],g)});