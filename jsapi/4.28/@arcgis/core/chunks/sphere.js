/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
import"./typedArrayUtil.js";import{L as t}from"./Logger.js";import{b as n,e as r}from"./mathUtils.js";import{f as e}from"./mat4.js";import{k as s,q as o,l as i,t as a,b as c,c as u,d as f,h as l,n as m,p as g,s as p,a as h,g as d,f as j}from"./vec3.js";import{c as M}from"./vec3f64.js";import{c as b,e as y}from"./vec4.js";import{a as A,f as S}from"./vec4f64.js";import{g as v}from"./common.js";import{A as x}from"./Axis.js";import{s as R,b as q,d as P,f as L,e as _}from"./vector.js";const w=C();function C(){return A()}const E=y,O=y;function T(t,n=C()){return b(n,t)}function k(t,n){return S(t[0],t[1],t[2],n)}function N(t){return t}function U(t,n){return t[0]=t[1]=t[2]=0,t[3]=n,t}function Z(t){return t[3]}function z(t){return t}function V(t,n,r,e){return S(t,n,r,e)}function X(t,n,r){if(null==n)return!1;if(!D(t,n,B))return!1;let{t0:e,t1:s}=B;if((e<0||s<e&&s>0)&&(e=s),e<0)return!1;if(r){const{origin:t,direction:s}=n;r[0]=t[0]+s[0]*e,r[1]=t[1]+s[1]*e,r[2]=t[2]+s[2]*e}return!0}function Y(t,n,r){const e=L(n,r);if(!D(t,e,B))return[];const{origin:s,direction:o}=e,{t0:i,t1:a}=B,c=n=>{const r=M();return j(r,s,o,n),I(t,r,r)};return Math.abs(i-a)<v()?[c(i)]:[c(i),c(a)]}const B={t0:0,t1:0};function D(t,n,r){const{origin:e,direction:s}=n,o=F;o[0]=e[0]-t[0],o[1]=e[1]-t[1],o[2]=e[2]-t[2];const i=s[0]*s[0]+s[1]*s[1]+s[2]*s[2];if(0===i)return!1;const a=2*(s[0]*o[0]+s[1]*o[1]+s[2]*o[2]),c=a*a-4*i*(o[0]*o[0]+o[1]*o[1]+o[2]*o[2]-t[3]*t[3]);if(c<0)return!1;const u=Math.sqrt(c);return r.t0=(-a-u)/(2*i),r.t1=(-a+u)/(2*i),!0}const F=M();function G(t,n){return X(t,n,null)}function H(t,n,r){const c=R.get(),u=q.get();s(c,n.origin,n.direction);const f=Z(t);s(r,c,n.origin),o(r,r,1/i(r)*f);const l=K(t,n.origin),m=P(n.origin,r);return e(u,m+l,c),a(r,r,u),r}function I(t,n,r){const e=c(R.get(),n,t),s=o(R.get(),e,t[3]/i(e));return f(r,s,t)}function J(t,n){const r=c(R.get(),n,t),e=m(r),s=t[3]*t[3];return Math.sqrt(Math.abs(e-s))}function K(t,r){const e=c(R.get(),r,t),s=i(e),o=Z(t),a=o+Math.abs(o-s);return n(o/a)}const Q=M();function W(t,n,e,s){const o=c(Q,n,t);switch(e){case x.X:{const t=r(o,Q)[2];return p(s,-Math.sin(t),Math.cos(t),0)}case x.Y:{const t=r(o,Q),n=t[1],e=t[2],i=Math.sin(n);return p(s,-i*Math.cos(e),-i*Math.sin(e),Math.cos(n))}case x.Z:return g(s,o);default:return}}function $(t,n){const r=c(rt,n,t);return i(r)-t[3]}function tt(t,n){const r=h(t,n),e=Z(t);return r<=e*e}function nt(t,n,r=C()){const e=l(t,n),s=t[3],o=n[3];return e+o<s?(b(r,t),r):e+s<o?(b(r,n),r):(d(r,t,n,(e+o-s)/(2*e)),r[3]=(e+s+o)/2,r)}const rt=M(),et=C(),st=Object.freeze(Object.defineProperty({__proto__:null,NullSphere:w,altitudeAt:$,angleToSilhouette:K,axisAt:W,clear:function(t){t[0]=t[1]=t[2]=t[3]=0},closestPoint:function(t,n,r){return X(t,n,r)?r:(_(n,t,r),I(t,r,r))},closestPointOnSilhouette:H,containsPoint:tt,copy:T,create:C,distanceToSilhouette:J,elevate:function(t,n,r){return t!==r&&u(r,t),r[3]=t[3]+n,r},equals:O,exactEquals:E,fromCenterAndRadius:k,fromRadius:U,fromValues:V,getCenter:z,getRadius:Z,intersectLine:Y,intersectRay:X,intersectRayClosestSilhouette:function(t,n,r){if(X(t,n,r))return r;const e=H(t,n,R.get());return f(r,n.origin,o(R.get(),n.direction,l(n.origin,e)/i(n.direction))),r},intersectsRay:G,projectPoint:I,setAltitudeAt:function(t,n,r,e){const s=$(t,n),i=W(t,n,x.Z,rt),a=o(rt,i,r-s);return f(e,n,a)},setExtent:function(n,r,e){return t.getLogger("esri.geometry.support.sphere").error("sphere.setExtent is not yet supported"),n===e?e:T(n,e)},tmpSphere:et,union:nt,wrap:N},Symbol.toStringTag,{value:"Module"}));export{w as N,T as a,z as b,C as c,G as d,E as e,k as f,Z as g,V as h,Y as i,X as j,H as k,U as l,J as m,tt as n,I as p,st as s,et as t,nt as u,N as w};
