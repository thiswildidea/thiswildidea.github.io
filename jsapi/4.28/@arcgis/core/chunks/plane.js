/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
import{c as t}from"./mathUtils.js";import{b as n,k as r,n as s,p as o,c as a,q as c,d as e,i,s as u,e as f}from"./vec3.js";import{c as I}from"./vec3f64.js";import{g as N}from"./common.js";import"./typedArrayUtil.js";import"./Logger.js";import"./Axis.js";import{s as M,a as m,p as g}from"./vector.js";import{t as h}from"./mathUtils2.js";function p(t=Y){return[t[0],t[1],t[2],t[3]]}function A(t=Y[0],n=Y[1],r=Y[2],s=Y[3]){return l(t,n,r,s,m.get())}function E(t,n){return l(n[0],n[1],n[2],n[3],t)}function l(t,n,r,s,o=p()){return o[0]=t,o[1]=n,o[2]=r,o[3]=s,o}function b(t,n,r){return a(r,t),r[3]=n,r}function j(t,n,r){const s=n[0]*n[0]+n[1]*n[1]+n[2]*n[2],o=Math.abs(s-1)>1e-5&&s>1e-12?1/Math.sqrt(s):1;return r[0]=n[0]*o,r[1]=n[1]*o,r[2]=n[2]*o,r[3]=-(r[0]*t[0]+r[1]*t[1]+r[2]*t[2]),r}function F(t,n,r,s=p()){const o=r[0]-n[0],a=r[1]-n[1],c=r[2]-n[2],e=t[0]-n[0],i=t[1]-n[1],u=t[2]-n[2],f=a*u-c*i,I=c*e-o*u,N=o*i-a*e,M=f*f+I*I+N*N,m=Math.abs(M-1)>1e-5&&M>1e-12?1/Math.sqrt(M):1;return s[0]=f*m,s[1]=I*m,s[2]=N*m,s[3]=-(s[0]*t[0]+s[1]*t[1]+s[2]*t[2]),s}function T(t,r,s,a=0,c=Math.floor(s*(1/3)),e=Math.floor(s*(2/3))){if(s<3)return!1;r(v,a);let u=c,I=!1;for(;u<s-1&&!I;)r(y,u),u++,I=!f(v,y);if(!I)return!1;for(u=Math.max(u,e),I=!1;u<s&&!I;)r(L,u),u++,n(X,v,y),o(X,X),n(q,y,L),o(q,q),I=!f(v,L)&&!f(y,L)&&Math.abs(i(X,q))<d;return I?(F(v,y,L,t),!0):(0!==a||1!==c||2!==e)&&T(t,r,s,0,1,2)}function _(t,n,r=!0){const s=n.length/3;return T(t,((t,r)=>u(t,n[3*r+0],n[3*r+1],n[3*r+2])),r?s-1:s)}const d=.99619469809,v=I(),y=I(),L=I(),X=I(),q=I();function x(t,n,r){return n!==t&&E(t,n),t[3]=-i(t,r),t}function C(t,n){return n[0]=-t[0],n[1]=-t[1],n[2]=-t[2],n[3]=-t[3],n}function P(t,n,s,o){return r(L,n,t),j(s,L,o)}function O(t,r,s,o){return S(t,r,n(M.get(),s,r),$,o)}function U(t,n,r){return null!=n&&S(t,n.origin,n.direction,tt,r)}function k(t,n,r){return S(t,n.origin,n.vector,Z.NONE,r)}function w(t,n,r){return S(t,n.origin,n.vector,Z.CLAMP,r)}const z=(()=>{const t=I();return(n,c,e)=>{const i=n,u=c;if(r(t,i,u),s(t)<N())return!1;o(t,t);const[f,I,M]=t,m=e.origin,g=Math.abs(f),h=Math.abs(I),p=Math.abs(M),[A,E,l]=i,[b,j,F]=u,T=n[3],_=c[3];return g>h&&g>p?(m[1]=(_*l-T*F)/f,m[2]=(T*j-_*E)/f):h>p?(m[0]=(T*F-_*l)/I,m[2]=(_*A-T*b)/I):(m[0]=(_*E-T*j)/M,m[1]=(T*b-_*A)/M),a(e.direction,t),!0}})();function B(t,n){return R(t,n)>=0}function D(t,n){const r=i(t,n.ray.direction),s=-R(t,n.ray.origin);if(s<0&&r>=0)return!1;if(r>-1e-6&&r<1e-6)return s>0;if((s<0||r<0)&&!(s<0&&r<0))return!0;const o=s/r;return r>0?o<n.c1&&(n.c1=o):o>n.c0&&(n.c0=o),n.c0<=n.c1}function G(t,n){const r=i(t,n.ray.direction),s=-R(t,n.ray.origin);if(r>-1e-6&&r<1e-6)return s>0;const o=s/r;return r>0?o<n.c1&&(n.c1=o):o>n.c0&&(n.c0=o),n.c0<=n.c1}function H(t,r,s){const o=c(M.get(),t,-t[3]),a=K(t,n(M.get(),r,o),M.get());return e(s,a,o),s}function J(t,r,s,o){const a=t,c=M.get(),e=M.get();h(a,c,e);const i=n(M.get(),s,r),f=g(c,i),I=g(e,i),N=g(a,i);return u(o,f,I,N)}function K(t,r,s){const o=c(M.get(),t,i(t,r));return n(s,r,o),s}function Q(t,n){return Math.abs(R(t,n))}function R(t,n){return i(t,n)+t[3]}function S(n,r,s,o,a){const u=i(n,s);if(0===u)return!1;let f=-(i(n,r)+n[3])/u;return o&Z.CLAMP&&(f=t(f,0,1)),!(!(o&Z.INFINITE_MIN)&&f<0||!(o&Z.INFINITE_MAX)&&f>1||(e(a,r,c(a,s,f)),0))}function V(t){return t}function W(t){return Math.abs(t[2])<N()}const Y=[0,0,1,0];var Z;!function(t){t[t.NONE=0]="NONE",t[t.CLAMP=1]="CLAMP",t[t.INFINITE_MIN=4]="INFINITE_MIN",t[t.INFINITE_MAX=8]="INFINITE_MAX"}(Z||(Z={}));const $=Z.INFINITE_MIN|Z.INFINITE_MAX,tt=Z.INFINITE_MAX;export{_ as A,B as a,W as b,p as c,Q as d,z as e,j as f,F as g,T as h,O as i,E as j,J as k,G as l,D as m,V as n,U as o,H as p,P as q,x as r,R as s,l as t,k as u,w as v,A as w,b as x,C as y,K as z};
