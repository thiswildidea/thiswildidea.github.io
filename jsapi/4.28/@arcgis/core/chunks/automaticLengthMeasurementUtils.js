/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
import{_ as t}from"./tslib.es6.js";import e from"../core/Evented.js";import{property as i}from"../core/accessorSupport/decorators/property.js";import"./ensureType.js";import"./typedArrayUtil.js";import{subclass as n}from"../core/accessorSupport/decorators/subclass.js";import s from"../core/Accessor.js";import{d as o}from"./maybe.js";import{watch as a,on as l,syncAndInitial as r}from"../core/reactiveUtils.js";import{s as c}from"./themeUtils.js";import"./Logger.js";import"../core/Error.js";import{c as p,i as u}from"./widgetUtils.js";import{t as d,a as h}from"./jsxFactory.js";import m,{l as f}from"../widgets/Widget.js";import{formatNumber as v}from"../intl.js";import{m as g}from"./memoize.js";import{e as _,g as y,h as b,i as x,j as w,k,l as T}from"./quantityFormatUtils.js";import{y as M,c as L}from"./unitFormatUtils.js";import{ag as $,ah as C,ai as j,c as V,b as z,f as E}from"./unitUtils.js";import{g as D}from"./getDefaultUnitForView.js";import{t as O}from"./keybindings.js";import{m as F}from"./messageBundle.js";import{e as I,a as S,b as N,c as U,d as R,f as H}from"./euclideanLengthMeasurementUtils.js";import{c as A}from"./vec3f64.js";import{geodesicLength as P}from"../geometry/geometryEngine.js";import{s as W}from"./vec3.js";import{a as K}from"./projectBuffer.js";import{p as Z}from"./projectVectorToWGS84ComparableLonLat.js";import{isSupported as q,InverseGeodeticSolverResult as G,inverseGeodeticSolver as B,geodesicLengths as X}from"../geometry/support/geodesicUtils.js";let Y=class extends e.EventedAccessor{constructor(t){super(t),this._mode="feedback",this.helpMessage=void 0,this.viewType=void 0}get mode(){return this._mode}get allFields(){return[]}get editableFields(){return this.allFields.filter((t=>!t.readOnly))}enterInputMode(){this._mode="input",this.emit("focus")}exitInputMode(){this._mode="feedback"}unlockAllFields(){this.allFields.forEach((t=>t.unlock()))}};t([i()],Y.prototype,"tooltipOptions",void 0),t([i()],Y.prototype,"_mode",void 0),t([i()],Y.prototype,"mode",null),t([i()],Y.prototype,"helpMessage",void 0),t([i()],Y.prototype,"viewType",void 0),t([i()],Y.prototype,"allFields",null),t([i()],Y.prototype,"editableFields",null),Y=t([n("esri.views.interactive.tooltip.SketchTooltipInfo")],Y);const Q="esri-tooltip",J=`${Q}-content`,tt=`${Q}-content--input`,et=`${Q}-content__header`,it=`${Q}-table`,nt=`${Q}-help-message`;function st({className:t,helpMessage:e,mode:i,onDiscard:n,onkeydown:s},...o){const a=o.flat(10).filter((t=>!!t));return d("div",{class:p(t,J,"input"===i&&tt),onkeydown:s},"input"===i?d("div",{class:et,key:"tooltip-content-header"},d("calcite-button",{appearance:"transparent",iconFlipRtl:"both",iconStart:"chevron-left",kind:"neutral",onclick:n,scale:"s",tabIndex:-1})):null,a.length>0?d("div",{class:it},...a):null,e?d("div",{class:nt,key:"help-message"},e):null)}const ot=`${Q}-field`,at={base:ot,inputMode:`${ot}--input`,title:`${ot}__title`,value:`${ot}__value`};let lt=class extends m{constructor(){super(...arguments),this.hidden=!1,this.mode="feedback"}render(){return d("div",{class:this.classes({[at.base]:!0,[at.inputMode]:"input"===this.mode})},d("div",{class:at.title},this.title),d("div",{class:at.value},this.value))}};t([i()],lt.prototype,"hidden",void 0),t([i()],lt.prototype,"mode",void 0),t([i()],lt.prototype,"title",void 0),t([i()],lt.prototype,"value",void 0),lt=t([n("esri.views.interactive.tooltip.TooltipField")],lt);const rt={base:`${Q}-value-by-value`};let ct=class extends m{constructor(){super(...arguments),this.divider="Ã—"}render(){return d("div",{class:rt.base},d("span",null,this.left),d("span",null,this.divider),d("span",null,this.right))}};t([i()],ct.prototype,"left",void 0),t([i()],ct.prototype,"divider",void 0),t([i()],ct.prototype,"right",void 0),ct=t([n("esri.views.interactive.tooltip.ValueByValue")],ct);let pt=class extends m{constructor(){super(...arguments),this._getFormatters=g(((t,e)=>({angle:t=>_(t,t.rotationType),area:(i,n)=>y(t,i,n??e.area),length:(i,n,s)=>b(t,i,n??e.length,s),relativeLength:(i,n)=>x(t,i,n??e.length),totalLength:(i,n)=>b(t,i,n??e.length),verticalLength:(i,n)=>w(t,i,n??e.length),relativeVerticalLength:(i,n)=>k(t,i,n??e.verticalLength),relativeOrientation:t=>v(t,{maximumFractionDigits:2,minimumFractionDigits:2,signDisplay:"exceptZero"}),percentage:t=>v(t.value,{style:"percent"}),scale:t=>v(t,{style:"percent",maximumFractionDigits:0})}))),this._formatScale=t=>this._formatters.scale(t),this._formatRelativeOrientation=t=>this._formatters.relativeOrientation(t),this._formatLength=(t,e,i)=>this._formatters.length(t,e,i),this._formatRelativeLength=(t,e)=>this._formatters.relativeLength(t,e),this._formatVerticalLength=(t,e)=>this._formatters.verticalLength(t,e),this._formatRelativeVerticalLength=(t,e)=>this._formatters.relativeVerticalLength(t,e),this._formatArea=(t,e)=>this._formatters.area(t,e),this._formatPercentage=t=>this._formatters.percentage(t),this._onDiscard=()=>{this._exitInputMode()},this._onCommit=(t,e)=>{if("commit-and-exit"===e)return this._exitInputMode();const i=this._getFocusableInputs(),n=i.length,s=i.indexOf(t);if(-1===s)return this._exitInputMode();const o=((s+("commit-and-next"===e?1:-1))%n+n)%n;i.at(o)?.focus()},this._handleTab=t=>{if(t.code!==O.next)return;const e=this._getFocusableInputs();if(0===e.length)return;const i=e.at(0),n=e.at(-1);i&&n&&(t.shiftKey?document.activeElement===i&&(t.preventDefault(),n.focus()):document.activeElement===n&&(t.preventDefault(),i.focus()))}}get _displayUnits(){const t=D(this.tooltip.view);return{length:t,verticalLength:t,area:t,angle:"degrees"}}get _inputUnitInfos(){const t=this._messagesUnits,e=e=>({unit:e,abbreviation:M(t,e,"abbr")}),i=D(this.tooltip.view),n=$(i),s=C(i),o=j(i),a="degrees";return{length:e(n),relativeLength:e(n),verticalLength:e(s),relativeVerticalLength:e(s),area:e(o),orientation:e(a),rotation:e(a)}}get _formatters(){return this._getFormatters(this._messagesUnits,this._displayUnits)}get fieldContext(){return{formatters:this._formatters,inputUnitInfos:this._inputUnitInfos,messages:this._messagesTooltip,onCommit:this._onCommit,onDiscard:this._onDiscard}}initialize(){let t=new AbortController;this.addHandles([a((()=>this.info.mode),(t=>{this.tooltip.positionMode="input"===t?"fixed":"follow-cursor"})),l((()=>this.info),"focus",(()=>{t?.abort();const{signal:e}=t=new AbortController;requestAnimationFrame((()=>{e.aborted||this._getFocusableInputs().at(0)?.focus()}))}))])}loadDependencies(){return f({button:()=>import("./calcite-button.js"),icon:()=>import("./calcite-icon.js"),input:()=>import("./calcite-input.js")})}_getHelpMessage(t){const{info:e}=this,{tooltipOptions:i,helpMessage:n,viewType:s}=e,o=i?.visibleElements?.helpMessage,a=t??n,l="3d"===s?"helpMessages3d":"helpMessages2d";return o&&a?this._messagesTooltip?.sketch?.[l]?.[a]:void 0}_exitInputMode(){this.info.exitInputMode(),document.querySelector(".esri-view-surface").focus()}_getFocusableInputs(){return Array.from(this.domNode?.querySelectorAll("input:not([disabled])")??[])}};t([F("esri/core/t9n/Units"),i()],pt.prototype,"_messagesUnits",void 0),t([F("esri/views/interactive/tooltip/t9n/Tooltip"),i()],pt.prototype,"_messagesTooltip",void 0),t([i()],pt.prototype,"info",void 0),t([i()],pt.prototype,"tooltip",void 0),t([i()],pt.prototype,"_displayUnits",null),t([i()],pt.prototype,"_inputUnitInfos",null),t([i()],pt.prototype,"_formatters",null),t([i()],pt.prototype,"fieldContext",null),pt=t([n("esri.views.interactive.tooltip.content.TooltipContent")],pt);const ut={base:`${J} ${J}--draw-rectangle`};let dt=class extends pt{render(){const{area:t,radius:e,xSize:i,ySize:n,tooltipOptions:s}=this.info,{visibleElements:o}=s,a=this._messagesTooltip.sketch;return d(st,{className:ut.base,helpMessage:this._getHelpMessage()},o.radius&&null!=e?d(lt,{title:a.radius,value:this._formatLength(e)}):null,o.size&&null!=i&&null!=n?d(lt,{title:a.size,value:d(ct,{left:this._formatLength(i),right:this._formatLength(n)})}):null,o.area?d(lt,{title:a.area,value:this._formatArea(t)}):null)}};dt=t([n("esri.views.interactive.tooltip.content.TooltipContentDrawCircle")],dt);const ht={base:`${J}--draw-mesh`};let mt=class extends pt{render(){const{elevation:t,tooltipOptions:e}=this.info,{visibleElements:i}=e,n=this._messagesTooltip.sketch;return d(st,{className:ht.base,helpMessage:this._getHelpMessage()},i.elevation?d(lt,{title:n.elevation,value:this._formatVerticalLength(t.actual)}):null)}};mt=t([n("esri.views.interactive.tooltip.content.TooltipContentDrawMesh")],mt);const ft=`${Q}-editable-field`,vt={base:ft,inputMode:`${ft}--input`,locked:`${ft}--locked`,title:`${ft}__title`,titleContent:`${ft}__title__content`,value:`${ft}__value`,valueContent:`${ft}__value__content`,input:`${ft}__input`,inputDisabled:`${ft}__input--disabled`,inputReadOnly:`${ft}__input--read-only`,inputSuffix:`${ft}__input-suffix`,button:`${ft}__button`};let gt=class extends m{constructor(){super(...arguments),this._input=null,this._afterInputCreate=t=>{this._input=t},this._selectText=()=>{requestAnimationFrame((()=>{this._input?.select()}))},this._onKeyDown=t=>{t.key===O.discard&&this._discard()},this._onInputKeyDown=t=>{switch(t.key){case O.commit:return this._commit({type:"commit-and-exit",allowLockingCurrentValue:!0});case O.next:return t.stopPropagation(),this._commit({type:t.shiftKey?"commit-and-previous":"commit-and-next",allowLockingCurrentValue:!1})}},this._onInput=t=>{this.field.inputValue=t.target.value},this._onLockClick=()=>{const{field:t}=this;t.locked?t.unlock():this._lock()}}loadDependencies(){return f({button:()=>import("./calcite-button.js"),icon:()=>import("./calcite-icon.js")})}render(){const{mode:t,field:e}=this,i="input"===t,{locked:n}=e;return d("div",{class:this.classes({[vt.base]:!0,[vt.inputMode]:"input"===t,[vt.locked]:n})},d("div",{class:vt.title,key:"title"},d("div",{class:vt.titleContent,key:"title-content"},this._title,n&&!i?d("calcite-icon",{icon:"lock",key:"icon",scale:"s"}):null)),d("div",{class:vt.value,key:"value"},i?this._renderInput():d("span",{key:"formatted-value"},this._feedbackValue)))}get _initialValue(){const{field:t}=this;return null!=t.actual?t.toInputUnits(t.actual,this.context).value:null}get _feedbackValue(){const{context:t,field:e}=this,{actual:i,committed:n,format:s}=e;return null!=n?s(n,t):null!=i?s(i,t):""}get _displayValue(){const{field:t}=this,{inputValue:e,committed:i}=t;return null!=e?e:null!=i?this._toString(t.toInputUnits(i,this.context).value):this._toString(this._initialValue)}get _suffix(){const{suffix:t}=this.field;return"string"==typeof t?t:t(this.context)}get _title(){const{title:t}=this.field;return"string"==typeof t?t:t(this.context)}_renderInput(){const{disabled:t,locked:e,readOnly:i}=this.field;return d("div",{class:vt.valueContent,key:"input-container",onkeydown:this._onKeyDown},d("input",{afterCreate:this._afterInputCreate,class:this.classes({[vt.input]:!0,[vt.inputDisabled]:t,[vt.inputReadOnly]:i}),disabled:t||i,onfocus:this._selectText,oninput:this._onInput,onkeydown:this._onInputKeyDown,readOnly:i,type:"text",value:this._displayValue}),d("div",{class:vt.inputSuffix,key:"suffix"},this._suffix),i?void 0:d("calcite-button",{appearance:"transparent",class:vt.button,disabled:t,iconStart:e?"lock":"unlock",kind:"neutral",onclick:this._onLockClick,scale:"s",tabIndex:-1}))}_commit({type:t,allowLockingCurrentValue:e}){const{_input:i,field:n}=this;i&&(n.locked&&""===n.inputValue?n.unlock():(e||null!=n.inputValue)&&this._lock(),this.context.onCommit(i,t))}_discard(){this._input&&(this.field.inputValue=null,this.context.onDiscard(this._input))}_lock(){const{field:t}=this,e=this._parseNumber(t.inputValue),i=null!=e?t.createQuantity(e,this.context):null;t.lock(i)}_parseNumber(t){if(null==t)return null;const e=parseFloat(t);return isNaN(e)||!isFinite(e)?null:e}_toString(t){return null!=t?t.toFixed(3):"0"}};function _t(t){const e=t.fields.filter((t=>null!=t&&!t.hidden));return 0===e.length?null:d(h,null,e.map((e=>d(gt,{context:t.context,field:e,key:e.id,mode:t.mode}))))}t([i()],gt.prototype,"field",void 0),t([i()],gt.prototype,"context",void 0),t([i()],gt.prototype,"mode",void 0),t([i()],gt.prototype,"_initialValue",null),t([i()],gt.prototype,"_feedbackValue",null),t([i()],gt.prototype,"_input",void 0),t([i()],gt.prototype,"_displayValue",null),t([i()],gt.prototype,"_suffix",null),t([i()],gt.prototype,"_title",null),gt=t([n("esri.views.interactive.tooltip.TooltipEditableField")],gt);const yt={base:`${J}--draw-point`};let bt=class extends pt{render(){const{fieldContext:t,info:e}=this,{mode:i,elevation:n,tooltipOptions:s}=e,{visibleElements:o}=s;return d(st,{className:yt.base,helpMessage:this._getHelpMessage(),mode:i,onkeydown:this._handleTab,onDiscard:this._onDiscard},d(_t,{context:t,fields:[o.elevation?n:void 0],mode:i}))}};bt=t([n("esri.views.interactive.tooltip.content.TooltipContentDrawPoint")],bt);const xt={base:`${J} ${J}--draw-polygon`};let wt=class extends pt{render(){const{fieldContext:t,info:e}=this,{area:i,distance:n,elevation:s,mode:o,orientation:a,tooltipOptions:l,viewType:r}=e,{inputEnabled:c,visibleElements:p}=l;return d(st,{className:xt.base,helpMessage:this._getHelpMessage(),mode:o,onkeydown:this._handleTab,onDiscard:this._onDiscard},d(_t,{context:t,fields:[c&&p.orientation?a:void 0,c&&p.distance?n:void 0,p.elevation&&"2d"!==r?s:void 0,p.area?i:void 0],mode:o}))}};wt=t([n("esri.views.interactive.tooltip.content.TooltipContentDrawPolygon")],wt);const kt={base:`${J} ${J}--draw-polyline`};let Tt=class extends pt{render(){const{fieldContext:t,info:e}=this,{distance:i,elevation:n,mode:s,orientation:o,tooltipOptions:a,totalLength:l,viewType:r}=e,{inputEnabled:c,visibleElements:p}=a;return d(st,{className:kt.base,helpMessage:this._getHelpMessage(),mode:s,onkeydown:this._handleTab,onDiscard:this._onDiscard},d(_t,{context:t,fields:[c&&p.orientation?o:void 0,c&&p.distance?i:void 0,p.elevation&&"2d"!==r?n:void 0,p.totalLength?l:void 0],mode:s}))}};Tt=t([n("esri.views.interactive.tooltip.content.TooltipContentDrawPolyline")],Tt);const Mt={base:`${J} ${J}--draw-rectangle`};let Lt=class extends pt{render(){const{area:t,xSize:e,ySize:i,tooltipOptions:n}=this.info,{visibleElements:s}=n,o=this._messagesTooltip.sketch;return d(st,{className:Mt.base,helpMessage:this._getHelpMessage()},s.size&&null!=e&&null!=i?d(lt,{title:o.size,value:d(ct,{left:this._formatLength(e),right:this._formatLength(i)})}):null,s.area?d(lt,{title:o.area,value:this._formatArea(t)}):null)}};Lt=t([n("esri.views.interactive.tooltip.content.TooltipContentDrawRectangle")],Lt);const $t={base:`${J} ${J}--extent-rotate`};let Ct=class extends pt{render(){const{angle:t,tooltipOptions:e}=this.info,{visibleElements:i}=e,n=this._messagesTooltip.sketch;return d(st,{className:$t.base,helpMessage:this._getHelpMessage()},i.rotation?d(lt,{title:n.rotation,value:this._formatRelativeOrientation(t)}):null)}};Ct=t([n("esri.views.interactive.tooltip.content.TooltipContentExtentRotate")],Ct);const jt={base:`${J} ${J}--extent-scale`};let Vt=class extends pt{render(){const t=this.info,{visibleElements:e}=t.tooltipOptions,i=this._messagesTooltip.sketch;return d(st,{className:jt.base,helpMessage:this._getHelpMessage()},e.size?d(lt,{title:i.size,value:d(ct,{left:this._formatLength(t.xSize),right:this._formatLength(t.ySize)})}):null,e.scale?d(lt,{title:i.scale,value:d(ct,{left:this._formatScale(t.xScale),right:this._formatScale(t.yScale)})}):null)}};Vt=t([n("esri.views.interactive.tooltip.content.TooltipContentExtentScale")],Vt);const zt={base:`${J} ${J}--reshape-edge-offset`};let Et=class extends pt{render(){const{area:t,distance:e,totalLength:i,tooltipOptions:n}=this.info,{visibleElements:s}=n,o=this._messagesTooltip.sketch;return d(st,{className:zt.base,helpMessage:this._getHelpMessage()},s.distance?d(lt,{title:o.distance,value:this._formatRelativeLength(e)}):null,s.area&&null!=t?d(lt,{title:o.area,value:this._formatArea(t)}):null,s.totalLength&&null!=i?d(lt,{title:o.totalLength,value:this._formatLength(i)}):null)}};Et=t([n("esri.views.interactive.tooltip.content.TooltipContentReshapeEdgeOffset")],Et);const Dt={base:`${J} ${J}--transform-absolute`};let Ot=class extends pt{render(){const{info:t}=this,{visibleElements:e}=t.tooltipOptions,i=this._messagesTooltip.sketch;return d(st,{className:Dt.base,helpMessage:this._getHelpMessage()},e.orientation&&null!=t.orientation?d(lt,{key:"orientation",title:i.orientation,value:_(t.orientation,t.rotationType,t.orientationPrecision)}):null,e.size&&null!=t.size?d(lt,{key:"size",title:i.size,value:this._formatLength(t.size,t.sizeUnit,t.sizePrecision)}):null)}};Ot=t([n("esri.views.interactive.tooltip.content.TooltipContentTransformAbsolute")],Ot);const Ft={base:`${J} ${J}--transform-rotate`};let It=class extends pt{render(){const{info:t}=this,{visibleElements:e}=t.tooltipOptions,i=this._messagesTooltip.sketch;return d(st,{className:Ft.base,helpMessage:this._getHelpMessage()},e.rotation&&null!=t.rotation?d(lt,{key:"rotation",title:i.rotation,value:T(t.rotation,t.rotationType,t.rotationPrecision)}):null,e.orientation&&null!=t.orientation?d(lt,{key:"orientation",title:i.orientation,value:_(t.orientation,t.rotationType,t.orientationPrecision)}):null)}};It=t([n("esri.views.interactive.tooltip.content.TooltipContentTransformRotate")],It);const St={base:`${J} ${J}--transform-scale`};let Nt=class extends pt{render(){const{info:t}=this,{visibleElements:e}=t.tooltipOptions,i=this._messagesTooltip.sketch;return d(st,{className:St.base,helpMessage:this._getHelpMessage()},e.scale&&null!=t.scale?d(lt,{key:"scale",title:i.scale,value:this._formatPercentage(t.scale)}):null,e.size&&null!=t.size?d(lt,{key:"size",title:i.size,value:this._formatLength(t.size,t.sizeUnit,t.sizePrecision)}):null)}};Nt=t([n("esri.views.interactive.tooltip.content.TooltipContentTransformScale")],Nt);const Ut={base:`${J} ${J}--translate-graphic`};let Rt=class extends pt{render(){const{info:t}=this,{visibleElements:e}=t.tooltipOptions,i=this._messagesTooltip.sketch;return d(st,{className:Ut.base,helpMessage:this._getHelpMessage()},e.distance?d(lt,{title:i.distance,value:this._formatLength(t.distance)}):null)}};Rt=t([n("esri.views.interactive.tooltip.content.TooltipContentTranslateGraphic")],Rt);const Ht={base:`${J} ${J}--translate-graphic-xy`};let At=class extends pt{render(){const{info:t}=this,{visibleElements:e}=t.tooltipOptions,i=this._messagesTooltip.sketch;return d(st,{className:Ht.base,helpMessage:this._getHelpMessage()},e.distance?d(lt,{title:i.distance,value:this._formatRelativeLength(t.distance)}):null)}};At=t([n("esri.views.interactive.tooltip.content.TooltipContentTranslateGraphicXY")],At);const Pt={base:`${J} ${J}--translate-graphic-z`};let Wt=class extends pt{render(){const{info:t}=this,{visibleElements:e}=t.tooltipOptions,i=this._messagesTooltip.sketch;return d(st,{className:Pt.base,helpMessage:this._getHelpMessage()},e.distance?d(lt,{title:i.distance,value:this._formatRelativeVerticalLength(t.distance)}):null)}};Wt=t([n("esri.views.interactive.tooltip.content.TooltipContentTranslateGraphicZ")],Wt);const Kt={base:`${J} ${J}--translate-vertex`};let Zt=class extends pt{render(){const{distance:t,elevation:e,area:i,totalLength:n,tooltipOptions:s}=this.info,{visibleElements:o}=s,a=this._messagesTooltip.sketch;return d(st,{className:Kt.base,helpMessage:this._getHelpMessage()},o.distance?d(lt,{title:a.distance,value:this._formatLength(t)}):null,o.elevation&&null!=e?d(lt,{title:a.elevation,value:this._formatVerticalLength(e.actual)}):null,o.area&&null!=i?d(lt,{title:a.area,value:this._formatArea(i)}):null,o.totalLength&&null!=n?d(lt,{title:a.totalLength,value:this._formatLength(n)}):null)}};Zt=t([n("esri.views.interactive.tooltip.content.TooltipContentTranslateVertex")],Zt);const qt={base:`${J} ${J}--translate-vertex`};let Gt=class extends pt{render(){const{area:t,distance:e,elevation:i,totalLength:n,tooltipOptions:s}=this.info,{visibleElements:o}=s,a=this._messagesTooltip.sketch;return d(st,{className:qt.base,helpMessage:this._getHelpMessage()},o.distance?d(lt,{title:a.distance,value:this._formatRelativeLength(e)}):null,o.elevation&&null!=i?d(lt,{title:a.elevation,value:this._formatVerticalLength(i.actual)}):null,o.area&&null!=t?d(lt,{title:a.area,value:this._formatArea(t)}):null,o.totalLength&&null!=n?d(lt,{title:a.totalLength,value:this._formatLength(n)}):null)}};Gt=t([n("esri.views.interactive.tooltip.content.TooltipContentTranslateVertexXY")],Gt);const Bt={base:`${J} ${J}--translate-vertex`};let Xt=class extends pt{render(){const{distance:t,elevation:e,tooltipOptions:i}=this.info,{visibleElements:n}=i,s=this._messagesTooltip.sketch;return d(st,{className:Bt.base,helpMessage:this._getHelpMessage()},n.distance?d(lt,{title:s.distance,value:this._formatRelativeVerticalLength(t)}):null,n.elevation&&null!=e?d(lt,{title:s.elevation,value:this._formatVerticalLength(e.actual)}):null)}};Xt=t([n("esri.views.interactive.tooltip.content.TooltipContentTranslateVertexZ")],Xt);const Yt={base:`${Q}`};let Qt=class extends s{constructor(t){super(t),this.info=null,this.positionMode="follow-cursor",this._contentContainer=(()=>{const t=document.createElement("div");return t.classList.add(Yt.base),c(t),t})(),this._contentWidget=null}initialize(){const t=this._contentContainer;this.addHandles([a((()=>this.view.overlay?.surface),(e=>{t.remove(),e?.appendChild(t)}),r),a((()=>this.info),((e,i)=>{if(null!=this._contentWidget&&null!=e&&null!=i&&e.type===i.type)this._contentWidget.info=e;else{this._contentWidget=o(this._contentWidget);const i=function(t,e){if(null==e)return null;const i=document.createElement("div");switch(e.type){case"draw-point":return new bt({tooltip:t,info:e,container:i});case"draw-polygon":return new wt({tooltip:t,info:e,container:i});case"draw-polyline":return new Tt({tooltip:t,info:e,container:i});case"draw-mesh":return new mt({tooltip:t,info:e,container:i});case"draw-rectangle":return new Lt({tooltip:t,info:e,container:i});case"draw-circle":return new dt({tooltip:t,info:e,container:i});case"extent-rotate":return new Ct({tooltip:t,info:e,container:i});case"extent-scale":return new Vt({tooltip:t,info:e,container:i});case"transform-absolute":return new Ot({tooltip:t,info:e,container:i});case"transform-rotate":return new It({tooltip:t,info:e,container:i});case"transform-scale":return new Nt({tooltip:t,info:e,container:i});case"translate-graphic":return new Rt({tooltip:t,info:e,container:i});case"translate-graphic-z":return new Wt({tooltip:t,info:e,container:i});case"translate-graphic-xy":return new At({tooltip:t,info:e,container:i});case"translate-vertex":return new Zt({tooltip:t,info:e,container:i});case"translate-vertex-z":return new Xt({tooltip:t,info:e,container:i});case"translate-vertex-xy":return new Gt({tooltip:t,info:e,container:i});case"reshape-edge-offset":return new Et({tooltip:t,info:e,container:i})}}(this,e);i&&(this._contentWidget=i,i.container&&t.appendChild(i.container))}}),r),a((()=>({container:this._contentContainer,contentWidget:this._contentWidget,screenPoint:this._screenPoint,positionMode:this.positionMode})),Jt,r)])}destroy(){this._contentWidget=o(this._contentWidget),this._contentContainer.remove()}clear(){this.info=null}get _screenPoint(){const t=this.view.inputManager;return t?.multiTouchActive?null:t?.latestPointerLocation}get test(){return{contentContainer:this._contentContainer,visible:"none"!==this._contentContainer?.style.display}}};function Jt({container:t,contentWidget:e,screenPoint:i,positionMode:n}){const{style:s}=t;if("docked"===n)return s.display="block",void(s.transform="none");if("fixed"!==n)if(null!=i&&null!=e){s.display="block";const e=u(t),n=`translate(${Math.round(i.x)+te[0]*(e?-1:1)}px, ${Math.round(i.y)+te[1]}px)`;s.transform=e?`translate(-100%, 0) ${n}`:n}else s.display="none"}t([i({nonNullable:!0})],Qt.prototype,"view",void 0),t([i()],Qt.prototype,"info",void 0),t([i()],Qt.prototype,"positionMode",void 0),t([i()],Qt.prototype,"_contentContainer",void 0),t([i()],Qt.prototype,"_contentWidget",void 0),t([i()],Qt.prototype,"_screenPoint",null),Qt=t([n("esri.views.interactive.tooltip.Tooltip")],Qt);const te=[20,20];function ee(t,e,i,n,...s){return V(t)&&q(t)?e.apply(void 0,s):z(t)?i.apply(void 0,s):n.apply(void 0,s)}const ie=A();function ne(t){const{spatialReference:e}=t;return ee(e,ce,pe,ue,t)}function se(t,e){if(!E(t.spatialReference,e.spatialReference))return null;const{spatialReference:i}=t;return he[0]=t.x,he[1]=t.y,he[2]=t.hasZ?t.z:0,me[0]=e.x,me[1]=e.y,me[2]=e.hasZ?e.z:0,oe(he,me,i)}function oe(t,e,i){return ee(i,ae,le,re,t,e,i)}function ae(t,e,i){return L(B(de,t,e,i).distance,"meters")}function le(t,e,i){return L(P(function(t,e,i){return{type:"polyline",spatialReference:i,paths:[[[...t],[...e]]]}}(t,e,i),"meters"),"meters")}function re(t,e,i){return Z(t,i,fe)&&Z(e,i,ve)?L(B(de,fe,ve).distance,"meters"):null}function ce(t){return L(X([t],"meters")[0],"meters")}function pe(t){return L(P(t,"meters"),"meters")}function ue(t){const e=[];if(!function({hasZ:t,spatialReference:e,paths:i},n,s=0){const o=K(e);if(null==o)return!1;const a=t?t=>t:t=>W(ie,t[0],t[1],s);for(const t of i){const e=[];for(const i of t){const t=[0,0,s];o(a(i),0,t,0),e.push(t)}n.push(e)}return!0}(t,e))return null;let i=0;for(const t of e){let e=0;for(let i=1;i<t.length;++i)e+=B(de,t[i-1],t[i]).distance;i+=e}return L(i,"meters")}const de=new G,he=A(),me=A(),fe=A(),ve=A();function ge(t,e){return Te(S,ne,I,e,t)}function _e(t,e,i){return Te(U,se,N,i,t,e)}function ye(t,e,i,n){return Te(H,oe,R,n,t,e,i)}function be(t,e,i){return Te(N,se,N,i,t,e)}function xe(t,e,i,n){return Te(R,oe,R,n,t,e,i)}function we(t){return Te(S,ne,I,"on-the-ground",t)}function ke(t,e){return Te(N,se,N,"on-the-ground",t,e)}function Te(t,e,i,n,...s){if("on-the-ground"===n){const t=e.apply(void 0,s);return null!=t?t:i.apply(void 0,s)}return t.apply(void 0,s)}export{Y as S,Qt as T,ge as a,_e as b,be as c,ye as d,oe as e,xe as f,ee as g,ke as h,we as i};
