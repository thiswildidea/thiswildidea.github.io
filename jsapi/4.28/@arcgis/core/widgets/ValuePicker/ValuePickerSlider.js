/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
import{_ as s}from"../../chunks/tslib.es6.js";import{debounce as t}from"../../core/promiseUtils.js";import{watch as e,initial as i}from"../../core/reactiveUtils.js";import{property as o}from"../../core/accessorSupport/decorators/property.js";import"../../chunks/ensureType.js";import"../../chunks/typedArrayUtil.js";import{subclass as r}from"../../core/accessorSupport/decorators/subclass.js";import l from"../Slider.js";import{l as n}from"../Widget.js";import"../../chunks/widgetUtils.js";import{t as p}from"../../chunks/jsxFactory.js";import{V as u}from"../../chunks/ValuePickerBaseComponent.js";import c from"../../core/Accessor.js";import"../../chunks/handleUtils.js";import"../../core/Error.js";import"../../core/lang.js";import"../../chunks/Logger.js";import"../../config.js";import"../../chunks/maybe.js";import"../../chunks/asyncUtils.js";import"../../core/Collection.js";import"../../core/Evented.js";import"../../core/Handles.js";import"../../chunks/utils.js";import"../../chunks/metadata.js";import"../../chunks/ObjectPool.js";import"../../chunks/ObservableBase.js";import"../../chunks/tracking.js";import"../../core/scheduling.js";import"../../chunks/nextTick.js";import"../../chunks/PooledArray.js";import"../../chunks/time.js";import"../../chunks/shared.js";import"../../chunks/SimpleObservable.js";import"../../intl.js";import"../../chunks/date.js";import"../../chunks/jsonMap.js";import"../../chunks/locale.js";import"../../chunks/timeZoneUtils.js";import"../../chunks/datetime.js";import"../../chunks/messages.js";import"../../request.js";import"../../kernel.js";import"../../core/urlUtils.js";import"../../core/JSONSupport.js";import"../../chunks/assets.js";import"../../core/accessorSupport/decorators/cast.js";import"../../chunks/legacyIcon.js";import"../Slider/SliderViewModel.js";import"../../chunks/globalCss.js";import"../../chunks/messageBundle.js";import"../../chunks/domUtils.js";import"../../core/Promise.js";import"../../chunks/uuid.js";import"../../chunks/projector.js";import"../../chunks/dom.js";import"../../chunks/index.js";import"../../chunks/jsxWidgetSupport.js";let a=class extends c{constructor(s){super(s),this.steps=!1,this.thumbTooltip=!1}};s([o({nonNullable:!0})],a.prototype,"steps",void 0),s([o({nonNullable:!0})],a.prototype,"thumbTooltip",void 0),a=s([r("esri.widgets.ValuePicker.ValuePickerSliderVisibleElements")],a);const h=a,m="esri-value-picker__slider",d={minorTick:`${m}__tick-minor`,majorTick:`${m}__tick-major`,stepsTick:`${m}__tick-steps`,tooltip:`${m}__tooltip`};function v(s){return(t,e)=>{e?.classList.add(s)}}let j=class extends u{constructor(s,e){super(s,e),this._majorTickCreatedFunction=v(d.majorTick),this._minorTickCreatedFunction=v(d.minorTick),this._stepsTickCreatedFunction=v(d.stepsTick),this._thumbNode=null,this._tooltip=null,this._slider=new l({thumbCreatedFunction:(s,t,e)=>{this._thumbNode=e}}),this.labelFormatFunction=null,this.labels=null,this.min=null,this.minorTicks=null,this.majorTicks=null,this.max=null,this.reversed=!1,this.steps=null,this.type="slider",this.visibleElements=new h,this._thumbDragDebounced=t((async s=>{await(this._tooltip?.reposition(!1))}))}initialize(){this.addHandles([e((()=>this.viewModel?.values),(s=>{this._slider.values=s}),i),e((()=>this._slider.values),(s=>{this.viewModel&&this.viewModel.values!==s&&(this.viewModel.values=s)})),this._slider.on("thumb-drag",this._thumbDragDebounced)])}destroy(){this._slider.destroy()}loadDependencies(){return n({tooltip:()=>import("../../chunks/calcite-tooltip.js")})}get _ascending(){const{reversed:s,viewModel:t}=this;if(!t)return null;const{layout:e}=t;return"horizontal"===e&&!s||"vertical"===e&&s}get canNext(){const{_ascending:s,min:t,max:e,steps:i,viewModel:o}=this;if(null==s||null==t||null==e||!i?.length||!o)return!1;const{values:r}=o,l=r?.[0];return null==l||(s?l!==i[i.length-1]:l!==i[0])}get canPlay(){return null!=this.viewModel&&!!this.steps?.length&&null!=this.min&&null!=this.max}get canPrevious(){const{_ascending:s,min:t,max:e,steps:i,viewModel:o}=this;if(null==s||null==t||null==e||!i?.length||!o)return!1;const{values:r}=o,l=r?.[0];return null==l||(s?l!==i[0]:l!==i[i.length-1])}render(){const{labels:s,labelFormatFunction:t,min:e,max:i,steps:o,minorTicks:r,majorTicks:l,reversed:n,viewModel:u}=this;if(!u)return p("div",null);const{disabled:c,layout:a}=u,h=`${a}${n?"-reversed":""}`,d="position",v=[];return null!=e&&null!=i&&(r&&v.push({mode:d,values:r,tickCreatedFunction:this._minorTickCreatedFunction}),l&&v.push({mode:d,values:l,tickCreatedFunction:this._majorTickCreatedFunction}),s&&v.push({mode:d,values:s,labelsVisible:!0}),this.visibleElements.steps&&this.steps&&v.push({mode:d,values:this.steps,tickCreatedFunction:this._stepsTickCreatedFunction})),this._slider.set({disabled:c,labelFormatFunction:t,layout:h,min:e,max:i,steps:o,tickConfigs:v}),p("div",{class:m},this._slider.render(),this._renderToolTip())}animate(s){this._step(1,s)}next(){this._step(this._ascending?1:-1)}previous(){this._step(this._ascending?-1:1)}_onTooltipAfterCreate(s){this._tooltip=s}_renderToolTip(){if(!this.visibleElements.thumbTooltip||!this._thumbNode||!this._slider.values)return null;const s=this._slider.viewModel.getLabelForValue(this._slider.values[0],"value");return s?p("calcite-tooltip",{afterCreate:this._onTooltipAfterCreate,class:d.tooltip,referenceElement:this._thumbNode},s):null}_step(s,t=!1){if(!this.viewModel||!this.steps?.length)return;if(!this.viewModel.values||!this.steps.includes(this.viewModel.values[0]))return void(this.viewModel.values=[this.steps[0]]);const e=this.steps.indexOf(this.viewModel.values[0])+s;e<0||e>=this.steps.length?this.viewModel.loop||t?this.viewModel.values=[this.steps[1===s?0:this.steps.length-1]]:"playing"===this.viewModel.state&&this.viewModel.pause():this.viewModel.values=[this.steps[e]]}};s([o()],j.prototype,"_ascending",null),s([o()],j.prototype,"canNext",null),s([o()],j.prototype,"canPlay",null),s([o()],j.prototype,"canPrevious",null),s([o()],j.prototype,"labelFormatFunction",void 0),s([o()],j.prototype,"labels",void 0),s([o()],j.prototype,"min",void 0),s([o()],j.prototype,"minorTicks",void 0),s([o()],j.prototype,"majorTicks",void 0),s([o()],j.prototype,"max",void 0),s([o({nonNullable:!0})],j.prototype,"reversed",void 0),s([o()],j.prototype,"steps",void 0),s([o()],j.prototype,"type",void 0),s([o({type:h,nonNullable:!0})],j.prototype,"visibleElements",void 0),j=s([r("esri.widgets.ValuePicker.ValuePickerSlider")],j);const k=j;export{k as default};
