/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
import{_ as o}from"../chunks/tslib.es6.js";import{L as r}from"../chunks/Logger.js";import{isDataProtocol as t,isAbsolute as e,normalize as s,makeData as i}from"../core/urlUtils.js";import{property as n}from"../core/accessorSupport/decorators/property.js";import"../chunks/ensureType.js";import"../chunks/typedArrayUtil.js";import{e as c}from"../chunks/enumeration.js";import{subclass as l}from"../core/accessorSupport/decorators/subclass.js";import a from"./Symbol3DLayer.js";import{w as p,i as h}from"../chunks/colors.js";import{s as m}from"../chunks/jsonMap.js";import{JSONSupport as u}from"../core/JSONSupport.js";import{r as f}from"../chunks/reader.js";import{w as y}from"../chunks/writer.js";import{f as d,t as j}from"../chunks/persistableUrlUtils.js";import{c as k,s as b}from"../chunks/materialUtils.js";import{S as v}from"../chunks/Symbol3DAnchorPosition2D.js";import g from"../Color.js";import{p as w}from"../chunks/screenUtils.js";import{S}from"../chunks/Symbol3DMaterial.js";import"../config.js";import"../core/lang.js";import"../core/Error.js";import"../core/Accessor.js";import"../core/Handles.js";import"../chunks/maybe.js";import"../chunks/metadata.js";import"../chunks/utils.js";import"../chunks/handleUtils.js";import"../chunks/ObjectPool.js";import"../chunks/ObservableBase.js";import"../chunks/tracking.js";import"../core/scheduling.js";import"../chunks/nextTick.js";import"../chunks/PooledArray.js";import"../core/promiseUtils.js";import"../chunks/time.js";import"../chunks/opacityUtils.js";import"../chunks/colorUtils.js";import"../chunks/mathUtils.js";import"../chunks/vec3.js";import"../chunks/vec3f64.js";import"../chunks/common.js";var U;const z=m()({circle:"circle",square:"square",cross:"cross",x:"x",kite:"kite",triangle:"triangle"});let x=U=class extends u{constructor(o){super(o)}readHref(o,r,t){return o?d(o,t):r.dataURI}writeHref(o,r,i,n){o&&(t(o)?r.dataURI=o:(r.href=j(o,n),e(r.href)&&(r.href=s(r.href))))}clone(){return new U({href:this.href,primitive:this.primitive})}};o([n({type:String,json:{write:!0,read:{source:["href","dataURI"]}}})],x.prototype,"href",void 0),o([f("href")],x.prototype,"readHref",null),o([y("href",{href:{type:String},dataURI:{type:String}})],x.prototype,"writeHref",null),o([c(z)],x.prototype,"primitive",void 0),x=U=o([l("esri.symbols.support.IconSymbol3DLayerResource")],x);const P="circle";var I;let L=I=class extends u{constructor(o){super(o),this.color=new g([0,0,0,1]),this.size=w(1)}clone(){const o={color:null!=this.color?this.color.clone():null,size:this.size};return new I(o)}};var D;o([n(k)],L.prototype,"color",void 0),o([n(b)],L.prototype,"size",void 0),L=I=o([l("esri.symbols.support.Symbol3DIconOutline")],L);const R="esri.symbols.IconSymbol3DLayer";let O=D=class extends a{constructor(o){super(o),this.material=null,this.resource=null,this.type="icon",this.size=12,this.anchor="center",this.anchorPosition=null,this.outline=null}clone(){return new D({anchor:this.anchor,anchorPosition:this.anchorPosition&&this.anchorPosition.clone(),enabled:this.enabled,material:null!=this.material?this.material.clone():null,outline:null!=this.outline?this.outline.clone():null,resource:this.resource&&this.resource.clone(),size:this.size})}static fromSimpleMarkerSymbol(o){const t=o.color||p,e=H(o),s=o.outline&&o.outline.width>0?{size:o.outline.width,color:(o.outline.color||p).clone()}:null;return new D({size:o.size,resource:{primitive:(i=o.style,q[i]||(r.getLogger(R).warn(`${i} cannot be mapped to Icon symbol. Fallback to "circle"`),"circle"))},material:{color:t},outline:s,anchor:e?"relative":void 0,anchorPosition:e});var i}static fromPictureMarkerSymbol(o){const r=!o.color||h(o.color)?p:o.color,t=H(o);return new D({size:o.width<=o.height?o.height:o.width,resource:{href:o.url},material:{color:r.clone()},anchor:t?"relative":void 0,anchorPosition:t})}static fromCIMSymbol(o){return new D({resource:{href:i({mediaType:"application/json",data:JSON.stringify(o.data)})}})}};function H(o){const r="width"in o?o.width:o.size,t="height"in o?o.height:o.size,e=M(o.xoffset),s=M(o.yoffset);return(e||s)&&r&&t?{x:-e/r,y:s/t}:null}function M(o){return isFinite(o)?o:0}o([n({type:S,json:{write:!0}})],O.prototype,"material",void 0),o([n({type:x,json:{write:!0}})],O.prototype,"resource",void 0),o([c({Icon:"icon"},{readOnly:!0})],O.prototype,"type",void 0),o([n(b)],O.prototype,"size",void 0),o([c({center:"center",left:"left",right:"right",top:"top",bottom:"bottom",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right",relative:"relative"}),n({json:{default:"center"}})],O.prototype,"anchor",void 0),o([n({type:v,json:{type:[Number],read:{reader:o=>new v({x:o[0],y:o[1]})},write:{writer:(o,r)=>{r.anchorPosition=[o.x,o.y]},overridePolicy(){return{enabled:"relative"===this.anchor}}}}})],O.prototype,"anchorPosition",void 0),o([n({type:L,json:{write:!0}})],O.prototype,"outline",void 0),O=D=o([l(R)],O);const q={circle:"circle",cross:"cross",diamond:"kite",square:"square",x:"x",triangle:"triangle",path:null};const A=O;export{P as d,A as default};
